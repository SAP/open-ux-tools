// json5: https://json5.org/
// json5 VS Code extension: https://marketplace.visualstudio.com/items?itemName=mrmlnc.vscode-json5
// renovate configuration: https://docs.renovatebot.com/configuration-options/
{
    $schema: 'https://docs.renovatebot.com/renovate-schema.json',

    extends: [
        'config:recommended',
        ':automergeDisabled',
        ':combinePatchMinorReleases',
        ':enableVulnerabilityAlerts',
        ':enableVulnerabilityAlertsWithLabel(security)',
        ':label(renovate)',
        ':rebaseStalePrs',
        ':semanticCommits',
        ':semanticPrefixChore',
        ':timezone(America/Los_Angeles)',
        ':updateNotScheduled',
        'workarounds:typesNodeVersioning'
    ],

    enabledManagers: ['npm', 'github-actions'],
    branchPrefix: 'chore/renovate/',
    platformCommit: 'enabled',

    major: {
        dependencyDashboardApproval: true
    },
    dependencyDashboardAutoclose: true,
    dependencyDashboardLabels: ['renovate-dashboard'],
    dependencyDashboardTitle: 'Renovate Dependency Dashboard',

    assigneesFromCodeOwners: true,

    // Allow Renovate to continue updating PRs after GitHub Actions bot commits
    // This is needed for the update-ui5manifest-version workflow which adds
    // additional changes (test fixtures, changesets) to Renovate PRs
    gitIgnoredAuthors: ['github-actions[bot]@users.noreply.github.com', kranthie-sap],

    ignorePaths: [
        '**/templates/**',
        '**/test-input/**',
        '**/test-output/**',
        '**/fixtures/**',
        '**/test/fixture/**',
        '**/test/test-data/**',
        '**/expected-output/**',
        '**/test/sample/**',
        '**/test/unit/sample/**',
        '**/test/data/**',
        '**/test/samples/**',
        '**/test/fixtures/**',
        '**/test/fixture/**',
        '**/test/test-data/**',
        '**/expected-output/**',
        '**/test/sample/**',
        '**/test-inputs/**',
        '**/test-outputs/**',
        '**/test/inputs/**',
        '**/test/outputs/**',
        '**/__tests__/fixtures/**',
        '**/__tests__/fixture/**',
        '**/__tests__/test-data/**',
        '**/__tests__/expected-output/**',
        '**/__tests__/sample/**',
        '**/__tests__/inputs/**',
        '**/test/sample-workspace/**'
    ],

    ignoreDeps: ['@sap-ux-private/playwright'],

    packageRules: [
        {
            matchPackageNames: ['@ui5/manifest'],
            groupName: 'dependencies [@ui5/manifest]',
            semanticCommitType: 'fix',
            commitMessagePrefix: 'fix(deps):',
            labels: ['dependencies', '@ui5/manifest'],
            automerge: false
        },
        {
            matchPackageNames: ['react{/,}**', 'react-dom{/,}**', '@types/react{/,}**', '@types/react-dom{/,}**'],
            groupName: 'dependencies [react]',
            allowedVersions: '<17.0.0'
        },
        {
            matchPackageNames: ['@fluentui/{/,}**'],
            groupName: 'dependencies [fluentui]'
        },
        {
            matchPackageNames: ['@testing-library/{/,}**', '@types/testing-library{/,}**'],
            groupName: 'dependencies [testing-library]',
            matchDepTypes: ['devDependencies']
        },
        {
            matchPackageNames: ['eslint{/,}**', '@typescript-eslint/{/,}**', 'lint-staged{/,}**'],
            groupName: 'dev dependencies [eslint]',
            matchDepTypes: ['devDependencies']
        },
        {
            matchPackageNames: ['prettier', 'pretty-quick'],
            groupName: 'dev dependencies [prettier]',
            matchDepTypes: ['devDependencies']
        },
        {
            matchPackageNames: ['i18next{/,}**'],
            groupName: 'dependencies [i18next]'
        },
        {
            matchPackageNames: ['mem-fs{/,}**', '@types/mem-fs{/,}**'],
            groupName: 'dependencies [mem-fs]'
        },
        {
            matchPackageNames: ['enzyme{/,}**', '@types/enzyme{/,}**'],
            groupName: 'dev dependencies [enzyme]',
            matchDepTypes: ['devDependencies']
        },
        {
            matchPackageNames: ['lodash{/,}**', '@types/lodash{/,}**'],
            groupName: 'dependencies [lodash]'
        },
        {
            matchPackageNames: [
                'jest{/,}**',
                '@​types/jest{/,}**',
                '@jest/​types{/,}**',
                'jest-*{/,}**',
                '*-jest{/,}**',
                '@​types/*jest*{/,}**'
            ],
            groupName: 'dev dependencies [jest]',
            matchDepTypes: ['devDependencies']
        },
        {
            matchPackageNames: ['nx{/,}**', '@​nrwl/nx-cloud{/,}**'],
            groupName: 'dev dependencies [nx]',
            matchDepTypes: ['devDependencies']
        },
        {
            matchPackageNames: ['@types/vscode{/,}**'],
            allowedVersions: '1.73.1'
        },
        {
            matchPackageNames: [
                'webpack{/,}**',
                'ts-loader{/,}**',
                'style-loader{/,}**',
                'sass-loader{/,}**',
                'sass{/,}**',
                'css-loader{/,}**',
                '@storybook/manager-webpack5{/,}**',
                '@storybook/builder-webpack5{/,}**',
                'storybook-addon-turbo-build{/,}**'
            ],
            groupName: 'dev dependencies [webpack]',
            matchDepTypes: ['devDependencies']
        }
    ]
}
