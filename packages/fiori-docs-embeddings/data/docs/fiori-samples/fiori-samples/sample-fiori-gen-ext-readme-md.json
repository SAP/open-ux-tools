{
  "id": "fiori-samples-sample-fiori-gen-ext-readme-md",
  "title": "Sample Fiori generator extension sub-generator",
  "category": "fiori-samples",
  "path": "sample-fiori-gen-ext/README.md",
  "lastModified": "2025-09-29T10:06:39.532Z",
  "tags": [
    "fiori-samples",
    "md",
    "README"
  ],
  "headers": [
    "Sample Fiori generator extension sub-generator",
    "Building and installing the sample Fiori generator extension",
    "For local testing",
    "For bundling to deploy to Business Application Studio",
    "How to provide an extension generator",
    "Implementing the `FioriGeneratorExtensionAPI` to extend Fiori generator",
    "Customizing existing prompts",
    "Adding new steps to the Fiori generator UI",
    "Updating or writing files in the Fiori generator extension",
    "Deployment to Business Application Studio",
    "More info"
  ],
  "content": "# Sample Fiori generator extension sub-generator\n\nThis module is an example of how to extend `@sap/generator-fiori`, adding additional steps, prompts and customizing existing prompt validators and default values.\n\n## Building and installing the sample Fiori generator extension\n\n1. Clone this repo locally.\n2. Run `yarn install` in the `sample-fiori-gen-ext` directory ( pre-requisite: `yarn` is installed globally )\n\n### For local testing\n1. Build the extension sample using `yarn bundle`\n2. Create the installable artefact by running `npm pack`\n3. Install the tgz globally using `npm i -g <path-to-generated-tgz>`\n\n### For bundling to deploy to Business Application Studio\nTo ensure dev space startup time is not negatively impacted by running installs it is recommended that the extension is bundled first. An example of bundling using `esbuild` is included (note: `shelljs` is included as a dependency as a workaround for a known `esbuild` issue):\n1. Bundle the extension sample using `yarn bundle`\n2. The bundle should be checked in to the repo for deployment using the WEX tool (ADD LINK!!!)\n3. To test locally create the installable artefact by running `npm pack`\n4. To test locally install the tgz globally using `npm i -g <path-to-generated-tgz>`\n\nNote: That if the extension generator is to be pushed to a repo then step 3 can be replaced by executing the github action `Draft a new release` from the github web app. \nStep 4 will be replaced by the WEX tool configuration to deploy to BAS dev spaces.\n\n\nTo see the sample extension in action run the Fiori generator using the Application Wizard vscode extension as usual in Business Application Studio or directly in VSCode. A CLI version is also supported. Once the sample extension has been installed globally the additional steps should be visible on the navigation panel in the Application Wizard when using the `SAP Fiori application` generator ( package: `@sap/generator-fiori` version: `1.9.7` and above).\n\n## How to provide an extension generator\n\nExtension generators are loaded during Fiori generator initialization. These should be installed as node modules into one of the following locations:\n\n1. The global npm module location (Run `npm -g root` to view the location. Install using `npm install -g <extension-module-tgz>`)\n2. Any of the standard install locations in a BAS dev space (see ref for configuration of BAS to pre-install)\n3. The custom location defined by the VSCode setting: `Application Wizard: Installation Location`\n\nThere are a few important settings required for the extension to be found.\n\n1. The package name, and therefore installed module folder name, must include the string `fiori-gen-ext`. \n2. The package.json file must include the keyword: `\"fiori-generator-extension\"`. Note that the keyword: `yeoman-generator` should also be included to indicate to Yeoman that this is a generator.\n\ne.g. package.json: \n```\n{\n    name: \"@acme/acme-fiori-gen-ext\",\n    keywords: [\n        \"fiori-generator-extension\"\n    ]\n}\n```\n\nA sample extension generator can be found here: https://github.com/SAP-samples/fiori-tools-samples/sample-fiori-gen-ext\n\n\n\n## Implementing the `FioriGeneratorExtensionAPI` to extend Fiori generator\n\nExtension generators are essentially generators which utilize the `composeWith` functionality provided by Yeoman (https://yeoman.io/authoring/composability.html) that additionally implement the `FioriGeneratorExtensionAPI` interface:\n\n```\nexport interface FioriGeneratorExtensionAPI {\n    /**\n     * Returns the settings to control some prompt and generation options\n     */\n    _getSettings?: () => FioriGeneratorSettings;\n    /**\n     * Returns the extensions which extend existing Fiori generator prompts\n     */\n    _getExtensions?: () => FioriGeneratorPromptExtension;\n    /**\n     * Returns the navigation steps which group new prompts provided by the `prompting` phase\n     */\n    _getSteps?: () => Step[];\n}\n```\n\nAll required type definitions can be imported from the module `@sap/generator-fiori`.\n\n## Customizing existing prompts\n\nExisting Fiori generator prompts can be extended by providing an implemetation of the `_getExtensions` function interface from a generator. \n\nPrompts (questions) defintions are based on the Inquirer-js json structure as defined here: https://github.com/SBoudrias/Inquirer.js/tree/master/packages/inquirer#questions.\nCurrently a limited set of prompts can be customized by providing properties for `default` and/or `validate`. These prompts appear on the Project Attributes step and are identifed by name:\n\n- name : module name\n- title : application title\n- namespace : applicaiton namespace\n- description : application description\n- targetFolder : the absolute path where the application will be generated\n- ui5Version : the minimum ui5 version defined in the application manifest.json\n\nThe complete set of extendable prompts is defined by the definition `promptNamea` exported by the node module `https://www.npmjs.com/package/@sap-ux/ui5-application-inquirer`. However `@sap-ux/ui5-application-inquirer` provides extensive customising using the export type `OdataServicePromptOptions`.\nAn example of providing `_getExtensions` might be: \n\n```\n...\nimport { FioriGeneratorExtensionAPI, FioriGeneratorPromptNames } from \"@sap/generator-fiori\";\n\n...\nclass extends Generator implements FioriGeneratorExtensionAPI\n...\n// Get the Fiori generator \"Project Attributes\" step main question names\nconst { projectAttributes: { mainQuestions: questionNames } } = FioriGeneratorPromptNames;\n...\n...\n    // Provide the extension prompts\n    _getExtensions(): FioriGeneratorPromptExtension {\n        this.log(`Getting extension defintions`);\n        const extensions = {\n            \"@sap/generator-fiori\": {\n                [questionNames.name]: {\n                    validate: (input: string): boolean | string => {\n                        if (input.length < 3) {\n                           return \"Name length > 3\";\n                        }\n                        return true;\n                    },\n                    default: \"superapp1\",\n                }\n            }\n        }\n        return extensions;\n    }\n...\n```\n\nIn the above example the generated app name prompt input will additionally validate that the input string has length greater than 3. If the input string value length is less than 3 a validation message will be shown to the user and progress through the generator prompts will be blocked. In addition any other validation that is assigned to the the prompt will also be executed and so all validations both custom and internally defined will need to return true before the input is considered valid.\n\nThe default value in the above example will be set to \"superapp1\".\n\n<img width=\"786\" alt=\"image\" src=\"https://github.com/IainSAP/fiori-tools-samples/assets/46536134/6f767e92-efbc-47ed-b2a1-9345307edb3c\">\n\n\nNote that default values are only dynamically applied where prompts have been defined with the gui option `applyDefaultWhenDirty` or an answer has not been provided by the user. The setting `applyDefaultWhenDirty` is not assignable by a customized prompt extension and the behaviour should be tested to determine if it is applied when other prompt answers are updated.\n\nAdd more entries, one per question name, to the returned extension object as required.\n\n## Adding new steps to the Fiori generator UI\n\nTo add new questions to the Fiori generator the name and description of the left-hand-side navigation items must be provided along with the question descriptions and a little code to run and process the questions. A full example of adding 2 new steps and running the questions can be found here: https://github.com/SAP-samples/fiori-tools-samples/sample-fiori-gen-ext\n\n```\n...\nimport { FioriGeneratorExtensionAPI } from \"@sap/generator-fiori\";\nimport { IPrompt as YUIStep } from \"@sap-devx/yeoman-ui-types\";\n...\nclass extends Generator implements FioriGeneratorExtensionAPI {\n...\n    async prompting(): Promise<void> {\n        this.log('Sample Fiori generator extension: prompting()');\n        // These are the prompts for the first step\n        const answersPrompt1 = await this.prompt([\n            {\n                type: \"input\",\n                guiOptions: {\n                breadcrumb: true,\n                },\n                name: \"prompt1\",\n                message: \"Sample prompt1\",\n                default: 'Default value prompt1',\n                validate: (val, answers): boolean | string =>\n                    val ? true : \"Validation message from prompt1, enter a value\"\n            },\n            {\n                type: \"input\",\n                guiOptions: {\n                breadcrumb: true,\n                },\n                name: \"prompt2\",\n                message: \"Sample prompt2\",\n                validate: (val, answers): boolean | string =>\n                val ? true : \"Validation message from prompt2, enter a value\"\n            }\n        ]);\n        this.log(`Answers from sample sub-generator \"Extension step 1\" prompts:  ${JSON.stringify(answersPrompt1)}`);\n        // These are the prompts for the second step\n        const answersPrompt2 = await this.prompt([\n            {\n                type: \"input\",\n                guiOptions: {\n                breadcrumb: true,\n                },\n                name: \"prompt3\",\n                message: \"Sample prompt3\",\n                default: () => this.fioriGeneratorState.project.namespace || \"\"\n            },\n            {\n                type: \"input\",\n                guiOptions: {\n                breadcrumb: true,\n                },\n                name: \"prompt4\",\n                message: \"Sample prompt4\"\n            }\n        ]);\n        this.log(`Answers from sample sub-generator \"Extension step 2\" prompts:  ${JSON.stringify(answersPrompt2)}`);\n        // Assign local answers for access in following phases\n        this.localAnswers = Object.assign({}, answersPrompt1, answersPrompt2);\n    }\n    // Return the nav steps that will be added to the LHS navigation panel\n    // Note: for each step there must be one call to prompt()\n    _getSteps(): YUIStep[] {\n        return [\n            {\n                name: \"Extension step 1\",\n                description: \"Extension step 1 description\",\n            },\n            {\n                name: \"Extension step 2\",\n                description: \"Extension step 2 description\",\n            }\n        ];\n    }\n...\n}\n```\nThe above implementation will result in the UI:\n\n<img width=\"1242\" alt=\"image\" src=\"https://github.com/IainSAP/fiori-tools-samples/assets/46536134/a2c5a0e6-c4f2-46af-8c7f-5a884f04e108\">\n\nAdding steps conditionally, perhaps based on the value of a previous answer, can be achieved using the slightly more complex approach as described here: https://github.com/SAP/yeoman-ui/tree/master/packages/generator-foodq.\n\n## Updating or writing files in the Fiori generator extension\n\nInternally Fiori generator uses the Yeoman `composeWith` functionality to add the generator extension. This means that each lifecycle phase of the extended generator will be run in the order defined by the run loop ordering: https://yeoman.io/authoring/running-context.html. The Fiori generator ensures that any extensions are always added after the prompting phase to ensure that it will receive the values of previous answers and also that it is added to the end of the run loop thus ensuring that when the `writing` phase is executed the generated files already exist in memory. This is convienent when extensions need to extend, update or write new files. \n\nThe in-memory file system can be accessed via the `this.fs` reference. An example of implementing the `writing` phase in a Fiori generator extenion might be:\n\n```\n...\n    async writing(): Promise<void> {\n        const manifestPath = this.destinationPath('webapp', 'manifest.json');\n        // Write a new file with some prompt answers\n        this.fs.writeJSON(this.destinationPath('sample.json'), {\n        moduleName: this.fioriGeneratorState.project.name,\n        moduleNamespace: this.fioriGeneratorState.project.namespace,\n        ...this.localAnswers\n        });\n\n        // Extend the application manifest.json\n        this.fs.extendJSON(manifestPath, {\n        'sap.app': {\n            tags: {\n                keywords: [\"fiori\", \"custom extension\", \"acme\"]\n            }\n        }});\n\n        // Update the package.json, for example, by adding a dependency\n        const packageJsonPath = this.destinationPath('package.json');\n        if (this.fs.exists(packageJsonPath)) {\n        this.fs.extendJSON(packageJsonPath, { devDependencies: { 'fast-glob': '3.2.12' }})\n        };\n    }\n...\n```\n\nPlease see the sample extension package:  https://github.com/SAP-samples/fiori-tools-samples/sample-fiori-gen-ext for a full working sample.\n\n### Deployment to Business Application Studio\n\nPlease refer to the documentation here: https://github.com/SAP-samples/fiori-tools-samples/sample-fiori-gen-ext/deploy_extension.md\n\n## More info \n\nFor additional help please reach out using our Community Forum: https://answers.sap.com/tags/73555000100800002345 or via email SAPFioriElements@sap.com\n\n\n",
  "excerpt": "Sample Fiori generator extension sub-generator This module is an example of how to extend @sap/generator-fiori, adding additional steps, prompts and customizing existing prompt validators and default ...",
  "wordCount": 1585,
  "version": "1.0.0",
  "source": "fiori-samples",
  "sourceType": "github"
}