{
  "id": "sapui5-docs-03-get-started-step-5-adding-a-flag-button-69a25bf-md",
  "title": "Step 5: Adding a *Flag* Button",
  "category": "ui5-framework",
  "path": "docs/03_Get-Started/step-5-adding-a-flag-button-69a25bf.md",
  "lastModified": "2025-09-01T18:17:10.476Z",
  "tags": [
    "ui5-framework",
    "md",
    "Step",
    "Adding",
    "Flag",
    "Button"
  ],
  "headers": [
    "Step 5: Adding a *Flag* Button",
    "Preview",
    "Coding",
    "webapp/model/FlaggedType.js",
    "webapp/view/Worklist.view.xml",
    "webapp/controller/Worklist.controller.js",
    "webapp/Component.js",
    "webapp/i18n/i18n.properties"
  ],
  "content": "<!-- loio69a25bf2f8a2478cbda4b8bbe64039de -->\n\n# Step 5: Adding a *Flag* Button\n\nNow that we have implemented the conversion tests, we add the corresponding functionality and show the button to flag a post in the app. The design team has specified that the flag feature should be implemented with a toggle button that has a flag icon.\n\n\n\n## Preview\n\n  \n  \n**The Flag button is now added to the table**\n\n![](images/Tutorial_Testing_Step_05_0cfabfd.jpg \"The Flag button is now added to the table\")\n\n\n\n## Coding\n\nYou can view and download all files in the *Samples* in the Demo Kit at [Testing - Step 5](https://ui5.sap.com/#/entity/sap.m.tutorial.testing/sample/sap.m.tutorial.testing.05).\n\n\n\n## webapp/model/FlaggedType.js\n\n```js\nsap.ui.define([\n\t\"sap/ui/model/SimpleType\"\n], function (SimpleType) {\n\t\"use strict\";\n\treturn SimpleType.extend(\"sap.ui.demo.bulletinboard.model.FlaggedType\", {\n\t\t/**\n\t\t * Formats the integer value from the model to a boolean for the pressed state of the flagged button\n\t\t *\n\t\t * @public\n\t\t * @param {number} iFlagged the integer value of the formatted property\n\t\t * @returns {boolean} 1 means true, all other numbers means false\n\t\t */\n\t\tformatValue: function (iFlagged) {\n\t\t\treturn iFlagged === 1;\n\t\t},\n\t\t/**\n\t\t * Parses a boolean value from the property to an integer\n\t\t *\n\t\t * @public\n\t\t * @param {boolean} bFlagged true means flagged, false means not flagged\n\t\t * @returns {number} true means 1 , false means 0\n\t\t */\n\t\tparseValue: function (bFlagged) {\n\t\t\tif (bFlagged) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\treturn 0;\n\t\t},\n\t\t/**\n\t\t * Validates the value to be parsed\n\t\t *\n\t\t * @public\n\t\t * Since there is only true and false, no client side validation is required\n\t\t * @returns {boolean} true\n\t\t */\n\t\tvalidateValue: function () {\n\t\t\treturn true;\n\t\t}\n\n\t});\n});\n```\n\nLets start with the implementation code for the `FlaggedType`. We now add the documentation in JSDoc format and the implementation of the three functions of the data type to the previously empty stub:\n\n-   The `formatValue` function takes care of the conversion from the model to the UI. As specified in the tests, a model value of `1` will be converted to `true`, everything else to `false`. In the implementation code, this equals to `\"iFlagged === 1\"`.\n\n-   Similarly, the `parseValue` function is called by SAPUI5 when the data is written back to the model. Here, we convert the Boolean value to an integer again.\n\n-   The validation function always returns `true` in this simple case, we do not expect any validation errors for this data type.\n\n\nWe call these functions of the data type in the unit tests directly. So if you now run your unit tests by opening `webapp/test/testsuite.qunit.html` in your browser and select `unit/unitTests`, the tests should already run successfully.\n\n\n\n## webapp/view/Worklist.view.xml\n\n```xml\n…\n<Table …>\n\t…\n\t<columns>\n\t\t…\n\t\t<Column width=\"33%\" id=\"unitNumberColumn\" hAlign=\"End\" vAlign=\"Middle\">\n\t\t\t<Text text=\"{i18n>TableUnitNumberColumnTitle}\" id=\"unitNumberColumnTitle\"/>\n\t\t</Column>\n\t\t<Column width=\"80px\" id=\"flaggedColumn\" demandPopin=\"true\" vAlign=\"Middle\"/>\n\n\t</columns>\n\t<items>\n\t\t<ColumnListItem vAlign=\"Middle\">\n\t\t\t<cells>\n\t\t\t\t…\n\t\t\t\t<ObjectNumber… />\n\t\t\t\t<ToggleButton\n\t\t\t\t\tid=\"flaggedButton\"\n\t\t\t\t\ttooltip=\"{i18n>flaggedTooltip}\"\n\t\t\t\t\ticon=\"sap-icon://flag\"\n\t\t\t\t\tpressed=\"{\n\t\t\t\t\t\tpath: 'Flagged',\n\t\t\t\t\t\ttype: '.types.flagged'\n\t\t\t\t\t}\"\n\t\t\t\t\tclass=\"sapUiMediumMarginBeginEnd\"/>\n\n\t\t\t</cells>\n\t\t</ColumnListItem>\n\t</items>\n</Table>\n…\n```\n\nIn the view, we add a new column and a cell for the flag feature at the end of the table. We fill the cell with a `sap.m.ToggleButton` control that serves as our input control for the `Flagged` state. We define a `flag` icon in the button, a tooltip from the resource bundle, and a layouting class to make our example complete. The control's `pressed` property is bound to the `Flagged` field in the model. Here we also apply the custom data type that is part of the controller.\n\n\n\n## webapp/controller/Worklist.controller.js\n\n```js\nsap.ui.define([\n\t'./BaseController',\n\t'sap/ui/model/json/JSONModel',\n\t'../model/formatter',\n\t'../model/FlaggedType',\n\t'sap/m/library'\n], function (BaseController, JSONModel, formatter, FlaggedType, mobileLibrary) {\n\t\"use strict\";\n\treturn BaseController.extend(\"sap.ui.demo.bulletinboard.controller.Worklist\", {\n\t\ttypes : {\n\t\t\tflagged: new FlaggedType()\n\t\t},\n\t\tformatter: formatter,\n\t\t// …\n\t});\n});\n```\n\nThe controller loads the custom data type as a dependency similar to the formatters. It is then provided as a property of the internal variable `types` so that it can be accessed as `.types.flagged` in the view as we have seen above.\n\nThe conversion functions that are made available when we create an instance of the type are called automatically by SAPUI5 when needed. However, by default the back conversion to the model is not enabled, so we still need a small change in the component.\n\n\n\n## webapp/Component.js\n\n```js\nsap.ui.define([\n\t// …\n], function (UIComponent, ResourceModel, models) {\n\t\"use strict\";\n\treturn UIComponent.extend(\"sap.ui.demo.bulletinboard.Component\", {\n\t// …\n\t\tinit: function () {\n\t\t\t// call the base component's init function\n\t\t\tUIComponent.prototype.init.apply(this, arguments);\n\n\t\t\t// allow saving values to the OData model\n\t\t\tthis.getModel().setDefaultBindingMode(\"TwoWay\");\n\n\t\t\t// …\n\t\t}\n\t});\n});\n```\n\nTo enable the propagation of the bound view properties to the model, we need to set the model's default binding mode to `TwoWay`. For an OData model the default mode is `OneWay` which means that properties are not written back to the model automatically. We want to propagate the state of the button automatically to the model, when the button for a post is clicked.\n\n\n\n## webapp/i18n/i18n.properties\n\n```ini\n#~~~ Worklist View ~~~~~~~~~~~~~~~~~~~~~~~~~~\n\n…\n#XTOL: tooltip for the flagged button\nflaggedTooltip=Mark this post as flagged\n\n…\n```\n\nFinally, add the new string for the button tooltip to the resource bundle file. Now we can also test the application manually by calling the `webapp/test/mockServer.html` page and making sure some of the buttons are pressed initially as reflected in the model. When we flag an item by choosing the button, the property is written back to the model transparently.\n\n> ### Note:  \n> As this feature covers both conversion and interaction parts, we could also have written an integration test for it to test the interaction part also. Feel free to add an integration test for this feature if you like, we will skip it here to focus on unit testing in this step.\n\n**Related Information**  \n\n\n[Formatting, Parsing, and Validating Data](../04_Essentials/formatting-parsing-and-validating-data-07e4b92.md \"Data that is presented on the UI often has to be converted so that is human readable and fits to the locale of the user. On the other hand, data entered by the user has to be parsed and validated to be understood by the data source. For this purpose, you use formatters and data types.\")\n\n",
  "excerpt": "<!-- loio69a25bf2f8a2478cbda4b8bbe64039de --> Step 5: Adding a Flag Button Now that we have implemented the conversion tests, we add the corresponding functionality and show the button to flag a post ...",
  "wordCount": 990,
  "version": "1.0.0",
  "source": "sapui5",
  "sourceType": "github"
}