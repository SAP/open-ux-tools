
--------------------------------

**TITLE**: Actions — Annotation and Manifest Patterns for SAP Fiori Elements (OData V2 / V4)

**INTRODUCTION**: Practical, code-focused patterns and runnable examples for implementing generic and application-specific actions in SAP Fiori elements. Includes XML, ABAP/CAP CDS, manifest.json, and extension-function samples for: intent-based navigation, OData function-import actions (bound/unbound/static), invocation grouping, parameter defaults (including DefaultValuesFunction), parameter grouping/hiding, action groups (menus) and manifest overrides.

**TAGS**: fiori-elements, annotations, OData, UI.DataFieldForAction, UI.DataFieldForIntentBasedNavigation, DefaultValuesFunction, manifest.json, CAP, ABAP, XML, CDS

STEP: Intent-Based Navigation — Context-Independent (RequiresContext=false)
DESCRIPTION: Annotation examples for a context-independent external navigation button (UI.DataFieldForIntentBasedNavigation). The button is always enabled and available context is passed.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation (edmx) -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
  <PropertyValue Property="Label" String="Navigation Tester (no context required)"/>
  <PropertyValue Property="SemanticObject" String="Object"/>
  <PropertyValue Property="Action" String="Action"/>
  <PropertyValue Property="RequiresContext" Bool="false"/>
</Record>
```

LANGUAGE: CAP CDS
CODE:
```cds
// CAP CDS UI annotation
{
  $Type : 'UI.DataFieldForIntentBasedNavigation',
  Label : 'Navigation Tester (no context required)',
  SemanticObject : 'Object',
  Action : 'Action',
  RequiresContext : false
}
```

LANGUAGE: ABAP CDS
CODE:
```abap
// ABAP CDS (JSON-like annotation used in examples)
{
  label: 'Navigation Tester (no context required)',
  semanticObject: 'Object',
  semanticObjectAction: 'Action',
  requiresContext: false,
  type: #FOR_INTENT_BASED_NAVIGATION
}
```

STEP: Intent-Based Navigation — Context-Dependent (RequiresContext=true)
DESCRIPTION: Same as above but RequiresContext=true — button visible but only enabled after a user selects a context (table row).
LANGUAGE: XML
CODE:
```xml
<Record Type="UI.DataFieldForIntentBasedNavigation">
  <PropertyValue Property="Label" String="Navigation Tester (requires context)"/>
  <PropertyValue Property="SemanticObject" String="Object"/>
  <PropertyValue Property="Action" String="Action"/>
  <PropertyValue Property="RequiresContext" Bool="true"/>
</Record>
```

LANGUAGE: CAP CDS
CODE:
```cds
{
  $Type : 'UI.DataFieldForIntentBasedNavigation',
  Label : 'Navigation Tester (requires context)',
  SemanticObject : 'Object',
  Action : 'Action',
  RequiresContext : true
}
```

STEP: OData Action Button — InvocationGrouping (UI.DataFieldForAction)
DESCRIPTION: Grouping strategy for executing the same action on multiple selected items. Use InvocationGrouping to control whether requests are isolated or part of a single changeset/batch.
LANGUAGE: XML
CODE:
```xml
<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="Label" String="My Action"/>
  <PropertyValue Property="Action" String="YourService.Entities/C_MyFunctionImport"/>
  <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/Isolated"/>
</Record>
```

LANGUAGE: CAP CDS
CODE:
```cds
{
  $Type : 'UI.DataFieldForAction',
  Label : 'My Action',
  Action : 'YourService.Entities/C_MyFunctionImport',
  InvocationGrouping : #Isolated
}
```

LANGUAGE: ABAP CDS
CODE:
```text
// ABAP CDS example (conceptual): dataAction and invocationGrouping shown in docs
{
  label: 'My Action',
  dataAction: 'PUSHDOWN:C_MyFunctionImport',
  invocationGrouping: #ISOLATED,
  type: #FOR_ACTION
}
```

STEP: FunctionImport — Bound (Context-Dependent) vs Unbound (Context-Independent) (OData V2)
DESCRIPTION: Function import patterns — bound actions include sap:action-for and require a context; unbound do not. Use these in metadata and annotate UI.DataFieldForAction accordingly.
LANGUAGE: XML
CODE:
```xml
<!-- Bound Action (context-dependent): sap:action-for associates the action with an entity type -->
<FunctionImport
  Name="Setdisabledstatus"
  ReturnType="YourService.YourType"
  EntitySet="YourEntitySet"
  m:HttpMethod="POST"
  sap:action-for="YourService.YourType"
  sap:applicable-path="Setdisabledstatus_ac">
</FunctionImport>

<!-- Unbound Action (context-independent) -->
<FunctionImport
  Name="Create_simple"
  ReturnType="YourService.YourType"
  EntitySet="YourEntitySet"
  m:HttpMethod="POST" />
```

STEP: Annotate UI.DataFieldForAction for Bound and Unbound Actions
DESCRIPTION: How to reference bound and unbound actions from annotations/UI.
LANGUAGE: XML
CODE:
```xml
<!-- Bound action referenced as <SchemaNamespace>.<ActionName> -->
<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="Label" String="Reunion"/>
  <PropertyValue Property="Action" String="com.example.REUNION"/>
</Record>

<!-- Unbound action referenced as <SchemaNamespace>.<EntityContainer>/<ActionImportName> -->
<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="Label" String="Break Up"/>
  <PropertyValue Property="Action" String="com.example.Container/BREAK_ACTION"/>
</Record>
```

LANGUAGE: CAP CDS
CODE:
```cds
// CAP: bound action inside entity projection
entity MyEntity as projection on db.MyEntity {
  actions {
    action REUNION(_it: $self) returns MyEntity;
  }
}

// CAP: unbound action
action UnboundAction() returns MyEntity;

// CAP UI referencing (example)
{
  $Type: 'UI.DataFieldForAction',
  Label: 'Bound Action',
  Action: 'com.example.REUNION'
}
{
  $Type: 'UI.DataFieldForAction',
  Label: 'Unbound Action',
  Action: 'com.example.EntityContainer/UnboundAction'
}
```

STEP: Static Actions (Collection binding)
DESCRIPTION: Define static actions that are bound to the collection header context by using a Collection(...) type for the _it parameter.
LANGUAGE: XML
CODE:
```xml
<Action Name="createActiveTravel" EntitySetPath="_it" IsBound="true">
  <Parameter Name="_it" Type="Collection(com.example.TravelType)"/>
  <ReturnType Type="com.example.TravelType" Nullable="false"/>
</Action>

<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="Label" String="Static Action"/>
  <PropertyValue Property="Action" String="com.example.createActiveTravel(com.example.TravelService.Travel)"/>
</Record>
```

LANGUAGE: CAP CDS
CODE:
```cds
entity Travel as projection on db.Travel actions {
  action createActiveTravel (_it: many $self) returns Travel;
}

// UI Consumption
{
  $Type: 'UI.DataFieldForAction',
  Label: 'Static Action',
  Action: 'TravelService.createActiveTravel(TravelService.Travel)'
}
```

STEP: Action Parameters — Declaration and UI Annotations
DESCRIPTION: Define action parameters in metadata, annotate labels, mandatory behavior, and value help. Bound actions use binding parameter alias _it as first parameter.
LANGUAGE: XML
CODE:
```xml
<Action Name="CreateWithSalesOrderType" EntitySetPath="_it" IsBound="true">
  <Parameter Name="_it" Type="Collection(com.example.SalesOrderManageType)" Nullable="false"/>
  <Parameter Name="SalesOrderType" Type="Edm.String" Nullable="false" MaxLength="4"/>
  <Parameter Name="SalesOrganization" Type="Edm.String" Nullable="false" MaxLength="4"/>
  <ReturnType Type="com.example.SalesOrderManageType" Nullable="false"/>
</Action>

<!-- Parameter annotation for label and mandatory -->
<Annotations Target="SAP__self.CreateWithSalesOrderType/SalesOrderType">
  <Annotation Term="Common.Label" String="SalesOrder Type"/>
  <Annotation Term="Common.FieldControl" EnumMember="Common.FieldControlType/Mandatory"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
entity SalesOrderManage as projection on db.baseEntity actions {
  action CreateWithSalesOrderType(
    _it: $self,
    SalesOrderType        : sd.param.SalesOrderType        not null,
    SalesOrganization     : sd.param.SalesOrganization     not null
  ) returns SalesOrderManage;
}

// CAP UI grouping and parameter annotations use @UI annotations shown in later steps
```

STEP: Group Action Parameters in Dialog (OperationParameterFacets / FieldGroup)
DESCRIPTION: Group action parameters into titled sections in the action-parameter dialog using UI.OperationParameterFacets and UI.FieldGroup.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.example.CreateWithSalesOrderType(com.example.SalesOrderManage)">
  <Annotation Term="UI.OperationParameterFacets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="First Parameter Group"/>
        <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#FirstGroup"/>
      </Record>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Second Parameter Group"/>
        <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SecondGroup"/>
      </Record>
    </Collection>
  </Annotation>

  <Annotation Term="UI.FieldGroup" Qualifier="FirstGroup">
    <Record Type="UI.FieldGroupType">
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="UI.DataField"><PropertyValue Property="Value" Path="SalesOrderType"/></Record>
          <Record Type="UI.DataField"><PropertyValue Property="Value" Path="SalesOrganization"/></Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <Annotation Term="UI.FieldGroup" Qualifier="SecondGroup">
    <Record Type="UI.FieldGroupType">
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="UI.DataField"><PropertyValue Property="Value" Path="OrganizationDivision"/></Record>
          <Record Type="UI.DataField"><PropertyValue Property="Value" Path="DistributionChannel"/></Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
@UI.OperationParameterFacets: [
  { $Type: 'UI.ReferenceFacet', Label: 'First Parameter Group', Target: '@UI.FieldGroup#FirstGroup' },
  { $Type: 'UI.ReferenceFacet', Label: 'Second Parameter Group', Target: '@UI.FieldGroup#SecondGroup' }
]
@UI.FieldGroup#FirstGroup: {
  $Type: 'UI.FieldGroupType',
  Data: [
    { $Type: 'UI.DataField', Value: SalesOrderType },
    { $Type: 'UI.DataField', Value: SalesOrganization }
  ]
}
@UI.FieldGroup#SecondGroup: {
  $Type: 'UI.FieldGroupType',
  Data: [
    { $Type: 'UI.DataField', Value: OrganizationDivision },
    { $Type: 'UI.DataField', Value: DistributionChannel }
  ]
}
action CreateWithSalesOrderType( SalesOrderType: String not null, SalesOrganization: String not null, OrganizationDivision: String, DistributionChannel: String ) returns SalesOrderManage;
```

STEP: Parameter Default Values — UI.ParameterDefaultValue and FLP precedence
DESCRIPTION: Use UI.ParameterDefaultValue to prefill action parameters from a path or constant; ParameterDefaultValue takes precedence over FLP user defaults.
LANGUAGE: XML
CODE:
```xml
<!-- From table column: path-based default -->
<Annotations Target="SalesOrder.CreateWithSalesOrderType/SalesOrderType">
  <Annotation Term="UI.ParameterDefaultValue" Path="_it/SalesOrderType"/>
</Annotations>

<!-- Fixed default -->
<Annotations Target="SalesOrder.CreateWithSalesOrderType/SalesOrganization">
  <Annotation Term="UI.ParameterDefaultValue" String="0001"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cql
annotate SalesOrder.CreateWithSalesOrderType with {
  UI.ParameterDefaultValue : _it.SalesOrderType
  SalesOrderType
};
annotate SalesOrder.CreateWithSalesOrderType with {
  UI.ParameterDefaultValue : '0001'
  SalesOrganization
};
```

STEP: DefaultValuesFunction — Back-End (annotation + CAP service handler)
DESCRIPTION: Annotate an action with Common.DefaultValuesFunction to have the back end return default values used to prefill the action-parameter dialog. Include CAP srv handler example and function declaration sketch.
LANGUAGE: XML
CODE:
```xml
<!-- Annotate action (custom action) with DefaultValuesFunction -->
<Annotations Target="myService.CustomAction(myService.SalesOrderManage)">
  <Annotation Term="Common.DefaultValuesFunction" String="myService.GetDefaultParamsForCustomAction" />
</Annotations>

<!-- Standard create action annotated at entity level -->
<Annotations Target="myService.EntityContainer/SalesOrderManage">
  <Annotation Term="Common.DefaultValuesFunction" String="GetDefaultParamsForSalesOrderCreate" />
</Annotations>
```

LANGUAGE: CAP (service implementation)
CODE:
```javascript
// srv.js (CAP service handler) - returns default values object matching action parameter names
srv.on("GetDefaultParamsForCustomAction", "SalesOrderManage", async req => {
  const tx = cds.transaction(req);
  const salesOrderItem = await tx.run(SELECT.one.from(SalesOrderManage).where(req.query.SELECT.from.ref[0].where));
  if (!salesOrderItem) throw new Error("Not found");
  const overallSDProcessStatus = salesOrderItem.OverallSDProcessStatus;
  const currentDateTime = new Date().toISOString();

  return {
    OverallSDProcessStatus: overallSDProcessStatus,
    SalesOrderType: "SE",
    LastChangedDateTime: currentDateTime
  };
});
```

STEP: Default Values — Front-end override (manifest defaultValuesFunction + extension)
DESCRIPTION: Use manifest.json controlConfiguration defaultValuesFunction to call a front-end extension function that returns parameter defaults (overrides annotation/back-end defaults).
LANGUAGE: JSON
CODE:
```json
// manifest.json: register front-end defaultValuesFunction for a specific action
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "actions": {
                    "DataFieldForAction::com.example.CreateWithSalesOrderType": {
                      "defaultValuesFunction": "SalesOrder.ext.CustomActions.getDefaultValues"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// CustomActions.js: front-end extension function
getDefaultValues: function(oContext, aSelectedContexts) {
  if (aSelectedContexts.length > 1) {
    return { "SalesOrderType": "SO03", "SalesOrganization": "1111" };
  } else {
    return { "SalesOrderType": "SE", "SalesOrganization": "", "DistributionChannel": "03" };
  }
}
```

STEP: Hiding Action Parameters (UI.Hidden) — static and dynamic examples
DESCRIPTION: Use UI.Hidden to hide parameters using a boolean, a path, or a dynamic expression. If all parameters are hidden and mandatory parameters have defaults, the action executes without a dialog.
LANGUAGE: XML
CODE:
```xml
<Action Name="actionWithHiddenParameters" IsBound="true">
  <Parameter Name="_it" Type="YourService.LineItems"/>
  <Parameter Name="myParameterHiddenFalse" Type="Edm.String"/>
  <Parameter Name="myParameterHiddenTrue" Type="Edm.String"/>
  <Parameter Name="myParameterHiddenDynamicPath" Type="Edm.String"/>
  <Parameter Name="myParameterHiddenDynamicExp" Type="Edm.String"/>
</Action>

<!-- Static false / true -->
<Annotations Target="YourService.actionWithHiddenParameters(YourService.LineItems)/myParameterHiddenFalse">
  <Annotation Term="UI.Hidden" Bool="false"/>
</Annotations>
<Annotations Target="YourService.actionWithHiddenParameters(YourService.LineItems)/myParameterHiddenTrue">
  <Annotation Term="UI.Hidden" Bool="true"/>
</Annotations>

<!-- Dynamic via path -->
<Annotations Target="YourService.actionWithHiddenParameters(YourService.LineItems)/myParameterHiddenDynamicPath">
  <Annotation Term="UI.Hidden" Path="_it/preferredItem"/>
</Annotations>

<!-- Dynamic expression (If Eq ... ) -->
<Annotations Target="YourService.actionWithHiddenParameters(YourService.LineItems)/myParameterHiddenDynamicExp">
  <Annotation Term="UI.Hidden">
    <If>
      <Eq>
        <Path>myParameterHiddenFalse</Path>
        <String>Show myParameterHiddenDynamicExp parameter</String>
      </Eq>
      <Bool>false</Bool>
      <Bool>true</Bool>
    </If>
  </Annotation>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
@cds.odata.bindingparameter.name: '_it'
action actionWithHiddenParameters(
  @title : 'Testparameter (Hidden=false)'
  @UI.Hidden : false
  myParameterHiddenFalse : String,

  @title : 'Testparameter (Hidden=true)'
  @UI.Hidden : true
  myParameterHiddenTrue : String,

  @title : 'Testparameter (Hidden=Dynamic via path)'
  @UI.Hidden : _it.preferredItem
  myParameterHiddenDynamicPath : String,

  @title : 'Testparameter (Hidden=Dynamic via exp)'
  @UI.Hidden : {$edmJson: {$If: [{$Eq: [{$Path: 'myParameterHiddenFalse'}, 'Show myParameterHiddenDynamicExp parameter']}, false, true]}}
  myParameterHiddenDynamicExp : String
);
```

STEP: Group Actions into Menu Buttons (annotation-based DataFieldForActionGroup)
DESCRIPTION: Annotate an action group with DataFieldForActionGroup and list DataFieldForAction items. Use the annotated ID to reference/override via manifest (key: DataFieldForActionGroup::<ID>).
LANGUAGE: XML
CODE:
```xml
<edmx:Reference Uri="https://sap.github.io/odata-vocabularies/vocabularies/UI.xml">
  <edmx:Include Namespace="com.sap.vocabularies.UI.v1" Alias="UI"/>
</edmx:Reference>

<Record Type="UI.DataFieldForActionGroup">
  <PropertyValue Property="Label" String="Action Group"/>
  <PropertyValue Property="ID" String="groupedActions"/>
  <PropertyValue Property="Actions">
    <Collection>
      <Record Type="UI.DataFieldForAction">
        <PropertyValue Property="Label" String="Action 1"/>
        <PropertyValue Property="Action" String="com.example.Action1"/>
      </Record>
      <Record Type="UI.DataFieldForAction">
        <PropertyValue Property="Label" String="Action 2"/>
        <PropertyValue Property="Action" String="com.example.Action2"/>
      </Record>
      <Record Type="UI.DataFieldForAction">
        <PropertyValue Property="Label" String="Action 3"/>
        <PropertyValue Property="Action" String="com.example.Action3"/>
      </Record>
    </Collection>
  </PropertyValue>
</Record>
```

LANGUAGE: CAP CDS
CODE:
```cds
{
  $Type  : 'UI.DataFieldForActionGroup',
  Label  : 'Action Group',
  ID     : 'groupedActions',
  Actions: [
    { $Type: 'UI.DataFieldForAction', Label: 'Action 1', Action: 'com.example.Action1' },
    { $Type: 'UI.DataFieldForAction', Label: 'Action 2', Action: 'com.example.Action2' },
    { $Type: 'UI.DataFieldForAction', Label: 'Action 3', Action: 'com.example.Action3' }
  ]
}
```

STEP: Menu Buttons — Manifest-based grouping and defaultAction
DESCRIPTION: Examples to group header/form/table actions into a menu via manifest and define a defaultAction (click triggers it directly).
LANGUAGE: JSON
CODE:
```json
// Sample manifest entry for object page header actions (grouping and menu)
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "content": {
        "header": {
          "actions": {
            "myFirstAction": {
              "press": "SalesOrder.ext.CustomActions.message",
              "text": "My First Action"
            },
            "mySecondAction": {
              "press": "SalesOrder.ext.CustomActions.message",
              "text": "My Second Action"
            },
            "MenuActions": {
              "text": "My Menu Button",
              "menu": [
                "myFirstAction",
                "mySecondAction",
                "DataFieldForAction::com.example.BoundActionWithParams"
              ]
            }
          }
        }
      }
    }
  }
}

// Default action example (manifest)
"MenuActionsCreateFromTemplate": {
  "text": "Usage Example of a defaultAction",
  "defaultAction": "DataFieldForIntentBasedNavigation::SalesOrder::defaultActionToBeCalled",
  "menu": [
    "DataFieldForAction::com.example.CreateFromCustomer",
    "DataFieldForAction::com.example.CreateFromSalesOrder",
    "DataFieldForIntentBasedNavigation::SalesOrder::manageInline"
  ]
}
```

STEP: Overriding Annotation-Based Actions via manifest (controlConfiguration)
DESCRIPTION: Override visibility/enabled or change behavior of annotation-based actions via manifest controlConfiguration (note: annotation logic may be ignored when overridden). Provide sample CustomActions.js handlers.
LANGUAGE: JSON
CODE:
```json
"controlConfiguration": {
  "@com.sap.vocabularies.UI.v1.LineItem": {
    "actions": {
      "DataFieldForAction::com.example.CreateWithSalesOrderType": {
        "enabled": "SalesOrder.ext.CustomActions.enabledIfTwoSelected",
        "visible": "SalesOrder.ext.CustomActions.visibleIfAConditionIsTrue"
      }
    }
  }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// CustomActions.js: handlers referenced in manifest overrides
enabledIfTwoSelected: function (oBindingContext, aSelectedContexts) {
  return aSelectedContexts && aSelectedContexts.length === 2;
},
visibleIfAConditionIsTrue: function (oBindingContext, aSelectedContexts) {
  // Return boolean based on oBindingContext or aSelectedContexts
  return true; // implement your logic
}
```

STEP: Modify Action Groups via manifest (add / remove / override items)
DESCRIPTION: Use DataFieldForActionGroup::<ID> key to override group menu list. To add actions include both existing and new actions; to remove actions only list the ones to keep.
LANGUAGE: JSON
CODE:
```json
// Example: Add myFirstAction to an existing annotation-based action group
"options": {
  "settings": {
    "contextPath": "/SalesOrderManage",
    "controlConfiguration": {
      "@com.sap.vocabularies.UI.v1.FieldGroup#OrderData": {
        "actions": {
          "myFirstAction": {
            "press": "SalesOrder.ext.CustomActions.getCustomerName",
            "visible": true,
            "enabled": true,
            "text": "My First Action"
          },
          "DataFieldForActionGroup::groupedActions": {
            "menu": [
              "DataFieldForAction::com.example.Action1",
              "DataFieldForAction::com.example.Action2",
              "DataFieldForAction::com.example.Action3",
              "myFirstAction",
              "DataFieldForAction::com.example.AnnotationAction"
            ]
          }
        }
      }
    }
  }
}
```

STEP: OData V4 — OperationAvailable for Enablement and Core.OperationAvailable path
DESCRIPTION: Use Core.OperationAvailable to control enablement dynamically (Boolean true = always enabled; path = evaluate per context). Caution: do not set to false — remove action instead.
LANGUAGE: XML
CODE:
```xml
<!-- Always enabled -->
<Annotations Target="MyService.CreateWithSalesOrderType">
  <Annotation Term="Core.OperationAvailable" Bool="true"/>
</Annotations>

<!-- Dynamic enablement via path -->
<Annotations Target="MyService.CreateWithSalesOrderType">
  <Annotation Term="Core.OperationAvailable" Path="Delivered"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cql
// CAP annotate example
annotate MyService.CreateWithSalesOrderType with {
  Core.OperationAvailable : true
};

annotate MyService.CreateWithSalesOrderType with {
  Core.OperationAvailable : Delivered
};
```

STEP: File Upload as Action Parameter (reference)
DESCRIPTION: To accept uploaded files as action parameters (bound or unbound), enable stream support and configure action parameter accordingly. See enabling-stream-support-b236d32.md for details and the subsection "File Upload as an Action Parameter".
LANGUAGE: TEXT
CODE:
```text
See documentation: enabling-stream-support-b236d32.md#loiob236d32d48b74304887b3dd5163548c1__subsection_upload_attribute
// Follow the "File Upload as an Action Parameter" subsection to configure UI and service streaming.
```

STEP: Notes and Best Practices (short checklist)
DESCRIPTION: Actionable guidelines to apply while implementing actions.
LANGUAGE: TEXT
CODE:
```text
- Use RequiresContext=true for intent navigation buttons requiring explicit selection.
- For action parameter defaults: evaluation order = UI.ParameterDefaultValue -> FLP user defaults -> Common.DefaultValuesFunction -> front-end defaultValuesFunction (manifest).
- Use InvocationGrouping to control parallel vs transactional execution for multi-select actions.
- Hide action parameters via UI.Hidden; if all parameters hidden and mandatory parameters have defaults, dialog is skipped.
- Use DataFieldForActionGroup::<ID> as manifest key to override annotation group.
- Avoid setting Core.OperationAvailable to false; remove action from metadata instead.
```

--------------------------------

**TITLE**: Actions in the List Report — concrete implementation patterns and snippets

**INTRODUCTION**: Quick, code-focused guide to implement and configure actions in SAP Fiori Elements List Report (table toolbar and global). Includes XML and CAP CDS annotation samples for Copy and Create controls, manifest.json settings for Create via newAction (OData V2), parameter dialog title, i18n keys, and OData V4 draft NewAction behavior and OperationAvailable rules. Use these snippets directly in your metadata and manifest.

**TAGS**: fiori-elements-framework, list-report, actions, annotations, odata-v2, odata-v4, manifest.json, CDS, UI.LineItem

STEP: Define a copy action in the table toolbar (XML Annotation)
DESCRIPTION: Add a DataFieldForAction entry in the UI.LineItem annotation and mark it as the copy action using UI.IsCopyAction. This renders a Copy button (placed automatically after Create). Provide an Action path and optional Label. If no Label is provided, default label "Copy" is used.
LANGUAGE: XML
CODE:
```xml
<!-- Add to your Service metadata annotations (XML) -->
<Annotation Term="UI.LineItem">
  <Collection>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy" />
      <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy" />
      <Annotation Term="UI.IsCopyAction" Bool="true" />
    </Record>
    <!-- other line item fields/actions -->
  </Collection>
</Annotation>
```

STEP: Define a copy action in CAP CDS (CDS annotation)
DESCRIPTION: Equivalent CAP CDS snippet to create a DataFieldForAction marked as IsCopyAction. Use this inside the UI.LineItem section of an entity's CDS UI annotations.
LANGUAGE: CDS
CODE:
```cds
// In your .cds file (UI annotations)
annotate MyService.MyEntity with {
  @UI.LineItem : [
    {
      $Type : 'UI.DataFieldForAction',
      Label : 'Copy',
      Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy',
      ![@UI.IsCopyAction] : true
    },
    // other line items
  ]
};
```

STEP: Enable Create action via newAction (OData V2, draft-enabled) — metadata annotation
DESCRIPTION: When using draft-enabled OData V2 and you want Create to trigger a function import instead of a default POST, define Common.DraftRoot.NewAction in the service metadata. This sample shows adding NewAction to DraftRoot.
LANGUAGE: XML
CODE:
```xml
<!-- In your service metadata annotations (XML) -->
<Annotation Term="Common.DraftRoot">
  <Record>
    <PropertyValue Property="NewAction"
                   String="cds_zrc_ce_localized_srv.cds_zrc_ce_localized_srv_Entities/Create"/>
  </Record>
</Annotation>
```

STEP: Configure manifest to use newAction for Create (OData V2)
DESCRIPTION: Enable the manifest setting useNewActionForCreate for the ListReport component to call the function import defined in DraftRoot.NewAction when the Create button is used.
LANGUAGE: JSON
CODE:
```json
// manifest.json (fragment)
{
  "sap.ui5": {
    "routing": { /* routing config */ },
    "models": { /* models */ },
    "componentUsages": { /* optional */ }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "useNewActionForCreate": true
          }
        },
        "entitySet": "Localized",
        "id": "ListReport|Localized"
      }
    ]
  }
}
```

STEP: Define parameter dialog title for function-import Create (OData V2)
DESCRIPTION: When NewAction (or any function import) has parameters, annotate the FunctionImport with Common.Label to set the dialog title shown when Create opens the parameter dialog. If missing, the i18n key DIALOG_TITLE_NEW_ACTION_FOR_CREATE is used.
LANGUAGE: XML
CODE:
```xml
<!-- Annotation for the FunctionImport to set dialog title -->
<Annotations Target="SAP.FCLM_BAM_ACCOUNTWD_SRV_Entities/FunctionImportName">
  <Annotation Term="Common.Label" String="Create"/>
</Annotations>
```

STEP: Override localized texts (i18n keys)
DESCRIPTION: Use these i18n keys in your app’s i18n.properties to override dialog and button texts for the Create/newAction flow:
- DIALOG_TITLE_NEW_ACTION_FOR_CREATE — title of the parameter dialog (default used if annotation missing)
- CREATE_OBJECT — label of the toolbar Create button (default "Create")
- DIALOG_ACTION_BUTTON_NEW_ACTION_FOR_CREATE — label of the action button inside the dialog (default "Continue")
LANGUAGE: properties
CODE:
```properties
# i18n.properties (example overrides)
DIALOG_TITLE_NEW_ACTION_FOR_CREATE=Create New Localized Entry
CREATE_OBJECT=New
DIALOG_ACTION_BUTTON_NEW_ACTION_FOR_CREATE=Proceed
```

STEP: Standard Delete and Create actions (guidance)
DESCRIPTION: Generic actions available automatically when entity set supports them:
- Create: enabled when entity set is creatable. For OData V2 without newAction, a POST is sent by default. Draft-enabled apps can use newAction as shown above.
- Delete: supported when entity set is deletable. Place Delete on table toolbar or line item actions.
For adding app-specific or table toolbar actions refer to the app extension points or UI annotations (UI.LineItem DataFieldForAction).

LANGUAGE: Text
CODE:
```text
- Ensure the EntitySet in metadata has sap:creatable="true" to enable Create (OData V2).
- Ensure EntitySet has delete capabilities to enable Delete.
- Add UI.DataFieldForAction entries to UI.LineItem for actions to appear in row inline or table toolbar depending on configuration.
```

STEP: Create behavior for OData V4 (draft-based) — metadata annotation
DESCRIPTION: For OData V4 draft-based apps, Create is enabled when DraftRoot.NewAction exists. Provide DraftRoot properties (NewAction, PreparationAction, EditAction, ActivationAction) in the Common.DraftRoot annotation. InsertRestrictions on the entity set are ignored if NewAction is present. Control Create visibility via OperationAvailable (true/false). Rules:
- OperationAvailable=false => Create button not displayed.
- OperationAvailable=true or unspecified => Create button displayed.
- OperationAvailable=null => ignored (treated as not specified).
LANGUAGE: XML
CODE:
```xml
<!-- OData V4 draft root (XML annotation in service metadata) -->
<Annotation Term="Common.DraftRoot">
  <Record Type="Common.DraftRootType">
    <PropertyValue Property="ActivationAction" String="com.c_salesordermanage_sd.draftActivate" />
    <PropertyValue Property="EditAction" String="com.c_salesordermanage_sd.draftEdit" />
    <PropertyValue Property="PreparationAction" String="com.c_salesordermanage_sd.draftPrepare" />
    <PropertyValue Property="NewAction" String="com.c_salesordermanage_sd.ReturnInProcess" />
  </Record>
</Annotation>
```

STEP: Action types and UI behavior (implementation guidance)
DESCRIPTION: When defining app-specific actions, choose the behavior and implement accordingly:
- Confirmation-required: Open a confirmation dialog before executing action (add dialog in controller or via extension point).
- Input-required: Open a parameter dialog (define function import with parameters or implement custom dialog).
- No extra input: Trigger action directly (DataFieldForAction without parameters).
- External navigation: Configure navigation target in manifest or use Navigation action handlers.
LANGUAGE: Text
CODE:
```text
Implementation patterns:
- Use UI.DataFieldForAction for toolbar/row actions.
- For confirmation dialogs: implement controller extension or use action extension that returns a confirmation.
- For input dialogs: expose function import with parameters and annotate Common.Label for title; system will open parameter dialog if applicable.
- For external navigation: implement action handler that invokes cross-app navigation or external URL.
```

STEP: References / Next steps (where to add code)
DESCRIPTION: Insert the XML annotation snippets into your service metadata annotations (annotation file or EDMX). Insert CDS snippet into your CAP .cds files. Update manifest.json at the UI application's root manifest.json. Add i18n keys to i18n.properties. Use List Report component settings under sap.ui.generic.app/pages as shown in the manifest snippet.
LANGUAGE: Text
CODE:
```text
Files to update:
- service metadata annotations: annotations.xml or <service>.edmx
- CAP project: .cds files for annotations (e.g., srv/cat-service.cds)
- UI project: webapp/manifest.json
- UI project: i18n/i18n.properties
```
--------------------------------

**TITLE**: Add a "Filter Price" Button to List Report Table Toolbar (Adaptation Extension)

**INTRODUCTION**: This example shows how to add a UI adaptation fragment (button) to the table toolbar in an SAP Fiori elements List Report (OData V2). The button triggers a controller-extension function that restricts table results to records with Price >= 1000 by adding a filter via the template extension API.

**TAGS**: fiori-elements-framework, adaptation, extension, odata-v2, list-report, fragment, controller-extension, toolbar

**STEP**: Prerequisites

**DESCRIPTION**: Confirm your app uses SAP Fiori elements for OData V2 and you have completed the steps in "Extending Delivered Apps Using Adaptation Extensions". All extensibility operations in this example are performed using the UI adaptation tool.

**LANGUAGE**: text

**CODE**:
```text
Prerequisite: Fiori elements OData V2 app and completed "Extending Delivered Apps Using Adaptation Extensions".
```

**STEP**: Create UI Adaptation Fragment (FilterPriceButton.fragment.xml)

**DESCRIPTION**: In the adaptation editor:
- Select the table toolbar and choose "Add Fragment".
- Set Target Aggregation = content and choose index (or Create New).
- Create fragment name: FilterPriceButton
- Edit the generated FilterPriceButton.fragment.xml and add a Button that points to the extension controller function.

Note: The press handler string must follow the UI adaptation format:
".extension.<ProjectName>.<ControllerExtensionName>.<FunctionName>"
Example used here:
".extension.ProdMan.AdaptProject.ListReportExtension.handleFilterPricePress"

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File name: FilterPriceButton.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
  <Button
    id="PriceBtnID"
    text="Filter Price"
    press=".extension.ProdMan.AdaptProject.ListReportExtension.handleFilterPricePress" />
</core:FragmentDefinition>
```

**STEP**: Create Controller Extension (ListReportExtension.js)

**DESCRIPTION**: In the adaptation editor:
- Select the table toolbar and choose "Extend with Controller".
- Enter controller name: ListReportExtension and choose Extend.
- The system generates ListReportExtension.js. Replace its contents (or paste) with the code below.
- Implementation details:
  - handleFilterPricePress is a custom function that sets iPriceRestriction and triggers rebind via the extension API.
  - The addFilters method is provided as an extension hook (templateBaseExtension.addFilters). It will be called by the framework when building filters for the table. It uses sap.ui.model.Filter with operator "GE" on property "Price".

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File name: ListReportExtension.js
/**
 * Controller extension for List Report - adds a button to filter Price >= 1000
 *
 * @controller Name: sap.suite.ui.generic.template.ListReport.view.ListReport
 * @viewId: STTA_MP::sap.suite.ui.generic.template.ListReport.view.ListReport::STTA_C_MP_Product
 */
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/ui/core/mvc/ControllerExtension"
], function (Controller, ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("ProdMan.AdaptProject.ListReportExtension", {

    /**
     * Custom handler for the fragment button press.
     * Sets a price restriction and rebinds the table via the template extension API.
     */
    handleFilterPricePress: function () {
      // set the price threshold used by the addFilters hook
      this.iPriceRestriction = "1000";

      // get extension API and trigger table rebind
      var oExtensionAPI = this.base.templateBaseExtension.getExtensionAPI();
      oExtensionAPI.rebindTable();
    },

    // Override block: override lifecycle hooks and template extension hooks here
    override: {
      onInit: function () {
        // optional initialization logic
      },

      onBeforeRendering: function () {
        // optional before-rendering logic
      },

      onAfterRendering: function () {
        // optional after-rendering logic
      },

      onExit: function () {
        // cleanup logic
      },

      // Template extension hooks used by SAP Fiori elements
      "templateBaseExtension": {
        /**
         * addFilters is called by the framework when building filters for the table.
         * If iPriceRestriction is set, add a "Price GE <iPriceRestriction>" filter.
         *
         * @param {function} fnAddFilter - framework callback to add a filter. Usage: fnAddFilter(thisController, oFilter)
         * @param {string} sControlId - control id (not used here)
         */
        addFilters: function (fnAddFilter, sControlId) {
          if (this.iPriceRestriction) {
            fnAddFilter(this, new sap.ui.model.Filter("Price", "GE", this.iPriceRestriction));
          }
        }
      }
    }
  });
});
```

**STEP**: Preview and Test

**DESCRIPTION**: In the adaptation editor choose the Preview tab and click Go. Verify:
- Initially, the table shows all records (check Price column values).
- Click the "Filter Price" button added to the toolbar.
- Confirm the table is re-bound and only records with Price >= 1000 are shown.
--------------------------------

**TITLE**: Implementing beforeSaveExtension to Run Logic Before Save (SAP Fiori Elements)

**INTRODUCTION**: Use the beforeSaveExtension controller extension to execute custom logic immediately before the framework starts a save operation. Return a Promise to delay the save until the Promise resolves (continue) or rejects (cancel). If no value is returned, the framework proceeds with the save without waiting.

**TAGS**: sapui5, fiori-elements, beforeSaveExtension, ObjectPage, controller-extension, OData, V2, V4, promise

**STEP**: 1 — Add beforeSaveExtension to the ObjectPage controller extension

**DESCRIPTION**: Implement beforeSaveExtension in your ObjectPage controller extension. Return a Promise when you need to perform asynchronous work (user confirmation, validations, additional server calls). Resolve the Promise to continue the save; reject the Promise to cancel it. If you do not return a Promise, the save proceeds immediately.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: Controller extension file (e.g., ext/ComponentControllerExtension.js)
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/m/Dialog",
  "sap/m/Text",
  "sap/m/Button"
], function(Controller, Dialog, Text, Button) {
  "use strict";

  return Controller.extend("my.namespace.ObjectPageExtension", {
    /**
     * This hook is called by the framework just before save.
     * Return a Promise to delay/approve/cancel the save.
     *
     * For draft apps: called once when saving root object page.
     * For non-draft: called for saves from any object page.
     *
     * @returns {Promise|undefined}
     */
    beforeSaveExtension: function() {
      var fnResolve, fnReject;
      var oPromise = new Promise(function(resolve, reject) {
        fnResolve = resolve;
        fnReject = reject;
      });

      this._oBeforeSaveDialog = new Dialog({
        title: "Confirm Save",
        content: new Text({
          text: "Do you want to continue and save changes?"
        }),
        beginButton: new Button({
          text: "Continue to Save",
          press: function() {
            fnResolve(); // let framework proceed with save
            this._oBeforeSaveDialog.close();
          }.bind(this)
        }),
        endButton: new Button({
          text: "Cancel Save",
          press: function() {
            fnReject(); // cancel the save operation
            this._oBeforeSaveDialog.close();
          }.bind(this)
        }),
        afterClose: function() {
          this._oBeforeSaveDialog.destroy();
          this._oBeforeSaveDialog = null;
        }.bind(this)
      });

      this.getView().addDependent(this._oBeforeSaveDialog);
      this._oBeforeSaveDialog.open();

      return oPromise;
    }
  });
});
```

**STEP**: 2 — Minimal synchronous implementation (do not delay save)

**DESCRIPTION**: If you do not need to delay the save, implement beforeSaveExtension without returning a Promise. The framework will start the save immediately.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
beforeSaveExtension: function() {
  // Perform quick synchronous checks/updates.
  // Do not return a Promise if you want save to proceed immediately.
  this._updateLocalModelFlags();
  // no return -> framework continues with save without waiting
}
```

**STEP**: 3 — Notes about behavior and documentation links

**DESCRIPTION**: Important behavior differences and references:
- Draft applications: beforeSaveExtension is called once while saving the root object page.
- Non-draft applications: beforeSaveExtension is called for save operations from any object page.
- If the extension returns a Promise, the framework waits for it to resolve/reject before continuing.
- If the extension does not return anything, save starts immediately.

**LANGUAGE**: Text/Links

**CODE**:
```text
Reference (OData V2 Demo Kit):
https://ui5.sap.com/#/api/sap.suite.ui.generic.template.ObjectPage.controllerFrameworkExtensions/methods/sap.suite.ui.generic.template.ObjectPage.controllerFrameworkExtensions.beforeSaveExtension

For OData V4 guidance see:
Using Custom Code Before Standard Operations (local doc):
using-custom-code-before-standard-operations-877e5ff.md
```
--------------------------------

**TITLE**: Customize Confirmation Dialog Texts for Deleting Table Lines (SAP Fiori Elements)

**INTRODUCTION**: Quick, code-focused guide to override default confirmation and result texts shown when deleting table rows in SAP Fiori Elements apps. Covers OData V2 (annotation-driven LineItem) and OData V4 (allowed resource keys + manifest enhancement). Includes exact i18n key formats, sample property entries, and manifest changes.

**TAGS**: sap-fiori, fiori-elements, i18n, manifest, ODataV2, ODataV4, delete, confirmation, properties

STEP: OData V2 — i18n key format and example entries
DESCRIPTION: For OData V2 object pages, provide custom texts in your app i18n file using the key pattern:
<i18n_Key>|<EntitySet>|<navigationProperty>|com.sap.vocabularies.UI.v1.LineItem[|<qualifier>]
Add the property lines to your app resource bundle (e.g. i18n/i18n.properties or i18n/custom.properties). Example shows overriding the confirmation text for the LineItem annotation and for a qualified annotation.
LANGUAGE: properties
CODE:
```properties
# File: i18n/custom.properties (or i18n/i18n.properties depending on your project)
# Format:
# <KEY>|<EntitySet>|<navigationProperty>|com.sap.vocabularies.UI.v1.LineItem[|<qualifier>]=<custom text>

# Example (no qualifier)
DELETE_SELECTED_ITEM|STTA_C_MP_Product|to_ProductText|com.sap.vocabularies.UI.v1.LineItem=Delete this row?

# Example (with qualifier)
DELETE_SELECTED_ITEM|STTA_C_MP_Product|to_ProductText|com.sap.vocabularies.UI.v1.LineItem|MyQualifier=Delete this row (qualified)?
```

STEP: OData V2 — Common delete-related keys (copy/update these strings)
DESCRIPTION: Common default keys used by Fiori Elements for delete confirmations, success and error texts. Copy and adapt these into your app resource bundle (same file as above) with localization text you need.
LANGUAGE: properties
CODE:
```properties
# Delete confirmation and result messages (OData V2)
DELETE_SELECTED_ITEM=Delete the selected item?
DELETE_SELECTED_ITEMS=Delete the selected items?

DELETE_SUCCESS_PLURAL_WITH_COUNT={0} items have been deleted.
DELETE_SUCCESS_WITH_COUNT={0} item has been deleted.

DELETE_ERROR_PLURAL_WITH_COUNT={0} items cannot be deleted.
DELETE_ERROR_WITH_COUNT={0} item cannot be deleted.

DELETE_ERROR_PLURAL=The selected items cannot be deleted.
DELETE_ERROR=The selected item cannot be deleted.

DELETE_SUCCESS_PLURAL=The selected items have been deleted.
ITEM_DELETED=Item deleted

DELETE_UNDELETABLE_ITEMS={0} of {1} items cannot be deleted.
```

STEP: OData V4 — Allowed override keys (list of keys to place in custom i18n)
DESCRIPTION: For OData V4, only a defined set of keys can be overridden. Add these keys to your custom resource bundle (e.g. i18n/customSalesOrderLR.properties). Use the exact key names below and optionally append an entitySet (see later steps).
LANGUAGE: properties
CODE:
```properties
# File: i18n/customSalesOrderLR.properties (OData V4 custom bundle)
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR=Delete this object?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_UNSAVED_CHANGES=Another user edited this object without saving the changes:{0} Delete anyway?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_UNSAVED_CHANGES_MULTIPLE_OBJECTS=Other users have edited the selected objects without saving the changes. Delete anyway?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL=Delete the selected objects?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_NON_DELETABLE={0} of {1} objects cannot be deleted.
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_LOCKED={0} of {1} objects are currently locked.
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_UNSAVED_AND_FEW_OBJECTS_LOCKED_SINGULAR=The remaining object has unsaved changes. Do you still want to delete it?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_UNSAVED_AND_FEW_OBJECTS_LOCKED_PLURAL=The remaining objects have unsaved changes. Do you still want to delete them?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_UNSAVED_SINGULAR=Also delete object with unsaved changes?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_UNSAVED_PLURAL=Also delete objects with unsaved changes?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_LOCKED_AND_NON_DELETABLE={0} out of {2} objects cannot be deleted. {1} of {2} objects are currently locked.
```

STEP: Manifest change for OData V4 — enable custom resource bundle
DESCRIPTION: Add "enhanceI18n" under the target component options -> settings to point Fiori Elements to your custom resource bundle. Use the relative path inside your app (e.g. i18n/customSalesOrderLR.properties).
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "id": "my.app.id"
  },
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "type": "Component",
          "id": "SalesOrderManageList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/SalesOrderManage",
              "enhanceI18n": "i18n/customSalesOrderLR.properties"
            }
          }
        }
      }
    }
  }
}
```

STEP: Example pair — default keys in Fiori Elements and custom override in app bundle (OData V4)
DESCRIPTION: Example showing how default keys map to custom bundle entries when appended with the entitySet.
LANGUAGE: properties
CODE:
```properties
# Default keys in Fiori Elements (no entity set appended, internal bundle)
# C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL=Delete the selected objects?
# C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR=Delete this object?

# Custom overrides in i18n/customSalesOrderLR.properties (application bundle)
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL|SalesOrderManage=Do you want to delete the selected Sales Orders?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR|SalesOrderManage=Do you want to delete this Sales Order?
```

STEP: Key naming rules and examples (shared vs entity-specific vs action-specific)
DESCRIPTION: Rules and concrete examples to override keys correctly:
- If a resource is global/shared across entities/controls, keep the original key (no suffix).
- If the resource must differ per entity set, append |<EntitySet> to the key.
- For action confirmation popovers that accept parameters, append |<EntitySet>|<ActionName>.
Provide examples below.
LANGUAGE: properties
CODE:
```properties
# Shared resource override (global)
C_COMMON_DIALOG_OK=Okie?

# Entity-specific override (append entity set name)
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR|_Items=Do you want to delete this Sales Order Item?

# Action-confirmation override (must include entity set and action name)
C_OPERATIONS_ACTION_CONFIRM_MESSAGE|SalesOrderManage|ReturnInProcess=Can you please confirm if you really want to trigger the returns?

# If same action name used for different entity sets, append different entitySet
C_OPERATIONS_ACTION_CONFIRM_MESSAGE|_Items|ReturnInProcess=Can you please confirm if you really want to trigger the returns for the chosen items?
```

STEP: Full example — manifest and custom bundle for a List Report (end-to-end)
DESCRIPTION: Minimal working example: manifest target + custom property file content for SalesOrderManage target overriding delete confirmation and action confirm messages.
LANGUAGE: JSON + properties
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "type": "Component",
          "id": "SalesOrderManageList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/SalesOrderManage",
              "enhanceI18n": "i18n/customSalesOrderLR.properties"
            }
          }
        }
      }
    }
  }
}
```

```properties
# File: i18n/customSalesOrderLR.properties
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL|SalesOrderManage=Do you want to delete the selected Sales Orders?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR|SalesOrderManage=Do you want to delete this Sales Order?

# Example action confirmation override for a specific action and entity set
C_OPERATIONS_ACTION_CONFIRM_MESSAGE|SalesOrderManage|ReturnInProcess=Can you please confirm if you really want to trigger the returns?
```


--------------------------------

**TITLE**: Customize Delete Dialog Text on Object Page Header (Fiori elements, OData V2)

**INTRODUCTION**: This guide shows how to adapt the title and text of the Delete confirmation dialog that appears when the Delete button is used in the Object Page header of an SAP Fiori elements (OData V2) app. It covers manifest registration of the controller extension and three implementation patterns for beforeDeleteExtension() in the controller extension.

**TAGS**: fiori-elements-framework, OData V2, extensionAPI, manifest.json, controller extension, delete dialog

**STEP**: Prerequisites and cautions

**DESCRIPTION**: This customization applies only to SAP Fiori elements for OData V2. Use app extensions only if manifest settings or annotations cannot produce the required behavior. When writing extensions, use only the official extensionAPI of SAP Fiori elements and avoid manipulating internal controls/models created by the framework.

**LANGUAGE**: Text

**CODE**:
```text
- Applicable to: SAP Fiori elements for OData V2 only.
- Use only extensionAPI functions (e.g., this.extensionAPI.securedExecution).
- Do not access/manipulate internal controls, properties, or models created by the Fiori elements framework.
```

**STEP**: Register controller extension in manifest.json

**DESCRIPTION**: Add a controller extension entry for the Object Page Details controller in your app descriptor (manifest.json). This registers the custom controller that will implement beforeDeleteExtension().

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "controllerName": "MY_APP.ext.controller.DetailsExtension"
          }
        }
      }
    }
  }
}
```

File: manifest.json (root of your application)

**STEP**: Add controller extension file to your app

**DESCRIPTION**: Create the controller extension file at the path matching the controllerName in the manifest. The file should implement beforeDeleteExtension() and return an object with title and text (or a Promise resolving to that object). Example file path: webapp/ext/controller/DetailsExtension.controller.js. (Project tree illustration referenced: images/AppExtensionTree_ObjectPage_318f52b.png)

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/controller/DetailsExtension.controller.js
sap.ui.define([], function() {
  "use strict";

  return {
    /**
     * Called before the standard Delete dialog is shown.
     * Must return either:
     *  - an object { title: "...", text: "..." }
     *  - a Promise resolving to that object
     *  - a securedExecution call that returns a Promise resolving to that object
     */
    beforeDeleteExtension: function() {
      var oMessageText = {
        title: "My title",
        text: "My text"
      };
      return oMessageText;
    }
  };
});
```

**STEP**: Return a Promise from beforeDeleteExtension

**DESCRIPTION**: If your logic is asynchronous, return a Promise that resolves to the message object. Use Promise.resolve for simple cases.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Promise-based variant (same file: webapp/ext/controller/DetailsExtension.controller.js)
sap.ui.define([], function() {
  "use strict";

  return {
    beforeDeleteExtension: function() {
      var oMessageText = {
        title: "My title",
        text: "My text"
      };
      return Promise.resolve(oMessageText);
    }
  };
});
```

**STEP**: Use extensionAPI.securedExecution when needed

**DESCRIPTION**: For operations that must be executed within the Fiori elements secured context (recommended when performing framework-related tasks), use this.extensionAPI.securedExecution and return a Promise that resolves to the message object.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// securedExecution variant (same file: webapp/ext/controller/DetailsExtension.controller.js)
sap.ui.define([], function() {
  "use strict";

  return {
    beforeDeleteExtension: function() {
      var oMessageText = {
        title: "My title",
        text: "My text"
      };

      // this.extensionAPI is provided by the Fiori elements runtime in controller extensions
      return this.extensionAPI.securedExecution(function() {
        return new Promise(function(resolve) {
          // perform any async operations here
          resolve(oMessageText);
        });
      });
    }
  };
});
```

**STEP**: Required return structure

**DESCRIPTION**: Ensure the resolved value from beforeDeleteExtension (synchronous or Promise) is an object with these properties:
- title: string (always shown)
- text: string (always shown)

**LANGUAGE**: JSON

**CODE**:
```json
{
  "title": "Custom dialog title",
  "text": "Custom dialog text shown to the user"
}
```
--------------------------------

**TITLE**: Adapt Delete Dialog Text for Nested Smart Table on Object Page (Fiori elements, OData V2)

**INTRODUCTION**: Show how to register and implement an app controller extension that customizes the Delete confirmation dialog text for a nested Smart Table on an Object Page in SAP Fiori elements (OData V2). Includes manifest registration, controller file location, and three implementation variants: synchronous, Promise-based, and securedExecution.

**TAGS**: fiori-elements, odata-v2, extensionAPI, controller-extension, smart-table, object-page, delete-dialog

**STEP**: 1 — Preconditions and Caution

**DESCRIPTION**: Notes you must consider before implementing the extension. This feature applies only to SAP Fiori elements for OData V2. Use app extensions only when manifest settings or annotations cannot achieve the required behavior. Integrate only via the extensionAPI; do not manipulate internal framework controls or models directly.

**LANGUAGE**: Text

**CODE**:
```text
- Applicable only to SAP Fiori elements for OData V2.
- Use extensionAPI functions only. Do not directly access or manipulate internal controls/models created by the framework.
- The oBeforeLineItemDeleteProperties object (argument to beforeLineItemDeleteExtension) contains:
    - sUiElementId: identifies the UI element (nested Smart Table) from which items are deleted.
    - other properties related to selected items (framework-specific).
- Return:
    - undefined / nothing => framework uses default dialog text
    - an object => framework uses its title/text/undeletableText fields
    - a Promise resolving to that object is also accepted
```

**STEP**: 2 — Register controller extension in manifest.json

**DESCRIPTION**: Add a controller extension entry for the Object Page Details view in your app descriptor (manifest.json). Replace controllerName with your extension module name (match file path in your project).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "controllerName": "MY_APP.ext.controller.DetailsExtension"
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Create controller extension file

**DESCRIPTION**: Add the controller extension module that exports the beforeLineItemDeleteExtension function. Place the file to match the controllerName from manifest.json. Example path: webapp/ext/controller/DetailsExtension.controller.js and module name MY_APP.ext.controller.DetailsExtension.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/controller/DetailsExtension.controller.js
sap.ui.define([], function() {
    "use strict";
    return {
        /**
         * beforeLineItemDeleteExtension hook
         * @param {object} oBeforeLineItemDeleteProperties - properties for the delete operation
         *   Example important property:
         *     sUiElementId: string identifying the nested Smart Table UI element
         * @returns {object|Promise<object>|undefined} - message text or a Promise resolving to it
         */
        beforeLineItemDeleteExtension: function(oBeforeLineItemDeleteProperties) {
            // implement variants in following steps
        }
    };
});
```

**STEP**: 4 — Variant A: Simple synchronous customization (return object)

**DESCRIPTION**: Check the sUiElementId to ensure you customize the intended nested Smart Table only. Return an object with fields title, text, undeletableText. If you return nothing (undefined), the framework uses default text.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Synchronous return variant
beforeLineItemDeleteExtension: function(oBeforeLineItemDeleteProperties) {
    // Match the nested Smart Table UI element id (use the actual id in your app)
    if (oBeforeLineItemDeleteProperties.sUiElementId !==
        "My_APP::sap.suite.ui.generic.template.ObjectPage.view.Details::MY_EntitySet--to_NavProperty::com.sap.vocabularies.UI.v1.LineItem::Table") {
        // Not the target table: do nothing and keep default behavior
        return;
    }

    // Provide custom dialog texts
    var oMessageText = {
        title: "Confirm deletion",
        text: "Are you sure you want to delete the selected items?",
        undeletableText: "Some selected items cannot be deleted."
    };
    return oMessageText;
}
```

**STEP**: 5 — Variant B: Promise-based customization (async operations)

**DESCRIPTION**: If you need asynchronous logic before returning the dialog text (for example, fetch translations, call a service), return a Promise that resolves to the message object.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Promise-based variant
beforeLineItemDeleteExtension: function(oBeforeLineItemDeleteProperties) {
    if (oBeforeLineItemDeleteProperties.sUiElementId !==
        "My_APP::sap.suite.ui.generic.template.ObjectPage.view.Details::MY_EntitySet--to_NavProperty::com.sap.vocabularies.UI.v1.LineItem::Table") {
        return;
    }

    var oMessageText = {
        title: "Confirm deletion (async)",
        text: "This text was prepared asynchronously.",
        undeletableText: "Async: some items cannot be deleted."
    };

    // Example: wrap in a resolved Promise (replace with real async work as needed)
    return Promise.resolve(oMessageText);
}
```

**STEP**: 6 — Variant C: Use extensionAPI.securedExecution for secured async logic

**DESCRIPTION**: Use extensionAPI.securedExecution when your asynchronous logic must be executed in the framework's secured context (recommended for operations touching navigation, busy handling, or other framework integration points). Use this.extensionAPI.securedExecution inside the controller extension (this is provided by Fiori elements).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// securedExecution variant (inside the same controller extension)
beforeLineItemDeleteExtension: function(oBeforeLineItemDeleteProperties) {
    if (oBeforeLineItemDeleteProperties.sUiElementId !==
        "My_APP::sap.suite.ui.generic.template.ObjectPage.view.Details::MY_EntitySet--to_NavProperty::com.sap.vocabularies.UI.v1.LineItem::Table") {
        return;
    }

    var oMessageText = {
        title: "Confirm deletion (secured)",
        text: "This text was prepared inside securedExecution.",
        undeletableText: "Secured: some items cannot be deleted."
    };

    // Use the framework-provided securedExecution wrapper
    return this.extensionAPI.securedExecution(function() {
        return new Promise(function(resolve /*, reject */) {
            // perform secured async tasks, then resolve with the message object
            // ... e.g., fetch translations, checks, etc.
            resolve(oMessageText);
        });
    });
}
```

**STEP**: 7 — Important implementation notes

**DESCRIPTION**: Summary of behaviors and usage patterns to integrate correctly.

**LANGUAGE**: Text

**CODE**:
```text
- The object returned (or resolved) must contain any of these fields the framework uses:
    - title (string)         -> always shown
    - text (string)          -> always shown
    - undeletableText (string) -> shown only if one or more selected items are not deletable (deletablePath feature)
- Ensure the sUiElementId string matches the nested Smart Table id in your app. If mismatched, your extension will not be applied.
- Returning undefined or not returning anything => default framework dialog text is used.
- Use this.extensionAPI.securedExecution for framework-integrated async operations. See framework docs for securedExecution details.
- Do not directly access or manipulate internal controls or models created by the Fiori elements framework.
```
--------------------------------

**TITLE**: Adapting Delete Dialog Texts via List Report Controller Extension (SAP Fiori elements, OData V2)

**INTRODUCTION**: Show how to register a controller extension for a List Report and implement beforeDeleteExtension to customize the Delete confirmation dialog texts (title, text, unsavedChanges, undeletableText). Includes manifest registration, controller file location, and three implementation patterns: synchronous return, Promise, and using extensionAPI.securedExecution. Applicable to SAP Fiori elements for OData V2 only. Use extensionAPI only; do not access internal framework controls or models.

**TAGS**: fiori-elements, list-report, delete-dialog, extension, beforeDeleteExtension, manifest, controller-extension, ODataV2

**STEP**: 1 — Register the controller extension in the app descriptor (manifest.json)

**DESCRIPTION**: Add the controller extension mapping under "extends" → "extensions" → "sap.ui.controllerExtensions" and point the List Report view to your extension controllerName. Place this snippet in your webapp/manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "controllerName": "MY_APP.ext.controller.ListReportExtension"
        }
      }
    }
  }
}
```

**STEP**: 2 — Create the controller extension file

**DESCRIPTION**: Create the controller implementation at the controllerName namespace referenced in manifest.json. Typical file path: webapp/ext/controller/ListReportExtension.controller.js. Export a controller object that implements beforeDeleteExtension: function(oBeforeDeleteProperties) { ... }.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/controller/ListReportExtension.controller.js
sap.ui.define([
    "sap/ui/core/mvc/Controller"
], function(Controller) {
    "use strict";

    return Controller.extend("MY_APP.ext.controller.ListReportExtension", {

        /**
         * beforeDeleteExtension hook
         * @param {object} oBeforeDeleteProperties - information about the selected items for deletion
         * @returns {object|Promise<object>} message text object or Promise resolving to it
         *
         * The message object shape:
         * {
         *   title: "string",           // always shown
         *   text: "string",            // always shown
         *   unsavedChanges: "string",  // shown unless selection meets specific unsaved/locked/deletable rules (see docs)
         *   undeletableText: "string"  // shown only if one or more selected items cannot be deleted using deletablePath and you provide this property
         * }
         */
        beforeDeleteExtension: function(oBeforeDeleteProperties) {
            // Inspect oBeforeDeleteProperties to adapt message based on selection
            // Example synchronous return below (see other patterns for Promise / securedExecution)
            var oMessageText = {
                title: "Confirm Delete",
                text: "Are you sure you want to delete the selected items?",
                unsavedChanges: "Some selected items have unsaved changes.",
                undeletableText: "Some selected items cannot be deleted."
            };
            return oMessageText;
        }

    });
});
```

**STEP**: 3 — Example: Return a resolved Promise (asynchronous)

**DESCRIPTION**: If your logic is asynchronous (e.g., needs additional checks), return a Promise that resolves to the message object.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
beforeDeleteExtension: function(oBeforeDeleteProperties) {
    var oMessageText = {
        title: "Confirm Delete",
        text: "Are you sure you want to delete the selected items?",
        unsavedChanges: "Some selected items have unsaved changes.",
        undeletableText: "Some selected items cannot be deleted."
    };
    return Promise.resolve(oMessageText);
}
```

**STEP**: 4 — Example: Use extensionAPI.securedExecution for secured async operations

**DESCRIPTION**: Use this.extensionAPI.securedExecution when you need to run secured asynchronous code (for example, to preserve framework busy handling/security). Return the securedExecution call which itself returns a Promise resolving to the message object.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
beforeDeleteExtension: function(oBeforeDeleteProperties) {
    var oMessageText = {
        title: "Confirm Delete",
        text: "Are you sure you want to delete the selected items?",
        unsavedChanges: "Some selected items have unsaved changes.",
        undeletableText: "Some selected items cannot be deleted."
    };

    // securedExecution takes a callback that can return a Promise or value
    return this.extensionAPI.securedExecution(function() {
        return new Promise(function(resolve) {
            // perform async checks, then resolve with the message object
            // ... async logic here ...
            resolve(oMessageText);
        });
    });
}
```

**STEP**: 5 — Rules for which message properties appear in the dialog

**DESCRIPTION**: Use these rules to decide which properties to set in the returned object.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "title": "always appears",
  "text": "always appears",
  "unsavedChanges": "appears except in the following cases: \
    1) Only selected items with editing status 'unsavedChanges' \
    2) Only items with 'unsavedChanges' and 'locked' \
    3) Only items with 'unsavedChanges' and items not deletable by deletablePath \
    4) Only items with 'unsavedChanges', 'locked', and not deletable by deletablePath \
    5) Only items that are both 'unsavedChanges' and not deletable by deletablePath",
  "undeletableText": "appears only if one or more selected items cannot be deleted using deletablePath and you provide this property"
}
```

**STEP**: 6 — Important notes and restrictions

**DESCRIPTION**: Action-oriented reminders to follow when implementing extensions.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "notes": [
    "Applicable only to SAP Fiori elements for OData V2.",
    "Use app extensions only when manifest settings or annotations cannot achieve the required behavior.",
    "Use only the extensionAPI of SAP Fiori elements. Do NOT access or manipulate internal framework controls, models, or properties.",
    "oBeforeDeleteProperties contains information about the selected items for deletion; inspect it to customize messages."
  ]
}
```
--------------------------------

**TITLE**: Adapting the Filter Bar for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: Action-oriented reference for adapting the filter bar using manifest.json, annotations and controller extensions. Covers: including navigation properties in the Adapt Filters dialog (V2 & V4), case-insensitive filtering via FilterFunctions (V4), adding a Clear button and custom clear logic, and moving filter fields to the Adapt Filters dialog.

**TAGS**: fiori-elements-framework, filter-bar, manifest.json, odata-v2, odata-v4, sapui5, annotations, navigation-properties, case-insensitive-filtering, smart-filter-bar

**STEP**: 1 — Include Navigation Properties in Adapt Filters (OData V2)

**DESCRIPTION**: By default (SAPUI5 >= 1.126.0) the Adapt Filters dialog only shows properties from the main entity set. To add navigation properties (either a single property or all filterable properties of a navigation target), add a navigationProperties array to the filterSettings of the ListReport entry in manifest.json. Paths are relative to the main entity set. If you point to a navigation or complex property, all simple properties of that type are added (except those annotated Hidden/HiddenFilter). If you point to a specific simple property on the navigation, only that field is added.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "ListReport|C_STTA_SalesOrder_WD_20": {
    "entitySet": "C_STTA_SalesOrder_WD_20",
    "component": {
      "name": "sap.suite.ui.generic.template.ListReport",
      "list": true,
      "settings": {
        "tableSettings": {
          ...
        },
        "filterSettings": {
          "navigationProperties": [
            "to_Supplier/EmailAddress",
            "to_DeliveryStatus"
          ]
        }
      }
    }
  }
}
```

**STEP**: 2 — Include Navigation Properties in Adapt Filters (OData V4 / SelectionFields)

**DESCRIPTION**: For OData V4, the filter bar shows fields defined in @com.sap.vocabularies.UI.v1.SelectionFields. To include navigation properties only for adaptation (Adapt Filters dialog), add a navigationProperties array inside the controlConfiguration/@com.sap.vocabularies.UI.v1.SelectionFields entry in manifest.json. Behavior:
- Path to navigation or complex type => all simple properties of that target are added (unless Hidden/HiddenFilter).
- Path to a simple property on a navigation => that single property is added (unless Hidden/HiddenFilter).
- Only one-level navigation properties are supported (no nested navigation).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "ListReport": {
    "options": {
      "settings": {
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.SelectionFields": {
            "navigationProperties": ["_DistributionChannel", "_Partner/FullName"]
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Configure Case-Insensitive Filtering (OData V4 via FilterFunctions)

**DESCRIPTION**: Case sensitivity is primarily determined by the back end (RAP: case-insensitive at DB level; CAP Node/Java: case-sensitive by default). To instruct SAP Fiori elements whether functions like tolower are supported, declare Org.OData.Capabilities.V1.FilterFunctions on the EntityContainer in your service metadata (annotation XML). SAP Fiori elements will set caseSensitive for client-side filtering depending on whether tolower exists. This affects: Filter bar, table personalization filters, filters from semantic keys, and value help dialogs.

- If tolower exists in the annotation => caseSensitive = false (backend expected to compare using lowercase).
- If tolower does not exist => caseSensitive = true (backend decides default).
- If no annotation is configured => caseSensitive = false (fallback: expect lowercase conversion).

Provide the FilterFunctions annotation in the service metadata/annotations XML.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="namespace.EntityContainer">
  <Annotation Term="Org.OData.Capabilities.V1.FilterFunctions">
    <Collection>
      <!-- include supported filter function names -->
      <String>tolower</String>
      <!-- other functions if supported -->
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 4 — Add a Clear Button to the Filter Bar (manifest.json)

**DESCRIPTION**: Enable the built-in Clear button for the filter bar by setting showClearButton: true in the controlConfiguration/@com.sap.vocabularies.UI.v1.SelectionFields section of the ListReport manifest entry. Clicking Clear will remove all filter values (not restore default values). If Editing Status is active, it resets to All.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageList": {
    "options": {
      "settings": {
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.SelectionFields": {
            "showClearButton": true
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Extend Clear Behavior with Controller Extension (onAfterClear)

**DESCRIPTION**: Implement the controller extension hook onAfterClear to run custom logic after the Clear button is pressed (e.g., reset a custom UI control). Add this method in your controller extension file.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
onAfterClear: function (oEvent) {
  var oView = this.getView();
  // Example: reset a custom segmented button on the view
  oView.byId("CustomSegmentedButton").setSelectedKey("none");
}
```

**STEP**: 6 — Move Explicit Filter Fields to the Adapt Filters Dialog

**DESCRIPTION**: To move an explicitly included filter field from the compact filter bar into the Adapt Filters dialog (so it is available only in Adaptation), set availability: "Adaptation" for that field under controlConfiguration/@com.sap.vocabularies.UI.v1.SelectionFields/filterFields in manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageList": {
    "options": {
      "settings": {
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.SelectionFields": {
            "filterFields": {
              "postingDate": {
                "availability": "Adaptation"
              }
            }
          }
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: UI Adaptation for SAP Fiori Elements (OData V2 & V4) — manifest.json Configuration Examples

**INTRODUCTION**: Quick, code-focused reference for enabling UI adaptation (design-time and runtime key-user adaptation) and applying common configuration settings in webapp/manifest.json for SAP Fiori elements apps (OData V2 and OData V4). Includes sample manifest fragments for enabling flex/UI adaptation, variant management, initial load behaviour, filter bar, tables and personalization options. Use these snippets as copy/paste starting points and adapt paths / component names to your project template.

**TAGS**: fiori-elements-framework, ui-adaptation, key-user, manifest.json, sapui5, odata-v2, odata-v4, variant-management, table-personalization

STEP: 1 — Enable UI Adaptation (SAPUI5 Flexibility)
DESCRIPTION: Turn on SAPUI5 flexibility so key-user UI adaptation and adaptation projects can be used. Add flexEnabled in webapp/manifest.json under sap.ui5. This is required for runtime key-user changes and for adaptation projects to take effect.
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json
{
  "sap.ui5": {
    "flexEnabled": true,
    "models": {
      "": {
        "dataSource": "mainService"
      }
    }
  }
}
```

STEP: 2 — Fiori Elements OData V2: List Report & Object Page sample settings
DESCRIPTION: Example manifest.json fragments for SAP Fiori Elements for OData V2. These fragments are typically placed under sap.ui.generic.app/pages[].component.settings (adjust index/path to match your project pages array). Settings shown: variantManagement, initialLoad, openInEditMode, filter bar navigation properties, and table-related controls (selection mode, create mode, condensed layout, select-all, thresholds).
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (fragment for OData V2 List Report / Object Page)
// Place under "sap.ui.generic.app" -> "pages" -> your page -> "component" -> "settings"
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "variantManagement": "Page",        // "Page" | "Control"
            "initialLoad": "Auto",             // "Auto" | "Enabled" | "Disabled"
            "hideVariantManagement": false,
            "filterSettings": {
              "navigationProperties": [
                "Category", "Supplier"
              ],
              "enableDateRange": true         // semantic date range semantics (if supported)
            },
            "tableSettings": {
              "selectionMode": "Multi",        // "Single" | "Multi"
              "createMode": "Inline",          // "NewPage" | "Inline" | "InlineCreationRows" | "InlineCreationRows(HiddenInEditPage)"
              "condensedTableLayout": false,
              "widthIncludingColumnHeader": true,
              "enableSelectAll": true,
              "selectionLimit": 100,
              "scrollThreshold": 20,
              "threshold": 200,
              "hideAddCardToInsights": true
            },
            "openInEditMode": false
          }
        }
      },
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "editableHeaderContent": true,
            "tableVariantManagement": true,
            "chartVariantManagement": true,
            "showRelatedApps": true
          }
        }
      }
    ]
  }
}
```

STEP: 3 — Fiori Elements OData V4: List Report, Object Page, Filter Bar & Table configuration
DESCRIPTION: Example manifest.json fragments for SAP Fiori Elements for OData V4 (sap.fe templates). These settings are applied in the manifest and are applied when a key user activates a new version (app reload). Adjust the paths/keys to match your project structure; the example uses "sap.fe.templates".
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (fragment for OData V4 — sap.fe templates)
{
  "sap.ui5": {
    "flexEnabled": true
  },
  "sap.fe": {
    "templates": {
      "ListReport": {
        "variantManagement": "Page",        // "Page" | "Control" | "None"
        "initialLoad": "Auto"               // "Auto" | "Enabled" | "Disabled"
      },
      "FilterBar": {
        "displayClearButton": true,
        "useSemanticDateRange": true
      },
      "ObjectPage": {
        "table": {
          "tableVariantManagement": true
        }
      },
      "Table": {
        "enableExport": true,
        "frozenColumnCount": 1,
        "personalization": {
          "enabled": true,
          "ownSettings": {
            "sorting": true,
            "columns": true,
            "filtering": true,
            "grouping": true
          }
        },
        "rowCount": 25,
        "condensedTableLayout": false,
        "widthIncludingColumnHeader": true,
        "selectAll": true,
        "selectionLimit": 50,
        "enableAddCardToInsights": false
      }
    }
  }
}
```

STEP: 4 — Table Personalization: enable/own-settings example (V4)
DESCRIPTION: Configure fine-grained table personalization. Use "personalization": { "enabled": true } to enable general personalization or "ownSettings" to enable a subset (Sorting, Columns, Filtering, Grouping).
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (table personalization fragment)
{
  "sap.fe": {
    "templates": {
      "Table": {
        "personalization": {
          "enabled": true,
          "ownSettings": {
            "sorting": true,
            "columns": true,
            "filtering": true,
            "grouping": true
          }
        }
      }
    }
  }
}
```

STEP: 5 — Runtime behavior & best practices
DESCRIPTION: Key-user runtime adaptation notes to implement in your app processes:
- When a key user enters adaptation mode, the app starts in a fresh state; changes are not preserved in the internal runtime state until the user activates them.
- When the key user exits adaptation mode without activating, the app restores to the state it had before adaptation.
- For OData V4, manifest.json changes created by key users are applied to the app manifest and the application reloads when a new version is activated.
- Do not embed iframes in Fiori Elements for OData V2 applications when relying on UI adaptation (not recommended).
LANGUAGE: JSON
CODE:
```json
// No code change required. These are runtime/behavioral guidelines to follow during development and testing.
{}
```

STEP: 6 — References & where to apply (paths and components)
DESCRIPTION: Common file targets for the snippets above:
- webapp/manifest.json — primary target for all shown fragments.
- For OData V2 (Fiori elements V2): place configuration under "sap.ui.generic.app" -> "pages" -> [page] -> "component" -> "settings".
- For OData V4 (Fiori elements V4): place configuration under "sap.fe" -> "templates" (or under framework-specific configuration used by your project).
LANGUAGE: JSON
CODE:
```json
// Example root file path reference (no change required in code)
{
  "fileTargets": [
    "webapp/manifest.json"
  ],
  "notes": [
    "Adjust the exact JSON path depending on your project template (ListReport / ObjectPage component names and structure).",
    "Ensure sap.ui5.flexEnabled is true to allow flexibility adaptations."
  ]
}
```
--------------------------------

**TITLE**: Analytical List Page (ALP) UI Adaptation — actionable manifest and flex change examples

**INTRODUCTION**: Practical, copy-pasteable examples that show how to adapt the Analytical List Page (Fiori elements, OData V2) UI via manifest.json settings and example UI adaptation (flex) change snippets. Use these snippets to: collapse or freeze the filter bar, enable/disable variant management and share, configure chart options (ignored chart types, selection mode, buttons), configure table options (export, scroll threshold, remember selections), change column properties, and tweak Visual Filters dialog buttons.

**TAGS**: fiori-elements, analytical-list-page, ALP, manifest.json, ui-adaptation, ui5, sap.ui.generic.app, chart, table, flex, sap.ui.fl

STEP: 1 — Configure ALP page-level settings in manifest.json
DESCRIPTION: Add or update the page entry for the Analytical List Page in manifest.json. This controls header/filter-bar behavior, variant management settings and top-level chart/table settings.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "YourEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "headerExpanded": false,                    // collapse/hide smart filter bar by default
            "preserveHeaderStateOnScroll": true,        // freeze filter bar on scroll
            "variants": {
              "showSetAsDefault": true,                 // allow users to set default variant
              "showShare": true                         // allow users to share variants
            },
            "chart": {
              "selectionMode": "Multi",                 // Single, Multi, None
              "ignoredChartTypes": "pie,donut",         // comma-separated values to hide
              "showChartTooltip": true,
              "showChartTypeSelectionButton": true,
              "showDownloadButton": true,
              "showLegendButton": true,
              "noData": "No chart data available"       // override no data text
            },
            "table": {
              "enableExport": false,                    // hide Export to Excel button
              "scrollThreshold": 500,                   // dynamically loaded records threshold (default 300)
              "rememberSelections": false,              // whether row selection persists after refresh
              "personalisation": {
                "visible": true                         // show Table personalization (Settings) icon
              }
            },
            "footer": {
              "visible": true                            // show or hide page footer
            },
            "tableToolbar": {
              "visible": true                            // show or hide table toolbar
            },
            "share": {
              "visible": true                            // show or hide Share icon
            },
            "clearButton": {
              "visible": true                            // show/hide Clear button on header area (if applicable)
            }
          }
        }
      }
    ]
  }
}
```

STEP: 2 — Chart: ignored chart types and available type tokens
DESCRIPTION: Use ignoredChartTypes (comma-separated) to hide chart types from the type selector. The example below shows how to hide pie and donut charts. Use the token list to form values.
LANGUAGE: JSON
CODE:
```json
{
  "chart": {
    "ignoredChartTypes": "pie,donut,waterfall" // tokens: bar, column, line, combination, pie, donut, scatter, bubble,
                                                // heatmap, bullet, vertical_bullet, stacked_bar, stacked_column,
                                                // stacked_combination, horizontal_stacked_combination,
                                                // dual_bar, dual_column, dual_line, dual_stacked_bar,
                                                // dual_stacked_column, dual_combination, dual_stacked_combination,
                                                // dual_horizontal_combination, dual_horizontal_stacked_combination,
                                                // 100_stacked_bar, 100_stacked_column, 100_dual_stacked_bar,
                                                // 100_dual_stacked_column, waterfall, horizontal_waterfall
  }
}
```

STEP: 3 — Chart: toolbar / button visibility (example manifest extension)
DESCRIPTION: Turn on/off chart toolbar buttons (chart type selection, download, legend). Use these settings inside the ALP page component "settings.chart".
LANGUAGE: JSON
CODE:
```json
{
  "chart": {
    "showChartTypeSelectionButton": true,
    "showDownloadButton": true,
    "showLegendButton": true,
    "showChartTooltip": true,
    "selectionMode": "Single" // "Single" | "Multi" | "None"
  }
}
```

STEP: 4 — Table settings: export, dynamic loading, and rememberSelections
DESCRIPTION: Example of toggling Export to Excel, changing scroll threshold for dynamic record loading, and controlling row-selection persistence.
LANGUAGE: JSON
CODE:
```json
{
  "table": {
    "enableExport": false,        // false: hide Export to Excel button
    "scrollThreshold": 300,       // default is 300; raise/lower as required
    "rememberSelections": false,  // true: selections persist after refresh
    "personalisation": {
      "visible": true             // Show/hide Settings icon for table personalization
    }
  }
}
```

STEP: 5 — Column-level UI Adaptation: example flex change to hide a column
DESCRIPTION: Example flex (UI adaptation) change that sets a column property (visible = false). Replace selector.id with your control id (component-specific). This is the structure used for runtime UI adaptation changes (sap.ui.fl).
LANGUAGE: JSON
CODE:
```json
{
  "changeType": "propertyChange",
  "layer": "CUSTOMER",
  "selector": {
    "id": "Component---YourComponentName---YourListView--responsiveTable::TableColumn::YourColumnProperty",
    "type": "sap.m.Column"
  },
  "content": {
    "property": "visible",
    "value": false
  },
  "texts": {}
}
```

STEP: 6 — Column-level UI Adaptation: set width, resizable and autoResizable
DESCRIPTION: Flex change example to set width/resizable/autoResizable on a smart table column. Adjust selector.id to target the specific column.
LANGUAGE: JSON
CODE:
```json
{
  "changeType": "propertyChange",
  "layer": "CUSTOMER",
  "selector": {
    "id": "Component---YourComponent---YourListView--smartTable::columns::YourColumn",
    "type": "sap.ui.table.Column"
  },
  "content": {
    "properties": {
      "width": "200px",
      "resizable": true,
      "autoResizable": false,
      "inResult": true,      // ensure column is included in aggregation/query
      "showSortMenuEntry": true,
      "sorted": true,
      "sortOrder": "Descending", // "Ascending" | "Descending"
      "summed": false
    }
  },
  "texts": {}
}
```

STEP: 7 — Visual Filters dialog: change a button (visible, text, icon)
DESCRIPTION: Example flex change to update a Visual Filter dialog button (visibility, text, icon). Replace id with the control id of the visual filter button or microchart.
LANGUAGE: JSON
CODE:
```json
{
  "changeType": "propertyChange",
  "layer": "CUSTOMER",
  "selector": {
    "id": "Component---YourComponent---YourListView--visualFilterDialog--YourFilterButton",
    "type": "sap.m.Button"
  },
  "content": {
    "properties": {
      "visible": true,
      "text": "My Filter",
      "icon": "sap-icon://filter",
      "busy": false,
      "enabled": true,
      "blocked": false
    }
  },
  "texts": {}
}
```

STEP: 8 — Chart toolbar: drill-down visibility toggle example
DESCRIPTION: Example to enable/disable a chart drill-down button in the chart toolbar (adapt per control id).
LANGUAGE: JSON
CODE:
```json
{
  "changeType": "propertyChange",
  "layer": "CUSTOMER",
  "selector": {
    "id": "Component---YourComponent---YourListView--chartToolbar--btnDrillDown",
    "type": "sap.m.Button"
  },
  "content": {
    "properties": {
      "visible": true
    }
  },
  "texts": {}
}
```

STEP: 9 — Practical notes and quick mapping
DESCRIPTION: Quick mapping and reminders when applying these changes programmatically or via UI adaptation tool:
- Put manifest.json settings under the Analytical List Page component entry inside "sap.ui.generic.app" -> "pages" -> component.settings.
- Use the UI Adaptation (Runtime Adaptation / App Variants) to create flex changes; the JSON shape above is the typical change body (changeType propertyChange). Replace selector ids with actual runtime control ids.
- ignoredChartTypes accepts comma-separated tokens (see token list in Step 2).
- Column-level properties (visible, width, autoResizable, resizable, inResult, showSortMenuEntry, sorted, sortOrder, summed) are applied per column via UI Adaptation (flex) or annotation-driven configuration where supported.

LANGUAGE: None
CODE:
```text
Replace placeholder ids and entity names:
- YourEntitySet
- YourComponent / YourListView
- Column and button selectors must be resolved from your app's runtime control ids or by inspecting the UI in the UI adaptation editor.
```

--------------------------------

**TITLE**: Adapting List Report and Object Page UI (Fiori elements, OData V2)

**INTRODUCTION**: This reference provides concise, code-focused examples and manifest/fragment snippets to adapt common UI properties for List Report and Object Page pages in SAP Fiori elements (OData V2). Use these snippets to update XML fragments or manifest.json entries when you cannot or prefer not to use the Page Editor. Each STEP lists the property, where to set it, and a minimal code example.

**TAGS**: fiori-elements, ui5, odata-v2, list-report, object-page, manifest, xml, smarttable, objectpage

STEP: 1 — Toggle Export to Excel on SmartTable (List Report)
DESCRIPTION: Enable or disable the Export to Excel button for a smart table. Can be set directly in the SmartTable XML or as property in the fragment/view.
LANGUAGE: XML
CODE:
```XML
<!-- Fragment / view containing a SmartTable -->
<smartTable:SmartTable
  id="STable"
  entitySet="Products"
  useTablePersonalisation="true"
  enableExport="true"
  tableType="ResponsiveTable"
  showRowCount="true"
  xmlns:smartTable="sap.ui.comp.smarttable">
</smartTable:SmartTable>
```

STEP: 2 — Toggle Export to Excel in manifest.json (List Report / Object Page table node)
DESCRIPTION: Example manifest snippet where a table node configuration includes enableExport. Place under the relevant page/component config used by your app (sap.ui.generic.app pages or component settings).
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "tableSettings": {
              "enableExport": true
            }
          }
        }
      }
    ]
  }
}
```

STEP: 3 — Set Column Width in XML column definition (custom column in fragment)
DESCRIPTION: Set width for a specific column. For custom columns, set directly inside the fragment.
LANGUAGE: XML
CODE:
```XML
<!-- sap.m.Column inside a table definition -->
<Table id="myTable" class="sapUiResponsiveTable" >
  <columns>
    <Column id="colProduct" width="12rem">
      <Text text="Product" />
    </Column>
    <!-- custom column -->
    <Column id="colCustom" width="8rem">
      <Text text="Custom" />
    </Column>
  </columns>
</Table>
```

STEP: 4 — Center-align status column (hAlign on Column)
DESCRIPTION: Set horizontal alignment for a column (status column).
LANGUAGE: XML
CODE:
```XML
<Column id="colStatus" hAlign="Center">
  <Text text="Status" />
</Column>
```

STEP: 5 — Disable dynamic page fitContent (prevent table from occupying entire container)
DESCRIPTION: Set DynamicPage fitContent property to false in XML or fragment to avoid full-height stretching for analytical/grid/tree tables.
LANGUAGE: XML
CODE:
```XML
<DynamicPage id="DP" fitContent="false" xmlns="sap.f">
  <header />
  <content>
    <!-- Table goes here -->
  </content>
</DynamicPage>
```

STEP: 6 — Change table popinLayout (improve readability for many columns)
DESCRIPTION: Set popinLayout to Block | GridSmall | GridLarge on the table node for responsive behavior.
LANGUAGE: XML
CODE:
```XML
<!-- Example on a sap.m.Table (or fiori-elements table node) -->
<Table id="wideTable" popinLayout="GridSmall">
  <!-- columns and items -->
</Table>
```

STEP: 7 — Change scrollThreshold for grid/analytical/tree tables
DESCRIPTION: Update the table's scrollThreshold (default 300). Use this in the table node.
LANGUAGE: XML
CODE:
```XML
<!-- Example: increase threshold to 500 -->
<Table id="gTable" scrollThreshold="500">
  <!-- columns and rows -->
</Table>
```

STEP: 8 — Toggle SmartFilterBar liveMode
DESCRIPTION: Enable or disable liveMode on the smart filter bar so filters trigger search immediately or via search button.
LANGUAGE: XML
CODE:
```XML
<smartFilterBar:SmartFilterBar id="SmartFilterBar" entityType="Products" liveMode="true" xmlns:smartFilterBar="sap.ui.comp.smartfilterbar">
</smartFilterBar:SmartFilterBar>
```

STEP: 9 — Persist or reset row selection after refresh (rememberSelections)
DESCRIPTION: Set rememberSelections to true/false on responsive tables to control selection persistence.
LANGUAGE: XML
CODE:
```XML
<Table id="respTable" rememberSelections="true">
  <!-- columns/cells -->
</Table>
```

STEP: 10 — Change Object Page avatar shape (displayShape)
DESCRIPTION: Set displayShape on the object page header. (Set directly in the header section of the object page fragment or page layout settings as used by your template.)
LANGUAGE: XML
CODE:
```XML
<!-- Example Object Page Header fragment -->
<ObjectPageHeader id="ObjectPageHeader" displayShape="Circle">
  <title>
    <Text text="{ProductName}" />
  </title>
</ObjectPageHeader>
```

STEP: 11 — Hide the anchor bar on Object Page
DESCRIPTION: Set showAnchorBar = false on the page layout node to hide the anchor navigation bar.
LANGUAGE: XML
CODE:
```XML
<ObjectPageLayout id="ObjectPage" showAnchorBar="false">
  <!-- header, sections, subsections -->
</ObjectPageLayout>
```

STEP: 12 — Switch Object Page to IconTabBar (useIconTabBar)
DESCRIPTION: Use tabs instead of anchor bar by setting useIconTabBar to true.
LANGUAGE: XML
CODE:
```XML
<ObjectPageLayout id="ObjectPage" useIconTabBar="true">
  <!-- sections as tabs -->
</ObjectPageLayout>
```

STEP: 13 — Show header content in edit mode (showHeaderContent) and binding example
DESCRIPTION: Make header content visible/hidden or bind visibility to an expression or model property.
LANGUAGE: XML
CODE:
```XML
<!-- Static -->
<ObjectPageLayout id="ObjectPage" showHeaderContent="true">
</ObjectPageLayout>

<!-- Binding example: bind to ui>/editable -->
<ObjectPageLayout id="ObjectPage" showHeaderContent="{= ${ui>/editable} }" />
```

STEP: 14 — Prevent header collapsing (alwaysShowContentHeader)
DESCRIPTION: Set alwaysShowContentHeader to true so header does not collapse while scrolling (note: small-screen devices may still collapse automatically).
LANGUAGE: XML
CODE:
```XML
<ObjectPageLayout id="ObjectPage" alwaysShowContentHeader="true">
  <!-- header content -->
</ObjectPageLayout>
```

STEP: 15 — Change growingThreshold on sap.m.Table in Object Page
DESCRIPTION: Set growingThreshold on the table node (default 10). Note: a single section with a single subsection containing a table may have default 20 and cannot be changed.
LANGUAGE: XML
CODE:
```XML
<Table id="opTable" growingThreshold="15">
  <!-- columns/items -->
</Table>
```

STEP: 16 — Make Object Page tables not editable (editable / navigationMode)
DESCRIPTION: Prevent automatic editable behavior in edit mode by setting table editable="false". Ensure inner table navigationMode is Navigation so keyboard focus works across focusable cells.
LANGUAGE: XML
CODE:
```XML
<!-- Outer table node -->
<Table id="opTable" editable="false">
  <!-- inner sap.m.Table settings if used -->
  <items>
    <!-- items with focusable controls -->
  </items>
</Table>

<!-- If you control inner table directly -->
<sap.m.Table id="innerTable" navigationMode="Navigation" />
```

STEP: 17 — Enable Include Item In Selection for tables
DESCRIPTION: Set includeItemInSelection to true so selection persists when navigating away from the table.
LANGUAGE: XML
CODE:
```XML
<Table id="selectTable" includeItemInSelection="true">
  <!-- columns/items -->
</Table>
```

STEP: 18 — Save and Edit action visibility binding (Footer action)
DESCRIPTION: Set the visibility of the Save and Edit footer action to the ui>/editable model path. Example manifest snippet for actions under the page Footer (adjust action names to match your template).
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "actions": {
              "Footer": {
                "SaveAndEdit": {
                  "visible": "{ui>/editable}"
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 19 — Change table popinLayout & scrollThreshold (Object Page table node)
DESCRIPTION: Example combining popinLayout and scrollThreshold on an object page table node for readability and performance tuning.
LANGUAGE: XML
CODE:
```XML
<Table id="opWideTable" popinLayout="GridLarge" scrollThreshold="400">
  <!-- columns / items -->
</Table>
```

STEP: 20 — References & Binding change reminder
DESCRIPTION: When you need conditional visibility or dynamic changes (for example showHeaderContent bound to app state), use binding changes or manifest actions. See your codebase's creating-a-binding-change guide for detailed binding-change examples.
LANGUAGE: JSON
CODE:
```JSON
{
  "note": "Use binding expressions or binding change definitions in your app when you require dynamic values (e.g., showHeaderContent bound to model path or expression)."
}
```

--------------------------------

**TITLE**: Adapting Transient Messages from the Back End in SAP Fiori elements (OData V2)

**INTRODUCTION**: Use the adaptTransientMessageExtension extension point to adapt transient (temporary) messages received from the back end before they are displayed in List Report, Object Page, or Analytical List Page applications built with SAP Fiori elements (OData V2). This document shows how to register the extension in manifest.json and implement a controller extension that adds or modifies transient messages via the Messaging API. Follow the warnings: use only the extensionAPI and do not modify state messages or message targets.

**TAGS**: fiori-elements, extension, adaptTransientMessageExtension, transient-messages, ODataV2, manifest, controller-extension

**STEP**: 1 — Register controller extension in manifest.json

**DESCRIPTION**: Register your controller extension in the app manifest (typically webapp/manifest.json). Add an entry under sap.ui.controllerExtensions for the SAP Fiori elements view(s) you want to extend. Example shows registration for List Report; repeat similarly for Object Page or Analytical List Page using the corresponding view IDs.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "STTA_MP.ext.controller.ListReportExtension"
          }
          /* For other pages use:
             "sap.suite.ui.generic.template.ObjectPage.view.Details": {
               "controllerName": "STTA_MP.ext.controller.ObjectPageExtension"
             },
             "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
               "controllerName": "STTA_MP.ext.controller.AnalyticalListPageExtension"
             }
          */
        }
      }
    }
  }
}
```

**STEP**: 2 — Implement adaptTransientMessageExtension in the controller extension

**DESCRIPTION**: Create the controller extension module that implements adaptTransientMessageExtension. This function is executed before transient messages are displayed. Use sap/ui/core/Messaging to access transient message model (Messaging.getMessageModel()). Do NOT manipulate messages coming from the message manager state model (Messaging.getMessageManager().getMessageModel()). Do not change message targets. Use only extensionAPI and avoid touching internal controls/models created by SAP Fiori elements.

Create the controller at the namespace referenced in manifest (example: STTA_MP/ext/controller/ListReportExtension.js).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/controller/ListReportExtension.js
// Module name must match "controllerName" in manifest.json: STTA_MP.ext.controller.ListReportExtension

sap.ui.define([
  "sap/ui/core/Messaging",
  "sap/ui/core/message/Message",
  "sap/ui/core/MessageType",
  "sap/ui/core/mvc/Controller"
], function (Messaging, Message, MessageType, Controller) {
  "use strict";

  return Controller.extend("STTA_MP.ext.controller.ListReportExtension", {
    /**
     * Called by SAP Fiori elements before transient messages are displayed.
     * Only modify transient messages accessed via Messaging.getMessageModel().
     * Do not alter messages from Messaging.getMessageManager().getMessageModel().
     */
    adaptTransientMessageExtension: function () {
      var oTransientModel = Messaging.getMessageModel();

      // Ensure transient message model exists and has messages
      if (oTransientModel && oTransientModel.oData && oTransientModel.oData.length) {
        // Example: add a consolidated information message
        var sMsgText = "This message has been added through List Extension";
        var oConsolidatedMessage = new Message({
          message: sMsgText,
          type: MessageType.Information,
          target: "",        // Keep target empty for application-level message
          persistent: true   // Keep message persistent until explicitly removed
        });

        // Add the message to the transient messaging model
        Messaging.addMessages(oConsolidatedMessage);
      }
    }
  });
});
```

**STEP**: 3 — Implementation notes and cautions

**DESCRIPTION**: Keep these implementation constraints in your code:
- Applicable only for SAP Fiori elements for OData V2.
- Use app extensions sparingly; prefer manifest settings or annotations when possible.
- Use only the SAP Fiori elements extensionAPI and the SAP UI5 Messaging APIs—do not access or manipulate internal framework controls, properties, or models.
- The adaptTransientMessageExtension hook is invoked for transient messages only (Messaging.getMessageModel()). Do not modify state messages from Messaging.getMessageManager().getMessageModel().
- Do not change the target property of messages in the message model; altering targets may break message model services.
- In flexible column layout scenarios, adaptTransientMessageExtension may be invoked for multiple pages (list report, object page, analytical list page) — ensure your logic accounts for message model adaptations across these pages.

**LANGUAGE**: Plain text

**CODE**:
```text
Notes:
- Ensure the message model has been adapted for each page where you expect the extension to run.
- If you extend multiple pages, register each page's controller extension in the manifest.
```
--------------------------------

**TITLE**: Add a Chart Facet to an Object Page (UI.ReferenceFacet + UI.Chart / UI.PresentationVariant)

**INTRODUCTION**: Show how to add a chart facet into an object page content section. Includes XML annotation pattern for OData V4, notes about OData V2 limitations, and sample ABAP CDS and CAP CDS annotation snippets for adding a UI.Chart as the first visualization of a UI.PresentationVariant and referencing it from a UI.ReferenceFacet.

**TAGS**: fiori-elements-framework, charts, UI.ReferenceFacet, UI.Chart, UI.PresentationVariant, OData V4, OData V2, ABAP, CAP, annotations

STEP: Add a Chart Facet (XML annotations — typical OData V4 pattern)

DESCRIPTION: Add a UI.ReferenceFacet inside UI.Facets and point its Target to a UI.PresentationVariant that contains Visualizations with @UI.Chart as the first visualization. Place these annotations in the annotation XML file for the relevant entity (Object Page). Replace Target entity name and qualifiers as needed. See also: configuring-charts-653ed0f.md. Image references used in docs: images/ObjectPage_SmartChart_69b1977.png

LANGUAGE: XML

CODE:
```xml
<!-- Annotation file (e.g. annotations.xml) -->
<Annotations Target="MyService.MyEntityType">
  <!-- Add the facet that references a PresentationVariant (which will include the chart) -->
  <Annotation Term="UI.Facets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Items"/>
        <PropertyValue Property="ID" String="SalesOrderItems"/>
        <!-- Target must point to a PresentationVariant that lists @UI.Chart as a visualization -->
        <PropertyValue Property="Target" AnnotationPath="_Item/@UI.PresentationVariant"/>
        <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
      </Record>
    </Collection>
  </Annotation>

  <!-- Define the PresentationVariant referenced above -->
  <Annotation Term="UI.PresentationVariant">
    <Record Type="UI.PresentationVariantType">
      <PropertyValue Property="SortOrder">
        <Collection>
          <Record Type="Common.SortOrderType">
            <PropertyValue Property="Property" PropertyPath="SalesOrderItem"/>
            <PropertyValue Property="Descending" Bool="true"/>
          </Record>
        </Collection>
      </PropertyValue>

      <PropertyValue Property="Visualizations">
        <Collection>
          <!-- Chart first, then LineItem -->
          <AnnotationPath>@UI.Chart</AnnotationPath>
          <AnnotationPath>@UI.LineItem</AnnotationPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: OData V2 limitation — UI.Chart with qualifier on Object Page

DESCRIPTION: Note that the Object Page on SAP Fiori Elements for OData V2 does not support UI.Chart references with qualifiers on navigation properties / reference facets. Do not point ReferenceFacet.Target directly to a qualified UI.Chart annotation. Example of an unsupported pattern shown for clarity.

LANGUAGE: XML

CODE:
```xml
<!-- UNSUPPORTED in OData V2 (example showing a qualified chart annotation target) -->
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="UI.Facets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Items"/>
        <PropertyValue Property="ID" String="SalesOrderItems"/>
        <!-- Target pointing directly to a UI.Chart with qualifier is not supported on the Object Page for OData V2 -->
        <PropertyValue Property="Target" AnnotationPath="_Item@UI.Chart#MyChartQualifier"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: OData V4 — ABAP CDS annotations (create PresentationVariant + facet reference)

DESCRIPTION: ABAP CDS: annotate the entity/view with @UI.facet referencing the target element (navigation property) and declare @UI.PresentationVariant that sets Visualizations with type #AS_CHART first. Use type #PRESENTATIONVARIANT_REFERENCE for the facet.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.facet: [{
  id:           'SalesOrderItems',
  label:        'Items',
  type:         #PRESENTATIONVARIANT_REFERENCE,
  purpose:      #STANDARD,
  targetElement: '_Item',
  importance:   #HIGH
}]
@UI.PresentationVariant: [{
  sortOrder: [
    { by: 'SalesOrderItem', direction: #DESC }
  ],
  visualizations: [
    { type: #AS_CHART },
    { type: #AS_LINEITEM }
  ]
}]
annotate view VIEWNAME with {
  // Additional field-level annotations if required
}
```

STEP: OData V4 — CAP CDS annotations (CDS/annotations in CAP)

DESCRIPTION: CAP CDS: declare a UI.ReferenceFacet entry pointing to the PresentationVariant and define UI.PresentationVariant with Visualizations listing '@UI.Chart' first. Example shows JSON-like annotation block used in CAP annotation sections.

LANGUAGE: CDS

CODE:
```cds
// In a .cds file or annotations.cds for CAP
entity SalesOrder { /* ... fields ... */ }

// Facet referencing a PresentationVariant on navigation element _Item
annotate SalesOrder with {
  @UI: {
    facet: [
      {
        $Type : 'UI.ReferenceFacet',
        Label : 'Items',
        ID    : 'SalesOrderItems',
        Target: '_Item/@UI.PresentationVariant',
        // Importance annotation in CAP CDS style:
        Importance : #High
      }
    ]
  };
}

// PresentationVariant definition (can be placed on the target entity or navigation element)
annotate SalesOrder with {
  @UI: {
    PresentationVariant: {
      SortOrder : [
        {
          $Type    : 'Common.SortOrderType',
          Property : 'SalesOrderItem',
          Descending : true
        }
      ],
      Visualizations : [
        '@UI.Chart',
        '@UI.LineItem'
      ]
    }
  };
}
```
--------------------------------

**TITLE**: Adding a Contact Facet (UI.ReferenceFacet / Communication.Contact)

**INTRODUCTION**: Instructions and code examples to add a contact facet (contact card and popover) in SAP Fiori Elements. Covers OData V2 and V4 usage: how to add a ReferenceFacet / DataFieldForAnnotation pointing at a Communication.Contact annotation and how to define the Communication.Contact content (XML, ABAP CDS, CAP CDS). Includes supported contact properties and rendering behavior.

**TAGS**: fiori-elements, annotations, Communication.Contact, UI.ReferenceFacet, DataFieldForAnnotation, ODataV2, ODataV4, ABAP, CAP, CDS, XML

**STEP**: 1 — Add a ReferenceFacet (OData V2) to render a contact card on an Object Page

**DESCRIPTION**: Add a UI.ReferenceFacet that points to a contact annotation (Communication.Contact). The UI.ReferenceFacet label is shown and the contact's fn property is rendered; clicking the name opens the quick view with the contact card.

**LANGUAGE**: XML

**CODE**:
```xml
<Record Type="UI.ReferenceFacet">
   <PropertyValue Property="Label" String="Supplier"/>
   <PropertyValue AnnotationPath="to_Supplier/@Communication.Contact" Property="Target"/>
</Record>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.facet: [
 {
  label: 'Supplier',
  type:         #CONTACT_REFERENCE,
  targetElement: '_Supplier',
  purpose: #STANDARD
 }
]
product;
```

**STEP**: 2 — Define the Communication.Contact annotation for the target type (OData V2 XML)

**DESCRIPTION**: Provide a Communication.Contact annotation on the target entity type. Map properties like fn, title, org, role, n (name parts), photo, tel, and email. Use Collection of Records for tel/email with type EnumMember values.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="SEPMRA_PROD_MAN.SEPMRA_I_EmployeeType">
  <Annotation Term="Communication.Contact">
    <Record>
      <PropertyValue Property="fn" Path="FormattedName"/>
      <PropertyValue Property="title" Path="JobTitle"/>
      <PropertyValue Property="org" Path="CompanyName"/>
      <PropertyValue Property="role" Path="OrganizationRole"/>
      <PropertyValue Property="n">
        <Record>
          <PropertyValue Property="given" Path="FirstName"/>
          <PropertyValue Property="additional" Path="MiddleName"/>
          <PropertyValue Property="surname" Path="LastName"/>
        </Record>
      </PropertyValue>
      <PropertyValue Property="photo" Path="EmployeePictureURL"/>
      <PropertyValue Property="tel">
        <Collection>
          <Record>
            <PropertyValue Property="type" EnumMember="Communication.PhoneType/fax"/>
            <PropertyValue Property="uri" Path="FaxNumber"/>
          </Record>
          <Record>
            <PropertyValue Property="type" EnumMember="Communication.PhoneType/cell"/>
            <PropertyValue Property="uri" Path="MobilePhoneNumber"/>
          </Record>
          <Record>
            <PropertyValue Property="type" EnumMember="Communication.PhoneType/work"/>
            <PropertyValue Property="uri" Path="PhoneNumber"/>
          </Record>
          <!-- Example with empty type and address property -->
          <Record>
            <PropertyValue Property="type" EnumMember=""/>
            <PropertyValue Property="address" Path="FaxNumber"/>
          </Record>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="email">
        <Collection>
          <Record>
            <PropertyValue Property="type" EnumMember="Communication.ContactInformationType/work"/>
            <PropertyValue Property="address" Path="EmailAddress"/>
          </Record>
        </Collection> 
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
define view VIEWNAME
{
  @Semantics.name.fullName: true
  FormattedName,

  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK]
  EmailAddress,
   
  @Semantics.telephone.type:  [ #FAX ] 
  FaxNumber,

  @Semantics.telephone.type:  [ #CELL ]
  MobilePhoneNumber,
  
  @Semantics.telephone.type:  [ #WORK]
  PhoneNumber,

  @Semantics.name: { jobTitle: true }   
  JobTitle,

  @Semantics.organization: { name: true }
  CompanyName,

  @Semantics.organization: { role: true, unit: true }
  OrganizationRole,

  @Semantics.name: { givenName: true }   
  FirstName,

  @Semantics.name: { additionalName: true }   
  MiddleName,

  @Semantics.name: { familyName: true }   
  LastName,

  @Semantics.address : { city: true }  
  City,

  @Semantics.contact.photo: true
  EmployeePictureURL
}
```

**STEP**: 3 — Add DataFieldForAnnotation to show contact as a smart link or line item (OData V4)

**DESCRIPTION**: In OData V4, configure a DataFieldForAnnotation (UI.DataFieldForAnnotation) in the LineItem or FieldGroup that points to supplier/@Communication.Contact. This renders a smart link that opens a contact popover.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="clouds.products.CatalogService.Products">
    <Annotation Term="UI.LineItem">
        <Collection>
            <Record Type="UI.DataFieldForAnnotation">
                <PropertyValue Property="Label" String="Supplier"/>
                <PropertyValue Property="Target" AnnotationPath="supplier/@Communication.Contact"/>
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
annotate view PRODUCTS.CATALOGSERVICE.PRODUCTS with {
  @UI.lineItem: [
    {
      label: 'Supplier',
      value: 'SUPPLIER',
      type: #AS_CONTACT,
      position: 1 
    }
  ]
  test;
}
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
LineItem : [
    {
        $Type  : 'UI.DataFieldForAnnotation',
        Target : 'supplier/@Communication.Contact',
        Label  : 'Supplier'
    }]
```

**STEP**: 4 — Define Communication.Contact on the EntitySet referenced by the navigation (OData V4)

**DESCRIPTION**: Add a Communication.Contact annotation to the EntitySet (e.g., Suppliers) referenced by the navigation property (Supplier). This controls the contact-card contents shown in the popover.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="clouds.products.CatalogService.Suppliers">
    <Annotation Term="Communication.Contact">
        <Record Type="Communication.ContactType">
            <PropertyValue Property="email">
                <Collection>
                    <Record Type="Communication.EmailAddressType">
                        <PropertyValue Property="type">
                            <EnumMember>Communication.ContactInformationType/work</EnumMember>
                        </PropertyValue>
                        <PropertyValue Property="address">
                            <Path>emailAddress</Path>
                        </PropertyValue>
                    </Record>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="fn">
                <Path>name</Path>
            </PropertyValue>
            <PropertyValue Property="tel">
                <Collection>
                    <Record Type="Communication.PhoneNumberType">
                        <PropertyValue Property="type">
                            <EnumMember>Communication.PhoneType/fax</EnumMember>
                        </PropertyValue>
                        <PropertyValue Property="uri">
                            <Path>faxNumber</Path>
                        </PropertyValue>
                    </Record>
                    <Record Type="Communication.PhoneNumberType">
                        <PropertyValue Property="type">
                            <EnumMember>Communication.PhoneType/work</EnumMember>
                        </PropertyValue>
                        <PropertyValue Property="uri">
                            <Path>phoneNumber</Path>
                        </PropertyValue>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
define view Suppliers
{
  @Semantics.name.fullName: true
  name,

  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK]
  emailAddress,
   
  @Semantics.telephone.type:  [ #FAX ] 
  FaxNumber,
  
  @Semantics.telephone.type:  [ #WORK]
  PhoneNumber
}
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
FieldGroup #HeaderGeneralInformation : { Data : [{
        $Type  : 'UI.DataFieldForAnnotation',
        Target : '_SoldToParty/@Communication.Contact',
        Label  : 'Contact Info'
    }]},

entity Customer @(
    cds.autoexpose,
    title                  : 'Sold-to Party',
    Communication.Contact  : {
        email : [{
            type    : #work,
            address : EmailAddress
        }],
        fn    : CustomerName,
        tel   : [{
            type : #fax,
            uri  : InternationalPhoneNumber
        }],
        adr   : [{
            type     : #work,
            code     : PostalCode,
            country  : Country,
            locality : CityName
        }]
    },
    Common.IsNaturalPerson : true
)
```

**STEP**: 5 — Contact properties, types, rendering rules and behaviors

**DESCRIPTION**: Summary of supported properties and how they are rendered (apply to both V2 and V4 contact cards/popovers).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "fn": "Full name, displayed as card title (large font) and clickable to open quick view",
  "title": "Job title, displayed under the title (small font)",
  "photo": "Photo URL shown in header; if absent a fallback contact icon is used",
  "role": "Role displayed in content",
  "org": "Organization displayed in content",
  "n": "Structured name (given, additional, surname) used for name parts",
  "adr": "Address follows addressType definition; if 'label' property is present, label only is shown. Display order: street, code, locality, region, country (comma-separated).",
  "mail/email": "Collection of email addresses; supported types: preferred, work. Rendered as mailto: link that opens mail client.",
  "tel": "Collection of phone numbers; supported types: preferred, cell, work, fax (use EnumMember Communication.PhoneType/fax). Rendered as tel: link opening phone app per browser settings."
}
```

**STEP**: 6 — Tips and behavior notes

**DESCRIPTION**: Important practical tips to implement correctly.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "annotationPaths": "ReferenceFacet or DataFieldForAnnotation should point to navigationProperty/@Communication.Contact",
  "entityTarget": "Place Communication.Contact on the EntitySet or EntityType referenced by the navigation property",
  "photoFallback": "If @Contact.photo is not provided, Fiori shows a fallback contact icon",
  "clickBehavior": "Clicking email opens mail client; clicking phone opens phone app; clicking name opens contact popover/quick view",
  "addressLabelOverride": "If 'label' is provided on 'adr', it overrides and hides individual address properties"
}
```
--------------------------------

**TITLE**: Add Contact Quick View to a Table (UI.LineItem + Communication.Contact)

**INTRODUCTION**: Enable a contact quick view (from list report and object page) by adding a UI.LineItem entry that references the @Communication.Contact annotation on the supplier navigation property (e.g., to_Supplier). This document provides ready-to-use XML, ABAP CDS and CAP CDS examples for both the UI.LineItem and the Communication.Contact definition.

**TAGS**: fiori-elements, annotations, UI.LineItem, Communication.Contact, quick-view, CDS, XML

**STEP**: 1A — Add UI.LineItem (XML Annotation)

**DESCRIPTION**: Add the UI.LineItem annotation under the ProductType entity in your OData annotations XML. Include a UI.DataFieldForAnnotation record whose Target points to the supplier navigation property's @Communication.Contact (Target="to_Supplier/@Communication.Contact"). This enables the contact quick view in table rows.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.LineItem">
    <Collection>
        <Record Type="UI.DataFieldForAction">
            <PropertyValue Property="Label" String="Activate" />
            <PropertyValue Property="Action"
                           String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductActivation"/>
            <PropertyValue Property="InvocationGrouping"
                           EnumMember="UI.OperationGroupingType/ChangeSet" />
        </Record>
        <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="ProductPictureURL" />
            <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
        </Record>
        <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="ProductForEdit" />
            <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
        </Record>
        <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="ProductCategory" />
            <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
        </Record>
        <Record Type="UI.DataFieldWithIntentBasedNavigation">
            <PropertyValue Property="Label" String="Supplier (with IBN)" />
            <PropertyValue Property="Value" Path="Supplier" />
            <PropertyValue Property="SemanticObject" String="EPMProduct" />
            <PropertyValue Property="Action" String="manage" />
        </Record>
        <Record Type="UI.DataFieldForAnnotation">
            <PropertyValue Property="Label" String="{@i18n>Supplier}"/>
            <PropertyValue Property="Target"
                           AnnotationPath="to_Supplier/@Communication.Contact"/>
            <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
        </Record>
        <Record Type="UI.DataField">
            <PropertyValue Property="Criticality"
                           Path="to_StockAvailability/StockAvailability" />
            <PropertyValue Property="Value"
                           Path="to_StockAvailability/StockAvailability" />
            <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
        </Record>
        <Record Type="UI.DataFieldForAnnotation">
            <PropertyValue Property="Label" String="Rating" />
            <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Rating" />
        </Record>
        <Record Type="UI.DataFieldForAnnotation">
            <PropertyValue Property="Label" String="Progress" />
            <PropertyValue Property="Criticality"
                           Path="to_StockAvailability/Quantity" />
            <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Progress" />
        </Record>
        <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="Price" />
            <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
        </Record>
        <Record Type="UI.DataFieldForAction">
            <PropertyValue Property="Label" String="Copy" />
            <PropertyValue Property="IconUrl" String="sap-icon://copy" />
            <PropertyValue Property="Action"
                           String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy" />
            <PropertyValue Property="Inline" Bool="true" />
            <PropertyValue Property="Determining" Bool="true" />
            <PropertyValue Property="InvocationGrouping"
                           EnumMember="UI.OperationGroupingType/Isolated" />
        </Record>
        <Record Type="UI.DataFieldForIntentBasedNavigation">
            <PropertyValue Property="Label" String="{@i18n>MANAGE_PRODUCTS_(ST)_2}" />
            <PropertyValue Property="SemanticObject" String="EPMProduct" />
            <PropertyValue Property="Action" String="manage_st" />
            <PropertyValue Property="Inline" Bool="false" />
            <PropertyValue Property="Determining" Bool="false" />
            <PropertyValue Property="RequiresContext" Bool="true" />
        </Record>
        <Record Type="UI.DataFieldForIntentBasedNavigation">
            <PropertyValue Property="Label" String="{@i18n>Inline_Nav_MasterDetail}" />
            <PropertyValue Property="SemanticObject" String="EPMProduct" />
            <PropertyValue Property="Action" String="manage" />
            <PropertyValue Property="Inline" Bool="true" />
            <PropertyValue Property="Determining" Bool="false" />
            <PropertyValue Property="RequiresContext" Bool="false" />
        </Record>
        <Record Type="UI.DataFieldForAnnotation">
            <PropertyValue Property="Label" String="Sales"/>
            <PropertyValue Property="Target" AnnotationPath="to_ProductSalesPrice/@UI.Chart#SalesPriceAreaChart"/>
        </Record>
        <Record Type="UI.DataFieldForAnnotation">
            <PropertyValue Property="Label" String="Revenue"/>
            <PropertyValue Property="Target" AnnotationPath="to_ProductSalesRevenue/@UI.Chart#GrossSalesRevenueBulletChart"/>
        </Record>
    </Collection>
</Annotation>
```

**STEP**: 1B — Add UI.LineItem (ABAP CDS)

**DESCRIPTION**: Add an equivalent @UI.lineItem entry in your ABAP CDS view for ProductType. Ensure the supplier entry uses type #AS_CONTACT / #AS_DATAPOINT mapping as shown (supplier entry references TO_SUPPLIER which corresponds to to_Supplier nav property).

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.lineItem: [
  {
    label: 'Activate',
    dataAction: 'PUSHDOWN:STTA_C_MP_ProductActivation',
    invocationGrouping: #CHANGE_SET,
    type: #FOR_ACTION,
    position: 1 
  },
  {
    importance: #HIGH,
    value: 'PRODUCTPICTUREURL',
    type: #STANDARD,
    position: 2 
  },
  {
    importance: #HIGH,
    label: '{@i18n>@Supplier}',
    value: 'TO_SUPPLIER',
    type: #AS_CONTACT,
    position: 6 
  },
  {
    label: 'Rating',
    valueQualifier: 'Rating',
    type: #AS_DATAPOINT,
    position: 8 
  },
  {
    label: 'Progress',
    criticality: 'TO_STOCKAVAILABILITY/QUANTITY',
    valueQualifier: 'Progress',
    type: #AS_DATAPOINT,
    position: 9 
  },
  {
    label: 'Copy',
    iconUrl: 'sap-icon:,//copy'
    dataAction: 'PUSHDOWN:STTA_C_MP_ProductCopy',
    invocationGrouping: #ISOLATED,
    type: #FOR_ACTION,
    position: 11 
  },
  {
    label: '{@i18n>@MANAGE_PRODUCTS_(ST)_2}',
    semanticObjectAction: 'manage_st',
    requiresContext: true,
    type: #FOR_INTENT_BASED_NAVIGATION,
    position: 12 
  },
  {
    label: '{@i18n>@Inline_Nav_MasterDetail}',
    semanticObjectAction: 'manage',
    type: #FOR_INTENT_BASED_NAVIGATION,
    position: 13 
  },
  {
    label: 'Sales',
    valueQualifier: 'SalesPriceAreaChart',
    value: 'TO_PRODUCTSALESPRICE',
    type: #AS_CHART,
    position: 14 
  },
  {
    label: 'Revenue',
    valueQualifier: 'GrossSalesRevenueBulletChart',
    value: 'TO_PRODUCTSALESREVENUE',
    type: #AS_CHART,
    position: 15 
  }
]
PRODUCTPICTUREURL;

@UI.lineItem: [
  {
    importance: #HIGH,
    value: 'PRODUCTFOREDIT',
    type: #STANDARD,
    position: 3 
  }
]
PRODUCTFOREDIT;

@UI.lineItem: [
  {
    importance: #HIGH,
    value: 'PRODUCTCATEGORY',
    type: #STANDARD,
    position: 4 
  }
]
PRODUCTCATEGORY;

@UI.lineItem: [
  {
    label: 'Supplier (with IBN)',
    value: 'SUPPLIER',
    semanticObjectAction: 'manage',
    type: #WITH_INTENT_BASED_NAVIGATION,
    position: 5 
  }
]
SUPPLIER;

@UI.lineItem: [
  {
    importance: #HIGH,
    criticality: 'TO_STOCKAVAILABILITY/STOCKAVAILABILITY',
    value: 'TO_STOCKAVAILABILITY/STOCKAVAILABILITY',
    type: #STANDARD,
    position: 7 
  }
]
TO_STOCKAVAILABILITY/STOCKAVAILABILITY;

@UI.lineItem: [
  {
    importance: #HIGH,
    value: 'PRICE',
    type: #STANDARD,
    position: 10 
  }
]
PRICE;

@Consumption.semanticObject: 'EPMProduct'
SUPPLIER;
```

**STEP**: 1C — Add UI.LineItem (CAP CDS)

**DESCRIPTION**: Add the CAP CDS UI.LineItem block in your service model or annotations file. Ensure the DataFieldForAnnotation entry targets to_Supplier/@Communication.Contact as shown.

**LANGUAGE**: CDS

**CODE**:
```cds
UI.LineItem : [
    {
        $Type : 'UI.DataFieldForAction',
        Label : 'Activate',
        Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductActivation',
        InvocationGrouping : #ChangeSet
    },
    {
        $Type : 'UI.DataField',
        Value : ProductPictureURL,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataField',
        Value : ProductForEdit,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataField',
        Value : ProductCategory,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataFieldWithIntentBasedNavigation',
        Label : 'Supplier (with IBN)',
        Value : Supplier,
        SemanticObject : 'EPMProduct',
        Action : 'manage'
    },
    {
        $Type : 'UI.DataFieldForAnnotation',
        Label : '{@i18n>@Supplier}',
        Target : 'to_Supplier/@Communication.Contact',
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataField',
        Criticality : to_StockAvailability.StockAvailability,
        Value : to_StockAvailability.StockAvailability,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataFieldForAnnotation',
        Label : 'Rating',
        Target : '@UI.DataPoint#Rating'
    },
    {
        $Type : 'UI.DataFieldForAnnotation',
        Label : 'Progress',
        Criticality : to_StockAvailability.Quantity,
        Target : '@UI.DataPoint#Progress'
    },
    {
        $Type : 'UI.DataField',
        Value : Price,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataFieldForAction',
        Label : 'Copy',
        IconUrl : 'sap-icon://copy',
        Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy',
        Inline : true,
        Determining : true,
        InvocationGrouping : #Isolated
    },
    {
        $Type : 'UI.DataFieldForIntentBasedNavigation',
        Label : '{@i18n>@MANAGE_PRODUCTS_(ST)_2}',
        SemanticObject : 'EPMProduct',
        Action : 'manage_st',
        Inline : false,
        Determining : false,
        RequiresContext : true
    },
    {
        $Type : 'UI.DataFieldForIntentBasedNavigation',
        Label : '{@i18n>@Inline_Nav_MasterDetail}',
        SemanticObject : 'EPMProduct',
        Action : 'manage',
        Inline : true,
        Determining : false,
        RequiresContext : false
    },
    {
        $Type : 'UI.DataFieldForAnnotation',
        Label : 'Sales',
        Target : 'to_ProductSalesPrice/@UI.Chart#SalesPriceAreaChart'
    },
    {
        $Type : 'UI.DataFieldForAnnotation',
        Label : 'Revenue',
        Target : 'to_ProductSalesRevenue/@UI.Chart#GrossSalesRevenueBulletChart'
    }
]
```

**STEP**: 2A — Define Communication.Contact (XML Annotation)

**DESCRIPTION**: Define the @Communication.Contact annotation on the supplier entity (e.g., SupplierType). Use the provided mapping: fn -> CompanyName, tel -> collection of phone records with types and uri paths, email -> collection with type and address path.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="Communication.Contact">
    <Record>
        <PropertyValue Property="fn" Path="CompanyName" />
        <PropertyValue Property="tel">
            <Collection>
                <Record>
                    <PropertyValue Property="type"
                                   EnumMember="Communication.PhoneType/fax" />
                    <PropertyValue Property="uri" Path="FaxNumber" />
                </Record>
                <Record>
                    <PropertyValue Property="type"
                                   EnumMember="Communication.PhoneType/preferred Communication.PhoneType/work" />
                    <PropertyValue Property="uri" Path="PhoneNumber" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="email">
            <Collection>
                <Record>
                    <PropertyValue Property="type"
                                   EnumMember="Communication.ContactInformationType/work Communication.ContactInformationType/pref" />
                    <PropertyValue Property="address" Path="EmailAddress" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 2B — Define Communication.Contact (ABAP CDS)

**DESCRIPTION**: Define the fields in your ABAP CDS view and annotate them with semantics so the communication quick view is inferred (Semantics.name.fullName, Semantics.eMail.address/type, Semantics.telephone.type, etc.). Use the view fields CompanyName, EmailAddress, FaxNumber, PhoneNumber.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
define view VIEWNAME
{
  @Semantics.name.fullName: true
  CompanyName,

  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK]
  EmailAddress,
   
  @Semantics.telephone.type:  [ #FAX ] 
  FaxNumber,
  
  @Semantics.telephone.type:  [ #WORK]
  PhoneNumber
}
```

**STEP**: 2C — Define Communication.Contact (CAP CDS)

**DESCRIPTION**: Define the Communication.Contact annotation object in CAP CDS syntax on the supplier type. Map fn, tel (array of phone records with type and uri), and email (array of email records with type and address) to your entity fields.

**LANGUAGE**: CDS

**CODE**:
```cds
Communication.Contact : {
    fn : CompanyName,
    tel : [
        {
            type : #fax,
            uri : FaxNumber
        },
        {
            type : [ #preferred, #work ],
            uri : PhoneNumber
        },
    ],
    email : [
        {
            type : [ #work, #pref ],
            address : EmailAddress
        }
    ]
}
```

--------------------------------

**TITLE**: Adding a Custom Message Strip to List Report, Analytical List Page and Object Page Tables

**INTRODUCTION**: Quick reference and code-ready examples for adding custom message strips to tables in SAP Fiori Elements (OData V2 and OData V4). Includes how to set message text/type, limit messages to specific tabs, add messages to object page tables (by table ID), and use a close callback (V4).

**TAGS**: fiori-elements-framework, extensionAPI, setCustomMessage, ListReport, AnalyticalListPage, ObjectPage, message-strip, ODataV2, ODataV4

**STEP**: 1 — Add a custom message to List Report / Analytical List Page (OData V2)

**DESCRIPTION**: Implement onBeforeRebindTableExtension in your List Report or Analytical List Page controller extension and call extensionAPI.setCustomMessage with a message object containing message text and a sap.ui.core.MessageType.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: ListReportExtension.controller.js
// or: AnaliticalListPageExt.controller.js

onBeforeRebindTableExtension: function () {
    // Create message object
    var oMessage = {
        message: "Custom message on table",
        type: sap.ui.core.MessageType.Success // Success | Warning | Error | Information
    };

    // Set custom message on the table (all tabs if no tabKey passed)
    this.extensionAPI.setCustomMessage(oMessage);
}
```

**STEP**: 2 — Limit message to specific tab(s) (OData V2)

**DESCRIPTION**: Pass a tab key (string) or array of tab keys as the second parameter to setCustomMessage to display the message only on specific tabs. Omit the second parameter to show the message on all tabs.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Display only on tab with key "1"
this.extensionAPI.setCustomMessage(oMessage, "1");

// Display only on tabs "1" and "2"
this.extensionAPI.setCustomMessage(oMessage, ["1", "2"]);

// Display on all tabs (no tabKey)
this.extensionAPI.setCustomMessage(oMessage);
```

**STEP**: 3 — Add custom message per tab on Object Page (OData V2) — example with two tabs

**DESCRIPTION**: Call setCustomMessage with both a message object and the table ID (full view+control ID) to attach a message to a specific table/tab on the Object Page. Example shows two different messages targeted to two different tabs.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: ObjectPageExtension.controller.js
onBeforeRebindTableExtension: function () {
    if (this.extensionAPI.setCustomMessage) {
        var oMsg1 = {
            message: "Custom message on object page tab 1",
            type: sap.ui.core.MessageType.Success
        };
        var oMsg2 = {
            message: "Custom message on object page tab 2",
            type: sap.ui.core.MessageType.Error
        };

        // Example table IDs (use the actual Table ID in your app)
        var sTableId = "STTASOMVLR::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20--SalesOrderItemsID::Table";

        // Display message on tab 1
        this.extensionAPI.setCustomMessage(oMsg1, sTableId, "_tab1");

        // Display message on tab 2
        this.extensionAPI.setCustomMessage(oMsg2, sTableId, "_tab2");
    }
}
```

**STEP**: 4 — Restrictions and compatibility (OData V2)

**DESCRIPTION**: Known restrictions — do not use setCustomMessage in multiple view scenarios; not supported for smart charts and smart lists.

**LANGUAGE**: Text

**CODE**:
```
Restrictions:
- Not recommended for multiple view scenarios.
- Not supported for smart charts and smart lists.
```

**STEP**: 5 — Add a custom message to List Report / Analytical List Page (OData V4) with close callback

**DESCRIPTION**: In a ListReport controller extension use the ListReport extension API (this.base.getExtensionAPI()) and call setCustomMessage with (messageObject, tabKey, onCloseCallback). If tabKey is null or omitted, the message is shown on all tabs. If messageObject is omitted it removes existing messages.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example placed in ListReport controller extension
routing: {
    onAfterBinding: function (oBindingContext, mParameters) {
        var oMessage = {
                message: "onAfterBinding: Context bound. Have a nice day",
                type: sap.ui.core.MessageType.Information
            },
            extensionAPI = this.base.getExtensionAPI();

        function fnOnClose() {
            sap.m.MessageToast.show("Custom message closed");
        }

        // Set message on all tabs (null tabKey), with on-close callback
        extensionAPI.setCustomMessage(oMessage, null, fnOnClose);

        // To remove existing messages:
        // extensionAPI.setCustomMessage();
    }
}
```

**STEP**: 6 — Add a message to Object Page table (OData V4) using Table building block

**DESCRIPTION**: For Object Page tables in the flexible programming model (OData V4), use the Table building block API's addMessage function. See the live example in the FPM explorer to inspect exact signature and usage.

**LANGUAGE**: Text / Link

**CODE**:
```
Use the Table building block's addMessage function to add messages to an object page table.
Live example: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/tableMessages
(Inspect the example to see the exact addMessage signature and integration points.)
```

**STEP**: 7 — setCustomMessage: parameters and supported message types

**DESCRIPTION**: Summary of function parameters and allowed message types to use with setCustomMessage.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "setCustomMessage(parameters)": {
    "messageObject (optional)": {
      "message": "string - text to display",
      "type": "sap.ui.core.MessageType - Success | Warning | Error | Information"
    },
    "tabKey (optional)": "string | array | null - identifies target tab(s); omit or null => all tabs",
    "onCloseCallback (optional, V4)": "function - called when the message strip is closed"
  },
  "supportedMessageTypes": [
    "sap.ui.core.MessageType.Success",
    "sap.ui.core.MessageType.Warning",
    "sap.ui.core.MessageType.Error",
    "sap.ui.core.MessageType.Information"
  ]
}
```
--------------------------------

**TITLE**: Adding a Custom Section to an Object Page (SAP Fiori Elements, OData V2 & V4)

**INTRODUCTION**: This document shows concrete, copy-paste-ready steps to add custom sections (facets) to an Object Page in SAP Fiori Elements applications. It includes file paths, XML fragment examples, i18n entries, manifest.json extension examples for both OData V2 and OData V4, and code samples for merging section titles with control titles using the extension API.

**TAGS**: fiori-elements-framework, sapui5, object-page, extension, manifest, i18n, ODataV2, ODataV4, fragment, extensionAPI

**STEP**: Add Custom Section Using SAP Fiori Tools (visual flow)
**DESCRIPTION**: Quick UI flow using SAP Fiori Tools Page Map / Page Editor to add a custom section to an Object Page. Useful when you prefer the graphical editor instead of manual edits.
**LANGUAGE**: text
**CODE**:
```text
1. Open project and launch Page Map (right-click project folder -> Show Page Map).
2. In Page Map, open Page Editor for your Object Page (click pencil/Edit icon).
3. Click the + (Add) icon next to Sections -> Add Custom Section.
4. Provide a unique Title (translatable) and a unique Fragment Name.
5. Select an Anchor Section (position before/after anchor).
6. Click Add.
7. Preview via SAP Fiori Tools Preview (see Previewing an Application).
```

**STEP**: OData V2 — Create XML View Fragment for New Facet
**DESCRIPTION**: Create a breakdown/view fragment placed under webapp/ext/view and define the controls. Example uses a non-editable TextArea bound to an association navigation property.
**LANGUAGE**: XML
**CODE**:
```xml
File: webapp/ext/view/DescriptionBreakout.view.xml
<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m">
  <VBox>
    <TextArea id="DescriptionTextArea"
              value="{to_ProductTextInOriginalLang/Description}"
              width="30%"
              editable="false"/>
  </VBox>
</mvc:View>
```

**STEP**: OData V2 — Add Translatable Title to i18n
**DESCRIPTION**: Add the section title entry to your i18n resource bundle so the manifest can reference it.
**LANGUAGE**: text
**CODE**:
```text
File: webapp/i18n/i18n.properties
# This is the resource bundle for Manage Products
# XTIT: Title of a facet within an object page if not needed in local/annotations.xml
ProductDescription=Product Description
```

**STEP**: OData V2 — Add viewExtension Entry in manifest.json
**DESCRIPTION**: Register the custom XML view fragment as a viewExtension for the Object Page Details template. The example places the custom section after the GeneralInformation facet. Use a unique extension key; for multiple sections include a key in sap.ui.generic.app.
**LANGUAGE**: JSON
**CODE**:
```json
// Add under "sap.ui5" -> "extends" in manifest.json
"extends": {
  "extensions": {
    "sap.ui.viewExtensions": {
      "sap.suite.ui.generic.template.ObjectPage.view.Details": {
        "AfterFacet|SEPMRA_C_PD_Product|GeneralInformation": {
          "className": "sap.ui.core.mvc.View",
          "viewName": "ManageProducts.ext.view.DescriptionBreakout",
          "type": "XML",
          "sap.ui.generic.app": {
            "title": "{{ProductDescription}}"
          }
        }
      }
    }
  }
}
```

**STEP**: OData V2 — Add Multiple Custom Sections (manifest example)
**DESCRIPTION**: Example manifest entries for multiple BeforeFacet/AfterFacet extensions. When adding more than one extension for the same annotation, include a numeric key suffix and a "key" property inside sap.ui.generic.app.
**LANGUAGE**: JSON
**CODE**:
```json
"extends": {
  "extensions": {
    "sap.ui.viewExtensions": {
      "sap.suite.ui.generic.template.ObjectPage.view.Details": {
        "BeforeFacet|SEPMRA_C_PD_Product|to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
          "className": "sap.ui.core.mvc.View",
          "viewName": "ManageProducts.ext.view.BeforeFacetTest",
          "type": "XML",
          "sap.ui.generic.app": {
            "title": "Facet Breakout before Product Text LineItem"
          }
        },
        "BeforeFacet|SEPMRA_C_PD_Product|to_ProductText::com.sap.vocabularies.UI.v1.LineItem|1": {
          "className": "sap.ui.core.mvc.View",
          "viewName": "ManageProducts.ext.view.BeforeFacetTestNew",
          "type": "XML",
          "sap.ui.generic.app": {
            "title": "Facet Breakout before Product Text LineItem",
            "key": "1"
          }
        },
        "AfterFacet|SEPMRA_C_PD_Product|to_Supplier::com.sap.vocabularies.UI.v1.Identification": {
          "className": "sap.ui.core.mvc.View",
          "viewName": "ManageProducts.ext.view.AfterFacetTest",
          "type": "XML",
          "sap.ui.generic.app": {
            "title": "Facet Breakout after Supplier Identification"
          }
        },
        "AfterFacet|SEPMRA_C_PD_Product|to_Supplier::com.sap.vocabularies.UI.v1.Identification|1": {
          "className": "sap.ui.core.mvc.View",
          "viewName": "ManageProducts.ext.view.AfterFacetTest",
          "type": "XML",
          "sap.ui.generic.app": {
            "title": "Facet Breakout after Supplier Identification",
            "key": 1
          }
        }
      }
    }
  }
}
```

**STEP**: OData V2 — Merge Section Title with Control Title (setAsTitleOwner)
**DESCRIPTION**: For a SmartTable/SmartChart placed in a custom fragment, set up an initialise event and call the extensionAPI.setAsTitleOwner so the control title becomes the section title (hides duplicate section title).
**LANGUAGE**: XML
**CODE**:
```xml
// In your fragment/view XML where SmartTable is defined
<st:SmartTable id="SalesPriceFacetID" initialise="SalesPriceInitialise"/>
```

**LANGUAGE**: JavaScript
**CODE**:
```javascript
// In your fragment controller (or extension controller)
SalesPriceInitialise: function(oEvent) {
  var oSmartTable = oEvent.getSource();
  // extensionAPI must be resolved using the official Fiori elements Extension API helper
  var oExtensionAPI = extensionAPI.getExtensionAPI(oSmartTable);
  oExtensionAPI.setAsTitleOwner(oSmartTable);
}
```

**STEP**: OData V4 — Create XML Fragment for New Section
**DESCRIPTION**: Create fragment under webapp/ext. Use core:require if you need a local handler object for events from fragment controls.
**LANGUAGE**: XML
**CODE**:
```xml
File: webapp/ext/CustomSection.fragment.xml
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m" xmlns:l="sap.ui.layout">
  <l:VerticalLayout core:require="{handler: 'SalesOrder/ext/CustomColumn'}">
    <Button text="Custom Button" press="handler.buttonPressed" />
  </l:VerticalLayout>
</core:FragmentDefinition>
```

**STEP**: OData V4 — Provide Fragment Handler (optional)
**DESCRIPTION**: If your fragment uses core:require to reference a handler, implement the handler module. Example shows a simple message handler.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// File: webapp/ext/CustomColumn.js  (or SalesOrder/ext/CustomColumn as referenced)
sap.ui.define(["sap/m/MessageBox"], function(MessageBox) {
  "use strict";
  return {
    buttonPressed: function() {
      MessageBox.show("Button pressed!");
    }
  };
});
```

**STEP**: OData V4 — Add Translatable Title to i18n
**DESCRIPTION**: Add the custom section title key to the i18n resource bundle.
**LANGUAGE**: text
**CODE**:
```text
File: webapp/i18n/i18n.properties
# This is the resource bundle
# XTIT: Title of a facet within an object page
customSection=Custom Section
```

**STEP**: OData V4 — Register Custom Section in manifest.json (routing target)
**DESCRIPTION**: Add a custom section to the object page by declaring it under the routing target options.settings.content.body.sections. Provide type XMLFragment, template (namespace path), title and position (placement/anchor).
**LANGUAGE**: JSON
**CODE**:
```json
// Insert under "sap.ui5" -> "routing" -> "targets" -> "SalesOrderManageObjectPage" -> "options" -> "settings"
{
  "content": {
    "body": {
      "sections": {
        "customSection": {
          "type": "XMLFragment",
          "template": "SalesOrder.ext.CustomSection",
          "title": "{i18n>customSection}",
          "position": {
            "placement": "Before",
            "anchor": "SalesOrderItems"
          }
        },
        "anotherCustomSection": {
          "type": "XMLFragment",
          "template": "SalesOrder.ext.CustomFieldForm",
          "title": "Field Form",
          "position": {
            "placement": "After",
            "anchor": "customSection"
          }
        }
      }
    }
  }
}
```

**STEP**: OData V4 — Use IDs for Multiple Custom Sections
**DESCRIPTION**: When defining multiple sections, use unique keys (IDs) like "customSection" and "anotherCustomSection" — these become the runtime control IDs for the added sections.

**LANGUAGE**: text
**CODE**:
```text
// Example: The keys "customSection" and "anotherCustomSection" are used as IDs for the resulting controls.
```

**STEP**: OData V4 — Merge Section Title with Control Title (Page layout) using onSectionLoaded
**DESCRIPTION**: For Page layout mode where you want the section title merged with a control title (for sections that use building blocks inside a layout), define an onSectionLoaded handler in the manifest for that section. Implement the handler to call setAsSectionTitleOwner (extension API) and pass the correct control instance to be used as the title owner.
**LANGUAGE**: JSON
**CODE**:
```json
// Manifest snippet: set onSectionLoaded to a controller method
"routing": {
  "targets": {
    "SalesOrderManageObjectPage": {
      "options": {
        "settings": {
          "sectionLayout": "Page",
          "content": {
            "body": {
              "sections": {
                "customSectionTableHBox": {
                  "type": "XMLFragment",
                  "template": "SalesOrder.custom.CustomSectionBuildingBlockTableHBox",
                  "title": "HBox Table",
                  "onSectionLoaded": "SalesOrder.custom.CustomSection.callShowSectionTitle"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**LANGUAGE**: JavaScript
**CODE**:
```javascript
// Custom controller method referenced by onSectionLoaded
callShowSectionTitle: function(section) {
  // Locate the inner control you want to be the title owner.
  // Adjust fragment traversal to match your fragment structure.
  const control = section.getSubSections()[0].getBlocks()[0].getContent().getItems()[0];
  // setAsSectionTitleOwner is provided by the FE extension API (sap.fe.templates/.../ExtensionAPI.ts)
  this.setAsSectionTitleOwner(control);
}
```

**STEP**: Notes & Cautions (extension API and responsibilities)
**DESCRIPTION**: Important rules when using app extensions:
- Use extensions only if manifest/annotations cannot achieve the desired behavior.
- Use only the official extensionAPI of SAP Fiori elements to integrate app extension code.
- After creating an app extension, layout and behavior are the app's responsibility — do not manipulate internal controls or models created by the framework.
**LANGUAGE**: text
**CODE**:
```text
// Reference: Use the official extensionAPI methods only (e.g., setAsTitleOwner, setAsSectionTitleOwner).
// See: using-the-extensionapi-bd2994b.md for extension API details and best practices.
```
--------------------------------

**TITLE**: Add a Custom ViewExtension / Custom Fragment to the Mass Edit Dialog (OData V2 & V4)

**INTRODUCTION**: This document shows how to add custom UI controls to the Mass Edit dialog in Fiori Elements for OData V2 and OData V4. It includes manifest.json entries, example fragment XMLs, and the controller extension to implement a custom save. Follow the namespace, stable ID, and container requirements described below.

**TAGS**: fiori-elements-framework, mass-edit, viewextension, custom-fragment, manifest.json, odata-v2, odata-v4, sapui5, fragment, controller-extension

STEP: OData V2 — Add ViewExtension entry to manifest.json
DESCRIPTION: Add a ViewExtension entry under sap.ui5 -> extends -> extensions -> sap.ui.viewExtensions to inject a fragment into the Mass Edit dialog for a ListReport. The key format is "MultiEditFieldsExtension|<EntitySet>" or "MultiEditFieldsExtension|<EntitySet>|<VariantKey>" when using quickVariantSelectionX (V2 details below).
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "MultiEditFieldsExtension|STTA_C_SO_SalesOrder_ND": { 
              "className": "sap.ui.core.Fragment",
              "fragmentName": "STTA_SO_ND.ext.fragments.MultiEditFieldsExtension",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Use ViewExtension with quickVariantSelectionX (variant-specific fragment)
DESCRIPTION: When a page uses quickVariantSelectionX, append the variant key after a pipe to the ViewExtension key. The variant key must match the "key" property in quickVariantSelectionX -> variants. This sample shows both the viewExtensions entry and the corresponding quickVariantSelectionX page configuration.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "MultiEditFieldsExtension|C_STTA_SalesOrder_WD_20|1": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "ManageSalesOrderWithTableTabs.ext.fragments.MultiEditFieldsExtension",
              "type": "XML"
            }
          }
        }
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [{
      "entitySet": "C_STTA_SalesOrder_WD_20",
      "component": {
        "name": "sap.suite.ui.generic.template.ListReport",
        "list": true,
        "settings": {
          "quickVariantSelectionX": {
            "showCounts": true,
            "variants": {
              "0": {
                "key": "1", 
                "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive",
                "tableSettings": {
                  "multiEdit": {
                    "enabled": true
                  }
                }
              }
            }
          }
        }
      }
    }]
  }
}
```

STEP: OData V2 — Fragment for MultiEditFieldsExtension (XML)
DESCRIPTION: Create the fragment referenced by fragmentName in the manifest. Controls must be wrapped in a GroupElement. Provide stable IDs for inputs and use beforeMultiEditSaveExtension to read/handle values (see notes).
LANGUAGE: XML
CODE:
```xml
<!-- File: webapp/ext/fragments/MultiEditFieldsExtension.fragment.xml -->
<core:FragmentDefinition xmlns:sfo="sap.ui.comp.smartform"
                         xmlns:core="sap.ui.core"
                         xmlns="sap.m">
    <sfo:GroupElement>
        <Label text="Rating Bar" labelFor="RI_default"/>
        <RatingIndicator id="RI_default" maxValue="5" class="sapUiSmallMarginBottom" value="4"/>
    </sfo:GroupElement>
</core:FragmentDefinition>
```

STEP: OData V2 — Notes (handling inputs and IDs)
DESCRIPTION: Implementation details and requirements for V2:
- Wrap custom controls in a GroupElement (sap.ui.comp.smartform).
- Provide stable IDs for custom input fields (recommended prefix: <appPrefix>--<fragmentId>--<controlId>).
- Use beforeMultiEditSaveExtension in the controller extension to read values from your fragment controls and inject them into the mass-edit handling logic. The extension hook should collect values from controls by their stable IDs and map them into update data passed to the standard save.

STEP: OData V4 — Declare customFragment for Mass Edit in manifest.json
DESCRIPTION: For OData V4, enable a custom fragment for mass edit by setting enableMassEdit.customFragment for the target LineItem in options.settings.controlConfiguration. The value is the fragment module path.
LANGUAGE: JSON
CODE:
```json
{
  "options": {
    "settings": {
      "contextPath": "/RootEntity",
      "variantManagement": "Control",
      "controlConfiguration": {
        "_Child/@com.sap.vocabularies.UI.v1.LineItem": {
          "tableSettings": {
            "type": "GridTable",
            "enableMassEdit": {
              "customFragment": "sap.fe.core.fpmExplorer.ext.fragment.customMassEdit"
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V4 — Fragment XML for customMassEdit (FormContainer)
DESCRIPTION: The custom fragment must wrap controls in a FormContainer. Provide stable IDs. This example creates a checkbox with id "myCheckBox".
LANGUAGE: XML
CODE:
```xml
<!-- File: webapp/ext/fragment/customMassEdit.fragment.xml -->
<core:FragmentDefinition xmlns:form="sap.ui.layout.form" xmlns:core="sap.ui.core" xmlns="sap.m">
    <form:FormContainer>
        <form:formElements>
            <form:FormElement label="Execute with the custom Save">
                <form:fields>
                    <CheckBox id="myCheckBox"/>
                </form:fields>
            </form:FormElement>
        </form:formElements>
    </form:FormContainer>
</core:FragmentDefinition>
```

STEP: OData V4 — Implement customMassEditSave in a Controller Extension
DESCRIPTION: Implement editFlow.customMassEditSave in a controller extension. The function receives aParameters (aParameters.aContexts array of selected contexts, aParameters.oUpdateData dictionary mapping propertyPath -> updated value). Return true to indicate you handled the save (prevent default mass-edit). The example invokes a backend action and shows a MessageToast on failure.
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/ext/controller/OPExtend.controller.js
sap.ui.define([
    "sap/ui/core/mvc/ControllerExtension",
    "sap/m/MessageToast",
    "sap/ui/core/Core"
], function (ControllerExtension, MessageToast, Core) {
    "use strict";

    return ControllerExtension.extend("sap.fe.core.fpmExplorer.OPExtend", {
        override: {
            editFlow: {
                /**
                 * aParameters.aContexts: array containing the selected contexts for the mass edit
                 * aParameters.oUpdateData: dictionary containing propertyPath -> updated value
                 *
                 * Return true if custom save was executed (skip default mass-edit).
                 */
                customMassEditSave: async function (aParameters) {
                    // Retrieve control value in the custom fragment. Adjust id to your fragment's generated id prefix if needed.
                    const isSelected = Core.byId("customMassEdit--myCheckBox") && Core.byId("customMassEdit--myCheckBox").getSelected();

                    if (isSelected) {
                        try {
                            await this.base.editFlow.invokeAction("Service.customUpdateAction", {
                                contexts: aParameters.aContexts,
                                parameterValues: aParameters.oUpdateData
                            });
                        } catch (e) {
                            MessageToast.show("Custom save failed");
                        }
                    }

                    // Return true to prevent the standard mass-edit save when custom save executed.
                    return !!isSelected;
                }
            }
        }
    });
});
```
--------------------------------

**TITLE**: Add Micro Charts to Table Columns (Fiori Elements, OData V2/V4)

**INTRODUCTION**: This guide shows how to add micro charts (area, bullet, etc.) into table columns for Fiori Elements applications (OData V2 and V4). It covers: placing charts in UI.LineItem via UI.DataFieldForAnnotation, defining UI.Chart and UI.DataPoint annotations (XML, ABAP CDS, CAP CDS), configuring micro chart size and labels in manifest.json, and enabling presentation-variant sorting for micro charts.

**TAGS**: fiori-elements, micro-chart, UI.Chart, UI.DataPoint, UI.LineItem, DataFieldForAnnotation, CDS, ABAP, CAP, manifest.json, presentation-variant

STEP: 1 — Add a micro chart to a table column (OData V2 / OData V4)
DESCRIPTION: Add a UI.DataFieldForAnnotation entry into the UI.LineItem annotation that references a micro chart (UI.Chart qualifier) or datapoint. Use AnnotationPath to reference the chart or datapoint. The control renders a SmartMicroChart in the table column.
LANGUAGE: XML
CODE:
```xml
<!-- Example: Add a chart reference to the LineItem of an entity -->
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="UI.LineItem">
    <Collection>
      <!-- Standard column -->
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Product"/>
      </Record>

      <!-- Micro chart column referencing a Chart qualifier -->
      <Record Type="UI.DataFieldForAnnotation">
        <PropertyValue Property="Target" AnnotationPath="@UI.Chart#AreaChartQualifier"/>
        <PropertyValue Property="Label" String="Sales Price"/>
      </Record>

      <!-- Micro chart column referencing a DataPoint (if chart uses DataPoint) -->
      <Record Type="UI.DataFieldForAnnotation">
        <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#BulletChartRevenue"/>
        <PropertyValue Property="Label" String="Revenue"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: 2 — UI.LineItem: concise CAP and ABAP CDS equivalents
DESCRIPTION: Equivalent LineItem entries for CAP CDS and ABAP CDS that define a DataFieldForAnnotation entry pointing to a chart/dataPoint qualifier.
LANGUAGE: CAP CDS
CODE:
```cdd
// CAP CDS snippet: attach a DataFieldForAnnotation referencing a Chart qualifier
annotate YourNamespace.YourView with {
  @UI.lineItem: [
    { $Type: 'UI.DataField', Value: 'Product' },
    {
      $Type: 'UI.DataFieldForAnnotation',
      Target: '@UI.Chart#AreaChartQualifier',
      Label: 'Sales Price'
    },
    {
      $Type: 'UI.DataFieldForAnnotation',
      Target: '@UI.DataPoint#BulletChartRevenue',
      Label: 'Revenue'
    }
  ];
}
```

LANGUAGE: ABAP CDS
CODE:
```abap
// ABAP CDS snippet: attach UI.LineItem with DataFieldForAnnotation
@UI.lineItem: [
  { value: 'Product' },
  { $Type: #AS_ANNOTATION, valueQualifier: 'AreaChartQualifier', value: '_YourChartSource' },
  { $Type: #AS_ANNOTATION, valueQualifier: 'BulletChartRevenue', value: '_YourChartSource' }
]
define view entity YourView as select from YourEntity { ... }
```

STEP: 3 — Define Area Micro Chart (XML and ABAP CDS)
DESCRIPTION: Create a UI.Chart annotation with qualifier and specify dimensions, measures, and measureAttributes. Link measureAttributes to a UI.DataPoint via AnnotationPath.
LANGUAGE: XML
CODE:
```xml
<!-- UI.Chart: Area Micro Chart definition (XML) -->
<Annotation Term="UI.Chart" Qualifier="AreaChartQualifier">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Sales Price" />
    <PropertyValue Property="Description" String="Area Micro Chart" />
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Area" />
    <PropertyValue Property="Dimensions">
      <Collection>
        <PropertyPath>PriceDay</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Measures">
      <Collection>
        <PropertyPath>AreaChartPrice</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="AreaChartPrice" />
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
          <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#AreaChartPrice" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Chart: [{
  title: 'Sales Price',
  description: 'Area Micro Chart',
  chartType: #AREA,
  dimensions: ['PRICEDAY'],
  measures: ['AREACHARTPRICE'],
  measureAttributes: [{ measure: 'AREACHARTPRICE', role: #AXIS_1, asDataPoint: true }],
  qualifier: 'AreaChartQualifier'
}]
annotate view ITEM with { }
```

STEP: 4 — Define Bullet Micro Chart (XML and ABAP CDS)
DESCRIPTION: Create a UI.Chart qualifier for a bullet micro chart. Link measureAttributes to a UI.DataPoint qualifier for criticality and target values.
LANGUAGE: XML
CODE:
```xml
<!-- UI.Chart: Bullet Micro Chart definition (XML) -->
<Annotation Term="UI.Chart" Qualifier="BulletChartQualifier">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Sales Revenue" />
    <PropertyValue Property="Description" String="Bullet Micro Chart" />
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bullet" />
    <PropertyValue Property="Measures">
      <Collection>
        <PropertyPath>BulletChartRevenue</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="BulletChartRevenue" />
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
          <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#BulletChartRevenue" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Chart: [{
  title: 'Sales Revenue',
  description: 'Bullet Micro Chart',
  chartType: #BULLET,
  measures: ['BULLETCHARTREVENUE'],
  measureAttributes: [{ measure: 'BULLETCHARTREVENUE', role: #AXIS_1, asDataPoint: true }],
  qualifier: 'BulletChartQualifier'
}]
annotate view ITEM with { }
```

STEP: 5 — Define UI.DataPoint for micro charts (XML and ABAP CDS)
DESCRIPTION: Define UI.DataPoint qualifiers referenced by UI.Chart.measureAttributes. Include Title (required), Value, TargetValue, ForecastValue, Min/Max, Criticality or CriticalityCalculation.
LANGUAGE: XML
CODE:
```xml
<!-- UI.DataPoint for Area Chart: uses CriticalityCalculation -->
<Annotation Term="UI.DataPoint" Qualifier="AreaChartPrice">
  <Record>
    <PropertyValue Property="Title" String="Sales Price" />
    <PropertyValue Property="Value" Path="AreaChartPrice" />
    <PropertyValue Property="TargetValue" Path="TargetPrice" />
    <PropertyValue Property="CriticalityCalculation">
      <Record>
        <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Target" />
        <PropertyValue Property="DeviationRangeHighValue" Path="DeviationUpperBoundPrice" />
        <PropertyValue Property="DeviationRangeLowValue" Path="DeviationLowerBoundPrice" />
        <PropertyValue Property="ToleranceRangeHighValue" Path="ToleranceUpperBoundPrice" />
        <PropertyValue Property="ToleranceRangeLowValue" Path="ToleranceLowerBoundPrice" />
      </Record>
    </PropertyValue>
  </Record>
</Annotation>

<!-- UI.DataPoint for Bullet Chart: uses Criticality -->
<Annotation Term="UI.DataPoint" Qualifier="BulletChartRevenue">
  <Record>
    <PropertyValue Property="Title" String="Sales Revenue" />
    <PropertyValue Property="Value" Path="BulletChartRevenue" />
    <PropertyValue Property="TargetValue" Path="TargetRevenue" />
    <PropertyValue Property="ForecastValue" Path="ForecastRevenue" />
    <PropertyValue Property="MinimumValue" Decimal="100" />
    <PropertyValue Property="MaximumValue" Decimal="300" />
    <PropertyValue Property="Criticality" Path="Criticality" />
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
// Area DataPoint with CriticalityCalculation
@UI.dataPoint: {
  title: 'Sales Price',
  targetValueElement: 'TargetPrice',
  criticalityCalculation: {
    improvementDirection: #TARGET,
    deviationRangeHighValueElement: 'DeviationUpperBoundPrice',
    deviationRangeLowValueElement: 'DeviationLowerBoundPrice',
    toleranceRangeHighValueElement: 'ToleranceUpperBoundPrice',
    toleranceRangeLowValueElement: 'ToleranceLowerBoundPrice'
  }
}
AreaChartPrice;

// Bullet DataPoint with Criticality
@UI.dataPoint: {
  title: 'Sales Revenue',
  targetValueElement: 'TargetRevenue',
  forecastValue: 'ForecastRevenue',
  minimumValue: 100,
  maximumValue: 300,
  criticality: 'Criticality'
}
BulletChartRevenue;
```

STEP: 6 — CDS annotation snippets for UI.Chart and UI.DataPoint (types and examples)
DESCRIPTION: Provide CDS-style type definitions and short annotation examples for reuse in local CDS files.
LANGUAGE: CDS
CODE:
```cdd
// CDS: UI.Chart type example (struct excerpt)
chart : array of {
  qualifier : String(120);
  title : String(60);
  description : String(120);
  chartType : String enum { AREA; BULLET; LINE; COLUMN; ... };
  dimensions : array of elementRef;
  measures : array of elementRef;
  measureAttributes : array of { measure: elementRef; role: String enum { AXIS_1; AXIS_2; }; asDataPoint: Boolean default true; };
}

// Example usage for area chart in CDS
@UI.chart:[{
  title: 'Sales Price',
  description: 'Area Micro Chart',
  chartType: #AREA,
  dimensions:['PriceDay'],
  measures:['AreaChartPrice'],
  measureAttributes: [{ measure: 'AreaChartPrice', role: #AXIS_1, asDataPoint: true }],
  qualifier: 'AreaChartQualifier'
}]
```

STEP: 7 — Configure micro chart size and labels in manifest.json
DESCRIPTION: Override default micro chart size (default XS) and show/hide micro chart labels via controlConfiguration for the LineItem property path. Use fully qualified key for the column. Trim whitespace in keys and values.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "models": { /* ... */ },
    "resources": { /* ... */ }
  },
  "sap.app": { /* ... */ },
  "options": {
    "settings": {
      "controlConfiguration": {
        "@com.sap.vocabularies.UI.v1.LineItem": {
          "columns": {
            "DataFieldForAnnotation::_CreditLimitDetails::Chart::RadialCriticalityPathHidden": {
              "settings": {
                "microChartSize": "M",
                "showMicroChartLabel": true
              }
            }
          },
          "tableSettings": {
            "type": "ResponsiveTable"
          }
        }
      }
    }
  }
}
```

STEP: 8 — Enable sorting for micro charts using UI.PresentationVariant
DESCRIPTION: To apply sort order to the micro chart data, add a UI.PresentationVariant with SortOrder (SortOrderType) and have the UI.DataFieldForAnnotation Target point to the PresentationVariant qualifier. Micro charts support SortOrder (ascending/descending) for certain chart types. Use XML local annotations for this.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd.SalesOrderItem">
  <!-- LineItem includes DataFieldForAnnotation that references a PresentationVariant qualifier -->
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataFieldForAnnotation">
        <PropertyValue Property="Target" AnnotationPath="_Item/@com.sap.vocabularies.UI.v1.PresentationVariant#AreaMaxPath" />
        <PropertyValue Property="Label" String="Credit Limit Details"/>
        <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Low"/>
      </Record>
    </Collection>
  </Annotation>

  <!-- PresentationVariant with SortOrder referencing the Chart qualifier -->
  <Annotation Term="UI.PresentationVariant" Qualifier="AreaMaxPath">
    <Record Type="UI.PresentationVariantType">
      <PropertyValue Property="Visualizations">
        <Collection>
          <AnnotationPath>@UI.Chart#AreaMaxPath</AnnotationPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="SortOrder">
        <Collection>
          <Record Type="Common.SortOrderType">
            <PropertyValue Property="Property" PropertyPath="NetAmount"/>
            <PropertyValue Property="Descending" Bool="true"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <!-- Chart qualifier referenced above -->
  <Annotation Term="UI.Chart" Qualifier="AreaMaxPath">
    <!-- chart definition -->
  </Annotation>
</Annotations>
```

STEP: 9 — Restriction and rendering notes
DESCRIPTION: Important limitations and rendering conditions to consider when coding:
- The template does not support navigation properties inside UI.Chart measures/dimensions for micro charts; avoid using navigation property paths in UI.Chart.
- In tables the micro chart is rendered in XS size by default and without title/description/dimension/measure labels or footers.
- Micro charts may not render if back-end data retrieval fails or no data is available.

LANGUAGE: Text
CODE:
```text
Restrictions:
- Do not use navigation properties inside UI.Chart for micro charts (unsupported by the template).
- Micro charts in table cells are compact (XS by default) and do not display extended metadata.
- Ensure back-end provides required measure and dimension elements; charts will not render on missing/errored data.
```


--------------------------------

**TITLE**: Add a Progress Indicator to a Table Using Annotations (XML, ABAP CDS, CAP CDS)

**INTRODUCTION**: This document shows how to add a progress indicator visualization to a table column in Fiori Elements by creating a UI.DataPoint annotation (qualified) and referencing it from the UI.LineItem. Examples are provided for XML annotations, ABAP CDS, and CAP CDS. Also shows how to change the progress bar color using the Criticality property.

**TAGS**: fiori-elements-framework, progress-indicator, UI.DataPoint, UI.LineItem, annotations, XML, ABAP-CDS, CAP-CDS, criticality

**STEP**: 1 — Define a qualified UI.DataPoint and reference it in the table (XML annotation file)

**DESCRIPTION**: Create an annotations XML file that defines a UI.DataPoint with a Qualifier (e.g. "Progress"). Set Value, TargetValue, and Visualization (Progress). Then reference that data point in the UI.LineItem collection using a UI.DataFieldForAnnotation with Target set to the DataPoint qualifier via AnnotationPath="@UI.DataPoint#Progress". This renders a progress indicator column in the table.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: annotations.xml (example) -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <!-- Define a qualified DataPoint that will be used as a progress indicator -->
    <Annotation Term="UI.DataPoint" Qualifier="Progress">
        <Record>
            <!-- Source value for the progress (current value) -->
            <PropertyValue Property="Value" Path="to_StockAvailability/Quantity" />
            <!-- Target value for the progress bar (e.g. percentage max or absolute max) -->
            <PropertyValue Property="TargetValue" Decimal="100" />
            <!-- Set the visualization type to Progress -->
            <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Progress" />
        </Record>
    </Annotation>

    <!-- Reference the DataPoint from the table LineItem -->
    <Annotation Term="UI.LineItem">
        <Collection>
            <Record Type="UI.DataFieldForAnnotation">
                <PropertyValue Property="Label" String="Progress" />
                <!-- Optionally define Criticality (if you want color changes) -->
                <PropertyValue Property="Criticality" Path="to_StockAvailability/Quantity" />
                <!-- Reference the qualified DataPoint using AnnotationPath -->
                <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Progress" />
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```

**STEP**: 2 — ABAP CDS: annotate a view / field as a progress DataPoint and expose it in the line item

**DESCRIPTION**: Use ABAP CDS annotation syntax to mark a field as a DataPoint with visualization #PROGRESS and a target value. Then add a UI.LineItem entry that references this DataPoint via valueQualifier / type #AS_DATAPOINT.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
/* File: CDS view or annotation include */

annotate view STTA_C_MP_StockAvailability with {
  @UI.dataPoint: { targetValue: 100, visualization: #PROGRESS }
  Quantity;
}

/* In the consumer view/entity (example) */
@UI.lineItem: [
  {
    label: 'Progress',
    criticality: 'TO_STOCKAVAILABILITY/QUANTITY',
    valueQualifier: 'Progress',        " qualifier name (if using a separate annotated datapoint variant )
    type: #AS_DATAPOINT
  }
]
progress;
```

**STEP**: 3 — CAP CDS: annotate an entity with UI.DataPoint and UI.LineItem

**DESCRIPTION**: In CAP CDS, annotate the entity or type to define a qualified DataPoint (#Progress) with Value pointing to a related property, a TargetValue, and Visualization set to #Progress. Then include a UI.LineItem DataFieldForAnnotation that targets the DataPoint with Target : '@UI.DataPoint#Progress'.

**LANGUAGE**: CDS (CAP)

**CODE**:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with (
  UI.DataPoint #Progress : {
    Value : to_StockAvailability.Quantity,
    TargetValue : 100,
    Visualization : #Progress
  },
  UI.LineItem : [
    {
      $Type : 'UI.DataFieldForAnnotation',
      Label : 'Progress',
      Criticality : to_StockAvailability.Quantity,
      Target : '@UI.DataPoint#Progress'
    }
  ]
);
```

**STEP**: 4 — Change progress bar color using Criticality (XML example)

**DESCRIPTION**: To change the color of the progress bar according to progress state, set the DataPoint's Criticality property to a path that evaluates to the criticality value for the row. The referenced property must provide the expected criticality value (numeric or enum) for your UI to interpret (e.g., Good/Warning/Critical).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: annotations-color.xml -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="UI.DataPoint" Qualifier="Quantity">
        <Record>
            <PropertyValue Property="Value" Path="Quantity"/>
            <PropertyValue Property="Title" String="{@i18n>Availability}"/>
            <PropertyValue Property="Description" String="Progress Indicator"/>
            <PropertyValue Property="TargetValue" Decimal="150"/>
            <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Progress"/>
            <!-- Path to the property that determines criticality/color -->
            <PropertyValue Property="Criticality" Path="StockAvailability"/>
        </Record>
    </Annotation>
</Annotations>
```

Notes:
- Use AnnotationPath="@UI.DataPoint#QualifierName" in UI.LineItem to reference the specific DataPoint qualifier.
- Visualization EnumMember values: UI.VisualizationType/Progress (for progress bar).
- Criticality path must map to the criticality semantics expected by the framework (e.g., Good/Neutral/Critical) for color changes.
--------------------------------

**TITLE**: Adding a Read-Only Rating Indicator (stars) to a Fiori Elements Table

**INTRODUCTION**: Show a numeric backend field as a read-only star rating in a table (LineItem). Define the maximum number of stars and link the DataPoint to the LineItem. Decimal values display half stars for values between x.25 and x.74; other decimals round up or down.

**TAGS**: fiori-elements-framework, annotations, UI.DataPoint, UI.LineItem, rating, stars, OData, CDS, CAP, ABAP

**STEP**: 1 — OData XML Annotations: create UI.DataPoint (Rating) and reference it in UI.LineItem

**DESCRIPTION**: Add an OData annotation record of term UI.DataPoint with Visualization set to Rating and TargetValue = maximum number of stars. Then reference that DataPoint in the entity's UI.LineItem as a DataFieldForAnnotation so the table shows a read-only rating indicator.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Add this to your annotation XML file that is consumed by the Fiori elements app -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType">
    <!-- DataPoint that drives the rating stars -->
    <Annotation Term="UI.DataPoint" Qualifier="Rating">
        <Record>
            <!-- Path to the numeric backend value to visualize as stars -->
            <PropertyValue Property="Value" Path="to_StockAvailability/StockAvailability" />
            <!-- Maximum number of stars shown -->
            <PropertyValue Property="TargetValue" Decimal="4" />
            <!-- Use the Rating visualization (read-only) -->
            <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Rating" />
        </Record>
    </Annotation>

    <!-- Reference the DataPoint inside the LineItem so the table column shows the stars -->
    <Annotation Term="UI.LineItem">
        <Collection>
            <Record Type="UI.DataFieldForAnnotation">
                <PropertyValue Property="Label" String="Rating" />
                <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Rating" />
            </Record>
            <!-- other line items ... -->
        </Collection>
    </Annotation>
</Annotations>
```

**STEP**: 2 — ABAP CDS Annotation: DataPoint + LineItem for rating in ABAP CDS view

**DESCRIPTION**: In the ABAP CDS view annotate the field with @UI.dataPoint to set visualization to RATING and targetValue to define maximum stars. Add a @UI.lineItem entry using type #AS_DATAPOINT and valueQualifier: 'Rating' to expose it in the table.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
annotate view STTA_C_MP_PRODUCT with {
  @UI.lineItem: [
    {
      label: 'Rating',
      valueQualifier: 'Rating',
      type: #AS_DATAPOINT,
      position: 1
    }
  ]
  @UI.dataPoint: {
    targetValue: 4,
    visualization: #RATING
  }
  to_stockavailability/stockavailability;
}
```

**STEP**: 3 — CAP CDS Annotation: DataPoint + LineItem for rating in CAP model

**DESCRIPTION**: For CAP-based projects annotate the entity with UI.DataPoint (named qualifier #Rating) referencing the numeric field, set TargetValue to the number of stars and Visualization to #Rating. Add a UI.LineItem entry of type UI.DataFieldForAnnotation that targets the DataPoint qualifier.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductType @(

  UI.DataPoint #Rating : {
    Value : to_StockAvailability.StockAvailability,
    TargetValue : 4,
    Visualization : #Rating
  },

  UI.LineItem : [
    {
      $Type : 'UI.DataFieldForAnnotation',
      Label : 'Rating',
      Target : '@UI.DataPoint#Rating'
    },
    // other line items ...
  ]
);
```

**STEP**: 4 — Behavior, configuration and implementation notes

**DESCRIPTION**: Keep these operational rules and tips when implementing the rating indicator.

**LANGUAGE**: text

**CODE**:
```
- Reading only: The Rating visualization is read-only; it displays values from the backend field.
- TargetValue: Defines the maximum number of stars (e.g., Decimal="4" shows up to 4 stars).
- Decimal handling:
  - Values between x.25 and x.74 -> display a half star.
  - Other decimals are rounded up or down accordingly.
- Ensure the DataPoint.Value path points to a numeric backend property.
- Place XML annotations in the annotations file consumed by your Fiori elements app or apply CDS annotations in the model/view where the entity is defined.
```
--------------------------------

**TITLE**: Add an Object Page Section and Fields using SAP Fiori Tools (Fiori elements, OData V4)

**INTRODUCTION**: This guide shows the exact UI steps in SAP Fiori Tools (Business Application Studio / VS Code extension) to add a new section to an Object Page and add fields into it, and shows the manifest.json changes that the tool creates/edits. Use this when automating or generating project scaffolding, or when programmatically editing webapp/manifest.json for Fiori elements (OData V4 Object Page).

**TAGS**: fiori-elements-framework, sap-fiori-tools, object-page, manifest.json, odata-v4, business-application-studio, sap.suite.ui.generic.template

STEP: 1 — Open Page Map and Page Editor (UI action)

DESCRIPTION: Launch the Page Map for your project and open the Page Editor for the Object Page where you want to add a section.
- In Business Application Studio: Right-click the project folder → Show Page Map.
- In Page Map: click the ✏️ (Edit) icon next to the Object Page to open the Page Editor.

LANGUAGE: N/A

CODE:
```text
UI actions:
1. Right-click project folder -> Show Page Map
2. In Page Map, click Edit (✏️) next to the Object Page
```

STEP: 2 — Add a new Section (UI action + manifest.json target)

DESCRIPTION: Use the Page Editor: click ➕ (Add) next to Sections, choose the section type, name it, select Value Source, then click Add. The Page Editor edits webapp/manifest.json under the sap.ui.generic.app/pages entry for that entity set. Below is a representative manifest.json snippet showing where the section metadata is stored after you add it. Replace EntitySetName and property bindings with your actual entity set and properties.

LANGUAGE: JSON

CODE:
```json
// webapp/manifest.json (snippet)
// Location: sap.ui.generic.app -> pages -> find page entry for your entitySet
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "EntitySetName",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "sections": {
              "Section::MySection": {
                "id": "Section::MySection",
                "title": "My Section Title",
                "valueSource": "Annotation",  // or "Metadata", "Manual", etc. (as set by the tool)
                "position": 1
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 3 — Add Basic Fields to the Section (UI action + manifest.json target)

DESCRIPTION: In the Page Editor outline tree expand Sections → expand the new section → click ➕ (Add) next to Fields → Add Basic Fields → pick fields → Add. The Page Editor will append field definitions under the section entry in webapp/manifest.json (or maintain references to annotations). Example below shows fields stored inline in the section metadata for quick reference; real projects may instead reference annotation targets.

LANGUAGE: JSON

CODE:
```json
// webapp/manifest.json (snippet showing fields inside the section)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "EntitySetName",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "sections": {
              "Section::MySection": {
                "id": "Section::MySection",
                "title": "My Section Title",
                "valueSource": "Annotation",
                "position": 1,
                "fields": [
                  {
                    "id": "Field::OrderID",
                    "label": "Order ID",
                    "value": "{OrderID}"
                  },
                  {
                    "id": "Field::Amount",
                    "label": "Amount",
                    "value": "{Amount}"
                  }
                ]
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 4 — If using OData V4 annotations: add / update annotation (CDS/annotation example)

DESCRIPTION: If your Object Page uses annotations (recommended), the Fiori Tools may create or update annotations. Below is an example of a UI Facets (ReferenceFacet) annotation that maps a facet/section to a navigation path or to a collection of fields. Adapt the annotation target to your entity type and property names.

LANGUAGE: XML

CODE:
```xml
<!-- annotations.xml (OData V4 UI Facets example) -->
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="UI.Facets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="My Section Title"/>
        <!-- For a simple FieldGroup (inline fields) use Target with an inline Collection/Record for DataFieldReferences -->
        <PropertyValue Property="Target">
          <Record Type="UI.FragmentAnnotation">
            <!-- The fragment name / path depends on your generated annotations or manifest settings -->
            <PropertyValue Property="FragmentName" String="com.sap.vocabularies.UI.v1.FieldGroup"/>
          </Record>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: 5 — Preview your changes

DESCRIPTION: Use Fiori Tools preview to run the app and verify the new section and fields render correctly:
- In Business Application Studio: right-click the project → Open With → Application Preview (or use the Fiori tools preview command).
- Alternatively run the local server (e.g., npm start) and open the preview URL provided by the SAP Fiori Tools.

LANGUAGE: N/A

CODE:
```text
Preview actions:
1. Right-click project -> Open With -> Application Preview
2. Or run the preview command configured in the project (e.g. `npm start` or `fiori run`)
3. Navigate to the Object Page for EntitySetName and verify the "My Section Title" section and its fields.
```

STEP: 6 — Where changes are persisted

DESCRIPTION: Edits made in the Page Editor are persisted in:
- webapp/manifest.json (sap.ui.generic.app -> pages -> component -> settings -> sections)
- Annotation files (annotations.xml / annotation folder) if Value Source = Annotation
- If you need to script changes, modify webapp/manifest.json or the annotation files and validate with the Fiori tools.

LANGUAGE: JSON

CODE:
```text
Files to check after editing:
- webapp/manifest.json
- webapp/annotations/annotations.xml (or other annotation files)
- webapp/changes/ (optional: tooling-generated changes)
```

Note: This workflow and the manifest/annotation locations apply to SAP Fiori elements for OData V4 Object Pages. For more details on Page Map and Page Editor usage, consult the SAP Fiori Tools documentation: https://help.sap.com/docs/SAP_FIORI_tools.
--------------------------------

**TITLE**: Add Form Action Buttons to Object Page Sections (FieldGroup / Identification / StatusInfo)

**INTRODUCTION**: This guide shows how to add action buttons (OData-bound actions and intent-based navigation) to forms in object page sections. It includes XML, ABAP CDS, and CAP CDS examples for: defining FieldGroup actions, linking FieldGroup to a ReferenceFacet, adding actions via Identification/StatusInfo, placing actions inline in the form toolbar, controlling visibility/enablement, passing context, and emphasizing a primary action.

**TAGS**: fiori-elements-framework, annotations, FieldGroup, DataFieldForAction, DataFieldForIntentBasedNavigation, UI.ReferenceFacet, UI.Identification, UI.StatusInfo, inline

**STEP**: 1 — Define a FieldGroup with action buttons (XML)

**DESCRIPTION**: Add DataFieldForAction and DataFieldForIntentBasedNavigation entries to the FieldGroup.Data collection. This renders buttons in the section toolbar for the referenced FieldGroup. Use Action for OData function import (bound/unbound) and SemanticObject for intent navigation.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="TechnicalData">
    <Record>
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="Width"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Medium"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="Depth"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Medium"/>
                </Record>

                <!-- OData action button (bound or unbound) -->
                <Record Type="UI.DataFieldForAction">
                    <PropertyValue Property="Label" String="Copy"/>
                    <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy"/>
                </Record>

                <!-- Intent-based navigation button -->
                <Record Type="UI.DataFieldForIntentBasedNavigation">
                    <PropertyValue Property="Label" String="Manage Products (ST)" />
                    <PropertyValue Property="SemanticObject" String="EPMProduct" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Label" String="Technical Data"/>
    </Record>
</Annotation>
```

**STEP**: 2 — Define a FieldGroup with action buttons (ABAP CDS)

**DESCRIPTION**: Use @UI.fieldGroup entries to declare fields and actions. For DataFieldForAction use dataAction and type #FOR_ACTION; for intent-based use type #FOR_INTENT_BASED_NAVIGATION and @Consumption.semanticObject.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.fieldGroup: [
  {
    importance: #MEDIUM,
    position: 10,
    qualifier: 'TechnicalData',
    groupLabel: 'Technical Data'
  }
]
WIDTH;

@UI.fieldGroup: [
  {
    importance: #MEDIUM,
    position: 20,
    qualifier: 'TechnicalData'
  }
]
DEPTH;

@UI.fieldGroup: [
  {
    label: 'Copy',
    dataAction: 'STTA_C_MP_ProductCopy',
    type: #FOR_ACTION,
    position: 30,
    qualifier: 'TechnicalData'
  },
  {
    label: 'Manage Products (ST)',
    type: #FOR_INTENT_BASED_NAVIGATION,
    position: 40,
    qualifier: 'TechnicalData'
  }
]

@Consumption.semanticObject: 'EPMProduct'
product;
```

**STEP**: 3 — Define a FieldGroup with action buttons (CAP CDS)

**DESCRIPTION**: In CAP CDS use UI.FieldGroup with Data entries; include $Type 'UI.DataFieldForAction' and 'UI.DataFieldForIntentBasedNavigation'. Use Inline property to place an action inside the form toolbar (see later step).

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.FieldGroup #TechnicalData : {
    Data : [
        {
            $Type : 'UI.DataField',
            Value : Width,
            ![@UI.Importance] : #Medium
        },
        {
            $Type : 'UI.DataField',
            Value : Depth,
            ![@UI.Importance] : #Medium
        },
        {
            $Type : 'UI.DataFieldForAction',
            Label : 'Copy',
            Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy'
        },
        {
            $Type : 'UI.DataFieldForIntentBasedNavigation',
            Label : 'Manage Products (ST)',
            SemanticObject : 'EPMProduct'
        }
    ],
    Label : 'Technical Data'
}
```

**STEP**: 4 — Link FieldGroup to a ReferenceFacet so the form displays on the object page (XML)

**DESCRIPTION**: Reference the FieldGroup via a UI.ReferenceFacet Target pointing to @UI.FieldGroup#Qualifier. This places the FieldGroup as a facet on the object page.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.Facets">
    <Collection>
        ...
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Technical Data"/>
            <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#TechnicalData"/>
        </Record>
        ...
    </Collection>
</Annotation>
```

**STEP**: 5 — Link FieldGroup to a ReferenceFacet (ABAP CDS)

**DESCRIPTION**: Use @UI.Facet with targetQualifier to reference the field group qualifier.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Facet: [
  {
    label: 'Technical Data',
    targetQualifier: 'TechnicalData',
    type: #FIELDGROUP_REFERENCE,
    purpose: #STANDARD
 }
]
```

**STEP**: 6 — Link FieldGroup to a ReferenceFacet (CAP CDS)

**DESCRIPTION**: In manifest-like UI facet array, add a UI.ReferenceFacet entry that points to the FieldGroup qualifier.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
{
   $Type     : 'UI.ReferenceFacet',
   Label     : 'Technical Data',
   ID        : 'TechnicalData',
   Target    : '@UI.FieldGroup#TechnicalData'
}
```

**STEP**: 7 — Add form actions via UI.Identification or UI.StatusInfo (XML)

**DESCRIPTION**: Form-level actions can be added in UI.Identification or UI.StatusInfo. Unqualified UI.Identification entries go to global actions unless marked determining (then go to footer). Use Qualifier to route to a specific ReferenceFacet (see next step to link Identification to a ReferenceFacet).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- DataFieldForAction in UI.Identification with qualifier -->
<Annotation Term="UI.Identification" Qualifier="ID">
    <Collection>
        ...
        <Record Type="UI.DataFieldForAction">
            <PropertyValue Property="Label" String="Break Up" />
            <PropertyValue Property="Action" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.BREAK_UP" />
        </Record>
        ...
    </Collection>
</Annotation>

<!-- DataFieldForAction in UI.StatusInfo with qualifier -->
<Annotation Term="UI.StatusInfo" Qualifier="SI">
    <Collection>
        ...
        <Record Type="UI.DataFieldForAction">
            <PropertyValue Property="Label" String="Move Country" />
            <PropertyValue Property="Action" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.MOVE_COUNTRY" />
        </Record>
        ...
    </Collection>
</Annotation>
```

**STEP**: 8 — Add form actions via UI.Identification / UI.StatusInfo (ABAP CDS)

**DESCRIPTION**: Use @UI.identification and @UI.statusInfo entries with qualifier and type fields.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.identification: [
  {
    label: 'Break Up',
    dataAction: 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.BREAK_UP',
    type: #FOR_ACTION,
    qualifier: 'ID'
  }
]

@UI.statusInfo: [
  {
    label: 'Move Country',
    dataAction: 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.MOVE_COUNTRY',
    type: #FOR_ACTION,
    qualifier: 'SI'
  }
]
```

**STEP**: 9 — Add form actions via UI.Identification / UI.StatusInfo (CAP CDS)

**DESCRIPTION**: Declare UI.Identification and UI.StatusInfo sections with UI.DataFieldForAction definitions.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.Identification #ID : [{
    $Type  : 'UI.DataFieldForAction',
    Label  : 'Break Up',
    Action : 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.BREAK_UP'
}],

UI.StatusInfo #SI : [{
    $Type  : 'UI.DataFieldForAction',
    Label  : 'Move Country',
    Action : 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.MOVE_COUNTRY'
}],
```

**STEP**: 10 — Place action inside the form toolbar using Inline=true (XML)

**DESCRIPTION**: Set the Inline property on a DataFieldForAction to make the action appear inside the form toolbar instead of the section toolbar.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="OrderData">
    <Record Type="UI.FieldGroupType">
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataFieldForAction">
                    <PropertyValue Property="Label" String="Facet Form Action" />
                    <PropertyValue Property="Action" String="com.c_salesordermanage_sd.FacetFormAction" />
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
                </Record>
                <Record Type="UI.DataFieldForAction">
                    <PropertyValue Property="Label" String="Facet Form Action at Form Level" />
                    <PropertyValue Property="Action" String="com.c_salesordermanage_sd.FacetFormAction2" />
                    <PropertyValue Property="Inline" Bool="true" />
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 11 — Place action inside the form toolbar (ABAP CDS / CAP CDS)

**DESCRIPTION**: ABAP CDS and CAP CDS equivalents: declare actions within the field group; to render at form level set Inline=true in CAP or maintain ordering/qualifier in ABAP.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.fieldGroup: [
  {
    importance: #HIGH,
    label: 'Facet Form Action',
    dataAction: 'com.c_salesordermanage_sd.FacetFormAction',
    type: #FOR_ACTION,
    position: 1 ,
    qualifier: 'OrderData'
  },
  {
    importance: #HIGH,
    label: 'Facet Form Action at Form Level',
    dataAction: 'com.c_salesordermanage_sd.FacetFormAction2',
    type: #FOR_ACTION,
    position: 2 ,
    qualifier: 'OrderData'
  }
]
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
FieldGroup #OrderData: {Data : [
    {
        $Type             : 'UI.DataFieldForAction',
        Label             : 'Facet Form Action',
        Action            : 'com.c_salesordermanage_sd.FacetFormAction',
        ![@UI.Importance] : #High
    },{
        $Type             : 'UI.DataFieldForAction',
        Label             : 'Facet Form Action at Form Level',
        Action            : 'com.c_salesordermanage_sd.FacetFormAction2',
        Inline            : true,
        ![@UI.Importance] : #High
    }
]}
```

**STEP**: 12 — Control visibility and enablement using UI.Hidden and Core.OperationAvailable (XML)

**DESCRIPTION**: Use UI.Hidden to hide an action and Core.OperationAvailable to control enablement. Static false for OperationAvailable removes the button (not rendered). Path-based OperationAvailable evaluates runtime enablement (true -> enabled; false -> disabled).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Hide an action -->
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Hidden Action" />
    <PropertyValue Property="Action" String="com.example.HiddenAction" />
    <Annotation Term="UI.Hidden" Bool="true"/>
</Record>

<!-- OperationAvailable static false -> action not rendered -->
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Not Available" />
    <PropertyValue Property="Action" String="com.example.NotAvailableAction" />
    <Annotation Term="Core.OperationAvailable" Bool="false"/>
</Record>

<!-- OperationAvailable path-based -> enables/disables based on a boolean property -->
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Conditional Action" />
    <PropertyValue Property="Action" String="com.example.ConditionalAction" />
    <Annotation Term="Core.OperationAvailable">
        <Path>IsActionAvailable</Path>
    </Annotation>
</Record>
```

**STEP**: 13 — Passing context rules for actions (description + XML example)

**DESCRIPTION**: Bound actions receive the full page context (entity instance). Unbound actions do not receive context. For DataFieldForIntentBasedNavigation, set RequiresContext="false" to pass page context; RequiresContext="true" is invalid for form buttons because users cannot select context for form-only buttons.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Intent-based navigation that passes page context -->
<Record Type="UI.DataFieldForIntentBasedNavigation" >
     <PropertyValue Property="Label" String="IBN"/>
     <PropertyValue Property="SemanticObject" String="SalesOrder"/>
     <PropertyValue Property="Action" String="manageInline"/>
     <PropertyValue Property="RequiresContext" Bool="false"/>
     <Annotation Term="UI.Emphasized" Bool="true" />
</Record>
```

**STEP**: 14 — Emphasize (ghost style) the primary form action (XML, ABAP, CAP)

**DESCRIPTION**: Use UI.Emphasized to highlight the most important form action. UI.Emphasized can be present without value, Bool="true", or set via a Path.

**LANGUAGE**: XML

**CODE**:
```xml
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Static Action" />
    <PropertyValue Property="Action" String="com.c_salesordermanage_sd.DummyStaticAction" />
    <Annotation Term="UI.Emphasized" />
</Record>
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Static Action" />
    <PropertyValue Property="Action" String="com.c_salesordermanage_sd.DummyStaticAction" />
    <Annotation Term="UI.Emphasized" Bool="true" />
</Record>
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Static Action" />
    <PropertyValue Property="Action" String="com.c_salesordermanage_sd.DummyStaticAction" />
    <Annotation Term="UI.Emphasized" Path="IsPrimaryAction" />
</Record>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.lineItem: [{ 
  label: 'IBN',
  type: #FOR_INTENT_BASED_NAVIGATION,
  emphasized: true,
  requiresContext: true,
  semanticObjectAction: 'manageInline',
  semanticObject: 'SalesOrder'
}]
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
{
    $Type               : 'UI.DataFieldForAction',
    Label               : 'Static Action',
    Action              : 'com.c_salesordermanage_sd.DummyStaticAction', 
    ![@UI.Emphasized]   : <<Path>>
}

{
    $Type               : 'UI.DataFieldForIntentBasedNavigation',
    SemanticObject      : 'SalesOrder',
    Action              : 'manageInline',
    Label               : 'IBN',
    RequiresContext     : false,
    ![@UI.Emphasized]   : true
}
```

**STEP**: 15 — Notes and recommendations

**DESCRIPTION**: 
- Place the most important action to the very left of the form toolbar (recommended UX). 
- For external navigation configuration see "Configuring External Navigation". 
- In OData V2 Fiori Elements you can change form action styles via UI adaptations. 
- Use determining flag on identification actions if you need an action in the footer.
--------------------------------

**TITLE**: Adding Actions to Tables — Annotations and Manifest Configuration (Fiori Elements)

**INTRODUCTION**: This reference shows how to enable and configure table actions (Create, Delete, custom and annotation-based actions) for SAP Fiori elements apps (OData V2 & V4). It contains actionable XML, CAP CDS, ABAP CDS and manifest.json snippets to: control Insert/Delete capabilities, configure inline actions, icons, inline deletion, action ordering, enable-on-select, create dialog behavior, and pass field values to actions.

**TAGS**: fiori-elements, annotations, manifest.json, UI.LineItem, InsertRestrictions, DeleteRestrictions, NavigationRestrictions, DataFieldForAction, DataFieldForIntentBasedNavigation, inlineDelete, CAP, ABAP CDS, OData

STEP: Enable Insert (Create) via NavigationRestrictions (OData V4 / XML)
DESCRIPTION: Set InsertRestrictions under NavigationRestrictions of a parent entity set. NavigationRestrictions takes precedence over InsertRestrictions defined directly for the child entity set. Insertable=true => Create button enabled for the related entity set.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_Product">
  <Annotation Term="Org.OData.Capabilities.V1.NavigationRestrictions">
    <Record>
      <PropertyValue Property="RestrictedProperties">
        <Collection>
          <Record>
            <PropertyValue Property="NavigationProperty" NavigationPropertyPath="to_ProductText"/>
            <PropertyValue Property="InsertRestrictions">
              <Record>
                <PropertyValue Property="Insertable" Bool="true"/>
                <!-- Or path-based:
                <PropertyValue Property="Insertable" Path="Insertable"/>
                -->
              </Record>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Enable Insert (Create) via InsertRestrictions (XML / CAP)
DESCRIPTION: Define InsertRestrictions directly on the entity set. Use Bool or Path. Insertable=true enables Create button for this entity set.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductText">
  <Annotation Term="Org.OData.Capabilities.V1.InsertRestrictions">
    <Record>
      <PropertyValue Property="Insertable" Bool="true" />
      <!-- Or path-based:
      <PropertyValue Property="Insertable" Path="Insertable"/>
      -->
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CAP
CODE:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductText with @(
  Capabilities.InsertRestrictions : {
    Insertable : true,
  }
);
```

STEP: Enable Delete via DeleteRestrictions (XML / CAP)
DESCRIPTION: Configure Deletable via DeleteRestrictions. If not provided, Delete is enabled by default. DeleteRestrictions supports Bool or Path values.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.Container/SalesOrderManage">
  <Annotation Term="SAP__capabilities.DeleteRestrictions">
    <Record>
      <PropertyValue Property="Deletable" Bool="false"/>
      <!-- Or path-based:
      <PropertyValue Property="Deletable" Path="isDeletable"/>
      -->
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CAP
CODE:
```cds
annotate SAP__self.SalesOrderManage with {
  SAP__capabilities.DeleteRestrictions : {
    Deletable : false
  }
};
```

STEP: Enable/Disable Delete Button Using deletable-path (XML / CAP)
DESCRIPTION: Use Org.OData.Capabilities.V1.DeleteRestrictions with Deletable Path pointing to a boolean property (e.g., Delete_mc). Ensure sap:deletable is not present if using deletable-path.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_Product">
  <Annotation Term="Org.OData.Capabilities.V1.DeleteRestrictions">
    <Record>
      <PropertyValue Property="Deletable" Path="Delete_mc"/>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CAP
CODE:
```cds
annotate STTA_C_MP_Product with @(
  Capabilities.DeleteRestrictions : {
    Deletable : Delete_mc
  }
);
```

STEP: Configure Table Inline Deletion (manifest.json tableSettings)
DESCRIPTION: Enable inline delete buttons at the end of each row for responsive tables. Cannot enable inlineDelete together with multiselect.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "models": {},
    "routing": {},
    "componentUsages": {},
    "tableSettings": {
      "inlineDelete": true
    }
  }
}
```

STEP: Configure UI.LineItem — Toolbar and Inline Actions (XML)
DESCRIPTION: Define toolbar actions (DataFieldForAction without Inline or Inline=false) and inline per-row actions (DataFieldForAction/DataFieldForIntentBasedNavigation with Inline=true). Order of Records defines column and action order.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.LineItem">
  <Collection>
    <!-- Toolbar action (no Inline) -->
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy with new Supplier"/>
      <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopywithparams"/>
      <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/Isolated"/>
    </Record>

    <!-- Toolbar action in ChangeSet -->
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Activate"/>
      <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductActivation"/>
      <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/ChangeSet"/>
    </Record>

    <!-- Standard columns -->
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="Product"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>

    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="ProductCategory"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>

    <!-- Inline per-row action (shows as a column button) -->
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy"/>
      <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy"/>
      <PropertyValue Property="Inline" Bool="true"/>
      <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/Isolated"/>
    </Record>

    <!-- Inline intent-based navigation -->
    <Record Type="UI.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="Label" String="Manage Products (ST)"/>
      <PropertyValue Property="SemanticObject" String="EPMProduct"/>
      <PropertyValue Property="Action" String="manage_st"/>
      <PropertyValue Property="Inline" Bool="true"/>
    </Record>

    <!-- Render property value as link and navigate -->
    <Record Type="UI.DataFieldWithIntentBasedNavigation">
      <PropertyValue Property="Label" String="Weight (with IBN)"/>
      <PropertyValue Property="Action" String="manage_st_test"/>
      <PropertyValue Property="Value" Path="Weight"/>
      <PropertyValue Property="SemanticObject" String="EPMProduct"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
  </Collection>
</Annotation>
```

STEP: Configure UI.LineItem — ABAP CDS and CAP CDS equivalents
DESCRIPTION: Equivalent ABAP CDS and CAP CDS snippets to declare line item actions and inline actions. Use dataAction / $Type and Inline in CAP.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [
  {
    label: 'Copy with new Supplier',
    dataAction: 'PUSHDOWN:STTA_C_MP_ProductCopywithparams',
    invocationGrouping: #ISOLATED,
    type: #FOR_ACTION,
    position: 1
  },
  {
    label: 'Activate',
    dataAction: 'PUSHDOWN:STTA_C_MP_ProductActivation',
    invocationGrouping: #CHANGE_SET,
    type: #FOR_ACTION,
    position: 2
  },
  {
    label: 'Product',
    importance: #HIGH,
    value: 'PRODUCT',
    type: #STANDARD,
    position: 3
  },
  {
    label: 'Copy',
    dataAction: 'PUSHDOWN:STTA_C_MP_ProductCopy',
    invocationGrouping: #ISOLATED,
    type: #FOR_ACTION,
    position: 8
  }
]
```

LANGUAGE: CAP
CODE:
```cds
UI.LineItem : [
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'Copy with new Supplier',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopywithparams',
    InvocationGrouping : #Isolated
  },
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'Activate',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductActivation',
    InvocationGrouping : #ChangeSet
  },
  {
    $Type : 'UI.DataField',
    Value : Product,
    ![@UI.Importance] : #High
  },
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'Copy',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy',
    Inline : true,
    InvocationGrouping : #Isolated
  },
  {
    $Type : 'UI.DataFieldForIntentBasedNavigation',
    Label : 'Manage Products (ST)',
    SemanticObject : 'EPMProduct',
    Action : 'manage_st',
    Inline : true
  }
];
```

STEP: Render Inline Action Buttons as Icon (DataFieldForAction / DataFieldForIntentBasedNavigation)
DESCRIPTION: Replace inline action text with an icon using IconUrl. Note: icon buttons ignore Criticality and only supported for inline table actions.
LANGUAGE: XML
CODE:
```xml
<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="Label" String="Navigate via Action"/>
  <PropertyValue Property="Action" String="com.c_salesordermanage_sd.ActionNavigation"/>
  <PropertyValue Property="Inline" Bool="true"/>
  <PropertyValue Property="IconUrl" String="sap-icon://arrow-right"/>
</Record>
```

LANGUAGE: CAP
CODE:
```cds
{
  $Type   : 'UI.DataFieldForAction',
  Label   : 'Navigate via Action',
  Action  : 'com.c_salesordermanage_sd.ActionNavigation',
  Inline  : true,
  IconUrl : 'sap-icon://arrow-right'
},
{
  $Type           : 'UI.DataFieldForIntentBasedNavigation',
  SemanticObject  : 'v4Freestyle',
  Action          : 'Inbound',
  Label           : 'IBN Inline',
  RequiresContext : true,
  Inline          : true,
  IconUrl         : 'sap-icon://arrow-left'
}
```

STEP: Group Actions as Menu Buttons
DESCRIPTION: Use the Actions vocabulary and grouping in annotations to group similar actions into menu buttons. (See Actions documentation.) — Use UI.OperationGroupingType and InvocationGrouping attributes shown above to control grouping behavior.
LANGUAGE: JSON
CODE:
```json
{
  "@com.sap.vocabularies.UI.v1.LineItem": {
    "actions": {
      "DataFieldForAction::MyActionKey": {
        "enableOnSelect": "single"
      }
    }
  }
}
```

STEP: Control Standard Action Order and Custom Actions in manifest.json
DESCRIPTION: Use controlConfiguration under target settings to set anchor and placement for standard and custom actions in the toolbar. Anchor can reference StandardAction::Create etc., placement values: "Before"/"After".
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "actions": {
                    "StandardAction::Delete": {
                      "position": {
                        "anchor": "StandardAction::Create",
                        "placement": "Before"
                      }
                    },
                    "CustomAction": {
                      "press": "SalesOrder.custom.CustomActions.CustomAction1",
                      "enabled": true,
                      "text": "Custom Action",
                      "command": "COMMON",
                      "position": {
                        "anchor": "StandardAction::Create",
                        "placement": "After"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Enable Single-Selection Requirement for Bound Actions (manifest.json)
DESCRIPTION: For annotation-based actions, configure enableOnSelect to "single" to enable an action only when exactly one applicable record is selected (default "multi").
LANGUAGE: JSON
CODE:
```json
{
  "@com.sap.vocabularies.UI.v1.LineItem": {
    "actions": {
      "DataFieldForAction::com.c_salesordermanage_sd.CreateWithSalesOrderType": {
        "enableOnSelect": "single" // values: "single" or "multi"
      }
    }
  }
}
```

STEP: Control Update/Delete via UpdateRestrictions/DeleteRestrictions (XML)
DESCRIPTION: Use Capabilities.UpdateRestrictions/DeleteRestrictions to control Updatable/Deletable via Bool or Path. NavigationRestrictions on parent entity set has precedence.
LANGUAGE: XML
CODE:
```xml
<!-- UpdateRestrictions (path-based) -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/Material">
  <Annotation Term="Org.OData.Capabilities.V1.UpdateRestrictions">
    <Record Type="Org.OData.Capabilities.V1.UpdateRestrictionsType">
      <PropertyValue Property="Updatable" Path="owner.isUpdatable"/>
    </Record>
  </Annotation>
</Annotations>

<!-- DeleteRestrictions (path-based) -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/Material">
  <Annotation Term="Org.OData.Capabilities.V1.DeleteRestrictions">
    <Record Type="Org.OData.Capabilities.V1.DeleteRestrictionsType">
      <PropertyValue Property="Deletable" Path="owner.isDeletable"/>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Priority Example — NavigationRestrictions with DeleteRestrictions (XML)
DESCRIPTION: Example showing NavigationRestrictions on parent entity set setting child DeleteRestrictions to Deletable=false — parent NavigationRestrictions takes precedence.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_Product">
  <Annotation Term="Org.OData.Capabilities.V1.NavigationRestrictions">
    <Record>
      <PropertyValue Property="RestrictedProperties">
        <Collection>
          <Record>
            <PropertyValue Property="NavigationProperty" NavigationPropertyPath="to_ProductText"/>
            <PropertyValue Property="DeleteRestrictions">
              <Record>
                <PropertyValue Property="Deletable" Bool="false"/>
              </Record>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Create Dialog Behavior for POST-Based Create and Computed Default Keys
DESCRIPTION: For POST-based create (not NewAction) with visible non-computed key fields, a dialog prompts for key values. Dialog also appears for Core.ComputedDefaultValue keys with text association and for RequiredProperties in InsertRestrictions.
LANGUAGE: XML
CODE:
```xml
<!-- ComputedDefaultValue on key (XML) -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/ID">
  <Annotation Term="Common.Label" String="Sales Order" />
  <Annotation Term="Common.Text" String="SalesOrder">
    <Annotation Term="UI.TextArrangement" EnumMember="UI.TextArrangementType/TextOnly" />
  </Annotation>
  <Annotation Term="Core.ComputedDefaultValue" Bool="true" />
</Annotations>

<!-- RequiredProperties in InsertRestrictions -->
<Annotation Term="Org.OData.Capabilities.V1.InsertRestrictions">
  <Record Type="Org.OData.Capabilities.V1.InsertRestrictionsType">
    <PropertyValue Property="Insertable" Bool="true"/>
    <PropertyValue Property="RequiredProperties">
      <Collection>
        <PropertyPath>PurchaseOrderByCustomer</PropertyPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: CAP
CODE:
```cds
entity SalesOrderManage @(title: 'Manage Sales Order') {
  key ID : UUID @(title: 'Sales Order', Common : { Text : SalesOrder, TextArrangement : #TextOnly }, Core.ComputedDefaultValue : true);
  // ...
}

// InsertRestrictions example in CAP
InsertRestrictions : {
  Insertable : true,
  RequiredProperties : [ PurchaseOrderByCustomer ]
}
```

STEP: Trigger Action from Field Value (DataFieldWithAction) and Pass Field Value to Action Parameters
DESCRIPTION: Use UI.DataFieldWithAction to make a field value a link that triggers an action. Use UI.ParameterDefaultValue annotations to set action parameter defaults from the field value (path-based).
LANGUAGE: XML
CODE:
```xml
<!-- DataFieldWithAction: show link and trigger action -->
<Record Type="UI.DataFieldWithAction">
  <PropertyValue Property="Value" Path="PurchaseOrderByCustomer"/>
  <PropertyValue Property="Action" String="com.c_salesordermanage_sd.ActionDataFieldWith"/>
  <PropertyValue Property="Label" String="Customer Reference"/>
</Record>

<!-- Pass field value to action parameter -->
<Annotations Target="com.c_salesordermanage_sd.ActionDataFieldWith(com.c_salesordermanage_sd.SalesOrderManage)/PurchaseOrderByCustomer">
  <Annotation Term="UI.ParameterDefaultValue" Path="_it/PurchaseOrderByCustomer"/>
  <Annotation Term="Common.Label" String="Customer Reference"/>
</Annotations>
```

LANGUAGE: CAP
CODE:
```cds
{
  $Type : 'UI.DataFieldWithAction',
  Value : PurchaseOrderByCustomer,
  Label : 'Customer Reference',
  Action : 'com.c_salesordermanage_sd.ActionDataFieldWith'
}
```

STEP: Show/Hide Create and Delete Buttons via UI.CreateHidden / UI.DeleteHidden (OData V4)
DESCRIPTION: Use UI.CreateHidden or UI.DeleteHidden on the parent entity to hide or show Create/Delete buttons. They accept Bool or Path to a boolean property (example uses owner.isCreateHidden / owner.isDeleteHidden).
LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/HeaderPartner">
  <Annotation Term="UI.CreateHidden" Path="owner/isCreateHidden"/>
  <Annotation Term="UI.DeleteHidden" Path="owner/isDeleteHidden"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.createHidden: #(_Root.isCreateHidden)
@UI.deleteHidden: #(_Root.isDeleteHidden)
```

LANGUAGE: CAP
CODE:
```cds
annotate com.c_salesordermanage_sd.HeaderPartner with @( UI.CreateHidden: owner.isCreateHidden);
annotate com.c_salesordermanage_sd.SalesOrderManage with @( UI.DeleteHidden: owner.isDeleteHidden);
```

STEP: Notes and Constraints (Actionable reminders)
DESCRIPTION: Keep these constraints in mind when applying the snippets:
- NavigationRestrictions at parent entity set takes precedence over InsertRestrictions/DeleteRestrictions on child.
- If using deletable-path or createHidden/deleteHidden path annotations, ensure sap:deletable/sap:creatable are not conflicting.
- inlineDelete works only for responsive tables and cannot be used with multiselect.
- Inline actions are annotation-based only; enableOnSelect applies only to annotation-based (not inline) actions.
- Icon inline buttons ignore Criticality and are supported only for inline table actions.
--------------------------------

**TITLE**: Adding Confirmation Popovers for Actions (IsActionCritical annotation)

**INTRODUCTION**: Show a confirmation popover when a user triggers a Fiori Elements action by adding the IsActionCritical annotation to the action. Use this when your action does not display an action-parameter dialog. Examples for XML and CAP CDS annotations are provided. No ABAP CDS sample is available — use the local XML annotation for ABAP-based services.

**TAGS**: fiori-elements-framework, annotations, IsActionCritical, confirmation, actions, OData, XML, CAP, CDS

**STEP**: 1 — Add XML Annotation to an action

**DESCRIPTION**: Add the com.sap.vocabularies.Common.v1.IsActionCritical annotation with Bool="true" to the action target in your OData annotation XML to trigger a confirmation popover when the action is invoked. Use the full action target (EntitySet/ActionName or EntityType/ActionName depending on your service).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Annotation example: enable confirmation popover for the action -->
<Annotations Target="GWSAMPLE_BASIC.GWSAMPLE_BASIC_Entities/RegenerateAllData">
    <Annotation Term="com.sap.vocabularies.Common.v1.IsActionCritical" Bool="true"/>
</Annotations>
```

**STEP**: 2 — Add CAP CDS Annotation to an action

**DESCRIPTION**: For CAP-based services, annotate the action using the CDS annotate syntax to mark it as critical. This enables the Fiori Elements confirmation popover for that action.

**LANGUAGE**: CDS

**CODE**:
```cds
// CAP CDS annotation example: enable confirmation popover for the action
annotate GWSAMPLE_BASIC.RegenerateAllData with @(
    Common.IsActionCritical: true
);
```

**STEP**: 3 — ABAP CDS guidance

**DESCRIPTION**: There is no ABAP CDS sample available for IsActionCritical in this documentation. If your backend is ABAP, add the annotation using a local XML annotation file for the OData service instead.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
/* No ABAP CDS sample available for IsActionCritical.
   Use the service annotation XML (local annotations) to add:
   com.sap.vocabularies.Common.v1.IsActionCritical = true
*/
```

**STEP**: 4 — Limitations and localization

**DESCRIPTION**: Important constraints and how to add action-specific messages:
- The confirmation popover is supported only for actions without an action-parameter dialog.
- Apps can add action-specific messages to the confirmation dialog. See the localization guide for adding localized UI texts and message keys.

**LANGUAGE**: TEXT

**CODE**:
```text
Limitations:
- Only supported on actions without an action-parameter dialog.

Localization:
- For adding action-specific messages and localized UI text keys, see:
  localization-of-ui-texts-b8cb649.md
```
--------------------------------

**TITLE**: Adding Custom Actions Using Extension Points (SAP Fiori elements — OData V2 & V4)

**INTRODUCTION**: This document shows concrete, copy-paste-ready examples to add custom actions (buttons) to List Report and Object Page UIs in SAP Fiori elements apps using extension points. It covers:
- Controller extension files and handler signatures
- Manifest.json snippets for OData V2 (controllerExtensions + sap.ui.commands)
- Manifest.json snippets for OData V4 (routing → targets → options → settings → controlConfiguration → actions)
Follow the extensionAPI only and avoid manipulating internal controls/models directly.

**TAGS**: sap-fiori, fiori-elements, extension, custom-action, manifest.json, controller-extension, ODataV2, ODataV4, sap.ui.commands

STEP: 1 — Create controller extension files (OData V2 style controllers)
DESCRIPTION: Add controller extension JS files under webapp/ext/controller. Export an object containing the action handler functions referenced in manifest.json. Use only SAP Fiori elements extensionAPI in your implementation.
LANGUAGE: JavaScript
CODE:
```javascript
// File: my_app/webapp/ext/controller/MyListReportExt.controller.js
sap.ui.define([], function() {
    "use strict";
    return {
        // Example handlers referenced from manifest.json Actions.press
        onCustomAction1: function(oEvent) {
            // oEvent is the UI5 event object. Use extensionAPI from Fiori elements only.
            // TODO: implement behavior
            console.log("Custom Action 1 pressed", oEvent);
        },
        onCustomAction2: function(oEvent) {
            // TODO: implement behavior for action 2
            console.log("Custom Action 2 pressed", oEvent);
        }
    };
});
```

```javascript
// File: my_app/webapp/ext/controller/MyObjectPageExt.controller.js
sap.ui.define([], function() {
    "use strict";
    return {
        onHeaderAction: function(oEvent) {
            // Handler for object page header action
            console.log("Header action pressed", oEvent);
        },
        onSectionAction: function(oEvent) {
            // Handler for section/form/table actions in object page
            console.log("Section action pressed", oEvent);
        }
    };
});
```

STEP: 2 — OData V2: Add controllerExtensions and Actions to manifest.json (List Report, Table toolbar)
DESCRIPTION: For V2-based apps, extend sap.ui5 → extends → extensions → sap.ui.controllerExtensions and optionally sap.ui.commands for keyboard shortcuts. Under the controller extension entry, declare sap.ui.generic.app → <EntitySet> → Actions with keys matching action names and press handlers pointing to functions in your controller extension.
LANGUAGE: JSON
CODE:
```json
// Insert into your manifest.json under "sap.ui5"
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "my_app.ext.controller.ListReportExtension",
            "sap.ui.generic.app": {
              "SMART_C_Product": {            // <entity set>
                "EntitySet": "SMART_C_Product",
                "Actions": {
                  "CustomActionName": {       // <Action 1>
                    "id": "CustomActionName", // id must match action key
                    "text": "{i18n>MY_BUTTON_TEXT}",
                    "press": "onCustomAction1", // handler function implemented in controller extension
                    "requiresSelection": true,
                    "applicablePath": "/IsSelectable", // optional path expression
                    "command": "MyCustomCommand" // optional: maps to sap.ui.commands entry
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — OData V2: Example — Object Page header / object page table toolbar / form / footer / global
DESCRIPTION: Use the same controllerExtensions pattern for object page header, object page tables (Sections), form actions and footer/determining actions. Below are representative manifest fragments for each placement. Replace placeholders (<entity set>, <SmartTable Facet ID>, etc.).
LANGUAGE: JSON
CODE:
```json
// Object Page Header actions
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details#my_app::sap.suite.ui.generic.template.ObjectPage.view.Details::SMART_C_Product": {
            "controllerName": "my_app.ext.controller.DetailsExtension",
            "sap.ui.generic.app": {
              "SMART_C_Product": {
                "EntitySet": "SMART_C_Product",
                "Header": {
                  "Actions": {
                    "HeaderAction": {
                      "id": "HeaderAction",
                      "text": "{i18n>HEADER_ACTION}",
                      "press": "onHeaderAction",
                      "applicablePath": "/IsHeaderActionVisible",
                      "command": "HeaderCommand"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

```json
// Object Page Table toolbar (Section / SmartTable) actions
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details#my_app::sap.suite.ui.generic.template.ObjectPage.view.Details::SMART_C_Product": {
            "controllerName": "my_app.ext.controller.DetailsExtension",
            "sap.ui.generic.app": {
              "SMART_C_Product": {
                "EntitySet": "SMART_C_Product",
                "Sections": {
                  "SmartTableFacetID": {
                    "id": "SmartTableFacetID",
                    "Actions": {
                      "SmartTableAction1": {
                        "id": "SmartTableAction1",
                        "text": "{i18n>ACTION_1}",
                        "press": "onSectionAction",
                        "requiresSelection": false,
                        "applicablePath": "/IsActionApplicable"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

```json
// Footer action (object page) - determining example (deprecated)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details#my_app::sap.suite.ui.generic.template.ObjectPage.view.Details::SMART_C_Product": {
          "controllerName": "my_app.ext.controller.DetailsExtension",
          "sap.ui.generic.app": {
            "SMART_C_Product": {
              "EntitySet": "SMART_C_Product",
              "Header": {
                "Actions": {
                  "FooterAction": {
                    "id": "FooterAction",
                    "text": "{i18n>FOOTER_ACTION}",
                    "press": "onFooterAction",
                    "applicablePath": "/IsFooterAvailable",
                    "determining": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

```json
// List Report global action (placed in filter bar / header)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "my_app.ext.controller.ListReportExtension",
            "sap.ui.generic.app": {
              "SMART_C_Product": {
                "EntitySet": "SMART_C_Product",
                "Actions": {
                  "GlobalAction": {
                    "id": "GlobalAction",
                    "text": "{i18n>GLOBAL_ACTION}",
                    "press": "onCustomAction1",
                    "global": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — OData V2: Add keyboard shortcut mapping (sap.ui.commands)
DESCRIPTION: To map a keyboard shortcut to a custom action, add a sap.ui.commands entry keyed by the component ID string "<ComponentName>#<ComponentIDWithoutAppPrefix>". Do NOT override default shortcuts (Ctrl+E, Ctrl+Enter, etc.). The "command" name referenced in the action must match the key here.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.commands": {
          "sap.suite.ui.generic.template.ListReport#sap.suite.ui.generic.template.ListReport::SMART_C_Product": {
            "MyCustomCommand": {
              "shortcut": "Ctrl+G"
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — OData V2: How to compute the component key "<ComponentName>#<Component ID without app ID prefix>"
DESCRIPTION: Use either the XmlView element id or the ComponentContainer to fetch the owner component id, remove the app prefix to get the "local component id" part used in the sap.ui.commands key.
LANGUAGE: JavaScript
CODE:
```javascript
// Example using XmlView ID: replace the id string with your XmlView id
sap.ui.require(["sap/ui/core/Element"], function(Element) {
  var compId = Element.getElementById("STTA_MP::sap.suite.ui.generic.template.ListReport.view.ListReport::STTA_C_MP_Product")
                   .getController().getOwnerComponent().getId();
  // compId looks like: application-EPMProduct-manage_st-component---sap.suite.ui.generic.template.ListReport::STTA_C_MP_Product
  // Remove the app prefix and dashes to get: sap.suite.ui.generic.template.ListReport::STTA_C_MP_Product
  console.log("Component id:", compId);
});

// Example using a ComponentContainer (replace the container id)
sap.ui.require(["sap/ui/core/Element"], function(Element) {
  var comp = Element.getElementById("__xmlview0-__clone0--host").getComponent();
  console.log("Component instance:", comp);
});
```

STEP: 6 — Properties reference (all versions) — what to supply in manifest actions
DESCRIPTION: Summary of supported action properties used in manifest.json entries.
LANGUAGE: JSON
CODE:
```json
{
  "id": "<id>",                      // Button id, should match action key
  "text": "{i18n>KEY}",              // Button label (usually i18n binding)
  "press": "<handler>",              // V2: function name in controller extension; V4: "AppId.ext.File.method"
  "requiresSelection": true,         // Table toolbar actions: whether selection required (default true)
  "global": false,                   // List report: global action (default false)
  "applicablePath": "/MyBoolean",    // expression path to decide visibility/enabled (V2) or callable (V4)
  "command": "<CommandName>",        // maps to sap.ui.commands entry (V2)
  "determining": false,              // footer/determining button (deprecated)
  "enabled": true | false | "<callable>", // V4: boolean or function ref
  "visible": true | false | "<callable>", // V4: boolean or function ref
  "position": {                      // V4 only: placement relative to an anchor action
    "placement": "Before" | "After",
    "anchor": "DataFieldForAction::ActionName"
  },
  "inline": true                     // V4: for form toolbar placement
}
```

STEP: 7 — OData V4: Create ext/CustomActions.js and define handler signature
DESCRIPTION: For V4 apps handlers are referenced from manifest as "<appId>.ext.CustomActions.method". Create webapp/ext/CustomActions.js and export methods. Handler signature receives (oContext, aSelectedContexts). Use these inputs to inspect the current entity context and selected rows.
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/ext/CustomActions.js
sap.ui.define([], function () {
    "use strict";
    return {
        // oContext: current binding context (root entity)
        // aSelectedContexts: array of binding contexts for selected table rows (if applicable)
        message: function (oContext, aSelectedContexts) {
            // Example action: simple alert
            // Implement using only the extensionAPI / available services
            alert("Custom action executed. Selected items: " + (aSelectedContexts ? aSelectedContexts.length : 0));
        },

        // Example enablement function for V4; must return boolean
        enabledForCompletedOnly: function (oContext, aSelectedContexts) {
            if (aSelectedContexts && aSelectedContexts.length === 1) {
                // Example: allow only when a single item selected
                return true;
            }
            return false;
        }
    };
});
```

STEP: 8 — OData V4: Add controlConfiguration actions into manifest.json (routing → targets → options → settings)
DESCRIPTION: For V4 apps, add actions under routing.targets.<target>.options.settings.controlConfiguration for tables, sections, forms or under options.settings.content.header/footer for header/footer actions. Use fully qualified handler references like "MyApp.ext.CustomActions.message". Examples below show common placements: table toolbar, object page header, footer, section actions, and form inline actions.
LANGUAGE: JSON
CODE:
```json
// Example: Table toolbar action (List Report / LineItem)
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "<ListReportTargetName>": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "actions": {
                    "MyTableAction": {
                      "press": "my.app.id.ext.CustomActions.message",
                      "text": "{i18n>MY_TABLE_ACTION}",
                      "enabled": true,
                      "visible": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

```json
// Example: Object Page header action
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "<ObjectPageTargetName>": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  "actions": {
                    "MyHeaderAction": {
                      "press": "my.app.id.ext.CustomActions.message",
                      "text": "{i18n>HEADER_ACTION}",
                      "enabled": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

```json
// Example: Section action using FieldGroup annotation id
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.FieldGroup#OrderData": {
                  "actions": {
                    "customSectionAction": {
                      "press": "SalesOrder.ext.CustomActions.alert",
                      "visible": true,
                      "enabled": true,
                      "text": "Alert",
                      "position": {
                        "placement": "After",
                        "anchor": "DataFieldForIntentBasedNavigation::SalesOrder::manageInline"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

```json
// Example: Form toolbar action shown inline
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.FieldGroup#OrderData": {
                  "actions": {
                    "customFormAction": {
                      "press": "SalesOrder.ext.CustomActions.alert",
                      "visible": true,
                      "enabled": false,
                      "text": "Action on Form",
                      "inline": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 9 — V4 handler declaration examples in manifest and result samples
DESCRIPTION: V4 manifest action entries for table header/footer and object page placements follow the routing → targets structure. Below are final sample fragments showing where to place action entries for different UI locations.
LANGUAGE: JSON
CODE:
```json
// Sample: List Report (header actions) via routing target settings content.header.actions
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "<ListReportTargetName>": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  "actions": {
                    "<ActionName>": {
                      "press": "my.app.id.ext.CustomActions.message",
                      "text": "{i18n>BUTTON_TEXT}",
                      "enabled": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

```json
// Sample: Object Page footer
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "<ObjectPageTargetName>": {
          "options": {
            "settings": {
              "content": {
                "footer": {
                  "actions": {
                    "<ActionName>": {
                      "press": "my.app.id.ext.CustomActions.message",
                      "text": "{i18n>FOOTER_ACTION}"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 10 — Quick checklist & rules
DESCRIPTION: Use this short checklist when adding custom actions.
LANGUAGE: JSON
CODE:
```json
{
  "checklist": [
    "Prefer manifest settings/annotations over app extensions. Use extensions only when required.",
    "Implement handlers under webapp/ext (V4) or webapp/ext/controller (V2) and reference them correctly.",
    "V2 controller extension handler names are referenced directly via 'press': 'onHandlerName'.",
    "V4 handler references have form 'app.id.ext.File.method'.",
    "Do NOT access/manipulate Fiori elements internal controls or models directly — use extensionAPI only.",
    "Do not override default keyboard shortcuts (Ctrl+E, Ctrl+Enter, etc.).",
    "Ensure 'id' and action key are identical in V2 actions."
  ]
}
```
--------------------------------

**TITLE**: Adding Custom Fields to the Filter Bar (Fiori elements — OData V2 & V4)

**INTRODUCTION**: Practical, code-focused guidance to add custom filter fields to the Smart Filter Bar in SAP Fiori elements for OData V2 and V4. Includes manifest and fragment examples, controller extension hooks to integrate filters with table binding, export handling, custom operators, multi-value mapping, required-field validation, and metadata-bound labels. Use only the SAP Fiori elements extensionAPI when integrating custom code.

**TAGS**: fiori-elements-framework, filter-bar, custom-filter, extensionAPI, manifest.json, ODataV2, ODataV4, controller-extension, fragment, custom-operator

**STEP**: 1 - Caution & Required Extension Methods

**DESCRIPTION**: Use app extensions only when manifest settings or annotations cannot achieve the goal. Use only the SAP Fiori elements extensionAPI. When adding custom filter controls you must expose and implement extension hooks to integrate with the template lifecycle and app-state handling.

Mandatory controller extension methods and their purposes:
- onBeforeRebindTable / onBeforeRebindTableExtension — inspect custom fields and add filters to bindingParameters before table rebinding.
- getCustomAppStateData / getCustomAppStateDataExtension — read all custom field state and put it into the provided object for app-state/variant handling.
- restoreCustomAppStateData / restoreCustomAppStateDataExtension — read the custom app state and restore control values (called after navigation/restore).
- onInitSmartFilterBarExtension — initialize or set default values and bind custom controls at FilterBar init.

**LANGUAGE**: Text

**CODE**:
```text
Note: Integrate your logic through the extensionAPI only. Avoid touching internal framework controls, properties, models, or other internal objects.
```

**STEP**: 2 - OData V2: Add view + controller extensions (manifest.json)

**DESCRIPTION**: Add a view fragment to the SmartFilterBar and a controller extension for lifecycle hooks in an OData V2 List Report. Example manifest "extends" snippet showing controller extension and view extension registration.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "controllerName": "my_app.ext.controller.ListReportExtension"
        }
      },
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "SmartFilterBarControlConfigurationExtension|<myEntityset>": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "<myNamespace>.ext.fragment.CustomFilter",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**STEP**: 3 - OData V2: onBeforeExportTableExtension — show filter labels (controller extension)

**DESCRIPTION**: Example controller extension method to modify exported filter settings so custom filter labels/values appear in export (e.g., show "Cost = Low" instead of raw query filter). Add this method inside your controller extension file referenced in manifest.

**LANGUAGE**: JavaScript

**CODE**:
```js
// File: my_app/ext/controller/ListReportExtension.js
sap.ui.define([
  "sap/ui/core/Element",
  "sap/ui/export/util/Filter"
], function (Element, ExportFilter) {
  "use strict";
  return {
    onBeforeExportTableExtension: function (oExportParams) {
      if (!oExportParams || !oExportParams.includeFilterSettings) {
        return;
      }
      var aFilterSettings = oExportParams.filterSettings || [];

      // ID of the custom combobox in the SmartFilterBar (example)
      var COST_COMBOBOX_ID = "STTA_MP::sap.suite.ui.generic.template.ListReport.view.ListReport::STTA_C_MP_Product--CustomFilter-OverallCost-combobox";
      var oCostCombobox = Element.getElementById(COST_COMBOBOX_ID);

      if (oCostCombobox && oCostCombobox.getValue()) {
        var oRawValue, sNewCostValue;

        // Remove raw OverallCost entry from export filter settings and store its raw value
        for (var i = 0; i < aFilterSettings.length; i++) {
          var oCurrentFilter = aFilterSettings[i];
          if (oCurrentFilter.getProperty && oCurrentFilter.getProperty() === "OverallCost") {
            oRawValue = oCurrentFilter.rawValues && oCurrentFilter.rawValues[0];
            aFilterSettings.splice(i, 1);
            break;
          }
        }

        // Map raw value -> user-friendly "Low"/"High"
        if (oRawValue && oRawValue.operator === "<=" && oRawValue.value === "1000") {
          sNewCostValue = "Low";
        } else {
          sNewCostValue = "High";
        }

        // Build new export filter with friendly label and value
        var sProperty = "OverallCost",
            sLabel = "Cost",
            oNewRawValue = { operator: "==", value: sNewCostValue },
            oCostFilter = new ExportFilter(sProperty, oNewRawValue, sLabel);

        aFilterSettings.push(oCostFilter);
      }
    }
  };
});
```

**STEP**: 4 - OData V4: Configure FilterBar controlConfiguration in manifest.json

**DESCRIPTION**: Use controlConfiguration @com.sap.vocabularies.UI.v1.SelectionFields to add custom filters in OData V4. Example shows adding a custom filter field "MyCustomRatingThing" with template fragment path and placement.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": { /* ... */ },
  "sap.ui5": {
    "routing": { /* ... */ },
    "targets": {
      "SalesOrderManageList": {
        "type": "Component",
        "id": "SalesOrderManageList",
        "name": "sap.fe.templates.ListReport",
        "options": {
          "settings": {
            "contextPath": "/SalesOrderManage",
            "controlConfiguration": {
              "@com.sap.vocabularies.UI.v1.SelectionFields": {
                "navigationProperties": ["_Partner", "_DistributionChannel"],
                "filterFields": {
                  "MyCustomRatingThing": {
                    "label": "{i18n>CustomRatingFilter}",
                    "property": "Rating",
                    "availability": "Default",
                    "template": "SalesOrder.ext.CustomRatingFilter",
                    "required": true,
                    "position": {
                      "placement": "After",
                      "anchor": "SalesOrder"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 - filterFields schema and options (manifest.json usage)

**DESCRIPTION**: Schema for a single filterField entry in controlConfiguration. Use "property" to point to the target property (entity-relative). "template" must be an XML fragment path. "availability" controls visibility and adaptation dialog inclusion.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "<filterField>": {
    "label": "{i18n>MyCustomLabel}",          // static or i18n binding
    "property": "Rating",                     // property path to be filtered (e.g. "Rating" or "_Partner/Rating")
    "template": "SalesOrder.ext.CustomRatingFilter",
    "required": false,
    "availability": "Default",                // "Default" | "Hidden" | "Adaptation"
    "position": {
      "placement": "Before" | "After",
      "anchor": "<Key_of_filter_field>"
    }
  }
}
```

**STEP**: 6 - Simple custom filter fragment (XML) and handler binding

**DESCRIPTION**: Example XML fragment for a rating control bound to the internal filterValues model. Use the built-in Value type macro to map the filter value. Handler functions referenced by core:require should be implemented in SalesOrder/ext/CustomRating.js. Bind control value to {filterValues>} for app-state & variant support.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: SalesOrder/ext/CustomRatingFilter.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m" xmlns:l="sap.ui.layout">
  <HBox alignItems="Center" core:require="{handler: 'SalesOrder/ext/CustomRating'}" width="100%">
    <!-- Recommended: bind via Value type -->
    <RatingIndicator id="MyCustomRatingIndicatorId"
      core:require="{ Value: 'sap/fe/macros/filter/type/Value' }"
      value="{ path: 'filterValues>', type: 'Value' }" />
    <core:Icon src="sap-icon://reset" press="handler.onReset" class="sapUiSmallMarginBegin" />
  </HBox>
</core:FragmentDefinition>
```

**STEP**: 7 - Simple custom filter handler (setFilterValues usage)

**DESCRIPTION**: Handler for value-change and reset actions. Use controller extension API function setFilterValues to update the filterValues model for template integration.

**LANGUAGE**: JavaScript

**CODE**:
```js
// File: SalesOrder/ext/CustomRating.js
sap.ui.define([], function () {
  "use strict";
  return {
    onValueChanged: function (oEvent) {
      var sValue = oEvent.getParameter("value");
      // setFilterValues(fieldKey, value) is provided by the list report ControllerExtensionAPI
      this.setFilterValues("Rating", sValue);
    },
    onReset: function () {
      // Clear the value
      this.setFilterValues("Rating");
    }
  };
});
```

**STEP**: 8 - Multi-value custom filter operator mapping (JS)

**DESCRIPTION**: When a custom control can select multiple values, implement a function that maps an array of user values to an array of sap.ui.model.Filter instances and return a combined Filter. Use this function as the operator callback for the Value type when configured accordingly.

**LANGUAGE**: JavaScript

**CODE**:
```js
// Example mapping function (SalesOrder/ext/CustomRating.js)
sap.ui.define(["sap/ui/model/Filter", "sap/ui/model/FilterOperator"], function (Filter, FilterOperator) {
  "use strict";
  return {
    onMultiValueRatingLevels: function (values) {
      if (!values || !Array.isArray(values) || values.length === 0) {
        return null;
      }
      var filters = [];
      values.forEach(function (value) {
        switch (value) {
          case "low":
            filters.push(new Filter({ path: "Rating", operator: FilterOperator.EQ, value1: 1 }));
            break;
          case "medium":
            filters.push(new Filter({ path: "Rating", operator: FilterOperator.EQ, value1: 2 }));
            filters.push(new Filter({ path: "Rating", operator: FilterOperator.EQ, value1: 3 }));
            filters.push(new Filter({ path: "Rating", operator: FilterOperator.EQ, value1: 4 }));
            break;
          case "high":
            filters.push(new Filter({ path: "Rating", operator: FilterOperator.EQ, value1: 5 }));
            break;
          default:
            break;
        }
      });
      return new Filter({ filters: filters, and: false });
    }
  };
});
```

**STEP**: 9 - Custom filter operator implementation & registration

**DESCRIPTION**: Example demonstrating a custom filter operator function that returns Filter objects per combo-key and how to register the function name in manifest.json under sap.fe -> macros -> filter -> customFilterOperators.

**LANGUAGE**: JavaScript / JSON

**CODE**:
```js
// File: SalesOrder/ext/CustomRating.js
sap.ui.define(["sap/ui/model/Filter", "sap/ui/model/FilterOperator"], function (Filter, FilterOperator) {
  "use strict";
  return {
    ratingLevels: function (sValue) {
      switch (sValue) {
        case "Low":
          return new Filter({ path: "Rating", operator: FilterOperator.LT, value1: 2 });
        case "Medium":
          return new Filter({
            filters: [
              new Filter({ path: "Rating", operator: FilterOperator.GT, value1: 1 }),
              new Filter({ path: "Rating", operator: FilterOperator.LT, value1: 5 })
            ],
            and: true
          });
        case "High":
          return new Filter({ path: "Rating", operator: FilterOperator.EQ, value1: 5 });
        default:
          return null;
      }
    }
  };
});
```

```json
// Add to manifest.json under "sap.fe"
{
  "sap.fe": {
    "macros": {
      "filter": {
        "customFilterOperators": [
          { "name": "SalesOrder.ext.CustomRating.ratingLevels" }
        ]
      }
    }
  }
}
```

**STEP**: 10 - Required custom filter visual validation (fragment + formatter)

**DESCRIPTION**: Mark a custom filter as required in manifest (required: true) and implement a visual validation (red frame) via valueState formatter bound to {filterValues>}. Example fragment and formatter.

**LANGUAGE**: XML / JavaScript

**CODE**:
```xml
<!-- File: SalesOrder/ext/CustomRequiredFilter.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
  <Input
    core:require="{ handler: 'SalesOrder/ext/CustomFilter', Value: 'sap/fe/macros/filter/type/Value' }"
    value="{ path: 'filterValues>', type: 'Value', formatOptions: { operator: 'Contains' } }"
    valueState="{ path: 'filterValues>', formatter: 'handler.onFilterInputFormatValue' }"
    placeholder="{i18n>customStringFilterPlaceholder}" />
</core:FragmentDefinition>
```

```js
// File: SalesOrder/ext/CustomFilter.js
sap.ui.define(["sap/ui/core/ValueState"], function (ValueState) {
  "use strict";
  return {
    // formatter used in fragment to set valueState to Error when no value is provided
    onFilterInputFormatValue: function (sValue) {
      return sValue ? ValueState.None : ValueState.Error;
    }
  };
});
```

**STEP**: 11 - Metadata binding for custom filter labels

**DESCRIPTION**: Use metaModel bindings for labels so the custom filter label comes from metadata. Example shows label binding using metaModel path.

**LANGUAGE**: JSON

**CODE**:
```json
"MyCustomSoldToPartyThing": {
  "label": "{metaModel>/SalesOrderManage/SoldToParty@com.sap.vocabularies.Common.v1.Label}",
  "property": "Rating",
  "template": "SalesOrder.ext.CustomSoldToParty",
  "required": true,
  "position": {
    "placement": "After",
    "anchor": "MyCustomRatingThing"
  }
}
```

**STEP**: 12 - Notes & Best Practices

**DESCRIPTION**: Summarize essential operational points for developers.

**LANGUAGE**: Text

**CODE**:
```text
- Bind the control value to the relative path {filterValues>} so variants and app-state handling work automatically.
- For case-insensitive filtering, pass caseSensitive: false to new Filter().
- In multi-view list reports the filter property is resolved against the active tab's entity; if not found, the property is ignored.
- Use the extensionAPI methods and ControllerExtensionAPI (e.g., setFilterValues) for consistent behavior.
- See the demo examples: "Adding Filterable Field to the Smart Filter Bar" and the FPM explorer live demos for custom filter patterns.
```
--------------------------------

**TITLE**: Adding Custom Messages with securedExecution (SAP Fiori elements)

**INTRODUCTION**: Show how to add and display custom transition messages in SAP Fiori elements using the securedExecution API. Includes actionable examples for OData V2 and OData V4 controller/extension code, required imports, parameter usage, and message lifecycle notes.

**TAGS**: fiori-elements-framework, securedExecution, Messaging, SAPUI5, ODataV2, ODataV4, extensionAPI, messages

**STEP**: Overview — Concept and prerequisites

**DESCRIPTION**: Use the extension API's securedExecution method to open a "busy session" during which transition messages are collected and then displayed when the session ends. Transition messages are added to the SAPUI5 Messaging API (module: sap/ui/core/Messaging). securedExecution accepts a function returning a Promise and an optional parameters object (e.g., sActionLabel). Typical usage: call this.extensionAPI.securedExecution(...) (OData V2) or this.editFlow.securedExecution(...) (OData V4). Ensure Messaging and Message modules are loaded.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example import pattern (place in your controller/extension file)
sap.ui.define([
  "sap/ui/core/Messaging",                // Messaging API
  "sap/ui/core/message/Message"          // Message constructor (for explicit message objects)
], function(Messaging, Message) {
  "use strict";
  return { /* controller/extension methods */ };
});
```

**STEP**: OData V2 — Add a transition message after an async read (controller action)

**DESCRIPTION**: In a ListReport/SmartTable controller extension, wrap async operations in a securedExecution call. Construct a sap.ui.core.message.Message with persistent: true and add it via Messaging.addMessages(). Provide sActionLabel in mParameters to control the action text shown to users (no effect for single transition info messages where a toast is shown).

Place this method inside your controller/extension and ensure Messaging is required as shown above.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
onCustomButtonPressed: function(oEvent) {
  var oSource = oEvent.getSource();
  var oModel = oSource.getModel();
  var sBindingPath = "/EntitySet('123')"; // example binding path to read
  var fnFunction = function() {
    return new Promise(function(fnResolve, fnReject) {
      oModel.read(sBindingPath, {
        success: function(oResponse) {
          var oMessage = new sap.ui.core.message.Message({
            message: "We have received the following response: " + JSON.stringify(oResponse),
            persistent: true,                       // make it a transition message
            type: sap.ui.core.MessageType.Success
          });
          // Messaging must be required via sap.ui.define("sap/ui/core/Messaging")
          Messaging.addMessages(oMessage);
          fnResolve();
        },
        error: fnReject
      });
    });
  };

  var mParameters = {
    sActionLabel: oSource.getText() // or "Your custom text"
  };

  // Use the extensionAPI provided to your extension/controller
  this.extensionAPI.securedExecution(fnFunction, mParameters);
}
```

**STEP**: OData V2 — Display a transition message without async work

**DESCRIPTION**: If no async operation is needed but you still want to display a transition message, return a resolved Promise inside the securedExecution function and add the message to Messaging. The busy session still ensures that transition messages are shown consistently.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
onCustomButtonPressed: function(oEvent) {
  var oSource = oEvent.getSource();
  var fnAddMessage = function() {
    return new Promise(function(fnResolve) {
      var oMessage = new sap.ui.core.message.Message({
        message: "Custom button was pressed",
        persistent: true,
        type: sap.ui.core.MessageType.Success
      });
      // Messaging required from "sap/ui/core/Messaging"
      Messaging.addMessages(oMessage);
      fnResolve();
    });
  };

  var mParameters = {
    sActionLabel: oSource.getText()
  };

  this.extensionAPI.securedExecution(fnAddMessage, mParameters);
}
```

**STEP**: OData V4 — Add a transition message via editFlow.securedExecution

**DESCRIPTION**: In OData V4 flows use this.editFlow.securedExecution to wrap the message addition. Construct a Message object and add it via Messaging.addMessages. For OData V4 messages, both code and target are required; if no logical target exists, pass target: "" (empty string).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example controller/extension method
securedExecution: function(oContext, aSelectedContexts) {
  // Ensure "Messaging" and "Message" are required in sap.ui.define
  this.editFlow.securedExecution(function() {
    Messaging.addMessages(new Message({
      message: "Server says hello",
      target: "",                       // mandatory: empty string if no target
      persistent: true,                 // transition message
      type: sap.ui.core.MessageType.Success,
      code: "123"                       // mandatory for OData V4 sample
    }));
  });
},
```

**STEP**: Message lifecycle and important notes

**DESCRIPTION**: Key technical behaviors and constraints to keep in mind when adding custom messages:
- persistent: true marks a transition message; Messaging does not automatically remove transition messages — SAP Fiori elements triggers deletions tied to busy sessions/flow.
- persistent: false messages are lifecycle-managed by Messaging and are removed when the bound entity is reloaded from the backend.
- When a busy session (securedExecution) starts, previous transition messages are removed because they are assumed to belong to previous interactions.
- When the busy session ends, collected transition messages are displayed to the user according to severity.
- sActionLabel in mParameters changes the action label shown when multiple messages/actions are possible; it has no effect for a single transition info message (a toast will be shown instead).
- OData V4: both code and target are mandatory. If no target exists, set target: "".

**STEP**: References

**DESCRIPTION**: Official references and further reading:
- securedExecution API reference: https://ui5.sap.com/#/api/sap.suite.ui.generic.template.ListReport.extensionAPI.ExtensionAPI/methods/securedExecution
- Messaging API reference: https://ui5.sap.com/#/api/module:sap/ui/core/Messaging
- Using Messages (Fiori elements guide): using-messages-239b192.md
- Using the SecuredExecution Method (Fiori elements guide): using-the-securedexecution-method-6a39150.md

**LANGUAGE**: N/A

**CODE**:
```text
See the links above for full API details and additional guidance.
```
--------------------------------

**TITLE**: Adding Dynamic Side Content to Object Page Sections (Fiori elements - OData V2 & V4)

**INTRODUCTION**: Show how to add dynamic side content to Object Page sections and subsections in SAP Fiori elements (OData V2 and OData V4). Includes manifest.json patterns, fragment/view registration, equalSplit behavior, i18n keys for custom Show/Hide labels, the showSideContent API, and examples of extension code files.

**TAGS**: fiori-elements-framework, side-content, object-page, manifest.json, extension, xmlfragment, fragment, equalSplit, showSideContent

STEP: 1 — Caution / Integration rules
DESCRIPTION: Use app extensions only if manifest settings or annotations cannot produce required behavior. Always use the Fiori elements extensionAPI. Do not manipulate internal controls/models of the Fiori elements framework.
LANGUAGE: text
CODE:
```text
// Caution:
// - Use only extensionAPI of SAP Fiori elements for integration.
// - Do not access/manipulate internal controls, properties, or models created by the framework.
// - Only create app extensions when necessary (annotations/manifest can't solve it).
```

STEP: 2 — OData V2: manifest.json extension-point syntax and example
DESCRIPTION: Register a view or fragment extension for a subsection using the extension key format:
// <ExtensionPointPosition>|<EntitySet_Name>|<Annotation_Info_of_Subsection>
// Supported positions: BeforeMainContent, AfterMainContent
// Required manifest properties for each extension: className, fragmentName/viewName, type, optional equalSplit (true|false)
LANGUAGE: JSON
CODE:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "AfterMainContent|STTA_C_MP_Product|GeneralInformationForm": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.SideContentExtension",
            "type": "XML",
            "equalSplit": true
          },
          "BeforeMainContent|STTA_C_MP_Product|to_ProductSalesData::com.sap.vocabularies.UI.v1.Chart": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.SideContentExtension",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

STEP: 3 — OData V2: fragment vs view, equalSplit, UX notes, i18n key format
DESCRIPTION: Use XML fragments or views (fragmentName/viewName). equalSplit: true enforces 50:50 main vs side content. If equalSplit omitted or false, split is responsive-dependent. Avoid tables, wide content, and horizontal scroll. Provide custom button labels in i18n.properties using keys built by replacing annotation separators (--, ::, etc.) with a vertical bar (|).
LANGUAGE: properties
CODE:
```properties
# i18n.properties entries for custom Show/Hide texts
# Key format: ShowSideContent|<EntitySet>|<Annotation Info of the Subsection>
# Example keys:
ShowSideContent|STTA_C_MP_Product|to_ProductSalesData|com.sap.vocabularies.UI.v1.Chart=Show Chart Details
HideSideContent|STTA_C_MP_Product|to_ProductSalesData|com.sap.vocabularies.UI.v1.Chart=Hide Chart Details

ShowSideContent|STTA_C_MP_Product|GeneralInformationForm=Show Details
HideSideContent|STTA_C_MP_Product|GeneralInformationForm=Hide Details
```

STEP: 4 — OData V4: manifest.json sideContent registration (sections and subsections)
DESCRIPTION: Register sideContent via "template" pointing to an xmlfragment module path. For facet-based sections, place sideContent under subSections -> <subSection-key> -> sideContent. For custom sections, place sideContent under sections -> <section-key> -> sideContent. Optionally add equalSplit: true.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "<section-key>": {
                      "sideContent": {
                        "template": "SalesOrder.ext.CustomSideContent"
                      }
                    },
                    "<section-key-with-subsections>": {
                      "subSections": {
                        "<subSection-key>": {
                          "sideContent": {
                            "template": "SalesOrder.ext.CustomSideContent",
                            "equalSplit": true
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — OData V4: sideContent properties and fragment path rule
DESCRIPTION: Supported properties:
- template: module path to xmlfragment (same syntax as Fragment.load)
- equalSplit: true | false (default false) — changes layout to 1:1 split
LANGUAGE: JSON
CODE:
```json
{
  "sideContent": {
    "template": "SalesOrder.ext.CustomSideContent", // module path to xmlfragment
    "equalSplit": true // true forces 50:50 split; default/fallback is false
  }
}
```

STEP: 6 — OData V4: Toggle side content via showSideContent API (manifest action + extension JS)
DESCRIPTION: Define an action (controlConfiguration) that calls an extension function. In the extension function, call this.showSideContent("<SideContent-Key>") to toggle, or pass explicit boolean: true to show, false to hide.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "controlConfiguration": {
                  "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                    "actions": {
                      "CustomActionToggleSideContent": {
                        "press": "Namespace.ext.CustomSectionSideContent.toggleSideContent",
                        "text": "Show/Hide Side Content",
                        "enabled": true,
                        "visible": true
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// webapp/ext/customSectionSideContent.js
sap.ui.define([], function () {
  "use strict";
  return {
    toggleSideContent: function (oBindingContext) {
      // Toggle the side content (no second param toggles)
      this.showSideContent("<SideContent-key>");
      // Explicitly show:
      // this.showSideContent("customerInfo", true);
      // Explicitly hide:
      // this.showSideContent("customerInfo", false);
    }
  };
});
```

STEP: 7 — Finding the correct Section/SubSection/SideContent keys
DESCRIPTION: Keys are derived from facet/section/subsection names used by the Object Page. Guidelines:
- For facet-based sections, Section-Key usually equals the facet key at the level where the facet appears.
- For subsections, SubSection-Key equals the subsection key defined in manifest or derived from the facet.
- SideContent-Key usually equals the SubSection-Key (or the facet key at the level that contains the subsection).
- Replace all annotation separators (::, --, etc.) with | when constructing extension keys or i18n keys.
- Tip: Scenario exceptions (e.g., scenario 4.1) can cause SubSection-Key and SideContent-Key to differ — verify by checking the generated section/subsection keys in the rendered page or template metadata.
LANGUAGE: text
CODE:
```text
// Example key patterns:
// OData V2 extension point key:
// "AfterMainContent|STTA_C_MP_Product|GeneralInformationForm"
//
// i18n key for show button:
// "ShowSideContent|STTA_C_MP_Product|to_ProductSalesData|com.sap.vocabularies.UI.v1.Chart"
//
// showSideContent API usage:
// this.showSideContent("<SideContent-Key>");
// Use true/false for explicit show/hide.
```

STEP: 8 — UX constraints and best practices
DESCRIPTION: Use side content for small previews only. Do not include tables or content that introduces horizontal scroll. Prefer equalSplit for better visualization if the side content requires similar space as the main content.
LANGUAGE: text
CODE:
```text
// UX guidelines:
// - Use side content for small previews, not a replacement of main panel content.
// - Do not use tables inside side content.
// - Avoid horizontal scrollbars (keep content narrow).
// - Consider using equalSplit: true for best visualization (50:50).
```
--------------------------------

**TITLE**: Add a Custom Filter Field to Smart Filter Bar (List Report, OData V2)

**INTRODUCTION**: Step-by-step code-focused example to add a custom "Price" filter (ComboBox with two options) to the Smart Filter Bar of a Fiori elements List Report (OData V2) using an app extension. Includes fragment, controller extension, i18n entries, and manifest.json integration. Keep all names consistent so the manifest, fragment, and controller module paths resolve correctly.

**TAGS**: fiori-elements, smart-filter-bar, extension, ODataV2, UI5, manifest, i18n

**STEP**: 1 — Create fragment and controller files (paths under webapp/ext)

**DESCRIPTION**: Create an XML fragment that adds a ControlConfiguration to the Smart Filter Bar and a controller module that implements onBeforeRebindTableExtension to append filters based on the ComboBox selection. Files to create:
- webapp/ext/fragment/Custom.Filter.fragment.xml
- webapp/ext/controller/Custom.Filter.controller.js

Ensure the fragmentName and controllerName you use in manifest.json match the module naming below (ManageProducts.ext.fragment.Custom.Filter and ManageProducts.ext.controller.Custom.Filter).

**LANGUAGE**: XML

**CODE**:
```XML
<!-- File: webapp/ext/fragment/Custom.Filter.fragment.xml -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:smartfilterbar="sap.ui.comp.smartfilterbar"
    xmlns:core="sap.ui.core">
    <!-- Price Filter -->
    <smartfilterbar:ControlConfiguration key="CustomPriceFilter" index="3"
        label="{i18n>xfld.Price}"
        visibleInAdvancedArea="true" groupId="_BASIC">
        <smartfilterbar:customControl>
            <ComboBox id="CustomPriceFilter-combobox">
                <core:Item id="CustomPriceFilterItem0" key="0" text="{i18n>xtit.Price_0-100}" />
                <core:Item id="CustomPriceFilterItem3" key="1" text="{i18n>xtit.Price_GE100}" />
            </ComboBox>
        </smartfilterbar:customControl>
    </smartfilterbar:ControlConfiguration>
</core:FragmentDefinition>
```

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// File: webapp/ext/controller/Custom.Filter.controller.js
sap.ui.define([], function () {
    "use strict";
    // The controller used as a controller extension for the ListReport
    // Return an object with extension hooks (onBeforeRebindTableExtension)
    return {
        onBeforeRebindTableExtension: function (oEvent) {
            var oBindingParams = oEvent.getParameter("bindingParams");
            oBindingParams.filters = oBindingParams.filters || [];
            oBindingParams.parameters = oBindingParams.parameters || {};

            var oSmartTable = oEvent.getSource();
            var oSmartFilterBar = this.byId(oSmartTable.getSmartFilterId());
            if (oSmartFilterBar && oSmartFilterBar instanceof sap.ui.comp.smartfilterbar.SmartFilterBar) {
                var oCustomControl = oSmartFilterBar.getControlByKey("CustomPriceFilter");
                if (oCustomControl && oCustomControl instanceof sap.m.ComboBox) {
                    var vCategory = oCustomControl.getSelectedKey();
                    // If your custom control does not fire change events to the SFB,
                    // call oCustomControl.fireChange() where appropriate so the SFB shows overlay.
                    switch (vCategory) {
                        case "0":
                            oBindingParams.filters.push(new sap.ui.model.Filter("Price", "LE", "100"));
                            break;
                        case "1":
                            oBindingParams.filters.push(new sap.ui.model.Filter("Price", "GT", "100"));
                            break;
                        default:
                            break;
                    }
                }
            }
        }
    };
});
```

**STEP**: 2 — Add i18n entries

**DESCRIPTION**: Add translatable labels for the filter label and its two items to your i18n properties file. File path: webapp/i18n/i18n.properties. Use the keys referenced in the fragment (xfld.Price, xtit.Price_0-100, xtit.Price_GE100).

**LANGUAGE**: properties

**CODE**:
```properties
# File: webapp/i18n/i18n.properties
# XFLD: Custom filter breakout label
xfld.Price=Price
# XTIT: Price range 0-100
xtit.Price_0-100=Price between 0-100
# XTIT: Price range Over 100
xtit.Price_GE100=Price: Over 100
```

**STEP**: 3 — Register the fragment and controller extension in manifest.json

**DESCRIPTION**: Add the controller extension and the SmartFilterBar ControlConfiguration fragment under sap.ui5 -> extends -> extensions. Use the module names that match the files you created:
- Controller module: ManageProducts.ext.controller.Custom.Filter  (maps to webapp/ext/controller/Custom.Filter.controller.js)
- Fragment module: ManageProducts.ext.fragment.Custom.Filter (maps to webapp/ext/fragment/Custom.Filter.fragment.xml)

Insert the snippet into webapp/manifest.json inside the "sap.ui5" root object. The SmartFilterBar extension key "SmartFilterBarControlConfigurationExtension|SEPMRA_C_PD_Product" targets the entity type / filter model used by the List Report (keep the same key used in your app; the example uses SEPMRA_C_PD_Product).

**LANGUAGE**: JSON

**CODE**:
```json
// Insert inside "sap.ui5" : { ... } in webapp/manifest.json
"extends": {
  "extensions": {
    "sap.ui.controllerExtensions": {
      "sap.suite.ui.generic.template.ListReport.view.ListReport": {
        "controllerName": "ManageProducts.ext.controller.Custom.Filter"
      }
    },
    "sap.ui.viewExtensions": {
      "sap.suite.ui.generic.template.ListReport.view.ListReport": {
        "SmartFilterBarControlConfigurationExtension|SEPMRA_C_PD_Product": {
          "className": "sap.ui.core.Fragment",
          "fragmentName": "ManageProducts.ext.fragment.Custom.Filter",
          "type": "XML"
        }
      }
    }
  }
}
```

**STEP**: 4 — Notes and best practices

**DESCRIPTION**: Quick actionable reminders to ensure correct behavior and maintainability:
- Use app extensions only when annotations or manifest settings cannot achieve the requirement.
- Do not manipulate internal SAP Fiori elements controls or models directly; use the documented extension API and extension points.
- If your custom control does not trigger SmartFilterBar change detection, call .fireChange() on your control when its value changes so the SmartFilterBar shows the overlay and rebinds correctly.
- Adjust the fragment index property to position the filter among other SmartFilterBar controls (index="3" in example).
--------------------------------

**TITLE**: Adding Multiple Fields to One Column in Responsive Tables (UI.FieldGroup + UI.LineItem)

**INTRODUCTION**: Show how to group multiple fields (IDs, descriptions, action buttons, navigation, visualizations) into a single responsive table column using UI.FieldGroup and reference it from UI.LineItem (FieldGroup usage for OData V2/V4 and CAP). Includes XML, ABAP CDS, and CAP CDS examples, supported annotation types, V2 extras, TextArrangement behavior, and implementation restrictions.

**TAGS**: fiori-elements-framework, annotations, UI.FieldGroup, UI.LineItem, CDS, OData, responsive-table, export, personalization

**STEP**: 1 — Define a UI.FieldGroup that contains multiple fields
**DESCRIPTION**: Create a FieldGroup annotation with a Data collection containing UI.DataField, UI.DataFieldForAction, or other supported field types. Use a qualifier (for example FieldGroup1) so you can reference it from UI.LineItem.
**LANGUAGE**: XML
**CODE**:
```XML
<Annotation Term="UI.FieldGroup" Qualifier="FieldGroup1">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <!-- ID / property display -->
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="ContractType"/>
        </Record>

        <!-- Action button in same column -->
        <Record Type="UI.DataFieldForAction">
          <PropertyValue Property="Label" String="Dummy Button"/>
          <PropertyValue Property="Action" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 2 — Define UI.FieldGroup in ABAP CDS
**DESCRIPTION**: ABAP CDS variant: tag properties with @UI.fieldGroup using the same qualifier. Use type #STANDARD for fields, #FOR_ACTION for actions with dataAction indicating backend action.
**LANGUAGE**: ABAP CDS
**CODE**:
```ABAP CDS
@UI.fieldGroup: [
  {
    value: 'CONTRACTTYPE',
    type: #STANDARD,
    position: 1,
    qualifier: 'FieldGroup1'
  }
]
CONTRACTTYPE;

@UI.fieldGroup: [
  {
    label: 'Dummy Button',
    dataAction: 'PUSHDOWN:com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2',
    type: #FOR_ACTION,
    position: 2,
    qualifier: 'FieldGroup1'
  }
]
contractname;
```

**STEP**: 3 — Define UI.FieldGroup in CAP CDS
**DESCRIPTION**: CAP CDS (Service model) representation of UI.FieldGroup using UI.FieldGroup with qualifier.
**LANGUAGE**: CAP CDS
**CODE**:
```CDS
UI.FieldGroup #FieldGroup1 : {
  Data : [
    {
      $Type : 'UI.DataField',
      Value : ContractType
    },
    {
      $Type : 'UI.DataFieldForAction',
      Label : 'Dummy Button',
      Action : 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2'
    }
  ]
}
```

**STEP**: 4 — Reference the FieldGroup from UI.LineItem (XML)
**DESCRIPTION**: In the LineItem annotation, add a UI.DataFieldForAnnotation that Target references the FieldGroup qualifier. The column label is defined here.
**LANGUAGE**: XML
**CODE**:
```XML
<Annotation Term="UI.LineItem">
  <Collection>
    <!-- other columns -->
    <Record Type="UI.DataFieldForAnnotation">
      <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#FieldGroup1" />
      <PropertyValue Property="Label" String="Type Information"/>
    </Record>
    <!-- other columns -->
  </Collection>
</Annotation>
```

**STEP**: 5 — Reference the FieldGroup from UI.LineItem (ABAP CDS)
**DESCRIPTION**: ABAP CDS line item: use type #AS_FIELDGROUP and valueQualifier set to the FieldGroup qualifier.
**LANGUAGE**: ABAP CDS
**CODE**:
```ABAP CDS
@UI.lineItem: [
  {
    label: 'Type Information',
    type: #AS_FIELDGROUP,
    valueQualifier: 'FieldGroup1'
  }
]
producttype;
```

**STEP**: 6 — Reference the FieldGroup from UI.LineItem (CAP CDS)
**DESCRIPTION**: CAP CDS line item using DataFieldForAnnotation with Target pointing to the FieldGroup qualifier.
**LANGUAGE**: CAP CDS
**CODE**:
```CDS
UI.LineItem : [
  {
    $Type : 'UI.DataFieldForAnnotation',
    Target : '@UI.FieldGroup#FieldGroup1',
    Label : 'Type Information'
  }
]
```

**STEP**: 7 — Supported field types inside UI.FieldGroup
**DESCRIPTION**: Allowed annotations you can put in UI.FieldGroup collections. Use these to combine semantic items into the same visual column.
**LANGUAGE**: Text
**CODE**:
```text
Supported UI.FieldGroup content (OData V2 & V4):
- UI.DataField
- UI.DataFieldForAction
- UI.DataFieldForIntentBasedNavigation
- UI.DataFieldForAnnotation which can contain:
  - Communication.Contact
  - UI.Visualization/Rating
  - UI.Visualization/Progress

Additional for SAP Fiori elements (OData V2) only:
- UI.DataFieldWithNavigationPath
- UI.DataFieldForAnnotation containing UI.Chart
```

**STEP**: 8 — TextArrangement behavior for fields with sap:text
**DESCRIPTION**: If a property and its sap:text property (text entity) are both shown inside the same FieldGroup column, TextArrangement is not applied — default behavior is idOnly. For all other scenarios, define textArrangement as needed to show ID + description.
**LANGUAGE**: Text
**CODE**:
```text
Note: When a property and its corresponding sap:text property are shown in the same column (same FieldGroup), TextArrangement annotation is ignored and the display defaults to idOnly. Otherwise define textArrangement normally.
```

**STEP**: 9 — Restrictions and known limitations
**DESCRIPTION**: Important export and personalization restrictions to plan for when using semantically connected columns.
**LANGUAGE**: Text
**CODE**:
```text
- Excel export (SAP Fiori elements OData V2): only the first visible field of the semantically connected column is exported.
- Excel export (SAP Fiori elements OData V4): none of the fields of semantically connected columns are exported.
- Table personalization (filter/sort/group): users can only filter, sort, and group based on the individual properties listed inside the UI.FieldGroup (properties must belong to the same entity type as the UI.LineItem). Example: If a column “Combined” contains height and weight, personalization cannot act on "Combined" — only on height or weight individually.
```

**STEP**: 10 — Example screenshot and assets
**DESCRIPTION**: Reference to visual result asset for documentation or UI review.
**LANGUAGE**: Text
**CODE**:
```text
Image: images/Multiple_IDs_93da960.png
Caption: Multiple IDs, Descriptions, and Action Buttons in a Table Column
```
--------------------------------

**TITLE**: Add Segmented Buttons to an Object Page Table Toolbar (quickVariantSelection)

**INTRODUCTION**: This guide shows how to add segmented buttons (or a selection box) to an Object Page table toolbar using SelectionVariant annotations and manifest configuration (quickVariantSelection). Each button or selection item maps to a SelectionVariant that applies filters to the table when activated. Includes examples for XML annotations, ABAP CDS, CAP CDS, and manifest.json entries for OData V2 and OData V4.

**TAGS**: fiori-elements-framework, quickVariantSelection, SelectionVariant, segmented-button, manifest.json, odata-v2, odata-v4, annotations, CDS, CAP

STEP: 1 — Create SelectionVariant annotations (XML)
DESCRIPTION: Define SelectionVariant annotations (simple or complex) in XML. Each SelectionVariant gets a Qualifier used by the manifest quickVariantSelection. Use SelectOptions with UI.SelectOptionType and UI.SelectionRangeType for ranges.
LANGUAGE: XML
CODE:
```xml
<!-- Example XML annotations (place in your annotation file or metadata) -->
<Annotation Term="UI.SelectionVariant" Qualifier="SimpleFilter">
  <Record>
    <PropertyValue Property="Text" String="Tax amount less than 10 USD" />
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record Type="UI.SelectOptionType">
          <PropertyValue Property="PropertyName" PropertyPath="tax_amount" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record Type="UI.SelectionRangeType">
                <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/LT" />
                <PropertyValue Property="Low" String="10" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>

<Annotation Term="UI.SelectionVariant" Qualifier="ComplexFilter">
  <Record>
    <PropertyValue Property="Text" String="Net Amount between 10 and 40 And Gross Amount Less than 100 USD" />
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record Type="UI.SelectOptionType">
          <PropertyValue Property="PropertyName" PropertyPath="net_amount" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record Type="UI.SelectionRangeType">
                <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/BT" />
                <PropertyValue Property="Low" String="10" />
                <PropertyValue Property="High" String="40" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
        <Record Type="UI.SelectOptionType">
          <PropertyValue Property="PropertyName" PropertyPath="gross_amount" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record Type="UI.SelectionRangeType">
                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/LT" />
                <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                <PropertyValue Property="Low" String="100" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 2 — Create SelectionVariant annotations (ABAP CDS)
DESCRIPTION: If using ABAP CDS, annotate the CDS view with @UI.selectionVariant entries. Use qualifier and text fields to match manifest references.
LANGUAGE: ABAP CDS
CODE:
```
@UI.selectionVariant: [
  {
    text: 'Tax amount less than 10 USD',
    qualifier: 'SimpleFilter',
    filter: 'tax_amount LT 10'
  }
]

@UI.selectionVariant: [
  {
    text: 'Net Amount between 10 and 40 And Gross Amount Less than 100 USD',
    qualifier: 'ComplexFilter',
    filter: 'net_amount GE 10 and net_amount LE 40 and gross_amount LT 100 '
  }
]
```

STEP: 3 — Create SelectionVariant annotations (CAP CDS)
DESCRIPTION: If using CAP CDS, create UI.SelectionVariant entries and qualifiers in the CDS or annotation file.
LANGUAGE: CDS (CAP)
CODE:
```
UI.SelectionVariant #SimpleFilter : {
  Text : 'Tax amount less than 10 USD',
  SelectOptions : [
    {
      $Type : 'UI.SelectOptionType',
      PropertyName : tax_amount,
      Ranges : [
        {
          $Type : 'UI.SelectionRangeType',
          Sign : #I,
          Option : #LT,
          Low : '10'
        }
      ]
    }
  ]
},
UI.SelectionVariant #ComplexFilter : {
  Text : 'Net Amount between 10 and 40 And Gross Amount Less than 100 USD',
  SelectOptions : [
    {
      $Type : 'UI.SelectOptionType',
      PropertyName : net_amount,
      Ranges : [
        {
          Sign : #I,
          Option : #BT,
          Low : '10',
          High : '40'
        }
      ]
    },
    {
      $Type : 'UI.SelectOptionType',
      PropertyName : gross_amount,
      Ranges : [
        {
          $Type : 'UI.SelectionRangeType',
          Option : #LT,
          Sign : #I,
          Low : '100'
        }
      ]
    }
  ]
}
```

STEP: 4 — Configure quickVariantSelection in manifest.json for OData V2 (ObjectPage)
DESCRIPTION: Add quickVariantSelection under the ObjectPage component -> settings -> sections -> <SectionID>.quickVariantSelection. Use "annotationPath" referencing the SelectionVariant qualifier (UI.SelectionVariant#Qualifier). Set showCounts to true to display counts on buttons (triggers count calls).
LANGUAGE: JSON
CODE:
```json
// manifest.json — for OData V2 object page section
"component": {
  "name": "sap.suite.ui.generic.template.ObjectPage",
  "settings": {
    "sections": {
      "SalesOrderItemsID": {
        "navigationProperty": "to_Item",
        "entitySet": "C_STTA_SalesOrderItem_WD_20",
        "createMode": "inline",
        "quickVariantSelection": {
          "showCounts": true,
          "variants": {
            "0": {
              "key": "_tab2",
              "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#SimpleFilter"
            },
            "1": {
              "key": "_tab3",
              "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#ComplexFilter"
            }
          }
        }
      }
    },
    "showRelatedApps": true
  }
}
```

STEP: 5 — Configure quickVariantSelection in manifest.json for OData V4 (ObjectPage / controlConfiguration)
DESCRIPTION: For OData V4 (FE), add quickVariantSelection under options -> settings -> controlConfiguration -> <path-to-entityLineItem>@com.sap.vocabularies.UI.v1.LineItem -> tableSettings.quickVariantSelection.paths. Each path uses annotationPath. Use showCounts and hideTableTitle as needed.
LANGUAGE: JSON
CODE:
```json
// manifest.json — for OData V4 Object Page controlConfiguration
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "contextPath": "/SalesOrderManage",
      "controlConfiguration": {
        "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
          "tableSettings": {
            "type": "GridTable",
            "quickVariantSelection": {
              "paths": [
                {
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#SimpleFilter"
                },
                {
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#ComplexFilter"
                }
              ],
              "showCounts": true,
              "hideTableTitle": true
            }
          }
        }
      }
    }
  }
}
```

STEP: 6 — Behavior & implementation notes (actionable)
DESCRIPTION: Preserve functional behavior and performance expectations when implementing quickVariantSelection.
LANGUAGE: JSON / Text
CODE:
```text
- Segmented vs selection box:
  - If number of variants <= 3 -> rendered as segmented buttons.
  - If number of variants >= 4 -> rendered as a selection box (drop-down).

- showCounts behavior:
  - When showCounts = true: the UI queries counts and displays numbers next to button labels.
    - On initial table load, two backend count calls are made to determine record counts for the table and variants.
  - OData V2: set showCounts to false to prevent count display and suppress count calls.
  - OData V4: showCounts is false by default; set to true explicitly to show counts.

- hideTableTitle (OData V4):
  - Setting hideTableTitle: true hides the table title and shows only segmented buttons / selection box.
  - Use only when SelectionVariant Text values are self-explanatory and can replace the table title.

- SelectionVariant combination logic:
  - If a SelectionVariant contains multiple SelectOptionType entries:
    - Filters with the same target property are combined with OR.
    - Filters with different target properties are combined with AND.
```

STEP: 7 — Quick checklist for implementation
DESCRIPTION: Steps to implement in order.
LANGUAGE: Text
CODE:
```text
1. Define SelectionVariant annotations (XML / ABAP CDS / CAP CDS) with unique qualifiers.
2. Add quickVariantSelection entries in manifest.json:
   - OData V2: component.settings.sections.<SectionID>.quickVariantSelection.variants[*].annotationPath
   - OData V4: options.settings.controlConfiguration.<path>@...LineItem.tableSettings.quickVariantSelection.paths[*].annotationPath
3. Set showCounts true/false depending on whether you want counts (note OData V4 default false).
4. Optionally use hideTableTitle (OData V4) to hide the table title.
5. Test: ensure clicking a segmented button applies the SelectionVariant filters to the table.
```

--------------------------------

**TITLE**: Adding and Removing Object Subpages in Fiori Elements Apps (OData V2 & V4)

**INTRODUCTION**: Procedures and ready-to-use manifest.json examples to add or remove object-page subpages in Fiori Elements apps. Covers recommended tooling, OData V2 nested page configuration, and OData V4 routing+target configuration. Use these snippets inside your app manifest (webapp/manifest.json) for code generation or manual edits.

**TAGS**: fiori-elements-framework, manifest.json, subpage, object-page, OData V2, OData V4, routing, targets, SAP Fiori tools

STEP: 1 — Recommended workflow: use SAP Fiori tools (Page Map)
  
DESCRIPTION: Use SAP Fiori tools (extensions for Business Application Studio or VS Code) to visually add, configure, or remove pages with the Page Map. This is the recommended approach; it updates manifest.json for you.

LANGUAGE: Text

CODE:
```text
Tool: SAP Fiori tools (Page Map)
Action: Open Page Map in SAP Business Application Studio or VS Code -> add/remove/configure pages -> manifest.json is updated automatically.
File: webapp/manifest.json (automatically modified)
Note: SAP Web IDE is deprecated for trial accounts; use Business Application Studio instead.
```

STEP: 2 — Add a nested subpage in OData V2 (manual edit)

DESCRIPTION: For OData V2 apps the manifest uses sap.ui.generic.app.pages with nested "pages" objects. Add a nested page (subpage) entry under the parent page. The example below shows:
- Root list report page
- Object page for entity SEPMRA_I_ProductWithDraft
- Subpage for related entity SEPMRA_I_ProductTextWithDraft using navigationProperty "to_ProductText"

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "entitySet": "SEPMRA_I_ProductWithDraft",
      "component": {
        "name": "sap.suite.ui.generic.template.ListReport",
        "list": true
      },
      "pages": {
        "entitySet": "SEPMRA_I_ProductWithDraft",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        },
        "pages": {
          "entitySet": "SEPMRA_I_ProductTextWithDraft",
          "navigationProperty": "to_ProductText",
          "component": {
            "name": "sap.suite.ui.generic.template.ObjectPage"
          }
        }
      }
    }
  }
}
```

STEP: 3 — Remove an OData V2 subpage

DESCRIPTION: Delete the nested "pages" entry for the subpage from the sap.ui.generic.app structure in manifest.json. Removing the configuration removes the subpage and its link on the object page.

LANGUAGE: Text

CODE:
```text
Action: Remove the subpage JSON node under "sap.ui.generic.app" -> "pages" -> "pages" -> "pages" that defines the sub-entity.
Effect: Subpage and navigation link are removed from the app.
File: webapp/manifest.json
```

STEP: 4 — Add a subpage in OData V4 (manual edit): routing + target

DESCRIPTION: For OData V4 apps, add two objects in manifest.json under "sap.ui5" -> "routing":
1. A route (added into "routes": [ ... ]) with pattern, name, and target.
2. A target (added into "targets": { ... }) defining type Component, name = "sap.fe.templates.ObjectPage", and settings.contextPath for the sub-entity.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "config": {
        "routerClass": "sap.m.routing.Router",
        "viewType": "XML",
        "viewPath": "",
        "controlId": "app",
        "controlAggregation": "pages"
      },
      "routes": [
        {
          "pattern": "SalesOrderManage({key})/_Item({key2}):?query:",
          "name": "SalesOrderItemObjectPage",
          "target": "SalesOrderItemObjectPage"
        }
      ],
      "targets": {
        "SalesOrderItemObjectPage": {
          "type": "Component",
          "id": "SalesOrderItemObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "contextPath": "/SalesOrderItem"
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Remove an OData V4 subpage

DESCRIPTION: To remove a subpage in OData V4, delete both:
- The corresponding route object from the "routes" array.
- The corresponding target entry from the "targets" object.
After removal, save manifest.json and rebuild/redeploy the app.

LANGUAGE: Text

CODE:
```text
Action:
1) Remove the route with "name": "<YourSubpageRouteName>" from sap.ui5.routing.routes.
2) Remove the target object with the matching key from sap.ui5.routing.targets.
File: webapp/manifest.json
Effect: Navigation route and component target for the subpage are removed.
```

STEP: 6 — Generator-created subpages and 1:n associations (OData V2)

DESCRIPTION: If you created the app with the Fiori generator and selected first- and second-level entities, the generator created a 1:n association from root entity to sub-entity and configured manifest.json accordingly. Navigation from the object page to the subpage is automatic. Remove the generated configuration as shown in Step 3 to delete the subpage.

LANGUAGE: Text

CODE:
```text
Note:
- Generator action: Creates 1:n association and nested pages in "sap.ui.generic.app".
- Removal: Remove the generated nested pages entries in manifest.json to remove the subpage and navigation.
```

STEP: 7 — Additional references and intent-based navigation

DESCRIPTION: For external navigation (intent-based navigation) or more advanced navigation changes, follow the "Changing Navigation to Object Page" guide. Also note the SAP Web IDE deprecation note.

LANGUAGE: Text

CODE:
```text
References:
- Changing Navigation to Object Page: changing-navigation-to-object-page-8bd546e.md
Notes:
- SAP Web IDE is no longer available for BTP trial accounts; use SAP Business Application Studio.
- File to edit: webapp/manifest.json
```
--------------------------------

**TITLE**: Add the SAP AI Icon to Action Buttons (fiori-elements)

**INTRODUCTION**: This document shows how to add the SAP AI icon (SAP-icons V5 "AI") to action buttons in Fiori elements apps. It covers the required icon font include, rules/restrictions, and code examples for configuring the icon via manifest.json and local annotations (XML and CAP CDS). Use manifest settings to override local annotations. ABAP CDS does not support UI.IsAIOperation — use local XML annotations.

**TAGS**: fiori-elements-framework, ai, icons, manifest, annotations, CAP, CDS, ABAP, UI.DataFieldForAction, UI.DataFieldForActionGroup

STEP: Prerequisites and rules
DESCRIPTION: Include the SAP icons font and follow the rules for using the AI icon.
LANGUAGE: HTML
CODE:
```html
<!-- Ensure the SAP Icons V5 stylesheet is loaded (path may vary per project) -->
<link rel="stylesheet" type="text/css" href="../css/sap-icons.css"/>

<!-- Rules:
  - Use the SAP-icons-V5 "AI" icon (visual glyph for AI) for all AI-related buttons.
  - Icon is displayed before the button text.
  - Provide transparency when processing personal data.
  - Restriction: the AI icon can only be added to buttons created with UI.DataFieldForAction or UI.DataFieldForActionGroup.
  - Inline action buttons cannot use this icon.
  - If manifest.json and local annotations are both present, manifest.json overrides local annotations.
-->
```

STEP: Add AI icon via manifest.json (recommended for global/app-level control)
DESCRIPTION: Set isAIOperation = true for the action entry under controlConfiguration for the LineItem table. Place the snippet under sap.ui5 -> routing -> targets -> <YourTarget> -> options -> settings -> controlConfiguration -> @com.sap.vocabularies.UI.v1.LineItem -> actions -> <ActionKey>.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "ListReportExample": {
          "type": "Component",
          "name": "sap.fe.templates.ListReport",
          "id": "ListReportExample",
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "actions": {
                    "TableCustomAction": {
                      "text": "Custom Action",
                      "press": "sap.fe.core.ActionAllAreas.AnnotationUnboundAction",
                      "isAIOperation": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Add AI icon via local XML annotations (UI.DataFieldForAction)
DESCRIPTION: Annotate the action target with UI.IsAIOperation = true in your local annotation XML. Use this approach when per-action/local metadata control is required. File: annotations.xml (or your local annotations file).
LANGUAGE: XML
CODE:
```xml
<!-- Local annotations.xml -->
<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="ID" String="AIActionChart" />
  <PropertyValue Property="Label" String="AI Action" />
  <PropertyValue Property="Action" String="com.c_salesordermanage_sd_aggregate.EntityContainer/AIUnboundAction" />
</Record>

<Action Name="AIUnboundAction" IsBound="false">
  <ReturnType Type="com.c_salesordermanage_sd_aggregate.SalesOrderManage" />
</Action>

<Annotations Target="com.c_salesordermanage_sd_aggregate.AIUnboundAction()">
  <Annotation Term="UI.IsAIOperation" bool="true" />
</Annotations>
```

STEP: ABAP CDS note
DESCRIPTION: ABAP CDS does not support UI.IsAIOperation. Use local XML annotations (see previous step) to mark actions as AI operations.

STEP: Add AI icon via CAP CDS annotations
DESCRIPTION: For CAP projects, annotate the action in your CDS so the generated annotation contains UI.IsAIOperation = true. Place the annotate block where your service/actions are defined.
LANGUAGE: CDS
CODE:
```cds
namespace sap.fe.core;

annotate ActionAllAreas.RootElement with @UI: {
  FieldGroup #GeneralInformation: {
    Label: 'General Information',
    Data : [
      {
        $Type : 'UI.DataFieldForAction',
        Label : 'Annotation Action',
        Action: 'sap.fe.core.ActionAllAreas.AnnotationAction'
      }
    ]
  },
  Identification: [{
    $Type : 'UI.DataFieldForAction',
    Label : 'Annotation Action',
    Action: 'sap.fe.core.ActionAllAreas.AnnotationAction'
  }]
}

service ActionAllAreas {
  @odata.draft.enabled
  entity RootElement as projection on core.RootElement actions {
    @cds.odata.bindingparameter.name: 'self'
    @UI.IsAIOperation: true
    action AnnotationAction() returns RootElement;
  }
}
```

STEP: UI.DataFieldForActionGroup (group actions) — local annotation guidance
DESCRIPTION: When using UI.DataFieldForActionGroup, you must mark each child UI.DataFieldForAction within the group as AI by setting UI.IsAIOperation = true on each child action annotation. If you need group-level control, prefer local XML annotations (manifest cannot be used for DataFieldForActionGroup per framework constraints).
LANGUAGE: XML
CODE:
```xml
<!-- Example: DataFieldForActionGroup with child actions annotated as AI -->
<Record Type="UI.DataFieldForActionGroup">
  <PropertyValue Property="ID" String="AIActionGroup" />
  <PropertyValue Property="Label" String="AI Actions Group" />
  <!-- Children are individual DataFieldForAction entries -->
  <CollectionProperty Property="Data">
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="ID" String="AIAction1" />
      <PropertyValue Property="Label" String="AI Action 1" />
      <PropertyValue Property="Action" String="Namespace.Service/AIAction1" />
    </Record>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="ID" String="AIAction2" />
      <PropertyValue Property="Label" String="AI Action 2" />
      <PropertyValue Property="Action" String="Namespace.Service/AIAction2" />
    </Record>
  </CollectionProperty>
</Record>

<!-- Then annotate each action target as AI -->
<Annotations Target="Namespace.Service.AIAction1()">
  <Annotation Term="UI.IsAIOperation" bool="true" />
</Annotations>
<Annotations Target="Namespace.Service.AIAction2()">
  <Annotation Term="UI.IsAIOperation" bool="true" />
</Annotations>
```

STEP: Implementation checklist
DESCRIPTION: Quick actionable checklist to ensure correct behavior.
LANGUAGE: JSON
CODE:
```json
{
  "checklist": [
    "Include SAP icons CSS (sap-icons.css) in the app shell or index.html",
    "Use UI.DataFieldForAction or UI.DataFieldForActionGroup for actions that should show the AI icon",
    "Set UI.IsAIOperation = true in local annotation XML (or set isAIOperation = true in manifest controlConfiguration for LineItem actions)",
    "Remember manifest.json settings override local annotations",
    "ABAP CDS: use local XML annotations because UI.IsAIOperation is not supported in ABAP CDS",
    "CAP CDS: annotate the action with @UI.IsAIOperation: true in the service/action CDS definition",
    "For action groups (UI.DataFieldForActionGroup), set UI.IsAIOperation on every child DataFieldForAction"
  ]
}
```
--------------------------------

**TITLE**: Enable OData $select for an OVF/Ovp Card via manifest.json (addODataSelect)

**INTRODUCTION**: This document shows how to enable the OData $select parameter for a specific OVF/OVP card by setting the addODataSelect property in the application manifest. Use this when your card requires explicit $select queries (for example Smart Business OData services or aggregated values). Note: $select is not enabled by default for list/table cards because it can affect navigation behavior.

**TAGS**: fiori-elements-framework, SAP Fiori, OData, $select, manifest.json, sap.ovp, cards, Smart Business, OVP

STEP: 1 - Locate application manifest.json

DESCRIPTION: Open your application manifest file (typically manifest.json in the project root or webapp folder). You will add the addODataSelect flag under the relevant card configuration inside the sap.ovp -> cards -> <cardId> -> settings object.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters",
    "cards": {
      "card00": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.list",
        "settings": {
          "entitySet": "SalesOrderSet",
          "category": "Sales Orders with filters",
          "listType": "extended",
          "addODataSelect": true
        }
      }
    }
  }
}
```

STEP: 2 - What the property does and when to use it

DESCRIPTION: Setting "addODataSelect": true instructs the card runtime to include OData $select clauses in requests for this card. Use this when:
- The backend requires explicit property selection (e.g., Smart Business OData services).
- Aggregated or computed fields are only returned when explicitly selected.
Do NOT enable this globally for list/table cards unless you understand navigation implications; it may remove properties needed for navigation or client-side logic.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "<yourCardId>": {
        "settings": {
          "addODataSelect": true
        }
      }
    }
  }
}
```

STEP: 3 - Verify and test

DESCRIPTION: After updating manifest.json:
- Deploy or run the application.
- Inspect network requests for the card's OData calls and confirm $select parameters are present and include required properties.
- Validate that aggregated/required values are returned and navigation behavior still works as expected.

LANGUAGE: JSON

CODE:
```json
// No code change here; test by checking runtime network requests, e.g.:
// GET /odata/service/SalesOrderSet?$select=PropertyA,PropertyB&$filter=...
```
--------------------------------

**TITLE**: Adding Titles to Object Page Tables (Fiori Elements)

**INTRODUCTION**: This document shows how to add a title for a table placed inside an Object Page section by providing a string to UI.HeaderInfo/TypeNamePlural for the entity type associated with the table. Includes XML, ABAP CDS and CAP CDS examples, plus key considerations.

**TAGS**: fiori-elements-framework, UI.HeaderInfo, TypeNamePlural, object-page, annotations, CDS, CAP, ABAP, XML, i18n

**STEP**: 1 — XML Annotation for OData Metadata
**DESCRIPTION**: Add a UI.HeaderInfo annotation to the entity type in the service metadata (Annotations file) and set TypeNamePlural to the title string (i18n token or literal). TypeNamePlural is mandatory; the table title is derived from this property.
**LANGUAGE**: XML
**CODE**:
```XML
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductTextType">
  <Annotation Term="UI.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeName" String="Product Text" />
      <PropertyValue Property="TypeNamePlural" String="{@i18n>@TableTitle}" />
      <PropertyValue Property="Title">
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="Name" />
        </Record>
      </PropertyValue>
      <PropertyValue Property="Description">
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="Language" />
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 2 — ABAP CDS Annotation
**DESCRIPTION**: Annotate the CDS view or externally annotate the view with @UI.headerInfo. Ensure TypeNamePlural is provided (use i18n token or literal). This annotation will be used by the Fiori Elements Object Page to derive the table title for the associated entity.
**LANGUAGE**: ABAP CDS
**CODE**:
```ABAP
annotate view STTA_C_MP_PRODUCTTEXT with {
  @UI.headerInfo: {
    typeName: 'Product Text',
    typeNamePlural: '{@i18n>@TableTitle}',
    title: {
      value: 'NAME',
      type: #STANDARD
    },
    description: {
      value: 'LANGUAGE',
      type: #STANDARD
    }
  }
};
```

**STEP**: 3 — CAP CDS Annotation
**DESCRIPTION**: For CAP-based services, annotate the entity in the service definition with UI.HeaderInfo and set TypeNamePlural. Use UI.DataField for Title and Description values pointing at entity properties.
**LANGUAGE**: CDS (CAP)
**CODE**:
```CDS
annotate STTA_PROD_MAN.STTA_C_MP_ProductType @(
  UI.HeaderInfo : {
    TypeName : 'Product Text',
    TypeNamePlural : '{@i18n>@TableTitle}',
    Title : {
      $Type : 'UI.DataField',
      Value : Name
    },
    Description : {
      $Type : 'UI.DataField',
      Value : Language
    }
  }
);
```

**STEP**: 4 — Key Considerations and UI Behavior
**DESCRIPTION**: Preserve these behaviors and rules when implementing:
**LANGUAGE**: Text
**CODE**:
```
- TypeNamePlural is mandatory: without it the object page table title will not be displayed.
- If UI.HeaderInfo is not provided for the entity type, the table title is not shown.
- If you use the same string under TypeNamePlural and also as the section title, ensure you intentionally set the appropriate section title — the framework may hide the section title in favor of the control title.
- If a section or subsection contains only one control of a specific type (table or chart), the framework hides the section/subsection title and uses it as the control title.
- Sections with tables/charts (custom or embedded) can choose to hide the section title and set it as the title for the control.

Image reference showing the result:
images/Adding_Titles_to_Object_page_8920264.png

Further reading:
- Placing Reuse Component Instances on the Object Page: placing-reuse-component-instances-on-the-object-page-1ba7f88.md
- Adding a Custom Section to an Object Page: adding-a-custom-section-to-an-object-page-a357047.md
```
--------------------------------

**TITLE**: Add Two Adjacent Tables in an Object Page Subsection (Fiori elements OData V2)

**INTRODUCTION**: Add two tables side-by-side inside a single subsection of a Fiori elements Object Page using OData V2 UI annotations. Provide the CollectionFacet with two ReferenceFacet records that point to existing LineItem annotations. This is applicable for SAP Fiori elements for OData V2.

**TAGS**: fiori-elements-framework, OData V2, annotations, UI.CollectionFacet, UI.ReferenceFacet, object-page, responsive

**STEP**: 1 — Add a CollectionFacet with two ReferenceFacet entries

**DESCRIPTION**: Insert a UI.CollectionFacet into your OData V2 annotations file (e.g., annotations.xml) for the entity type used by the Object Page. The CollectionFacet contains two UI.ReferenceFacet records that reference existing @UI.LineItem annotations. Replace the Annotations Target with your service namespace and entity type. Keep the AnnotationPath values pointing to the navigation properties that expose the related LineItem annotations.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Insert into your annotations file (e.g., annotations.xml) under the appropriate <Annotations Target="YourService.YourEntityType"> -->
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="UI.Facets">
    <Collection>
      <Record Type="UI.CollectionFacet">
        <PropertyValue Property="Label" String="Single Section Multiple Tables" />
        <PropertyValue Property="ID" String="MultiTable" />
        <PropertyValue Property="Facets">
          <Collection>
            <!-- First table: Sales Order Items -->
            <Record Type="UI.ReferenceFacet">
              <PropertyValue Property="Label" String="Sales Order Items" />
              <PropertyValue Property="ID" String="SalesOrderItemsID" />
              <!-- Point to the LineItem annotation for items; keep the qualifier if used (#SalesOrderItem) -->
              <PropertyValue Property="Target" AnnotationPath="to_Item/@UI.LineItem#SalesOrderItem" />
              <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
            </Record>

            <!-- Second table: Contacts -->
            <Record Type="UI.ReferenceFacet">
              <PropertyValue Property="Label" String="Contacts" />
              <PropertyValue Property="ID" String="ContactsID" />
              <PropertyValue Property="Target" AnnotationPath="to_BPAContact/@UI.LineItem" />
              <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
            </Record>
          </Collection>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 2 — Placement and usage notes

**DESCRIPTION**: Place the above annotation under the entity type that represents the Object Page. Ensure the referenced LineItem annotations exist at the specified AnnotationPath locations (navigation property + @UI.LineItem or qualified annotation). No extra front-end coding is required—the Fiori elements runtime renders the two tables adjacent in the subsection.

**LANGUAGE**: Text

**CODE**:
```
Placement:
- File: annotations.xml (or your OData V2 annotations file)
- Section: <Annotations Target="YourService.YourEntityType"> ... </Annotations>
- Ensure: Navigation properties (e.g., to_Item, to_BPAContact) have @UI.LineItem annotations.

References:
- First table Target: to_Item/@UI.LineItem#SalesOrderItem
- Second table Target: to_BPAContact/@UI.LineItem

Notes:
- The UI.Importance setting is optional; shown as High in the sample.
- If your LineItem annotations use qualifiers, include them in the AnnotationPath (e.g., @UI.LineItem#Qualifier).
```

**STEP**: 3 — Responsive layout behavior (space occupied by the two tables)

**DESCRIPTION**: The Fiori elements layout automatically adapts the widths of the two tables based on the container/screen size. Use this mapping to validate UI expectations and screenshots.

**LANGUAGE**: Text

**CODE**:
```
Responsive widths (first table / second table):
- Extra Large (XL) — e.g., large desktops
  - First table: 75%
  - Second table: 25%
  - Screenshot: images/Extra_Large_XL_Containers_Screen_Size_287b6ce.png

- Large (L) — e.g., desktops
  - First table: 66.66%
  - Second table: 33.33%
  - Screenshot: images/Large_L_Containers_Screen_Size_88b89fc.png

- Medium (M) — e.g., tablets
  - First table: 50%
  - Second table: 50%
  - Screenshot: images/Medium_M_Containers_Screen_Sizes_43b4b66.png

- Small (S) — e.g., mobiles
  - Tables stack vertically (one below the other)
  - Screenshot: images/Small_S_Containers_Screen_Sizes_d94126e.png
```
--------------------------------

**TITLE**: Address Facet in Object Page Sections and Quick Views (UI.ReferenceFacet / Communication.Address)

**INTRODUCTION**: Use a UI.ReferenceFacet (or DataFieldForAnnotation pointing to a ReferenceFacet) to render an address facet in SAP Fiori elements (OData V2). The facet shows the ReferenceFacet label and, beneath it, only the address annotation's label property. The label must contain the fully formatted address with "\n" for new lines. Other address annotation properties are not rendered.

**TAGS**: fiori-elements-framework, UI.ReferenceFacet, Communication.Address, address, OData V2, annotations, XML, ABAP, CAP, JSON

STEP: 1 — Behavior and requirements
DESCRIPTION: Summary of what the address facet renders and the required formatting for the address text.
LANGUAGE: Text
CODE:
```text
- Applicable only to SAP Fiori elements for OData V2.
- The facet displays:
  1) The UI.ReferenceFacet.Label (e.g., "Communication Address")
  2) Below it: only the Label property of the Communication.Address annotation.
- Address Label must contain the fully formatted address using "\n" for line breaks.
  Example Label value:
    "Mail Drop: TNE QB\n123 Main Street\nAny Town, CA 91921-1234\nU.S.A."
- Other properties of the address annotation (street, city, postalCode, etc.) are NOT interpreted or rendered.
```

STEP: 2 — As a separate section (ReferenceFacet)
DESCRIPTION: Create a UI.ReferenceFacet annotation that points to the Communication.Address annotation. Use this to render a standalone section in the object page.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation (UI.ReferenceFacet) -->
<Record Type="UI.ReferenceFacet">
  <PropertyValue Property="Label" String="Communication Address" />
  <PropertyValue Property="Target" AnnotationPath="to_Address/@Communication.Address" />
</Record>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.facet: [
  {
    label: 'Communication Address',
    type: #ADDRESS_REFERENCE,
    targetElement: '_Address',
    purpose: #STANDARD
  }
]
/* _Address should refer to the navigation or address element containing @Communication.Address */
```

LANGUAGE: JSON
CODE:
```json
// CAP / JSON representation for UI.ReferenceFacet
{
  "$Type": "UI.ReferenceFacet",
  "Label": "Communication Address",
  "Target": "to_Address/@Communication.Address"
}
```

STEP: 3 — As part of a FieldGroup and in Quick View (DataFieldForAnnotation, smart link popover)
DESCRIPTION: Use UI.DataFieldForAnnotation inside a UI.FieldGroup to show the address within a section or a quick view (smart link). The DataFieldForAnnotation.Target points to the Communication.Address annotation.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation: FieldGroup with DataFieldForAnnotation -->
<Annotation Term="UI.FieldGroup" Qualifier="GeneralInformation">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataFieldForAnnotation">
          <PropertyValue Property="Label" String="Communication Address" />
          <PropertyValue Property="Target" AnnotationPath="to_Address/@Communication.Address" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Label" String="Product Information" />
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [
  {
    label: 'Communication Address',
    value: '_ADDRESS',
    type: #AS_ADDRESS,
    qualifier: 'GeneralInformation',
    groupLabel: 'Product Information'
  }
]
/* Define _ADDRESS (or the referenced element) so that it points to the address annotation element */
_ADDRESS;
```

LANGUAGE: JSON
CODE:
```json
// CAP / JSON representation for UI.FieldGroup with DataFieldForAnnotation
UI.FieldGroup#GeneralInformation: {
  Data: [
    {
      "$Type": "UI.DataFieldForAnnotation",
      "Label": "Communication Address",
      "Target": "to_Address/@Communication.Address"
    }
  ],
  "Label": "Product Information"
}
```

STEP: 4 — Related reference
DESCRIPTION: Link to enabling quick views for link navigation when using smart links and quick view popovers (enrich popover content).
LANGUAGE: Text
CODE:
```text
See: Enabling Quick Views for Link Navigation
File: enabling-quick-views-for-link-navigation-307ced1.md
```
--------------------------------

**TITLE**: Address Facet in the Object Page Header (UI.ReferenceFacet → Address)

**INTRODUCTION**: Use a UI.ReferenceFacet that targets an address annotation to display a compact address facet in the object page header. The facet displays the ReferenceFacet label and the address annotation's label property only (the label must contain the full formatted address, using \n for line breaks). Other address annotation properties are ignored.

**TAGS**: fiori-elements-framework, UI.ReferenceFacet, address, object-page, annotations, CDS, CAP, XML

**STEP**: Behavior and requirements

**DESCRIPTION**: 
- Add a UI.ReferenceFacet that targets an address annotation (e.g., @Communication.Address).  
- The object page header renders: the ReferenceFacet Label (heading) and, below it, the address annotation's Label property only.  
- The address annotation's Label must contain the full formatted address with newline characters (\n) to produce line breaks.  
- Other address properties are not interpreted or rendered.  
- Example formatted label value: "Mail Drop: TNE QB\n123 Main Street\nAny Town, CA 91921-1234\nU.S.A."  
- Example image (reference): images/Address_Facet_8d92094.png

**LANGUAGE**: Plain

**CODE**:
```text
Notes:
- ReferenceFacet should point to the address annotation path: e.g., @Communication.Address
- The address annotation must provide its entire formatted address in its Label property using '\n' for new lines.
- Only the Label property of the address annotation is rendered in the header facet; other address properties are ignored.
```

**STEP**: XML annotation example (UI.ReferenceFacet)

**DESCRIPTION**: XML snippet to declare a ReferenceFacet that targets an address annotation at AnnotationPath="@Communication.Address". Place this XML in your annotation file where you define facets for the object page.

**LANGUAGE**: XML

**CODE**:
```xml
<Record Type="UI.ReferenceFacet">
    <PropertyValue Property="Label" String="Shipping Address"/>
    <PropertyValue AnnotationPath="@Communication.Address" Property="Target"/>
</Record>
```

**STEP**: ABAP CDS annotation example (UI.facet)

**DESCRIPTION**: ABAP CDS example that creates a UI facet of type address (#AS_ADDRESS) with a label. Use this on the relevant CDS entity or projection. Note: the address annotation itself must exist at @Communication.Address (or adjust Target accordingly).

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.facet: [
 {
  label: 'Shipping Address',
  type:         #AS_ADDRESS,
  purpose: #STANDARD
 }
]
product;
```

**STEP**: CAP CDS / JSON annotation example (UI.ReferenceFacet)

**DESCRIPTION**: CAP (or JSON) style annotation that defines a ReferenceFacet target and label. Use this in your service or annotation JSON file. Ensure the address annotation referenced exists (e.g., @Communication.Address).

**LANGUAGE**: JSON

**CODE**:
```json
{
    "$Type": "UI.ReferenceFacet",
    "Label": "Shipping Address",
    "Target": "@Communication.Address"
}
```

**STEP**: Example Label value for address annotation

**DESCRIPTION**: Provide the full formatted address as the Label property of the address annotation. Use '\n' to break lines. This value is what will be shown under the facet heading.

**LANGUAGE**: Plain

**CODE**:
```text
Example Label value:
"Mail Drop: TNE QB\n123 Main Street\nAny Town, CA 91921-1234\nU.S.A."
```
--------------------------------

**TITLE**: Analytical Cards — Chart Annotations and Manifest Configuration for SAP Fiori Elements / OVP

**INTRODUCTION**: Practical, code-focused guidance for configuring analytical (chart) cards in SAP Fiori Elements / Overview Page (OVP). Covers: limiting chart data, chart interactivity, axis scaling options, DataPoint min/max, and manifest.json card wiring. Includes XML, ABAP CDS, CAP CDS, and manifest JSON examples.

**TAGS**: fiori-elements-framework, sap.ovp, analytical-card, annotations, UI.Chart, UI.PresentationVariant, UI.DataPoint, manifest.json

STEP: 1 — Limit records fetched for chart responsiveness (UI.PresentationVariant.MaxItems)

DESCRIPTION: Use UI.PresentationVariant.MaxItems to limit records fetched/rendered by the chart. Apply via XML annotation, ABAP CDS, or CAP CDS.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.PresentationVariant" Qualifier="Column_Eval_by_Country_123">
  <Record>
    <PropertyValue Property="MaxItems" Int="5" />
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.PresentationVariant: [
  {
    maxItems: 5,
    qualifier: 'Column_Eval_by_Country_123'
  }
]
annotate view VIEWNAME with { }
```

LANGUAGE: CAP CDS

CODE:
```cds
UI.PresentationVariant #Column_Eval_by_Country_123 : {
  MaxItems : 5
}
```

STEP: 2 — Prefer top records using SortOrder (when many records exist)

DESCRIPTION: If many records are available and you only need top records, use UI.PresentationVariant.SortOrder to sort and then rely on MaxItems to fetch top N. See "Configuring Card Properties" for details.

LANGUAGE: (annotation concept)
CODE:
```text
Use UI.PresentationVariant.SortOrder together with MaxItems to sort by a field (e.g., revenue desc) and fetch/display the top N records.
```

STEP: 3 — Chart interactivity: selecting a data point passes technical ID

DESCRIPTION: Configure identification/navigation annotations so that when users select a chart data point the system passes the technical key (for example "RegionID"="001") as URL parameters to the target application. The target app reads those parameters to filter the target dataset.

LANGUAGE: (annotation behavior)
CODE:
```text
When configuring Identification/Navigation annotations (UI.Identification, NavigationPropertyPath, etc.), ensure the key property (technical ID) is part of the identification to be passed in the URL. The card sends keys (e.g., RegionID) rather than display labels.
```

STEP: 4 — Axis scaling: ZeroAlwaysVisible (XML + CAP CDS)

DESCRIPTION: ZeroAlwaysVisible forces zero to be visible on the axis. Set this in the UI.Chart annotation AxisScaling -> AutoScaleBehavior -> ZeroAlwaysVisible.

LANGUAGE: XML

CODE:
```xml
<PropertyValue Property="AxisScaling">
  <Record Type="UI.ChartAxisScalingType">
    <PropertyValue Property="AutoScaleBehavior">
      <Record Type="UI.ChartAxisAutoScaleBehaviorType">
        <PropertyValue Property="ZeroAlwaysVisible" Bool="true"/>
      </Record>
    </PropertyValue>
  </Record>
</PropertyValue>
```

LANGUAGE: CAP CDS

CODE:
```cds
AxisScaling : { 
  $Type : 'UI.ChartAxisScalingType',
  AutoScaleBehavior: { 
    $Type: 'UI.ChartAxisAutoScaleBehaviorType',
    ZeroAlwaysVisible: true
  }
}
```

STEP: 5 — Axis scaling: DataScope (XML + CAP CDS)

DESCRIPTION: DataScope uses the full dataset to determine axis min/max. Set AutoScaleBehavior.DataScope.

LANGUAGE: XML

CODE:
```xml
<PropertyValue Property="AxisScaling">
  <Record Type="UI.ChartAxisScalingType">
    <PropertyValue Property="AutoScaleBehavior">
      <Record Type="UI.ChartAxisAutoScaleBehaviorType">
        <PropertyValue Property="DataScope" EnumMember="DataSet"/>
      </Record>
    </PropertyValue>
  </Record>
</PropertyValue>
```

LANGUAGE: CAP CDS

CODE:
```cds
AxisScaling : { 
  $Type : 'UI.ChartAxisScalingType',
  AutoScaleBehavior: { 
    $Type: 'UI.ChartAxisAutoScaleBehaviorType',
    DataScope: 'DataSet'
  }
}
```

STEP: 6 — Axis scaling: FixedScale and DataPoint min/max (XML + CAP CDS + ABAP CDS)

DESCRIPTION: Use FixedScale to apply fixed axis min/max. Define those min/max values via UI.DataPoint annotations (MinimumValue, MaximumValue). FixedScale uses values from the measure's DataPoint by default.

LANGUAGE: XML (FixedScale)

CODE:
```xml
<PropertyValue Property="AxisScaling">
  <Record Type="UI.ChartAxisScalingType">
    <PropertyValue Property="ScaleBehavior" EnumMember="UI.ChartAxisScaleBehaviorType/FixedScale"/>
  </Record>
</PropertyValue>
```

LANGUAGE: XML (DataPoint min/max)

CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="DataPoint_Qualifier">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="MinimumValue" Decimal="1" />
    <PropertyValue Property="MaximumValue" Decimal="5" />
    <PropertyValue Property="ValueFormat">
      <Record>
        <!-- number formatting details -->
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS (DataPoint)

CODE:
```abap
@UI.dataPoint: { 
  minimumValue: 1,
  maximumValue: 5,
  valueFormat: { }
}
property_name;
```

LANGUAGE: CAP CDS (DataPoint)

CODE:
```cds
UI.DataPoint #DataPointQualifier : {
  $Type : 'UI.DataPointType',
  MinimumValue : 1,
  MaximumValue : 5,
  NumberFormat : { }
},
```

STEP: 7 — Manifest sample: register OData service, annotations file, and analytical cards

DESCRIPTION: Example manifest.json snippet wired for OVP analytical cards. For OData V4 use template "sap.ovp.cards.v4.charts.analytical" instead of "sap.ovp.cards.charts.analytical".

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "_version": "1.1.0",
    "id": "sap.ovp.demo",
    "type": "application",
    "i18n": "i18n/i18n.properties",
    "applicationVersion": {
      "version": "1.2.2"
    },
    "title": "{{app_title}}",
    "description": "{{app_description}}",
    "dataSources": {
      "salesShare": {
        "uri": "https://abc.com/SalesShare.xsodata",
        "type": "OData",
        "settings": {
          "odataVersion": "2.0",
          "annotations": [
            "salesShareAnno"
          ]
        }
      },
      "salesShareAnno": {
        "uri": "data/salesshare/annotations.xml",
        "type": "ODataAnnotation",
        "settings": {}
      }
    }
  },
  "sap.ovp": {
    "globalFilterModel": "salesShare",
    "globalFilterEntityType": "GlobalFilters",
    "cards": {
      "cardBubble": {
        "model": "salesShare",
        "template": "sap.ovp.cards.charts.analytical",
        "settings": {
          "entitySet": "SalesShare",
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Eval_by_CtryCurr",
          "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#Eval_by_CtryCurr",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#Eval_by_CtryCurr",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#Eval_by_CtryCurr",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#Eval_by_CtryCurr"
        }
      },
      "cardchartsline": {
        "model": "salesShare",
        "template": "sap.ovp.cards.charts.analytical",
        "settings": {
          "entitySet": "SalesShare",
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Eval_by_Country",
          "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#Eval_by_Country",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#Eval_by_Country",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#Eval_by_Country",
          "idenfiticationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#Eval_by_Country"
        }
      },
      "cardchartsdonut": {
        "model": "salesShare",
        "template": "sap.ovp.cards.charts.analytical",
        "settings": {
          "entitySet": "SalesShare",
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Eval_by_Currency",
          "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#Eval_by_Currency",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#Eval_by_Currency",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#Eval_by_Currency",
          "idenfiticationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#Eval_by_Currency"
        }
      }
    }
  }
}
```

STEP: 8 — UI behavior note: chart title hides axis descriptions

DESCRIPTION: If you configure a chart title, x/y axis descriptions are not shown in the card (except bubble charts). Use descriptive chart titles to convey measure/dimension meaning (e.g., "Net Sales by Days Payable").

LANGUAGE: (behavior)

CODE:
```text
Note: Setting chart Title will hide x/y axis descriptions on the card (bubble charts excepted).
```

STEP: 9 — Reference: further chart configuration

DESCRIPTION: For deeper chart configuration (chart types, measures/dimensions mapping, identification/navigation), see the related Configuring Charts documentation.

LANGUAGE: (link)

CODE:
```text
See: Configuring Charts (configuring-charts-c7c5a82.md) and Configuring Card Properties (configuring-card-properties-53b0791.md)
```
--------------------------------

**TITLE**: Analytical List Page (ALP) — Fiori Elements (OData V4) Implementation

**INTRODUCTION**: Practical, code-focused guide for implementing an Analytical List Page (ALP) with SAP Fiori elements. Includes manifest.json descriptor configuration, UI annotations (chart, table/line items, header/KPIs), visual filter placement, file paths, and OData V4 restriction note. Use these snippets as templates—replace placeholder entity and property names with your service model.

**TAGS**: fiori-elements, analytical-list-page, ALP, manifest.json, annotations, UI.Chart, UI.LineItem, visual-filters, OData V4, CDS, annotations.xml

**STEP**: 1 — Add ALP page to the application descriptor (manifest.json)

**DESCRIPTION**: Add a page entry for the Analytical List Page in webapp/manifest.json. Declare the target entitySet and the component name sap.suite.ui.generic.template.AnalyticalListPage. Provide a minimal sap.ui.generic.app structure and placeholders for settings (chart/table/visualFilter). File path: webapp/manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "com.example.alp",
    "title": "Analytical List Page Example"
  },
  "sap.ui": {
    "technology": "UI5"
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrders",                                 /* <-- replace with your entity set */
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "chart": { "chartType": "Donut" },                     /* placeholder setting */
            "table": { "multiSelect": false },
            "visualFilter": { "enabled": true }                   /* high-level switch; details go into annotations */
          }
        }
      }
    ]
  },
  "sap.ui5": { }
}
```

**STEP**: 2 — Provide UI annotations (chart and line-item) in an annotations file

**DESCRIPTION**: Define UI.Chart and UI.LineItem annotations for the ALP content area. Place annotation XML under webapp/annotations/annotations.xml or register it via the OData service metadata. The ALP uses these annotations to render the chart area (UI.Chart) and the table area (UI.LineItem). Replace Type/Target with your service namespace and entity type, and replace property names (Revenue, Category, SalesOrderID, etc.) with real model properties.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/annotations/annotations.xml -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:DataServices>
    <!-- Target should be your entity type (Namespace.EntityType) or entity set annotations -->
    <Annotations Target="MyService.SalesOrderType">
      <!-- Table columns for the list area -->
      <Annotation Term="UI.LineItem">
        <Collection>
          <Record Type="UI.DataField">
            <PropertyValue Property="Label" String="Sales Order ID"/>
            <PropertyValue Property="Value">
              <PropertyPath>SalesOrderID</PropertyPath>
            </PropertyValue>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Label" String="Customer"/>
            <PropertyValue Property="Value">
              <PropertyPath>CustomerName</PropertyPath>
            </PropertyValue>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Label" String="Revenue"/>
            <PropertyValue Property="Value">
              <PropertyPath>Revenue</PropertyPath>
            </PropertyValue>
          </Record>
        </Collection>
      </Annotation>

      <!-- Chart for the analytical area -->
      <Annotation Term="UI.Chart">
        <Record>
          <PropertyValue Property="Title" String="Revenue by Category"/>
          <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Donut"/>
          <PropertyValue Property="Measures">
            <Collection>
              <PropertyPath>Revenue</PropertyPath>
            </Collection>
          </PropertyValue>
          <PropertyValue Property="Dimensions">
            <Collection>
              <PropertyPath>Category</PropertyPath>
            </Collection>
          </PropertyValue>
        </Record>
      </Annotation>
    </Annotations>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 3 — Add header KPI tags / header info for KPI cards and progressive disclosure

**DESCRIPTION**: Configure header KPIs (tags/cards) via UI.HeaderInfo and related KPI annotations. Place this in the same annotations file (annotations.xml) and target the Collection or EntityType as required. These annotations enable KPI display and navigation from the header area.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Add to webapp/annotations/annotations.xml -->
<Annotations Target="MyService.SalesOrderType">
  <!-- HeaderInfo: label + KPI placeholders -->
  <Annotation Term="UI.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeName" String="Sales Orders"/>
      <PropertyValue Property="Title">
        <Record Type="UI.DataFieldForAnnotation">
          <PropertyValue Property="Target">
            <AnnotationPath>UI.KPI</AnnotationPath>   <!-- UI.KPI records defined below -->
          </PropertyValue>
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>

  <!-- Example KPI annotation block (replace with KPI vocabulary as per your backend) -->
  <Annotation Term="UI.KPI">
    <Record>
      <PropertyValue Property="Title" String="Total Revenue"/>
      <PropertyValue Property="ValuePath" PropertyPath="Revenue"/>
      <!-- Add navigation info, formatting, or additional properties supported by your backend -->
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 4 — Configure Visual Filter Bar (high-level) and where to place visual filter annotations

**DESCRIPTION**: Visual filters are configured by annotation records (visual-filter related vocabulary) placed alongside your UI annotations. The manifest.json should reference the annotation file or the OData service must expose these annotations. Exact visual filter annotation constructs depend on your metadata/annotation toolchain; below is a template that shows where to place visual filter definitions and a placeholder example. Put visual filter annotations into webapp/annotations/visualFilters.xml or into the same annotations.xml and ensure they are exposed to the Fiori elements runtime.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/annotations/visualFilters.xml -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:DataServices>
    <Annotations Target="MyService.SalesOrderType">
      <!-- Visual filter example: this is a placeholder template.
           Replace with your backend's supported visual filter vocabulary syntax. -->
      <Annotation Term="UI.VisualFilter">
        <Collection>
          <Record>
            <PropertyValue Property="Property" PropertyPath="Category"/>
            <PropertyValue Property="Measure" PropertyPath="Revenue"/>
            <PropertyValue Property="Label" String="Category by Revenue"/>
          </Record>
          <!-- Add additional visual filter items here -->
        </Collection>
      </Annotation>
    </Annotations>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 5 — Register annotations or forward annotation file in manifest (service configuration)

**DESCRIPTION**: Ensure webapp/manifest.json references the annotation files or that your OData service metadata exposes them. If your annotations are local (annotations.xml), add them under sap.ui5/dataSources -> annotations and point the model to that annotation file.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": { "id": "com.example.alp" },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      },
      "annotations": {
        "dataSource": "annotations"
      }
    },
    "resources": {}
  },
  "sap.service": {},
  "sap.app": {},
  "sap.ui5": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/MY_SERVICE_SRV/",
        "type": "OData",
        "settings": { "odataVersion": "4.0" }
      },
      "annotations": {
        "uri": "annotations/annotations.xml",
        "type": "ODataAnnotation",
        "settings": { "localUri": "webapp/annotations/annotations.xml" }
      }
    }
  }
}
```

**STEP**: 6 — File placement and typical project paths

**DESCRIPTION**: Use these conventional paths in a UI5/fiori-elements project. Keep annotations in webapp/annotations and manifest at webapp/manifest.json.

**LANGUAGE**: TEXT

**CODE**:
```
Project root/
├─ webapp/
│  ├─ manifest.json                  <-- application descriptor (ALP page config)
│  ├─ annotations/
│  │  ├─ annotations.xml             <-- UI.Chart, UI.LineItem, UI.HeaderInfo, visual filters
│  │  └─ visualFilters.xml           <-- optional separate visual filter definitions
│  └─ ... UI5 app files ...
├─ srv/ or db/                        <-- optional CDS model / OData service definitions
│  └─ annotations.cds                 <-- (if using CDS to generate annotations)
```

**STEP**: 7 — Restrictions and implementation notes for OData V4

**DESCRIPTION**: Visual filters are supported with restrictions in SAP Fiori Elements for OData V4. Test visual-filter behavior with your specific OData V4 service and annotation exposure. If you rely on backend-generated annotations (CDS or EDMX), ensure:
- Annotations are reachable by the Fiori runtime (exposed in $metadata or via local annotation files referenced in manifest.json).
- UI.Chart and UI.LineItem annotations target the correct EntityType/EntitySet.
- Aggregation and measure-based visual filters may require OData service support for aggregation or measures; verify service capabilities.
- For advanced ALP customizations (extensions, actions, navigation), see the related documentation pages (descriptor, title area, visual filter bar, content area, extensions).

**LANGUAGE**: TEXT

**CODE**:
```
Note: "Visual filters are supported with restrictions" for OData V4.
- Validate the OData service supports required aggregation and annotation terms.
- Prefer exposing annotations from the service metadata for simpler runtime behavior.
- If local annotation files are used, ensure manifest.json references them as ODataAnnotation dataSource entries.
```

**STEP**: 8 — References (quick links to related configs and deeper customization)

**DESCRIPTION**: Use these related documents when extending ALP features like descriptor options, title area config, visual filter details, content area configuration, and app extensions.

**LANGUAGE**: TEXT

**CODE**:
```
Related topics / further reading (use these to implement advanced features):
- Descriptor Configuration for the Analytical List Page: webapp/manifest.json descriptor options
- Configuring the Title Area: UI.HeaderInfo and header facets for dynamic title and KPI tags
- Configuring the Visual Filter Bar: Visual filter annotation vocabulary and examples
- Configuring the Content Area: UI.Chart and UI.LineItem for chart/table definitions
- Configuring Analytical List Page App Extensions: extension points, custom fragments, and controller hooks
```
--------------------------------

**TITLE**: Overview Page Annotations (SAP Fiori Elements) — Ready-to-use XML / ABAP CDS / CAP CDS Examples

**INTRODUCTION**: This reference lists the annotation terms used on Overview Pages (Fiori Elements). Each STEP contains a concise, action-oriented description and copy-pasteable code examples in XML, ABAP CDS, and CAP CDS where available. Use these examples to implement or generate annotations for HeaderInfo, DataFields, DataPoints, KPIs, Selection/Presentation variants, Charts, Facets, FieldGroups, Text Arrangement, and Personal Data marking. Note: dynamic subtitle path can be referenced from manifest.json (see Descriptor Configuration for the Overview Page).

**TAGS**: fiori-elements-framework, annotations, UI, HeaderInfo, DataPoint, LineItem, KPI, SelectionVariant, PresentationVariant, Chart, Facets, FieldGroup, TextArrangement, PersonalData, XML, ABAP, CAP, CDS

STEP: HeaderInfo (com.sap.vocabularies.UI.v1.HeaderInfo)

DESCRIPTION: Configure entity header meta (type names, title, description, image). dynamicSubtitleAnnotationPath can reference descriptor (manifest.json). Use HeaderInfo to set card header text and image.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo" Qualifier="dynamicSubtitle">
  <Record>
    <PropertyValue Property="TypeName" String="Product"/>
    <PropertyValue Property="TypeNamePlural" String="Products"/>
    <PropertyValue Property="Title">
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Value" Path="Name"/>
      </Record>
    </PropertyValue>
    <PropertyValue Property="Description">
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Value" Path="Description"/>
      </Record>
    </PropertyValue>
    <PropertyValue Property="ImageUrl" Path="ProductPicUrl"/>
  </Record>
</Annotation>
```

LANGUAGE: ABAP
CODE:
```abap
@UI.headerInfo: {
  typeName: 'Product',
  typeNamePlural: 'Products',
  title: { value: 'NAME', type: #STANDARD },
  description: { value: 'DESCRIPTION', type: #STANDARD },
  imageUrl: 'PRODUCTPICURL'
}
annotate view VIEWNAME with { }
```

LANGUAGE: CDS
CODE:
```cds
UI.HeaderInfo #dynamicSubtitle : {
    TypeName : 'Product',
    TypeNamePlural : 'Products',
    Title : {
        $Type : 'UI.DataField',
        Value : Name
    },
    Description : {
        $Type : 'UI.DataField',
        Value : Description
    },
    ImageUrl : ProductPicUrl
}
```

STEP: DataField (com.sap.vocabularies.UI.v1.DataField)

DESCRIPTION: Display a simple labeled text/value bound to a metadata path. Use in LineItem, FieldGroup, Identification.

LANGUAGE: XML
CODE:
```xml
<Record Type="com.sap.vocabularies.UI.v1.DataField">
  <PropertyValue Property="Label" String="Total Sum"/>
  <PropertyValue Property="Value" Path="TotalSum"/>
</Record>
```

LANGUAGE: ABAP
CODE:
```abap
{ label: 'Total Sum' }
  TOTALSUM;
```

LANGUAGE: CDS
CODE:
```cds
{
  $Type : 'UI.DataField',
  Label : 'Total Sum',
  Value : TotalSum
}
```

STEP: DataFieldForAnnotation (com.sap.vocabularies.UI.v1.DataFieldForAnnotation)

DESCRIPTION: Reference another annotation instance (Target) by annotation path/qualifier. Useful to reuse DataPoint or other composite annotations inside LineItem/Identification.

LANGUAGE: XML
CODE:
```xml
<Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation" Qualifier="WeightMeasure">
  <PropertyValue Property="Label" String="Weight Measure"/>
  <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.DataPoint#WeightMeasure"/>
</Record>
```

LANGUAGE: ABAP
CODE:
```abap
{
  label: 'Weight Measure',
  valueQualifier: 'WeightMeasure',
  type: #AS_DATAPOINT
}
Weight;
```

LANGUAGE: CDS
CODE:
```cds
{
  $Type : 'UI.DataFieldForAnnotation',
  Label : 'Weight Measure',
  Target : '@UI.DataPoint#WeightMeasure'
}
```

STEP: DataFieldForAction (com.sap.vocabularies.UI.v1.DataFieldForAction)

DESCRIPTION: Bind an OData FunctionImport action to card footer or quick view actions. Provide Label and Action (fully-qualified service path or function import name). Optionally add Importance.

LANGUAGE: XML
CODE:
```xml
<Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
  <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/Medium"/>
  <PropertyValue Property="Label" String="Confirm"/>
  <PropertyValue Property="Action" String="GWSAMPLE_BASIC.GWSAMPLE_BASIC_Entities/SalesOrder_Confirm"/>
</Record>
```

LANGUAGE: ABAP
CODE:
```abap
{
  importance: #MEDIUM,
  label: 'Confirm',
  dataAction: 'GWSAMPLE_BASIC.GWSAMPLE_BASIC_Entities/SalesOrder_Confirm',
  type: #FOR_ACTION
}
```

LANGUAGE: CDS
CODE:
```cds
{
  $Type : 'UI.DataFieldForAction',
  Label : 'Confirm',
  Action : 'GWSAMPLE_BASIC.GWSAMPLE_BASIC_Entities/SalesOrder_Confirm',
  ![@UI.Importance] : #Medium
}
```

STEP: DataFieldForIntentBasedNavigation (com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation)

DESCRIPTION: Configure intent-based navigation (SemanticObject + Action) on cards/footers. Add Label and optionally Importance. Can be used in Identification/LineItem.

LANGUAGE: XML
CODE:
```xml
<Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
  <PropertyValue Property="SemanticObject" String="SemanticObject1"/>
  <PropertyValue Property="Action" String="Action1"/>
  <PropertyValue Property="Label" String="App1"/>
  <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/Medium"/>
</Record>
```

LANGUAGE: ABAP
CODE:
```abap
@Consumption.semanticObject: 'SemanticObject1'
annotate view VIEWNAME with {
  @UI.lineItem: [
    {
      importance: #MEDIUM,
      semanticObjectAction: 'Action1',
      label: 'App1',
      type: #FOR_INTENT_BASED_NAVIGATION
    }
  ]
  property_name;
}
```

LANGUAGE: CDS
CODE:
```cds
{
  $Type : 'UI.DataFieldForIntentBasedNavigation',
  SemanticObject : 'SemanticObject1',
  Action : 'Action1',
  Label : 'App1',
  ![@UI.Importance] : #Medium
}
```

STEP: DataFieldWithUrl (com.sap.vocabularies.UI.v1.DataFieldWithUrl and com.sap.vocabularies.HTML5.v1.LinkTarget)

DESCRIPTION: Create clickable links. Configure Url (static URL or odata.fillUriTemplate for dynamic paths) and Label/Value. Optionally set HTML5 LinkTarget: _self, _blank, _parent, _top.

LANGUAGE: XML
CODE:
```xml
<Record Type="com.sap.vocabularies.UI.v1.DataFieldWithUrl">
  <PropertyValue Property="Label" String="Link to"/>
  <PropertyValue Property="Value" String="Google Maps"/>
  <PropertyValue Property="Url">
    <Apply Function="odata.fillUriTemplate">
      <String>https://www.google.de/maps/place/{street},{city}</String>
      <LabeledElement Name="street">
        <Apply Function="odata.uriEncode"><Path>Address/Street</Path></Apply>
      </LabeledElement>
      <LabeledElement Name="city">
        <Apply Function="odata.uriEncode"><Path>Address/City</Path></Apply>
      </LabeledElement>
    </Apply>
  </PropertyValue>
</Record>
```

LANGUAGE: ABAP
CODE:
```abap
{
  label: 'Link to',
  type: #WITH_URL
}
```

LANGUAGE: CDS
CODE:
```cds
{
  $Type : 'UI.DataFieldWithUrl',
  Value : 'Google Maps',
  Label : 'Link to',
  Url   : {
    $edmJson : {
      $Apply: [
        'https://www.google.de/maps/place/{street},{city}',
        {
          $LabeledElement : {
            $Apply    : [{$Path : 'Address/Street'}],
            $Function : 'odata.uriEncode'
          },
          $Name : 'street'
        },
        {
          $LabeledElement : {
            $Apply    : [{$Path : 'Address/City'}],
            $Function : 'odata.uriEncode'
          },
          $Name : 'city'
        }
      ],
      $Function : 'odata.fillUriTemplate'
    }
  }
}
```

STEP: DataPoint (com.sap.vocabularies.UI.v1.DataPoint)

DESCRIPTION: Display formatted numeric values, colors by criticality, trend and target calculation. Configure Title, Value, NumberFormat (ScaleFactor, NumberOfFractionalDigits), Criticality/Calculation (ImprovementDirection, ranges), TargetValue, TrendCalculation (ReferenceValue, DownDifference).

LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Country">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Sales India - Line Card"/>
    <PropertyValue Property="Value" Path="Sales"/>
    <PropertyValue Property="NumberValueFormat">
      <Record>
        <PropertyValue Property="ScaleFactor" IntDecimal="0"/>
        <PropertyValue Property="NumberOfFractionalDigits" Int="3"/>
      </Record>
    </PropertyValue>
    <PropertyValue Property="CriticalityCalculation">
      <Record>
        <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Minimizinge"/>
        <PropertyValue Property="DeviationRangeHighValue" String="7300"/>
        <PropertyValue Property="ToleranceRangeHighValue" String="7200"/>
      </Record>
    </PropertyValue>
    <PropertyValue Property="TargetValue" String="2.000"/>
    <PropertyValue Property="TrendCalculation">
      <Record>
        <PropertyValue Property="ReferenceValue" String="5201680"/>
        <PropertyValue Property="DownDifference" IntDecimal="10000000.0"/>
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP
CODE:
```abap
@UI.dataPoint: {
  title: 'Sales India - Line Card',
  valueFormat: { scaleFactor: 0, numberOfFractionalDigits: 3 },
  criticalityCalculation: {
    improvementDirection: #MINIMIZE,
    deviationRangeHighValue: 7300,
    toleranceRangeHighValue: 7200
  },
  targetValue: 2.000,
  trendCalculation: { referenceValue: 'refValElement', downDifference: 10000000.0 }
}
Sales;
```

LANGUAGE: CDS
CODE:
```cds
UI.DataPoint #Eval_by_Country : {
  $Type : 'UI.DataPointType',
  Title : 'Sales India - Line Card',
  Value : Sales,
  NumberFormat : { ScaleFactor : 0, NumberOfFractionalDigits : 3 },
  CriticalityCalculation : {
    ImprovementDirection : #Minimizing,
    DeviationRangeHighValue : '7300',
    ToleranceRangeHighValue : '7200'
  },
  TargetValue : '2.000',
  TrendCalculation : { ReferenceValue : '5201680', DownDifference : 10000000.0 }
}
```

STEP: Identification (com.sap.vocabularies.UI.v1.Identification)

DESCRIPTION: Container for primary card actions / identification fields. Use DataFieldForIntentBasedNavigation, DataFieldForAction, DataFieldWithUrl or DataField.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.Identification">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="SemanticObject" String="Action"/>
      <PropertyValue Property="Action" String="toappnavsample"/>
      <PropertyValue Property="Label" String="SO Navigation (M)"/>
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/Medium"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Sales Order ID"/>
      <PropertyValue Property="Value" Path="SalesOrderID"/>
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP
CODE:
```abap
@UI.identification: [
  { importance: #MEDIUM, semanticObjectAction: 'toappnavsample', label: 'SO Navigation (M)', type: #FOR_INTENT_BASED_NAVIGATION, position: 10 }
]
PROPERT_NAME;

@UI.identification: [
  { label: 'Sales Order ID', position: 20 }
]
SALESORDERID;

@Consumption.semanticObject: 'Action'
annotate view VIEWNAME with { }
```

LANGUAGE: CDS
CODE:
```cds
UI.Identification : [
  {
    $Type : 'UI.DataFieldForIntentBasedNavigation',
    SemanticObject : 'Action',
    Action : 'toappnavsample',
    Label : 'SO Navigation (M)',
    ![@UI.Importance] : #Medium
  },
  {
    $Type : 'UI.DataField',
    Label : 'Sales Order ID',
    Value : SalesOrderID
  }
]
```

STEP: LineItem (com.sap.vocabularies.UI.v1.LineItem)

DESCRIPTION: Define list/table columns. Supported record types: DataField, DataFieldForAnnotation, DataFieldForIntentBasedNavigation, DataFieldWithUrl.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Sales Order ID"/>
      <PropertyValue Property="Value" Path="SalesOrderID"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Customer Name"/>
      <PropertyValue Property="Value" Path="CustomerName"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Status"/>
      <PropertyValue Property="Value" Path="Status"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Note"/>
      <PropertyValue Property="Value" Path="Note"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation" Qualifier="TotalSum">
      <PropertyValue Property="Label" String="Total Sum"/>
      <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.DataPoint#TotalSum"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="SemanticObject" String="Action"/>
      <PropertyValue Property="Action" String="toappnavsample2"/>
      <PropertyValue Property="Label" String="SO Navigation (M)"/>
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/Medium"/>
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP
CODE:
```abap
@UI.lineItem: [
  { label: 'Sales Order ID', position: 10 }
]
SALESORDERID;

@UI.lineItem: [
  { label: 'Customer Name', position: 20 }
]
CUSTOMERNAME;

@UI.lineItem: [
  { label: 'Status', position: 30 }
]
STATUS;

@UI.lineItem: [
  { label: 'Note', position: 40 }
]
NOTE;

@UI.lineItem: [
  { label: 'Total Sum', valueQualifier: 'TotalSum', type: #AS_DATAPOINT, position: 50 },
  { importance: #MEDIUM, semanticObjectAction: 'toappnavsample2', label: 'SO Navigation (M)', type: #FOR_INTENT_BASED_NAVIGATION, position: 80 }
]
PROPERT_NAME;

@Consumption.semanticObject: 'Action'
annotate view VIEWNAME with { }
```

LANGUAGE: CDS
CODE:
```cds
UI.LineItem : [
  { $Type : 'UI.DataField', Label : 'Sales Order ID', Value : SalesOrderID },
  { $Type : 'UI.DataField', Label : 'Customer Name', Value : CustomerName },
  { $Type : 'UI.DataField', Label : 'Status', Value : Status },
  { $Type : 'UI.DataField', Label : 'Note', Value : Note },
  { $Type : 'UI.DataFieldForAnnotation', Label : 'Total Sum', Target : '@UI.DataPoint#TotalSum' },
  { $Type : 'UI.DataFieldForIntentBasedNavigation', SemanticObject : 'Action', Action : 'toappnavsample2', Label : 'SO Navigation (M)', ![@UI.Importance] : #Medium }
]
```

STEP: Facets (com.sap.vocabularies.UI.v1.Facets) / FieldGroup (com.sap.vocabularies.UI.v1.FieldGroup)

DESCRIPTION: Define Overview Page facets (only ReferenceFacet supported). ReferenceFacet.Target points to UI.FieldGroup#Qualifier. FieldGroup contains DataField entries.

LANGUAGE: XML
CODE:
```xml
<!-- Facets (ReferenceFacet pointing to FieldGroup) -->
<Annotation Term="com.sap.vocabularies.UI.v1.Facets">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.ReferenceFacet">
      <Annotation Term="com.sap.vocabularies.UI.v1.IsSummary"/>
      <PropertyValue Property="Label" String="Amounts"/>
      <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.FieldGroup#Amounts"/>
    </Record>
  </Collection>
</Annotation>

<!-- FieldGroup definition -->
<Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup" Qualifier="Amounts">
  <Record Type="com.sap.vocabularies.UI.v1.FieldGroupType">
    <PropertyValue Property="Label" String="Amounts"/>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.DataField">
          <PropertyValue Property="Label" String="Total Sum"/>
          <PropertyValue Property="Value" Path="TotalSum"/>
        </Record>
        <Record Type="com.sap.vocabularies.UI.v1.DataField">
          <PropertyValue Property="Label" String="Net Sum"/>
          <PropertyValue Property="Value" Path="NetSum"/>
        </Record>
        <Record Type="com.sap.vocabularies.UI.v1.DataField">
          <PropertyValue Property="Label" String="Tax"/>
          <PropertyValue Property="Value" Path="Tax"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP
CODE:
```abap
@UI.Facet: [
  { isSummary: true, label: 'Amounts', targetQualifier: 'Amounts', type: #FIELDGROUP_REFERENCE, purpose: #STANDARD }
]
PROPERT_NAME;

@UI.fieldGroup: [ { label: 'Total Sum', position: 10, qualifier: 'Amounts', groupLabel: 'Amounts' } ]
TOTALSUM;

@UI.fieldGroup: [ { label: 'Net Sum', position: 20, qualifier: 'Amounts' } ]
NETSUM;

@UI.fieldGroup: [ { label: 'Tax', position: 30, qualifier: 'Amounts' } ]
TAX;
```

LANGUAGE: CDS
CODE:
```cds
UI.Facets : [
  { $Type : 'UI.ReferenceFacet', Label : 'Amounts', Target : '@UI.FieldGroup#Amounts', ![@UI.IsSummary] }
];

UI.FieldGroup #Amounts : {
  $Type : 'UI.FieldGroupType',
  Label : 'Amounts',
  Data : [
    { $Type : 'UI.DataField', Label : 'Total Sum', Value : TotalSum },
    { $Type : 'UI.DataField', Label : 'Net Sum', Value : NetSum },
    { $Type : 'UI.DataField', Label : 'Tax', Value : Tax }
  ]
}
```

STEP: SelectionVariant (com.sap.vocabularies.UI.v1.SelectionVariant)

DESCRIPTION: Define SelectOptions (filters) and Parameters. Use qualifier to reference from SelectionPresentationVariant or KPI. Supports Sign/Option/Low/High ranges.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant" Qualifier="SP2">
  <Record>
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record>
          <PropertyValue Property="PropertyName" PropertyPath="CustomerName"/>
          <PropertyValue Property="Ranges">
            <Collection>
              <Record>
                <PropertyValue Property="Sign" EnumMember="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"/>
                <PropertyValue Property="Option" EnumMember="com.sap.vocabularies.UI.v1.SelectionRangeOptionType/EQ"/>
                <PropertyValue Property="Low" String="Asia High tech"/>
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: CDS
CODE:
```cds
UI.SelectionVariant #SP2 : {
  SelectOptions : [
    {
      PropertyName : CustomerName,
      Ranges : [ { Sign : #I, Option : #EQ, Low : 'Asia High tech' } ]
    }
  ]
}
```

LANGUAGE: XML
CODE:
```xml
<!-- Example with Parameters and SelectOptions -->
<Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant" Qualifier="Eval_by_Currency_1">
  <Record>
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record>
          <PropertyValue Property="PropertyName" PropertyPath="Country"/>
          <PropertyValue Property="Ranges">
            <Collection>
              <Record>
                <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I"/>
                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ"/>
                <PropertyValue Property="Low" String="IN"/>
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Parameters">
      <Collection>
        <Record Type="UI.Parameter">
          <PropertyValue Property="PropertyName" PropertyPath="Currency_Target"/>
          <PropertyValue Property="PropertyValue" String="EUR"/>
        </Record>
        <Record Type="UI.Parameter">
          <PropertyValue Property="PropertyName" PropertyPath="UoM_Target"/>
          <PropertyValue Property="PropertyValue" String="KGM"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: CDS
CODE:
```cds
UI.SelectionVariant #Eval_by_Currency_1 : {
  SelectOptions : [
    { PropertyName : Country, Ranges : [ { Sign : #I, Option : #EQ, Low : 'IN' } ] }
  ],
  Parameters : [
    { $Type : 'UI.Parameter', PropertyName : Currency_Target, PropertyValue : 'EUR' },
    { $Type : 'UI.Parameter', PropertyName : UoM_Target, PropertyValue : 'KGM' }
  ]
}
```

STEP: PresentationVariant (com.sap.vocabularies.UI.v1.PresentationVariant)

DESCRIPTION: Configure how query results are presented (grouping, sort order, requestAtLeast extra dimensions, visualizations). Use with SelectionPresentationVariant or KPI for card visual behavior.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant" Qualifier="customer">
  <Record>
    <PropertyValue Property="GroupBy">
      <Collection>
        <PropertyPath>BillingStatusDescription</PropertyPath>
        <PropertyPath>DeliveryStatusDescription</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
        <AnnotationPath>@UI.LineItem#View2</AnnotationPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record>
          <PropertyValue Property="Property" PropertyPath="CustomerName"/>
          <PropertyValue Property="Descending" Boolean="true"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP
CODE:
```abap
@UI.PresentationVariant: [
  {
    groupBy: [ 'BILLINGSTATUSDESCRIPTION', 'DELIVERYSTATUSDESCRIPTION' ],
    visualizations: [ { type: #AS_LINEITEM, qualifier: 'View2' } ],
    sortOrder: [ { by: 'CUSTOMERNAME' } ],
    qualifier: 'customer'
  }
]
annotate view VIEWNAME with { }
```

LANGUAGE: CDS
CODE:
```cds
UI.PresentationVariant #customer : {
  GroupBy : [ BillingStatusDescription, DeliveryStatusDescription ],
  Visualizations : [ '@UI.LineItem#View2' ],
  SortOrder : [ { Property : CustomerName, Descending : true } ]
}
```

STEP: SelectionPresentationVariant (com.sap.vocabularies.UI.v1.SelectionPresentationVariant)

DESCRIPTION: Combine SelectionVariant + PresentationVariant by reference. Use SelectionPresentationVariant to apply filters and presentation together in visualizations or KPIs.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.SelectionPresentationVariant" Qualifier="BothSelectionAndPresentation">
  <Record>
    <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#SP2"/>
    <PropertyValue Property="PresentationVariant" Path="@UI.PresentationVariant#customer"/>
  </Record>
</Annotation>
```

LANGUAGE: ABAP
CODE:
```abap
@UI.SelectionPresentationVariant: [
  {
    selectionvariantqualifier: 'SP2',
    presentationvariantqualifier: 'customer',
    qualifier: 'BothSelectionAndPresentation'
  }
]
annotate view VIEWNAME with { }
```

LANGUAGE: CDS
CODE:
```cds
UI.SelectionPresentationVariant #BothSelectionAndPresentation : {
  SelectionVariant : ![@UI.SelectionVariant#SP2],
  PresentationVariant : ![@UI.PresentationVariant#customer]
}
```

STEP: Chart (com.sap.vocabularies.UI.v1.Chart)

DESCRIPTION: Define chart dimensions/measures and their attributes (roles). Use MeasureAttributes and DimensionAttributes to set axis/series roles. Reference Chart via PresentationVariant.Visualizations.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.Chart">
  <Record Type="com.sap.vocabularies.UI.v1.ChartDefinitionType">
    <PropertyValue Property="Title" String="View1"/>
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="TotalSum"/>
          <PropertyValue Property="Role" EnumMember="com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis1"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="Status"/>
          <PropertyValue Property="Role" EnumMember="com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Series"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP
CODE:
```abap
@UI.Chart: [
  {
    title: 'View1',
    measureAttributes: [ { measure: 'TotalSum', role: #AXIS_1 } ],
    dimensionAttributes: [ { dimension: 'Status', role: #SERIES } ]
  }
]
annotate view VIEWNAME with { }
```

LANGUAGE: CDS
CODE:
```cds
UI.Chart : {
  $Type : 'UI.ChartDefinitionType',
  Title : 'View1',
  MeasureAttributes : [ { $Type : 'UI.ChartMeasureAttributeType', Measure : TotalSum, Role : #Axis1 } ],
  DimensionAttributes : [ { $Type : 'UI.ChartDimensionAttributeType', Dimension : Status, Role : #Series } ]
}
```

STEP: KPI (UI.KPI)

DESCRIPTION: Build KPI tile metadata for Overview page cards. Use DataPoint reference, Detail block to reference default/alternative PresentationVariants, set semantic object/action for navigation, and SelectionVariant qualifier.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.KPI" Qualifier="Eval_by_Country_-Generic">
  <Record>
    <PropertyValue Property="DataPoint" Path="@UI.DataPoint#Eval_by_Country_-Generic"/>
    <PropertyValue Property="Detail">
      <Record Type="UI.KPIDetailType">
        <PropertyValue Property="DefaultPresentationVariant" Path="@UI.PresentationVariant#Eval_by_Currency1"/>
        <PropertyValue Property="AlternativePresentationVariants">
          <Collection>
            <Path>@UI.PresentationVariant#Eval_by_Currency_Column</Path>
          </Collection>
        </PropertyValue>
        <PropertyValue Property="SemanticObject" String="Action"/>
        <PropertyValue Property="Action" String="toappnavsample"/>
      </Record>
    </PropertyValue>
    <PropertyValue Property="ID" String="String for KPI Annotation"/>
    <PropertyValue Property="SelectionVariantQualifier" Path="@UI.SelectionVariant#Eval_by_Currency_1"/>
  </Record>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Country_-Generic">
  <Record>
    <PropertyValue Property="Value" Path="Currency"/>
    <PropertyValue Property="Title" String="test"/>
  </Record>
</Annotation>
```

LANGUAGE: ABAP
CODE:
```abap
@UI.KPI: [
  {
    detail: {
      defaultPresentationVariantQualifier: 'Eval_by_Currency1',
      alternativePresentationVariantQualifiers: [ 'Eval_by_Currency_Column' ],
      semanticObject: 'Action',
      semanticObjectAction: 'toappnavsample'
    },
    selectionVariantQualifier: 'Eval_by_Currency_1',
    id: 'String for KPI Annotation',
    qualifier: 'Eval_by_Country-Generic',
    dataPoint.title: 'test'
  }
]
Eval_by_Country-Generic;
```

LANGUAGE: CDS
CODE:
```cds
UI.KPI #AllActualCosts : {
  $Type : 'UI.KPIType',
  Detail : {
    $Type : 'UI.KPIDetailType',
    DefaultPresentationVariant : ![@UI.PresentationVariant#Eval_by_Currency1],
    AlternativePresentationVariants : [ ![@UI.PresentationVariant#Eval_by_Currency_Column] ],
    SemanticObject : 'Action',
    Action : 'toappnavsample'
  },
  SelectionVariant : ![@UI.SelectionVariant#Eval_by_Currency_1],
  DataPoint : ![@UI.DataPoint#Eval_by_Country-Generic],
  ID : 'String for KPI Annotation'
}
```

STEP: TextArrangement (com.sap.vocabularies.Common.v1.Text and com.sap.vocabularies.UI.v1.TextArrangement)

DESCRIPTION: Control display order of text vs key (TextLast, TextFirst, TextOnly). Use @Common.Text to bind text property and @UI.TextArrangement to set arrangement.

LANGUAGE: XML
CODE:
```xml
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="GWSAMPLE_BASIC.SalesOrder/CustomerID">
  <Annotation Term="com.sap.vocabularies.Common.v1.Text" Path="Supplier_Name"/>
  <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"/>
</Annotations>
```

LANGUAGE: ABAP
CODE:
```abap
annotate view SALESORDER with {
  @UI.TextArrangement: #TEXT_LAST
  customerid;
}
```

LANGUAGE: CDS
CODE:
```cds
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.Text : Supplier_Name
  @UI.TextArrangement : #TextLast
  CustomerID
};
```

STEP: Potentially Sensitive Personal Data (com.sap.vocabularies.PersonalData.v1)

DESCRIPTION: Mark entity properties as potentially sensitive personal data. Use PersonalData.IsPotentiallySensitive / Semantics.personalData.isPotentiallySensitive.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="SEPMRA_OVW.SEPMRA_C_OVW_SalesOrderType/CompanyCode">
  <Annotation Term="com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"/>
</Annotations>
```

LANGUAGE: ABAP
CODE:
```abap
@Semantics.personalData.isPotentiallySensitive: true
CompanyCode;
```

LANGUAGE: CDS
CODE:
```cds
annotate SEPMRA_OVW.SEPMRA_C_OVW_SalesOrderType with {
  @PersonalData.IsPotentiallySensitive
  CompanyCode
};
```
--------------------------------

**TITLE**: Area Micro Chart — Required Annotations and Code Examples

**INTRODUCTION**: This document provides concise, action-oriented examples for implementing an Area Micro Chart in Fiori Elements using UI.Chart and UI.DataPoint annotations. It includes XML, ABAP CDS, and CAP CDS examples, highlights mandatory annotations, and calls out runtime label/semantic-color behavior required for correct rendering.

**TAGS**: fiori-elements-framework, area-micro-chart, UI.Chart, UI.DataPoint, annotations, CDS, XML, CAP, ABAP

**STEP**: 1 — Requirements and behavior (mandatory annotations & runtime labels)

**DESCRIPTION**: Summary of mandatory annotations, semantic-color requirement, label behavior, and unit consistency rules you must follow when implementing an Area Micro Chart.

**LANGUAGE**: Text

**CODE**:
```Text
Mandatory annotations:
- UI.Chart: ChartType must be "Area"
- UI.Chart: Dimensions
- UI.Chart: Measures
- UI.Chart: MeasureAttributes -> DataPoint (annotation reference/qualifier)
- UI.DataPoint: Value
- UI.DataPoint: CriticalityCalculation (and CriticalityCalculation/ImprovementDirection)

Runtime / UI behavior:
- The first and last measure values are displayed as top-left and top-right numeric labels.
- The first and last dimension values (dimension IDs) are displayed as bottom-left and bottom-right labels.
- Semantic coloring using CriticalityCalculation is mandatory for area micro charts (ensures error/warning/acceptance/good ranges).
- Ensure units of measure are consistent across all data points.
- Use the DataPoint qualifier referenced from UI.Chart MeasureAttributes (e.g. @UI.DataPoint#AreaChartPrice).
```

**STEP**: 2 — UI.Chart XML annotation (Area micro chart)

**DESCRIPTION**: Define a UI.Chart annotation for an Area chart: title, description, chart type, one dimension and one measure, and MeasureAttributes referencing the DataPoint qualifier.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.Chart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Sales Price" />
        <PropertyValue Property="Description" String="Area Micro Chart" />
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Area" />
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>PriceDay</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>AreaChartPrice</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="AreaChartPrice" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#AreaChartPrice" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 3 — UI.Chart ABAP CDS example

**DESCRIPTION**: ABAP CDS syntax for adding an area chart definition. Use the measure name and set measureAttributes.asDataPoint true to link to a UI.DataPoint.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Chart: [
  {
    title: 'Sales Price',
    description: 'Area Micro Chart',
    chartType: #AREA,
    dimensions: [
      'PRICEDAY'
    ],
    measures: [
      'AREACHARTPRICE'
    ],
    measureAttributes: [
      {
        measure: 'AreaChartPrice',
        role: #AXIS_1,
        asDataPoint: true
      }
    ]
  }
]
annotate view STTA_C_MP_PRODUCT with {
}
```

**STEP**: 4 — UI.Chart CAP CDS example

**DESCRIPTION**: CAP (CDS for Node.js) syntax for the same chart definition. Use DataPoint reference in MeasureAttributes using DataPoint annotation path.

**LANGUAGE**: CDS

**CODE**:
```cds
UI.Chart : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Sales Price',
    Description : 'Area Micro Chart',
    ChartType : #Area,
    Dimensions : [
        PriceDay
    ],
    Measures : [
        AreaChartPrice
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : AreaChartPrice,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#AreaChartPrice'
        }
    ]
}
```

**STEP**: 5 — UI.DataPoint XML annotation (with CriticalityCalculation)

**DESCRIPTION**: Provide a DataPoint annotation qualifier that supplies Value, TargetValue, and a CriticalityCalculation. The qualifier name must match the MeasureAttributes DataPoint reference (e.g. AreaChartPrice).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.DataPoint" Qualifier="AreaChartPrice">
    <Record>
        <PropertyValue Property="Value" Path="AreaChartPrice" />
        <PropertyValue Property="TargetValue" Path="TargetPrice" />
        <PropertyValue Property="CriticalityCalculation">
            <Record>
                <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Target" />
                <PropertyValue Property="DeviationRangeHighValue" Path="DeviationUpperBoundPrice" />
                <PropertyValue Property="DeviationRangeLowValue" Path="DeviationLowerBoundPrice" />
                <PropertyValue Property="ToleranceRangeHighValue" Path="ToleranceUpperBoundPrice" />
                <PropertyValue Property="ToleranceRangeLowValue" Path="ToleranceLowerBoundPrice" />
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 6 — UI.DataPoint ABAP CDS example

**DESCRIPTION**: ABAP CDS shorthand to annotate the measure element with dataPoint settings, targeting the elements that provide target and range boundaries used for criticality calculation.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.dataPoint: {
  targetValueElement: 'TargetPrice',
  criticalityCalculation: {
    improvementDirection: #TARGET,
    deviationRangeHighValueElement: 'DeviationUpperBoundPrice',
    deviationRangeLowValueElement: 'DeviationLowerBoundPrice',
    toleranceRangeHighValueElement: 'ToleranceUpperBoundPrice',
    toleranceRangeLowValueElement: 'ToleranceLowerBoundPrice'
  }
}
AreaChartPrice;
```

**STEP**: 7 — UI.DataPoint CAP CDS example

**DESCRIPTION**: CAP CDS DataPoint annotation using a qualifier name (AreaChartPrice). Map Value, TargetValue, and CriticalityCalculation fields to corresponding entity properties.

**LANGUAGE**: CDS

**CODE**:
```cds
UI.DataPoint #AreaChartPrice : {
    Value : AreaChartPrice,
    TargetValue : TargetPrice,
    CriticalityCalculation : {
        ImprovementDirection : #Target,
        DeviationRangeHighValue : DeviationUpperBoundPrice,
        DeviationRangeLowValue : DeviationLowerBoundPrice,
        ToleranceRangeHighValue : ToleranceUpperBoundPrice,
        ToleranceRangeLowValue : ToleranceLowerBoundPrice
    }
}
```

**STEP**: 8 — Quick checklist before deploy

**DESCRIPTION**: Final verification steps to ensure the area micro chart renders correctly.

**LANGUAGE**: Text

**CODE**:
```Text
- Confirm UI.Chart.ChartType == Area.
- Confirm Dimensions and Measures reference actual entity fields.
- Confirm MeasureAttributes.DataPoint references the UI.DataPoint qualifier (e.g. @UI.DataPoint#AreaChartPrice).
- Confirm UI.DataPoint contains Value and CriticalityCalculation with ImprovementDirection.
- Confirm units are consistent across Value, TargetValue, and all range elements.
- Confirm first/last measure and dimension values appear as expected in the micro chart UI.
```
--------------------------------

**TITLE**: Bar Chart Card — UI.Annotation + Semantic Coloring Implementation

**INTRODUCTION**: How to define a Bar Chart card using UI.Chart annotations and enable semantic coloring using DataPoint threshold values (ToleranceRangeLow/High, DeviationRangeLow/High and ImprovementDirection). Includes a full chart annotation example and a TypeScript helper to compute semantic state (Negative/Critical/Positive) for rendering or tests.

**TAGS**: fiori-elements-framework, annotations, UI.Chart, UI.DataPoint, semantic-coloring, bar-chart, OData, TypeScript

**STEP**: 1 — Create the Bar Chart UI.Chart annotation

**DESCRIPTION**: Add a UI.Chart annotation of type Bar. Define Title, ChartType, Measures, Dimensions, MeasureAttributes (each measure references a UI.DataPoint by AnnotationPath), and DimensionAttributes. Use one measure if you want per-measure threshold legend values to appear in the card.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: annotations.xml (or include in your .annot.xml) -->
<Annotation Term="UI.Chart" Qualifier="Eval_by_Currency_Bar">
  <Record Type="UI.ChartDefinitionType">
    <!-- Title and Chart type -->
    <PropertyValue Property="Title" String="Sales by Product" />
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bar" />

    <!-- Measures: number of columns equals number of measures -->
    <PropertyValue Property="Measures">
      <Collection>
        <PropertyPath>Sales</PropertyPath>
        <!-- Add more PropertyPath entries for additional measures -->
      </Collection>
    </PropertyValue>

    <!-- Dimensions (categories) -->
    <PropertyValue Property="Dimensions">
      <Collection>
        <PropertyPath>Product</PropertyPath>
      </Collection>
    </PropertyValue>

    <!-- Measure attributes: Reference a UI.DataPoint annotation for semantic coloring -->
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="Sales" />
          <!-- Reference a DataPoint annotation by qualifier -->
          <PropertyValue Property="DataPoint">
            <AnnotationPath>@UI.DataPoint#Column_Eval_by_Country_123</AnnotationPath>
          </PropertyValue>
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
        </Record>
      </Collection>
    </PropertyValue>

    <!-- Dimension attributes -->
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="Product" />
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 2 — Define the UI.DataPoint annotation with thresholds and improvement direction

**DESCRIPTION**: Create a UI.DataPoint annotation (qualifier referenced above). It must include the value binding and a criticality/threshold configuration with the four threshold properties and ImprovementDirection (Maximize, Minimize, Target). The chart uses these values for semantic coloring and for showing threshold legend entries when only one measure is present.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: annotations.xml (same file or separate) -->
<Annotation Term="UI.DataPoint" Qualifier="Column_Eval_by_Country_123">
  <Record Type="UI.DataPointType">
    <!-- Value: the measure used for color/criticality -->
    <PropertyValue Property="Value" Path="Sales" />

    <!-- Criticality calculation using thresholds and improvement direction -->
    <PropertyValue Property="CriticalityCalculation">
      <Record Type="UI.CriticalityCalculationType">
        <!-- ImprovementDirection: UI.ImprovementDirection/Maximize | Minimize | Target -->
        <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirection/Maximize" />

        <!-- Threshold values used for semantic coloring -->
        <PropertyValue Property="ToleranceRangeLowValue" Path="ToleranceRangeLowValue" />
        <PropertyValue Property="ToleranceRangeHighValue" Path="ToleranceRangeHighValue" />
        <PropertyValue Property="DeviationRangeLowValue" Path="DeviationRangeLowValue" />
        <PropertyValue Property="DeviationRangeHighValue" Path="DeviationRangeHighValue" />
      </Record>
    </PropertyValue>

    <!-- Optional: label, unit, target value, etc. -->
    <PropertyValue Property="Label" String="Sales Value" />
  </Record>
</Annotation>
```

**STEP**: 3 — Semantic-coloring rules and recommendation

**DESCRIPTION**: Use these rules to determine semantic state (Negative / Critical / Positive) from a numeric measure value and threshold properties depending on ImprovementDirection. Recommendation: use only one measure in the chart when you require per-measure threshold legend entries. When more than one measure is used, the legend will only show Good/Bad/Neutral and not individual threshold values.

**LANGUAGE**: TypeScript

**CODE**:
```typescript
// Helper: compute semantic state from value and thresholds.
// ImprovementDirection: "Maximize" | "Minimize" | "Target"
type ImprovementDirection = "Maximize" | "Minimize" | "Target";

interface Thresholds {
  deviationLow?: number;
  toleranceLow?: number;
  toleranceHigh?: number;
  deviationHigh?: number;
}

/**
 * Returns "Negative" | "Critical" | "Positive" based on rules from the doc.
 */
function computeSemanticState(
  value: number,
  thresholds: Thresholds,
  improvementDirection: ImprovementDirection
): "Negative" | "Critical" | "Positive" {
  const dLow = thresholds.deviationLow ?? Number.NEGATIVE_INFINITY;
  const tLow = thresholds.toleranceLow ?? Number.NEGATIVE_INFINITY;
  const tHigh = thresholds.toleranceHigh ?? Number.POSITIVE_INFINITY;
  const dHigh = thresholds.deviationHigh ?? Number.POSITIVE_INFINITY;

  if (improvementDirection === "Maximize") {
    // Lower is worse. Boundaries: [deviationLow, toleranceLow)
    if (value < dLow) return "Negative";
    if (value < tLow) return "Critical";
    return "Positive";
  }

  if (improvementDirection === "Minimize") {
    // Higher is worse. Boundaries: (toleranceHigh, deviationHigh]
    if (value <= tHigh) return "Positive";
    if (value <= dHigh) return "Critical";
    return "Negative";
  }

  // Target: best inside [toleranceLow, toleranceHigh], worse outside.
  if (value < dLow) return "Negative";
  if (value < tLow) return "Critical";
  if (value <= tHigh) return "Positive";
  if (value <= dHigh) return "Critical";
  return "Negative";
}
```

**STEP**: 4 — Legend and multi-measure behavior

**DESCRIPTION**: Notes for implementation and testing:
- If semantic coloring is enabled and you use a single measure: the legend will include threshold values (for example Good/Neutral/Bad with threshold numbers).
- If multiple measures are used in the chart: the legend shows only labels Good/Bad/Neutral without per-measure threshold numeric values.
- Ensure the DataPoint referenced in MeasureAttributes above contains the threshold values and ImprovementDirection; otherwise semantic coloring will not be applied.

**LANGUAGE**: JSON (configuration example)

**CODE**:
```json
{
  "chart": {
    "qualifier": "Eval_by_Currency_Bar",
    "type": "Bar",
    "measures": ["Sales"],
    "dimensions": ["Product"]
  },
  "dataPoint": {
    "qualifier": "Column_Eval_by_Country_123",
    "valuePath": "Sales",
    "criticalityCalculation": {
      "improvementDirection": "Maximize",
      "toleranceRangeLowValue": 80,
      "toleranceRangeHighValue": 120,
      "deviationRangeLowValue": 50,
      "deviationRangeHighValue": 150
    }
  }
}
```
--------------------------------

**TITLE**: Bubble Chart Card (Fiori Elements annotations)

**INTRODUCTION**: Defines how to create a Bubble Chart card in Fiori Elements using UI.Chart annotations (XML, ABAP CDS, CAP CDS). Bubble charts require three measures and one or two dimensions. This doc gives the measure/dimension-to-feed mapping rules, fallback behavior, and runnable annotation examples.

**TAGS**: fiori-elements-framework, ui.chart, bubble, annotation, xml, cds, abap, cap

**STEP**: 1 — Measure & dimension mapping rules (practical summary)

**DESCRIPTION**: Map measures and dimensions to chart feeds when authoring Bubble Chart annotations. Use these rules when assigning ChartMeasureRoleType and ChartDimensionRoleType.

**LANGUAGE**: Text

**CODE**:
```Text
Rules summary (action-oriented):

- Required:
  - Exactly 3 measures (used for x-axis, y-axis, bubble size).
  - 1 or 2 dimensions (used for color (series) and/or shape (category)).

- Primary feed mappings:
  - valueAxis (x-axis): mapped from the measure chosen for the x-axis.
    Priority for selection: Axis1 -> Axis2 (if no Axis1) -> Axis3 (if no Axis2).
  - valueAxis2 (y-axis): mapped from the measure chosen for the y-axis.
    Selection fallback sequence (use these checks in order):
      1) A measure whose Role is Axis2
      2) If no Axis2 available, Axis1 of the second measure
      3) If still not found, Axis3 of the first measure
  - bubbleWidth (bubble size): assigned to the remaining measure that is not used for x/y.

- Dimensions:
  - Role = Series -> mapped to color feed (UID color). If multiple dimensions are flagged as Series,
    each unique combination of dimension members receives its own color.
  - Role = Category -> mapped to shape feed (UID shape). If multiple Category dimensions are set,
    only the first is considered.
  - If no Role assigned to a dimension, that dimension does NOT affect color (all members share same color).

- Practical recommendations:
  - Prefer assigning Axis1 to the intended x-axis measure and Axis2 to the intended y-axis measure.
  - Do NOT rely on shape (Category) for bubble charts – not recommended.
  - Always verify annotation ordering and roles to ensure feeds map as expected.
```

**STEP**: 2 — XML Annotation example

**DESCRIPTION**: Use this XML annotation snippet in your annotation file to define a Bubble Chart. It demonstrates three measures (roles Axis1/Axis2/Axis3) and one dimension (Role = Series). Use the Qualifier to reference the chart definition as needed.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.Chart" Qualifier="Qualifier_ID_1">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="View1" />
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bubble"/>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="SalesShare" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                </Record>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="TotalSales" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2" />
                </Record>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="Sales" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis3" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="DimensionAttributes">
            <Collection>
                <Record Type="UI.ChartDimensionAttributeType">
                    <PropertyValue Property="Dimension" PropertyPath="Product" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Series" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 3 — ABAP CDS Annotation example

**DESCRIPTION**: Use this ABAP CDS annotation inside your CDS view to define a Bubble Chart. The qualifier is set to 'Qualifier_ID_1'. Keep the measure names matching the exposed view fields.

**LANGUAGE**: ABAP

**CODE**:
```abap
@UI.Chart: [
  {
    title: 'View1',
    chartType: #BUBBLE,
    measureAttributes: [
      {
        measure: 'SalesShare',
        role: #AXIS_1
      },
      {
        measure: 'TotalSales',
        role: #AXIS_2
      },
      {
        measure: 'Sales',
        role: #AXIS_3
      }
    ],
    dimensionAttributes: [
      {
        dimension: 'Product',
        role: #SERIES
      }
    ],
    qualifier: 'Qualifier_ID_1'
  }
]
annotate view VIEWNAME with { }
```

**STEP**: 4 — CAP CDS Annotation example

**DESCRIPTION**: Use this CAP CDS annotation snippet in a .cds file (service or domain model) to define the Bubble Chart. Replace Measure/Dimension names to match your model.

**LANGUAGE**: CDS

**CODE**:
```cds
UI.Chart #Qualifier_ID_1 : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'View1',
    ChartType : #Bubble,
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : SalesShare,
            Role : #Axis1
        },
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : TotalSales,
            Role : #Axis2
        },
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Sales,
            Role : #Axis3
        }
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : Product,
            Role : #Series
        }
    ]
}
```

**STEP**: 5 — Semantic coloring, shape behavior, and artifact reference

**DESCRIPTION**: Notes on color palette support, shape usage, and where to find a sample image.

**LANGUAGE**: Text

**CODE**:
```Text
- The bubble chart supports semantic coloring (use the color/series dimension to drive palette).
- If you assign Role = Series to two dimensions, the chart colors each combination of members uniquely
  (e.g., Country/Year combinations each get a distinct color).
- Role = Category maps to shape; multiple Category dimensions -> only first considered. Shape is not
  recommended for bubble charts due to limited readability.
- Example image (reference): images/Bubble_Chart_e131bed.png
```
--------------------------------

**TITLE**: Build and Run a SAP Fiori elements App using SAP Fiori tools (VS Code / Business Application Studio)

**INTRODUCTION**: Step-by-step, code-focused guidance to create, run, and build a SAP Fiori elements application using SAP Fiori tools (Visual Studio Code or SAP Business Application Studio). Includes required extensions, commands, minimal project structure, and key files (manifest.json, ui5.yaml, package.json) so an AI agent can generate or scaffold a working sample app and start a local development server.

**TAGS**: sap-fiori, fiori-elements, sap-fiori-tools, ui5, ui5-tooling, visual-studio-code, business-application-studio, odata

STEP: 1 — Install prerequisites

DESCRIPTION: Install Node.js and the UI5 tooling locally. Install VS Code (or use BAS) and the SAP Fiori tools extension pack. These are required to scaffold and run Fiori elements apps.

LANGUAGE: Shell

CODE:
```bash
# Install Node.js (LTS recommended) first via https://nodejs.org/
# Install UI5 CLI as a dev dependency for the project or globally:
npm install --save-dev @ui5/cli

# Optional global install (useful for local machine development):
npm install --global @ui5/cli

# VS Code: Install the following extensions (or use SAP Business Application Studio)
# - "SAP Fiori tools - Extension Pack" (includes the Application Generator)
# Install from VS Code marketplace or BAS extension manager.
```

STEP: 2 — Create a new Fiori elements project using SAP Fiori tools (VS Code or BAS)

DESCRIPTION: Use the Application Generator from SAP Fiori tools (command palette in VS Code: "Fiori: Open Application Generator") or the Yeoman generator. Choose Fiori elements -> OData v4 -> List Report/Object Page (example) and provide required metadata (OData service URL or local metadata file). The generator will scaffold project files under a chosen folder.

LANGUAGE: Instructions (UI)

CODE:
```text
VS Code:
1. Open command palette (Ctrl+Shift+P).
2. Choose "Fiori: Open Application Generator".
3. Select:
   - Project Template: SAP Fiori elements
   - OData Version: OData V4
   - Floorplan: List Report Object Page
4. Provide:
   - App namespace/id (e.g., com.example.fiori)
   - Title
   - OData service URL (or point to local metadata.xml)
5. Generator scaffolds the project (webapp/, manifest.json, annotations/, etc.)

Alternative (Yeoman):
# If using generator-fiori (optional)
npm install -g yo generator-fiori
yo fiori
# Follow prompts similar to the Application Generator
```

STEP: 3 — Key project structure and required files

DESCRIPTION: After scaffolding, the minimal files to run the app are shown. Place UI source under webapp/. The manifest.json declares the Fiori elements app; ui5.yaml configures UI5 tooling; package.json defines scripts to start and build.

LANGUAGE: JSON, YAML

CODE:
```json
// package.json (place at project root)
{
  "name": "fiori-elements-sample",
  "version": "0.0.1",
  "private": true,
  "devDependencies": {
    "@ui5/cli": "^3"
  },
  "scripts": {
    "start": "npx ui5 serve --config=ui5.yaml",
    "build": "npx ui5 build --config=ui5.yaml --include-dependencies --dest=dist"
  }
}
```

```yaml
# ui5.yaml (place at project root)
specVersion: '2.2'
metadata:
  name: fiori-elements-sample
type: application
server:
  customMiddleware:
    - name: ui5-middleware-simpleproxy
      mountPath: /sap/opu
      afterMiddleware: compression
```

```json
// webapp/manifest.json (minimal example for List Report/Object Page, OData v4)
{
  "sap.app": {
    "id": "com.example.fiori",
    "type": "application",
    "i18n": "i18n/i18n.properties",
    "applicationVersion": {
      "version": "1.0.0"
    }
  },
  "sap.ui": {
    "technology": "UI5"
  },
  "sap.ui5": {
    "rootView": {
      "viewName": "sap.fe.templates.ListReport.view.ListReport",
      "type": "JS"
    },
    "dependencies": {
      "minUI5Version": "1.84.0",
      "libs": {
        "sap.fe.templates": {},
        "sap.fe.core": {},
        "sap.m": {},
        "sap.ui.core": {}
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Products", 
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport"
        }
      }
    ]
  },
  "sap.cloud": {
    "public": true
  }
}
```

STEP: 4 — Provide or reference OData metadata and annotation files

DESCRIPTION: Fiori elements apps require OData metadata and optional CDS/annotation files. For local development, place metadata.xml and annotations.xml under webapp/localService or point the manifest to a remote OData service. If running behind a backend, use the ui5 proxy middleware configured in ui5.yaml.

LANGUAGE: XML, JSON

CODE:
```xml
<!-- webapp/localService/metadata.xml (truncated example, must match real service) -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:DataServices>
    <Schema Namespace="MyService" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <EntityType Name="Products">
        <Key><PropertyRef Name="ID"/></Key>
        <Property Name="ID" Type="Edm.String"/>
        <Property Name="Name" Type="Edm.String"/>
      </EntityType>
      <EntityContainer Name="Container">
        <EntitySet Name="Products" EntityType="MyService.Products"/>
      </EntityContainer>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

```json
// Example manifest snippet referencing local metadata (webapp/manifest.json)
{
  "sap.app": { /* ... */ },
  "sap.ui5": { /* ... */ },
  "sap.ui.generic.app": { /* ... */ },
  "sap.cloud": { /* ... */ },
  "sap.app": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/MY_SERVICE_SRV/",
        "type": "OData",
        "settings": {
          "odataVersion": "4.0",
          "localUri": "localService/metadata.xml" 
        }
      }
    }
  }
}
```

STEP: 5 — Run the app locally (UI5 tooling)

DESCRIPTION: Start the UI5 development server. If using a local metadata file or backend, ensure ui5 proxy middleware is configured for OData paths. Open the provided index.html or the root URL printed by ui5 serve.

LANGUAGE: Shell

CODE:
```bash
# Install dependencies and start
npm install
npm run start

# Default: open http://localhost:8080/index.html or the URL printed by ui5 serve
# If you used proxy middleware, the server will forward /sap/opu requests to the backend.
```

STEP: 6 — Build for deployment

DESCRIPTION: Use UI5 build to produce a distribution bundle (dist/) that can be deployed to an ABAP repository or other hosting (SAP Cloud Platform, etc.). The build command bundles and optimizes resources.

LANGUAGE: Shell

CODE:
```bash
# Build optimized app into ./dist
npm run build

# Resulting files in ./dist (upload these to target platform)
# Typical deployment targets: SAP ABAP repo, SAP BTP, or static web host
```

STEP: 7 — Add annotations or customizations (optional)

DESCRIPTION: Add local annotation files (XML) to guide Fiori elements behavior (field groups, protected fields, UI presentation). Reference annotation files from manifest.json under "sap.app" -> "dataSources" -> "annotations" or "sap.ui5" -> "models".

LANGUAGE: XML, JSON

CODE:
```xml
<!-- webapp/annotations/annotations.xml (example snippet) -->
<Annotations Target="MyService.Products">
  <Annotation Term="UI.HeaderInfo">
    <Record>
      <PropertyValue Property="Type" String="Object"/>
      <PropertyValue Property="Title" Path="Name"/>
    </Record>
  </Annotation>
</Annotations>
```

```json
// manifest.json: reference annotation file
{
  "sap.app": {
    "dataSources": {
      "mainService": { "uri": "/sap/opu/odata/sap/MY_SERVICE_SRV/", "type": "OData", "settings": { "odataVersion": "4.0", "localUri": "localService/metadata.xml" } },
      "annotations": {
        "uri": "annotations/annotations.xml",
        "type": "ODataAnnotation",
        "settings": { "localUri": "annotations/annotations.xml" }
      }
    }
  }
}
```

STEP: 8 — Useful tips and next steps

DESCRIPTION: After scaffolding & running:
- Use the SAP Fiori tools Application Generator for scaffolding templates and data binding automatically.
- For backend integration, configure destination/proxy in ui5.yaml or use BAS dev spaces.
- Use SAP Fiori tools "Preview" or "App Diagnostics" extensions to inspect routing and annotations in VS Code.
- When deploying to ABAP, generate BSP or use the SAP Cloud Platform deployment pipeline.

LANGUAGE: Text

CODE:
```text
- To debug or modify the UI, edit files under webapp/ (views, controllers, manifest.json).
- Use the "Fiori: Start App" command in VS Code if the Fiori tooling extension is installed.
- For CI/CD, include npm run build in your pipeline and push the dist/ output to the target repository.
```
--------------------------------

**TITLE**: Building Blocks (SAP Fiori elements — OData V4)

**INTRODUCTION**: This document explains the SAP Fiori elements "building blocks" concept (OData V4 only), shows how to use the Field building block in XML fragments, demonstrates the control tree that the building block produces, and shows how to load fragments dynamically using sap.fe.core.ExtensionAPI.loadFragment.

**TAGS**: fiori-elements, OData V4, building-blocks, sap.fe.macros, sap.fe.core, ExtensionAPI, loadFragment, sap.m

**STEP**: 1 — Overview and key constraints

**DESCRIPTION**: Brief, actionable summary of building blocks behavior and constraints for code generation:
- Building blocks are templating instructions (not runtime SAPUI5 controls). They are used by Fiori elements templates to create a control tree depending on bound metadata and attributes.
- Building blocks do not exist at runtime; the result is actual SAPUI5 controls (e.g., sap.m.Text, sap.m.DatePicker).
- A dedicated API object exists for limited manipulation of controls created from building blocks — use only the supported API surface.
- This topic and examples are applicable only to SAP Fiori elements for OData V4.
- When loading fragments dynamically that contain building blocks, load the fragment via sap.fe.core.ExtensionAPI.loadFragment to ensure correct processing.

**LANGUAGE**: Text

**CODE**:
```Text
- Building blocks -> templating instructions producing control trees at runtime.
- Use sap.fe.core.ExtensionAPI.loadFragment(...) for dynamically loaded fragments that contain building blocks.
- Applicable only to SAP Fiori elements (OData V4).
```

**STEP**: 2 — Use the Field building block in an XML fragment (authoring)

**DESCRIPTION**: Example XML fragment showing how to declare Field building blocks. Use the "macros" namespace mapped to "sap.fe.macros". Place the Field elements where a custom section or fragment expects controls. These building blocks will be transformed into the appropriate SAPUI5 controls at runtime.

**LANGUAGE**: XML

**CODE**:
```XML
<!-- Example fragment containing Field building blocks -->
<core:FragmentDefinition
  xmlns:core="sap.ui.core"
  xmlns:macros="sap.fe.macros">

  <!-- Field for a string property -->
  <macros:Field metaPath="MyStringProperty" readOnly="true"/>

  <!-- Field for a date property -->
  <macros:Field metaPath="MyDateProperty" readOnly="true"/>
</core:FragmentDefinition>
```

**STEP**: 3 — Expected runtime control tree (result of Field transformations)

**DESCRIPTION**: The Field building block maps to different SAPUI5 controls depending on the property type and attributes. Example mapping for the XML above:

**LANGUAGE**: XML

**CODE**:
```XML
<!-- Resulting controls created at runtime by the building block transformations -->
<m:Text xmlns:m="sap.m" value="{MyStringProperty}"/>
<m:DatePicker xmlns:m="sap.m" value="{MyDateProperty}"/>
```

**STEP**: 4 — Load fragments containing building blocks dynamically using ExtensionAPI

**DESCRIPTION**: When a fragment that contains building blocks is loaded dynamically, always use sap.fe.core.ExtensionAPI.loadFragment. This ensures the Fiori elements runtime processes the building blocks and produces the correct control tree. The method returns a Promise resolving with the instantiated fragment (control) which you should add as dependent to your view or aggregation.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example controller method: load a fragment that contains building blocks
onOpenCustomSection: function () {
  // 'this.extensionAPI' is provided in Fiori elements controllers
  this.extensionAPI.loadFragment({
    name: "com.my.app.fragments.CustomSection", // fragment name (XML)
    controller: this
  }).then(function (oFragment) {
    // Add the returned fragment as a dependent so models and lifecycle are handled
    this.getView().addDependent(oFragment);
    // Example: insert into a page or aggregation
    // this.byId("mySectionAggregate").addItem(oFragment);
  }.bind(this));
}
```

**STEP**: 5 — Related links and references

**DESCRIPTION**: Links for deeper reference and API details. Use these resources for the flexible programming model and ExtensionAPI documentation.

**LANGUAGE**: Text

**CODE**:
```Text
- Flexible Programming Model overview:
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/overview/introduction

- ExtensionAPI.loadFragment (Demo Kit / API reference):
  https://ui5.sap.com/#/api/sap.fe.core.ExtensionAPI%23overview
```
--------------------------------

**TITLE**: Bullet Micro Chart (UI.Chart + UI.DataPoint annotations)

**INTRODUCTION**: Provide the annotations required to render a Bullet Micro Chart in Fiori Elements. Includes XML (OData annotations), ABAP CDS, and CAP CDS examples for UI.Chart and UI.DataPoint annotations, plus the mandatory annotation checklist and semantic coloring behavior.

**TAGS**: fiori-elements-framework, ui5, annotations, UI.Chart, UI.DataPoint, CDS, CAP, ABAP, XML

**STEP**: 1 — Add UI.Chart annotation (XML)
**DESCRIPTION**: Place this UI.Chart annotation in your OData annotations file (e.g., annotations.xml) to define a Bullet chart with title, description, measures, and measure attributes. Ensure ChartType is UI.ChartType/Bullet and MeasureAttributes refer to a DataPoint qualifier via AnnotationPath.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.Chart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Sales Revenue" />
        <PropertyValue Property="Description" String="Bullet Micro Chart" />
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bullet" />
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>BulletChartRevenue</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="BulletChartRevenue" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#BulletChartRevenue" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 2 — Add UI.Chart annotation (ABAP CDS)
**DESCRIPTION**: Add this CDS annotation to your ABAP CDS view (annotate the view or field as appropriate). ChartType must be #BULLET; include measures and measureAttributes with asDataPoint true when using a DataPoint.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@UI.Chart: [
  {
    title: 'Sales Revenue',
    description: 'Bullet Micro Chart',
    chartType: #BULLET,
    measures: [
      'BULLETCHARTREVENUE'
    ],
    measureAttributes: [
      {
        measure: 'BulletChartRevenue',
        role: #AXIS_1,
        asDataPoint: true
      }
    ]
  }
]
annotate view STTA_C_MP_PRODUCT with {

}
```

**STEP**: 3 — Add UI.Chart annotation (CAP CDS)
**DESCRIPTION**: Add this UI.Chart object in your .cds file (service layer or entity annotation) to define the Bullet chart. Use ChartType #Bullet, list Measures, and set MeasureAttributes with DataPoint referencing the DataPoint qualifier.
**LANGUAGE**: CAP CDS
**CODE**:
```
UI.Chart : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Sales Revenue',
    Description : 'Bullet Micro Chart',
    ChartType : #Bullet,
    Measures : [
        BulletChartRevenue
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : BulletChartRevenue,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#BulletChartRevenue'
        }
    ]
}
```

**STEP**: 4 — Add UI.DataPoint annotation (XML)
**DESCRIPTION**: Define the DataPoint qualifier referenced by the UI.Chart MeasureAttributes. Include Value, TargetValue, ForecastValue, MinimumValue, MaximumValue, and Criticality (or CriticalityCalculation).
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.DataPoint" Qualifier="BulletChartRevenue">
    <Record>
        <PropertyValue Property="Value" Path="BulletChartRevenue" />
        <PropertyValue Property="TargetValue" Path="TargetRevenue" />
        <PropertyValue Property="ForecastValue" Path="ForecastRevenue" />
        <PropertyValue Property="MinimumValue" Decimal="100" />
        <PropertyValue Property="MaximumValue" Decimal="300" />
        <PropertyValue Property="Criticality" Path="Criticality" />
    </Record>
</Annotation>
```

**STEP**: 5 — Add UI.DataPoint annotation (ABAP CDS)
**DESCRIPTION**: Annotate the measure element in ABAP CDS with @UI.dataPoint to map target/forecast/min/max/criticality properties for the Bullet chart.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@UI.dataPoint: {
  targetValueElement: 'TargetRevenue',
  forecastValue: 'ForecastRevenue',
  minimumValue: 100,
  maximumValue: 300,
  criticality: 'Criticality'
}
BulletChartRevenue;
```

**STEP**: 6 — Add UI.DataPoint annotation (CAP CDS)
**DESCRIPTION**: Define a UI.DataPoint qualifier in CAP CDS and reference it from UI.Chart MeasureAttributes. Map Value, TargetValue, ForecastValue, MinimumValue, MaximumValue, and Criticality.
**LANGUAGE**: CAP CDS
**CODE**:
```
UI.DataPoint #BulletChartRevenue : {
    Value : BulletChartRevenue,
    TargetValue : TargetRevenue,
    ForecastValue : ForecastRevenue,
    MinimumValue : 100,
    MaximumValue : 300,
    Criticality : Criticality
}
```

**STEP**: 7 — Mandatory annotations & semantic coloring rules
**DESCRIPTION**: Required annotations checklist and semantic coloring precedence. Use these rules to validate chart annotation completeness and semantic behavior.
**LANGUAGE**: TEXT
**CODE**:
```
Mandatory annotations:
- UI.Chart -> ChartType: "Bullet"
- UI.Chart -> Measures (at least one measure; referenced field name)
- UI.Chart -> MeasureAttributes -> DataPoint (AnnotationPath or qualifier reference)
- UI.DataPoint -> Value (path to measure value field)

Semantic coloring rules:
- UI.DataPoint supports Criticality and CriticalityCalculation.
- If both Criticality and CriticalityCalculation are present, Criticality overrides CriticalityCalculation.
- If using CriticalityCalculation, also provide:
  - UI.DataPoint -> CriticalityCalculation
  - UI.DataPoint -> CriticalityCalculation/ImprovementDirection
```
--------------------------------

**TITLE**: Caching the Last Executed Request (SAP Fiori elements — OData V4)

**INTRODUCTION**: Short guide for enabling and controlling client-side caching of the last executed request in SAP Fiori elements list reports (OData V4, S/4HANA Cloud Public Edition). The cache stores request parameters (not responses) so the app can re-trigger the last request on load and reduce end-to-end response time.

**TAGS**: fiori-elements, odata-v4, s4hana-cloud, list-report, caching, manifest.json, security

**STEP**: 1 — Applicability and behavior

**DESCRIPTION**: Confirm this feature applies only to Fiori elements apps using OData V4 in S/4HANA Cloud Public Edition. Caching stores only the request parameters (filters, sorting, pagination, etc.), not backend responses. When list reports are configured to load data automatically, the last executed request is held on the client and can be re-triggered during application startup to speed up load time.

**LANGUAGE**: text

**CODE**:
```text
Applies to: SAP Fiori elements for OData V4 in SAP S/4HANA Cloud Public Edition
Behavior: Caches last executed request parameters (not response body) to re-trigger request on app load.
```

**STEP**: 2 — Conditions that disable request caching

**DESCRIPTION**: Request caching is automatically disabled when:
- The request contains filters on properties annotated with PersonalData.IsPotentiallySensitive.
- A controller extension is defined in the list report (because extensions can modify requests and potentially add sensitive filters).

If either condition is present, the framework disables request caching by default.

**LANGUAGE**: text

**CODE**:
```text
Disabled when:
- Any filter uses properties annotated with:
  https://github.com/SAP/odata-vocabularies/blob/main/vocabularies/PersonalData.xml#L234
  (PersonalData.IsPotentiallySensitive)
- A controller extension is defined for the list report
```

**STEP**: 3 — Override default (enable request caching when controller extension exists)

**DESCRIPTION**: If a controller extension exists but you are certain no sensitive filters will be added at runtime, explicitly enable request caching by setting disableRequestCache to false in the manifest routing target's tableSettings. Place this setting under routing -> targets -> <ListTarget> -> options -> settings -> controlConfiguration -> @com.sap.vocabularies.UI.v1.LineItem -> tableSettings -> disableRequestCache.

Include this snippet in your app's manifest.json target configuration.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "routing": {
    "targets": {
      "RootEntityList": {
        "type": "Component",
        "name": "sap.fe.templates.ListReport",
        "id": "RootEntityList",
        "options": {
          "settings": {
            "entitySet": "RootEntity",
            "controlConfiguration": {
              "@com.sap.vocabularies.UI.v1.LineItem": {
                "tableSettings": {
                  "disableRequestCache": false
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Security note when overriding caching

**DESCRIPTION**: When you set disableRequestCache to false, you are responsible for ensuring that no filters on sensitive data (PersonalData.IsPotentiallySensitive) are added by extensions or at runtime. Enabling caching while sensitive filters are present violates the security constraint and is not recommended.

**LANGUAGE**: text

**CODE**:
```text
Security requirement: If disableRequestCache = false, ensure no filters on properties annotated with PersonalData.IsPotentiallySensitive are applied.
Reference: Security Configuration documentation (see security-configuration-ba0484b.md)
```

**STEP**: 5 — End-user controls for cache expiration and clearing

**DESCRIPTION**: End users can control cache expiration and manually clear the cached last request via SAP Fiori launchpad settings (User Activities / Settings -> Cache / Last executed request). Administrators may also manage FLP settings globally.

**LANGUAGE**: text

**CODE**:
```text
End users: Clear cache and control expiration in SAP Fiori launchpad settings (User Activities / Settings -> Cache or similar)
Developer note: No additional code required; behavior is managed by the Fiori launchpad and framework.
```
--------------------------------

**TITLE**: Changing Default Titles for New and Unnamed Objects in SAP Fiori Elements

**INTRODUCTION**: Instructions and code examples to override default titles shown for newly created and unnamed objects in SAP Fiori elements apps (OData V2 and V4). Includes i18n keys, file locations, example i18n entries, and notes about behavior and limitations (draft vs non-draft, list report vs object page).

**TAGS**: fiori-elements, i18n, localization, OData V2, OData V4, list-report, object-page, titles

**STEP**: 1 — Add/modify i18n file in your app
**DESCRIPTION**: Create or update the i18n properties file used by your SAP Fiori elements application. Typical path: webapp/i18n/i18n.properties. Add the appropriate keys depending on the OData version of your app (V2 or V4). The examples below provide entries for both V2 and V4 so you can pick the ones relevant to your app.
**LANGUAGE**: properties
**CODE**:
```properties
# File: webapp/i18n/i18n.properties
# --- OData V2 keys (List Report & Object Page support) ---
# XTIT: Title for new unsaved objects (draft apps show this for newly created drafts)
NEW_OBJECT=My Custom Title for New Objects

# XTIT: Default Title for objects that have a saved version (saved objects without an explicit title)
UNNAMED_OBJECT=My Custom Title for Unnamed Object

# --- OData V4 keys (List Report & Object Page support) ---
# Override default 'New Object' for newly created objects
T_NEW_OBJECT=My Custom Title for New Objects (V4)

# Override default 'Unnamed Object' for saved objects without header info
T_ANNOTATION_HELPER_DEFAULT_HEADER_TITLE_NO_HEADER_INFO=My Custom Title for Unnamed Object (V4)
```

**STEP**: 2 — Example: minimal i18n files for multiple languages
**DESCRIPTION**: Provide translations for other languages by copying the same keys into language-specific files (e.g., i18n_de.properties). Maintain identical key names across locales.
**LANGUAGE**: properties
**CODE**:
```properties
# File: webapp/i18n/i18n_de.properties
NEW_OBJECT=Neuer Entwurfstitel
UNNAMED_OBJECT=Unbenannter Eintrag
T_NEW_OBJECT=Neuer Titel für neue Objekte (V4)
T_ANNOTATION_HELPER_DEFAULT_HEADER_TITLE_NO_HEADER_INFO=Unbenannter Eintrag (V4)
```

**STEP**: 3 — Behavior notes and limitations to code against
**DESCRIPTION**: Use these rules to implement UI or tests that rely on title behavior. Preserve these behaviors in custom code or automated tests.
**LANGUAGE**: text
**CODE**:
```text
Behavior summary:

- OData V2:
  - NEW_OBJECT: shown for newly created draft objects in draft-enabled apps and for unsaved created objects in non-draft apps.
  - UNNAMED_OBJECT: shown as default title for saved objects (display and edit modes).
  - Note: For non-draft list reports, NEW_OBJECT and UNNAMED_OBJECT are not supported in i18n.properties.
  - Note (object pages): To display a custom default title for saved objects, override UNNAMED_OBJECT. (SAP Fiori elements does not support specifying default titles for saved objects in all scenarios—test in your target app template.)

- OData V4:
  - T_NEW_OBJECT: overrides default 'New Object' for newly created objects in tables.
  - T_ANNOTATION_HELPER_DEFAULT_HEADER_TITLE_NO_HEADER_INFO: overrides default 'Unnamed Object' for saved objects that have no header title.
  - If UI.HeaderInfo.Typename is undefined, clearing the title or saving without changing 'New Object' may set the title to an empty string ("") — ensure your app logic or annotations handle this case.

Implementation tips:
- Place the keys in the i18n file used by your application runtime (webapp/i18n/i18n.properties).
- Ensure your build / resource bundling includes these i18n files.
- Verify behavior in both draft and non-draft applications, and on both list reports and object pages, since support differs by template and OData version.
```

**STEP**: 4 — Quick verification checklist (manual or automated tests)
**DESCRIPTION**: Test the behavior after adding keys to ensure the UI shows customized titles in the expected scenarios.
**LANGUAGE**: text
**CODE**:
```text
Verification checklist:
1. Start app with OData V2 draft-enabled list report or object page:
   - Create a new item -> verify title shows NEW_OBJECT value.
   - Save without changing title -> verify saved title shows UNNAMED_OBJECT value (object page).

2. Start app with OData V2 non-draft list report:
   - Create a new item -> verify whether NEW_OBJECT/UNNAMED_OBJECT are applied (note they may not be supported).

3. Start app with OData V4:
   - Create a new item -> verify title shows T_NEW_OBJECT value.
   - Save without changing title -> verify title updates to T_ANNOTATION_HELPER_DEFAULT_HEADER_TITLE_NO_HEADER_INFO value, or empty string if UI.HeaderInfo.Typename is undefined.

4. Test language fallback:
   - Change user language -> verify localized i18n_<lang>.properties values are shown.
```
--------------------------------

**TITLE**: Change list-report to object-page navigation (disable or replace with external navigation)

**INTRODUCTION**: This document shows concrete manifest.json edits for SAP Fiori Elements applications to: (1) disable internal navigation from List Report to Object Page, and (2) replace internal navigation with intent-based (external) navigation. Examples cover OData V2 (sap.ui.generic.app) and OData V4 / SAP Fiori elements v4 (sap.ui5 routing / FE templates). Keep the file path: manifest.json.

**TAGS**: fiori-elements-framework, manifest.json, navigation, sap.ui.generic.app, sap.app, sap.ui5, crossNavigation, outbounds, odata-v2, odata-v4

STEP: Disable internal navigation — OData V2 (sap.ui.generic.app)
DESCRIPTION: Remove the nested "pages" definition for the Object Page from the List Report page to prevent internal navigation from the List Report to the Object Page. Edit manifest.json under "sap.ui.generic.app" pages and delete the nested subpage block.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Zfarvd_Bs_Hd_Bo",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "gridTable": false,
            "hideTableVariantManagement": false
          }
        }
        /* Remove the nested "pages" array below to disable navigation to Object Page:
        ,
        "pages": [
          {
            "entitySet": "Zfarvd_Bs_Hd_Bo",
            "component": { "name": "sap.suite.ui.generic.template.ObjectPage" }
          }
        ]
        */
      }
    ]
  }
}
```

STEP: Disable internal navigation — OData V4 / Fiori elements v4 (sap.ui5 routing)
DESCRIPTION: Remove the "navigation" section (or the specific navigation mapping) from the target that defines the List Report → Object Page mapping in sap.ui5.routing.targets. This prevents internal navigation to the object/subobject page.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "ArtistList": {
          "options": {
            "settings": {
              "contextPath": "/Artists"
              /* Remove or clear the "navigation" block below to disable internal navigation:
              ,"navigation": {
                "Artists": {
                  "detail": {
                    "route": "ArtistObjectPage"
                  }
                }
              }
              */
            }
          }
        },
        "ArtistObjectPage": {
          "options": {
            "settings": {
              "contextPath": "/Artists"
              /* Remove "navigation" mapping that would link to subobject pages:
              ,"navigation": {
                "_Publication": {
                  "detail": { "route": "PublicationObjectPage" }
                }
              }
              */
            }
          }
        }
      }
    }
  }
}
```

STEP: Enable external intent-based navigation — OData V2 (sap.ui.generic.app)
DESCRIPTION: Define an outbound intent in sap.app.crossNavigation.outbounds and reference it from the List Report → Object Page navigation using "navigation.display" that points to the outbounds path. Ensure sap.ui.generic.app->_version supports this (example uses 1.2.0).
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "_version": "1.2.0",
    "crossNavigation": {
      "outbounds": {
        "ExampleNavigationTarget": {
          "semanticObject": "EPMProduct",
          "action": "manage_st"
        }
      }
    }
  },
  "sap.ui.generic.app": {
    "_version": "1.2.0",
    "pages": [
      {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": [
          {
            "entitySet": "STTA_C_MP_Product",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage"
            },
            "navigation": {
              "display": {
                "path": "sap.app.crossNavigation.outbounds",
                "target": "ExampleNavigationTarget"
              }
            }
          }
        ]
      }
    ]
  }
}
```

STEP: Enable external intent-based navigation — OData V4 / Fiori elements v4 (sap.ui5 routing)
DESCRIPTION: Define an outbound intent in sap.app.crossNavigation.outbounds and update target navigation settings to call the outbound instead of internal routes. Two options: (A) use "navigation.*.detail.outbound" to point to an outbound key, or (B) use "navigation.*.display" with path to sap.app.crossNavigation.outbounds and target. If both are present, "display" has priority.
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "crossNavigation": {
      "outbounds": {
        "ProductDetails": {
          "semanticObject": "ProductDetails",
          "action": "manage"
        }
      }
    }
  },
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": ":?query:",
          "name": "ArtistList",
          "target": "ArtistList"
        },
        {
          "pattern": "Artists({key}):?query:",
          "name": "ArtistDetail",
          "target": "ArtistObjectPage"
        }
      ],
      "targets": {
        "ArtistList": {
          "type": "Component",
          "id": "ArtistList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/Artists",
              "navigation": {
                "Artists": {
                  "detail": {
                    "route": "ArtistObjectPage"
                  }
                }
              }
            }
          }
        },
        "ArtistObjectPage": {
          "type": "Component",
          "id": "ArtistDetail",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "contextPath": "/Artists",
              "_tableType": "Table",
              "navigation": {
                "_Publication": {
                  "detail": {
                    /* Option A: use outbound to call the external intent:
                       "outbound": "ProductDetails"
                  */
                    "outbound": "ProductDetails"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Alternative external navigation (use display with path) — OData V4
DESCRIPTION: Use "display" to reference the outbounds path explicitly. When both display and detail/outbound exist, display takes precedence.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "ArtistObjectPage": {
          "options": {
            "settings": {
              "navigation": {
                "_Publication": {
                  "display": {
                    "path": "sap.app.crossNavigation.outbounds",
                    "target": "ProductDetails"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Important notes and validation
DESCRIPTION: Checklist to validate changes:
- Ensure the referenced outbound key (ExampleNavigationTarget, ProductDetails, etc.) exists under sap.app.crossNavigation.outbounds.
- For OData V2 examples, sap.ui.generic.app->_version 1.2.0 is shown; adapt if you use a different schema version.
- For OData V4 / FE v4, you can set "detail.outbound" or "display" under the navigation mapping; "display" has priority when both are present.
- Edits must be made in the application's manifest.json (root of the UI project).
LANGUAGE: JSON
CODE:
```json
{
  "file": "manifest.json",
  "checks": [
    "sap.app.crossNavigation.outbounds contains target key used by navigation",
    "sap.ui.generic.app.pages (V2) or sap.ui5.routing.targets.*.options.settings.navigation (V4) updated/removed as intended",
    "Confirm version compatibility for sap.ui.generic.app->_version if using V2 features"
  ]
}
```
--------------------------------

**TITLE**: Analytical Chart Cards for Overview Pages (OVP)

**INTRODUCTION**: Provide an overview of how to add analytical chart cards to Fiori overview pages (OVP). Includes manifest configuration for the card and example backend annotations (CDS and EDMX/XML) to expose measures/dimensions. Notes about automatic height and legend behavior are included for layout considerations.

**TAGS**: fiori-elements-framework, ovp, analytical-card, chart, manifest, CDS, annotations, edmx, sap.ovp

STEP: 1 — Add an analytical chart card to the app manifest

DESCRIPTION: Add a card entry under sap.ovp/cards in webapp/manifest.json. Use the charts card template and reference an annotationPath or qualifier to pick the chart annotation defined in the OData service. Set title and entitySet. The card height is automatically adjusted by OVP; legends are created automatically based on measures/dimensions in the annotation.

LANGUAGE: JSON

CODE:
```json
// File: webapp/manifest.json (snippet)
{
  "sap.ovp": {
    "cards": {
      "SalesChartCard": {
        "template": "sap.ovp.cards.charts",
        "title": "Sales by Region",
        "entitySet": "SalesOrderSet",
        "annotationPath": "com.sap.vocabularies.UI.v1.Chart#SalesByRegion",
        "settings": {
          "chartAnnotationQualifier": "SalesByRegion"
        }
      }
    }
  }
}
```

STEP: 2 — Define chart annotation in ABAP CDS (preferred for ABAP backend)

DESCRIPTION: Annotate the CDS view to expose a chart annotation. Define chart type, one or more measures, and one or more dimensions. OVP will render the chart using these annotation properties. The annotation qualifier should match the qualifier referenced in manifest (e.g., SalesByRegion).

LANGUAGE: CDS

CODE:
```cds
// File: srv/annotations/view.cds (example)
@AbapCatalog.sqlViewName: 'ZV_SALES_OVP'
@EndUserText.label: 'Sales OVP View'
define view Z_SalesOVP
  as select from sepm_sddl_salesorder as Sales
{
  key Sales.SalesOrderID    as SalesOrderID,
      Sales.Region          as Region,
      Sales.GrossAmount     as SalesAmount,
      Sales.OrderDate       as OrderDate
}
annotate view Z_SalesOVP with
{
  @UI.chart: {
    qualifier: 'SalesByRegion',
    type: #BAR,                     // chart types: #BAR, #COLUMN, #LINE, #PIE, etc.
    measures: [ 'SalesAmount' ],
    dimensions: [ 'Region' ],
    aggregation: #SUM
  }
}
```

STEP: 3 — (Alternative) Define chart annotation in EDMX / OData V2 metadata XML

DESCRIPTION: If using an OData service with EDMX annotations, provide a Chart annotation with a qualifier. The qualifier name must match the manifest annotationPath to connect the card to this chart definition.

LANGUAGE: XML

CODE:
```xml
<!-- File: <service>.xml or annotations.xml (snippet) -->
<Annotations Target="SalesOrderSet">
  <Annotation Term="com.sap.vocabularies.UI.v1.Chart" Qualifier="SalesByRegion">
    <Record>
      <PropertyValue Property="ChartType" EnumMember="com.sap.vocabularies.UI.v1.ChartType/Column" />
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>SalesAmount</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>Region</PropertyPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 4 — Important layout and behavior notes

DESCRIPTION: Key behaviors to consider when implementing analytical chart cards:
- Card height is not fixed: OVP adjusts the height automatically depending on the chart content (data points, legend, labels) — do not hardcode a pixel height in the card settings.
- Legends are auto-generated from the defined measures and dimensions — you do not need to add legend entries manually.
- If multiple measures are present, the chart will render multiple series; use measures and dimensions appropriately in the annotation.
- Use the same qualifier/annotationPath between manifest and backend annotations to bind the card to the specific chart.

LANGUAGE: JSON

CODE:
```json
// Example: reminder to keep qualifier consistent
{
  "manifest": {
    "sap.ovp": {
      "cards": {
        "SalesChartCard": {
          "annotationPath": "com.sap.vocabularies.UI.v1.Chart#SalesByRegion"
        }
      }
    }
  },
  "backend": {
    "chartQualifier": "SalesByRegion"
  }
}
```
--------------------------------

**TITLE**: Chart Extensions for Analytical List Page (ALP) — onBeforeRebindChartExtension

**INTRODUCTION**: Configure a controller extension for SAP Fiori elements Analytical List Page (ALP) to implement onBeforeRebindChartExtension. This extension lets you inspect and modify chart binding parameters (for example, add custom filters or alter query parameters) just before the chart data is rebound. Applicable to SAP Fiori elements for OData V2.

**TAGS**: fiori-elements-framework, sap-fiori, analytical-list-page, OData V2, controller-extension, chart, onBeforeRebindChartExtension

**STEP**: 1 — Register controller extension in app descriptor (manifest.json)

**DESCRIPTION**: Update your app descriptor (manifest.json / app-descriptor) to extend the ALP controller by mapping the framework controller to your custom extension controller. Add the sap.ui.controllerExtensions entry under sap.ui5 -> extends -> extensions. Replace the controllerName with your extension module path.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "_version": "1.1.0",
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
            "controllerName": "sap.poc.ftu.apps.alr.ext.controller.AnalyticalListPageExt"
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Implement the extension controller module

**DESCRIPTION**: Create the extension controller module that implements onBeforeRebindChartExtension. Place the file according to the controllerName path from the manifest (example path: webapp/sap/poc/ftu/apps/alr/ext/controller/AnalyticalListPageExt.js). The function receives an event object from ALP—use oEvent.getParameter("bindingParams") to read/modify chart binding parameters and oEvent.getSource() to get the chart control.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/sap/poc/ftu/apps/alr/ext/controller/AnalyticalListPageExt.js
sap.ui.define([
  "sap/ui/model/Filter",
  "sap/ui/model/FilterOperator"
], function(Filter, FilterOperator) {
  "use strict";

  return {
    /**
     * Called by ALP before the chart is rebound.
     * oEvent contains parameters such as "bindingParams" and source control.
     */
    onBeforeRebindChartExtension: function(oEvent) {
      // Simple notification for debugging
      alert("onBeforeRebindChartExtension called!");

      // Access the chart control that triggered the event
      var oChart = oEvent.getSource();

      // Access and modify binding parameters
      var oBindingParams = oEvent.getParameter("bindingParams");
      if (oBindingParams) {
        // Example: ensure filters array exists, then add a custom filter
        oBindingParams.filters = oBindingParams.filters || [];
        // Add a filter: Property 'Category' equals 'X' (adjust property/operator/value as needed)
        oBindingParams.filters.push(new Filter("Category", FilterOperator.EQ, "X"));

        // Optionally modify other binding params (e.g., $select, $expand, sorters)
        // oBindingParams.parameters = oBindingParams.parameters || {};
        // oBindingParams.parameters.custom = "value";
      }

      // You can also inspect or manipulate the chart (oChart) here
      // e.g., oChart.setVizType("bar");
    }
  };
});
```

**STEP**: 3 — Runtime behavior and tips

**DESCRIPTION**: At runtime ALP will call your onBeforeRebindChartExtension implementation before re-binding chart data. Use the event object to:
- Read and modify oEvent.getParameter("bindingParams") to add filters, sorters, or query parameters.
- Use oEvent.getSource() to access the chart/control for UI changes.
- Keep logic synchronous; modify bindingParams directly to affect the binding that follows.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "runtimeTips": [
    "Ensure controller module path matches manifest controllerName.",
    "Use oEvent.getParameter('bindingParams') to change filters/sorters before the request is sent.",
    "This extension applies to SAP Fiori elements for OData V2 (Analytical List Page)."
  ]
}
```

Related Information: Configuring Analytical List Page App Extensions — configuring-analytical-list-page-app-extensions-9504fb4.md
--------------------------------

**TITLE**: Verify Generated Fiori Elements App: Folder Structure, Component.js, manifest.json, and Preview Destinations

**INTRODUCTION**: Quick checklist and minimal code examples to programmatically verify and adapt a newly generated SAP Fiori elements (OData V2) application. Use this to validate the generated artifact locations, inspect the application component and app descriptor, confirm local test data, and adapt preview destinations via UI5 run configuration files or the Fiori run configurations palette.

**TAGS**: fiori-elements-framework, sapui5, odata-v2, manifest, Component.js, annotations, ui5, run-config

**STEP**: 1 — Verify folder structure and presence of key artifacts

**DESCRIPTION**: Confirm the main generated folders and files exist under your app project (usually under webapp/). This minimal tree covers List Report + Object Page projects. Adjust paths when your workspace layout differs.

**LANGUAGE**: Text

**CODE**:
```text
<project-root>/
├─ webapp/
│  ├─ Component.js
│  ├─ manifest.json
│  ├─ index.html
│  ├─ controller/
│  ├─ view/
│  ├─ localService/
│  │  ├─ metadata.xml
│  │  └─ SEPMRA_PROD_MAN_ANNO_MDL.xml
│  ├─ i18n/
│  │  └─ i18n.properties
│  ├─ css/
│  ├─ images/
│  └─ test/
├─ ui5*.yaml   # one or more UI5 tooling config files used for preview/deployment
└─ package.json
```

**STEP**: 2 — Inspect Component.js (do not modify)

**DESCRIPTION**: Component.js bootstraps the SAPUI5 component and delegates configuration to the manifest.json at runtime. This file is generated and should not be edited. Use it to confirm the component references the manifest.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/Component.js (representative minimal structure - generated file)
sap.ui.define(["sap/ui/core/UIComponent"],
  function (UIComponent) {
    "use strict";
    return UIComponent.extend("sap.ui.demo.myFioriApp.Component", {
      metadata: {
        manifest: "json" // links to webapp/manifest.json
      }
    });
});
```

**STEP**: 3 — Inspect manifest.json for dataSources, annotations, and app metadata

**DESCRIPTION**: The manifest.json (webapp/manifest.json) contains service and annotation resource links entered in the generator. For OData V2 apps, annotations commonly use the catalog service of SAP Gateway or local annotation files. Verify dataSources, annotations, and i18n configuration. Example shows typical entries: sap.app id/title, sap.ui5 dataSources for OData and annotations, and i18n model.

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (excerpt)
{
  "sap.app": {
    "id": "my.company.app",
    "title": "{{appTitle}}"
  },
  "sap.ui": {
    "technology": "UI5"
  },
  "sap.ui5": {
    "models": {
      "i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "settings": {
          "bundleName": "my.company.app.i18n.i18n"
        }
      }
    },
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/SEPMRA_PROD_MAN_SRV/",
        "type": "OData",
        "settings": { "odataVersion": "2.0" }
      },
      "annotations": {
        "uri": "localService/SEPMRA_PROD_MAN_ANNO_MDL.xml",
        "type": "ODataAnnotation"
      }
    }
  },
  "sap.platform.hcp": { /* optional HCP/Cloud info */ }
}
```

**STEP**: 4 — Confirm localService annotation files and precedence rules

**DESCRIPTION**: The project may include localService/metadata.xml plus local annotation files (e.g., localService/SEPMRA_PROD_MAN_ANNO_MDL.xml). If a local annotations file named annotations.xml is present, it takes precedence over back-end annotations when the app runs locally. Use these files to simulate back-end responses for local tests.

**LANGUAGE**: Text

**CODE**:
```text
Files to check:
- webapp/localService/metadata.xml           -> local OData metadata (mock service)
- webapp/localService/SEPMRA_PROD_MAN_ANNO_MDL.xml  -> local annotation file
- webapp/annotations.xml (if present)        -> local annotations override backend annotations
Precedence:
1. webapp/annotations.xml (if exists)
2. annotations referenced in manifest.json (localService/*.xml or backend)
```

**STEP**: 5 — Adapt preview destinations using run configurations (Fiori: Open Run Configurations) and ui5*.yaml

**DESCRIPTION**: Destination configuration for preview is stored in one or more UI5 tooling YAML files (ui5*.yaml). Use the VS Code command palette: "Fiori: Open Run Configurations" to open and edit preview destinations. Below is a safe generic example YAML snippet (placeholders) to adapt to your environment — replace placeholders with your backend URL and destination name.

**LANGUAGE**: YAML

**CODE**:
```yaml
# Example ui5-runner or ui5-local tooling snippet (replace with your generated ui5*.yaml filename)
preview:
  server:
    port: 8000
    open: true
  destinations:
    - name: MyBackend
      url: "https://my.sap.backend.example"
      description: "Preview backend for OData service"
      # If using a relative service path:
      servicePath: "/sap/opu/odata/sap/SEPMRA_PROD_MAN_SRV/"
# Use the VS Code command palette: "Fiori: Open Run Configurations" to edit and apply preview destinations.
```

**STEP**: 6 — Localization and shell bar preferences

**DESCRIPTION**: Texts should use i18n properties under webapp/i18n/i18n.properties. You can define subtitle and application icon for the shell bar in the manifest.json sap.app or related sections; refer to the manifest descriptor docs when changing these values.

**LANGUAGE**: Properties / JSON

**CODE**:
```properties
# webapp/i18n/i18n.properties (example)
appTitle=My Fiori Elements App
appSubtitle=List Report & Object Page
```

```json
// manifest.json snippet for shell icon/title (place under sap.app or sap.ui)
{
  "sap.app": {
    "title": "{{appTitle}}",
    "subTitle": "{{appSubtitle}}",
    "applicationCategory": "Business"
  },
  "sap.fiori": {
    "registrationIds": [],
    "archeType": "transactional"
  }
}
```

**STEP**: 7 — References and further reading

**DESCRIPTION**: For details about generated files and the project layout, consult the "Projects" section in the SAP Fiori Tools Generating an Application documentation and the manifest descriptor docs.

**LANGUAGE**: Text

**CODE**:
```text
Docs:
- Generating an Application -> Projects section:
  https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/db44d45051794d778f1dd50def0fa267.html
- Manifest descriptor for applications, components, and libraries:
  ../04_Essentials/manifest-descriptor-for-applications-components-and-libraries-be0cf40.md
- Localization of UI Texts:
  localization-of-ui-texts-b8cb649.md
```
--------------------------------

**TITLE**: Choosing Filter Modes for Analytical List Page (ALP)

**INTRODUCTION**: Guidance and actionable templates for implementing and customizing filter modes (visual and compact) in SAP Fiori Elements Analytical List Page (ALP). Covers annotation placement, manifest wiring, runtime toggling, and visual filter chart options. Use the templates as starting points and replace placeholders with your actual entity/field names and backend annotation files.

**TAGS**: fiori-elements-framework, analytical-list-page, ALP, filters, visual-filter, compact-filter, ODataV2, manifest.json, annotations

STEP: 1 — Annotation: Declare selection fields and visual-filter candidates

DESCRIPTION: Mark the entity properties that should appear in the filter UI. Fields intended to be available in the compact filter must be exposed as selection fields. Fields that should appear as visual filters require the relevant visual-filter annotations in your OData/CDS/annotation file. Visual-filter-enabled fields will always also appear in the compact filter.

LANGUAGE: XML (OData annotation template)

CODE:
```xml
<!-- annotations.xml (template) -->
<!-- Replace ENTITY_TYPE and PROPERTY_NAME with your values.
     This template shows the typical structure: SelectionFields + visual-filter annotation placeholder. -->

<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="http://docs.oasis-open.org/odata/odata/v4.0/cs01/vocabularies/Org.OData.Core.V1.xml" />
  <!-- Add other vocabulary references as needed -->
  <edmx:DataServices>
    <Schema Namespace="Your.Service.Annotations" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <!-- SelectionFields listing for compact filter -->
      <Annotations Target="Your.Service.EntityType">
        <Annotation Term="com.sap.vocabularies.UI.v1.SelectionFields">
          <Collection>
            <PropertyPath>PROPERTY_NAME_1</PropertyPath>
            <PropertyPath>PROPERTY_NAME_2</PropertyPath>
            <!-- Add additional selection fields -->
          </Collection>
        </Annotation>

        <!-- Visual filter annotation placeholder for a property -->
        <!-- Replace with the specific visual filter annotation syntax your OData provider uses -->
        <Annotation Term="com.sap.vocabularies.UI.v1.Field">
          <Record>
            <PropertyValue Property="PropertyPath" String="PROPERTY_NAME_1"/>
            <!-- Custom term(s) indicating visual filter configuration go here -->
            <!-- Example: chart type, measure, sort order, etc. -->
          </Record>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

STEP: 2 — Project wiring: Analytical List Page entry in manifest.json

DESCRIPTION: Register your ALP page in the manifest to enable the ALP runtime. Place page configuration under sap.ui.generic.app/pages. This is the standard place for Fiori Elements to bootstrap ALP and wire annotations.

LANGUAGE: JSON (manifest.json template)

CODE:
```json
{
  "sap.app": {
    "id": "your.app.id"
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      }
    },
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/YOUR_SERVICE/"
      }
    },
    "extends": {
      "extensions": {}
    }
  },
  "sap.ui.generic.app": {
    "pages": {
      "AnalyticalListPage": {
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "entitySet": "YourEntitySet"
            /* Additional ALP-specific settings can be added here */
          }
        }
      }
    }
  }
}
```

STEP: 3 — Runtime behavior: Toggle modes and sync expectations

DESCRIPTION: ALP offers a toggle between visual and compact filter modes. The ALP runtime synchronizes filter values between modes. Note these important behaviors to implement in UI or controller customizations:
- A visual filter field always appears in compact filter mode.
- Fields that have no visual-filter configuration appear only in compact mode.
- When toggling modes, filter values are kept in sync across both modes.
- All compact-filter values (including ones not visible on the visual bar) are applied to the main content area when visual filter mode is active.

LANGUAGE: JavaScript (pseudo-code template)

CODE:
```javascript
// controller.js (pseudo-code template)
// Use your framework's event handling to toggle filter modes.
// Replace getAnalyticalListPageControl and internal API names with actual component methods.

function toggleFilterMode(mode) {
  // mode: "visual" or "compact"
  const alp = getAnalyticalListPageControl(); // placeholder
  if (!alp) return;

  // PSEUDO: request the ALP to switch filter mode.
  // Replace with the real ALP API or trigger the UI-level control change.
  alp.setFilterMode && alp.setFilterMode(mode);
  // ALP runtime will synchronize values between visual and compact filters automatically.
}
```

STEP: 4 — Visual filter chart customization (OData V2 specifics)

DESCRIPTION: In visual filter mode (OData V2), end users can change chart type, sort order, and measure. Supported basic chart types are: bar, donut, and line. Provide a mapping of allowed chart types in your UI or config to limit/enable choices.

LANGUAGE: JSON (chart type config template)

CODE:
```json
// visual-filter-chart-config.json (template)
{
  "visualFilter": {
    "allowedChartTypes": ["bar", "donut", "line"],
    "defaultChartType": "bar",
    "allowMeasureSwitch": true,
    "allowSortChange": true
  }
}
```

STEP: 5 — Adapt Filters (runtime personalization)

DESCRIPTION: Users customize which filter fields or visual filter charts appear on the filter bar using the Adapt Filters option in the ALP header. The selection count shown in the filter bar reflects the number of fields selected, not the number of values set within a field. The count also includes filters set from the filter dialog that are not visible on the filter bar.

LANGUAGE: Text (usage)

CODE:
```text
// Runtime instruction (no code): Use the header action "Adapt Filters (<number>)"
// - Opens the filter personalization dialog.
// - Select/deselect fields and charts to appear on compact/visual filter bars.
// - Save personalization as user-specific variant if variants are enabled.
```

STEP: 6 — Related files and documentation links

DESCRIPTION: Preserve helpful internal doc links and where to find related configuration docs.

LANGUAGE: Text (links)

CODE:
```text
Related documentation files:
- Configuring the Title Area: configuring-the-title-area-ebdb5da.md
- Managing Variants: managing-variants-8ce658e.md
- Enhancing ValueList Annotations for Visual Filters: enhancing-valuelist-annotations-for-visual-filters-16d43eb.md

Place annotation files typically under:
- webapp/annotations/annotations.xml
- backend service metadata: $metadata (OData)
- ABAP CDS: annotation sections in the CDS view definition
```

--------------------------------

**TITLE**: Configure Semantic Coloring for OVP Column Chart Cards Using DataPoint Threshold Values

**INTRODUCTION**: This guide shows how to enable semantic coloring for Fiori overview (OVP) column chart cards by attaching DataPoint threshold values to the measure used in the card. It includes example annotations (CDS and XML) and TypeScript pseudocode to compute semantic colors based on ThresholdValues.* fields and ImprovementDirection. Use a single measure per chart for predictable legends.

**TAGS**: fiori-elements-framework, ovp, semantic-coloring, datapoint, annotations, thresholds, CDS, XML, TypeScript

**STEP**: 1 — Add DataPoint annotation for the measure (CDS example)

**DESCRIPTION**: Add a UI.DataPoint annotation to the measure in your CDS entity exposing the measure. Include ThresholdValues fields (DeviationRangeLowValue, ToleranceRangeLowValue, ToleranceRangeHighValue, DeviationRangeHighValue) and an ImprovementDirection (#Target, #Maximize, #Minimize). Reference the threshold properties as paths to numeric properties in the entity.

**LANGUAGE**: CDS

**CODE**:
```cds
entity SalesFact {
  key ID : UUID;
  Revenue : Decimal(15,2);
  Revenue_Target : Decimal(15,2);
  // threshold properties exposed in the entity:
  Revenue_DeviationRangeLowValue  : Decimal(15,2);
  Revenue_ToleranceRangeLowValue  : Decimal(15,2);
  Revenue_ToleranceRangeHighValue : Decimal(15,2);
  Revenue_DeviationRangeHighValue : Decimal(15,2);

  // UI annotation for semantic coloring
  @UI.dataPoint: {
    value: 'Revenue',
    targetValue: 'Revenue_Target',
    // improvementDirection: #Target | #Maximize | #Minimize
    criticalityCalculation: {
      improvementDirection: #Target,
      // reference the threshold properties by path
      deviationRangeLowValue: 'Revenue_DeviationRangeLowValue',
      toleranceRangeLowValue: 'Revenue_ToleranceRangeLowValue',
      toleranceRangeHighValue: 'Revenue_ToleranceRangeHighValue',
      deviationRangeHighValue: 'Revenue_DeviationRangeHighValue'
    }
  }
}
```

**STEP**: 2 — Add DataPoint annotation for the measure (OData XML/EDMX example)

**DESCRIPTION**: If you annotate in XML/EDMX metadata, add a UI.DataPoint record that points the Value and threshold properties to the corresponding entity properties. Include ImprovementDirection as an enum member. The example below uses placeholders for exact vocabulary names; replace paths and enum members with the correct vocabulary values in your metadata file.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="Namespace.SalesFact">
  <Annotation Term="UI.DataPoint" Qualifier="RevenueDP">
    <Record>
      <PropertyValue Property="Value" Path="Revenue" />
      <PropertyValue Property="TargetValue" Path="Revenue_Target" />
      <PropertyValue Property="CriticalityCalculation">
        <Record>
          <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Target" />
          <PropertyValue Property="DeviationRangeLowValue" Path="Revenue_DeviationRangeLowValue" />
          <PropertyValue Property="ToleranceRangeLowValue" Path="Revenue_ToleranceRangeLowValue" />
          <PropertyValue Property="ToleranceRangeHighValue" Path="Revenue_ToleranceRangeHighValue" />
          <PropertyValue Property="DeviationRangeHighValue" Path="Revenue_DeviationRangeHighValue" />
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 3 — Expose threshold fields in backend/service model

**DESCRIPTION**: Ensure the entity exposes numeric properties corresponding to each ThresholdValues.* name used in the annotation. These values are used by the UI to compute semantic colors.

**LANGUAGE**: JSON (example service payload / metadata fields)

**CODE**:
```json
{
  "SalesFact": {
    "ID": "uuid",
    "Revenue": 12345.67,
    "Revenue_Target": 12000.00,
    "Revenue_DeviationRangeLowValue": 9000.00,
    "Revenue_ToleranceRangeLowValue": 11000.00,
    "Revenue_ToleranceRangeHighValue": 13000.00,
    "Revenue_DeviationRangeHighValue": 15000.00
  }
}
```

**STEP**: 4 — Semantic color decision logic (TypeScript pseudocode)

**DESCRIPTION**: Implement or verify the UI logic that maps measure values to semantic color categories using ImprovementDirection and threshold values. This pseudocode follows the tables in the documentation: Target, Maximizing, Minimizing measures. Output categories: 'Negative', 'Critical', 'Positive', 'Neutral'. Use strictly one measure per chart for meaningful legends.

**LANGUAGE**: TypeScript

**CODE**:
```typescript
type ImprovementDirection = 'Target' | 'Maximize' | 'Minimize';
type Semantic = 'Negative' | 'Critical' | 'Positive' | 'Neutral';

interface ThresholdValues {
  DeviationRangeLowValue: number;
  ToleranceRangeLowValue: number;
  ToleranceRangeHighValue: number;
  DeviationRangeHighValue: number;
}

function getSemanticForTargetMeasure(value: number, t: ThresholdValues): Semantic {
  // Follow the "Target Measure" table logic
  if (value >= t.DeviationRangeLowValue && value < t.ToleranceRangeLowValue) return 'Critical'; // Negative -> Critical
  if (value >= t.ToleranceRangeLowValue && value <= t.ToleranceRangeHighValue) return 'Positive'; // Critical -> Positive
  if (value > t.ToleranceRangeHighValue && value <= t.DeviationRangeHighValue) return 'Critical'; // Positive -> Critical
  if (value > t.DeviationRangeHighValue) return 'Negative'; // Critical -> Negative
  return 'Neutral';
}

function getSemanticForMaximizeMeasure(value: number, t: ThresholdValues): Semantic {
  // Follow the "Maximizing Measure" table logic
  if (value >= t.DeviationRangeLowValue && value < t.ToleranceRangeLowValue) return 'Critical'; // Negative -> Critical
  if (value >= t.ToleranceRangeLowValue) return 'Positive'; // Critical -> Positive
  return 'Neutral';
}

function getSemanticForMinimizeMeasure(value: number, t: ThresholdValues): Semantic {
  // Follow the "Minimizing Measure" table logic
  if (value > t.ToleranceRangeHighValue && value <= t.DeviationRangeHighValue) return 'Critical'; // Positive -> Critical
  if (value > t.DeviationRangeHighValue) return 'Negative'; // Critical -> Negative
  return 'Neutral';
}

function getSemanticColor(value: number, t: ThresholdValues, dir: ImprovementDirection): Semantic {
  switch (dir) {
    case 'Target': return getSemanticForTargetMeasure(value, t);
    case 'Maximize': return getSemanticForMaximizeMeasure(value, t);
    case 'Minimize': return getSemanticForMinimizeMeasure(value, t);
    default: return 'Neutral';
  }
}
```

**STEP**: 5 — UX/Legend behavior and recommendations

**DESCRIPTION**: Implementation notes for charts:
- Prefer a single measure in the chart to get clear semantic legend entries showing threshold values.
- If multiple measures each have DataPoint threshold annotations, each will be colored based on its own thresholds; the chart legend becomes less meaningful.
- If only some measures define thresholds, those measures get semantic colors; measures without valid threshold annotations render in black.
- The UI displays the threshold values in the legend when semantic coloring is applied to a single measure.

**LANGUAGE**: Plain text

**CODE**:
```text
Recommendations:
- Configure one measure per analytic card when you need explicit legend/threshold display.
- Ensure the entity/service exposes numeric fields used in ThresholdValues.* paths.
- Use ImprovementDirection = Target | Maximize | Minimize per measure semantics.
```
--------------------------------

**TITLE**: Column Chart Card (OVP / Fiori Elements) — Annotation and Manifest Examples

**INTRODUCTION**: This guide shows how to implement a Column Chart Card for Fiori Elements / Overview Page (OVP). It includes the necessary OData annotation (XML) that defines a column chart and the manifest.json card configuration that binds the card to the annotation. Use these examples to create a column chart that displays measures as columns and dimensions on the x-axis.

**TAGS**: fiori-elements, ovp, column-chart, annotations, ui.chart, manifest.json, odata, sapui5

**STEP**: 1 — Add Chart Annotation to OData Service (XML)

**DESCRIPTION**: Add a com.sap.vocabularies.UI.v1.Chart annotation for the target entity type in your service metadata. Define ChartType as Column, list Measures (each measure becomes a separate column) and at least one Dimension (used on the x-axis). The example below defines a chart named ProductSales with two measures and one dimension.

Important rules to follow:
- Column charts require at least one measure and one dimension.
- The number of displayed columns equals the number of measures in the annotation.
- Every measure is represented as a separate column regardless of measure roles.
- Every dimension is added to the axis (x-axis) regardless of role.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: metadata.xml (or annotations.xml / edmx annotations section) -->
<Annotations Target="MyService.ProductSalesEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.Chart" Qualifier="ProductSales">
    <Record>
      <!-- Title shown on the card -->
      <PropertyValue Property="Title" String="Product Sales by Year"/>

      <!-- Chart type: Column -->
      <PropertyValue Property="ChartType" EnumMember="com.sap.vocabularies.UI.v1.ChartType/Column"/>

      <!-- Measures: each PropertyPath becomes one column in the chart -->
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>SalesAmount</PropertyPath>
          <PropertyPath>UnitsSold</PropertyPath>
        </Collection>
      </PropertyValue>

      <!-- Dimensions: values shown on the x-axis (at least one required) -->
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>FiscalYear</PropertyPath>
        </Collection>
      </PropertyValue>

      <!-- Optional: set presentation formatting or sort order if supported -->
      <!-- <PropertyValue Property="SortOrder"> ... </PropertyValue> -->
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 2 — Bind Annotation to OVP Card in manifest.json

**DESCRIPTION**: Configure the Overview Page card in manifest.json to use the chart annotation. The card template for charts is typically sap.ovp.cards.charts (OVP). Point annotationPath to the qualified Chart annotation you created (use the same qualifier). Set entitySet to the OData entity set for the chart.

Adjust file path and keys to match your project structure.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "columnChartCard": {
        "model": "ovpCard",
        "template": "sap.ovp.cards.charts",
        "settings": {
          "title": "Product Sales (Column Chart)",
          "subTitle": "Sales by Fiscal Year",
          "entitySet": "ProductSalesSet",
          "annotationPath": "com.sap.vocabularies.UI.v1.Chart#ProductSales"
        }
      }
    }
  }
}
```

**STEP**: 3 — Verify Measures and Dimensions in OData Model (Optional examples)

**DESCRIPTION**: Ensure the properties referenced as Measure and Dimension exist in the service entity and expose correct numeric / key types. Example stubs below show typical property definitions in OData metadata (EDMX snippet) and a CDS-style example for ABAP CDS.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- EDMX entity type snippet (metadata.xml) -->
<EntityType Name="ProductSalesEntityType">
  <Key>
    <PropertyRef Name="SalesID"/>
  </Key>
  <Property Name="SalesID" Type="Edm.String" Nullable="false"/>
  <Property Name="FiscalYear" Type="Edm.String"/>
  <Property Name="SalesAmount" Type="Edm.Decimal" Precision="16" Scale="2"/>
  <Property Name="UnitsSold" Type="Edm.Int32"/>
</EntityType>
```

**LANGUAGE**: CDS

**CODE**:
```sql
// Example ABAP CDS view snippet (for services using ABAP CDS)
@AbapCatalog.sqlViewName: 'ZV_PRODUCT_SALES'
@AccessControl.authorizationCheck: #NOT_REQUIRED
define view Z_ProductSales
  as select from some_table
{
  key SalesID,
  FiscalYear,
  SalesAmount,
  UnitsSold
}
```

**STEP**: 4 — Notes and Best Practices

**DESCRIPTION**: Quick actionable reminders for implementation:
- Always provide at least one measure and one dimension in the Chart annotation.
- To show multiple columns, add multiple PropertyPath entries under Measures.
- Dimensions are placed on the x-axis; if you need multiple dimension levels, provide multiple PropertyPath entries under Dimensions (rendering may depend on the UI implementation).
- If annotation qualifiers are used, reference them in manifest annotationPath using the format: com.sap.vocabularies.UI.v1.Chart#QualifierName

**LANGUAGE**: JSON

**CODE**:
```json
// Example: reference without qualifier (if annotation not qualified)
"annotationPath": "com.sap.vocabularies.UI.v1.Chart"

// Example: reference with qualifier (recommended for multiple charts)
"annotationPath": "com.sap.vocabularies.UI.v1.Chart#ProductSales"
```
--------------------------------

**TITLE**: Column Micro Chart - UI.Chart and UI.DataPoint Annotations

**INTRODUCTION**: Instructions and code-ready examples for defining a Column Micro Chart in Fiori Elements using UI.Chart and UI.DataPoint annotations. Includes XML annotation, ABAP CDS, and CAP CDS examples for measures, dimensions, measure attributes, and semantic coloring.

**TAGS**: fiori-elements-framework, UI.Chart, UI.DataPoint, Column, ColumnMicroChart, annotations, CDS, XML, ABAP

**STEP**: 1 - UI.Chart (XML annotation)

**DESCRIPTION**: Add a UI.Chart annotation in the OData annotation XML to define a Column chart. The annotation sets Title and Description, uses ChartType = Column, declares Measures and Dimensions, and links MeasureAttributes to a UI.DataPoint by qualifier (@UI.DataPoint#Width).

**LANGUAGE**: XML

**CODE**:
```XML
<Annotation Term="UI.Chart" Qualifier="SpecificationWidthColumnChart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Product Width Specification Column Chart"/>
        <PropertyValue Property="Description" String="Describe Column Chart"/>
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>Width</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>Day</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="Width"/>
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Width"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 2 - UI.Chart (ABAP CDS annotation)

**DESCRIPTION**: Add the UI.Chart annotation block in an ABAP CDS view. Use chartType #COLUMN, list measures and dimensions and set measureAttributes to reference the measure and role; include qualifier to match UI annotation usage.

**LANGUAGE**: ABAP CDS

**CODE**:
```ABAP CDS
@UI.Chart: [
  {
    title: 'Product Width Specification Column Chart',
    description: 'Describe Column Chart',
    chartType: #COLUMN,
    measures: [
      'WIDTH'
    ],
    dimensions: [
      'DAY'
    ],
    measureAttributes: [
      {
        measure: 'Width',
        role: #AXIS_1,
        asDataPoint: true
      }
    ],
    qualifier: 'SpecificationWidthColumnChart'
  }
]
annotate view STTA_C_MP_PRODUCT with {

}
```

**STEP**: 3 - UI.Chart (CAP CDS annotation)

**DESCRIPTION**: CAP CDS example defining a UI.Chart with $Type 'UI.ChartDefinitionType'. Use ChartType #Column, list Measures and Dimensions and configure MeasureAttributes to reference a UI.DataPoint by annotation path.

**LANGUAGE**: CDS

**CODE**:
```CDS
UI.Chart #SpecificationWidthColumnChart : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Product Width Specification Column Chart',
    Description : 'Describe Column Chart',
    ChartType : #Column,
    Measures : [
        Width
    ],
    Dimensions : [
        Day
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Width,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#Width',
        }
    ]
}
```

**STEP**: 4 - UI.DataPoint (XML annotation)

**DESCRIPTION**: Define the UI.DataPoint annotation in the OData annotation XML that the chart's MeasureAttributes point to. Provide Value (path), Description, and Criticality (path). Criticality supports semantic coloring.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotation Term="UI.DataPoint" Qualifier="Width">
    <Record>
        <PropertyValue Property="Value" Path="Width"/>
        <PropertyValue Property="Description" String="Column Micro Chart"/>
        <PropertyValue Property="Criticality" Path="criticalityValue"/>
    </Record>
</Annotation>
```

**STEP**: 5 - UI.DataPoint (ABAP CDS annotation)

**DESCRIPTION**: ABAP CDS syntax for a UI.DataPoint annotation referencing the target value element and criticality. This associates semantic coloring and description to the measure used in the chart.

**LANGUAGE**: ABAP CDS

**CODE**:
```ABAP CDS
@UI.dataPoint: {
  description: 'Column Micro Chart',
  targetValueElement: 'Weight',
  criticality: 'criticalityValue'
}
Width;
```

**STEP**: 6 - UI.DataPoint (CAP CDS annotation)

**DESCRIPTION**: CAP CDS style for defining UI.DataPoint qualifier #Width with Value and Criticality. Use the same qualifier referenced by UI.Chart MeasureAttributes (DataPoint : '@UI.DataPoint#Width').

**LANGUAGE**: CDS

**CODE**:
```CDS
UI.DataPoint #Width : {
    Value : Width,
    Description : 'Column Micro Chart',
    Criticality : criticalityValue
}
```

**STEP**: 7 - Semantic coloring rules and mandatory annotation checklist

**DESCRIPTION**: Rules to follow when implementing Column Micro Chart annotations. The Criticality property in UI.DataPoint overrides CriticalityCalculation when both are present. The following annotations/properties are mandatory for Column Micro Chart to render correctly.

- Mandatory items:
  - UI.Chart → ChartType: "Column"
  - UI.Chart → Measures (at least one)
  - UI.Chart → MeasureAttributes → DataPoint (AnnotationPath referencing a UI.DataPoint qualifier)
  - UI.DataPoint → Value (target value path)

- If using CriticalityCalculation for semantic coloring, include:
  - UI.DataPoint → CriticalityCalculation
  - UI.DataPoint → CriticalityCalculation/ImprovementDirection

**LANGUAGE**: text

**CODE**:
```text
Mandatory annotation checklist:
- UI.Chart.ChartType = Column
- UI.Chart.Measures defined (e.g., Width)
- UI.Chart.MeasureAttributes.DataPoint set (e.g., @UI.DataPoint#Width)
- UI.DataPoint.Value provided (path to measure)
- If using CriticalityCalculation, also provide CriticalityCalculation and CriticalityCalculation/ImprovementDirection

Note: UI.DataPoint.Criticality (explicit) overrides UI.DataPoint.CriticalityCalculation.
```
--------------------------------

**TITLE**: Combination Chart Card — XML / ABAP CDS / CAP CDS Annotation Examples

**INTRODUCTION**: This document explains how to configure a Combination Chart Card (column + line) for Fiori Elements using UI.Chart annotations. It includes the required rules and three ready-to-use annotation examples (XML, ABAP CDS, CAP CDS). Use these snippets in your annotation files or CDS views to render a combination chart. Key constraints and recommended practices are included.

**TAGS**: fiori-elements-framework, combination-chart, chart-card, annotations, UI.Chart, CDS, ABAP, CAP, XML

**STEP**: 1 — Rules & Requirements (apply before implementing annotations)

**DESCRIPTION**: Action-oriented checklist and technical rules to satisfy when creating a combination chart card:
- Combination chart requires at least two measures. The first measure is rendered as a column, subsequent measures are rendered as lines.
- All measures map to the feed UID value axis. Assign measures to Axis1 (#Axis1 / #AXIS_1) or other axis roles per your visualization needs.
- Provide at least one Dimension with role = Category for the category axis. Prefer only one time-based dimension on the category axis.
- Series-type dimensions are assigned to the feed UID color (rendered as different colored columns/lines per series member).
- Use Qualifier to name the chart annotation and reference it where needed in OVP/cards or other Fiori Elements cards.
- Place XML annotations in your annotations XML file, ABAP CDS annotations in the view definitions or annotation include, and CAP CDS annotations in your service or annotation CDS file.

**LANGUAGE**: text

**CODE**:
```text
# Rules:
- Minimum measures: 2 (first -> column, subsequent -> line)
- At least one dimension with Role=#Category
- Prefer only one time-based dimension on the category axis
- All measures map to value axis (UID feed)
- Use a qualifier like "Eval_by_Currency_Combination" to reference the chart
```

**STEP**: 2 — XML Annotation Example

**DESCRIPTION**: Add this annotation into your OData annotations XML (e.g., annotations.xml). Use the Qualifier to reference the chart in the UI manifest or card definition. This XML config sets chart type to Combination and defines two measures and one category dimension.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Place in annotations.xml (OData annotation file). Qualifier used to reference the chart. -->
<Annotation Term="UI.Chart" Qualifier="Eval_by_Currency_Combination">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Sales and Total Sales" />
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Combination"/>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="sales" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                </Record>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="totalsales" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="DimensionAttributes">
            <Collection>
                <Record Type="UI.ChartDimensionAttributeType">
                    <PropertyValue Property="Dimension" PropertyPath="quarter_1" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 3 — ABAP CDS Annotation Example

**DESCRIPTION**: Use this ABAP CDS annotation block inside your CDS view file or as an annotation include. Replace VIEWNAME with your view and ensure the measure and dimension element names (sales, totalsales, quarter_1) exist in the view. The Qualifier identifies the chart annotation.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Chart: [
  {
    title: 'Sales and Total Sales',
    chartType: #COMBINATION,
    measureAttributes: [
      {
        measure: 'sales',
        role: #AXIS_1
      },
      {
        measure: 'totalsales',
        role: #AXIS_1
      }
    ],
    dimensionAttributes: [
      {
        dimension: 'quarter_1',
        role: #CATEGORY
      }
    ],
    qualifier: 'Eval_by_Currency_Combination'
  }
]
annotate view VIEWNAME with { }
```

**STEP**: 4 — CAP CDS Annotation Example

**DESCRIPTION**: Insert this UI.Chart annotation into a CAP CDS annotation file (e.g., in the service or annotations file). Ensure property names match your entity definitions (sales, totalsales, quarter_1). The Qualifier #Eval_by_Currency_Combination is used to reference this chart definition.

**LANGUAGE**: CDS

**CODE**:
```cds
UI.Chart #Eval_by_Currency_Combination : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Sales and Total Sales',
    ChartType : #Combination,
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : sales,
            Role : #Axis1
        },
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : totalsales,
            Role : #Axis1
        }
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : quarter_1,
            Role : #Category
        }
    ]
}
```

**STEP**: 5 — Visual Reference (optional)

**DESCRIPTION**: Example screenshot path for documentation. Use it in docs pages or design specs to show expected result.

**LANGUAGE**: text

**CODE**:
```text
Image: ../01_Whats-New/images/Whats_New_140_OVP_Combination_Chart_55139a9.png
```
--------------------------------

**TITLE**: Comparison Micro Chart — UI.Chart and UI.DataPoint Annotations for SAP Fiori Elements (OData V4)

**INTRODUCTION**: Practical reference with complete, ready-to-use annotation examples (XML, ABAP CDS, CAP CDS) to implement a Comparison Micro Chart in SAP Fiori elements for OData V4. Includes constraints, required annotations, and how to configure value/text display, criticality (semantic coloring), and min/max values.

**TAGS**: fiori-elements-framework, ODataV4, ComparisonMicroChart, UI.Chart, UI.DataPoint, annotations, XML, ABAP_CDS, CAP_CDS

STEP: 1 — Key constraints and behavior
DESCRIPTION: List the essential constraints and chart behavior that must be enforced when generating annotations and backend models.
LANGUAGE: Plain
CODE:
```
- Applicable only to SAP Fiori elements for OData V4.
- Chart shows only the first three values returned from the backend.
- Dimensions and Measures cannot originate from the same entity; they must come from a 1:n navigation entity (e.g., SalesOrder -> SalesOrderItem).
- Ensure unit of measure is consistent across all data points.
- Semantic coloring supported only via UI.DataPoint -> Criticality.
- Display rules:
  - If UI.DataPoint.Value has an associated @Common.Text annotation, the TextValue is displayed.
  - Otherwise the raw numeric Value is displayed.
- Mandatory annotations for the Comparison Micro Chart:
  - UI.Chart with ChartType: "Bar"
  - UI.Chart -> Dimensions
  - UI.Chart -> Measures
  - UI.Chart -> MeasureAttributes -> DataPoint (link to a UI.DataPoint qualifier)
  - UI.DataPoint -> Value
```

STEP: 2 — UI.Chart XML Annotation (complete example)
DESCRIPTION: Add the UI.Chart annotation in XML, qualifier "ComparisonPath". This defines a bar chart with a dimension SalesOrderItem, measure NetAmount, and links the measure to a UI.DataPoint qualifier.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Chart" Qualifier="ComparisonPath">
    <Record Type="UI.ChartDefinitionType">
        <!-- Chart type must be Bar for Comparison Micro Chart -->
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bar"/>
        <!-- Optional: subtitle -->
        <PropertyValue Property="Description" String="Testing Comparison Chart"/>
        <!-- Dimension: must be from a 1:n navigation entity (e.g., SalesOrderItem) -->
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>SalesOrderItem</PropertyPath>
            </Collection>
        </PropertyValue>
        <!-- Measure attributes: map measure to DataPoint qualifier -->
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="NetAmount"/>
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#ComparisonPath"/>
                </Record>
            </Collection>
        </PropertyValue>
        <!-- Measures included in the chart -->
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>NetAmount</PropertyPath>
            </Collection>
        </PropertyValue>
        <!-- Title shown above the chart -->
        <PropertyValue Property="Title" String="Items Comparison Chart"/>
    </Record>
</Annotation>
```

STEP: 3 — UI.Chart ABAP CDS Annotation (complete example)
DESCRIPTION: Equivalent ABAP CDS annotation for a view. Use chartType #BAR, dimension SALESORDERITEM, measure NETAMOUNT, and mark measure asDataPoint to link to a data point qualifier.
LANGUAGE: ABAP CDS
CODE:
```
@UI.Chart: [
  {
    chartType: #BAR,
    description: 'Testing Comparison Chart',
    dimensions: [
      'SALESORDERITEM'
    ],
    measureAttributes: [
      {
        measure: 'NetAmount',
        role: #AXIS_1,
        asDataPoint: true         // links to UI.DataPoint qualifier NetAmount or as specified
      }
    ],
    measures: [
      'NETAMOUNT'
    ],
    title: 'Items Comparison Chart',
    qualifier: 'ComparisonPath'
  }
]
annotate view STTA_C_MP_PRODUCT with {
  // Additional annotations or mappings as required
}
```

STEP: 4 — UI.Chart CAP CDS Annotation (complete example)
DESCRIPTION: CAP CDS UI.Chart definition. Provide ChartType, Dimensions, MeasureAttributes referencing a UI.DataPoint qualifier, Measures, and Title.
LANGUAGE: CDS
CODE:
```
UI.Chart #ComparisonPath : {
    $Type : 'UI.ChartDefinitionType',
    ChartType : #Bar,
    Description : 'Testing Comparison Chart',
    Dimensions : [
        SalesOrderItem
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : NetAmount,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#ComparisonPath'
        },
    ],
    Measures : [
        NetAmount
    ],
    Title : 'Items Comparison Chart'
}
```

STEP: 5 — UI.DataPoint XML Annotation (complete example)
DESCRIPTION: Define the UI.DataPoint qualifier to supply Value, Criticality, MaximumValue and MinimumValue. This qualifier name should match the one referenced by UI.Chart.MeasureAttributes.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="NetAmount">
    <Record Type="UI.DataPointType">
        <!-- Value path shown on the chart (required) -->
        <PropertyValue Property="Value" Path="NetAmount"/>
        <!-- Criticality path used for semantic coloring -->
        <PropertyValue Property="Criticality" Path="Criticality"/>
        <!-- Optional chart scale limits -->
        <PropertyValue Property="MaximumValue" Decimal="100"/>
        <PropertyValue Property="MinimumValue" Decimal="0"/>
    </Record>
</Annotation>
```

STEP: 6 — UI.DataPoint ABAP CDS Annotation (complete example)
DESCRIPTION: ABAP CDS style data point annotation attached to the measure field. Specify criticality and min/max values.
LANGUAGE: ABAP CDS
CODE:
```
@UI.dataPoint: {
  criticality: 'Criticality',
  maximumValue: 100,
  minimumValue: 0
}
NetAmount;
```

STEP: 7 — UI.DataPoint CAP CDS Annotation (complete example)
DESCRIPTION: CAP CDS data point definition using a qualifier name that matches UI.Chart MeasureAttributes DataPoint reference.
LANGUAGE: CDS
CODE:
```
UI.DataPoint #NetAmount : {
    Value       : NetAmount,
    Criticality : Criticality,
    MaximumValue: 100,
    MinimumValue: 0
}
```

STEP: 8 — Display value precedence and semantic coloring
DESCRIPTION: Implementation notes to ensure generated code uses the correct display value and criticality for coloring.
LANGUAGE: Plain
CODE:
```
- Value vs TextValue:
  - If the DataPoint.Value property has an associated @com.sap.vocabularies.Common.v1.Text annotation on the measure property,
    the chart will display the textual value (TextValue) instead of the numeric Value.
  - If no @Common.Text is provided, the numeric Value is displayed.
- Semantic coloring:
  - Only UI.DataPoint.Criticality is supported for semantic coloring in Comparison Micro Chart.
  - Criticality must be provided as a path (e.g., "Criticality") in the DataPoint record.
- Ensure unit consistency across all data points (same currency or UoM).
```

STEP: 9 — Quick checklist for code generation
DESCRIPTION: Checklist to validate annotations before deploying the chart.
LANGUAGE: Plain
CODE:
```
- Verify OData is V4.
- Confirm Dimensions come from a 1:n navigation entity (not same entity as Measures).
- UI.Chart.ChartType == Bar.
- UI.Chart.Dimensions includes the navigation key property (e.g., SalesOrderItem).
- UI.Chart.Measures includes the measure property (e.g., NetAmount).
- UI.Chart.MeasureAttributes includes DataPoint linked to a UI.DataPoint qualifier.
- UI.DataPoint.Value is present and paths match measure names.
- UI.DataPoint.Criticality provided if semantic coloring required.
- If using @Common.Text on measure, ensure text content is appropriate for display.
- Test backend response (only first three items will be shown).
```
--------------------------------

**TITLE**: Configure OData EntitySet with Input Parameters (SelectionVariant) for Fiori Elements / OVP Cards

**INTRODUCTION**: This document shows how to configure an OData EntitySet that requires input parameters, annotate a SelectionVariant with fixed parameter values, expose a parameters EntityType, and wire the SelectionVariant into an OVP card via manifest.json. Includes XML (EDMX) metadata, annotation XML, CAP CDS annotation, and manifest.json examples. Use these steps to make cards query the primary EntitySet using parameter values.

**TAGS**: fiori-elements, ovp, selectionvariant, parameters, odata, annotation, manifest, CDS, EDmx

**STEP**: 1 — Define OData metadata: EntityType for data + parameters EntityType
**DESCRIPTION**: Add the primary aggregate EntityType (SalesShareType) and a parameters EntityType (SalesShareParametersType) with sap:semantics="parameters". Define the association between them and the EntityContainer with both EntitySets. Note: SalesShareParameters is marked sap:addressable="false".
**LANGUAGE**: XML
**CODE**:
```xml
<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<edmx:Edmx Version="1.0" xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx" xmlns:sap="http://www.sap.com/Protocols/SAPData">
    <edmx:DataServices xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" m:DataServiceVersion="2.0">
        <Schema Namespace="sap.smartbusinessdemo.services" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices" xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" xmlns="http://schemas.microsoft.com/ado/2008/09/edm">
            <!-- Aggregate EntityType containing OData data -->
            <EntityType Name="SalesShareType" sap:semantics="aggregate">
                <Key>
                    <PropertyRef Name="ID" />
                </Key>
                <Property Name="ID" Type="Edm.String" Nullable="false" MaxLength="2147483647" sap:filterable="false" />
                <Property Name="Country" Type="Edm.String" MaxLength="3" sap:label="Country" sap:aggregation-role="dimension" />
                <Property Name="Region" Type="Edm.String" MaxLength="4" sap:label="Region" sap:aggregation-role="dimension" />
                <Property Name="ProductID" Type="Edm.String" MaxLength="10" sap:label="Product ID" sap:aggregation-role="dimension" />
                <Property Name="Currency" Type="Edm.String" MaxLength="5" sap:label="Currency" sap:aggregation-role="dimension" />
                <Property Name="Product" Type="Edm.String" MaxLength="1024" sap:label="Product" sap:aggregation-role="dimension" />
                <Property Name="SupplierCompany" Type="Edm.String" MaxLength="80" sap:label="Supplier Company" sap:aggregation-role="dimension" />
                <Property Name="BuyerCompany" Type="Edm.String" MaxLength="80" sap:label="Buyer Company" sap:aggregation-role="dimension" />
                <Property Name="Year" Type="Edm.String" MaxLength="4" sap:label="Year" sap:aggregation-role="dimension" />
                <Property Name="Quarter" Type="Edm.String" MaxLength="2" sap:label="Quarter" sap:aggregation-role="dimension" />
                <Property Name="Month" Type="Edm.String" MaxLength="2" sap:label="Month" sap:aggregation-role="dimension" />
                <Property Name="TotalSales_CURRENCY" Type="Edm.String" MaxLength="5" sap:semantics="currency-code" />
                <Property Name="Sales_CURRENCY" Type="Edm.String" MaxLength="5" sap:semantics="currency-code" />
                <Property Name="TotalSales" Type="Edm.Decimal" Precision="15" Scale="2" sap:filterable="false" sap:label="Total Sales" sap:aggregation-role="measure" sap:unit="TotalSales_CURRENCY" />
                <Property Name="Sales" Type="Edm.Decimal" Precision="15" Scale="2" sap:filterable="false" sap:label="Sales" sap:aggregation-role="measure" sap:unit="Sales_CURRENCY" />
                <Property Name="SalesShare" Type="Edm.Decimal" Precision="12" Scale="5" sap:filterable="false" sap:label="Sales Share" sap:aggregation-role="measure" />
            </EntityType>

            <!-- Parameters EntityType with sap:semantics="parameters" -->
            <EntityType Name="SalesShareParametersType" sap:semantics="parameters">
                <Key>
                    <PropertyRef Name="P_Currency"/>
                    <PropertyRef Name="P_Country"/>
                </Key>
                <Property Name="P_Currency" Type="Edm.String" Nullable="false" MaxLength="5" sap:label="Currency" sap:parameter="mandatory"/>
                <Property Name="P_Country" Type="Edm.String" Nullable="false" DefaultValue="3" MaxLength="20" sap:label="CountryCode" sap:parameter="mandatory"/>
                <NavigationProperty Name="Results" Relationship="sap.smartbusinessdemo.services.SalesShareParameters_SalesShareType" FromRole="SalesShareParametersPrincipal" ToRole="SalesShareDependent"/>
            </EntityType>

            <!-- Association between parameters and the main result EntityType -->
            <Association Name="SalesShareParameters_SalesShareType">
                <End Type="sap.smartbusinessdemo.services.SalesShareParametersType" Role="SalesShareParametersPrincipal" Multiplicity="*"/>
                <End Type="sap.smartbusinessdemo.services.SalesShareType" Role="SalesShareDependent" Multiplicity="*"/>
            </Association>

            <!-- EntityContainer with both EntitySets; parameters EntitySet is not addressable -->
            <EntityContainer Name="SalesShare" m:IsDefaultEntityContainer="true">
                <EntitySet Name="SalesShare" EntityType="sap.smartbusinessdemo.services.SalesShareType"/>
                <EntitySet Name="SalesShareParameters" EntityType="sap.smartbusinessdemo.services.SalesShareParametersType" sap:addressable="false"/>
                <AssociationSet Name="SalesShareParameters_SalesShare" Association="sap.smartbusinessdemo.services.SalesShareParameters_SalesShareType">
                    <End Role="SalesShareParametersPrincipal" EntitySet="SalesShareParameters"/>
                    <End Role="SalesShareDependent" EntitySet="SalesShare"/>
                </AssociationSet>
            </EntityContainer>
        </Schema>
    </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 2 — Annotate SelectionVariant with fixed input parameters (XML annotations)
**DESCRIPTION**: Create an annotations XML (or use your service-specific annotations file) that targets the primary EntityType and provides a SelectionVariant annotated with a qualifier (e.g., "#params"). The Parameters collection must reference parameter property names (PropertyPath) and their literal values (PropertyValue String). Use qualifier to reference from manifest (selectionAnnotationPath).
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="sap.smartbusinessdemo.services.SalesShareType">
    <Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant" Qualifier="params">
        <Record>
            <PropertyValue Property="SelectOptions">
                <Collection>
                    <!-- add SelectOptions if needed -->
                </Collection>
            </PropertyValue>
            <PropertyValue Property="Parameters">
                <Collection>
                    <Record Type="com.sap.vocabularies.UI.v1.Parameter">
                        <PropertyValue Property="PropertyName" PropertyPath="P_Currency" />
                        <PropertyValue Property="PropertyValue" String="EUR" />
                    </Record>
                    <Record Type="com.sap.vocabularies.UI.v1.Parameter">
                        <PropertyValue Property="PropertyName" PropertyPath="P_Country" />
                        <PropertyValue Property="PropertyValue" String="IN" />
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
    ...
</Annotations>
```

**STEP**: 3 — Annotate SelectionVariant using CAP CDS (alternative to XML)
**DESCRIPTION**: If using CAP (CDS), add UI.SelectionVariant annotation with the same qualifier and parameter list. Each parameter must be of $Type 'UI.Parameter' and reference the parameter property name used in the parameters EntityType.
**LANGUAGE**: CDS
**CODE**:
```sql
annotate sap.smartbusinessdemo.services.SalesShareType @(
  UI.SelectionVariant #params : {
    SelectOptions : [
    ],
    Parameters : [
        {
            $Type : 'UI.Parameter',
            PropertyName : P_Currency,
            PropertyValue : 'EUR'
        },
        {
            $Type : 'UI.Parameter',
            PropertyName : P_Country,
            PropertyValue : 'IN'
        }
    ]
  }
);
```

**STEP**: 4 — Wire SelectionVariant into OVP card configuration (manifest.json)
**DESCRIPTION**: In the UI application manifest.json, configure the OVP card to use the SelectionVariant qualifier by setting selectionAnnotationPath to "com.sap.vocabularies.UI.v1.SelectionVariant#params" and entitySet to the main EntitySet ("SalesShare"). Set the appropriate model name for your service (e.g., "salesShare").
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card04": {
        "model": "salesShare",
        "template": "sap.ovp.cards.list",
        "settings": {
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#params",
          "entitySet": "SalesShare"
        }
      }
    }
  }
}
```

**STEP**: 5 — Configure EntityType with optional input parameter (optional parameters behavior)
**DESCRIPTION**: If the parameters EntityType contains an optional parameter, you can omit it from the SelectionVariant. By default, if an optional parameter is not provided in the SelectionVariant, its value defaults to an empty string (only supported for Edm.String). Define optional parameters with sap:parameter="optional".
**LANGUAGE**: XML
**CODE**:
```xml
<EntityType Name="SalesShareParametersType" sap:semantics="parameters">
    <Key>
        <PropertyRef Name="P_Currency"/>
        <PropertyRef Name="P_Country"/>
        <PropertyRef Name="P_Optional"/>
    </Key>
    <Property Name="P_Currency" Type="Edm.String" Nullable="false" MaxLength="5" sap:label="Currency" sap:parameter="mandatory"/>
    <Property Name="P_Country" Type="Edm.String" Nullable="false" DefaultValue="3" MaxLength="20" sap:label="CountryCode" sap:parameter="mandatory"/>
    <Property Name="P_Optional" Type="Edm.String" Nullable="false" MaxLength="5" sap:label="Optional" sap:parameter="optional"/>
    <NavigationProperty Name="Results" Relationship="sap.smartbusinessdemo.services.SalesShareParameters_SalesShareType" FromRole="SalesShareParametersPrincipal" ToRole="SalesShareDependent"/>
</EntityType>
```

**STEP**: 6 — Multi-card analytical parameter behavior (operational note)
**DESCRIPTION**: When multiple cards should support analytical/parameter-based filtering, provide a SelectionVariant per card (unique qualifier). If the global filter bar applies parameter values, each card that has a parameter name matching the filter will receive the applied value. Ensure parameter property names are consistent between annotations and the parameters EntityType.
**LANGUAGE**: JSON
**CODE**:
```json
// Example: multiple manifest card entries, each with its own selectionAnnotationPath
{
  "sap.ovp": {
    "cards": {
      "cardA": {
        "settings": {
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#paramsA",
          "entitySet": "SalesShare"
        }
      },
      "cardB": {
        "settings": {
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#paramsB",
          "entitySet": "SalesShare"
        }
      }
    }
  }
}
```

Notes:
- Use the SelectionVariant qualifier (e.g., "#params") consistently between annotations and manifest selectionAnnotationPath.
- The parameters EntitySet is typically sap:addressable="false" and used only for specifying input parameters to query the primary EntitySet.
- Optional parameters currently supported only for Edm.String; missing optional parameters default to an empty string.
--------------------------------

**TITLE**: Analytical List Page (ALP) App Extensions — Practical Configuration Snippets

**INTRODUCTION**: Quick, code-focused reference for adding common ALP app extensions in SAP Fiori elements (OData V2). Includes manifest.json snippets, an extension controller template, and the recommended way to invoke the Fiori Elements refresh API from your extension code. Use these snippets as drop-in templates and adapt IDs/namespaces/entity sets to your app.

**TAGS**: sap-fiori, fiori-elements, analytical-list-page, ALP, ODataV2, manifest.json, controllerExtensions, custom-actions, refreshBinding

**STEP**: 1 — Applicability / Scope

**DESCRIPTION**: Note when to apply these configurations.

**LANGUAGE**: Text

**CODE**:
```text
Applicability: These extension patterns are applicable only to SAP Fiori elements for OData V2 (Analytical List Page floorplan).
Files referenced in examples:
- webapp/manifest.json
- webapp/controller/AnalyticalListPageExtension.controller.js
- webapp/Component.js (only when you need to implement or reference component-level helpers)
```

**STEP**: 2 — Register a controller extension in manifest.json

**DESCRIPTION**: Add a controller extension mapping in webapp/manifest.json to point the standard ALP controller to your extension controller. Replace "my.app.namespace.controller.AnalyticalListPageExtension" with your controller module name.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "controllerExtensions": {
      "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
        "controllerName": "my.app.namespace.controller.AnalyticalListPageExtension"
      }
    }
  }
}
```

File: webapp/manifest.json — insert or merge into existing sap.ui5 section.

**STEP**: 3 — Create the extension controller file

**DESCRIPTION**: Implement the extension controller that receives lifecycle hooks and custom handlers. Use getOwnerComponent().refreshBinding() (safe-guarded) to refresh ALP bindings (header, filter, content areas). Put this file under webapp/controller.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/controller/AnalyticalListPageExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";
  return Controller.extend("my.app.namespace.controller.AnalyticalListPageExtension", {
    onInit: function () {
      // Initialization logic
      // e.g., attach handlers or initialize state
    },

    // Example custom action handler bound to a UI button or manifest-defined action
    onCustomActionPress: function (oEvent) {
      // Implement your custom action logic here
      // When done, refresh ALP bindings to pick up changed data/state
      var oComponent = this.getOwnerComponent && this.getOwnerComponent();
      if (oComponent && typeof oComponent.refreshBinding === "function") {
        oComponent.refreshBinding();
      }
    },

    // Example: call refresh after variant load or filter change
    onAfterVariantLoaded: function () {
      var oComponent = this.getOwnerComponent && this.getOwnerComponent();
      if (oComponent && typeof oComponent.refreshBinding === "function") {
        oComponent.refreshBinding();
      }
    }
  });
});
```

**STEP**: 4 — How to call the Refresh API from extensions

**DESCRIPTION**: Always check that the component exposes refreshBinding before calling. Use this pattern in any controller/extension to safely trigger ALP refresh behavior.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Safe call pattern (can be used inside any controller extension method)
var oComponent = this.getOwnerComponent && this.getOwnerComponent();
if (oComponent && typeof oComponent.refreshBinding === "function") {
  // Optionally pass parameters if your app/component implementation requires them
  oComponent.refreshBinding();
}
```

**STEP**: 5 — Define custom actions (chart / table / global) in manifest.json

**DESCRIPTION**: Declare custom actions so they appear in ALP UI (chart, table, or header/toolbars). Place these under sap.ui.generic.app.pages[].component.settings. Adapt "entitySet" and action IDs/texts to your app.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesAnalyticalEntity",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "actions": [
              {
                "id": "Z_GLOBAL_ACTION_Approve",
                "text": "Approve Selected",
                "requiresSelection": true,
                "press": "onCustomActionPress"  // handler name in your extension controller (optional mapping)
              }
            ],
            "chart": {
              "actions": [
                {
                  "id": "Z_CHART_ACTION_Drill",
                  "text": "Drill Into",
                  "requiresSelection": false
                }
              ]
            },
            "table": {
              "actions": [
                {
                  "id": "Z_TABLE_ACTION_Process",
                  "text": "Process rows",
                  "requiresSelection": true
                }
              ]
            }
          }
        }
      }
    ]
  }
}
```

File: webapp/manifest.json — merge under top-level sap.ui.generic.app.

Note: Execution wiring for manifest-declared actions may require the action ID to be handled by the Generic Action framework or by mapping to your controller extension methods — adapt according to your Fiori elements version and app generator wiring.

**STEP**: 6 — Typical file locations & quick checklist

**DESCRIPTION**: Keep standard file locations and checklist when implementing ALP extensions.

**LANGUAGE**: Text

**CODE**:
```text
Recommended file locations:
- webapp/manifest.json           -> add controllerExtensions and actions
- webapp/controller/*.controller.js  -> create extension controller(s)
- webapp/Component.js            -> optional: component-level helpers (refresh wrappers) if needed

Checklist:
- Confirm app is Fiori elements OData V2 (ALP-specific)
- Register controller extension in sap.ui5.controllerExtensions
- Implement extension controller methods and safe refresh calls to getOwnerComponent().refreshBinding()
- Declare custom actions under sap.ui.generic.app.pages[].component.settings
- Test: perform action -> ensure onCustomActionPress runs -> bindings refresh as expected
```

**RELATED**: For more advanced or alternate extension patterns, refer to:
- Extending SAP Fiori Elements-Based Apps
- Smart Table Extensions
- Chart Extensions
- Creating Custom Filters
- Defining Custom Actions
- Adding a Custom Message Strip to List Report and Analytical List Page
--------------------------------

**TITLE**: Configure Card Filters for SAP Fiori Elements Cards

**INTRODUCTION**: Shows how to add server-side filters to Fiori elements cards via the SelectionVariant annotation (XML or CAP CDS) and how to pass client-side filter parameters in the overview page URL. Use SelectionVariant SelectOptions / Ranges to restrict record sets (e.g., numeric ranges). Notes include allowed URL parameter types and the Launchpad currency preference source.

**TAGS**: sap-fiori, fiori-elements, annotations, SelectionVariant, card-filters, CAP, CDS, XML, overview-page, URL-filter

**STEP**: 1 — Add SelectionVariant (XML annotation) to your annotation file

**DESCRIPTION**: Add a SelectionVariant annotation record with SelectOptions to your annotation document (for example: annotations.xml, annotation files under annotations/ or in your OData service metadata annotations). The example below filters the entityset by property TotalSum and returns values between 0 and 8000. You can add multiple Record entries under SelectOptions to combine filters.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Add to your annotation document (e.g., annotations.xml or service annotations) -->
<Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant" Qualifier="bubble">
  <Record>
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record>
          <PropertyValue Property="PropertyName" PropertyPath="TotalSum" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record>
                <PropertyValue Property="Sign"
                  EnumMember="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I" />
                <PropertyValue Property="Option"
                  EnumMember="com.sap.vocabularies.UI.v1.SelectionRangeOptionType/BT" />
                <PropertyValue Property="Low" String="0" />
                <PropertyValue Property="High" String="8000" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 2 — Add SelectionVariant in CAP CDS

**DESCRIPTION**: If using CAP/CDS annotations, add a UI.SelectionVariant with SelectOptions and Ranges in your CDS annotation file (e.g., annotations.cds or within your .cds model). This example implements the same filter (TotalSum between 0 and 8000) using CDS syntax. Multiple filters can be added to the SelectOptions array.

**LANGUAGE**: CDS

**CODE**:
```cds
// Add to your CDS annotation file (e.g., annotations.cds)
using { UI } from '@sap/cds/common';

annotate MyService.MyEntity with {
  // Qualifier 'bubble' matches the usage in card configuration if required
  @UI.SelectionVariant #bubble : {
    SelectOptions : [
      {
        PropertyName : TotalSum,
        Ranges : [
          {
            Sign : #I,   // Include
            Option : #BT, // Between
            Low : '0',
            High : '8000'
          }
        ]
      }
    ]
  };
};
```

**STEP**: 3 — Pass filters via Overview Page URL (client-side)

**DESCRIPTION**: When launching an SAP Fiori overview page (from FLP or another app), append filter parameters in the URL query string using the entity property name as key. Only string or integer values are supported. The filter applies automatically if the property exists in the target entity set.

**LANGUAGE**: PlainText

**CODE**:
```
Example URL:
http://abc#Equipment-overviewPage?EquipmentNumber=123456

Notes:
- Only strings or integers are supported as filter parameter values.
- Property name in the URL must match the entityset property (case-sensitive depending on service).
- Multiple parameters can be appended with & (e.g., ?PropA=1&PropB=XYZ).
```

**STEP**: 4 — Currency display preference

**DESCRIPTION**: Currency display for cards follows the SAP Fiori Launchpad user settings. Use the DisplayCurrency field configured in the application/FLP user settings. No additional annotation is required for Launchpad-driven currency preference; ensure your card data includes currency properties and the Launchpad setting is available.

**LANGUAGE**: PlainText

**CODE**:
```
Behavior:
- The displayed currency type is taken from the SAP Fiori Launchpad user settings (DisplayCurrency).
- To override or control currency display, configure FLP user settings or ensure application reads DisplayCurrency.
```
--------------------------------

**TITLE**: Configuring Card Navigation for SAP Fiori Overview Pages (OVP)

**INTRODUCTION**: This document describes how to configure card navigation in SAP Fiori Overview Pages (OVP). It covers navigation annotation choices, manifest configuration (identificationAnnotationPath, staticParameters), behavior rules, and how to implement custom navigation breakouts via a controller extension (doCustomNavigation). Use the code samples directly in your app descriptor and controller implementations.

**TAGS**: fiori-elements-framework, sap.ovp, navigation, annotations, DataFieldForIntentBasedNavigation, DataFieldWithUrl, identificationAnnotationPath, staticParameters, controller-extension, doCustomNavigation

STEP: Navigation annotations and when to use them

DESCRIPTION: Use annotation terms to configure card navigation. Use DataFieldForIntentBasedNavigation to navigate via Fiori intent (semantic object + action). Use DataFieldWithUrl to navigate to external URLs or to construct specific application routes that are not target mappings. For list/table cards only, you can pass single-record context to the destination by configuring navigation in the com.sap.vocabularies.UI.v1.LineItem term used by the card.

LANGUAGE: Text

CODE:
```text
Annotations to use:
- com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation  -> intent-based (semanticObject + action)
- com.sap.vocabularies.UI.v1.DataFieldWithUrl                 -> external URL or specific app route
- com.sap.vocabularies.UI.v1.Identification                    -> card header identification navigation
- com.sap.vocabularies.UI.v1.LineItem                          -> per-line navigation (only list/table cards can pass single-record context)
Notes:
- If multiple navigation records exist, the first one is used (sorted by ImportanceType and their order).
```

STEP: Configure identificationAnnotationPath and card settings in manifest (sap.ovp)

DESCRIPTION: Set the identificationAnnotationPath (with optional qualifier) and annotationPath for the card inside the "sap.ovp" section of the app descriptor (manifest.json). Example demonstrates a list/card configuration including entitySet, annotationPath, identificationAnnotationPath and card-specific settings.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card04": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.list",
        "settings": {
          "sortBy": "Price",
          "sortOrder": "descending",
          "listFlavor": "bar",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#bar",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#bar",
          "category": "{{card04_category}}",
          "entitySet": "Products"
        }
      }
    }
  }
}
```

STEP: Behavior rules and limitations

DESCRIPTION: Summarize deterministic behavior so code can handle edge cases:
- Only list/table cards can pass the selected single record context; configure navigation in the LineItem term.
- If multiple navigation entries are provided in Identification or LineItem, the first is used. Ordering is determined by com.sap.vocabularies.UI.v1.ImportanceType then entry order.
- For navigation to non-target-mapped application routes, DataFieldWithUrl can be used (OVP may still detect intent-based routes and open in same tab).

LANGUAGE: Text

CODE:
```text
Behavior summary:
- Single-record context passing: only from LineItem (list/table cards).
- Multiple navigation entries: first entry chosen (sort by ImportanceType then input order).
- Use DataFieldWithUrl to build specific routes if target mapping is not available.
```

STEP: Configure controller extension in app descriptor for custom navigation breakouts

DESCRIPTION: To implement custom navigation breakouts (multiple targets from different areas/line items), extend the OVP controller in the app descriptor by adding a controller extension that points to your custom controller.

LANGUAGE: JSON

CODE:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.ovp.app.Main": {
          "controllerName": "my_app.ext.controller.OverViewPageExt"
        }
      }
    }
  }
}
```

STEP: Implement doCustomNavigation in the custom controller

DESCRIPTION: Implement doCustomNavigation(sCardId, oContext, oNavigationEntry) in your controller extension. Input parameters:
- sCardId: string (card id as in manifest)
- oContext: context object from the clicked card (can use oContext.getProperty(oContext.sPath))
- oNavigationEntry: original navigation entry from annotations

Return: either null/undefined to delegate to standard navigation, or an object with string properties:
- type (mandatory): "com.sap.vocabularies.UI.v1.DataFieldWithUrl" OR "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"
- semanticObject (required for DataFieldForIntentBasedNavigation)
- action (required for DataFieldForIntentBasedNavigation)
- url (required for DataFieldWithUrl)
- label (optional)

LANGUAGE: JavaScript

CODE:
```javascript
// Controller: my_app.ext.controller.OverViewPageExt
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function(Controller) {
  "use strict";
  return Controller.extend("my_app.ext.controller.OverViewPageExt", {
    /**
     * sCardId: string
     * oContext: binding context of clicked card item
     * oNavigationEntry: original navigation annotation entry
     * Return an object mimicking navigation annotation (or undefined to use default)
     */
    doCustomNavigation: function (sCardId, oContext, oNavigationEntry) {
      var oCustomNavigationEntry;
      var oEntity = oContext && oContext.getProperty(oContext.sPath);

      // Example: override navigation for card001 when PurchaseOrder matches a value
      if (sCardId === "card001" && oEntity && oEntity.PurchaseOrder === "4500003575") {
        oCustomNavigationEntry = {
          type: "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation",
          semanticObject: "Action",
          action: "toappnavsample2",
          // url is optional for intent-based, but keep empty string if present
          url: "",
          label: ""
        };
      }

      // Return undefined/null to fall back to the annotation-provided navigation
      return oCustomNavigationEntry;
    }
  });
});
```

STEP: Add staticParameters to card settings (manifest.json)

DESCRIPTION: Provide static navigation parameters (key/value pairs) to be included during IntentBasedNavigation from overview page to target application. Place staticParameters in the card settings object in the descriptor.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card01": {
        "model": "Z..._SRV",
        "template": "sap.ovp.cards.list",
        "settings": {
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem",
          "entitySet": "Orders",
          "staticParameters": {
            "parameter1": "parameterValue1",
            "parameter2": "parameterValue2"
          }
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Configuring Overview Page Card Properties (Fiori Elements)

**INTRODUCTION**: Minimal, actionable reference for configuring card properties used by Overview Page cards in Fiori Elements. Includes example JSON snippets and manifest integration patterns covering the four mandatory card properties: model, template, settings, and entitySet. Use these snippets when generating card configuration files or manifest entries programmatically.

**TAGS**: fiori-elements-framework, overview-page, cards, sap.ovp, manifest.json, configuration

**STEP**: 1 — Minimal standalone card JSON

**DESCRIPTION**: Create a minimal card configuration file containing the four mandatory properties. Use this as a standalone card descriptor (e.g., in a card library or to be referenced by the manifest).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "model": "mainModel",
  "template": "sap.ovp.cards.list",
  "entitySet": "SalesOrderSet",
  "settings": {
    "title": "Sales Orders",
    "annotationPath": "/SalesOrderSet/Annotations",
    "items": {
      "path": "/SalesOrderSet",
      "template": {
        "cells": [
          { "template": "{SalesOrderID}" },
          { "template": "{CustomerName}" },
          { "template": "{NetAmount}" }
        ]
      }
    }
  }
}
```

**STEP**: 2 — Integrate card into webapp/manifest.json (sap.ovp)

**DESCRIPTION**: Embed the card descriptor into the application manifest under sap.ovp.cards. This example demonstrates programmatic insertion or generation of the manifest entry using the same mandatory properties. Place in webapp/manifest.json at path: sap.ovp -> cards -> <cardId>.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "SalesOrderCard": {
        "model": "mainModel",
        "template": "sap.ovp.cards.list",
        "entitySet": "SalesOrderSet",
        "settings": {
          "title": "Sales Orders",
          "subtitle": "Open orders",
          "annotationPath": "/SalesOrderSet/Annotations",
          "items": {
            "path": "/SalesOrderSet",
            "template": {
              "cells": [
                { "template": "{SalesOrderID}" },
                { "template": "{CustomerName}" },
                { "template": "{NetAmount}" }
              ]
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Add header, footer, and navigation inside settings

**DESCRIPTION**: Enhance settings with header/footer controls and navigation. These properties are kept in settings to control card UI and interactivity. Use action handlers or route names that your app implements.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "SalesOrderCard": {
        "model": "mainModel",
        "template": "sap.ovp.cards.list",
        "entitySet": "SalesOrderSet",
        "settings": {
          "title": "Sales Orders",
          "header": {
            "showTitle": true,
            "actions": [
              {
                "type": "action",
                "text": "Create",
                "press": "onCreateSalesOrder"   /* reference to controller/handler */
              }
            ]
          },
          "footer": {
            "show": true,
            "actions": [
              {
                "type": "link",
                "text": "View all",
                "navigation": {
                  "route": "SalesOrderList"
                }
              }
            ]
          },
          "navigation": {
            "route": "SalesOrderDetail",
            "parameters": {
              "targetId": "{SalesOrderID}"
            }
          },
          "items": {
            "path": "/SalesOrderSet",
            "template": {
              "cells": [
                { "template": "{SalesOrderID}" },
                { "template": "{CustomerName}" },
                { "template": "{NetAmount}" }
              ]
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Generating or updating cards programmatically

**DESCRIPTION**: When generating or updating cards via code, ensure each card entry contains the mandatory properties. Example pseudo-code shows creating the manifest card entry object before writing to manifest.json.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
const cardId = "SalesOrderCard";
const cardConfig = {
  model: "mainModel",
  template: "sap.ovp.cards.list",
  entitySet: "SalesOrderSet",
  settings: {
    title: "Sales Orders",
    items: { path: "/SalesOrderSet" }
  }
};

// load manifest (webapp/manifest.json), insert or update:
// manifest["sap.ovp"] = manifest["sap.ovp"] || {};
// manifest["sap.ovp"].cards = manifest["sap.ovp"].cards || {};
// manifest["sap.ovp"].cards[cardId] = cardConfig;
// write manifest back to file system
```
--------------------------------

**TITLE**: Configuring Chart Facets and Chart Annotations for SAP Fiori Elements (OData V4/V2)

**INTRODUCTION**: Concrete, copy-paste-ready examples and actionable instructions to add a chart facet to list reports and object pages, define UI.Chart annotations (XML, ABAP CDS, CAP CDS), enable backend aggregation (standard and custom), use dynamic aggregate measures, enable criticality coloring, enable time-axis behavior, and configure chart behavior through manifest.json. Use these snippets directly in your annotation XML, CDS sources or manifest.json.

**TAGS**: UI.Chart, UI.ReferenceFacet, Aggregation.ApplySupported, Analytics.AggregatedProperty, UI.ValueCriticality, manifest.json, CAP, ABAP CDS, XML, OData, charts, Fiori Elements

STEP: 1 - Add a Chart Facet (UI.ReferenceFacet)

DESCRIPTION: Add a chart facet to an entity's UI.Facets list. Target the chart annotation by annotation path (e.g., to_ProductSalesData/@UI.Chart). Use in list report or object page section to surface the chart.

LANGUAGE: XML
CODE:
```xml
<!-- File: local annotation XML -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType">
  <Annotation Term="UI.Facets">
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="{@i18n>@SalesData}"/>
      <PropertyValue Property="Target" AnnotationPath="to_ProductSalesData/@UI.Chart"/>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.facet: [
  {
    label: '{@i18n>@SalesData}',
    type: #CHART_REFERENCE,
    purpose: #STANDARD,
    targetElement: '_productSalesData'
  }
]
```

LANGUAGE: CAP CDS
CODE:
```cap
annotate STTA_PROD_MAN.STTA_C_MP_ProductType @(
  UI.Facets : {
    $Type : 'UI.ReferenceFacet',
    Label : '{@i18n>@SalesData}',
    Target : 'to_ProductSalesData/@UI.Chart'
  }
);
```

STEP: 2 - Define the Chart (UI.Chart): Title, ChartType, Dimensions, Measures

DESCRIPTION: Define the chart on the chart entity type. Provide Title, ChartType, Dimensions (category), Measures (aggregated properties). Navigation properties are NOT supported inside UI.Chart.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType">
  <Annotation Term="UI.Chart">
    <Record>
      <PropertyValue Property="Title" String="Test Chart"/>
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>DeliveryMonth</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>Revenue</PropertyPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Chart: [
  {
    title: 'Test Chart',
    chartType: #COLUMN,
    dimensions: [
      'DELIVERYMONTH'
    ],
    measures: [
      'REVENUE'
    ]
  }
]
annotate view STTA_C_MP_PRODUCTSALESDATA with { }
```

LANGUAGE: CAP CDS
CODE:
```cap
annotate STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType @(
  UI.Chart : {
    Title : 'Test Chart',
    ChartType : #Column,
    Dimensions : [
      DeliveryMonth
    ],
    Measures : [
      Revenue
    ]
  }
);
```

STEP: 3 - Enable Backend Aggregation: Declare Groupable and Aggregatable properties on the entity set

DESCRIPTION: At the entity-set (container) level, use Aggregation.ApplySupported to list GroupableProperties (dimensions) and AggregatableProperties (measures). This is required so charts can request aggregated data via $apply.

LANGUAGE: XML
CODE:
```xml
<!-- Example: set aggregation support on the entity set -->
<Annotations Target="sap.fe.managepartners.ManagePartnersService.EntityContainer/BusinessPartners">
  <Annotation Term="Aggregation.ApplySupported">
    <Record Type="Aggregation.ApplySupportedType">
      <PropertyValue Property="AggregatableProperties">
        <Collection>
          <Record Type="Aggregation.AggregatablePropertyType">
            <PropertyValue Property="Property">
              <PropertyPath>SalesAmount</PropertyPath>
            </PropertyValue>
          </Record>
          <Record Type="Aggregation.AggregatablePropertyType">
            <PropertyValue Property="Property">
              <PropertyPath>SalesAmountLocalCurrency</PropertyPath>
            </PropertyValue>
          </Record>
          <!-- more aggregatable properties -->
        </Collection>
      </PropertyValue>
      <PropertyValue Property="GroupableProperties">
        <Collection>
          <PropertyPath>AccountResponsible</PropertyPath>
          <PropertyPath>Country</PropertyPath>
          <!-- more groupable properties -->
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cap
@Aggregation.ApplySupported : {
  GroupableProperties : [AccountResponsible, Country],
  AggregatableProperties: [
    { Property: SalesAmount },
    { Property: SalesAmountLocalCurrency }
  ]
}
```

STEP: 4 - Define Standard Aggregated Properties (Analytics.AggregatedProperty)

DESCRIPTION: Declare transformation-aggregation-based properties (min/max/sum/etc.) in metadata so the frontend can request them by name. Use Analytics.AggregatedProperty entries with Name, AggregationMethod and AggregatableProperty.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd_aggregate.SalesOrderManage">
  <Annotation Term="Aggregation.ApplySupported">
    <!-- ... -->
  </Annotation>

  <Annotation Term="Analytics.AggregatedProperty">
    <Record Type="Analytics.AggregatedPropertyType">
      <PropertyValue Property="Name" String="minPrice"/>
      <PropertyValue Property="AggregationMethod" String="min"/>
      <PropertyValue Property="AggregatableProperty" PropertyPath="NetPricing"/>
      <Annotation Term="Common.Label" String="Minimum Net Price"/>
    </Record>
  </Annotation>

  <Annotation Term="Analytics.AggregatedProperty" Qualifier="max">
    <Record Type="Analytics.AggregatedPropertyType">
      <PropertyValue Property="Name" String="maximumPrice"/>
      <PropertyValue Property="AggregationMethod" String="max"/>
      <PropertyValue Property="AggregatableProperty" PropertyPath="NetPricing"/>
      <Annotation Term="Common.Label" String="Maximum Net Price"/>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cap
annotate com.c_salesordermanage_sd_aggregate.SalesOrderManage with @(
  Aggregation.ApplySupported : {
    AggregatableProperties: [{ Property : NetPricing }],
    CustomAggregationMethods: ['Custom.concat']
  },
  Analytics.AggregatedProperty : {
    Name : 'minPrice',
    AggregationMethod : 'min',
    AggregatableProperty : 'NetPricing',
    ![@Common.Label] : 'Minimum Net Price'
  }
);
```

STEP: 5 - Use DynamicMeasures in UI.Chart for Transformation Aggregation

DESCRIPTION: When the aggregated measure is defined via Analytics.AggregatedProperty (transformation aggregation), include it in UI.Chart.DynamicMeasures and reference it in MeasureAttributes. Keep Measures only for properties that are directly part of the entity (custom aggregate measures).

LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Chart">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Sales Chart"/>
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
    <PropertyValue Property="Measures">
      <Collection>
        <PropertyPath>avgPricing</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DynamicMeasures">
      <Collection>
        <AnnotationPath>@Analytics.AggregatedProperty#sum</AnnotationPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Dimensions">
      <Collection>
        <PropertyPath>SalesOrganization</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="avgPricing"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
        </Record>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="DynamicMeasure" AnnotationPath="@Analytics.AggregatedProperty#sum"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="SalesOrganization"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: CAP CDS
CODE:
```cap
Chart : {
  $Type               : 'UI.ChartDefinitionType',
  Title               : 'Sales Chart',
  ChartType           : #Column,
  Measures            : [avgPricing],
  DynamicMeasures     : ['@Analytics.AggregatedProperty#sum'],
  Dimensions          : [SalesOrganization],
  MeasureAttributes   : [
    {
      $Type   : 'UI.ChartMeasureAttributeType',
      Measure : avgPricing,
      Role    : #Axis1
    },
    {
      $Type          : 'UI.ChartMeasureAttributeType',
      DynamicMeasure : '@Analytics.AggregatedProperty#sum',
      Role           : #Axis1
    }
  ],
  DimensionAttributes : [
    {
      $Type     : 'UI.ChartDimensionAttributeType',
      Dimension : SalesOrganization,
      Role      : #Category
    }
  ]
}
```

STEP: 6 - Support Custom Aggregation Methods (Aggregation.CustomAggregate)

DESCRIPTION: For custom aggregation methods, declare Aggregation.CustomAggregate annotations at the entity-set level and mark groupable properties. Units may be annotated as custom aggregates but will not appear as selectable chart measures.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="sap.fe.managepartners.ManagePartnersService.EntityContainer/BusinessPartners">
  <Annotation Term="Aggregation.CustomAggregate" Qualifier="RequestedQuantity">
    <String>Edm.Decimal</String>
  </Annotation>
  <Annotation Term="Aggregation.CustomAggregate" Qualifier="RequestedQuantityLocalUnit">
    <String>Edm.Decimal</String>
  </Annotation>
</Annotations>

<Annotations Target="sap.fe.managepartners.ManagePartnersService.BusinessPartners/Name">
  <Annotation Term="Aggregation.Groupable"><Bool>true</Bool></Annotation>
  <Annotation Term="Common.Label"><String>Partner Name</String></Annotation>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cap
@Aggregation.CustomAggregate #RequestedQuantity          : 'Edm.Decimal'
@Aggregation.CustomAggregate #RequestedQuantityLocalUnit : 'Edm.Decimal'

entity BusinessPartners {
  Name   : String @Common : { Label: 'Partner Name' } @Aggregation.Groupable : true;
  // RequestedQuantity / RequestedQuantityLocalUnit defined as measures using custom aggregation
}
```

STEP: 7 - Add Criticality-Based Coloring (UI.ValueCriticality)

DESCRIPTION: Annotate a property with UI.ValueCriticality to map property values to UI.CriticalityType. Chart criticality coloring is supported in OData V4 charts; neutral values do not color a dimension.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd_aggregate.SalesOrderManage/SalesOrderType">
  <Annotation Term="UI.ValueCriticality">
    <Collection>
      <Record Type="UI.ValueCriticalityType">
        <PropertyValue Property="Value" String="CCLN"/>
        <PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Negative"/>
      </Record>
      <Record Type="UI.ValueCriticalityType">
        <PropertyValue Property="Value" String="CR"/>
        <PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Critical"/>
      </Record>
      <Record Type="UI.ValueCriticalityType">
        <PropertyValue Property="Value" String="OR"/>
        <PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Positive"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view C_SALESORDERMANAGE_SD_AGGREGATE.SALESORDERMANAGE with {

  @UI.ValueCriticality: [
    {
      value: 'CCLN',
      criticality: #NEGATIVE
    },
    {
      value: 'CR',
      criticality: #CRITICAL
    },
    {
      value: 'OR',
      criticality: #POSITIVE
    }
  ]
  salesordertype;
}
```

LANGUAGE: CAP CDS
CODE:
```cap
SalesOrderType @(
  UI.ValueCriticality : [
    { Value: 'CCLN', Criticality: #Negative },
    { Value: 'CR',   Criticality: #Critical },
    { Value: 'OR',   Criticality: #Positive }
  ]
);
```

STEP: 8 - Time Axis Support for Charts

DESCRIPTION: The chart time axis is enabled automatically when the chart dimension has one of these EDM types or specific Common annotations.

LANGUAGE: None
CODE:
```text
Enable time axis when:
- Dimension property type is Edm.Date or Edm.DateTimeOffset
OR dimension property is String annotated with one of:
  @Common.IsFiscalYear
  @Common.IsFiscalYearPeriod
  @Common.IsCalendarYearMonth
  @Common.IsCalendarYearQuarter
  @Common.IsCalendarYearWeek
  @Common.IsCalendarDate
```

STEP: 9 - Configure Chart Header and Selection via manifest.json

DESCRIPTION: Use controlConfiguration for @com.sap.vocabularies.UI.v1.Chart to set header visibility/text and selectionMode (None, Single, Multiple). These manifest settings apply for charts in the list report content area; object-page chart titles are driven by section titles.

LANGUAGE: JSON
CODE:
```json
// File: manifest.json (excerpt)
"BusinessPartnersList": {
  "type": "Component",
  "id": "BusinessPartnersList",
  "name": "sap.fe.templates.ListReport",
  "options": {
    "settings": {
      "controlConfiguration": {
        "@com.sap.vocabularies.UI.v1.Chart": {
          "chartSettings": {
            "headerVisible": false,                 // true (default) or false
            "header": "My Custom chart title",
            "selectionMode": "None"                 // "None" / "Single" / "Multiple" (default)
          }
        }
      }
    }
  }
}
```

STEP: 10 - Important Restrictions and Notes

DESCRIPTION: Key restrictions and platform-specific limitations you must account for when implementing charts.

LANGUAGE: None
CODE:
```text
- Navigation properties inside UI.Chart are not supported. Use only properties from the chart entity set.
- Charts are not supported for draft-enabled entities in OData V2 (or for transactional/draft entities when back end cannot handle $apply).
- OData V4 supports charts on draft-enabled entities but only uses active data for charts.
- Chart selections/personalization are not saved in iAppState (variant changes do not include chart selections).
- Semantic coloring using UI.Criticality and UI.CriticalityCalculation is not supported for charts in some scenarios.
- Aggregations on draft-enabled entities are not supported in ABAP CDS if $apply on draft/transactional entities is unsupported by SADL.
- The back end must support transformation aggregation and transformation filters for aggregate controls (charts) in OData V4 scenarios.
```


--------------------------------

**TITLE**: Configuring Charts for OVP Analytical Cards (Annotations & Manifest)

**INTRODUCTION**: This guide provides concise, actionable configuration patterns for analytical/chart cards in SAP Fiori Overview Pages (OVP). It covers mandatory annotations, numeric formatting via DataPoint, enabling semantic pattern (actual vs forecast), chart role usage, time-series conditions, color palette and stable coloring (dimension-based), and enabling data labels. Use these snippets directly in annotation files (XML / ABAP CDS / CAP CDS) and in the app descriptor (manifest.json or card settings).

**TAGS**: fiori-elements-framework, OVP, UI.Chart, UI.DataPoint, annotations, manifest, charts, colorPalette, semantic-pattern

STEP: Mandatory Annotation Elements for All Chart Types

DESCRIPTION: Create an annotation file with the following mandatory and recommended terms to configure an analytical chart card. Use qualifiers to reuse the same annotation file for multiple cards/views.

LANGUAGE: XML

CODE:
```xml
<!-- Minimal required annotations scaffold for an analytical chart card -->
<!-- Use Qualifier values per card, e.g. #Eval_by_Currency -->
<Annotations Target="YourService.YourEntityType">
  <!-- Mandatory: Click navigation and parameters -->
  <Annotation Term="UI.Identification">
    <!-- identification definition here -->
  </Annotation>

  <!-- Optional: Pre-applied filters -->
  <Annotation Term="UI.SelectionVariant.SelectOptions">
    <!-- selection variant here -->
  </Annotation>

  <!-- Optional: Sorting -->
  <Annotation Term="UI.PresentationVariant.SortOrder">
    <!-- sort order here -->
  </Annotation>

  <!-- Optional: Limit number of records (avoid for full-data charts like donut) -->
  <Annotation Term="UI.PresentationVariant.MaxItems">
    <Record>
      <PropertyValue Property="Value" Int="50"/>
    </Record>
  </Annotation>

  <!-- Mandatory: Chart definition (use Qualifier to reference in manifest) -->
  <Annotation Term="UI.Chart" Qualifier="YourChartQualifier">
    <Record Type="UI.ChartDefinitionType">
      <PropertyValue Property="Title" String="My Chart" />
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
      <!-- MeasureAttributes and DimensionAttributes follow -->
    </Record>
  </Annotation>
</Annotations>
```

STEP: Format Numeric Values Using UI.DataPoint (XML)

DESCRIPTION: Use UI.DataPoint with ValueFormat/NumberOfFractionalDigits and optionally ScaleFactor to format chart measure display. Reference the DataPoint from the measure via DataPoint annotation path inside UI.Chart.MeasureAttributes.

LANGUAGE: XML

CODE:
```xml
<!-- DataPoint definition: controls number formatting -->
<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Currency_TotalSales">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Value" Path="Sales"/>
    <PropertyValue Property="ValueFormat">
      <Record>
        <PropertyValue Property="ScaleFactor" Decimal="1000" />
        <PropertyValue Property="NumberOfFractionalDigits" Int="3" />
      </Record>
    </PropertyValue>
  </Record>
</Annotation>

<!-- Chart referencing the DataPoint for a measure -->
<Annotation Term="UI.Chart" Qualifier="Eval_by_Currency">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="View1" />
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bubble"/>
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="TotalSales" />
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2" />
          <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Eval_by_Currency-TotalSales"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: Format Numeric Values Using ABAP CDS

DESCRIPTION: Same formatting intent, expressed in ABAP CDS annotations. Use valueFormat with scaleFactor and numberOfFractionalDigits, and reference the measure asDataPoint in the UI.Chart annotation.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.dataPoint: {
  valueFormat: { scaleFactor: 1000, numberOfFractionalDigits: 3 }
}
Sales; "property representing Sales measure"

@UI.Chart: [
  {
    title: 'View1',
    chartType: #BUBBLE,
    measureAttributes: [
      {
        measure: 'TotalSales',
        role: #AXIS_2,
        asDataPoint: true
      }
    ],
    qualifier: 'Eval_by_Currency'
  }
]
annotate view VIEWNAME with { }
```

STEP: Format Numeric Values Using CAP CDS (CSN)

DESCRIPTION: CAP-style CSN example for DataPoint and UI.Chart with DataPoint reference.

LANGUAGE: CAP CDS

CODE:
```json
// In a .cds or corresponding annotation file (CSN-like snippet)
UI.DataPoint #Eval_by_Currency-TotalSales : {
    $Type : 'UI.DataPointType',
    ValueFormat : {
        ScaleFactor : 1000,
        NumberOfFractionalDigits : 3
    }
},
UI.Chart #Eval_by_Currency : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'View1',
    ChartType : #Bubble,
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : TotalSales,
            Role : #Axis2,
            DataPoint : '@UI.DataPoint#Eval_by_Currency-TotalSales'
        }
    ]
}
```

STEP: Enable Semantic Pattern (Actual vs Forecast)

DESCRIPTION: To enable semantic pattern (actual vs forecast) for line, column and vertical bullet charts:
- Ensure the DataPoint annotation for the measure has ForecastValue set to a measure property.
- Chart must be configured:
  - line & column: 1 dimension + 1 measure
  - vertical bullet: 1 dimension + 1–2 measures
- The chart will render actual as solid and forecast as dashed/dotted.

LANGUAGE: XML

CODE:
```xml
<!-- DataPoint with ForecastValue -->
<Annotation Term="UI.DataPoint" Qualifier="Column_Forecast">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Sales Performance"/>
    <PropertyValue Property="Value" Path="Sales"/>
    <PropertyValue Property="ValueFormat">
      <Record>
        <PropertyValue Property="ScaleFactor" Decimal="0"/>
        <PropertyValue Property="NumberOfFractionalDigits" Int="3"/>
      </Record>
    </PropertyValue>
    <PropertyValue Property="ForecastValue" Path="SalesShare"/>
  </Record>
</Annotation>

<!-- Chart referencing that DataPoint -->
<Annotation Term="UI.Chart" Qualifier="Eval_by_Currency_Column">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Column chart for shape" />
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column" />
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="Sales" />
          <PropertyValue Property="DataPoint">
            <AnnotationPath>@UI.DataPoint#Column_Forecast</AnnotationPath>
          </PropertyValue>
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="SupplierCompany" />
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: Chart Roles: Dimension and Measure Roles (Mapping & Defaults)

DESCRIPTION: Set roles to control visualization mapping:
- Dimension roles: category (default) or series.
- Measure roles: axis1 (default), axis2, axis3.
Role interpretation depends on chart type (e.g., stacked, combination).

LANGUAGE: XML

CODE:
```xml
<!-- Example: one category dimension, two measures on axis1 and axis2 -->
<Annotation Term="UI.Chart" Qualifier="ExampleChart">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Combination"/>
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="ActualValue"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
        </Record>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="TargetValue"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="Category" />
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: Time Series Charts — Conditions to Use Time Axis

DESCRIPTION: Analytical cards automatically use a time axis only when all conditions are met:
- ChartType is line, bubble, column, or combination.
- Exactly one dimension configured (bubble requires exactly two measures).
- Dimension data type is edm:DateTime or edm:String with sap:semantics="yearmonthday".
- Combination charts require at least two measures.

LANGUAGE: XML

CODE:
```xml
<!-- Example time-series chart with one datetime dimension -->
<Annotation Term="UI.Chart" Qualifier="TimeSeriesChart">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Time Series" />
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Line"/>
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="Revenue"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="OrderDate" />
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>

<!-- Backend metadata must declare OrderDate as edm:DateTime or edm:String + sap:semantics="yearmonthday" -->
```

STEP: Color Palette — App Descriptor (manifest.json) Semantic Coloring

DESCRIPTION: Define colorPalette in the app descriptor (manifest.json) to map four semantic criticality states (0..3) to semantic palette color tokens and legend text. Required for line, bubble, combination and stacked column charts.

LANGUAGE: JSON

CODE:
```json
// manifest.json (app descriptor) — top-level part of configuration used by OVP runtime
{
  "sap.ovp": {
    "colorPalette": {
      "0": {
        "color": "sapUiChartPaletteSemanticNeutral",
        "legendText": "{{OTHERS}}"
      },
      "1": {
        "color": "sapUiChartPaletteSemanticBadDark1",
        "legendText": "{{BAD}}"
      },
      "2": {
        "color": "sapUiChartPaletteSemanticCriticalDark2",
        "legendText": "{{CRITICAL}}"
      },
      "3": {
        "color": "sapUiChartPaletteSemanticCritical",
        "legendText": "{{GOOD}}"
      }
    }
  }
}
```

STEP: Stable Coloring by Dimension Values (Column Stack Chart)

DESCRIPTION: Enable stable colors mapped to specific dimension values (column stack) by:
1. Setting bEnableStableColors: true in the card's settings.
2. Defining colorPalette.dimensionSettings with mapping rules (color + dimensionValue + optional index).
3. Optional: Use index to order legends. If only dimensionValue+index are present (no color), default colors are used but legends are ordered.

LANGUAGE: JSON

CODE:
```json
// manifest.json - sap.ovp.cards.<card_id>.settings
{
  "sap.ovp": {
    "cards": {
      "<card_id>": {
        "model": "<model_name>",
        "template": "sap.ovp.cards.charts.analytical",
        "settings": {
          "title": "<Card title>",
          "entitySet": "<entitySet>",
          "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#Eval_by_Currency_ColumnStacked",
          "bEnableStableColors": true,
          "colorPalette": {
            "dimensionSettings": {
              "StatusCriticality": {
                "rule1": {
                  "color": "sapUiChartPaletteSemanticGood",
                  "dimensionValue": "0",
                  "index": 0
                },
                "rule2": {
                  "color": "sapUiChartPaletteSemanticNeutral",
                  "dimensionValue": "1",
                  "index": 1
                },
                "rule3": {
                  "color": "sapUiChartPaletteSemanticCriticalDark2",
                  "dimensionValue": "2",
                  "index": 2
                },
                "rule4": {
                  "color": "sapUiChartPaletteSemanticBad",
                  "dimensionValue": "3",
                  "index": 3
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Enable Data Labels in Analytical Charts

DESCRIPTION: Show numeric data labels on analytical cards by setting showDataLabel: true under sap.ovp.chartSettings in the app descriptor (manifest.json).

LANGUAGE: JSON

CODE:
```json
// manifest.json - enable data labels globally for OVP charts
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters",
    "chartSettings": {
      "showDataLabel": true
    }
  }
}
```

STEP: References and Best Practices

DESCRIPTION: Quick pointers:
- Avoid UI.PresentationVariant.MaxItems for charts requiring a complete dataset (e.g., donut).
- Use only SAP Fiori semantic palette tokens for chart colors.
- All four keys (0..3) are mandatory in colorPalette for semantic mappings.
- For legend ordering without custom colors, define dimensionValue and index only.

LANGUAGE: None

CODE:
```text
Further reading:
- Configuring Card Navigation: configuring-card-navigation-530f9e6.md
- Chart Cards Used in Overview Pages: chart-cards-used-in-overview-pages-68e62ad.md
- Use qualifiers to reference @UI.Chart and @UI.DataPoint per card/view
```
--------------------------------

**TITLE**: Configure Valid Date Range for Date Fields (OData V4, SAP Fiori elements)

**INTRODUCTION**: Use OData Validation annotations to restrict selectable dates in Fiori elements date pickers. This guide shows how to set static (literal) or dynamic (path-based) minimum and maximum dates using XML annotations (local annotation file) and CAP CDS annotations. Applicable only for SAP Fiori elements on OData V4.

**TAGS**: fiori-elements-framework, odata-v4, annotations, Validation, date, CDS, XML, CAP, OData-Vocabularies

STEP: 1 — Add OData Validation Vocabulary Reference (XML)
DESCRIPTION: Include the Validation vocabulary reference in your local annotation XML (e.g., annotations.xml) so you can use Validation.Minimum and Validation.Maximum terms.
LANGUAGE: XML
CODE:
```XML
<!-- Add this reference near the top of your annotations file -->
<edmx:Reference Uri="https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Validation.V1.xml">
    <edmx:Include Alias="Validation" Namespace="Org.OData.Validation.V1" />
</edmx:Reference>
```

STEP: 2 — Configure Static Valid Date Range (Local XML Annotation)
DESCRIPTION: Disable invalid date values in the date picker by applying literal Date values for Validation.Minimum and Validation.Maximum on the target property.
LANGUAGE: XML
CODE:
```XML
<!-- Example local annotation block -->
<!-- Replace com.service.Entity/DateProperty with your entity and property -->
<Annotations Target="com.service.Entity/DateProperty">
    <Annotation Term="Validation.Minimum" Date="2024-07-01" />
    <Annotation Term="Validation.Maximum" Date="2024-12-31" />
</Annotations>
```

STEP: 3 — Configure Static Valid Date Range (CAP CDS)
DESCRIPTION: In CAP CDS, annotate the Date property with Validation.Minimum and Validation.Maximum using $edmJson Date literals.
LANGUAGE: CDS
CODE:
```CDS
// Define a Date property with static min/max date values
DateProperty : Date @(Validation: {
   Minimum: {$edmJson: {$Date: '2024-07-01'}},
   Maximum: {$edmJson: {$Date: '2024-12-31'}}
});
```

STEP: 4 — Configure Dynamic (Path-Based) Valid Date Range (Local XML Annotation)
DESCRIPTION: Use Path values pointing to other Date properties (e.g., MinimumDate, MaximumDate) so the valid range is evaluated per entity instance.
LANGUAGE: XML
CODE:
```XML
<!-- Example using path references for minimum/maximum -->
<!-- MinimumDate and MaximumDate are Date properties on the same entity -->
<Annotations Target="com.service.Entity/DateProperty">
    <Annotation Term="Validation.Minimum" Path="MinimumDate" />
    <Annotation Term="Validation.Maximum" Path="MaximumDate" />
</Annotations>
```

STEP: 5 — Configure Dynamic (Path-Based) Valid Date Range (CAP CDS)
DESCRIPTION: In CAP CDS define the two date fields and reference them in the Validation annotation for the target Date property.
LANGUAGE: CDS
CODE:
```CDS
// Example CAP CDS snippet with dynamic path-based min/max
MinimumDate : Date;
MaximumDate : Date;

DateProperty : Date @(Validation: {
  Minimum: MinimumDate,
  Maximum: MaximumDate
});
```

STEP: 6 — ABAP CDS Compatibility Note
DESCRIPTION: Path-based Date validation (using MinimumDate/MaximumDate) is not supported in ABAP CDS annotations. If targeting ABAP CDS, implement the date-range validation using local XML annotations (as shown in STEP 4) instead.
LANGUAGE: TEXT
CODE:
```TEXT
Note: Date validation using dynamic path values (MinimumDate/MaximumDate) is NOT supported in ABAP CDS annotations.
Use local XML annotations with Validation.Minimum and Validation.Maximum (literal Date or Path) for ABAP backends.
```
--------------------------------

**TITLE**: Configuring Default Filter Values for SAP Fiori Elements

**INTRODUCTION**: How to configure default filter values for filter bar fields in SAP Fiori elements using UI.SelectionVariant and Common.FilterDefaultValue annotations. Includes XML, ABAP CDS, and CAP CDS examples, merging/priority rules, and important runtime/manifest notes.

**TAGS**: fiori-elements-framework, SAP Fiori, annotations, SelectionVariant, FilterDefaultValue, CDS, CAP, XML, manifest

**STEP**: 1 — Configure default values using UI.SelectionVariant

**DESCRIPTION**: Use UI.SelectionVariant (or UI.SelectionPresentationVariant containing a SelectionVariant) to define complex default filter values (parameters and select options). Provide the annotation in local XML, ABAP CDS, or CAP CDS. Note: SelectionOption (SelectOptions) is not supported in ABAP CDS annotations — use local XML for selection ranges in ABAP CDS.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Local XML annotation: define SelectionVariant with a parameter (P_CompanyCode) and a filter SelectOption (Customer) -->
<Annotation Term="UI.SelectionVariant" Qualifier="Default">
    <Record>
        <PropertyValue Property="Parameters">
            <Collection>
                <Record Type="UI.Parameter">
                    <PropertyValue Property="PropertyName" PropertyPath="P_CompanyCode" />
                    <PropertyValue Property="PropertyValue" String="EASI" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="SelectOptions">
            <Collection>
                <Record Type="UI.SelectOptionType">
                    <PropertyValue Property="PropertyName" PropertyPath="Customer"/>
                    <PropertyValue Property="Ranges">
                        <Collection>
                            <Record Type="UI.SelectionRangeType">
                                <PropertyValue EnumMember="UI.SelectionRangeSignType/I" Property="Sign"/>
                                <PropertyValue EnumMember="UI.SelectionRangeOptionType/EQ" Property="Option"/>
                                <PropertyValue Property="Low" String="ABC"/>
                            </Record>
                        </Collection>
                    </PropertyValue>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
/* ABAP CDS: SelectionVariant example (note: SelectOptions not supported — use XML for ranges) */
@UI.selectionVariant: [
  {
    qualifier: 'SVForQuantity',
    parameters: [{name: 'PropertyName', value: 'P_CompanyCurrency' }, { name: 'PropertyValue', value: 'EASI'}]
  }
]
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
// CAP CDS: SelectionVariant example with Parameters and SelectOptions
UI.SelectionVariant #Default : {
    Parameters : [
        {
            $Type : 'UI.Parameter',
            PropertyName : P_CompanyCode,
            PropertyValue : 'EASI'
        }
    ],
    SelectOptions : [
        {
            $Type : 'UI.SelectOptionType',
            PropertyName : Customer,
            Ranges : [
                {
                    $Type : 'UI.SelectionRangeType',
                    Sign : #I,
                    Option : #EQ,
                    Low : 'ABC'
                }
            ]
        }
    ]
}
```

**STEP**: 2 — Configure simple single-value defaults using Common.FilterDefaultValue

**DESCRIPTION**: Use Common.FilterDefaultValue to assign a single default value to a filter property. This supports only single simple values (no complex operators or multiple values). Examples shown for XML, ABAP CDS, and CAP CDS.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Local XML annotation: simple single-value default for Supplier -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType/Supplier">
    <Annotation Term="Common.FilterDefaultValue" String="100000047"/>
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
/* ABAP CDS: simple single-value default for Supplier */
@Consumption.filter.defaultValue: '100000047'
Supplier;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
// CAP CDS: simple single-value default for Supplier
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with {
    @Common.FilterDefaultValue : '100000047'
    Supplier
};
```

**STEP**: 3 — Behavior, precedence, and runtime notes

**DESCRIPTION**: Implementation and runtime behaviors to apply in code and tests.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "keyNotes": [
    "SelectionVariant, if provided, takes precedence over Common.FilterDefaultValue for all other filters.",
    "Annotation default values are considered only on application load and only when the app is launched with the standard variant.",
    "Annotation default values do not change filter field visibility.",
    "Annotation-applied filter values are cleared and overwritten by incoming navigation context.",
    "Date default values must use ISO format YYYY-MM-DD.",
    "DisplayCurrency may receive defaults from FLP (SAP Fiori launchpad); check FLP inbound configuration.",
    "For Analytical List Page (OData V2): set manifest property filterDefaultsFromSelectionVariant: true so SelectionVariant defaults are considered."
  ]
}
```

**STEP**: 4 — Merging priority and combination rules for multiple sources

**DESCRIPTION**: When default values come from multiple sources (navigation context, user default variant, standard variant annotations, or FLP user defaults), apply the following priority and merging rules in code that decides the effective defaults.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "priorityOrder": [
    "1. Navigation context (includes FLP target mapping / tile navigation source) — highest priority; overrides all other defaults.",
    "2. User-defined default variant (if present and different from standard variant, and no navigation context) — overrides everything including FLP user defaults.",
    "3. Standard variant combined with annotations (UI.SelectionVariant or Common.FilterDefaultValue) — applied when no navigation context and no user default variant."
  ],
  "mergeLogicWhenStandardVariantAndFLPUserDefaultsExist": [
    "If a filter field has only FLP user default values and no annotation value → keep FLP user default values.",
    "If a filter field has only annotation default values and no FLP user default values → keep annotation default values.",
    "If a filter field has both FLP user default values and annotation default values → use ONLY the FLP user default values (FLP wins)."
  ],
  "tip": "User default values from FLP mark the standard variant as dirty (unlike annotation or manifest defaults)."
}
```

**STEP**: 5 — Restrictions and special cases

**DESCRIPTION**: Known restrictions and platform-specific notes to ensure correct implementation and testing.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "restrictions": [
    "Analytical list page (ALP) based apps: Cannot define default filter values using UI.SelectionVariant in ALP-based apps for OData V4.",
    "ABAP CDS: SelectionRange/SelectOptions are not supported — use local XML annotations for ranges/select options.",
    "ALP (OData V2): ensure manifest property filterDefaultsFromSelectionVariant is set to true to consider SelectionVariant defaults."
  ],
  "manifestNote": "Set filterDefaultsFromSelectionVariant: true in the application's manifest.json under the Analytical List Page settings (manifest area depends on app template)."
}
```

**STEP**: 6 — Related resources and files to check

**DESCRIPTION**: Files and docs to inspect when implementing or debugging default filters.

**LANGUAGE**: PlainText

**CODE**:
```text
- Local annotation files (e.g., annotations.xml) for UI.SelectionVariant and Common.FilterDefaultValue entries
- ABAP CDS files where @UI.selectionVariant / @Consumption.filter.defaultValue are added
- CAP CDS files where UI.SelectionVariant / @Common.FilterDefaultValue are annotated
- manifest.json: set filterDefaultsFromSelectionVariant: true for ALP OData V2 scenarios
- Documentation links: 'Configuring Default Settings (Visualizations, Sort Order, Filter Values)' and 'Navigation to an App (Inbound Navigation)' for FLP handling of defaults
```
--------------------------------

**TITLE**: Configuring Default Visualizations, Sort Order, and Default Filter Values (UI.SelectionPresentationVariant, UI.PresentationVariant, UI.SelectionVariant)

**INTRODUCTION**: Action-oriented reference showing how to configure default visualization (table/chart), default sort order, default filter values, requested properties, and initial row count for SAP Fiori elements List Report / ALP using annotation patterns. Includes XML (OData), ABAP CDS, CAP CDS and manifest.json examples for OData V2 and V4. Use these snippets to implement default behavior on application startup.

**TAGS**: fiori-elements-framework, annotations, UI.SelectionPresentationVariant, UI.SelectionVariant, UI.PresentationVariant, UI.LineItem, UI.Chart, manifest.json, OData V2, OData V4, ABAP CDS, CAP CDS, XML, JSON

STEP: Define UI.SelectionPresentationVariant (qualified)
DESCRIPTION: Add a SelectionPresentationVariant that references a SelectionVariant and a PresentationVariant. When used as the default variant in the manifest, this controls default filter values and the default visualization (table/chart). Always ensure PresentationVariant path is valid — if an SPV references a missing PV, the app will fail to load.
LANGUAGE: XML
CODE:
```xml
<!-- Example: XML annotation (OData) with qualifier BookingSPV -->
<Annotations Target="self.BookingType">
  <Annotation Term="UI.SelectionPresentationVariant" Qualifier="BookingSPV">
    <Record>
      <PropertyValue Property="Text" String="Default"/>
      <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#BookingSV"/>
      <PropertyValue Property="PresentationVariant" Path="@UI.PresentationVariant#BookingPV"/>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Define UI.SelectionPresentationVariant (ABAP CDS)
DESCRIPTION: Equivalent in ABAP CDS: link SPV -> selectionVariantQualifier / presentationVariantQualifier on the entity view.
LANGUAGE: ABAP CDS
CODE:
```abap
//@Scope: [ENTITY] ("Booking")
@UI: {
  selectionPresentationVariant: [ {
    qualifier: 'BookingSPV',
    selectionVariantQualifier: 'BookingSV',
    presentationVariantQualifier: 'BookingPV'
  } ]
}
```

STEP: Define UI.SelectionPresentationVariant (CAP CDS)
DESCRIPTION: CAP CDS pattern to create a SelectionPresentationVariant with references to SelectionVariant and PresentationVariant.
LANGUAGE: CDS
CODE:
```cds
annotate TravelService.Travel with @UI: {
  SelectionPresentationVariant #BookingSPV : {
    SelectionVariant : ![@UI.SelectionVariant#BookingSV],
    PresentationVariant : ![@UI.PresentationVariant#BookingPV]
  }
}
```

STEP: Define SelectionVariant (XML) — default filter values
DESCRIPTION: Use SelectionVariant to define default filter SelectOptions (ranges). This example sets BookingStatus = 'N'.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="self.BookingType">
  <Annotation Term="UI.SelectionVariant" Qualifier="BookingSV">
    <Record>
      <PropertyValue Property="SelectOptions">
        <Collection>
          <Record Type="UI.SelectOptionType">
            <PropertyValue Property="PropertyName" PropertyPath="BookingStatus"/>
            <PropertyValue Property="Ranges">
              <Collection>
                <Record Type="UI.SelectionRangeType">
                  <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I"/>
                  <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ"/>
                  <PropertyValue Property="Low" String="N"/>
                </Record>
              </Collection>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Define SelectionVariant (ABAP CDS)
DESCRIPTION: ABAP CDS selectionVariant example using filter expression form.
LANGUAGE: ABAP CDS
CODE:
```abap
//@Scope: [ENTITY] ("Booking")
@UI: {
  selectionVariant: [ { 
    qualifier: 'BookingSV',
    filter: 'BookingStatus EQ "N"'
  } ]
}
```

STEP: Define SelectionVariant (CAP CDS)
DESCRIPTION: CAP CDS SelectionVariant example with SelectOptions + Ranges.
LANGUAGE: CDS
CODE:
```cds
annotate TravelService.Travel with @UI: {
  SelectionVariant #BookingSV: {
    SelectOptions: [ {
      $Type       : 'UI.SelectOptionType',
      PropertyName: BookingStatus,
      Ranges      : [ {
        $Type : 'UI.SelectionRangeType',
        Sign  : #I,
        Option: #EQ,
        Low   : 'N'
      } ]
    } ]
  }
}
```

STEP: Define PresentationVariant (XML - OData V4)
DESCRIPTION: PresentationVariant defines default visualization (Visualizations pointing to UI.LineItem/UI.Chart), SortOrder, MaxItems, etc. Example shows SortOrder by BookingID desc and Visualizations referencing @UI.LineItem.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="self.BookingType">
  <Annotation Term="UI.PresentationVariant" Qualifier="BookingPV">
    <Record>
      <PropertyValue Property="Text" String="Default"/>
      <PropertyValue Property="SortOrder">
        <Collection>
          <Record Type="Common.SortOrderType">
            <PropertyValue Property="Property" PropertyPath="BookingID"/>
            <PropertyValue Property="Descending" Bool="true"/>
          </Record>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Visualizations">
        <Collection>
          <AnnotationPath>@UI.LineItem</AnnotationPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Define PresentationVariant (ABAP CDS)
DESCRIPTION: ABAP CDS PresentationVariant specifying sort and visualization type.
LANGUAGE: ABAP CDS
CODE:
```abap
//@Scope: [ENTITY] ("Booking")
@UI: {
  presentationVariant: [ { 
    qualifier: 'BookingPV',
    sortOrder: [ {
      by: 'BookingID',
      direction: #DESC
    } ],
    visualizations: [ {
      type: #AS_LINEITEM
    } ]
  } ]
}
```

STEP: Define PresentationVariant (CAP CDS)
DESCRIPTION: CAP CDS PresentationVariant with SortOrder and Visualizations.
LANGUAGE: CDS
CODE:
```cds
annotate TravelService.Travel with @UI: {
  PresentationVariant #BookingPV: {
    SortOrder : [
      {
        $Type : 'Common.SortOrderType',
        Property : BookingID,
        Descending : true
      }
    ],
    Visualizations : [
      '@UI.LineItem'
    ]
  }
}
```

STEP: Define UI.Chart (XML)
DESCRIPTION: Annotate an entity type/view to provide a chart definition (title, chart type, dimensions, measures). Chart annotation is used for ALP main chart or chart facets.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType">
  <Annotation Term="UI.Chart">
    <Record>
      <PropertyValue Property="Title" String="Test Chart"/>
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>DeliveryMonth</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>Revenue</PropertyPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Define UI.Chart (ABAP CDS)
DESCRIPTION: ABAP CDS chart annotation equivalent.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Chart: [
  {
    title: 'Test Chart',
    chartType: #COLUMN,
    dimensions: [ 'DELIVERYMONTH' ],
    measures:   [ 'REVENUE' ]
  }
]
annotate view STTA_C_MP_PRODUCTSALESDATA with { }
```

STEP: Define UI.Chart (CAP CDS)
DESCRIPTION: CAP CDS chart annotation equivalent.
LANGUAGE: CDS
CODE:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType @(
  UI.Chart : {
    Title : 'Test Chart',
    ChartType : #Column,
    Dimensions : [ DeliveryMonth ],
    Measures : [ Revenue ]
  }
);
```

STEP: Define UI.LineItem (XML)
DESCRIPTION: UI.LineItem controls table columns shown by default. Provide DataField entries, Importance, Criticality, and text arrangement as needed.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="self.Container/Booking">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="TravelID"/>
        <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="BookingID"/>
        <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
      </Record>
      <!-- ... other fields ... -->
      <Record Type="UI.DataField">
        <PropertyValue Property="Criticality" Path="BookingStatusIndicator"/>
        <PropertyValue Property="Value" Path="BookingStatus"/>
        <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: Define UI.LineItem (ABAP CDS)
DESCRIPTION: ABAP CDS lineItem examples with position and importance.
LANGUAGE: ABAP CDS
CODE:
```abap
//@Scope: [VIEW] ("BOOKING")
annotate view VIEWNAME with {
  @UI.lineItem: [ { position: 10, importance: #HIGH } ] TravelID;
  @UI.lineItem: [ { position: 20, importance: #HIGH } ] BookingID;
  @UI.lineItem: [ { position: 30, importance: #HIGH } ] BookingDate;
  @UI.lineItem: [ { position: 40, importance: #HIGH } ] @UI.textArrangement: #TEXT_FIRST CustomerID;
  @UI.lineItem: [ { position: 90, criticality: 'BookingStatusIndicator', importance: #HIGH } ] BookingStatus;
}
```

STEP: Define UI.LineItem (CAP CDS)
DESCRIPTION: CAP CDS style UI.LineItem array with UI.DataField entries and importance.
LANGUAGE: CDS
CODE:
```cds
UI.LineItem : [
  { $Type : 'UI.DataField', Value : TravelID,       ![@UI.Importance] : #High },
  { $Type : 'UI.DataField', Value : BookingID,      ![@UI.Importance] : #High },
  { $Type : 'UI.DataField', Value : BookingDate,    ![@UI.Importance] : #High },
  { $Type : 'UI.DataField', Value : CustomerID,     ![@UI.Importance] : #High },
  {
    $Type       : 'UI.DataField',
    Value       : BookingStatus,
    Criticality : BookingStatusIndicator,
    ![@UI.Importance] : #High
  }
]
```

STEP: Inline SelectionVariant and PresentationVariant inside SelectionPresentationVariant (XML)
DESCRIPTION: You can embed SelectionVariant inline and reference PresentationVariant either inline or by path. Example shows inline SelectionVariant and PV referenced by path.
LANGUAGE: XML
CODE:
```xml
<!-- Inline SelectionVariant inside SelectionPresentationVariant with PV path -->
<Annotation Term="UI.SelectionPresentationVariant" Qualifier="OpenSPVWithPVPath">
  <Record>
    <PropertyValue Property="Text" String="Open"/>
    <PropertyValue Property="SelectionVariant">
      <Record Type="UI.SelectionVariantType">
        <PropertyValue Property="Text" String="Open"/>
        <PropertyValue Property="SelectOptions">
          <Collection>
            <Record Type="UI.SelectOptionType">
              <PropertyValue Property="PropertyName" PropertyPath="OverallSDProcessStatus"/>
              <PropertyValue Property="Ranges">
                <Collection>
                  <Record Type="UI.SelectionRangeType">
                    <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I"/>
                    <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ"/>
                    <PropertyValue Property="Low" String="A"/>
                  </Record>
                </Collection>
              </PropertyValue>
            </Record>
          </Collection>
        </PropertyValue>
      </Record>
    </PropertyValue>
    <PropertyValue Property="PresentationVariant" Path="@UI.PresentationVariant"/>
  </Record>
</Annotation>

<!-- Inline PresentationVariant example -->
<Annotation Term="UI.PresentationVariant">
  <Record>
    <PropertyValue Property="MaxItems" Int="2"/>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record Type="Common.SortOrderType">
          <PropertyValue Property="Property" PropertyPath="ID"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
        <AnnotationPath>@UI.LineItem</AnnotationPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: Inline SelectionPresentationVariant (CAP CDS)
DESCRIPTION: CAP CDS example showing SelectionPresentationVariant with inline SelectionVariant and PresentationVariant reference.
LANGUAGE: CDS
CODE:
```cds
UI.SelectionPresentationVariant #OpenSPVWithPVPath : {
  Text                : 'Open',
  SelectionVariant    : {
    Text          : 'Open',
    SelectOptions : [{
      PropertyName : OverallSDProcessStatus,
      Ranges       : [{ Sign : #I, Option : #EQ, Low : 'A' }]
    }]
  },
  PresentationVariant : ![@UI.PresentationVariant]
};

UI.PresentationVariant : {
  MaxItems       : 2,
  SortOrder      : [{ Property : ID }],
  Visualizations : ['@UI.LineItem']
};
```

STEP: Request additional properties for tables/charts (RequestAtLeast)
DESCRIPTION: Use PresentationVariant.RequestAtLeast to request additional properties in the OData $select even if not displayed — helpful to ensure required fields are returned for client-side logic or visualizations.
LANGUAGE: XML
CODE:
```xml
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item">
  <Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant">
    <Record>
      <PropertyValue Property="Visualizations">
        <Collection>
          <AnnotationPath>@UI.LineItem</AnnotationPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="RequestAtLeast">
        <Collection>
          <PropertyPath>Customer</PropertyPath>
          <PropertyPath>CompanyCode</PropertyPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: RequestAtLeast (ABAP CDS)
DESCRIPTION: ABAP CDS requestAtLeast example in PresentationVariant.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.PresentationVariant: [
  {
    requestAtLeast: [ 'CUSTOMER', 'COMPANYCODE' ],
    visualizations: [{ type: #AS_LINEITEM }]
  }
]
annotate view ITEM with { }
```

STEP: RequestAtLeast (CAP CDS)
DESCRIPTION: CAP CDS equivalent.
LANGUAGE: CDS
CODE:
```cds
annotate ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item @(
  com.sap.vocabularies.UI.v1.PresentationVariant : {
    Visualizations : [ '@UI.LineItem' ],
    RequestAtLeast : [ Customer, CompanyCode ]
  }
);
```

STEP: Configure SortOrder (XML)
DESCRIPTION: PresentationVariant.SortOrder defines default sort sequence. Descending order uses Descending = true. Note: for amounts with currency/unit, sorting is applied by currency/unit first then by amount.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant">
    <Record>
      <PropertyValue Property="Visualizations">
        <Collection>
          <AnnotationPath>@UI.LineItem</AnnotationPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="SortOrder">
        <Collection>
          <Record>
            <PropertyValue Property="Property" PropertyPath="CompanyCode"/>
            <PropertyValue Property="Descending" Bool="true"/>
          </Record>
          <Record>
            <PropertyValue Property="Property" PropertyPath="Customer"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Configure SortOrder (ABAP CDS)
DESCRIPTION: ABAP CDS sortOrder example with descending and fallback fields.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.PresentationVariant: [
  {
    sortOrder: [
      { by: 'COMPANYCODE', direction: #DESC },
      { by: 'CUSTOMER' }
    ],
    visualizations: [{ type: #AS_LINEITEM }]
  }
]
annotate view ITEM with { }
```

STEP: Configure SortOrder (CAP CDS)
DESCRIPTION: CAP CDS sort order example.
LANGUAGE: CDS
CODE:
```cds
annotate ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item @(
  com.sap.vocabularies.UI.v1.PresentationVariant : {
    Visualizations : [ '@UI.LineItem' ],
    SortOrder : [
      { Property : CompanyCode, Descending : true },
      { Property : Customer }
    ]
  }
);
```

STEP: Configure MaxItems (XML)
DESCRIPTION: PresentationVariant.MaxItems sets number of rows initially loaded for the table (initial page size).
LANGUAGE: XML
CODE:
```xml
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item">
  <Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant">
    <Record>
      <PropertyValue Property="Visualizations">
        <Collection>
          <AnnotationPath>@UI.LineItem</AnnotationPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="MaxItems" Int="50" />
    </Record>
  </Annotation>
</Annotations>
```

STEP: Configure MaxItems (ABAP CDS)
DESCRIPTION: ABAP CDS maxItems example.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.PresentationVariant: [
  {
    maxItems : 50,
    visualizations: [{ type: #AS_LINEITEM }]
  }
]
annotate view ITEM with { }
```

STEP: Configure MaxItems (CAP CDS)
DESCRIPTION: CAP CDS MaxItems example.
LANGUAGE: CDS
CODE:
```cds
annotate ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item @(
  com.sap.vocabularies.UI.v1.PresentationVariant : {
    Visualizations : [ '@UI.LineItem' ],
    MaxItems : 50
  }
);
```

STEP: manifest.json — set default annotation path (OData V2)
DESCRIPTION: For OData V2 List Report (sap.suite.ui.generic.template.ListReport) specify annotationPath in manifest.json settings to point to SelectionPresentationVariant#Qualifier, PresentationVariant#Qualifier or SelectionVariant#Qualifier. If you point to PresentationVariant or SelectionVariant instead of SPV, behavior differs (see notes).
LANGUAGE: JSON
CODE:
```json
// manifest.json (OData V2 List Report)
"component": {
  "name": "sap.suite.ui.generic.template.ListReport",
  "list": true,
  "settings": {
    "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#DefaultSPV"
    // can also point to com.sap.vocabularies.UI.v1.PresentationVariant#Qualifier
    // or com.sap.vocabularies.UI.v1.SelectionVariant#Qualifier
  }
}
```

STEP: manifest.json — set defaultTemplateAnnotationPath (OData V4)
DESCRIPTION: For OData V4 use sap.fe.templates.ListReport target and defaultTemplateAnnotationPath under targets[].options.settings. Must reference a SelectionPresentationVariant (not PV or SV).
LANGUAGE: JSON
CODE:
```json
// manifest.json (OData V4 - target)
"targets": {
  "SalesOrderManageList": {
    "type": "Component",
    "id": "SalesOrderManageList",
    "name": "sap.fe.templates.ListReport",
    "options": {
      "settings": {
        "contextPath": "/SalesOrderManage",
        "defaultTemplateAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#SPVPath"
      }
    }
  }
}
```

STEP: Default visualization lookup & fallback rules
DESCRIPTION: Follow this order if manifest.json setting is not defined. Implementers should ensure valid annotation references to avoid runtime errors:
- 1) Look for default unqualified UI.SelectionPresentationVariant and use its associated SV/PV.
- 2) If not found, check for default unqualified UI.SelectionVariant and default unqualified UI.PresentationVariant.
- 3) If UI.PresentationVariant not found, fallback to default UI.LineItem or UI.Chart.
- 4) If neither UI.PresentationVariant nor UI.LineItem/UI.Chart found, the app renders an empty table/chart; users can personalize the control to configure it.
Note: If a qualified UI.SelectionPresentationVariant is configured in manifest but its associated UI.PresentationVariant is missing or the path is incorrect, the app will error and stop loading — always validate paths. In multiple-view scenarios the framework only fetches a UI.PresentationVariant when undefined according to the multiple view rules. For ALP in OData V4, PresentationVariant logic differs (see ALP descriptor configuration).

LANGUAGE: text
CODE:
```text
Fallback and error guidance:
- Ensure SPV -> PV path exists; missing PV causes app load error.
- If SPV present but PV missing -> fail fast (runtime error).
- If PV present but Visualizations absent -> fallback to unqualified UI.LineItem or UI.Chart (or empty render).
- Multiple view and ALP have specific handling; consult multiple-view and ALP descriptor docs.
```

STEP: Notes & links to related topics
DESCRIPTION: Quick links and reminders:
- UI.Chart is applicable to ALP main chart and chart facets in multiple views.
- For multiple view scenarios, follow the "Defining Multiple Views..." docs for how PV/SV are fetched.
- See the following docs for deeper guidance and examples: Configuring Tables, Configuring Charts, Loading Behavior of Data on Initial Launch, Initial Expansion Level for Tables.

LANGUAGE: text
CODE:
```text
Related docs (use repository/site references):
- Configuring Tables: configuring-tables-f4eb70f.md
- Configuring Charts: configuring-charts-653ed0f.md
- Loading Behavior: loading-behavior-of-data-on-initial-launch-of-the-application-9f4e119.md
- Initial Expansion Level: initial-expansion-level-for-tables-in-list-reports-analytical-list-pages-bc05d35.md
- Multiple view examples: defining-multiple-views-on-a-list-report-table-multiple-table-mode-37aeed7.md
- ALP descriptor config: descriptor-configuration-for-the-analytical-list-page-2a9df06.md
```
--------------------------------

**TITLE**: Configure SAPUI5 Library Dependencies in manifest.json (e.g., add sap.ovp)

**INTRODUCTION**: Add explicit SAPUI5 library dependencies in your application's manifest.json to improve load performance and ensure required libraries (for example, sap.ovp used by Overview Page instances) are loaded with a minimum UI5 version.

**TAGS**: fiori-elements-framework, sapui5, manifest.json, dependencies, sap.ovp, performance

**STEP**: 1 — Locate manifest.json and identify sap.ui5 section

**DESCRIPTION**: Open your application's manifest.json (typically at webapp/manifest.json) and find or create the top-level "sap.ui5" section where UI5 dependencies are declared.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "your.app.id",
    "type": "application",
    "i18n": "i18n/i18n.properties",
    "...": "other app settings"
  },
  "sap.ui5": {
    "...": "existing configuration (controllers, models, etc.)"
  }
}
```

**STEP**: 2 — Add or update the dependencies block with minUI5Version and libs

**DESCRIPTION**: Add the "dependencies" block under "sap.ui5". Set "minUI5Version" to the minimum UI5 runtime required and declare each library under "libs" with an optional "minVersion". For Overview Page (OVP) instances, include "sap.ovp" with at least "1.32.0".

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "dependencies": {
      "minUI5Version": "1.32.0",
      "libs": {
        "sap.ovp": {
          "minVersion": "1.32.0"
        }
      }
    },
    "...": "other sap.ui5 configuration"
  }
}
```

**STEP**: 3 — Example: add multiple libraries (pattern to follow)

**DESCRIPTION**: To declare multiple required libraries, add additional entries under "libs". Each library can specify its own "minVersion". Keep "minUI5Version" aligned with the highest required base UI5 version.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "dependencies": {
      "minUI5Version": "1.32.0",
      "libs": {
        "sap.ovp": {
          "minVersion": "1.32.0"
        },
        "sap.m": {
          "minVersion": "1.44.0"
        },
        "sap.ui.core": {}
      }
    }
  }
}
```

**STEP**: 4 — Save and verify at runtime

**DESCRIPTION**: Save manifest.json, rebuild/deploy if required by your project toolchain, and verify in the browser (console/network) that the declared libraries are requested and that no UI5 version conflicts occur.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "dependencies": {
      "minUI5Version": "1.32.0",
      "libs": {
        "sap.ovp": {
          "minVersion": "1.32.0"
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Configuring External Navigation (Inbound and Outbound) for Fiori Elements

**INTRODUCTION**: This document provides actionable, code-focused configuration and examples for external navigation in SAP Fiori elements apps: defining inbound intents (target app receives navigation), defining outbound intents (source app exposes/sends navigation), using the CrossApplicationNavigation service programmatically, and declaring intent-based navigation in annotations (CDS). Use the manifest.json in webapp for runtime configuration and CDS/annotation files for annotation-driven intent navigation.

**TAGS**: fiori-elements, manifest.json, inbound, outbound, crossNavigation, CrossApplicationNavigation, DataFieldForIntentBasedNavigation, CDS, SAPUI5

**STEP**: 1 — Configure inbound navigation (target app)

**DESCRIPTION**: Define inbound intents for the target Fiori app in webapp/manifest.json so the launchpad and other apps can navigate to it. Include semanticObject, action, title, signature (parameters), and resolutionResult (applicationType and component).

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (excerpt)
{
  "sap.app": {
    "id": "com.example.ProductApp",
    "applicationVersion": { "version": "1.0.0" },
    "title": "Product App",
    "crossNavigation": {
      "inbounds": {
        "Product-display": {
          "semanticObject": "Product",
          "action": "display",
          "title": "Display Product",
          "subTitle": "Show product details",
          "signature": {
            "parameters": {
              "ProductID": {
                "required": true
              }
            },
            "additionalParameters": "allowed"
          },
          "resolutionResult": {
            "applicationType": "SAPUI5",
            "additionalInformation": "SAPUI5.Component=com.example.ProductApp",
            "url": "/resources/com/example/ProductApp/"
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Configure outbound navigation (source app)

**DESCRIPTION**: Define outbounds in the source app manifest to expose navigation targets or to make intent names consistent across apps. Use the outbounds key to map a developer-friendly name to semanticObject/action and optionally include parameter mappings or sample parameters.

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (excerpt)
{
  "sap.app": {
    "id": "com.example.SalesApp",
    "crossNavigation": {
      "outbounds": {
        "toProductDisplay": {
          "semanticObject": "Product",
          "action": "display",
          "title": "Navigate to Product",
          "parameters": {
            "ProductID": {
              "required": true
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Programmatic navigation using CrossApplicationNavigation service (UI5)

**DESCRIPTION**: Use the CrossApplicationNavigation service from the ushell container to navigate to a semantic object/action or to an inbound defined in another app. Examples below show navigation by hash string and by structured target object with params.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Programmatic navigation in a controller
// Example 1: Navigate using a hash string
sap.ushell.Container.getService("CrossApplicationNavigation").toExternal({
  target: { shellHash: "#Product-display?ProductID=123" }
});

// Example 2: Navigate using a target object and params
sap.ushell.Container.getService("CrossApplicationNavigation").toExternal({
  target: {
    semanticObject: "Product",
    action: "display"
  },
  params: {
    ProductID: ["123"],
    // multiple values example
    ViewMode: ["detail", "readonly"]
  }
});

// Example 3: From an async/Promise-aware controller
const navService = sap.ushell.Container.getService("CrossApplicationNavigation");
navService.toExternal({
  target: { semanticObject: "Product", action: "display" },
  params: { ProductID: ["123"] }
});
```

**STEP**: 4 — Declare intent-based navigation in annotations (Fiori elements / CDS)

**DESCRIPTION**: For list/table actions in Fiori elements, declare a DataFieldForIntentBasedNavigation annotation in CDS or annotation XML so the framework renders intent-based navigation links/buttons. Provide required parameters in the annotation signature.

**LANGUAGE**: CDS

**CODE**:
```cds
// File: db/schema.cds or annotations.cds (CDS example)
using { sap } from '@sap/cds/common';

entity Products {
  key ProductID : Integer;
  Name           : String;
  Category       : String;
  // ...
}

/* UI annotation: DataFieldForIntentBasedNavigation example */
annotate Products with {
  @UI: {
    LineItem: [
      { 
        Value: Name,
        DataFieldForIntentBasedNavigation: {
          SemanticObject: 'Product',
          Action: 'display',
          Label: 'Open Product',
          Url: null,
          SemanticObjectMapping: [
            { LocalProperty: 'ProductID', SemanticObjectProperty: 'ProductID' }
          ]
        }
      }
    ]
  }
}
```

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/annotations/annotations.xml (OData V2 annotations example) -->
<Annotations Target="YourService.Products">
  <Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
    <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
        <PropertyValue Property="Label" String="Open Product"/>
        <PropertyValue Property="SemanticObject" String="Product"/>
        <PropertyValue Property="Action" String="display"/>
        <PropertyValue Property="SemanticObjectMapping">
          <Collection>
            <Record>
              <PropertyValue Property="LocalProperty" String="ProductID"/>
              <PropertyValue Property="SemanticObjectProperty" String="ProductID"/>
            </Record>
          </Collection>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 5 — Common runtime considerations and parameter passing

**DESCRIPTION**: How parameters are passed and resolved:
- Inbound signature.parameters defines required parameters and their types (consumer apps should provide them).
- AdditionalParameters: "allowed" | "ignored" | "notAllowed".
- CrossApplicationNavigation.toExternal params is an object with arrays of string values: { ParamName: ["value1", "value2"] }.
- For Fiori elements, DataFieldForIntentBasedNavigation maps entity properties to semantic object properties via SemanticObjectMapping.
- Ensure target app resolutionResult.url and additionalInformation (SAPUI5.Component=...) are correct and deployed paths match.

**LANGUAGE**: JSON

**CODE**:
```json
// Example: toExternal params format reminder
{
  "target": { "semanticObject": "Product", "action": "display" },
  "params": {
    "ProductID": ["123"],        // must be an array of strings
    "Locale": ["en-US"]
  }
}
```

**STEP**: 6 — Debugging and testing

**DESCRIPTION**: Steps to test and debug:
- Validate manifest in webapp/manifest.json for syntax and correct component id/path.
- Deploy both apps to the Fiori launchpad and ensure semanticObject/action pairs are unique or intentionally reused.
- Use browser devtools / network trace to inspect navigation hashes and parameters.
- Programmatic navigation errors often indicate missing inbound definitions or incorrect application id/component in resolutionResult.

**LANGUAGE**: Text

**CODE**:
```text
// Quick checks:
1) Verify inbound exists in target manifest under sap.app.crossNavigation.inbounds
2) Verify outbound exists in source manifest under sap.app.crossNavigation.outbounds (optional)
3) Test navigation via CrossApplicationNavigation.toExternal with a known ProductID
4) Confirm annotation-based links appear in List Report by checking OData metadata and UI annotations
```

--------------------------------

**TITLE**: Configuring Field Rendering, Formatting, Placeholders, and Validation for SAP Fiori elements (OData V4)

**INTRODUCTION**: This guide provides concise, code-focused examples and actionable instructions for configuring field placeholders, date/time display style and custom LDML patterns, and validation for currency, unit-of-measure (UoM) and Edm.Guid fields in SAP Fiori elements (OData V4). Use the XML annotation examples for annotation files, CDS examples for ABAP/CAP models, and manifest.json guidance for pattern-based formatting.

**TAGS**: fiori-elements, odata-v4, annotations, UI.Placeholder, UI.DateTimeStyle, LDML, currency, unit-of-measure, Edm.Guid, manifest.json

STEP: 1 — Applicability note
DESCRIPTION: Confirm that these configurations apply only to SAP Fiori elements for OData V4. Use the provided annotation snippets in your annotation files (XML) or in CDS definitions (ABAP CDS or CAP CDS).
LANGUAGE: text
CODE:
```text
Note: These examples are applicable only to SAP Fiori elements for OData V4.
Place XML annotations in your annotations file (*.xml) or include CDS annotations in your ABAP/CAP model definitions.
```

STEP: 2 — Set Placeholder Text for Input Fields
DESCRIPTION: Use the UI.Placeholder annotation to define placeholder text shown in edit mode for input controls (sap.m.Input, sap.m.ComboBox, etc.). Place this XML block in your OData annotations file (e.g., annotations.xml) targeting the property.
LANGUAGE: XML
CODE:
```xml
<!-- annotations.xml -->
<Annotations Target="sap.fe.manageitems.TechnicalTestingService.LineItems/multiLineTextField">
    <Annotation Term="Common.Label" String="Test Multi Line Text Field"/>
    <Annotation Term="UI.MultiLineText" Bool="true"/>
    <Annotation Term="UI.Placeholder" String="Enter a multi line text"/>
</Annotations>
```

STEP: 3 — Configure Date/Time Display Using DateTimeStyle (XML)
DESCRIPTION: Use the UI.DateTimeStyle annotation to set one of the locale-aware styles (short, medium, long, full). Include the UI vocabulary reference and annotate the target property in your annotation XML.
LANGUAGE: XML
CODE:
```xml
<!-- annotations.xml -->
<edmx:Reference Uri="https://sap.github.io/odata-vocabularies/vocabularies/UI.xml">
    <edmx:Include Namespace="com.sap.vocabularies.UI.v1" Alias="UI"/>
</edmx:Reference>

<Annotations Target="SAP__self.TravelType/CreatedAt">
    <Annotation Term="UI.DateTimeStyle" String="short"/>
</Annotations>
```

STEP: 4 — Configure Date/Time Display Using DateTimeStyle (ABAP CDS & CAP CDS)
DESCRIPTION: Equivalent property-level annotation examples in ABAP CDS and CAP CDS to set DateTimeStyle = 'short'.
LANGUAGE: CDS
CODE:
```cds
-- ABAP CDS (use in ABAP CDS view)
@UI.DateTimeStyle: ['short']
define view entity TravelType as select from ...
{
    CreatedAt
}

-- CAP CDS (service model)
namespace my.service;

entity Example {
    DatePropertyWithStyle : Date     @UI: { DateTimeStyle: 'short' };
    TimePropertyWithStyle : Time     @UI: { DateTimeStyle: 'short' };
    DateTimePropertyWithStyle : DateTime @UI: { DateTimeStyle: 'short' };
}
```

STEP: 5 — Use LDML Patterns for Custom Date/Time Formats (manifest.json guidance)
DESCRIPTION: For custom date/time formats, define an LDML pattern (e.g., "yyyy-MM-dd") in your application manifest.json where you configure UI format settings for the app. The pattern follows Unicode LDML symbols. The exact placement can vary by app structure—ensure it is included in the manifest.json area your app reads for format/display settings (examples below show the pattern value and a minimal manifest snippet illustrating where to place such settings conceptually).
LANGUAGE: JSON
CODE:
```json
// Example: manifest.json — include a pattern value for the property display.
// Exact key path may vary by application template; ensure your app reads it from manifest.json.
{
  "sap.app": { /* app metadata */ },
  "sap.ui5": {
    "resources": {},
    "models": {},
    "formatSettings": {
      "DatePropertyPattern": "yyyy-MM-dd"  // LDML pattern: displays "2023-09-24"
    }
  }
}
```
CODE:
```text
LDML example: "yyyy-MM-dd" -> 2023-09-24
See LDML pattern symbols and details: https://sapui5.hana.ondemand.com/sdk/#/topic/91f2eba36f4d1014b6dd926db0e91070.html
```

STEP: 6 — DateTimeStyle Values & Examples
DESCRIPTION: Use one of these values for UI.DateTimeStyle:
LANGUAGE: text
CODE:
```text
short  -> concise date/time (example: 7/25/24, 1:11 PM)
medium -> readable with seconds (example: Jul 25, 2024, 1:11:51 PM)
long   -> includes time zone details (example: July 25, 2024 at 1:11:51 PM GMT+2)
full   -> full day and time zone name (example: Thursday, July 25, 2024 at 1:11:51 PM Central European Summer Time)
```

STEP: 7 — Validate Currency Fields Without a Related Value Field
DESCRIPTION: When a currency field exists alone (no pair amount field), mark it as currency using Common.isCurrency (XML), ABAP CDS semantics, or CAP CDS Common.IsCurrency.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/TransactionCurrency">
    <Annotation Term="Common.isCurrency" Bool="true"/>
    <!-- additional property or value help definitions -->
</Annotations>
```
LANGUAGE: CDS
CODE:
```cds
-- ABAP CDS
@Semantics.currencyCode: true
TransactionCurrency : <DataType>;

-- CAP CDS
TransactionCurrency @( Common : { IsCurrency : true } );
```

STEP: 8 — Validate Unit-of-Measure (UoM) Fields Without a Related Value Field
DESCRIPTION: Mark UoM-only fields using Common.isUnit (XML), ABAP CDS semantics, or CAP CDS Common.IsUnit to enable validation and correct handling.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/DocumentUnit">
    <Annotation Term="Common.isUnit" Bool="true"/>
    <!-- additional property or value help definitions -->
</Annotations>
```
LANGUAGE: CDS
CODE:
```cds
-- ABAP CDS
@Semantics.unitOfMeasure: true
DocumentUnit : <DataType>;

-- CAP CDS
DocumentUnit @( Common : { IsUnit : true } );
```

STEP: 9 — Edm.Guid Properties Validation
DESCRIPTION: Validation is automatically enabled for properties typed Edm.Guid when they expose a value help; no additional annotation is required beyond providing a value help annotation/source for the Guid property.
LANGUAGE: text
CODE:
```text
- Ensure the property is typed Edm.Guid in the service metadata.
- Provide a value help (value list or association/value help annotations) for that property.
- The framework enables Guid validation automatically when value help is present.
```

STEP: 10 — Quick Checklist for Implementation
DESCRIPTION: Use this checklist when applying the above settings in your app.
LANGUAGE: text
CODE:
```text
- Verify the app uses SAP Fiori elements for OData V4.
- Add UI.Placeholder annotation for editable input placeholders.
- Use UI.DateTimeStyle for locale-aware date/time styles (short/medium/long/full).
- For custom formats, define LDML patterns in manifest.json where the app reads format settings.
- Mark standalone currency fields with Common.isCurrency and UoM fields with Common.isUnit.
- Provide value help for Edm.Guid properties to enable automatic validation.
- Test in display and edit modes to confirm formatting, placeholder, and validation behavior.
```
--------------------------------

**TITLE**: Configuring Filter Bars (List Report & Analytical List Page)

**INTRODUCTION**: Action-oriented reference for implementing and configuring filter bars in SAP Fiori elements (OData V2 / V4). Includes required service capabilities, annotation examples (XML, ABAP CDS, CAP CDS), manifest.json settings, parameterized entity handling, filter restrictions, and UI tool steps.

**TAGS**: fiori-elements, filter-bar, selectionfields, live-mode, manifest.json, ODataV2, ODataV4, CDS, annotations, parameterized-entities

STEP: Service filterability (required capability)
DESCRIPTION: Ensure the OData service exposes filtering capability. Required annotations/capabilities differ by OData version.
LANGUAGE: TEXT
CODE:
```text
SAP Fiori elements for OData V2:
  - sap-filterable = true

SAP Fiori elements for OData V4:
  - Capabilities.Filterable = true
```

STEP: Define UI.SelectionFields (XML annotation)
DESCRIPTION: Add default filter fields to the filter bar. Place this annotation in your entity container or service metadata annotations.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.SelectionFields">
   <Collection>
     <PropertyPath>SalesOrder</PropertyPath>
     <PropertyPath>SoldToParty</PropertyPath>
     <PropertyPath>OverallSDProcessStatus</PropertyPath>
     <PropertyPath>SalesOrderDate</PropertyPath>
     <PropertyPath>_Item/Material</PropertyPath>
   </Collection>
</Annotation>
```

STEP: Define UI.SelectionFields (ABAP CDS)
DESCRIPTION: Mark fields as selection fields in ABAP CDS with positions or element references.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.SelectionField: [{ position: 10 }]
SALESORDER;

@UI.SelectionField: [{ position: 20 }]
SOLDTOPARTY;

@UI.SelectionField: [{ position: 30 }]
OVERALLSDPROCESSSTATUS;

@UI.SelectionField: [{ position: 40 }]
SALESORDERDATE;

@UI.SelectionField: [{ position: 50, element: '_Item.Material' }]
_Item;
```

STEP: Define UI.SelectionFields (CAP CDS)
DESCRIPTION: CAP service-side annotation adding selection fields for the list report.
LANGUAGE: CAP CDS
CODE:
```cds
annotate service.SalesOrderManage with @(
  UI.SelectionFields  : [
     SalesOrder,
     SoldToParty,
     OverallSDProcessStatus,
     SalesOrderDate,
     Item.Material
  ]
);
```

STEP: Search behavior — Go button mode vs Live mode (concept + manifest example)
DESCRIPTION: Choose Go button (user clicks Go to trigger) or Live mode (automatic search on filter change). Live mode can be enabled in manifest.json (be aware of performance impact). Use UI adaptation or manifest settings to control.
LANGUAGE: JSON
CODE:
```json
// Enable Live Mode in manifest.json (example)
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "MyEntitiesList": {
          "type": "Component",
          "name": "sap.fe.templates.ListReport",
          "id": "MyEntitiesList",
          "options": {
            "settings": {
              "liveMode": true
            }
          }
        }
      }
    }
  }
}
```

STEP: Caution — Live mode performance impact
DESCRIPTION: When liveMode=true:
- Initial load triggers content load regardless of manifest initialLoad.
- Each filter value change triggers refresh (may cause heavy DB joins).
- Test end-to-end performance before enabling for large/complex datasets.
LANGUAGE: TEXT
CODE:
```text
Caution: Enabling liveMode causes automatic content loads on initial launch and on every filter change. Validate performance in your environment.
```

STEP: OData V2 — entitySet with input parameters (auto-shown in filter bar)
DESCRIPTION: If an entitySet is marked as parameter semantics, its parameters are shown in the filter bar automatically. Mandatory parameters must be supplied; optional Edm.String currently supported only.
LANGUAGE: XML
CODE:
```xml
<EntityType Name="SalesShareParametersType" sap:semantics="parameters">
    <Key>
        <PropertyRef Name="P_Currency"/>
        <PropertyRef Name="P_Country"/>
        <PropertyRef Name="P_Optional"/>
    </Key>
    <Property Name="P_Currency" Type="Edm.String" Nullable="false" MaxLength="5" sap:label="Currency" sap:parameter="mandatory"/>
    <Property Name="P_Country" Type="Edm.String" Nullable="false" DefaultValue="3" MaxLength="20" sap:label="CountryCode" sap:parameter="mandatory"/>
    <Property Name="P_Optional" Type="Edm.String" Nullable="false" MaxLength="5" sap:label="Optional" sap:parameter="optional"/>
    <NavigationProperty Name="Results" Relationship="sap.smartbusinessdemo.services.SalesShareParameters_SalesShareType" FromRole="SalesShareParametersPrincipal" ToRole="SalesShareDependent"/>
</EntityType>
```

STEP: V4 — Add filter fields using SAP Fiori Tools (UI steps)
DESCRIPTION: Use SAP Fiori Tools Page Map/Page Editor to add filter fields to a List Report page in Business Application Studio or VS Code extension.
LANGUAGE: TEXT
CODE:
```text
UI Steps (Fiori Tools):
1. Open Page Map (right-click project → Show Page Map).
2. Open Page Editor for the List Report (Edit icon).
3. Expand Filter Fields node; click Arrow to open dropdown.
4. Click + (Add) → Add Filter Fields.
5. Select fields from dropdown → Click Add.
6. Reorder fields via drag-and-drop in Page Editor.
7. Preview via Fiori Tools Preview.
```

STEP: Hide the filter bar (manifest.json)
DESCRIPTION: Hide the filter bar even if entitySet contains filterable fields. If mandatory parameters/filters exist without defaults, hide is ignored and filter bar will display.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "hideFilterBar": true
            }
          }
        }
      }
    }
  }
}
```

STEP: Configure mandatory filter fields (Capabilities.RequiredProperties)
DESCRIPTION: Mark filter properties as required so the filter must have values before search is triggered. Provide XML, ABAP CDS, and CAP CDS examples.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.Container/SalesOrder">
   <Annotation Term="SAP__capabilities.FilterRestrictions">
      <Record>
         <PropertyValue Property="RequiredProperties">
            <Collection>
               <PropertyPath>OrderType</PropertyPath>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@Consumption.filter.mandatory: true
OrderType;
```
LANGUAGE: CAP CDS
CODE:
```cds
annotate service.SalesOrder with @Capabilities : {
    FilterRestrictions : {
        $Type : 'Capabilities.FilterRestrictionsType',
        RequiredProperties : [
            OrderType
        ],
    },
};
```

STEP: Hide fields from Filter Bar and Adapt Filters (NonFilterableProperties)
DESCRIPTION: Use Capabilities.NonFilterableProperties or ObjectModel.filter.enabled=false to prevent fields appearing in filter bar and Adapt Filters dialog.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.Container/SalesOrder">
   <Annotation Term="SAP__capabilities.FilterRestrictions">
      <Record>
         <PropertyValue Property="NonFilterableProperties">
            <Collection>
               <PropertyPath>DeliveryChannel</PropertyPath>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@ObjectModel.filter.enabled: false
DeliveryChannel;
```
LANGUAGE: CAP CDS
CODE:
```cds
annotate service.SalesOrder with @Capabilities : {
    FilterRestrictions : {
        $Type : 'Capabilities.FilterRestrictionsType',
        NonFilterableProperties : [
            DeliveryChannel
        ],
    },
};
```

STEP: Parameterized entities — metadata and access pattern
DESCRIPTION: For a parameterized main entity, the filter bar shows required parameters. Access the main entity data via the parameter entity set (ResultContext). Example metadata and OData invocation shown.
LANGUAGE: XML
CODE:
```xml
<!-- Main parameterized entity type with containment nav to Parameters -->
<EntityType Name="CustomerType">
    <Key>
        <PropertyRef Name="Customer"/>
        <PropertyRef Name="CompanyCode"/>
    </Key>
    <Property Name="Customer" Type="Edm.String" Nullable="false" MaxLength="10"/>
    <Property Name="CompanyCode" Type="Edm.String" Nullable="false" MaxLength="4"/>
    <NavigationProperty Name="Parameters" Type="...CustomerParameters" Nullable="false"/>
</EntityType>

<!-- Parameters entity marked with ResultContext -->
<Annotations Target="SAP__self.CustomerParameters">
    <Annotation Term="SAP__common.ResultContext"/>
</Annotations>

<!-- Parameters entity type with navigation back to main entity (Set) -->
<EntityType Name="CustomerParameters">
    <Key>
        <PropertyRef Name="P_DisplayCurrency"/>
    </Key>
    <Property Name="P_DisplayCurrency" Type="Edm.String" Nullable="false" MaxLength="3"/>
    <NavigationProperty Name="Set" Type="Collection(...CustomerType)" Partner="Parameters" ContainsTarget="true"/>
</EntityType>

<!-- EntitySet for parameters (Customer) with NavigationPropertyBinding -->
<EntityContainer Name="Container">
    <EntitySet Name="Customer" EntityType="...CustomerParameters">
        <NavigationPropertyBinding Path="Set/Parameters" Target="Customer"/>
    </EntitySet>
</EntityContainer>

<!-- Sample OData call to fetch results via parameter entity -->
GET /Customer(P_DisplayCurrency='JPY')/Set?$count=true
```

STEP: Filter restrictions for parameterized entities — Option A (FilterRestrictions at main entity)
DESCRIPTION: Define FilterExpressionRestrictions on the main entity with PropertyPath pointing to containment navigation (e.g., Set/SalesOrganization). Use XML or CAP CDS examples.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.Container/Customer">
   <Record Type="SAP__capabilities.FilterRestrictionsType">
      <PropertyValue Property="FilterExpressionRestrictions">
         <Collection>
            <Record Type="Capabilities.FilterExpressionRestrictionType">
               <PropertyValue Property="Property" PropertyPath="Set/SalesOrganization" />
               <PropertyValue Property="AllowedExpressions" String="MultiValue" />
            </Record>
         </Collection>
      </PropertyValue>
   </Record>
</Annotations>
```
LANGUAGE: CAP CDS
CODE:
```cds
entity Customer @(
  Capabilities : {
    FilterRestrictions:{
      $Type: 'Capabilities.FilterRestrictionsType',
      FilterExpressionRestrictions: [{
          Property: 'Set/SalesOrganization',
          AllowedExpressions: 'MultiValue'
      }]
    }
  }
);
```

STEP: Filter restrictions for parameterized entities — Option B (NavigationRestrictions on parameter entity)
DESCRIPTION: Define NavigationRestrictions on the parameter entity with FilterRestrictions targeting the containment navigation (Set). NavigationRestrictions take precedence over direct main-entity restrictions.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.Container/Customer">
   <Annotation Term="SAP__capabilities.NavigationRestrictions">
      <Record>
         <PropertyValue Property="RestrictedProperties">
            <Collection>
               <Record>
                  <PropertyValue Property="NavigationProperty" NavigationPropertyPath="Set" />
                  <PropertyValue Property="FilterRestrictions">
                     <Record>
                        <PropertyValue Property="FilterExpressionRestrictions">
                           <Collection>
                              <Record>
                                 <PropertyValue Property="Property" PropertyPath="SalesOrganization" />
                                 <PropertyValue Property="AllowedExpressions" String="MultiValue" />
                              </Record>
                           </Collection>
                        </PropertyValue>
                     </Record>
                  </PropertyValue>
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```
LANGUAGE: CAP CDS
CODE:
```cds
service MyService {
    @Capabilities.NavigationRestrictions.RestrictedProperties : [{
        $Type              : 'Capabilities.NavigationPropertyRestriction',
        NavigationProperty : 'Set',
        FilterRestrictions : {
            $Type                        : 'Capabilities.FilterRestrictionsType',
            FilterExpressionRestrictions : [{
                $Type              : 'Capabilities.FilterExpressionRestrictionType',
                Property           : 'Set.SalesOrganization',
                AllowedExpressions : 'MultiValue'
            }]
        }
    }]
    entity Customer;
}
```

STEP: Restrictions & limitations (parameterized scenarios)
DESCRIPTION: Key limitations to validate:
- Parameters supported for read-only services only.
- Multiple view mode not supported with parameters (unless single-table mode).
- Navigation entity sets associated with main entity cannot be parameterized.
- Sort restrictions not supported for first-level navigation entity sets in parameterized root.
- Filtering on measure properties is not supported.
LANGUAGE: TEXT
CODE:
```text
Restrictions:
- Parameter support: read-only services only.
- No parameterized navigation entity sets.
- Multiple view mode: parameters unsupported unless single-table mode.
- First-level nav sort restrictions not supported in parameterized scenarios.
- Measures cannot be used for filtering.
```

STEP: Further reading (links)
DESCRIPTION: Links to related topics for deeper configuration and extension APIs.
LANGUAGE: TEXT
CODE:
```text
- Adapting the Filter Bar: adapting-the-filter-bar-609c39a.md
- Loading Behavior of Data on Initial Launch: loading-behavior-of-data-on-initial-launch-of-the-application-9f4e119.md
- Adding Custom Fields to the Filter Bar (extension APIs): adding-custom-fields-to-the-filter-bar-5fb9f57.md
- Enabling Live Mode (V2 / V4): see V2/V4 specific sections in configuring-filter-bars-4bd7590.md
- SAP Fiori Tools: https://help.sap.com/docs/SAP_FIORI_tools
```
--------------------------------

**TITLE**: Configuring Filter Fields (FilterRestrictions) for SAP Fiori Elements – OData V2 & V4, CAP & ABAP CDS Examples

**INTRODUCTION**: Short, developer-focused reference showing how to configure filter fields (single-value, multi-value, single-range, multi-range) via OData V2 sap:filter-restriction, OData V4 Capabilities.FilterRestrictions XML, CAP CDS and ABAP CDS annotations. Includes navigation/association use cases, containment examples, required-filter settings, copy/paste behavior, and prioritization rules for merged annotations.

**TAGS**: fiori-elements-framework, filter-restrictions, OData V2, OData V4, annotations, CAP, ABAP, CDS, XML, navigation, association, containment

**STEP**: 1 — Copy & Paste Multi-Value Behavior and Restrictions

**DESCRIPTION**: End-user copy/paste scenarios and developer constraints. Use this to decide UX and performance limits for multi-value paste into filter fields and to implement custom copy/paste for custom filter controls.

**LANGUAGE**: Text

**CODE**:
```text
Use cases where end users can copy/paste multiple values into a filter field:
- From one filter field to another field with the same data type.
- From one filter field to a value help dialog for a field of the same data type.
- From a spreadsheet into a filter field with the same data type.

Example image: images/copy-paste-filter-bar_e343435.png

Restrictions:
- Pasting a very large number of values may cause performance issues.
- For apps with custom filters, developers must implement the copy and paste events for those custom controls.
```

**STEP**: 2 — OData V2: Use sap:filter-restriction on Property (single-value example)

**DESCRIPTION**: For OData V2 metadata (EDMX), annotate a Property with sap:filter-restriction to make it single-valued (default without annotation: multi-valued).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: mark Date property as single-value -->
<Property Name="StartDate" Type="Edm.DateTime"
          sap:display-format="Date"
          sap:aggregation-role="dimension"
          sap:label="Date"
          sap:filter-restriction="single-value"/>

<!-- Example: string with semantics yearmonthday as single-value -->
<Property Name="StartDate" Type="Edm.String"
          sap:semantics="yearmonthday"
          sap:aggregation-role="dimension"
          sap:label="Date"
          sap:filter-restriction="single-value"/>
```

**STEP**: 3 — OData V4: XML Annotation for Capabilities.FilterRestrictions (basic structure)

**DESCRIPTION**: Use Capabilities.FilterRestrictions and FilterExpressionRestrictions to define AllowedExpressions per property (SingleValue, MultiValue, SingleRange, MultiRange) at the entity-container target.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/SalesOrderManage">
  <Annotation Term="Capabilities.FilterRestrictions">
    <Record Type="Capabilities.FilterRestrictionsType">
      <PropertyValue Property="FilterExpressionRestrictions">
        <Collection>
          <Record Type="Capabilities.FilterExpressionRestrictionType">
            <PropertyValue Property="Property" PropertyPath="SoldToParty"/>
            <PropertyValue Property="AllowedExpressions" String="SingleValue"/>
          </Record>
          <Record Type="Capabilities.FilterExpressionRestrictionType">
            <PropertyValue Property="Property" PropertyPath="SalesOrderDate"/>
            <PropertyValue Property="AllowedExpressions" String="SingleRange"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 4 — CAP CDS: Define FilterRestrictions on an entity (FilterExpressionRestrictions)

**DESCRIPTION**: CAP CDS example to set AllowedExpressions for properties inside the entity declaration. Use this in service metadata or cds model files.

**LANGUAGE**: CDS

**CODE**:
```cds
entity SalesOrderManage @( 
  title: 'Manage Sales Order',
  Capabilities: {
    FilterRestrictions: {
      FilterExpressionRestrictions: [
        {
          Property: 'SoldToParty',
          AllowedExpressions: 'SingleValue'
        },
        {
          Property: 'SalesOrderDate',
          AllowedExpressions: 'SingleRange'
        }
      ]
    }
  }
) {
  key ID : UUID;
  SoldToParty : String;
  SalesOrderDate : Date;
  // ...
}
```

**STEP**: 5 — CAP CDS: Make a filter field required (RequiredProperties)

**DESCRIPTION**: Mark specific filter properties as required in Capabilities.FilterRestrictions.RequiredProperties.

**LANGUAGE**: CDS

**CODE**:
```cds
entity SalesOrderManage @(
  title        : 'Manage Sales Order',
  Capabilities : {
    FilterRestrictions : {
      $Type : 'Capabilities.FilterRestrictionsType',
      RequiredProperties : [ SalesOrderDate ]
    }
  }
) {
  key ID : UUID;
  SalesOrderDate : Date;
  // ...
}
```

**STEP**: 6 — ABAP CDS Mapping: AllowedExpressions → @Consumption.filter.* attributes

**DESCRIPTION**: ABAP CDS annotation equivalents for AllowedExpressions values (use on fields in ABAP CDS view definitions). Use these to control UI multipleSelections and selectionType.

**LANGUAGE**: ABAP

**CODE**:
```abap
" AllowedExpressions = 'SingleValue'  -> single value only
@Consumption.filter.multipleSelections: false
@Consumption.filter.selectionType: #SINGLE

" AllowedExpressions = 'MultiValue'  -> multiple single values (list)
@Consumption.filter.multipleSelections: true
@Consumption.filter.selectionType: #SINGLE

" AllowedExpressions = 'SingleRange'  -> single interval / range
@Consumption.filter.multipleSelections: false
@Consumption.filter.selectionType: #INTERVAL

" AllowedExpressions = 'MultiRange'  -> multiple intervals
@Consumption.filter.multipleSelections: true
@Consumption.filter.selectionType: #INTERVAL
```

**STEP**: 7 — Filter Restrictions for Navigation / Association / Containment Scenarios (approaches & code)

**DESCRIPTION**: Use one of the supported approaches to annotate filter restrictions for properties that live in navigation/child entities. If multiple approaches are present, the prioritization rules (see step 8) decide the effective behavior. Examples include association-level, navigation restrictions on parent, parent with PropertyPath pointing to child, and direct child-entity annotations. Containment and non-containment XML examples are included.

**LANGUAGE**: XML / CDS

**CODE**:
```xml
<!-- Approach A: Filter Restrictions at Association Entity (non-containment)
     Target: association path like Entity/_Material -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/_Material">
  <Annotation Term="Capabilities.FilterRestrictions">
    <Record Type="Capabilities.FilterRestrictionsType">
      <PropertyValue Property="FilterExpressionRestrictions">
        <Collection>
          <Record Type="Capabilities.FilterExpressionRestrictionType">
            <PropertyValue Property="Property" PropertyPath="Material"/>
            <PropertyValue Property="AllowedExpressions" String="SingleValue"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>

<!-- Approach B: Navigation Restrictions at Parent Entity (non-containment)
     Annotate EntityContainer/SalesOrderManage with NavigationRestrictions -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/SalesOrderManage">
  <Annotation Term="Capabilities.NavigationRestrictions">
    <Record>
      <PropertyValue Property="RestrictedProperties">
        <Collection>
          <Record>
            <PropertyValue Property="NavigationProperty" NavigationPropertyPath="_Material"/>
            <PropertyValue Property="FilterRestrictions">
              <Record>
                <PropertyValue Property="FilterExpressionRestrictions">
                  <Collection>
                    <Record>
                      <PropertyValue Property="Property" PropertyPath="Material"/>
                      <PropertyValue Property="AllowedExpressions" String="SingleValue"/>
                    </Record>
                  </Collection>
                </PropertyValue>
              </Record>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>

<!-- Approach C: Filter Restrictions at Parent Entity with PropertyPath to child (non-containment) -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/SalesOrderManage">
  <Annotation Term="Capabilities.FilterRestrictions">
    <Record Type="Capabilities.FilterRestrictionsType">
      <PropertyValue Property="FilterExpressionRestrictions">
        <Collection>
          <Record Type="Capabilities.FilterExpressionRestrictionType">
            <PropertyValue Property="Property" PropertyPath="_Material/Material"/>
            <PropertyValue Property="AllowedExpressions" String="SingleValue"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>

<!-- Approach D: Filter Restrictions Directly at Child Entity (non-containment) -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/MaterialEntity">
  <Annotation Term="Capabilities.FilterRestrictions">
    <Record Type="Capabilities.FilterRestrictionsType">
      <PropertyValue Property="FilterExpressionRestrictions">
        <Collection>
          <Record Type="Capabilities.FilterExpressionRestrictionType">
            <PropertyValue Property="Property" PropertyPath="Material"/>
            <PropertyValue Property="AllowedExpressions" String="SingleValue"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>

<!-- Containment example: annotation target for containment navigation -->
<Annotations Target="sap.fe.test.MyService.MainEntityType/_ItemPartners">
  <Annotation Term="SAP__capabilities.FilterRestrictions">
    <Record>
      <PropertyValue Property="FilterExpressionRestrictions">
        <Collection>
          <Record>
            <PropertyValue Property="Property" PropertyPath="CityName" />
            <PropertyValue Property="AllowedExpressions" String="MultiValue" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 8 — CAP CDS Examples for Navigation/Containment Scenarios (mapping to previous approaches)

**DESCRIPTION**: CAP CDS snippets showing how to attach FilterRestrictions at association level, parent entity via NavigationRestrictions, parent with PropertyPath, and on child entity. Use these patterns inside entity declarations.

**LANGUAGE**: CDS

**CODE**:
```cds
// Approach A: FilterRestrictions on association property inside parent entity
entity SalesOrderManage {
  // ... properties ...
  _Material : Association to Material on _Material.Material = Material;
  @(Capabilities: {
    FilterRestrictions: {
      FilterExpressionRestrictions: [
        { Property: 'Material', AllowedExpressions: 'SingleRange' }
      ]
    }
  })
  _Material;
}

// Approach B: NavigationRestrictions at parent entity level
entity SalesOrderManage @( 
  title: 'Manage Sales Order',
  Capabilities: {
    NavigationRestrictions: {
      RestrictedProperties: [{
        NavigationProperty: _Material,
        FilterRestrictions: {
          FilterExpressionRestrictions: [{
            Property: 'Material',
            AllowedExpressions: 'SingleValue'
          }]
        }
      }]
    }
  }
) {
  key ID : UUID;
  _Material : Association to Material;
}

// Approach C: Parent entity with PropertyPath pointing to child (non-containment)
entity SalesOrderManage @( 
  Capabilities: {
    FilterRestrictions: {
      FilterExpressionRestrictions: [
        { Property: _Material.Material, AllowedExpressions: 'SingleValue' }
      ]
    }
  }
) {
  // ...
}

// Approach D: FilterRestrictions directly at child entity
entity MaterialEntity @(
  title: 'Material',
  Capabilities: {
    FilterRestrictions: {
      FilterExpressionRestrictions: [{
        Property: 'Material',
        AllowedExpressions: 'SingleValue'
      }]
    }
  }
) {
  key Material : String;
  // ...
}

// Containment example (child entity with annotation)
entity _ItemPartner @( 
  Capabilities: {
    FilterRestrictions: {
      FilterExpressionRestrictions: [{
        Property: 'CityName',
        AllowedExpressions: 'MultiValue'
      }]
    }
  }
) {
  key ID : UUID;
  CityName : String;
  // ...
}
```

**STEP**: 9 — Prioritization Rules for Merged Annotations

**DESCRIPTION**: When multiple annotations exist for the same filter field from different approaches, Fiori elements merges them and uses the highest-priority entry for conflicts. Use this to reason which annotation will win in overlapping scenarios.

**LANGUAGE**: Text

**CODE**:
```text
Prioritization (highest → lowest):
1. Filter Restrictions at Association Entity
   - Annotation target example: com.c_salesordermanage_sd.SalesOrderManage/_Partner
   - This wins over any other annotation for the same field.

2. Navigation Restrictions at Parent Entity
   - Uses Capabilities.NavigationRestrictions.RestrictedProperties.FilterRestrictions

3. Filter Restrictions at Parent Entity with PropertyPath pointing to Child Entity
   - Not supported for containment scenarios (e.g., parameterized services/entities).

4. Filter Restrictions Directly at Child Entity
   - Lowest priority; overridden by higher-priority annotations.

Example outcome:
- If Child.CityName is annotated as SingleValue at child (approach 4) but a higher-priority annotation (approach 2 or 1) marks CityName as MultiValue, the effective type will be MultiValue (higher priority wins).
```

**STEP**: 10 — Defaults & Reminders

**DESCRIPTION**: Default behavior if no FilterRestrictions defined and links to field-help documentation.

**LANGUAGE**: Text

**CODE**:
```text
- Default: If no filter-restriction (AllowedExpressions) is provided for a property, the filter field is treated as multi-valued.
- For field-help configuration (value help), see: field-help-a5608ea.md
- Image resource referenced: images/copy-paste-filter-bar_e343435.png
```
--------------------------------

**TITLE**: Configure common Fiori Elements features using OData annotations (status colors & navigation)

**INTRODUCTION**: This document shows concise, copy-pasteable examples to enable common Fiori Elements features via OData annotation files: (1) intent-based navigation from a List Report/Line Item and (2) status colors (criticality) driven by property values. Includes file locations and manifest.json registration for local annotation files. Use these XML annotations with OData V4 / Fiori Elements apps.

**TAGS**: fiori-elements-framework, annotations, odata-v4, navigation, intent-based-navigation, status, criticality, manifest.json, annotations.xml

**STEP**: 1 — Add intent-based navigation to the LineItem (list report)
**DESCRIPTION**: Create or update your local annotation file to add a UI.LineItem entry with UI.DataFieldWithIntentBasedNavigation. This enables semantic object + action based navigation (intent-based navigation) from the list report line item to another app (e.g., fact sheet).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: webapp/annotations/annotations.xml -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:DataServices>
    <Schema Namespace="My.Service.Annotations" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <!-- Target must match your service entity type: ServiceNamespace.EntitySetName or ServiceNamespace.EntityType -->
      <Annotations Target="MyService.MyEntityType">
        <Annotation Term="UI.LineItem">
          <Collection>
            <!-- Example DataFieldWithIntentBasedNavigation -->
            <Record Type="UI.DataFieldWithIntentBasedNavigation">
              <PropertyValue Property="Label" String="Open Fact Sheet"/>
              <!-- SemanticObject and Action define the target intent: e.g. SemanticObject="Customer", Action="displayFactSheet" -->
              <PropertyValue Property="SemanticObject" String="Customer"/>
              <PropertyValue Property="Action" String="displayFactSheet"/>
              <!-- Use Value as the key or path passed to the intent (optional) -->
              <PropertyValue Property="Value">
                <Path>CustomerID</Path>
              </PropertyValue>
            </Record>

            <!-- Example: normal field next in the same LineItem collection -->
            <Record Type="UI.DataField">
              <PropertyValue Property="Label" String="Name"/>
              <PropertyValue Property="Value"><Path>Name</Path></PropertyValue>
            </Record>
          </Collection>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 2 — Add status color (criticality) for a property shown in the list or object page
**DESCRIPTION**: Use UI.DataPoint (or embed a DataPoint inside a DataField) and provide a Criticality expression. The example below maps a numeric Amount property to Criticality values using an If expression. Criticality enum members: com.sap.vocabularies.UI.v1.CriticalityType/Positive | /Negative | /Critical | /Neutral.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: webapp/annotations/annotations.xml (append or in same file as step 1) -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:DataServices>
    <Schema Namespace="My.Service.Annotations" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <Annotations Target="MyService.MyEntityType">
        <Annotation Term="UI.LineItem">
          <Collection>
            <!-- Render Amount with color-coded criticality -->
            <Record Type="UI.DataField">
              <PropertyValue Property="Label" String="Amount"/>
              <PropertyValue Property="Value">
                <Record Type="UI.DataPoint">
                  <!-- numeric value shown -->
                  <PropertyValue Property="Value"><Path>Amount</Path></PropertyValue>

                  <!-- Determine criticality via expression:
                       If Amount < 0 -> Negative
                       Else if Amount > 10000 -> Critical
                       Else -> Positive
                  -->
                  <PropertyValue Property="Criticality">
                    <If>
                      <Lt>
                        <Path>Amount</Path>
                        <LITERAL Int="0"/>
                      </Lt>
                      <EnumMember>com.sap.vocabularies.UI.v1.CriticalityType/Negative</EnumMember>

                      <If>
                        <Gt>
                          <Path>Amount</Path>
                          <LITERAL Int="10000"/>
                        </Gt>
                        <EnumMember>com.sap.vocabularies.UI.v1.CriticalityType/Critical</EnumMember>
                        <EnumMember>com.sap.vocabularies.UI.v1.CriticalityType/Positive</EnumMember>
                      </If>
                    </If>
                  </PropertyValue>

                  <!-- optional: show unit or scale -->
                  <PropertyValue Property="ValueFormat" String="Currency"/>
                </Record>
              </PropertyValue>
            </Record>
          </Collection>
        </Annotation>

        <!-- Optionally expose a compact status as a separate annotation (StatusInfo) for Object Page header -->
        <Annotation Term="UI.HeaderInfo">
          <Record>
            <PropertyValue Property="TypeName" String="Order"/>
            <PropertyValue Property="Title">
              <Record Type="UI.DataField">
                <PropertyValue Property="Value"><Path>OrderID</Path></PropertyValue>
              </Record>
            </PropertyValue>
            <PropertyValue Property="Description">
              <Record Type="UI.DataField">
                <PropertyValue Property="Value"><Path>CustomerName</Path></PropertyValue>
              </Record>
            </PropertyValue>
            <PropertyValue Property="Status">
              <Record Type="UI.DataField">
                <PropertyValue Property="Value">
                  <Record Type="UI.DataPoint">
                    <PropertyValue Property="Value"><Path>Amount</Path></PropertyValue>
                    <PropertyValue Property="Criticality">
                      <Path>AmountCriticality</Path> <!-- if your service provides a Criticality field -->
                    </PropertyValue>
                  </Record>
                </PropertyValue>
              </Record>
            </PropertyValue>
          </Record>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 3 — Register local annotation file in manifest.json so Fiori Elements loads it
**DESCRIPTION**: Add your annotation file to the main OData service data source in manifest.json. Place the XML file under webapp/annotations/annotations.xml and reference it under the service data source settings -> annotations array.
**LANGUAGE**: JSON
**CODE**:
```json
// File: webapp/manifest.json (relevant excerpt)
{
  "sap.app": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/ZMY_SERVICE_SRV/",
        "type": "OData",
        "settings": {
          "annotations": [
            {
              "uri": "annotations/annotations.xml"
            }
          ]
        }
      }
    }
  }
}
```

**STEP**: 4 — File placement and quick checklist
**DESCRIPTION**: Ensure the app reads the annotation file and the annotation target names match your service metadata.
**LANGUAGE**: text
**CODE**:
```text
- Place annotation file: webapp/annotations/annotations.xml
- Ensure manifest.json references that file under the service data source (see step 3)
- Verify Target values in annotations match the EDM entity type name (e.g., MyService.MyEntityType)
- Use SemanticObject/Action that exist in the Launchpad/intent configuration to enable navigation
- Criticality expression can use Path to a precomputed property (e.g., AmountCriticality) or inline expressions (If, Lt, Gt) as shown
```


--------------------------------

**TITLE**: Configuring Internal Navigation for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: Practical, code-focused guide for configuring app-internal navigation in SAP Fiori elements. Includes manifest and annotation examples for controlling: standard navigation (list → object → subobject pages), navigation after action execution, linking entities inside an app, and disabling automatic navigation for actions.

**TAGS**: fiori-elements, navigation, manifest.json, routing, ODataV2, ODataV4, annotations, UI.DataFieldForAction, DataFieldWithNavigationPath, CDS, CAP

STEP: Navigation behavior after executing an action (general rules)
DESCRIPTION: Summarizes when automatic navigation is triggered after executing an action defined with UI.DataFieldForAction and the key constraints to control or prevent it.
LANGUAGE: Text
CODE:
```text
Rules:
- Default (OData V2): Automatic navigation occurs when:
  - Action returns a single instance,
  - Returned instance is not the same as the triggering instance,
  - Action succeeded,
  - Manifest has navigation defined for the returned context.
- Navigation is NOT triggered:
  - If the user selected multiple contexts (table/chart toolbar multi-select),
  - If the action returns a different entity type but no manifest navigation exists,
  - In chart toolbar actions, subobject pages, standard Fiori actions (Save/Edit/Create), manifest-based actions, or external navigation.
- In non-draft apps: if the user is in edit mode on an object page and unsaved changes exist, navigation is blocked with a "changes will be lost" message.

Recommendations:
- For OData V4: To explicitly disable navigation after action execution, use the manifest setting navigateToInstance (see later step).
```

STEP: Disable automatic navigation after action execution (OData V4)
DESCRIPTION: Use the navigateToInstance setting in the manifest to disable automatic navigation for specific annotation-based actions. Key names must start with "DataFieldForAction::". Show separate configuration for inline actions (columns level).
LANGUAGE: JSON
CODE:
```json
// File: manifest.json (partial)
// Disable navigation after specific annotation-based actions (OData V4)
{
  "sap.ui5": {
    "models": { /* ... */ }
  },
  "sap.ui.generic.app": { /* ... */ },
  "com.sap.vocabularies.UI.v1.LineItem": {
    "tableSettings": {
      /* table settings */
    },
    "actions": {
      "DataFieldForAction::com.c_salesordermanage_sd.AddRandomItem": {
        "afterExecution": {
          "navigateToInstance": false
        }
      },
      "DataFieldForAction::com.c_salesordermanage_sd.DummyBoundAction": {
        "afterExecution": {
          "navigateToInstance": false
        }
      }
    },
    "columns": {
      // For inline actions (columns-level configuration)
      "DataFieldForAction::com.c_salesordermanage_sd.AddRandomItem": {
        "afterExecution": {
          "navigateToInstance": false
        }
      },
      "DataFieldForAction::com.c_salesordermanage_sd.DummyBoundAction": {
        "afterExecution": {
          "navigateToInstance": false
        }
      }
    }
  }
}
```

STEP: Standard internal navigation — OData V2 (manifest pages tree)
DESCRIPTION: Keep or remove predefined "pages" definitions to enable/disable navigation from a list report to object pages and further subobject pages. Always specify navigationProperty where appropriate to define the relationship between pages.
LANGUAGE: JSON
CODE:
```json
// File: manifest.json (OData V2, partial)
// Keep this "pages" structure to enable navigation from ListReport -> ObjectPage -> SubObjectPages.
// Remove a pages block to disable navigation to that level.
{
  "sap.ui.generic.app": {
    "pages": {
      "MyListReport": {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": {
          "MyObjectPageOnFirstLevel": {
            "entitySet": "MyEntitySet",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage"
            },
            "pages": {
              "MyFirstObjectPageOnSecondLevel": {
                "navigationProperty": "to_MyFirstEntitySet",
                "entitySet": "MyFirstEntitySet",
                "component": {
                  "name": "sap.suite.ui.generic.template.ObjectPage"
                }
              },
              "MySecondObjectPageOnSecondLevel": {
                "navigationProperty": "to_MySecondEntitySetNavigation",
                "entitySet": "MySecondEntitySet",
                "component": {
                  "name": "sap.suite.ui.generic.template.ObjectPage"
                }
              },
              "MyThirdObjectPageOnSecondLevel": {
                "navigationProperty": "to_MyThirdEntitySet",
                "entitySet": "MyThirdEntitySet",
                "component": {
                  "name": "sap.suite.ui.generic.template.ObjectPage"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Show item list in List Report and parent on Object Page (create directs to parent entity)
DESCRIPTION: Use creationEntitySet on the ListReport component settings so the Create action creates the parent entity (main object), while the list displays child items.
LANGUAGE: JSON
CODE:
```json
// File: manifest.json (partial)
// Direct the Create action to the parent entity set.
{
  "component": {
    "name": "sap.suite.ui.generic.template.ListReport",
    "list": true,
    "settings": {
      "creationEntitySet": "C_MPPurchasingSource"
    }
  }
}
```

STEP: Standard internal navigation — OData V4 (routing + targets + navigation)
DESCRIPTION: Define navigation within each routing target's "options.settings.navigation" to enable chevrons and standard internal navigation. The app pages must form a tree; object pages are uniquely identified by entity sets. Use navigation property PATH (not entity set name) when mapping navigation entries.
LANGUAGE: JSON
CODE:
```json
// File: manifest.json (OData V4, partial)
// Routing and targets: define navigation under each target's options.settings.navigation.
// NOTE: Use navigation PATH (e.g., "_Records" or "to_Items") — do NOT use the navigation entity set name.
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": ":?query:",
          "name": "ArtistList",
          "target": "ArtistList"
        },
        {
          "pattern": "Artists({key}):?query:",
          "name": "ArtistDetail",
          "target": "ArtistObjectPage"
        }
      ],
      "targets": {
        "ArtistList": {
          "type": "Component",
          "id": "ArtistList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/Artists",
              "navigation": {
                "Artists": {
                  "detail": {
                    "route": "ArtistObjectPage"
                  }
                }
              }
            }
          }
        },
        "ArtistObjectPage": {
          "type": "Component",
          "id": "ArtistDetail",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "navigation": {
                "_Records": {
                  "detail": {
                    "route": "RecordSubObjectPage"
                  }
                },
                "_Publishers": {
                  "detail": {
                    "route": "PublisherSubObjectPage"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Important note on navigation PATH vs entity set name (OData V4)
DESCRIPTION: When defining navigation entries under "navigation" in a target, always reference the navigation PROPERTY PATH (the navigation path used in bindings) rather than the navigation entity set name. Example: use "_Records" (navigation path) not "Records" (entity set name).

LANGUAGE: Text
CODE:
```text
Example: under ArtistObjectPage.navigation use "_Records" (navigation path to related records) — do NOT use "Records" (entity set name).
```

STEP: Navigation between entities inside an app (determine target and route parameters)
DESCRIPTION: Use UI.DataFieldWithNavigationPath annotation to provide a Target that maps to a "navigation" entry in the routing target. Resolve route parameters using relative binding paths in the manifest target's parameters object.
LANGUAGE: JSON
CODE:
```json
// File: manifest.json (partial)
// Map a navigation path to a route and set parameter binding for "key".
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": "SalesOrderManage({key}):?query:",
          "name": "SalesOrderManageObjectPage",
          "target": "SalesOrderManageObjectPage"
        }
      ],
      "targets": {
        "SalesOrderManageObjectPage": {
          "type": "Component",
          "id": "SalesOrderManageObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "contextPath": "/SalesOrderManage",
              "navigation": {
                "to_SalesOrder": {
                  "detail": {
                    "route": "SalesOrderManageObjectPage",
                    "parameters": {
                      "key": "{_ReferencedSalesOrder/ID}"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: DataFieldWithNavigationPath annotation examples (XML, ABAP CDS, CAP CDS)
DESCRIPTION: Example annotations to create a clickable field that navigates using the Target (navigation property path). The Target value must match the navigation entry defined in the manifest target settings.
LANGUAGE: XML
CODE:
```xml
<!-- File: Annotation XML (OData annotation) -->
<Annotation Term="UI.FieldGroup" Qualifier="NavExample">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataFieldWithNavigationPath">
          <PropertyValue Property="Label" String="Ref. Sales Order" />
          <PropertyValue Property="Value" Path="RefSalesOrderID" />
          <PropertyValue Property="Target" NavigationPropertyPath="to_SalesOrder" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
// ABAP CDS snippet (qualifier NavExample)
@UI.fieldGroup: [
  {
    targetelement: 'TO_SALESORDER',
    label: 'Ref. Sales Order',
    value: 'REFSALESORDERID',
    type: #WITH_NAVIGATION_PATH,
    position: 1,
    qualifier: 'NavExample'
  }
]
REFSALESORDERID;
```

LANGUAGE: CDS (CAP)
CODE:
```cds
// CAP CDS annotation (qualifier NavExample)
UI.FieldGroup #NavExample : {
  Data : [
    {
      $Type : 'UI.DataFieldWithNavigationPath',
      Label : 'Ref. Sales Order',
      Value : RefSalesOrderID,
      Target : to_SalesOrder
    }
  ]
}
```

STEP: When navigation after action execution works / does not work (OData V4 summary)
DESCRIPTION: Concise checklist showing supported and unsupported cases for "navigation after executing an action".
LANGUAGE: Text
CODE:
```text
Navigation after execution - Supported cases:
- Bound actions in table toolbar, inline actions, header/footer actions, and form actions.
- Annotation-based custom actions.
- When returned context belongs to the same entity as the triggering context (or routing defines navigation to the returned instance).
- For navigation to the next level as defined via routing.

Navigation after execution - Not supported:
- Chart toolbar actions.
- Subobject page actions (control is refreshed instead).
- Standard framework actions (Save, Edit, Create).
- Manifest-based actions.
- External navigation.
```

STEP: In-page navigation (header facets)
DESCRIPTION: Header facets support in-page navigation (jump to sections on the same object page). See "Navigation from Header Facet Title" reference for examples and configuration specifics.
LANGUAGE: Text
CODE:
```text
See: Navigation from Header Facet Title (documentation reference)
- Header facet title elements can be configured to navigate within the same object page (in-page anchor navigation).
```
--------------------------------

**TITLE**: Configuring List Report Features (Table Type & Filter Bar) for Fiori Elements

**INTRODUCTION**: Practical code-focused examples to configure list report features for Fiori Elements apps: choose the table type (Responsive, Grid, Analytical), set table behavior, and configure the filter bar using manifest.json and OData annotations (annotations.xml). Examples include file paths and minimal working snippets to drop into a project.

**TAGS**: fiori-elements, list-report, manifest.json, annotations.xml, filter-bar, table-type, UI.LineItem, UI.SelectionFields

**STEP**: 1 — Set List Report page and table type in manifest.json

**DESCRIPTION**: Configure the List Report page component, choose tableType, and enable common table settings (multiSelect, showRowCount, or table-specific settings). Place this snippet in webapp/manifest.json under sap.ui.generic.app -> pages.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "models": { /* your models */ }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "tableType": "ResponsiveTable",    // options: ResponsiveTable, GridTable, AnalyticalTable
            "multiSelect": true,
            "showRowCount": true,
            "selectionMode": "MultiToggle"    // optional, for selection UI
          }
        }
      }
    ]
  }
}
```

**STEP**: 2 — Alternate: GridTable or AnalyticalTable configuration details

**DESCRIPTION**: When using GridTable or AnalyticalTable, you may also supply table-specific settings. Replace tableType value and add relevant properties inside settings.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "tableType": "GridTable",
            "multiSelect": true,
            "tableSettings": {
              "visibleRowCountMode": "Auto",
              "minAutoRowCount": 5
            }
          }
        }
      }
    ]
  }
}
```

**STEP**: 3 — Define visible columns for the list (UI.LineItem annotation) in annotations.xml

**DESCRIPTION**: Use UI.LineItem annotation to define which entity properties appear as columns in the list report table. Save this in webapp/annotations/annotations.xml (or the annotation file served by your OData service).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="MyService.SalesOrderType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value">
          <Path>SalesOrderID</Path>
        </PropertyValue>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value">
          <Path>CustomerName</Path>
        </PropertyValue>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value">
          <Path>GrossAmount</Path>
        </PropertyValue>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value">
          <Path>CreatedAt</Path>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 4 — Define filter fields (UI.SelectionFields) via annotations.xml

**DESCRIPTION**: Use UI.SelectionFields annotation to expose properties in the Filter Bar. Place this in the same annotations.xml used by the List Report.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="MyService.SalesOrderType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <!-- Filter bar fields -->
  <Annotation Term="UI.SelectionFields">
    <Collection>
      <PropertyPath>CustomerName</PropertyPath>
      <PropertyPath>CreatedAt</PropertyPath>
      <PropertyPath>GrossAmount</PropertyPath>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 5 — Customize Filter Bar behavior in manifest.json

**DESCRIPTION**: Configure filter bar behavior (live mode, advanced mode, showGoButton) in manifest.json under the List Report component settings. This controls whether filters trigger search automatically, show advanced area, and more.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "filterBar": {
              "liveMode": true,
              "showGoButton": false,
              "advancedMode": false
            },
            "quickVariantSelection": {
              "paths": {
                "standard": { "key": "STANDARD", "annotationPath": "@UI.SelectionVariant" }
              }
            }
          }
        }
      }
    ]
  }
}
```

**STEP**: 6 — Make a property hidden or required in Filter Bar using annotations

**DESCRIPTION**: Use UI.Hidden or Common.Semantics attributes in annotations to hide a property from the filter bar or make it mandatory.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="MyService.SalesOrderType/SomeInternalFlag" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <!-- Hide this property everywhere (including filter bar) -->
  <Annotation Term="UI.Hidden">
    <Bool>true</Bool>
  </Annotation>
</Annotations>

<Annotations Target="MyService.SalesOrderType/CustomerName" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <!-- Mark as mandatory for UI (if supported by the framework) -->
  <Annotation Term="Org.OData.Core.V1.Computed">
    <Bool>false</Bool>
  </Annotation>
</Annotations>
```

**STEP**: 7 — Combine manifest and annotations: full minimal example

**DESCRIPTION**: Example file locations and minimal set of artifacts to enable a List Report with responsive table and filter fields: webapp/manifest.json + webapp/annotations/annotations.xml (or service annotations served by backend).

**LANGUAGE**: JSON / XML

**CODE**:
```json
// webapp/manifest.json (excerpt)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "tableType": "ResponsiveTable",
            "filterBar": {
              "liveMode": true,
              "showGoButton": false
            },
            "multiSelect": true
          }
        }
      }
    ]
  }
}
```

```xml
<!-- webapp/annotations/annotations.xml (excerpt) -->
<Annotations Target="MyService.SalesOrderType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataField"><PropertyValue Property="Value"><Path>SalesOrderID</Path></PropertyValue></Record>
      <Record Type="UI.DataField"><PropertyValue Property="Value"><Path>CustomerName</Path></PropertyValue></Record>
      <Record Type="UI.DataField"><PropertyValue Property="Value"><Path>GrossAmount</Path></PropertyValue></Record>
    </Collection>
  </Annotation>

  <Annotation Term="UI.SelectionFields">
    <Collection>
      <PropertyPath>CustomerName</PropertyPath>
      <PropertyPath>CreatedAt</PropertyPath>
    </Collection>
  </Annotation>
</Annotations>
```


--------------------------------

**TITLE**: Configuring Navigation in SAP Fiori elements (manifest and code examples)

**INTRODUCTION**: Practical, code-focused guide for configuring internal and external navigation in SAP Fiori elements apps. Includes manifest.json fragments and controller code for intent-based navigation (inbound/outbound), URL navigation, router-based internal navigation, and an OData V2 post-function navigation example. Links to deeper topic pages (file paths preserved) are included for further reference.

**TAGS**: fiori-elements-framework, navigation, manifest.json, sap.app, sap.ui5, sap.ushell, routing, ODataV2, semantic-object

**STEP**: 1 — Configure internal app navigation (router targets and navTo)

**DESCRIPTION**: Define route(s) and targets in manifest.json under sap.ui5.routing, then call router.navTo from controllers to navigate between pages (List -> Object pages, custom pages, etc.). Use this for standard internal navigation inside the app.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "config": {
        "routerClass": "sap.m.routing.Router",
        "viewType": "XML",
        "async": true,
        "controlId": "app",
        "controlAggregation": "pages"
      },
      "routes": [
        {
          "name": "Master",
          "pattern": "",
          "target": "Master"
        },
        {
          "name": "Object",
          "pattern": "Object/{entitySet}({key})",
          "target": "Object"
        }
      ],
      "targets": {
        "Master": {
          "viewName": "Master",
          "viewLevel": 1
        },
        "Object": {
          "viewName": "Object",
          "viewLevel": 2
        }
      }
    }
  }
}
```

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// In a controller: navigate to Object page with key value
onShowObject: function (oEvent) {
  const sKey = "123"; // derive from selection or OData result
  const oRouter = sap.ui.core.UIComponent.getRouterFor(this);
  oRouter.navTo("Object", {
    entitySet: "Products", // the entity set segment used in route pattern
    key: sKey
  });
}
```

**STEP**: 2 — Configure inbound intent-based navigation (make the app a navigation target)

**DESCRIPTION**: Register inbound intents in manifest.json under sap.app.crossNavigation.inbounds. This makes the app reachable by semantic object + action from the FLP or other apps. See configuring-external-navigation-1d4a0f9.md for details.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "com.example.myApp",
    "crossNavigation": {
      "inbounds": {
        "MyApp-display": {
          "semanticObject": "MyApp",
          "action": "display",
          "signature": {
            "parameters": {
              "ProductID": {
                "required": false
              }
            }
          },
          "resolutionResult": {
            "applicationType": "URL",
            "url": "#com.example.myApp-display"
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Outbound: call intent-based navigation from the app (semantic object)

**DESCRIPTION**: Trigger outbound intent-based navigation from within the app using the UShell CrossApplicationNavigation service to navigate to another app by semanticObject/action and optional params.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Use CrossApplicationNavigation to navigate via semantic object + action
onNavigateBySemanticObject: function () {
  const oCrossAppNav = sap.ushell && sap.ushell.Container && sap.ushell.Container.getService("CrossApplicationNavigation");
  if (!oCrossAppNav) {
    // fallback to URL or log
    return;
  }

  oCrossAppNav.toExternal({
    target: {
      semanticObject: "Product",
      action: "display"
    },
    params: {
      ProductID: ["123"]
    }
  });
}
```

**STEP**: 4 — Outbound: navigate using a URL (simple external navigation)

**DESCRIPTION**: Open an external URL directly or change window location. Use when you need to navigate to a plain URL (external page or full URL to another SAP app).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Open in same window
window.location.href = "https://example.com/path";

// Open in new tab/window
window.open("https://example.com/path", "_blank");
```

**STEP**: 5 — Additional: OData V2 — navigate after executing a function import or action

**DESCRIPTION**: For OData V2, after calling a function import or action that returns a created entity key or navigation target, extract the key from the response and route to the object page. This is often used after create or action operations in Fiori elements. See configuring-internal-navigation-2c65f07.md and configuring-card-navigation-530f9e6.md for related patterns.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: call OData V2 function import / action and navigate to resulting object
onCreateViaFunction: function () {
  const oModel = this.getView().getModel();
  const sFunctionPath = "/CreateProduct"; // function import path
  const mParameters = {
    method: "POST",
    success: (oData) => {
      // Assume service returns new entity key or object id in response
      // Adjust extraction according to your service metadata/response
      const sNewKey = oData && oData.ProductID;
      if (sNewKey) {
        const oRouter = sap.ui.core.UIComponent.getRouterFor(this);
        oRouter.navTo("Object", {
          entitySet: "Products",
          key: sNewKey
        });
      }
    },
    error: (oError) => {
      // handle error
    }
  };
  oModel.callFunction(sFunctionPath, mParameters);
}
```

**STEP**: 6 — References and further configuration files

**DESCRIPTION**: Use the following internal documentation pages for more in-depth details and UI patterns. Keep these file paths in your project docs or link them from README/navigation docs.

**LANGUAGE**: Text

**CODE**:
```text
- Configuring Internal Navigation: configuring-internal-navigation-2c65f07.md
- Configuring External Navigation: configuring-external-navigation-1d4a0f9.md
- Configuring Card Navigation (Overview Page): configuring-card-navigation-530f9e6.md
```
--------------------------------

**TITLE**: Configuring Object Page Features with UI Annotations

**INTRODUCTION**: This guide shows how to configure key Object Page features (header, identification, sections/facets, header actions and navigation) using UI annotations. Includes example annotation files, manifest.json references, and XML patterns you can adapt to your entity types. Use these snippets inside your local annotation file(s) and reference them in manifest.json for Fiori Elements apps.

**TAGS**: fiori-elements-framework, object-page, annotations, UI.Facets, UI.HeaderInfo, UI.FieldGroup, UI.Identification, DataFieldForIntentBasedNavigation, manifest.json, annotations.xml

**STEP**: 1 — Add a local annotations file and reference it in manifest.json

**DESCRIPTION**: Create a local annotation file (e.g., webapp/annotations/annotations.xml) and reference it in manifest.json so Fiori Elements loads your UI annotations.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (snippet)
{
  "sap.app": { "id": "my.app.id" },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      },
      "annotations": {
        "dataSource": "annotationFile",
        "settings": {}
      }
    },
    "resources": {},
    "dependencies": {}
  },
  "sap.app": {},
  "sap.platform.hcp": {},
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      }
    },
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/YourService/",
        "type": "OData",
        "settings": { "odataVersion": "2.0" }
      },
      "annotationFile": {
        "uri": "annotations/annotations.xml",
        "type": "ODataAnnotation",
        "settings": { "localUri": "annotations/annotations.xml" }
      }
    }
  }
}
```

**STEP**: 2 — Basic object page header (UI.HeaderInfo)

**DESCRIPTION**: Define the header title, description and image for the Object Page using the UI.HeaderInfo annotation on the EntityType or EntitySet target. Use Path properties to bind to entity properties.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/annotations/annotations.xml -->
<Annotations Target="YourService.ProductType">
  <Annotation Term="UI.HeaderInfo">
    <Record Type="UI.HeaderInfoType">
      <!-- Static type name -->
      <PropertyValue Property="TypeName" String="Product" />
      <!-- Bind title to the entity property 'Name' -->
      <PropertyValue Property="Title" Path="Name" />
      <!-- Bind description -->
      <PropertyValue Property="Description" Path="Description" />
      <!-- Optional image -->
      <PropertyValue Property="ImageUrl" Path="ImageUrl" />
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 3 — Identification (fields shown under header)

**DESCRIPTION**: Use UI.Identification to list key identification fields that appear below the header (key/value pairs). Reference the annotation on the same target as HeaderInfo.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="YourService.ProductType">
  <Annotation Term="UI.Identification">
    <Collection>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="ProductID" />
        <PropertyValue Property="Label" String="Product ID" />
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Category" />
        <PropertyValue Property="Label" String="Category" />
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 4 — Define Object Page sections using UI.Facets and a FieldGroup

**DESCRIPTION**: Create facets (sections) on the Object Page using UI.Facets. Each facet references another annotation (e.g., a FieldGroup) via AnnotationPath or a qualified annotation. Define the FieldGroup with Data collection using DataField records to list properties inside the section.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Facets declaration on the entity -->
<Annotations Target="YourService.ProductType">
  <Annotation Term="UI.Facets">
    <Collection>
      <!-- Reference facet pointing to a FieldGroup qualifier -->
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="General Information" />
        <PropertyValue Property="Target">
          <Record Type="UI.AnnotationPath">
            <!-- Points to the FieldGroup declared with Qualifier="GeneralInfo" -->
            <PropertyValue Property="AnnotationPath" String="@UI.FieldGroup#GeneralInfo" />
          </Record>
        </PropertyValue>
      </Record>

      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Sales Data" />
        <PropertyValue Property="Target">
          <Record Type="UI.AnnotationPath">
            <PropertyValue Property="AnnotationPath" String="@UI.FieldGroup#Sales" />
          </Record>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>

<!-- FieldGroup definitions referenced by the facets -->
<Annotations Target="YourService.ProductType">
  <Annotation Term="UI.FieldGroup" Qualifier="GeneralInfo">
    <Record Type="UI.FieldGroupType">
      <PropertyValue Property="Label" String="General Information" />
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="Name" />
            <PropertyValue Property="Label" String="Name" />
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="Description" />
            <PropertyValue Property="Label" String="Description" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <Annotation Term="UI.FieldGroup" Qualifier="Sales">
    <Record Type="UI.FieldGroupType">
      <PropertyValue Property="Label" String="Sales" />
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="Price" />
            <PropertyValue Property="Label" String="Price" />
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="Currency" />
            <PropertyValue Property="Label" String="Currency" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 5 — Add header actions and intent-based navigation (DataFieldForIntentBasedNavigation)

**DESCRIPTION**: Add actions (buttons) in the header that trigger navigation or intents using DataFieldForIntentBasedNavigation. Place these in UI.HeaderInfo or in UI.LineItem / UI.Identification depending on desired placement.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="YourService.ProductType">
  <Annotation Term="UI.HeaderInfo">
    <Record Type="UI.HeaderInfoType">
      <PropertyValue Property="Title" Path="Name" />
      <!-- Add header actions as an array of Records inside 'Actions' -->
      <PropertyValue Property="Actions">
        <Collection>
          <!-- Intent-based navigation -->
          <Record Type="UI.DataFieldForIntentBasedNavigation">
            <PropertyValue Property="SemanticObject" String="Product" />
            <PropertyValue Property="Action" String="manage" />
            <PropertyValue Property="Label" String="Manage Product" />
          </Record>

          <!-- Static action (example) -->
          <Record Type="UI.DataField">
            <PropertyValue Property="Label" String="Custom Action" />
            <!-- For custom actions, use annotations to call OData Action via a Button in UI -->
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 6 — Place complex lists inside a section with UI.LineItem or Table facet

**DESCRIPTION**: If a section should contain a list or table, reference a LineItem annotation as a target facet or use CollectionFacet with UI.CollectionFacet pointing to a navigation property/annotation.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Facet referencing a LineItem for a related navigation property -->
<Annotations Target="YourService.ProductType">
  <Annotation Term="UI.Facets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Related Documents" />
        <PropertyValue Property="Target">
          <Record Type="UI.AnnotationPath">
            <PropertyValue Property="AnnotationPath" String="ToDocuments/@UI.LineItem" />
          </Record>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>

<!-- Example LineItem on the related entity (Documents) -->
<Annotations Target="YourService.DocumentType">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="DocumentID" />
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Title" />
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="CreatedAt" />
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 7 — Prefilling field values (Related doc reference: DefaultValuesFunction)

**DESCRIPTION**: To prefill fields when creating new entities or initializing action parameters, use the DefaultValuesFunction approach. See your project's prefilling-fields documentation for details and examples.

**LANGUAGE**: Plain (reference)

**CODE**:
```text
See: webapp/docs/prefilling-fields-using-the-defaultvaluesfunction-5ada91c.md
(Use the DefaultValuesFunction implementation to bind default values to create actions and action parameters)
```

Notes:
- Replace "YourService.ProductType" and property names with your actual service namespace and properties.
- Use Qualifier names consistently: refer to FieldGroup qualifiers in UI.Facets as shown.
- You can author annotations in XML (as shown) or JSON-based annotation files; ensure manifest.json annotationUri/localUri points to the file location (e.g., webapp/annotations/annotations.xml).
--------------------------------

**TITLE**: Configuring Overview Page App Extensions (Fiori Elements OVP)

**INTRODUCTION**: Practical recipe to customize SAP Fiori Overview Page (OVP) card area and filter area using UI5 app extension points. Shows how to add a custom card entry in manifest.json, override a card's view/controller via UI5 extension points, provide the extension controller implementation, add an XML fragment for card content, and programmatically add a filter field to the SmartFilterBar. Use these steps to implement maintainable, manifest-driven OVP customizations.

**TAGS**: fiori-elements-framework, sapui5, ovp, manifest, app-extension, cards, filters, controllerExtensions, viewExtensions

**STEP**: 1 — Add custom card configuration to manifest.json

**DESCRIPTION**: Add a new OVP card entry under sap.ovp.cards. Keep card id unique. The example below registers a card named "CustomListCard" using a built-in list template — this entry will make the card available to the Overview Page. Adjust entitySet / settings per your service/annotations.

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (partial)
{
  "sap.ovp": {
    "cards": {
      "CustomListCard": {
        "model": "mainModel",
        "template": "sap.ovp.cards.list",
        "title": "My Custom Card",
        "settings": {
          "entitySet": "Orders",
          "selectionAnnotationPath": "",
          "navigation": {}
        }
      }
    }
  }
}
```

**STEP**: 2 — Declare UI5 view/controller extensions in manifest.json

**DESCRIPTION**: Use UI5 extension points to replace/extend the card's view fragment and controller logic. The manifest below maps the original OVP card controller and view aggregations to your extension controller and an XML fragment. Replace the keys with the exact original view/controller names if different in your OVP runtime. Place extension source files under webapp/ext/.

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (partial)
// Add the following inside "sap.ui5" root
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          // original controller full name -> your extension controller
          "sap.ovp.cards.list.List": {
            "controllerName": "my.ext.CustomListController"
          }
        },
        "sap.ui.viewExtensions": {
          // original view full name -> aggregation name -> fragment definition
          "sap.ovp.cards.list.List": {
            "cardContent": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "my.ext.CustomCardContent",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Implement the extension controller

**DESCRIPTION**: Create a controller to add behavior specific to your custom card and/or to extend filter behavior. The example shows onInit usage and an API example to access the card's view and model. You will also use this controller to register runtime modifications (e.g., add event handlers, modify binding parameters).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/ext/CustomListController.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/ui/comp/filterbar/FilterGroupItem",
  "sap/m/Input"
], function(Controller, FilterGroupItem, Input) {
  "use strict";

  return Controller.extend("my.ext.CustomListController", {
    onInit: function() {
      // Typical initialization hook for card-level logic.
      // The extension controller receives the same current view as the original controller.
      var oView = this.getView();
      var oModel = oView.getModel();

      // Example: attach to an event or modify card data binding parameters
      // oModel.setProperty("/myFlag", true);
    },

    // Example helper to add a custom filter field to the SmartFilterBar on OVP
    addCustomFilterToOVPFilterBar: function() {
      // Navigate from card view to top-level Overview Page view if needed
      var oComponent = sap.ui.core.Component.getOwnerComponentFor(this.getView());
      if (!oComponent) {
        return;
      }
      var oRoot = oComponent.getRootControl && oComponent.getRootControl();
      if (!oRoot) {
        return;
      }

      // Attempt to find SmartFilterBar by ID used in your OVP app (adjust ID as needed)
      var oSmartFilterBar = oRoot.byId("ovpFilter") || oRoot.byId("smartFilterBar");
      if (!oSmartFilterBar) {
        return;
      }

      // Create a FilterGroupItem to be displayed in the SmartFilterBar
      var oControl = new Input({ placeholder: "Customer" });
      var oFilterGroupItem = new FilterGroupItem({
        groupName: "CustomFilters",
        name: "Customer",
        label: "Customer",
        control: oControl
      });

      // Add the item to the filter bar
      oSmartFilterBar.addFilterGroupItem(oFilterGroupItem);
    }
  });
});
```

**STEP**: 4 — Provide the XML fragment for the custom card content

**DESCRIPTION**: The fragment implements the UI (card content) that replaces or extends the default card content. Keep fragment lightweight and use binding expressions to bind to the card's model. Use the fragment name declared in manifest.json ("my.ext.CustomCardContent").

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/ext/CustomCardContent.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:layout="sap.f">
  <VBox class="sapOvpCardContent">
    <Text text="{path: 'Orders>/OrderID', formatter: '.formatter.formatOrderTitle'}" />
    <!-- Example list inside a card: bind to the card context model path -->
    <List items="{Orders>/results}">
      <items>
        <StandardListItem
          title="{Orders>OrderID}"
          description="{Orders>CustomerName}" />
      </items>
    </List>
  </VBox>
</core:FragmentDefinition>
```

**STEP**: 5 — Programmatically add or tweak filters from a component/controller extension

**DESCRIPTION**: If you need to inject a filter field dynamically on app launch (not inside a particular card), implement a component or central controller extension and call similar code to add FilterGroupItems to the SmartFilterBar. Example below shows a component-level hook (e.g., Component.js or main controller) that runs once on start.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/ext/OVPFilterInitializer.js
sap.ui.define([
  "sap/ui/core/Component",
  "sap/ui/comp/filterbar/FilterGroupItem",
  "sap/m/Input"
], function(Component, FilterGroupItem, Input) {
  "use strict";

  return {
    initFilters: function() {
      var oComponent = sap.ui.core.Component.getOwnerComponentFor(this);
      var oRoot = oComponent && oComponent.getRootControl && oComponent.getRootControl();
      if (!oRoot) {
        return;
      }

      var oSmartFilterBar = oRoot.byId("ovpFilter") || oRoot.byId("smartFilterBar");
      if (!oSmartFilterBar) {
        return;
      }

      // Add a "Region" filter to the filter bar
      var oInput = new Input({ placeholder: "Region" });
      var oFilterGroupItem = new FilterGroupItem({
        groupName: "CustomFilters",
        name: "Region",
        label: "Region",
        control: oInput
      });
      oSmartFilterBar.addFilterGroupItem(oFilterGroupItem);
    }
  };
});
```

**STEP**: 6 — File structure and deployment notes

**DESCRIPTION**: Keep extension artifacts under webapp/ext/ (or webapp/extension/) and reference their names (controllerName, fragmentName) exactly in manifest.json. After editing manifest.json, rebuild and deploy the UI5 app or run the local server to validate. When testing, use SAP Web IDE / BAS or UI5 tooling; clear caches or use ?sap-ui-debug=true if needed.

**LANGUAGE**: TEXT

**CODE**:
```text
Recommended file layout (example):
webapp/
  ├─ manifest.json               // modified
  ├─ Component.js
  ├─ ext/
  │   ├─ CustomListController.controller.js
  │   ├─ CustomCardContent.fragment.xml
  │   └─ OVPFilterInitializer.js
  └─ ... (other app files)
```

Notes:
- Replace IDs (ovpFilter, smartFilterBar), original controller/view names, and entitySet names with the exact names used by your OVP runtime and service.
- Use the UI5 "sap.ui.viewExtensions" aggregation name that matches the target view (e.g., "cardContent" or "content") — inspect runtime view structure if uncertain.
- When overriding controllers, prefer controllerExtensions instead of full controller replacement to keep default OVP behavior intact; call original controller methods if needed.
--------------------------------

**TITLE**: Configuring Sort Properties for Fiori Elements Cards

**INTRODUCTION**: This document shows how to configure sorting for Fiori Elements cards (list, table, stack). You can configure sort behavior either in the application manifest (for sap.ovp cards) or in OData/UI annotations (PresentationVariant). Examples include manifest JSON, XML annotations, ABAP CDS, and CAP CDS. Use these snippets to set single or multi-level sorts and to share sort parameters across applications.

**TAGS**: sap.fiori, fiori-elements, ovp, presentationvariant, sort, manifest, annotations, CDS, CAP

**STEP**: 1 — Configure card-level sorting in manifest.json

**DESCRIPTION**: Add sortBy and sortOrder properties under the card settings in the app manifest to sort records for list, table, and stack cards. Place this in webapp/manifest.json (or the application's manifest).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card04": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.list",
        "settings": {
          "sortBy": "Price",
          "sortOrder": "descending",
          "listFlavor": "bar",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#bar",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#bar",
          "category": "{{card04_category}}",
          "entitySet": "Products"
        }
      }
    }
  }
}
```

**STEP**: 2 — Configure sorting using PresentationVariant (XML annotation)

**DESCRIPTION**: Define PresentationVariant annotations in your annotation XML file (e.g., annotations.xml). Use SortOrder with one or more Records to define multi-level sorts. Each SortOrder Record specifies Property (PropertyPath) and Descending (Boolean). Reference the annotated PresentationVariant from the card using annotationPath or annotation qualifiers.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant" Qualifier="Eval_by_Country">
  <Record>
    <PropertyValue Property="GroupBy">
      <Collection>
        <PropertyPath>Country</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record>
          <PropertyValue Property="Property" PropertyPath="Sales" />
          <PropertyValue Property="Descending" Boolean="true" />
        </Record>
        <!-- Add more <Record> elements for additional sort levels:
        <Record>
          <PropertyValue Property="Property" PropertyPath="AnotherProperty" />
          <PropertyValue Property="Descending" Boolean="false" />
        </Record>
        -->
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
        <AnnotationPath>@UI.Chart#Eval_by_Country</AnnotationPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 3 — Configure sorting in ABAP CDS view annotations

**DESCRIPTION**: Add @UI.PresentationVariant to your ABAP CDS view definition. Use sortOrder with one or more entries (by: '<FIELD>') and optional qualifier. This example sorts by SALES descending. Place this in your CDS source file (.cds or .abap) for the view.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.PresentationVariant: [
  {
    groupBy: [
      'COUNTRY'
    ],
    sortOrder: [
      {
        by: 'SALES'   // primary sort by SALES
        // for descending order, some ABAP CDS environments require additional attributes or separate annotations;
        // if supported, add: direction: #DESC or specify accordingly in your environment
      }
    ],
    visualizations: [
      {
        type: #AS_CHART,
        qualifier: 'Eval_by_Country'
      }
    ],
    qualifier: 'Eval_by_Country'
  }
]
annotate view VIEWNAME with {
  // view element annotations or field annotations go here
}
```

**STEP**: 4 — Configure sorting in CAP CDS

**DESCRIPTION**: Use UI.PresentationVariant in CAP CDS (annotations file or within the model) to define GroupBy, SortOrder, and Visualizations. The SortOrder collection supports Property and Descending flag. Insert into your .cds or annotations configuration.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
// Example CAP CDS presentation variant (e.g., in annotations.cds or the model file)
UI.PresentationVariant #Eval_by_Country : {
    GroupBy : [
        Country
    ],
    SortOrder : [
        {
            Property : Sales,
            Descending : true
        }
        // Add additional sort objects for multi-level sorting:
        // { Property : AnotherField, Descending : false }
    ],
    Visualizations : [
        '@UI.Chart#Eval_by_Country'
    ]
},
```

**STEP**: 5 — Multi-level sorts and usage notes

**DESCRIPTION**: To apply multi-level sorting, include multiple Records (XML) or multiple entries in SortOrder (CDS) in the desired priority order (first entry = highest priority). Cards prefer manifest settings for quick overrides; annotations centralize sorting across multiple consumers. Use annotation qualifiers (Qualifier) to reference specific PresentationVariants.

**LANGUAGE**: JSON / XML / CDS

**CODE**:
```json
// manifest.json: card-level override (highest precedence)
"settings": {
  "sortBy": "Price",
  "sortOrder": "descending"
}
```

```xml
<!-- annotations.xml: multi-level SortOrder (annotation-level) -->
<PropertyValue Property="SortOrder">
  <Collection>
    <Record>
      <PropertyValue Property="Property" PropertyPath="Sales" />
      <PropertyValue Property="Descending" Boolean="true" />
    </Record>
    <Record>
      <PropertyValue Property="Property" PropertyPath="Price" />
      <PropertyValue Property="Descending" Boolean="false" />
    </Record>
  </Collection>
</PropertyValue>
```

**STEP**: 6 — Share sort parameters across apps (Overview Pages)

**DESCRIPTION**: Overview pages can share sort parameters defined in a PresentationVariant to target Fiori Elements apps via external navigation. Configure external navigation to pass the PresentationVariant qualifier or annotation reference so target apps can apply the same sort order. See your project’s external navigation configuration for parameter mapping.

**LANGUAGE**: Reference

**CODE**:
```text
// Reference: Configuring External Navigation
// Use the PresentationVariant qualifier (e.g., Eval_by_Country) in the navigation payload.
// Example concept: pass "presentationVariant=Eval_by_Country" or annotation path to target app.
// See: configuring-external-navigation-1d4a0f9.md
```
--------------------------------

**TITLE**: Configuring Tables (SAP Fiori Elements — OData V4 & V2)

**INTRODUCTION**: Quick, code-focused guide showing how to configure tables in SAP Fiori Elements using annotations (UI.LineItem, UI.PresentationVariant) for OData V4 and SmartTable for OData V2. Includes where to place annotation files, a manifest.json registration example, and runnable XML examples for annotations and views.

**TAGS**: fiori-elements-framework, ODataV4, ODataV2, annotations, UI.LineItem, UI.PresentationVariant, SmartTable, manifest.json

**STEP**: Register annotation files and data sources in manifest.json

**DESCRIPTION**: Place your annotation file (e.g., webapp/annotations.xml) in the app and register it in manifest.json as a dataSource and model so the app loads the annotations at runtime. Example shows a common pattern: main OData service dataSource and an ODataAnnotation dataSource for a local annotations.xml. Adjust URIs and names to match your project layout.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "your.app.id",
    "applicationVersion": { "version": "1.0.0" }
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      },
      "annotationModel": {
        "dataSource": "annotations"
      }
    },
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/Your_Service_SRV/",
        "type": "OData",
        "settings": {}
      },
      "annotations": {
        "uri": "localService/annotations.xml",
        "type": "ODataAnnotation"
      }
    }
  }
}
```

**STEP**: OData V4 — UI.PresentationVariant (control sort/visualization) — place in annotations.xml

**DESCRIPTION**: Define a UI.PresentationVariant to control default sorting and visualization selection. This example creates a PresentationVariant named "Default" that sorts by NetAmount descending and selects the LineItem visualization qualified as Default via AnnotationPath @UI.LineItem#Default. Put this inside your annotations XML file (webapp/localService/annotations.xml or similar) or the service annotation metadata extension.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.PresentationVariant">
  <Record>
    <PropertyValue Property="Text" String="Default"/>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record Type="Common.SortOrderType">
          <PropertyValue Property="Property" PropertyPath="NetAmount"/>
          <PropertyValue Property="Descending" Bool="true"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
         <AnnotationPath>@UI.LineItem#Default</AnnotationPath>
      </Collection>
   </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: OData V4 — UI.LineItem (table columns and actions) — place in annotations.xml

**DESCRIPTION**: Define the table columns, importance, intent-based navigation, and actions via UI.LineItem qualified as "Default". This example shows multiple DataField types including DataField, DataFieldForIntentBasedNavigation, DataFieldForAction. Put this Record Collection into the same annotations XML file and ensure the PresentationVariant Visualizations reference @UI.LineItem#Default (see previous step).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.LineItem" Qualifier="Default">
  <Collection>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="DeliveryCalendarYear"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="DeliveryCalendarMonth"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="SalesOrder"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="Label" String="Manage Sales Order"/>
      <PropertyValue Property="SemanticObject" String="EPMSalesOrder"/>
      <PropertyValue Property="Action" String="manage_st"/>
      <PropertyValue Property="RequiresContext" Bool="false"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Label" String="Item"/>
      <PropertyValue Property="Value" Path="SalesOrderItem"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="Product"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy"/>
      <PropertyValue Property="Action" String="CZ_EASILINEITEMS_SADL_CDS.CZ_EASILINEITEMS_SADLType/Copy"/>
      <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/Isolated"/>
      <PropertyValue Property="Determining" Bool="true"/>
    </Record>
    <Record Type="UI.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="Label" String="Manage Products (STTA)"/>
      <PropertyValue Property="SemanticObject" String="EPMProduct"/>
      <PropertyValue Property="Action" String="manage_st"/>
      <PropertyValue Property="Determining" Bool="true"/>
    </Record>
  </Collection>
</Annotation>
```

**STEP**: OData V2 — SmartTable usage in XML view

**DESCRIPTION**: For OData V2-based Fiori Elements apps using smart controls, use sap.ui.comp.smarttable.SmartTable to render a smart table that reads smart annotations from the metadata. The snippet below shows a basic SmartTable instance in an XML view. Adjust entitySet and control settings as required.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns:smartTable="sap.ui.comp.smarttable">
  <smartTable:SmartTable
    id="SmartTable"
    entitySet="SalesOrderSet"
    tableType="ResponsiveTable"
    useExportToExcel="true"
    header="Sales Orders"
    smartFilterId="smartFilterBar"/>
</mvc:View>
```

**STEP**: Where to place the annotation files (file paths & options)

**DESCRIPTION**: Common file locations and options for annotation placement:
- webapp/localService/annotations.xml — local annotation file referenced in manifest.json.
- annotations can also be provided by the OData service (service annotations) or as a metadata extension file.
- Ensure manifest.json dataSource.uri points to the correct annotation file or service annotation endpoint.

**LANGUAGE**: text

**CODE**:
```text
Recommended file path in app project:
webapp/localService/annotations.xml

Alternative options:
- Server-provided annotations via service metadata
- CDS annotations (when using CAP) -> generate OData annotations or embed UI annotations as XML
```

**STEP**: Related documentation links (keep for implementation reference)

**DESCRIPTION**: Links to more details and related configuration topics.

**LANGUAGE**: text

**CODE**:
```text
SmartTable API (OData V2): https://ui5.sap.com/#/api/sap.ui.comp.smarttable.SmartTable
Tables: Which One Should I Choose? (Fiori Elements docs)
Maintaining Standard Texts for Tables: maintaining-standard-texts-for-tables-aacfac5.md
Maintaining Standard Texts for Charts: maintaining-standard-texts-for-charts-37cd601.md
Setting the Default Column Width: setting-the-default-column-width-a765253.md
Extension Points for Tables: extension-points-for-tables-d525522.md
Configuring Default Settings (Visualizations, Sort Order, Filter Values): configuring-default-settings-visualizations-sort-order-filter-values-49a6ba5.md
```
--------------------------------

**TITLE**: Configure Application Title with @UI.headerInfo.typeName

**INTRODUCTION**: Configure the application title that SAP Fiori launchpad generates for an app (list report, object page, overview page, analytical list report) by setting the @UI.headerInfo.typeName annotation on the relevant entity. Provide the annotation either in CDS (CAP) or in an OData annotation XML file depending on your project.

**TAGS**: fiori-elements-framework, annotations, headerInfo, application-title, CDS, annotations.xml, ODataV2, ALP, overview-page

**STEP**: 1 — Add the title in CDS (CAP / .cds)
**DESCRIPTION**: Set the application title by adding @UI.headerInfo.typeName to the entity used for the list/object/overview/analytical page. Place this in your service or domain CDS file (e.g., srv/schema.cds or db/data-model.cds).
**LANGUAGE**: CDS
**CODE**:
```CDS
namespace my.app;

using { cuid } from '@sap/cds/common';

entity SalesOrder {
  key ID   : UUID;
  Buyer    : String;
  Amount   : Decimal(9,2);
}

/* Option A: nested headerInfo object */
annotate my.app.SalesOrder with {
  @UI.headerInfo: {
    typeName: 'Sales Orders'     /* Application title shown in shell bar */
  }
};

/* Option B: dotted annotation assignment (equivalent) */
annotate my.app.SalesOrder with
  @UI.headerInfo.typeName: 'Sales Orders';
```

**STEP**: 2 — Add the title in an OData V2 annotation XML
**DESCRIPTION**: If your project uses OData annotation files, add the UI.HeaderInfo Term with a TypeName property. Save under webapp/annotations or annotations/<Service>.annotations.xml and register the file in the manifest if needed.
**LANGUAGE**: XML
**CODE**:
```XML
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="1.0" xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx">
  <edmx:DataServices xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata">
    <Annotations Target="MyService.SalesOrder">
      <Annotation Term="UI.HeaderInfo">
        <Record>
          <PropertyValue Property="TypeName" String="Sales Orders"/> <!-- Application title -->
        </Record>
      </Annotation>
    </Annotations>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 3 — Configure title for Overview Page or Analytical List Report
**DESCRIPTION**: For overview pages and analytical list reports, apply the same annotation to the root entity or the entity used by those pages. The runtime uses the annotated entity's TypeName to generate the shell/title.
**LANGUAGE**: XML
**CODE**:
```XML
<!-- Example: overview page root entity -->
<Annotations Target="MyService.OverviewRootEntity">
  <Annotation Term="UI.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeName" String="Overview - My App"/>
    </Record>
  </Annotation>
</Annotations>

<!-- Example: analytical list report entity -->
<Annotations Target="MyService.AnalyticalEntity">
  <Annotation Term="UI.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeName" String="Analytics - Sales"/>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 4 — File placement and manifest registration
**DESCRIPTION**: Place CDS annotations in your .cds model (srv/ or db/). Place OData XML annotations under webapp/annotations or annotations/, e.g. webapp/annotations/MyService.annotations.xml. If required, reference the annotation file in the manifest.json under "sap.ui5" -> "models" -> "<AnnotationsModel>" or ensure the annotation file is exposed by the OData service.
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "annotations": [
            "annotations/MyService.annotations.xml"
          ]
        }
      }
    }
  }
}
```

**STEP**: 5 — Validation and notes
**DESCRIPTION**: After deployment:
- Open the app in Fiori launchpad and verify the title in the shell bar for list report / object page / overview page / analytical list report.
- If title doesn't appear, verify the annotation target (entity name including namespace) matches the service metadata and that the annotation file is loaded or the CDS annotation compiled into service metadata.
- For details on object page header usage and additional header properties, see the object page header sample code in "Setting Up the Object Page Header".
--------------------------------

**TITLE**: Configure Chart-Only Default View and Chart Behavior for Analytical List Page (ALP)

**INTRODUCTION**: This document collects concise, copy-paste-ready manifest and annotation examples to:
- Make the chart-only (visual) view the default for Analytical List Page (ALP)
- Bind chart rendering to specific PresentationVariant/SelectionPresentationVariant qualifiers
- Define the chart (UI.Chart) and PresentationVariant annotations (XML / ABAP CDS / CAP CDS)
- Configure chart behavior: data labels, stable colors, and chartPresentationQualifier
- Enable semantic navigation on chart dimensions

Use these code snippets in your app manifest (manifest.json) and metadata/annotations or CDS files. Keep qualifiers consistent across manifest and annotations (e.g., DefaultVariant, DefaultPresentationVariant, Default).

**TAGS**: AnalyticalListPage, ALP, chart-only, PresentationVariant, SelectionPresentationVariant, UI.Chart, manifest.json, CDS, ODataV2, ODataV4, chartSettings

STEP: 1 — App descriptor (manifest.json) for OData V2 ALP page component
DESCRIPTION: Configure the ALP page entry in manifest.json for OData V2. Include the page entitySet, component name sap.suite.ui.generic.template.AnalyticalListPage and set a settings.qualifier to match the SelectionPresentationVariant qualifier. Optionally include chartPresentationQualifier to select which PresentationVariant to render as chart.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "qualifier": "DefaultVariant",
            "chartPresentationQualifier": "DefaultPresentationVariant"
          }
        }
      }
    ]
  }
}
```

STEP: 2 — App descriptor (manifest.json) for OData V4: use PresentationVariant paths + defaultPath="primary"
DESCRIPTION: For OData V4 ALP, configure the views.paths in manifest.json and set defaultPath to primary so the chart-only (primary) view loads by default. The primary path should reference the PresentationVariant annotation path.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "views": {
              "paths": [
                {
                  "primary": [
                    {
                      "annotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#DefaultPresentationVariant"
                    }
                  ],
                  "secondary": [
                    {
                      "annotationPath": "com.sap.vocabularies.UI.v1.LineItem"
                    }
                  ],
                  "defaultPath": "primary"
                }
              ]
            }
          }
        }
      }
    ]
  }
}
```

STEP: 3 — SelectionPresentationVariant annotation (XML) — qualifier = "DefaultVariant"
DESCRIPTION: Define a SelectionPresentationVariant with qualifier DefaultVariant that points to the SelectionVariant and PresentationVariant qualifiers. This drives the default selection and presentation for the ALP page.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.SelectionPresentationVariant" Qualifier="DefaultVariant">
  <Record>
    <PropertyValue Property="Text" String="Product Financial Analysis"/>
    <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#DefaultSelectionVariant"/>
    <PropertyValue Property="PresentationVariant" Path="@UI.PresentationVariant#DefaultPresentationVariant"/>
  </Record>
</Annotation>
```

STEP: 4 — SelectionPresentationVariant annotation (ABAP CDS)
DESCRIPTION: ABAP CDS equivalent for SelectionPresentationVariant with qualifier DefaultVariant.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.SelectionPresentationVariant: [
  {
    text: 'Product Financial Analysis',
    selectionvariantqualifier: 'DefaultSelectionVariant',
    presentationvariantqualifier: 'DefaultPresentationVariant',
    qualifier: 'DefaultVariant'
  }
]
annotate view VIEWNAME with {
  // annotated elements
}
```

STEP: 5 — SelectionPresentationVariant annotation (CAP CDS)
DESCRIPTION: CAP CDS equivalent for SelectionPresentationVariant with qualifier DefaultVariant.
LANGUAGE: CAP CDS
CODE:
```cds
UI.SelectionPresentationVariant #DefaultVariant : {
    Text : 'Product Financial Analysis',
    SelectionVariant : ![@UI.SelectionVariant#DefaultSelectionVariant],
    PresentationVariant : ![@UI.PresentationVariant#DefaultPresentationVariant]
}
```

STEP: 6 — PresentationVariant annotation (XML) — qualifier = "DefaultPresentationVariant"
DESCRIPTION: PresentationVariant defines sort order and visualizations. Include UI.Chart annotation path in Visualizations to ensure chart rendering with qualifier Default.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.PresentationVariant" Qualifier="DefaultPresentationVariant">
  <Record>
    <PropertyValue Property="Text" String="Default"/>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record Type="Common.SortOrderType">
          <PropertyValue Property="Property" PropertyPath="NetAmount"/>
          <PropertyValue Property="Descending" Bool="true"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
         <AnnotationPath>@UI.Chart#Default</AnnotationPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 7 — PresentationVariant annotation (ABAP CDS)
DESCRIPTION: ABAP CDS PresentationVariant mapping with visualization type AS_CHART and qualifier DefaultPresentationVariant.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.PresentationVariant: [
  {
    text: 'Default',
    sortOrder: [
      {
        by: 'NETAMOUNT',
        direction: #DESC
      }
    ],
    visualizations: [
      {
        type: #AS_CHART,
        qualifier: 'Default'
      }
    ],
    qualifier: 'DefaultPresentationVariant'
  }
]
annotate view VIEWNAME with {
  // annotated elements
}
```

STEP: 8 — PresentationVariant annotation (CAP CDS)
DESCRIPTION: CAP CDS PresentationVariant equivalent referencing UI.Chart#Default.
LANGUAGE: CAP CDS
CODE:
```cds
UI.PresentationVariant #DefaultPresentationVariant : {
    Text : 'Default',
    SortOrder : [
        {
            $Type : 'Common.SortOrderType',
            Property : NetAmount,
            Descending : true
        }
    ],
    Visualizations : [
        '@UI.Chart#Default'
    ]
}
```

STEP: 9 — Chart annotation (XML) — UI.Chart qualifier = "Default"
DESCRIPTION: Define a UI.Chart with Qualifier "Default". Specify ChartType, Dimensions, DimensionAttributes (roles: Category/Series), Measures, and MeasureAttributes including a DataPoint annotation path.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Chart" Qualifier="Default">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Revenue by Customer"/>
    <PropertyValue Property="Description" String="Net Revenue by Customer"/>
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
    <PropertyValue Property="Dimensions">
      <Collection>
        <PropertyPath>SoldToParty</PropertyPath>
        <PropertyPath>DeliveryCalendarYear</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="SoldToParty"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category"/>
        </Record>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="DeliveryCalendarYear"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Series"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Measures">
      <Collection>
        <PropertyPath>NetAmount</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="NetAmount"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
          <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#NetAmount"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 10 — Chart annotation (ABAP CDS)
DESCRIPTION: ABAP CDS version of UI.Chart with qualifier Default and measure DataPoint flag (asDataPoint / DataPoint annotation).
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Chart: [
  {
    title: 'Revenue by Customer',
    description: 'Net Revenue by Customer',
    chartType: #COLUMN,
    dimensions: [
      'SOLDTOPARTY',
      'DELIVERYCALENDARYEAR'
    ],
    dimensionAttributes: [
      {
        dimension: 'SoldToParty',
        role: #CATEGORY
      },
      {
        dimension: 'DeliveryCalendarYear',
        role: #SERIES
      }
    ],
    measures: [
      'NETAMOUNT'
    ],
    measureAttributes: [
      {
        measure: 'NetAmount',
        role: #AXIS_1,
        asDataPoint: true
      }
    ],
    qualifier: 'Default'
  }
]
annotate view VIEWNAME with {
  // annotated elements
}
```

STEP: 11 — Chart annotation (CAP CDS)
DESCRIPTION: CAP CDS UI.Chart definition with qualifier Default including DataPoint reference.
LANGUAGE: CAP CDS
CODE:
```cds
UI.Chart #Default : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Revenue by Customer',
    Description : 'Net Revenue by Customer',
    ChartType : #Column,
    Dimensions : [
        SoldToParty,
        DeliveryCalendarYear
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : SoldToParty,
            Role : #Category
        },
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : DeliveryCalendarYear,
            Role : #Series
        }
    ],
    Measures : [
        NetAmount
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : NetAmount,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#NetAmount'
        }
    ]
}
```

STEP: 12 — Use chartPresentationQualifier in manifest settings (manifest.json snippet)
DESCRIPTION: Use chartPresentationQualifier to force ALP to render the chart based on a specific PresentationVariant qualifier.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "chartPresentationQualifier": "DefaultPresentationVariant"
          }
        }
      }
    ]
  }
}
```

STEP: 13 — Enable data labels and stable colors: chartSettings in manifest.json
DESCRIPTION: Configure chartSettings in manifest.json to show data labels and enable stable colors. Provide dimensionSettings mapping dimension values to specific colors and legendIndex. If a dimension value lacks a color, a default color is used.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCubeALPResults",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "chartSettings": {
              "showDataLabel": true,
              "enableStableColors": true,
              "dimensionSettings": {
                "CostElement": {
                  "400020": {
                    "color": "red",
                    "legendIndex": 0
                  },
                  "421000": {
                    "color": "sapUiChartPaletteSemanticNeutral",
                    "legendIndex": 1
                  },
                  "417900": {
                    "color": "blue",
                    "legendIndex": 2
                  }
                },
                "Customer": {
                  "C000013": {
                    "color": "red",
                    "legendIndex": 0
                  },
                  "C000085": {
                    "color": "blue",
                    "legendIndex": 1
                  }
                },
                "default": {
                  "color": "green"
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 14 — Semantic object annotation for a dimension (XML) — enable semantic navigation from charts
DESCRIPTION: Annotate a chart dimension with a semantic object. Smart Chart will use semantic object navigation parameters when user selects a data point.
LANGUAGE: XML
CODE:
```xml
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="Emp_Line_Item.Item/Cost_Center">
  <Annotation Term="com.sap.vocabularies.Common.v1.SemanticObject" String="CostCenter"/>
</Annotations>
```

STEP: 15 — Semantic object annotation for a dimension (ABAP CDS)
DESCRIPTION: ABAP CDS mapping for assigning a semanticObject to a field (CostCenter) to enable semantic navigation from charts.
LANGUAGE: ABAP CDS
CODE:
```abap
annotate view ITEM with {
  @Consumption.semanticObject: 'CostCenter'
  cost_center;
}
```

STEP: 16 — Quick checklist to enable chart-only default
DESCRIPTION: Apply the following when implementing chart-only default:
- Define SelectionPresentationVariant (qualifier e.g., DefaultVariant) linking SelectionVariant and PresentationVariant.
- Define PresentationVariant (qualifier e.g., DefaultPresentationVariant) including Visualizations -> @UI.Chart#Default.
- Define UI.Chart (qualifier Default) with Dimensions, Measures, and MeasureAttributes.
- Set manifest.json:
  - For OData V2: settings.qualifier = "DefaultVariant" and settings.chartPresentationQualifier = "DefaultPresentationVariant"
  - For OData V4: views.paths with primary referencing PresentationVariant and defaultPath: "primary"
- Optional: enable chartSettings.showDataLabel and chartSettings.enableStableColors and add dimensionSettings color mappings.

LANGUAGE: JSON
CODE:
```json
{
  "checklist": {
    "SelectionPresentationVariant_qualifier": "DefaultVariant",
    "PresentationVariant_qualifier": "DefaultPresentationVariant",
    "Chart_qualifier": "Default",
    "manifest_v2": {
      "settings": {
        "qualifier": "DefaultVariant",
        "chartPresentationQualifier": "DefaultPresentationVariant"
      }
    },
    "manifest_v4": {
      "views": {
        "paths": [
          {
            "defaultPath": "primary"
          }
        ]
      }
    }
  }
}
```
--------------------------------

**TITLE**: Configure Analytical List Page (ALP) Content Area — Annotations and Descriptor Settings

**INTRODUCTION**: Practical, code-focused guidance to:
- Define UI.Chart or UI.LineItem OData annotations to render chart and table content for the ALP content area.
- Configure the ALP descriptor (manifest.json) to set content title, enable FilterableKPI (content tile), and select the default view mode (Table/Chart/Hybrid).
- Notes on dynamic page header pin behavior for responsive tables.

**TAGS**: fiori-elements-framework, analytical-list-page, manifest.json, annotations, UI.Chart, UI.LineItem, FilterableKPI, ALP

STEP: 1 — Add UI.LineItem annotation for the table area

DESCRIPTION: Create or update an annotation file to define the table columns shown in the ALP (UI.LineItem). Save this file in the annotations folder referenced by your application (example: webapp/annotations/annotations.xml). Use PropertyPath entries to map entity properties to DataFields.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/annotations/annotations.xml -->
<Annotations Target="MyService.Namespace.MyEntityType" xmlns="http://docs.oasis-open.org/odata/ns/edm" xmlns:UI="http://docs.oasis-open.org/odata/ns/annotation">
  <Annotation Term="UI.LineItem">
    <Collection>
      <!-- Column 1 -->
      <Record Type="UI.DataField">
        <PropertyValue Property="Value">
          <Path>SalesOrderID</Path>
        </PropertyValue>
        <PropertyValue Property="Label" String="Order ID"/>
      </Record>

      <!-- Column 2 -->
      <Record Type="UI.DataField">
        <PropertyValue Property="Value">
          <Path>CustomerName</Path>
        </PropertyValue>
        <PropertyValue Property="Label" String="Customer"/>
      </Record>

      <!-- Column 3 (numeric measure) -->
      <Record Type="UI.DataField">
        <PropertyValue Property="Value">
          <Path>SalesAmount</Path>
        </PropertyValue>
        <PropertyValue Property="Label" String="Sales Amount"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: 2 — Add UI.Chart annotation for the chart area

DESCRIPTION: Define a UI.Chart annotation for the same entity set. Specify ChartType, Dimensions and Measures. Place this in the same annotations file or a separate one referenced from the manifest.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/annotations/annotations.xml -->
<Annotations Target="MyService.Namespace.MyEntityType" xmlns="http://docs.oasis-open.org/odata/ns/edm" xmlns:UI="http://docs.oasis-open.org/odata/ns/annotation">
  <Annotation Term="UI.Chart">
    <Record>
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>Region</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>SalesAmount</PropertyPath>
        </Collection>
      </PropertyValue>
      <!-- Optional: Chart title and tooltip -->
      <PropertyValue Property="Title" String="Sales by Region"/>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 3 — Add KPI annotation (optional) for content tile / FilterableKPI view

DESCRIPTION: If you want a FilterableKPI tile (the KPI view that appears with segmented buttons), add a KPI annotation and reference it from the descriptor. Example KPI annotation with an ID that will be referenced in the manifest.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/annotations/annotations.xml -->
<Annotations Target="MyService.Namespace.MyEntityType" xmlns="http://docs.oasis-open.org/odata/ns/edm" xmlns:UI="http://docs.oasis-open.org/odata/ns/annotation">
  <!-- KPI definition with an ID -->
  <Annotation Term="UI.KPI" Qualifier="SalesKPI">
    <Record>
      <PropertyValue Property="Value" Path="SalesAmount"/>
      <PropertyValue Property="Title" String="Total Sales"/>
      <!-- Add additional KPI metadata as needed -->
    </Record>
  </Annotation>
</Annotations>
```

STEP: 4 — Configure the ALP descriptor (manifest.json) to wire annotations and set content behavior

DESCRIPTION: Edit webapp/manifest.json to:
- Register your annotations file(s) under sap.app/dataSources (if using local annotation files).
- Configure the AnalyticalListPage component settings to set contentTitle, reference the KPI (contentTile), and choose the default content view (Table, Chart, Hybrid). Use "entitySet" to point to the main entity set.

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/MY_SERVICE_SRV/",
        "type": "OData",
        "settings": { "annotations": ["localAnnotations"] }
      },
      "localAnnotations": {
        "uri": "annotations/annotations.xml",
        "type": "ODataAnnotation",
        "settings": { "localUri": "webapp/annotations/annotations.xml" }
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "contentTitle": "Sales Overview",               // Adds title to content area
            "contentTile": {
              "KPIAnnotationPath": "com.sap.vocabularies.UI.v1.KPI#SalesKPI"
            },
            "defaultContentView": "Hybrid"                 // Valid values: "Table", "Chart", "Hybrid"
          }
        }
      }
    ]
  }
}
```

STEP: 5 — Choose view mode and defaults

DESCRIPTION: The ALP supports three view modes:
- Table only
- Chart only
- Hybrid (chart + table)

Set the default in manifest.json using "defaultContentView" (see Step 4). The segmented buttons (Hybrid/Chart/Table) are provided automatically when both chart and table annotations exist. To force only a single mode, omit the other annotation or set the default and hide other options via custom settings or extensions.

LANGUAGE: JSON

CODE:
```json
// Example choices (already shown in Step 4):
"defaultContentView": "Table"    // starts in table-only mode
"defaultContentView": "Chart"    // starts in chart-only mode
"defaultContentView": "Hybrid"   // default ALP hybrid mode (chart + table)
```

STEP: 6 — Dynamic page header (behavior notes — no code required)

DESCRIPTION: Pin toggle behavior:
- When the ALP uses a responsive table (the default for ALP on desktop/tablet), the dynamic page header is pinnable; a pin toggle is shown to keep the header expanded while scrolling.
- For non-responsive table types, the pin toggle is not available on ALP.
- The pin toggle is not available for 'S' size devices (mobile). No explicit descriptor setting is required for the pin: it appears automatically based on table type and device size.

LANGUAGE: Plain text

CODE:
```text
// Behavior summary (no descriptor change required):
- Responsive table on desktop/tablet -> dynamic page header is pinnable (pin toggle visible)
- Non-responsive tables -> pin toggle not available in ALP
- Mobile ('S' devices) -> pin toggle not available
```

STEP: 7 — File locations and quick checklist

DESCRIPTION: Ensure these files and references are correct in your project.

LANGUAGE: Plain text

CODE:
```text
- Annotations: webapp/annotations/annotations.xml  (contains UI.LineItem, UI.Chart, UI.KPI)
- Descriptor: webapp/manifest.json                  (sap.ui.generic.app.pages -> AnalyticalListPage settings)
- DataSources: manifest.json -> sap.app.dataSources -> annotations registered (localAnnotations)
- Default view: "defaultContentView": "Table" | "Chart" | "Hybrid"
- contentTitle: "Your Content Area Title"
- contentTile.KPIAnnotationPath: Reference to KPI annotation with qualifier (e.g., com.sap.vocabularies.UI.v1.KPI#SalesKPI)
```


--------------------------------

**TITLE**: Configure Quick View Content (QuickViewFacets, HeaderInfo, Contacts, DataPoints, Footer SemanticObject)

**INTRODUCTION**: This document contains ready-to-use annotation examples and precise instructions to configure Quick View content (title area, content area with field groups/contacts/DataPoints, and footer navigation) for SAP Fiori Elements. Includes XML, ABAP CDS, and CAP CDS examples for OData V2 and V4 targets. Use these snippets directly in your annotation files or CDS sources to enable Quick View popovers.

**TAGS**: fiori-elements-framework, quickview, UI.QuickViewFacets, HeaderInfo, FieldGroup, Contact, DataPoint, SemanticObject, ABAP, CAP, XML, CDS

STEP: 1 — Quick View Facets (XML annotation for target entity)
DESCRIPTION: Add UI.QuickViewFacets to a service annotations XML file to include a field group reference, a contact reference, and a DataPoint reference in the Quick View for the specified target entity.
LANGUAGE: XML
CODE:
```xml
<!-- Annotations XML: add to your service annotations file -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType"> 
   <Annotation Term="UI.QuickViewFacets">
      <Collection>
         <!-- Field group reference -->
         <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SupplierQuickViewPOC_FieldGroup_1" />
         </Record>

         <!-- Contact reference -->
         <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Main Contact Person" />
            <PropertyValue Property="Target" AnnotationPath="@Communication.Contact#KeyAccount"/>
         </Record>

         <!-- DataPoint reference -->
         <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="DataPoint in QV"/>
            <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Product"/>
         </Record> 
      </Collection>
   </Annotation>
</Annotations>
```

STEP: 2 — Quick View Facets (ABAP CDS annotation)
DESCRIPTION: Use ABAP CDS annotate view to add Quick View facet references (field group, contact, DataPoint). Place this directly in the CDS view definition or in a separate annotate block.
LANGUAGE: ABAP
CODE:
```abap
annotate view STTA_C_MP_SUPPLIER with {
  @UI.Facet: [
    {
      targetQualifier: 'SupplierQuickViewPOC_FieldGroup_1',
      type: #FIELDGROUP_REFERENCE,
      purpose: #QUICK_VIEW
    },
    {
      label: 'Main Contact Person',
      targetQualifier: 'KeyAccount',
      type: #CONTACT_REFERENCE,
      purpose: #QUICK_VIEW
    },
    {
      label: 'DataPoint in QV',
      targetQualifier: 'Product',
      type: #DATAPOINT_REFERENCE,
      purpose: #QUICK_VIEW
    }
  ]
  supplier;
}
```

STEP: 3 — Quick View Facets (CAP CDS annotation)
DESCRIPTION: Add UI.QuickViewFacets in CAP (CDS) annotation syntax to configure Quick View facets (field group, contact, DataPoint). Use annotate <namespace>.<entity> with @(UI.QuickViewFacets : [...]).
LANGUAGE: CDS
CODE:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_SupplierType with @(
    UI.QuickViewFacets : [
        {
            $Type : 'UI.ReferenceFacet',
            Target : '@UI.FieldGroup#SupplierQuickViewPOC_FieldGroup_1'
        },
        {
            $Type : 'UI.ReferenceFacet',
            Label : 'Main Contact Person',
            Target : '@Communication.Contact#KeyAccount'
        },
        {
            $Type : 'UI.ReferenceFacet',
            Label : 'DataPoint in QV',
            Target : '@UI.DataPoint#Product'
        }
    ]
);
```

STEP: 4 — Footer navigation: SemanticObject using ReferentialConstraint (XML) and register semantic object on property (ABAP/CAP)
DESCRIPTION: When enabling Quick View footer navigation, annotate the navigation target with a SemanticObject. Two common approaches:
- Use existing association where metadata has a ReferentialConstraint (check metadata for the dependent property).
- Create an association and annotate the navigation property or property with a semantic object.

The examples below show:
1) XML Association entry demonstrating a referential constraint in the service metadata.
2) ABAP CDS: annotate Supplier property with a semantic object for consumption.
3) CAP CDS: annotate product property or target entity with Common.SemanticObject and how to mark SemanticKey/Text on the target entity.

LANGUAGE: XML / ABAP / CDS
CODE:
```xml
<!-- 1) Metadata: Association with ReferentialConstraint (service metadata XML fragment) -->
<Association Name="assoc_2CCAF987BA334B3BD1DF2404F50BC9C5" sap:content-version="1">
    <End Type="STTA_PROD_MAN.STTA_C_MP_ProductType" Multiplicity="1" Role="FromRole_assoc_2CCAF987BA334B3BD1DF2404F50BC9C5"/>
    <End Type="STTA_PROD_MAN.STTA_C_MP_SupplierType" Multiplicity="0..1" Role="ToRole_assoc_2CCAF987BA334B3BD1DF2404F50BC9C5"/>
    <ReferentialConstraint>
        <Principal Role="ToRole_assoc_2CCAF987BA334B3BD1DF2404F50BC9C5">
            <PropertyRef Name="Supplier"/>
        </Principal>
        <Dependent Role="FromRole_assoc_2CCAF987BA334B3BD1DF2404F50BC9C5">
            <PropertyRef Name="Supplier"/>
        </Dependent>
    </ReferentialConstraint>
</Association>
```

```abap
" 2) ABAP CDS: annotate property Supplier with Consumption.SemanticObject in product type
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with {
  @Consumption.SemanticObject : 'EPMProduct'
  Supplier
}
```

```cds
// 3) CAP CDS: annotate product type / target entity with Common.SemanticObject and mark SemanticKey/Text on target
// Example: add SemanticObject on property or annotate target entity as semantic key

// a) Annotate ProductType to reference supplier association with semantic object
entity STTA_C_MP_ProductType {
     _Supplier    : Association to STTA_C_MP_SupplierType
          on _Supplier.Supplier = Supplier @(Common : {
                                             Label          : 'Supplier with semantic in navigation',
                                             SemanticObject : 'Customer'
                                             });
}

// b) Target entity: define SemanticKey and Text for SupplierType
entity STTA_C_MP_SupplierType @(
     //…
     title  : 'Supplier type',
     Common : {SemanticKey : [SupplierName]},
     //…
){
     key SupplierID     : String(10) not null @(Common : {
          Label : 'Supplier ID',
          Text  : SupplierName
     });
     SupplierName : String(10)          @(Common : {
          Label : 'Name'
     });
}
```

STEP: 5 — Show Quick View via referenced navigation property fields (FieldGroup examples for Quick View data)
DESCRIPTION: When creating field group data for Quick View, use the navigation path (for example _Supplier) as DataField values. Below are XML, ABAP CDS, and CAP CDS examples showing how to bind DataFields to the navigation property to display QuickView data for Supplier.
LANGUAGE: XML / ABAP / CDS
CODE:
```xml
<!-- XML Annotation: UI.FieldGroup using navigation path _Supplier -->
<Annotation Term="UI.FieldGroup">
     <Record Type="UI.FieldGroupType">
       <PropertyValue Property="Data">
         <Collection>
           <Record Type="UI.DataField">
             <PropertyValue Property="SupplierName" Path="_Supplier"/>
             <PropertyValue Property="Label" String="My QuickView"/>
           </Record>
           <Record Type="UI.DataField">
             <PropertyValue Property="SupplierID" Path="_Supplier"/>
             <PropertyValue Property="Label" String="My QuickView2"/>
           </Record>
         </Collection>
       </PropertyValue>
     </Record>
</Annotation>
```

```abap
" ABAP CDS: UI.fieldGroup for navigation fields (use qualifier/position/label)
@UI.fieldGroup: [
  {
    label: 'Dummy Button'
    type: #STANDARD,
    position: 1 ,
    qualifier: 'My QuickView'
  }
]
_Supplier.supplier;

@UI.fieldGroup: [
  {
    label: 'Dummy Button',
    type: #STANDARD,
    position: 2 ,
    qualifier: 'My QuickView2'
  }
]
_Supplier.supplierID;
```

```cds
// CAP CDS: annotate product type to add UI.FieldGroup data referencing _Supplier navigation
annotate STTA_C_MP_ProductType with @(UI: 
{
    FieldGroup #MyQuickViews: {Data: 
    [{
         $Type : 'UI.DataField',
         Value : _Supplier.SupplierName,
         Label : 'My QuickView'
    },
    {
         $Type : 'UI.DataField',
         Value : _Supplier.SupplierID,  
         Label : 'My QuickView2'
    }]  
    }
})
```

STEP: 6 — Quick View behavior & rules (notes for Title area and Footer)
DESCRIPTION: Use these rules when authoring Quick View annotations (actionable checklist for implementation). No code changes required; follow when choosing annotations and actions.
LANGUAGE: Text
CODE:
```text
- Image selection:
  - OData V2: annotate HeaderInfo.ImageUrl or HeaderInfo.TypeImageUrl. If both are present, ImageUrl is evaluated first.
  - OData V4: if no HeaderInfo.ImageUrl/TypeImageUrl provided, add HeaderInfo.Initials to display initials; otherwise no image.

- Title and description:
  - OData V2: title follows TextArrangement (TextFirst/TextLast/TextOnly). If description empty, title size increases.
  - OData V4: title taken from HeaderInfo.Title. Subtitle from HeaderInfo.Description; if missing, subtitle displays label of source property.
  - If main navigation / primary action is set, title is rendered as a link (note: opening in new tab is restricted on Fiori launchpad).

- Field groups:
  - You can include any number of UI.ReferenceFacet entries pointing to FieldGroup annotations.
  - DataField types supported in QuickView: DataField (with criticality), DataFieldWithUrl (handled by SmartField), DataFieldWithIntentBasedNavigation (interpreted by Fiori elements).

- Contacts:
  - Reference facet must target com.sap.vocabularies.Communication.v1.Contact.
  - Contact position in Quick View follows the order of ReferenceFacet entries.
  - If contact title area duplicates HeaderInfo title area (picture/title/description), contact title area is suppressed.

- DataPoints:
  - Reference a UI.DataPoint by annotation path; label comes from the ReferenceFacet Record.

- Footer actions:
  - Important targets: mark actions with sap-tag parameter 'superiorAction' to show by default in footer.
  - If no superiorAction set, the first three actions are shown by default.
  - Users can personalize footer actions via "More Links" popover.
  - When no QuickView annotations are present or targets can't be resolved at runtime, the field may still appear as a link and show an error message on click.
```

--------------------------------

**TITLE**: Configure Delete Confirmation Dialog Text (UI.HeaderInfo + i18n) for SAP Fiori Elements

**INTRODUCTION**: This guide shows how to configure the text shown in the Delete confirmation dialog by:
- Defining UI.HeaderInfo (XML / ABAP CDS)
- Mapping dialog behavior to UI.HeaderInfo combinations
- Overriding dialog text via i18n resource keys for OData V2 and OData V4
Use these examples to update annotations and to provide localized/overridden messages in your application's i18n files (webapp/i18n/i18n.properties).

**TAGS**: fiori-elements-framework, UI.HeaderInfo, i18n, delete-dialog, OData V2, OData V4, ABAP, XML

**STEP**: 1 — Define UI.HeaderInfo (OData V2) — XML Annotation (Title + Description)
**DESCRIPTION**: Add a UI.HeaderInfo annotation to the entitySet metadata to provide Title and Description values. When both Title and Description are present, the Delete dialog may show both pieces of information (behavior differs in Flexible Column Layout vs Fullscreen).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Example: metadata (annotations for entitySet) -->
<Annotation Term="UI.HeaderInfo">
  <Record>
    <PropertyValue Property="TypeName" String="Sales Order" />
    <PropertyValue Property="TypeNamePlural" String="Sales Orders" />
    <PropertyValue Property="Title">
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="so_id" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="Description">
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" String="Sales Order" />
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 2 — Define UI.HeaderInfo (OData V2) — ABAP CDS Annotation (Title + Description)
**DESCRIPTION**: Equivalent ABAP CDS annotation snippet. Use this in CDS view source to set header information used by Fiori Elements (title and description).
**LANGUAGE**: CDS / ABAP
**CODE**:
```abap
@UI.headerInfo: {
  typeName: 'Sales Order',
  typeNamePlural: 'Sales Orders',
  title: {
    value: 'SO_ID',
    type: #STANDARD
  },
  description: {
    type: #STANDARD
  }
}
annotate view SALESORDERMANAGE with { }.
```

**STEP**: 3 — UI.HeaderInfo variants and their Delete-dialog behavior (OData V2)
**DESCRIPTION**: For OData V2 the dialog text shown depends on presence of Title and Description in UI.HeaderInfo and on layout mode (Flexible Column Layout (FCL) vs Fullscreen). Map the annotation state to the i18n keys to override dialog text.
- UI.HeaderInfo has both Title and Description:
  - Main Object (List Report / Main Object page):
    - FCL: use i18n key DELETE_WITH_OBJECTINFO
    - Fullscreen: use i18n key DELETE_WITH_OBJECTTITLE
  - Sub Entity (object page tables / subobject):
    - FCL: DELETE_SELECTED_ITEM_WITH_OBJECTINFO
    - Fullscreen: DELETE_SELECTED_ITEM_WITH_OBJECTTITLE
- UI.HeaderInfo has only Title:
  - Main Object: DELETE_WITH_OBJECTTITLE
  - Sub Entity: DELETE_SELECTED_ITEM_WITH_OBJECTTITLE
- UI.HeaderInfo has neither Title nor Description:
  - Main Object: ST_GENERIC_DELETE_SELECTED
  - Sub Entity: DELETE_SELECTED_ITEM
**LANGUAGE**: plain
**CODE**:
```text
# Mapping summary (OData V2)
# Main object (List Report / Main Object page)
UI.HeaderInfo: Title + Description => FCL: DELETE_WITH_OBJECTINFO
UI.HeaderInfo: Title + Description => Fullscreen: DELETE_WITH_OBJECTTITLE
UI.HeaderInfo: Title only            => DELETE_WITH_OBJECTTITLE
UI.HeaderInfo: none                  => ST_GENERIC_DELETE_SELECTED

# Sub entity (object page tables / subobject)
UI.HeaderInfo: Title + Description => FCL: DELETE_SELECTED_ITEM_WITH_OBJECTINFO
UI.HeaderInfo: Title + Description => Fullscreen: DELETE_SELECTED_ITEM_WITH_OBJECTTITLE
UI.HeaderInfo: Title only            => DELETE_SELECTED_ITEM_WITH_OBJECTTITLE
UI.HeaderInfo: none                  => DELETE_SELECTED_ITEM
```

**STEP**: 4 — Override OData V2 Delete dialog messages via i18n (example)
**DESCRIPTION**: Put these keys in your application i18n resource file (path example: webapp/i18n/i18n.properties). Replace the sample values with the localized or custom messages you need. Use placeholders if required by your app and ensure the keys match the mapping in STEP 3.
**LANGUAGE**: properties
**CODE**:
```properties
# webapp/i18n/i18n.properties - OData V2 delete dialog overrides (examples)
DELETE_WITH_OBJECTINFO=Delete \"{0}\" ({1})? This action cannot be undone.
DELETE_WITH_OBJECTTITLE=Delete \"{0}\"? This action cannot be undone.
ST_GENERIC_DELETE_SELECTED=Delete selected item(s)? This action cannot be undone.

DELETE_SELECTED_ITEM_WITH_OBJECTINFO=Delete selected item \"{0}\" ({1})?
DELETE_SELECTED_ITEM_WITH_OBJECTTITLE=Delete selected item \"{0}\"?
DELETE_SELECTED_ITEM=Delete selected item(s)?
```

**STEP**: 5 — Behavior and i18n keys for OData V4
**DESCRIPTION**: For OData V4, the List Report delete message currently does not consider UI.HeaderInfo; object page header delete considers HeaderInfo (both Title and Description). Map V4 delete scenarios to i18n keys you can override:
- Delete from List Report: C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR (generic default; overrideable)
- Delete from Object Page (Header): C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO (considers UI.HeaderInfo.Title and UI.HeaderInfo.Description)
- Delete from Object or Subobject Page Table: C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR
**LANGUAGE**: plain
**CODE**:
```text
# Mapping summary (OData V4)
Delete from List Report (generic):            C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR
Delete from Object Page Header (uses HeaderInfo): C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO
Delete from Object/Subobject Page Table:      C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR
```

**STEP**: 6 — Override OData V4 delete messages via i18n (example)
**DESCRIPTION**: Add these keys to webapp/i18n/i18n.properties to override the default V4 delete confirmation messages. Adjust messages and placeholders for your UI and localization requirements.
**LANGUAGE**: properties
**CODE**:
```properties
# webapp/i18n/i18n.properties - OData V4 delete dialog overrides (examples)
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR=Delete \"{0}\"? This action cannot be undone.
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO=Delete \"{0}\" ({1})? This action cannot be undone.
```

**STEP**: 7 — Implementation notes and verification
**DESCRIPTION**: When you override the messages:
- Ensure i18n keys are added to the application i18n file(s) (webapp/i18n/i18n.properties and language-specific variants).
- Revisit UI.HeaderInfo annotation texts if you override messages that expect Title/Description content (so displayed tokens/values are meaningful).
- Test deletion flows in both Flexible Column Layout and Fullscreen modes, and test List Report vs Object Page vs Table deletes to ensure the intended key is used and placeholders resolve correctly.
**LANGUAGE**: plain
**CODE**:
```text
# Checklist
- Add/modify UI.HeaderInfo in metadata/CDS as appropriate.
- Add corresponding i18n keys to webapp/i18n/i18n.properties.
- Rebuild/deploy app and verify delete dialogs in:
  - List Report
  - Object Page Header
  - Object Page / Subobject tables
- Update UI.HeaderInfo Title/Description text if custom delete messages assume specific tokens.
```
--------------------------------

**TITLE**: Configure Delete Confirmation Dialog Text (Fiori Elements)

**INTRODUCTION**: This guide shows how to customize the text shown in the Delete confirmation dialog for SAP Fiori elements (OData V2 and V4). It covers which i18n keys to override and how to ensure the dialog shows the desired contextual value by configuring the UI HeaderInfo Title annotation (XML and ABAP CDS examples included).

**TAGS**: fiori-elements, i18n, delete-dialog, HeaderInfo, annotations, ODataV2, ODataV4, SAPUI5

STEP: 1 — Override i18n key for OData V2

DESCRIPTION: In OData V2-based Fiori elements apps the framework text for the delete confirmation dialog is controlled by the i18n key ST_GENERIC_DELETE_SELECTED. Add or update this key in your app's i18n file (webapp/i18n/i18n.properties or similar). Use a placeholder for the Title value that will be filled from the HeaderInfo.Title annotation.

LANGUAGE: Properties

CODE:
```properties
# webapp/i18n/i18n.properties
# {0} will be replaced by the value sourced from HeaderInfo Title (e.g. the ID or name shown in the dialog)
ST_GENERIC_DELETE_SELECTED=Delete Object {0}?
```

STEP: 2 — Ensure dialog context comes from HeaderInfo Title (XML annotation)

DESCRIPTION: The string inserted into the delete dialog comes from the HeaderInfo Title annotation. Map Title to the entity property you want displayed in the dialog (for example so_id). Add this UI.HeaderInfo annotation to your service metadata annotations or annotation file.

LANGUAGE: XML

CODE:
```xml
<!-- Example XML annotation: map HeaderInfo Title to the so_id property -->
<Annotation Term="UI.HeaderInfo">
  <Record>
    <PropertyValue Property="TypeName" String="Sales Order"/>
    <PropertyValue Property="TypeNamePlural" String="Sales Orders"/>
    <PropertyValue Property="Title">
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="so_id"/>
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 3 — Ensure dialog context comes from HeaderInfo Title (ABAP CDS annotation)

DESCRIPTION: If you use ABAP CDS annotations, set UI.headerInfo.title to map the Title shown in the dialog. The example below shows an ABAP CDS view headerInfo that defines the Title value.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.headerInfo: {
  typeName: 'Sales Order',
  typeNamePlural: 'Sales Orders',
  title: {
    value: 'SO_ID',
    type: #STANDARD
  }
}
annotate view STTA_C_MP_PRODUCT with {
  // additional annotations (if required)
}
```

STEP: 4 — Override delete dialog keys for OData V4

DESCRIPTION: In OData V4-based Fiori elements apps, override keys that start with C_TRANSACTION_HELPER_CONFIRM_DELETE in your custom i18n file. Place entries in webapp/i18n/i18n.properties (or the JSON variant) to customize the confirmation texts. Use placeholders ({0}, {1}, ...) to receive context values.

LANGUAGE: Properties

CODE:
```properties
# webapp/i18n/i18n.properties (OData V4)
# Example override - {0} will contain the Title/context value provided by the framework
C_TRANSACTION_HELPER_CONFIRM_DELETE_DEFAULT=Delete {0}?
# Add other C_TRANSACTION_HELPER_CONFIRM_DELETE* keys as needed to cover different dialog variants
```

LANGUAGE: JSON

CODE:
```json
// webapp/i18n/i18n.json (UI5 JSON i18n)
{
  "C_TRANSACTION_HELPER_CONFIRM_DELETE_DEFAULT": "Delete {0}?"
}
```

STEP: 5 — File locations and usage notes

DESCRIPTION: Place i18n changes in your application's i18n files (common paths: webapp/i18n/i18n.properties or webapp/i18n/i18n.json). Ensure the HeaderInfo annotation is part of the service metadata annotations (annotation XML file or CDS annotations) so the framework can supply the Title value to the dialog.

LANGUAGE: Text

CODE:
```text
Recommended file locations:
- i18n properties: webapp/i18n/i18n.properties
- i18n JSON:      webapp/i18n/i18n.json
- XML annotations: annotations/annotations.xml  (or include in your service metadata)
- ABAP CDS: annotated in the CDS view source as shown above
```
--------------------------------

**TITLE**: Configuring the Dynamic Link List Card (sap.ovp.cards.linklist)

**INTRODUCTION**: This guide shows how to configure the Dynamic Link List Card (sap.ovp.cards.linklist) to display list items (links, images, icons), support carousel or standard flavors, enable quick-view via contact annotations, and configure navigation (intent-based, function import, external URL).

**TAGS**: fiori-elements, ovp, linklist, headerAnnotationPath, UI.HeaderInfo, contact, navigation, annotations, CDS, ABAP, XML, JSON

**STEP**: 1 — Descriptor (card) settings

**DESCRIPTION**: Add or update the card descriptor in your OVP manifest/descriptor. Set listFlavor to "standard" or "carousel", point headerAnnotationPath to a UI.HeaderInfo qualifier, configure entitySet, sorting, and defaultSpan. This JSON fragment is an example card configuration.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "card017": {
    "model": "salesOrder",
    "template": "sap.ovp.cards.linklist",
    "settings": {
      "title": "Standard Dynamic Linklist Card",
      "targetUri": "https://en.abc.org/wiki/xyz_2",
      "subTitle": "Smartlink Feature Test",
      "listFlavor": "standard",
      "entitySet": "ProductSet",
      "sortBy": "Name",
      "sortOrder": "ascending",
      "headerAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#header1",
      "defaultSpan": {
        "rows": 20,
        "cols": 2
      }
    }
  }
}
```

**STEP**: 2 — Configure UI.HeaderInfo (list title, subtitle, item picture/icon)

**DESCRIPTION**: Use UI.HeaderInfo annotation (with qualifier referenced by headerAnnotationPath) to map: Title (list title), Description (list subtitle), TypeImageUrl or ImageUrl (list item icon/picture). The carousel uses the same image mapping; clicking the carousel image behaves like clicking the title.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo" Qualifier="header1">
   <Record Type="com.sap.vocabularies.UI.v1.HeaderInfoType">
      <PropertyValue Property="TypeName" String="Product" />
      <PropertyValue Property="TypeNamePlural" String="Products" />
      <PropertyValue Property="Title">
         <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Label" String="Product Name" />
            <PropertyValue Property="Value" Path="Name" />
         </Record>
      </PropertyValue>
      <PropertyValue Property="Description">
         <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Label" String="Product Description" />
            <PropertyValue Property="Value" Path="Description" />
         </Record>
      </PropertyValue>
      <PropertyValue Property="TypeImageUrl" Path="ImageUrl" />
   </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.headerInfo: {
  typeName: 'Product',
  typeNamePlural: 'Products',
  title: {
    label: 'Product Name',
    value: 'NAME',
    type: #STANDARD
  },
  description: {
    label: 'Product Description',
    value: 'DESCRIPTION',
    type: #STANDARD
  }
}
annotate view VIEWNAME with { 

}
```

**LANGUAGE**: CDS

**CODE**:
```cds
UI.HeaderInfo #header1 : {
    $Type : 'UI.HeaderInfoType',
    TypeName : 'Product',
    TypeNamePlural : 'Products',
    Title : {
        $Type : 'UI.DataField',
        Label : 'Product Name',
        Value : Name
    },
    Description : {
        $Type : 'UI.DataField',
        Label : 'Product Description',
        Value : Description
    },
    TypeImageUrl : ImageUrl
},
```

**STEP**: 3 — Configure contact annotation (quick view / popover)

**DESCRIPTION**: Provide a communication contact annotation to enable quick view popovers when clicking the title. Map fields as follows:
- fn -> Full name (headline in contact popover)
- photo -> Picture URL for header
- role -> description text in header
- tel -> collection of phone numbers; types determine display:
  - [work, preferred] -> displayed as Phone
  - [cell, work] -> displayed as Mobile
  - fax -> Fax
- email -> collection; types [work, preferred] -> displayed as E-Mail

Include one of the following annotation styles depending on your metadata approach.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.Communication.v1.Contact">
   <Record>
       <PropertyValue Property="fn" Path="FullName" />
      <PropertyValue Property="title" Path="Title" />
      <PropertyValue Property="org" Path="CompanyName" />
      <PropertyValue Property="role" Path="OrganizationRole" />
      <PropertyValue Property="tel">
         <Collection>
            <Record>
               <PropertyValue Property="type"
                  EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/fax" />
               <PropertyValue Property="uri" Path="FaxNumber" />
            </Record>
            <Record>
               <PropertyValue Property="type"
                  EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/work com.sap.vocabularies.Communication.v1.PhoneType/preferred" />
               <PropertyValue Property="uri" Path="PhoneNumber" />
            </Record>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="email">
         <Collection>
            <Record>
               <PropertyValue Property="type"
                  EnumMember="com.sap.vocabularies.Communication.v1.ContactInformationType/preferred com.sap.vocabularies.Communication.v1.ContactInformationType/work" />
               <PropertyValue Property="address" Path="EmailAddress" />
            </Record>
         </Collection>
      </PropertyValue>
   </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
define view VIEWNAME
{
  @Semantics.name.fullName: true
  FullName,

  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK, #PREF]
  EmailAddress,
   
  @Semantics.telephone.type:  [ #FAX ] 
  FaxNumber,
  
  @Semantics.telephone.type:  [ #PREF , #WORK]
  PhoneNumber,

  @Semantics.name: { jobTitle: true }   
  Title,

  @Semantics.organization: { name: true }
  CompanyName,

  @Semantics.organization: { role: true, unit: true }
  OrganizationRole
}
```

**LANGUAGE**: CDS

**CODE**:
```cds
Communication.Contact : {
    fn : FullName,
    title : Title,
    org : CompanyName,
    role : OrganizationRole,
    tel : [
        {
            type : #fax,
            uri : FaxNumber
        },
        {
            type : [ #work, #pref ],
            uri : PhoneNumber
        }
    ],
    email : [
        {
            type : [ #pref, #work ],
            address : EmailAddress
        }
    ]
}
```

**STEP**: 4 — Configure navigation (intent, function import, external URL)

**DESCRIPTION**: The link list supports three navigation types. Implement the appropriate annotation so item titles or lines navigate correctly.

- Intent-based navigation: set SemanticObject and Action in UI.Identification (or in UI.Identification of the entity). This enables intent navigation from the line item and (when contact exists) quick view on title.
- Function import (DataFieldForAction): define Action in UI.LineItem to trigger an OData action/function import.
- External navigation: define UI.LineItem entries of type WITH_URL and set url property to the field that contains the external URL.

The examples below illustrate XML annotation patterns for intent-based and LineItem navigation.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Intent-based navigation via UI.Identification -->
<Annotation Term="com.sap.vocabularies.UI.v1.Identification">
  <Record>
    <PropertyValue Property="SemanticObject" String="Product" />
    <PropertyValue Property="Action" String="display" />
  </Record>
</Annotation>

<!-- LineItem with DataFieldForAction (function import / OData action) -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
      <PropertyValue Property="Label" String="Trigger Action" />
      <PropertyValue Property="Action" String="MyFunctionImport" />
    </Record>
    <!-- External URL LineItem -->
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldWithUrl">
      <PropertyValue Property="Label" String="Open External" />
      <PropertyValue Property="Url" Path="ExternalUrlField" />
    </Record>
  </Collection>
</Annotation>
```

**STEP**: 5 — Navigation behavior summary (when clicking title vs line item)

**DESCRIPTION**: Use these rules to predict behavior based on annotations present:

- If UI.Identification Action OR LineItem Action OR LineItem Url is present:
  - Navigation is available from the line item.
- If any of the above AND the default contact annotation exists:
  - Navigation is available from the line item AND quick view (contact popover) is shown when clicking the title.
- If only the default contact annotation exists:
  - Clicking the title shows quick view (popover) but line item navigation may not be present.
- If none of the navigation or contact annotations exist:
  - Only the label/text is displayed (no navigation, no quick view).

Use these guidelines to combine HeaderInfo, Contact, and Navigation annotations to achieve the desired UX for each link list card.
--------------------------------

**TITLE**: Configuring the Global Filter (sap.ovp — manifest.json)

**INTRODUCTION**: Practical, code-focused guide to configure the global SmartFilterBar for OVP applications. Covers: global filter binding, enabling basic search, configuring semantic date ranges (dateSettings), and a minimal stub for a custom date-range implementation referenced from manifest.json.

**TAGS**: sap.ovp, SmartFilterBar, globalFilter, manifest.json, dateSettings, semanticDateRange, SAPUI5

**STEP**: 1 — Configure Global Filter (manifest.json)

**DESCRIPTION**: Add the global filter settings in the sap.ovp section of your manifest.json. Set the OData model to use for the global filter, define the entity set that contains filterable properties (use globalFilterEntitySet from SAPUI5 1.54+). Optionally include the deprecated globalFilterEntityType for older SAPUI5 versions (marked deprecated).

Ensure that cards you want filtered expose properties with the same property names in their entity type / entity set.

Preserve manifest context; this is a fragment to merge into the top-level manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "_version": "1.1.0",
    "globalFilterModel": "ZCD204_EPM_DEMO_SRV",
    "globalFilterEntityType": "SalesOrder",
    "globalFilterEntitySet": "SalesOrders",
    "cards": {
      "...": "card configurations go here"
    }
  }
}
```

**STEP**: 2 — Enable Basic Search on SmartFilterBar

**DESCRIPTION**: Enable the basic search field on the SmartFilterBar by setting showBasicSearch to true in sap.ovp in manifest.json (descriptor). Basic search works only when the entity type/metadata supports search:
- The property or entity must have sap:searchable="true" in the OData metadata.
- The entity set should expose SearchRestrictions annotation.

Add the flag into the same sap.ovp block.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "_version": "1.1.0",
    "showBasicSearch": true,
    "globalFilterModel": "ZCD204_EPM_DEMO_SRV",
    "globalFilterEntitySet": "SalesOrders"
  }
}
```

**STEP**: 3 — Configure Semantic Date Ranges (dateSettings)

**DESCRIPTION**: Configure semantic date ranges (semantic selections such as LASTYEAR, NEXT, QUARTER, etc.) under sap.ovp.filterSettings.dateSettings in manifest.json.

Key behaviors and rules:
- dateSettings.useDateRange (boolean) takes precedence when defined.
- If dateSettings.useDateRange is missing and sap.ovp.useDateRangeType exists, the system uses useDateRangeType.
- If both dateSettings.useDateRange and sap.ovp.useDateRangeType are defined, the app fails to load (error).
- If useDateRange is false, dateSettings fields (customDateRangeImplementation, selectedValues/exclude) are still applied to configure date filters.
- Per-property settings override defaults. customDateRangeImplementation (string) takes precedence over selectedValues/exclude for that property.
- selectedValues is a comma-separated list of standard date tokens. exclude is boolean (default true). If exclude=true, the listed selectedValues are removed from the list. If exclude=false, only the listed values are shown.

Example manifest fragment showing dateSettings with defaults and per-field overrides. Merge this into sap.ovp.filterSettings.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "_version": "1.1.0",
    "filterSettings": {
      "dateSettings": {
        "useDateRange": true,
        "selectedValues": "DAYS,WEEK,MONTH,DATERANGE,QUARTER,YEAR",
        "fields": {
          "DateProperty1": {
            "selectedValues": "TOMORROW,NEXT,LASTYEAR,LAST2WEEKS,LAST3WEEKS,LAST4WEEKS,LAST5WEEKS,YEARTODATE,QUARTER1,QUARTER2,QUARTER3,QUARTER4",
            "exclude": true
          },
          "DateProperty2": {
            "customDateRangeImplementation": "my.app.ext.controller.customDateRangeType",
            "selectedValues": "FROM,TO,DAYS,WEEK,MONTH,DATERANGE,TODAY,TOMORROW,YEAR,YESTERDAY",
            "exclude": true
          },
          "DateProperty3": {
            "selectedValues": "YESTERDAY",
            "exclude": false
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Optional: Custom Date Range Implementation Stub (JavaScript)

**DESCRIPTION**: If you reference a customDateRangeImplementation in manifest.json, implement a module that exposes the API expected by your application/template. The exact API depends on your SmartFilterBar/template; below is a minimal SAPUI5 module skeleton to register and expose custom range entries (adjust method names and return format to your template requirements).

Place this file at the module path referenced in manifest.json (example: webapp/ext/controller/customDateRangeType.js corresponds to "my.app.ext.controller.customDateRangeType").

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define([], function() {
  "use strict";

  // Example skeleton for a custom date range provider.
  // Implement the actual methods required by your SmartFilterBar/template.
  return {
    /**
     * getCustomRanges
     * Return an array of custom date range descriptors your template expects.
     * Modify to match the expected format for the SmartFilterBar/date range integration.
     */
    getCustomRanges: function() {
      return [
        {
          key: "CUSTOM_LAST_10_DAYS",
          label: "Last 10 Days",
          // payload format depends on your template's consumer
          from: "NOW-10DAYS",
          to: "NOW"
        },
        {
          key: "CUSTOM_NEXT_30_DAYS",
          label: "Next 30 Days",
          from: "NOW",
          to: "NOW+30DAYS"
        }
      ];
    }

    // Add any other methods required by your SmartFilterBar integration.
  };
});
```
--------------------------------

**TITLE**: Configuring the List Area (LineItem, DataPoint, Contact, and Navigation Annotations)

**INTRODUCTION**: Action-oriented reference for implementing list-area UI annotations (LineItem) and optional DataFieldForAnnotation entries (DataPoint, Contact) plus navigation (intent-based and URL) in XML, ABAP CDS, and CAP CDS formats. Use these snippets to configure what fields show in list cards and how they behave (numeric formatting, quick-view contact, navigation).

**TAGS**: fiori-elements-framework, UI.LineItem, DataField, DataPoint, Contact, IntentBasedNavigation, DataFieldWithUrl, XML, ABAP CDS, CAP CDS

**STEP**: 1 — Define DataField values for the list (LineItem)
**DESCRIPTION**: Add UI.LineItem annotations to display properties as list entries. Include DataField records for simple text fields and DataFieldForAnnotation entries to reference DataPoint or other annotations. Use the Qualifier when adding a view-specific LineItem (example uses Qualifier="View4").
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Place under the entity's annotations section -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem" Qualifier="View4">
  <Collection>
    <!-- Simple text fields -->
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Order ID" />
      <PropertyValue Property="Value" Path="SalesOrderID" />
    </Record>

    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Customer (Email)" />
      <PropertyValue Property="Value" Path="ToBusinessPartner/EmailAddress" />
    </Record>

    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Customer Name" />
      <PropertyValue Property="Value" Path="CustomerName" />
    </Record>

    <!-- Reference a DataPoint annotation (defined separately) -->
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
      <PropertyValue Property="Label" String="TaxAmount" />
      <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.DataPoint#TaxAmount" />
    </Record>
  </Collection>
</Annotation>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
/* In your CDS view source: attach @UI.lineItem entries for each field (qualifier View4) */

@UI.lineItem: [{
  label: 'Order ID',
  position: 10,
  qualifier: 'View4'
}]
SALESORDERID;

@UI.lineItem: [{
  label: 'Customer (Email)',
  value: '_BUSINESSPARTNER.EMAILADDRESS',
  position: 20,
  qualifier: 'View4'
}]
TOBUSINESSPARTNER/EMAILADDRESS;

@UI.lineItem: [{
  label: 'Customer Name',
  position: 30,
  qualifier: 'View4'
}]
CUSTOMERNAME;

/* DataPoint referenced via valueQualifier (DataPoint defined separately) */
@UI.lineItem: [{
  label: 'TaxAmount',
  valueQualifier: 'TaxAmount',
  type: #AS_DATAPOINT,
  position: 40,
  qualifier: 'View4'
}]
PROPERT_NAME;
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
/* In your .cds file UI annotations */
using { UI } from '@sap/cds/common';

annotate MyService.MyEntity with {
  @UI.LineItem #View4 : [
    { $Type : 'UI.DataField', Label : 'Order ID',   Value : SalesOrderID },
    { $Type : 'UI.DataField', Label : 'Customer',   Value : ToBusinessPartner.EmailAddress },
    { $Type : 'UI.DataField', Label : 'Customer',   Value : CustomerName },
    { $Type : 'UI.DataFieldForAnnotation', Label : 'TaxAmount', Target : '@UI.DataPoint#TaxAmount' }
  ];
}
```

**STEP**: 2 — Optional: Define a DataPoint for numeric display in the list
**DESCRIPTION**: Define a DataPoint annotation and reference it from a DataFieldForAnnotation in LineItem to render numeric values (currency, formatting, title). Use matching qualifier (TaxAmount) referenced by Target.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="TaxAmount">
  <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
    <PropertyValue Property="Title" String="TaxAmount" />
    <PropertyValue Property="Value" Path="TaxAmount" />
    <!-- Optionally add format/currency annotations here -->
  </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
/* Define DataPoint on the numeric field (example) */
@UI.dataPoint: {
  title: 'TaxAmount'
}
TaxAmount;
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
/* Define DataPoint with qualifier TaxAmount */
annotate MyService.MyEntity with {
  @UI.DataPoint #TaxAmount : {
    $Type : 'UI.DataPointType',
    Title : 'TaxAmount',
    Value : TaxAmount
  };
}
```

**STEP**: 3 — Optional: Define Contact annotations for quick view contact info
**DESCRIPTION**: Configure Communication.Contact to enable quick-view contact details in the list. Map telephone and email entries to entity properties and use Semantics annotations where needed.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.Communication.v1.Contact">
  <Record>
    <PropertyValue Property="tel">
      <Collection>
        <Record>
          <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/fax" />
          <PropertyValue Property="uri" Path="FaxNumber" />
        </Record>
        <Record>
          <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/work com.sap.vocabularies.Communication.v1.PhoneType/preferred" />
          <PropertyValue Property="uri" Path="PhoneNumber" />
        </Record>
      </Collection>
    </PropertyValue>

    <PropertyValue Property="email">
      <Collection>
        <Record>
          <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.ContactInformationType/preferred com.sap.vocabularies.Communication.v1.ContactInformationType/work" />
          <PropertyValue Property="address" Path="EmailAddress" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
/* Example CDS view fields with semantics for contact quick view */
define view VIEWNAME as select from SomeSource {
  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK]
  EmailAddress,

  @Semantics.telephone.type:  [ #FAX ] 
  FaxNumber,

  @Semantics.telephone.type:  [ #WORK]
  PhoneNumber
}
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
/* Communication.Contact annotation to map tel and email */
annotate MyService.MyEntity with {
  @Communication.Contact : {
    tel : [
      { type : #fax, uri : FaxNumber },
      { type : [ #work, #pref ], uri : PhoneNumber }
    ],
    email : [
      { type : [ #pref, #work ], address : EmailAddress }
    ]
  };
}
```

**STEP**: 4 — Optional: Define navigation properties (intent-based and URL)
**DESCRIPTION**: Configure navigation from a list entry either via intent-based navigation (recommended) using DataFieldForIntentBasedNavigation or via DataFieldWithUrl for a specific route/URL. DataFieldForIntentBasedNavigation uses SemanticObject + Action for Fiori target mapping. DataFieldWithUrl opens a URL/route (overview page recognizes and opens in same tab).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Intent-based navigation: recommended -->
<Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
  <PropertyValue Property="Label" String="Open Sales Order" />
  <PropertyValue Property="SemanticObject" String="SalesOrder" />
  <PropertyValue Property="Action" String="display" />
  <PropertyValue Property="Value" Path="SalesOrderID" />
</Record>

<!-- URL-based navigation to an external app or specific route -->
<Record Type="com.sap.vocabularies.UI.v1.DataFieldWithUrl">
  <PropertyValue Property="Label" String="Open External Site" />
  <PropertyValue Property="Url">
    <Record Type="com.sap.vocabularies.UI.v1.UrlDefinition">
      <!-- either static or composed via Path -->
      <PropertyValue Property="String" String="https://example.com/orders/{SalesOrderID}" />
    </Record>
  </PropertyValue>
</Record>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
/* Intent-based navigation entry in line item (qualifier 'View4') */
@UI.lineItem: [{
  label: 'Open Sales Order',
  type: #FOR_INTENT_BASED_NAVIGATION,
  semanticObject: 'SalesOrder',
  action: 'display',
  value: SALESORDERID,
  qualifier: 'View4'
}]
SALESORDERID;

/* URL-based navigation example (opens route/URL) */
@UI.lineItem: [{
  label: 'Open External Site',
  type: #FOR_URL,
  url: 'https://example.com/orders/{SalesOrderID}',
  qualifier: 'View4'
}]
SALESORDERID.
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
/* Intent-based navigation via DataFieldForIntentBasedNavigation */
annotate MyService.MyEntity with {
  @UI.LineItem : [
    {
      $Type : 'UI.DataFieldForIntentBasedNavigation',
      Label : 'Open Sales Order',
      SemanticObject : 'SalesOrder',
      Action : 'display',
      Value : SalesOrderID
    },
    {
      $Type : 'UI.DataFieldWithUrl',
      Label : 'Open External Site',
      Url : { $Type : 'UI.UrlDefinition', String : 'https://example.com/orders/{SalesOrderID}' }
    }
  ];
}
```

**NOTE**: Use DataFieldForIntentBasedNavigation as the recommended approach for navigation to Fiori targets (semantic object + action). Use DataFieldWithUrl for specific routes or external links not configured in the target map; overview pages interpret such entries as intent-based navigation and open the target in the same tab.
--------------------------------

**TITLE**: Configuring List Card Header Area (titles, KPI and tabs) for SAP Fiori Elements OVP list card

**INTRODUCTION**: This guide shows the exact descriptor and annotation snippets to configure a list card header: card title/subTitle, KPI on the header (kpiAnnotationPath + KPI/DataPoint/PresentationVariant/SelectionVariant annotations), tab-based view switching, and list header navigation behavior. Use the JSON descriptor changes in manifest/descriptor and add the corresponding OData metadata annotations (XML or CDS) to enable analytical headers and switching.

**TAGS**: fiori-elements-framework, ovp, list-card, kpi, datapoint, annotations, descriptor, manifest

**STEP**: 1 — Configure card title and subTitle in the app descriptor

**DESCRIPTION**: Add "title" and "subTitle" to the card settings in the "sap.ovp"/"cards" section of the app descriptor (manifest.json or descriptor file). Use the card ID you need. Keep other card settings (model, entitySet, template) as required.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters",
    "cards": {
      "sap.ovp.test_card.card002": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.list",
        "settings": {
          "title": "Purchase History",
          "subTitle": "SubTitle",
          "entitySet": "SalesOrderSet"
          /* other settings */
        }
      }
    }
  }
}
```

**STEP**: 2a — Point the card to a KPI annotation using descriptor (kpiAnnotationPath)

**DESCRIPTION**: Set "kpiAnnotationPath" under "sap.ovp" in the descriptor to reference the qualified KPI annotation (UI.KPI#Qualifier) that should be used for the card header KPI.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    /* ovp-specific settings */
    "kpiAnnotationPath": "com.sap.vocabularies.UI.v1.KPI#AllActualCosts"
  }
}
```

**STEP**: 2b — KPI annotation (XML) — defines KPI entry + links to DataPoint/PresentationVariant/SelectionVariant

**DESCRIPTION**: Create a UI.KPI annotation with Qualifier and properties: Detail (DefaultPresentationVariant/AlternativePresentationVariants), SelectionVariant, DataPoint, ID, SemanticObject, Action. This example uses Qualifier "AllActualCosts".

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.KPI" Qualifier="AllActualCosts">
  <Record Type="UI.KPIType">
    <PropertyValue Property="Detail">
      <Record Type="UI.KPIDetailType">
        <PropertyValue Property="DefaultPresentationVariant" Path="@UI.PresentationVariant#Eval_by_Currency1" />
        <PropertyValue Property="AlternativePresentationVariants">
          <Collection>
            <Path>@UI.PresentationVariant#Eval_by_Currency_Column</Path>
          </Collection>
        </PropertyValue>
        <PropertyValue Property="SemanticObject" String="Action" />
        <PropertyValue Property="Action" String="toappnavsample" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#Eval_by_Currency_1" />
    <PropertyValue Property="DataPoint" Path="@UI.DataPoint#Eval_by_Country_Generic" />
    <PropertyValue Property="ID" String="String for KPI Annotation" />
  </Record>
</Annotation>
```

**STEP**: 2c — KPI annotation (ABAP CDS) — same as above in ABAP CDS syntax

**DESCRIPTION**: ABAP CDS equivalent of the KPI annotation with qualifier 'AllActualCosts'.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.KPI: [
  {
    detail: {
      defaultPresentationVariantQualifier: 'Eval_by_Currency1',
      alternativePresentationVariantQualifiers: [
        'Eval_by_Currency_Column'
      ],
      semanticObject: 'Action',
      semanticObjectAction: 'toappnavsample'
    },
    selectionVariantQualifier: 'Eval_by_Currency_1',
    id: 'String for KPI Annotation',
    qualifier: 'AllActualCosts'
  }
]
Eval_by_Country-Generic;
```

**STEP**: 2d — KPI annotation (CAP CDS) — same as above in CAP CDS syntax

**DESCRIPTION**: CAP CDS equivalent of the KPI annotation referencing DataPoint and PresentationVariant qualifiers.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.KPI #AllActualCosts : {
    $Type : 'UI.KPIType',
    Detail : {
        $Type : 'UI.KPIDetailType',
        DefaultPresentationVariant : ![@UI.PresentationVariant#Eval_by_Currency1],
        AlternativePresentationVariants : [
            ![@UI.PresentationVariant#Eval_by_Currency_Column]
        ],
        SemanticObject : 'Action',
        Action : 'toappnavsample'
    },
    SelectionVariant : ![@UI.SelectionVariant#Eval_by_Currency_1],
    DataPoint : ![@UI.DataPoint#Eval_by_Country-Generic],
    ID : 'String for KPI Annotation'
};
```

**STEP**: 2e — PresentationVariant annotation (XML) — controls grouping/sorting/MaxItems/Visualizations

**DESCRIPTION**: Define presentation rules referenced by the KPI Detail's DefaultPresentationVariant. Use Qualifier 'Eval_by_Currency1'.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.PresentationVariant" Qualifier="Eval_by_Currency1">
  <Record>
    <PropertyValue Property="MaxItems" Int="5" />
    <PropertyValue Property="GroupBy">
      <Collection>
        <PropertyPath>Country</PropertyPath>
        <PropertyPath>Currency</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record>
          <PropertyValue Property="Property" PropertyPath="TotalSales" />
          <PropertyValue Property="Descending" Bool="true" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
        <AnnotationPath>@UI.Chart#Eval_by_Currency_Donut</AnnotationPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 2f — PresentationVariant (ABAP CDS)

**DESCRIPTION**: ABAP CDS variant equivalent. Qualifier: Eval_by_Currency1.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.PresentationVariant: [
  {
    maxItems: 5,
    groupBy: [
      'COUNTRY',
      'CURRENCY'
    ],
    sortOrder: [
      {
        by: 'TOTALSALES'
      }
    ],
    visualizations: [
      {
        type: #AS_CHART,
        qualifier: 'Eval_by_Currency_Donut'
      }
    ],
    qualifier: 'Eval_by_Currency1'
  }
]
annotate view VIEWNAME with { }
```

**STEP**: 2g — PresentationVariant (CAP CDS)

**DESCRIPTION**: CAP CDS PresentationVariant snippet for Eval_by_Currency1.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.PresentationVariant #Eval_by_Currency1 : {
    MaxItems : 5,
    GroupBy : [
        Country,
        Currency
    ],
    SortOrder : [
        {
            Property : TotalSales,
            Descending : true
        }
    ],
    Visualizations : [
        '@UI.Chart#Eval_by_Currency_Donut'
    ]
};
```

**STEP**: 2h — SelectionVariant annotation (XML)

**DESCRIPTION**: Define filters/parameters applied when the KPI/presentation is used. Qualifier: Eval_by_Currency_1.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.SelectionVariant" Qualifier="Eval_by_Currency_1">
  <Record>
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record>
          <PropertyValue Property="PropertyName" PropertyPath="Country" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record>
                <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                <PropertyValue Property="Low" String="IN" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Parameters">
      <Collection>
        <Record Type="UI.Parameter">
          <PropertyValue Property="PropertyName" PropertyPath="Currency_Target" />
          <PropertyValue Property="PropertyValue" String="EUR" />
        </Record>
        <Record Type="UI.Parameter">
          <PropertyValue Property="PropertyName" PropertyPath="UoM_Target" />
          <PropertyValue Property="PropertyValue" String="KGM" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 2i — SelectionVariant (ABAP CDS)

**DESCRIPTION**: ABAP CDS SelectionVariant sample with qualifier 'Eval_by_Currency_1'.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.SelectionVariant: [
  {
    qualifier: 'Eval_by_Currency_1',
    parameters: [
      { name: 'PropertyName', value: 'CompanyCurrency' },
      { name: 'PropertyValue', value: 'EUR' }
    ]
  }
]
annotate view VIEWNAME with { }
```

**STEP**: 2j — SelectionVariant (CAP CDS)

**DESCRIPTION**: CAP CDS selection variant for Eval_by_Currency_1 showing select options and parameters.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.SelectionVariant #Eval_by_Currency_1 : {
    SelectOptions : [
        {
            PropertyName : Country,
            Ranges : [
                {
                    Sign : #I,
                    Option : #EQ,
                    Low : 'IN'
                }
            ]
        }
    ],
    Parameters : [
        {
            $Type : 'UI.Parameter',
            PropertyName : Currency_Target,
            PropertyValue : 'EUR'
        },
        {
            $Type : 'UI.Parameter',
            PropertyName : UoM_Target,
            PropertyValue : 'KGM'
        }
    ]
};
```

**STEP**: 2k — DataPoint annotation (XML) — define KPI UI display properties and criticality calculation

**DESCRIPTION**: Add a UI.DataPoint annotation (Qualifier referenced by UI.KPI.DataPoint). Key properties: Title (displayed on KPI header), Value (Path or constant), ValueFormat (ScaleFactor / NumberOfFractionalDigits), Criticality or CriticalityCalculation (enum or path — supported enums listed below), TargetValue, TrendCalculation. You can set criticality as enum values or via a path returning 0..3 that map to Neutral/Negative/Critical/Positive.

Supported enum values:
- com.sap.vocabularies.UI.v1.CriticalityType/Neutral
- com.sap.vocabularies.UI.v1.CriticalityType/Negative
- com.sap.vocabularies.UI.v1.CriticalityType/Critical
- com.sap.vocabularies.UI.v1.CriticalityType/Positive

Numeric criticality path mapping:
- 0 => Neutral
- 1 => Negative
- 2 => Critical
- 3 => Positive

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Country_Generic">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Sales India - Generic Card" />
    <PropertyValue Property="Value" Path="Sales" />
    <PropertyValue Property="ValueFormat">
      <Record>
        <PropertyValue Property="ScaleFactor" Decimal="2" />
        <PropertyValue Property="NumberOfFractionalDigits" Int="1" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="CriticalityCalculation">
      <Record>
        <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Minimize" />
        <PropertyValue Property="DeviationRangeHighValue" String="7300" />
        <PropertyValue Property="ToleranceRangeHighValue" String="7200" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="TargetValue" String="2.000" />
    <PropertyValue Property="TrendCalculation">
      <Record>
        <PropertyValue Property="ReferenceValue" String="5201680" />
        <PropertyValue Property="DownDifference" Decimal="10000000.0" />
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 2l — DataPoint (ABAP CDS)

**DESCRIPTION**: ABAP CDS DataPoint example matching the XML above.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.dataPoint: { 
  title: 'Sales India - Generic Card',
  valueFormat: { scaleFactor: 2, numberOfFractionalDigits: 1 },
  criticalityCalculation: { 
    improvementDirection: #MINIMIZE,
    deviationRangeHighValue: 7300,
    toleranceRangeHighValue: 7200
  },
  targetValue: 2.000,
  trendCalculation: { referenceValue: 'refValElement', downDifference: 10000000.0 }
}
Sales;
```

**STEP**: 2m — DataPoint (CAP CDS)

**DESCRIPTION**: CAP CDS DataPoint example with same properties.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.DataPoint #Eval_by_Country-Generic : {
    $Type : 'UI.DataPointType',
    Title : 'Sales India - Generic Card',
    Value : Sales,
    ValueFormat : {
        ScaleFactor : 2,
        NumberOfFractionalDigits : 1
    },
    CriticalityCalculation : {
        ImprovementDirection : #Minimizing,
        DeviationRangeHighValue : '7300',
        ToleranceRangeHighValue : '7200'
    },
    TargetValue : '2.000',
    TrendCalculation : {
        ReferenceValue : '5201680',
        DownDifference : 10000000.0
    }
};
```

**STEP**: 3 — Configure tabs (view switch) in the card descriptor settings

**DESCRIPTION**: Provide a "tabs" array inside the card settings to define multiple views for the card. Each tab maps annotationPath (LineItem qualifier), optional selectionAnnotationPath, presentationAnnotationPath, identificationAnnotationPath, dataPointAnnotationPath, and a display value. Use annotation paths that match your metadata annotations (qualified by #Qualifier).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "cards": {
    "card00": {
      "model": "salesOrder",
      "template": "sap.ovp.cards.list",
      "settings": {
        "category": "Sales Orders With Analytical Header",
        "listFlavor": "bar",
        "listType": "extended",
        "entitySet": "SalesOrderSet",
        "tabs": [
          {
            "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
            "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
            "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line",
            "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
            "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
            "value": "{{dropdown_value1}}"
          },
          {
            "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View2",
            "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#customer",
            "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#SP2",
            "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#item2",
            "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
            "value": "{{dropdown_value2}}"
          }
        ]
      }
    }
  }
}
```

**STEP**: 4 — Configure list header navigation using Identification annotation

**DESCRIPTION**: Use the UI.Identification annotation to configure navigation from header and list area. Note: for list area navigation the LineItem annotation's navigation settings take precedence over Identification annotation navigation settings.

**LANGUAGE**: JSON (descriptor usage note)

**CODE**:
```json
{
  "notes": [
    "Define navigation targets in UI.Identification annotation in metadata to enable header/list navigation.",
    "If both LineItem and Identification provide navigation for list rows, navigation in LineItem takes precedence."
  ]
}
```
--------------------------------

**TITLE**: Configure Object Page Header Title and Description (UI.HeaderInfo)

**INTRODUCTION**: Use UI.HeaderInfo annotations to define the Object Page header Title and Description. This guide provides ready-to-use examples for OData XML annotations, ABAP CDS annotations, and CAP CDS annotations. Use the appropriate snippet for your stack and adapt the entity name and properties to your data model.

**TAGS**: fiori-elements-framework, UI.HeaderInfo, ObjectPage, title, description, annotations, OData, XML, CDS, ABAP, CAP

STEP: 1 — OData XML Annotation for UI.HeaderInfo

DESCRIPTION: Add UI.HeaderInfo annotation to your OData service annotation file (annotations.xml or equivalent). Set Title and Description using UI.DataField records. Use a navigation property path for localized text when needed (example uses to_ProductTextInOriginalLang/Name). Replace Target and Paths to match your service metadata.

LANGUAGE: XML

CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType">
    <Annotation Term="UI.HeaderInfo">
        <Record>
            <PropertyValue Property="Title">
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="to_ProductTextInOriginalLang/Name"/>
                </Record>
            </PropertyValue>
            <PropertyValue Property="Description">
                <Record Type="UI.DataField">
                     <PropertyValue Property="Value" Path="ProductForEdit"/>
                </Record>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: 2 — ABAP CDS Annotation (SAP Gateway / ABAP stack)

DESCRIPTION: Annotate an ABAP CDS view using @UI.headerInfo to configure title and description. Use value references (element names or texts) and set type (#STANDARD or other UI types). Replace view name and values with your CDS view and fields.

LANGUAGE: ABAP CDS

CODE:
```
@UI.headerInfo: {
  title: {
    value: '_PRODUCTTEXTINORIGINALLANG.NAME',
    type: #STANDARD
  },
  description: {
    value: 'PRODUCTFOREDIT',
    type: #STANDARD
  }
}
annotate view STTA_C_MP_PRODUCT with {

}
```

STEP: 3 — CAP CDS Annotation (CAP model annotations file)

DESCRIPTION: Annotate the CAP entity to provide UI.HeaderInfo. Use $Type : 'UI.DataField' and point Value to the entity property or navigation property. Replace namespace, entity name, and property references to match your CAP model.

LANGUAGE: CAP CDS

CODE:
```
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with @(
  UI.HeaderInfo : {
    Title : {
        $Type : 'UI.DataField',
        Value : to_ProductTextInOriginalLang.Name
    },
    Description : {
        $Type : 'UI.DataField',
        Value : ProductForEdit
    }
  }
);
```

STEP: 4 — Implementation Notes

DESCRIPTION: Quick actionable notes to apply and validate changes:
- Ensure the annotation file is deployed with the service (OData XML annotations) or included in the CDS activation (ABAP/CAP).
- Title and Description accept UI.DataField entries; Value can be a Path (XML) or a property reference (CDS).
- For localized texts, use the navigation property to the text entity (example: to_ProductTextInOriginalLang.Name).
- Test the Object Page in a Fiori Elements app to confirm header updates.

STEP: 5 — Related Resource

DESCRIPTION: Guidance on default titles for new/unnamed objects:
- See "Changing Default Titles of New and Unnamed Objects" for replacing system default titles in list reports or object pages.

LANGUAGE: URL

CODE:
```
changing-default-titles-of-new-and-unnamed-objects-63946c0.md
```
--------------------------------

**TITLE**: Configuring the Static Link List Card (sap.ovp.cards.linklist)

**INTRODUCTION**: Action-oriented reference for configuring an OVP "linklist" card with static data. Shows required card settings, staticContent item properties, and two navigation patterns: URL-based and Intent-based. Use these JSON snippets to add static link list cards to your OVP cards configuration.

**TAGS**: fiori-elements-framework, ovp, linklist, staticContent, navigation, card-settings, sap.ovp.cards.linklist

**STEP**: 1 — Configure card-level settings

**DESCRIPTION**: Set basic card settings: title, subTitle and listFlavor (display style). listFlavor accepts at least "standard" or "carousal" to control list rendering.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "cardId_Example": {
    "model": "salesOrder",
    "template": "sap.ovp.cards.linklist",
    "settings": {
      "title": "Quick Links",
      "subTitle": "Standard Link List With Static Data",
      "listFlavor": "standard"
    }
  }
}
```

**STEP**: 2 — Define staticContent items (fields and example)

**DESCRIPTION**: Each staticContent entry represents one list item. Common fields:
- title (string) — required for item label
- subTitle (string) — secondary label
- imageUri (string) — image URL or sap-icon URI (e.g., "sap-icon://Fiori2/F0246")
- imageAltText (string) — alt text for the image
- targetUri (string) — URL for URL-based navigation
- openInNewWindow (boolean) — whether URL opens in new window/tab
- semanticObject (string) & action (string) — for Intent-based navigation
- disableInCard (boolean) — optional, disables in-card action

Example staticContent item:
**LANGUAGE**: JSON

**CODE**:
```json
{
  "title": "Jim Smith",
  "subTitle": "Sales",
  "imageUri": "img/JD.png",
  "imageAltText": "Jim Smith",
  "targetUri": "https://abc.com",
  "openInNewWindow": true
}
```

**STEP**: 3 — URL-based navigation example (targetUri + openInNewWindow)

**DESCRIPTION**: Use targetUri and openInNewWindow to configure URL-based navigation on static list items. This snippet is a complete card configuration containing multiple staticContent items using targetUri navigation.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "card010_QuickLinks": {
    "model": "salesOrder",
    "template": "sap.ovp.cards.linklist",
    "settings": {
      "title": "Quick Links",
      "subTitle": "Standard Link List With Static Data",
      "listFlavor": "standard",
      "staticContent": [
        {
          "title": "Jim Smith",
          "subTitle": "Sales",
          "imageUri": "img/JD.png",
          "imageAltText": "Jim Smith",
          "targetUri": "https://abc.com",
          "openInNewWindow": true
        },
        {
          "title": "Alice Wilson",
          "subTitle": "Sales",
          "imageUri": "img/AW.png",
          "imageAltText": "Alice Wilson",
          "targetUri": "https://abc.com",
          "openInNewWindow": true
        }
      ]
    }
  }
}
```

**STEP**: 4 — Intent-based navigation example (semanticObject + action)

**DESCRIPTION**: Use semanticObject and action to configure intent-based navigation on static list items. Example also demonstrates defaultSpan and disableInCard usage in settings and items.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "card010_QuickLinks": {
    "model": "salesOrder",
    "template": "sap.ovp.cards.linklist",
    "settings": {
      "title": "Quick Links",
      "subTitle": "Standard Link List With Static Data",
      "listFlavor": "standard",
      "defaultSpan": {
        "rows": 15,
        "cols": 1
      },
      "staticContent": [
        {
          "title": "Create Purchase Order",
          "imageUri": "sap-icon://Fiori6/F0865",
          "imageAltText": "{{card30_icon_prod_man}}",
          "semanticObject": "Action",
          "action": "toappnavsample",
          "disableInCard": true
        },
        {
          "title": "Create Supplier",
          "imageUri": "sap-icon://Fiori2/F0246",
          "imageAltText": "{{card30_icon_so_man}}",
          "semanticObject": "Action",
          "action": "toappnavsample"
        },
        {
          "title": "Create Contact",
          "imageUri": "sap-icon://Fiori6/F0866",
          "imageAltText": "{{card30_icon_so_man}}",
          "semanticObject": "Action",
          "action": "toappnavsample"
        }
      ]
    }
  }
}
```
--------------------------------

**TITLE**: Configuring Table Columns (LineItem) and Related Annotations for Fiori Elements

**INTRODUCTION**: This document shows actionable annotation examples to configure the table (LineItem) area in Fiori Elements apps. It includes XML, ABAP CDS, and CAP CDS samples for DataField (table columns), DataFieldForAnnotation (DataPoint), Contact annotations, and templates for intent-based and URL navigation. Use these snippets in your service/annotation files (annotations XML, CDS, or CAP model) to control table column labels, values, numeric formatting, quick view contact display, and navigation.

**TAGS**: fiori-elements-framework, UI.LineItem, DataField, DataPoint, Contact, DataFieldForAnnotation, DataFieldForIntentBasedNavigation, DataFieldWithUrl, ABAP CDS, CAP CDS, XML, CDS

STEP: 1 - Configure LineItem (table columns)

DESCRIPTION: Define table columns using UI.LineItem. Use UI.DataField for simple label/value columns and UI.DataFieldForAnnotation to reference other annotations (e.g., DataPoint). Examples are shown in XML annotation, ABAP CDS, and CAP CDS syntaxes. Replace field names and qualifiers with your own.

LANGUAGE: XML

CODE:
```xml
<!-- XML Annotation: LineItem with DataField and DataFieldForAnnotation -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem" Qualifier="View4">
   <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
         <PropertyValue Property="Label" String="Order ID" />
         <PropertyValue Property="Value" Path="SalesOrderID" />
      </Record>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
         <PropertyValue Property="Label" String="Customer" />
         <PropertyValue Property="Value" Path="ToBusinessPartner/EmailAddress" />
      </Record>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
         <PropertyValue Property="Label" String="Customer" />
         <PropertyValue Property="Value" Path="CustomerName" />
      </Record>
      <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
         <PropertyValue Property="Label" String="TaxAmount" />
         <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.DataPoint#TaxAmount" />
      </Record>
   </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.lineItem: [
  {
    label: 'Order ID',
    position: 10 ,
    qualifier: 'View4'
  }
]
SALESORDERID;

@UI.lineItem: [
  {
    label: 'Customer',
    value: '_BUSINESSPARTNER.EMAILADDRESS',
    position: 20 ,
    qualifier: 'View4'
  }
]
_BUSINESSPARTNER;

@UI.lineItem: [
  {
    label: 'Customer',
    position: 30,
    qualifier: 'View4'
  }
]
CUSTOMERNAME;

@UI.lineItem: [
  {
    label: 'TaxAmount',
    valueQualifier: 'TaxAmount',
    type: #AS_DATAPOINT,
    position: 40,
    qualifier: 'View4'
  }
]
PROPERT_NAME;
```

LANGUAGE: CDS

CODE:
```cds
// CAP CDS: UI.LineItem annotated with qualifier #View4
UI.LineItem #View4 : [
    {
        $Type : 'UI.DataField',
        Label : 'Order ID',
        Value : SalesOrderID
    },
    {
        $Type : 'UI.DataField',
        Label : 'Customer',
        Value : ToBusinessPartner.EmailAddress
    },
    {
        $Type : 'UI.DataField',
        Label : 'Customer',
        Value : CustomerName
    },
    {
        $Type : 'UI.DataFieldForAnnotation',
        Label : 'TaxAmount',
        Target : '@UI.DataPoint#TaxAmount'
    }
]
```

STEP: 2 - Add DataPoint annotation (numeric formatting / value)

DESCRIPTION: Use DataPoint annotation to render numeric/value-driven columns (e.g., amounts, KPIs). Link this DataPoint from a DataFieldForAnnotation (see Step 1). Examples: XML, ABAP CDS, CAP CDS. Ensure qualifier matches the DataFieldForAnnotation Target.

LANGUAGE: XML

CODE:
```xml
<!-- XML Annotation: DataPoint used by DataFieldForAnnotation (qualifier TaxAmount) -->
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="TaxAmount">
   <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
      <PropertyValue Property="Title" String="TaxAmount" />
      <PropertyValue Property="Value" Path="TaxAmount" />
   </Record>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.dataPoint: {
  title: 'TaxAmount'
}
TaxAmount;
```

LANGUAGE: CDS

CODE:
```cds
// CAP CDS: DataPoint with qualifier #TaxAmount
UI.DataPoint #TaxAmount : {
    $Type : 'UI.DataPointType',
    Title : 'TaxAmount',
    Value : TaxAmount
}
```

STEP: 3 - Add Contact annotation for quick view information

DESCRIPTION: Use Communication.Contact to provide telephone/email quick-view content for table rows. Link this contact annotation from a DataFieldForAnnotation or use it in card/tooling that exposes quick views.

LANGUAGE: XML

CODE:
```xml
<!-- XML Annotation: Contact with phone and email collections -->
<Annotation Term="com.sap.vocabularies.Communication.v1.Contact">
   <Record>
      <PropertyValue Property="tel">
         <Collection>
            <Record>
               <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/fax" />
               <PropertyValue Property="uri" Path="FaxNumber" />
            </Record>
            <Record>
               <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/work com.sap.vocabularies.Communication.v1.PhoneType/preferred"/>
               <PropertyValue Property="uri" Path="PhoneNumber" />
            </Record>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="email">
         <Collection>
            <Record>
               <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.ContactInformationType/preferred com.sap.vocabularies.Communication.v1.ContactInformationType/work" />
               <PropertyValue Property="address" Path="EmailAddress" />
            </Record>
         </Collection>
      </PropertyValue>
   </Record>
</Annotation>
```

LANGUAGE: CDS

CODE:
```cds
// CAP CDS: Communication.Contact example
Communication.Contact : {
    tel : [
        {
            type : #fax,
            uri : FaxNumber
        },
        {
            type : [ #work, #pref ],
            uri : PhoneNumber
        }
    ],
    email : [
        {
            type : [ #pref, #work ],
            address : EmailAddress
        }
    ]
}
```

STEP: 4 - Configure navigation (intent-based and URL)

DESCRIPTION: For row-level navigation in table columns use com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation for intent-based navigation (recommended). Use com.sap.vocabularies.UI.v1.DataFieldWithUrl for external URLs or direct routes. Below are XML and CAP CDS templates — adapt SemanticObject, Action, Value, or Url to your context.

LANGUAGE: XML

CODE:
```xml
<!-- XML Template: intent-based navigation (DataFieldForIntentBasedNavigation) -->
<Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
  <PropertyValue Property="Label" String="Open Order" />
  <PropertyValue Property="SemanticObject" String="SalesOrder" />
  <PropertyValue Property="Action" String="display" />
  <PropertyValue Property="Value" Path="SalesOrderID" />
</Record>

<!-- XML Template: URL navigation (DataFieldWithUrl) -->
<Record Type="com.sap.vocabularies.UI.v1.DataFieldWithUrl">
  <PropertyValue Property="Label" String="Open Website" />
  <PropertyValue Property="Url" String="https://example.com/app/path" />
</Record>
```

LANGUAGE: CDS

CODE:
```cds
// CAP CDS: DataFieldForIntentBasedNavigation inside UI.LineItem
UI.LineItem: [
  {
    $Type: 'UI.DataFieldForIntentBasedNavigation',
    Label: 'Open Order',
    SemanticObject: 'SalesOrder',
    Action: 'display',
    Value: SalesOrderID
  },
  {
    $Type: 'UI.DataFieldWithUrl',
    Label: 'Open Website',
    Url: 'https://example.com/app/path'
  }
]
```

STEP: 5 - Notes and best practices

DESCRIPTION: Use DataFieldForIntentBasedNavigation for intent-based navigation (recommended). Use DataFieldWithUrl when navigation targets are external apps or specific application routes not configured in target mapping. When using DataFieldForAnnotation, ensure the Target annotation qualifier matches the DataPoint/Contact qualifier. Keep qualifiers consistent between LineItem entries and referenced annotations.
--------------------------------

**TITLE**: Configuring the Table Card Header Area (OVP Table Card) — manifest.json and Annotations

**INTRODUCTION**: Action-oriented guide to configure the table card header area for an OVP table card in Fiori Elements: set title/subTitle, add KPI/DataPoint annotations, configure view-switch (tabs) for per-card filtering, and enable header/table navigation. Use manifest.json (app descriptor) and annotation metadata (XML / CDS / ABAP CDS).

**TAGS**: fiori-elements-framework, ovp, table-card, manifest.json, annotations, DataPoint, KPI, view-switch, header, navigation

**STEP**: 1 — Set card title, subtitle and basic card settings in the app descriptor (manifest.json)

**DESCRIPTION**: Edit the app descriptor (manifest.json) to configure the card title, subTitle, model, template and entitySet. Also add a kpiAnnotationPath at sap.ovp level to point to a KPI/DataPoint annotation (if used).

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters",
    "showDateInRelativeFormat": false,
    "disableTableCardFlexibility": false,
    "considerAnalyticalParameters": true,
    "useDateRangeType": false,
    "kpiAnnotationPath": "com.sap.vocabularies.UI.v1.KPI#AllActualCosts",
    "cards": {
      "card014": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.table",
        "settings": {
          "title": "Sales Forecast",
          "subTitle": "per Supplier",
          "entitySet": "SalesShare"
        }
      }
    }
  }
}
```

**STEP**: 2 — Add a DataPoint (KPI) annotation (XML) and reference it from kpiAnnotationPath

**DESCRIPTION**: Create a UI.DataPoint annotation in your OData annotation file (XML). Reference this annotation from manifest.json via sap.ovp.kpiAnnotationPath (example shown in Step 1). Include Title, Value, ValueFormat, CriticalityCalculation, TargetValue, and TrendCalculation as required.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- OData annotation file (annotations.xml) -->
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="UI.DataPoint" Qualifier="Eval_by_Country_Generic">
    <Record Type="UI.DataPointType">
      <PropertyValue Property="Title" String="Sales India - Generic Card" />
      <PropertyValue Property="Value" Path="Sales" />
      <PropertyValue Property="ValueFormat">
        <Record>
          <PropertyValue Property="ScaleFactor" Decimal="2" />
          <PropertyValue Property="NumberOfFractionalDigits" Int="1" />
        </Record>
      </PropertyValue>
      <PropertyValue Property="CriticalityCalculation">
        <Record>
          <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Minimize" />
          <PropertyValue Property="DeviationRangeHighValue" String="7300" />
          <PropertyValue Property="ToleranceRangeHighValue" String="7200" />
        </Record>
      </PropertyValue>
      <PropertyValue Property="TargetValue" String="2.000" />
      <PropertyValue Property="TrendCalculation">
        <Record>
          <PropertyValue Property="ReferenceValue" String="5201680" />
          <PropertyValue Property="DownDifference" Decimal="10000000.0" />
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 3 — DataPoint annotation examples in CDS (ABAP CDS and CAP CDS)

**DESCRIPTION**: If you author annotations in CDS, use these patterns (ABAP CDS and CAP CDS) to create equivalent DataPoint annotations for the KPI.

**LANGUAGE**: ABAP CDS

**CODE**:
```ABAP
@UI.dataPoint: { 
  title: 'Sales India - Generic Card',
  valueFormat: { scaleFactor: 2, numberOfFractionalDigits: 1 },
  criticalityCalculation: { 
    improvementDirection: #MINIMIZE,
    deviationRangeHighValue: 7300,
    toleranceRangeHighValue: 7200
  },
  targetValue: 2.000,
  trendCalculation: { referenceValue: 'refValElement', downDifference: 10000000.0 }
}
Sales;
```

**LANGUAGE**: CDS (CAP)

**CODE**:
```CDS
annotation UI.DataPoint #Eval_by_Country_Generic : {
    $Type : 'UI.DataPointType',
    Title : 'Sales India - Generic Card',
    Value : Sales,
    ValueFormat : {
        ScaleFactor : 2,
        NumberOfFractionalDigits : 1
    },
    CriticalityCalculation : {
        ImprovementDirection : #Minimizing,
        DeviationRangeHighValue : '7300',
        ToleranceRangeHighValue : '7200'
    },
    TargetValue : '2.000',
    TrendCalculation : {
        ReferenceValue : '5201680',
        DownDifference : 10000000.0
    }
}
```

**STEP**: 4 — Configure per-card view switch (tabs) in manifest.json (card settings)

**DESCRIPTION**: Add a "tabs" array to a card's settings to provide a dropdown for filtering/viewing multiple annotation-driven views. Each tab references annotation paths (annotationPath, selectionAnnotationPath, presentationAnnotationPath, identificationAnnotationPath, dataPointAnnotationPath, dynamicSubtitleAnnotationPath) and a value to bind to the dropdown label.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ovp": {
    "cards": {
      "card014": {
        "settings": {
          "title": "Sales Forecast",
          "subTitle": "per Supplier",
          "valueSelectionInfo": "Value Selection Info",
          "entitySet": "SalesShare",
          "tabs": [
            {
              "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
              "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
              "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
              "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line",
              "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
              "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
              "value": "{{dropdown_value2}}"
            },
            {
              "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
              "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View4",
              "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#item2",
              "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
              "value": "{{dropdown_value4}}"
            }
          ]
        }
      }
    }
  }
}
```

**STEP**: 5 — DataPoint descriptor properties and supported criticality values (how to set KPI appearance)

**DESCRIPTION**: When authoring a DataPoint/DataPointDescriptor for a KPI header, include these properties. Criticality may be set via enum member or a Path that returns numeric values 0..3.

- Title — displayed as KPI header title and can also be used as column name
- Value — measure path for KPI
- ValueFormat — scaleFactor, numberOfFractionalDigits, etc.
- Criticality / CriticalityCalculation — either:
  - EnumMember values:
    - com.sap.vocabularies.UI.v1.CriticalityType/Neutral (default)
    - com.sap.vocabularies.UI.v1.CriticalityType/Negative
    - com.sap.vocabularies.UI.v1.CriticalityType/Critical
    - com.sap.vocabularies.UI.v1.CriticalityType/Positive
  - Path returning numeric code:
    - 0 => Neutral
    - 1 => Negative (Red)
    - 2 => Critical (Orange)
    - 3 => Positive (Green)

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Minimal DataPoint fragment showing Title, Value, ValueFormat and Criticality (enum) -->
<Annotation Term="UI.DataPoint" Qualifier="KPI_Header">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Total Sales" />
    <PropertyValue Property="Value" Path="TotalSales" />
    <PropertyValue Property="ValueFormat">
      <Record>
        <PropertyValue Property="ScaleFactor" Decimal="0" />
        <PropertyValue Property="NumberOfFractionalDigits" Int="2" />
      </Record>
    </PropertyValue>
    <!-- Criticality as enum -->
    <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Positive" />
  </Record>
</Annotation>

<!-- OR Criticality as Path that returns 0..3 -->
<Annotation Term="UI.DataPoint" Qualifier="KPI_Header_Path">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Total Sales" />
    <PropertyValue Property="Value" Path="TotalSales" />
    <PropertyValue Property="Criticality" Path="CriticalityCode" />
  </Record>
</Annotation>
```

**STEP**: 6 — Configure header/table navigation using Identification annotation (note precedence)

**DESCRIPTION**: Use UI.Identification annotations to configure navigation from the header area (and optionally table area). If you also configure navigation in LineItem (table) annotation, the LineItem navigation settings will take precedence for table item navigation. Add navigation targets inside Identification or LineItem as required for your app.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: Identification annotation used for header navigation (annotations.xml) -->
<Annotation Term="UI.Identification">
  <Record>
    <!-- configure header fields and navigation settings here -->
    <PropertyValue Property="Title" String="Customer Overview" />
    <!-- Example: a navigation property can be represented using UrlRef / SemanticObjectReference depending on service -->
    <!-- Keep navigation configuration consistent with your routing/navigation framework (semantic object or target mapping) -->
  </Record>
</Annotation>

<!-- NOTE: If LineItem contains a navigation configuration, it overrides Identification for table area navigation -->
```


--------------------------------

**TITLE**: Configure Analytical List Page (ALP) to Load Table-Only View by Default

**INTRODUCTION**: This guide shows how to configure SAP Fiori Elements Analytical List Page (ALP) to load the table-only view by default. It covers both OData V2 (descriptor manifest under sap.ui.generic.app) and OData V4 (views paths/defaultPath in manifest.json), plus related table settings (table type, condensed vs compact) and column width tuning via metadata.

**TAGS**: fiori-elements-framework, ALP, AnalyticalListPage, OData V2, OData V4, manifest.json, table-only, tableSettings, defaultPath, table-type, MaxLength, Precision

STEP: Configure Table-Only View (OData V2) in Descriptor (manifest.json)

DESCRIPTION: Add or update the sap.ui.generic.app -> pages entry in manifest.json to point to the AnalyticalListPage component and set list=true. Under component.settings.tableSettings specify the table type to render the table-only UI (options: "GridTable", "AnalyticalTable", "ResponsiveTable"). To change spacing mode, set the descriptor setting for compact mode (override default condensed mode). Save changes to manifest.json in your application root.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "tableSettings": {
              "type": "GridTable"  // or "AnalyticalTable" or "ResponsiveTable"
            },
            "layout": {
              "mode": "Compact"    // optional: override default condensed mode to compact
            }
          }
        }
      }
    ]
  }
}
```

STEP: Tune Column Widths via OData V2 Metadata

DESCRIPTION: Control column display widths by adjusting backend metadata:
- For text properties set MaxLength in the EDM metadata/annotation.
- For decimal properties set Precision in the EDM metadata/annotation.
These metadata values affect rendered column widths in ALP tables.

LANGUAGE: XML / EDMX (example snippet)

CODE:
```xml
<!-- Example EDMX property annotations (EDMX or local CDS/annotation source) -->
<Property Name="ProductName" Type="Edm.String" MaxLength="60" />
<Property Name="Amount" Type="Edm.Decimal" Precision="12" Scale="2" />
```

STEP: Note on Determining Actions (Deprecated)

DESCRIPTION: Determining buttons/actions are supported for compatibility only. Avoid using them in new implementations. For legacy reference, see the List Report determining actions documentation.

LANGUAGE: JSON (no code change required)

CODE:
```json
// Recommendation: Avoid using determining actions. This feature is deprecated.
```

STEP: Configure Table-Only View (OData V4) via views.defaultPath (manifest.json)

DESCRIPTION: For OData V4 ALP, set the annotation path defaultPath to "secondary" in the manifest views configuration so the table-only (secondary) view is loaded by default. Place this under the "views" section of manifest.json.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "views": {
      "paths": [
        {
          "annotation": "com.sap.vocabularies.UI.v1",
          "defaultPath": "secondary"
        }
      ]
    }
  }
}
```

STEP: Related Configuration References

DESCRIPTION: Use these references for additional table options and descriptor configurations:
- Descriptor Configuration for the Analytical List Page: configure annotation paths and ALP options.
- Configuring Tables: table features and behaviors.
- Setting the Table Type: control which table type is rendered via manifest.json or annotations.
- Configuring the Content Area: define UI.Chart or UI.LineItem annotations to render chart and table areas.

LANGUAGE: TEXT

CODE:
```text
Related files/sections:
- descriptor-configuration-for-the-analytical-list-page-2a9df06.md
- configuring-tables-f4eb70f.md
- setting-the-table-type-7f844f1.md
- configuring-the-content-area-fc7d73c.md
```
--------------------------------

**TITLE**: Configuring the Analytical List Page Title Area with UI.KPI (OData V2)

**INTRODUCTION**: This document shows how to configure the ALP title/header area to display KPIs using the UI.KPI annotation (OData V2). It covers the manifest (descriptor) mapping, the annotation definition (including navigation configuration), and the SelectionPresentationVariant fallback behavior. Use these steps when adding KPI cards to an analytical list page and enabling navigation to a target application (smart business or other targets).

**TAGS**: ALP, analytical-list-page, UI.KPI, KPI, manifest.json, annotations, OData V2, SAP Fiori elements

**STEP**: 1 — Add KPI descriptor mapping in manifest.json

**DESCRIPTION**: Add an entry in the application descriptor (manifest.json) that points a front-end KPI mapping key to the KPI annotation qualifier and the OData entity set. This informs Fiori elements which annotation qualifier and service entity set to use for KPI rendering.

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (excerpt under sap.ui5 or sap.app as appropriate)
{
  "sap.app": {
    "id": "your.app.id",
    "applicationVersion": {
      "version": "1.0.0"
    }
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      },
      "kpi": {
        "dataSource": "kpiService"
      }
    },
    "extends": {
      "extensions": {}
    },
    "componentUsages": {},
    "config": {
      "KPIQuantity": {
        "model": "kpi",
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCubeALPResults",
        "qualifier": "KPIQuantity"
      }
    }
  }
}
```

Notes:
- Place the KPI mapping under the appropriate config location used by your template (the example uses sap.ui5.config.KPIQuantity).
- "model" must refer to a model configured in manifest.json (here "kpi").
- "qualifier" must match the Qualifier in your UI.KPI annotation (see next step).

**STEP**: 2 — Define the UI.KPI annotation (OData V2) and navigation

**DESCRIPTION**: Create an annotation file that declares the UI.KPI collection for the target entity set. Each KPI card must include an Id and navigation properties (SemanticObject and Action) to enable navigation. The KPI Id will be sent as EvaluationId to the target application.

Place this file in your annotation folder (e.g., webapp/annotations/annotations.xml) and register it in the manifest under "sap.app" -> "dataSources" or "sap.ui5" -> "models".

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/annotations/annotations.xml (fragment) -->
<Annotations Target="SEPMRA_C_ALP_SlsOrdItemCubeALPResults" Qualifier="KPIQuantity" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="UI.KPI">
    <Collection>
      <!-- KPICard 1 -->
      <Record Type="UI.KPICard">
        <PropertyValue Property="Id" String="KPI_SalesQuantity" />
        <PropertyValue Property="Label" String="Sales Quantity" />
        <!-- Navigation configuration for KPI card (semantic object + action) -->
        <PropertyValue Property="SemanticObject" String="SalesOrder" />
        <PropertyValue Property="Action" String="displayFactSheet" />
        <!-- Card content: KPI value as DataPoint -->
        <PropertyValue Property="Value">
          <Record Type="UI.DataPoint">
            <PropertyValue Property="Value">
              <Record Type="Common.Value">
                <PropertyValue Property="Path" String="Quantity" />
              </Record>
            </PropertyValue>
            <!-- optional: show unit -->
            <PropertyValue Property="Unit" Path="Currency" />
          </Record>
        </PropertyValue>
      </Record>

      <!-- Add more KPICard records as needed -->
    </Collection>
  </Annotation>
</Annotations>
```

Notes:
- KPI card Id must be unique; it will be forwarded to the target application as parameter EvaluationId.
- SemanticObject and Action are required to enable outbound navigation from the KPI card.
- The DataPoint/value configuration can use Path references to entity properties (Value, Unit, etc.).

**STEP**: 3 — (Optional) Provide a SelectionPresentationVariant fallback using the same qualifier

**DESCRIPTION**: If a UI.KPI annotation is not provided for the qualifier referenced in the descriptor, the UI.SelectionPresentationVariant annotation with the same qualifier will be used as a fallback. Add a SelectionPresentationVariant annotation using the same qualifier when relevant.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/annotations/annotations.xml (fragment) -->
<Annotations Target="SEPMRA_C_ALP_SlsOrdItemCubeALPResults" Qualifier="KPIQuantity" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="UI.SelectionPresentationVariant">
    <Record>
      <PropertyValue Property="SelectionVariant">
        <Record Type="UI.SelectionVariant">
          <!-- Example: default filter context -->
          <PropertyValue Property="SelectOptions">
            <Collection>
              <Record Type="UI.SelectOption">
                <PropertyValue Property="PropertyName" String="SalesOrganization" />
                <PropertyValue Property="Ranges">
                  <Collection />
                </PropertyValue>
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </PropertyValue>
      <PropertyValue Property="PresentationVariant">
        <Record Type="UI.PresentationVariant">
          <PropertyValue Property="Visualizations">
            <Collection>
              <!-- Provide visualization refs (e.g., Chart, Table) as needed -->
            </Collection>
          </PropertyValue>
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

Notes:
- Use the same Qualifier name as in the manifest mapping ("KPIQuantity") to enable the fallback behavior.
- The SelectionPresentationVariant controls filter-selection defaults and default content visualizations if UI.KPI is not present.

**STEP**: 4 — Register annotation files and models in manifest.json

**DESCRIPTION**: Ensure your annotation file and KPI model (if a separate service) are declared in manifest.json dataSources and models so the framework can load them.

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (dataSources and model declarations - excerpt)
{
  "sap.app": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/YOUR_MAIN_SERVICE/",
        "type": "OData",
        "settings": { "annotations": ["annotations/annotations.xml"] }
      },
      "kpiService": {
        "uri": "/sap/opu/odata/sap/YOUR_KPI_SERVICE/",
        "type": "OData"
      }
    }
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "odataVersion": "2.0"
        }
      },
      "kpi": {
        "dataSource": "kpiService",
        "settings": {
          "odataVersion": "2.0"
        }
      }
    }
  }
}
```

Notes:
- List your annotations under the mainService dataSource settings.annotations array (or the appropriate service).
- The kpi model should reference the service exposing KPI-related entity sets if separate.

**RELATED**: For additional ALP header capabilities (variants, filter modes, customizations, sharing) refer to:
- Analytical List Page
- Managing Variants
- Creating Key Performance Indicator Tags
- Choosing Filter Modes
--------------------------------

**TITLE**: Configuring the Visual Filter Bar (Fiori elements)

**INTRODUCTION**: Short, actionable guidance for developers to enable and configure Visual Filters in SAP Fiori elements apps (OData V4). Covers prerequisites (value list annotations), manifest.json settings, availability options, backend aggregation placement, and draft-enabled entity restrictions. Use these steps while implementing visual filters for Analytical List Page (ALP) or other Fiori elements pages.

**TAGS**: fiori-elements-framework, visual-filter, manifest.json, OData V4, valueList, aggregation, draft, analytical-list-page

STEP: 1 — Prerequisites for Visual Filters

DESCRIPTION: Visual filters require value list annotations on the filter fields. Visual filters only apply to fields that accept single or multiple values (not ranges) and do not support semantic dates. Ensure each filter field you want as a visual filter has a corresponding value list annotation. See the referenced doc for examples of value list annotations.

LANGUAGE: Text

CODE:
```text
- Ensure filter field is single- or multi-value (not range-based).
- Do NOT use semantic date fields for visual filters.
- Define ValueList annotations for each filter field to be rendered as a visual filter.
  (See: enhancing-valuelist-annotations-for-visual-filters-16d43eb.md)
```

STEP: 2 — Add visual-filter settings to manifest.json (OData V4)

DESCRIPTION: Add a "settings" section in your manifest.json to enable the visual filter bar, set layout defaults, and configure each filter field. For each visual filter field, set "visualFilter.valueList" to point to the value list annotation path for that field.

LANGUAGE: JSON

CODE:
```json
{
  "settings": {
    "contextPath": "/SalesOrderManage",
    "controlConfiguration": {
      "@com.sap.vocabularies.UI.v1.SelectionFields": {
        "layout": "CompactVisual",
        "initialLayout": "Visual",
        "filterFields": {
          "ItemRating": {
            "availability": "Default",
            "visualFilter": {
              "valueList": "<pathToValueList>"
            }
          }
        }
      }
    }
  }
}
```

Notes:
- "layout": "Compact" or "CompactVisual" — use "CompactVisual" to render both compact and visual filters.
- "initialLayout": "Visual" or "Compact" — default filter mode on initial load.
- Replace "<pathToValueList>" with the annotation path (the valuelist annotation that maps the main entity filter field to the value help entity set).

STEP: 3 — "availability" property values and behavior

DESCRIPTION: Control initial visibility of filter fields and visual filters using the "availability" property in manifest.json. Use one of the enumerated values described below.

LANGUAGE: JSON

CODE:
```json
{
  "availabilityValues": {
    "Default": "Shown by default in filter bar and visual filters (if visualFilter defined).",
    "Adaptation": "Not shown by default; available under Adapt Filters.",
    "Hidden": "Not visible in the filter bar nor in Adapt Filters."
  }
}
```

STEP: 4 — Backend aggregation: enable valueList entity for aggregation

DESCRIPTION: The value help entity (the entity referenced by visualFilter.valueList) MUST be enabled for aggregation in the backend. Where to place aggregation annotations depends on whether the valueList entity is parameterized:

- Non-parameterized valueList entity: define aggregation annotations at the EntitySet level.
- Parameterized valueList entity: define aggregation annotations at the EntityType level.

Refer to the charts configuration guidance for backend aggregation details.

LANGUAGE: Text

CODE:
```text
- Ensure backend supports $apply aggregations for the valueList entity.
- If valueList entity is non-parameterized:
    Place aggregation annotations on the Service.EntitySet for the visual filter value help.
- If valueList entity is parameterized:
    Place aggregation annotations on the Service.EntityType for that value help.
- See: configuring-charts-653ed0f.md#loio653ed0f4f0d743dbb33ace4f68886c4e__enabling_aggregation_subsection
```

STEP: 5 — Draft-enabled entities: behavior and restrictions

DESCRIPTION: If the main or value help entities are draft-enabled, visual filters and charts behave with restrictions. Only active (non-draft) data is used for chart/visual-filter displays. Follow these constraints when using draft-enabled entities.

LANGUAGE: Text

CODE:
```text
- Only active data is used for chart/visual-filter display when entity is draft-enabled.
- Known limitations:
  - Sorting on virtual properties/measures may fail with CAP Node.js versions < @sap/cds 6.0.0.
  - Aggregations on draft-enabled entities are not supported in ABAP CDS (SADL limitation).
- Restrictions for visual filters and charts:
  - Donut charts are not supported.
  - Properties from "associated entity sets" (value help entity) are not supported.
  - For line charts, use only Edm.Date, Edm.Time, or Edm.DateTime types (no string-based time/date).
  - Selection outside chart enabled only for value help-based fields (not dropdowns or date/time inputs).
  - Visual filters inside "Adapt Filters" dialog are not supported.
  - Incorrect formatting for fiscal periods or string-based time annotations is possible.
  - Path-based UI.Criticality and CriticalityCalculation-based semantic coloring are not supported.
  - Cannot configure a visual filter for a field that already uses a custom filter implementation.
```

STEP: 6 — Implementation checklist and related resources

DESCRIPTION: Quick checklist and reference files to consult while implementing visual filters.

LANGUAGE: Text

CODE:
```text
Implementation checklist:
- [ ] Add ValueList annotations for each filter field (see enhancing-valuelist-annotations-for-visual-filters-16d43eb.md).
- [ ] Update manifest.json "settings" > "@com.sap.vocabularies.UI.v1.SelectionFields" with layout, initialLayout and filterFields.
- [ ] For each filter field: set availability (Default/Adaptation/Hidden) and visualFilter.valueList to the value list annotation path.
- [ ] Enable aggregation in the backend for the valueList entity (see configuring-charts-653ed0f.md#loio653ed0f4f0d743dbb33ace4f68886c4e__enabling_aggregation_subsection).
- [ ] Validate behavior with draft-enabled entities if applicable.

Related documentation:
- enhancing-valuelist-annotations-for-visual-filters-16d43eb.md
- configuring-charts-653ed0f.md (see aggregation subsection)
- analytical-list-page-3d33684.md
- visual-filters-1714720.md
```
--------------------------------

**TITLE**: Configuring View Switch for OVP/Fiori Elements Cards

**INTRODUCTION**: Instructions and ready-to-use JSON snippets to configure a view switch (drop-down tabs) at the card level. Use these configurations inside your card definition (e.g., manifest.json card config or an external card JSON). Includes single-entity and multi-entity set patterns and a complete example with annotation paths and value bindings.

**TAGS**: fiori-elements-framework, view-switch, ovp, sap.card, manifest.json, annotationPaths, entitySet

**STEP**: 1 — Configure view switch for a single entity set

**DESCRIPTION**: Use this pattern when all view switch tabs should operate on the same entity set. Set the common entitySet at settings level and define each tab's annotation/presentation/selection paths and value binding.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "settings": {
    "entitySet": "SalesOrderSet",
    "tabs": [
      {
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
        "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line",
        "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
        "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
        "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
        "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
        "value": "{{dropdown_value2}}"
      },
      {
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View3",
        "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#SP3",
        "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
        "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
        "value": "{{dropdown_value3}}"
      }
    ]
  }
}
```

**STEP**: 2 — Configure view switch with multiple entity sets

**DESCRIPTION**: Use this pattern when each tab targets a different entity set. Omit top-level settings.entitySet and include entitySet per tab. Each tab may still define annotation/presentation/identification paths and its own value binding.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "settings": {
    "tabs": [
      {
        "entitySet": "SalesOrderSet",
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#ViewA",
        "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#PV1",
        "value": "{{dropdown_value_sales}}"
      },
      {
        "entitySet": "ProductSet",
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem",
        "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#identify1",
        "value": "{{dropdown_value_product}}"
      }
    ]
  }
}
```

**STEP**: 3 — Full card example (merge into your card definition)

**DESCRIPTION**: Complete example of a list/card configuration that includes view-switch tabs. Place this JSON inside the card definition (e.g., in manifest.json under the card's configuration or an external card file). Preserve annotation paths and bindings as shown. Bind tab values to localized or runtime properties (e.g., "{{dropdown_value1}}").

**LANGUAGE**: JSON

**CODE**:
```json
{
  "card009": {
    "model": "salesOrder",
    "template": "sap.ovp.cards.list",
    "settings": {
      "title": "Contract Monitoring",
      "subTitle": "Per Supplier",
      "valueSelectionInfo": "Total contract volume",
      "listFlavor": "bar",
      "listType": "extended",
      "showLineItemDetail": true,
      "tabs": [
        {
          "entitySet": "SalesOrderSet",
          "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
          "value": "{{dropdown_value2}}"
        },
        {
          "entitySet": "SalesOrderSet",
          "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View3",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#SP3",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
          "value": "{{dropdown_value3}}"
        },
        {
          "entitySet": "ProductSet",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#identify1",
          "value": "{{dropdown_value1}}"
        }
      ]
    }
  }
}
```

Note: To implement custom behavior beyond annotation-driven filters (for example, conditional logic or advanced filtering), extend the view switch using a custom View Switch extension. See custom-view-switch-ecd9f10.md for implementation details.
--------------------------------

**TITLE**: Confirmation Popups — Configuration and Handling (SAP Fiori Elements, OData V2 & V4)

**INTRODUCTION**: This document collects actionable configuration snippets and client-side handling patterns for confirmation popups used in Fiori Elements list reports and object pages. It covers: draft-discard confirmation, legacy object-page confirmation, i18n title overrides, 412 "Precondition Failed" confirmation flow (Prefer: handling=strict), and version-specific settings and restrictions for OData V2 and V4.

**TAGS**: fiori-elements, confirmation-popup, draft, manifest.json, i18n, ODataV2, ODataV4, 412, Prefer-header

STEP: 1 — Turn off Draft Activation Confirmation Popup for External Navigation (OData V2)

DESCRIPTION: Disable the draft-discard confirmation popup for external navigation by setting draftDiscardConfirmationSettings.enabled in manifest.json. Place this under "sap.ui.generic.app" -> "settings". The example uses version "1.3.0" and the "restricted" value shown in product docs.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "draftDiscardConfirmationSettings": {
        "enabled": "restricted"
      }
    }
  }
}
```

STEP: 2 — Turn off Draft Activation Confirmation Popup for External Navigation (OData V4 / SAP Fiori elements FE)

DESCRIPTION: For OData V4 / Fiori FE apps, use "sap.fe.app.silentlyKeepDraftOnForwardNavigation": true in manifest.json to skip the external-navigation draft-discard confirmation.

LANGUAGE: JSON

CODE:
```json
{
  "sap.fe": {
    "app": {
      "silentlyKeepDraftOnForwardNavigation": true
    }
  }
}
```

STEP: 3 — (Legacy) Show Additional Confirmation Popup Before Draft Activation on Object Page

DESCRIPTION: Legacy setting: enable a front-end confirmation popup before activation on object pages by setting showConfirmationOnDraftActivate to true under the object page settings in manifest.json. This is recommended only when 412-based confirmation popups are not used.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "routes": []
    }
  },
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "showRelatedApps": true,
            "tableType": "ResponsiveTable",
            "editableHeaderContent": true,
            "showConfirmationOnDraftActivate": true,
            "sections": {
              "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
                "navigationProperty": "to_ProductText",
                "entitySet": "STTA_C_MP_ProductText",
                "multiSelect": true,
                "createMode": "inline",
                "tableType": "ResponsiveTable"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — Override Confirmation Dialog Title Texts (i18n)

DESCRIPTION: Provide application-specific dialog titles by overriding i18n keys. Add these keys to your i18n properties file (e.g., i18n.properties or i18n_en.properties).

LANGUAGE: PROPERTIES

CODE:
```
ST_KEEP_DRAFT_MESSAGE_CREATE=Do you want to discard the draft (Create)? 
ST_KEEP_DRAFT_MESSAGE_EDIT=Do you want to discard changes (Edit)?
CREATE=Create
SAVE=Save
```

STEP: 5 — 412 "Precondition Failed" Confirmation Flow (Client + Backend contract)

DESCRIPTION: Implement the 412-based confirmation flow:
- Client sends the action request with header "Prefer: handling=strict".
- Backend can return HTTP 412 with a message payload if warnings exist that block automatic processing.
- UI displays the backend message in a confirmation popup. If user confirms, resend the request without the "Prefer: handling=strict" header to execute the action. If user cancels, terminate the flow.

Include example client-side request/confirm handling in JavaScript (fetch) showing initial request with header and retry without header.

LANGUAGE: JavaScript

CODE:
```javascript
// Example: triggerAction sends the action; on 412 shows confirmation and retries without Prefer header if confirmed
async function triggerAction(url, body) {
  // initial request with strict handling preference
  const initResponse = await fetch(url, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "Prefer": "handling=strict"
    },
    body: JSON.stringify(body)
  });

  if (initResponse.status === 412) {
    // Extract message from backend (assumes JSON body with {message: "..."} or similar)
    const payload = await initResponse.json().catch(() => null);
    const serverMessage = (payload && (payload.message || payload.error && payload.error.message)) || "Warnings present. Continue?";

    // Show confirmation popup to user (UI framework code required here)
    const userConfirmed = await showConfirmationDialog(serverMessage); // implement showConfirmationDialog in UI layer

    if (!userConfirmed) {
      // User canceled -> terminate action
      return { status: "cancelled" };
    }

    // User confirmed -> resend without Prefer header
    const finalResponse = await fetch(url, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(body)
    });

    const finalPayload = await finalResponse.json().catch(() => null);
    return { status: finalResponse.ok ? "success" : "error", response: finalPayload, httpStatus: finalResponse.status };
  }

  // Non-412 path: return original response
  const resultPayload = await initResponse.json().catch(() => null);
  return { status: initResponse.ok ? "success" : "error", response: resultPayload, httpStatus: initResponse.status };
}
```

STEP: 6 — Server Response Contract for 412

DESCRIPTION: Backend must return HTTP 412 ("Precondition Failed") when warnings exist that should be displayed and require user confirmation. The response should include a human-readable message (or OData error structure) that the UI can show in the confirmation dialog. For OData V4, 412 messages must be configured as "transition" messages (not "state").

LANGUAGE: JSON

CODE:
```json
// Example HTTP 412 response body (OData error-like structure)
{
  "error": {
    "code": "412",
    "message": {
      "lang": "en",
      "value": "There are warnings that prevent automatic processing. Do you want to continue and ignore these warnings?"
    },
    "details": [
      {
        "code": "Warning001",
        "message": "Item X has a missing required field.",
        "severity": "warning"
      }
    ]
  }
}
```

STEP: 7 — Notes, Supported Scenarios, and Restrictions (412 and Drafts)

DESCRIPTION: Keep these rules and restrictions as implementation checks in your app logic and server behavior:
- Supported 412 scenarios: Save, Activate, Create, function-import actions, create/update/delete in non-draft apps, deletion of an object (server must send transition message for save/delete/function import in V2; V4 requires transition).
- Restriction: You cannot configure a 412 confirmation popup for a deletion triggered from a table in an object page.
- Multi-select actions: If some selected items produce warnings, the batch processing may fail — the user must perform actions on individual items as required.
- OData V4 / CAP restriction: For CAP back ends, 412 handling may not work correctly when action invocation uses InvocationGrouping = UI.OperationGroupingType/Isolated (actions for selected contexts are inside the same changeset — all or none execute).
- Deletion: 412 handling is not applied for record deletion in some back ends (note platform-specific behavior).

LANGUAGE: Text

CODE:
```text
- Ensure backend returns transition messages for 412 when required (V4: transition only).
- Avoid relying on 412 confirmation for deletions triggered from object-page tables.
- For multi-selection, expect failure if any selected item has warnings; guide users to act per-item.
- CAP-based backends with InvocationGrouping=Isolated may cause 412 handling to be ineffective.
```

STEP: 8 — Configure Critical Actions to Show Confirmation Popovers

DESCRIPTION: Mark actions as "critical" so that Fiori Elements shows a confirmation popup before execution. Implementation is dependent on how actions are declared (annotations, metadata, or manifest action configuration). If using custom actions, ensure UI metadata (annotations or manifest action definitions) specify critical semantics so the framework triggers the confirmation popover.

LANGUAGE: Text

CODE:
```text
// Implementation notes (framework-dependent):
// - For metadata-driven actions (annotations): add appropriate UI/behavioral annotation indicating criticality.
// - For manifest-declared actions or custom buttons: set a property or hook that triggers standard confirmation popover.
// - See "Adding Confirmation Popovers for Actions" guide for framework-specific annotation/manifest patterns.
```

STEP: 9 — Images and UX References (Optional)

DESCRIPTION: Reference existing image assets for designers / docs. (Not required for code; listed for completeness and traceability.)

LANGUAGE: Text

CODE:
```text
// Example image asset paths from documentation
images/Confirmation_Popup_for_Draft_Discard_-_Create_Mode_8e59d66.png
images/Confirmation_Popup_for_Discard_Draft_-_Edit_Mode_b43cd41.png
images/Confirmation_Popup_412_Warning_03381d1.png
```


--------------------------------

**TITLE**: Contact Facet — Add Communication.Contact to Header/FieldGroup (OData V2 & V4)

**INTRODUCTION**: Enable a quick-view contact in a header form facet by referencing the Communication.Contact annotation from UI.DataFieldForAnnotation (OData V2) or UI.FieldGroup / UI.DataFieldForAnnotation (OData V4). This guide provides copy-ready XML, ABAP CDS, and CAP CDS examples for the contact link (field reference) and the contact popover (Communication.Contact definition).

**TAGS**: fiori-elements-framework, odata-v2, odata-v4, annotations, UI.DataFieldForAnnotation, UI.FieldGroup, Communication.Contact, ABAP CDS, CAP CDS

**STEP**: 1 — OData V2: Add Contact Link to Header Facet

**DESCRIPTION**: Add a UI.DataFieldForAnnotation in the header facet that points to a Contact annotation on a related entity (1:1). Place this XML in your UI annotations file (e.g., annotations.xml) or the corresponding annotation repository. The Label is used as the field label; the Contact's fn property is displayed as the value.

**LANGUAGE**: XML

**CODE**:
```XML
<Record Type="UI.DataFieldForAnnotation">
       <PropertyValue Property="Label" String="Supplier [ContactQV]"/>
       <PropertyValue Property="Target" AnnotationPath="to_Supplier/@Communication.Contact"/>
       <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
</Record>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.fieldGroup: [
  {
    importance: #LOW,
    value: '_STOCKAVAILABILITY.QUANTITY',
    position: 10 ,
    qualifier: 'GeneralInformationForHeader',
    groupLabel: '{@i18n>@GeneralInfoFieldGroupLabel}'
  }
]
_STOCKAVAILABILITY;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    position: 20 ,
    qualifier: 'GeneralInformationForHeader'
  }
]
WEIGHT;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    label: 'WeightUnit [SmLiQv]',
    position: 30 ,
    qualifier: 'GeneralInformationForHeader'
  }
]
WEIGHTUNIT;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    label: 'Supplier [ContactQV]',
    value: '_SUPPLIER',
    type: #AS_CONTACT,
    position: 40 ,
    qualifier: 'GeneralInformationForHeader'
  }
]
MANAGER;
```

**STEP**: 2 — OData V2: Define Communication.Contact Popover

**DESCRIPTION**: Define the Contact structure referenced above. Add this Communication.Contact annotation to the target entity's annotation block (XML) or define the corresponding fields with semantics in the CDS view.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotation Term="Communication.Contact">
  <Record>
       <PropertyValue Property="fn" Path="CompanyName"/>
       <PropertyValue Property="email">
            <Collection>
                  <Record>
                       <PropertyValue Property="type" EnumMember="Communication.ContactInformationType/work"/>
                       <PropertyValue Property="address" Path="EmailAddress"/>
                  </Record>
            </Collection>
       </PropertyValue>
       <PropertyValue Property="tel">
            <Collection>
                  <Record>
                       <PropertyValue Property="type" EnumMember="Communication.PhoneType/preferred Communication.PhoneType/work"/>
                       <PropertyValue Property="uri" Path="PhoneNumber"/>
                  </Record>
                  <Record>
                       <PropertyValue Property="type" EnumMember="Communication.PhoneType/fax"/>
                       <PropertyValue Property="uri" Path="FaxNumber"/>
                  </Record>
            </Collection>
       </PropertyValue>
  </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
define view VIEWNAME
{

 @Semantics.name.fullName: true
  CompanyName,

  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK]
  EmailAddress,

  @Semantics.telephone.type:  [ #CELL ] 
  PhoneNumber,

  @Semantics.telephone.type: [ #FAX ]
  FaxNumber,
}
```

**STEP**: 3 — OData V4: Add Contact Link to UI.FieldGroup (OrderData example)

**DESCRIPTION**: In OData V4, use UI.FieldGroup with a UI.DataFieldForAnnotation entry that targets _SoldToParty/@Communication.Contact. Add this XML to your UI annotations (annotations.xml / manifest-linked annotations). Equivalent ABAP CDS and CAP CDS field-group examples are provided for CDS-based UI annotations.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotation Term="UI.FieldGroup" Qualifier="OrderData">
    <Record Type="UI.FieldGroupType">
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataFieldWithNavigationPath">
                    <PropertyValue Property="Label" String="Referenced Sales Order"/>
                    <PropertyValue Property="Value" Path="_ReferencedSalesOrder/SalesOrder"/>
                    <PropertyValue Property="Target" NavigationPropertyPath="SalesOrderManage"/>
                </Record>
                <Record Type="UI.DataFieldForAnnotation">
                    <PropertyValue Property="Target" AnnotationPath="_SoldToParty/@Communication.Contact"/>
                    <PropertyValue Property="Label" String="Sold-To-Party"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="PurchaseOrderByCustomer"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SalesOrderDate"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                    <Annotation Term="UI.Hidden" Path="Delivered"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="ShippingCondition"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="OverallSDProcessStatus"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                    <PropertyValue Property="Criticality" Path="StatusCriticality"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="DescriptionFieldForOPACleanup"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.fieldGroup: [
  {
    targetelement: 'SALESORDERMANAGE',
    label: 'Referenced Sales Order',
    value: '_REFERENCEDSALESORDER.SALESORDER',
    type: #WITH_NAVIGATION_PATH,
    position: 10,
    qualifier: 'OrderData'
  }
]
_REFERENCEDSALESORDER;

@UI.fieldGroup: [
  {
    value: '_SOLDTOPARTY',
    label: 'Sold-To-Party',
    type: #AS_CONTACT,
    position: 20 ,
    qualifier: 'OrderData'
  }
]
_SOLDTOPARTY;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    position: 30 ,
    qualifier: 'OrderData'
  }
]
PURCHASEORDERBYCUSTOMER;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    hidden: true,
    position: 40 ,
    qualifier: 'OrderData'
  }
]
SALESORDERDATE;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    position: 50 ,
    qualifier: 'OrderData'
  }
]
SHIPPINGCONDITION;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    criticality: 'STATUSCRITICALITY',
    position: 60 ,
    qualifier: 'OrderData'
  }
]
OVERALLSDPROCESSSTATUS;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    position: 70 ,
    qualifier: 'OrderData'
  }
]
DESCRIPTIONFIELDFOROPACLEANUP;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.FieldGroup #OrderData : {
    $Type : 'UI.FieldGroupType',
    Data : [
        {
            $Type : 'UI.DataFieldWithNavigationPath',
            Label : 'Referenced Sales Order',
            Value : _ReferencedSalesOrder.SalesOrder,
            Target : SalesOrderManage
        },
        {
            $Type : 'UI.DataFieldForAnnotation',
            Target : '_SoldToParty/@Communication.Contact',
            Label : 'Sold-To-Party'
        },
        {
            $Type : 'UI.DataField',
            Value : PurchaseOrderByCustomer,
            ![@UI.Importance] : #High
        },
        {
            $Type : 'UI.DataField',
            Value : SalesOrderDate,
            ![@UI.Importance] : #High,
            ![@UI.Hidden] : Delivered
        },
        {
            $Type : 'UI.DataField',
            Value : ShippingCondition,
            ![@UI.Importance] : #High
        },
        {
            $Type : 'UI.DataField',
            Value : OverallSDProcessStatus,
            Criticality : StatusCriticality,
            ![@UI.Importance] : #High
        },
        {
            $Type : 'UI.DataField',
            Value : DescriptionFieldForOPACleanup,
            ![@UI.Importance] : #High
        }
    ]
}
```

**STEP**: 4 — OData V4: Define Communication.Contact Popover

**DESCRIPTION**: Define the contact details for the referenced entity. Add this Communication.Contact XML in your UI annotations or define equivalent fields with semantics in ABAP CDS or CAP CDS. The Contact fields map to fn (full name), email, tel, adr, and photo shown in the popover.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotation Term="Communication.Contact">
    <Record Type="Communication.ContactType">
        <PropertyValue Property="adr">
            <Collection>
                <Record Type="Communication.AddressType">
                    <PropertyValue Property="type" EnumMember="Communication.ContactInformationType/work"/>
                    <PropertyValue Property="uri" Path="InternationalPhoneNumber"/>
                    <PropertyValue Property="code" Path="PostalCode"/>
                    <PropertyValue Property="country" Path="Country"/>
                    <PropertyValue Property="locality" Path="CityName"/>
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="email">
            <Collection>
                <Record Type="Communication.EmailAddressType">
                    <PropertyValue Property="type" EnumMember="Communication.ContactInformationType/work"/>
                    <PropertyValue Property="address" Path="EmailAddress"/>
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="fn" Path="CustomerName"/>
        <PropertyValue Property="tel">
            <Collection>
                <Record Type="Communication.PhoneNumberType">
                    <PropertyValue Property="type" EnumMember="Communication.PhoneType/fax"/>
                    <PropertyValue Property="uri" Path="InternationalPhoneNumber"/>
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="photo" Path="CustomerImg"/>
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
define view VIEWNAME
{
  @Semantics.name.fullName: true
  CustomerName,

  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK]
  EmailAddress,

  @Semantics.telephone.type:  [ #FAX ] 
  InternationalPhoneNumber,

  @Semantics.address : { zipCode: true } 
  PostalCode,

  @Semantics.address : { country: true } 
  Country,

  @Semantics.address : { city: true }  
  CityName,

  @Semantics.contact.photo: true
  CustomerImg
}
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
Communication.Contact : {
    $Type : 'Communication.ContactType',
    adr : [
        {
            $Type : 'Communication.AddressType',
            type : #work,
            uri : InternationalPhoneNumber,
            code : PostalCode,
            country : Country,
            locality : CityName
        }
    ],
    email : [
        {
            $Type : 'Communication.EmailAddressType',
            type : #work,
            address : EmailAddress
        }
    ],
    fn : CustomerName,
    tel : [
        {
            $Type : 'Communication.PhoneNumberType',
            type : #fax,
            uri : InternationalPhoneNumber
        }
    ],
    photo : CustomerImg
},
```

**STEP**: 5 — More Information

**DESCRIPTION**: Refer to the official documentation for additional guidance and examples.

**LANGUAGE**: Markdown

**CODE**:
```Markdown
See: adding-a-contact-facet-a6a8c0c.md
```
--------------------------------

**TITLE**: Controlling Editability of Child-Entity Sections with UpdateRestrictions and NavigationRestrictions (OData V4)

**INTRODUCTION**: This guide explains how to control editability of fields that originate from child entity sets in SAP Fiori elements (OData V4). It covers XML and CAP CDS annotations for UpdateRestrictions and NavigationRestrictions, boolean vs path-based Updatable values, priority rules, draft implications, and sample annotations. Use these snippets in local annotation files or CAP models to make fields editable or read-only depending on entity capabilities and runtime field control.

**TAGS**: fiori-elements, odata-v4, annotations, UpdateRestrictions, NavigationRestrictions, CAP, XML, CDS, editability, draft

**STEP**: Applicability and high-level rules
**DESCRIPTION**: Key rules to apply when controlling editability of child-entity fields.
- Only applies to SAP Fiori elements for OData V4.
- UpdateRestrictions on a child entity controls editability of fields originating from that entity.
- UpdateRestrictions is ignored for the main (primary) entity set of the list report.
- Editability of child-entity fields also depends on:
  - Whether the list report entity set can be updated (list-report Updatable).
  - The UI edit state (e.g., object page in edit mode) and property field control.
- NavigationRestrictions on the parent entity set take precedence: if the parent NavigationRestrictions marks the navigation property as Updatable=false, child records cannot be edited regardless of child UpdateRestrictions.
- UpdateRestrictions.Updatable supports Boolean and Path expressions (use Path to vary by record state, e.g., draft vs activated).

**LANGUAGE**: TEXT
**CODE**:
```text
Rules summary:
- Applicable: SAP Fiori elements for OData V4 only.
- UpdateRestrictions controls editability of fields from that entity (ignored for main entity set).
- Parent's Org.OData.Capabilities.V1.NavigationRestrictions has priority.
- Updatable supports Bool or Path.
- For drafts use Path-based Updatable to allow draft editing but disable after activation.
```

**STEP**: Set UpdateRestrictions (XML annotation example for child entity)
**DESCRIPTION**: Make all fields of a child entity updatable by setting UpdateRestrictions.Updatable to true (XML local annotation). Target the entity namespace-qualified name.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Local annotation file (e.g., annotations.xml) -->
<Annotations Target="com.c_salesordermanage_sd.MaterialCategory">
     <Annotation Term="Capabilities.UpdateRestrictions">
          <Record Type="Capabilities.UpdateRestrictionsType">
               <PropertyValue Property="Updatable" Bool="true"/>
          </Record>
     </Annotation>
</Annotations>
```

**STEP**: Set UpdateRestrictions (CAP CDS example for child entity)
**DESCRIPTION**: Equivalent CAP CDS annotation to mark child entity updatable. Place in your .cds model or annotation file.
**LANGUAGE**: CDS
**CODE**:
```cds
annotate c_salesordermanage_sd.MaterialCategory with @Capabilities : {
    UpdateRestrictions : { Updatable : true }
};
```

**STEP**: Parent NavigationRestrictions to restrict editing of a navigation property (XML)
**DESCRIPTION**: On the parent entity, set NavigationRestrictions.RestrictedProperties with a NavigationProperty entry that sets UpdateRestrictions.Updatable=false for that navigation. This prevents editing child records accessed via that navigation property.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Local annotation file (e.g., annotations.xml) on parent entity set) -->
<Annotation Term="Capabilities.NavigationRestrictions">
     <Record Type="Capabilities.NavigationRestrictionsType">
          <PropertyValue Property="RestrictedProperties">
               <Collection>
                    <Record Type="Capabilities.NavigationPropertyRestriction">
                         <PropertyValue Property="NavigationProperty" NavigationPropertyPath="_MaterialDetails"/>
                         <PropertyValue Property="UpdateRestrictions">
                              <Record Type="Capabilities.UpdateRestrictionsType">
                                   <PropertyValue Property="Updatable" Bool="false"/>
                              </Record>
                         </PropertyValue>
                    </Record>
               </Collection>
          </PropertyValue>
     </Record>
</Annotation>
```

**STEP**: Parent NavigationRestrictions (CAP CDS example)
**DESCRIPTION**: CAP CDS equivalent to restrict updates on the navigation property from the parent entity model.
**LANGUAGE**: CDS
**CODE**:
```cds
entity SalesOrderItem @(
  Capabilities : {
    NavigationRestrictions : {
      RestrictedProperties : [{
        NavigationProperty : _MaterialDetails,
        UpdateRestrictions : { Updatable : false }
      }]
    }
  }
);
```

**STEP**: Use path-based Updatable (XML) — allow draft edits but block after activation
**DESCRIPTION**: Use a Path expression for UpdateRestrictions.Updatable so editability can depend on an entity property (e.g., isUpdatable). This enables scenarios where newly created draft records remain editable but become read-only after activation.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="com.c_salesordermanage_sd_aggregate.MaterialDetails">
     <Annotation Term="Capabilities.UpdateRestrictions">
          <Record Type="Capabilities.UpdateRestrictionsType">
               <PropertyValue Property="Updatable" Path="isUpdatable"/>
          </Record>
     </Annotation>
</Annotations>
```

**STEP**: Use path-based Updatable (CAP CDS)
**DESCRIPTION**: CAP CDS equivalent of the path-based Updatable property. Ensure the referenced property (isUpdatable) exists on the entity and evaluates correctly per record state.
**LANGUAGE**: CDS
**CODE**:
```cds
annotate MaterialDetails with @(
    Capabilities.UpdateRestrictions : {
        Updatable : isUpdatable
    }
);
```

**STEP**: Draft behavior recommendation and caveats
**DESCRIPTION**: Important guidance for draft-enabled scenarios:
- If you set UpdateRestrictions.Updatable = false (static boolean) on an entity, this applies to both draft and active records and prevents editing even on draft copies. To allow creation and editing of draft records while denying edits after activation, use a Path expression that evaluates to true for draft records and false for activated records.
- Ensure list report entity set is updatable and UI is in edit mode for child-entity fields to be editable (subject to UpdateRestrictions and NavigationRestrictions).

**LANGUAGE**: TEXT
**CODE**:
```text
Draft guidance:
- Avoid static Updatable=false if drafts should be editable.
- Use Updatable Path (e.g., isUpdatable) that returns true for draft records and false after activation.
- This enables users to create/edit drafts but prevents edits post-activation.
```

**STEP**: Visual reference (image file paths)
**DESCRIPTION**: Reference images illustrating behavior described above. Keep these image assets in your project or documentation media folder and reference them in your documentation pages.
**LANGUAGE**: TEXT
**CODE**:
```text
Images referenced:
- images/UpdateRestrictions1_9616035.png
- images/UpdateRestrictions2_b3a0021.png
```

**STEP**: Cross references
**DESCRIPTION**: Related documentation pointers.
- Field control details: Further Features of the Field (further-features-of-the-field-f49a0f7.md)
- Main entity editability and annotation-based actions: Actions -> Enabling Custom Actions Defined Using Annotations (actions-cbf16c5.md#loiocbf16c599f2d4b8796e3702f7d4aae6c__subsection_xkx_gwq_nsb)

**LANGUAGE**: TEXT
**CODE**:
```text
Related docs:
- further-features-of-the-field-f49a0f7.md
- actions-cbf16c5.md#loiocbf16c599f2d4b8796e3702f7d4aae6c__subsection_xkx_gwq_nsb
```
--------------------------------

**TITLE**: Enabling and Using Copy/Paste from External Applications to Editable SAP Fiori Elements Tables

**INTRODUCTION**: Brief guide for developers and implementers to enable, configure, and use copy/paste between external applications (for example spreadsheets) and editable SAP Fiori elements tables. Covers supported scenarios (table-level and cell-level paste), developer configuration options, OData V2/V4 specifics, restrictions, and recommended spreadsheet preparation (split cells).

**TAGS**: fiori-elements-framework, tables, copy-paste, clipboard, sapui5, manifest.json, odata-v2, odata-v4, export-to-spreadsheet

STEP: Supported paste scenarios and table types
DESCRIPTION: Summarize when paste is available and which table types support which paste modes.
LANGUAGE: Text
CODE:
```Text
- Table-level paste:
  - Function: Create new rows and paste clipboard data into them.
  - Requirements:
    - Draft-enabled applications only.
    - Table creation mode must be "inline" or "creationRows".
    - Trigger: Browser paste (Ctrl+V on Windows, Cmd+V on macOS) when focus is anywhere on the table or select an empty row; or click the Paste icon in the table toolbar.
  - New rows are created only when above conditions are met.

- Cell-level paste:
  - Function: Add or update values in a single cell or selected group of cells. If selected cells include an empty row, additional rows may be created for extra data.
  - Requirements:
    - Only supported by GridTable and ResponsiveTable.
    - Selection must be either a single cell or a contiguous range of cells.
    - Active/draft row values are replaced with clipboard content.

- UI:
  - Copy button shown in table toolbar by default.
  - Paste icon shown only if table supports paste action.
```

STEP: User actions and behavior
DESCRIPTION: Provide step-by-step actions for end users and expected system behavior during paste.
LANGUAGE: Text
CODE:
```Text
- Prepare data in spreadsheet using "split cells" export format to avoid formatting issues (recommended).
- Select and Copy data in spreadsheet (Ctrl/Cmd+C).
- In the Fiori table:
  - Table-level paste: focus anywhere on the table or select an empty row then press Ctrl/Cmd+V or click Paste icon.
  - Cell-level paste: select a single cell or range of cells, then press Ctrl/Cmd+V or click Paste icon.
- Result behavior:
  - If new rows are created during paste, all new rows are sent in a single POST batch call.
  - If validation errors occur, a dialog displays the error(s) and the end user must resolve them.
  - For cells containing both ID and text, the property is updated immediately but the text description may only update after saving.
```

STEP: Developer configuration — manifest.json snippet to disable paste
DESCRIPTION: How to disable paste for a specific table component by setting enablePaste to false in the manifest (component options/settings). Place this snippet in your app manifest settings where you configure the ObjectPage or table controlConfiguration.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "components": {
      "SalesOrderManageObjectPageEnableExport": {
        "type": "Component",
        "id": "SalesOrderManageObjectPage",
        "name": "sap.fe.templates.ObjectPage",
        "options": {
          "settings": {
            "controlConfiguration": {
              "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                "tableSettings": {
                  "type": "GridTable",
                  "enablePaste": false,
                  "condensedTableLayout": true,
                  "personalization": {
                    "column": true,
                    "sort": false
                  },
                  "creationMode": {
                    "name": "Inline"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 specifics (smart table with inline actions)
DESCRIPTION: Developer and user notes specific to OData V2 smart tables with inline actions and read-only columns.
LANGUAGE: Text
CODE:
```Text
- If a SmartTable contains inline actions, the paste function is available, but:
  - Columns that contain inline actions are ignored by the paste operation; omit these columns from your source while copying.
  - Read-only columns are ignored by the paste operation (they are included when exporting to spreadsheets but ignored on paste).
- Exported spreadsheet includes read-only columns to preserve column layout for paste preparation.
```

STEP: OData V4 specifics (object page defaults and validation)
DESCRIPTION: Behavior and constraints for OData V4, including default enablement, split-cell export, and validation responsibilities.
LANGUAGE: Text
CODE:
```Text
- Default:
  - Paste is enabled by default on the Object Page if creation mode is set to "inline" or "empty row".
  - See: Enabling Inline Creation Mode or Empty Row Mode for Table Entries (enabling-inline-creation-mode-or-empty-row-mode-for-table-entries-cfb04f0.md).

- Export to generate paste template:
  - Export the table in split-cell mode to generate a spreadsheet template that shows expected column layout and placeholders for inline actions.
  - End users must preserve placeholder columns for inline actions when pasting back; these columns may be empty.

- Restrictions and validation:
  - Properties annotated with textArrangement = "TextOnly" cannot be pasted.
  - Front end verifies data type alignment on paste but does NOT enforce other checks (e.g., field editability, fixed value lists).
  - Strict validation must be implemented on the back end.
```

STEP: Restrictions and important notes (global)
DESCRIPTION: Consolidated list of restrictions, unsupported field types, and performance considerations.
LANGUAGE: Text
CODE:
```Text
- Unsupported field types: Complex fields such as links, images, connected fields, multi-input fields, and field groups are not supported for paste.
- Navigation properties: You cannot paste into a cell that contains a navigation property.
- Text-only properties: Properties annotated with textArrangement = "TextOnly" (OData V4) cannot be pasted.
- Custom tables: Paste feature is not supported in custom tables (only standard Fiori elements table controls).
- POST batching: New rows created during paste are included in a single POST batch call; duration increases with the number of rows pasted.
- Row order: Order of pasted rows may differ from the order in the source spreadsheet after insertion; this behavior is not controlled by SAP Fiori elements.
- Validation UI: If validation fails, an error dialog is shown and user action is required.
```

STEP: Preparing spreadsheets for reliable paste
DESCRIPTION: Guidelines and a recommended workflow to prepare spreadsheet data for paste to Fiori tables.
LANGUAGE: Text
CODE:
```Text
- Recommended workflow:
  1. Export the target table using "Export to Spreadsheet" (available by default only if copy/paste is available; see using-the-export-button-4bab6f2.md).
  2. Use the exported file with "split cells" layout as the paste template.
  3. Remove columns that correspond to inline actions for OData V2 or keep placeholders for inline actions for OData V4 (per instruction above).
  4. Ensure only simple fields (IDs, numbers, dates, plain text) are used. Do not include complex field types.
  5. Copy the relevant range from the spreadsheet and paste into the table (see user actions step).
```

STEP: References and related documentation
DESCRIPTION: Keep links and file names for related docs and sections for deeper reading or implementation references.
LANGUAGE: Text
CODE:
```Text
- Using the Export Button: using-the-export-button-4bab6f2.md
- Enabling Inline Creation Mode or Empty Row Mode for Table Entries: enabling-inline-creation-mode-or-empty-row-mode-for-table-entries-cfb04f0.md
- Tables > Copying Multiple Rows and Range Selections: tables-c0f6592.md#loioc0f6592a592e47f9bb6d09900de47412__section_pth_3mb_dzb
- Image assets (examples and screenshots): images/Copying_Data_from_a_Table_3e5d9c8.png,
  images/Excel_copy_paste_5_db3d9d3.png, images/Excel_copy_paste_6_fa98abc.png,
  images/Pasting_in_Excel_with_Inline_Actions_8173bd4.png,
  images/Sample_Data_for_Pasting_in_Exccel_with_Inline_Action_b4c1a5d.png
```
--------------------------------

**TITLE**: Create a propertyBindingChange for SAP Fiori elements (OData V2)

**INTRODUCTION**: This document explains how to create a property binding change (propertyBindingChange) for SAP Fiori elements (OData V2). Use it to bind control properties (for example, visible, enabled) to model properties or expressions so the UI reacts dynamically. Applicable when the model data has already been retrieved by the model.

**TAGS**: fiori-elements, odata-v2, ui5, propertyBindingChange, change-files, page-editor, adaptations

**STEP**: 1 — Validate applicability and constraints

**DESCRIPTION**: Confirm this procedure applies to your app/page and review constraints:
- Only for SAP Fiori elements for OData V2.
- Common use cases: Object Page — show header content in edit mode, show header parts per mode, control section visibility.
- The bound property must have been retrieved by the model.
- If binding to an OData property, that OData property must belong to the same node or the root node.

**LANGUAGE**: text

**CODE**:
```text
Notes:
- Applicable: SAP Fiori elements (OData V2)
- Use cases: Object Page (header/section visibility, mode-based control)
- OData-binding constraint: OData property must be on same node or root node
```

**STEP**: 2 — Create or modify a change via Page Editor

**DESCRIPTION**: Use the Page Editor to locate the control/property (e.g., section visible, button enabled). In the property panel, either select an existing value or compose an expression. If you already have a propertyChange file, convert it to a propertyBindingChange as shown below.

**LANGUAGE**: text

**CODE**:
```text
Action:
1. Open the Page Editor for the target application/page.
2. Locate the control and the property (e.g., visible).
3. In the property panel, choose a binding expression or compose one.
4. If a propertyChange file exists, update it to propertyBindingChange (see next step).
```

**STEP**: 3 — Example: convert an existing propertyChange file to propertyBindingChange

**DESCRIPTION**: Replace changeType and change content: remove newValue and add newBinding with the binding expression (e.g., "{myProperty}" or expression binding). Preserve other metadata (selector, layer, namespace, support, creation, originalLanguage, etc.).

**LANGUAGE**: JSON

**CODE**:
```json
// Original propertyChange example (replace this file if present)
{
    "fileName": "id_1460988346969_256_propertyChange",
    "fileType": "change",
    "changeType": "propertyChange",
    "reference": "STTA_MP.Component",
    "packageName": "$TMP",
    "content": {
        "property": "visible",
        "oldValue": true,
        "newValue": false
    },
    "selector": {
        "id": "STTA_MP::sap.suite.ui.generic.template.ObjectPage.view.Details::STTA_C_MP_Product--action::STTA_PROD_MAN.STTA_PROD_MAN_Entities::STTA_C_MP_ProductCopywithparams",
        "type": "sap.uxap.ObjectPageHeaderActionButton"
    },
    "layer": "CUSTOMER_BASE",
    "texts": {},
    "namespace": "apps/STTA_MP/changes/",
    "creation": "2016-04-18T14:05:47.149Z",
    "originalLanguage": "EN",
    "conditions": {},
    "context": "",
    "support": {
        "generator": "Change.createInitialFileContent",
        "service": "",
        "user": ""
    }
}
```

**LANGUAGE**: JSON

**CODE**:
```json
// Converted propertyBindingChange example: use newBinding instead of newValue
{
    "fileName": "id_1460988346969_256_propertyChange",
    "fileType": "change",
    "changeType": "propertyBindingChange",
    "reference": "STTA_MP.Component",
    "packageName": "$TMP",
    "content": {
        "property": "visible",
        "oldValue": true,
        "newBinding": "{myProperty}"
    },
    "selector": {
        "id": "STTA_MP::sap.suite.ui.generic.template.ObjectPage.view.Details::STTA_C_MP_Product--action::STTA_PROD_MAN.STTA_PROD_MAN_Entities::STTA_C_MP_ProductCopywithparams",
        "type": "sap.uxap.ObjectPageHeaderActionButton"
    },
    "layer": "CUSTOMER_BASE",
    "texts": {},
    "namespace": "apps/STTA_MP/changes/",
    "creation": "2016-04-18T14:05:47.149Z",
    "originalLanguage": "EN",
    "conditions": {},
    "context": "",
    "support": {
        "generator": "Change.createInitialFileContent",
        "service": "",
        "user": ""
    }
}
```

**STEP**: 4 — Use expression bindings and model prefixes

**DESCRIPTION**: You can use expression bindings, model-prefixed bindings, or i18n bindings in newBinding. Examples below show common patterns and UI model properties for the Object Page.

**LANGUAGE**: JSON

**CODE**:
```json
// Direct property binding (boolean provided by model)
"newBinding": "{myProperty}"

// Expression binding: invert boolean
"newBinding": "{= !${myProperty}}"

// UI model bindings for Object Page modes:
"newBinding": "{ui>/editable}"          // Edit mode
"newBinding": "{= !${ui>/editable}}"   // Display mode (inverse)
"newBinding": "{ui>/createMode}"       // Create mode (entity being created)
"newBinding": "{ui>/enabled}"          // Controls enabled (buttons, etc.)

// i18n text binding example
"newBinding": "{i18n>xtol.MoveDown}"
```

**STEP**: 5 — Best practices & final checks

**DESCRIPTION**: 
- Ensure the model property paths (e.g., ui>/editable or myProperty) are available at runtime.
- Validate selectors (id and type) correctly target the control.
- Keep change file metadata (namespace, layer, reference, creation) accurate.
- Use expression binding for simple transformations (negation, ternary-like constructs) rather than creating extra model properties.

**LANGUAGE**: text

**CODE**:
```text
Checklist:
- Model property exists and is loaded before change is applied.
- OData-bound property belongs to same or root node (if using OData binding).
- Selector id/type matches the control to be adapted.
- Test expression bindings in the running application to confirm behavior.
```
--------------------------------

**TITLE**: Create a Fiori List Report Without Variant Management (OData V2 & V4)

**INTRODUCTION**: Quick, actionable steps to disable standard variant management for SAP Fiori elements List Report apps (OData V2 and OData V4) by editing manifest.json and i18n properties. Includes sample manifest fragments, i18n keys, and notes about interactions between settings.

**TAGS**: fiori-elements-framework, sap-fiori, list-report, variant-management, manifest.json, i18n, ODataV2, ODataV4

**STEP**: OData V2 — Disable Variant Management (manifest.json)

**DESCRIPTION**: In the app's manifest.json set variantManagementHidden in the List Report component settings. This hides the standard variant management UI and displays the app name instead. Ensure smartVariantManagement is enabled when you want to hide both page and control variants (see NOTE below).

File: webapp/manifest.json — edit the "sap.ui.generic.app" → pages[].component.settings section.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "XXXXXX_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "gridTable": false,
            "smartVariantManagement": true,
            "variantManagementHidden": true
          }
        }
      }
    ]
  }
}
```

**STEP**: OData V2 — Use an App-Specific Title When Variant Management Is Hidden (i18n)

**DESCRIPTION**: If variantManagementHidden is true and you want a custom title displayed instead of a variant name, add a localized key subTitleIfVariantMgmtHidden to your i18n properties file and reference it in manifest.json (see next step).

File: webapp/i18n/i18n.properties

**LANGUAGE**: Properties

**CODE**:
```
# XTIT,40
subTitleIfVariantMgmtHidden = List Report Custom Title
```

**STEP**: OData V2 — Reference the i18n Title in manifest.json

**DESCRIPTION**: Add subTitleIfVariantMgmtHidden with an i18n binding to the List Report settings to present the custom subtitle when variant management is hidden.

File: webapp/manifest.json — add or update the property under the same component settings shown earlier.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "XXXXXX_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "gridTable": false,
            "smartVariantManagement": true,
            "variantManagementHidden": true,
            "subTitleIfVariantMgmtHidden": "{{subTitleIfVariantMgmtHidden}}"
          }
        }
      }
    ]
  }
}
```

**STEP**: OData V2 — NOTE on smartVariantManagement

**DESCRIPTION**: The property variantManagementHidden should be used together with "smartVariantManagement": true to hide page variants and control variants. If variantManagementHidden is set alone (smartVariantManagement absent or false) it hides only the filter bar variant.

---

**STEP**: OData V4 — Disable Variant Management (manifest.json routing target)

**DESCRIPTION**: For OData V4 apps, set variantManagement to "None" inside the target options.settings of the List Report target in sap.ui5.routing.targets. This disables standard variant management and the app name will be shown instead.

File: webapp/manifest.json — edit sap.ui5.routing.targets.[YourListTarget].options.settings

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "XXXXXX_List": {
          "type": "Component",
          "id": "XXXXXX_List",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/XXXXXX",
              "variantManagement": "None"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: OData V4 — Use an App-Specific Title (i18n)

**DESCRIPTION**: Add a localized subtitle key (for example appSubTitle) to the i18n properties file and reference it from the manifest to show a custom subtitle when variants are not used.

File: webapp/i18n/i18n.properties

**LANGUAGE**: Properties

**CODE**:
```
# XTIT, 40
appSubTitle = List Report Custom Title
```

**STEP**: OData V4 — Reference the i18n Subtitle in manifest.json (sap.app)

**DESCRIPTION**: Bind the i18n key to sap.app.subTitle so the custom subtitle displays for the application.

File: webapp/manifest.json — add/update in "sap.app"

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "XXXXXX",
    "type": "application",
    "i18n": "i18n/i18n.properties",
    "title": "{{title}}",
    "subTitle": "{{appSubTitle}}",
    "description": "{{description}}"
  }
}
```

**Related**: See Managing Variants documentation for details on Page vs Control variant behavior and additional configuration.
--------------------------------

**TITLE**: Create a SAP Fiori elements Project (VS Code / Business Application Studio)

**INTRODUCTION**: Practical, code-focused steps to create a SAP Fiori elements project using SAP Fiori tools in Visual Studio Code or SAP Business Application Studio. Includes prerequisites, installing the tools, GUI generator usage, and an optional CLI invocation of the Yeoman generator.

**TAGS**: fiori-elements, sap-fiori-tools, visual-studio-code, sap-business-application-studio, scaffolding, generator

**STEP**: 1 — Verify prerequisites

**DESCRIPTION**: Ensure you have completed the required prerequisites before creating an app (SDK versions, connectivity, account access, Node/npm, etc.). Confirm you are using either SAP Business Application Studio or Visual Studio Code.

**LANGUAGE**: Text

**CODE**:
```
Read prerequisites:
- Local/relative doc: prerequisites-for-using-sap-fiori-elements-f2344b5.md
- SAP Fiori tools docs: https://help.sap.com/docs/SAP_FIORI_tools
Ensure:
- Node.js and npm installed (per your environment requirements)
- You have access to SAP back-end if required by your app template
- Using one of: SAP Business Application Studio or Visual Studio Code
```

**STEP**: 2 — Install SAP Fiori tools extension (Visual Studio Code) or verify BAS dev space

**DESCRIPTION**: Install the SAP Fiori tools extension pack in VS Code or use a BAS dev space that already includes SAP Fiori tools. This provides the Application Generator (template wizard) and other tooling for scaffolding Fiori elements apps.

**LANGUAGE**: Text

**CODE**:
```
Visual Studio Code:
1. Open Extensions view (Ctrl+Shift+X).
2. Search for "SAP Fiori tools".
3. Install "SAP Fiori tools - Application Generator" (and related SAP Fiori tools extensions).

SAP Business Application Studio:
1. Create or open a dev space configured for SAP Fiori development.
2. Use the built-in template wizard ("Start from template" or Application Generator) available in the dev space.
```

**STEP**: 3 — Generate an app using the GUI (VS Code Command Palette or BAS wizard)

**DESCRIPTION**: Use the Application Generator UI to scaffold a Fiori elements application. Follow the prompts to choose template type (e.g., List Report / Object Page), data source, OData service, routing, and initial project options. This is the recommended, guided approach.

**LANGUAGE**: Text

**CODE**:
```
Visual Studio Code (Command Palette):
1. Open Command Palette (Ctrl+Shift+P).
2. Run: "Fiori Tools: Application Generator".
3. Follow prompts:
   - Project name / folder
   - Template (e.g., List Report Object Page)
   - Data source (register or select OData service)
   - OData service path (e.g., /sap/opu/odata/sap/<SERVICE>)
   - Authentication / destination settings (if applicable)
   - Finish to scaffold project files

SAP Business Application Studio:
1. Open your dev space.
2. Use "Start from template" / "Application Generator" wizard.
3. Follow the same prompts as above to scaffold the project.
```

**STEP**: 4 — Optional: Generate an app using the Yeoman generator (CLI)

**DESCRIPTION**: If you prefer a CLI approach or cannot use the editor extensions, run the SAP Fiori Yeoman generator via npx (no global installs required). This runs the same generator used by the GUI and prompts for the same settings.

**LANGUAGE**: Shell

**CODE**:
```bash
# Run the SAP Fiori Yeoman generator without global installs:
npx -p yo -p @sap/generator-fiori -c "yo @sap/generator-fiori"

# Follow interactive prompts:
# - project name, template, data source / OData service, routing, etc.
# After scaffolding:
cd <your-project-folder>
# Install dependencies if required:
npm install
# Start local dev server (depends on template/tooling, e.g., UI5 tooling):
# Example (if using UI5 tooling):
npm run start
```

**STEP**: 5 — Links & further reading

**DESCRIPTION**: Official documentation and generator guide referenced for details, troubleshooting, and advanced topics (deployment, connectivity, customizing templates).

**LANGUAGE**: Text

**CODE**:
```
SAP Fiori tools docs: https://help.sap.com/docs/SAP_FIORI_tools
Generate an Application (detailed guide): https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/db44d45051794d778f1dd50def0fa267.html
Prerequisites for Using SAP Fiori Elements (local doc reference): prerequisites-for-using-sap-fiori-elements-f2344b5.md
```
--------------------------------

**TITLE**: Extension Hooks to Modify Navigation Context Before Outbound Navigation (OData V2 & V4)

**INTRODUCTION**: This guide shows how to register a controller extension and implement the extension methods that let you modify the navigation context (add/remove/change selection parameters and selectOptions) just before an external outbound navigation is triggered. Includes code templates for both SAP Fiori elements OData V2 (adaptNavigationParameterExtension) and OData V4 (adaptNavigationContext). Use these templates to implement custom filtering or redaction logic for navigation intents (semantic links, related apps, DataFieldForIntentBasedNavigations).

**TAGS**: sapui5, fiori-elements, extension, navigation, SelectionVariant, adaptNavigationContext, adaptNavigationParameterExtension, manifest.json

**STEP**: Register controller extension in manifest.json (OData V2)

**DESCRIPTION**: Add controller extension registration entries under "extends"/"extensions"/"sap.ui.controllerExtensions" in the app manifest to point to your extension controller names for the List Report and Object Page templates (OData V2). Place this snippet in manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "MY_APP.ext.controller.ListReportExtension"
          },
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "controllerName": "MY_APP.ext.controller.DetailsExtension"
          }
        }
      }
    }
  }
}
```

**STEP**: Register controller extension in manifest.json (OData V4 / FE)

**DESCRIPTION**: For SAP Fiori elements OData V4 (FE), register controller extensions pointing to the FE controller types. Place this snippet in manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ListReport.ListReportController": {
            "controllerName": "SalesOrder.ext.LRExtend"
          },
          "sap.fe.templates.ObjectPage.ObjectPageController": {
            "controllerName": "SalesOrder.ext.OPExtend"
          }
        }
      }
    }
  }
}
```

**STEP**: Create controller extension files (file paths and names)

**DESCRIPTION**: Create the controller extension files under your app namespace. Example file paths:
- webapp/ext/controller/ListReportExtension.controller.js
- webapp/ext/controller/DetailsExtension.controller.js
- webapp/ext/LRExtend.controller.js (for FE sample)
- webapp/ext/OPExtend.controller.js (for FE sample)

Follow UI5 module naming consistent with manifest controllerName entries.

**LANGUAGE**: Plain text

**CODE**:
```text
Place files at:
- webapp/ext/controller/ListReportExtension.controller.js             -> "MY_APP.ext.controller.ListReportExtension"
- webapp/ext/controller/DetailsExtension.controller.js              -> "MY_APP.ext.controller.DetailsExtension"
- webapp/ext/LRExtend.controller.js                                 -> "SalesOrder.ext.LRExtend"
- webapp/ext/OPExtend.controller.js                                 -> "SalesOrder.ext.OPExtend"
```

**STEP**: Implement adaptNavigationParameterExtension (OData V2) — controller extension template

**DESCRIPTION**: Implement adaptNavigationParameterExtension(oSelectionVariant, oObjectInfo) to modify the SelectionVariant before outbound navigation. Use SelectionVariant API: removeParameter, removeSelectOption, getSelectOptionsPropertyNames, etc. Do not remove required properties such as the semanticObject property for semantic object links.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define(["sap/ui/core/mvc/Controller"], function(Controller) {
  "use strict";

  return Controller.extend("MY_APP.ext.controller.ListReportExtension", {
    /**
     * Modify navigation parameters before outbound navigation (OData V2).
     * @param {sap.ui.generic.app.navigation.service.SelectionVariant} oSelectionVariant
     * @param {object} oObjectInfo - additional object info provided by the framework
     */
    adaptNavigationParameterExtension: function(oSelectionVariant, oObjectInfo) {
      // Example: remove a simple parameter
      oSelectionVariant.removeParameter("Currency");

      // Example: remove a selectOption by property name
      oSelectionVariant.removeSelectOption("Price");

      // Example: remove all selectOptions whose property name starts with 'D'
      oSelectionVariant.getSelectOptionsPropertyNames().forEach(function(sSelectOptionName) {
        if (sSelectOptionName.startsWith("D")) {
          oSelectionVariant.removeSelectOption(sSelectOptionName);
        }
      });

      // Customize as needed. Do not remove mandatory properties (e.g. semanticObject).
    }
  });
});
```

**STEP**: Implement adaptNavigationContext (OData V4 / FE) — controller extension template

**DESCRIPTION**: For OData V4 FE apps, implement override.intentBasedNavigation.adaptNavigationContext(oSelectionVariant, oTargetInfo). oSelectionVariant is pre-filtered (sensitive data excluded and object mapping applied). oTargetInfo contains semanticObject and action. The method is invoked once when the outbound navigation is triggered (even if multiple links open); it is not invoked for second-level clicks.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/base/Log"
], function(Controller, Log) {
  "use strict";

  return Controller.extend("SalesOrder.ext.OPExtend", {
    override: {
      intentBasedNavigation: {
        /**
         * Modify the navigation context before outbound navigation (OData V4 / FE).
         * @param {sap.ui.generic.app.navigation.service.SelectionVariant} oSelectionVariant
         * @param {object} oTargetInfo - { semanticObject: string, action: string, ... }
         */
        adaptNavigationContext: function(oSelectionVariant, oTargetInfo) {
          Log.info("adaptNavigationContext called with semanticObject: " + oTargetInfo.semanticObject +
                   " and action: " + oTargetInfo.action);

          // Example: remove a selectOption
          oSelectionVariant.removeSelectOption("HasDraftEntity");

          // Add or change parameters/selectOptions as needed:
          // oSelectionVariant.addParameter("NewParam", "Value");
          // oSelectionVariant.addSelectOption("SomeProp", "I", "EQ", "42");

          // Ensure you do not remove required properties for the configured link.
        }
      }
    }
  });
});
```

**STEP**: Important integration and security notes (actionable)

**DESCRIPTION**: Follow these rules when implementing extensions:
- Use only the official SAP Fiori elements extension API; do not access or modify internal framework controls, models, or bindings.
- The extension method runs just before external outbound navigation (semantic links, related apps, DataFieldForIntentBasedNavigations).
- oSelectionVariant already excludes sensitive information and respects object mapping applied by the framework.
- oTargetInfo contains at least semanticObject and action.
- Do not remove all properties required for the link (e.g., semanticObject must remain for semantic object links).
- The method is invoked once per outbound navigation trigger; it will not be called again for second-level link clicks.

**LANGUAGE**: Plain text

**CODE**:
```text
References:
- SelectionVariant API: https://ui5.sap.com/#/api/sap.ui.generic.app.navigation.service.SelectionVariant/overview
- Use extensionAPI guidance: using-the-extensionapi-bd2994b.md
- Security configuration: security-configuration-ba0484b.md
```
--------------------------------

**TITLE**: Creating Cards for the Insights Cards Section of My Home (SAP S/4HANA Cloud Public Edition & SAP S/4HANA)

**INTRODUCTION**: This guide shows how to enable the runtime option that lets end users create cards from list report tables and analytical list page (ALP) charts and how application developers can hide that option by configuring manifest.json. Includes examples for SAP Fiori elements OData V2 and OData V4, supported/unsupported column types, and known restrictions.

**TAGS**: fiori-elements-framework, sapui5, manifest.json, cards, my-home, insights, odata-v2, odata-v4, list-report, analytical-list-page

STEP: 1 — Prerequisite: enable My Home for your system
DESCRIPTION: Ensure an administrator has enabled "My Home" in SAP S/4HANA Cloud Public Edition or SAP S/4HANA. Once enabled, the "Add Card to Insights" option appears automatically in:
- the table overflow toolbar of List Report applications
- the chart overflow toolbar of Analytical List Page (ALP) applications
LANGUAGE: Text
CODE:
```Text
Admin task: Enable "My Home" in SAP S/4HANA Cloud Public Edition or SAP S/4HANA.
Result: "Add Card to Insights" appears automatically in the overflow toolbar of supported UI controls.
```

STEP: 2 — Supported and unsupported columns for card creation
DESCRIPTION: The card creation dialog only shows columns that are supported for integration cards. Use these rules when designing your List Report / ALP to ensure columns are eligible.
LANGUAGE: Text
CODE:
```Text
Supported column types (card creation dialog):
- Single-valued DataField-based columns
- DataFieldWithUrl (fields displayed as links)
- Semantic links
- DataField with QuickViewFacets
- (OData V4 only) DataFieldWithIntentBasedNavigation
- (OData V4 only) DataFieldWithNavigationPath

Unsupported column types:
- Image columns
- Multi-valued based columns
- FieldGroup-based columns
- Columns with inline actions
- Columns with navigation button
- DataFieldForAnnotation (contact/address fields)
- Custom columns

OData V4 note:
- Card creation supports single view scenarios and single-entity multi-view scenarios with ResponsiveTable only.
```

STEP: 3 — Hide "Add Card to Insights" in OData V2 List Report via manifest.json
DESCRIPTION: In an OData V2 List Report, set addCardtoInsightsHidden to true inside tableSettings of the page component in manifest.json to hide the toolbar option.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Zfarvd_Bs_Hd_Bo",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "tableSettings": {
              "addCardtoInsightsHidden": true
            }
          }
        }
      }
    ]
  }
}
```

STEP: 4 — Hide "Add Card to Insights" in OData V2 Analytical List Page via manifest.json
DESCRIPTION: In an OData V2 Analytical List Page, set addCardtoInsightsHidden to true inside chartSettings of the page component in manifest.json to hide the chart toolbar option.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Zfarvd_Bs_Hd_Bo",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "chartSettings": {
              "addCardtoInsightsHidden": true
            }
          }
        }
      }
    ]
  }
}
```

STEP: 5 — Hide "Add Card to Insights" in OData V4 List Report (table toolbar) via manifest.json
DESCRIPTION: For OData V4 List Report pages using the LineItem annotation, hide the table toolbar option by disabling enableAddCardToInsights under controlConfiguration for the LineItem annotation. Also ensure the table type is ResponsiveTable when required.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "componentUsages": {},
    "controlConfiguration": {
      "@com.sap.vocabularies.UI.v1.LineItem": {
        "tableSettings": {
          "type": "ResponsiveTable",
          "enableAddCardToInsights": false
        }
      }
    }
  }
}
```

STEP: 6 — Hide "Add Card to Insights" in OData V4 Analytical List Page (chart toolbar) via manifest.json
DESCRIPTION: For OData V4 ALP pages, disable enableAddCardToInsights under controlConfiguration for the Chart annotation to hide the chart toolbar option.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "controlConfiguration": {
      "@com.sap.vocabularies.UI.v1.Chart": {
        "enableAddCardToInsights": false
      }
    }
  }
}
```

STEP: 7 — Known restrictions and behavior
DESCRIPTION: Be aware of these limitations when users create integration cards from a list report table:
LANGUAGE: Text
CODE:
```Text
Restrictions:
- Changes that are NOT retained when navigating back from the created card:
  - Removed filter fields or removed table columns
  - Reordered filter fields or table columns
- Unit-of-measure fields may be formatted differently in cards compared with the list report table.
```

STEP: 8 — Where to put these settings
DESCRIPTION: Add the JSON snippets into your application's manifest.json (project root). Make sure they are merged into the existing sap.ui.generic.app or sap.ui5 sections as appropriate for your application type (OData V2 vs V4).
LANGUAGE: Text
CODE:
```Text
File: <project-root>/webapp/manifest.json  (or <project-root>/manifest.json depending on project layout)
Merge the provided JSON into the existing manifest structure; maintain valid JSON and existing properties.
```

STEP: 9 — Related documentation links
DESCRIPTION: Reference links for additional details on My Home and integration with S/4HANA.
LANGUAGE: Text
CODE:
```Text
- My Home in SAP S/4HANA Cloud Public Edition:
  https://help.sap.com/docs/SAP_S4HANA_CLOUD/4fc8d03390c342da8a60f8ee387bca1a/8a60279e8d2041b5ad8d3455fab0f3ef.html

- My Home in SAP S/4HANA:
  https://help.sap.com/docs/ABAP_PLATFORM_NEW/a7b390faab1140c087b8926571e942b7/8a60279e8d2041b5ad8d3455fab0f3ef.html
```
--------------------------------

**TITLE**: Creating Custom Filters for SAP Fiori elements (OData V2, Analytical List Page)

**INTRODUCTION**: This guide provides compact, code-focused examples to implement custom filters for Compact Filters, Visual Filters, and KPI Tags in SAP Fiori elements (OData V2) Analytical List Page (ALP). It covers manifest view/controller extensions, XML fragment for a custom filter control, controller extension hooks to wire behavior and app-state persistence, handling Clear, and extension hooks for visual filters and KPI tags.

**TAGS**: fiori-elements-framework, OData V2, AnalyticalListPage, ALP, filters, smartfilterbar, visual-filters, KPI, controller-extension, view-extension

STEP: 1 — Manifest: Register controller and fragment view extensions
DESCRIPTION: Add controller extensions and viewExtensions in the sap.ui5 section of the manifest to register a controller extension for ALP and inject a custom SmartFilterBar fragment. Replace namespaces (controllerName, fragmentName, keys) with your app-specific namespaces and entity set.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "_version": "1.1.0",
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
            "controllerName": "my_app.ext.controller.AnalyticalListPageExt"
          }
        },
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
            "SmartFilterBarControlConfigurationExtension|CZ_EASILINEITEMS_SADL": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "analytics2.alr.ext.fragments.CustomFilters",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

STEP: 2 — Fragment: Custom Compact Filter fragment (SmartFilterBar ControlConfiguration)
DESCRIPTION: XML fragment that defines a custom compact/advanced filter control using SmartFilterBar ControlConfiguration. Use the key to bind/identify the control in controller code. Place this fragment in the namespace specified in fragmentName.
LANGUAGE: XML
CODE:
```xml
<core:FragmentDefinition xmlns="sap.m"
                         xmlns:smartfilterbar="sap.ui.comp.smartfilterbar"
                         xmlns:core="sap.ui.core">
  <smartfilterbar:ControlConfiguration key="CustomFilters" index="99" visibleInAdvancedArea="true" label="Custom Filter" groupId="_BASIC">
    <smartfilterbar:customControl>
      <ComboBox id="CustomFilters-combobox">
        <core:Item key="0" text="Item1"/>
        <core:Item key="1" text="Item2"/>
        <core:Item key="2" text="Item3"/>
      </ComboBox>
    </smartfilterbar:customControl>
  </smartfilterbar:ControlConfiguration>
</core:FragmentDefinition>
```

STEP: 3 — Controller extension: Hook into SmartFilterBar lifecycle and persist/restore custom field state
DESCRIPTION: Define the controller extension (namespace = controllerName from manifest). Implement lifecycle hooks used by ALP:
- onInitSmartFilterBarExtension: wire events to the custom control.
- onBeforeRebindTableExtension / onBeforeRebindChartExtension: add binding/filter parameters based on the custom control.
- getCustomAppStateDataExtension / restoreCustomAppStateDataExtension: persist and restore custom control state in app state.
LANGUAGE: JavaScript
CODE:
```javascript
sap.ui.define([], function() {
  return {
    onInitSmartFilterBarExtension: function(oEvent) {
      // oEvent.getSource() returns SmartFilterBar instance
      var oSmartFilterBar = oEvent.getSource();
      // Attach a selection change handler to the custom control by ControlConfiguration key
      var oControl = oSmartFilterBar.getControlByKey("CustomFilters");
      if (oControl) {
        oControl.attachSelectionChange(function(oChangeEvent) {
          // Custom reaction to selection change; e.g. trigger search or update parameters
          // code...
        }, this);
      }
      jQuery.sap.log.info("onInitSmartFilterBarExtension initialized");
    },

    onBeforeRebindTableExtension: function(oEvent) {
      // Modify binding parameters/filter on the table before rebind based on custom control value
      // Example:
      // var oBindingParams = oEvent.getParameter("bindingParams");
      // var sSelectedKey = this.byId("CustomFilters-combobox") && this.byId("CustomFilters-combobox").getSelectedKey();
      // if (sSelectedKey) { oBindingParams.filters.push(new sap.ui.model.Filter("CustomProperty", "EQ", sSelectedKey)); }
    },

    onBeforeRebindChartExtension: function(oEvent) {
      // Similar to onBeforeRebindTableExtension for charts
    },

    getCustomAppStateDataExtension: function(oCustomData) {
      // Store control content in app state for back navigation / restore
      var oComboBox = this.byId("CustomFilters-combobox");
      if (oComboBox) {
        oCustomData.CustomPriceFilter = oComboBox.getSelectedKey();
      }
    },

    restoreCustomAppStateDataExtension: function(oCustomData) {
      // Restore custom control content from app state
      if (oCustomData && oCustomData.CustomPriceFilter !== undefined) {
        if (this.byId("CustomFilters-combobox")) {
          this.byId("CustomFilters-combobox").setSelectedKey(oCustomData.CustomPriceFilter);
        }
      }
    }
  };
});
```

STEP: 4 — Clear handling: Implement onClearFilterExtension to reset custom filters
DESCRIPTION: ALP triggers onClearFilterExtension when the user chooses Clear. Clear any custom controls manually inside this handler.
LANGUAGE: JavaScript
CODE:
```javascript
onClearFilterExtension: function(oEvent) {
  'use strict';
  if (this.byId("CustomFilters-combobox")) {
    this.byId("CustomFilters-combobox").setSelectedKey(null);
  }
}
```

STEP: 5 — Visual Filters: Modify visual filter call and access navigation context
DESCRIPTION: Implement onBeforeRebindVisualFilterExtension to:
- Modify the visual filter query parameters, filters, or sorters.
- Add custom queryParameter(s) that will be appended to the visual filter OData query.
- Access incoming navigation context via this.extensionAPI.getNavigationContext().
LANGUAGE: JavaScript
CODE:
```javascript
onBeforeRebindVisualFilterExtension: function(sEntityType, sDimension, sMeasure, oContext) {
  'use strict';
  // oContext contains: filters (array), queryParameters (object), sorters, entityParameters
  var oNavigationContext = this.extensionAPI.getNavigationContext(); // incoming nav context
  if (sDimension === "CostCenter") {
    // Add custom query parameter (included as ?Type=Cost)
    oContext.queryParameters.Type = "Cost";

    // Influence parameters and add filters conditionally
    if (oContext.entityParameters && oContext.entityParameters.P_DisplayCurrency === "USD") {
      oContext.queryParameters.Country = "USA";
      oContext.filters.push(new sap.ui.model.Filter("Product", "EQ", "HT-1000"));
    }
  }
}
```

STEP: 6 — Visual Filters: Date and datetime formats
DESCRIPTION: Use the correct formats when passing date or datetime values into filter/query parameters:
- Date-only format: YYYY-MM-DDT00:00:00Z (example: 2018-10-15T00:00:00Z)
- SelectionVariant datetime formats:
  - UTC: YYYY-MM-DDT00:00:00.000Z (example: 2018-09-03T12:46:00.000Z)
  - Local with offset: YYYY-MM-DDTHH:MM:SS.fff-HH:MM (example: 2018-09-03T12:46:12.123-07:00)
LANGUAGE: text
CODE:
```text
Date-only example:    2018-10-15T00:00:00Z
SelectionVariant UTC: 2018-09-03T12:46:00.000Z
Local w/ offset:      2018-09-03T12:46:12.123-07:00
```

STEP: 7 — KPI Tags: Extend or modify filters for Filterable KPIs
DESCRIPTION: Implement onBeforeRebindFilterableKPIExtension to add/modify select options, filters, or parameters for KPI tag queries. Use oSelectionVariant API to addSelectOption values or modify filters. Replace sKPIId check with your KPI ID(s).
LANGUAGE: JavaScript
CODE:
```javascript
sap.ui.define(["sap/base/Log"], function(Log) {
  return {
    onBeforeRebindFilterableKPIExtension: function(oSelectionVariant, sEntityType, sKPIId) {
      'use strict';
      // Modify selection variant for specific KPI ID
      if (sKPIId === "alp.tech.app::sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage::SEPMRA_C_ALP_SlsOrdItemCubeALPResults--template::KPITag::kpi::KPINetProductPriceByCategory") {
        oSelectionVariant.addSelectOption("Product", "I", "EQ", "HT-1502", null);
      }
      Log.info("onBeforeRebindFilterableKPIExtension called!");
    }
  };
});
```

STEP: 8 — Reminders & behaviors
DESCRIPTION: Key behavioral notes to implement correctly:
- Custom filters do NOT appear in Visual Filters.
- Values set/handled in onBeforeRebindChartExtension / onBeforeRebindTableExtension are refreshed on table/chart refresh to keep custom filters synchronized across filter modes.
- Implement onClearFilterExtension to explicitly clear custom filter controls (ALP clears only framework filter dimensions by default).
--------------------------------

**TITLE**: Creating Key Performance Indicator (KPI) Tags for Analytical List Page (ALP)

**INTRODUCTION**: This guide shows how to configure KPI tags for SAP Fiori elements Analytical List Page (ALP). It provides descriptor (manifest) settings and the full set of annotations (XML, ABAP CDS, CAP CDS) needed to render KPI tiles in the title area or below the filter bar, enable navigation, formatting, units, charts, and filterable KPIs. Use this as a copy-pasteable reference for implementing KPIs.

**TAGS**: fiori-elements-framework, ALP, KPI, UI.KPI, annotations, manifest.json, CDS, CAP, XML, OData

STEP: 1 — Configure Descriptor (manifest.json) for SAP Fiori elements (OData V2)
DESCRIPTION: Add a KPI entry under the ALP page settings. Set model/entitySet/qualifier/detailNavigation and optionally filterable. Save in manifest.json under "sap.ui.generic.app" -> "pages".
LANGUAGE: JSON
CODE:
```JSON
// File: manifest.json (SAP Fiori elements for OData V2)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "keyPerformanceIndicators": {
              "KPIRevenue": {
                "model": "kpi",
                "entitySet": "SEPMRA_C_ALP_TotalSalesKPI",
                "qualifier": "KPIQuantity",
                "detailNavigation": "EPMProduct",
                "filterable": true
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 2 — Configure Descriptor (manifest.json) for SAP Fiori elements (OData V4 / Fiori Elements V4)
DESCRIPTION: Add KPI entries under the routing target options -> settings -> keyPerformanceIndicators. Each KPI maps an entitySet and a qualifier (annotation qualifier).
LANGUAGE: JSON
CODE:
```JSON
// File: manifest.json (SAP Fiori elements for OData V4)
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "BusinessPartnersALP": {
          "type": "Component",
          "id": "BusinessPartnersList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "keyPerformanceIndicators": {
                "KPIRevenue": {
                  "entitySet": "BusinessPartners",
                  "qualifier": "KPIQuantity"
                },
                "KPIVolume": {
                  "entitySet": "BusinessPartners",
                  "qualifier": "Volume",
                  "detailNavigation": "PartnerSales"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — UI.KPI XML Annotation (qualifier KPIQuantity)
DESCRIPTION: Define UI.KPI with DataPoint and SelectionVariant references, an ID for EvaluationId, and a Detail record containing semantic object/action/defaultPresentationVariant. Place this annotation in your OData annotation XML file.
LANGUAGE: XML
CODE:
```XML
<!-- File: annotations.xml -->
<Annotation Term="UI.KPI" Qualifier="KPIQuantity">
  <Record>
    <PropertyValue Property="DataPoint" Path="@UI.DataPoint#DPForQuantity" />
    <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#SVForQuantity" />
    <PropertyValue Property="ID" String="ActualCostByGLAccountNameKPI" />
    <PropertyValue Property="Detail">
      <Record Type="UI.KPIDetailType">
        <PropertyValue Property="SemanticObject" String="EPMProduct" />
        <PropertyValue Property="Action" String="manage_stta" />
        <PropertyValue Property="DefaultPresentationVariant" Path="@UI.PresentationVariant#PVForQuantity" />
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 4 — UI.KPI ABAP CDS Annotation (qualifier KPIQuantity)
DESCRIPTION: Inline ABAP CDS example for @UI.KPI with selectionVariantQualifier, id, datapoint title, detail block and qualifier. Add to your ABAP CDS view definition.
LANGUAGE: ABAP CDS
CODE:
```ABAP
@UI.KPI: [
  {
    selectionVariantQualifier: 'SVForQuantity',
    id: 'ActualCostByGLAccountNameKPI',
    dataPoint.title: 'Define datapoint inline',
    datapoint.minimumValue: 2,
    detail: {
      semanticObject: 'EPMProduct',
      semanticObjectAction: 'manage_stta',
      defaultPresentationVariantQualifier: 'PVForQuantity'
    },
    qualifier: 'KPIQuantity'
  }
]
DPForQuantity;
```

STEP: 5 — UI.KPI CAP CDS Annotation (qualifier KPIQuantity)
DESCRIPTION: CAP CDS annotation syntax mapping to UI.KPI with DataPoint and SelectionVariant references and detail KPI metadata.
LANGUAGE: CAP CDS
CODE:
```CDS
// In your .cds or .cds (annotations) file
UI.KPI #KPIQuantity : {
  DataPoint : ![@UI.DataPoint#DPForQuantity],
  SelectionVariant : ![@UI.SelectionVariant#SVForQuantity],
  ID : 'ActualCostByGLAccountNameKPI',
  Detail : {
    $Type : 'UI.KPIDetailType',
    SemanticObject : 'EPMProduct',
    Action : 'manage_stta',
    DefaultPresentationVariant : ![@UI.PresentationVariant#PVForQuantity]
  }
},
```

STEP: 6 — KPIDetailType (XML snippet)
DESCRIPTION: Use this record inside UI.KPI Detail to enable navigation — semantic object, action, and default presentation variant. KPI ID is passed as EvaluationId to target app.
LANGUAGE: XML
CODE:
```XML
<PropertyValue Property="Detail">
  <Record Type="UI.KPIDetailType">
    <PropertyValue Property="SemanticObject" String="EPMProduct" />
    <PropertyValue Property="Action" String="manage_stta" />
    <PropertyValue Property="DefaultPresentationVariant" Path="@UI.PresentationVariant#PVForQuantity" />
  </Record>
</PropertyValue>
```

STEP: 7 — DataPoint annotation (XML / ABAP CDS / CAP CDS)
DESCRIPTION: Define the DataPoint providing Title, Description, Value path, and Criticality or CriticalityCalculation. This DataPoint title is used as the KPI name (source for abbreviation).
LANGUAGE: XML
CODE:
```XML
<!-- File: annotations.xml -->
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="DPForQuantity">
  <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
    <PropertyValue Property="Title" String="Quantity by Customer Company Name" />
    <PropertyValue Property="Description" String="About NumberOfSalesOrders" />
    <PropertyValue Property="Value" Path="Quantity" />
    <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Neutral" />
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```ABAP
@UI.dataPoint: {
  title: 'Quantity by Customer Company Name',
  value: 'Quantity',
  criticality: #NEUTRAL
}
DPForQuantity;
```

LANGUAGE: CAP CDS
CODE:
```CDS
UI.DataPoint #DPForQuantity : {
  $Type : 'UI.DataPointType',
  Title : 'Quantity by Customer Company Name',
  Description : 'About NumberOfSalesOrders',
  Value : Quantity,
  Criticality : #Neutral
}
```

STEP: 8 — SelectionVariant annotation (XML / ABAP CDS / CAP CDS)
DESCRIPTION: Configure SelectionVariant for default filter parameters and select options used by the KPI. SelectionVariant defaults apply unless filter bar overrides.
LANGUAGE: XML
CODE:
```XML
<!-- File: annotations.xml -->
<Annotation Term="UI.SelectionVariant" Qualifier="SVForQuantity">
  <Record>
    <PropertyValue Property="Parameters">
      <Collection>
        <Record Type="UI.Parameter">
          <PropertyValue Property="PropertyName" PropertyPath="CompanyCurrency" />
          <PropertyValue Property="PropertyValue" String="EUR" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record Type="UI.SelectOptionType">
          <PropertyValue Property="PropertyName" PropertyPath="MainProductCategory" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record Type="UI.SelectionRangeType">
                <PropertyValue EnumMember="UI.SelectionRangeSignType/I" Property="Sign" />
                <PropertyValue EnumMember="UI.SelectionRangeOptionType/EQ" Property="Option" />
                <PropertyValue Property="Low" String="Computer Systems" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```ABAP
@UI.selectionVariant: [
  {
    qualifier: 'SVForQuantity',
    parameters: [
      { name: 'CompanyCurrency', value: 'EUR' }
    ]
  }
]
```

LANGUAGE: CAP CDS
CODE:
```CDS
UI.SelectionVariant #SVForQuantity : {
  Parameters : [
    {
      $Type : 'UI.Parameter',
      PropertyName : CompanyCurrency,
      PropertyValue : 'EUR'
    }
  ],
  SelectOptions : [
    {
      $Type : 'UI.SelectOptionType',
      PropertyName : MainProductCategory,
      Ranges : [
        {
          $Type : 'UI.SelectionRangeType',
          Sign : #I,
          Option : #EQ,
          Low : 'Computer Systems'
        }
      ]
    }
  ]
}
```

STEP: 9 — PresentationVariant annotation (XML / ABAP CDS / CAP CDS)
DESCRIPTION: Define PresentationVariant referencing SortOrder and the Visualizations (first visualization provides KPI value & color). Include qualifier used in KPI Detail DefaultPresentationVariant.
LANGUAGE: XML
CODE:
```XML
<!-- File: annotations.xml -->
<Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant" Qualifier="PVForQuantity">
  <Record>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record Type="Common.SortOrderType">
          <PropertyValue Property="Property" PropertyPath="Quantity" />
          <PropertyValue Property="Descending" Bool="true" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
        <AnnotationPath>@com.sap.vocabularies.UI.v1.Chart#QuantityChart</AnnotationPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```ABAP
@UI.PresentationVariant: [
  {
    sortOrder: [
      {
        by: 'QUANTITY',
        direction: #DESC
      }
    ],
    visualizations: [
      { type: #AS_CHART, qualifier: 'QuantityChart' }
    ],
    qualifier: 'PVForQuantity'
  }
]
```

LANGUAGE: CAP CDS
CODE:
```CDS
UI.PresentationVariant #PVForQuantity : {
  SortOrder : [
    {
      $Type : 'Common.SortOrderType',
      Property : Quantity,
      Descending : true
    }
  ],
  Visualizations : [
    '@UI.Chart#QuantityChart'
  ]
}
```

STEP: 10 — Chart annotation (XML / ABAP CDS / CAP CDS) — qualifier QuantityChart
DESCRIPTION: Define a chart used by the PresentationVariant. The first visualization element (chart or other) is used to render the KPI value and color. For OData V4 only supported chart types: line, column, bar, stacked bar, stacked column, vertical_bullet, scatter, combination, donut, bubble. PresentationVariant uses SortOrder and MaxItems.
LANGUAGE: XML
CODE:
```XML
<!-- File: annotations.xml -->
<Annotation Term="com.sap.vocabularies.UI.v1.Chart" Qualifier="QuantityChart">
  <Record>
    <PropertyValue Property="Title" String="NumberOfSalesOrders" />
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="Quantity" />
          <PropertyValue Property="Role" EnumMember="com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis1" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="SoldToPartyCompanyName" />
          <PropertyValue Property="Role" EnumMember="com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Category" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bar" />
    <PropertyValue Property="Description" String="NumberOfSalesOrders by Customer Company Name" />
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```ABAP
@UI.Chart: [
  {
    title: 'NumberOfSalesOrders',
    measureAttributes: [
      { measure: 'Quantity', role: #AXIS_1 }
    ],
    dimensionAttributes: [
      { dimension: 'SoldToPartyCompanyName', role: #CATEGORY }
    ],
    chartType: #BAR,
    description: 'NumberOfSalesOrders by Customer Company Name',
    qualifier: 'QuantityChart'
  }
]
```

LANGUAGE: CAP CDS
CODE:
```CDS
UI.Chart #QuantityChart : {
  Title : 'NumberOfSalesOrders',
  MeasureAttributes : [
    {
      $Type : 'UI.ChartMeasureAttributeType',
      Measure : Quantity,
      Role : #Axis1
    }
  ],
  DimensionAttributes : [
    {
      $Type : 'UI.ChartDimensionAttributeType',
      Dimension : SoldToPartyCompanyName,
      Role : #Category
    }
  ],
  ChartType : #Bar,
  Description : 'NumberOfSalesOrders by Customer Company Name'
}
```

STEP: 11 — Number Formatting: ValueFormat.NumberOfFractionalDigits (XML / ABAP CDS / CAP CDS)
DESCRIPTION: Control decimal precision shown in KPI via DataPoint.ValueFormat.NumberOfFractionalDigits. Default: decimals hidden; you can specify 1 or 2; values >2 considered additive to 2.
LANGUAGE: XML
CODE:
```XML
<!-- Example: override NumberOfFractionalDigits to 1 -->
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="Price">
  <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
    <PropertyValue Property="Value" Path="Price"/>
    <PropertyValue Property="ValueFormat">
      <Record Type="com.sap.vocabularies.UI.v1.NumberFormat">
        <PropertyValue Property="NumberOfFractionalDigits" Int="1"/>
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```ABAP
@UI.dataPoint: { 
  valueFormat.numberOfFractionalDigits: 1  
}
price;
```

LANGUAGE: CAP CDS
CODE:
```CDS
UI.DataPoint #Price : {
  $Type : 'UI.DataPointType',
  Value : Price,
  ValueFormat : {
    $Type : 'UI.NumberFormat',
    NumberOfFractionalDigits : 1
  }
}
```

STEP: 12 — Units of Measure / Currency (XML and CAP CDS)
DESCRIPTION: Add Org.OData.Measures annotations for ISOCurrency or Unit on KPI measure properties. You can reference a path (dynamic) or a fixed string.
LANGUAGE: XML
CODE:
```XML
<!-- Example: attach currency or unit annotations to KPI measure properties -->
<Annotations Target="CZ_PROJECTKPIS_CDS.CZ_PROJECTKPISType/ActualCost">
  <Annotation Term="Org.OData.Measures.V1.ISOCurrency" Path="CompanyCodeCurrency"/>
</Annotations>

<Annotations Target="CZ_PROJECTKPIS_CDS.CZ_PROJECTKPISType/TargetMargin">
  <Annotation Term="Org.OData.Measures.V1.ISOCurrency" String="EUR"/> 
</Annotations>

<Annotations Target="CZ_PROJECTKPIS_CDS.CZ_PROJECTKPISType/ActualMarginRelative">
  <Annotation Term="Org.OData.Measures.V1.Unit" String="%"/>
</Annotations>

<Annotations Target="CZ_PROJECTKPIS_CDS.CZ_PROJECTKPISType/NetWeight">
  <Annotation Term="Org.OData.Measures.V1.Unit" Path="WeightUnit"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```CDS
annotate CZ_PROJECTKPIS_CDS.CZ_PROJECTKPISType with {
  @Measures.ISOCurrency : CompanyCodeCurrency
  ActualCost
};
```

STEP: 13 — Override unit of measure (XML snippet)
DESCRIPTION: Example showing how to override backend unit to a fixed string (e.g., '%').
LANGUAGE: XML
CODE:
```XML
<Annotations Target="CZ_PROJECTKPIS_CDS.CZ_PROJECTKPISType/ActualCost">
  <Annotation Term="Org.OData.Measures.V1.Unit" String="%"/>
</Annotations>
```

STEP: 14 — KPI Title Abbreviation Rules
DESCRIPTION: Abbreviations for KPI tiles are generated from the DataPoint Title:
- One word: first three letters (e.g., "TargetMargin" → "TAR")
- Two words: first letter of each word ("Actual Cost" → "AC")
- Three or more words: first letter of first three words ("Actual Margin Relative" → "AMR")
LANGUAGE: TEXT
CODE:
```
// KPI title is taken from DataPoint.Title; abbreviations are derived automatically using the rules above.
```

STEP: 15 — KPI Value Coloring and Criticality
DESCRIPTION: KPI color is determined by the DataPoint visualization (first visualization in PresentationVariant) and threshold settings. Use:
- CriticalityCalculation: static thresholds or path-based thresholds
- Criticality (server side): backend-calculated value — when both are present Criticality overrides CriticalityCalculation
Also choose ImprovementDirection (maximizing/minimizing/range) in your measure/back-end logic to determine color logic.
LANGUAGE: TEXT
CODE:
```
// Implementation notes:
// - Define Criticality or CriticalityCalculation in DataPoint to control KPI color.
// - If both are present, Criticality wins.
// - For filterable KPIs, only path-based CriticalityCalculation is supported for semantic coloring.
```

STEP: 16 — Enable Filterable KPIs (manifest + rules)
DESCRIPTION: For filterable KPIs (only OData V2), set "filterable": true in the descriptor KPI config. Filterable KPIs react to filter bar only if technical names and parameter fields match exactly between filter bar and KPI entitySet. Notes:
- If SelectionVariant defaults are part of filter bar, filter bar values override them.
- UI.Hidden fields are ignored in KPI filter selection if marked UI.Hidden in KPI entity set.
- If showGoButtonOnFilterBar = true, KPIs hidden until Go is pressed; if Apply Automatically checked, KPIs display on load.
LANGUAGE: JSON
CODE:
```JSON
// manifest.json excerpt for filterable KPI (SAP Fiori elements OData V2)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "keyPerformanceIndicators": {
              "KPIRevenue": {
                "model": "kpi",
                "entitySet": "SEPMRA_C_ALP_TotalSalesKPI",
                "qualifier": "KPIRevenue",
                "filterable": true,
                "detailNavigation": "OverviewPage"
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 17 — Semantic Coloring for Filterable KPIs
DESCRIPTION: For filterable KPIs, define CriticalityCalculation with path-based thresholds. Semantic coloring updates on filter/parameter changes. Only path-based thresholds are supported for filterable KPIs.
LANGUAGE: TEXT
CODE:
```
// Ensure CriticalityCalculation uses property paths (path-based) so ALP can update KPI color when filters change.
```

STEP: 18 — Related implementation pointers
DESCRIPTION: Quick references and checks before deployment:
- KPI ID is passed as EvaluationId to target apps (used by SAP Smart Business)
- The first visualization element in PresentationVariant renders KPI value & color
- For OData V4, PresentationVariant supports SortOrder and MaxItems only; supported chart types: line, column, bar, stacked bar, stacked column, vertical_bullet, scatter, combination, donut, bubble
LANGUAGE: TEXT
CODE:
```
// Checklist:
// - Verify UI.KPI qualifier matches descriptor manifest qualifier.
// - DataPoint.Title used for KPI name/abbreviation.
// - Ensure SelectionVariant and PresentationVariant qualifiers exist and are referenced properly.
// - For navigation, set Detail.SemanticObject and Detail.Action in UI.KPI.
```
--------------------------------

**TITLE**: Create Key Performance Indicator (KPI) Tags via manifest.json and Fragments in SAP Fiori elements (OData V4)

**INTRODUCTION**: Add KPI tags to a Fiori elements List Report by configuring keyPerformanceIndicators in manifest.json and providing fragment(s) that define the KPI UI. Use the sap.fe.macros.KPITag building block to match the analytical KPI design. Optionally implement a press handler for interactive KPIs.

**TAGS**: fiori-elements-framework, kpi, manifest.json, sap.fe.macros.KPITag, odata-v4, fragments, ui5

**STEP**: 1 — Add keyPerformanceIndicators to manifest.json

**DESCRIPTION**: Update your component's manifest.json to declare one or more KPI templates under the List Report target settings. The section goes under targets -> <yourPageTarget> -> options -> settings -> keyPerformanceIndicators. Each KPI entry uses a template identifier that resolves to a fragment/component (e.g. a fragment name you will create).

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (excerpt)
{
  "sap.ui5": {
    "routing": { /* routing omitted for brevity */ },
    "targets": {
      "mainPage": {
        "type": "Component",
        "id": "Default",
        "name": "sap.fe.templates.ListReport",
        "options": {
          "settings": {
            "contextPath": "/RootEntity",
            "variantManagement": "None",
            "initialLoad": true,
            "keyPerformanceIndicators": {
              "myKPITag": {
                "template": "sap.fe.core.fpmExplorer.customKPIContent.CustomKPITag"
              },
              "myKPIWithPress": {
                "template": "sap.fe.core.fpmExplorer.customKPIContent.CustomKPITagWithPress"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Create a KPI fragment using the KPI building block (no press handler)

**DESCRIPTION**: Create a fragment that uses the KPITag macro to render the KPI. This fragment is lightweight and matches KPI styling of analytical services. Map the fragment name to the template string used in manifest.json. Use the fragment file naming and namespace mapping used by your project; below is a recommended fragment structure and content.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/extension/fragments/CustomKPITag.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m"
                         xmlns:core="sap.ui.core"
                         xmlns:macros="sap.fe.macros">
    <macros:KPITag
        number="0"
        unit="Days"
        status="Error"
        showIcon="true" />
</core:FragmentDefinition>
```

**STEP**: 3 — Create a KPI fragment with a press handler (interactive KPI)

**DESCRIPTION**: If you need clickable KPI tags, add a press binding to the KPITag and point it to an extension handler. The press property can reference an extension path like ".extension.<namespace>.<fragmentCollection>.<controller>.<function>". Ensure the referenced function exists and is exported as part of your extension.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/extension/fragments/CustomKPITagWithPress.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m"
                         xmlns:core="sap.ui.core"
                         xmlns:macros="sap.fe.macros">
    <macros:KPITag
        number="0"
        unit="Days"
        status="Error"
        showIcon="true"
        press=".extension.sap.fe.core.fpmExplorer.customKPIContent.LRExtend.onKPIPressed" />
</core:FragmentDefinition>
```

**STEP**: 4 — Implement the KPI press handler

**DESCRIPTION**: Implement the onKPIPressed handler referenced by the fragment. Export a function matching the extension path used in the fragment press property. The function receives the event parameter (oEvent) — use it to access KPI metadata, binding context, or navigate. Example shows a simple MessageToast action.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/extension/controllers/LRExtend.js
sap.ui.define([
  "sap/m/MessageToast"
], function (MessageToast) {
  "use strict";

  return {
    /**
     * onKPIPressed - extension handler referenced by fragment press property
     * @param {sap.ui.base.Event} oEvent
     */
    onKPIPressed: function (oEvent) {
      // Example: show a toast and access KPI binding context if needed
      var oSource = oEvent.getSource();
      var oContext = oSource.getBindingContext && oSource.getBindingContext();
      // Custom logic here: navigate, open dialog, fetch details, etc.
      MessageToast.show("KPI pressed" + (oContext ? " - context: " + oContext.getPath() : ""));
    }
  };
});
```

**STEP**: 5 — Notes and recommendations

**DESCRIPTION**: Use the sap.fe.macros.KPITag macro to keep KPI visuals consistent with analytical services. You can supply any fragment as a template, but prefer the KPI building block. Verify the template identifiers in manifest.json match how your project resolves fragments/modules. For a working example, see the FPM Explorer: Custom KPI Tags in List Report - Overview (ui5 test resources).
--------------------------------

**TITLE**: Fiori Elements — Custom Actions for Quick View Stack Cards and Global Filter Bar

**INTRODUCTION**: This guide shows how to add custom action buttons to quick view cards that appear in the object stream of a stack card, and how to add global actions to the Smart Filter Bar. It covers: (A) creating a controller that exposes press handlers and the onCustomActionPress hook, (B) wiring that controller into the app descriptor, (C) configuring card settings with customActions, and (D) adding a global action fragment and its controller handler.

**TAGS**: fiori-elements-framework, SAPUI5, OVP, stack-card, quick-view, custom-actions, smart-filter-bar, extension, descriptor

STEP: 1 — Create extension controller for quick-view custom actions

DESCRIPTION: Add a JavaScript controller module that exports the hook onCustomActionPress and named press handlers. onCustomActionPress receives the press handler name (string) and must return the corresponding function reference. Place this file under your extension namespace (example shown).

LANGUAGE: JavaScript

CODE:
```JavaScript
// File: webapp/ext/controller/customConfiguration.controller.js
// Module name example: my_app.ext.controller.OverViewPageExt
sap.ui.define([], function () {
    "use strict";
    return {
        /*
         The hook onCustomActionPress receives one argument: the press-handler name as a string,
         and returns the corresponding handler function defined in this controller.
        */
        onCustomActionPress: function (sCustomAction) {
            if (sCustomAction === "press1") {
                return this.press1;
            } else if (sCustomAction === "press2") {
                return this.press2;
            }
            // return undefined if no handler found
        },

        /*
         Named press handlers executed when quick view footer buttons are pressed.
         Each receives the press event object (oEvent).
        */
        press1: function (oEvent) {
            // Example action: open external URL
            window.open("https://www.google.co.in");
        },

        press2: function (oEvent) {
            // Example action: open external URL
            window.open("http://www.sap.com/index.html");
        }
    };
});
```

STEP: 2 — Register controller extension in manifest (descriptor) "extends" section

DESCRIPTION: Add the controller extension entry to the application descriptor so the OVP main controller will use your extension. Replace controllerName with your module name.

LANGUAGE: JSON

CODE:
```json
// Add or merge into manifest.json
"extends": {
  "extensions": {
    "sap.ui.controller.Extensions": {
      "sap.ovp.app.Main": {
        "controllerName": "my_app.ext.controller.OverViewPageExt"
      }
    }
  }
}
```

STEP: 3 — Configure customActions for a stack card's quick view (objectStreamCardsSettings)

DESCRIPTION: Under the specific stack card's settings, add objectStreamCardsSettings.customActions — an array of action objects. Each action object must contain:
- text: string shown on the quick view footer button
- press: string name of the press handler defined in your extension controller
- position: numeric ordering value used to sort actions in the footer

LANGUAGE: JSON

CODE:
```json
// Example card entry in manifest.json (or cards configuration)
"card007_ProductsOutOfStock": {
  "model": "salesOrder",
  "template": "sap.ovp.cards.stack",
  "settings": {
    "itemText": "{{stackCard_itemText}}",
    "title": "Products Out of Stock",
    "subTitle": "SalesOrderSet Stack Card",
    "requireAppAuthorization": "#Action-toappnavsample",
    "entitySet": "SalesOrderSet",
    "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification,com.sap.vocabularies.UI.v1.Identification#item2",
    "objectStreamCardsSettings": {
      "showFirstActionInFooter": false,
      "customActions": [
        { "text": "text1", "press": "press1", "position": 1 },
        { "text": "text2", "press": "press2", "position": 10 },
        { "text": "text3", "press": "press1", "position": 3 },
        { "text": "text4", "press": "press2", "position": 8 },
        { "text": "text5", "press": "press1", "position": 5 },
        { "text": "text6", "press": "press2", "position": 6 }
      ]
    }
  }
}
```

STEP: 4 — Configure global actions on the Smart Filter Bar (descriptor entries)

DESCRIPTION: To add global actions you must:
- register a controller extension for the app main controller
- register view extensions/fragments for SmartFilterBar control configuration and for global actions
Example manifest fragment shows sap.ui5 settings, models, and the extends entries for controller and view extensions.

LANGUAGE: JSON

CODE:
```json
// Merge/extend into manifest.json under "sap.ui5"
"sap.ui5": {
  "_version": "1.1.0",
  "dependencies": {
    "libs": {
      "sap.ovp": {}
    }
  },
  "models": {
    "i18n": {
      "type": "sap.ui.model.resource.ResourceModel",
      "uri": "i18n/i18n.properties"
    },
    "salesOrder": {
      "dataSource": "salesOrder",
      "settings": {}
    }
  },
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.ovp.app.Main": {
          "controllerName": "sap.ovp.demo.ext.customFilter"
        }
      },
      "sap.ui.viewExtensions": {
        "sap.ovp.app.Main": {
          "SmartFilterBarControlConfigurationExtension|GlobalFilters": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "sap.ovp.demo.ext.customFilter",
            "type": "XML"
          },
          "SmartFilterBarGlobalActionExtension": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "sap.ovp.demo.ext.customAction",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

STEP: 5 — Create the global action fragment

DESCRIPTION: Define an XML fragment that contains the UI control(s) to be inserted into the Smart Filter Bar global actions area. Place this file at the path matching fragmentName (e.g., webapp/ext/fragment/customAction.fragment.xml or namespace path sap/ovp/demo/ext/customAction.fragment.xml).

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/ext/fragment/customAction.fragment.xml
     Fragment name example: sap.ovp.demo.ext.customAction -->
<core:FragmentDefinition
  xmlns="sap.m"
  xmlns:smartfilterbar="sap.ui.comp.smartfilterbar"
  xmlns:core="sap.ui.core">
  <Button text="Action" press="handleCustomAction" type="Transparent" />
</core:FragmentDefinition>
```

STEP: 6 — Implement the controller for the global action fragment

DESCRIPTION: Create the controller module referenced in the descriptor (controllerName). Implement the handler function referenced from the fragment (handleCustomAction). This controller is returned as an object of functions (extension style), not an MVC controller class.

LANGUAGE: JavaScript

CODE:
```JavaScript
// File: webapp/ext/controller/customFilter.controller.js
// Module name example: sap.ovp.demo.ext.customFilter
sap.ui.define([
    "sap/ui/model/Filter",
    "sap/m/MessageToast"
], function (Filter, MessageToast) {
    "use strict";

    // Extension controller for OVP app — exposes handlers used by fragments
    return {
        /*
         Custom Global Action handler invoked from fragment Button press
        */
        handleCustomAction: function () {
            var msg = "Custom Global Action clicked";
            MessageToast.show(msg);
        }
    };
});
```
--------------------------------

**TITLE**: Creating and Integrating Custom Cards in SAP Fiori Elements Overview Pages

**INTRODUCTION**: Step-by-step actionable reference for adding a custom card to an Overview Page (OVP) application. Includes file layout, sample Component extension, fragment view, optional header fragment, controller with extension APIs (onRefresh, setRelevantFilters), and manifest/descriptor wiring. Use these code-ready examples inside webapp/ext/<yourCard>.

**TAGS**: fiori-elements-framework, sapui5, sap.ovp, overview-page, custom-card, OData, extension-api

STEP: 1 — Create folder and file skeleton
DESCRIPTION: Create a folder under webapp/ext for your custom card and add the required files.
LANGUAGE: text
CODE:
```
File path: webapp/ext/myCustomCard/
Files to create:
- Component.js              (custom Component that extends sap/ovp/cards/custom/Component)
- MyCustomCard.fragment.xml (card content fragment)
- MyCustomCard.controller.js (controller implementing extension APIs)
- MyCustomCardHeader.fragment.xml (optional header fragment if you want a custom header)
```

STEP: 2 — Implement Component.js (extend custom card component)
DESCRIPTION: Implement the UI5 component for your custom card. This file registers default fragment names, controller extension and metadata used by OVP. Save as webapp/ext/myCustomCard/Component.js. Note: update namespace strings to match your project.
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/ext/myCustomCard/Component.js
sap.ui.define(["sap/ovp/cards/custom/Component"],
    function (CustomCardComponent) {
        "use strict";
        return CustomCardComponent.extend("test.testovp.ext.myCustomCard.Component", {
            metadata: {
                properties: {
                    contentFragment: {
                        type: "string",
                        defaultValue: "test.testovp.ext.myCustomCard.MyCustomCard"
                    },
                    annotationPath: {
                        type: "string",
                        defaultValue: "com.sap.vocabularies.UI.v1.LineItem"
                    },
                    countHeaderFragment: {
                        type: "string",
                        defaultValue: "sap.ovp.cards.generic.CountHeader"
                    },
                    headerExtensionFragment: {
                        type: "string",
                        defaultValue: "sap.ovp.cards.generic.KPIHeader"
                    }
                },
                customizing: {
                    "sap.ui.controllerExtensions": {
                        "sap.ovp.cards.generic.Card": {
                            controllerName: "test.testovp.ext.myCustomCard.MyCustomCard"
                        }
                    }
                },
                version: "${version}",
                library: "sap.ovp",
                includes: [],
                dependencies: {
                    libs: ["sap.suite.ui.microchart"],
                    components: []
                },
                config: {}
            }
        });
    }
);
```

STEP: 3 — Define the card content fragment
DESCRIPTION: Define the card content area fragment. Save as webapp/ext/myCustomCard/MyCustomCard.fragment.xml. Use IDs for bindings; sample skeleton below — add your controls and bindings inside.
LANGUAGE: XML
CODE:
```xml
<!-- File: webapp/ext/myCustomCard/MyCustomCard.fragment.xml -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:ovp="sap.ovp.ui"
    xmlns:template="http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1">
    <!-- Put your Card's Content Area here -->
    <!-- Example: a List bound to items -->
    <List id="cardView" items="{/Results}">
        <StandardListItem title="{Name}" description="{Description}" />
    </List>
</core:FragmentDefinition>
```

STEP: 4 — (Optional) Define a custom header fragment
DESCRIPTION: If you want a custom header for the card place it in MyCustomCardHeader.fragment.xml and reference via metadata.headerExtensionFragment or in manifest settings.
LANGUAGE: XML
CODE:
```xml
<!-- File: webapp/ext/myCustomCard/MyCustomCardHeader.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
    <OverflowToolbar>
        <Title text="My Custom Card Header" />
        <!-- Add status or KPI controls as needed -->
    </OverflowToolbar>
</core:FragmentDefinition>
```

STEP: 5 — Implement controller with extension APIs
DESCRIPTION: Implement controller functions: onInit, onAfterRendering, onRefresh (for manual refresh action), and setRelevantFilters (to receive filters from OVP). Save as webapp/ext/myCustomCard/MyCustomCard.controller.js. Use getView().byId("cardView") where "cardView" matches fragment control id.
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/ext/myCustomCard/MyCustomCard.controller.js
(function () {
    "use strict";
    /* global sap, jQuery */
    sap.ui.define([], function () {
        return {
            onInit: function () {
                // initialization logic
            },

            onAfterRendering: function () {
                // post-render logic
            },

            /**
             * Called when user triggers the Refresh action on the card.
             * Use this hook to refresh model data or update bindings.
             */
            onRefresh: function () {
                // Example: refresh the card's entity set binding
                var oView = this.getView().byId("cardView");
                if (oView) {
                    var oBinding = oView.getBinding("items");
                    if (oBinding && oBinding.refresh) {
                        oBinding.refresh(); // refresh OData list binding
                    } else {
                        // fallback: trigger model refresh if needed
                        var oModel = this.getView().getModel();
                        if (oModel && oModel.refresh) {
                            oModel.refresh(true);
                        }
                    }
                }
            },

            /**
             * Extension function to receive card-relevant filters from the overview page.
             * @param {sap.ui.model.Filter[]} oFilters - Relevant filters (array)
             * @returns {void}
             */
            setRelevantFilters: function (oFilters) {
                var oView = this.getView().byId("cardView");
                if (!oView) {
                    return;
                }
                // If filters array contains valid filters, apply them to the items aggregation binding
                if (oFilters && oFilters.length > 0) {
                    var oBinding = oView.getBinding("items");
                    if (oBinding) {
                        oBinding.filter(oFilters);
                    }
                } else {
                    // Clear filters
                    var oBindingClear = oView.getBinding("items");
                    if (oBindingClear) {
                        oBindingClear.filter([]);
                    }
                }
            }
        };
    });
})();
```

STEP: 6 — Wire the custom card in manifest.json (descriptor)
DESCRIPTION: Configure the overview page descriptor to reference your custom card component and settings. Place under "sap.ovp" -> "cards". Adjust model, entitySet, title, and template namespace to match Component extend path.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card008_HereIsMyCustomCard": {
        "model": "myModel",
        "template": "test.testovp.ext.myCustomCard", 
        "settings": {
          "title": "Custom Card Title",
          "entitySet": "MyEntity"
          /* add additional card settings as required */
        }
      }
    }
  }
}
```

STEP: 7 — Card action availability and naming note
DESCRIPTION: Use onRefresh to support a card action that refreshes the custom card data. Also note which card template names are reserved.
LANGUAGE: text
CODE:
```
- Implement onRefresh in the card controller to enable a Refresh action on the card.
- Note: Card templates that begin with "sap.ovp.cards" are designated for standard OVP cards; custom templates should use your namespace (e.g., test.testovp.ext.myCustomCard).
```

STEP: 8 — Usage summary and integration points
DESCRIPTION: Quick checklist when adding a custom card into OVP:
LANGUAGE: text
CODE:
```
- Ensure webapp/ext/<yourCard> contains Component.js, MyCustomCard.fragment.xml, MyCustomCard.controller.js.
- Optionally add MyCustomCardHeader.fragment.xml for custom headers and reference it via metadata or settings.
- Extend sap/ovp/cards/custom/Component in Component.js and register controller extension (sap.ovp.cards.generic.Card).
- Implement onRefresh to refresh binding/model and setRelevantFilters to receive OVP filters.
- Add card entry under manifest.json "sap.ovp.cards" with "template" pointing to your component namespace.
```
--------------------------------

**TITLE**: Custom Filters for OVP Overview Page (SmartFilterBar Control Configuration Extension)

**INTRODUCTION**: Add custom filter controls to an SAP Fiori Elements overview page (OVP) by extending the SmartFilterBar ControlConfiguration. This guide shows how to:
- create an XML fragment with custom filter controls,
- implement a controller extension to provide filter logic and app-state persistence,
- wire the fragment and controller in the manifest.json.

Use when you want custom inputs on the filter bar (global filters or group-specific filters) and need the filters applied to one or more cards.

**TAGS**: fiori-elements-framework, sapui5, ovp, smartfilterbar, custom-filters, manifest, extension

**STEP**: 1 — Create the view extension fragment (customFilter.fragment.xml)

**DESCRIPTION**: Create an XML fragment that defines ControlConfiguration entries for the SmartFilterBar. Each ControlConfiguration must include:
- groupId: group to associate the filter (if groupId does not exist, the filter is added to the default group),
- key: entity property used for filter criteria,
- visibleInAdvancedArea: show the control on the filter bar advanced area,
- customControl: the input control and its id (the id is used in controller to read/write values).

Save file as webapp/ext/fragment/customFilter.fragment.xml (or an appropriate path matching your fragmentName in manifest).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/fragment/customFilter.fragment.xml -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:smartfilterbar="sap.ui.comp.smartfilterbar"
    xmlns:core="sap.ui.core">
    <!-- Example: Product ID filter in BASIC group -->
    <smartfilterbar:ControlConfiguration
        groupId="_BASIC"
        key="ProductID"
        label="Product ID (Extension)"
        visibleInAdvancedArea="true">
        <smartfilterbar:customControl>
            <Input id="ProductID" type="Text"/>
        </smartfilterbar:customControl>
    </smartfilterbar:ControlConfiguration>

    <!-- Example: Sales Order ID filter in GlobalFilters group -->
    <smartfilterbar:ControlConfiguration
        groupId="GlobalFilters"
        key="SalesOrderID"
        label="Sales Order ID (Extension)"
        visibleInAdvancedArea="false">
        <smartfilterbar:customControl>
            <Input id="SalesOrderID" type="Text"/>
        </smartfilterbar:customControl>
    </smartfilterbar:ControlConfiguration>
</core:FragmentDefinition>
```

**STEP**: 2 — Create the controller extension (customFilter.controller.js)

**DESCRIPTION**: Implement a controller extension that:
- reads values from custom inputs and returns a combined sap.ui.model.Filter via getCustomFilters(),
- stores custom input values into the app state via getCustomAppStateDataExtension(oCustomData),
- restores values from app state via restoreCustomAppStateDataExtension(oCustomData).

Wrap with sap.ui.define and export a controller extension object. Ensure the module name matches the controllerName used in the manifest (example below uses my_app.ext.controller.OverViewPageExt).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/controller/customFilter.controller.js
sap.ui.define([
    "sap/ui/core/mvc/Controller",
    "sap/ui/model/Filter"
], function (Controller, Filter) {
    "use strict";

    return Controller.extend("my_app.ext.controller.OverViewPageExt", {
        /**
         * Called by OVP framework to fetch custom filters.
         * Return an instance of sap.ui.model.Filter or undefined.
         */
        getCustomFilters: function () {
            var oView = this.getView ? this.getView() : this.oView; // compatibility
            var oValue1 = oView.byId("ProductID") && oView.byId("ProductID").getValue();
            var oValue2 = oView.byId("SalesOrderID") && oView.byId("SalesOrderID").getValue();

            var aFilters = [];

            if (oValue1) {
                aFilters.push(new Filter({
                    path: "ProductID",
                    operator: "EQ",
                    value1: oValue1
                }));
            }

            if (oValue2) {
                aFilters.push(new Filter({
                    path: "SalesOrderID",
                    operator: "EQ",
                    value1: oValue2
                }));
            }

            if (aFilters.length > 0) {
                // combine filters with logical AND
                return new Filter(aFilters, true);
            }

            // return undefined if no custom filters
        },

        /**
         * Persist custom fields into the app state object.
         * The framework will call this before storing the navigation/app state.
         */
        getCustomAppStateDataExtension: function (oCustomData) {
            if (!oCustomData) {
                return;
            }
            var oView = this.getView ? this.getView() : this.oView;
            var oCustomField1 = oView.byId("ProductID");
            var oCustomField2 = oView.byId("SalesOrderID");

            if (oCustomField1) {
                oCustomData.ProductID = oCustomField1.getValue();
            }
            if (oCustomField2) {
                oCustomData.SalesOrderID = oCustomField2.getValue();
            }
        },

        /**
         * Restore custom fields from the app state object.
         * The framework calls this when restoring state (e.g., after Back navigation).
         */
        restoreCustomAppStateDataExtension: function (oCustomData) {
            if (!oCustomData) {
                return;
            }
            var oView = this.getView ? this.getView() : this.oView;

            if (oCustomData.ProductID !== undefined) {
                var oCustomField1 = oView.byId("ProductID");
                if (oCustomField1) {
                    oCustomField1.setValue(oCustomData.ProductID);
                }
            }

            if (oCustomData.SalesOrderID !== undefined) {
                var oCustomField2 = oView.byId("SalesOrderID");
                if (oCustomField2) {
                    oCustomField2.setValue(oCustomData.SalesOrderID);
                }
            }
        }
    });
});
```

**STEP**: 3 — Register the view fragment and controller extension in manifest.json

**DESCRIPTION**: Add the view extension (fragment) and controller extension definitions under "extends.extensions". Ensure the fragmentName points to the fragment created in STEP 1 and the controllerName matches your controller module. Also configure sap.ovp global filter settings: set globalFilterModel and globalFilterEntityType to match your entity-type/group (example uses "GlobalFilters").

Place these entries under the root manifest.json. Adjust module names and fragmentName paths to match your project structure.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.ovp.app.Main": {
          "controllerName": "my_app.ext.controller.OverViewPageExt"
        }
      },
      "sap.ui.viewExtensions": {
        "sap.ovp.app.Main": {
          "SmartFilterBarControlConfigurationExtension|GlobalFilters": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "my_app.ext.fragment.customFilter", 
            "type": "XML"
          }
        }
      }
    }
  },
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters"
    /* ...other sap.ovp settings... */
  }
}
```

Notes:
- The fragmentName must match the fragment file module path (e.g., webapp/ext/fragment/customFilter.fragment.xml => module "my_app.ext.fragment.customFilter" depending on your project namespace).
- Ensure the entity type name used for ControlConfiguration (groupId or the entity type) matches sap.ovp.globalFilterEntityType if you want the custom filters to act as global filters for cards.
- If the specified groupId does not exist, the control is added to the default group.
--------------------------------

**TITLE**: Customizing Card Messages with getCustomMessage in Extension Controller

**INTRODUCTION**: Provide custom messages and optional icons for card success, success-with-no-data, and error scenarios in Fiori Elements cards by implementing getCustomMessage(oResponse, sCardId) in your extension controller. Return an object with sMessage and optional sIcon (use sIcon only for success/success-no-data). Error scenarios should return sMessage only (default icon is used).

**TAGS**: fiori-elements-framework, UI5, extension, controller, messages, custom-message, cards

**STEP**: 1 — Implement getCustomMessage in your extension controller

**DESCRIPTION**: Add the getCustomMessage function to the extension controller file. The function signature is getCustomMessage(oResponse, sCardId). Inspect oResponse.getParameters().success to distinguish success/no-data from error. Return an object:
- For success or success-with-no-data: { sMessage: "<text>", sIcon: "sap-icon://..." } (sIcon optional)
- For error: { sMessage: "<text>" } (do not include sIcon; default icon is displayed)

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Place this function in your extension controller (e.g., extension controller file)
getCustomMessage: function (oResponse, sCardId) {
  // Example for a specific card id "card001"
  if (sCardId === "card001") {
    // Detect success / success-with-no-data via response parameters
    if (oResponse && oResponse.getParameters && oResponse.getParameters().success) {
      return {
        sMessage: "My Custom Message for No Data",      // message for success and no data
        sIcon: "sap-icon://message-information"         // optional icon for success scenarios
      };
    } else {
      // Error scenario: return message only (default icon will be displayed)
      return {
        sMessage: "My Custom Message for Error"
      };
    }
  }

  // No custom message for other cards: return undefined or nothing
},
```

**STEP**: 2 — Multi-card handling and default fallback

**DESCRIPTION**: Handle multiple cards and provide a default message fallback. Use a switch or map to return different messages per sCardId and provide a generic fallback when no specific card is matched.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
getCustomMessage: function (oResponse, sCardId) {
  var isSuccess = !!(oResponse && oResponse.getParameters && oResponse.getParameters().success);

  switch (sCardId) {
    case "card001":
      return isSuccess
        ? { sMessage: "Card 001: No data available", sIcon: "sap-icon://message-success" }
        : { sMessage: "Card 001: Error loading data" };

    case "card002":
      return isSuccess
        ? { sMessage: "Card 002: No results found", sIcon: "sap-icon://search" }
        : { sMessage: "Card 002: Failed to retrieve results" };

    default:
      // Generic fallback: only set message; let framework use default icon for errors
      return isSuccess
        ? { sMessage: "No data available", sIcon: "sap-icon://message-information" }
        : { sMessage: "An error occurred while loading the card" };
  }
},
```

**STEP**: 3 — Notes and best practices

**DESCRIPTION**: Guidelines to ensure expected behavior:
- Always return an object with sMessage for any scenario you want to customize.
- Only include sIcon for success/success-with-no-data scenarios; error scenarios should omit sIcon so the framework displays the default error icon.
- Ensure oResponse.getParameters() is present before accessing .success to avoid runtime errors.
- Keep messages short and user-focused.
--------------------------------

**TITLE**: Custom Navigation Parameters for Intent-Based Navigation (OVP / Fiori Elements)

**INTRODUCTION**: This guide shows how to add custom URL/selection-variant parameters for intent-based navigation from SAP OVP (OVP cards / Fiori Elements). Implement a controller extension with an onCustomParams dispatcher that returns one of your custom parameter functions. Configure the app descriptor to wire the controller extension and set the card setting customParams to the function name.

**TAGS**: fiori-elements-framework, sap.ovp, navigation, selection-variant, custom-parameters, ui5, controller-extension

STEP: 1 — Implement onCustomParams dispatcher and custom parameter functions

DESCRIPTION: Create a controller extension (UI5 controller) that implements onCustomParams. onCustomParams receives a function name (string) and must return a function that will be executed by the navigation framework. Provide two common patterns:
- Return an array of selection-variant entries (aCustomSelectionVariant).
- Mutate and return oNavigateParams.
- (Alternate) Return an object containing aSelectionVariant and bIgnoreEmptyString (replaces deprecated selectionVariant/ignoreEmptyString).

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/ext/controller/OverViewPageExt.controller.js
// Controller extension example for OVP app
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function(Controller) {
  "use strict";

  return Controller.extend("my_app.ext.controller.OverViewPageExt", {

    /**
     * Dispatcher called by OVP before navigation.
     * sCustomParams is the function name set in the card's customParams setting.
     * Return the actual function that will be called for this navigation.
     */
    onCustomParams: function(sCustomParams) {
      if (sCustomParams === "getParameters") {
        return this.getParameters;
      } else if (sCustomParams === "param2") {
        return this.param2;
      } else if (sCustomParams === "getParametersWithSelectionVariant") {
        return this.getParametersWithSelectionVariant;
      }
      // default: return null/undefined to not modify navigation
      return null;
    },

    /**
     * Pattern A: Return an array of selection-variant entries.
     * Each entry: { path, operator, value1, value2, sign }
     * operator: EQ, NE, LE, GE, LT, GT, BT, CP
     * sign: "I" to include, "E" to exclude
     */
    getParameters: function(oNavigateParams) {
      var aCustomSelectionVariant = [];
      var oCustomSelectionVariant = {
        path: "TaxTarifCode",
        operator: "EQ",
        value1: "5",
        value2: null,
        sign: "I"
      };
      aCustomSelectionVariant.push(oCustomSelectionVariant);
      // return an array of selection-variant objects
      return aCustomSelectionVariant;
    },

    /**
     * Pattern B: Modify the raw navigation params object and return it.
     * Example: add or override navigation parameter values.
     */
    param2: function(oNavigateParams) {
      oNavigateParams.TaxTarifCode = "3";
      return oNavigateParams;
    },

    /**
     * Pattern C: Work with SelectionVariant object provided by framework
     * - Read available select options
     * - Remove/replace filters by setting empty values and using bIgnoreEmptyString
     * - Return { aSelectionVariant: [...], bIgnoreEmptyString: true }
     *
     * Note: older names selectionVariant / ignoreEmptyString are deprecated from 1.54.
     */
    getParametersWithSelectionVariant: function(oNavigateParams, oSelectionVariantParams) {
      // Read available select option property names (useful to inspect)
      var aSelectOptionNames = oSelectionVariantParams.getSelectOptionsPropertyNames();

      // Read specific select options (returns array-like structure)
      var oFilter1 = oSelectionVariantParams.getSelectOption("Filter1");
      var oFilter2 = oSelectionVariantParams.getSelectOption("Filter2");

      // Your logic to extract values from oFilter1 and oFilter2
      // Example: remove Filter1 and Filter2 by assigning empty values
      var Filter1 = {
        path: "Filter1",
        operator: "EQ",
        value1: "",
        value2: null,
        sign: "I"
      };

      var Filter2 = {
        path: "Filter2",
        operator: "EQ",
        value1: "",
        value2: null,
        sign: "I"
      };

      // Add other filters to include
      var oFilter3 = {
        path: "Filter3PropertyName",
        operator: "EQ",
        value1: "<ValueToInclude>",
        value2: null,
        sign: "I"
      };

      var aCustomSelectionVariant = [];
      aCustomSelectionVariant.push(oFilter3);
      aCustomSelectionVariant.push(Filter2);
      aCustomSelectionVariant.push(Filter1);

      // Return the modern property names:
      return {
        aSelectionVariant: aCustomSelectionVariant,
        bIgnoreEmptyString: true
      };
    }

  });
});
```

STEP: 2 — Configure the app descriptor to register the controller extension

DESCRIPTION: In your manifest.json (descriptor), register the controller extension under sap.ui.controllerExtensions for the base controller (sap.ovp.app.Main). If the controller file already exists, add the extension to the same file.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.ovp.app.Main": {
            "controllerName": "my_app.ext.controller.OverViewPageExt"
          }
        }
      }
    }
  }
}
```

STEP: 3 — Configure card settings: set customParams to the function name

DESCRIPTION: In the OVP card configuration (card manifest or cards configuration JSON), set the customParams value to the function name you return from onCustomParams. This string is passed to onCustomParams which should return the appropriate function (see Step 1).

LANGUAGE: JSON

CODE:
```json
{
  "card002_ReorderSoon": {
    "model": "purchaseOrder",
    "template": "sap.ovp.cards.list",
    "settings": {
      "title": "reorder Soon",
      "subTitle": "Less than 10 in stock",
      "listType": "condensed",
      "entitySet": "PurchaseSet",
      "customParams": "getParameters"    // function name defined in onCustomParams
      // ... other settings ...
    }
  }
}
```

STEP: 4 — Important details and operator reference

DESCRIPTION: Keep these implementation details in mind when building your custom param functions.

LANGUAGE: Plain text (for clarity in code use comments)

CODE:
```text
- Selection-variant entry fields:
  - path: property name (string)
  - operator: EQ, NE, LE, GE, LT, GT, BT, CP
  - value1: first operator value (string or number)
  - value2: second operator value (use for BT/range; set null otherwise)
  - sign: "I" to include, "E" to exclude

- Return types supported by navigation framework:
  - Array of selection-variant objects (Pattern A)
  - Mutated oNavigateParams object (Pattern B)
  - Object with aSelectionVariant and bIgnoreEmptyString (modern names)
    Example: { aSelectionVariant: [...], bIgnoreEmptyString: true }

- Deprecation note:
  - selectionVariant and ignoreEmptyString were deprecated in UI5 1.54.
  - Use aSelectionVariant and bIgnoreEmptyString instead.
```
--------------------------------

**TITLE**: Custom State Handling for Extended SAP Fiori Elements Apps (OData V2 & V4)

**INTRODUCTION**: Implementation guide and code examples for handling custom UI/app state in extended SAP Fiori Elements apps. Covers OData V2 methods (object page extension), lifecycle semantics, reuse component API, and OData V4 ViewState controller extension, including registration in manifest and how to trigger app-state updates.

**TAGS**: sap.ui5, fiori-elements, extensionAPI, app-state, view-state, object-page, controller-extension, lifecycle

**STEP**: 1 - Notify framework when custom state changes (OData V2)
**DESCRIPTION**: Call the extension API hook onCustomStateChange whenever the persistable state of a custom UI element changes. This informs the framework the app state must be recalculated/persisted.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// Controller / extension code snippet: call when your custom control's persistable state changes
// Assumes you have access to the ExtensionAPI instance as `this.extensionAPI`
// (in object page controller extensions the extensionAPI is available from the controller)
onCustomControlChanged: function() {
  // Mark that custom state has changed so framework will include it in the app state
  this.extensionAPI.onCustomStateChange();
}
```

**STEP**: 2 - Provide custom state into the global state object (OData V2)
**DESCRIPTION**: Override provideCustomStateExtension(oState) in the object page controller extension and add properties to the provided empty oState. Each property must be an object with two keys: data (serializable) and lifecycle (object describing lifetime: session, permanent, page, pagination).
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// Object page controller extension override
provideCustomStateExtension: function(oState) {
  // Add one or more state entries; keys must be unique
  oState.myCustomWidget = {
    data: {
      selectedTab: this.byId("myTabs").getSelectedKey(),
      filter: { text: this._filterText } // JSON.stringify-able
    },
    lifecycle: {
      session: true,     // survives cross-app navigation in this FLP session
      permanent: false,  // not persisted beyond session
      page: false,
      pagination: false
    }
  };

  // More entries can be added similarly
  oState.someOtherState = {
    data: { foo: "bar" },
    lifecycle: { permanent: true } // persisted to URL hash if configured
  };
}
```

**STEP**: 3 - Apply returned custom state when restoring (OData V2)
**DESCRIPTION**: Override applyCustomStateExtension(oState, bIsSameAsLast) to receive the persisted state. The oState contains entries that were included in provideCustomStateExtension; values are the corresponding data objects (the lifecycle is NOT passed here). Respect bIsSameAsLast (truthy => same instance visited previously; no UI update required).
**LANGUAGE**: JavaScript
**CODE**:
```javascript
applyCustomStateExtension: function(oState, bIsSameAsLast) {
  // If same instance as last time, skip restoring UI state
  if (bIsSameAsLast) {
    return;
  }

  // oState.myCustomWidget corresponds to the data object you set earlier
  var widgetState = oState && oState.myCustomWidget;
  if (widgetState) {
    // Apply values to controls (defensive checks as input may be deserialized)
    if (widgetState.selectedTab) {
      this.byId("myTabs").setSelectedKey(widgetState.selectedTab);
    }
    if (widgetState.filter && widgetState.filter.text) {
      this._filterText = widgetState.filter.text;
      // Apply to filter control
      this.byId("myFilter").setValue(this._filterText);
    }
  }

  // Handle other state entries similarly...
}
```

**STEP**: 4 - Lifecycle properties and semantics (OData V2)
**DESCRIPTION**: Use lifecycle booleans to define retention scope for each state property. The framework uses lifecycle to decide which state parts to include and how to persist them (URL hash, session, etc.). Summary:
- session: true = survives cross-app navigation inside same FLP session; hashed in URL
- permanent: true = survives sessions, hashed and stored (requires backend/front-end config)
- page: true = apply when navigating to same page for a different instance (use carefully)
- pagination: true = apply only when switching instances by pagination (immediate replace)
**LANGUAGE**: JSON
**CODE**:
```json
// Example lifecycle object for a state entry
{
  "lifecycle": {
    "session": true,
    "permanent": false,
    "page": false,
    "pagination": false
  }
}
```

**STEP**: 5 - Reuse component API (keeping component-specific state)
**DESCRIPTION**: Reuse components cannot override controller extension methods. Implement stGetCurrentState() to return component state and stApplyState(oState, bIsSameAsLast) to apply it. stGetCurrentState should return an object adhering to the { propertyName: { data, lifecycle } } structure. stApplyState should accept either (a) the same object or (b) the inner data objects (defensively detect both forms).
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// Reuse component methods implemented inside the component's controller/logic
stGetCurrentState: function() {
  return {
    myCompState: {
      data: {
        isExpanded: this._isExpanded,
        selection: this._currentSelection
      },
      lifecycle: { session: true } // or permanent/page/pagination as required
    }
  };
},

stApplyState: function(oState, bIsSameAsLast) {
  if (bIsSameAsLast) {
    return;
  }

  // Handle two possible incoming shapes:
  // 1) { myCompState: { data: {...}, lifecycle: {...} } }
  // 2) { myCompState: { ... } }  (data-only)
  var entry = oState && oState.myCompState;
  var data = entry && (entry.data ? entry.data : entry);

  if (data) {
    if ("isExpanded" in data) {
      this._isExpanded = data.isExpanded;
      this.byId("myComp").setExpanded(this._isExpanded);
    }
    if ("selection" in data) {
      this._currentSelection = data.selection;
      // apply selection to component
    }
  }
}
```

**STEP**: 6 - ViewState controller extension (OData V4) — override methods
**DESCRIPTION**: Use the ViewState controller extension in any view controller that should participate in app-state handling. Override the provided hooks to collect and apply control-specific state and additional view-level state. Key hooks to override:
- adaptControlStateHandler(oControl, aControlHandler)
- adaptStateControls(aCollectedControls)
- retrieveAdditionalStates(mAdditionalStates)
- applyAdditionalStates(oViewState, aPromises)
- applyNavigationParameters(oNavParameter, aPromises)
- applyInitialStateOnly()
- onBeforeStateApplied(aPromises)
- onAfterStateApplied(aPromises)
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// Example control-state handler signatures:
{
  retrieve: function(oControl) {
    // return serializable state for oControl
  },
  apply: function(oControl, oControlState, oNavParameters) {
    // apply state; oControlState or oNavParameters can be null -> check accordingly
  }
}
```

**STEP**: 7 - Control state handler example (OData V4)
**DESCRIPTION**: Sample handler for sap.uxap.ObjectPageLayout: retrieve selected section and apply it safely.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
{
  retrieve: function(oOPLayout) {
    return {
      selectedSection: oOPLayout.getSelectedSection()
    };
  },
  apply: function(oOPLayout, oControlState, oNavParameters) {
    // Defensive check: oControlState can be null/undefined after deserialization
    oControlState && oControlState.selectedSection && oOPLayout.setSelectedSection(oControlState.selectedSection);
  }
}
```

**STEP**: 8 - Overriding the default ViewState extension (OData V4) — full example
**DESCRIPTION**: Provide a controller extension module that overrides viewState.* hooks to register custom control handlers, add controls to state collection, and manage additional states. Register this controller extension in the manifest (see next step).
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// Controller extension module (e.g., Custom/LRControllerExtension.js)
return ControllerExtension.extend("Custom.LRControllerExtension", {
  override: {
    viewState: {
      adaptControlStateHandler: function(oControl, aControlHandlers) {
        if (oControl.isA("sap.f.DynamicPage")) {
          aControlHandlers.push({
            retrieve: function(oControl) {
              return { headerExpanded: oControl.getHeaderExpanded() };
            },
            apply: function(oControl, mControlState) {
              if (mControlState && "headerExpanded" in mControlState) {
                oControl.setHeaderExpanded(mControlState.headerExpanded);
              }
            }
          });
        }
      },
      adaptStateControls: function(aControls) {
        // Add a view control by local ID (use view.byId in controller implementation)
        aControls.push(this.getView().byId("My::DynamicePage::Control"));
      },
      retrieveAdditionalStates: function(mAdditionalStates) {
        mAdditionalStates.lastVisit = new Date().toString();
      },
      applyAdditionalStates: function(mAdditionalStates) {
        if (mAdditionalStates.lastVisit) {
          MessageToast.show("Applying view state from " + mAdditionalStates.lastVisit);
        }
      }
    }
  }
});
```

**STEP**: 9 - Register the controller extension in manifest.json (OData V4 sample)
**DESCRIPTION**: Add a controller extension entry under sap.ui5 -> extends -> extensions -> sap.ui.controllerExtensions mapping the base template controller to your extension controller.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ListReport.ListReportController": {
            "controllerName": "Custom.LRControllerExtension"
          }
        }
      }
    }
  }
}
```

**STEP**: 10 - Trigger an app-state update after custom view changes (OData V4 and V2)
**DESCRIPTION**: When you implement custom view-state handling, notify the framework to update the overall app state by calling ExtensionAPI.updateAppState(). Use this after changes to the custom controls or view state that should be persisted.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// Example: call after your custom state changed
// Assumes ExtensionAPI instance available as this.extensionAPI
this.extensionAPI.updateAppState(); // framework will collect view states and persist/update URL hash as configured

// Optionally use the returned promise if supported in your framework version:
if (this.extensionAPI.updateAppState) {
  var p = this.extensionAPI.updateAppState();
  if (p && typeof p.then === "function") {
    p.then(function() {
      // post-update actions
    });
  }
}
```

**STEP**: 11 - Notes & defensive implementation tips
**DESCRIPTION**: Implementation tips to ensure reliability:
- Always JSON.stringify/parse-safe: data objects must be serializable.
- applyCustomStateExtension receives only the data part (no lifecycle); lifecycle controls inclusion only.
- bIsSameAsLast: truthy means same instance visited previously — skip UI restoration to keep original state.
- In ViewState apply handlers, check for null/undefined oControlState and oNavParameters.
- Use lifecycle flags carefully: permanent implies state can be visible across sessions and must be appropriate (avoid transient data like scroll position).
**LANGUAGE**: PlainText
**CODE**:
```text
- Ensure all state data is JSON-safe (serializable).
- Be defensive: check for undefined/null when applying state.
- Use lifecycle flags to limit exposure of sensitive or transient state.
```
--------------------------------

**TITLE**: Custom View Switch for OVP Cards (controller extension)

**INTRODUCTION**: Create a controller extension to programmatically set the active tab for OVP cards based on filter values or custom logic. Implement onBeforeRebindPageExtension(aCards, oSelectionVariant) to build a mapping of cardId -> tabIndex and then call this.setTabIndex(mapping).

**TAGS**: fiori-elements-framework, sapui5, ovp, controller-extension, view-switch, manifest, controller

**STEP**: 1 — Implement controller extension file

**DESCRIPTION**: Create a controller extension (example name: sap.ovp.demo.ext.customController) that implements onBeforeRebindPageExtension(aCards, oSelectionVariant). Build an object mapping card IDs to desired tab indices (1-based) and call this.setTabIndex(oTabIndexList). Include a helper _getFilterList(oSelectionVariant) that extracts filter values (Parameters and SelectOptions) into a flat object for decision logic.

Note: TabIndex values must start at 1 and must not exceed the number of tabs on the card.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: ext/customViewswitch.controller.js
// Example AMD/UI5 module implementing the controller extension for view switching

sap.ui.define([
    "sap/ui/core/mvc/Controller"
], function (Controller) {
    "use strict";

    return Controller.extend("sap.ovp.demo.ext.customController", {

        /**
         * Called by OVP before rebind of cards. Build a mapping { cardId: tabIndex } and pass to this.setTabIndex.
         * @param {Array} aCards - array of visible card descriptors (each must have .id)
         * @param {Object} oSelectionVariant - filter selection variant with Parameters and SelectOptions
         */
        onBeforeRebindPageExtension: function (aCards, oSelectionVariant) {
            // Example mapping object: {"card1": 2, "card2": 1}
            var oTabIndexList = {};

            // Convert selection variant into a simple key->value object
            var oFilterList = this._getFilterList(oSelectionVariant);

            // Sample logic: for card with id "card012", switch tab based on SupplierName filter
            if (Array.isArray(aCards) && aCards.length > 0) {
                for (var i = 0; i < aCards.length; i++) {
                    var oCard = aCards[i];
                    if (!oCard || !oCard.id) {
                        continue;
                    }

                    if (oCard.id === "card012") {
                        if (oFilterList && oFilterList.hasOwnProperty("SupplierName")) {
                            if (oFilterList.SupplierName === "SAP") {
                                oTabIndexList["card012"] = 1; // first tab
                            } else if (oFilterList.SupplierName === "Talpa") {
                                oTabIndexList["card012"] = 2; // second tab
                            }
                            // Add more conditions as needed
                        }
                    }

                    // Example: static mapping for another card
                    // oTabIndexList["cardABC"] = 1;
                }
            }

            // Pass the completed mapping to the framework method
            // Note: values must be >= 1 and <= number of tabs on the target card
            this.setTabIndex(oTabIndexList);
        },

        /**
         * Read selection variant Parameters and SelectOptions into a flat object:
         * Parameters: [{PropertyName, PropertyValue}, ...]
         * SelectOptions: [{PropertyName, Ranges:[{Option, Low, High}, ...]}, ...]
         * Only EQ ranges with Low value are collected here for simplicity.
         * @param {Object} oSelectionVariant
         * @returns {Object} oFilterList
         */
        _getFilterList: function (oSelectionVariant) {
            var oFilterList = {};

            if (!oSelectionVariant) {
                return oFilterList;
            }

            // Parameters (simple key/value)
            if (oSelectionVariant.Parameters && oSelectionVariant.Parameters.length > 0) {
                for (var p = 0; p < oSelectionVariant.Parameters.length; p++) {
                    var oParam = oSelectionVariant.Parameters[p];
                    if (oParam && oParam.PropertyName) {
                        oFilterList[oParam.PropertyName] = oParam.PropertyValue;
                    }
                }
            }

            // SelectOptions (ranges); collect first EQ Low value if present
            if (oSelectionVariant.SelectOptions && oSelectionVariant.SelectOptions.length > 0) {
                for (var s = 0; s < oSelectionVariant.SelectOptions.length; s++) {
                    var oSel = oSelectionVariant.SelectOptions[s];
                    if (!oSel || !oSel.PropertyName || !oSel.Ranges) {
                        continue;
                    }
                    for (var r = 0; r < oSel.Ranges.length; r++) {
                        var oRange = oSel.Ranges[r];
                        if (oRange && oRange.Option === "EQ" && oRange.Low !== "") {
                            oFilterList[oSel.PropertyName] = oRange.Low;
                            break; // only first EQ taken for this property in this helper
                        }
                    }
                }
            }

            return oFilterList;
        }

    });
});
```

**STEP**: 2 — Configure controller extension in manifest/descriptor

**DESCRIPTION**: Register the controller extension under sap.ui.controllerExtensions in your app descriptor (manifest.json). Replace controllerName with the module name used above.

Place this snippet in the root "sap.ui5" -> "extends" -> "extensions" -> "sap.ui.controllerExtensions" section of your manifest.json (or merge into existing structure).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.ovp.app.Main": {
            "controllerName": "sap.ovp.demo.ext.customController"
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Example mapping usage and constraints

**DESCRIPTION**: Use an object mapping where keys are card IDs and values are 1-based tab indices. Example: {"card1": 2, "card2": 1}. Ensure indices do not exceed the available tab count of each card.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example mapping and invocation (inside your controller logic)
var oTabIndexList = {
    "card1": 2,
    "card2": 1
};
// call framework-provided method
this.setTabIndex(oTabIndexList);
```
--------------------------------

**TITLE**: Customizing List Card (Smart Links, Text Arrangement, Filtering, Sorting)

**INTRODUCTION**: Instructions and concrete code examples for customizing Fiori Elements list cards: add smart links (semantic objects), configure text arrangement for list area, apply filters, and set sorting/grouping via the application descriptor. Use these snippets directly in XML annotations, ABAP CDS, CAP CDS, or manifest (application descriptor).

**TAGS**: fiori-elements-framework, annotations, smart-links, text-arrangement, selection-variant, filtering, sorting, application-descriptor, CDS, CAP

**STEP**: 1 — Add Smart Links (Semantic Object)

**DESCRIPTION**: Define a semantic object for an entity set property so the property appears as a smart link. Use XML OData annotations, ABAP CDS annotations, or CAP CDS annotations. Target the fully qualified entity/property as shown.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- XML Annotation -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="GWSAMPLE_BASIC.SalesOrder/SalesOrderID">
  <Annotation Term="com.sap.vocabularies.Common.v1.SemanticObject" String="OVP" />
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
/* ABAP CDS Annotation */
annotate view SALESORDER with {
  @Consumption.semanticObject: 'OVP'
  salesorderid;
}
```

**LANGUAGE**: CAP CDS

**CODE**:
```sql
-- CAP CDS Annotation
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.SemanticObject : 'OVP'
  SalesOrderID
};
```

**STEP**: 2 — Configure Text Arrangement in List Area

**DESCRIPTION**: Use the Text annotation plus UI.TextArrangement to control how the main ID and display text are combined in the list. The examples set a text property and choose a text arrangement. Text arrangement mapping:
- TextLast -> "ID (Text)" (enum: #TEXT_LAST or #TextLast)
- TextFirst -> "Text (ID)" (enum: #TEXT_FIRST or #TextFirst)
- TextOnly -> "Text" (enum: #TEXT_ONLY or #TextOnly)

**LANGUAGE**: XML

**CODE**:
```xml
<!-- XML Annotation: bind text property and set text arrangement -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="GWSAMPLE_BASIC.SalesOrder/CustomerID">
  <Annotation Term="com.sap.vocabularies.Common.v1.Text" Path="Supplier_Name"/>
  <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast" />
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
/* ABAP CDS Annotation: set UI text arrangement for the property */
annotate view SALESORDER with {
  @UI.TextArrangement: #TEXT_LAST
  customerid;
}
```

**LANGUAGE**: CAP CDS

**CODE**:
```sql
-- CAP CDS Annotation: assign text field and arrangement
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.Text : Supplier_Name
  @UI.TextArrangement : #TextLast
  CustomerID
};
```

**STEP**: 3 — Add Filters to List Card

**DESCRIPTION**: Add filters to the list card using the SelectionVariant annotation (com.sap.vocabularies.UI.v1.SelectionVariant) or by passing OData filter expressions in the card URL. Use SelectionVariant in XML annotations to define static filters and selection options. Alternatively, append $filter to the OData service URL used by the card.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- XML Annotation: simple SelectionVariant example -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="GWSAMPLE_BASIC.SalesOrder">
  <Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant">
    <Record>
      <!-- Example: preselect Status = 'Open' -->
      <PropertyValue Property="SelectOptions">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.SelectOption">
            <PropertyValue Property="PropertyName" String="Status"/>
            <PropertyValue Property="Ranges">
              <Collection>
                <Record Type="com.sap.vocabularies.UI.v1.Range">
                  <PropertyValue Property="Sign" EnumMember="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"/>
                  <PropertyValue Property="Option" EnumMember="com.sap.vocabularies.UI.v1.SelectionRangeOptionType/EQ"/>
                  <PropertyValue Property="Low" String="Open"/>
                </Record>
              </Collection>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: Plain text (URL)

**CODE**:
```
# OData URL filter example: pass filter in the card service URL
https://.../GWSAMPLE_BASIC/SalesOrder?$filter=Status eq 'Open'
```

**STEP**: 4 — Configure Sorting / Grouping in Application Descriptor

**DESCRIPTION**: Set default sort properties for the list card using sortBy and sortOrder in the application descriptor (manifest.json or the card configuration file). The snippet below demonstrates placing these properties in a card configuration object in manifest.json. Update the card key and property names to match your card and OData properties.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "your.app.id"
  },
  "sap.ui": { },
  "sap.card": {
    "cards": {
      "listCard": {
        "model": "odata",
        "settings": {
          "entitySet": "SalesOrder",
          "sortBy": "CreatedAt",
          "sortOrder": "Descending"  /* or "Ascending" */
        }
      }
    }
  }
}
```

**STEP**: 5 — References & Integration Notes

**DESCRIPTION**: Use these snippets in the appropriate annotation files or CDS definitions:
- XML annotations: include in your service annotation XML (annotations.xml) or the annotation file referenced by the OData service.
- ABAP CDS: include in the annotate view block of the CDS source or separate header.
- CAP CDS: include in your .cds files or a separate annotations.cds file.
- Application descriptor: update your manifest.json or card-specific descriptor used by the Fiori launchpad.
For more advanced filter configuration and UI card filter mapping, consult your platform's "Configuring Card Filters" and "Configuring Sort Properties" documentation.
--------------------------------

**TITLE**: Customizing Overview Pages Using Runtime Capabilities

**INTRODUCTION**: Describe how end users can personalize SAP Fiori overview pages at runtime: rearrange cards, hide/show cards, resize cards (when enabled), and apply filters affecting relevant cards. Provide the descriptor (manifest) configuration required to enable resizable cards and set default card sizes.

**TAGS**: fiori-elements-framework, overview-page, ovp, personalization, runtime-capabilities, manifest.json, descriptor, cards, resize, defaultSpan

**STEP**: 1 — End-user interactions (rearrange cards)

**DESCRIPTION**: Allow end users to rearrange cards by drag-and-drop or keyboard. Document keyboard shortcut, ClickLock usage, and saving behavior for moved cards.

**LANGUAGE**: Text

**CODE**:
```text
- Rearranging:
  - Mouse: Drag and drop a card to a new location.
  - Keyboard: Press Ctrl and use Arrow keys to move the focused card.
  - ClickLock (Windows): Optional OS-level setting to allow single-click drag:
    1. Open Settings -> Bluetooth and devices -> Touchpad
    2. Click "More touchpad settings" -> "Mouse Properties" dialog
    3. Check "Turn on ClickLock"
    Usage: Single-click to enter drag mode, move cursor, second click to commit.

- Save behavior:
  - Only the moved cards have their target location persisted.
  - Unmoved cards are arranged by layout engine (best fit).
  - To fix a specific position for every card, move each card at least once.
```

**STEP**: 2 — Hide and show cards (runtime)

**DESCRIPTION**: Steps for end users to hide or show cards via the Overview Page UI, and how to reset to defaults.

**LANGUAGE**: Text

**CODE**:
```text
1. In the overview page header, click/tap the Options icon -> Manage Cards.
2. Toggle the checkbox for each card to hide or show it.
3. Click OK to save changes.
4. To restore default view: open Manage Cards -> Reset.
```

**STEP**: 3 — Enable resizable cards and set default card size (descriptor / manifest configuration)

**DESCRIPTION**: Configure the overview page descriptor (manifest.json) to enable resizable container layout for cards and set default sizes per card using defaultSpan. Place these settings in your application's descriptor (manifest.json) under the sap.ovp section.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "globalSettings": {
      "containerLayout": "resizable"    /* prerequisite to enable runtime resizing */
    },
    "cards": {
      "MyCardId": {
        "settings": {
          "defaultSpan": {
            "rows": 7,
            "cols": 2
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Notes and constraints

**DESCRIPTION**: Preserve important runtime constraints and limitations for code generation and QA.

**LANGUAGE**: Text

**CODE**:
```text
- Only personalize cards that share the same screen resolution and size.
- Browser zoom must be set to default (100%) for reliable drag/drop and layout behavior.
- Resizing of "stack" card types is not supported.
- Filters applied by the user affect all relevant cards and limit displayed content (e.g., show only orders with supply date in the past).
```
--------------------------------

**TITLE**: Customizing Table Card — Smart Links, Text Arrangement, Filtering, Sorting

**INTRODUCTION**: Practical examples and annotation snippets to customize table card content in Fiori Elements: add smart links (semantic objects), control text arrangement, apply filters using SelectionVariant or URL parameters, and configure sorting/grouping via the application descriptor (manifest.json). Includes XML Annotation, ABAP CDS, and CAP model examples.

**TAGS**: fiori-elements, annotations, OData, CDS, CAP, ABAP, manifest.json, smart-links, text-arrangement, selection-variant, sorting

**STEP**: 1 — Add Smart Links (Semantic Objects)

**DESCRIPTION**: Define a semantic object for an entity set property so table cells become smart links. Place annotations either in an OData annotation XML file, an ABAP CDS view annotation, or a CAP model annotation. Replace entity and property names with your service/model names.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- annotations.xml (OData Annotation file) -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="GWSAMPLE_BASIC.SalesOrder/SalesOrderID">
  <Annotation Term="com.sap.vocabularies.Common.v1.SemanticObject" String="OVP" />
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
/* In your ABAP CDS view file */
annotate view SALESORDER with {
  @Consumption.semanticObject: 'OVP'
  salesorderid;
}
```

**LANGUAGE**: CAP CDS

**CODE**:
```sql
/* In a CAP model .cds file or annotations file */
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.SemanticObject : 'OVP'
  SalesOrderID;
};
```

---

**STEP**: 2 — Control Text Arrangement in Table Cells

**DESCRIPTION**: Use the Text and TextArrangement annotations to display a descriptive text alongside the key value in the table cell. Examples show XML Annotation, ABAP CDS, and CAP CDS. TextArrangement enum examples: TextLast (key first: "ContractID (Customer)"), TextFirst ("Customer (ContractID)"), TextOnly ("Customer").

**LANGUAGE**: XML

**CODE**:
```xml
<!-- annotations.xml: Bind textual property and set arrangement -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="GWSAMPLE_BASIC.SalesOrder/CustomerID">
  <Annotation Term="com.sap.vocabularies.Common.v1.Text" Path="Supplier_Name"/>
  <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast" />
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
/* ABAP CDS: set UI text arrangement for the property */
annotate view SALESORDER with {
  @UI.TextArrangement: #TEXT_LAST
  customerid;
}
```

**LANGUAGE**: CAP CDS

**CODE**:
```sql
/* CAP CDS: annotate model to provide text and arrangement */
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.Text            : Supplier_Name,
  @UI.TextArrangement     : #TextLast,
  CustomerID;
};
```

---

**STEP**: 3 — Add Filters (SelectionVariant or URL)

**DESCRIPTION**: Apply initial filters to the card using the SelectionVariant annotation or by passing filter parameters in the card/URL. Use SelectionVariant to define default select options (server-side) or use client-side URL filter parameters. See referenced guide: configuring-card-filters-ecde99f.md

**LANGUAGE**: XML

**CODE**:
```xml
<!-- annotations.xml: SelectionVariant for default filtering -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="GWSAMPLE_BASIC.SalesOrder">
  <Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant">
    <Record Type="com.sap.vocabularies.UI.v1.SelectionVariant">
      <!-- Example: default filter CustomerID = 'ALFKI' -->
      <PropertyValue PropertyName="SelectOptions">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.SelectOption">
            <PropertyValue PropertyName="PropertyName" String="CustomerID"/>
            <PropertyValue PropertyName="Sign" EnumMember="com.sap.vocabularies.UI.v1.SelectionSignType/I"/>
            <PropertyValue PropertyName="Option" EnumMember="com.sap.vocabularies.UI.v1.SelectionOptionType/EQ"/>
            <PropertyValue PropertyName="Low" String="ALFKI"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: JSON

**CODE**:
```json
// Example: pass filter via card URL or application URL (client-side filtering)
{
  "url": "/sap/opu/odata/sap/GWSAMPLE_BASIC/SalesOrderSet?$filter=CustomerID eq 'ALFKI'"
}
```

---

**STEP**: 4 — Configure Sorting (and Grouping) in Application Descriptor

**DESCRIPTION**: Configure default sorting for the table card in the application descriptor (manifest.json). Add sortBy and sortOrder to the card settings (replace property names and card type as needed). Grouping behavior is typically driven by annotations or card settings in the descriptor — check your card/card type documentation.

**LANGUAGE**: JSON

**CODE**:
```json
/* manifest.json (application descriptor) - sample card settings */
{
  "sap.card": {
    "type": "sap.ovp.cards.table",
    "settings": {
      "entitySet": "SalesOrder",
      "annotationPath": "com.sap.vocabularies.UI.v1.LineItem",
      "sortBy": "SalesOrderID",
      "sortOrder": "desc" /* or "asc" */
    }
  }
}
```

**STEP**: References

**DESCRIPTION**: Link to related documentation for deeper configuration details.

**LANGUAGE**: Plain text

**CODE**:
```
- Configuring Card Filters: configuring-card-filters-ecde99f.md
- Configuring Sort Properties: configuring-sort-properties-41af842.md
```
--------------------------------

**TITLE**: Data Points — Add and Format Header Data Points for Fiori Elements Object Page

**INTRODUCTION**: Shows how to expose single data points (numeric or textual) in the Fiori Elements object page header using UI.ReferenceFacet referencing UI.DataPoint annotations. Includes XML, ABAP CDS and CAP CDS examples for creating reference facets, defining data points (including criticality), and controlling numeric decimal places via NumberFormat.NumberOfFractionalDigits.

**TAGS**: fiori-elements-framework, ui.datapoint, ui.referencefacet, annotations, cds, abap, cap, xml, numberformat, header

**STEP**: 1 — Add a Data Point to the Object Page Header via UI.ReferenceFacet

**DESCRIPTION**: Add entries to the UI.HeaderFacets annotation that reference UI.DataPoint qualifiers. You can reference a data point directly (e.g., @UI.DataPoint#Price) or via a navigation path (e.g., to_StockAvailability/@UI.DataPoint#StockAvailability). Place this annotation in the entity-level metadata where header facets are defined.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.HeaderFacets">
    <Collection>
        ...
        <Record Type="UI.ReferenceFacet">
            <!-- Direct qualifier reference -->
            <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Price" />
        </Record>
        ...
        <Record Type="UI.ReferenceFacet">
            <!-- Navigation path to a related type, then the DataPoint qualifier -->
            <PropertyValue Property="Target" AnnotationPath="to_StockAvailability/@UI.DataPoint#StockAvailability" />
        </Record>
        ...
    </Collection>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Facet: [
  {
    targetQualifier: 'Price',
    type: #DATAPOINT_REFERENCE,
    purpose: #HEADER
  },
  {
    targetQualifier: 'ProductCategory',
    type: #DATAPOINT_REFERENCE,
    purpose: #HEADER
  },
  {
    label: 'Employee',
    targetElement: 'TO_SUPPLIER',
    type: #CONTACT_REFERENCE,
    purpose: #HEADER
  }
]
product;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.HeaderFacets : [
    {
        $Type : 'UI.ReferenceFacet',
        Target : '@UI.DataPoint#Price'
    },
    {
        $Type : 'UI.ReferenceFacet',
        Target : '@UI.DataPoint#ProductCategory'
    },
    {
        $Type : 'UI.ReferenceFacet',
        Label : 'Employee',
        Target : 'to_Supplier/@Communication.Contact'
    }
]
```

**STEP**: 2 — Define UI.DataPoint Annotations (Qualifier required)

**DESCRIPTION**: Define each UI.DataPoint with a Qualifier. Provide Value (Path or expression), Title (string or i18n token), and optional Criticality or ValueFormat. The UI.DataPoint qualifier must match the reference used in UI.HeaderFacets.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Simple Price DataPoint -->
<Annotation Term="UI.DataPoint" Qualifier="Price">
    <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
        <PropertyValue Property="Value" Path="Price" />
        <PropertyValue Property="Title" String="Price" />
    </Record>
</Annotation>

<!-- StockAvailability with Criticality -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_StockAvailabilityType">
    <Annotation Term="UI.DataPoint" Qualifier="StockAvailability">
        <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
            <PropertyValue Property="Value" Path="StockAvailability" />
            <PropertyValue Property="Title" String="Availability" />
            <PropertyValue Property="Criticality" Path="StockAvailability" />
        </Record>
    </Annotation>
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.dataPoint: {
  title: 'Price'
}
Price;

@UI.dataPoint: {
  title: 'Category'
}
ProductCategory;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.DataPoint #Price : {
    Value : Price,
    Title : 'Price'
},
UI.DataPoint #ProductCategory : {
    Value : ProductCategory,
    Title : 'Category'
}
```

**STEP**: 3 — Control Decimal Places for Numerical Data Points (NumberFormat.NumberOfFractionalDigits)

**DESCRIPTION**: For numeric data points you can override the default scale/precision display by adding a ValueFormat using UI.NumberFormat and setting NumberOfFractionalDigits. The examples below show how to set NumberOfFractionalDigits in XML, ABAP CDS and CAP CDS. Example table shows how NumberOfFractionalDigits affects displayed decimals (given metadata Scale=3, Precision=15).

- If NumberOfFractionalDigits is undefined, UI displays scale metadata (3 decimals in the example).
- If NumberOfFractionalDigits is provided, UI displays that many decimals subject to precision/metadata constraints (see examples).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Weight">
    <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
        <PropertyValue Property="Value" Path="Weight" />
        <PropertyValue Property="Title" String="Weight" />
        <PropertyValue Property="ValueFormat">
            <Record Type="com.sap.vocabularies.UI.v1.NumberFormat">
                <PropertyValue Property="NumberOfFractionalDigits" Int="5"/>
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.dataPoint: {
  title: 'Weight',
  valueFormat: {
    numberOfFractionalDigits: 5
  }
}
Weight;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.DataPoint #Weight : {
    $Type : 'UI.DataPointType',
    Value : Weight,
    Title : 'Weight',
    ValueFormat : {
        $Type : 'UI.NumberFormat',
        NumberOfFractionalDigits : 5
    }
}
```

**STEP**: 4 — Examples: Effect of NumberOfFractionalDigits (Scale = 3, Precision = 15)

**DESCRIPTION**: Concrete examples showing how NumberOfFractionalDigits influences displayed decimal places for numeric data points. Use these examples to test or document expected UI rounding/truncation behavior.

**LANGUAGE**: JSON

**CODE**:
```json
[
  { "ScaleMetadata": 3, "PrecisionMetadata": 15, "NumberOfFractionalDigits": "undefined", "UI_DecimalPlaces": 3 },
  { "ScaleMetadata": 3, "PrecisionMetadata": 15, "NumberOfFractionalDigits": 5, "UI_DecimalPlaces": 5 },
  { "ScaleMetadata": 3, "PrecisionMetadata": 15, "NumberOfFractionalDigits": 1, "UI_DecimalPlaces": 1 },
  { "ScaleMetadata": 3, "PrecisionMetadata": 15, "NumberOfFractionalDigits": 20, "UI_DecimalPlaces": 14 },
  { "ScaleMetadata": 3, "PrecisionMetadata": 15, "NumberOfFractionalDigits": 0, "UI_DecimalPlaces": 3 }
]
```
--------------------------------

**TITLE**: Defining Actions in the Chart Toolbar

**INTRODUCTION**: Add action buttons to Fiori Elements chart toolbars by defining the Actions collection inside the UI.Chart annotation. Supported action types: UI.DataFieldForAction and UI.DataFieldForIntentBasedNavigation. This guide provides ready-to-use XML, ABAP CDS, and CAP CDS examples and actionable rules for visibility and enablement (OData V2 and V4).

**TAGS**: fiori-elements-framework, UI.Chart, DataFieldForAction, DataFieldForIntentBasedNavigation, annotations, XML, CDS, ABAP, CAP, ODataV2, ODataV4

**STEP**: 1 — Rules and requirements for chart toolbar actions

**DESCRIPTION**: Key rules to apply before adding actions:
- The Actions property must be a collection of UI.DataFieldForAction and UI.DataFieldForIntentBasedNavigation records.
- To make a button visible in the chart toolbar, the Determining and Inline properties (if present) MUST be false or omitted.
- UI.DataFieldForAction-based chart actions do NOT support passing of context.
- For UI.DataFieldForIntentBasedNavigation, use RequiresContext to control whether a selection is required (default = true).
- When using path-based visibility/enablement (applicable-path or OperationAvailable), the property path must reference a property on the parent entity set — not the chart entity set.

**LANGUAGE**: Text

**CODE**:
```
Visibility & behavior summary:
- Types allowed in UI.Chart.Actions: UI.DataFieldForAction, UI.DataFieldForIntentBasedNavigation
- Visibility requirement: Determining = false AND Inline = false (or these properties absent)
- DataFieldForAction: no context can be passed
- DataFieldForIntentBasedNavigation: set RequiresContext = false to always enable the button; default is true (selection required)
- Path-based checks (applicable-path / OperationAvailable): path must point to parent entity set property
```

**STEP**: 2 — XML Annotation example (annotations.xml)

**DESCRIPTION**: Add the Actions collection into a UI.Chart annotation in your annotations XML file (e.g., annotations.xml). Replace provide_label, provide_action_name, and provide_semantic_object with your values. Ensure Determining and Inline are not set or are false.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- annotations.xml -->
<Annotation Term="UI.Chart">
    <Record>
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>product</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>sales</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Actions">
            <Collection>
                <!-- Action that triggers an application action (no context can be passed) -->
                <Record Type="UI.DataFieldForAction">
                    <PropertyValue Property="Label" String="provide_label"/>
                    <PropertyValue Property="Action" String="provide_action_name"/>
                    <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/Isolated"/>
                    <!-- Do NOT set Determining or Inline to true; omit or set to false -->
                </Record>

                <!-- Intent-based navigation action -->
                <Record Type="UI.DataFieldForIntentBasedNavigation">
                    <PropertyValue Property="Label" String="provide_label"/>
                    <PropertyValue Property="SemanticObject" String="provide_semantic_object"/>
                    <PropertyValue Property="Action" String="provide_action_name"/>
                    <!-- Optional: user must select an item first (default true).
                         To allow action without selection, set RequiresContext to false -->
                    <PropertyValue Property="RequiresContext" Bool="false"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 3 — ABAP CDS Annotation example

**DESCRIPTION**: Place this annotation block in your ABAP CDS view source where you annotate the view (e.g., annotate view <VIEW_NAME> with { ... }). Replace placeholders with your real fields and actions.

**LANGUAGE**: ABAP

**CODE**:
```abap
@UI.Chart: [
  {
    chartType: #COLUMN,
    dimensions: [
      'PRODUCT'
    ],
    measures: [
      'SALES'
    ],
    actions: [
      {
        label: 'provide_label',
        dataAction: 'PUSHDOWN:provide_action_name',    // action name; PUSHDOWN example
        invocationGrouping: #ISOLATED,
        type: #FOR_ACTION
      },
      {
        label: 'provide_label',
        semanticObjectAction: 'provide_action_name',   // intent-based navigation
        type: #FOR_INTENT_BASED_NAVIGATION
        // Note: RequiresContext control for intent-based navigation is handled via metadata/service or UI settings
      }
    ]
  }
]
annotate view STTA_C_MP_PRODUCTSALESDATA with {

}
```

**STEP**: 4 — CAP CDS Annotation example

**DESCRIPTION**: Use this format when authoring in CAP CDS (annotations file). Replace entity fields and action names accordingly. The $Type indicates the annotation record type.

**LANGUAGE**: CDS

**CODE**:
```cds
// place inside the entity annotations in a .cds file or annotations.cds
UI.Chart : {
    ChartType : #Column,
    Dimensions : [
        product
    ],
    Measures : [
        sales
    ],
    Actions : [
        {
            $Type : 'UI.DataFieldForAction',
            Label : 'provide_label',
            Action : 'provide_action_name',
            InvocationGrouping : #Isolated
            // Determining and Inline: do not set or set to false
        },
        {
            $Type : 'UI.DataFieldForIntentBasedNavigation',
            Label : 'provide_label',
            SemanticObject : 'provide_semantic_object',
            Action : 'provide_action_name',
            // To allow without selection: RequiresContext : false  (if supported in your annotation processing)
        }
    ]
}
```

**STEP**: 5 — Enable/disable actions for OData V2 (intent-based navigation)

**DESCRIPTION**: For DataFieldForIntentBasedNavigation, control whether a selection is required using RequiresContext:
- RequiresContext = true (default): user must select an item in the chart before action is enabled.
- RequiresContext = false: button always enabled.
When using path-based applicable-path to control visibility, ensure the property path is from the parent entity set.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: RequiresContext false (no selection required) -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
    <PropertyValue Property="Label" String="Open Details"/>
    <PropertyValue Property="SemanticObject" String="Product"/>
    <PropertyValue Property="Action" String="display"/>
    <PropertyValue Property="RequiresContext" Bool="false"/>
</Record>
```

**STEP**: 6 — Enable/disable actions for OData V4 (use OperationAvailable / Operation enablement approach)

**DESCRIPTION**: For OData V4, use the "Enablement of Operations" approach (same concept as tables) to enable/disable actions based on selected context. When using path-based OperationAvailable settings to control visibility/enablement, the property must be on the parent entity set (not the chart entity set). Refer to your Fiori Elements docs for "Adding Actions to Tables — Enablement of Operations" to implement OperationAvailable expressions or manifest-based adaptation.

**LANGUAGE**: Text

**CODE**:
```
Guidance:
- Implement the OperationAvailable (path-based) mechanism described in "Adding Actions to Tables" under OData V4.
- Ensure the path referenced by OperationAvailable is a property on the parent entity set.
- This mechanism allows context-dependent enable/disable of chart toolbar actions.
```
--------------------------------

**TITLE**: Defining and Adapting Object Page Sections (UI.Facets) — Code-focused Guide

**INTRODUCTION**: This document provides actionable, code-centered examples and rules to define object page sections and subsections using com.sap.vocabularies.UI.v1.Facets (XML / ABAP CDS / CAP CDS), manifest.json settings for section layout and SmartForm column layout, and runtime behavior differences between OData V2 and V4. Use these snippets directly in annotation files or CDS sources and manifest configuration.

**TAGS**: Fiori Elements, Object Page, UI.Facets, CollectionFacet, ReferenceFacet, manifest.json, CDS, CAP, XML, OData V2, OData V4

STEP: 1 — Basic: Define top-level sections with ReferenceFacet and CollectionFacet (XML)
DESCRIPTION: Create an object page section using UI.Facets. Use UI.ReferenceFacet for a single reference (field group, identification, chart, line item) and UI.CollectionFacet to group multiple reference facets (a section with subsections). Avoid using a CollectionFacet under UI.Facets if it contains only one ReferenceFacet (use ReferenceFacet instead).
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Facets">
  <Collection>
    <!-- Reference facet -> top-level section pointing to a field group -->
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="{@i18n>@GeneralInfoFacetLabel}"/>
      <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#GeneralInformation" />
    </Record>

    <!-- Collection facet -> top-level section with nested facets -->
    <Record Type="UI.CollectionFacet">
      <PropertyValue Property="ID" String="FurtherData"/>
      <PropertyValue Property="Label" String="{@i18n>@FurtherData}"/>
      <PropertyValue Property="Facets">
        <Collection>
          <!-- second-level facets go here (ReferenceFacet or CollectionFacet) -->
          <Record Type="UI.CollectionFacet">
            <!-- Subsection definition (empty here as placeholder) -->
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Collection>
</Annotation>
```

STEP: 2 — Basic: Define facets in ABAP CDS (equivalent)
DESCRIPTION: Use @UI.Facet to define collection and reference facets in ABAP CDS. Provide id for collection facets for stable IDs.
LANGUAGE: ABAP CDS
CODE:
```
@UI.Facet: [
  {
    label: '{@i18n>@GeneralInfoFacetLabel}',
    targetQualifier: 'GeneralInformation',
    type: #FIELDGROUP_REFERENCE,
    purpose: #STANDARD
  },
  {
    id: 'FurtherData',
    label: '{@i18n>@FurtherData}',
    type: #COLLECTION,
    purpose: #STANDARD
  },
  {
    parentId: 'FurtherData',
    purpose: #STANDARD
  }
]
define view entity product { ... };
```

STEP: 3 — Basic: Define facets in CAP CDS (equivalent)
DESCRIPTION: CAP CDS JSON-style annotations: ReferenceFacet and nested CollectionFacet.
LANGUAGE: CDS
CODE:
```
UI.Facets : [
  {
    $Type : 'UI.ReferenceFacet',
    Label : '{@i18n>@GeneralInfoFacetLabel}',
    Target : '@UI.FieldGroup#GeneralInformation'
  },
  {
    $Type : 'UI.CollectionFacet',
    ID : 'FurtherData',
    Label : '{@i18n>@FurtherData}',
    Facets : [
      {
        $Type : 'UI.CollectionFacet'
      }
    ]
  }
]
```

STEP: 4 — Create a subsection (XML) and nesting rules
DESCRIPTION: To create a subsection, add a CollectionFacet under a top-level CollectionFacet and then add ReferenceFacet(s) or CollectionFacet(s) under it. Note: UI.CollectionFacet at third level and beyond is ignored. For OData V2, reference facets outside a second-level collection facet are ignored; for OData V4 they are shown as separate subsections.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Facets">
  <Collection>
    <Record Type="UI.CollectionFacet">
      <PropertyValue Property="ID" String="TopSection"/>
      <PropertyValue Property="Label" String="Top Section"/>
      <PropertyValue Property="Facets">
        <Collection>
          <!-- second-level collection facet => defines subsections -->
          <Record Type="UI.CollectionFacet">
            <PropertyValue Property="ID" String="SubSection1"/>
            <PropertyValue Property="Label" String="Sub Section 1"/>
            <PropertyValue Property="Facets">
              <Collection>
                <!-- reference facets arranged beside each other in this collection -->
                <Record Type="UI.ReferenceFacet">
                  <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#GroupA"/>
                </Record>
                <Record Type="UI.ReferenceFacet">
                  <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#GroupB"/>
                </Record>
              </Collection>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Collection>
</Annotation>
```

STEP: 5 — Render a table in a section (XML)
DESCRIPTION: To render a table inside a section, reference UI.LineItem or a (Selection)PresentationVariant whose first visualization is UI.LineItem. For OData V4, UI.SelectionPresentationVariant is supported. Use ReferenceFacet.Target annotationPath to point to the LineItem or SelectionPresentationVariant.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Facets">
  <Collection>
    <!-- Section containing a reference to a LineItem (table) -->
    <Record Type="UI.CollectionFacet">
      <PropertyValue Property="ID" String="FacetIdentifier1"/>
      <PropertyValue Property="Label" String="Section 1"/>
      <PropertyValue Property="Facets">
        <Collection>
          <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="ID" String="FacetIdentifier2"/>
            <PropertyValue Property="Target" AnnotationPath="_Child/@UI.LineItem"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>

    <!-- Section using a SelectionPresentationVariant that contains a PresentationVariant whose first visualization is UI.LineItem -->
    <Record Type="UI.CollectionFacet">
      <PropertyValue Property="ID" String="FacetIdentifier2"/>
      <PropertyValue Property="Label" String="Section 2"/>
      <PropertyValue Property="Facets">
        <Collection>
          <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="ID" String="FacetIdentifier2"/>
            <PropertyValue Property="Target" AnnotationPath="_Child/@UI.SelectionPresentationVariant#mySPV"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Collection>
</Annotation>
```

STEP: 6 — Render a table in a section (CAP CDS)
DESCRIPTION: Equivalent CAP CDS definition pointing Target to LineItem or SelectionPresentationVariant.
LANGUAGE: CDS
CODE:
```
Facets : [
  {
    $Type : 'UI.CollectionFacet',
    ID    : 'FacetIdentifier1',
    Label : 'Section 1',
    Facets: [{
      $Type : 'UI.ReferenceFacet',
      ID    : 'FacetIdentifier2',
      Target: '_Child/@UI.LineItem'
    }]
  },
  {
    $Type : 'UI.CollectionFacet',
    ID    : 'FacetIdentifier2',
    Label : 'Section 2',
    Facets: [{
      $Type : 'UI.ReferenceFacet',
      ID    : 'FacetIdentifier2',
      Target: '_Child/@UI.SelectionPresentationVariant#mySPV'
    }]
  }
]
```

STEP: 7 — Conditionally hide/show sections (XML, ABAP CDS, CAP CDS)
DESCRIPTION: Use UI.Hidden on a ReferenceFacet to hide the whole section based on a property (boolean or path). Examples for XML, ABAP CDS and CAP CDS are shown.
LANGUAGE: XML
CODE:
```xml
<Record Type="UI.ReferenceFacet">
  <Annotation Term="UI.Hidden" Path="IsActiveEntity"/>
  <PropertyValue Property="Label" String="{@i18n>@SalesData}" />
  <PropertyValue Property="Target" AnnotationPath="to_ProductSalesData/@UI.Chart" />
</Record>
```
LANGUAGE: ABAP CDS
CODE:
```
@UI.facet: [
 {
  label: '{@i18n>@SalesData}',
  type:         #DATAPOINT_REFERENCE,
  targetElement: '_PRODUCTSALESDATA',
  purpose: #STANDARD
 }
]
define view entity product { ... };
```
LANGUAGE: CDS
CODE:
```
UI.Facets : {
  $Type : 'UI.ReferenceFacet',
  Label : '{@i18n>@SalesData}',
  Target : 'to_ProductSalesData/@UI.Chart',
  ![@UI.Hidden] : IsActiveEntity
}
```

STEP: 8 — IDs for collection facets and stable IDs guidance
DESCRIPTION: Always define ID for UI.CollectionFacet for stable view/control IDs to enable extensions, personalization, and automated testing. Use camelCase without spaces. If you didn't define an ID for a ReferenceFacet, its derived ID is annotationPath with '/@' replaced by '::' (e.g., to_ProductText::com.sap.vocabularies.UI.v1.LineItem). Do not add an ID after delivering the app because stable derived IDs are used for controls.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Facets">
  <Collection>
    <Record Type="UI.CollectionFacet">
      <PropertyValue Property="ID" String="GeneralInformation"/>
    </Record>
  </Collection>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```
@UI.Facet: [
  {
    id: 'GeneralInformation',
    type: #COLLECTION,
    purpose: #STANDARD
  }
]
define view entity product { ... };
```
LANGUAGE: CDS
CODE:
```
UI.Facets : [
  {
    $Type : 'UI.CollectionFacet',
    ID : 'GeneralInformation'
  }
]
```

STEP: 9 — Section layout: Page vs Tabs (manifest.json)
DESCRIPTION: Choose "Tabs" to render top-level sections as tabs. Default is "Page" (all sections on one page and anchor navigation). Configure sectionLayout via sap.ui.generic.app component options for the object page component.
LANGUAGE: JSON
CODE:
```json
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "contextPath": "/SalesOrderManage",
      "navigation": { /* ... */ },
      "sectionLayout": "Tabs"   /* Possible values: "Page" (default) or "Tabs" */
    }
  }
}
```

STEP: 10 — SmartForm column layout and responsive grid (manifest.json)
DESCRIPTION: Change default SmartForm column layout (6 columns on XL) and switch SmartForm to responsive grid by useColumnLayoutForSmartForm=false. Use objectPageColumns.screenSizeXL to set 4 columns.
LANGUAGE: JSON
CODE:
```json
"sap.ui.generic.app": {
  "settings": {
    "objectPageColumns": {
      "screenSizeXL": 4
    },
    "useColumnLayoutForSmartForm": false
  }
}
```

STEP: 11 — Runtime behaviors & rendering notes (actionable rules)
DESCRIPTION: Follow these implementation rules and runtime behaviors:
- OData V2: Reference facets that are outside a second-level collection facet are ignored. If no second-level collection facet exists, all reference facets are considered.
- OData V4: Reference facets outside a second-level collection facet are considered and shown as separate subsections.
- UI.CollectionFacet beyond second level (third level and deeper) is ignored.
- Do not use a CollectionFacet under UI.Facets that contains only one ReferenceFacet — use ReferenceFacet directly to avoid rendering issues.
- In OData V4: If a ReferenceFacet uses a chart or table, ensure it’s the only content (no sibling ReferenceFacet) to avoid rendering issues.
- Section titles must not contain commas (commas are delimiters for backend message grouping).
- When using an icon tab bar for sections: section titles are not displayed in the content area. With anchor bar: only the first top-level section title is hidden in content area.
- For Page layout: if a section/subsection contains only a single control (table or chart), the section/subsection title is hidden and control title is replaced by the section title. In Tabs mode, this applies only to subsections. In OData V2, special logic is not invoked if multiple controls are configured but only one is visible at runtime due to visibility rules.

STEP: 12 — Increased section/table height behavior
DESCRIPTION: When an object page contains only a single section with a single table (or uses icon tab bar and a section has only one table) the section and table expand:
- ui.table -> section/table use full page height (more rows visible).
- sap.m.Table -> section/table expand to show 20 rows.
LANGUAGE: Text
CODE:
```text
// No code required. Implementation note: UI runtime adapts heights automatically based on table type and page layout.
```

STEP: 13 — Accessibility note: TextArea label handling
DESCRIPTION: If a UI.FieldGroup contains only a single UI.MultiLineText property (TextArea) and no other controls, the TextArea label is hidden and the section title serves as the label. Still provide a meaningful TextArea label for screen readers.
LANGUAGE: Text
CODE:
```text
// Ensure TextArea control has a meaningful label even if hidden visually for screen reader compatibility.
```

Step: 14 — Useful constraints and best practices (compact)
DESCRIPTION: Quick rules to follow when authoring:
- Use meaningful and unique camelCase IDs for collection facets.
- Avoid adding IDs after app delivery (stable IDs are used to build control IDs).
- Do not nest CollectionFacet beyond second level.
- For tables, ensure InsertRestrictions Insertable = true on the entityset to enable Create/InlineCreate if required.
LANGUAGE: Text
CODE:
```text
// Example: enable insert (OData capability) at service/backend metadata level:
// Org.OData.Capabilities.V1.InsertRestrictions/Insertable = true
```
--------------------------------

**TITLE**: Defining Custom Actions for Analytical List Page (ALP) in SAP Fiori elements (OData V2)

**INTRODUCTION**: This document shows how to declare custom actions for the Analytical List Page (ALP) via the app descriptor (manifest.json) and how to implement the corresponding controller extension handlers. It includes examples for global actions, table/chart toolbar actions, keyboard shortcut mapping via sap.ui.commands, using extensionAPI.getSelectedContexts(), and invoking backend actions via extensionAPI.invokeActions().

**TAGS**: fiori-elements, analytical-list-page, OData V2, manifest.json, sap.ui5, extensionAPI, custom-actions, sap.ui.commands, controllerExtensions

**STEP**: 1 — Add custom action definitions and command shortcut in manifest.json

**DESCRIPTION**: Add entries under sap.ui5 → extends → extensions to:
- map keyboard shortcuts with sap.ui.commands (keyed by the ALP instance id)
- extend the ALP controller with a custom controller file
- declare Actions under sap.ui.generic.app → <EntitySet> with properties: id, text, press, global, filter (chart/table), requiresSelection, determining, command (optional)

Place this snippet into webapp/manifest.json (merge into existing sap.ui5 block). Ensure the EntitySet name matches your ALP main entity set.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "_version": "1.1.0",
    "extends": {
      "extensions": {
        "sap.ui.commands": {
          "sap.suite.generic.template.AnalyticalListPage#sap.suite.generic.template.AnalyticalListPage::ZCostCenterCostQuery0020": {
            "GlobalActionCommand": {
              "shortcut": "Ctrl+B"
            }
          }
        },
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
            "controllerName": "my_app.ext.controller.AnalyticalListPageExt",
            "sap.ui.generic.app": {
              "ZCostCenterCostQuery0020": {
                "EntitySet": "ZCostCenterCostQuery0020",
                "Actions": {
                  "Action A": {
                    "id": "ActionA",
                    "text": "{{Action A}}",
                    "press": "onClickActionA",
                    "global": true,
                    "command": "GlobalActionCommand"
                  },
                  "Action B": {
                    "id": "ActionB_requiresSelection",
                    "text": "{{Action B}}",
                    "press": "onClickActionB",
                    "filter": "table",
                    "requiresSelection": true
                  },
                  "Action C": {
                    "id": "ActionC_requiresSelection",
                    "text": "{{Action C}}",
                    "press": "onClickActionC",
                    "filter": "chart",
                    "requiresSelection": true
                  },
                  "Action D": {
                    "id": "ActionD",
                    "text": "{{Action D}}",
                    "press": "onClickActionD",
                    "filter": "table"
                  },
                  "Action E": {
                    "id": "ActionE",
                    "text": "{{Action E}}",
                    "press": "onClickActionE",
                    "filter": "chart"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Implement ALP controller extension with action handlers

**DESCRIPTION**: Create the custom controller specified in manifest.controllerName (webapp/extension/my_app/ext/controller/AnalyticalListPageExt.js). Use extensionAPI.getSelectedContexts() synchronously to fetch selected contexts and pass them into confirmation logic. For chart toolbar actions, pass the event id into getSelectedContexts(...) to retrieve the correct selection. Use extensionAPI.invokeActions(path, contexts, parameters) to call backend actions.

Import sap/m/MessageBox for confirmation dialogs and use this.extensionAPI inside handlers.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/extension/my_app/ext/controller/AnalyticalListPageExt.js
sap.ui.define(["sap/m/MessageBox"], function (MessageBox) {
  "use strict";

  return {
    /* Optional hooks called by ALP */
    onBeforeRebindTableExtension: function (oEvent) {
      console.log("onBeforeRebindTableExtension called!");
    },

    onBeforeRebindChartExtension: function (oEvent) {
      console.log("onBeforeRebindChartExtension called!");
    },

    /* Global action (mapped to keyboard shortcut via sap.ui.commands) */
    onClickActionA: function () {
      console.log("Global Action Shortcut Key triggers");
      MessageBox.alert("Global Action A clicked or triggered by shortcut.");
    },

    /* Table toolbar action that requires selection */
    onClickActionB: function () {
      // getSelectedContexts must be called synchronously (cached result)
      var aContexts = this.extensionAPI.getSelectedContexts();

      MessageBox.confirm("Would you like to perform the action?", {
        title: "Confirm",
        actions: [MessageBox.Action.OK, MessageBox.Action.CANCEL],
        emphasizedAction: MessageBox.Action.OK,
        onClose: this.onActionConfirm.bind(this, aContexts)
      });
    },

    onActionConfirm: function (aContexts, sAction) {
      if (sAction === sap.m.MessageBox.Action.OK) {
        // invoke server-side action; path can be relative (service/action) or absolute
        this.extensionAPI.invokeActions("/ActionB", aContexts).then(function (oResult) {
          // handle result
          console.log("ActionB invoked, result:", oResult);
        });
      }
    },

    /* Chart toolbar action: pass event id to getSelectedContexts */
    onClickActionC: function (oEvent) {
      // For chart actions, pass the event id so the API returns correct selection
      var aContexts = this.extensionAPI.getSelectedContexts(oEvent.getId && oEvent.getId());
      MessageBox.alert("Action C (chart) clicked. Selected contexts count: " + (aContexts ? aContexts.length : 0));
    },

    onClickActionD: function () {
      MessageBox.alert("Action D (table) clicked.");
    },

    onClickActionE: function () {
      MessageBox.alert("Action E (chart) clicked.");
    }
  };
});
```

**STEP**: 3 — Example: invoking a backend OData action from an extension handler

**DESCRIPTION**: Use extensionAPI.invokeActions(servicePathOrActionName, aContexts, mParameters) to call backend actions. Pass selected contexts (if required) and action-specific parameters in mParameters.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example handler invoking a backend function/action with parameters
onClickInvokeBackendExample: function (oEvent) {
  var oApi = this.extensionAPI;
  var mParameters = {
    "SalesOrderID": "500000052"
  };

  // actionPath can be "<ServiceNamespace>/<ActionName>" or a relative action path
  oApi.invokeActions("STTA_SALES_ORDER_ND_SRV_01/AFF8CCF97ACESave_stta_i_so_salesorder_nd", [], mParameters)
    .then(function (oResult) {
      // success handling
      console.log("Backend action invoked, result:", oResult);
    })
    .catch(function (oError) {
      // error handling
      console.error("Error invoking backend action:", oError);
    });
}
```

**STEP**: 4 — Important integration notes and behavior

**DESCRIPTION**:
- This guidance is specific to SAP Fiori elements for OData V2 ALP.
- When you add a command under sap.ui.commands and reference it via the action "command" property, the event object delivered to the handler may differ; adjust code accordingly if you depend on oEvent.
- If multiple ALP views use different entity sets, define Actions only for the main EntitySet.
- Use only extensionAPI methods (this.extensionAPI) for safe integration with Fiori elements.
- For table actions that require selection, set requiresSelection: true (default true). For footer rendering use determining: true. Global actions use global: true.
--------------------------------

**TITLE**: Defining Determining Actions on the Object Page (Fiori Elements)

**INTRODUCTION**: This guide shows how to define DataFieldForAction annotations as determining actions for Fiori Elements object pages. Determining actions appear in the object page footer (only in edit mode). If Determining is absent or false, the action appears in the header. Footer actions must be hidden in display mode by adding a path-based UI.Hidden annotation.

**TAGS**: fiori-elements-framework, annotations, UI.DataFieldForAction, determining, object-page, CDS, XML, ABAP

**STEP**: 1 — XML annotations for Determining Actions on Object Page

**DESCRIPTION**: Add DataFieldForAction records inside the UI.Identification annotation. Set PropertyValue Determining Bool="true" to place the action in the page footer (edit mode). Keep UI.Identification as the vocabulary term defining object page actions.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.Identification">
  <Collection>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="CWP"/>
      <PropertyValue Property="Action"
        String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/
        STTA_C_MP_ProductCopywithparams"/>
    </Record>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy"/>
      <PropertyValue Property="Action"
        String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy"/>
      <PropertyValue Property="Determining" Bool="true"/>
      <!--
        Footer actions must not be available in display mode.
        Add the UI.Hidden annotation with a path-based expression here
        so the action is hidden in display mode (placeholder example):
        <Annotation Term="UI.Hidden">
          <Path>/* path expression that returns true when action should be hidden in display mode */</Path>
        </Annotation>
      -->
    </Record>
  </Collection>
</Annotation>
```

**STEP**: 2 — ABAP CDS annotation for Determining Actions

**DESCRIPTION**: Use @UI.identification on the entity field in ABAP CDS to declare DataFieldForAction equivalent entries. Set determining: true for actions to appear in the footer (edit mode). Add a UI.Hidden annotation (path-based) to ensure the footer action is not available in display mode (example shown as placeholder comment).

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.identification: [
  {
    label: 'CWP',
    dataAction: 'PUSHDOWN: STTA_C_MP_ProductCopywithparams ',
    type: #FOR_ACTION,
    position: 1
  },
  {
    label: 'Copy',
    dataAction: 'PUSHDOWN: STTA_C_MP_ProductCopy',
    type: #FOR_ACTION,
    determining: true,
    position: 2
    // Add a UI.Hidden path-based annotation here to hide in display mode (placeholder):
    // @UI.hidden: '<path-based expression that evaluates to true in display mode>'
  }
]
product;
```

**STEP**: 3 — CAP CDS annotation for Determining Actions

**DESCRIPTION**: In CAP CDS, declare UI.Identification as a list of UI.DataFieldForAction records. Use Determining : true to mark footer actions. Add a UI.Hidden annotation with a path-based expression to hide the action in display mode (placeholder usage provided).

**LANGUAGE**: CDS

**CODE**:
```cds
UI.Identification : [
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'CWP',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/
    STTA_C_MP_ProductCopywithparams'
  },
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'Copy',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy',
    Determining : true
    // Add UI.Hidden with a path-based expression to hide in display mode:
    // e.g. UI.Hidden : { $Path : '<path-expression-that-is-true-in-display-mode>' }
  }
]
```

**STEP**: 4 — Behavior and implementation notes

**DESCRIPTION**: Key behavioral rules and implementation tips for code generation:
- Vocabulary term: Use UI.Identification to define actions on the object page.
- Placement:
  - DataFieldForAction with Determining = true -> appears in the object page footer (edit mode only).
  - Determining absent or false -> action appears in the object page header.
- Visibility: Footer actions must not be available in display mode. Add a UI.Hidden annotation with an appropriate path-based expression (application-specific) to hide the action when the page is in display mode.
- When generating code, ensure:
  - Actions targeted for the footer include Determining true.
  - Add the UI.Hidden path-based annotation (replace the placeholder path expression with your app’s condition for display mode).
  - Keep action strings using the full entity/action path as shown in samples (e.g., STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy).

**CODE**:
```text
Behavior summary (pseudocode/template for generator):

- For each action:
  if action.isDetermining == true:
    annotate as UI.DataFieldForAction with Determining = true
    annotate UI.Hidden with path-based expression to hide in display mode
  else:
    annotate as UI.DataFieldForAction without Determining (appears in header)
```
--------------------------------

**TITLE**: Defining Determining Actions in List Reports (OData V2)

**INTRODUCTION**: Shows how to add determining action buttons to the footer of a Fiori elements List Report (smart table) by using UI.LineItem annotations. Includes examples for backend actions (DataFieldForAction) and intent-based navigation (DataFieldForIntentBasedNavigation). Applicable only to SAP Fiori elements for OData V2. Note: feature is deprecated — use only for compatibility.

**TAGS**: fiori-elements-framework, odata-v2, annotations, list-report, UI.LineItem, DataFieldForAction, DataFieldForIntentBasedNavigation, determining-action, deprecated

**STEP**: 1 — Applicability and recommendation

**DESCRIPTION**: Confirm applicability and the recommended usage. This feature applies only to SAP Fiori elements for OData V2 and is deprecated. Prefer not to introduce new determining actions in new solutions.

**LANGUAGE**: Text

**CODE**:
```text
Applicability: SAP Fiori elements for OData V2 only.
Recommendation: Deprecated — avoid using determining actions for new implementations.
```

**STEP**: 2 — Types of determining actions

**DESCRIPTION**: Determine which type you need. Two supported complex types:
- DataFieldForAction: triggers a back-end OData call (Function, FunctionImport, Action, ActionImport).
- DataFieldForIntentBasedNavigation: triggers intent-based navigation via a SemanticObject/Action.

Set the Determining property to true on the complex type to place the action in the list report footer.

**LANGUAGE**: Text

**CODE**:
```text
- Use UI.DataFieldForAction for server-side OData operations.
- Use UI.DataFieldForIntentBasedNavigation for intent-based navigation.
- Set PropertyValue Property="Determining" Bool="true" on the Record in UI.LineItem to move the action to the footer.
```

**STEP**: 3 — Add determining actions to UI.LineItem (XML annotation example)

**DESCRIPTION**: Add UI.LineItem annotation to your annotations file (e.g., annotations.xml or embedded metadata annotations). Use Record elements with Type="UI.DataFieldForAction" or Type="UI.DataFieldForIntentBasedNavigation". Include Label, Action (or SemanticObject + Action for intent navigation), optionally InvocationGrouping, and set Determining to Bool="true" for footer placement.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.LineItem">
  <Collection>
    <!-- Backend action that appears in the smart table toolbar (no Determining property) -->
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy with new Supplier"/>
      <PropertyValue Property="Action"
                     String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopywithparams"/>
      <PropertyValue Property="InvocationGrouping"
                     EnumMember="UI.OperationGroupingType/Isolated"/>
    </Record>

    <!-- Backend action that appears in the footer (Determining = true) -->
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy"/>
      <PropertyValue Property="Action"
                     String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy"/>
      <PropertyValue Property="Determining" Bool="true"/>
      <PropertyValue Property="InvocationGrouping"
                     EnumMember="UI.OperationGroupingType/Isolated"/>
    </Record>

    <!-- Intent-based navigation that appears in the footer (Determining = true) -->
    <Record Type="UI.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="Label" String="Manage Products (ST)"/>
      <PropertyValue Property="SemanticObject" String="EPMProduct"/>
      <PropertyValue Property="Action" String="manage_st"/>
      <PropertyValue Property="Determining" Bool="true"/>
    </Record>
  </Collection>
</Annotation>
```

**STEP**: 4 — Behavior summary and placement rules

**DESCRIPTION**: Use these quick rules when authoring annotations:
- If Record has Determining Bool="true" (for DataFieldForAction or DataFieldForIntentBasedNavigation) → action appears in the list report footer.
- If Determining is missing or Bool="false" → action appears in the smart table toolbar.
- Use InvocationGrouping to control grouping behavior for backend actions (e.g., UI.OperationGroupingType/Isolated).

**LANGUAGE**: Text

**CODE**:
```text
Rules:
- Determining = true  => footer action (row/context based)
- Determining missing => toolbar action
- InvocationGrouping controls execution grouping (e.g., Isolated)
```
--------------------------------

**TITLE**: Defining Filter Facets for Fiori Elements Filter Bars

**INTRODUCTION**: Show how to define UI.FilterFacets and UI.FieldGroup annotations to control filter groups in Fiori elements filter bars. Includes XML, ABAP CDS, and CAP CDS code examples and guidance on grouping logic (Basic Group, Field Group, Entity Type Name Group). Use these annotations in your annotation file (e.g., annotations.xml), ABAP CDS view, or CAP CDS annotation files.

**TAGS**: fiori-elements, UI.FilterFacets, UI.FieldGroup, UI.SelectionFields, filter, OData V2, ABAP CDS, CAP CDS, XML, annotations

STEP: 1 — Add UI.FilterFacets (XML annotation)
DESCRIPTION: Add a UI.FilterFacets annotation to the target entity type to display filter groups (ReferenceFacet) in the filter bar / Adapt Filters dialog. Place this in your annotations.xml or local annotation file for the service.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType">
   <Annotation Term="UI.FilterFacets">
      <Collection>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#MyFilterGroup"/>
            </Record>
      </Collection>
   </Annotation>
</Annotations>
```

STEP: 2 — Add UI.FilterFacets (ABAP CDS annotation)
DESCRIPTION: Use ABAP CDS annotate view to attach a ReferenceFacet to the entity view. This example attaches a FILTER-purpose facet with qualifier MyFilterGroup.
LANGUAGE: ABAP
CODE:
```abap
annotate view STTA_C_MP_SUPPLIERTYPE with {
  @UI.Facet: [
    {
      targetQualifier: 'MyFilterGroup',
      type: #FIELDGROUP_REFERENCE,
      purpose: #FILTER
    }
  ]
  Supplier; 
}
```

STEP: 3 — Add UI.FilterFacets (CAP CDS annotation)
DESCRIPTION: In CAP CDS, declare UI.FilterFacets as an annotation with a ReferenceFacet. The Target value can point to a FieldGroup qualifier of an association or the current entity.
LANGUAGE: CAP CDS
CODE:
```cds
@UI.FilterFacets : [
    {
        $Type  : 'UI.ReferenceFacet',
        Target : '_SoldToParty/@UI.FieldGroup#MyFilterGroup'
    }
]
```

STEP: 4 — Define a UI.FieldGroup (XML)
DESCRIPTION: Define a FieldGroup that lists the filter fields and a label. Reference this FieldGroup from UI.FilterFacets using the qualifier.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="Group_Name">
    <Record>
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="Name"/>
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Label" String="Group Name"/>
    </Record>
</Annotation>
```

STEP: 5 — Define a UI.FieldGroup (ABAP CDS)
DESCRIPTION: Define a FieldGroup in ABAP CDS and assign it to a property. Use qualifier and groupLabel to identify the group.
LANGUAGE: ABAP
CODE:
```abap
@UI.fieldGroup: [{ qualifier: 'Group Name', groupLabel: 'Group Name' }]
PROPERTY_NAME;
```

STEP: 6 — Define a UI.FieldGroup (CAP CDS)
DESCRIPTION: CAP CDS FieldGroup definition showing Data (UI.DataField) and Label. Reference with qualifier #GroupName.
LANGUAGE: CAP CDS
CODE:
```cds
UI.FieldGroup #GroupName : {
    Data : [
        {
            $Type : 'UI.DataField',
            Value : PropertyName
        }
    ],
    Label : 'Group Name'
}
```

STEP: 7 — Make fields appear in the Basic group (UI.SelectionFields and _BASIC FieldGroup)
DESCRIPTION: Only fields that are part of UI.SelectionFields and mandatory filters appear by default in the filter bar. To ensure a FieldGroup is part of the Basic group, reference a FieldGroup with qualifier _BASIC in UI.FilterFacets. Also show a minimal UI.SelectionFields example.
LANGUAGE: XML
CODE:
```xml
<!-- Ensure selection fields appear in the filter bar (place under the entity annotations) -->
<Annotation Term="UI.SelectionFields">
  <Collection>
    <PropertyPath>Supplier</PropertyPath>
    <PropertyPath>Name</PropertyPath>
  </Collection>
</Annotation>

<!-- Reference a FieldGroup qualifier named _BASIC to include its fields in the Basic group -->
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="UI.FilterFacets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#_BASIC"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: 8 — Grouping logic summary and restriction
DESCRIPTION: Summary of how filter fields are grouped in Adapt Filters and restriction for availability.
LANGUAGE: text
CODE:
```
Grouping logic:
- Basic Group:
  - All fields listed in UI.SelectionFields.
  - All fields that are part of UI.FieldGroup with qualifier "_BASIC" when referenced via UI.FilterFacets.
- Field Group:
  - Fields that are part of a UI.FieldGroup (qualifier != "_BASIC") referenced by UI.FilterFacets but not part of UI.SelectionFields.
- Entity Type Name Group:
  - Fields not defined in UI.SelectionFields or any UI.FieldGroup are grouped into a group named by the entity type.
Restriction:
- This feature is available only in SAP Fiori elements for OData V2.
```
--------------------------------

**TITLE**: Defining Line Items (UI.LineItem) for Fiori Elements Tables

**INTRODUCTION**: Use the UI.LineItem annotation (com.sap.vocabularies.UI.v1.LineItem) to define table columns (line items) displayed by Fiori Elements List Report / Object Page table components. This document provides ready-to-use annotation examples in OData/XML, ABAP CDS, and CAP CDS formats, and explains key attributes that determine column name, order, and visibility.

**TAGS**: fiori-elements, ui.lineitem, annotations, annotations.xml, ABAP CDS, CAP CDS, table, lineitem

**STEP**: 1 — Use UI.LineItem (OData XML annotation)

**DESCRIPTION**: Insert a UI.LineItem annotation into your OData metadata/annotation file to define table columns. Each Record of Type="UI.DataField" maps a column to an entity property via PropertyValue Property="Value" Path="<PropertyName>". Use UI.Importance to mark columns as High/Medium/Low for responsive visibility.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: OData XML annotation defining three line items -->
<Annotation Term="UI.LineItem">
  <Collection>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="Product"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="ProductCategory"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="Supplier"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
  </Collection>
</Annotation>
```

**STEP**: 2 — Use UI.lineItem in ABAP CDS

**DESCRIPTION**: In ABAP CDS, annotate the exposed elements using @UI.lineItem to define each column. Specify importance (#HIGH/#MEDIUM/#LOW), value (property name), type (e.g., #STANDARD), and position (numeric ordering). Place these annotations directly above the element definitions in your CDS view.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.lineItem: [
  {
    importance: #HIGH,
    value: 'PRODUCT',
    type: #STANDARD,
    position: 1 
  }
]
PRODUCT;

@UI.lineItem: [
  {
    importance: #HIGH,
    value: 'PRODUCTCATEGORY',
    type: #STANDARD,
    position: 2 
  }
]
PRODUCTCATEGORY;

@UI.lineItem: [
  {
    importance: #HIGH,
    value: 'SUPPLIER',
    type: #STANDARD,
    position: 3 
  }
]
SUPPLIER;
```

**STEP**: 3 — Use UI.LineItem in CAP CDS (CDS for SAP Cloud Application Programming)

**DESCRIPTION**: In CAP CDS files, define UI.LineItem as an array of UI.DataField records. Reference entity properties directly (no quotes for property identifiers). Use the UI.Importance annotation shorthand (![@UI.Importance]) to mark importance.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.LineItem : [
    {
        $Type : 'UI.DataField',
        Value : Product,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataField',
        Value : ProductCategory,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataField',
        Value : Supplier,
        ![@UI.Importance] : #High
    }
]
```

**STEP**: 4 — Column naming, ordering, and responsiveness rules

**DESCRIPTION**: Use these properties to control rendering behavior:
- Value / Path: property name shown in the column.
- Position (ABAP CDS): numeric value controls column order (lower first).
- UI.Importance: High/Medium/Low controls responsive hiding rules (columns with lower importance are hidden first on narrow screens).
- Type (ABAP CDS): e.g., #STANDARD or other field types to influence rendering.

Include these annotations on the root entity set or respective entity properties used as line items.

**LANGUAGE**: Plain text

**CODE**:
```text
Key attributes:
- Value / Path -> maps to entity property (column source)
- position (ABAP CDS) -> integer ordering (1,2,3,...)
- importance / UI.Importance -> visibility priority (High, Medium, Low)
- type (ABAP CDS) -> rendering type (#STANDARD, etc.)
```

**STEP**: 5 — Additional references

**DESCRIPTION**: See related docs for adding actions and responsive options for tables. Use these links when implementing actions or customizing responsive behavior.

**LANGUAGE**: Plain text

**CODE**:
```text
See:
- Adding Actions to Tables: adding-actions-to-tables-b623e0b.md
- Responsiveness Options: Example: responsiveness-options-example-69efbe7.md
```
--------------------------------

**TITLE**: Defining Multiple Views for a Table in an Analytical List Page (Single Table Mode)

**INTRODUCTION**: Configure multiple predefined table views for an Analytical List Page (ALP) in SAP Fiori Elements (OData V2). Use UI.SelectionVariant annotations to define each view, then map them to quickVariantSelection entries in manifest.json to present them as a segmented button (≤3 views) or a drop-down (>3 views). Optionally enable per-view counts.

**TAGS**: fiori-elements-framework, OData V2, Analytical List Page, annotations, SelectionVariant, manifest.json, quickVariantSelection, showCounts

**STEP**: 1 — Define SelectionVariant annotations for each view

**DESCRIPTION**: Create UI.SelectionVariant annotations in your annotations file. Each annotated Record defines one view, with Text (label) and SelectOptions specifying filter ranges. Use a distinct Qualifier for each view so you can reference them from manifest.json.

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="SEPMRA_ALP_SO_ANA_SRV.SEPMRA_C_ALP_SlsOrdItemCubeALPResult">
   <Annotation Term="UI.SelectionVariant" Qualifier="Expensive">
      <Record>
         <PropertyValue Property="Text" String="Expensive" />
         <PropertyValue Property="SelectOptions">
            <Collection>
               <Record Type="UI.SelectOptionType">
                  <PropertyValue Property="PropertyName" PropertyPath="Product" />
                  <PropertyValue Property="Ranges">
                     <Collection>
                        <Record Type="UI.SelectionRangeType">
                           <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                           <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                           <PropertyValue Property="Low" String="HT-1000" />
                        </Record>
                     </Collection>
                  </PropertyValue>
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>

   <Annotation Term="UI.SelectionVariant" Qualifier="Cheap">
      <Record>
         <PropertyValue Property="Text" String="Cheap" />
         <PropertyValue Property="SelectOptions">
            <Collection>
               <Record Type="UI.SelectOptionType">
                  <PropertyValue Property="PropertyName" PropertyPath="Product" />
                  <PropertyValue Property="Ranges">
                     <Collection>
                        <Record Type="UI.SelectionRangeType">
                           <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                           <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                           <PropertyValue Property="Low" String="HT-1050" />
                        </Record>
                     </Collection>
                  </PropertyValue>
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>

   <Annotation Term="UI.SelectionVariant" Qualifier="Economic">
      <Record>
         <PropertyValue Property="Text" String="Economic" />
         <PropertyValue Property="SelectOptions">
            <Collection>
               <Record Type="UI.SelectOptionType">
                  <PropertyValue Property="PropertyName" PropertyPath="Product" />
                  <PropertyValue Property="Ranges">
                     <Collection>
                        <Record Type="UI.SelectionRangeType">
                           <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                           <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                           <PropertyValue Property="Low" String="HT-1002" />
                        </Record>
                     </Collection>
                  </PropertyValue>
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>

   <Annotation Term="UI.SelectionVariant" Qualifier="Budget">
      <Record>
         <PropertyValue Property="Text" String="Budget" />
         <PropertyValue Property="SelectOptions">
            <Collection>
               <Record Type="UI.SelectOptionType">
                  <PropertyValue Property="PropertyName" PropertyPath="Product" />
                  <PropertyValue Property="Ranges">
                     <Collection>
                        <Record Type="UI.SelectionRangeType">
                           <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                           <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                           <PropertyValue Property="Low" String="HT-1022" />
                        </Record>
                     </Collection>
                  </PropertyValue>
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```

**STEP**: 2 — Map SelectionVariants to quickVariantSelection in manifest.json

**DESCRIPTION**: Add a quickVariantSelection object to the analytical list page settings section under sap.ui.generic.app in manifest.json. Each variant entry must reference the SelectionVariant annotation using the fully qualified annotationPath: com.sap.vocabularies.UI.v1.SelectionVariant#<Qualifier>. The key value is an arbitrary unique key used by the ALP control.

Behavior notes:
- If number of variants ≤ 3 → UI displays a segmented button.
- If number of variants > 3 → UI displays a drop-down.

**LANGUAGE**: JSON

**CODE**:
```json
"quickVariantSelection": {
  "variants": {
    "0": {
      "key": "_tab1",
      "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive"
    },
    "1": {
      "key": "_tab2",
      "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Cheap"
    },
    "2": {
      "key": "_tab3",
      "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Economic"
    },
    "3": {
      "key": "_tab4",
      "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Budget"
    }
  }
}
```

Place this quickVariantSelection object in manifest.json under the Analytical List Page settings area of sap.ui.generic.app (the ALP settings section).

**STEP**: 3 — Enable counts for each view (optional)

**DESCRIPTION**: To display the number of entries for each view next to the view label, set showCounts to true in the quickVariantSelection object.

**LANGUAGE**: JSON

**CODE**:
```json
"quickVariantSelection": {
  "showCounts": true,
  "variants": {
    "0": {
      "key": "_tab1",
      "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive"
    },
    "1": {
      "key": "_tab2",
      "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Cheap"
    },
    "2": {
      "key": "_tab3",
      "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Economic"
    },
    "3": {
      "key": "_tab4",
      "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Budget"
    }
  }
}
```

**STEP**: 4 — Validation and runtime behavior checks

**DESCRIPTION**: After deployment:
- Confirm the ALP shows a segmented button when variants count ≤3, otherwise a drop-down.
- Verify each view applies the corresponding SelectionVariant filter.
- If showCounts is true, verify counts are retrieved and displayed for each variant.

**LANGUAGE**: Notes

**CODE**:
```text
- Ensure SelectionVariant Qualifiers exactly match the annotationPath suffixes in manifest.json.
- Ensure the SelectionVariant annotation Target matches the ALP entity type.
- If counts are slow, consider backend OData optimizations or lazy count retrieval.
```

**STEP**: 5 — Reference for OData V4 (information)

**DESCRIPTION**: For OData V4 or List Report variations, consult "Defining Multiple Views on a List Report Table - Single Table Mode" (separate documentation).
--------------------------------

**TITLE**: Defining Multiple Views on a List Report Table (Multiple Table Mode)

**INTRODUCTION**: Steps and annotated code examples to configure multiple table mode (multiple views/tabs) in SAP Fiori Elements List Report. Covers: defining SelectionVariant / SelectionPresentationVariant, adding charts, manifest.json settings for OData V2 (quickVariantSelectionX) and OData V4 (views in routing targets), controlConfiguration, chart actions & navigation, stable ID behavior and recommendations.

**TAGS**: fiori-elements-framework, annotations, selectionvariant, presentationvariant, charts, manifest.json, quickVariantSelectionX, views, ODataV2, ODataV4, CDS, CAP, ABAP

STEP: 1 — Define a UI.Chart annotation (required when using charts in a view)

DESCRIPTION: Create a UI.Chart definition with a qualifier (used later by SelectionPresentationVariant). Examples in XML annotation, ABAP CDS, and CAP CDS (OData V4).

LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Chart" Qualifier="Chart1">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Revenue by Customer"/>
        <PropertyValue Property="Description" String="Net Revenue by Customer"/>
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>ProductCategory</PropertyPath>             
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>NetAmount</PropertyPath>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```
@UI.Chart: [
  {
    title: 'Revenue by Customer',
    description: 'Net Revenue by Customer',
    chartType: #COLUMN,
    dimensions: [
      'PRODUCTCATEGORY'
    ],
    measures: [
      'NETAMOUNT'
    ],
    qualifier: 'Chart1'
  }
]
annotate view SALESORDERMANAGE with {

}
```

LANGUAGE: CAP CDS
CODE:
```
UI.Chart #Chart1 : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Revenue by Customer',
    Description : 'Net Revenue by Customer',
    ChartType : #Column,
    Dimensions : [
        ProductCategory
    ],
    Measures : [
        NetAmount
    ],
}
```

STEP: 2 — Reference the UI.Chart in a SelectionPresentationVariant or PresentationVariant

DESCRIPTION: Reference the chart using an AnnotationPath in PresentationVariant.Visualizations or as the PresentationVariant of a SelectionPresentationVariant (qualifier must match the chart qualifier).

LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.SelectionPresentationVariant" Qualifier="Chart1">
    <Record>
        <PropertyValue Property="Text" String="Chart1"/>
            <PropertyValue Property="SelectionVariant">
                <Record>
                    ....
                </Record>
            </PropertyValue>
        <PropertyValue Property="PresentationVariant">
            <Record>
                <PropertyValue Property="Visualizations">
                    <Collection>
                        <AnnotationPath>@UI.Chart#Chart1</AnnotationPath>
                    </Collection>
                </PropertyValue>
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```
@UI.selectionPresentationVariant: [{
  text: 'Chart1',
  selectionVariantQualifier: '',
  presentationVariantQualifier: 'Default',
  qualifier: 'Chart1'
}]

@UI.presentationVariant: [
  {
    qualifier: 'Default',
    sortOrder: [{by: 'GrossAmount', direction: #ASC }],
    visualizations: [{type: #AS_CHART, qualifier: 'Chart1'}]
  }
]
annotate view SALESORDERMANAGE with {

}
```

LANGUAGE: CAP CDS
CODE:
```
UI.SelectionPresentationVariant #Chart1 : {
    Text : 'Chart1',
    SelectionVariant : {
        ....
    },
    PresentationVariant : {
        Visualizations : [
            '@UI.Chart#Chart1'
        ]
    }
},
```

STEP: 3 — Add SelectionVariant / SelectionPresentationVariant annotations for multiple table mode (OData V2)

DESCRIPTION: Create selection variants or selection + presentation variants to represent each view/tab. Use qualifiers to identify variants when referenced from the manifest. Examples: "Expensive" SelectionVariant and "Cheap" SelectionPresentationVariant.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_SALES_ORDER_ITEM_AGGR_SRV.STTA_C_SO_ItemAggrType">
<Annotation Term="UI.SelectionVariant" Qualifier="Expensive">
    <Record>
        <PropertyValue Property="Text" String="Expensive">
        </PropertyValue>
        <PropertyValue Property="SelectOptions">
            <Collection>
                <Record Type="UI.SelectOptionType">
                    <PropertyValue Property="PropertyName" PropertyPath="GrossAmount" />
                    <PropertyValue Property="Ranges">
                        <Collection>
                            <Record Type="UI.SelectionRangeType"> 
                                 <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/E"/>
                                 <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/LT"/> 
                                 <PropertyValue Property="Low" String="5000"/>
                            </Record>
                        </Collection>
                    </PropertyValue>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```
@UI.SelectionVariant: [
  {
    text: 'Expensive',
    qualifier: 'Expensive'
  }
]
annotate view SALESORDERMANAGE with {

}
```

LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_SALES_ORDER_ITEM_AGGR_SRV.STTA_C_SO_ItemAggrType">
<Annotation Term="UI.SelectionPresentationVariant" Qualifier="Cheap">
    <Record>
        <PropertyValue Property="Text" String="Cheap">
        </PropertyValue>
        <PropertyValue Property="SelectionVariant">
            <Record>
                <PropertyValue Property="Text" String="Cheap">
                </PropertyValue>
                <PropertyValue Property="SelectOptions">
                    <Collection>
                        <Record Type="UI.SelectOptionType">
                            <PropertyValue Property="PropertyName"
                                PropertyPath="GrossAmount" />
                            <PropertyValue Property="Ranges">
                                <Collection>
                                    <Record Type="UI.SelectionRangeType">
                                        <PropertyValue Property="Option"
                                            EnumMember="UI.SelectionRangeOptionType/LT" />
                                        <PropertyValue Property="Low" String="5000" />
                                    </Record>
                                </Collection>
                            </PropertyValue>
                        </Record>
                    </Collection>
                </PropertyValue>
            </Record>
        </PropertyValue>
        <PropertyValue Property="PresentationVariant">
            <Record>
                <PropertyValue Property="SortOrder">
                    <Collection>
                        <Record>
                            <PropertyValue Property="Property"
                                PropertyPath="GrossAmount" />
                            <PropertyValue Property="Descending" Bool="false" />
                        </Record>
                    </Collection>
                </PropertyValue>
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```
@UI.selectionPresentationVariant: [{
  id: '',
  text: 'Cheap',
  selectionVariantQualifier: 'Default',
  presentationVariantQualifier: 'Default',
  qualifier: 'Cheap'
}]

@UI.selectionVariant: [
  {
    text: 'Cheap',
    qualifier: 'Default'
  }
]

@UI.presentationVariant: [
  {
    qualifier: 'Default',
    sortOrder: [{by: 'GrossAmount', direction: #ASC }]
  }
]
annotate view SALESORDERMANAGE with {

}
```

STEP: 4 — Supported selection range options & presentation variant behavior (Notes)

DESCRIPTION: When creating SelectionVariant ranges:
- FilterExpression of SelectionVariantType is not supported.
- Supported SelectionRangeOptionType values (no wildcards): EQ, BT, LE, GE, NE, GT, LT.
- PresentationVariant supports SortOrder and Visualizations. PresentationVariant must contain a Visualization to be applied.

LANGUAGE: JSON
CODE:
```json
{
  "notes": [
    "SelectionVariant: FilterExpression unsupported",
    "Supported SelectionRangeOptionType: EQ, BT, LE, GE, NE, GT, LT",
    "PresentationVariant: supports SortOrder and Visualizations",
    "PresentationVariant without Visualizations => default LineItem applies"
  ]
}
```

STEP: 5 — Enable multiple table mode in manifest.json for OData V2 (quickVariantSelectionX)

DESCRIPTION: Add quickVariantSelectionX to sap.ui.generic.app > pages > settings and map keys to annotationPaths of the SelectionVariant/SelectionPresentationVariant created earlier. Each variant record must include "key" and "annotationPath". Keys are used for IconTabBar item initialization and become suffixes for stable IDs of tab-specific tables.

LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "C_STTA_SalesOrder_WD_20",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "quickVariantSelectionX": {
              "variants": {
                "Expensive": {
                  "key": "Expensive",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive"
                },
                "Cheap": {
                  "key": "Cheap",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#Cheap"
                }
              }
            }
            ...
          }
        }
      }
    ]
  }
}
```

STEP: 6 — Stable IDs and variant key recommendations

DESCRIPTION: Behavior and constraints:
- Each tab creates a separate table instance; IDs get a suffix "-<key>" where <key> is the variant key from manifest.
- Keys: use alphanumeric characters, digits and underscores; must not begin with a digit.
- Use key to apply key-user adaptations per-table.

LANGUAGE: JSON
CODE:
```json
{
  "stableIdRules": {
    "suffix": "-<key>",
    "keyConstraints": "alphanumeric, underscore, cannot start with digit"
  }
}
```

STEP: 7 — Charts in multiple table mode: actions and navigation

DESCRIPTION: For charts in multiple table mode:
- Use UI.Chart/Actions (DataFieldForAction / DataFieldForIntentBasedNavigation) or custom toolbar extension point actions; actions relevant to selection are disabled if no chart bar is selected.
- To enable navigation on chart items, set showItemNavigationOnChart = true for the corresponding variant entry in manifest, and maintain an internal navigation target in the manifest routing/targets.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Chart" Qualifier="Chart4">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>CompanyCode</PropertyPath>
                <PropertyPath>Customer</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>AmountInTransactionCurrency</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Actions">
            <Collection>
                <Record Type="UI.DataFieldForAction">
                    <PropertyValue Property="Action" String="ZFAR_CUSTOMER_LINE_ITEMS2_SRV.ZFAR_CUSTOMER_LINE_ITEMS2_SRV_Entities/Create"/>
                    <PropertyValue Property="Label" String="Action 1"/>
                </Record>
                <Record Type="UI.DataFieldForIntentBasedNavigation">
                    <PropertyValue Property="SemanticObject" String="Customer"/>
                    <PropertyValue Property="Action" String="postPayment2"/>
                    <PropertyValue Property="Label" String="SO Navigation (M)"/>
                    <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/Medium"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```
@UI.Chart: [
  {
    chartType: #COLUMN,
    dimensions: [
      'COMPANYCODE',
      'CUSTOMER'
    ],
    measures: [
      'AMOUNTINTRANSACTIONCURRENCY'
    ],
    actions: [
      {
        dataAction: 'PUSHDOWN:Create',
        label: 'Action 1',
        type: #FOR_ACTION
      },
      {
        semanticObjectAction: 'postPayment2',
        label: 'SO Navigation (M)',
        type: #FOR_INTENT_BASED_NAVIGATION
      }
    ],
    qualifier: 'Chart4'
  }
]
annotate view SALESORDERMANAGE with {

}
```

LANGUAGE: JSON
CODE:
```json
{
  "quickVariantSelectionX": {
    "variants": {
      "SalesOrderTable": {
        "key": "SalesOrderTable",
        "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#VAR1"
      },
      "Amount_CustomerChart": {
        "key": "Amount_CustomerChart",
        "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#VAR4",
        "showItemNavigationOnChart": true
      }
    }
  }
}
```

NOTE: Ensure the service/entity used by the chart is not draft-enabled and not read-only when showItemNavigationOnChart is used.

STEP: 8 — Additional example: SelectionVariant without qualifier (XML) + manifest mapping

DESCRIPTION: Example SelectionVariant without a qualifier and mapping it in quickVariantSelectionX.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.SelectionVariant">
     <Record>
          <PropertyValue Property="Text" String="Expensive">
          </PropertyValue>
          <PropertyValue Property="SelectOptions">
               <Collection>
                    <Record Type="UI.SelectOptionType">
                         <PropertyValue Property="PropertyName"
                                        PropertyPath="GrossAmount" />
                         <PropertyValue Property="Ranges">
                              <Collection>
                                   <Record Type="UI.SelectionRangeType">
                                        <PropertyValue Property="Option"
                                                       EnumMember="UI.SelectionRangeOptionType/GE" />
                                        <PropertyValue Property="Low" String="5000" />
                                   </Record>
                              </Collection>
                         </PropertyValue>
                    </Record>
               </Collection>
          </PropertyValue>
     </Record>
</Annotation>
```

LANGUAGE: JSON
CODE:
```json
"settings": {
  "quickVariantSelectionX": {
    "variants": {
      "ExpensiveOrdersTable": {
        "key": "ExpensiveOrdersTable",
        "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant"
      }
    }
  }
}
```

STEP: 9 — Additional example: SelectionPresentationVariant without qualifier (XML) + manifest mapping

DESCRIPTION: Example SPV referencing a reduced LineItem via PresentationVariant.Visualizations, plus manifest mapping for two variants.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.SelectionPresentationVariant">
     <Record>
          <PropertyValue Property="Text" String="Cheap">
          </PropertyValue>
          <PropertyValue Property="SelectionVariant">
               <Record>
                    <PropertyValue Property="Text" String="Cheap">
                    </PropertyValue>
                    <PropertyValue Property="SelectOptions">
                         <Collection>
                              <Record Type="UI.SelectOptionType">
                                   <PropertyValue Property="PropertyName"
                                                  PropertyPath="GrossAmount" />
                                   <PropertyValue Property="Ranges">
                                        <Collection>
                                             <Record Type="UI.SelectionRangeType">
                                                  <PropertyValue Property="Option"
                                                                 EnumMember="UI.SelectionRangeOptionType/LT" />
                                                  <PropertyValue Property="Low" String="5000" />
                                             </Record>
                                        </Collection>
                                   </PropertyValue>
                              </Record>
                         </Collection>
                    </PropertyValue>
               </Record>
          </PropertyValue>
          <PropertyValue Property="PresentationVariant">
               <Record>
                    <PropertyValue Property="Visualizations">
                         <Collection>
                              <AnnotationPath>@UI.LineItem#Reduced</AnnotationPath>
                         </Collection>
                    </PropertyValue>
                    <PropertyValue Property="SortOrder">
                         <Collection>
                              <Record>
                                   <PropertyValue Property="Property"
                                                  PropertyPath="GrossAmount" />
                                   <PropertyValue Property="Descending" Bool="false" />
                              </Record>
                         </Collection>
                    </PropertyValue>
               </Record>
          </PropertyValue>
     </Record>
</Annotation>
```

LANGUAGE: JSON
CODE:
```json
"quickVariantSelectionX": {
  "variants": {
    "ExpensiveOrdersTable": {
      "key": "ExpensiveOrdersTable",
      "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant"
    },
    "CheapOrdersTable": {
      "key": "CheapOrdersTable",
      "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant"
    }
  }
}
```

STEP: 10 — OData V4: Define SelectionVariant / SelectionPresentationVariant / LineItem examples (XML, ABAP, CAP)

DESCRIPTION: OData V4 uses similar annotation constructs. Examples show SelectionVariant with qualifier "Good", SPV with qualifier "PV", and LineItem/SelectionPresentationVariant that uses a qualified LineItem "Simplified". Include CAP and ABAP CDS forms.

LANGUAGE: XML
CODE:
```xml
<!-- SelectionVariant Qualifier "Good" -->
<Annotation Term="UI.SelectionVariant" Qualifier="Good">
     <Record Type="UI.SelectionVariantType">
          <PropertyValue Property="SelectOptions">
               <Collection>
                    <Record Type="UI.SelectOptionType">
                         <PropertyValue Property="PropertyName" PropertyPath="Rating" />
                         <PropertyValue Property="Ranges">
                              <Collection>
                                   <Record Type="UI.SelectionRangeType">
                                        <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                                        <PropertyValue Property="Low" String="5" />
                                   </Record>
                              </Collection>
                         </PropertyValue>
                    </Record>
               </Collection>
          </PropertyValue>
          <PropertyValue Property="Text" String="Good Rating/SV" />
     </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```
@UI.selectionVariant: [
  {
    text: 'Good',
    qualifier: 'Good'
  }
]

annotate view SALESORDERMANAGE with {

}
```

LANGUAGE: CAP CDS
CODE:
```
UI.SelectionVariant #Good : {
    $Type : 'UI.SelectionVariantType',
    SelectOptions : [
        {
            $Type : 'UI.SelectOptionType',
            PropertyName : Rating,
            Ranges : [
                {
                    $Type : 'UI.SelectionRangeType',
                    Option : #EQ,
                    Low : '5'
                }
            ]
        }
    ],
    Text : 'Good Rating/SV'
},
```

LANGUAGE: XML
CODE:
```xml
<!-- SelectionPresentationVariant "PV" -->
<Annotation Term="UI.SelectionPresentationVariant" Qualifier="PV">
     <Record Type="UI.SelectionPresentationVariantType">
          <PropertyValue Property="Text" String="Medium Rating/PV">
          </PropertyValue>
          <PropertyValue Property="SelectionVariant">
               <Record Type="UI.SelectionVariantType">
                    <PropertyValue Property="SelectOptions">
                         <Collection>
                              <Record Type="UI.SelectOptionType">
                                   <PropertyValue Property="PropertyName" PropertyPath="Rating" />
                                        <PropertyValue Property="Ranges">
                                             <Collection>
                                                  <Record Type="UI.SelectionRangeType">
                                                       <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/BT" />
                                                       <PropertyValue Property="Low" String="2" />
                                                       <PropertyValue Property="High" String="4" />
                                                  </Record>
                                             </Collection>
                                   </PropertyValue>
                              </Record>
                         </Collection>
                    </PropertyValue>
                    <PropertyValue Property="Text" String="Medium Rating" />
               </Record>
          </PropertyValue>
          <PropertyValue Property="PresentationVariant">
               <Record Type="UI.PresentationVariantType">
                    <PropertyValue Property="Visualizations">
                         <Collection>
                              <AnnotationPath>@UI.LineItem#Reduced</AnnotationPath>
                         </Collection>
                    </PropertyValue>
                    <PropertyValue Property="MaxItems" Int="5" />
                    <PropertyValue Property="SortOrder">
                         <Collection>
                              <Record Type="Common.SortOrderType">
                                   <PropertyValue Property="Property" PropertyPath="ID" />
                                   <PropertyValue Property="Ascending" Bool="true" />
                              </Record>
                              <Record Type="Common.SortOrderType">
                                   <PropertyValue Property="Property" PropertyPath="SalesOrderType" />
                                   <PropertyValue Property="Descending" Bool="true" />
                              </Record>
                         </Collection>
                    </PropertyValue>
               </Record>
          </PropertyValue>
     </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```
@UI.selectionPresentationVariant: [{
  id: '',
  text: 'Medium Rating/PV',
  selectionVariantQualifier: 'Default',
  presentationVariantQualifier: 'Default',
  qualifier: 'PV'
}]

@UI.selectionVariant: [
  {
    text: 'Medium Rating',
    qualifier: 'Default'
  }
]

@UI.presentationVariant: [
  {
    qualifier: 'Default',
    sortOrder: [
                {by: 'ID', direction: #ASC }, 
                {by: 'SalesOrderType', direction: #DESC }
              ],
    visualizations: [{
        type: #AS_LINEITEM,
        qualifier: 'Reduced'
    }
  }
]
annotate view SALESORDERMANAGE with {

}
```

LANGUAGE: CAP CDS
CODE:
```
UI.SelectionPresentationVariant #PV : {
    $Type : 'UI.SelectionPresentationVariantType',
    Text : 'Medium Rating/PV',
    SelectionVariant : {
        $Type : 'UI.SelectionVariantType',
        SelectOptions : [
            {
                $Type : 'UI.SelectOptionType',
                PropertyName : Rating,
                Ranges : [
                    {
                        $Type : 'UI.SelectionRangeType',
                        Option : #BT,
                        Low : '2',
                        High : '4'
                    }
                ]
            }
        ],
        Text : 'Medium Rating'
    },
    PresentationVariant : {
        $Type : 'UI.PresentationVariantType',
        MaxItems : 5,
        SortOrder : [
            {
                $Type : 'Common.SortOrderType',
                Property : ID,
                Ascending : true
            },
            {
                $Type : 'Common.SortOrderType',
                Property : SalesOrderType,
                Descending : true
            }
        ],
        Visualizations : ['@UI.LineItem#Reduced']
    }
}
```

STEP: 11 — OData V4: Multiple table mode with different LineItem / SPV that references qualified LineItem

DESCRIPTION: Define multiple LineItem variants (qualified) and reference them from a SelectionPresentationVariant.Visualizations (example: LineItem#Simplified + SPV#PVandSV).

LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.LineItem" Qualifier="Simplified">
     <Collection>
          <Record Type="UI.DataField">
               <PropertyValue Property="Value" Path="ID" />
          </Record>
          <Record Type="UI.DataField">
               <PropertyValue Property="Value" Path="ImageUrl" />
          </Record>
          <Record Type="UI.DataFieldForAnnotation">
               <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#multipleActionFields" />
               <PropertyValue Property="Label" String="Sold-To Party" />
          </Record>
     </Collection>
</Annotation>

<Annotation Term="UI.SelectionPresentationVariant" Qualifier="PVandSV">
     <Record Type="UI.SelectionPresentationVariantType">
          <PropertyValue Property="Text" String="Medium Rating/PVandSV">
          </PropertyValue>
          <PropertyValue Property="SelectionVariant">
               <Record Type="UI.SelectionVariantType">
                    <PropertyValue Property="SelectOptions">
                         <Collection>
                              <Record Type="UI.SelectOptionType">
                                   <PropertyValue Property="PropertyName" PropertyPath="Rating" />
                                   <PropertyValue Property="Ranges">
                                        <Collection>
                                             <Record Type="UI.SelectionRangeType">
                                                  <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/BT" />
                                                  <PropertyValue Property="Low" String="2" />
                                                  <PropertyValue Property="High" String="4" />
                                             </Record>
                                        </Collection>
                                   </PropertyValue>
                              </Record>
                         </Collection>
                    </PropertyValue>
                    <PropertyValue Property="Text" String="Medium Rating" />
               </Record>
          </PropertyValue>
          <PropertyValue Property="PresentationVariant">
               <Record Type="UI.PresentationVariantType">
                    <PropertyValue Property="MaxItems" Int="2" />
                    <PropertyValue Property="SortOrder">
                         <Collection>
                              <Record Type="Common.SortOrderType">
                                   <PropertyValue Property="Property" PropertyPath="ID" />
                                   <PropertyValue Property="Ascending" Bool="false" />
                              </Record>
                              <Record Type="Common.SortOrderType">
                                   <PropertyValue Property="Property" PropertyPath="SalesOrderType" />
                                   <PropertyValue Property="Descending" Bool="true" />
                              </Record>
                         </Collection>
                    </PropertyValue>
                    <PropertyValue Property="Visualizations">
                         <Collection>
                              <AnnotationPath>@UI.LineItem#Simplified</AnnotationPath>
                         </Collection>
                    </PropertyValue>
               </Record>
          </PropertyValue>
     </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```
@UI.lineItem: [
  {
    value: 'ID',
    type: #STANDARD,
    position: 1 ,
    qualifier: 'Simplified'
  }
]
ID;
@UI.lineItem: [
  {
    value: 'IMAGEURL',
    type: #STANDARD,
    position: 2 ,
    qualifier: 'Simplified'
  }
]
IMAGEURL;

@UI.lineItem: [
  {
    type: #AS_FIELDGROUP,
    position: 3 ,
    qualifier: 'Simplified',
    label: 'Sold-To Party',
    valueQualifier: 'multipleActionFields'
  }
]
SOLDTOPARTY;


@UI.selectionPresentationVariant: [{
  id: '',
  text: 'Medium Rating/PVandSV',
  selectionVariantQualifier: 'Default',
  presentationVariantQualifier: 'Default',
  qualifier: 'PVandSV'
}]

@UI.selectionVariant: [
  {
    text: 'Medium Rating',
    qualifier: 'Default'
  }
]

@UI.presentationVariant: [
  {
    qualifier: 'Default',
    maxItems: 2,
    sortOrder: [
                {by: 'ID', direction: #DESC }, 
                {by: 'SalesOrderType', direction: #DESC }
              ],
   visualizations: [{type: #AS_LINEITEM, qualifier: 'Simplified'}
  }
]
```

LANGUAGE: CAP CDS
CODE:
```
UI.LineItem #Simplified : [
    {
        $Type : 'UI.DataField',
        Value : ID
    },
    {
        $Type : 'UI.DataField',
        Value : ImageUrl
    },
    {
        $Type : 'UI.DataFieldForAnnotation',
        Target : '@UI.FieldGroup#multipleActionFields',
        Label : 'Sold-To Party'
    }
],
UI.SelectionPresentationVariant #PVandSV : {
    $Type : 'UI.SelectionPresentationVariantType',
    Text : 'Medium Rating/PVandSV',
    SelectionVariant : {
        $Type : 'UI.SelectionVariantType',
        SelectOptions : [
            {
                $Type : 'UI.SelectOptionType',
                PropertyName : Rating,
                Ranges : [
                    {
                        $Type : 'UI.SelectionRangeType',
                        Option : #BT,
                        Low : '2',
                        High : '4'
                    }
                ]
            }
        ],
        Text : 'Medium Rating'
    },
    PresentationVariant : {
        $Type : 'UI.PresentationVariantType',
        MaxItems : 2,
        SortOrder : [
            {
                $Type : 'Common.SortOrderType',
                Property : ID,
                Ascending : false
            },
            {
                $Type : 'Common.SortOrderType',
                Property : SalesOrderType,
                Descending : true
            }
        ],
        Visualizations : [
            '@UI.LineItem#Simplified'
        ]
    }
}
```

STEP: 12 — OData V4: Enable multiple views in manifest routing targets (views.paths) and controlConfiguration

DESCRIPTION: For OData V4 apps using sap.fe.templates.ListReport, configure the list report target options > settings > views > paths: each object defines a view with key and annotationPath. Use controlConfiguration to configure table types and settings for visualizations.

LANGUAGE: JSON
CODE:
```json
"SalesOrderManageList": {
  "type": "Component",
  "id": "SalesOrderManageList",
  "name": "sap.fe.templates.ListReport",
  "options": {
    "settings": {
      "contextPath": "/SalesOrderManage",
      "views": {
        "paths": [
          {
            "key": "tab1",
            "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Good"
          },
          {
            "key": "tab2",
            "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#UncompletePV"
          },
          {
            "key": "tab3",
            "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#PVandSV"
          }
        ],
        "showCounts": false
      },
      "controlConfiguration": {
        ...
      }
    },
    ...
  }
}
```

LANGUAGE: JSON
CODE:
```json
"controlConfiguration": {
   "@com.sap.vocabularies.UI.v1.LineItem#withPrice": {
      "tableSettings": {
         "type": "ResponsiveTable",
         "enableExport": false
      }
   }
}
```

STEP: 13 — Views settings summary (showCounts, key, annotationPath, keepPreviousPersonalization)

DESCRIPTION: Use the following settings per view:
- showCounts (optional, default false) — show counts in tabs.
- key (required) — used to suffix stable IDs for tab-specific controls.
- annotationPath (required) — points to SelectionVariant or SelectionPresentationVariant. If it points to a SelectionVariant, default LineItem (no qualifier) is used; if SPV, SPV.Visualization defines the view.
- keepPreviousPersonalization (optional) — when migrating single-table app to multi-table, set on one view to preserve previously defined personalization (only one view allowed).

LANGUAGE: JSON
CODE:
```json
{
  "views_settings": {
    "showCounts": false,
    "key": "required and used as ID suffix",
    "annotationPath": "SelectionVariant or SelectionPresentationVariant",
    "keepPreviousPersonalization": "optional (only one view allowed)"
  }
}
```

STEP: 14 — Miscellaneous tips and constraints

DESCRIPTION: Additional practical notes:
- You can show different entitySets, table types and settings per tab using manifest per-view configuration; add entitySet/table settings under each tab in the manifest.
- Refreshing counts via global side effects is only possible for views that have been opened.
- If table title matches view name, the table title is omitted to avoid duplication.
- When enabling chart item navigation ensure internal navigation targets are configured (see app-specific routing). Do not use draft-enabled/read-only services for chart navigation.

LANGUAGE: JSON
CODE:
```json
{
  "tips": [
    "Per-tab entitySet and table settings are supported in manifest (configure per view)",
    "Global side effect refresh of tab count works only for opened views",
    "Table title omitted if it matches view name to avoid duplicate info",
    "Chart item navigation requires non-draft, non-read-only entity/service"
  ]
}
```
--------------------------------

**TITLE**: Define Multiple Table Views (Single Table Mode) for Fiori Elements List Report

**INTRODUCTION**: This guide shows how to define multiple filter views (SelectionVariants / SelectionPresentationVariants) and enable single-table mode segmented buttons so users can switch between those views. Includes XML annotation examples, ABAP and CAP CDS snippets, and the required manifest.json settings for OData V2 and OData V4 apps. Follow the steps to add annotations and configure quickVariantSelection.

**TAGS**: fiori-elements, annotations, SelectionVariant, SelectionPresentationVariant, manifest.json, quickVariantSelection, segmented-button, ODataV2, ODataV4

**STEP**: 1 — Add SelectionVariant annotation (OData V2 XML)
**DESCRIPTION**: Create a UI.SelectionVariant annotation (optionally with a Qualifier) in your annotations file to define the filter ranges for a view. The example filters GrossAmount >= 5000. Notes: FilterExpression is not supported. Supported SelectionRangeOptionTypes: EQ, BT, LE, GE, NE, GT, LT (no wildcards). PresentationVariant supports SortOrders, but SelectionPresentationVariant's PresentationVariant is ignored for single-table quickVariantSelection lookup (only SelectionVariant filters are used).
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.SelectionVariant" Qualifier="Expensive">
    <Record>
        <PropertyValue Property="Text" String="Expensive" />
        <PropertyValue Property="SelectOptions">
            <Collection>
                <Record Type="UI.SelectOptionType">
                    <PropertyValue Property="PropertyName" PropertyPath="GrossAmount" />
                    <PropertyValue Property="Ranges">
                        <Collection>
                            <Record Type="UI.SelectionRangeType">
                                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/GE" />
                                <PropertyValue Property="Low" String="5000" />
                            </Record>
                        </Collection>
                    </PropertyValue>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 2 — Add SelectionVariant annotation examples (OData V2 variants)
**DESCRIPTION**: Additional V2 variants: (a) SelectionVariant with Qualifier and explicit Sign/Option; (b) SelectionVariant without Qualifier; (c) SelectionPresentationVariant (with or without Qualifier) referencing a SelectionVariant and optionally containing a PresentationVariant. Note: PresentationVariant is not considered for selecting filters in single table mode, only the SelectionVariant part is used.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- SelectionVariant with Qualifier (example: Expensive with Sign and LT) -->
<Annotation Term="UI.SelectionVariant" Qualifier="Expensive">
    <Record>
        <PropertyValue Property="Text" String="{@i18n>@Expensive}" />
        <PropertyValue Property="SelectOptions">
            <Collection>
                <Record Type="UI.SelectOptionType">
                    <PropertyValue Property="PropertyName" PropertyPath="GrossAmount" />
                    <PropertyValue Property="Ranges">
                        <Collection>
                            <Record Type="UI.SelectionRangeType">
                                <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/E"/>
                                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/LT" />
                                <PropertyValue Property="Low" String="5000" />
                            </Record>
                        </Collection>
                    </PropertyValue>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>

<!-- SelectionVariant without Qualifier -->
<Annotation Term="UI.SelectionVariant">
    <Record>
        <PropertyValue Property="Text" String="{@i18n>@Expensive}" />
        <PropertyValue Property="SelectOptions">
            <Collection>
                <Record Type="UI.SelectOptionType">
                    <PropertyValue Property="PropertyName" PropertyPath="GrossAmount" />
                    <PropertyValue Property="Ranges">
                        <Collection>
                            <Record Type="UI.SelectionRangeType">
                                <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/E"/>
                                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/LT" />
                                <PropertyValue Property="Low" String="5000" />
                            </Record>
                        </Collection>
                    </PropertyValue>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>

<!-- SelectionPresentationVariant (references a SelectionVariant and contains PresentationVariant, Qualifier optional) -->
<Annotation Term="UI.SelectionPresentationVariant" Qualifier="Cheap">
    <Record>
        <PropertyValue Property="Text" String="{@i18n>@Cheap}" />
        <PropertyValue Property="SelectionVariant">
            <Record>
                <PropertyValue Property="Text" String="Cheap" />
                <PropertyValue Property="SelectOptions">
                    <Collection>
                        <Record Type="UI.SelectOptionType">
                            <PropertyValue Property="PropertyName" PropertyPath="GrossAmount" />
                            <PropertyValue Property="Ranges">
                                <Collection>
                                    <Record Type="UI.SelectionRangeType">
                                        <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/LT" />
                                        <PropertyValue Property="Low" String="5000" />
                                    </Record>
                                </Collection>
                            </PropertyValue>
                        </Record>
                    </Collection>
                </PropertyValue>
            </Record>
        </PropertyValue>
        <PropertyValue Property="PresentationVariant">
            <Record>
                <PropertyValue Property="Visualizations">
                    <Collection>
                        <AnnotationPath>@UI.LineItem#Reduced</AnnotationPath>
                    </Collection>
                </PropertyValue>
                <PropertyValue Property="SortOrder">
                    <Collection>
                        <Record>
                            <PropertyValue Property="Property" PropertyPath="GrossAmount" />
                            <PropertyValue Property="Descending" Bool="false" />
                        </Record>
                    </Collection>
                </PropertyValue>
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 3 — Add SelectionVariant annotations in ABAP CDS (OData V2 / V4)
**DESCRIPTION**: If using ABAP CDS, declare UI.SelectionVariant(s) with text and qualifier(s) attached to the view/entity. Example shows a single qualifier.
**LANGUAGE**: ABAP
**CODE**:
```abap
@UI.SelectionVariant: [
  {
    text: 'Expensive',
    qualifier: 'Expensive'
  }
]
annotate view STTA_C_MP_Product with {
  // additional annotations
}
```

**STEP**: 4 — Add SelectionVariant annotations in CAP CDS (OData V4)
**DESCRIPTION**: For Node.js CAP projects, annotate the entity with UI.SelectionVariant entries. Example shows two qualifiers: Completed and InProcess (ranges and texts).
**LANGUAGE**: CDS
**CODE**:
```cds
annotate com.c_salesordermanage_sd.SalesOrderManage with @(
  UI.SelectionVariant #Completed : {
    $Type : 'UI.SelectionVariantType',
    SelectOptions : [
      {
        $Type : 'UI.SelectOptionType',
        PropertyName : OverallSDProcessStatus,
        Ranges : [
          { $Type : 'UI.SelectionRangeType', Option : #BT, Low : 'A', High : 'D' },
          { $Type : 'UI.SelectionRangeType', Option : #BT, Low : 'B', High : 'C' }
        ]
      }
    ],
    Text : 'completed (2 Ranges)'
  },
  UI.SelectionVariant #InProcess : {
    $Type : 'UI.SelectionVariantType',
    SelectOptions : [
      {
        $Type : 'UI.SelectOptionType',
        PropertyName : OverallSDProcessStatus,
        Ranges : [
          { $Type : 'UI.SelectionRangeType', Option : #EQ, Low : 'B' }
        ]
      }
    ],
    Text : 'In Process'
  }
);
```

**STEP**: 5 — Configure quickVariantSelection in manifest.json (OData V2 List Report)
**DESCRIPTION**: In manifest.json under sap.ui.generic.app > pages > component > settings, enable quickVariantSelection and list the variants. Each entry under "variants" must include a mandatory "key" (used for SegmentedButton initialization) and an "annotationPath" referencing the SelectionVariant or SelectionPresentationVariant (with optional qualifier suffix #Qualifier). Example shows two variants.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "C_STTA_SalesOrder_WD_20",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "quickVariantSelection": {
              "variants": {
                "0": {
                  "key": "_tab1",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive"
                },
                "1": {
                  "key": "_tab2",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#Cheap"
                }
              }
            }
            // ... other settings
          }
        }
      }
    ]
  }
}
```

**STEP**: 6 — Configure quickVariantSelection in manifest.json (OData V4 / Fiori elements V4)
**DESCRIPTION**: For OData V4 Fiori Elements, configure quickVariantSelection under the List Report target's options -> settings -> controlConfiguration -> @com.sap.vocabularies.UI.v1.LineItem -> tableSettings. Use "paths" array to reference annotationPath entries. Optional keys: showCounts (Boolean) to display counts next to segmented buttons (impacts performance due to additional $count requests), hideTableTitle (Boolean) to hide the table title and show only segmented buttons.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "routing": {
    "targets": {
      "SalesOrderManageList": {
        "type": "Component",
        "id": "SalesOrderManageList",
        "name": "sap.fe.templates.ListReport",
        "options": {
          "settings": {
            "contextPath": "/SalesOrderManage",
            "controlConfiguration": {
              "@com.sap.vocabularies.UI.v1.LineItem": {
                "tableSettings": {
                  "type": "ResponsiveTable",
                  "quickVariantSelection": {
                    "paths": [
                      { "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Open" },
                      { "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Completed" },
                      { "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#NotRelevant" },
                      { "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#InProcess" }
                    ],
                    "hideTableTitle": true,
                    "showCounts": true
                  }
                }
              }
            }
            // ... other settings
          }
        }
      }
    }
  }
}
```

**STEP**: 7 — Key requirements, behavioral notes, and performance considerations
**DESCRIPTION**: Checklist and rules to implement correctly:
- "key" is mandatory for each variant entry in V2 manifest quickVariantSelection variants (used for SegmentedButton).
- annotationPath format: namespace.Term[#Qualifier], e.g., "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive" or without qualifier.
- SelectionPresentationVariant is used only to find the SelectionVariant and its filters for quickVariantSelection: its PresentationVariant visuals are ignored when initializing filters in single table mode.
- Supported SelectionRangeOptionTypes: EQ, BT, LE, GE, NE, GT, LT (no wildcards).
- FilterExpression of SelectionVariantType is not supported.
- showCounts:true adds $count requests for each variant — this impacts performance. Use only if necessary.
- hideTableTitle:true will remove the title; enable only if each SegmentedButton label is explicit enough.

**STEP**: 8 — Example: Minimal manifest quickVariantSelection entry (V2)
**DESCRIPTION**: Minimal manifest snippet showing required structure and mandatory key.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "C_STTA_SalesOrder_WD_20",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "quickVariantSelection": {
              "variants": {
                "0": {
                  "key": "_tab1",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant"
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

--------------------------------

**TITLE**: Defining Multiple List Report Views with Different Entity Sets and Table Settings (OData V2 & V4)

**INTRODUCTION**: This guide shows how to configure a Fiori Elements List Report to expose multiple views (tabs) that use different entity sets and table/chart settings. It includes manifest.json configuration for OData V2 and OData V4, UI annotation examples (XML and CAP CDS), per-entity controlConfiguration examples, and system behavior notes about filters and counts.

**TAGS**: fiori-elements-framework, list-report, multiple-views, manifest.json, annotations, ODataV2, ODataV4, CDS, SelectionVariant, SelectionPresentationVariant, tableSettings, controlConfiguration

STEP: Prerequisites
DESCRIPTION: Ensure you have implemented the multiple table mode basics (list report page setup) and have annotation files or CDS entities available. For OData V2 put configuration under "sap.ui.generic.app" -> "pages" in manifest.json. For OData V4 use "targets" -> page component settings.
LANGUAGE: Text
CODE:
```Text
Prerequisite: Implement the basic List Report page and smart filter bar. This guide extends that by specifying per-variant entitySet, annotationPath, and tableSettings.
```

STEP: Configure multiple variants with entitySet and tableSettings (OData V2)
DESCRIPTION: Add quickVariantSelectionX variants under "sap.ui.generic.app"/"pages"[].component.settings to define each tab. Specify a per-variant entitySet when it differs from the leading page entitySet. Add tableSettings.type per variant to choose a table type (e.g., GridTable, TreeTable). The leading entitySet (top-level "entitySet") is used for the smart filter bar and footer.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "C_RequirementTrackingPurReq",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "condensedTableLayout": true,
            "smartVariantManagement": false,
            "quickVariantSelectionX": {
              "variants": {
                "1": {
                  "key": "1",
                  "entitySet": "C_RequirementTrackingPurReq",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#VAR1",
                  "tableSettings": {
                    "type": "GridTable"
                  }
                },
                "2": {
                  "key": "2",
                  "entitySet": "C_RequirementTrackingPurOrd",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#VAR5",
                  "tableSettings": {
                    "type": "GridTable"
                  }
                },
                "3": {
                  "key": "3",
                  "entitySet": "C_RequirementTrackingPurReq",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#VAR6",
                  "showItemNavigationOnChart": true,
                  "tableSettings": {
                    "type": "TreeTable"
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: System behavior for filters and counts (summary)
DESCRIPTION: Understand how filter bar and counts interact across multiple entity sets:
- The smart filter bar is bound to the leading entitySet (top-level "entitySet"). You cannot add filters that belong only to a non-leading entity set.
- Filters are applied to every table/tab only if the properties exist in that tab's entity type; otherwise they are ignored.
- Counts in the icon tab bar are shown by default to reflect result changes whenever filters change.
- If a filter applies to only one entity set, counts of other tabs are unchanged and a message is shown to the user explaining irrelevant filters.
LANGUAGE: Text
CODE:
```Text
Key behavior:
- Filters originate from the leading entitySet (smart filter bar).
- Filters apply per-tab only when the target entity type contains the property.
- Counts are always shown in the icon tab bar and update only when filters are relevant to the tab's entitySet.
- Do not expect filters defined in the filter bar to add new properties to non-main entity sets.
```

STEP: Notes and constraints (action-oriented checklist)
DESCRIPTION: Follow these guidelines when combining multiple entity sets in one List Report:
- Use only for similar business objects with common fields.
- Do not mix draft and non-draft entity sets in one report.
- Do not combine responsive and non-responsive table types in one app (i.e., either all responsive or only non-responsive types mixed: Grid/Tree/Analytical).
- Actions (custom) are supported for main entity set only; actions on other entity sets are not supported.
- For charts, ensure the service/entity is not draft-enabled or is read-only.
- Evaluate performance impact when adding entity sets.
LANGUAGE: Text
CODE:
```Text
Checklist:
- Similar business objects only.
- No draft + non-draft mix.
- Avoid mixing responsive with non-responsive tables.
- Custom actions only for the main entitySet.
- Charts must use non-draft/read-only entities.
- Test performance after adding entitySets.
```

STEP: Define SelectionVariant and SelectionPresentationVariant annotations (OData V4 - XML)
DESCRIPTION: Define SelectionVariant (SV) and SelectionPresentationVariant (SPV) annotations in the service annotations XML. Use Qualifier to reference the annotation from the manifest views.paths annotationPath.
LANGUAGE: XML
CODE:
```XML
<!-- SelectionVariant for entityB -->
<Annotations Target="myService.entityB">
  <Annotation Term="UI.SelectionVariant" Qualifier="One">
    <Record Type="UI.SelectionVariantType">
      <PropertyValue Property="SelectOptions">
        <Collection>
          <Record Type="UI.SelectOptionType">
            <PropertyValue Property="PropertyName" PropertyPath="propertyInteger" />
            <PropertyValue Property="Ranges">
              <Collection>
                <Record Type="UI.SelectionRangeType">
                  <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                  <PropertyValue Property="Low" String="1" />
                </Record>
              </Collection>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Text" String="entityA with one follower" />
    </Record>
  </Annotation>
</Annotations>

<!-- SelectionPresentationVariant for entityA -->
<Annotations Target="myService.entityA">
  <Annotation Term="UI.SelectionPresentationVariant" Qualifier="trueSPV">
    <Record Type="UI.SelectionPresentationVariantType">
      <PropertyValue Property="Text" String="entityB with true value" />
      <PropertyValue Property="SelectionVariant">
        <Record Type="UI.SelectionVariantType">
          <PropertyValue Property="SelectOptions">
            <Collection>
              <Record Type="UI.SelectOptionType">
                <PropertyValue Property="PropertyName" PropertyPath="propertyBoolean" />
                <PropertyValue Property="Ranges">
                  <Collection>
                    <Record Type="UI.SelectionRangeType">
                      <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                      <PropertyValue Property="Low" String="true" />
                    </Record>
                  </Collection>
                </PropertyValue>
              </Record>
            </Collection>
          </PropertyValue>
          <PropertyValue Property="Text" String="Medium Rating" />
        </Record>
      </PropertyValue>
      <PropertyValue Property="PresentationVariant">
        <Record Type="UI.PresentationVariantType">
          <PropertyValue Property="MaxItems" Int="3" />
          <PropertyValue Property="SortOrder">
            <Collection>
              <Record Type="Common.SortOrderType">
                <PropertyValue Property="Property" PropertyPath="propertyInteger" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Define SelectionVariant and SelectionPresentationVariant annotations (CAP CDS)
DESCRIPTION: Equivalent SPV/SV definitions in CAP CDS; use annotation keys UI.SelectionVariant#Qualifier and UI.SelectionPresentationVariant#Qualifier and annotate the corresponding entities.
LANGUAGE: CDS
CODE:
```CDS
annotate my.namespace.entityB with @(
  UI.SelectionVariant#One : {
    Text: 'entityA with one follower',
    SelectOptions: [
      {
        $Type : 'UI.SelectOptionType',
        PropertyName : propertyInteger,
        Ranges: [
          {
            $Type: 'UI.SelectionRangeType',
            Option: #EQ,
            Low: '1'
          }
        ]
      }
    ]
  }
);

annotate my.namespace.entityA with @(
  UI.SelectionPresentationVariant#trueSPV : {
    Text: 'entityB with true value',
    SelectionVariant: {
      SelectOptions: [
        {
          $Type : 'UI.SelectOptionType',
          PropertyName : propertyBoolean,
          Ranges: [
            {
              $Type: 'UI.SelectionRangeType',
              Option: #EQ,
              Low: 'true'
            }
          ]
        }
      ]
    },
    PresentationVariant: {
      MaxItems: 3,
      SortOrder: [{ Property: 'ID' }]
    }
  }
);
```

STEP: Configure views and entitySet per tab (OData V4 manifest.json targets)
DESCRIPTION: In the manifest for OData V4 Fiori Elements (sap.fe.templates.ListReport), set the page's contextPath to the main entitySet and add views.paths entries for each tab. When a tab uses a different entity set, include "entitySet" plus the annotationPath referencing the SV or SPV Qualifier.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui5": {
    "routing": {},
    "targets": {
      "DraftList": {
        "type": "Component",
        "id": "DraftList",
        "name": "sap.fe.templates.ListReport",
        "options": {
          "settings": {
            "contextPath": "/entityA",
            "views": {
              "paths": [
                {
                  "key": "tab1",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#trueSPV"
                },
                {
                  "key": "tab2",
                  "entitySet": "entityB",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#One"
                }
              ]
            }
          }
        }
      }
    }
  }
}
```

STEP: Define per-entity controlConfiguration (manifest.json)
DESCRIPTION: Use controlConfiguration to define per-entity table personalization or other control-level settings. Prefix annotation keys with "/EntityName/" to target that specific entity's annotation (e.g., "/EntityB/@com.sap.vocabularies.UI.v1.LineItem").
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui5": {
    "routing": {},
    "targets": {
      "DraftList": {
        "type": "Component",
        "id": "DraftList",
        "name": "sap.fe.templates.ListReport",
        "options": {
          "settings": {
            "contextPath": "/EntityA",
            "views": {
              "paths": [
                {
                  "key": "tab1",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant"
                },
                {
                  "key": "tab2",
                  "entitySet": "EntityB",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant"
                }
              ]
            },
            "controlConfiguration": {
              "@com.sap.vocabularies.UI.v1.LineItem": {
                "tableSettings": {
                  "personalization": false
                }
              },
              "/EntityB/@com.sap.vocabularies.UI.v1.LineItem": {
                "tableSettings": {
                  "personalization": {
                    "column": true,
                    "sort": false,
                    "filter": true,
                    "group": false
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Table type behavior notes (actionable)
DESCRIPTION: When configuring table types:
- If no variant-specific tableSettings exist, the global table setting is applied to the variant.
- You can render different table types per tab (e.g., first tab TreeTable, second tab GridTable), but do not mix responsive with non-responsive tables in the same app.
LANGUAGE: Text
CODE:
```Text
Actionable:
- Prefer explicit "tableSettings.type" per variant for clarity.
- Ensure global and per-variant table types are consistent with responsiveness constraints.
```

STEP: Related resources
DESCRIPTION: Use linked examples for navigation across detail pages or deeper customizations.
LANGUAGE: Text
CODE:
```Text
See also: Example: Enable Internal Navigation to Different Detail Page (example-enable-internal-navigation-to-different-detail-page-75002b3.md)
```
--------------------------------

**TITLE**: Configure Request Grouping and Lazy Loading for Object Page (SAP Fiori elements, OData V4)

**INTRODUCTION**: This guide shows how to control request grouping for header KPIs (DataPoint) and MicroCharts, and explains the built-in lazy-loading behavior of Object Page in SAP Fiori elements for OData V4. Use the manifest.json controlConfiguration to assign request groups so backend calls are batched as intended. Also learn the runtime batching behavior and when lazy loading triggers additional requests.

**TAGS**: fiori-elements-framework, ODataV4, object-page, request-groups, lazy-loading, manifest.json, controlConfiguration, DataPoint, MicroChart

**STEP**: Request group names and intended use

**DESCRIPTION**: Use these pre-defined request group names when assigning header elements to batch groups. Choose the group based on element type and expected latency.

- Heroes: requests for all fields from the main entity set; all 1:1 multiplicity fields from header forms or KPIs (DataPoints and MicroCharts) and visible section forms.
- Workers: all tables.
- Decoration: all 1-n multiplicity micro charts in the header.
- LongRunners: slow/complex KPIs (not used by Fiori elements by default; available for app use to batch separately).

**LANGUAGE**: Text

**CODE**:
```text
Request groups:
- "Heroes"
- "Workers"
- "Decoration"
- "LongRunners"
```

**STEP**: Configure controlConfiguration in manifest.json for header DataPoint and MicroChart annotations

**DESCRIPTION**: In webapp/manifest.json, under the ObjectPage component options → settings → controlConfiguration, set keys using the annotation path of the header control (annotation term + qualifier or navigation path). Assign requestGroupId to one of the request groups. The key must match the annotation path used in the header.

- Path: webapp/manifest.json
- Location: sap.ui5 > componentUsages or sap.app > "component" entry for the Fiori elements object page (example below uses a component entry where the ObjectPage component is configured).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "componentUsages": {
      "SalesOrderManageObjectPage": {
        "name": "sap.fe.templates.ObjectPage",
        "settings": {
          "contextPath": "/SalesOrderManage",
          "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.DataPoint#NetValue": {
              "requestGroupId": "Workers"
            },
            "_CreditLimitDetails/@com.sap.vocabularies.UI.v1.Chart#CreditLimitChart": {
              "requestGroupId": "LongRunners"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Example minimal manifest.json snippet (component entry variant)

**DESCRIPTION**: If your app defines the ObjectPage as a component under "components" (component entry variant), configure similarly in options → settings. This snippet mirrors the sample code pattern in many Fiori elements apps.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "my.app"
  },
  "sap.ui5": {
    "components": {
      "SalesOrderManageObjectPage": {
        "type": "Component",
        "id": "SalesOrderManageObjectPage",
        "name": "sap.fe.templates.ObjectPage",
        "options": {
          "settings": {
            "contextPath": "/SalesOrderManage",
            "controlConfiguration": {
              "@com.sap.vocabularies.UI.v1.DataPoint#NetValue": {
                "requestGroupId": "Workers"
              },
              "_CreditLimitDetails/@com.sap.vocabularies.UI.v1.Chart#CreditLimitChart": {
                "requestGroupId": "LongRunners"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Behavior and caveats of request grouping at runtime

**DESCRIPTION**: Runtime notes you must handle in code and tests:

- Fiori elements fires the named batch groups in parallel, but cannot fully control the underlying model. Some requests in the same group may be prepared/fired at slightly different times.
- Use requestGroupId to indicate batching intent, but the model may split or reorder requests: e.g., a DataPoint assigned to "Workers" can be fired before a table request in the same group.
- Recommendation: Place LongRunners (slow KPIs) visually to the right in the header so left-most visible KPIs load from faster default groups (Heroes/Workers).
- LongRunners is available for apps to separate slow requests; Fiori elements itself does not automatically use LongRunners.

**LANGUAGE**: Text

**CODE**:
```text
Caveats:
- Batching intent declared via requestGroupId is recommended but not guaranteed by the model runtime.
- Expect parallel batch groups with slight delays; validate performance and ordering in integration tests.
```

**STEP**: Lazy loading behavior for Object Page (OData V4)

**DESCRIPTION**: Lazy loading is enabled by default and cannot be disabled. The Object Page delays data calls for sections not in the current viewport. Use these rules to predict requests and design UX:

- Simple scenario (header has no micro charts AND no section contains a table):
  - Two batch requests initially:
    1. Header request (fields, header KPIs)
    2. Section data request for:
       - Desktop: first three subsections
       - Touch devices (tablet/phone): only currently visible subsections

- Complex scenario (header has micro charts OR any form section has a table):
  - Two additional batch calls (in parallel to the basic calls):
    - Table requests (each table may go in a separate batch request)
    - All micro charts in the header (separate batch)
  - So initial requests include header, visible sections, table(s), and micro chart(s) distributed across batch groups.

- Scrolling behavior:
  - When the user scrolls and a subsection becomes visible, a separate batch request is sent for that subsection's data.

- Error handling and messages:
  - If the backend returns error messages for fields not visible in the current section, lazy loading is switched off and additional sections are loaded automatically so the message can link to the related field.

- Subsequent navigation:
  - On later loads of the same object page instance (e.g., navigate back to list and then open another object), header and visible subsection requests are combined into a single batch GET request.

**LANGUAGE**: Text

**CODE**:
```text
Lazy loading rules (summary):
- Default: enabled and mandatory for OData V4 Object Page.
- Simple scenario: initial header + visible sections (2 batch executions).
- Complex scenario: header + visible sections + separate batches for tables and header micro charts (parallel).
- Scrolling: each newly visible subsection triggers its own batch.
- Backend errors for invisible fields: disable lazy loading and load additional sections to show/resolve the message.
- Subsequent loads: header + visible subsections often combined in one GET batch.
```

**STEP**: Testing and validation checklist

**DESCRIPTION**: Validate request grouping and lazy loading in integration tests and performance testing:

- Inspect network calls:
  - Verify requestGroupId assignments in manifest and observe whether intended groups are batched.
  - Confirm LongRunners calls are separated and appear later (if assigned).
- Test scenarios on desktop and touch devices to confirm different visible-subsection behavior.
- Test error cases where backend issues for invisible fields trigger loading of other sections.
- Ensure visual ordering of header KPIs follows the recommendation to place slow KPIs on the right.

**LANGUAGE**: Text

**CODE**:
```text
Test checklist:
- Check manifest controlConfiguration keys exactly match header annotation paths/qualifiers.
- Validate network batch requests for Heroes / Workers / Decoration / LongRunners as intended.
- Test scrolling to trigger subsection loads.
- Simulate backend field errors for invisible fields and confirm lazy loading behavior changes.
- Measure perceived load time when moving LongRunners to the right side of the header.
```
--------------------------------

**TITLE**: Defining Object Page Subsection Loading Behavior (manifest.json)

**INTRODUCTION**: Configure when a subsection in a Fiori elements Object Page activates its OData binding by adding a loadingBehavior block in the app manifest. Use this to delay binding until header data is available or until the subsection enters the viewport. Applicable for SAP Fiori elements for OData V2.

**TAGS**: fiori-elements-framework, manifest, object-page, loadingBehavior, subsections, odata-v2, sections

STEP: 1 — Identify the subsection id
DESCRIPTION: Locate the subsection id used in the Object Page settings in your manifest. This id is the key under "sections" for the object page (e.g., "SalesOrderItemsID", "ContactsID").
LANGUAGE: text
CODE:
```text
# Example subsection ids you will find under:
# manifest.json -> pages -> "<ObjectPageKey>" -> component -> settings -> sections
# Keys such as "SalesOrderItemsID" and "ContactsID" are subsection ids.
```

STEP: 2 — Add loadingBehavior for a subsection
DESCRIPTION: Under the relevant object page (or subobject page) entry in the manifest, add a loadingBehavior block as a child of the subsection id inside settings.sections. Set boolean flags:
- waitForHeaderData: true => subsection waits until header data has loaded before activating its binding (useful for tables/charts that need header-based filters via onBeforeRebindTableExtension).
- waitForViewportEnter: true => subsection waits to enter the viewport before activating binding.
If a property is omitted, it is considered false.
LANGUAGE: JSON
CODE:
```json
{
  "pages": {
    "ObjectPage|My_EntitySet": {
      "entitySet": "My_EntitySet",
      "component": {
        "name": "sap.suite.ui.generic.template.ObjectPage",
        "settings": {
          "sections": {
            "MySubsectionID": {
              "navigationProperty": "to_Items",
              "entitySet": "My_ItemEntitySet",
              "loadingBehavior": {
                "waitForHeaderData": true,
                "waitForViewportEnter": false
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — Default behavior and single-property rule
DESCRIPTION: If you do not define loadingBehavior, defaults are:
- waitForHeaderData: false
- waitForViewportEnter: true
If you define only one of the two properties, the other is implicitly treated as false.
LANGUAGE: JSON
CODE:
```json
// Default behavior (applies when loadingBehavior is not defined):
{
  "loadingBehavior": {
    "waitForHeaderData": false,
    "waitForViewportEnter": true
  }
}

// If only one property is defined, the other is false. Example:
{
  "loadingBehavior": {
    "waitForHeaderData": true
    // => waitForViewportEnter is implicitly false
  }
}
```

STEP: 4 — Full manifest snippet (practical example)
DESCRIPTION: Example placing loadingBehavior for two subsections in a real Object Page entry. This snippet shows usage in the pages block of the manifest.
LANGUAGE: JSON
CODE:
```json
{
  "pages": {
    "ObjectPage|C_STTA_SalesOrder_WD_20": {
      "entitySet": "C_STTA_SalesOrder_WD_20",
      "component": {
        "name": "sap.suite.ui.generic.template.ObjectPage",
        "settings": {
          "sections": {
            "SalesOrderItemsID": {
              "navigationProperty": "to_Item",
              "entitySet": "C_STTA_SalesOrderItem_WD_20",
              "createMode": "inline",
              "tableSettings": {
                "inlineDelete": true
              },
              "loadingBehavior": {
                "waitForHeaderData": true,
                "waitForViewportEnter": false
              }
            },
            "ContactsID": {
              "loadingBehavior": {
                "waitForHeaderData": false,
                "waitForViewportEnter": false
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Common configuration patterns
DESCRIPTION: Quick recommendations for typical scenarios:
- Table/chart that requires header-dependent filters: set waitForHeaderData = true and waitForViewportEnter = false.
- Prefetch subsection together with header: set waitForViewportEnter = false (so loading is independent of viewport).
- Lazy-load subsections when scrolled into view: set waitForViewportEnter = true (default).
LANGUAGE: JSON
CODE:
```json
// Table needs header filters:
"loadingBehavior": { "waitForHeaderData": true, "waitForViewportEnter": false }

// Prefetch with header without viewport dependency:
"loadingBehavior": { "waitForHeaderData": false, "waitForViewportEnter": false }

// Lazy load on viewport enter (default behavior):
// Either omit loadingBehavior or:
"loadingBehavior": { "waitForHeaderData": false, "waitForViewportEnter": true }
```
--------------------------------

**TITLE**: Deploy a SAP Fiori (UI5 / Fiori Elements) Application to SAP BTP (VS Code / Business Application Studio / CLI)

**INTRODUCTION**: Step-by-step actionable instructions and concrete code/config examples to build and deploy a SAP Fiori (UI5 / Fiori Elements) application from Visual Studio Code or SAP Business Application Studio, and via CLI (build an MTA archive). Includes example package.json scripts, ui5 build commands, minimal mta.yaml and manifest.yml templates you can adapt to your environment.

**TAGS**: fiori-elements-framework, ui5, sap-fiori-tools, sap-btp, cloud-foundry, build, deploy, mta, manifest

**STEP**: 1. Prerequisites and environment setup

**DESCRIPTION**: Install required CLIs and project dev dependencies. Confirm you have an SAP BTP account and the necessary permissions (Cloud Foundry space or ABAP/trusted system depending on target).

**LANGUAGE**: Shell

**CODE**:
```bash
# Example prerequisites (install once)
# Node.js & npm (use official Node installer)
node -v
npm -v

# UI5 CLI (used to build UI5 apps)
npm install --save-dev @ui5/cli
# Optional: global install for convenience
npm install -g @ui5/cli

# Multi-Target Application (MTA) build tool (creates .mtar)
npm install -g mbt

# Cloud Foundry CLI (for CF target)
# Follow: https://docs.cloudfoundry.org/cf-cli/install-go-cli.html
cf --version

# Visual Studio Code or Business Application Studio installed
# Install SAP Fiori tools extensions in VS Code:
# - SAP Fiori tools - Application development
# - SAP Fiori tools - Deployment (if available)
```

**STEP**: 2. Build the UI5 / Fiori application locally (recommended)

**DESCRIPTION**: Use UI5 CLI to produce the distributable output under a "dist" (or "webapp") folder. Add npm scripts to automate builds.

**LANGUAGE**: JSON

**CODE**:
```json
// package.json (scripts section example)
{
  "scripts": {
    "install": "npm ci",
    "build": "ui5 build --clean --config=ui5.yaml --include=all",
    "start": "ui5 serve -o index.html"
  },
  "devDependencies": {
    "@ui5/cli": "^3.0.0"
  }
}
```

**LANGUAGE**: Shell

**CODE**:
```bash
# From project root:
npm ci
npm run build
# Output will be in the "dist" folder (default for many projects) or configured path in ui5.yaml
ls -la dist
```

**STEP**: 3. Minimal manifest.yml for Cloud Foundry (single-app deploy)

**DESCRIPTION**: Example manifest to push the static UI5 distribution to Cloud Foundry using a static/HTML buildpack. Replace placeholders with your route and org/space details. This is a minimal example — your environment might require html5-apps-repo or different buildpacks.

**LANGUAGE**: YAML

**CODE**:
```yaml
# manifest.yml - Cloud Foundry single-app example
applications:
  - name: my-ui5-app            # change to your app name
    path: dist                  # path to built UI5 assets
    memory: 128M
    buildpacks:
      - staticfile_buildpack    # or use nodejs_buildpack if needed
    routes:
      - route: my-ui5-app.cfapps.<region>.hana.ondemand.com
```

**STEP**: 4. Minimal mta.yaml for MTA packaging (.mtar) for Cloud Foundry deployment

**DESCRIPTION**: Multi-target application packaging allows bundling UI5 frontend with backend modules or services. This minimal mta.yaml points the html5 module at the built dist directory. Adapt to include services and backend modules if present.

**LANGUAGE**: YAML

**CODE**:
```yaml
ID: com.example.myapp
_schema-version: "3.1"
version: 0.0.1
modules:
  - name: my-ui5-app
    type: html5
    path: dist
    parameters:
      buildpack: nodejs_buildpack
    provides: []
resources: []
```

**STEP**: 5. Build the MTA archive (.mtar)

**DESCRIPTION**: Use the MTA build tool to create a deployable .mtar. Use the -p flag to produce artifacts for Cloud Foundry (p=cf). The resulting .mtar will be used by your SAP BTP cockpit or CI/CD to deploy.

**LANGUAGE**: Shell

**CODE**:
```bash
# From project root where mta.yaml exists
# Ensure 'mbt' is installed globally (see prerequisites)
mbt build -p=cf
# Output: mta_archives/<project_name>_<version>.mtar
ls -la mta_archives/*.mtar
```

**STEP**: 6. Deploy from Visual Studio Code (SAP Fiori tools)

**DESCRIPTION**: Use SAP Fiori Tools extensions in VS Code to deploy via the command palette. This launches the Fiori deploy wizard (choose Cloud Foundry or ABAP target and follow prompts).

**LANGUAGE**: Text

**CODE**:
```text
# In VS Code:
# 1. Open Command Palette (Ctrl+Shift+P or Cmd+Shift+P)
# 2. Run: "Fiori: Deploy Application" (or "Fiori: Deploy to SAP Business Technology Platform")
# 3. Select project, choose target (Cloud Foundry or ABAP), choose build output (dist), provide BTP / CF credentials
# Follow the prompts to complete deployment.
```

**STEP**: 7. Deploy from SAP Business Application Studio (BAS)

**DESCRIPTION**: BAS provides a guided Deploy wizard in the application context menu. Use the BAS UI to pick the deployment target (Cloud Foundry or ABAP) and upload the built artifacts or .mtar.

**LANGUAGE**: Text

**CODE**:
```text
# In Business Application Studio:
# 1. Right-click the project in Workspace > 'Deploy' or open the 'SAP Fiori tools' menu
# 2. Start the Deploy wizard, select target (Cloud Foundry / ABAP), and follow steps to push the app
# 3. For Cloud Foundry you can upload the generated .mtar or push the dist folder as an app depending on workspace setup
```

**STEP**: 8. Deploy via Cloud Foundry CLI (simple manifest push) or upload .mtar to SAP BTP cockpit

**DESCRIPTION**: Use cf CLI to push with manifest.yml, or upload the .mtar via SAP BTP cockpit (Cloud Foundry -> Multi-Target Applications / HTML5 Applications) to deploy. Authenticate and select org/space first.

**LANGUAGE**: Shell

**CODE**:
```bash
# 1) CF manifest push (simple app push)
cf login -a https://api.<region>.cf.cloud.sap --sso    # or username/password
cf target -o <org> -s <space>
cf push -f manifest.yml

# 2) Upload .mtar via SAP BTP cockpit (manual):
# - Open SAP BTP Cockpit -> Subaccount -> Space -> Continuous Integration / Multitarget apps or Deploy -> Upload MTA Archive
# - Select the .mtar from mta_archives/ and follow prompts to deploy
```

**STEP**: 9. Post-deploy verification

**DESCRIPTION**: Validate the deployed route, check logs, and test the application in the browser. Use CF apps or cockpit to view logs and status.

**LANGUAGE**: Shell / Text

**CODE**:
```bash
# Check app status & logs with CF
cf apps
cf logs my-ui5-app --recent

# Verify route open in browser
# https://my-ui5-app.cfapps.<region>.hana.ondemand.com
```

**STEP**: 10. Notes and troubleshooting tips

**DESCRIPTION**: Quick actionable tips when things fail: ensure build output path matches mta.yaml/manifest, confirm target credentials and permissions, and check required services (html5-apps-repo) for deployment scenarios that use SAP HTML5 application repository.

**LANGUAGE**: Text

**CODE**:
```text
- Ensure the dist (or webapp) folder is referenced correctly in mta.yaml / manifest.yml.
- If using HTML5 Application Repository on SAP BTP, you may need specific deployment steps (upload to HTML5 repo service).
- For ABAP deployments, use the SAP Fiori tools wizard (it packages and pushes to ABAP repository / transport).
- Use cf logs <app> --recent to capture runtime errors; use browser DevTools to debug UI issues.
- Use CI/CD pipelines to automate: build (ui5 build), package (mbt build), deploy (.mtar upload or cf push).
```

--------------------------------

**TITLE**: Analytical List Page (ALP) descriptor configuration for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: Practical, copy-pasteable manifest.json snippets and action-oriented guidance to enable and configure the Analytical List Page (ALP) in SAP Fiori Elements. Includes OData V2 ALP floorplan configuration, table and KPI settings, inner/external navigation, and how to enable ALP as a List Report flavor in OData V4 with views configuration.

**TAGS**: fiori-elements-framework, ALP, manifest.json, OData V2, OData V4, tableSettings, KPI, keyPerformanceIndicators, views, crossNavigation

**STEP**: 1 — Enable ALP in manifest.json (OData V2)

**DESCRIPTION**: Add the sap.ui.generic.app configuration for the Analytical List Page. Provide the main entity set, must-use component name, ALP settings (tableSettings, qualifier, filter & view defaults), KPI configuration, and inner page navigation to an ObjectPage. Important constraints:
- component.name must be "sap.suite.ui.generic.template.AnalyticalListPage".
- tableSettings.type: supported values "AnalyticalTable", "GridTable", "ResponsiveTable". Do NOT set "AnalyticalTable" unless the service is an aggregate service.
- multiSelect only effective when Actions exist in annotations or ControllerExtension.
- selectAll and selectionLimit apply to GridTable and AnalyticalTable.
- qualifier selects SelectionPresentationVariant/PresentationVariant.
- keyPerformanceIndicators.model must reference a model defined in the manifest models section.
- KPI detailNavigation must point to an outbound in sap.apps.crossNavigation.outbounds.
- Inner "pages" config performs inner navigation to a target smart template (ObjectPage in example).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.2.0",
    "settings": {
      "flexibleColumnLayout": {
        "defaultTwoColumnLayoutType": "TwoColumnsBeginExpanded"
      }
    },
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "tableSettings": {
              "type": "AnalyticalTable",
              "multiSelect": true,
              "selectAll": true,
              "selectionLimit": 20
            },
            "qualifier": "DefaultPresentationVariant",
            "condensedTableLayout": true,
            "smartVariantManagement": true,
            "defaultContentView": "charttable",
            "defaultFilterMode": "visual",
            "showGoButtonOnFilterBar": false,
            "contentTitle": "{{contentAreaTitle}}",
            "autoHide": false,
            "filterDefaultsFromSelectionVariant": false,
            "allFiltersAsInParameters": true,
            "keyPerformanceIndicators": {
              "KPIRevenue": {
                "model": "kpi",
                "entitySet": "SEPMRA_C_ALP_TotalSalesKPI",
                "qualifier": "KPIRevenue",
                "detailNavigation": "OverviewPage",
                "groupId": "mainKpiGroup"
              }
            }
          }
        },
        "pages": [
          {
            "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage"
            },
            "navigation": {
              "display": {
                "path": "sap.apps.crossNavigation.outbounds",
                "target": "NavigateToCTRItem"
              }
            }
          }
        ]
      }
    ]
  }
}
```

**STEP**: 2 — Table settings (options and constraints)

**DESCRIPTION**: Use this focused example when you only need to configure table behavior. Key points:
- type: choose "AnalyticalTable" (aggregate services only), "GridTable" or "ResponsiveTable".
- multiSelect: enables multi-selection when Actions are present.
- selectAll: selects all rows from backend using current filters (one batch call).
- selectionLimit: max rows selectable in range; default 200 if omitted.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "tableSettings": {
    "type": "GridTable",
    "multiSelect": true,
    "selectAll": true,
    "selectionLimit": 20
  }
}
```

**STEP**: 3 — KPI configuration and batching (keyPerformanceIndicators)

**DESCRIPTION**: Configure KPIs that appear as KPI tags/cards. Provide:
- model: reference to a manifest model name providing KPI data source.
- entitySet: KPI entity set used for KPI details.
- qualifier: UI.KPI qualifier to pick the right annotation.
- detailNavigation: outbound name inside sap.apps.crossNavigation.outbounds for footer navigation.
- groupId: optional grouping key to batch KPI calls. KPIs with same data source and same groupId are considered for batching. Different data sources always trigger separate batch calls.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "keyPerformanceIndicators": {
    "KPIRevenue": {
      "model": "kpi",
      "entitySet": "SEPMRA_C_ALP_TotalSalesKPI",
      "qualifier": "KPIRevenue",
      "detailNavigation": "OverviewPage",
      "groupId": "mainKpiGroup"
    },
    "KPIOrders": {
      "model": "kpi",
      "entitySet": "SEPMRA_C_ALP_OrderCountKPI",
      "qualifier": "KPIOrders",
      "detailNavigation": "OrdersOverview",
      "groupId": "mainKpiGroup"
    }
  }
}
```

**STEP**: 4 — Inner and external navigation from ALP (ObjectPage + crossNavigation)

**DESCRIPTION**: Inner-pages array enables navigation inside the app (for example to an ObjectPage). Use navigation.display.path to reference outbound definitions for external navigation. Set navigation.display.target to the outbound key defined in sap.app/crossNavigation/outbounds.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "pages": [
    {
      "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
      "component": {
        "name": "sap.suite.ui.generic.template.ObjectPage"
      },
      "navigation": {
        "display": {
          "path": "sap.apps.crossNavigation.outbounds",
          "target": "NavigateToCTRItem"
        }
      }
    }
  ]
}
```

**STEP**: 5 — Enable ALP flavor in OData V4 List Report (views configuration)

**DESCRIPTION**: In OData V4, ALP is a List Report flavor. Configure the List Report target with "views" to specify primary (chart/PV) and secondary (table/LineItem) annotation paths and set "defaultPath" to "primary", "secondary", or "both". Primary annotationPath may be UI.Chart, UI.PresentationVariant or UI.SelectionPresentationVariant. Secondary may be UI.LineItem, UI.PresentationVariant, or UI.SelectionPresentationVariant. Important:
- If primary points to a PresentationVariant/SelectionPresentationVariant, the first chart visualization is used.
- If a PresentationVariant has no chart, the default UI.Chart (no qualifier) is used; otherwise a blank chart renders.
- If a specified annotationPath is missing, there is no fallback — the app fails to load.
- Do not use arrays for "paths", "primary" and "secondary" even if the manifest structure shows arrays — prefer single objects.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "targets": {
    "BusinessPartnersList": {
      "name": "sap.fe.templates.ListReport",
      "options": {
        "settings": {
          "contextPath": "/BusinessPartners",
          "views": {
            "paths": {
              "primary": {
                "annotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#ProductSalesPV"
              },
              "secondary": {
                "annotationPath": "com.sap.vocabularies.UI.v1.LineItem"
              },
              "defaultPath": "both"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — Primary/Secondary behavior and fallback rules (summary)

**DESCRIPTION**: Quick actionable rules for developers:
- Primary: UI.Chart | UI.PresentationVariant | UI.SelectionPresentationVariant. If PV/S-PV found, pick first chart; if none, try default UI.Chart; if none -> blank chart.
- Secondary: UI.LineItem | UI.PresentationVariant | UI.SelectionPresentationVariant. If PV/S-PV found, pick first LineItem; else try default UI.LineItem; if none -> blank table.
- defaultPath: "primary" (chart-only), "secondary" (table-only), "both" (hybrid).
- Missing annotationPath -> app fails to load (no fallback).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "views_behavior": {
    "primary_allowed": [
      "UI.Chart",
      "UI.PresentationVariant",
      "UI.SelectionPresentationVariant"
    ],
    "secondary_allowed": [
      "UI.LineItem",
      "UI.PresentationVariant",
      "UI.SelectionPresentationVariant"
    ],
    "defaultPath_options": [
      "primary",
      "secondary",
      "both"
    ],
    "note": "If an annotationPath is missing the app will fail to load. Avoid arrays for paths/primary/secondary."
  }
}
```
--------------------------------

**TITLE**: Descriptor Configuration for SAP Fiori Overview Page (sap.ovp) — manifest.json Examples

**INTRODUCTION**: This document provides actionable, copy-paste-ready descriptor examples and concise explanations for configuring the Overview Page (OVP) via manifest.json. Use these snippets to enable global filter behaviour, data loading, card definitions, layout modes (fixed vs resizable), default card sizing, lazy rendering, and refresh intervals.

**TAGS**: fiori-elements, sapui5, manifest.json, sap.ovp, overview-page, cards, lazy-loading, descriptor, OVP

**STEP**: 1 — Add sap.ovp top-level descriptor section

**DESCRIPTION**: Add the sap.ovp top-level configuration object to your manifest.json. Use these keys to configure global filter model/entity, container layout, live filter behavior, data load policy, card refresh, lazy rendering, and other global OVP settings. Replace placeholder values with your app-specific names and IDs.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Insert this structure into manifest.json under the root object.
// Example: { "sap.app": { ... }, "sap.ui5": { ... }, "sap.ovp": { ... } }

"sap.ovp": {
  // Models and Global Filters
  "globalFilterModel": "ZModelName",               // OData model containing entities for global filters
  "globalFilterEntityType": "ZFilterEntityType",   // (deprecated since SAPUI5 1.54)
  "globalFilterEntitySet": "ZFilterEntitySet",     // Use from SAPUI5 1.54+

  // Layout and rendering
  "containerLayout": "resizable",                  // "fixed" (default) or "resizable"
  "enableLazyRendering": true,                     // Render visible cards first, lazy render on scroll
  // Note: You can also mimic enableLazyRendering via URL param sap-fe-xx-lazyloadingtest=true

  // Filter / Variant behavior
  "smartVariantRequired": true,                    // Enable smart variant management for global filters
  "enableLiveFilter": false,                       // true = live updates; false = manual Go button
  "considerAnalyticalParameters": true,            // Enable analytical parameter support
  "useDateRangeType": true,                        // Use semantic date range control (default false)

  // Data load & refresh
  "dataLoadSettings": {
    "loadDataOnAppLaunch": "ifAnyFilterExist"      // Options: "ifAnyFilterExist" | "always" | "never"
  },
  "refreshIntervalInMinutes": 2,                   // Auto refresh interval for card models

  // Misc
  "imageSupported": true,                          // Allow images/icons in condensed list cards
  "showDateInRelativeFormat": false,               // Use relative date formatting in OVP
  "smartVariantRequired": true,                    // switch for smart variant management
  "enableLazyRendering": true                      // cards in viewport are rendered first
}
```

**STEP**: 2 — Define cards under sap.ovp.cards

**DESCRIPTION**: Add a "cards" object under sap.ovp and define each card by id. Configure card model, template (card component path), settings for title, entitySet, annotations, layout options, sorting, navigation, static content, and authorizations. Use annotation paths that map to your OData service metadata.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Inside "sap.ovp" add a "cards" object. Replace card01, model, and annotation paths accordingly.

"sap.ovp": {
  /* ... other sap.ovp keys ... */
  "cards": {
    "card01": {
      "model": "ZCard1Model",                       // name of the model defined elsewhere in manifest
      "template": "sap.ovp.cards.list",             // card type: list, analytical, table, etc.
      "settings": {
        "title": "Card Title",                      // i18n keys preferable
        "subTitle": "Card Subtitle",
        "entitySet": "zCard1EntitySet",             // OData entity set for the card
        "valueSelectionInfo": "text for KPI Header",
        "listFlavor": "Standard",                   // "Standard" | "Bar"
        "listType": "Extended",                     // "Extended" | "Condensed"
        "sortBy": "zPropertyForSort",
        "sortOrder": "Ascending",                   // "Ascending" | "Descending"
        "showRefresh": false,                       // default true, set false to hide Refresh action

        // Annotation paths (use fully qualified annotation identifiers from metadata)
        "annotationPath": "",
        "kpiAnnotationPath": "com.sap.vocabularies.UI.v1.KPI#AllActualCosts",
        "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#SalesShareBubble",
        "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#SalesShareBubble",
        "dataPointAnnotationPath": "",              // e.g., DataPoint#<id>
        "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#Eval_by_Currency_Scatter",
        "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Eval_by_Currency_ColumnStacked",
        "dynamicSubtitleAnnotationPath": "dynamicSubtitle",
        "requireAppAuthorization": "",              // roles or scopes that are required
        "staticContent": {},                        // used for static link list cards
        "navigation": "noHeaderNav"                 // "noHeaderNav" disables header navigation for analytical list card
      }
    },

    // Example: second card definition (optional)
    "card02": {
      "model": "ZCard2Model",
      "template": "sap.ovp.cards.table",
      "settings": {
        "title": "Table Card",
        "entitySet": "zCard2EntitySet",
        "defaultSpan": { "rows": 5, "cols": 2 }     // per-card default sizing can be set here (fixed layout)
      }
    }
  }
}
```

**STEP**: 3 — Configure defaultSpan for fixed card layout (card sizing)

**DESCRIPTION**: When using fixed layout (containerLayout: "fixed"), configure defaultSpan at either card-level settings or globally per card to define card size and header-only rendering. Use rows to control number of list lines or table rows, cols to control card width based on grid columns, and minimumTitleRow/minimumSubTitleRow to control header text wrapping.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example defaultSpan inside a card's settings (used for fixed layout):
"card01": {
  "model": "ZCard1Model",
  "template": "sap.ovp.cards.list",
  "settings": {
    "title": "Card Title",
    "entitySet": "zCard1EntitySet",
    "defaultSpan": {
      "rows": 7,                  // number of line items to display for list/table cards
      "cols": 2,                  // card width measured in grid columns
      "showOnlyHeader": false,    // true => render only header (no content)
      "minimumTitleRow": 1,       // 1 | 2 | 3 => number of title lines shown
      "minimumSubTitleRow": 1     // 1 | 2 => number of subtitle lines shown
    }
  }
}
```

**STEP**: 4 — Enable resizable layout for end-user card resizing

**DESCRIPTION**: To allow end users to resize cards horizontally and vertically in a grid, set containerLayout to "resizable". Remove per-card fixed constraints if you want full resizability. Keep defaultSpan if you want initial sizes, but users can change them at runtime.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Set at sap.ovp root
"sap.ovp": {
  /* ... other keys ... */
  "containerLayout": "resizable",
  // optional initial sizing for cards (users can resize at runtime)
  "cards": {
    "card01": {
      "settings": {
        "defaultSpan": { "rows": 7, "cols": 2 }
      }
    }
  }
}
```

**STEP**: 5 — Control data load behavior and performance tips (lazy loading)

**DESCRIPTION**: Use dataLoadSettings.loadDataOnAppLaunch to control auto-loading on app start. Choose values "ifAnyFilterExist", "always", or "never". For improving OVP performance, enable descriptor lazy rendering via enableLazyRendering or mimic it with URL parameter sap-fe-xx-lazyloadingtest=true.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Data load behaviour
"sap.ovp": {
  "dataLoadSettings": {
    "loadDataOnAppLaunch": "ifAnyFilterExist" // "ifAnyFilterExist" | "always" | "never"
  },

  // Lazy rendering: renders visible cards first; remaining cards are rendered on scroll
  "enableLazyRendering": true
}

// Alternative: mimic lazy rendering at runtime (no descriptor change required)
// Append to the app launch URL:
//  ?sap-fe-xx-lazyloadingtest=true
```

**STEP**: 6 — Example: Minimal manifest.json fragment with sap.ovp integrated

**DESCRIPTION**: Example of how sap.ovp integrates into a typical manifest.json structure. Insert the sap.ovp object into your manifest root alongside sap.app and sap.ui5.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "my.ovp.app",
    "title": "My Overview Page App"
  },
  "sap.ui5": {
    "models": {
      "ZCard1Model": { "dataSource": "mainService" }
    }
  },
  "sap.ovp": {
    "globalFilterModel": "ZModelName",
    "globalFilterEntitySet": "ZFilterEntitySet",
    "containerLayout": "resizable",
    "smartVariantRequired": true,
    "enableLiveFilter": false,
    "dataLoadSettings": { "loadDataOnAppLaunch": "ifAnyFilterExist" },
    "refreshIntervalInMinutes": 2,
    "enableLazyRendering": true,
    "cards": {
      "card01": {
        "model": "ZCard1Model",
        "template": "sap.ovp.cards.list",
        "settings": {
          "title": "Card Title",
          "entitySet": "zCard1EntitySet",
          "defaultSpan": { "rows": 7, "cols": 2 }
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Extension Functions for Adapting Delivered SAP Fiori elements (OData V2)

**INTRODUCTION**: Practical, code-focused reference of extension hook implementations available for SAP Fiori elements (OData V2). Each step contains what the framework calls, the expected controller-extension implementation pattern, and concise JavaScript examples that show how to call the framework callbacks (fnSetAppStateData, fnGetAppStateData, fnEnsureSelectionProperty, fnAddFilter, fnSetExtensionStateData, fnGetExtensionStateData, etc.).

**TAGS**: fiori-elements, adaptation, extension, odata-v2, list-report, object-page, overview-page, analytical-list-page

**STEP**: onInitSmartFilterBar

**DESCRIPTION**: Implement this hook to run custom initialization when the SmartFilterBar is ready (List Report and Analytical List Page). The framework calls onInitSmartFilterBar when the SmartFilterBar has been initialized. Use it to attach handlers, set default tokens, or inspect the control.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Controller extension file (e.g. extension/MyListReportExtension.controller.js)
sap.ui.define([], function () {
  "use strict";
  return {
    onInitSmartFilterBar: function (oEvent) {
      // oEvent.getSource() is the SmartFilterBar instance
      var oSmartFilterBar = oEvent && oEvent.getSource ? oEvent.getSource() : null;
      if (oSmartFilterBar) {
        // Example: add a change handler
        oSmartFilterBar.attachFilterChange(function () {
          // custom logic
        });
      }
    }
  };
});
```

**STEP**: provideExtensionAppStateData

**DESCRIPTION**: Store extension-specific state into the app state. The framework provides a callback fnSetAppStateData; call it with your controller extension instance and a serializable state object. Applicable to List Report, Analytical List Page, and Overview Page.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Called by framework: provideExtensionAppStateData(fnSetAppStateData)
return {
  provideExtensionAppStateData: function (fnSetAppStateData) {
    // build a serializable state object
    var oAppState = {
      mySelection: this._mySelection || null,
      timestamp: Date.now()
    };
    // fnSetAppStateData(controllerExtensionInstance, oAppState)
    fnSetAppStateData(this, oAppState);
  }
};
```

**STEP**: restoreExtensionAppStateData

**DESCRIPTION**: Restore extension-specific state from the current app state. The framework provides fnGetAppStateData; call it with your controller extension instance. The function returns the stored state or undefined if none/faulty. Applicable to List Report, Analytical List Page, and Overview Page.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Called by framework: restoreExtensionAppStateData(fnGetAppStateData)
return {
  restoreExtensionAppStateData: function (fnGetAppStateData) {
    var oRestored = fnGetAppStateData(this); // returns previously stored oAppState or undefined
    if (oRestored) {
      this._mySelection = oRestored.mySelection;
      // reapply selection/filters, etc.
    }
  }
};
```

**STEP**: ensureFieldsForSelect

**DESCRIPTION**: Ensure fields are included in the $select of the table/entity binding. Implement ensureFieldsForSelect and call fnEnsureSelectionProperty(controllerExtensionInstance, sFieldname) for each required field. sFieldname can be a direct entity field or a relative path using a 1:1 navigation property. Applicable to List Report, Analytical List Page, and Object Page.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Called by framework: ensureFieldsForSelect(sControlId, fnEnsureSelectionProperty)
return {
  ensureFieldsForSelect: function (sControlId, fnEnsureSelectionProperty) {
    // You can check sControlId to restrict to a specific table/list
    if (sControlId === "myTableId" || !sControlId) {
      // Ensure primary key and a navigation property field are selected
      fnEnsureSelectionProperty(this, "SalesOrderID");            // direct field
      fnEnsureSelectionProperty(this, "ToCustomer/CustomerName"); // relative path via 1:1 nav prop
    }
  }
};
```

**STEP**: addFilters

**DESCRIPTION**: Add filters programmatically. Implement addFilters(fnAddFilter) and call fnAddFilter(controllerExtensionInstance, oFilter) for each filter you want to apply. All added filters are combined with other filters using AND. Use sap.ui.model.Filter to construct filters. Applicable to List Report, Analytical List Page, Object Page, and Overview Page.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Called by framework: addFilters(fnAddFilter)
sap.ui.define(["sap/ui/model/Filter", "sap/ui/model/FilterOperator"], function (Filter, FilterOperator) {
  "use strict";
  return {
    addFilters: function (fnAddFilter) {
      // Example: add filter SalesOrderID eq '12345'
      var oFilter1 = new Filter("SalesOrderID", FilterOperator.EQ, "12345");
      fnAddFilter(this, oFilter1);

      // Example: add range filter on Amount
      var oFilter2 = new Filter("Amount", FilterOperator.GE, 1000);
      fnAddFilter(this, oFilter2);
    }
  };
});
```

**STEP**: provideExtensionStateData

**DESCRIPTION**: For Object Page extensions: store extension-specific lifecycle state. Call fnSetExtensionStateData(controllerExtensionInstance, oExtensionState) with a serializable oExtensionState. The framework ignores faulty states. Values for lifecycle parameters (Page, Permanent, etc.) must be provided by the extension where applicable.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Called by framework: provideExtensionStateData(fnSetExtensionStateData)
return {
  provideExtensionStateData: function (fnSetExtensionStateData) {
    var oExtensionState = {
      expandedSections: this._expandedSections || [],
      customFlag: true
    };
    fnSetExtensionStateData(this, oExtensionState);
  }
};
```

**STEP**: restoreExtensionStateData

**DESCRIPTION**: For Object Page extensions: restore previously stored lifecycle state. The framework provides fnGetExtensionStateData(controllerExtensionInstance) and also passes bIsSameAsLast (boolean). Call fnGetExtensionStateData(this) to obtain stored state or undefined. Use bIsSameAsLast to skip reapplication when the view hasn't changed.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Called by framework: restoreExtensionStateData(fnGetExtensionStateData, bIsSameAsLast)
return {
  restoreExtensionStateData: function (fnGetExtensionStateData, bIsSameAsLast) {
    if (bIsSameAsLast) {
      // No adaptation required, view is the same as last time
      return;
    }
    var oSaved = fnGetExtensionStateData(this); // may be undefined
    if (oSaved) {
      this._expandedSections = oSaved.expandedSections || [];
      // reapply expansion state on the object page sections
    }
  }
};
```

**STEP**: provideStartupExtension

**DESCRIPTION**: For Overview Page cards: modify the selection variant that will be set to the filter bar at startup. The parameter received is a reference to the selection variant object used by the overview page; modify it in place.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Called by framework: provideStartupExtension(oSelectionVariant)
return {
  provideStartupExtension: function (oSelectionVariant) {
    // e.g. add a default select option or change parameter
    if (oSelectionVariant && typeof oSelectionVariant.AddSelectOption === "function") {
      // Example API from selection variant libraries; adjust per runtime
      oSelectionVariant.AddSelectOption("Status", "I", "EQ", "Open");
    } else {
      // fallback: if it's a plain object
      oSelectionVariant.defaultStatus = "Open";
    }
  }
};
```

**STEP**: provideExtensionNavigation

**DESCRIPTION**: For Overview Page cards: return a new or modified navigation entry used by the core to perform navigation. The framework calls this function with the standard navigation entry details for a card/context. Return the modified entry object.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Called by framework: provideExtensionNavigation(oNavigationEntry)
return {
  provideExtensionNavigation: function (oNavigationEntry) {
    if (!oNavigationEntry) {
      return oNavigationEntry;
    }
    // modify or extend before returning
    oNavigationEntry.customLabel = "Navigate with extension";
    oNavigationEntry.parameters = oNavigationEntry.parameters || {};
    oNavigationEntry.parameters.fromExtension = "X";
    return oNavigationEntry;
  }
};
```

**STEP**: provideCustomActionPress

**DESCRIPTION**: For Overview Page custom actions: map an action key to a handler function. The core calls provideCustomActionPress and expects the extension to return a function (event handler) that will be invoked when the custom action is pressed.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Called by framework: provideCustomActionPress(sActionKey)
return {
  provideCustomActionPress: function (sActionKey) {
    if (sActionKey === "myCustomAction") {
      // Return the bound handler to be executed on press
      return this.onMyCustomActionPress.bind(this);
    }
    // return undefined for unknown keys
    return undefined;
  },

  onMyCustomActionPress: function (oEvent) {
    // Handler implementation for the custom action press event
    sap.m.MessageToast.show("Custom action pressed");
  }
};
```

**STEP**: provideCustomParameter

**DESCRIPTION**: For Overview Page cards: map a parameter name/key to a method that returns custom parameters (can be synchronous or return a Promise). The framework calls provideCustomParameter(name) and expects a function that resolves to the parameter value(s).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Called by framework: provideCustomParameter(sMethodName)
return {
  provideCustomParameter: function (sMethodName) {
    if (sMethodName === "getCustomParams") {
      return this.getCustomParams.bind(this);
    }
    return undefined;
  },

  getCustomParams: function () {
    // could return an object or a Promise resolving to an object
    return {
      tenant: "T100",
      region: "EMEA"
    };
  }
};
```

**NOTE**: This reference applies only to SAP Fiori elements for OData V2. Preserve serialization constraints when storing state (oAppState / oExtensionState must be serializable).
--------------------------------

**TITLE**: SAP Fiori Elements: Minimal metadata-driven app scaffold (List Report + Object Page)

**INTRODUCTION**: Quick reference and minimal code examples to build a metadata-driven SAP Fiori elements app. Shows file layout, manifest configuration for an OData service + annotation file, a minimal Component.js and index.html to bootstrap the app, and a package.json snippet to run locally with UI5 tooling. Use this to generate or scaffold a working Fiori Elements app with no UI JavaScript coding (UI is driven by OData metadata + annotations).

**TAGS**: fiori-elements, sapui5, odata, annotations, manifest.json, list-report, object-page, ui5-cli

STEP: 1 — Project scaffold / file layout
DESCRIPTION: Create a webapp folder structure and files used in subsequent steps. File paths used in the examples below:
- webapp/manifest.json
- webapp/Component.js
- webapp/index.html
- webapp/annotations/annotations.xml
- package.json (project root)

LANGUAGE: text

CODE:
```
Project root
├─ package.json
└─ webapp
   ├─ index.html
   ├─ Component.js
   ├─ manifest.json
   └─ annotations
      └─ annotations.xml
```

STEP: 2 — manifest.json: declare OData dataSource, annotation file and Fiori elements pages
DESCRIPTION: Configure the main OData service, reference the local XML annotation file, register the model and declare generic Fiori Elements pages (List Report and Object Page). Save as webapp/manifest.json.

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "id": "my.app",
    "type": "application",
    "i18n": "i18n/i18n.properties",
    "applicationVersion": { "version": "1.0.0" }
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "ZProducts",
        "preload": true
      }
    },
    "resources": {}
  },
  "sap.ui": {},
  "dataSources": {
    "ZProducts": {
      "uri": "/sap/opu/odata/sap/ZPRODUCT_SRV;v=2/",
      "type": "OData",
      "settings": {
        "annotations": [
          {
            "type": "XML",
            "uri": "annotations/annotations.xml"
          }
        ]
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        }
      },
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      }
    ]
  }
}
```

STEP: 3 — annotations.xml: provide UI annotations for the service
DESCRIPTION: Create a minimal OData V4 annotation XML describing UI.LineItem for the Products entity. Place this at webapp/annotations/annotations.xml. Fiori elements reads these annotations to render list and object pages without writing UI JS.

LANGUAGE: XML

CODE:
```xml
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:DataServices>
    <!-- Replace Target with the full namespace + EntityType name from your service metadata -->
    <Annotations Target="Namespace.Product">
      <Annotation Term="UI.LineItem">
        <Collection>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="ID"/>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="Name"/>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="Price"/>
          </Record>
        </Collection>
      </Annotation>

      <Annotation Term="UI.HeaderInfo">
        <Record>
          <PropertyValue Property="TypeName" String="Product"/>
          <PropertyValue Property="Title">
            <Record Type="UI.DataField">
              <PropertyValue Property="Value" Path="Name"/>
            </Record>
          </PropertyValue>
        </Record>
      </Annotation>
    </Annotations>
  </edmx:DataServices>
</edmx:Edmx>
```

STEP: 4 — Component.js: minimal component that reads the manifest
DESCRIPTION: Minimal UIComponent implementation that uses manifest.json to configure the app. Save as webapp/Component.js.

LANGUAGE: JavaScript

CODE:
```javascript
sap.ui.define(["sap/ui/core/UIComponent"], function (UIComponent) {
  "use strict";
  return UIComponent.extend("my.app.Component", {
    metadata: {
      manifest: "json"
    }
  });
});
```

STEP: 5 — index.html: bootstrap UI5 and place the ComponentContainer
DESCRIPTION: Basic index.html to bootstrap SAPUI5 and instantiate the component. Save as webapp/index.html.

LANGUAGE: HTML

CODE:
```html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Fiori Elements App</title>
    <script id="sap-ui-bootstrap"
            src="https://sapui5.hana.ondemand.com/resources/sap-ui-core.js"
            data-sap-ui-theme="sap_belize"
            data-sap-ui-libs="sap.m,sap.ui.core"
            data-sap-ui-resourceroots='{"my.app": "./"}'>
    </script>
    <script>
      sap.ui.getCore().attachInit(function () {
        sap.ui.require(["sap/ui/core/ComponentContainer"], function (ComponentContainer) {
          new ComponentContainer({
            name: "my.app",
            settings: { id: "FioriElementsApp" },
            async: true
          }).placeAt("content");
        });
      });
    </script>
  </head>
  <body class="sapUiBody" id="content"></body>
</html>
```

STEP: 6 — package.json: local run with UI5 CLI
DESCRIPTION: Example package.json with a script to run the app locally using @ui5/cli. Place in project root and run npm install && npm start to serve webapp.

LANGUAGE: JSON

CODE:
```json
{
  "name": "fiori-elements-app",
  "version": "0.0.1",
  "scripts": {
    "start": "ui5 serve --open /index.html"
  },
  "devDependencies": {
    "@ui5/cli": "^3.0.0"
  }
}
```

STEP: 7 — Run and verify
DESCRIPTION: Steps to run locally and verify the metadata-driven UI:
1. Install ui5 CLI: npm install
2. Start local server: npm start
3. Open the started URL; the Fiori Elements List Report should render using your OData service and the referenced annotations. No app-specific view/controller code is required because Fiori elements interprets OData metadata and annotations at startup.

LANGUAGE: text

CODE:
```
# From project root
npm install
npm start
# Open the URL printed by ui5 serve (usually http://localhost:8080/index.html)
```

Notes:
- Replace dataSource URI and annotation Target with your real OData service namespace/entity type names.
- Add more UI annotations (SelectionFields, Facets, FieldGroups) in annotations.xml to customize List Report / Object Page behavior and layout.
- For SAP Business Application Studio / BAS, import the same files into a workspace and deploy/run against the back-end system.
--------------------------------

**TITLE**: Developing Reuse Components for SAP Fiori elements (Object Page Sections)

**INTRODUCTION**: Practical, code-focused guidance for implementing SAPUI5 reuse components intended to be embedded as sections within SAP Fiori elements object pages. Covers project structure, property handling, component model usage, lifecycle hooks (stStart/stRefresh), lazy loading, subpage integration, navigation, extension API, and model propagation for OData V2 and V4 scenarios.

**TAGS**: sapui5, fiori-elements, reuse-component, object-page, UIComponent, ReuseComponentSupport, OData, manifest.json, extension-api

STEP: 1 — Choose distribution model (library vs in-app)
DESCRIPTION: Create a reusable library when the component will be shared across multiple apps. For one-time usage keep the reuse component inside the same application project. Always expose a stable view ID declaratively in manifest.json to enable stable control IDs.
LANGUAGE: text
CODE:
```text
- If reused across apps: implement as a library + UI5 component package.
- If used once: include the component under the same app project.
- Ensure view hosting content has a stable ID in manifest.json (declarative view).
```

STEP: 2 — Reuse component vs instance (no singletons)
DESCRIPTION: A reuse component is a software artifact that can be embedded multiple times. An instance is a single embedding. Do not store instance-specific data in module-level singletons; keep state scoped to the component instance (this).
LANGUAGE: text
CODE:
```text
// Avoid patterns like module-scoped objects to store per-instance data.
// Use this.<property> inside the UIComponent instance.
```

STEP: 3 — Declare and consume properties (reserved names)
DESCRIPTION: Declare all properties (including framework-provided ones) in the component metadata. Reserved prefixes and names: do not define methods starting with "st" or "_st" (except documented ones). Property/method name `getComponentModel` is reserved by Fiori elements.
LANGUAGE: text
CODE:
```text
// Predefined properties you must declare in metadata:
- uiMode (string)          // "Create" | "Display" | "Edit"
- semanticObject (string)
- stIsAreaVisible (boolean)

// Prefix rule:
- Property/method names starting with "st" or "_st" must not be defined except documented lifecycle hooks (stStart/stRefresh).
```

STEP: 4 — Component model via ReuseComponentSupport.mixInto (model name, bTwoWaySync)
DESCRIPTION: Call ReuseComponentSupport.mixInto(this[, sModelName, bTwoWaySync]) in init(). If sModelName is provided it creates a JSON component model accessible via getComponentModel(). Changes to component properties are reflected in the component model. bTwoWaySync enables two-way sync (use with caution).
LANGUAGE: JavaScript
CODE:
```javascript
// In UIComponent.init():
// ReuseComponentSupport.mixInto(this, "myPropertiesModelName", /* bTwoWaySync */ false);

// Then access component model:
var oCompModel = this.getComponentModel(); // model name "myPropertiesModelName" if provided
// Bind /documentNumber and attach change handler:
var oPropertyBinding = oCompModel.bindProperty("/documentNumber");
oPropertyBinding.attachChange(function(){
  var sDocumentNumber = oCompModel.getProperty("/documentNumber");
  // react to documentNumber change
});
```

STEP: 5 — Full example: UIComponent implementing properties, overrides, component model, stRefresh/stStart, lazy loading
DESCRIPTION: Combined, production-ready UIComponent example showing metadata properties, ReuseComponentSupport.mixInto usage with model name, overriding predefined setter stIsAreaVisible to trigger refreshImpl, wiring component model property binding for documentNumber, implementing stStart/stRefresh lifecycle hooks, and lazy-loading pattern.
LANGUAGE: JavaScript
CODE:
```javascript
sap.ui.define([
  "sap/ui/core/UIComponent",
  "sap/suite/ui/generic/template/extensionAPI/ReuseComponentSupport"
], function(UIComponent, ReuseComponentSupport) {
  "use strict";

  return UIComponent.extend("my.library.MyReuseComponent", {
    metadata: {
      manifest: "json",
      library: "myLibrary",
      properties: {
        // framework-provided (must be declared)
        uiMode: { type: "string", group: "standard" },
        semanticObject: { type: "string", group: "standard" },
        stIsAreaVisible: { type: "boolean", group: "standard" },
        // component-specific
        documentNumber: { type: "string", group: "specific", defaultValue: "" },
        theNavigationPropertyName: { type: "string", group: "specific", defaultValue: "" }
      }
    },

    init: function() {
      // Defensive super init
      (UIComponent.prototype.init || jQuery.noop).apply(this, arguments);

      // Transform into a Fiori elements reuse component and create component model
      // Provide a model name so bindings inside the component can use it.
      ReuseComponentSupport.mixInto(this, "myPropertiesModelName", false);

      // Example: bind to a component model property
      var oCompModel = this.getComponentModel(); // provided by mixInto
      if (oCompModel) {
        var oBinding = oCompModel.bindProperty("/documentNumber");
        oBinding.attachChange(function() {
          var sDocumentNumber = oCompModel.getProperty("/documentNumber");
          // consume changed document number programmatically
        });
      }
    },

    // Technique 1: override setter for predefined property
    setStIsAreaVisible: function(bIsAreaVisible) {
      if (bIsAreaVisible !== this.getStIsAreaVisible()) {
        this.setProperty("stIsAreaVisible", bIsAreaVisible);
        this.refreshImpl(); // lazy-load / refresh logic
      }
    },

    // Optional lifecycle hook called once per app when first context arrives
    stStart: function(oModel, oBindingContext, oExtensionAPI) {
      this.oModel = oModel;
      this.oBindingContext = oBindingContext;
      this.oExtensionAPI = oExtensionAPI;
      // initial load (only first time)
      this.refreshImpl();
    },

    // Called when embedding page binding context changes or is refreshed
    stRefresh: function(oModel, oBindingContext, oExtensionAPI) {
      this.oModel = oModel;
      this.oBindingContext = oBindingContext;
      this.oExtensionAPI = oExtensionAPI;
      this.refreshImpl();
    },

    // Implementation of lazy loading + refresh
    refreshImpl: function() {
      if (this.oBindingContext && this.getStIsAreaVisible()) {
        // load component data using this.oModel and this.oBindingContext
        // use this.oModel.read(...) or oBindingContext.requestObject() depending on model type
        // After loading, reset binding context flag if desired:
        this.oBindingContext = null;
      }
    }
  });
});
```

STEP: 6 — Declarative binding inside views (use component model)
DESCRIPTION: Use the component model name (provided to mixInto) in view bindings to react declaratively to properties such as uiMode.
LANGUAGE: XML
CODE:
```xml
<!-- Example: SmartForm editable-binding using component model "myPropertiesModelName" -->
<sfo:SmartForm xmlns:sfo="sap.ui.comp.smartform"
               editable="{= ${myPropertiesModelName>/uiMode} !== 'Display' }" />
```

STEP: 7 — Subpages: manifest embeddedComponents snippet (consumer must add)
DESCRIPTION: The reuse component provider publishes a manifest snippet defining possible subpages. Each consumer must add the snippet to their manifest.embeddedComponents entry and map settings (e.g., documentNumber or theNavigationPropertyName).
LANGUAGE: JSON
CODE:
```json
{
  "embeddedComponents": {
    "myComponentEmbedding": {
      "id": "myComponentEmbedding",
      "componentName": "theEmbeddedComponent",
      "title": "{{I18N_KEY_FOR_REUSE_COMPONENT_TITLE}}",
      "settings": {
        "documentNumber": "{documentNumber}",
        "theNavigationPropertyName": "myNavigationProperty"
      },
      "pages": {
        // add sub-pages here; structure same as ObjectPage pages
      }
    }
  }
}
```

STEP: 8 — Using standard ObjectPage as a subpage (manifest example)
DESCRIPTION: Prefer using a standard ObjectPage as subpage. Define a page with key "ObjectPage|<navigationProperty>" and provide navigationProperty, entitySet and component.name = "sap.suite.ui.generic.template.ObjectPage".
LANGUAGE: JSON
CODE:
```json
{
  "embeddedComponents": {
    "myComponentEmbedding": {
      "id": "myComponentEmbedding",
      "componentName": "theEmbeddedComponent",
      "title": "{{I18N_KEY_FOR_REUSE_COMPONENT_TITLE}}",
      "settings": {
        "theNavigationPropertyName": "myNavigationProperty"
      },
      "pages": {
        "ObjectPage|myNavigationProperty": {
          "navigationProperty": "myNavigationProperty",
          "entitySet": "myDependingEntitySet",
          "component": {
            "name": "sap.suite.ui.generic.template.ObjectPage"
          }
        }
      }
    }
  }
}
```

STEP: 9 — Navigate to a subpage programmatically (NavigationController.navigateInternal)
DESCRIPTION: Trigger navigation to a reuse component subpage using the modified NavigationController from the extension API. Retrieve the navigation property name via component property (no hard-coding).
LANGUAGE: JavaScript
CODE:
```javascript
// Example inside a control/event handler inside the reuse component:
var oBindingContext = oEvent.getSource().getBindingContext(); // binding context for target page
var oNavigationController = oExtensionAPI.getNavigationController(); // extension API passed to stRefresh/stStart
var sNavigationProperty = this.getOwnerComponent().getTheNavigationPropertyName(); // reading property declared in metadata
var oNavigationData = { navigationProperty: sNavigationProperty };
oNavigationController.navigateInternal(oBindingContext, oNavigationData);
```

STEP: 10 — Extension API specifics (returned by mixInto)
DESCRIPTION: ReuseComponentSupport.mixInto returns a Promise that resolves to an extension API instance for that reuse component instance. Differences vs standard extension API:
- getNavigationController(): modified to navigate inside reuse component pages and shares communication object.
- getCommunicationObject(1): returns a communication object for pages inside the reuse component; subpages obtain it via getCommunicationObject().
- setSectionHidden(bHidden): available when embedded in object page to hide/show section.
LANGUAGE: text
CODE:
```text
// Usage:
this.getComponentModel(); // component model
// mixInto(...).then(function(oExtensionAPI){ /* extension API instance for the reuse component */ });
```

STEP: 11 — Model propagation (unnamed OData model + "ui" JSON model)
DESCRIPTION: The embedding application propagates:
- the unnamed OData model (primary OData model)
- a JSON model named "ui"
These are available in the reuse component. The binding context of the embedding page is preset and propagated (modified by relative binding if configured). Additional internal JSON models may also be propagated but must not be accessed by reuse component.
LANGUAGE: text
CODE:
```text
// Key points:
- Use this.getModel() to access the unnamed OData model.
- Use this.getModel("ui") to access the UI JSON model.
- Rely on model propagation to have bindings updated prior to stStart/stRefresh invocation.
```

STEP: 12 — Lifecycle hooks to react to binding context changes (stStart / stRefresh)
DESCRIPTION: Implement stStart(oModel, oBindingContext, oExtensionAPI) and/or stRefresh(oModel, oBindingContext, oExtensionAPI) to react when the embedding page binding context is set or refreshed. stStart is called only once (first occurrence); stRefresh is called on subsequent changes or explicit refresh requests. These methods receive:
- oModel: the app's unnamed OData model
- oBindingContext: the page's binding context (may be undefined in create-mode)
- oExtensionAPI: the reuse-component-specific extension API instance
LANGUAGE: text
CODE:
```text
// Implement one or both:
// stStart(oModel, oBindingContext, oExtensionAPI) { ... }
// stRefresh(oModel, oBindingContext, oExtensionAPI) { ... }
```

STEP: 13 — Lazy loading + refresh example pattern
DESCRIPTION: Combine stRefresh and stIsAreaVisible to load data only when visible and when binding context changes. Use override setter of stIsAreaVisible to call refreshImpl(), and stRefresh to set binding context + call refreshImpl().
LANGUAGE: JavaScript
CODE:
```javascript
// Pattern summary (see full UIComponent example in STEP 5):
// 1) setStIsAreaVisible triggers refreshImpl()
// 2) stRefresh saves oBindingContext and calls refreshImpl()
// 3) refreshImpl checks both oBindingContext and getStIsAreaVisible() before loading data
```

STEP: 14 — Reuse components and OData V4 notes
DESCRIPTION: For OData V4:
- No eventing API for reuse components to support draft handling is provided currently.
- Reuse components can use an internal OData model independent from the embedding application. If so, name the internal model to avoid conflicts with the propagated unnamed model.
LANGUAGE: text
CODE:
```text
// Recommendation:
- For internal OData V4 models, use a unique model name and access via this.getModel("<name>").
```

STEP: 15 — Additional constraints & safety notes
DESCRIPTION: Technical constraints to follow:
- Do not define methods starting with "st" or "_st" except stStart and stRefresh and other documented exceptions.
- Avoid overriding getComponentModel (name reserved).
- Be careful with bTwoWaySync in mixInto (can modify outer app data).
- Do not access propagated internal JSON models that are not part of the public contract.
LANGUAGE: text
CODE:
```text
// Enforce checks in code reviews:
// - Ensure metadata declares framework properties.
// - Ensure no illegal "st*" methods are defined.
// - Confirm mixInto is called in init().
```

STEP: 16 — References / further reading (preserve links & manifest paths)
DESCRIPTION: Useful references and paths to embed into documentation or code comments.
LANGUAGE: text
CODE:
```text
- Including Reuse Components on an Object Page: including-reuse-components-on-an-object-page-d869d7a.md
- UIComponent API: https://ui5.sap.com/#/api/sap.ui.core.UIComponent
- ReuseComponentSupport API: https://ui5.sap.com/#/api/sap.suite.ui.generic.template.extensionAPI.ReuseComponentSupport
- ExtensionAPI (ObjectPage): https://ui5.sap.com/#/api/sap.suite.ui.generic.template.ObjectPage.extensionAPI.ExtensionAPI
- NavigationController: https://ui5.sap.com/#/api/sap.suite.ui.generic.template.extensionAPI.NavigationController
```
--------------------------------

**TITLE**: Field Display Representations and Annotations for SAP Fiori elements (OData V4)

**INTRODUCTION**: This reference shows how to control field display types in SAP Fiori elements (OData V4) using annotations and manifest settings. Each step provides the actionable annotation patterns for XML, ABAP CDS and CAP CDS where available. Use these snippets to enable: plain text facets, forms, KPIs/DataPoints, rating/progress visuals, links (semantic, quick view, contact, basic), multi-line/editable text with manifest formatOptions, micro charts, file stream fields, timezone display and masked inputs.

**TAGS**: fiori-elements-framework, odata-v4, annotations, UI.DataField, UI.DataPoint, UI.FieldGroup, UI.MultiLineText, UI.InputMask, Common.Masked, manifest.json, CAP, ABAP, XML

STEP: Representation as a Simple Plain Text Facet
DESCRIPTION: Display a property as a plain text facet (key-value). Add a UI.FieldGroup with a UI.DataField referencing the property path. Use Qualifier to target the FieldGroup if needed.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="PlainText">
    <Record>
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="description"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [
  {
    value: 'DESCRIPTION',
    type: #STANDARD,
    qualifier: 'PlainText'
  }
];
```
LANGUAGE: CAP CDS
CODE:
```cds
UI.FieldGroup #PlainText: {
  Data : [{
    $Type : 'UI.DataField',
    Value : description
  }]
}
```

STEP: Representation as Part of a Form
DESCRIPTION: Group multiple fields into a form-based representation using UI.FieldGroup / grouping annotations. For details and required structure, see "Grouping of Fields" (grouping-of-fields-cb1748e.md).
LANGUAGE: (reference)
CODE:
```text
See: grouping-of-fields-cb1748e.md
```

STEP: Representation as a Key Value Facet / KPI (UI.DataPoint)
DESCRIPTION: Use UI.DataPoint to render KPI or key value facets. Provide Title, Value (Path), and Criticality. Use Qualifier to separate multiple DataPoints.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Availability">
    <Record Type="UI.DataPointType">
        <PropertyValue Property="Title" String="Availability"/>
        <PropertyValue Property="Value" Path="stock/availability"/>
        <PropertyValue Property="Criticality" Path="stock/availability"/>
    </Record>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  title: 'Availability',
  criticality: 'availability'
}
availability;
```
LANGUAGE: CAP CDS
CODE:
```cds
UI.DataPoint #Availability: {
  Value       : stock.availability,
  Title       : 'Availability',
  Criticality : stock.availability
}
```
DESCRIPTION: KPI via DataField with Criticality — renders object status control. Example patterns:
LANGUAGE: XML
CODE:
```xml
<Record Type="SAP__UI.DataField">
    <PropertyValue Property="Criticality" Path="OvrlDeliveryStatusCriticality"/>
    <PropertyValue Property="CriticalityRepresentation" EnumMember="SAP__UI.CriticalityRepresentationType/WithoutIcon"/>
    <PropertyValue Property="Value" Path="OverallDeliveryStatus"/>
    <Annotation Term="SAP__UI.Importance" EnumMember="SAP__UI.ImportanceType/High"/>
</Record>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  criticality: 'OvrlDeliveryStatusCriticality',
  criticalityRepresentation: #WITHOUT_ICON
}
OverallDeliveryStatus;
```
LANGUAGE: CAP CDS
CODE:
```cds
{
  $Type      : 'UI.DataField',
  Value      : OverallDeliveryStatus,
  Criticality: OvrlDeliveryStatusCriticality,
  ![@UI.CriticalityRepresentation] : #WithoutIcon
}
```
DESCRIPTION: Tip — adding a semantic object to the DataPoint value displays a link but suppresses criticality rendering. See navigation-from-an-app-outbound-navigation-d782acf.md.

STEP: Representation as a Rating Indicator (DataPoint Visualization=Rating)
DESCRIPTION: Use UI.DataPoint with Visualization = Rating and optional TargetValue to render a rating indicator.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="averageRating">
    <Record>
        <PropertyValue Property="Value" Path="averageRating"/>
        <PropertyValue Property="TargetValue" Decimal="5"/>
        <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Rating"/>
    </Record>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  targetValue: 5,
  visualization: #RATING
}
averageRating;
```
LANGUAGE: CAP CDS
CODE:
```cds
DataPoint #averageRating: {
  Value         : averageRating,
  TargetValue   : 5.0,
  Visualization : #Rating
}
```
DESCRIPTION: Tip — inside tables the rating is shown without a label.

STEP: Representation as a Progress Indicator (DataPoint Visualization=Progress)
DESCRIPTION: Use UI.DataPoint with Visualization = Progress and TargetValue to render progress bar/indicator.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="quantity">
    <Record>
        <PropertyValue Property="Value" Path="stock/quantity"/>
        <PropertyValue Property="TargetValue" Decimal="100"/>
        <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Progress"/>
    </Record>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  targetValue: 100,
  visualization: #PROGRESS
}
quantity;
```
LANGUAGE: CAP CDS
CODE:
```cds
DataPoint #quantity: {
  Value         : stock.quantity,
  TargetValue   : 100.0,
  Visualization : #Progress
}
```
DESCRIPTION: Tip — inside tables the progress indicator is shown without a label.

STEP: Representation as a Semantic Link (Common.SemanticObject)
DESCRIPTION: Annotate a property/entity to render the field as a semantic link. The semantic object must be configured in FLP for navigation targets to appear.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="clouds.products.CatalogService.Products/SoldToParty">
    <Annotation Term="Common.SemanticObject" String="supplier"/>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
annotate view PRODUCTS.CATALOGSERVICE.PRODUCTS with {
  @Consumption.semanticObject: 'supplier'
  soldtoparty;
}
```
LANGUAGE: CAP CDS
CODE:
```cds
SoldToParty : String(10) @(Common : { SemanticObject : 'supplier' });
```
DESCRIPTION: See navigation-from-an-app-outbound-navigation-d782acf.md for outbound navigation details.

STEP: Quick View Card / Contact Card (DataFieldForAnnotation)
DESCRIPTION: Use UI.DataFieldForAnnotation with Target referencing Communication.Contact to show a Quick View or Contact Card on link click. Also annotate phone/email fields with Communication.IsPhoneNumber / Communication.IsEmailAddress.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="clouds.products.CatalogService.Products">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataFieldForAnnotation">
        <PropertyValue Property="Label" String="Supplier"/>
        <PropertyValue Property="Target" AnnotationPath="supplier/@Communication.Contact"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>

<Annotations Target="sap.fe.manageitems.TechnicalTestingService.Supplier/phoneNumber">
  <Annotation Term="Common.Label" String="Mobile"/>
  <Annotation Term="Communication.IsPhoneNumber" Bool="true"/>
</Annotations>

<Annotations Target="sap.fe.manageitems.TechnicalTestingService.Supplier/emailAddress">
  <Annotation Term="Common.Label" String="Email"/>
  <Annotation Term="Communication.IsEmailAddress" Bool="true"/>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
annotate view PRODUCTS.CATALOGSERVICE.PRODUCTS with {
  @UI.lineItem: [
    {
      label: 'Supplier',
      value: 'SUPPLIER',
      type: #AS_CONTACT,
      position: 1
    }
  ]
  SupplierID;
}

annotate view FE.MANAGEITEMS.TECHNICALTESTINGSERVICE.SUPPLIER with {
  @Semantics.eMail.address: true
  @EndUserText.label: 'EMail'
  emailAddress;

  @Semantics.telephone.type: [ #CELL ]
  @EndUserText.label: 'Mobile'
  phoneNumber;
}
```
LANGUAGE: CAP CDS
CODE:
```cds
UI.LineItem: [
  {
    $Type  : 'UI.DataFieldForAnnotation',
    Target : 'supplier/@Communication.Contact',
    Label  : 'Supplier'
  }
]
phoneNumber  : String(15) @( title: 'Mobile', Communication.IsPhoneNumber );
emailAddress : String(241) @( title: 'Email', Communication.IsEmailAddress );
```
DESCRIPTION: See enabling-quick-views-for-link-navigation-307ced1.md and adding-a-contact-facet-a6a8c0c.md for Quick View and Contact Card details.

STEP: Contact Links (tel: / mailto:)
DESCRIPTION: Mark phone/email properties to create actionable links (tel: and mailto:). Use Communication.IsPhoneNumber and Communication.IsEmailAddress.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="sap.fe.manageitems.TechnicalTestingService.LineItems/phoneNumber">
    <Annotation Term="Common.Label" String="Mobile"/>
    <Annotation Term="Communication.IsPhoneNumber" Bool="true"/>
</Annotations>

<Annotations Target="sap.fe.manageitems.TechnicalTestingService.LineItems/emailAddress">
    <Annotation Term="Common.Label" String="Email"/>
    <Annotation Term="Communication.IsEmailAddress" Bool="true"/>
</Annotations>
```

STEP: Basic Links (DataFieldWithUrl)
DESCRIPTION: Use UI.DataFieldWithUrl in a UI.FieldGroup to show basic links with optional icon/image.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="DataFieldUrl">
  <Record Type="UI.FieldGroupType">
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataFieldWithUrl">
          <PropertyValue Property="Url" String="www.sap.com"/>
          <PropertyValue Property="Value" String="This is an URL"/>
          <PropertyValue Property="IconUrl" String="sap-icon://arrow-right"/>
        </Record>
        <Record Type="UI.DataFieldWithUrl">
          <PropertyValue Property="Url" String="www.sap.com"/>
          <PropertyValue Property="Value" String=""/>
          <PropertyValue Property="IconUrl" Path="oneIcon"/>
        </Record>
        <Record Type="UI.DataFieldWithUrl">
          <PropertyValue Property="Url" Path="oneUrl"/>
          <PropertyValue Property="Value" String="This is an URL three"/>
          <PropertyValue Property="IconUrl" String="sap-icon://arrow-right"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [
  {
    iconUrl: 'sap-icon://arrow-right',
    type: #WITH_URL,
    position: 1,
    qualifier: 'DataFieldUrl'
  },
  {
    url: 'ONEURL',
    value: 'ONEURL',
    type: #WITH_URL,
    position: 2,
    qualifier: 'DataFieldUrl'
  }
]
```
LANGUAGE: CAP CDS
CODE:
```cds
UI.FieldGroup #DataFieldUrl: {
  Data : [{
    $Type  : 'UI.DataFieldWithUrl',
    Url    : 'www.sap.com',
    Value  : 'This is an URL',
    IconUrl: 'sap-icon://arrow-right'
  },
  {
    $Type  : 'UI.DataFieldWithUrl',
    Url    : oneDisplay,
    Value  : oneUrl,
    IconUrl: oneIcon
  }]
}
```

STEP: Representation as TextArea / ExpandableText (UI.MultiLineText)
DESCRIPTION: Annotate a property with UI.MultiLineText to render TextArea in edit mode and ExpandableText in display mode. Configure default behavior via manifest.json controlConfiguration (formatOptions).
LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage">
    <Annotation Term="Common.Label" String="Customer Reference"/>
    <Annotation Term="UI.MultiLineText" Bool="true"/>
</Annotations>
```
DESCRIPTION: Default behavior and customizations:
- Edit mode default lines: 4 (can be modified via manifest formatOptions).
- Display mode default cutoff: 100 characters with a "More" link; expand behavior defaults to "InPlace" (changeable to "Popover").
- Use textMaxLength to restrict characters; when exceeded, shows indicator/notification.

STEP: Manifest-based Field / Column controlConfiguration (formatOptions)
DESCRIPTION: Extend controlConfiguration in manifest.json to set textLinesEdit, textMaxLines, textMaxCharactersDisplay, textExpandBehaviorDisplay, textMaxLength for specific FieldGroup or LineItem entries. Example structure below.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.FieldGroup#myQualifier": {
                  "fields": {
                    "DataField::myFormTextField": {
                      "formatOptions": {
                        "textLinesEdit": "6",
                        "textMaxCharactersDisplay": "Infinity"
                      }
                    }
                  }
                },
                "myEntity/@com.sap.vocabularies.UI.v1.LineItem": {
                  "columns": {
                    "DataField::myTableTextField": {
                      "formatOptions": {
                        "textLinesEdit": "3",
                        "textMaxLines": "5",
                        "textMaxCharactersDisplay": "400",
                        "textExpandBehaviorDisplay": "Popover"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```
DESCRIPTION: Allowed formatOptions parameters (summary)
LANGUAGE: JSON
CODE:
```json
{
  "textLinesEdit": "Integer (min lines in edit mode)",
  "textMaxLines": "Integer (max lines editable can grow to)",
  "textMaxCharactersDisplay": "Integer | 'Infinity' (chars displayed before 'More')",
  "textExpandBehaviorDisplay": "'InPlace' | 'Popover' (how full text is shown)",
  "textMaxLength": "Integer (max characters allowed for entry)"
}
```

STEP: Representation as a Micro Chart
DESCRIPTION: Use the Micro Chart facet to render micro charts for additional measures/criticality. See micro-chart-facet-e219fd0.md and adding-a-micro-chart-to-a-table-b8312a4.md for annotation details and usage examples.
LANGUAGE: (reference)
CODE:
```text
See: micro-chart-facet-e219fd0.md and adding-a-micro-chart-to-a-table-b8312a4.md
```

STEP: Representation as File Upload/Download (Edm.Stream)
DESCRIPTION: Enable stream support to add Edm.Stream fields (file upload/download) to object page forms. See enabling-stream-support-b236d32.md for required service/annotations and UI integration.
LANGUAGE: (reference)
CODE:
```text
See: enabling-stream-support-b236d32.md
```

STEP: Representation as Timestamp with Timezone Information
DESCRIPTION: Annotate timezone code properties with @Common.IsTimezone to display timezone text in display mode next to timestamp.
LANGUAGE: (annotation)
CODE:
```text
@Common.IsTimezone
// attach to timezone code property in CDS or XML annotation for the property
```
DESCRIPTION: See field-help-a5608ea.md (Date Picker and Date/Time Picker) for field help and UI behaviors.

STEP: Masked Input Field (UI.InputMask)
DESCRIPTION: Use UI.InputMask to enforce input format masks. Define Mask, PlaceholderSymbol and Rules (RegExp per mask symbol). Mask symbols map to rules; use caret '^' to escape rule characters as immutable characters.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="sap.fe.core.MaskInputMassEdit.MainEntity/MaskedInputPhone">
  <Annotation Term="UI.InputMask">
    <Record>
      <PropertyValue Property="Mask" String="(***) *** ******"/>
      <PropertyValue Property="PlaceholderSymbol" String="_"/>
    </Record>
  </Annotation>
  <Annotation Term="UI.Placeholder" String="Enter twelve-digit number"/>
</Annotations>

<Annotations Target="sap.fe.core.MaskInputMassEdit.MainEntity/MaskedInputRegistration">
  <Annotation Term="UI.InputMask">
    <Record>
      <PropertyValue Property="Mask" String="I____-__"/>
      <PropertyValue Property="PlaceholderSymbol" String="_"/>
      <PropertyValue Property="Rules">
        <Collection>
          <Record>
            <PropertyValue Property="MaskSymbol" String="_"/>
            <PropertyValue Property="RegExp" String="[0-9]"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```
LANGUAGE: CAP CDS
CODE:
```cds
MaskedInputPhone : String @( 
  UI.InputMask  : { 
    Mask             : '(***) *** ******', 
    PlaceholderSymbol: '_' 
  }, 
  UI.Placeholder: 'Enter twelve-digit number'
);

MaskedInputRegistration : String @( 
  UI.InputMask  : { 
    Mask             : 'I****-**', 
    PlaceholderSymbol: '_', 
    Rules            : [{ MaskSymbol: '*', RegExp: '[0-9]' }]
  }, 
  UI.Placeholder: 'Enter digits registration number'
);

MaskedInputSAP : String @(
  UI.InputMask : {
    Mask             : 'S^AP-AA-999',
    PlaceholderSymbol: '_',
    Rules            : [
      { MaskSymbol: '9', RegExp: '[0-9]' },
      { MaskSymbol: 'A', RegExp: '[A-Z]' }
    ]
  },
  UI.Placeholder: 'Starts with SAP followed by two uppercase letter and three digits'
);
```
DESCRIPTION: Notes:
- Ensure placeholder symbols do not match mask symbols.
- The caret '^' escapes a rule character (makes it immutable).
- Mask characters without rules are immutable by default.
- No ABAP CDS sample for UI.InputMask (use local XML annotations).

STEP: Masked Display (Common.Masked)
DESCRIPTION: Use @Common.Masked to visually mask sensitive fields on the client. This only affects UI rendering (dots/asterisks) and does not change backend transmission or storage. Always mask/encrypt sensitive data server-side before sending to the client.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="sap.fe.core.FieldDisplayStyles.RootEntity/MaskedField">
    <Annotation Term="Common.Masked" Bool="true"/>
</Annotations>
```
LANGUAGE: CAP CDS
CODE:
```cds
MaskedField : String @Common : { Masked: true };
```
DESCRIPTION: See security-configuration-ba0484b.md for security guidance. Live examples available in the UI5 FPM Explorer:
- Field - Display Representations: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/fieldDisplayStyles
- Field - Edit Mode: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/fieldEdit

STEP: Related Information
DESCRIPTION: Quick links to related topics
LANGUAGE: (links)
CODE:
```text
- Grouping of Fields: grouping-of-fields-cb1748e.md
- Navigation (Outbound): navigation-from-an-app-outbound-navigation-d782acf.md
- Quick Views: enabling-quick-views-for-link-navigation-307ced1.md
- Contact Facet: adding-a-contact-facet-a6a8c0c.md
- Stream Support: enabling-stream-support-b236d32.md
- Micro Chart Facet: micro-chart-facet-e219fd0.md
- Adding Micro Chart to Table: adding-a-micro-chart-to-a-table-b8312a4.md
- Field Help - Date/Time: field-help-a5608ea.md
- Security Configuration: security-configuration-ba0484b.md
- Flexible Programming Model Explorer (Format Options): https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/fieldFormatOptions
```
--------------------------------

**TITLE**: Disable the Editing Status Filter in Draft-Enabled Fiori Elements List Report

**INTRODUCTION**: Instructions and ready-to-use annotation snippets to disable the default Editing Status filter that appears on list report pages for draft-enabled applications. Add one of the following annotations to your application's annotation file (e.g., annotations.xml or service annotations) depending on your stack.

**TAGS**: fiori-elements-framework, annotations, draft, editing-status, filter, XML, CAP, CDS, ABAP

**STEP**: 1 — XML Annotation (OData Service / Local Annotation File)

**DESCRIPTION**: Add this XML annotation to your annotation file (for example annotations.xml) under the relevant EntityContainer/EntityType target. This disables filtering on the navigation property DraftAdministrativeData so the Editing Status filter is not shown.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="TravelService.EntityContainer/Travel">
   <Annotation Term="Capabilities.NavigationRestrictions">
      <Record Type="Capabilities.NavigationRestrictionsType">
         <PropertyValue Property="RestrictedProperties">
            <Collection>
               <Record Type="Capabilities.NavigationPropertyRestriction">
                  <PropertyValue Property="NavigationProperty" NavigationPropertyPath="DraftAdministrativeData"/>
                  <PropertyValue Property="FilterRestrictions">
                     <Record Type="Capabilities.FilterRestrictionsType">
                        <PropertyValue Property="Filterable" Bool="false"/>
                     </Record>
                  </PropertyValue>
               </Record>
           </Collection>
        </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```

**STEP**: 2 — CAP CDS Annotation (CAP model)

**DESCRIPTION**: For SAP CAP projects, annotate the entity in your CDS model with the following CAP CDS-style annotation to set Filterable = false for the DraftAdministrativeData navigation property.

**LANGUAGE**: CDS

**CODE**:
```cds
annotate TravelService.Travel with @(
  Capabilities: {
    NavigationRestrictions : {
      $Type : 'Capabilities.NavigationRestrictionsType',
      RestrictedProperties : [
        {
          $Type : 'Capabilities.NavigationPropertyRestriction',
          NavigationProperty : DraftAdministrativeData,
          FilterRestrictions : {
            $Type : 'Capabilities.FilterRestrictionsType',
            Filterable : false,
          },
        },
      ],
    },
  }
);
```

**STEP**: 3 — ABAP CDS Annotation

**DESCRIPTION**: No ABAP CDS sample is provided in the source documentation. If you are using ABAP CDS, implement an equivalent NavigationRestrictions annotation in your ABAP CDS annotations or use the local XML annotation approach shown in Step 1.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
/* No ABAP CDS sample available.
   Use the local XML annotation (Step 1) or implement an equivalent NavigationRestrictions annotation in your ABAP CDS annotations. */
```

**STEP**: 4 — Effect and Testing

**DESCRIPTION**: Once the annotation is deployed/applied, the Editing Status filter (which is enabled by default for draft-enabled list reports) will be disabled. End users will no longer be able to filter objects by editing status. Verify in the list report UI that the Editing Status filter is removed. No additional UI code changes are required beyond adding this annotation.

**LANGUAGE**: Text

**CODE**:
```
Result: Editing Status filter removed from the list report filter bar.
Test: Open the list report for TravelService.Travel and confirm the Editing Status filter is not available.
```
--------------------------------

**TITLE**: Displaying and Ordering Actions on the Object Page (Fiori Elements)

**INTRODUCTION**: Practical guide for adding, ordering, and controlling action buttons on the Object Page in SAP Fiori elements. Includes manifest-based examples for placement using "position" and annotation examples for action criticality (OData V4). Use these snippets to implement header/footer actions, change ordering, and set criticality so the UI renders actions according to Fiori Elements rules.

**TAGS**: fiori-elements, object-page, actions, manifest.json, annotations.xml, OData V4, criticality, ordering

STEP: Action display rules (summary)
DESCRIPTION: Use this reference to understand default rendering order and mode-based placement of actions on the Object Page.
LANGUAGE: Text
CODE:
```text
Default display order in the Object Page header (top to bottom):
1. Generic actions (e.g., Save, Edit)
2. Application-specific actions (order defined in metadata)
3. Manifest-based custom actions
4. Related Apps button
5. Other generic actions (e.g., Share)

Mode-based placement:
- Display mode: actions appear in the header toolbar.
- Edit/Create mode: relevant actions appear in the footer bar (e.g., Save/Cancel in Edit, Create/Cancel in Create).

Additional OData V4 behavior:
- If an action has criticality or is defined as a semantic action (app developer set semantic behavior), semantic actions are placed before generic actions; generic actions are not auto-emphasized in that case.
```

STEP: Add a manifest-based custom action to the Object Page header
DESCRIPTION: Add a custom button to the Object Page header via manifest.json. The "position" property controls placement relative to other header actions. Place this snippet in the app's manifest.json under the Object Page component's settings for the corresponding page (pages > component > settings > header > actions).
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrders",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "header": {
              "actions": [
                {
                  "id": "ZCreateInvoice",
                  "text": "Create Invoice",
                  "type": "Action",                /* conceptual type for fiori-elements */
                  "press": "onCreateInvoice",      /* name of extension function/handler if using extension */
                  "position": "After"              /* placement hint: e.g., Begin, After, Before, End */
                }
              ]
            }
          }
        }
      }
    ]
  }
}
```

STEP: Change the order of an existing application or annotation-based action using manifest override
DESCRIPTION: To reposition an action defined in metadata or annotations, reference that action by ID in the manifest and set "position". This override is commonly placed at the same manifest path as header actions for the Object Page. Use the action ID as specified in the service metadata or annotation.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrders",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "header": {
              "actions": [
                {
                  "id": "APPROVE_ACTION_FROM_ANNOTATION",
                  "position": "Begin"   /* Moves the existing action to the beginning of the header actions */
                }
              ]
            }
          }
        }
      }
    ]
  }
}
```

STEP: Set action criticality via OData annotations (annotations.xml)
DESCRIPTION: Add a UI criticality annotation for an action in your annotation file (annotations.xml) or metadata annotations. Setting criticality ensures the action can be rendered with the appropriate semantic styling and (in OData V4) can make semantic actions appear before generic actions.
LANGUAGE: XML
CODE:
```xml
<!-- Target the bound or unbound action defined in your service/metadata -->
<Annotations Target="MyService.MyEntityType/Approve">
  <!-- CriticalityType: Positive | Negative | Critical | Neutral -->
  <Annotation Term="com.sap.vocabularies.UI.v1.Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Critical"/>
</Annotations>
```

STEP: Define a DataFieldForAction with criticality (annotation-based action shown in object header)
DESCRIPTION: Example of defining an annotation-based action (DataFieldForAction) for the Object Page toolbar and attaching a Criticality annotation. Place DataFieldForAction entries in the appropriate UI.LineItem or UI.HeaderFacets annotation groups, or attach to the entity's header annotation collection.
LANGUAGE: XML
CODE:
```xml
<!-- Example: Define a UI action as annotation and attach label and criticality -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
      <PropertyValue Property="Action" String="MyService.Approve"/>
      <PropertyValue Property="Label" String="Approve"/>
      <!-- Optionally set visualization hints; many clients use the action and criticality -->
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/High" />
    </Record>
  </Collection>
</Annotation>

<!-- Separate Criticality annotation for the same action -->
<Annotations Target="MyService.MyEntityType/Approve">
  <Annotation Term="com.sap.vocabularies.UI.v1.Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Positive"/>
</Annotations>
```

STEP: Behavior notes for implementers (practical guidance)
DESCRIPTION: Short actionable rules to follow while implementing:
LANGUAGE: Text
CODE:
```text
- Place actions meant for Display mode in header actions (manifest or annotations).
- Place Save/Cancel or Create/Cancel for Edit/Create modes into footer; Fiori Elements automatically moves edit/create actions to footer when in those modes.
- For ordering changes, prefer manifest overrides referencing action IDs and set "position". This works for both manifest-defined actions and annotation-defined actions (referencing their IDs).
- Use the Criticality annotation (com.sap.vocabularies.UI.v1.Criticality) to set semantic emphasis; in OData V4 apps, actions with criticality/semantic intent are placed before generic actions.
- For complex behavior (visibility per mode or conditional visibility), control via annotations or manifest visibility rules/expressions supported by your Fiori Elements version.
```

STEP: Related resources (file references)
DESCRIPTION: Use these documents for deeper integration patterns and examples (keep these file paths/links for reference in your repo or documentation).
LANGUAGE: Text
CODE:
```text
- Adding Custom Actions Using Extension Points: adding-custom-actions-using-extension-points-7619517.md
- Enabling Actions in the Object Page Header: enabling-actions-in-the-object-page-header-5fe4396.md
- Adding Action Buttons to Forms in Sections: adding-action-buttons-to-forms-in-sections-e64efda.md
- Defining Determining Actions: defining-determining-actions-1743323.md
- Setting the Criticality for Actions: setting-the-criticality-for-actions-12f2ba2.md
- Generic Action Buttons in Tables on the Object Page: generic-action-buttons-in-tables-on-the-object-page-additional-considerations-d27ae99.md
```
--------------------------------

**TITLE**: Configure Decimal Padding for Amounts with Currency or Unit of Measure in Fiori Elements (OData V4)

**INTRODUCTION**: This document shows how to control decimal padding used to align numeric amounts and their currency or unit-of-measure (UoM) labels in SAP Fiori elements tables (OData V4). Use the manifest.json keys sap.fe.macros.table.currency.decimalPadding and sap.fe.macros.table.unitOfMeasure.decimalPadding to adjust alignment.

**TAGS**: fiori-elements, sap.fe, odata-v4, manifest, currency, unit-of-measure, decimalPadding, alignment

STEP: 1 — Applicability and alignment rules

DESCRIPTION: Confirm applicability and expected alignment behavior. This applies only to SAP Fiori elements for OData V4. In table display mode:
- The numeric amount is aligned by the decimal separator (if present).
- The currency or unit-of-measure label is right-aligned.
- Default decimal padding is 3 (used to ensure consistent alignment across rows).

LANGUAGE: text

CODE:
```text
Applicability: SAP Fiori elements (OData V4) only
Alignment rules:
 - Amount: aligned on decimal separator
 - Currency/UoM: right-aligned
 - Default decimalPadding: 3
```

STEP: 2 — Update manifest.json to change decimal padding

DESCRIPTION: Edit your application's manifest.json to set the desired decimalPadding values under sap.fe.macros.table. Put these keys into your existing manifest.json. The following examples show:
- Setting currency decimal padding to 5
- Setting unitOfMeasure decimal padding to 3 (explicit, same as default)

File: manifest.json

LANGUAGE: JSON

CODE:
```JSON
{
  "sap.fe": {
    "macros": {
      "table": {
        "currency": {
          "decimalPadding": 5
        },
        "unitOfMeasure": {
          "decimalPadding": 3
        }
      }
    }
  }
}
```

STEP: 3 — Minimal/targeted change examples

DESCRIPTION: If you only need to change one setting, include only that key under sap.fe.macros.table. Examples below show changing only currency or only unit of measure.

LANGUAGE: JSON

CODE:
```JSON
// Change only currency decimal padding
{
  "sap.fe": {
    "macros": {
      "table": {
        "currency": {
          "decimalPadding": 4
        }
      }
    }
  }
}
```

```JSON
// Change only unitOfMeasure decimal padding
{
  "sap.fe": {
    "macros": {
      "table": {
        "unitOfMeasure": {
          "decimalPadding": 2
        }
      }
    }
  }
}
```

STEP: 4 — Verify in UI

DESCRIPTION: Deploy or run the app and open the list/table view containing amount + currency/UoM columns. Verify:
- Amounts line up on the decimal separator across rows
- Currency/UoM labels are right-aligned
- Adjust decimalPadding values as needed to achieve visual alignment for your data ranges

LANGUAGE: text

CODE:
```text
Verification checklist:
 - Open the table display view containing amount + currency/UoM
 - Confirm numeric alignment on decimal separator
 - Confirm currency/UoM is right-aligned
 - If misaligned, increase or decrease decimalPadding and redeploy
```
--------------------------------

**TITLE**: Displaying Fields in Smartforms on Small Devices (UI.Importance for Fiori elements, OData V2)

**INTRODUCTION**: Use the UI.Importance annotation to control visibility of individual data fields in Smartforms on small devices. Set importance per data field (High / Medium / Low). Applicable only to SAP Fiori elements for OData V2. If UI.Importance is omitted, default is None (= Medium). You cannot hide a whole FieldGroup or the Identification section — set importance on each data field inside the group.

**TAGS**: fiori-elements-framework, odata-v2, annotations, UI.Importance, smartforms, CDS, CAP, ABAP, XML

STEP: 1 — Visibility behavior mapping
DESCRIPTION: Mapping of UI.Importance values to device visibility. Use this to decide which fields to mark High / Medium / Low.
LANGUAGE: text
CODE:
```text
UI.Importance mapping:
- UI.ImportanceType/High   -> Visible on desktops, tablets, and mobiles (all).
- UI.ImportanceType/Medium -> Visible on desktops and tablets (hidden on small/mobile).
- UI.ImportanceType/Low    -> Visible on desktops and tablets (hidden on small/mobile).

Default behavior:
- If UI.Importance is not specified, the default is None, treated as Medium importance.
Note:
- UI.Importance must be set per data field. You cannot hide entire FieldGroup or Identification by setting UI.Importance on the group.
```

STEP: 2 — XML Annotation (OData V2) example: set importance per UI.DataField in UI.FieldGroup
DESCRIPTION: Add a UI.FieldGroup annotation in your annotation XML and set UI.Importance on each UI.DataField record. Place this in the annotation file consumed by the Fiori elements app (e.g., annotations.xml).
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="GeneralInformation">
    <Record>
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SalesOrder"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Label" String="Business Partner ID"/>
                    <PropertyValue Property="Value" Path="BusinessPartnerID"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Low"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Label" String="Opportunity ID"/>
                    <PropertyValue Property="Value" Path="OpportunityID"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Medium"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Label" String="Enabled"/>
                    <PropertyValue Property="Value" Path="EnabledStatus"/>
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Label" String="General Information"/>
    </Record>
</Annotation>
```

STEP: 3 — ABAP CDS Annotation example: set importance on fields via @UI.fieldGroup
DESCRIPTION: In an ABAP CDS view, annotate each element with @UI.fieldGroup entries including importance. Place these annotations in the CDS view source used for the OData V2 service.
LANGUAGE: ABAP
CODE:
```abap
@UI.fieldGroup: [
  {
    importance: #HIGH,
    position: 10,
    qualifier: 'GeneralInformation',
    groupLabel: 'General Information'
  }
]
SALESORDER;

@UI.fieldGroup: [
  {
    importance: #LOW,
    label: 'Business Partner ID',
    position: 20,
    qualifier: 'GeneralInformation'
  }
]
BUSINESSPARTNERID;

@UI.fieldGroup: [
  {
    importance: #MEDIUM,
    label: 'Opportunity ID',
    position: 30,
    qualifier: 'GeneralInformation'
  }
]
OPPORTUNITYID;

@UI.fieldGroup: [
  {
    label: 'Enabled',
    position: 40,
    qualifier: 'GeneralInformation'
  }
]
ENABLEDSTATUS;
```

STEP: 4 — CAP CDS Annotation example: field group with UI.Importance markers
DESCRIPTION: For CAP-based models, declare UI.FieldGroup with UI.DataField entries and attach ![@UI.Importance]. Include this in your .cds file or separate annotations file used by the service.
LANGUAGE: CDS
CODE:
```cds
UI.FieldGroup #GeneralInformation : {
    Data : [
        {
            $Type : 'UI.DataField',
            Value : SalesOrder,
            ![@UI.Importance] : #High
        },
        {
            $Type : 'UI.DataField',
            Label : 'Business Partner ID',
            Value : BusinessPartnerID,
            ![@UI.Importance] : #Low
        },
        {
            $Type : 'UI.DataField',
            Label : 'Opportunity ID',
            Value : OpportunityID,
            ![@UI.Importance] : #Medium
        },
        {
            $Type : 'UI.DataField',
            Label : 'Enabled',
            Value : EnabledStatus
        }
    ],
    Label : 'General Information'
}
```

STEP: 5 — Implementation guidance and checklist
DESCRIPTION: Quick actionable checklist to apply UI.Importance correctly in your project.
LANGUAGE: text
CODE:
```text
Checklist:
- Confirm project uses SAP Fiori elements for OData V2 (UI.Importance behavior applies only to OData V2).
- Decide per data field which importance to assign (High / Medium / Low).
- Add UI.Importance annotations:
  - For annotation XML: add <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/..."/> on each UI.DataField.
  - For ABAP CDS: use @UI.fieldGroup entries with importance: #HIGH/#MEDIUM/#LOW per element.
  - For CAP CDS: use ![@UI.Importance] : #High/#Medium/#Low inside UI.FieldGroup Data entries.
- Do NOT rely on setting UI.Importance on the FieldGroup to hide the whole group — set for each field instead.
- If omitted, fields default to None (treated as Medium). Test on desktop, tablet, and mobile to confirm expected visibility.
```
--------------------------------

**TITLE**: Displaying Images in Fiori Elements Tables (URL, Stream, Binary)

**INTRODUCTION**: This guide shows how to display images in Fiori Elements tables by annotating entity properties that contain image URLs or media. It includes XML, ABAP CDS, and CAP CDS examples for:
- adding the property to the table line item,
- marking a property as an image URL (alt text),
- annotating OData V4 stream properties (URL + MediaType, read-only),
- annotating binary media properties (MediaType).

Use these snippets in local annotation XML files, CDS views, or CAP model/annotation files. Preserve the entity/property path shown (STTA_PROD_MAN.STTA_C_MP_ProductType/ProductPictureURL) and adapt to your entity.

**TAGS**: fiori-elements, annotations, images, UI.IsImageUrl, Core.MediaType, Core.IsURL, CDS, CAP, XML, ODataV4

STEP: 1 — Add the image property to the table (line item)
DESCRIPTION: Include the data field for the image URL in the UI line item annotation so the column is rendered in the table. Examples for XML annotations, ABAP CDS view line item, and CAP CDS line item are provided.
LANGUAGE: XML
CODE:
```XML
<!-- Local annotation file: add DataField for ProductPictureURL to line item -->
<Record Type="UI.DataField">
    <PropertyValue Property="Value" Path="ProductPictureURL"/>
    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
</Record>
```
LANGUAGE: ABAP CDS
CODE:
```ABAP CDS
// In your CDS view (line item projection) include the property
@UI.lineItem: [{ importance: #HIGH }]
PRODUCTPICTUREURL;
```
LANGUAGE: CAP CDS
CODE:
```CAP CDS
// In a CAP UI annotation JSON/JS block or .cds annotations file, include DataField
{
    $Type : 'UI.DataField',
    Value : ProductPictureURL,
    ![@UI.Importance] : #High
}
```

STEP: 2 — Mark the property as an image URL and add alt text
DESCRIPTION: Annotate the property to indicate it contains an image URL so Fiori Elements renders sap.m.Image. Optionally add Common.Text for accessibility (alt text). Use the entity property target path as shown.
LANGUAGE: XML
CODE:
```XML
<!-- Local annotation file: mark property as image URL and provide alt text -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType/ProductPictureURL">
    <Annotation Term="UI.IsImageUrl" />
    <Annotation Term="Common.Text" String="{Product}" />
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```ABAP CDS
// Mark the property as image URL and arrange text (example in CDS field list)
@Semantics.imageUrl: true
@UI.textArrangement: #TEXT_ONLY
PRODUCTPICTUREURL;
```
LANGUAGE: CAP CDS
CODE:
```CAP CDS
// CAP annotate block to mark property as image URL and add alt text
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with {
  @UI.IsImageUrl : true
  @Common.Text : '{Product}'
  ProductPictureURL
};
```

STEP: 3 — OData V4: Annotate a stream property (image via URL, read-only)
DESCRIPTION: For OData V4 stream properties (media-stream), annotate the property to indicate it is a URL and set the media type to image/<format>. Stream properties are supported only for read-only access (data read via URL). Include Common.Text for alt text.
LANGUAGE: XML
CODE:
```XML
<!-- Local annotation file for a stream property (entity/media content) -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType/ProductPictureURL">
   <Annotation Term="Common.Text" String="{Product}" /> 
   <Annotation Term="Core.IsURL" Bool="true"/>
   <Annotation Term="Core.MediaType" String="image/jpg"/>
</Annotations>
```
LANGUAGE: CAP CDS
CODE:
```CAP CDS
// CAP annotate block for OData V4 stream property (read-only via URL)
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with {
  @Common.Text : '{Product}'
  @Core.IsURL : true
  @Core.MediaType : 'image/jpg'
  ProductPictureURL
};
```
DESCRIPTION (note): Stream properties are read-only (served via URL only). See OData V4 Stream Properties for details:
http://docs.oasis-open.org/odata/odata-json-format/v4.0/os/odata-json-format-v4.0-os.html#_Toc372793075

STEP: 4 — Annotate a binary media property (embedded binary, MediaType)
DESCRIPTION: For binary media (content embedded in the payload instead of via URL), annotate only the MediaType plus optional alt text. This tells the UI the content is an image of the specified format.
LANGUAGE: XML
CODE:
```XML
<!-- Local annotation file for binary media (embedded) -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType/ProductPictureURL">
   <Annotation Term="Common.Text" String="{Product}" /> 
   <Annotation Term="Core.MediaType" String="image/png"/>
</Annotations>
```
LANGUAGE: CAP CDS
CODE:
```CAP CDS
// CAP annotate block for binary media property
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with {
  @Common.Text : '{Product}'
  @Core.MediaType : 'image/png'
  ProductPictureURL
};
```
--------------------------------

**TITLE**: Display Text and ID for Value Help Inputs (Object Pages, OData V2 & V4)

**INTRODUCTION**: This guide shows how to configure value-help (ValueList) input fields in SAP Fiori elements object pages to display both descriptive text and the ID in Edit and Display modes. Includes annotations and examples for XML (service metadata), ABAP CDS, and CAP CDS; client-side validation via ValueListForValidation; and OData V2/V4-specific behaviors and modeling patterns.

**TAGS**: fiori-elements-framework, value-help, textArrangement, ValueListForValidation, sap:text, ODataV2, ODataV4, ABAP, CAP, XML

STEP: 1 — Define textArrangement at the entity level (applies to all fields unless overridden)
DESCRIPTION: Add a TextArrangement UI annotation at the entity type level so bound fields show text + ID according to the arrangement. Field-level annotations override entity-level.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_SALES_ORDER_ND_SRV_01.STTA_C_SO_SalesOrder_NDType"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement"
                EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.TextArrangement: #TEXT_LAST
annotate view STTA_C_SO_SALESORDER_ND with {
  // entity-level annotation (no specific field listed here)
}
```

LANGUAGE: CAP CDS
CODE:
```cap
annotate STTA_SALES_ORDER_ND_SRV_01.STTA_C_SO_SalesOrder_NDType @(
  UI.TextArrangement : #TextLast
);
```

STEP: 2 — Define textArrangement at the field/property level (overrides entity level)
DESCRIPTION: Apply TextArrangement directly to a property to force per-field behavior (TextOnly, TextLast, TextFirst, etc.).
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_SALES_ORDER_ND_SRV_01.STTA_C_SO_SalesOrder_NDType/BusinessPartnerID"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement"
                EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view STTA_C_SO_SALESORDER_ND with {
  @UI.TextArrangement: #TEXT_ONLY
  businesspartnerid;
}
```

LANGUAGE: CAP CDS
CODE:
```cap
annotate STTA_SALES_ORDER_ND_SRV_01.STTA_C_SO_SalesOrder_NDType {
  @UI.TextArrangement : #TextOnly
  BusinessPartnerID
};
```

STEP: 3 — Configure client-side validation with ValueListForValidation
DESCRIPTION: Use Common.ValueListForValidation under a property to enforce client validation against the ValueList entity set. Notes: works only with empty qualifier (String=""); user input that does not match the ValueList is rejected (not written to backend, including drafts).
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType/Supplier"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="Common.ValueListForValidation" String=""/>
    <Annotation Term="Common.ValueList">
        <!-- Definition of ValueList (navigation, parameters) -->
    </Annotation>
</Annotations>
```

STEP: 4 — Edit mode behavior for OData V2 (TextInEditModeSource and default)
DESCRIPTION: On object page forms, the default configuration TextInEditModeSource = ValueListNoValidation allows entering values not in the value help. To display descriptive text in edit mode, the SmartField must satisfy all conditions below; otherwise only the ID is shown.
LANGUAGE: None
CODE:
```text
Conditions required for sap.ui.comp.smartfield.TextInEditModeSource.ValueList:
- SmartField value is bound to an EDM property of type Edm.String or Edm.Guid.
- com.sap.vocabularies.UI.v1.TextArrangement is specified for the bound property or entity type (in metadata/annotations).
- SmartField value binding mode is two-way.
- The field from which the description is fetched is filterable.
If any condition is not met -> only ID is displayed.
Note: TextInEditModeSource.ValueList is only supported in object page forms (not in tables).
```

STEP: 5 — Display mode modeling for OData V2: use sap:text (navigation path) to show text + ID
DESCRIPTION: Point sap:text to a navigation property/path so the UI control can fetch the descriptive text from the related value-help entity. Also include TextArrangement at the entity or property as needed.
LANGUAGE: XML (Property in EntityType)
CODE:
```xml
<Property Name="BusinessPartnerID"
          Type="Edm.String"
          Nullable="false"
          MaxLength="10"
          sap:display-format="UpperCase"
          sap:text="to_BusinessPartner/CompanyName"
          sap:label="Business Partner ID"
          sap:value-list="standard"/>
<!-- And entity-level TextArrangement -->
<Annotations Target="STTA_SALES_ORDER_ND_SRV_01.STTA_C_SO_SalesOrder_NDType"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement"
                EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"/>
</Annotations>
```

STEP: 6 — Alternative Display modeling: define text property inside the ValueHelp entity (sap:text)
DESCRIPTION: Expose a text property inside the value-help entity and reference it via sap:text on the key property. Also annotate the value-help entity with TextArrangement.
LANGUAGE: XML (Value Help EntityType + Annotations)
CODE:
```xml
<EntityType Name="C_CostCenterVHType" sap:label="Cost Center Value Help" sap:value-list="true">
    <Key>
        <PropertyRef Name="CostCenter" />
    </Key>
    <Property Name="CostCenter" Type="Edm.String" Nullable="false" MaxLength="10"
              sap:display-format="UpperCase" sap:text="CostCenter_Text" sap:label="Cost Center" />
    <Property Name="CostCenter_Text" Type="Edm.String" MaxLength="20" sap:label="Cost Center Name"
              sap:creatable="false" sap:updatable="false" />
</EntityType>

<Annotations Target="COST_CENTERS_SRV.C_CostCenterVHType"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement"
                EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast" />
</Annotations>
```

STEP: 7 — Display behavior rules & limitations (OData V2 & V4)
DESCRIPTION: Summary of runtime behavior for display mode:
- DataField bound to a value help and rendered as SmartLink (SemanticObject) or quick view: shows descriptive text + ID by default.
- DataFieldWithNavigationPath bound to a value help: shows descriptive text + ID by default.
- Applies to tables, object page headers, and object page form sections.
- Change behavior using TextArrangement: TextFirst, TextLast, TextOnly.
- Not supported for record types: DataFieldWithIntentBasedNavigation, Communication.Contact.
- If TextArrangement is defined as textSeparate: only the ID is displayed.
LANGUAGE: None
CODE:
```text
Applies to: Tables, Object Page headers, Object Page form sections.
Use TextArrangement to choose display order or hide text.
Unsupported record types: DataFieldWithIntentBasedNavigation, Communication.Contact.
If TextArrangement == textSeparate -> only ID displayed.
```

STEP: 8 — OData V4: display mode behavior (note)
DESCRIPTION: For OData V4, the same default behavior applies: DataField rendered as a link (SemanticObject) or quick view and DataFieldWithNavigationPath bound to value help show descriptive text + ID by default. Use TextArrangement to change ordering or visibility.
LANGUAGE: None
CODE:
```text
OData V4 behavior: Descriptive text + ID shown by default for DataField and DataFieldWithNavigationPath when bound to value help and rendered as link/quick view. Use TextArrangement to customize.
```
--------------------------------

**TITLE**: Donut Chart Card — configuration, stable coloring, percentages, and "Others" navigation

**INTRODUCTION**: This document gives precise, code-focused examples to configure a Donut Chart Card for Fiori Elements / card descriptor usage. It covers: required measure/dimensions, displaying percentage labels, enabling stable coloring with a color map, annotating dimensions for stable colors, and configuring navigation for the "Others" sector. Use these snippets in your card descriptor (JSON), OData annotations (CDS/XML), and navigation target configuration.

**TAGS**: fiori-elements, donut-chart, chart, stable-colors, colorPalette, card-settings, annotations, navigation, percentages

**STEP**: 1 — Basic Donut Chart properties and percentage labels

**DESCRIPTION**: Configure chart properties in the card descriptor to display data labels as percentages. Donut charts require exactly one measure and one or more dimensions (multiple dimensions are stacked). Add ChartProperties.plotArea.dataLabel.type = "percentage" to show percent values.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "cardSettings": {
    "chartType": "Donut"
  },
  "ChartProperties": {
    "plotArea": {
      "dataLabel": {
        "type": "percentage"
      }
    }
  },
  "data": {
    "measures": [
      {
        "property": "SalesAmount",
        "label": "Sales"
      }
    ],
    "dimensions": [
      { "property": "Year" },
      { "property": "Country" }
    ]
  }
}
```

**STEP**: 2 — Enable stable coloring and provide a colorPalette map in descriptor

**DESCRIPTION**: To assign stable (predictable) colors to particular dimension values, set bEnableStableColors to true and provide a colorPalette object that maps dimension value keys to hex color values. Place these settings in the same card descriptor/descriptor configuration where chart options are defined.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "cardSettings": {
    "bEnableStableColors": true,
    "colorPalette": {
      "values": {
        "Europe": "#1f77b4",
        "Asia": "#ff7f0e",
        "Americas": "#2ca02c",
        "Others": "#d62728"
      }
    }
  },
  "ChartProperties": {
    "plotArea": {
      "dataLabel": {
        "type": "percentage"
      }
    }
  }
}
```

**STEP**: 3 — Dimension annotation requirements for stable coloring

**DESCRIPTION**: Stable coloring requires that chart dimension properties are treated as a Category role and that each dimension property has a sap.vocabularies.Common.v1.Text annotation for their display labels. Below are two annotation styles: CDS and OData XML. Ensure the chart annotation lists the dimension(s) and the measure.

**LANGUAGE**: CDS

**CODE**:
```cds
namespace my.service;

entity Sales {
  key ID       : UUID;
  SalesAmount  : Decimal(15,2);        // measure
  Year         : String;               // dimension 1
  Country      : String;               // dimension 2 (the value mapped to colorPalette)
  CountryName  : String;               // textual label for Country
}

annotate Sales with {
  // Mark CountryName as the text label for Country values
  Country @(sap.common.Text: 'CountryName');
}
```

**LANGUAGE**: XML

**CODE**:
```xml
<!-- OData V2/V4 style annotation example (UI.Chart + Common.Text on a property) -->
<Annotations Target="MyService.Sales">
  <Annotation Term="UI.Chart">
    <Record>
      <PropertyValue Property="ChartType" String="Donut"/>
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>SalesAmount</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>Year</PropertyPath>
          <PropertyPath>Country</PropertyPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <!-- Text annotation for Country property used as label in legend -->
  <Annotation Term="Common.Text" Qualifier="CountryText">
    <PropertyPath>CountryName</PropertyPath>
  </Annotation>
</Annotations>
```

**STEP**: 4 — Ensure chart dimension Role = Category

**DESCRIPTION**: The chart dimension property (Role) must be a Category for stable coloring to apply. In most chart annotation formats this is the default for dimensions; if your annotation format allows explicit role settings, set Role="Category" for each dimension.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "chartAnnotation": {
    "chartType": "Donut",
    "measures": ["SalesAmount"],
    "dimensions": [
      {
        "property": "Country",
        "role": "Category"   // explicit role setting where supported
      },
      {
        "property": "Year",
        "role": "Category"
      }
    ]
  }
}
```

**STEP**: 5 — Configure "Others" sector navigation with filter conditions

**DESCRIPTION**: When a donut chart aggregates many small categories into an "Others" slice, configure navigation from the "Others" slice to a target application and pass filters that exclude the explicit, displayed dimension values (e.g., A, B, C) so the target shows the rest. Use your card descriptor navigation object to pass filter expressions or structured filter arrays.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "navigation": {
    "target": {
      "semanticObject": "Sales",
      "action": "display",
      "parameters": {
        "filters": [
          { "path": "Country", "operator": "NE", "value": "Europe" },
          { "path": "Country", "operator": "NE", "value": "Asia" },
          { "path": "Country", "operator": "NE", "value": "Americas" }
        ]
        /* Alternative: pass a single filter string
           "filter": "Country ne 'Europe' and Country ne 'Asia' and Country ne 'Americas'"
        */
      }
    }
  }
}
```

**STEP**: 6 — Example image reference (for documentation slot)

**DESCRIPTION**: Use the provided example image for visual reference in documentation or card preview.

**LANGUAGE**: Markdown / Path

**CODE**:
```text
images/Donut_Chart_0750575.png
```
--------------------------------

**TITLE**: Draft Handling — configuration and annotations for SAP Fiori elements (OData V2 / V4)

**INTRODUCTION**: Practical, code-focused reference for implementing and configuring draft handling in SAP Fiori elements apps. Includes manifest.json snippets, annotation examples, and actionable notes for Apply/Validate/Discard behaviors, collaborative drafts, and options to hide draft UI. Use these snippets to update manifest.json and OData annotations or CDS models.

**TAGS**: draft, manifest.json, sap.fe, OData V2, OData V4, PreparationAction, DiscardAction, ShareAction, hideDraft, dataSaveFrequency

STEP: 1 — Configure draft save frequency (OData V2)
DESCRIPTION: Set automatic draft save behavior. The default delayed merge (20s) can be changed to immediate saves after user input or actions by configuring sap.ui.generic.app.settings.draftSettings.dataSaveFrequency in manifest.json.
LANGUAGE: JSON
CODE:
```JSON
// manifest.json — enable immediate draft saves (OData V2)
{
  "sap.ui.generic.app": {
    "settings": {
      "draftSettings": {
        // "delayed" (default/20s) or "immediate"
        "dataSaveFrequency": "immediate"
      }
    }
  }
}
```

STEP: 2 — Hide draft-related UI features while keeping draft functionality
DESCRIPTION: Hide draft UI elements (editing status filter, Apply button, Draft footer messages, etc.) while leaving backend draft functionality active. Control navigation after Save/Cancel and visibility of Create Next.
LANGUAGE: JSON
CODE:
```JSON
// manifest.json — hide draft UI and control post-save/cancel navigation
{
  "sap.fe": {
    "app": {
      "hideDraft": {
        "enabled": true,
        // default true: stay on current page after save/cancel
        "stayOnCurrentPageAfterSave": false,
        "stayOnCurrentPageAfterCancel": false,
        // hide the Create Next button in create mode
        "hideCreateNext": true
      }
    }
  }
}
```

STEP: 3 — DiscardAction fallback behavior (annotation reference)
DESCRIPTION: If DraftRoot.DiscartAction is defined, the DiscardAction is executed when deleting a draft; otherwise the Delete call is triggered. Define DiscardAction in your service annotations to customize discard behavior.
LANGUAGE: Annotation
CODE:
```Annotation
// OData annotation example (JSON-like for clarity) — associate DiscardAction and PreparationAction with DraftRoot
{
  "EntityTypeNamespace.EntityName": {
    "@com.sap.vocabularies.Common.v1.DraftRoot": {
      "DiscardAction": "EntityName/DiscardDraftAction",
      "PreparationAction": "EntityName/PrepareDraftAction"
    }
  }
}

// Implement corresponding OData action endpoints in your service:
// - Action: EntityName/DiscardDraftAction (called when draft is discarded)
// - Action: EntityName/PrepareDraftAction (called for validation / prepare before activation)
```

STEP: 4 — Trigger PreparationAction on Enter and Validate (client behavior)
DESCRIPTION: Pressing Enter in input fields on a draft triggers PreparationAction (DraftRoot) or global side effects. PreparationAction saves pending changes and returns validation messages. If Global Side Effects specify TriggerAction, TriggerAction is called instead. For side effects with source properties plus TriggerAction, PreparationAction is not skipped.
LANGUAGE: PlainText
CODE:
```PlainText
Behavior summary:
- Enter on draft input -> PreparationAction (DraftRoot) called by default.
- Before PreparationAction, pending draft changes are saved.
- If "TriggerAction" is annotated in global side effects for that entity, TriggerAction is called instead of PreparationAction.
- Side effects configured for the entity are executed along with PreparationAction/TriggerAction.
```

STEP: 5 — Validate / Prepare on mobile/tablet (Validate button)
DESCRIPTION: For mobile/tablet object pages, expose a Validate button that calls the DraftRoot.PreparationAction and triggers configured side effects. Use same PreparationAction annotation as in STEP 3.
LANGUAGE: PlainText
CODE:
```PlainText
Usage:
- Add UI to call PreparationAction (Validate button) on subobject/object pages.
- Ensure service implements PreparationAction (validation and message return).
- Configure side effects in the annotations to run along with PreparationAction when needed.
```

STEP: 6 — OData V4: enable collaborative drafts (ShareAction) and locking
DESCRIPTION: For collaborative drafts, define ShareAction on the draft-capable entity. This enables shared drafts, WebSocket-based sync, per-field locks with editor avatars, and an Invite flow. Note restrictions: supported only with ABAP RAP and lock mechanism only for FE V4 building block extensions.
LANGUAGE: Annotation
CODE:
```Annotation
// OData V4 annotation (JSON-like) — mark entity as collaborative draft and provide a ShareAction
{
  "EntityTypeNamespace.EntityName": {
    "@com.sap.vocabularies.Common.v1.DraftRoot": {
      "ShareAction": "EntityName/ShareDraftAction"
    }
  }
}

// Implementation notes:
// - Implement server-side ShareDraftAction to expose sharing behavior.
// - Collaborative draft synchronization uses WebSocket: session remains active while users stay in draft.
// - UI: avatars and Invite control are shown automatically when service supports collaborative drafts.
```

STEP: 7 — Draft filtering (OData V4)
DESCRIPTION: Draft-related filters (Draft Created By/On, Draft Last Changed By/On) are enabled by default in V4 applications. Time-related filters use semantic operators by default. This feature is not available for CAP services.
LANGUAGE: PlainText
CODE:
```PlainText
Filters available (default in V4):
- Draft Created By
- Draft Created On
- Draft Last Changed By
- Draft Last Changed On

Note: CAP services do not expose these draft filter features by default.
```

STEP: 8 — Client-side behavior for inconsistent input before saving/apply
DESCRIPTION: If UI input is technically inconsistent with draft storage (e.g., invalid numeric chars, overflow), the UI contents differ from the draft. Save/Apply will prompt an error message requiring the user to fix technical inconsistencies before the draft can be saved or Apply completes. Logical validation errors (business rules) surface as state messages on Save.
LANGUAGE: PlainText
CODE:
```PlainText
Behavior checklist for UI developers:
- Ensure front-end validation for type/format limits to avoid technical inconsistencies.
- Provide message handling to display server-side messages returned by PreparationAction or Save.
- On Apply: verify UI and draft store contents are synchronized; block Apply until technical errors are resolved.
```

STEP: 9 — Apply button flow (subobject pages)
DESCRIPTION: Apply commits changes to the draft and navigates up one level (subobject footer). Typical flow:
1) Edit on object page -> draft created
2) Make changes -> navigate to subobject detail
3) Press Apply -> changes written to draft (not to active)
4) Later press Save on root -> changes saved to active document
LANGUAGE: PlainText
CODE:
```PlainText
Implementers:
- No manifest change needed for default Apply behavior.
- To customize discard/delete behavior, define DiscardAction in DraftRoot (see STEP 3).
- Ensure subobject footer shows Apply in create/edit mode (FE default).
```

STEP: 10 — Hiding Apply button for subobjects when hideDraft enabled
DESCRIPTION: When hideDraft.enabled is true (manifest.json), subobject Apply button is hidden automatically. Use STEP 2 manifest snippet to enable hideDraft.
LANGUAGE: JSON
CODE:
```JSON
// manifest.json — hide Draft UI (Apply button hidden automatically when enabled)
{
  "sap.fe": {
    "app": {
      "hideDraft": {
        "enabled": true
      }
    }
  }
}
```

STEP: 11 — Related links and references (for implementation/testing)
DESCRIPTION: Quick list of official docs and related conceptual pages to validate behavior and testing.
LANGUAGE: PlainText
CODE:
```PlainText
References:
- Draft Handling in SAP Fiori Design Guidelines: https://experience.sap.com/fiori-design-web/draft-handling/
- Developing New Transactional Apps with Draft Capabilities: SAP Help (ABAP)
- Confirmation Popups: confirmation-popups-9a53662.md
- Using Global Side Effects: using-global-side-effects-955ae31.md
- Toggling Between Draft and Saved Values: toggling-between-draft-and-saved-values-fd3950a.md
- FE explorer example (Draft Validation, FPM): https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/advancedFeatures/guidance/draftValidation
```
--------------------------------

**TITLE**: Dual Combination Chart Card (UI.Chart CombinationDual) — Fiori Elements

**INTRODUCTION**: Provide the OData V4 UI.Chart annotation to render a Dual Combination Chart Card in Fiori elements. Use this to show multiple measures on two value axes (columns + lines) with a category dimension. Actionable for code generation: insert the shown annotation record into your service annotations file (annotations.xml or equivalent).

**TAGS**: fiori-elements, ui.chart, annotation, CombinationDual, dual-combo, chart, OData, UI

**STEP**: 1 — Full UI.Chart annotation for a Dual Combination Chart
**DESCRIPTION**: Add a UI.Chart annotation record with ChartType CombinationDual, define Title, Measures, Dimensions, MeasureAttributes and DimensionAttributes. This full example is ready to be copied into your annotations file and adjusted to your entity properties.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.Chart" Qualifier="Eval_by_CtryCurr_Dual_Combo">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Dual Combination Chart" />
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/CombinationDual"/>
    <PropertyValue Property="Measures">
      <Collection>
        <PropertyPath>Sales</PropertyPath>
        <PropertyPath>SalesShare</PropertyPath>
        <PropertyPath>TotalSales</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Dimensions">
      <Collection>
        <PropertyPath>Product</PropertyPath>
        <PropertyPath>Quarter</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="Sales"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
        </Record>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="TotalSales" />
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
        </Record>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="SalesShare" />
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="Product" />
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 2 — Configure Measures and Dimension requirements
**DESCRIPTION**: Ensure the Measures and Dimensions collections meet the chart requirements before generating code or UI:
- Configure at least two measures in the Measures collection.
- Assign the measures to the chart (they will be bound to the chart's value feed).
- Use only one time-based dimension on the category axis when applicable.
- Assign at least one dimension the Category role; Category is the default role if not specified.
**LANGUAGE**: XML
**CODE**:
```xml
<PropertyValue Property="Measures">
  <Collection>
    <PropertyPath>Sales</PropertyPath>
    <PropertyPath>SalesShare</PropertyPath>
    <!-- add additional measures as needed -->
  </Collection>
</PropertyValue>

<PropertyValue Property="Dimensions">
  <Collection>
    <PropertyPath>Product</PropertyPath>
    <!-- optional: time-based dimension like Quarter (recommend only one) -->
    <PropertyPath>Quarter</PropertyPath>
  </Collection>
</PropertyValue>
```

**STEP**: 3 — Assign measures to axes using MeasureAttributes
**DESCRIPTION**: Map each measure to Axis1 or Axis2 using MeasureAttributes. Important behaviors:
- The first measure configured in the chart is rendered as a column; subsequent measures render as lines.
- Assign Role values: UI.ChartMeasureRoleType/Axis1 or UI.ChartMeasureRoleType/Axis2.
- Measures must be present in the Measures collection and are bound to the chart value feed irrespective of Role.
**LANGUAGE**: XML
**CODE**:
```xml
<PropertyValue Property="MeasureAttributes">
  <Collection>
    <Record Type="UI.ChartMeasureAttributeType">
      <PropertyValue Property="Measure" PropertyPath="Sales"/>
      <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
    </Record>
    <Record Type="UI.ChartMeasureAttributeType">
      <PropertyValue Property="Measure" PropertyPath="SalesShare" />
      <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2"/>
    </Record>
  </Collection>
</PropertyValue>
```

**STEP**: 4 — Assign Category role to dimensions using DimensionAttributes
**DESCRIPTION**: Ensure dimensions used for the category axis are assigned the Category role (or rely on default). Include only dimensions intended for the category axis.
**LANGUAGE**: XML
**CODE**:
```xml
<PropertyValue Property="DimensionAttributes">
  <Collection>
    <Record Type="UI.ChartDimensionAttributeType">
      <PropertyValue Property="Dimension" PropertyPath="Product" />
      <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category"/>
    </Record>
  </Collection>
</PropertyValue>
```

**STEP**: 5 — Implementation checklist & rendering notes
**DESCRIPTION**: Quick checklist before deployment:
- At least two measures configured.
- Measures listed in the Measures collection match those referenced in MeasureAttributes.
- One or more dimensions assigned to Category role.
- Prefer single time-based dimension on category axis.
- First measure is shown as columns; others as lines; use Axis1/Axis2 to control which value axis is used.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "notes": [
    "Place the XML annotation in your service annotations file (annotations.xml or equivalent).",
    "Ensure property names (e.g., Sales, SalesShare, Product) match your entity properties.",
    "ChartType must be UI.ChartType/CombinationDual for dual combination charts."
  ]
}
```
--------------------------------

**TITLE**: Editing Status — List Report (Draft) Implementation Guide for Fiori Elements

**INTRODUCTION**: This guide explains how editing status is derived from draft administrative data, how it is displayed in Fiori elements List Reports (responsive vs grid tables), how to access administrative data (user/time), how the editing-status filter works, example OData payloads and filter expressions, and how to disable the built-in editing status filter in the app manifest. Use the examples to implement or debug editing-status behavior in List Reports of draft-enabled applications.

**TAGS**: fiori-elements, draft, editing-status, list-report, manifest.json, odata, draft-administrative-data

STEP: 1 — Draft Administrative Data: key fields and sample entity payload

DESCRIPTION: Draft-enabled OData entities include administrative metadata that the UI uses to calculate editing status. Use these fields to determine which of the UI statuses to show: Own Draft, Locked by Another User, Unsaved Changes by Another User, Unchanged (active), or All.

LANGUAGE: JSON

CODE:
```json
{
  "ID": "123",
  "Title": "Sales Order 123",
  "IsActiveEntity": true,                // if false => the entity is a draft record
  "HasDraftEntity": true,                // (optional in some services) indicates draft exists
  "DraftAdministrativeData": {
    "DraftUUID": "a1b2c3d4-uuid",
    "InProcessByUser": "JOHNDOE",        // technical name or user id
    "LastChangeDateTime": "2025-10-14T08:30:00Z",
    "CreationDateTime": "2025-10-14T08:00:00Z",
    "IsLocked": true                     // some backends include explicit lock flag; if missing, derive from lock logic
  }
}
```

STEP: 2 — Mapping of backend fields to UI statuses (logic)

DESCRIPTION: Use the following decision logic (examples) to map draft admin fields to the UI statuses shown in the list report. Implement this logic in server-side query handlers or in client-side post-processing if needed.

LANGUAGE: Pseudocode

CODE:
```text
// Example mapping logic (conceptual)
if (no DraftAdministrativeData exists or HasDraftEntity == false) {
  status = "Unchanged"   // Active version, no draft
} else {
  if (DraftAdministrativeData.InProcessByUser == currentUser) {
    status = "Own Draft" // draft by current user (show "Draft: my own draft")
  } else {
    if (draftLockIsActive(DraftAdministrativeData)) {
      status = "Locked by Another User"
    } else {
      status = "Unsaved Changes by Another User" // lock expired but draft still exists
    }
  }
}
```

STEP: 3 — Example OData filter expressions for editing-status server queries

DESCRIPTION: The editing-status filter in the UI maps to OData filters to find entities in a specific state. These are example filters — adapt field names to your service metadata (IsActiveEntity, DraftAdministrativeData/InProcessByUser, HasDraftEntity).

LANGUAGE: OData (example)

CODE:
```text
// Show all entities (default)
// No filter required: $filter omitted

// Show own drafts only (example)
$filter=HasDraftEntity eq true and DraftAdministrativeData/InProcessByUser eq 'JOHNDOE'

// Show locked by another user
$filter=HasDraftEntity eq true and DraftAdministrativeData/InProcessByUser ne 'JOHNDOE' and DraftAdministrativeData/IsLocked eq true

// Show unsaved changes by another user (lock expired but draft exists)
$filter=HasDraftEntity eq true and DraftAdministrativeData/InProcessByUser ne 'JOHNDOE' and (DraftAdministrativeData/IsLocked eq false or DraftAdministrativeData/IsLocked eq null)

// Show unchanged entities (no draft)
$filter=HasDraftEntity eq false or DraftAdministrativeData eq null
```

STEP: 4 — UI behavior: where the editing status appears in the List Report

DESCRIPTION: Visual placement depends on table type in the list report:
- Responsive table: editing status is shown in the key column (inline icon/label in the row).
- Grid table: editing status appears in a separate column.
- For statuses "Unsaved Changes by Another User" and "Locked by Another User", the user name (DraftAdministrativeData/InProcessByUser) is displayed directly in the row. If full name is not in backend master data, only the technical user name is shown; if technical name is not available, the UI displays "another user".
- For statuses Own Draft, Unsaved Changes by Another User, and Locked by Another User, the list report provides a popover (link) to show the last-changed user and timestamp using DraftAdministrativeData.LastChangeDateTime.

LANGUAGE: Text

CODE:
```text
// No UI code required — behavior is provided by Fiori elements runtime.
// Ensure the OData service exposes DraftAdministrativeData navigation/property
// so the Fiori elements runtime can render the status and popover automatically.
```

STEP: 5 — Disabling the Editing Status Filter in manifest.json (example)

DESCRIPTION: Fiori elements adds a static editing-status filter to the list report filter bar by default for draft-enabled apps. To disable that filter after code generation, set the page component settings in manifest.json. Replace <EntitySet> with your list report page ID or the entity set name used in your descriptor.

LANGUAGE: JSON

CODE:
```json
// manifest.json (fragment) — example structure
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|<EntitySet>": {
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport", 
          "settings": {
            "enableEditingStatusFilter": false
          }
        }
      }
    }
  }
}
```

STEP: 6 — Links to related documentation and files

DESCRIPTION: Preserve references to related docs and internal pages for further implementation details.

LANGUAGE: Text

CODE:
```text
// Related docs and file references:
- Disabling the Editing Status Filter: disabling-the-editing-status-filter-8eb695a.md
- Handling Semantic Key Fields: handling-semantic-key-fields-aa2793c.md
- Settings for List Report Tables: settings-for-list-report-tables-4c2d17a.md
- Original images and examples used in the list report:
  images/ListReport_Edit_Draft_4e387a1.png
  images/ListReport_Edit_Active_3bbd126.png
  images/ListReport_Edit_Unsaved_8916c63.jpg
  images/ListReport_Edit_Locked_bfd9208.jpg
```

STEP: 7 — Implementation checklist

DESCRIPTION: Quick checklist for developers when enabling/editing editing status behavior.

LANGUAGE: Text

CODE:
```text
- Ensure the OData service supports draft (DraftAdministrativeData exposed).
- Verify entity-level fields: IsActiveEntity, HasDraftEntity (or equivalent).
- Confirm DraftAdministrativeData contains InProcessByUser and LastChangeDateTime.
- Ensure the List Report is bound to the draft-enabled entity set.
- If customer wants to hide the editing-status filter, edit manifest.json as shown.
- If custom logic is required for deriving lock expiry, implement it in backend or an OData-proxy layer so the UI receives canonical flags (e.g., IsLocked).
```

--------------------------------

**TITLE**: Enabling Actions Added Using Extension Points (SAP Fiori Elements)

**INTRODUCTION**: This document shows how to control enablement/visibility of custom actions added via extension points in SAP Fiori elements apps. It covers OData V2 (requiresSelection + applicablePath in manifest.json) and OData V4 (enabled property or binding expression), plus sample controller handlers. Use these snippets to declare actions in the manifest and implement enable/visible handler functions in your controller/extension.

**TAGS**: sap-fiori, fiori-elements, manifest.json, ODataV2, ODataV4, extension-points, actions, requiresSelection, applicablePath, enabled, visibility

STEP: OData V2 — List Report: Action in Table Header (requiresSelection + applicablePath)
DESCRIPTION: Declare a custom action for a List Report table header that is enabled only when a row selection exists (requiresSelection) and optionally only if the backend reports the action applicable for the selected row (applicablePath). For multiple selected rows the action is enabled if any applicablePath evaluates true. If applicablePath is omitted, the action is always enabled when selection exists.
LANGUAGE: XML / manifest.json
CODE:
```xml
"sap.ui5": {
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "controllerName": "my_app.ext.controller.ListReportExtension",
          "sap.ui.generic.app": {
            "<EntitySetName>": {
              "EntitySet": "<EntitySetName>",
              "Actions": {
                "<ActionKey1>": {
                  "id": "<id>",
                  "text": "<button text>",
                  "press": "<handler function>",
                  "requiresSelection": true,
                  "applicablePath": "<EntityTypeProperty>"    /* e.g. 'IsEditable' */
                },
                "<ActionKey2>": {
                  "id": "<id>",
                  "text": "<button text>",
                  "press": "<handler function>",
                  "requiresSelection": true
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Object Page: Header Action and Section Table Action (applicablePath + requiresSelection)
DESCRIPTION: Declare object-page header actions (considered selection = current object) and table toolbar actions inside sections. Header actions use only applicablePath (object-level); when applicablePath evaluates to false the header action is hidden. Table actions can use requiresSelection and applicablePath to control enablement per row selection.
LANGUAGE: XML / manifest.json
CODE:
```xml
"sap.ui5": {
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details#my_app::sap.suite.ui.generic.template.ObjectPage.view.Details::<EntitySetName>": {
          "controllerName": "my_app.ext.controller.DetailsExtension",
          "sap.ui.generic.app": {
            "<EntitySetName>": {
              "EntitySet": "<EntitySetName>",
              "Header": {
                "Actions": {
                  "<HeaderAction>": {
                    "id": "<id>",
                    "text": "<button text>",
                    "press": "<handler function>",
                    "applicablePath": "<EntityTypeProperty>"  /* hides if false for current object */
                  }
                }
              },
              "Sections": {
                "<EntityTypeAssociation>::com.sap.vocabularies.UI.v1.LineItem": {
                  "id": "<SmartTableFacetID>",
                  "Actions": {
                    "<SectionTableAction>": {
                      "id": "<id>",
                      "text": "<button text>",
                      "press": "<handler function>",
                      "requiresSelection": true,
                      "applicablePath": "<EntityTypeProperty>"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Draft-aware visibility via DraftAdministrativeData (controller/view extension)
DESCRIPTION: Bind a UI element (for example a button) to DraftAdministrativeData to show/hide or enable/disable based on draft state (useful to show button only in edit mode / draft-owned states). Example: in onAfterRendering bind the button to the DraftAdministrativeData navigation and to properties such as DraftIsCreatedByMe.
LANGUAGE: JavaScript
CODE:
```javascript
// file: my_app/ext/controller/DetailsExtension.controller.js
sap.ui.define([
  "sap/ui/core/Element",
  "sap/ui/core/mvc/Controller"
], function (Element, Controller) {
  "use strict";

  return Controller.extend("my_app.ext.controller.DetailsExtension", {
    onAfterRendering: function () {
      // Button global ID example: adjust to your app's generated ID
      var sButtonId = "STTA_MP::sap.suite.ui.generic.template.ObjectPage.view.Details::STTA_C_MP_Product--action::ObjectPageCustomAction";
      var oButton = Element.getElementById(sButtonId);
      if (oButton) {
        // bind the element context to DraftAdministrativeData for property access
        oButton.bindElement("DraftAdministrativeData");
        // bind visible to DraftIsCreatedByMe property
        oButton.bindProperty("visible", {
          path: "DraftIsCreatedByMe"
        });
      }
    }
  });
});
```

STEP: OData V4 — List Report: enable action via enabled property pointing to handler function
DESCRIPTION: For OData V4, set the action's enabled property to the fully qualified function reference in manifest.json. Implement the handler function to receive (oBindingContext, aSelectedContexts) and return boolean or Promise<boolean>. Common pattern: enable only when exactly one row selected.
LANGUAGE: JSON + JavaScript
CODE:
```json
/* manifest.json (snippet for ListReport target) */
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "<ListReportTargetName>": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  "actions": {
                    "<ActionName>": {
                      "press": "SalesOrder.ext.CustomActions.onMyAction",
                      "visible": true,
                      "enabled": "SalesOrder.ext.CustomActions.enabledForCompletedOnly",
                      "text": "{i18n>myActionText}"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

```javascript
/* CustomActions.js - implement the enabled handler */
sap.ui.define([], function () {
  "use strict";
  return {
    enabledForCompletedOnly: function (oBindingContext, aSelectedContexts) {
      // Example: enable only when exactly one row is selected
      if (aSelectedContexts && aSelectedContexts.length === 1) {
        return true; // or return Promise.resolve(true);
      }
      return false;
    }
  };
});
```

STEP: OData V4 — Object Page: enable via binding expression on ui model (editMode)
DESCRIPTION: Use a binding expression on the ui model to enable an object-page header/footer action only in edit mode. This is a purely manifest-based binding and requires the ui model to expose /editMode.
LANGUAGE: JSON
CODE:
```json
/* manifest.json (ObjectPage target) */
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "<ObjectPageTargetName>": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  "actions": {
                    "<ActionName>": {
                      "press": "<ApplicationId.FolderName.ScriptFilename.methodName>",
                      "visible": true,
                      "enabled": "{= ${ui>/editMode} === 'Editable' }",
                      "text": "{i18n>myActionText}"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V4 — Custom visibility handler calling backend via binding context.requestObject
DESCRIPTION: Configure an action's visibility in the manifest to call a custom function that can use the binding context to query a backend property (e.g., OverallSDProcessStatus) and return Promise<boolean>. Use this for dynamic visibility based on backend state.
LANGUAGE: JSON + JavaScript
CODE:
```json
/* manifest.json: bind a DataFieldForAction visibility to a custom function */
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "<ObjectPageTargetName>": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  "actions": {
                    "<ActionName>": {
                      "DataFieldForAction::com.c_salesordermanage_sd.ArchiveSalesOrder": {
                        "visible": "SalesOrder.ext.CustomActions.visibleForCompletedOnly"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

```javascript
/* CustomActions.js - implement visibility handler that queries the binding context */
sap.ui.define([], function () {
  "use strict";
  return {
    visibleForCompletedOnly: function (oBindingContext) {
      if (oBindingContext) {
        // requestObject returns a Promise resolving to the requested property value
        return oBindingContext.requestObject("OverallSDProcessStatus").then(function (sStatus) {
          return sStatus === "C"; // visible only if status equals "C" (completed)
        });
      }
      return false;
    }
  };
});
```

STEP: Notes & Best Practices
DESCRIPTION: Key behavioral details to preserve when implementing:
- For OData V2:
  - requiresSelection: true requires a row selection for enablement.
  - applicablePath: optional. If present, SAP Fiori elements queries backend to decide if action is applicable for selection(s). If any selected row's applicablePath is true, the action becomes enabled. For object-page header actions, applicablePath is checked for the current object; when false the action is hidden.
- For OData V4:
  - enabled can be true/false, a handler function reference (string) returning boolean or Promise<boolean>, or a binding expression.
  - Handler signature examples: function(oBindingContext, aSelectedContexts) { ... } or function(oBindingContext) for object-level actions.
- Draft apps: use DraftAdministrativeData navigation property to determine draft ownership and mode in controller extensions.
- Always use the SAP Fiori elements extensionAPI where applicable and avoid manipulating framework-internal controls or models directly.
--------------------------------

**TITLE**: Enable Generic and Custom Actions in the Object Page Header (Fiori Elements)

**INTRODUCTION**: Practical, code-focused instructions for adding and configuring header actions (Edit, Delete, Copy, custom actions and IBN) on the Fiori Elements Object Page. Includes XML OData annotations, ABAP CDS and CAP CDS examples, and platform-specific behavior and enablement controls for OData V2 and V4.

**TAGS**: fiori-elements, annotations, UI.Identification, DataFieldForAction, DataFieldForIntentBasedNavigation, ODataV2, ODataV4, ABAP, CAP, XML, CDS, header-actions

STEP: 1 — Add Generic Header Actions (XML / ABAP CDS / CAP CDS)
DESCRIPTION: Add DataFieldForAction records under unqualified UI.Identification. Each DataFieldForAction renders a header button showing the Label. Example: "Copy with new supplier" action. Use these snippets directly in your metadata annotations or CDS source.
LANGUAGE: XML
CODE:
```xml
<!-- Add inside your service metadata annotations or annotation file -->
<Annotation Term="UI.Identification">
  <Collection>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy with new supplier" />
      <PropertyValue Property="Action"
                     String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy_new_supplier" />
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
    </Record>
    <!-- additional DataFieldForAction / DataFieldForIntentBasedNavigation entries -->
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.identification: [
  {
    importance: #HIGH,
    label: 'Copy with new supplier',
    dataAction: 'PUSHDOWN:STTA_C_MP_ProductCopy_new_supplier',
    type: #FOR_ACTION,
    position: 1
  }
]
product;
```

LANGUAGE: CAP CDS (schema.cds / annotations.cds)
CODE:
```cds
// In your service or entity annotation file
annotate MyService.Product with {
  @UI.Identification: [
    {
      $Type : 'UI.DataFieldForAction',
      Label : 'Copy with new supplier',
      Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy_new_supplier',
      ![@UI.Importance] : #High
    }
  ]
};
```

STEP: 2 — Context Passing Rules (OData V2 vs V4)
DESCRIPTION: Behavior when invoking header actions:
- OData V2: object page context is always passed to the action.
- OData V4: context is passed only for bound actions (or DataFieldForIBN configured to pass context). Unbound actions receive no context.

LANGUAGE: JSON
CODE:
```json
{
  "notes": [
    "OData V2: header action -> context ALWAYS passed",
    "OData V4: header action -> context passed ONLY if action is bound (or DataFieldForIBN configured to require context). Unbound: no context."
  ]
}
```

STEP: 3 — Edit Action on Subobject Page (Rules)
DESCRIPTION: Rules for the Edit button when on subobject pages:
- Displayed on subobject page only if visible on object page and not hidden on subobject entity.
- Enabled on subobject page only if enabled on object page and not disabled on subobject entity.
- Selecting Edit on a subobject page enables edit for the entire object page (not just the subobject).

LANGUAGE: JSON
CODE:
```json
{
  "edit-subobject-rules": {
    "displayedIf": "visibleOnObjectPage && notHiddenOnSubobject",
    "enabledIf": "enabledOnObjectPage && notDisabledOnSubobject",
    "note": "Invoking Edit on subobject enables Edit for entire object page."
  }
}
```

STEP: 4 — Define a Standard Copy Action (XML / CAP CDS)
DESCRIPTION: To provide a standard Copy button, annotate a DataFieldForAction with UI.IsCopyAction = true. Copy button appears after Delete and only on the object page. You can supply a custom Label; default label is "Copy".
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Identification">
  <Collection>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy" />
      <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy" />
      <Annotation Term="UI.IsCopyAction" Bool="true" />
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: CAP CDS
CODE:
```cds
// CAP annotation block
UI.Identification : [
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'Copy',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy',
    ![@UI.IsCopyAction] : true
  }
];
```

STEP: 5 — Control Edit/Delete Visibility with OData V2 (XML)
DESCRIPTION: In OData V2, Edit/Delete visibility depends on sap:updatable and sap:deletable attributes unless you use path-based updatable-path/deletable-path. If you use updatable-path/deletable-path, do not set sap:updatable or sap:deletable directly.
LANGUAGE: XML
CODE:
```xml
<!-- Example: use UpdateRestrictions with Updatable path to control Edit button visibility -->
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_Product">
  <Annotation Term="Org.OData.Capabilities.V1.UpdateRestrictions">
    <Record>
      <PropertyValue Property="Updatable" Path="Updatable_mc"/>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 6 — Edit/Delete & UpdateHidden in OData V4 (XML / ABAP CDS / CAP CDS)
DESCRIPTION: OData V4 notes:
- Draft apps: EditAction may be defined in DraftRoot -> EditAction. If EditAction exists, UpdateRestrictions are ignored.
- Use UI.UpdateHidden (or @UI.updateHidden in CDS) at entity set level to hide Edit button statically or path-based.
- Use OperationAvailable to determine enablement when EditAction is defined.
LANGUAGE: XML
CODE:
```xml
<!-- Example: DraftRoot EditAction -->
<Annotation Term="com.sap.vocabularies.Common.v1.DraftRoot">
  <Record>
    <PropertyValue Property="EditAction" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.EditAction"/>
  </Record>
</Annotation>

<!-- Example: hide Edit statically -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/HeaderPartner">
  <Annotation Term="UI.UpdateHidden" Bool="true"/>
</Annotations>

<!-- Example: hide Edit via path -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/SalesOrderManage">
  <Annotation Term="UI.UpdateHidden" Path="isUpdateHidden"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.updateHidden:true
// OR path-based
@UI.updateHidden: #('isUpdateHidden')
define view entity SalesOrderManage { ... }
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate com.c_salesordermanage_sd.SalesOrderManage with @( UI.UpdateHidden: true);
// OR path-based
annotate com.c_salesordermanage_sd.SalesOrderManage with @( UI.UpdateHidden: isUpdateHidden);
```

STEP: 7 — Edit Enablement with OperationAvailable (OData V4)
DESCRIPTION: When EditAction exists, enablement relies on OperationAvailable:
- OperationAvailable = true OR not defined -> Edit visible and enabled (if updateHidden doesn't hide it).
- OperationAvailable = false -> Edit not visible.
- OperationAvailable = <path> -> visible; enabled only if path returns true; if path returns null -> visible but disabled.

LANGUAGE: JSON
CODE:
```json
{
  "operationAvailable-rules": {
    "trueOrNotDefined": "visible + enabled (unless updateHidden hides it)",
    "false": "not visible",
    "path": "visible; enabled if path == true; disabled if path == null or false"
  }
}
```

STEP: 8 — Define Custom Global Actions and IBN (XML / ABAP CDS / CAP CDS)
DESCRIPTION: Add custom global actions under unqualified UI.Identification. Non-determining actions are rendered next to standard actions. For IBN (DataFieldForIntentBasedNavigation) on header: RequiresContext should be false or omitted; for enablement use NavigationAvailable. Visibility controlled by UI.Hidden; enablement of DataFieldForAction controlled by OperationAvailable. Bound actions or DataFieldForIBN pass context in OData V4; unbound actions do not.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Identification">
  <Collection>
    <!-- Custom action (global) -->
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Break Up" />
      <PropertyValue Property="Action" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.BREAK_UP" />
      <!-- Optional: <Annotation Term="UI.OperationAvailable" Bool="true"/> or Path="..." -->
      <!-- Optional: <Annotation Term="UI.Hidden" Bool="false"/> or Path="..."/> -->
    </Record>

    <!-- Intent-Based Navigation (header IBN) -->
    <Record Type="UI.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="Label" String="SampleIBN"/>
      <PropertyValue Property="SemanticObject" String="MySemanticObject"/>
      <PropertyValue Property="Action" String="manage"/>
      <!-- For header IBN: RequiresContext MUST be false or omitted -->
      <PropertyValue Property="RequiresContext" Bool="false"/>
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.identification: [
  {
    label: 'Break Up',
    dataAction: 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.BREAK_UP',
    type: #FOR_ACTION,
    position: 1
  },
  {
    label: 'SampleIBN',
    semanticObjectAction: 'manage',
    type: #FOR_INTENT_BASED_NAVIGATION,
    position: 2
  }
]
TEST;
@Consumption.semanticObject: 'MySemanticObject'
%ENTITY;
```

LANGUAGE: CAP CDS
CODE:
```cds
UI : {
  Identification: [
    {
      $Type  : 'UI.DataFieldForAction',
      Label  : 'Break Up',
      Action : 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.BREAK_UP'
      // Optionally annotate OperationAvailable / Hidden
    },
    {
      $Type           : 'UI.DataFieldForIntentBasedNavigation',
      Label           : 'SampleIBN',
      SemanticObject  : 'MySemanticObject',
      Action          : 'manage',
      RequiresContext : false
    }
  ]
}
```

STEP: 9 — Visibility & Enablement Controls for Custom Actions
DESCRIPTION: Control action visibility and enablement:
- Hide: annotate action with UI.Hidden (static Bool="true" or Path="...").
- Enable/Disable: annotate action with UI.OperationAvailable (static Bool or Path).
- IBN enablement: controlled by NavigationAvailable for DataFieldForIntentBasedNavigation.
- Bound vs Unbound: Action is passed object context when it's a bound action or DataFieldForIBN (OData V4). Unbound => no context.

LANGUAGE: JSON
CODE:
```json
{
  "controls": {
    "hide": "UI.Hidden (Bool or Path)",
    "enable": "UI.OperationAvailable (Bool or Path)",
    "ibn-enable": "NavigationAvailable (Bool or Path)",
    "context-passing": "Bound actions/DataFieldForIBN -> context (OData V4). Unbound -> no context."
  }
}
```

STEP: 10 — References and Related Topics (Quick pointers)
DESCRIPTION: Use these docs for deeper implementation patterns and examples:
- Displaying Actions on the Object Page (displaying-actions-on-the-object-page-f65e8b1.md)
- Actions (actions-cbf16c5.md) — covers OperationAvailable, Bound/Unbound actions
- Setting the Criticality for Actions (setting-the-criticality-for-actions-12f2ba2.md)
- Navigation from an App (navigation-from-an-app-outbound-navigation-d782acf.md) — NavigationAvailable and IBN details

LANGUAGE: JSON
CODE:
```json
{
  "related": [
    "displaying-actions-on-the-object-page-f65e8b1.md",
    "actions-cbf16c5.md",
    "setting-the-criticality-for-actions-12f2ba2.md",
    "navigation-from-an-app-outbound-navigation-d782acf.md"
  ]
}
```
--------------------------------

**TITLE**: Enable Key User Adaptation for SAP Fiori elements (OData V4)

**INTRODUCTION**: Enable SAP Fiori elements apps to allow key-user UI adaptations (variants, header facets, forms, actions, iFrame embedding) for OData V4 apps. This guide shows the minimal manifest and annotation changes and examples to: enable flexibility, prepare header-facet annotations, stash/restrict header facets, and enable form personalization.

**TAGS**: sap-fiori, fiori-elements, ui-adaptation, sapui5-flexibility, manifest.json, annotations, header-facets, forms, CDS

**STEP**: 1 — Enable flexibility globally
**DESCRIPTION**: Turn on SAPUI5 flexibility for the app in manifest.json so key-user adaptation is enabled at runtime. This is required for all subsequent adaptations.
**LANGUAGE**: JSON
**CODE**:
```json
// manifest.json (fragment)
{
  "sap.ui5": {
    "flexEnabled": true
  }
}
```

**STEP**: 2 — Understand supported adaptations and restrictions (OData V4)
**DESCRIPTION**: Summary of what key users can and cannot adapt. Use this as a checklist when designing annotation and manifest changes.
**LANGUAGE**: JSON
**CODE**:
```json
// Supported adaptations (summary, not a manifest entry)
{
  "supported": [
    "List report variants (filters, columns, sorting, tab selection)",
    "Mass-edit dialog: define visible fields (all except static read-only)",
    "Move/rename/remove/reveal toolbar and table buttons (header & table of list report; header, section, subsection, table, footer of object page)",
    "Split/combine table actions",
    "Move/rename/remove/reveal object page sections/subsections",
    "Edit object page header facets (prepare via annotations)",
    "Move/rename/add/remove form parts (FormContainers/fields)",
    "Embed/update/move/remove iFrame content on headers/sections (cannot embed another Fiori elements app)"
  ],
  "restrictions": [
    "Not applicable to non-OData V4 apps",
    "Standard actions such as edit, save, delete are excluded",
    "Actions with dynamic visibility cannot be added or removed",
    "Cannot add button-like annotations (DataFieldForAction / intent-based) to FormContainers"
  ]
}
```

**STEP**: 3 — Prepare object page header facets via annotations
**DESCRIPTION**: Define ReferenceFacet entries in your annotation file so key users can add or reorder these header facets on the object page header. Include ID to use direct manifest references; omit ID to allow generated ID based on AnnotationPath and qualifier.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Annotation file (CDS/XML or external annotations) -->
<Annotation Term="UI.HeaderFacets">
  <Collection>
    ...
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="Column MicroChart"/>
      <PropertyValue Property="ID" String="ColumnMicroChart"/>
      <PropertyValue Property="Target" AnnotationPath="_Item/@UI.Chart#ColumnMaxPath"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="Progress Indicator"/>
      <PropertyValue Property="ID" String="ProgressIndicator"/>
      <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Progress"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    ...
  </Collection>
</Annotation>
```

**STEP**: 4 — Reference header facet IDs (explicit vs generated)
**DESCRIPTION**: When referencing header facets in manifest.json control configuration, use:
- the ID property from the annotation if provided (e.g., "ProgressIndicator"), or
- the generated ID when no ID is present: format is "<AnnotationPathTerm>::<Qualifier>" (example: "DataPoint::Rating" for @UI.DataPoint#Rating).
Use these IDs when stashing or setting flexSettings for a facet.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- If ID provided -->
<Record Type="UI.ReferenceFacet">
  <PropertyValue Property="Label" String="Progress Indicator"/>
  <PropertyValue Property="ID" String="ProgressIndicator"/>
  <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Progress"/>
</Record>

<!-- If no ID provided: generated ID example -->
<Record Type="UI.ReferenceFacet">
  <PropertyValue Property="Label" String="Rating Indicator"/>
  <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Rating"/>
</Record>
<!-- Generated manifest reference ID for second facet: "DataPoint::Rating" -->
```

**STEP**: 5 — Stash header facets and restrict adaptability via manifest.json
**DESCRIPTION**: In the manifest.json fragment for the object page component use controlConfiguration keyed by the HeaderFacets vocabulary term to:
- mark facets as "stashed": initially invisible and not loaded (can be added by key users)
- apply flexSettings.designtime to restrict adaptabilities like visibility changes
Use the facet ID (explicit or generated) as shown.
**LANGUAGE**: JSON
**CODE**:
```json
// manifest.json (fragment showing component configuration for object page)
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "editableHeaderContent ": false,
      "controlConfiguration": {
        "@com.sap.vocabularies.UI.v1.HeaderFacets": {
          "facets": {
            "ColumnMicroChart": {
              "stashed": true
            },
            "ProgressIndicator": {
              "stashed": false,
              "flexSettings": {
                "designtime": "not-adaptable-visibility"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — Behavior: stashed facets and designtime values
**DESCRIPTION**: Implementation notes for runtime behavior:
- Stashed facets: not visible and not loaded at app start. Key users can add them via adaptation UI.
- flexSettings.designtime values control allowed operations. Example "not-adaptable-visibility": disables add/remove (visibility changes) but still allows move. Use other designtime tokens as defined by your design-time descriptors.
**LANGUAGE**: JSON
**CODE**:
```json
// Example designtime usage already shown above:
// "flexSettings": { "designtime": "not-adaptable-visibility" }
```

**STEP**: 7 — Enable key user adaptation in forms (DataFieldDefault + rules)
**DESCRIPTION**: To allow key users to add fields to FormContainers, provide properties with DataFieldDefault wrapper annotations. This enables the Add dialog to surface fields (including value-help if available). Restrictions: fields can only be added once inside the same form; DataFieldForAction / intent-based navigation annotations are not supported in forms (no buttons in FormContainers). Note: fields added via flexibility have SAPUI5-flex-provided stable IDs different from Fiori elements' generated stable IDs.
**LANGUAGE**: CDS
**CODE**:
```cds
// Example CDS annotation fragment for a property with DataFieldDefault
OrganizationDivision : String(2) @(
  Common : { Label : 'Division' },
  UI : {
    DataFieldDefault : {
      $Type: 'UI.DataField',
      Value: OrganizationDivision,
      Label: 'Default Division'
    }
  }
);
```

**STEP**: 8 — iFrame embedding constraints
**DESCRIPTION**: Key users can embed, update, move, and remove iFrame content on object page headers and sections. Do not embed another SAP Fiori elements app in an iFrame within a Fiori elements app (not supported).
**LANGUAGE**: JSON
**CODE**:
```json
// No manifest change required here beyond flexEnabled;
// embedding is managed via annotations / runtime iFrame control configuration per app design.
{
  "note": "iFrame embedding allowed for generic content; do NOT embed another Fiori elements app."
}
```
--------------------------------

**TITLE**: Enabling Chart Personalization in SAP Fiori Elements

**INTRODUCTION**: This document shows how to enable, disable, and finely control chart personalization in SAP Fiori Elements (OData V4). It includes manifest.json snippets to toggle personalization globally or per-chart and describes default behaviors depending on variant management and which fields are excluded from the chart Filter personalization option.

**TAGS**: fiori-elements-framework, chart, personalization, manifest.json, OData V4, variant-management, controlConfiguration, Analytics

**STEP**: 1 — Default behavior and variant-management effects

**DESCRIPTION**: Understand default personalization visibility and how variant management level affects available chart personalization options. Use this to decide whether you need to enable filter personalization or leave defaults.

**LANGUAGE**: Text

**CODE**:
```text
Default filter option behavior:
- Filter option is available only if personalization is enabled.
- Default state for Filter:
  - Disabled in page-level variant or if variant management is not enabled.
  - Enabled in control-level variant.

Variant management mapping (OData V4):
- "Page" level: available options => Item, Sort, Type
- "None" level: available options => Item, Sort, Type
- "Control" level: available options => Item, Sort, Type, Filter
```

**STEP**: 2 — Disable chart personalization entirely (manifest.json snippet)

**DESCRIPTION**: To switch off all personalization for a specific chart, set the "personalization" property to false in the controlConfiguration for the chart annotation in your app manifest (manifest.json). Place this under the component or page configuration where your chart is defined (example uses BusinessPartnersList).

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json — example: switch off personalization for a chart
"BusinessPartnersList": {
   "type": "Component",
   "id": "BusinessPartnersList",
   "name": "sap.fe.templates.ListReport",
   "options": {
      "settings": {
         "contextPath": "/BusinessPartners",
         .....
         .....    
         "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.Chart": {
               "chartSettings": {
                  "personalization": false         
               }
            }
         }
      }
   }
},
```

**STEP**: 3 — Enable fine-grained chart personalization controls (manifest.json snippet)

**DESCRIPTION**: Provide an object for "personalization" to selectively enable or disable specific personalization features: column (item), sort, filter, type. Omit a key or set it to false to keep that feature disabled. This prevents unexpected enabling of new features in future releases.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json — example: fine-grained control over chart personalization
"BusinessPartnersList": {
   "type": "Component",
   "id": "BusinessPartnersList",
   "name": "sap.fe.templates.ListReport",
   "options": {
      "settings": {
         "contextPath": "/BusinessPartners",
         ....
         ....
         "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.Chart": {
               "chartSettings": {
                  "personalization": {
                    "column" : true,
                    "sort" : false, // Sort option is not visible
                    "filter" : true,
                    "type": true
                  }
               }
            }
         }
      }
   }
},
```

**STEP**: 4 — Allowed values for "personalization" and their effects

**DESCRIPTION**: Use the following options in manifest configuration to control chart personalization behavior.

**LANGUAGE**: Text

**CODE**:
```text
"personalization" valid values:
- true (default) : all chart personalization features are enabled. New features (e.g., future "sort") are enabled automatically.
- false : all chart personalization features are disabled.
- object : explicitly define "column", "sort", "filter", and "type" booleans. Any omitted property is treated as false (disabled).
```

**STEP**: 5 — Fields excluded from the Filter personalization option

**DESCRIPTION**: When Filter personalization is enabled, certain fields are excluded from appearing in the chart Filter UI. Exclude these annotations and property types when building or validating personalization UIs.

**LANGUAGE**: Text

**CODE**:
```text
Fields excluded from the "Filter" option:
- Properties annotated with @com.sap.vocabularies.UI.v1.HiddenFilter
- Fields coming from the navigation entity set (navigation properties)
- Properties annotated as measures:
  - Analytics.AggregatedProperty
  - Aggregation.CustomAggregate

Reference: Configuring Charts (configuring-charts-653ed0f.md)
```
--------------------------------

**TITLE**: Configure Object Page State Preservation Mode (Discovery vs Persistence)

**INTRODUCTION**: Configure how object page personalization (filters, table column visibility, tab selection, anchor section selection) is stored/restored by setting the statePreservationMode via the manifest. Use this to control whether changes apply only to the current object (discovery) or persist across objects at the same navigation level (persistence).

**TAGS**: fiori-elements-framework, sap-ui5, manifest.json, object-page, state-preservation, odata-v2, odata-v4, persistence, discovery, flexible-column-layout

STEP: 1 — Modes overview and default behavior

DESCRIPTION: Summary of the two modes and their defaults. Choose discovery for per-object-only personalization; choose persistence for shared personalization across same-level objects (typical for Flexible Column Layout (FCL)).

LANGUAGE: text

CODE:
```text
Discovery mode (default for non-FCL apps)
- Personalization changes affect only the currently opened object.
- Navigating to another object does NOT carry over filters, tab selection, etc.
- Good when each object should keep its own view state.

Persistence mode (default for FCL apps)
- Personalization changes affect the current object and other objects at the same level when navigating (e.g., via paginator).
- Filters and tab selections persist across objects at the same level.
- Use when you want a consistent, shared state across sibling objects.
```

STEP: 2 — Set statePreservationMode in manifest.json for OData V2 apps

DESCRIPTION: Edit webapp/manifest.json to set "statePreservationMode" under "sap.ui.generic.app"."settings". Replace the value with "persistence" or "discovery" depending on desired behavior. This example shows both options.

LANGUAGE: JSON

CODE:
```json
// File: webapp/manifest.json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "objectPageDynamicHeaderTitleWithVM": true,
      "statePreservationMode": "persistence" // or "discovery"
    },
    "pages": {
      "ListReport|C_STTA_SalesOrder_WD_20": {
        // page configuration...
      }
    }
  }
}
```

STEP: 3 — When to choose each mode (action guidance)

DESCRIPTION: Action-oriented rules to select a mode based on app layout and UX requirements.

LANGUAGE: text

CODE:
```text
- Choose "persistence" when:
  - App uses Flexible Column Layout (FCL).
  - You want filters, column selections, and tab selections to persist across same-level objects.
  - You want a consistent user experience when moving between objects.

- Choose "discovery" when:
  - App does NOT use FCL and each object should maintain its own isolated state.
  - You want default control settings (annotations/manifest) applied when opening a new object.
```

STEP: 4 — Important behavior notes and exceptions

DESCRIPTION: Preserve these behavioral details in code comments, documentation, or release notes—critical for user expectations.

LANGUAGE: text

CODE:
```text
- Section selection persists only when a section is selected via the anchor navigation area;
  scrolling to a section does NOT persist selection.

- Changes made to an object page at any level do NOT persist after the object page is closed:
  they reset to the annotation/manifest defaults when reopened.

- Exception: The last subobject you opened may keep its changes even after closing the subobject
  (recently opened object state may persist in some scenarios).

- Implementers should not rely on persistence across closed object pages except for the last open object.
```

STEP: 5 — Restriction for OData V4

DESCRIPTION: OData V4-specific limitation: discovery mode is not supported. Configure only "persistence" for OData V4 apps (or rely on framework defaults).

LANGUAGE: text

CODE:
```text
- Restriction: Discovery mode is NOT applicable to SAP Fiori elements for OData V4.
- For OData V4, use persistence mode or accept the framework's default behavior.
```

STEP: 6 — Validate changes and testing checklist

DESCRIPTION: Checklist to validate manifest changes and verify expected runtime behavior.

LANGUAGE: text

CODE:
```text
- Update webapp/manifest.json with desired "statePreservationMode".
- Rebuild/deploy the app and open the object page(s).
- Test scenarios:
  1) Apply filters / change table columns / switch tabs on one object.
  2) Navigate to another object at the same level.
     - If "persistence": changes should carry over.
     - If "discovery": changes should NOT carry over (default settings applied).
  3) Select an anchor section and verify selection persists when re-opening objects only if selected via anchor.
  4) Close a subobject and reopen it to verify whether changes reset (expected) except possible persistence for the last-opened object.
- If behavior differs, confirm OData version and FCL usage; ensure no app-level overrides intercept state handling.
```
--------------------------------

**TITLE**: Enabling Mass Edit (Dialog) in Fiori Elements — manifest.json configuration and rules

**INTRODUCTION**: This document shows exactly how to enable and configure the Mass Edit dialog (mass edit) in SAP Fiori Elements applications via manifest.json. It provides actionable manifest fragments for toggling mass edit, restricting or exposing fields, controlling operation grouping, and lists prerequisites and runtime restrictions to follow when generating or editing code.

**TAGS**: fiori-elements-framework, odata-v4, mass-edit, manifest.json, enableMassEdit, operationGroupingMode, visibleFields, ignoredFields

**STEP**: 1 — Enable mass edit (boolean)
**DESCRIPTION**: Turn the Mass Edit dialog on for a specific table (LineItem). Place this manifest fragment under your application manifest where controlConfiguration is defined for the table UI annotation path.
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "controlConfiguration": {
    "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "enableMassEdit": true
      }
    }
  }
}
```

**STEP**: 2 — Enable mass edit and specify visibleFields (comma-separated)
**DESCRIPTION**: To improve performance and control which fields appear in the dialog, set visibleFields as a comma-separated list of properties. When visibleFields is set, ignoredFields is ignored. Use this for OData V4. This fragment goes in the same controlConfiguration -> tableSettings location.
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "controlConfiguration": {
    "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "enableMassEdit": {
          "visibleFields": "PropertyA,PropertyB,PropertyC"
        }
      }
    }
  }
}
```

**STEP**: 3 — Enable mass edit and specify visibleFields (FieldGroup annotation)
**DESCRIPTION**: Instead of a comma-separated list you can reference a FieldGroup annotation. Only one of visibleFields or ignoredFields may be used.
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "controlConfiguration": {
    "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "enableMassEdit": {
          "visibleFields": "@com.sap.vocabularies.UI.v1.FieldGroup#MyFieldGroup"
        }
      }
    }
  }
}
```

**STEP**: 4 — Enable mass edit and ignore specific fields
**DESCRIPTION**: Use ignoredFields to hide specific fields (comma-separated). Note: if visibleFields is present, ignoredFields is ignored. Use this when you want the dialog to include all table-visible editable fields except some.
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "controlConfiguration": {
    "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "enableMassEdit": {
          "ignoredFields": "Property2,Property3"
        }
      }
    }
  }
}
```

**STEP**: 5 — Set operation grouping mode (ChangeSet or Isolated)
**DESCRIPTION**: Control how update requests are grouped for the selected records in mass edit. Add operationGroupingMode inside enableMassEdit. Default: object page = "ChangeSet", list report = "Isolated".
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "controlConfiguration": {
    "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "enableMassEdit": {
          "visibleFields": "PropertyA,PropertyB",
          "operationGroupingMode": "Isolated"   /* or "ChangeSet" */
        }
      }
    }
  }
}
```

**STEP**: 6 — Example: full minimal manifest fragment combining settings
**DESCRIPTION**: Minimal combined example demonstrating boolean, visibleFields and operationGroupingMode options (only include one of the patterns in real manifest).
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "controlConfiguration": {
    "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        /* Option A: enable mass edit (simple boolean) */
        "enableMassEdit": true

        /* Option B: enable mass edit with field selection and operation grouping
        "enableMassEdit": {
          "visibleFields": "PropertyA,PropertyB",
          "operationGroupingMode": "ChangeSet"
        }
        */
      }
    }
  }
}
```

**STEP**: 7 — Runtime prerequisites and behavior (rules to implement / validate)
**DESCRIPTION**: Enforce these prerequisites and runtime behaviors in your application logic (no manifest keys) or inform code generation:
- The feature must be enabled in the manifest (as shown above).
- End users must select at least one record to open the dialog.
- On object pages, mass edit is available only in edit mode.
- The Edit button is hidden if the table entity has UI.UpdateHidden or static update restriction = false.
- The Edit button is disabled if update restriction evaluates to a path that is false.
- When the dialog opens, editable read-only fields are excluded automatically.
- For performance, use visibleFields to limit fields returned/loaded by the dialog.

**LANGUAGE**: text
**CODE**:
```
Practical limits and server-side / UX implications:
- Mass edit does NOT change draft vs active status.
- If parent entity has a navigation restriction to the table entity set, that restriction takes priority.
- If enableMassEdit is on and selectionMode is not set or is "Multi", multiple record selection is allowed.
- Suggestion lists in dialog may be suppressed for fields:
  * Part of Common.ValueListParameterIn mapping where the source field is set
  * Having Common.ValueListParameterOut mapping (ambiguous out mapping)
- For ETag-protected services: ensure ETag master (child ETag must not depend on parent ETag).
- Only first 30 selected lines are used to propose currently selected values in the dialog; for >30 selected lines the dialog opens directly and editability is computed in background.
- Server-side validation during field changes in the dialog is not executed until user clicks Save.
```

**STEP**: 8 — Restrictions (fields not supported in mass edit)
**DESCRIPTION**: Ensure UI generation omits these field types from mass edit dialog and from visibleFields/ignoredFields configuration.
**LANGUAGE**: text
**CODE**:
```
Not available in the mass edit dialog:
- Image-based fields
- DataFieldForAnnotation-based fields (micro-chart, contact fields, fields coming from a FieldGroup-based field in the table)
- Multi-input fields
- Fields from navigation properties (navigation entities)
- Custom fields
- Fields with context-dependent value help
- Value-help fields with fixed dropdown values ("@Common.ValueListWithFixedValues": true)
```

**STEP**: 9 — CAP Node.js backend note (feature flag)
**DESCRIPTION**: If using CAP (Node.js), enable the SAPUI5 mass edit server-side support via CAP feature flag (check CAP release notes / docs).
**LANGUAGE**: text
**CODE**:
```
Reference: CAP Node.js feature flag for SAPUI5 mass edit
https://cap.cloud.sap/docs/releases/dec23#sapui5-mass-edit
Ensure the backend supports mass edit before enabling enableMassEdit in the UI manifest.
```
--------------------------------

**TITLE**: Enable Mass Edit (MultiEdit) Dialog in List Report (SAP Fiori elements OData V2)

**INTRODUCTION**: Enable and configure the mass edit (MultiEdit) dialog in a List Report app so users can edit one or multiple selected rows at once. This guide shows manifest.json configuration, optional FieldGroup annotation to limit fields, how to ignore specific fields, and how to override the dialog title.

**TAGS**: sap-fiori, fiori-elements, list-report, multiEdit, mass-edit, manifest.json, annotations, i18n

STEP: 1 — Enable MultiEdit in manifest.json
DESCRIPTION: Turn on the MultiEdit dialog for a responsive or grid table in the List Report. Add these settings to your app manifest.json under "sap.ui.generic.app" → pages → component → settings → tableSettings. File: manifest.json.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "STTA_C_SO_SalesOrder_ND",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "tableSettings": {
              "multiEdit": {
                "enabled": true
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 2 — Default behavior and user flow
DESCRIPTION: When multiEdit is enabled:
- The Edit action appears in the table toolbar.
- User selects multiple records and clicks Edit to open the mass edit dialog.
- By default the dialog displays editable fields corresponding to columns currently displayed in the table (table personalization affects this).
- Entered values are applied to all selected instances. Each selected instance is updated as a separate changeset within a single batch; failures for one do not cancel others.
LANGUAGE: text
CODE:
```
Default behavior:
- Edit control appears in list toolbar when "multiEdit.enabled": true.
- Dialog fields: columns currently visible in the table.
- Update execution: one changeset per instance inside a single batch request.
- Failure handling: an error for one instance does not stop updates for other selected instances.
```

STEP: 3 — Specify FieldGroup (annotationPath) to control which fields appear (recommended for performance)
DESCRIPTION: To limit the fields shown in the MultiEdit dialog (recommended for performance), define a UI.FieldGroup annotation with a qualifier and reference it from manifest.json via annotationPath. Add annotationPath under tableSettings.multiEdit.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "STTA_C_SO_SalesOrder_ND",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "tableSettings": {
              "multiEdit": {
                "enabled": true,
                "annotationPath": "com.sap.vocabularies.UI.v1.FieldGroup#MultiEdit"
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 4 — Example UI.FieldGroup annotation (XML)
DESCRIPTION: Place this annotation in your annotation XML file (or in your service annotations) and ensure the Qualifier matches the annotationPath in the manifest. The Data collection lists the DataField paths that appear in the dialog.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="UI.FieldGroup" Qualifier="MultiEdit">
    <Record>
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="NetAmount"/>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="TaxAmount"/>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="LifecycleStatus"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 5 — Ignore specific fields from the MultiEdit dialog (key user adaptation)
DESCRIPTION: Prevent particular properties from being added to the mass edit dialog by listing them in ignoredFields as a comma-separated string in manifest.json under tableSettings.multiEdit. This is useful for key-user adaptations or to explicitly exclude fields.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "STTA_C_SO_SalesOrder_ND",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "tableSettings": {
              "multiEdit": {
                "enabled": true,
                "annotationPath": "com.sap.vocabularies.UI.v1.FieldGroup#MultiEdit",
                "ignoredFields": "NetAmount,TaxAmount"
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 6 — Override default MultiEdit dialog title via i18n
DESCRIPTION: Replace the default title "Edit(X)" by adding MULTI_EDIT_DIALOG_TITLE to the List Report i18n properties file (i18n.properties). Use placeholders if you want the selected-count inserted.
LANGUAGE: Properties
CODE:
```
# i18n.properties (List Report)
MULTI_EDIT_DIALOG_TITLE=Edit ({0})  # {0} will be replaced by the number of selected items
```

STEP: 7 — Limitations and supported scenarios
DESCRIPTION: Key constraints to keep in mind when implementing MultiEdit:
- Supported table types: responsive tables and grid tables only.
- Not supported: smart multi-input fields, custom columns, and DataFieldForAnnotations.
- Only properties of the entity set are supported for mass edit (no navigation property edits).
- Each selected instance is updated in a separate changeset within one batch request; partial failures are possible (some changesets can fail while others succeed).
LANGUAGE: text
CODE:
```
Limitations:
- Table types: responsive table and grid table only.
- Unsupported field types: smart multi-input, custom columns, DataFieldForAnnotations.
- Supported fields: direct properties of the entity set only.
- Batch behavior: one changeset per instance inside a single batch; individual changeset failures do not block other changesets.
```
--------------------------------

**TITLE**: Enabling Inline Creation Mode or Empty Row Mode for Table Entries (Fiori Elements, OData V2 & V4)

**INTRODUCTION**: This guide provides actionable configuration and annotation snippets to enable inline creation (inline editing) and empty-row creation modes for object page tables in SAP Fiori Elements (both OData V2 and OData V4). It covers manifest.json settings, annotation snippets for RequiredProperties, DefaultValuesFunction, and SideEffects, plus UI behavior toggles such as disableDefaultInlineCreateSort and inlineCreationRowsHiddenInEditMode.

**TAGS**: fiori-elements, manifest.json, createMode, inline-creation, creationRows, DefaultValuesFunction, RequiredProperties, SideEffects, ODataV2, ODataV4, annotations

STEP: Configure application-level and page-level createMode (OData V2)

DESCRIPTION: Set default createMode at the app level and override it at object-page or section/table level. Valid OData V2 values: "inline", "creationRows", "creationRowsHiddenInEditMode", "newPage". Section IDs in manifest must match the annotation section IDs (e.g., to_ProductText::com.sap.vocabularies.UI.v1.LineItem). Example shows app-level, object-page-level, and section/table-level overrides.

LANGUAGE: JSON

CODE:
```JSON
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "tableSettings": {
        "createMode": "creationRows"   // App-level default for all object pages
      }
    },
    "pages": {
      "ListReport|C_STTA_SalesOrder_WD_20": {
        "entitySet": "C_STTA_SalesOrder_WD_20",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": {
          "ObjectPage|C_STTA_SalesOrder_WD_20": {
            "entitySet": "C_STTA_SalesOrder_WD_20",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "createMode": "inline",    // Overrides app-level default for this object page
                "sections": {
                  "to_Item::com.sap.vocabularies.UI.v1.LineItem": {
                    "navigationProperty": "to_Item",
                    "entitySet": "C_STTA_SalesOrderItem_WD_20",
                    "createMode": "newPage", // Overrides object-page and app-level for this table/section
                    "tableSettings": {
                      "inlineDelete": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Enable creationRowsHiddenInEditMode vs creationRows (OData V2)

DESCRIPTION: Use "creationRowsHiddenInEditMode" to hide the empty row while editing an existing object. The empty row is added when user clicks Create. Example inside ObjectPage settings.

LANGUAGE: JSON

CODE:
```JSON
{
  "ObjectPage|SalesOrderObject": {
    "entitySet": "SalesOrder",
    "component": {
      "name": "sap.suite.ui.generic.template.ObjectPage",
      "settings": {
        "controlConfiguration": {
          "to_Item::com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "createMode": "creationRowsHiddenInEditMode", // empty row hidden in edit mode
              "inlineDelete": true
            }
          }
        }
      }
    }
  }
}
```

STEP: Disable default inline-create sorting (OData V2)

DESCRIPTION: By default, new inline rows are placed at the top in edit mode. To keep existing table sort order, set disableDefaultInlineCreateSort = true for the specific section/table (only evaluated when createMode = "inline").

LANGUAGE: JSON

CODE:
```JSON
{
  "ObjectPage|STTA_C_MP_Product": {
    "entitySet": "STTA_C_MP_Product",
    "component": {
      "name": "sap.suite.ui.generic.template.ObjectPage",
      "settings": {
        "showRelatedApps": true,
        "tableType": "ResponsiveTable",
        "editableHeaderContent": true,
        "sections": {
          "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
            "navigationProperty": "to_ProductText",
            "entitySet": "STTA_C_MP_ProductText",
            "multiSelect": true,
            "createMode": "inline",
            "disableDefaultInlineCreateSort": true,
            "tableType": "ResponsiveTable"
          }
        }
      }
    }
  }
}
```

STEP: Annotate RequiredProperties (InsertRestrictions) for empty row support

DESCRIPTION: Declare required fields for insert (used to determine when an empty row can be converted to a draft). Use Capabilities.InsertRestrictions.RequiredProperties in annotations. When RequiredProperties are not filled, the runtime shows errors and prevents draft creation.

LANGUAGE: XML

CODE:
```XML
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/_Item"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="Capabilities.InsertRestrictions">
    <Record Type="Capabilities.InsertRestrictionsType">
      <PropertyValue Property="RequiredProperties">
        <Collection>
          <PropertyPath>RequestedQuantity</PropertyPath>
          <PropertyPath>Material</PropertyPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Override required-field error text in i18n

DESCRIPTION: Provide a custom message for an empty required column using i18n key format:
REQUIRED_PROP_ERROR|<EntitySet>|<navigationProperty>|com.sap.vocabularies.UI.v1.LineItem|<Required Property Name>

LANGUAGE: TEXT

CODE:
```TEXT
# i18n.properties (example)
REQUIRED_PROP_ERROR|C_STTA_SalesOrder_WD_20|to_Item|com.sap.vocabularies.UI.v1.LineItem|so_item_pos=Enter an item position
```

STEP: Configure DefaultValuesFunction to prefill empty rows (OData V2 EDMX)

DESCRIPTION: Define a FunctionImport that returns defaults, then annotate the entity set with com.sap.vocabularies.Common.v1.DefaultValuesFunction pointing to that FunctionImport. Two variants: a root-level create and a navigation property (item) create.

LANGUAGE: XML

CODE:
```XML
<!-- FunctionImport for root create -->
<FunctionImport Name="GetDefaultsForRoot" ReturnType="cds_zrc_dv_defaultvalues.ZRC_DV_A_Create" m:HttpMethod="GET"/>

<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="cds_zrc_dv_defaultvalues.cds_zrc_dv_defaultvalues_Entities/Root">
  <Annotation Term="com.sap.vocabularies.Common.v1.DefaultValuesFunction" String="GetDefaultsForRoot"/>
</Annotations>

<!-- FunctionImport for navigation property / item create -->
<FunctionImport Name="GetDefaultsForItem"
                ReturnType="cds_zrc_dv_defaultvalues.ZRC_DV_A_Create"
                m:HttpMethod="GET"
                sap:action-for="cds_zrc_dv_defaultvalues.RootType">
  <Parameter Name="UUID" Type="Edm.Guid" Mode="In"/>
</FunctionImport>

<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="cds_zrc_dv_defaultvalues.RootType/to_Item">
  <Annotation Term="com.sap.vocabularies.Common.v1.DefaultValuesFunction" String="GetDefaultsForItem"/>
</Annotations>
```

STEP: Recalculate default values when source properties change (SideEffects)

DESCRIPTION: Annotate side effects so the empty row updates when a property that affects default calculation changes. Use a SideEffects record referencing SourceProperties and TargetEntities (use the navigation property representing the table as target). Provide both concise side-effect syntax and full XML annotation example.

LANGUAGE: TEXT

CODE:
```TEXT
SideEffects #TableIsRefreshed: {
      SourceProperties: [CustomerNumber],
      TargetEntities  : [_Item]
}
```

LANGUAGE: XML

CODE:
```XML
<Annotation Term="Common.SideEffects" Qualifier="TableIsRefreshed"
            xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Record Type="Common.SideEffectsType">
    <PropertyValue Property="SourceProperties">
      <Collection>
        <PropertyPath>CustomerNumber</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="TargetEntities">
      <Collection>
        <NavigationPropertyPath>_Item</NavigationPropertyPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: DefaultValuesFunction behavior and notes

DESCRIPTION: Key behaviors and requirements:
- Empty row is prefilled with DefaultValuesFunction if annotation is defined on the entity set used by the table.
- If a property influencing defaults changes, annotate side effects using the table navigation property so the empty row refreshes.
- Empty row has no backend draft entry until converted (per-required-properties / side effects rules).
- For apps on SAP NetWeaver 7.51 SP00 or lower: table filters in inline creation mode may not work properly for draft-enabled apps.

LANGUAGE: TEXT

CODE:
```TEXT
Behavior summary:
- Responsive tables: empty row appears at the top.
- Grid tables: empty row appears at the bottom.
- Responsive table: Create button hidden in empty-row mode.
- Grid table: Create button visible; selecting Create scrolls to empty row and focuses first editable field.
- Empty row highlight: new inline entry is highlighted (blue) until saved.
- RequiredProperties must be satisfied before an empty row converts to a draft.
```

STEP: OData V4 — Enable Inline creationMode (FE V4)

DESCRIPTION: For Fiori Elements OData V4, configure controlConfiguration for the table (component is sap.fe.templates.ObjectPage). Set creationMode.name to "Inline" to enable inline creation. If a field is controlled by FieldControl=mandatory, an asterisk is displayed in the column header.

LANGUAGE: JSON

CODE:
```JSON
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "controlConfiguration": {
        "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
          "tableSettings": {
            "creationMode": {
              "name": "Inline" // Inline creation (default)
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V4 — Enable InlineCreationRows and inlineCreationRowsHiddenInEditMode

DESCRIPTION: Use creationMode.name = "InlineCreationRows" to enable empty-row behavior in FE V4. Set inlineCreationRowsHiddenInEditMode to true to hide the empty row while editing an existing object (it will be shown when the user clicks Create).

LANGUAGE: JSON

CODE:
```JSON
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "controlConfiguration": {
        "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
          "tableSettings": {
            "creationMode": {
              "name": "InlineCreationRows",
              "inlineCreationRowsHiddenInEditMode": true
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V4 — Define defaultCreationMode globally

DESCRIPTION: Set defaultCreationMode in sap.fe.macros.table so a default creation mode is applied to all tables unless overridden per table.

LANGUAGE: JSON

CODE:
```JSON
"sap.fe": {
  "macros": {
    "table": {
      "defaultCreationMode": "InlineCreationRows"
    }
  }
}
```

STEP: Empty-row required-field visuals and runtime behavior

DESCRIPTION: Runtime UX and validation specifics to implement/expect:
- RequiredProperties annotated via Capabilities.InsertRestrictions show an asterisk in column header.
- An empty required field shows the standard message "Enter a value"; override via i18n (see i18n key format step).
- Empty row deletes clear contents and replace with a new empty row.
- In V2 creationRows mode: modified empty row converts to draft after 20 seconds unless structural side effect exists or user presses Enter.
- In V4 empty-row mode: leaving (blur) the input field converts the row to draft immediately.

LANGUAGE: TEXT

CODE:
```TEXT
Runtime notes:
- Convert-to-draft rules:
  * V2 creationRows: delay ~20s for conversion unless side effect or explicit Enter.
  * V4 InlineCreationRows: blur triggers immediate conversion.
- Hide row actions (chevron/navigation/inline delete) on empty row.
- Sorting/grouping not applied to empty row (no backend entry).
```

STEP: Additional configuration reminders

DESCRIPTION: Checklist and pointers to ensure correct behavior:
- Match section IDs in annotations and manifest (use defined ID if you set one).
- Use InsertRestrictions annotation to make object page tables insertable or non-insertable.
- For DefaultValuesFunction, ensure the FunctionImport exists and the entity-set annotation points to it.
- For RequiredProperties, consider setting UI.Importance = High on responsive table columns so required columns do not overflow and hide on small devices.

LANGUAGE: TEXT

CODE:
```TEXT
Checklist:
- Ensure annotation Target uses the correct entity or navigation path (e.g., EntitySet/NavigationProperty).
- Add SideEffects for any source property that affects default values.
- Verify manifest overrides (app -> object page -> section/table) are set as needed.
- Update i18n keys for custom required-field messages.
```


--------------------------------

**TITLE**: Enable Lazy Loading for Custom Object Page Sections (Fiori elements OData V2)

**INTRODUCTION**: This guide shows how to enable lazy loading for custom sections (fragments) added to an Object Page via extension points in a Fiori elements (OData V2) app by setting the enableLazyLoading parameter in manifest.json. Use this to defer loading of independent custom sections until they are needed.

**TAGS**: fiori-elements-framework, odata-v2, lazy-loading, manifest.json, extension-points, object-page, ObjectPageLayout

**STEP**: 1 — Confirm applicability

**DESCRIPTION**: Ensure your application is a SAP Fiori elements app using OData V2. Lazy loading of extension-point sections is supported only for OData V2 object pages.

**LANGUAGE**: Text

**CODE**:
```text
Applicable only for: SAP Fiori elements for OData V2
```

**STEP**: 2 — Add enableLazyLoading to the extension-point entry in manifest.json

**DESCRIPTION**: Locate the manifest.json entry where you register your fragment via the Object Page view extension point (typically under sap.ui5 -> extends -> extensions -> sap.ui.viewExtensions). Add the "sap.ui.generic.app" block with "enableLazyLoading": true inside the extension definition for that facet. This defers loading of the fragment until the facet is activated/displayed.

Place the parameter only for sections that do not affect other sections or the object page header.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "AfterFacet|STTA_C_MP_Producttext|ProductTextCollectionFacetID": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "STTA_MP.ext.fragments.ApplicationLogBreakout",
              "type": "XML",
              "sap.ui.generic.app": {
                "title": "{{xtit.applicationLog}}",
                "enableLazyLoading": true
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Validate behavior and constraints

**DESCRIPTION**: After deployment, verify the custom facet loads on demand (when expanded or navigated to). Do not enable lazy loading for facets that need to initialize shared state, affect other facets, or modify the object page header, as this can cause functional or UI inconsistencies.

**LANGUAGE**: Text

**CODE**:
```text
Validation checklist:
- Confirm the facet fragment is not loaded at initial object page render.
- Expand or navigate to the facet to trigger loading; verify correct fragment behavior.
- Ensure no header content or inter-facet dependencies break when lazy loading is enabled.
```

**STEP**: 4 — References

**DESCRIPTION**: Consult Fiori design guidelines and API reference for object page structure and behavior.

**LANGUAGE**: Text

**CODE**:
```text
References:
- SAP Fiori Design Guidelines (Object Page structure): https://experience.sap.com/fiori-design-web/object-page/#structure
- API Reference: sap.uxap.ObjectPageLayout: https://ui5.sap.com/#/api/sap.uxap.ObjectPageLayout
```
--------------------------------

**TITLE**: Enable Multiple Row Selection in SAP Fiori Elements Tables (OData V2 & V4)

**INTRODUCTION**: Configure table row selection mode (single/multiple/none), Select All / Clear All behavior, and selection limits in Fiori Elements apps by editing manifest.json table settings for List Reports and Object Pages. This reference contains ready-to-use JSON snippets and actionable notes for both OData V2 and OData V4 scenarios.

**TAGS**: fiori-elements-framework, manifest.json, odata-v2, odata-v4, tableSettings, selectionMode, multiSelect, selectAll, selectionLimit

STEP: OData V2 — List Report: enable multiple selection

DESCRIPTION: Enable multiple row selection for a List Report table by setting tableSettings.multiSelect = true under sap.ui.generic.app -> pages -> "ListReport|<EntitySet>". Use this snippet inside your manifest.json.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "pages": {
      "ListReport|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "tableSettings": {
              "multiSelect": true
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Object Page: enable multiple selection globally or per table

DESCRIPTION: Enable multiple selection for all tables on an Object Page by placing tableSettings.multiSelect = true at the page settings level. Or enable it per table by adding tableSettings.multiSelect = true inside a specific section definition (line item). Insert into the ObjectPage manifest.json page entry.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "name": "sap.suite.ui.generic.template.ObjectPage",
        "settings": {
          "showRelatedApps": true,
          "editableHeaderContent": true,
          "tableSettings": {
            "multiSelect": true
          },
          "sections": {
            "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
              "navigationProperty": "to_ProductText",
              "entitySet": "STTA_C_MP_ProductText",
              "createMode": "inline"
            }
          }
        }
      }
    }
  }
}
```

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "name": "sap.suite.ui.generic.template.ObjectPage",
        "settings": {
          "showRelatedApps": true,
          "editableHeaderContent": true,
          "sections": {
            "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
              "navigationProperty": "to_ProductText",
              "entitySet": "STTA_C_MP_ProductText",
              "createMode": "inline",
              "tableSettings": {
                "multiSelect": true
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Select All / Clear All and selectionLimit

DESCRIPTION: Control Select All vs Clear All behavior and limit selection for Grid/Analytical/Tree tables. For responsive tables: Select All checkbox shown by default when multiSelect = true; set selectAll = false to show Clear All by default. selectionLimit applies only to Grid/Analytical/Tree tables (default 200). Use these tableSettings entries in manifest.json.

LANGUAGE: JSON

CODE:
```json
{
  "tableSettings": {
    "multiSelect": true,
    "selectAll": false,
    "selectionLimit": 150
  }
}
```

STEP: OData V4 — selectionMode values and behavior (action-oriented summary)

DESCRIPTION: Use selectionMode to control selection behavior in V4 apps. Set under controlConfiguration -> <LineItem path> -> tableSettings. Available values:
- "Multi": default. In display mode, allows multi-selection only if toolbar contains actions that require context (or IB Navigation). In edit mode, if no context actions but a Delete button exists, multi-selection is allowed.
- "Single": single selection with same rule-checking for context actions; may be allowed in edit mode with Delete button.
- "None": disables selection in display mode; in edit mode selection (including multi) is allowed if a Delete button exists.
- "Auto": deprecated — avoid using.

LANGUAGE: JSON

CODE:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "type": "ResponsiveTable",
        "selectionMode": "Multi"
      }
    }
  }
}
```

STEP: OData V4 — List Report example: set selectionMode to Multi

DESCRIPTION: Example manifest.json component entry for a List Report using sap.fe.templates.ListReport with a responsive table and selectionMode set to Multi.

LANGUAGE: JSON

CODE:
```json
{
  "SalesOrderManageList": {
    "type": "Component",
    "id": "SalesOrderManageList",
    "name": "sap.fe.templates.ListReport",
    "options": {
      "settings": {
        "contextPath": "/SalesOrderManage",
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "type": "ResponsiveTable",
              "selectionMode": "Multi"
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V4 — Object Page example: set selectionMode, selectAll and selectionLimit

DESCRIPTION: Example manifest.json component entry for an Object Page using sap.fe.templates.ObjectPage. Demonstrates per-table tableSettings including selectionMode = "Multi", selectAll toggle, and selectionLimit (applies to Grid/Analytical/Tree tables).

LANGUAGE: JSON

CODE:
```json
{
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "contextPath": "/SalesOrderManage",
        "sectionLayout": "Tabs",
        "controlConfiguration": {
          "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "type": "GridTable",
              "selectionMode": "Multi",
              "selectAll": true,
              "selectionLimit": 50
            }
          }
        }
      }
    }
  }
}
```

STEP: Notes & performance guidance (actionable)

DESCRIPTION: Practical rules to apply in code:
- For Grid/Analytical/Tree tables, selectionLimit defaults to 200 if not set — set selectionLimit explicitly to avoid unexpected large backend loads.
- For Grid/Analytical/Tree tables, selectAll = true triggers backend-driven page-sequential loading of all data — enable only if dataset size is reasonable.
- For Responsive tables, selectAll = true selects only currently loaded rows and shows a toast with the selected count; selectAll = false shows Clear All by default.
- For OData V4, prefer "Multi"/"Single"/"None" values; avoid "Auto" (deprecated). Always ensure toolbar actions that require selection/context are present when relying on automatic selection enabling/disabling behavior.

LANGUAGE: JSON

CODE:
```json
{
  "recommendations": {
    "grid_tables": {
      "defaultSelectionLimit": 200,
      "setSelectionLimit": "true to avoid large backend requests",
      "selectAllPerformance": "enable selectAll only for small/controlled datasets"
    },
    "responsive_tables": {
      "selectAll": "true selects only loaded rows and shows a toast",
      "selectAllFalse": "shows Clear All button by default"
    },
    "odata_v4": {
      "avoid": "Auto (deprecated)",
      "use": ["Multi", "Single", "None"]
    }
  }
}
```
--------------------------------

**TITLE**: Enable Create-Dialog for Object Creation in List Report (Fiori Elements OData V2 & V4)

**INTRODUCTION**: Instructions and manifest snippets to enable creating new entities using a modal dialog in List Report pages. Includes V2 (createWithParameterDialog) and V4 (creationMode) configurations, i18n customization keys, runtime behaviors, constraints, and example fragments that can be copied into manifest.json.

**TAGS**: fiori-elements-framework, odata-v2, odata-v4, list-report, manifest.json, create-dialog, createWithParameterDialog, creationMode, i18n

STEP: 1 — Enable create dialog (OData V2) in a List Report (single view)
DESCRIPTION: Add createWithParameterDialog under tableSettings inside the List Report page configuration in manifest.json. Define up to (and recommended maximum) 8 fields; each field maps to an entity property via "path".
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "pages": {
      "ListReport|STTA_C_SO_SalesOrder_ND": {
        "entitySet": "STTA_C_SO_SalesOrder_ND",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "multiSelect": true,
            "isWorklist": true,
            "tableSettings": {
              "createWithParameterDialog": {
                "fields": {
                  "BusinessPartnerID": { "path": "BusinessPartnerID" },
                  "CurrencyCode": { "path": "CurrencyCode" },
                  "BillingStatus":   { "path": "BillingStatus" },
                  "DeliveryStatus":  { "path": "DeliveryStatus" },
                  "OpportunityID":   { "path": "OpportunityID" }
                }
              }
            }
          }
        },
        "pages": {}
      }
    }
  }
}
```

STEP: 2 — Enable create dialog (OData V2) in multi-view (quickVariantSelectionX)
DESCRIPTION: For list reports with multiple views (variants / tabs) provide tableSettings including createWithParameterDialog per variant. Place createWithParameterDialog inside the variant's tableSettings.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|STTA_C_SO_SalesOrder_ND": {
        "entitySet": "C_STTA_SalesOrder_WD_20",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "quickVariantSelectionX": {
              "showCounts": true,
              "variants": {
                "0": {
                  "key": "_tab1",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive"
                },
                "1": {
                  "key": "_tab2",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#Cheap",
                  "tableSettings": {
                    "createWithParameterDialog": {
                      "fields": {
                        "bp_id": { "path": "bp_id" },
                        "currency_code": { "path": "currency_code" },
                        "op_id": { "path": "op_id" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — Runtime behavior and constraints (OData V2)
DESCRIPTION: Implementers must be aware of runtime constraints and required properties when enabling createWithParameterDialog.
LANGUAGE: text
CODE:
```
- Manifest file: manifest.json (place snippets under sap.ui.generic.app -> pages -> <ListReport|...>)
- Max recommended fields shown in dialog: 8 data fields.
- You cannot navigate to an object page in "create" mode when creating via dialog. You can navigate to the object page in display mode to modify objects.
- Draft state is NOT maintained for objects created via this dialog.
- Ensure the properties you list are part of the entity and include all mandatory entity properties in the dialog.
- If the backend returns state messages on Create, each message must include a target pointing to a specific field; messages will be shown inline (field red box + text).
- Prefill: Filter values can be used to prefill dialog fields (use extension points—see "Prefilling Fields When Creating a New Entity Using an Extension Point").
- Only List Report pages support this create dialog.
```

STEP: 4 — Customize dialog title and buttons (OData V2)
DESCRIPTION: Change the dialog title and button labels using i18n. Default dialog title key is CREATE_DIALOG_TITLE. Button labels can be changed in Adaptation Editor or via i18n.
LANGUAGE: PROPERTIES
CODE:
```properties
# i18n.properties
CREATE_DIALOG_TITLE=New Object
CREATE_BUTTON=Create
CANCEL_BUTTON=Cancel

# To override, change values in your app's i18n.properties or via the Adaptation Editor:
# CREATE_DIALOG_TITLE=My Custom Title
# CREATE_BUTTON=Save
# CANCEL_BUTTON=Abort
```

STEP: 5 — Enable create dialog (OData V4) using creationMode (List Report)
DESCRIPTION: For Fiori Elements OData V4 (sap.fe.templates.ListReport), configure creationMode under tableSettings within controlConfiguration for the @com.sap.vocabularies.UI.v1.LineItem annotation. creationFields can reference a FieldGroup annotation or a comma-separated list of properties.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "ProductsList": {
          "type": "Component",
          "name": "sap.fe.templates.ListReport",
          "id": "ProductsList",
          "options": {
            "settings": {
              "entitySet": "Products",
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "creationMode": {
                      "name": "CreationDialog",
                      "creationFields": "com.sap.vocabularies.UI.v1.FieldGroup#CreationParameters"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 6 — V4 behavior, constraints, and tips
DESCRIPTION: Important notes when using creationMode in V4.
LANGUAGE: text
CODE:
```
- Place creationMode parameters per line item in TableSettings for each view in multi-view scenarios.
- creationFields may point to:
  - a FieldGroup annotation (recommended), e.g. "com.sap.vocabularies.UI.v1.FieldGroup#CreationParameters"
  - OR a comma-separated list of property names.
- Immutable properties are automatically added to the creationFields list.
- Navigation properties are NOT supported inside creation dialog.
- Mandatory parameters are marked with a red asterisk in the dialog.
- Draft state is NOT maintained for objects created via the dialog.
- Prefill: If filter values are entered, those values can be used to prefill creation dialog fields (see "Prefilling Fields When Creating a New Entity").
```

STEP: 7 — Customize dialog title (OData V4)
DESCRIPTION: Change the default dialog title for V4 using the i18n key C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE.
LANGUAGE: PROPERTIES
CODE:
```properties
# i18n.properties
C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE=New Object

# To customize:
# C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE=My Custom Create Title
```

STEP: 8 — References and extension points (implementation pointers)
DESCRIPTION: Use these internal doc references/extension points to implement prefilling and advanced customization.
LANGUAGE: text
CODE:
```
- Prefilling fields when creating a new entity using an extension point:
  - V2 doc reference: Prefilling Fields When Creating a New Entity Using an Extension Point
  - V4 doc reference: Prefilling Fields When Creating a New Entity
- Multi-view configuration references:
  - Defining Multiple Views on a List Report Table - Single Table Mode
  - Defining Multiple Views on a List Report Table - Multiple Table Mode
- Tree table custom create dialog:
  - Create Mode and Custom Create Mode with a Menu Button (Tree Tables)
```
--------------------------------

**TITLE**: Enabling Quick Views for Link Navigation (OData V2 & V4)

**INTRODUCTION**: This guide shows the exact annotation and metadata steps to enable Quick Views for link (smart link) navigation in SAP Fiori Elements. Use these examples to identify the semantic object on the source property, locate the association/navigation metadata, and annotate the association end (target entity) with UI.QuickViewFacets and UI.FieldGroup so that the popover shows a title area and field-group content.

**TAGS**: fiori-elements-framework, ui.quickviewfacets, quick-view, smart-link, odata-v2, odata-v4, annotations, abap-cds, cap-cds, xml, metadata

STEP: V2 — 1. Identify the semantic object on the source property

DESCRIPTION: Find the property that is annotated with Common.SemanticObject in your service. This field will be rendered as a link. Example XML and ABAP CDS annotations for the source entity property (Supplier).

LANGUAGE: XML

CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType/Supplier">
   <Annotation Term="Common.SemanticObject" String="EPMProduct"/>
</Annotations>
```

LANGUAGE: ABAP CDS

CODE:
```abap
annotate view STTA_C_MP_PRODUCT with {
  @Consumption.semanticObject: 'EPMProduct'
  supplier;
}
```

STEP: V2 — 2. Locate the association and referential constraint in the service metadata

DESCRIPTION: In the service metadata (WSDL/$metadata), identify the Association or NavigationProperty that references the target entity and contains ReferencialConstraint(s) involving the identified source property as Dependent or Principal. Example association excerpt showing Supplier as Dependent.

LANGUAGE: XML

CODE:
```xml
<Association Name="assoc_2CCAF987BA334B3BD1DF2404F50BC9C5" sap:content-version="1">
    <End Type="STTA_PROD_MAN.STTA_C_MP_ProductType" Multiplicity="1" Role="FromRole_assoc_2CCAF987BA334B3BD1DF2404F50BC9C5"/>
    <End Type="STTA_PROD_MAN.STTA_C_MP_SupplierType" Multiplicity="0..1" Role="ToRole_assoc_2CCAF987BA334B3BD1DF2404F50BC9C5"/>
    <ReferentialConstraint>
        <Principal Role="ToRole_assoc_2CCAF987BA334B3BD1DF2404F50BC9C5">
            <PropertyRef Name="Supplier"/>
        </Principal>
        <Dependent Role="FromRole_assoc_2CCAF987BA334B3BD1DF2404F50BC9C5">
            <PropertyRef Name="Supplier"/>
        </Dependent>
    </ReferentialConstraint>
</Association>
```

STEP: V2 — 3. Annotate UI.QuickViewFacets and UI.FieldGroup on the association end (target entity)

DESCRIPTION: Add UI.QuickViewFacets on the target EntityType (association end type) and provide a UI.FieldGroup qualifier referenced by the QuickViewFacets. Below are XML and ABAP CDS examples that create a reference facet and a field group with three fields (CompanyName, Supplier, EmailAddress).

LANGUAGE: XML

CODE:
```xml
<!-- QuickViewFacets annotation for Supplier -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType">
    <Annotation Term="UI.QuickViewFacets">
        <Collection>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SupplierQuickViewPOC_FieldGroup_1" />
            </Record>
        </Collection>
    </Annotation>
    <Annotation Term="UI.FieldGroup" Qualifier="SupplierQuickViewPOC_FieldGroup_1">
        <Record>
            <PropertyValue Property="Data">
                <Collection>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Company Name" />
                        <PropertyValue Property="Value" Path="CompanyName"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Supplier" />
                        <PropertyValue Property="Value" Path="Supplier"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Email Address" />
                        <PropertyValue Property="Value" Path="EmailAddress"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS

CODE:
```abap
annotate view STTA_C_MP_SUPPLIER with {
  @UI.Facet: [
    {
      targetQualifier: 'SupplierQuickViewPOC_FieldGroup_1',
      type: #FIELDGROUP_REFERENCE,
      purpose: #QUICK_VIEW
    }
  ]
  @UI.fieldGroup: [
    {
      label: 'Company Name',
      value: 'COMPANYNAME',
      type: #STANDARD,
      position: 1,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_1'
    }
  ]
  companyname;

  @UI.fieldGroup: [
    {
      label: 'Supplier',
      value: 'SUPPLIER',
      type: #STANDARD,
      position: 2,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_1'
    }
  ]
  supplier;

  @UI.fieldGroup: [
    {
      label: 'Email Address',
      value: 'EMAILADDRESS',
      type: #STANDARD,
      position: 3,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_1'
    }
  ]
  emailaddress;
}
```

STEP: V2 — 4. Verify and constraints

DESCRIPTION: After deploying annotations, the smart link popover for the annotated property displays the quick view content. Note: QuickViewFacets can only be annotated for EntityTypes that belong to the same OData service (referenced with referential constraints in the metadata).

LANGUAGE: JSON

CODE:
```json
{
  "note": "QuickViewFacets only supported for EntityTypes in the same service (referential constraints refer to these)."
}
```

STEP: V4 — Overview: supported quick-view cases

DESCRIPTION: For OData V4, Quick Views are supported when:
- The source property has a ReferentialConstraint on a target entity (navigation property).
- OR the source property points to a target property that is defined as a semantic key or entity key (association keyed by semantic/entity key).

Proceed with the relevant scenario below.

STEP: V4 — A. Identify the semantic object on the source property (multiple forms)

DESCRIPTION: The semantic object can be provided as a literal string, as a path, or as an EdmJson expression. Examples for XML, ABAP CDS, and CAP CDS follow.

LANGUAGE: XML

CODE:
```xml
<!-- Literal string -->
<Annotations Target="com.c_salesordermanage_sd.ProductSupplier/Supplier">
   <Annotation Term="Common.SemanticObject" String="EPMProduct"/>
</Annotations>

<!-- Path-based semantic object -->
<Annotations Target="com.c_salesordermanage_sd.ProductSupplier/Supplier">
   <Annotation Term="Common.SemanticObject" Path="supplierSemanticObject"/>
</Annotations>

<!-- EdmJson expression (If/Then/Else) -->
<Annotations Target="com.c_salesordermanage_sd.ProductSupplier/Supplier">
   <Annotation Term="Common.SemanticObject">
       <If>
          <Eq>
              <Path>SupplierType</Path>
              <Int>2</Int>
          </Eq>
          <String>EPMProduct</String>
          <String>NoTarget</String>
       </If>
    </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS

CODE:
```abap
annotate view ProductSupplier with {
  @Consumption.semanticObject: 'EPMProduct'
  supplier;
}
```

LANGUAGE: CAP CDS

CODE:
```cds
annotate ProductSupplier with {
  Supplier @Common.SemanticObject: 'EPMProduct';
}
```

STEP: V4 — B. (ReferentialConstraint) Locate the navigationProperty referentialConstraint in metadata

DESCRIPTION: In the entity's navigationProperties (metadata or CDS), ensure the ReferentialConstraint references the source property. Example XML and CDS snippets.

LANGUAGE: XML

CODE:
```xml
<NavigationProperty Name="_ShipToPartyVH" Type="com.c_salesordermanage_sd.Customer">
      <ReferentialConstraint Property="Supplier" ReferencedProperty="CustomerID" />
</NavigationProperty>
```

LANGUAGE: CDS

CODE:
```cds
_ShipToPartyVH  : Association to Customer
                    on _ShipToPartyVH.CustomerID = Supplier;
```

STEP: V4 — C. (ReferentialConstraint) Annotate UI.QuickViewFacets and UI.FieldGroup on the target entity

DESCRIPTION: Add UI.QuickViewFacets on the target entity referenced by the navigationProperty (e.g., Customer). Use a ReferenceFacet to point to a FieldGroup qualifier. Examples in XML, ABAP CDS, and CAP CDS.

LANGUAGE: XML

CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd.Customer">
  <Annotation Term="UI.QuickViewFacets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Address"/>
        <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SoldToQuickView"/>
      </Record>
    </Collection>
  </Annotation>

  <Annotation Term="UI.FieldGroup" Qualifier="SoldToQuickView">
    <Record Type="UI.FieldGroupType">
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="PostalCode"/>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="CityName"/>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="Country"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS

CODE:
```abap
annotate view CUSTOMER with {
  @UI.Facet: [
    {
      label: 'Address',
      targetQualifier: 'SoldToQuickView',
      type: #FIELDGROUP_REFERENCE,
      purpose: #QUICK_VIEW
    }
  ]
  @UI.fieldGroup: [
    { value: 'POSTALCODE', type: #STANDARD, position: 1, qualifier: 'SoldToQuickView' }
  ]
  postalcode;

  @UI.fieldGroup: [
    { value: 'CITYNAME', type: #STANDARD, position: 2, qualifier: 'SoldToQuickView' }
  ]
  cityname;

  @UI.fieldGroup: [
    { value: 'COUNTRY', type: #STANDARD, position: 3, qualifier: 'SoldToQuickView' }
  ]
  country;
}
```

LANGUAGE: CAP CDS

CODE:
```cds
annotate schema.Customer with @(UI : {
  QuickViewFacets : [
    {
      $Type  : 'UI.ReferenceFacet',
      Label  : 'Address',
      Target : '@UI.FieldGroup#SoldToQuickView'
    }
  ],
  FieldGroup #SoldToQuickView : { Data : [
    { $Type : 'UI.DataField', Value : PostalCode },
    { $Type : 'UI.DataField', Value : CityName },
    { $Type : 'UI.DataField', Value : Country }
  ]}
})
```

STEP: V4 — D. (SemanticKey / Entity Key) Define association on source entity and annotate target

DESCRIPTION: When the target property is a semantic key or entity key, define an association from source to target and add Common.SemanticKey / Common.SemanticObject on the target. Then annotate UI.QuickViewFacets on the target entity as above. Example CAP CDS association and semantic key definition.

LANGUAGE: CAP CDS

CODE:
```cds
entity ProductSupplier {
  CustomerReference: String;
  _NavigationProperty: Association to Customer
       on _NavigationProperty.Customer = CustomerReference @(Common : {
            SemanticObject : 'Customer'
       });
}

annotate Customer with @(
  Common.SemanticKey : [CustomerName]
) {
  key Customer: String;
  CustomerName: String;
}
```

LANGUAGE: XML

CODE:
```xml
<!-- Use the same UI.QuickViewFacets + UI.FieldGroup example (see V4-C) on the target entity "Customer". -->
```

STEP: V4 — E. Verify and behavior notes

DESCRIPTION: After deploying annotations:
- The quick view is generated for the smart link popover and shows the title area + field groups defined.
- If the user lacks navigation rights to the target application, the link may not be displayed.
- For V2: QuickViewFacets only allowed for EntityTypes in the same service (referential constraints must reference those entities).

LANGUAGE: JSON

CODE:
```json
{
  "verify": [
    "Open the app and hover/click the annotated link property to open the popover",
    "Confirm title area and field group content appear per UI.FieldGroup",
    "If no link appears, check navigation rights and referential constraints"
  ],
  "notes": {
    "v2_same_service": "QuickViewFacets can only be annotated for EntityTypes in the same OData service.",
    "no_navigation": "If the user can't navigate to the target application, no link is displayed."
  },
  "references": [
    "Configuring the Content of Quick Views: configuring-the-content-of-quick-views-c245ad7.md",
    "Flexible programming model explorer Quick View: https://sapui5.hana.ondemand.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/fieldQuickView"
  ]
}
```
--------------------------------

**TITLE**: Enabling and Configuring Semantic Date Operators for Filter Bars (Fiori Elements V2 & V4)

**INTRODUCTION**: Quick, code-focused reference to enable semantic date (Today, Last Week, etc.) controls and operators in Fiori Elements filter bars for OData V2 and V4. Includes required metadata/annotations, manifest.json settings, per-field overrides, include/exclude rules, default values (including parameterized operators), and enabling additional operators.

**TAGS**: fiori-elements-framework, sapui5, manifest.json, annotations, ODataV2, ODataV4, filter-bar, semantic-date, date-range

STEP: 1 — Ensure property supports interval filtering (metadata / CDS)
DESCRIPTION: Add filter-restriction or CDS consumption annotation so the field can be rendered as a date range/semantic date control.
LANGUAGE: XML
CODE:
```xml
<!-- OData V2 metadata: add sap:filter-restriction="interval" to the Property -->
<Property Name="DeliveryDate" Type="Edm.DateTime" sap:label="Delivery Date" Precision="0" sap:display-format="Date" sap:filter-restriction="interval" />
```

STEP: 2 — CDS snippet for OData V2 (Consumption annotation)
DESCRIPTION: For CDS-based services (V2), set the selectionType to INTERVAL so UI can use semantic date controls.
LANGUAGE: CDS
CODE:
```cds
@Consumption.filter.selectionType: #INTERVAL
entity YourEntity {
    DeliveryDate: DateTime; // example
}
```

STEP: 3 — Enable global semantic date control in manifest (OData V2)
DESCRIPTION: Turn on useDateRange to replace date pickers with semantic date controls for all date fields by default.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|SEPMRA_C_PD_Product": {
        "component": {
          "settings": {
            "filterSettings": {
              "dateSettings": {
                "useDateRange": true
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — Customize default date-range types globally and per-field (OData V2)
DESCRIPTION: Define global selectedValues (applies to all date fields) and override per-field using fields.{Property}. Use exclude=true to remove listed values from the default list; exclude=false to show only listed values. Use customDateRangeImplementation to supply a JS class that defines/changes the value list.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|SEPMRA_C_PD_Product": {
        "component": {
          "settings": {
            "filterSettings": {
              "dateSettings": {
                "useDateRange": true,
                "selectedValues": "DAYS,WEEK,MONTH,DATERANGE",
                "fields": {
                  "DateProperty1": {
                    "selectedValues": "TOMORROW,NEXT,LASTYEAR,LAST2WEEKS,LAST3WEEKS,LAST4WEEKS,LAST5WEEKS,YEARTODATE,QUARTER1,QUARTER2,QUARTER3,QUARTER4",
                    "exclude": true
                  },
                  "DateProperty2": {
                    "customDateRangeImplementation": "SOMULTIENTITY.ext.controller.customDateRangeType",
                    "selectedValues": "FROM,TO,DAYS,WEEK,MONTH,DATERANGE,TODAY,TOMORROW,YEAR,YESTERDAY",
                    "exclude": true
                  },
                  "DateProperty3": {
                    "selectedValues": "YESTERDAY",
                    "exclude": false
                  },
                  "DateTimeProperty1": {
                    "selectedValues": "MONTH",
                    "exclude": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Use filter rules to include/exclude specific date-range keys (OData V2)
DESCRIPTION: Use the filter array to specify fine-grained include/exclude rules by path (key or category). This is passed to the SmartFilterBar and supports contains/equals/exclude semantics.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|SEPMRA_C_PD_Product": {
        "component": {
          "settings": {
            "filterSettings": {
              "dateSettings": {
                "useDateRange": true,
                "fields": {
                  "PostingDate": {
                    "filter": [
                      { "path": "key", "equals": "TODAY", "exclude": true }
                    ]
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 6 — Exclude by DateRangeType category (OData V2)
DESCRIPTION: Remove whole categories (FIXED, DYNAMIC, etc.) by filtering on the category property with contains and exclude:true.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|SEPMRA_C_PD_Product": {
        "component": {
          "settings": {
            "filterSettings": {
              "dateSettings": {
                "useDateRange": true,
                "fields": {
                  "PostingDate": {
                    "filter": [
                      { "path": "category", "contains": "FIXED", "exclude": true }
                    ]
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 7 — Set default semantic date value in V2 manifest (per-field)
DESCRIPTION: Define a default selected semantic operator for a field under filterSettings.dateSettings.fields.{Property}.defaultValue.operation. Note: defaultValue is ignored when semantic date comes from navigation context, app state, or URL. Do not provide numerical FROM/TO values as defaultValue.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|SEPMRA_C_PD_Product": {
        "component": {
          "settings": {
            "filterSettings": {
              "dateSettings": {
                "fields": {
                  "CreatedDate": {
                    "defaultValue": {
                      "operation": "TOMORROW"
                    }
                  },
                  "DeliveryDate": {
                    "defaultValue": {
                      "operation": "TOMORROW"
                    },
                    "filter": [
                      {
                        "path": "key",
                        "equals": "TODAY",
                        "exclude": true
                      }
                    ]
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 8 — Enable semantic date operators by FilterRestrictions (OData V4 XML annotation)
DESCRIPTION: For OData V4, set Capabilities.FilterRestrictions -> FilterExpressionRestrictions -> AllowedExpressions = "SingleRange" (or SingleValue where applicable) for the property in XML annotations.
LANGUAGE: XML
CODE:
```xml
<edmx:Reference Uri="https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Capabilities.V1.xml">
  <edmx:Include Namespace="Org.OData.Capabilities.V1" Alias="Capabilities"/>
</edmx:Reference>

<Annotations Target="com.c_salesordermanage_sd.EntityContainer/SalesOrderManage">
  <Annotation Term="Capabilities.FilterRestrictions">
    <Record Type="Capabilities.FilterRestrictionsType">
      <PropertyValue Property="FilterExpressionRestrictions">
        <Collection>
          <Record Type="Capabilities.FilterExpressionRestrictionType">
            <PropertyValue Property="Property" PropertyPath="myDate"/>
            <PropertyValue Property="AllowedExpressions" String="SingleRange"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 9 — CAP CDS annotation for OData V4 FilterRestrictions
DESCRIPTION: CAP-based CDS example to mark a Date property as SingleRange-supported.
LANGUAGE: CDS
CODE:
```cds
@Capabilities : {
  FilterRestrictions : {
    FilterExpressionRestrictions : [
      {
        Property : 'myDate',
        AllowedExpressions : 'SingleRange'
      }
    ]
  }
}
entity MyEntity {
  myDate: Date;
}
```

STEP: 10 — Set default semantic operator in manifest (OData V4)
DESCRIPTION: For V4-based Fiori Elements, set defaultValues operator under controlConfiguration -> @com.sap.vocabularies.UI.v1.SelectionFields -> filterFields.{Property}.settings.defaultValues.
LANGUAGE: JSON
CODE:
```json
{
  "settings": {
    "contextPath": "/SalesOrderManage",
    "controlConfiguration": {
      "@com.sap.vocabularies.UI.v1.SelectionFields": {
        "filterFields": {
          "SalesOrderDate": {
            "settings": {
              "defaultValues": [{ "operator": "YESTERDAY" }]
            }
          }
        }
      }
    }
  }
}
```

STEP: 11 — Supported semantic operators (V4): single-date, date-range, and additional
DESCRIPTION: Lists of supported operators. Use these values in operatorConfiguration or as defaultValues.operator.
LANGUAGE: JSON
CODE:
```json
{
  "singleDateOperators": [
    "YESTERDAY","TOMORROW","TODAY",
    "FIRSTDAYWEEK","LASTDAYWEEK","FIRSTDAYMONTH","LASTDAYMONTH",
    "FIRSTDAYQUARTER","LASTDAYQUARTER","FIRSTDAYYEAR","LASTDAYYEAR"
  ],
  "dateRangeOperators": [
    "THISWEEK","LASTWEEK","NEXTWEEK","THISMONTH","LASTMONTH","NEXTMONTH",
    "THISQUARTER","LASTQUARTER","NEXTQUARTER","QUARTER1","QUARTER2","QUARTER3","QUARTER4",
    "THISYEAR","LASTYEAR","NEXTYEAR","YEARTODATE","DATETOYEAR"
  ],
  "additionalSingleRangeOperators": [
    "FROMTODAY","FROMTOMORROW","FROMYESTERDAY","FROMFIRSTDAYWEEK","FROMLASTDAYWEEK",
    "FROMFIRSTDAYMONTH","FROMLASTDAYMONTH","FROMFIRSTDAYQUARTER","FROMLASTDAYQUARTER",
    "FROMFIRSTDAYYEAR","FROMLASTDAYYEAR",
    "TOTODAY","TOTOMORROW","TOYESTERDAY","TOFIRSTDAYWEEK","TOLASTDAYWEEK",
    "TOFIRSTDAYMONTH","TOLASTDAYMONTH","TOFIRSTDAYQUARTER","TOLASTDAYQUARTER",
    "TOFIRSTDAYYEAR","TOLASTDAYYEAR"
  ]
}
```

STEP: 12 — Parameterized default values (OData V4 manifest sample)
DESCRIPTION: Single manifest snippet showing defaultValues examples for operators that require parameter values. Date strings must be YYYY-MM-DD; SPECIFICMONTH values are zero-based (January=0).
LANGUAGE: JSON
CODE:
```json
{
  "@com.sap.vocabularies.UI.v1.SelectionFields": {
    "filterFields": {
      "SalesOrderDate": {
        "settings": {
          "defaultValues": [
            { "operator": "DATE", "values": ["2018-12-28"] },
            { "operator": "FROM", "values": ["2018-11-28"] },
            { "operator": "TO", "values": ["2019-11-02"] },
            { "operator": "DATERANGE", "values": ["2019-11-02", "2022-01-01"] },
            { "operator": "TODAYFROMTO", "values": [5, 6] },
            { "operator": "LASTDAYS", "values": [6] },
            { "operator": "NEXTDAYS", "values": [6] },
            { "operator": "SPECIFICMONTH", "values": [1] }
          ]
        }
      }
    }
  }
}
```

STEP: 13 — operatorConfiguration to include/exclude specific operators (OData V4)
DESCRIPTION: Use operatorConfiguration to include or exclude individual operators. customDateRangeImplementation (if present) takes precedence over operatorConfiguration settings. For navigation-entity properties, use "<navigationProperty>::<propertyName>".
LANGUAGE: JSON
CODE:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.SelectionFields": {
      "filterFields": {
        "SalesOrderDate": {
          "settings": {
            "operatorConfiguration": [
              { "path": "key", "equals": "TODAY", "exclude": true },
              { "path": "key", "equals": "TODAY", "exclude": false },
              { "path": "key", "equals": "TODAYFROMTO", "exclude": true }
            ]
          }
        },
        "_Items::DispatchDate": {  /* example navigation property format */
          "settings": {
            "operatorConfiguration": [
              { "path": "key", "equals": "TODAY", "exclude": true }
            ]
          }
        }
      }
    }
  }
}
```

STEP: 14 — Enable additional date-range operators (V4) that combine FROM/TO with single-date operators
DESCRIPTION: Additional operators (e.g., FROMTODAY, TOYESTERDAY) are disabled by default. To enable, add operatorConfiguration entries with exclude:false for each operator under the field's settings in the manifest. Note: these operators are not available with the Filter Bar building block and not available as filters inside object page tables/charts.
LANGUAGE: JSON
CODE:
```json
{
  "targets": {
    "SalesOrderManageList": {
      "options": {
        "settings": {
          "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.SelectionFields": {
              "filterFields": {
                "SalesOrderDate": {
                  "settings": {
                    "operatorConfiguration": [
                      { "path": "key", "equals": "FROMTODAY", "exclude": false },
                      { "path": "key", "equals": "TOYESTERDAY", "exclude": false }
                    ]
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 15 — Notes and references (links and usage constraints)
DESCRIPTION: Quick constraints and links:
- V2: sap:filter-restriction="interval" (metadata) or @Consumption.filter.selectionType: #INTERVAL (CDS) is mandatory for semantic date controls.
- V4: FilterRestrictions AllowedExpressions = "SingleRange" (or SingleValue per field) enables semantic operators.
- Default values from SelectionVariant are ignored; manifest-based default values are used.
- Do not set numeric FROM/TO as defaultValue unless operator expects numeric parameters (see examples).
- Navigation-entity semantic filter field format: "<navigationProperty>::<filterField>".
- Additional operator availability restrictions: not available for Filter Bar building block or as object page table/chart filters.
- For adapting the filter bar and bookmark behavior, see:
  - Adapting the Filter Bar: adapting-the-filter-bar-609c39a.md
  - Bookmark/tiles: extending-the-bookmark-function-to-save-static-tiles-to-the-sap-fiori-launchpad-7e34ea9.md
LANGUAGE: JSON
CODE:
```json
{
  "references": [
    "adapting-the-filter-bar-609c39a.md",
    "extending-the-bookmark-function-to-save-static-tiles-to-the-sap-fiori-launchpad-7e34ea9.md",
    "SAPUI5 Sample: SmartFilterBar UseDateRangeType (UI5 SDK)"
  ],
  "constraints": [
    "V2: metadata sap:filter-restriction=\"interval\" required",
    "V4: AllowedExpressions = 'SingleRange' needed for semantic ranges",
    "Default manifest values override SelectionVariant defaults",
    "Navigation-field format: \"<navProp>::<propertyName>\""
  ]
}
```
--------------------------------

**TITLE**: Enable simpleHeaderFacets in manifest.json for Fiori elements (OData V2)

**INTRODUCTION**: Enable the simple header facet to display additional header content in an Object Page of SAP Fiori elements (OData V2). This guide shows the exact manifest.json location and a ready-to-use JSON snippet to add the simpleHeaderFacets flag.

**TAGS**: fiori-elements-framework, manifest.json, simpleHeaderFacets, OData V2, ObjectPage, sap.ui.generic.app

STEP: Add simpleHeaderFacets to manifest.json

DESCRIPTION: Edit webapp/manifest.json and add the simpleHeaderFacets: true flag under the target ObjectPage component's settings. This example shows the typical sap.ui.generic.app structure where a ListReport navigates to an ObjectPage; the flag must be added to the ObjectPage component.settings section. Also ensure editableHeaderContent is set to true if you want editable header content.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.2.0",
    "pages": [
      {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "gridTable": false,
            "multiSelect": true,
            "smartVariantManagement": true
          }
        },
        "pages": [
          {
            "entitySet": "STTA_C_MP_Product",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "showRelatedApps": true,
                "gridTable": false,
                "editableHeaderContent": true,
                "simpleHeaderFacets": true
              }
            },
            "pages": [
              {
                "navigationProperty": "to_ProductText",
                "entitySet": "STTA_C_MP_ProductText",
                "component": {
                  "name": "sap.suite.ui.generic.template.ObjectPage"
                }
              }
            ]
          }
        ]
      }
    ]
  }
}
```

STEP: Applicability, limitations, and validation

DESCRIPTION: Before and after enabling the flag, verify the following:
- Applicability: This setting is supported only for SAP Fiori elements for OData V2 applications.
- Limitations: The simple header facet does NOT support complex DataFieldForAnnotation types (for example: ratings, progress indicators, charts) or other complex datapoints.
- File & path to change: webapp/manifest.json -> sap.ui.generic.app.pages[].component.settings.simpleHeaderFacets
- Validation: Run the app (or preview in SAP Web IDE / Business Application Studio) and inspect the Object Page header to confirm the additional header content is displayed as expected.

LANGUAGE: JSON

CODE:
```json
{
  "applicableTo": "SAP Fiori elements for OData V2 only",
  "manifestFile": "webapp/manifest.json",
  "propertyPath": "sap.ui.generic.app.pages[].component.settings.simpleHeaderFacets",
  "limitations": [
    "Does not support complex DataFieldForAnnotation (ratings, progress indicators, charts)",
    "Not applicable for OData V4 or non-Fiori-elements Object Page setups"
  ],
  "validationSteps": [
    "Build and run the Fiori app",
    "Open the ListReport and navigate to the Object Page",
    "Confirm additional header content is shown in header facets",
    "If header content missing, confirm editableHeaderContent is true and the correct ObjectPage component.def is targeted"
  ]
}
```
--------------------------------

**TITLE**: Enabling Standard List Items and Object List Items (Fiori elements, OData V2)

**INTRODUCTION**: Concise, developer-focused guide to enable and configure StandardList and ObjectList items in Fiori elements List Reports (OData V2). Includes required UI.LineItem annotation patterns, DataPoint usage, manifest.json settings, and property-to-UI mappings for code generation and automated annotation tooling.

**TAGS**: fiori-elements, odata-v2, UI.LineItem, DataField, DataFieldForAnnotation, DataPoint, manifest.json, StandardList, ObjectList

STEP: 1 — Core rules and notes (OData V2)
DESCRIPTION: Summarize constraints and behavior that apply to both Standard and Object list items. Use these rules when generating annotations or validating metadata.
LANGUAGE: JSON
CODE:
```json
{
  "ODataVersion": "V2",
  "UI.LineItem": {
    "allowedChildren": ["UI.DataField", "UI.DataFieldForAnnotation"],
    "unsupportedChildren": "Other DataFieldAbstract types are not supported"
  },
  "DataFieldForAnnotation": "Used with DataPoint target for fields on the right side of the list item",
  "Fallback": "If no DataPoint exists, DataField is used for right-side fields",
  "Sorting": "Fields are ordered by UI.Importance; DataPoint presence overrides importance",
  "DefaultImportance": "UI.ImportanceType/Medium if not specified",
  "Criticality": "UI.Criticality supported for semantic coloring of DataPoints",
  "Images": "UI.IsImageURL marks the image field (order irrelevant)",
  "InternalNavigation": "onListNavigationExtension is enabled for internal navigation (see example enable-internal-navigation-to-different-detail-page)"
}
```

STEP: 2 — Standard List Item: UI.LineItem annotation (example)
DESCRIPTION: Provide a complete sample UI.LineItem with a DataPoint qualifier "Price". Use UI.Importance where appropriate. DataFieldForAnnotation references the DataPoint via AnnotationPath="@UI.DataPoint#Price".
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.LineItem">
  <Collection>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="ProductForEdit" />
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="ProductCategory" />
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Medium" />
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="ProductPictureURL" />
    </Record>
    <Record Type="UI.DataFieldForAnnotation">
      <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Price" /> 
    </Record>
  </Collection>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="Price">
  <Record>
    <PropertyValue Property="Value" Path="Price" />
    <PropertyValue Property="Criticality" Path="PriceCriticality" />
  </Record>
</Annotation>
```

STEP: 3 — Standard List Item: manifest.json fragment
DESCRIPTION: Update the app manifest to use StandardList type for the List Report page. Ensure "isWorklist" and "smartVariantManagement" are set as required.
LANGUAGE: JSON
CODE:
```json
{
  "pages": {
    "ListReport|STTA_C_MP_Product": {
      "entitySet": "STTA_C_MP_Product",
      "component": {
        "settings": {
          "isWorklist": true,
          "tableSettings": {
            "type": "StandardList"
          },
          "smartVariantManagement": false
        }
      }
    }
  }
}
```

STEP: 4 — Standard List Item: property-to-annotation mapping (machine-friendly)
DESCRIPTION: Machine-readable mapping of list item UI properties to UI.LineItem annotations and behavior. Consume this to generate annotations or to validate placement.
LANGUAGE: JSON
CODE:
```json
[
  {
    "uiProperty": "title",
    "entityAnnotation": "First data field of UI.LineItem",
    "location": "Top left",
    "comments": ""
  },
  {
    "uiProperty": "description",
    "entityAnnotation": "Second data field of UI.LineItem",
    "location": "Bottom left",
    "comments": ""
  },
  {
    "uiProperty": "info",
    "entityAnnotation": "First data point (UI.DataPoint) or first available DataField if no DataPoint",
    "location": "Top right",
    "comments": "If no DataPoint exists, the third data field is used"
  },
  {
    "uiProperty": "infoState",
    "entityAnnotation": "Criticality (DataPoint/CriticalityCalculation) or first DataPoint",
    "location": "Color (semantic state)",
    "comments": "Default state None if no DataPoint exists"
  },
  {
    "uiProperty": "icon",
    "entityAnnotation": "First DataField marked with UI.IsImageURL",
    "location": "image area (order not important)",
    "comments": "Can be placed anywhere under UI.LineItem; used as icon"
  }
]
```

STEP: 5 — Object List Item: UI.LineItem annotation (example)
DESCRIPTION: Provide a complete sample UI.LineItem for an ObjectList with three DataPoints (NetAmount, GrossAmount, TaxAmount) and importance annotations. Use DataFieldForAnnotation to point to DataPoints using AnnotationPath.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.LineItem">
  <Collection>
    <Record Type="UI.DataField">
      <PropertyValue Property="Label" String="Sales Order ID" />
      <PropertyValue Property="Value" Path="SalesOrderID"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="BusinessPartnerID"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Medium"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="CurrencyCode"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Low"/>
    </Record>
    <Record Type="UI.DataFieldForAnnotation">
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
      <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#NetAmount" /> 
    </Record>
    <Record Type="UI.DataFieldForAnnotation">
      <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#GrossAmount" /> 
    </Record>
    <Record Type="UI.DataFieldForAnnotation">
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Low"/>
      <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#TaxAmount" /> 
    </Record>
  </Collection>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="NetAmount">
  <Record>
    <PropertyValue Property="Value" Path="NetAmount" />
    <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Positive" />
  </Record>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="GrossAmount">
  <Record>
    <PropertyValue Property="Value" Path="GrossAmount" />
    <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Negative" />
  </Record>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="TaxAmount">
  <Record>
    <PropertyValue Property="Value" Path="TaxAmount" />
    <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Critical" />
  </Record>
</Annotation>
```

STEP: 6 — Object List Item: manifest.json fragment
DESCRIPTION: Update the app manifest to use ObjectList type for the List Report page. Keep isWorklist and smartVariantManagement settings aligned with examples.
LANGUAGE: JSON
CODE:
```json
{
  "pages": {
    "ListReport|STTA_C_MP_Product": {
      "entitySet": "STTA_C_MP_Product",
      "component": {
        "settings": {
          "isWorklist": true,
          "tableSettings": {
            "type": "ObjectList"
          },
          "smartVariantManagement": false
        }
      }
    }
  }
}
```

STEP: 7 — Object List Item: property-to-annotation mapping (machine-friendly)
DESCRIPTION: Machine-readable mapping of Object list UI properties to UI.LineItem annotations and rules. Use this mapping when generating object-list annotations or UI composition.
LANGUAGE: JSON
CODE:
```json
[
  {
    "uiProperty": "title",
    "entityAnnotation": "First data field of UI.LineItem",
    "location": "Top left",
    "comments": ""
  },
  {
    "uiProperty": "firstObjectAttribute",
    "entityAnnotation": "Second data field of UI.LineItem",
    "location": "Middle left",
    "comments": "Maps to first ObjectAttribute under attributes aggregation in the rendered UI"
  },
  {
    "uiProperty": "number",
    "entityAnnotation": "First data point (UI.DataPoint) or first available DataField if no DataPoint",
    "location": "Top right",
    "comments": "If no DataPoint exists then the next DataField (3rd) is used"
  },
  {
    "uiProperty": "numberState",
    "entityAnnotation": "Criticality (DataPoint/CriticalityCalculation) or first DataPoint",
    "location": "Color (semantic state)",
    "comments": "Default state None if no DataPoint exists"
  },
  {
    "uiProperty": "firstStatus",
    "entityAnnotation": "Second data point",
    "location": "Middle right",
    "comments": "If no second data point: fallback to next DataField (3rd or 4th depending on provided data points)"
  },
  {
    "uiProperty": "secondObjectAttribute",
    "entityAnnotation": "Third data field",
    "location": "Bottom left",
    "comments": "If third data field already in use, use next available data field (4th/5th as applicable)"
  },
  {
    "uiProperty": "secondStatus",
    "entityAnnotation": "Third data point",
    "location": "Bottom right",
    "comments": "If no data points exist, fallback to available DataField(s) as specified in rules"
  }
]
```
--------------------------------

**TITLE**: Enabling Stream Support for SAP Fiori Elements (OData V2 & OData V4)

**INTRODUCTION**: Practical, code-focused guide to enable file stream support (upload, download, delete) in SAP Fiori elements apps. Covers required service model properties and annotation patterns for OData V2 and OData V4, UI field annotations, media-type/file-name binding, upload restrictions (MaxLength, Core.AcceptableMediaTypes), and how to pass files as action parameters. Includes XML, CAP CDS and ABAP CDS examples.

**TAGS**: fiori-elements, odata-v2, odata-v4, stream, file-upload, annotations, CDS, CAP, ABAP, Core.AcceptableMediaTypes, Core.MediaType

**STEP**: 1 — Security prerequisites (required before enabling streams)

**DESCRIPTION**: Ensure backend security measures and validation are in place before enabling stream upload/download. These are mandatory to avoid malicious content processing.

**LANGUAGE**: text

**CODE**:
```text
- Define @Core.AcceptableMediaTypes to whitelist allowed MIME types.
- Ensure backend performs virus scanning, MIME-type checks, and enforces a maximum file size.
- Implement file validation and data sanitization on the backend.
- See Security Configuration for more details.
```

**STEP**: 2 — OData V2: Make an entity stream-enabled (service model)

**DESCRIPTION**: For OData V2, entity types that store files must have the HasStream attribute (m:HasStream="true"). Provide a mandatory MediaType annotation on the entity and expose a UI DataField with Value path "$value" in UI.FieldGroup or UI.Identification to render the file control on object pages.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- EntityType with HasStream=true -->
<EntityType Name="MyStreamType" m:HasStream="true" sap:label="Stream Test" sap:content-version="1">
  <Key>
    <PropertyRef Name="Streamuuid" />
    <PropertyRef Name="IsActiveEntity" />
  </Key>
  <Property Name="Edit_ac" Type="Edm.Boolean" sap:label="Dyn. Action Control" sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false" />
</EntityType>

<!-- UI DataField on object page (UI.FieldGroup or UI.Identification) to enable stream control -->
<Record Type="UI.DataField">
  <PropertyValue Property="Value" Path="$value"/>
</Record>

<!-- Mandatory entity-level media type annotation -->
<Annotation Term="Org.OData.Core.V1.MediaType" Path="ThisMimeType"></Annotation>

<!-- Optional: render stream as image -->
<Annotation Term="UI.IsImage"/>
```

**STEP**: 3 — OData V2: File name and acceptable media types (entity-level annotations)

**DESCRIPTION**: Bind file name to a property via SAP__core.ContentDisposition/Filename to show filename in UI; use Core.AcceptableMediaTypes to restrict uploadable MIME types.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Bind file name -->
<Annotation Term="SAP__core.ContentDisposition">
  <Record>
    <PropertyValue Property="Filename" Path="ThisFileName" />
  </Record>
</Annotation>

<!-- Restrict acceptable media types -->
<Annotation Term="Core.AcceptableMediaTypes">
  <Collection>
    <String>text/plain</String>
  </Collection>
</Annotation>
```

**STEP**: 4 — OData V2: Notes on UI behavior and limitations

**DESCRIPTION**: Key UI behavior rules for V2:

**LANGUAGE**: text

**CODE**:
```text
- If UI.IsImage is set OR MediaType starts with "image/", UI shows thumbnails/avatars.
- Otherwise UI shows icon + hyperlink. Link text: filename (from ContentDisposition) or "Open File" by default.
- Draft apps: upload/delete only in editable mode. Non-draft apps: upload/delete only in display mode.
- Only one file per record; second upload replaces existing file.
- If no file present, a placeholder is displayed.
```

**STEP**: 5 — OData V4 Step 1: Add Edm.Stream property and media metadata

**DESCRIPTION**: Define Edm.Stream properties and associated metadata properties (MediaType, FileName). Use MaxLength (bytes) to restrict file size and Core.AcceptableMediaTypes to restrict MIME types. Use Core.MediaType binding to connect a media-type property; mark the type property with Core.IsMediaType.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Entity properties: stream + media type + name + optional MaxLength -->
<EntityType Name="MainEntities">
    ...
    <Property Name="myStreamProperty" Type="Edm.Stream" />
    <Property Name="myStreamPropertyType" Type="Edm.String" />
    <Property Name="myRestrictedStreamProperty" Type="Edm.Stream" MaxLength="100000"/>
    ...
</EntityType>

<!-- Bind Core.MediaType to a media-type property -->
<Annotations Target="sap.fe.stream.StreamsService.MainEntities/myStreamProperty">
    <Annotation Term="Core.MediaType" Path="myStreamPropertyType" />
</Annotations>

<!-- Mark the media-type property as a media-type -->
<Annotations Target="sap.fe.stream.StreamsService.MainEntities/myStreamPropertyType">
    <Annotation Term="Core.IsMediaType" Bool="true" />
</Annotations>

<!-- Restrict media type for a stream property and acceptable media types -->
<Annotations Target="sap.fe.stream.StreamsService.MainEntities/myRestrictedStreamProperty">
    <Annotation Term="Core.MediaType" String="text/plain"/>
    <Annotation Term="Core.AcceptableMediaTypes">
        <Collection>
            <String>text/plain</String>
        </Collection>
    </Annotation>
</Annotations>

<!-- Note: MaxLength is max file size in bytes. odata.mediaEditLink is not supported. -->
```

**STEP**: 6 — OData V4 Step 2: Annotate UI field to show upload/download control

**DESCRIPTION**: Maintain a UI.FieldGroup / UI.DataField entry that points the Value to the Edm.Stream property. This will render file preview/link and upload/delete controls in edit mode.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="sap.fe.stream.StreamsService.MainEntities">
    <Annotation Term="UI.FieldGroup" Qualifier="streams">
        <Record Type="UI.FieldGroupType">
            <PropertyValue Property="Label" String="Streams" />
            <PropertyValue Property="Data">
                <Collection>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Stream" />
                        <PropertyValue Property="Value" Path="myStreamProperty" />
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 7 — UI representation rules (document icon, link text, avatar)

**DESCRIPTION**: Implementation rules for rendering stream fields — when link text shows filename vs "Open File" vs empty indicator; when avatar is used.

**LANGUAGE**: text

**CODE**:
```text
Document icon:
- If backend returns odata.mediaContentType, SAP Fiori elements maps it to a specific icon; otherwise a generic icon is used.

Document link text:
- Filename shown when:
  * Core.ContentDisposition/Filename points to a non-empty filename AND
  * Stream property is not empty (odata.mediaContentType != null or not returned).
- "Open File" shown when:
  * No Core.ContentDisposition/Filename or it points to an empty filename AND
  * Stream property is not empty.
- Empty indicator shown when:
  * Stream property is empty (odata.mediaContentType returned as null).

Avatar:
- Render avatar when UI.IsImage is present OR Core.MediaType starts with "image/".
- To render as person avatar (circle), add Common.IsNaturalPerson at entity type or to UI.IsImage.
```

**STEP**: 8 — OData V4: Example — XML annotation combining media type + content disposition + label

**DESCRIPTION**: Example XML annotations to bind media type, file name and label for a stream property.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="sap.fe.streams.StreamsService.MainEntities/streamWithFilename_content">
     <Annotation Term="Core.MediaType" Path="streamWithFilename_type"/>
     <Annotation Term="Core.ContentDisposition">
          <Record Type="Core.ContentDispositionType">
               <PropertyValue Property="Filename" Path="streamWithFilename_name"/>
          </Record>
     </Annotation>
     <Annotation Term="Common.Label" String="Stream, dynamic media type, with name"/>
</Annotations>
```

**STEP**: 9 — OData V4: Example — CAP CDS (stream + media-type + filename binding)

**DESCRIPTION**: CAP CDS snippet showing property declarations and annotations for a stream with filename and media type mappings.

**LANGUAGE**: CDS

**CODE**:
```cds
@title : 'Stream with file name'
@Core.MediaType : streamWithFilename_type
@Core.ContentDisposition.Filename : streamWithFilename_name
streamWithFilename_content : Stream;
streamWithFilename_type : MediaType;
streamWithFilename_name : StreamName;
```

**STEP**: 10 — File upload as an action parameter (XML service metadata)

**DESCRIPTION**: Use a ComplexType containing Edm.Stream + MimeType + FileName as the action parameter to allow file uploads in action dialogs. Maintain Core.ContentDisposition, Core.MediaType and Core.IsMediaType annotations to preserve relationships. Use MaxLength and Core.AcceptableMediaTypes for restrictions.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Action with complex type parameter for file upload -->
<Action Name="ActionParameterTypeName" IsBound="true">
  <Parameter Name="_it" Type="service.namespace.EntityTypeName" Nullable="false"/>
  <Parameter Name="_StreamProperties" Type="service.namespace.FileStreamTypeName" Nullable="false"/>
</Action>

<ComplexType Name="FileStreamTypeName">
  <Property Name="StreamProperty" Type="Edm.Stream" Nullable="false" MaxLength="128" />
  <Property Name="MimeType" Type="Edm.String" Nullable="false" />
  <Property Name="FileName" Type="Edm.String" Nullable="false" />
</ComplexType>

<!-- Annotations linking filename and media type to the stream property -->
<Annotations Target="service.namespace.FileStreamTypeName/StreamProperty">
  <Annotation Term="Common.Label" String="Label for File Upload" />
  <Annotation Term="Core.ContentDisposition">
    <Record>
      <PropertyValue Property="Filename" Path="FileName" />
    </Record>
  </Annotation>
  <Annotation Term="Core.MediaType" Path="MimeType" />
  <Annotation Term="Core.AcceptableMediaTypes">
    <Collection>
      <String>image/png</String>
    </Collection>
  </Annotation>
</Annotations>

<Annotations Target="service.namespace.FileStreamTypeName/MimeType">
  <Annotation Term="Core.IsMediaType" />
</Annotations>
```

**STEP**: 11 — File upload as an action parameter — ABAP CDS example

**DESCRIPTION**: ABAP CDS view structure for a file-stream complex type and an action parameter association.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
// FILE_STREAM_TYPE_NAME
define root abstract entity FILE_STREAM_TYPE_NAME
{
  @Semantics.largeObject.mimeType: 'mimetype'
  @Semantics.largeObject.fileName: 'filename'
  @Semantics.largeObject.contentDispositionPreference: #INLINE
  streamproperty : abap.rawstring(0);

  @UI.hidden: true
  mimetype : abap.char(128);

  @UI.hidden: true
  filename : abap.char(128);
}

// Behavior Definitions
abstract;
strict;
with hierarchy;
define behavior for FILE_STREAM_TYPE_NAME {}

// ACTION_PARAMETER_TYPE_NAME
define root abstract entity ACTION_PARAMETER_TYPE_NAME
{
  _StreamProperties : association [1] to FILE_STREAM_TYPE_NAME on 1 = 1;
}

// Behavior Definitions for ACTION_PARAMETER_TYPE_NAME
abstract;
strict;
with hierarchy;
define behavior for ACTION_PARAMETER_TYPE_NAME
{
  association _StreamProperties with hierarchy;
}
```

**STEP**: 12 — File upload as an action parameter — CAP CDS example

**DESCRIPTION**: CAP CDS definition for action accepting a complex type with stream, mime type and filename; annotations link the fields.

**LANGUAGE**: CDS

**CODE**:
```cds
action ActionParameterTypeName(
  _StreamProperties : service.namespace.FileStreamTypeName not null
) returns EntityTypeName;

type FileStreamTypeName {
  StreamProperty       : LargeBinary @Core.MediaType: MimeType @Core.ContentDisposition.Filename: FileName;
  MimeType             : String @Core.IsMediaType;
  FileName             : String;
};
```

**STEP**: 13 — References & notes for implementers

**DESCRIPTION**: Quick reminders and external references.

**LANGUAGE**: text

**CODE**:
```text
- MaxLength on stream property = maximum file size in bytes.
- Use Core.AcceptableMediaTypes to whitelist MIME types.
- Backend must return odata.mediaContentType to indicate a non-empty stream; if backend returns odata.mediaContentType = null, UI treats stream as empty.
- The odata.mediaEditLink annotation is not supported.
- For CAP guidance see: https://cap.cloud.sap/docs/guides/providing-services#annotating-media-elements
- For action parameters see: Actions documentation.
```
--------------------------------

**TITLE**: Enable Sub-object Creation via Dialog on Non-draft Object Page (OData V2)

**INTRODUCTION**: Enable creation of related/sub-objects (up to 8 data fields) from an Object Page of a non-draft Fiori elements application (OData V2) using a parameter dialog. Configure the manifest to display a create dialog for a related entity set section and optionally override dialog title and success toast via i18n keys.

**TAGS**: fiori-elements-framework, odata-v2, manifest.json, object-page, create-dialog, non-draft, i18n

**STEP**: 1 — Add createWithParameterDialog to the section's tableSettings

**DESCRIPTION**: Add a createWithParameterDialog configuration under the specific section in the Object Page that represents the related entity set (section key typically is "<navigationProperty>::<annotationTerm>"). Place this under the sap.ui.generic.app → pages array in manifest.json. The fields map defines which properties appear in the dialog: each entry uses the property name as key and an object with "path" pointing to the entity property.

- Works only for OData V2 non-draft applications.
- Maximum of 8 fields in the dialog.
- Include all mandatory properties required by the related entity set.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "STTA_C_SO_SalesOrder_ND",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "showRelatedApps": true,
            "gridTable": false,
            "sections": {
              "to_Item::com.sap.vocabularies.UI.v1.LineItem": {
                "navigationProperty": "to_Item",
                "entitySet": "STTA_C_SO_SalesOrderItem_ND",
                "tableSettings": {
                  "createWithParameterDialog": {
                    "fields": {
                      "SalesOrderItemID": { "path": "SalesOrderItemID" },
                      "ProductID": { "path": "ProductID" },
                      "Quantity": { "path": "Quantity" }
                    }
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

**STEP**: 2 — Field mapping format and rules

**DESCRIPTION**: Use the following rules when defining fields:
- Key: an identifier for the UI field (typically same as property name).
- Value: object containing "path" with the entity property name.
- Include all required/mandatory properties for the related entity.
- Limit to 8 fields maximum.
- Each "path" must reference a property of the related entity set (STTA_C_SO_SalesOrderItem_ND in example).
- This configuration displays a dialog to create a sub-object on the Object Page; it does not apply to draft-enabled apps.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "createWithParameterDialog": {
    "fields": {
      "<FieldKey>": { "path": "<EntityPropertyName>" },
      "CustomerID": { "path": "CustomerID" },
      "Amount": { "path": "Amount" }
    }
  }
}
```

**STEP**: 3 — Override dialog title and success toast via i18n

**DESCRIPTION**: Default i18n keys and text:
- CREATE_DIALOG_TITLE = "New Item" (dialog title)
- ITEM_CREATED = "Item Created" (success toast)

To override, add or change these keys in your i18n properties file (e.g., i18n.properties under webapp/i18n).

**LANGUAGE**: Properties (i18n)

**CODE**:
```
CREATE_DIALOG_TITLE=Create Sales Order Item
ITEM_CREATED=Sales Order Item successfully created
```

**STEP**: 4 — Validation checklist before enabling

**DESCRIPTION**: Ensure the following before deploying:
- The application uses OData V2 and is non-draft.
- The related entity set contains the properties referenced by "path".
- All mandatory fields for the related entity are included in the dialog fields.
- The total number of fields configured does not exceed 8.

**LANGUAGE**: Plain text

**CODE**:
```
Checklist:
- OData protocol: V2
- App mode: non-draft
- Fields defined belong to the related entity set
- Mandatory fields included
- <= 8 fields in createWithParameterDialog
```
--------------------------------

**TITLE**: Enabling Table Personalization in SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: This guide explains how to enable and configure table personalization (filtering, sorting, grouping, column add/remove/reorder) for SAP Fiori Elements apps. It contains exact manifest.json snippets, annotation examples (XML / CDS / ABAP CDS), default behaviors, and actionable rules for text-arranged properties and currency/unit sorting.

**TAGS**: fiori-elements, table-personalization, manifest.json, variantManagement, smartVariantManagement, LineItem, annotations, SortRestrictions, TextArrangement

**STEP**: Filter option defaults

**DESCRIPTION**: Understand default behavior for the filter option across page-level and control-level variants and where the filter access appears for responsive vs other table types.

**LANGUAGE**: plain

**CODE**:
```text
Defaults:
- Page-level variant: Filter option disabled by default.
- Control-level variant: Filter option enabled by default.

Notes:
- For responsive tables, the filter option is available in the table personalization settings.
- For other table types, when the filter option is enabled it is available both from the personalization dialog and from the column header menu.
```

**STEP**: Enable table filtering for OData V2 (harmonized variant management)

**DESCRIPTION**: To allow end users to set table filters in page variants for an OData V2 List Report using harmonized variant management, add enableTableFilterInPageVariant to the page component settings. If smartVariantManagement is false, table filtering is enabled by default.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "forceGlobalRefresh": true
    },
    "pages": {
      "ListReport|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "smartVariantManagement": true,
            "enableTableFilterInPageVariant": true
          }
        }
      }
    }
  }
}
```

**STEP**: Enable or disable table personalization for OData V4 (variantManagement)

**DESCRIPTION**: Set the variantManagement property for a List Report or Object Page to control personalization scope. Use "Page", "Control", or "None" depending on desired behavior.

- "Page" (List Report): table personalization filtering is disabled; use filterBar and save filters to page variant.
- "Control": enables control-level personalization (filter, sort, column, grouping depending on personalization configuration).
- "None" (Object Page): disable variant management.

Provide this in the component entry of manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "my.app"
  },
  "sap.ui5": {
    "componentUsages": {},
    "routing": {}
  },
  "sap.fiori": {},
  "sap.ui": {},
  "sap.ui5": {
    "services": {}
  },
  "sap.ui.generic.app": {},
  "sap.fe.templates": {},
  "sap.ui": {},
  "Component": {},
  "BusinessPartnersList": {
    "type": "Component",
    "id": "BusinessPartnersList",
    "name": "sap.fe.templates.ListReport",
    "options": {
      "settings": {
        "contextPath": "/BusinessPartners",
        "variantManagement": "Control"
      }
    }
  }
}
```

**STEP**: Configure personalization features per table (controlConfiguration)

**DESCRIPTION**: When variantManagement is "Control", control-level personalization is enabled by default. Use the "personalization" object under controlConfiguration for a specific LineItem annotation to enable/disable specific features (column, sort, filter, group). Use explicit object form to avoid automatic enabling of future features.

- Values:
  - true: enable all features
  - false: disable all features
  - object: specify column/sort/filter/group booleans

**LANGUAGE**: JSON

**CODE**:
```json
{
  "UsersList": {
    "type": "Component",
    "id": "UsersList",
    "name": "sap.fe.templates.ListReport",
    "options": {
      "settings": {
        "contextPath": "/Users",
        "variantManagement": "Control",
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "type": "AnalyticalTable",
              "personalization": {
                "column": true,
                "sort": false,
                "filter": true,
                "group": true
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: SortRestrictions — XML Annotation for NavigationRestrictions (OData V4)

**DESCRIPTION**: Use Capabilities.NavigationRestrictions and Capabilities.SortRestrictions to control which properties (including navigation properties) are sortable. Examples show disabling individual non-sortable navigation properties and disabling all sorting for a navigation property.

Place this annotation in your service annotations file (annotations.xml) or approprately in your annotation provider.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="Capabilities.NavigationRestrictions">
    <Record Type="Capabilities.NavigationRestrictionsType">
        <PropertyValue Property="RestrictedProperties">
            <Collection>
                <Record Type="Capabilities.NavigationPropertyRestriction">
                    <PropertyValue Property="NavigationProperty" NavigationPropertyPath="_OverallSDProcessStatus"/>
                    <PropertyValue Property="SortRestrictions">
                        <Record Type="Capabilities.SortRestrictionsType">
                            <PropertyValue Property="NonSortableProperties">
                                <Collection>
                                    <PropertyPath>_OverallSDProcessStatus/OverallSDProcessStatus_Text</PropertyPath>
                                </Collection>
                            </PropertyValue>
                        </Record>
                    </PropertyValue>
                </Record>
                <Record Type="Capabilities.NavigationPropertyRestriction">
                    <PropertyValue Property="NavigationProperty" NavigationPropertyPath="_SalesOrderType"/>
                    <PropertyValue Property="SortRestrictions">
                        <Record Type="Capabilities.SortRestrictionsType">
                            <PropertyValue Property="NonSortableProperties">
                                <PropertyValue Property="Sortable" Bool="false"/>
                            </PropertyValue>
                        </Record>
                    </PropertyValue>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: SortRestrictions — ABAP CDS example (disable sorting for an entity)

**DESCRIPTION**: Use @ObjectModel.sort.enabled: false in ABAP CDS to disable sorting for an entity or property.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@ObjectModel.sort.enabled: false
define view ZMyView as select from my_table {
  key id,
      field1,
      field2
}
```

**STEP**: SortRestrictions — CAP CDS example (NavigationRestrictions)

**DESCRIPTION**: For CAP (Node.js) CDS, define NavigationRestrictions with SortRestrictions to mark NonSortableProperties or disable Sortable entirely. When referencing navigation properties, prefix NonSortableProperties with the NavigationPropertyPath.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
using { cuid } from '@sap/cds/common';

entity BusinessPartner {
  key ID : UUID;
  OverallSDProcessStatus : Association to SomeStatus;
  SalesOrderType : Association to SomeOrderType;
  Amount : Decimal;
  Currency : String;
}

annotate BusinessPartner with {
  @Capabilities.NavigationRestrictions : {
    RestrictedProperties: [
      {
        NavigationProperty: _OverallSDProcessStatus,
        SortRestrictions: { NonSortableProperties: [_OverallSDProcessStatus.OverallSDProcessStatus_Text] }
      },
      {
        NavigationProperty: _SalesOrderType,
        SortRestrictions: { Sortable: false }
      }
    ]
  }
}
```

**STEP**: Behavior notes and limitations

**DESCRIPTION**: Actionable behavior and restrictions to follow during implementation.

**LANGUAGE**: plain

**CODE**:
```text
- Grouping: available for Analytical and Responsive tables only.
- Responsive table: end users can open sorting/filtering/grouping dialog from column header.
- Default dialog properties: the properties visible in the column are used as defaults in the Sort/Filter/Group dialog.
- Restriction: cannot sort or group 1:n (multi-input) fields.
- Navigation properties: sorting/filtering availability only for properties present in the LineItem.
- TextArrangement impacts:
  - #TextFirst: sorting/grouping available on either property or its text.
  - #TextOnly: sorting/grouping available only on the text; filtering applies on the property itself (text filter may apply only if text has no filter restriction).
  - If a column label is set in LineItem, that label is used in Sort/Group menus for single-property columns. Filter menu shows the property name.
  - If TextOnly and the text property is annotated UI.Hidden=true, the Hidden annotation is ignored for sorting/grouping — text can still be sorted/grouped.
  - If a presentationVariant sets sortOrder on a TextOnly property, sorting is applied on the property (not text); the header sort indicator may not appear if the property is not visible in the table.
  - If TextArrangement target is not part of the LineItem, the target property is not available in the Columns tab of the personalization dialog.
- Sorting amounts with currency/unit:
  - Ascending sort first orders by currency or UoM, then by amount to ensure consistent display across currencies/units.
- CAP Node.js + SQLite:
  - Sorting on navigation properties can cause issues when using CAP Node.js with an SQLite database; test and avoid if unstable.
```

**STEP**: Recommended references

**DESCRIPTION**: Use these documentation topics when implementing or troubleshooting variant and personalization behavior.

**LANGUAGE**: plain

**CODE**:
```text
- Managing Variants: see "Managing Variants" topic in Fiori Elements docs.
- Enabling Variant Management on Object Page: see "Enabling Variant Management on the Object Page".
- Personalization for properties with Text Arrangement: consult the TextArrangement subsection in the Table Personalization docs.
```

--------------------------------

**TITLE**: Enabling and Configuring Flexible Column Layout (FCL) in SAP Fiori Elements

**INTRODUCTION**: This reference shows exactly how to enable and configure the Flexible Column Layout (FCL) for SAP Fiori Elements applications (OData V2 and V4). It contains actionable, copy-pasteable manifest.json snippets, routing/target configurations for 2- and 3-column scenarios, and UI tooling steps. Use these snippets to enable FCL, set default layouts, and map routes/targets to begin/mid/end column aggregations.

**TAGS**: fiori-elements, flexible-column-layout, manifest.json, routing, sap.f, sap.fe, ODataV2, ODataV4, manifest, rootView

STEP: Prerequisites and Important Notes
DESCRIPTION: Key restrictions and prerequisites to know before enabling FCL.
LANGUAGE: text
CODE:
```
- The FCL is not available for the Overview Page floorplan.
- Analytical List Page supports only TwoColumnsBeginExpanded.
- FCL works for draft and non-draft scenarios.
- PopinLayout can be set to Block, GridLarge, or GridSmall for readability.
- Column resize settings are saved per user/app/device (personalization).
- For OData V4: ensure "sap.f" library is added under "sap.ui5" dependencies.
```

STEP: Enable Flexible Column Layout using SAP Fiori Tools (Page Map)
DESCRIPTION: Use SAP Fiori Tools Page Map to quickly toggle FCL and preview. This is a UI step; settings are applied to manifest.json.
LANGUAGE: text
CODE:
```
1. Open Page Map (e.g., right-click project folder -> Show Page Map).
2. In the Property Panel select "Flexible Column Layout".
3. Choose a two-column or three-column layout (affects defaultTwoColumnLayoutType/defaultThreeColumnLayoutType in manifest.json).
4. Preview the app (Previewing an Application).
```

STEP: Configure FCL in manifest.json (OData V2) — Global settings
DESCRIPTION: Add a global "flexibleColumnLayout" entry under "sap.ui.generic.app"."settings" to set default 2- and 3-column layout behavior.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "settings": {
      "flexibleColumnLayout": {
        "defaultTwoColumnLayoutType": "TwoColumnsMidExpanded",
        "defaultThreeColumnLayoutType": "ThreeColumnsEndExpanded"
      }
    },
    "pages": [
      /* ... */
    ]
  }
}
```

STEP: Set defaultLayoutType per page (OData V2) — override global defaults
DESCRIPTION: Use "defaultLayoutType" at a page level to open that page in a specific layout (e.g., OneColumn or MidColumnFullScreen). This overrides global flexibleColumnLayout for that column.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "settings": {
      "flexibleColumnLayout": {
        "defaultTwoColumnLayoutType": "TwoColumnsMidExpanded",
        "defaultThreeColumnLayoutType": "ThreeColumnsEndExpanded"
      }
    },
    "pages": [
      {
        "entitySet": "MainEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": { /* ... */ }
        },
        "pages": [
          {
            "entitySet": "ChildEntitySet",
            "defaultLayoutType": "OneColumn",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": { /* ... */ }
            }
          }
        ]
      }
    ]
  }
}
```

STEP: Configure FCL in OData V4 — Add rootView
DESCRIPTION: For OData V4 apps, set a rootView to use the FCL root view implementation.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "rootView": {
      "viewName": "sap.fe.core.rootView.Fcl",
      "type": "XML",
      "async": true,
      "id": "appRootView"
    }
  }
}
```

STEP: Configure OData V4 — Routing config with sap.f.routing.Router and flexibleColumnLayout
DESCRIPTION: In "routing"."config" set routerClass to "sap.f.routing.Router" and optionally include flexibleColumnLayout defaults (two/three column default types).
LANGUAGE: JSON
CODE:
```json
{
  "routing": {
    "config": {
      "routerClass": "sap.f.routing.Router",
      "flexibleColumnLayout": {
        "defaultTwoColumnLayoutType": "TwoColumnsMidExpanded",
        "defaultThreeColumnLayoutType": "ThreeColumnsMidExpanded"
      }
    },
    "routes": [
      /* ... */
    ]
  }
}
```

STEP: Routing & Target keys — keys and mapping rules
DESCRIPTION: Use the following keys when defining routes and targets for FCL:
- routes[].pattern: pattern to match navigation (end patterns commonly include :?query:).
- routes[].name: unique route id.
- routes[].target: array of target names to display (array length maps to columns shown).
- targets[].controlAggregation: set to beginColumnPages / midColumnPages / endColumnPages depending on column placement.
LANGUAGE: text
CODE:
```
Key mapping:
- route.name: unique route identifier
- route.target: array of target names to show (mapping order -> begin/mid/end)
- targets[].type = "Component"
- targets[].id = unique target id
- targets[].name = template component (sap.fe.templates.ListReport or sap.fe.templates.ObjectPage)
- targets[].controlAggregation: "beginColumnPages" | "midColumnPages" | "endColumnPages"
- targets[].contextPattern: navigation path for the target (OData path)
```

STEP: Example A — 3-column layout starting with List Report (List → List|Object1 → List|Object1|Object2)
DESCRIPTION: Copy this manifest routing/targets fragment for a common 3-column scenario that starts with a list report in the first column.
LANGUAGE: JSON
CODE:
```json
{
  "routes": [
    {
      "pattern": ":?query:",
      "name": "SalesOrderManageList",
      "target": ["SalesOrderManageList"]
    },
    {
      "pattern": "SalesOrderManage({key}):?query:",
      "name": "SalesOrderManageObjectPage",
      "target": ["SalesOrderManageList", "SalesOrderManageObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2}):?query:",
      "name": "SalesOrderItemObjectPage",
      "target": ["SalesOrderManageList", "SalesOrderManageObjectPage", "SalesOrderItemObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3}):?query:",
      "name": "MaterialDetailsObjectPage",
      "target": ["MaterialDetailsObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3})/_MaterialRatings({key4}):?query:",
      "name": "MaterialRatingsObjectPage",
      "target": ["MaterialRatingsObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3})/_MaterialRatings({key4})/_MaterialRatingsDetails({key5}):?query:",
      "name": "MaterialRatingsDetailsObjectPage",
      "target": ["MaterialRatingsDetailsObjectPage"]
    }
  ],
  "targets": {
    "SalesOrderManageList": {
      "type": "Component",
      "id": "SalesOrderManageList",
      "name": "sap.fe.templates.ListReport",
      "controlAggregation": "beginColumnPages",
      "contextPattern": ""
    },
    "SalesOrderManageObjectPage": {
      "type": "Component",
      "id": "SalesOrderManageObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "midColumnPages",
      "contextPattern": "/SalesOrderManage({key})"
    },
    "SalesOrderItemObjectPage": {
      "type": "Component",
      "id": "SalesOrderItemObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "endColumnPages",
      "contextPattern": "/SalesOrderManage({key})/_Item({key2})"
    },
    "MaterialDetailsObjectPage": {
      "type": "Component",
      "id": "MaterialDetailsObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "endColumnPages",
      "contextPattern": "/SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3})"
    }
    /* ... other targets ... */
  }
}
```

STEP: Example B — 2-column layout starting with Object Page (List → Object1 → Object1|Object2)
DESCRIPTION: Copy this manifest routing/targets fragment for a 2-column scenario that starts with an object page.
LANGUAGE: JSON
CODE:
```json
{
  "routes": [
    {
      "pattern": ":?query:",
      "name": "SalesOrderManageList",
      "target": ["SalesOrderManageList"]
    },
    {
      "pattern": "SalesOrderManage({key}):?query:",
      "name": "SalesOrderManageObjectPage",
      "target": ["SalesOrderManageObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2}):?query:",
      "name": "SalesOrderItemObjectPage",
      "target": ["SalesOrderManageObjectPage", "SalesOrderItemObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3}):?query:",
      "name": "MaterialDetailsObjectPage",
      "target": ["MaterialDetailsObjectPage"]
    }
  ],
  "targets": {
    "SalesOrderManageList": {
      "type": "Component",
      "id": "SalesOrderManageList",
      "name": "sap.fe.templates.ListReport",
      "controlAggregation": "beginColumnPages",
      "contextPattern": ""
    },
    "SalesOrderManageObjectPage": {
      "type": "Component",
      "id": "SalesOrderManageObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "beginColumnPages",
      "contextPattern": "/SalesOrderManage({key})"
    },
    "SalesOrderItemObjectPage": {
      "type": "Component",
      "id": "SalesOrderItemObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "midColumnPages",
      "contextPattern": "/SalesOrderManage({key})/_Item({key2})"
    },
    "MaterialDetailsObjectPage": {
      "type": "Component",
      "id": "MaterialDetailsObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "endColumnPages",
      "contextPattern": "/SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3})"
    }
  }
}
```

STEP: Example C — 3-column layout starting with Object Page (complex object-only flow)
DESCRIPTION: Copy this manifest fragment for flows that begin with an object page and progressively populate mid and end columns.
LANGUAGE: JSON
CODE:
```json
{
  "routes": [
    {
      "pattern": ":?query:",
      "name": "SalesOrderManageList",
      "target": "SalesOrderManageList"
    },
    {
      "pattern": "SalesOrderManage({key}):?query:",
      "name": "SalesOrderManageObjectPage",
      "target": ["SalesOrderManageObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2}):?query:",
      "name": "SalesOrderItemObjectPage",
      "target": ["SalesOrderItemObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3}):?query:",
      "name": "MaterialDetailsObjectPage",
      "target": ["SalesOrderItemObjectPage", "MaterialDetailsObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3})/_MaterialRatings({key4}):?query:",
      "name": "MaterialRatingsObjectPage",
      "target": ["SalesOrderItemObjectPage", "MaterialDetailsObjectPage", "MaterialRatingsObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3})/_MaterialRatings({key4})/_MaterialRatingsDetails({key5}):?query:",
      "name": "MaterialRatingsDetailsObjectPage",
      "target": ["MaterialRatingsDetailsObjectPage"]
    }
  ],
  "targets": {
    "SalesOrderManageList": {
      "type": "Component",
      "id": "SalesOrderManageList",
      "name": "sap.fe.templates.ListReport",
      "controlAggregation": "beginColumnPages",
      "contextPattern": ""
    },
    "SalesOrderManageObjectPage": {
      "type": "Component",
      "id": "SalesOrderManageObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "beginColumnPages",
      "contextPattern": "/SalesOrderManage({key})"
    },
    "SalesOrderItemObjectPage": {
      "type": "Component",
      "id": "SalesOrderItemObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "beginColumnPages",
      "contextPattern": "/SalesOrderManage({key})/_Item({key2})"
    },
    "MaterialDetailsObjectPage": {
      "type": "Component",
      "id": "MaterialDetailsObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "midColumnPages",
      "contextPattern": "/SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3})"
    },
    "MaterialRatingsObjectPage": {
      "type": "Component",
      "id": "MaterialRatingsObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "endColumnPages",
      "contextPattern": "/SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3})/_MaterialRatings({key4})"
    }
  }
}
```

STEP: Target configuration template and mapping rules
DESCRIPTION: Copy this template to define targets consistently. Use ListReport only for first-level initial view; ObjectPage for subsequent levels. controlAggregation maps directly to begin/mid/end columns.
LANGUAGE: JSON
CODE:
```json
{
  "targets": {
    "ExampleList": {
      "type": "Component",
      "id": "ExampleList",
      "name": "sap.fe.templates.ListReport",
      "controlAggregation": "beginColumnPages",
      "contextPattern": ""
    },
    "ExampleObjectMid": {
      "type": "Component",
      "id": "ExampleObjectMid",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "midColumnPages",
      "contextPattern": "/Example({key})"
    },
    "ExampleObjectEnd": {
      "type": "Component",
      "id": "ExampleObjectEnd",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "endColumnPages",
      "contextPattern": "/Example({key})/_Sub({key2})"
    }
  }
}
```

STEP: Runtime behavior, personalization and restrictions
DESCRIPTION: Operational notes to implementers and testers.
LANGUAGE: text
CODE:
```
- End users can expand/collapse columns and enter full-screen per column via FCL UI buttons.
- Column resize is stored per user/app/device (desktop/tablet/phone) in personalization.
- Restrictions:
  - In object page edit mode, subobject pages close automatically when table columns are added/removed.
  - If multiple tables share the same entity on a page, only the first table synchronizes with its subobject page.
  - Multi-input changes on object pages require parent page refresh to display updates.
  - TreeTable or AnalyticalTable is not supported in the List Report for draft-enabled services in FCL.
```


--------------------------------

**TITLE**: Enable Full-Screen Mode for Tables in SAP Fiori elements (OData V4)

**INTRODUCTION**: Enable a full-screen toggle for table controls in an Object Page by adding a manifest.json setting. This exposes a button on the table toolbar to open/close the table in full-screen mode, giving users more space to view and work with table entries.

**TAGS**: fiori-elements-framework, manifest.json, full-screen, tables, odata-v4, ui5, tableSettings, controlConfiguration

**STEP**: 1 — Add enableFullScreen to manifest.json

**DESCRIPTION**: Add the enableFullScreen property to the controlConfiguration for the table LineItem annotation of the target page in manifest.json. The snippet below shows the manifest fragment to be placed under the page configuration (example page id: SalesOrderManageObjectPage). Adjust the page key to match your application page id.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "SalesOrderManageObjectPage": {
        "options": {
          "settings": {
            "controlConfiguration": {
              "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                "tableSettings": {
                  "enableFullScreen": true
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Scope and applicability

**DESCRIPTION**: Use these rules when adding the setting:
- This setting applies only to SAP Fiori elements for OData V4.
- It is not available for List Report pages. If configured for a list report page, the setting will be ignored during templating.
- On mobile phones, full-screen mode is enabled by default (no manifest configuration required).

**LANGUAGE**: JSON

**CODE**:
```json
// Notes (for developer reference)
// - Applicable: SAP Fiori elements OData V4 Object Page tables
// - Ignored for: List Report pages
// - Mobile phones: full-screen enabled by default
```

**STEP**: 3 — Runtime behavior and UX

**DESCRIPTION**: Expected UI behavior after enabling:
- A full-screen button appears on the table toolbar to the left of the personalization button.
- Clicking the button toggles the table into a full-screen dialog; the button icon changes to indicate "exit full-screen".
- The full-screen dialog also shows a Close button at the bottom to exit full-screen mode.

**LANGUAGE**: JSON

**CODE**:
```json
// Runtime UX summary (no code changes required):
// - Toolbar: [Full-screen button] appears left of Personalization button
// - Toggle: Button click opens full-screen dialog; icon toggles for exit
// - Dialog: Close button shown at bottom to exit full-screen
```
--------------------------------

**TITLE**: Enable input-history (recently entered values) for Fiori Elements filters

**INTRODUCTION**: This guide shows how to enable/disable the history of recently entered values for filter fields in SAP Fiori Elements applications. It covers prerequisites (launchpad parameter), per-field and global manifest settings for OData V2 and OData V4 apps, and how to mark properties as sensitive to prevent history storage.

**TAGS**: fiori-elements, manifest, filterSettings, historySettings, INPUTFIELD_HISTORY, ODataV2, ODataV4, personal-data

**STEP**: 1 — Prerequisite: enable launchpad parameter

**DESCRIPTION**: Enable the FLP parameter INPUTFIELD_HISTORY in the SAP Fiori launchpad. This global launchpad setting must be active for any app-level historySettings to take effect.

- Where to configure: Launchpad admin settings
- Documentation: Manage Launchpad Settings — https://help.sap.com/docs/SAP_S4HANA_CLOUD/4fc8d03390c342da8a60f8ee387bca1a/22d573aead754b80abca18ec71872fb7.html

**LANGUAGE**: TEXT

**CODE**:
```text
Action: Set FLP parameter INPUTFIELD_HISTORY = true (via system/launchpad admin settings)
```

**STEP**: 2 — OData V2: Enable/disable history per-field in manifest (sap.ui.generic.app)

**DESCRIPTION**: For SAP Fiori Elements OData V2 apps, configure history behavior in the application manifest under "sap.ui.generic.app" -> pages -> <PageKey> -> component -> settings -> filterSettings -> historySettings. You can set a global default ("historyEnabled") and/or override individual OData properties by name under "fields". Valid values for historyEnabled (global or per-field) are "enabled", "disabled", or "auto" (default; behavior depends on control type).

- Page key example: "ListReport|RootEntity"
- <fieldname> is the OData property name of the filter field

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|RootEntity": {
        "component": {
          "settings": {
            "filterSettings": {
              "historySettings": {
                "historyEnabled": "auto",    // global default: "enabled" | "disabled" | "auto"
                "fields": {
                  "SalesOrderID": {
                    "historyEnabled": "enabled"
                  },
                  "CustomerName": {
                    "historyEnabled": "disabled"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — OData V2: Minimal per-field example (only enable history for one field)

**DESCRIPTION**: Example showing only one field entry under fields.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|RootEntity": {
        "component": {
          "settings": {
            "filterSettings": {
              "historySettings": {
                "fields": {
                  "CustomerName": {
                    "historyEnabled": "enabled"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — OData V4: Enable/disable history in manifest (sap.fe)

**DESCRIPTION**: For SAP Fiori Elements OData V4 apps, history of recently entered values is enabled by default. Use the "sap.fe" -> historySettings -> fields map to disable (false) or enable (true) history per property path. The key is the property path in the OData metadata.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.fe": {
    "historySettings": {
      "fields": {
        "CustomerName": {
          "historyEnabled": false
        },
        "SalesOrderID": {
          "historyEnabled": true
        }
      }
    }
  }
}
```

**STEP**: 5 — Mark sensitive properties to prevent history storage (annotation)

**DESCRIPTION**: To prevent storage of values for properties that contain sensitive personal data, add the PersonalData annotation com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive to the property in the service metadata (EDMX) or in annotations. When present, the platform will not store history for that property.

**LANGUAGE**: XML (EDMX snippet)

**CODE**:
```xml
<Property Name="CustomerName" Type="Edm.String">
  <Annotation Term="com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive" Bool="true" />
</Property>
```

**STEP**: 6 — End-user note: deleting input history and related docs

**DESCRIPTION**: End users can delete their own input history. For UI behavior and user instructions, see Input History and Configuring Filter Bars.

**LANGUAGE**: TEXT

**CODE**:
```text
Related docs:
- Input History: ../10_More_About_Controls/input-history-152f84f.md
- Configuring Filter Bars: configuring-filter-bars-4bd7590.md
- Security configuration (sensitive data handling): security-configuration-ba0484b.md
```
--------------------------------

**TITLE**: Enabling the Situation Handling Icon (Fiori elements, OData V4)

**INTRODUCTION**: Enable automatic display of the Situation Handling (business situations) icon in SAP Fiori elements List Report and Object Page UIs. Requirement: your OData V4 service metadata must annotate exactly one target entity type with the SAPObjectNodeType = "BusinessSituation" and the root entity must expose exactly one navigation property pointing to that annotated entity type.

**TAGS**: fiori-elements-framework, odata-v4, situation-handling, annotations, edmx

**STEP**: 1 — Confirm OData V4 service
**DESCRIPTION**: Verify the service is OData V4. Open the service $metadata and confirm the EDMX version is 4.0.
**LANGUAGE**: XML
**CODE**:
```XML
<!-- Example: check /$metadata contains Edmx Version="4.0" -->
<Edmx Version="4.0" xmlns="http://docs.oasis-open.org/odata/ns/edmx">
  <DataServices>
    <!-- service schema and annotations here -->
  </DataServices>
</Edmx>
```

**STEP**: 2 — Annotate the BusinessSituation entity type
**DESCRIPTION**: Add the SAPObjectNodeType annotation to the entity type that represents business situations. This annotation must use the vocabulary term com.sap.vocabularies.Common.v1.SAPObjectNodeType with a Record containing PropertyValue Name = "BusinessSituation". Place this annotation in your service metadata (EDMX/Annotations) or merge it into your generated metadata.
**LANGUAGE**: XML
**CODE**:
```XML
<!-- Add an Annotations section targeting the BusinessSituation entity type -->
<Annotations Target="MyService.BusinessSituation" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="com.sap.vocabularies.Common.v1.SAPObjectNodeType">
    <Record>
      <PropertyValue Property="Name" String="BusinessSituation" />
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 3 — Expose exactly one navigation property to the annotated type
**DESCRIPTION**: Ensure the root/main entity (the business entity shown in list/object page) exposes exactly one NavigationProperty whose Type targets the annotated BusinessSituation entity type. The framework requires exactly one such navigation property to render the situation icon.
**LANGUAGE**: XML
**CODE**:
```XML
<!-- Example EntityType that represents the application business object -->
<Schema Namespace="MyService" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <EntityType Name="PurchaseOrder">
    <Key><PropertyRef Name="ID"/></Key>
    <Property Name="ID" Type="Edm.String" Nullable="false"/>
    <!-- Exactly one navigation property to the annotated BusinessSituation entity -->
    <NavigationProperty Name="BusinessSituationNav" Type="MyService.BusinessSituation" />
  </EntityType>

  <!-- The annotated BusinessSituation entity type can be defined like this -->
  <EntityType Name="BusinessSituation">
    <Key><PropertyRef Name="SituationID"/></Key>
    <Property Name="SituationID" Type="Edm.String" Nullable="false" />
    <!-- ... other properties describing the situation ... -->
  </EntityType>
</Schema>
```

**STEP**: 4 — Full minimal EDMX fragment (combined)
**DESCRIPTION**: Example minimal combined fragment showing schema + annotations. Use this as a drop-in example when editing service metadata or generating EDMX.
**LANGUAGE**: XML
**CODE**:
```XML
<Edmx Version="4.0" xmlns="http://docs.oasis-open.org/odata/ns/edmx">
  <DataServices>
    <Schema Namespace="MyService" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <EntityType Name="PurchaseOrder">
        <Key><PropertyRef Name="ID"/></Key>
        <Property Name="ID" Type="Edm.String" Nullable="false"/>
        <NavigationProperty Name="BusinessSituationNav" Type="MyService.BusinessSituation" />
      </EntityType>

      <EntityType Name="BusinessSituation">
        <Key><PropertyRef Name="SituationID"/></Key>
        <Property Name="SituationID" Type="Edm.String" Nullable="false" />
      </EntityType>
    </Schema>

    <Annotations Target="MyService.BusinessSituation" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <Annotation Term="com.sap.vocabularies.Common.v1.SAPObjectNodeType">
        <Record>
          <PropertyValue Property="Name" String="BusinessSituation" />
        </Record>
      </Annotation>
    </Annotations>
  </DataServices>
</Edmx>
```

**STEP**: 5 — Deploy and verify in UI
**DESCRIPTION**: Deploy the updated metadata (service endpoint or UI proxy). Open the Fiori elements List Report and Object Page for the root entity. If the metadata contains the annotation and there is exactly one navigation property pointing to the annotated type, the Situation Handling icon automatically appears:
- In List Report: icon appears in a dedicated column (grid table shows a separate column for business situations).
- In Object Page: icon shown in the header/actions or configured area as provided by the Fiori elements templates.

**LANGUAGE**: Plain
**CODE**:
```text
Verification steps:
1. Refresh the app that consumes the OData V4 service.
2. Check List Report / Object Page for the business situation icon.
3. If not displayed: re-check $metadata to confirm
   - Edmx Version="4.0"
   - Annotations Target points to the correct Namespace.EntityType
   - Exactly one NavigationProperty references that annotated entity type
```
--------------------------------

**TITLE**: Enabling and Configuring the Related Apps Button (Fiori elements)

**INTRODUCTION**: This document shows how to enable the Related Apps button on Object Pages and how to configure which semantic-object links appear. It covers Fiori elements OData V2 and V4 manifest settings, how to add additional semantic objects, mapping between fields, and hiding/allowing specific actions. Use these snippets directly in manifest.json or annotation files.

**TAGS**: fiori-elements, manifest.json, related-apps, semantic-object, semanticObjectAction, SemanticObjectUnavailableActions, SemanticObjectMapping, ODataV2, ODataV4, CAP, ABAP, XML

STEP: 1 — Enable Related Apps (OData V2)
DESCRIPTION: Turn on the Related Apps button for an Object Page in a V2 application by setting showRelatedApps: true under the object page component in sap.ui.generic.app pages.
LANGUAGE: JavaScript/JSON
CODE:
```js
// manifest.json (sap.ui.generic.app structure)
"sap.ui.generic.app": {
  "pages": [
    {
      "entitySet": "SEPMRA_C_PD_Product",
      "component": {
        "name": "sap.suite.ui.generic.template.ListReport",
        "list": true
      },
      "pages": [
        {
          "entitySet": "SEPMRA_C_PD_Product",
          "component": {
            "name": "sap.suite.ui.generic.template.ObjectPage",
            "settings": {
              "showRelatedApps": true
            }
          },
          "pages": [
            {
              "navigationProperty": "to_ProductText",
              "entitySet": "SEPMRA_C_PD_ProductText",
              "component": {
                "name": "sap.suite.ui.generic.template.ObjectPage"
              }
            }
          ]
        }
      ]
    }
  ]
}
```

STEP: 2 — Add relatedAppsSettings (OData V2): add semantic objects and actions
DESCRIPTION: Configure additional semantic objects and restrict which actions are shown for each semantic object using relatedAppsSettings in the same object page settings. Behavior rules:
- If semanticObjectAction is not defined for a semanticObject -> show all actions except those excluded via SemanticObjectUnavailableActions annotation.
- If semanticObjectAction is defined -> only actions listed there are shown; SemanticObjectUnavailableActions is ignored for that semantic object.
- If semanticObjectAction is defined as an empty object -> no actions from the current app's semantic object are considered.
LANGUAGE: JSON
CODE:
```json
// manifest.json: relatedAppsSettings (inside the ObjectPage component settings)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_PD_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": [
          {
            "entitySet": "SEPMRA_C_PD_Product",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "showRelatedApps": true,
                "relatedAppsSettings": {
                  "0": {
                    "semanticObject": "EPMProduct"
                  },
                  "STTA_WD20": {
                    "semanticObject": "STTA_WD20",
                    "semanticObjectAction": {
                      "0": { "action": "Multi_View" },
                      "1": { "action": "Tree_Table" }
                    }
                  },
                  "": {
                    "semanticObject": "",
                    "semanticObjectAction": {}
                  }
                }
              }
            }
          }
        ]
      }
    ]
  }
}
```

STEP: 3 — Hide actions using SemanticObjectUnavailableActions (XML & CAP)
DESCRIPTION: Use the Common.SemanticObjectUnavailableActions annotation to hide specific actions for a semantic object in the app context. If ABAP CDS annotation is not available for this case, use XML local annotations or CAP CDS.
LANGUAGE: XML
CODE:
```xml
<!-- local XML annotations file -->
<Annotations Target="SalesOrderService.SalesOrderManage">
  ...
  <Annotation Term="Common.SemanticObjectUnavailableActions">
    <Collection>
      <String>displayFactSheet</String>
    </Collection>
  </Annotation>
  <Annotation Term="Common.SemanticObject" String="SalesOrder"/>
  ...
</Annotations>
```

LANGUAGE: CDS (CAP)
CODE:
```cds
// CAP CDS: hide displayFactSheet
Common.SemanticObjectUnavailableActions : ['displayFactSheet']
```

STEP: 4 — Enable Related Apps (OData V4 / Fiori elements for V4)
DESCRIPTION: For OData V4 (FE), enable the Related Apps button by setting options.settings.showRelatedApps true in the ObjectPage component declaration in manifest.json.
LANGUAGE: JSON
CODE:
```json
// manifest.json (Fiori elements V4)
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "contextPath": "/SalesOrderManage",
      "showRelatedApps": true
    }
  }
}
```
DESCRIPTION (note): When calling FLP GetLinks API, Fiori elements passes all semantic keys if available; otherwise it passes technical keys.

STEP: 5 — Map default link field names between source and target apps (SemanticObjectMapping)
DESCRIPTION: If the technical field names differ between source and target, annotate the source entity with Common.SemanticObject and Common.SemanticObjectMapping so the runtime translates keys. Do not use this annotation to map to additionalSemanticObjects added via the manifest; those mappings are defined in manifest (see Step 6).
LANGUAGE: XML
CODE:
```xml
<!-- XML annotation: SemanticObject + SemanticObjectMapping -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage">
  <Annotation Term="Common.SemanticObject" String="SalesOrder"/>
  <Annotation Term="Common.SemanticObjectMapping">
    <Collection>
      <Record Type="Common.SemanticObjectMappingType">
        <PropertyValue Property="LocalProperty" PropertyPath="SoldToParty"/>
        <PropertyValue Property="SemanticObjectProperty" String="Customer"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
// ABAP CDS example: annotate view and map Customer <- SoldToParty
annotate view SalesOrderManage with {
   @Consumption.semanticObject: 'SalesOrder'
   @Consumption.semanticObjectMapping.additionalBinding: [{element: 'Customer', localElement: 'SoldToParty'}]
   Customer
}
```

LANGUAGE: CDS (CAP)
CODE:
```cds
// CAP CDS: SemanticObject + SemanticObjectMapping
entity SalesOrderManage @(Common : {
    SemanticObject : 'SalesOrder',
    SemanticObjectMapping : [{
        LocalProperty : SoldToParty,
        SemanticObjectProperty : 'Customer'
    }]
}) {
    key SoldToParty : String;
    Customer : String;
}
```

STEP: 6 — Add additionalSemanticObjects in manifest (V4) with mapping and unavailableActions / allowedActions
DESCRIPTION: Use additionalSemanticObjects in the ObjectPage manifest settings to provide extra semantic objects (links) for the Related Apps menu. For each additional semantic object you can:
- provide mapping: map local source keys to target names
- provide unavailableActions: list of actions to exclude for that semantic object
- provide allowedActions: exact list of actions to show (when provided, unavailableActions is ignored)
Behavior rules:
- If allowedActions is enabled for a semantic object, unavailableActions is ignored.
- If allowedActions is an empty list, no links for that semantic object are shown.
LANGUAGE: JSON
CODE:
```json
// manifest.json: additionalSemanticObjects example (inside the ObjectPage component options.settings)
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "contextPath": "/SalesOrderManage",
      "showRelatedApps": true,
      "additionalSemanticObjects": {
        "ProductCollection": {
          "unavailableActions": ["displayFactSheet", "reorderProduct"],
          "mapping": {
            "SoldToParty": "Client"
          }
        },
        "Customer": {
          "unavailableActions": ["manage"],
          "mapping": {
            "SoldToParty": "Customer"
          }
        },
        "SalesOrder": {
          "allowedActions": ["create", "managev2"]
        },
        "ProductCollectionLimited": {
          "allowedActions": ["displayFactSheet"],
          "mapping": {
            "SoldToParty": "Client"
          }
        }
      }
    }
  }
}
```

STEP: 7 — Short reference / quick rules
DESCRIPTION: Quick operational rules to follow when implementing:
- Always set showRelatedApps: true to display the Related Apps button.
- Use relatedAppsSettings (V2) or additionalSemanticObjects (V4) to add additional semantic objects/links.
- Use Common.SemanticObjectUnavailableActions annotation to hide actions globally for that semantic object in this app.
- Use manifest.allowedActions to explicitly whitelist actions; this disables unavailableActions for that semantic object.
- Use Common.SemanticObjectMapping annotations to map source fields to target semantic object properties for default links.
- For additionalSemanticObjects, define mapping in the manifest mapping key (not via SemanticObjectMapping annotation).
--------------------------------

**TITLE**: Enable or Disable the Search Field in Fiori Elements List Report (OData V2 & V4)

**INTRODUCTION**: Practical, code-first instructions to enable the List Report Search field for OData V2 services and to disable or control search behavior for OData V4 services (XML annotations, ABAP CDS and CAP CDS). Includes the metadata change for OData V2, SearchRestrictions annotation for OData V4, and notes on limits and table-type behavior.

**TAGS**: fiori-elements-framework, odata-v2, odata-v4, annotations, metadata, cds, abap, cap, list-report, search

**STEP**: 1 — Enable Search in OData V2 (service metadata)
**DESCRIPTION**: Set sap:searchable="true" on the root EntitySet in the OData V2 service metadata (EDMX) to enable the List Report Search field. This is done in the service metadata XML (usually the service $metadata or metadata file for the service).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Add or modify the EntitySet element for the root entity set in the service metadata (EDMX) -->
<EntitySet Name="SEPMRA_C_PD_Product"
           EntityType="SEPMRA_PROD_MAN.SEPMRA_C_PD_ProductType"
           sap:searchable="true"
           sap:content-version="1" />
```

**STEP**: 2 — Behavior note: search input limit
**DESCRIPTION**: The List Report search field input is restricted to 1000 characters. Enforce validation on client or server if you rely on different limits.
**LANGUAGE**: PlainText
**CODE**:
```text
Search input limit: 1000 characters (List Report)
```

**STEP**: 3 — OData V4: Search field default and how to disable
**DESCRIPTION**: For OData V4, the Search field is enabled by default in Fiori Elements. To disable search for an entity, add a SearchRestrictions annotation with Searchable set to false. The following XML annotation targets an entity named SalesOrder (example). Place this annotation in your service annotations file.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Disable search for SalesOrder in OData V4 service annotations -->
<Annotations Target="SAP__self.Container/SalesOrder">
   <Annotation Term="SAP__capabilities.SearchRestrictions">
      <Record>
         <PropertyValue Property="Searchable" Bool="false" />
      </Record>
   </Annotation>
</Annotations>
```

**STEP**: 4 — OData V4: Disable search via ABAP CDS annotation
**DESCRIPTION**: In ABAP CDS views, annotate the view to mark it as not searchable. Use this when the backend CDS should prevent the Search field for the entity/view.
**LANGUAGE**: CDS
**CODE**:
```abap
@Search.searchable: false
annotate view ZC_SalesOrder with { };
```

**STEP**: 5 — OData V4: Disable search via CAP CDS annotation
**DESCRIPTION**: In CAP (Node.js) CDS models, use the @Capabilities.SearchRestrictions annotation to disable search on an entity.
**LANGUAGE**: CDS
**CODE**:
```cds
annotate SalesOrder with @Capabilities: { SearchRestrictions: { Searchable: false } };
```

**STEP**: 6 — Analytical tables and table type considerations
**DESCRIPTION**: Search behavior for analytical tables can differ. If you need to enable/disable the search field when using analytical table types, consult the table-type configuration guidance (Setting the Table Type).
**LANGUAGE**: PlainText
**CODE**:
```text
See: Setting the Table Type (setting-the-table-type-7f844f1.md) for Search behavior on analytical tables.
```

**STEP**: 7 — Related configuration: filter bar customization
**DESCRIPTION**: For additional adjustments to how search integrates with filters, adapt the FilterBar configuration in the List Report. See the Adapting the Filter Bar documentation.
**LANGUAGE**: PlainText
**CODE**:
```text
See: Adapting the Filter Bar (adapting-the-filter-bar-609c39a.md)
```
--------------------------------

**TITLE**: Enabling File Upload for SAP Fiori elements Table (OData V4)

**INTRODUCTION**: Enable built-in upload/download/delete functionality for table rows that represent binary streams (Edm.Stream). This guide lists actionable prerequisites, required annotations, security checks, and configuration points to expose upload in edit mode for SAP Fiori elements (OData V4).

**TAGS**: fiori-elements-framework, upload, file-upload, OData V4, Edm.Stream, UI.LineItem, UI.MediaResource, manifest.json, security

**STEP**: 1 — Prerequisites: Entity and stream property
**DESCRIPTION**: Ensure the entity type includes an Edm.Stream property used for storing uploaded file content and a key property. The client-side table must reference that stream in UI metadata. Implement an Edm.Stream property in your service metadata (EDMX / OData model).
**LANGUAGE**: XML (EDMX)
**CODE**:
```xml
<!-- Minimal OData V4 entity type with an Edm.Stream property -->
<EntityType Name="Document">
  <Key>
    <PropertyRef Name="ID"/>
  </Key>
  <Property Name="ID" Type="Edm.String" Nullable="false"/>
  <!-- Property of type Edm.Stream used to store the uploaded file -->
  <Property Name="file" Type="Edm.Stream"/>
</EntityType>
```

**STEP**: 2 — Required UI annotations: reference stream in LineItem and MediaResource
**DESCRIPTION**: Add UI annotations so the table shows the stream-based column and the media resource mapping. The UI.LineItem must reference the Edm.Stream property. The UI.MediaResource annotation must reference the same stream via its Stream property.
**LANGUAGE**: XML (Annotations)
**CODE**:
```xml
<Annotations Target="Namespace.Document">
    <Annotation Term="UI.LineItem">
        <Collection>
            <Record Type="UI.DataField">
                <PropertyValue Property="Value" Path="file"/>
                <PropertyValue Property="Label" String="File"/>
            </Record>
        </Collection>
    </Annotation>
    <Annotation Term="UI.MediaResource">
        <Record Type="UI.MediaResourceType">
            <PropertyValue Property="Stream" Path="file"/>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 3 — ABAP CDS note
**DESCRIPTION**: If you use ABAP CDS, no sample is provided here. Use local XML annotations mapped to the service metadata to enable upload behavior.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
/* No ABAP CDS annotation sample is available.
   Use local XML annotation (see step 2) attached to the OData service metadata. */
```

**STEP**: 4 — CAP (Cloud Application Programming) note
**DESCRIPTION**: For CAP-based services, implement attachments using the Attachments plug-in. This plug-in enables Edm.Stream handling and necessary service-side behavior. Refer to the CAP Attachments plugin documentation for setup.
**LANGUAGE**: TEXT
**CODE**:
```text
Use the CAP Attachments plug-in: https://cap.cloud.sap/docs/plugins/#attachments
Follow the plugin instructions to expose attachments (stream) support for your entity.
```

**STEP**: 5 — Add additional columns and actions in the table
**DESCRIPTION**: To show more columns or additional actions (e.g. custom upload-related actions), either extend UI.LineItem annotations or place custom columns/actions in the app descriptor (manifest.json) per standard Fiori elements "Defining Line Items" guidance.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "note": "Add custom columns or actions via UI.LineItem annotations or the manifest.json as described in Defining Line Items and Adding Actions to Tables documentation."
}
```

**STEP**: 6 — Control Upload button visibility and enablement
**DESCRIPTION**: The Upload button semantics are equivalent to the Create action (upload creates a new instance). Control its visibility/enablement the same way you control the Create button—via annotations and action visibility expressions (see Adding Actions to Tables). Ensure upload is only available in edit mode.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "note": "Control upload button visibility/enablement using the same annotation-based patterns as Create actions (refer to Adding Actions to Tables)."
}
```

**STEP**: 7 — Security and server-side requirements
**DESCRIPTION**: Implement the following security measures on the back end before enabling uploads:
- Define Core.AcceptableMediaTypes to restrict MIME types accepted.
- Ensure a virus scan or other malware protection is executed by the back end.
- Enforce maximum file size limits and MIME-type restrictions server-side.
- Implement file validation and data sanitization in your back-end service.
Refer to Security Configuration and Enabling Stream Support for details.
**LANGUAGE**: XML (Annotation example)
**CODE**:
```xml
<!-- Example: restrict acceptable media types for the stream property -->
<Annotations Target="Namespace.Document/file">
  <Annotation Term="Core.AcceptableMediaTypes" String="application/pdf,image/png"/>
</Annotations>

<!-- Note: enforce file size limits and virus scanning in the back-end implementation. -->
```

**STEP**: 8 — File type and size constraints
**DESCRIPTION**: Use the Core.AcceptableMediaTypes annotation to declare allowed MIME types. Use service-side enforcement (and refer to the Enabling Stream Support documentation) to apply MaxLength and other constraints to uploaded streams.
**LANGUAGE**: TEXT
**CODE**:
```text
Use @Core.AcceptableMediaTypes on the stream property to define allowed MIME types.
Enforce file size limits and additional validations in the back end (see Enabling Stream Support).
```

**STEP**: 9 — Reference live example
**DESCRIPTION**: Review a working example of table file upload in the flexible programming model explorer to validate behavior and UI.
**LANGUAGE**: TEXT
**CODE**:
```text
Live example: Table - File Upload
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/tableUpload
```

--------------------------------

**TITLE**: Enabling and Disabling Variant Management on the Object Page

**INTRODUCTION**: Quick reference for enabling or disabling variant management for tables and charts on SAP Fiori elements Object Pages. Includes global component-level switches, section-specific overrides for tables/charts (OData V2), and the OData V4 manifest structure to enable Control-based variant management and table personalization.

**TAGS**: fiori-elements-framework, variant-management, object-page, manifest.json, sapui5, OData V2, OData V4, personalization

**STEP**: 1 — Overview and important rules

**DESCRIPTION**: Understand defaults and constraints before changing manifest settings:
- OData V2 (SAP Fiori elements): variant management for tables and charts is enabled by default (as of SAPUI5 1.108). Do not set "variantManagement": true to enable it.
- OData V2: you can disable variant management globally or per section (table or chart).
- OData V4: variant management is disabled by default. Enable by setting "variantManagement" = "Control" (or disable with "None").
- Personalization is independent of variant management. Variant management requires personalization to be enabled for a table.
- Do not change variant management settings after production delivery — users may lose personalization.

**LANGUAGE**: Plain text

**CODE**:
```
Defaults and constraints:
- OData V2: variant management enabled by default (SAPUI5 >= 1.108). Do not set "variantManagement": true.
- OData V4: variant management disabled by default. Use "Control" to enable, "None" to disable.
- Personalization must be enabled for variant management to work.
- Avoid changing variant management after delivery (loss of user personalization).
```

**STEP**: 2 — Disable variant management globally for all tables and charts on Object Page (OData V2)

**DESCRIPTION**: Add these settings to the component section of manifest.json to disable variant management for all tables and charts on the object page.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "component": {
    "name": "sap.suite.ui.generic.template.ObjectPage",
    "settings": {
      "tableSettings": {
        "variantManagement": false
      },
      "chartSettings": {
        "variantManagement": false
      }
    }
  }
}
```

**STEP**: 3 — Disable variant management for a specific table on the Object Page (OData V2)

**DESCRIPTION**: Use a section-level switch in the component settings to disable variant management for a specific LineItem table. Replace the section key with your section identifier.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "component": {
    "name": "sap.suite.ui.generic.template.ObjectPage",
    "settings": {
      "sections": {
        "to_ProductText::com.sap.vocabularies.UI.v1.LineItem ": {
          "tableSettings": {
            "variantManagement": false
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Disable variant management for a specific chart on the Object Page (OData V2)

**DESCRIPTION**: Use a section-level switch in the component settings to disable variant management for a specific Chart. Replace the section key with your chart section identifier.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "component": {
    "name": "sap.suite.ui.generic.template.ObjectPage",
    "settings": {
      "sections": {
        "to_ProductSalesData::com.sap.vocabularies.UI.v1.Chart ": {
          "chartSettings": {
            "variantManagement": false
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Enable variant management on the Object Page (OData V4)

**DESCRIPTION**: In OData V4, enable Control-based variant management at the object page by setting variantManagement to "Control". Use controlConfiguration to set table-level personalization options (column, sort, etc.). Place this under the page entry in the manifest (e.g., sap.ui.generic.app pages or the page id entry used by your app).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "options": {
      "settings": {
        "variantManagement": "Control",
        "controlConfiguration": {
          "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "personalization": {
                "column": true,
                "sort": false
              }
            }
          },
          "_Partner/@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "personalization": {
                "column": true,
                "sort": false
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — Disable variant management on the Object Page (OData V4)

**DESCRIPTION**: Set variantManagement to "None" in the page settings to disable variant management for the page.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "options": {
      "settings": {
        "variantManagement": "None"
      }
    }
  }
}
```

**STEP**: 7 — Table-level personalization vs variant management (OData V4)

**DESCRIPTION**: Personalization options are configured per table and are independent from variant management. Variant management requires personalization to be enabled. Example shows enabling column personalization but disabling sort personalization.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "options": {
      "settings": {
        "variantManagement": "Control",
        "controlConfiguration": {
          "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "personalization": {
                "column": true,
                "sort": false
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 8 — Notes and best practices

**DESCRIPTION**: Important operational notes to follow when changing variant management settings.

**LANGUAGE**: Plain text

**CODE**:
```
- Do not set "variantManagement": true to enable variant management in OData V2 if using SAPUI5 >= 1.108 (it is enabled by default).
- If variant management was enabled before SAPUI5 1.108, you can keep the existing settings.
- Variant management requires table personalization to be enabled; you cannot enable variant management if personalization is turned off for that table.
- Avoid changing variantManagement settings after application delivery — changes can cause end users to lose their saved personalization/variants.
- For section keys, use the exact section identifier from your metadata/manifest (e.g., "to_ProductText::com.sap.vocabularies.UI.v1.LineItem ").
```
--------------------------------

**TITLE**: Enhance ValueList Annotations with PresentationVariantQualifier for Visual Filters

**INTRODUCTION**: Add a PresentationVariantQualifier to ValueList annotations so Fiori Elements visual filters (charts) render for filter fields. The qualifier must reference a UI.PresentationVariant (on the value-help entity) that contains a UI.Chart. This guide shows XML, ABAP CDS, and CAP CDS examples and explains selection/propagation behavior for visual filters.

**TAGS**: fiori-elements-framework, ValueList, PresentationVariantQualifier, visual-filter, UI.PresentationVariant, UI.Chart, CDS, CAP, ABAP

STEP: Add PresentationVariantQualifier to XML ValueList Annotation

DESCRIPTION: Edit the ValueList annotation record for the filter property and add PropertyValue PresentationVariantQualifier with the qualifier string of the UI.PresentationVariant that defines the UI.Chart. The PresentationVariantQualifier must point to a UI.PresentationVariant defined on the value-help entity (CollectionPath), not the main entity.

LANGUAGE: XML

CODE:
```xml
<Annotations Target="Z0020_CDS.Z0020Type/CountryID">
  <Annotation Term="Common.ValueList" Qualifier="0020_Country">
    <Record>
      <PropertyValue Property="Label" String="Country"/>
      <PropertyValue Property="CollectionPath" String="Z0022"/>
      <PropertyValue Bool="false" Property="SearchSupported"/>
      <PropertyValue Property="Parameters">
        <Collection>
          <Record Type="Common.ValueListParameterOut">
            <PropertyValue Property="LocalDataProperty" PropertyPath="CountryID"/>
            <PropertyValue Property="ValueListProperty" String="CountryIdentifier"/>
          </Record>
          <Record Type="Common.ValueListParameterIn">
            <PropertyValue Property="LocalDataProperty" PropertyPath="RegionID"/>
            <PropertyValue Property="ValueListProperty" String="RegionIdentifier"/>
          </Record>
        </Collection>
      </PropertyValue>
      <!-- Point to UI.PresentationVariant qualifier located on value help entity Z0022 -->
      <PropertyValue Property="PresentationVariantQualifier" String="Country_Chart"/>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Add PresentationVariantQualifier in ABAP CDS value help definition

DESCRIPTION: In ABAP CDS, add presentationVariantQualifier in the @Consumption.valueHelpDefinition entry for the element. Note: ABAP CDS does not model separate ValueListParameterIn / Out — use the InOut equivalent if needed. The presentationVariantQualifier value must match a UI.PresentationVariant qualifier defined on the value-help entity (entity Z0022 below).

LANGUAGE: ABAP CDS

CODE:
```abap
@Consumption.valueHelpDefinition: [{
  entity = {
    name    = 'Z0022',           // CollectionPath (value help entity)
    element = 'CountryIdentifier'// ValueListProperty used for display/filter
  },
  label  = 'Country',            // ValueList label
  qualifier = '0020_Country',    // ValueList qualifier
  presentationVariantQualifier = 'Country_Chart' // UI.PresentationVariant qualifier on value help entity
}]
CountryID
```

STEP: Add PresentationVariantQualifier in CAP CDS

DESCRIPTION: For CAP CDS annotations, declare a ValueList qualifier with PresentationVariantQualifier on the field. Ensure CollectionPath targets the value help entity (Z0022) and PresentationVariantQualifier matches the UI.PresentationVariant qualifier on that value help entity. Correctly type Parameters entries using Common.ValueListParameterOut / In.

LANGUAGE: CAP CDS

CODE:
```cap
// Field annotation example inside a CDS entity definition
entity MainEntity {
  CountryID  : String @(Common.ValueList#0020_Country: {
    Label: 'Country',
    CollectionPath: 'Z0022',
    SearchSupported: false,
    Parameters: [
      {
        $Type: 'Common.ValueListParameterOut',
        LocalDataProperty: CountryID,
        ValueListProperty: 'CountryIdentifier'
      },
      {
        $Type: 'Common.ValueListParameterIn',
        LocalDataProperty: RegionID,
        ValueListProperty: 'RegionIdentifier'
      }
    ],
    PresentationVariantQualifier: 'Country_Chart'
  });
}
```

STEP: Visual Filter Selection Behavior (Scenarios)

DESCRIPTION: Understand how selections propagate between visual filters and the main entity set based on ValueList parameter mappings.

LANGUAGE: Text

CODE:
```
Given visual filters:
- RegionID -> value help entity Z0021 (bar = RegionCode)
- CountryID -> value help entity Z0022 (bar = CountryIdentifier)
- PlantID   -> value help entity Z0023 (bar = PlantNumber)

Scenario 1: Select a Region bar
- The RegionID value (RegionCode from Z0021) is passed to the main entity filter query.
- ALP refreshes main content and visual filters whose ValueList annotations have RegionID as an IN parameter (e.g., CountryID and PlantID).
- Country and Plant charts refresh to show top 3 values for the selected region.

Scenario 2: Select Region bar, then select Country bar
- CountryID (CountryIdentifier from Z0022) is passed to the main entity filter query.
- ALP refreshes main content and visual filters that depend on CountryID as IN parameter (e.g., PlantID).
- Plant chart shows top 3 plants filtered by selected region and country.

Scenario 3: Select Plant bar
- PlantID is an IN parameter only for RegionID.
- Selecting a plant refreshes the main content and Region chart (top 3 regions for chosen plant).
- Country chart is not refreshed if CountryID is not dependent on PlantID.
```

STEP: Important Notes and Best Practices

DESCRIPTION: Keep these rules in mind when implementing PresentationVariantQualifier and ValueList mappings.

LANGUAGE: Text

CODE:
```
- PresentationVariantQualifier applies to the value-help entity referenced by CollectionPath (not the main entity). The qualifier must match a UI.PresentationVariant that contains a UI.Chart on that value-help entity.

- In ABAP CDS, you cannot model separate Common.ValueListParameterIn and Common.ValueListParameterOut; use the equivalent InOut modeling where required.

- For OData V4 (Fiori elements), ensure CollectionPath points to the result entity set (see Configuring Filter Bars -> Supporting Parameterized Entities): configuring-filter-bars-4bd7590.md#loio4bd7590569c74c61a0124c6e370030f6__suppprting_parameterized_entities_subsection

- If a field has a ValueList annotation, any IN mapping defined elsewhere for that same field is ignored for visual filter value propagation. The ignored mapping still affects the main filter query and appears in the visual filter "Selected" button.

- Mandatory filter values are automatically passed to visual filter queries only when the value-help entity of the visual filter is the same as the main entity. Otherwise, explicitly define IN mappings in the ValueList Parameters to pass required values.

- If the IN mapping points to a field in the value-help entity marked with UI.Hidden, ALP ignores the incoming value for the visual filter (the hidden target field will block propagation).
```

STEP: References

DESCRIPTION: Related documentation links for implementing and configuring visual filters and filter modes.

LANGUAGE: Text

CODE:
```
- Configuring the Visual Filter Bar: configuring-the-visual-filter-bar-33f3d80.md
- Choosing Filter Modes: choosing-filter-modes-00c19e1.md
- Supporting Parameterized Entities (Filter Bars): configuring-filter-bars-4bd7590.md#loio4bd7590569c74c61a0124c6e370030f6__suppprting_parameterized_entities_subsection
```
--------------------------------

**TITLE**: Event-Driven Side Effects for SAP Fiori elements (OData V4)

**INTRODUCTION**: Provide server-triggered side effects in SAP Fiori elements (OData V4). The server sends a WebSocket message containing an event name and an entity key; the client checks whether the corresponding entity is visible and then fetches/refreshes the required properties or entities. Use annotations to declare source events, target properties/entities, and WebSocket connection metadata; use manifest.json to control user interaction behavior on refresh.

**TAGS**: fiori-elements, odata-v4, side-effects, websocket, annotations, manifest.json

**STEP**: 1 — Annotate an entity type with a side effect event (SourceEvents → TargetProperties)

**DESCRIPTION**: Add a SideEffects annotation on the EntityType to declare the event name(s) the server can send and the target property names to refresh when the event is received. Use PropertyValue "SourceEvents" (Collection of String event names) and "TargetProperties" (Collection of String property names).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: annotations.xml (or your CDS/annotation XML file) -->
<Annotations Target="MyService.MyEntityType"> 
     <Annotation Term="com.sap.vocabularies.UI.v1.SideEffects"> 
          <Record Type="SAP__common.SideEffectsType"> 
               <PropertyValue Property="SourceEvents"> 
                    <Collection> 
                         <String>MyEventName</String> 
                    </Collection> 
               </PropertyValue> 
               <PropertyValue Property="TargetProperties"> 
                    <Collection> 
                         <String>Property1</String> 
                         <String>Property2</String> 
                    </Collection> 
               </PropertyValue> 
          </Record> 
     </Annotation> 
</Annotations>
```

**STEP**: 2 — Refresh an entire list/table via TargetEntities (absolute path)

**DESCRIPTION**: To refresh a whole table (for example in a List Report), set "TargetEntities" with an absolute NavigationPropertyPath to the entity set or collection. Use an absolute path beginning with "/" and specify the service container and entity set.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="MyService.MyEntityType">
    <Annotation Term="com.sap.vocabularies.UI.v1.SideEffects">
        <Record Type="Common.SideEffectsType">
            <PropertyValue Property="SourceEvents">
                <Collection>
                        <String>MyEventName</String>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetEntities">
                <Collection>
                    <!-- Absolute path to the entity set to be refreshed -->
                    <NavigationPropertyPath>/MyService.EntityContainer/MyEntity</NavigationPropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 3 — Configure WebSocket connection via annotations (WebSocketBaseURL, WebSocketChannel)

**DESCRIPTION**: Provide the WebSocket endpoint and channel used by the application server to push side-effect events. Add WebSocketBaseURL on the service container (SAP__self.Container) and WebSocketChannel with a qualifier (channel identifier).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="SAP__self.Container"> 
     <!-- Base WebSocket endpoint (can be a relative or absolute URL) -->
     <Annotation Term="SAP__common.WebSocketBaseURL" String="testEndpoint" /> 
     <!-- Channel qualifier + channel string used by server to send events -->
     <Annotation Term="SAP__common.WebSocketChannel" Qualifier="sideEffects" String="cinema" /> 
</Annotations>
```

**STEP**: 4 — Set default interaction type for side effect events in manifest.json

**DESCRIPTION**: Configure how the UI behaves when side effects trigger data refresh. Use "sideEffectsEventsInteractionType" under "sap.fe.app". Valid values: "Notification" (default, auto-refresh + notification), "Confirmation" (show confirmation dialog), "None" (auto-refresh no UI).

**LANGUAGE**: JSON

**CODE**:
```json
{
     "sap.fe": {
          "app": {
               "sideEffectsEventsInteractionType": "Confirmation"
          }
     }
}
```

**STEP**: 5 — Define per-event interaction behavior in manifest.json (default + per-event mapping)

**DESCRIPTION**: Provide a mapping that sets a default interaction type and overrides for specific event names. Events not listed use the "default" setting.

**LANGUAGE**: JSON

**CODE**:
```json
{
    "sap.fe": {
        "app": {
            "sideEffectsEventsInteractionType": {
                "default": "None",
                "events": {
                    "myEventName": "Confirmation",
                    "myOtherEventName": "Notification"
                }
            }
        }
    }
}
```
--------------------------------

**TITLE**: Adding Custom Columns to a Grid Table in a Fiori Elements List Report (OData V2)

**INTRODUCTION**: This document shows the exact files and code snippets to add custom columns to a Grid Table in a Fiori elements List Report (OData V2). It covers: (1) creating an XML fragment with Column definitions and p13nData customData (including leadingProperty and columnIndex), and (2) registering the fragment(s) in manifest.json. Use only the extensionAPI and avoid manipulating internal framework objects.

**TAGS**: fiori-elements-framework, list-report, grid-table, extension, fragment, manifest.json, OData V2, QuickVariantSelectionX

**STEP**: 1 — Create the view fragment for Grid Table columns

**DESCRIPTION**: Add an XML fragment that defines one or more sap.ui.table.Column elements. Put this fragment under webapp/ext/fragments/. For columns that bind to a property (e.g., Price) include "leadingProperty" in the p13nData customData. Use "columnIndex" to control the position (lower numbers appear earlier). Example file path: webapp/ext/fragments/ListReportGridTableColumns.fragment.xml

**LANGUAGE**: XML

**CODE**:
```XML
<!-- File: webapp/ext/fragments/ListReportGridTableColumns.fragment.xml -->
<core:FragmentDefinition
    xmlns:core="sap.ui.core"
    xmlns:table="sap.ui.table"
    xmlns="sap.m">

    <!-- Rating column with leadingProperty and custom columnIndex -->
    <table:Column>
        <Label text="Rating" />
        <table:customData>
            <!-- p13nData must be a JSON-string. Include leadingProperty if template binds to a property (e.g., Price). -->
            <core:CustomData key="p13nData"
                value='{"columnKey":"Rating","leadingProperty":"Price","columnIndex":"100"}' />
        </table:customData>
        <table:template>
            <!-- Example using expression binding to Price -->
            <RatingIndicator value="{= ${Price} > 500 ? 1 : 5 }" />
        </table:template>
    </table:Column>

    <!-- Test column without leadingProperty -->
    <table:Column>
        <Label text="Test" />
        <table:customData>
            <core:CustomData key="p13nData"
                value='{"columnKey":"Test","columnIndex":"101"}' />
        </table:customData>
        <table:template>
            <!-- Example text using i18n binding -->
            <Text text="{i18n>xfld.BreakoutColumnContent}" />
        </table:template>
    </table:Column>

</core:FragmentDefinition>
```

**STEP**: 2 — Register the fragment in manifest.json (single view / no QuickVariantSelectionX tabs)

**DESCRIPTION**: Register your fragment under the List Report view using the "sap.ui.viewExtensions" extension point. Use the extension key format GridTableColumnsExtension|<EntitySet>. The fragmentName must reference the fragment module (namespace + path without the .fragment.xml extension). Example shows a component extending sap.suite.ui.generic.template.ListReport.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ui5": {
    "extends": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "minVersion": "1.1.0",
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "GridTableColumnsExtension|STTA_C_MP_Product": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "STTA_MP.ext.fragments.ListReportGridTableColumns",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Register fragments per tab when using QuickVariantSelectionX (multiple table mode)

**DESCRIPTION**: When QuickVariantSelectionX is used, register a separate fragment per tab using the extension key GridTableColumnsExtension|<EntitySet>|<tabKey>. Use the tabKey that you defined in QuickVariantSelectionX. If you omit the tabKey (legacy compatibility), the feature still works but stable IDs for columns/cells cannot be guaranteed.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ui5": {
    "extends": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "minVersion": "1.1.0",
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "GridTableColumnsExtension|STTA_C_MP_Product|Expensive": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "STTA_MP.ext.fragments.ListReportGridTableColumnsExpensive",
              "type": "XML"
            },
            "GridTableColumnsExtension|STTA_C_MP_Product|Cheap": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "STTA_MP.ext.fragments.ListReportGridTableColumnsCheap",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Important notes and constraints

**DESCRIPTION**: Follow these rules when implementing:
- Applicable only for SAP Fiori elements for OData V2.
- Use app extensions sparingly; prefer manifest settings or annotations when possible.
- Integrate only via the official extensionAPI. Do not access or manipulate internal controls, properties, models, or other framework internals.
- If a column template binds to a property (e.g., {Price}), include "leadingProperty" in the CustomData p13nData JSON so personalization and sorting/filtering can work correctly.
- Set "columnIndex" in p13nData to control insertion order. Lower numeric values appear earlier.
--------------------------------

**TITLE**: Add Custom Columns to a Grid Table in the Object Page (Fiori elements, OData V2)

**INTRODUCTION**: This guide shows how to add custom columns to a Grid Table in the Object Page of an SAP Fiori elements app (OData V2). You will create an XML fragment that defines the columns, register the fragment as a view extension in manifest.json, and add a controller extension to handle column events (for example, a button press). Use the SAP Fiori elements extensionAPI and avoid manipulating internal framework objects.

**TAGS**: fiori-elements, odata-v2, grid-table, object-page, extensions, fragments, manifest, xml, json, javascript

**STEP**: Prerequisites and Warnings

**DESCRIPTION**: Requirements, scope and extension guidelines: this procedure is only applicable to SAP Fiori elements for OData V2. Use app extensions only when manifest settings or annotations cannot achieve the required behavior. Use only the extensionAPI provided by SAP Fiori elements. Do not access or manipulate internal controls, properties, models, or other objects created by the framework.

**LANGUAGE**: Text

**CODE**:
```Text
- Applicable: SAP Fiori elements (OData V2) only.
- Use only extensionAPI functions. Do not manipulate internal controls or models created by the framework.
- Place fragment and controller files under your app's extension folder (recommended path: webapp/ext/...).
```

**STEP**: Create the fragment that defines custom Grid Table columns

**DESCRIPTION**: Create an XML fragment file that defines additional columns (one text column and one column with a button). Place the fragment under webapp/ext/fragments/ProductTextGridTableColumns.fragment.xml. Use the fragment name you will reference in the manifest.

**LANGUAGE**: XML

**CODE**:
```XML
<!-- File: webapp/ext/fragments/ProductTextGridTableColumns.fragment.xml -->
<core:FragmentDefinition
    xmlns:core="sap.ui.core"
    xmlns:table="sap.ui.table"
    xmlns="sap.m"
    xmlns:sfi="sap.ui.comp.smartfield">
   <table:Column width="150px">
      <Label text="{i18n>STTA_C_MP_Product>xfld.BreakoutColumn}" />
      <table:template>
         <Text text="{i18n>STTA_C_MP_Product>xfld.BreakoutColumnContent}" />
      </table:template>
   </table:Column>
   <table:Column width="160px">
      <Label text="{i18n>STTA_C_MP_Product>xfld.BreakoutColumn}" />
      <table:template>
         <Button text="GridTab.Button"
                 press="onGridTableBreakoutButtonPress" />
      </table:template>
   </table:Column>
</core:FragmentDefinition>
```

**STEP**: Register the fragment and controller extension in manifest.json

**DESCRIPTION**: Add entries under "extends" -> "extensions" in your application's manifest.json to register the view extension (fragment) and the controller extension. Replace the fragmentName and controllerName with your actual namespace if different. The view extension key uses the GridTableColumnsExtension naming convention combined with the entity/table path used by your app.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "controllerName": "STTA_MP.ext.controllerExtensions.ProductText"
        }
      },
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "GridTableColumnsExtension|STTA_C_MP_ProductText|to_ProductTextNavigation::com.sap.vocabularies.UI.v1.LineItem": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ProductTextGridTableColumns",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**STEP**: Implement the controller extension to handle events from the fragment

**DESCRIPTION**: Implement the press handler referenced in the fragment (onGridTableBreakoutButtonPress). Place controller code under webapp/ext/controllerExtensions/ProductText.controller.js (controllerName must match the manifest entry). Use only public APIs and extensionAPI where needed. Example shows a safe handler that reads the binding context and displays a MessageToast.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// File: webapp/ext/controllerExtensions/ProductText.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/m/MessageToast"
], function(Controller, MessageToast) {
  "use strict";

  return Controller.extend("STTA_MP.ext.controllerExtensions.ProductText", {
    /**
     * Event handler for the button in the custom grid column.
     * Do not manipulate internal framework controls or models.
     */
    onGridTableBreakoutButtonPress: function(oEvent) {
      var oSource = oEvent.getSource();
      var oContext = oSource.getBindingContext();
      var sPath = oContext ? oContext.getPath() : "<no context>";
      // Use extensionAPI here if you need navigation or other framework-provided services.
      MessageToast.show("Row pressed: " + sPath);
    }
  });
});
```

**STEP**: Verify and test

**DESCRIPTION**: Build and run the app. Navigate to the Object Page details view and open the grid table. Confirm the new columns appear and the button press triggers the controller handler. If the columns do not show, verify:
- fragmentName and controllerName in manifest.json match the files and namespaces,
- the view extension key matches the Object Page view and table (GridTableColumnsExtension|... entry),
- the app uses OData V2 (this approach is applicable for OData V2 only).
**LANGUAGE**: Text

**CODE**:
```Text
- Build and deploy the app.
- Open the Object Page and locate the Grid Table (LineItem).
- Confirm custom columns are visible and that the button press triggers your handler.
- If behavior is inconsistent, check console logs and manifest mappings.
```
--------------------------------

**TITLE**: Add Custom Columns to a Responsive Table in a List Report (Fiori Elements)

**INTRODUCTION**: This guide shows how to add custom columns to a responsive table in a Fiori Elements List Report by implementing two view extension fragments (column definitions and cell content) and registering them in the app manifest. Use these steps when manifest settings or annotations cannot produce the required column behavior. Follow the extensionAPI guidance and avoid manipulating internal framework controls or models.

**TAGS**: fiori-elements-framework, sapui5, extension, list-report, responsive-table, fragments, manifest, quickvariantselectionx

**STEP**: 1 — Create fragment: Column definitions (ListReportResponsiveTableColumns.fragment.xml)

**DESCRIPTION**: Define the custom Column elements that will be injected into the responsive table. Put this fragment in webapp/ext/fragments/ListReportResponsiveTableColumns.fragment.xml. Use core:CustomData with key "p13nData" and include columnKey, columnIndex for ordering, and leadingProperty when the cell content binds to an entity property (e.g., {Price}). columnIndex controls the column sequence.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/fragments/ListReportResponsiveTableColumns.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core"
       xmlns="sap.m">
       <Column>
              <Text text="{i18n|sap.suite.ui.generic.template.ListReport|STTA_C_MP_Product>xfld.Rating}" />
              <customData>
                     <core:CustomData key="p13nData"
                            value='{"columnKey": "Rating", "leadingProperty":"Price", "columnIndex" : "100"}' />
              </customData>
       </Column>
       <Column>
              <Text text="{i18n|sap.suite.ui.generic.template.ListReport|STTA_C_MP_Product>xfld.BreakoutColumn}" />
              <customData>
                     <core:CustomData key="p13nData"
                            value='{"columnKey": "Test", "columnIndex" : "101"}' />
              </customData>
       </Column>
</core:FragmentDefinition>
```

**STEP**: 2 — Create fragment: Cell content (ListReportResponsiveTableCells.fragment.xml)

**DESCRIPTION**: Define the cell controls that correspond to the columns defined in step 1. Put this fragment in webapp/ext/fragments/ListReportResponsiveTableCells.fragment.xml. Bind values to entity properties as needed. If the cell binds to a property used in column definition, ensure the column's p13nData includes a matching "leadingProperty".

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/fragments/ListReportResponsiveTableCells.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
       <RatingIndicator value="{= ${Price} > 500 ? 1 : 5 }"></RatingIndicator>
       <Text text="{i18n|sap.suite.ui.generic.template.ListReport|STTA_C_MP_Product>xfld.BreakoutColumnContent}"></Text>
</core:FragmentDefinition>
```

**STEP**: 3 — Register view extensions in manifest.json (basic single-view registration)

**DESCRIPTION**: Register the two fragments under sap.ui.viewExtensions for the ListReport view. Use the extension point names ResponsiveTableColumnsExtension|<EntitySet> and ResponsiveTableCellsExtension|<EntitySet>. Example below registers fragments for entity set STTA_C_MP_Product. Add this snippet under "extends" -> "extensions" -> "sap.ui.viewExtensions".

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "ResponsiveTableColumnsExtension|STTA_C_MP_Product": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableColumns",
            "type": "XML"
          },
          "ResponsiveTableCellsExtension|STTA_C_MP_Product": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableCells",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Register extensions per QuickVariantSelectionX tab (multiple table mode)

**DESCRIPTION**: When using QuickVariantSelectionX (multiple table views/tabs), register extensions per tab using extension point names ResponsiveTableColumnsExtension|<EntitySet>|<tabKey> and ResponsiveTableCellsExtension|<EntitySet>|<tabKey>. Replace <tabKey> with the QuickVariantSelectionX tab key. If you omit the tab key for compatibility, the feature still works but stable IDs for columns/cells cannot be provided.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "ResponsiveTableColumnsExtension|STTA_C_MP_Product|Expensive": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableColumnsExpensive",
            "type": "XML"
          },
          "ResponsiveTableCellsExtension|STTA_C_MP_Product|Expensive": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableCellsExpensive",
            "type": "XML"
          },
          "ResponsiveTableColumnsExtension|STTA_C_MP_Product|Cheap": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableColumnsCheap",
            "type": "XML"
          },
          "ResponsiveTableCellsExtension|STTA_C_MP_Product|Cheap": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableCellsCheap",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Reuse a fragment across multiple tabs (set id for uniqueness)

**DESCRIPTION**: To reuse the same fragment for multiple tabs, set the "id" property for each registration so generated control IDs remain unique. Add the "id" entry inside each extension entry.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extensions": {
    "sap.ui.viewExtensions": {
      "sap.suite.ui.generic.template.ListReport.view.ListReport": {
        "ResponsiveTableColumnsExtension|STTA_C_MP_Product|Expensive": {
          "className": "sap.ui.core.Fragment",
          "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableColumns",
          "type": "XML",
          "id": "Expensive"
        },
        "ResponsiveTableCellsExtension|STTA_C_MP_Product|Expensive": {
          "className": "sap.ui.core.Fragment",
          "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableCells",
          "type": "XML",
          "id": "Expensive"
        },
        "ResponsiveTableColumnsExtension|STTA_C_MP_Product|Cheap": {
          "className": "sap.ui.core.Fragment",
          "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableColumns",
          "type": "XML",
          "id": "Cheap"
        },
        "ResponsiveTableCellsExtension|STTA_C_MP_Product|Cheap": {
          "className": "sap.ui.core.Fragment",
          "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableCells",
          "type": "XML",
          "id": "Cheap"
        }
      }
    }
  }
}
```

Notes and constraints (keep in code context):
- Use app extensions only when manifest settings or annotations cannot achieve the required behavior.
- Integrate with Fiori elements only via the official extensionAPI; do not manipulate internal controls or models.
- If a custom cell binds to a property (e.g., {Price}), add the corresponding "leadingProperty" in the column's p13nData.
- Use "columnIndex" in p13nData to control sequence.
- Extension point names:
  - Single view: ResponsiveTableColumnsExtension|<EntitySet>, ResponsiveTableCellsExtension|<EntitySet>
  - Per-tab (QuickVariantSelectionX): ResponsiveTableColumnsExtension|<EntitySet>|<tabKey>, ResponsiveTableCellsExtension|<EntitySet>|<tabKey>
--------------------------------

**TITLE**: Add Custom Columns to a Responsive Table on the Object Page

**INTRODUCTION**: This guide shows how to add a custom column to a responsive table on the Object Page in a SAP Fiori elements application by implementing two view extension fragments and registering them in the application's manifest.json. Use app extensions only when manifest settings or annotations cannot achieve the required behavior. Always use the Fiori elements extensionAPI only; do not manipulate internal controls or models created by the framework.

**TAGS**: fiori-elements, sapui5, extension, fragment, responsive-table, object-page, manifest, xml, json, extensionAPI

**STEP**: 1 — Create the responsive table Column fragment (definition)
**DESCRIPTION**: Create an XML fragment that defines the additional Column (header label and p13nData). Save this file under webapp/ext/fragments/ProductTextResponsiveTableColumns.fragment.xml. The fragment defines a Column containing a Text control for the header and core:CustomData with p13nData (columnKey and columnIndex) so the personalization (p13n) framework recognizes the column.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: webapp/ext/fragments/ProductTextResponsiveTableColumns.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core"
       xmlns="sap.m">
       <Column>
              <Text text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumn}" />
              <customData>
                     <core:CustomData key="p13nData"
                            value='\{"columnKey": "Test", "columnIndex" : "101"}' />
              </customData>
       </Column>
</core:FragmentDefinition>
```

**STEP**: 2 — Create the responsive table Cell fragment (content)
**DESCRIPTION**: Create an XML fragment that defines the cell content for the custom column. Save this file under webapp/ext/fragments/ProductTextResponsiveTableCells.fragment.xml. Bind the cell content to the appropriate i18n or model property as required.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: webapp/ext/fragments/ProductTextResponsiveTableCells.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
       <Text text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumnContent}"></Text>
</core:FragmentDefinition>
```

**STEP**: 3 — Register the fragments in manifest.json
**DESCRIPTION**: Register both fragments as view extensions in webapp/manifest.json. Place the "extends" block inside the "sap.ui5" section of the manifest. The keys for the extensions follow the pattern expected by the framework (see "Extension Points for Tables" for naming rules). Replace the fragmentName values with your actual namespace and fragment paths if different.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "minVersion": "1.1.0",
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "ResponsiveTableColumnsExtension|STTA_C_MP_ProductText|to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "STTA_MP.ext.fragments.ProductTextResponsiveTableColumns",
              "type": "XML"
            },
            "ResponsiveTableCellsExtension|STTA_C_MP_ProductText|to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "STTA_MP.ext.fragments.ProductTextResponsiveTableCells",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Notes, best practices and references
**DESCRIPTION**: 
- Use extensions with caution: prefer manifest settings or annotations first. After adding an extension, the application is responsible for display and behavior (bindings, busy handling, etc.). Use only the Fiori elements extensionAPI.  
- Ensure i18n keys referenced in fragments exist in your i18n properties file or change the data binding to the appropriate model property.  
- For naming conventions and more details on table extension points, see "Extension Points for Tables".
--------------------------------

**TITLE**: Add custom columns to a Tree Table in a Fiori Elements List Report (OData V2)

**INTRODUCTION**: This guide shows how to add custom columns to the Tree Table of a Fiori elements List Report (OData V2) using a view fragment and registering it in the application manifest. Use app extensions only when manifest settings or annotations cannot achieve the required behavior. Integrate with SAP Fiori elements only via the extensionAPI; do not manipulate internal controls/models of the framework.

**TAGS**: fiori-elements, list-report, tree-table, extension, fragment, manifest.json, OData V2

**STEP**: 1 — Create an XML fragment for the Tree Table columns

**DESCRIPTION**: Add a fragment file that defines one or more sap.ui.table:Column entries. Place the file under webapp/ext/fragments/ListReportTreeTableColumns.fragment.xml (or a name matching your manifest fragmentName). Use core:CustomData with key "p13nData" to provide column metadata: columnKey, optional leadingProperty (if the column template binds to a data property), and columnIndex to control column order. The fragment is an XML fragment (sap.m namespace used for controls such as RatingIndicator and Text). Ensure the JSON inside value attributes is valid and enclosed in single quotes so double quotes are allowed inside.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/fragments/ListReportTreeTableColumns.fragment.xml -->
<core:FragmentDefinition
    xmlns:core="sap.ui.core"
    xmlns:table="sap.ui.table"
    xmlns="sap.m">
    <!-- Custom column 1: Rating (uses Price as leadingProperty for personalization) -->
    <table:Column>
        <Label text="Rating" />
        <table:customData>
            <core:CustomData
                key="p13nData"
                value='{"columnKey":"Rating","leadingProperty":"Price","columnIndex":"100"}' />
        </table:customData>
        <table:template>
            <RatingIndicator value="{= ${Price} > 500 ? 1 : 5 }" />
        </table:template>
    </table:Column>

    <!-- Custom column 2: Test -->
    <table:Column>
        <Label text="Test" />
        <table:customData>
            <core:CustomData
                key="p13nData"
                value='{"columnKey":"Test","columnIndex":"101"}' />
        </table:customData>
        <table:template>
            <Text text="{i18n|sap.suite.ui.generic.template.ListReport|STTA_C_MP_Product>xfld.BreakoutColumnContent}" />
        </table:template>
    </table:Column>
</core:FragmentDefinition>
```

**STEP**: 2 — Register the fragment as a view extension in manifest.json

**DESCRIPTION**: Register the fragment under "extends" → "extensions" → "sap.ui.viewExtensions" for the ListReport view. The extension point name for tree table columns is:
- Single table mode: "TreeTableColumnsExtension|<EntitySet>"
- Multiple table mode (QuickVariantSelectionX): "TreeTableColumnsExtension|<EntitySet>|<tabKey>"

If using QuickVariantSelectionX, register a fragment per tab key to allow stable IDs for columns and cells. For backward compatibility, omitting the tab key might still work, but stable IDs cannot be guaranteed.

Do not modify framework internals; extension code is responsible for display and behavior beyond what Fiori elements manages.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json snippet — single table (example)
{
  "extends": {
    "component": "sap.suite.ui.generic.template.ListReport",
    "minVersion": "1.1.0",
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "TreeTableColumnsExtension|STTA_C_MP_Product": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportTreeTableColumns",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json snippet — multiple-table mode using QuickVariantSelectionX (per-tab registration)
{
  "extends": {
    "component": "sap.suite.ui.generic.template.ListReport",
    "minVersion": "1.1.0",
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "TreeTableColumnsExtension|STTA_C_MP_Product|Expensive": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportTreeTableColumnsExpensive",
            "type": "XML"
          },
          "TreeTableColumnsExtension|STTA_C_MP_Product|Cheap": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportTreeTableColumnsCheap",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Notes and best practices

**DESCRIPTION**: 
- If a custom column template binds to a property (e.g., {Price}), include that property as "leadingProperty" inside the p13nData CustomData to enable proper personalization and behavior.
- Use columnIndex in p13nData to set column order; values are numeric strings (e.g., "100", "101").
- Keep UI logic inside the fragment; do not access Fiori elements internal controls/models. Use only supported extensionAPI functions for interactions with the framework.
--------------------------------

**TITLE**: Add Custom Columns to an Analytical Table on the Object Page (Fiori elements, OData V2)

**INTRODUCTION**: This guide shows how to add custom columns (text and action button) to an AnalyticalTable on the Object Page using a view fragment and registering it in manifest.json. Applicable only to SAP Fiori elements for OData V2. Use extensionAPI only and avoid manipulating internal framework objects directly.

**TAGS**: fiori-elements, odata-v2, analytical-table, object-page, view-extensions, manifest, fragment, sap.ui.table

**STEP**: 0 — Preconditions and Cautions

**DESCRIPTION**: Ensure your app is based on SAP Fiori elements for OData V2. Use app extensions only when manifest settings or annotations cannot achieve the behavior. Integrate extension code using the extensionAPI; do not manipulate internal framework controls, models, or properties created by SAP Fiori elements.

**LANGUAGE**: Text

**CODE**:
```text
Preconditions:
- SAP Fiori elements for OData V2
- Use extensionAPI only (see Using the extensionAPI)
- File paths referenced below are relative to your application root (e.g., webapp/)
```

**STEP**: 1 — Create XML Fragment with Custom Analytical Columns

**DESCRIPTION**: Create the fragment file webapp/ext/fragments/ProductSalesDataAnalyticalTableColumns.fragment.xml. The fragment defines two AnalyticalColumn entries: one with text content and one with a Button (press handler to be implemented in your controller extension). Each column must define p13n data via core:CustomData with a unique columnKey for personalization.

Replace i18n keys and columnKey values as required for your project.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/fragments/ProductSalesDataAnalyticalTableColumns.fragment.xml -->
<core:FragmentDefinition
    xmlns:core="sap.ui.core"
    xmlns:table="sap.ui.table"
    xmlns="sap.m"
    xmlns:sfi="sap.ui.comp.smartfield">

    <!-- Text column -->
    <table:AnalyticalColumn width="150px">
        <Label text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumn}" />
        <table:template>
            <Text text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumnContent}" />
        </table:template>
        <table:customData>
            <!-- p13nData must include a unique columnKey for personalization -->
            <core:CustomData key="p13nData" value='{"columnKey": "someUniqueKey1"}' />
        </table:customData>
    </table:AnalyticalColumn>

    <!-- Button column -->
    <table:AnalyticalColumn width="170px">
        <Label text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumn}" />
        <table:template>
            <!-- press handler is implemented in your controller extension -->
            <Button text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.AnalyticalTableButton}"
                    press="onAnalyticalTableBreakoutButtonPress" />
        </table:template>
        <table:customData>
            <core:CustomData key="p13nData" value='{"columnKey": "someUniqueKey2"}' />
        </table:customData>
    </table:AnalyticalColumn>

</core:FragmentDefinition>
```

**STEP**: 2 — Register the Fragment as a View Extension in manifest.json

**DESCRIPTION**: Register the fragment under the view extension map in webapp/manifest.json. Add an entry under "extends" -> "extensions" -> "sap.ui.viewExtensions" for the ObjectPage Details view. Use the fragmentName pointing to the created fragment module path (namespace-based). The example key uses the extension identifier for AnalyticalTableColumnsExtension for the ProductSalesData LineItem. Adjust the extension key, fragmentName, and type as needed.

If you also need a controller extension to implement the button press handler, register it under "sap.ui.controllerExtensions" in the same "extends" -> "extensions" section.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        // If you implement controller methods (e.g., onAnalyticalTableBreakoutButtonPress),
        // register your controller extension here.
        // "sap.suite.ui.generic.template.ObjectPage.view.Details": {
        //   "com.mycompany.myapp.ext.controller.DetailsExt": "my.ControllerExtension"
        // }
      },
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "AnalyticalTableColumnsExtension|STTA_C_MP_ProductSalesData|to_ProductSalesData::com.sap.vocabularies.UI.v1.LineItem": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ProductSalesDataAnalyticalTableColumns",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Implement Controller Extension (Optional)

**DESCRIPTION**: If your fragment uses event handlers (e.g., onAnalyticalTableBreakoutButtonPress), implement a controller extension file and register it as shown in Step 2 under sap.ui.controllerExtensions. Ensure the controller namespace and method name match the fragment handler.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File example: webapp/ext/controller/DetailsExt.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("STTA_MP.ext.controller.DetailsExt", {
    onAnalyticalTableBreakoutButtonPress: function (oEvent) {
      // Implement action logic here. Use extensionAPI only for framework interaction.
      var oButton = oEvent.getSource();
      // Example: get binding context or row data
      var oContext = oButton.getBindingContext();
      // Implement navigation, popover, or other behavior required.
      // ...
    }
  });
});
```
--------------------------------

**TITLE**: Adding Custom Filter Fields into an Object Page Table Toolbar (OData V2)

**INTRODUCTION**: Add custom filter controls (Select, ComboBox, DatePicker, TextField) into an object page table toolbar in SAP Fiori elements (OData V2). Use a toolbar fragment registered in the manifest, ensure controls do not overflow by setting OverflowToolbarLayoutData priority="NeverOverflow", and implement two extension points: a fragment change handler that triggers rebind and an onBeforeRebindTable extension to append filters to the table binding.

**TAGS**: fiori-elements-framework, sapui5, object-page, table-toolbar, custom-filter, odata-v2, overflowtoolbar

**STEP**: 1 — Register the toolbar fragment in manifest.json

**DESCRIPTION**: Add an object page view extension entry in manifest.json. The manifest key must follow the format: "TableToolBarExtension|<EntitySet>|<facetId>". Replace entity set and facet id with your app-specific values. The fragment can be located under ext/fragments and should be registered with className "sap.ui.core.Fragment" and type "XML".

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "TableToolBarExtension|STTA_C_MP_Product|to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.OPCustomFilter",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Create the XML fragment (OPCustomFilter.fragment.xml)

**DESCRIPTION**: Create the toolbar fragment under the path you registered (example: webapp/ext/fragments/OPCustomFilter.fragment.xml or STTA_MP/ext/fragments/OPCustomFilter.fragment.xml). Use sap.m controls and set OverflowToolbarLayoutData priority="NeverOverflow" for each control (or label) that must not be pushed into the overflow. Replace i18n keys and item keys/texts with values appropriate to your app.

**LANGUAGE**: XML

**CODE**:
```xml
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:smartfilterbar="sap.ui.comp.smartfilterbar">
  <Label text="{i18n>ST_GENERIC_LANGUAGE_FILTER}" labelFor="filterId">
    <layoutData>
      <OverflowToolbarLayoutData priority="NeverOverflow"/>
    </layoutData>
  </Label>

  <Select id="filterId" change="onCustomFilterChange">
    <items>
      <core:Item key="0" text="{i18n>ST_GENERIC_ENGLISH_LANGUAGE_FILTER}"/>
      <core:Item key="1" text="{i18n>ST_GENERIC_MANDARIN_LANGUAGE_FILTER}"/>
    </items>
    <layoutData>
      <OverflowToolbarLayoutData priority="NeverOverflow"/>
    </layoutData>
  </Select>
</core:FragmentDefinition>
```

**STEP**: 3 — Implement controller extension: trigger rebind and add filters before rebind

**DESCRIPTION**: Implement two handlers in your object page extension controller:
- onCustomFilterChange: called by the Select change event — find the SmartTable control and call rebindTable().
- onBeforeRebindTableExtension: called by the framework before table binding — inspect the selected filter key and push appropriate sap.ui.model.Filter instances into oEvent.getParameter("bindingParams").filters.

Place this controller as an extension controller (for example: STTA_MP/ext/controllers/ObjectPage.controller.js) or inside your existing object page extension controller. Replace the element IDs below with your app's global IDs (the fragment control ID may be prefixed by the view/container IDs in the running app).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: STTA_MP/ext/controllers/ObjectPage.controller.js
sap.ui.define([
  "sap/ui/core/Element",
  "sap/ui/model/Filter"
], function(Element, Filter) {
  "use strict";

  return {
    /**
     * Called from the Select control in the toolbar fragment (change event).
     * Triggers table rebind so onBeforeRebindTableExtension runs.
     */
    onCustomFilterChange: function(oEvent) {
      // Replace this ID with your SmartTable's global ID in the running app
      var sSmartTableId = "STTA_MP::sap.suite.ui.generic.template.ObjectPage.view.Details::STTA_C_MP_Product--to_ProductText::com.sap.vocabularies.UI.v1.LineItem::Table";
      var oSmartTable = Element.getElementById(sSmartTableId);
      if (oSmartTable && typeof oSmartTable.rebindTable === "function") {
        oSmartTable.rebindTable();
      }
    },

    /**
     * onBeforeRebindTableExtension hook — add custom filters to bindingParams.filters.
     * The framework calls this before the table binding is created.
     */
    onBeforeRebindTableExtension: function(oEvent) {
      var oBindingParams = oEvent.getParameter("bindingParams");
      oBindingParams.filters = oBindingParams.filters || [];
      oBindingParams.parameters = oBindingParams.parameters || {};

      // Replace this ID with your Select control's global ID in the running app
      var sFilterControlId = "STTA_MP::sap.suite.ui.generic.template.ObjectPage.view.Details::STTA_C_MP_Product--filterId";
      var oCustomFilter = Element.getElementById(sFilterControlId);
      var sKey = oCustomFilter && oCustomFilter.getSelectedKey && oCustomFilter.getSelectedKey();

      switch (sKey) {
        case "0":
          // English
          oBindingParams.filters.push(new Filter("Language", "EQ", "EN"));
          break;
        case "1":
          // Mandarin
          oBindingParams.filters.push(new Filter("Language", "EQ", "ZH"));
          break;
        default:
          // no custom filter
          break;
      }
    }
  };
});
```
--------------------------------

**TITLE**: Applying Custom Logic When an Object Page Table is Loaded or Refreshed (OData V2, Fiori Elements)

**INTRODUCTION**: Use a controller extension to run custom logic when a table on an Object Page is loaded or refreshed. This example shows how to (1) register a controller extension in manifest.json and (2) implement onBeforeRebindTableExtension in the extension controller to target a specific table by its control ID. Applicable to SAP Fiori elements for OData V2. Use only extensionAPI functions and avoid directly manipulating internal framework controls, models, or properties.

**TAGS**: fiori-elements, odata-v2, extension, manifest, controller-extension, sapui5, object-page, onBeforeRebindTableExtension

**STEP**: 1 — Register controller extension in manifest.json

**DESCRIPTION**: Edit webapp/manifest.json to add a controller extension entry under sap.ui5.extends.extensions.sap.ui.controllerExtensions. Set the target view key (for an Object Page) to the extension controller name. Keep the fully qualified controllerName (namespace + path).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "controllerName": "STTA_MP.ext.controller.DetailsExtension"
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Implement the controller extension (onBeforeRebindTableExtension)

**DESCRIPTION**: Create the extension controller file matching the controllerName above (namespace to folder mapping). Implement onBeforeRebindTableExtension(oEvent) and identify the table by its control ID (tableId). Use oEvent.getParameter("bindingParams") to inspect or modify binding parameters (filters, sorters, etc.). Keep logic scoped to the extensionAPI and do not access internal framework objects directly.

File path example: webapp/ext/controller/DetailsExtension.controller.js

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define([], function() {
    "use strict";

    return {
        /**
         * Handler called before a table rebind on the Object Page.
         * Use oEvent.getParameter("bindingParams") to adjust filters/sorters/parameters.
         */
        onBeforeRebindTableExtension: function(oEvent) {
            // Control id of the specific table you want to target
            var tableId = "STTA_MP::sap.suite.ui.generic.template.ObjectPage.view.Details::STTA_C_MP_Product--to_ProductText::com.sap.vocabularies.UI.v1.LineItem::Table";

            // The id of the table that triggered the event
            var oID = oEvent.getSource().getId();

            // Get binding parameters to modify (filters, sorters, etc.)
            var oBindingParams = oEvent.getParameter("bindingParams");

            if (oID === tableId) {
                // Implement table-specific logic here.
                // Example: add a filter programmatically:
                // oBindingParams.filters.push(new sap.ui.model.Filter("Language", "EQ", "EN"));
                //
                // Example: modify select / expand parameters:
                // oBindingParams.parameters = oBindingParams.parameters || {};
                // oBindingParams.parameters.custom = "someValue";

                // ...your custom logic...
            } else {
                // Default logic for all other tables (optional)
                // ...your default logic...
                return;
            }
        }
    };
});
```
--------------------------------

**TITLE**: Custom State Handling for Fiori elements (OData V2) - Map Example

**INTRODUCTION**: Example implementation showing how to manage inner app state for custom UI elements (map) in SAP Fiori elements for OData V2. Demonstrates: (1) notifying the framework on custom UI changes, (2) providing custom state (with lifecycle flags) to the framework, and (3) applying restored state while avoiding re-entrant change notifications.

**TAGS**: fiori-elements-framework, OData V2, custom-app-state, custom-ui, extensionAPI, bookmarking, pagination, session

**STEP**: 1 - Controller initialization

**DESCRIPTION**: Initialize controller properties used for state handling: zoomFactor, country, city and the re-entrancy guard isAdoptingState.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
onInit: function () {
    // State values for the custom UI area (map)
    this.zoomFactor = 1;    // number between 1 and 100
    this.country = null;    // selected country
    this.city = null;       // selected city

    // Guard to prevent handling change events while applying state
    this.isAdoptingState = false;
}
```

**STEP**: 2 - Event handlers: notify framework on changes

**DESCRIPTION**: Implement event handlers that update controller state and inform the Fiori framework that the custom UI state changed. Use the isAdoptingState guard to ignore changes triggered while applying a provided state.

- Use extensionAPI.onCustomStateChange() for state that should be shared across instances/pagination/session.
- Use extensionAPI.onCustomAppStateChange() for state that should be stored/bookmarked for the current instance only.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
onZoomFactorChange: function (iZoomFactor) {
    if (!this.isAdoptingState) { // ignore changes while adopting state
        this.zoomFactor = iZoomFactor;
        // Inform framework that state of custom UI area has changed (shared/session/pagination)
        this.extensionAPI.onCustomStateChange();
    }
},

onSelectedCityChange: function (sCountry, sCity) {
    if (!this.isAdoptingState) { // ignore changes while adopting state
        this.country = sCountry;
        this.city = sCity;
        // Inform framework that app-specific state of custom UI area has changed (bookmarkable)
        this.extensionAPI.onCustomAppStateChange();
    }
},
```

**STEP**: 3 - Provide custom state extension (framework reads this)

**DESCRIPTION**: Implement provideCustomStateExtension to return the custom UI state and lifecycle semantics. Keep numeric zoomFactor with session+pagination lifecycles, and selectedCity as permanent (bookmarkable) app state.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
provideCustomStateExtension: function (oState) {
    // zoomFactor: keep the last value across the session and during pagination
    oState.zoomFactor = {
        data: this.zoomFactor,
        lifecycle: {
            session: true,
            pagination: true
        }
    };

    // selectedCity: store as app-specific/permanent (bookmarkable) state for this instance
    oState.selectedCity = {
        data: {
            country: this.country,
            city: this.city
        },
        lifecycle: {
            permanent: true
        }
    };
},
```

**STEP**: 4 - Apply custom state extension (framework provides this)

**DESCRIPTION**: Implement applyCustomStateExtension to restore custom UI state when the framework supplies it. If bIsSameAsLast is true, skip restoring. Use isAdoptingState = true to prevent re-entrant event handlers while setting values.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
applyCustomStateExtension: function (oState, bIsSameAsLast) {
    if (bIsSameAsLast) {
        return; // controls are already in the correct state
    }

    this.isAdoptingState = true;

    if (oState && oState.zoomFactor && oState.zoomFactor.data !== undefined) {
        // restore zoom factor (oState.zoomFactor may contain lifecycle metadata)
        this.setZoomFactor(oState.zoomFactor.data);
    }

    if (oState && oState.selectedCity && oState.selectedCity.data) {
        var sCountry = oState.selectedCity.data.country;
        var sCity = oState.selectedCity.data.city;
        this.setSelectedCity(sCountry, sCity);
    }

    this.isAdoptingState = false;
},
```

**STEP**: 5 - Helper setters: apply values to UI and internal state

**DESCRIPTION**: Implement setter helpers that update controller state and perform the custom UI operations (e.g., reposition map, select city). These should not call extensionAPI notification methods directly since event handlers will do that unless isAdoptingState is true.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
setZoomFactor: function (iZoomFactor) {
    this.zoomFactor = iZoomFactor;
    // ... custom code which sets the map zoom level, e.g.:
    // this._oMapControl.zoomTo(iZoomFactor);
},

setSelectedCity: function (sCountry, sCity) {
    this.country = sCountry;
    this.city = sCity;
    // ... custom code which selects/highlights the specified city on the map, e.g.:
    // this._oMapControl.selectCity({ country: sCountry, city: sCity });
}
```

**STEP**: 6 - Best practice / notes

**DESCRIPTION**: Recommendation and behavior summary for implementers.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Note:
// - Define isAdoptingState on the controller to prevent loops when setZoomFactor/setSelectedCity
//   trigger the change handlers onZoomFactorChange/onSelectedCityChange.
// - Use lifecycle flags: session + pagination for values that must be propagated across pages,
//   and permanent for bookmarkable app-specific state.
// - This pattern applies only to SAP Fiori elements for OData V2.
```
--------------------------------

**TITLE**: Enable Conditional Internal Navigation to Different Detail Pages (Fiori Elements)

**INTRODUCTION**: This guide shows how to implement conditional internal navigation from a List Report or Object Page to different detail pages (different entity sets). Includes examples for OData V2 (onListNavigationExtension / onChildOpenedExtension) and OData V4 (manifest route + onBeforeNavigation extension). Use these extension points in your controller extensions to override default internal navigation when a condition is met; return true to prevent default navigation, return false to allow it.

**TAGS**: fiori-elements-framework, navigation, odata-v2, odata-v4, list-report, object-page, routing, manifest, extension

STEP: 1 — OData V2: Conditional navigation from List Report using onListNavigationExtension

DESCRIPTION: Implement onListNavigationExtension in your List Report controller extension to decide at runtime which navigation property (target entity) to navigate to. When sNavigationProperty is set, use extensionAPI.getNavigationController().navigateInternal(targetContext) inside securedExecution to perform internal navigation. Return true to stop default navigation; return false to allow default navigation.

LANGUAGE: JavaScript

CODE:
```javascript
// In your List Report controller extension (e.g. ListReportExtension.controller.js)
onListNavigationExtension: function(oEvent) {
    var oBindingContext = oEvent.getSource().getBindingContext();
    var oObject = oBindingContext.getObject();
    var sNavigationProperty;

    // Determine navigation property based on row data (customize condition)
    switch (oObject.Column3) {
        case "100":
            sNavigationProperty = "NavigationProperty1";
            break;
        case "200":
            sNavigationProperty = "NavigationProperty2";
            break;
    }

    if (sNavigationProperty) {
        var oExtensionAPI = this.extensionAPI;

        var fnNavigate = function() {
            return new Promise(function(fnResolve, fnReject) {
                var oModel = oBindingContext.getModel();
                // Create a binding context for the navigation property to get the target context
                oModel.createBindingContext(sNavigationProperty, oBindingContext, {}, function(oTarget) {
                    var oNavigationController = oExtensionAPI.getNavigationController();
                    // Perform internal navigation to the target context
                    oNavigationController.navigateInternal(oTarget);
                    fnResolve();
                });
            });
        };

        // Use securedExecution to run the navigation (no busy popup, no dataloss popup as example)
        oExtensionAPI.securedExecution(fnNavigate, {
            busy: { check: false },
            dataloss: { popup: false }
        });

        // Return true to prevent default navigation
        return true;
    }

    // Return false to allow default navigation to the default detail page
    return false;
}
```

STEP: 2 — OData V2: Provide visual indication for navigated table rows with onChildOpenedExtension

DESCRIPTION: Use onChildOpenedExtension in your List Report/Object Page controller extension to supply a binding path for the last opened child page so the framework can mark the corresponding row. Call fnSetPath with the actual binding path when it differs from oSelectionInfo.path.

LANGUAGE: JavaScript

CODE:
```javascript
// In your List Report or Object Page controller extension
onChildOpenedExtension: function(oSelectionInfo, fnSetPath) {
    // oSelectionInfo.path - default path of the opened child page
    // fnSetPath - call with the correct binding path if different from oSelectionInfo.path
    var oModel = this.getView().getModel();

    // Example: append navigation property to the selection path to get the specific row context
    oModel.createBindingContext(oSelectionInfo.path + "NavigationProperty", null, null, function(oContext) {
        if (oContext) {
            fnSetPath(oContext.getPath());
        }
    });
},
```

STEP: 3 — OData V2: Manifest pages configuration for multiple object pages (sample)

DESCRIPTION: Define multiple detail pages (object pages) in the manifest "pages" section so internal routing can resolve different entity sets. Ensure page keys match expected component/page IDs.

LANGUAGE: JSON

CODE:
```json
{
  "pages": {
    "ObjectPage|EntitySet1": {
      "entitySet": "EntitySet1",
      "component": {
        "name": "sap.suite.ui.generic.template.ObjectPage"
      }
    },
    "ObjectPage|EntitySet2": {
      "entitySet": "EntitySet2",
      "component": {
        "name": "sap.suite.ui.generic.template.ObjectPage"
      }
    },
    "ObjectPage|EntitySet3": {
      "entitySet": "EntitySet3",
      "component": {
        "name": "sap.suite.ui.generic.template.ObjectPage"
      }
    }
  }
}
```

STEP: 4 — OData V4: Define a custom route for the detail page in manifest

DESCRIPTION: Add a route entry in the manifest (sap.ui5.routing.routes) for the custom detail page. Use pattern placeholders for keys and map to a target defined elsewhere in your manifest.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3}):?query:",
          "name": "CustomMaterialDetailsPage",
          "target": "CustomMaterialDetailsPage"
        }
      ]
    }
  }
}
```

STEP: 5 — OData V4: List Report controller extension — override routing.onBeforeNavigation to navigate to custom route conditionally

DESCRIPTION: In a ControllerExtension for the List Report, override routing.onBeforeNavigation. Inspect oContextInfo.sourceBindingContext to decide whether to navigate to a custom route via extensionAPI.routing.navigateToRoute(routeName, params). Return true to prevent default navigation, return false to allow it.

LANGUAGE: JavaScript (sap.ui.define ControllerExtension)

CODE:
```javascript
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension"
], function(ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("SalesOrder.ext.LRExtend", {
    override: {
      routing: {
        onBeforeNavigation: function(oContextInfo) {
          var oLineContextData = oContextInfo.sourceBindingContext;
          var oExtensionAPI = this.base.getExtensionAPI();
          var oRouting = oExtensionAPI.routing;

          // Example condition: for SalesOrder 2919431 navigate to CustomMaterialDetailsPage
          if (oLineContextData && oLineContextData.SalesOrder === "2919431") {
            oRouting.navigateToRoute("CustomMaterialDetailsPage", {
              "key": "ID=11111138-aaaa-bbbb-cccc-ddddeeeeffff,IsActiveEntity=true",
              "key2": "ID=11111142-aaaa-bbbb-cccc-ddddeeeeffff,IsActiveEntity=true",
              "key3": "ID=21111142-aaaa-bbbb-cccc-ddddeeeeffff,IsActiveEntity=true"
            });
            // Return true to prevent default navigation
            return true;
          }

          // Return false to trigger default internal navigation
          return false;
        }
      }
    }
  });
});
```

STEP: 6 — OData V4: Object Page controller extension — override routing.onBeforeNavigation to navigate to a different object page

DESCRIPTION: In an Object Page controller extension, override routing.onBeforeNavigation. Use oContextInfo.sourceBindingContext to read the line item and call routing.navigateToRoute with computed keys to navigate to a different object page when conditions match.

LANGUAGE: JavaScript (sap.ui.define ControllerExtension)

CODE:
```javascript
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension"
], function(ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("SalesOrder.ext.OPExtend", {
    override: {
      routing: {
        onBeforeNavigation: function(oContextInfo) {
          var oLineContextData = oContextInfo.sourceBindingContext;
          var oExtensionAPI = this.base.getExtensionAPI();
          var oRouting = oExtensionAPI.routing;

          // Example: for salesOrderItem 40 from SalesOrder 2916499, navigate to PartnerObjectPage
          if (oLineContextData &&
              oLineContextData.SalesOrder === "2916499" &&
              oLineContextData.SalesOrderItem === 40) {

            oRouting.navigateToRoute("PartnerObjectPage", {
              "key": "ID=" + oLineContextData.ID + ",IsActiveEntity=" + oLineContextData.IsActiveEntity,
              "key2": "ID=" + oLineContextData.ID + ",IsActiveEntity=" + oLineContextData.IsActiveEntity
            });

            // Return true to prevent default navigation
            return true;
          }

          // Return false to trigger default internal navigation
          return false;
        }
      }
    }
  });
});
```
--------------------------------

**TITLE**: Replace Standard Chevron Navigation in List Report (Responsive Table) — External/Internal Target

**INTRODUCTION**: This guide shows how to replace the default chevron navigation from a List Report responsive table so that a row click (chevron) navigates to an external app (via FLP outbound) or falls back to default internal navigation. Two variants are provided: OData V2 (classic Fiori Elements ListReport) and OData V4 (FE V4 ListReport). Use only the SAP Fiori elements extensionAPI; do not manipulate internal controls or models directly. Ensure an object page is defined (or enable external navigation) if you still want object-page-related behavior.

**TAGS**: fiori-elements, sapui5, manifest.json, extensionAPI, navigation, list-report, object-page, ODataV2, ODataV4

STEP: OData V2 — Add outbound navigation target to manifest
DESCRIPTION: Add an outbound navigation target under sap.app -> crossNavigation -> outbounds in your manifest.json so you can reference it from the extension controller via its outbound key.
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "id": "your.app.id",
    "crossNavigation": {
      "inbounds": {},
      "outbounds": {
        "EPMProductManageSt": {
          "semanticObject": "EPMProduct",
          "action": "manage",
          "parameters": {
            "preferredMode": {
              "value": {
                "value": "display"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Register the list report controller extension in manifest
DESCRIPTION: Register your controller extension by adding its fully qualified controller name under sap.ui5 (or root "extends" depending on app). Example uses the generic ListReport view id key to attach your extension controller.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "STTA_MP.ext.controller.ListReportExtension"
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Implement onListNavigationExtension in controller extension
DESCRIPTION: Implement onListNavigationExtension in your list report controller extension. Use this.extensionAPI.getNavigationController().navigateExternal(<outboundKey>) for outbound navigation. Return true to prevent default navigation; return false to allow default internal navigation.
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/ext/controller/ListReportExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("STTA_MP.ext.controller.ListReportExtension", {
    /**
     * Called when a row chevron navigation is triggered in the List Report responsive table.
     * oEvent: event from the chevron press; use oEvent.getSource().getBindingContext() to get row context.
     */
    onListNavigationExtension: function (oEvent) {
      var oNavigationController = this.extensionAPI.getNavigationController();
      var oBindingContext = oEvent.getSource().getBindingContext();
      var oObject = oBindingContext && oBindingContext.getObject();

      // Example: trigger external navigation for items in ProductCategory "Notebooks"
      if (oObject && oObject.ProductCategory === "Notebooks") {
        // outbound key must match manifest outbounds entry
        oNavigationController.navigateExternal("EPMProductManageSt");
      } else {
        // allow default internal navigation to object page
        return false;
      }

      // prevent further default navigation
      return true;
    }
  });
});
```

STEP: OData V2 — Ensure object page or enable external navigation
DESCRIPTION: The List Report must include an object page definition for internal navigation to work. If you do not want users to navigate to that object page, enable external navigation by following your project policy (for example, disable object-page navigation or configure "Enable External Navigation" in your app settings). No code block required.

STEP: OData V4 — Add outbound navigation target to manifest
DESCRIPTION: For OData V4, define the outbound navigation in sap.app -> crossNavigation -> outbounds in manifest.json. The outbound key will be used by the extension to navigate outbound.
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "id": "your.app.id",
    "crossNavigation": {
      "inbounds": {},
      "outbounds": {
        "FreestyleNav": {
          "semanticObject": "v4Freestyle",
          "action": "Inbound",
          "parameters": {
            "SoldToParty": {
              "value": {
                "value": "7P100001",
                "format": "plain"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V4 — Register FE controller extensions in manifest
DESCRIPTION: Register controller extensions for the List Report (and Object Page if needed) under sap.ui5 -> extends -> extensions -> sap.ui.controllerExtensions. Use controllerName entries pointing to your extension modules.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ListReport.ListReportController": {
            "controllerName": "SalesOrder.ext.LRExtend"
          },
          "sap.fe.templates.ObjectPage.ObjectPageController": {
            "controllerName": "SalesOrder.ext.OPExtend"
          }
        }
      }
    }
  }
}
```

STEP: OData V4 — Implement onBeforeNavigation in controller extension
DESCRIPTION: Implement the onBeforeNavigation override in your List Report controller extension. Inspect oContextInfo.sourceBindingContext (the line item context). Use this.base.getExtensionAPI().intentBasedNavigation.navigateOutbound(<outboundKey>, params) to navigate to the outbound target. Return true to block default navigation or false to allow default behavior.
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/ext/LRExtend.js
sap.ui.define([], function () {
  "use strict";

  return {
    override: {
      routing: {
        /**
         * oContextInfo: contains source binding context (line item) and other navigation context
         * Return true to prevent default navigation; return false to allow default internal navigation.
         */
        onBeforeNavigation: function (oContextInfo) {
          var oLineContext = oContextInfo && oContextInfo.sourceBindingContext;
          var oNav = this.base.getExtensionAPI().intentBasedNavigation;

          // Example: if SalesOrder equals "6437" navigate outbound with a Customer parameter
          if (oLineContext && oLineContext.SalesOrder === "6437") {
            // outbound key must match manifest outbounds entry
            oNav.navigateOutbound("FreestyleNav", { "Customer": "10001" });
          } else {
            // allow default internal navigation
            return false;
          }

          // prevent default navigation
          return true;
        }
      }
    }
  };
});
```

STEP: OData V4 — Note on context passed to target app
DESCRIPTION: oContextInfo contains the context that would be passed to the target application (for example, the lineItem context when navigating from the list report table). Use this to construct parameter values for the outbound navigation. No code block required.
--------------------------------

**TITLE**: Replace Standard Chevron/Line-Item Navigation with Custom External or Internal Targets (OData V2 & V4)

**INTRODUCTION**: This document shows how to replace default chevron/line-item navigation from a Responsive Table on the Object Page with a custom navigation target (internal or external) using app extensions. It includes manifest configuration (outbound navigation and controller extension registration) and sample controller extension implementations for OData V2 and OData V4. Use only the SAP Fiori elements extensionAPI in your code and avoid manipulating framework internals.

**TAGS**: fiori-elements, navigation, extensionAPI, manifest.json, controller-extension, OData V2, OData V4, intent-based-navigation

STEP: 1 — Add outbound navigation to manifest.json (OData V2)
DESCRIPTION: Add a crossNavigation outbound entry in manifest.json to declare the external target (SAP Fiori Launchpad outbound). Use the outbound key when invoking navigateExternal from the extension API.
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "id": "my.company.app",
    "crossNavigation": {
      "inbounds": {},
      "outbounds": {
        "EPMProductManageSt": {
          "semanticObject": "EPMProduct",
          "action": "manage",
          "parameters": {
            "preferredMode": {
              "value": {
                "value": "display"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 2 — Register controller extension in manifest.json (OData V2)
DESCRIPTION: Register the object page controller extension module that implements onListNavigationExtension. Set controllerName to the AMD module path (example: STTA_MP.ext.controller.DetailsExtension).
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "controllerName": "STTA_MP.ext.controller.DetailsExtension"
          }
        }
      }
    }
  }
}
```

STEP: 3 — Implement onListNavigationExtension in the controller (OData V2)
DESCRIPTION: Create the controller extension module. Inspect the clicked line item's binding context, decide whether to perform outbound navigation (external) or allow default internal navigation. Return true to prevent default navigation (when you navigate externally), or return false to allow default navigation.
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/ext/controller/DetailsExtension.controller.js
sap.ui.define([], function () {
  "use strict";

  return {
    /**
     * Handler invoked for list/line-item navigation on the Object Page (chevron).
     * oEvent is the press event from the row/line item.
     */
    onListNavigationExtension: function (oEvent) {
      // Use the extension API to get the navigation controller
      var oNavigationController = this.extensionAPI.getNavigationController();

      // Get the line item's binding context and object
      var oBindingContext = oEvent.getSource().getBindingContext();
      var oObject = oBindingContext && oBindingContext.getObject && oBindingContext.getObject();

      // Example logic: external navigation for ProductCategory === "Notebooks"
      if (oObject && oObject.ProductCategory === "Notebooks") {
        // navigateExternal expects the outbound key defined in manifest.crossNavigation.outbounds
        oNavigationController.navigateExternal("EPMProductManageSt");
        // return true to prevent the default internal navigation
        return true;
      }

      // return false to allow the default internal navigation behavior
      return false;
    }
  };
});
```

STEP: 4 — Add outbound navigation to manifest.json (OData V4)
DESCRIPTION: Declare an outbound in sap.app.crossNavigation for V4 intent-based outbound navigation. This outbound key will be used with the intent-based navigation API in the extension.
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "id": "my.company.v4app",
    "crossNavigation": {
      "inbounds": {},
      "outbounds": {
        "FreestyleNav1": {
          "semanticObject": "v4Freestyle",
          "action": "Inbound",
          "parameters": {
            "SoldToParty": {
              "value": {
                "value": "7P100001",
                "format": "plain"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Register controller extension in manifest.json (OData V4)
DESCRIPTION: Register controller extensions for ListReport and/or ObjectPage controllers. The controllerName values must point to your extension modules (example: SalesOrder.ext.OPExtend).
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ListReport.ListReportController": {
            "controllerName": "SalesOrder.ext.LRExtend"
          },
          "sap.fe.templates.ObjectPage.ObjectPageController": {
            "controllerName": "SalesOrder.ext.OPExtend"
          }
        }
      }
    }
  }
}
```

STEP: 6 — Implement onBeforeNavigation override in the controller (OData V4)
DESCRIPTION: Implement the override routing.onBeforeNavigation method in your ObjectPage controller extension module. Inspect the merged context (line item + object page), and call intent-based navigation navigateOutbound with the outbound key and parameters when required. Return true to block default navigation, false to allow it.
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/ext/OPExtend.controller.js
sap.ui.define([], function () {
  "use strict";

  return {
    override: {
      routing: {
        /**
         * onBeforeNavigation receives oContextInfo containing the merged context
         * (lineItem + ObjectPage). Use base.getExtensionAPI().intentBasedNavigation
         * to execute outbound navigation.
         *
         * @param {object} oContextInfo - { bindingContext: <Context>, ... }
         * @returns {boolean} - return true to prevent default navigation; false to allow it
         */
        onBeforeNavigation: function (oContextInfo) {
          var oLineContext = oContextInfo && oContextInfo.bindingContext && oContextInfo.bindingContext.getObject && oContextInfo.bindingContext.getObject();
          var oNavAPI = this.base.getExtensionAPI().intentBasedNavigation;

          // Example: if SalesOrder equals "6437", navigate outbound to Freestyle app
          if (oLineContext && oLineContext.SalesOrder === "6437") {
            // outbound key must match manifest.sap.app.crossNavigation.outbounds key
            oNavAPI.navigateOutbound("FreestyleNav1", { "Customer": "10001" });
            // return true to prevent the default internal navigation
            return true;
          }

          // return false to allow default internal navigation
          return false;
        }
      }
    }
  };
});
```


--------------------------------

**TITLE**: Extending SAP Fiori elements Apps with a Canvas Page (OData V2)

**INTRODUCTION**: How to declare and navigate to a Canvas page inside a SAP Fiori elements (OData V2) app. Includes manifest JSON fragments for declaring a canvas page and its implementing component, enabling footer/flexible-column actions, routingSpec settings, and code snippets (controller and implementing component) for navigation and evaluating passed parameters.

**TAGS**: fiori-elements-framework, canvas, manifest.json, routing, extensionAPI, navigation, OData V2, implementingComponent, componentUsage

**STEP**: 1 — Declare a Canvas page in manifest.json

**DESCRIPTION**: Add a canvas page entry under sap.ui.generic.app -> pages. Use "component" with name "sap.suite.ui.generic.template.Canvas" and "implementingComponent" to point to the embedded component. You can use "componentName" or "componentUsage" to reference a component usage defined elsewhere in the manifest.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "thePageName": {
        "component": {
          "name": "sap.suite.ui.generic.template.Canvas",
          "settings": {
            /* canvas-specific settings go here (see Step 2) */
          }
        },
        "implementingComponent": {
          "componentName": "theImplementingComponentQualifiedName",
          "settings": {
            /* public property mappings / bindings for the implementing component */
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Use componentUsage instead of componentName (optional)

**DESCRIPTION**: If you defined a component usage in the manifest, reference it via componentUsage instead of componentName to reuse that configuration.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "thePageName": {
        "implementingComponent": {
          "componentUsage": "myUsageName" /* maps to manifest sap.ui5/componentUsages/myUsageName */
        }
      }
    }
  }
}
```

**STEP**: 3 — Enable standard footer bar or flexible column actions for the Canvas

**DESCRIPTION**: Configure required controls in the Canvas component settings. Set "requiredControls.footerBar": true to allow the implementing component to add the standard footer bar via extension API. Use "flexibleColumnLayoutActions": true to request flexible column actions. You can enable both.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "thePageName": {
        "component": {
          "name": "sap.suite.ui.generic.template.Canvas",
          "settings": {
            "requiredControls": {
              "footerBar": true,
              "flexibleColumnLayoutActions": true
            }
          }
        },
        "implementingComponent": {
          "componentName": "theImplementingComponentQualifiedName"
        }
      }
    }
  }
}
```

**STEP**: 4 — Configure data/property bindings for the implementing component

**DESCRIPTION**: Use implementingComponent.settings to map public properties of the implementing component to context/data from the embedding page (similar to embedding reuse components). Place these mappings in manifest under implementingComponent.settings.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "thePageName": {
        "implementingComponent": {
          "componentName": "theImplementingComponentQualifiedName",
          "settings": {
            /* Example mapping: expose parent context or property values */
            "ParentEntityPath": "{/currentEntityPath}",
            "SomeFlag": "{/flags/EnableFeature}"
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Enable navigation to the Canvas page (routingSpec)

**DESCRIPTION**: Add "routingSpec" to the page to allow internal navigation. routeName must be unique within the app and should not coincide with an entity set or navigation property (except in special override cases described in Step 7). Use noOData:true for non-OData target; set noKey:true if the canvas page is per-object (inherits parent context) or noKey:false to accept an additional key/string parameter.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "thePageName": {
        "routingSpec": {
          "noOData": true,
          "noKey": true,        /* true = inherits parent key; false = expects one additional key string */
          "routeName": "theRouteName"
        }
      }
    }
  }
}
```

**STEP**: 6 — Parent page with nested canvas child (manifest snippet)

**DESCRIPTION**: Sample manifest structure for a canvas page nested under a parent page (e.g., object page). This demonstrates that the parent page context is passed to the canvas and only the parent's extensionAPI instance may navigate to the canvas child.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "theParentPageName": {
        "entitySet": "theMainEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {}
        },
        "pages": {
          "thePageName": {
            "component": {
              "name": "sap.suite.ui.generic.template.Canvas",
              "settings": {
                "requiredControls": {
                  "footerBar": true
                }
              }
            },
            "implementingComponent": {
              "componentName": "theImplementingComponentQualifiedName",
              "settings": {}
            },
            "routingSpec": {
              "noOData": true,
              "noKey": true,
              "routeName": "theRouteName"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 7 — Navigate to the Canvas page from an extension controller (no additional key)

**DESCRIPTION**: Use the parent page's extensionAPI to obtain the navigation controller and call navigateInternal. If no additional key is needed, pass an empty string as the first argument. The extensionAPI instance must belong to the parent page of the target canvas page.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// controller extension (e.g., in a button press handler)
var oApi = this.extensionAPI;
var oNavigationController = oApi.getNavigationController();
oNavigationController.navigateInternal("", { routeName: "theRouteName" });
```

**STEP**: 8 — Navigate to the Canvas page passing one additional key (noKey = false)

**DESCRIPTION**: When routingSpec.noKey is false, pass a single string parameter (sUsersChoice) via navigateInternal. Only one string can be passed; encode complex data into a single string if needed.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// controller extension - pass one string parameter to the canvas page
var oApi = this.extensionAPI;
var oNavigationController = oApi.getNavigationController();
var sUsersChoice = /* generate or obtain a single string representing user choice */;
oNavigationController.navigateInternal(sUsersChoice, { routeName: "theRouteName" });
```

**STEP**: 9 — Absolute navigation to a canvas page (isAbsolute = true)

**DESCRIPTION**: To navigate to a canvas page that is not a child of the current canvas page (or to target a page that is a child of any hierarchical ancestor), set isAbsolute: true in navigateInternal options.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
var oApi = this.extensionAPI;
var oNavigationController = oApi.getNavigationController();
var sUsersChoice = /* user's choice string */;
oNavigationController.navigateInternal(sUsersChoice, {
  routeName: "theRouteName",
  isAbsolute: true
});
```

**STEP**: 10 — Evaluate the passed key inside the implementing component (stRefresh)

**DESCRIPTION**: In the implementing component, use the stRefresh lifecycle method to get current navigation keys from the extension API, extract the last key (user-provided string), and store it in the component model or take action.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// component.js (implementing component)
stRefresh: function(oModel, oBindingContext, oExtensionAPI) {
  var oNavigationController = oExtensionAPI.getNavigationController();
  var aKeys = oNavigationController.getCurrentKeys();
  var sUserChoice = aKeys[aKeys.length - 1];
  var oComponentModel = this.getComponentModel();
  oComponentModel.setProperty("/UsersChoice", sUserChoice);
}
```

**STEP**: 11 — Bind navigation context from a list report row to canvas controls (stStart example)

**DESCRIPTION**: Example code in the implementing component's stStart to read a navigation key and bind the canvas view's element to a constructed OData path so smart controls in the canvas can use the bound context.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// component.js (implementing component)
stStart: function(oModel, oBindingContext, oExtensionAPI) {
  var oComponentModel = this.getComponentModel();
  // get navigation keys; index 1 may hold the binding key from the originating list row
  var sPath = oExtensionAPI.getNavigationController().getCurrentKeys()[1];
  // build OData binding path (example for SalesOrder)
  var sBindingPath = "/C_STTA_SalesOrder_WD_20(" + sPath + ")";
  var oPathSpec = { path: sBindingPath };
  var oCanvasView = oComponentModel.getProperty("/View");
  oCanvasView.bindElement(oPathSpec);
}
```

**STEP**: 12 — Rules and considerations

**DESCRIPTION**: Key constraints and behaviors to implement correctly:
- This topic applies only to SAP Fiori elements for OData V2.
- routeName must be unique within the app and must not match an entity set or navigation property unless you intentionally override the standard object page behavior (see Step 7 alternative usage).
- The extensionAPI instance used for navigation must belong to the parent page of the canvas page.
- Only one string parameter can be passed via navigateInternal; encode complex data into one string if required.
- requiredControls settings expose extension API methods (e.g., addFooterBarToPage, getFlexibleColumnLayoutActionButtons) that the implementing component can call.

**LANGUAGE**: N/A

**CODE**:
```text
Related docs: Developing Reuse Components (for guidance when creating implementing components for reuse)
```
--------------------------------

**TITLE**: Extending Delivered SAP Fiori Elements Apps Using Adaptation Extensions

**INTRODUCTION**: Practical developer-focused guide for implementing adaptation extensions (controller-based overrides) in SAP Fiori elements delivered apps. Covers supported pages (List Report, Object Page, Overview Page, Analytical List Page), supported extension points, and actionable code examples for overriding template-based extension functions (addFilters, provide/restore app state, ensureFieldsForSelect, provideCustomActionPress).

**TAGS**: fiori-elements-framework, adaptation-editor, controller-extension, list-report, object-page, overview-page, analytical-list-page, ODataV2, ODataV4, SAPUI5

**STEP**: 1 — Supported pages, extension points, and limitations

**DESCRIPTION**: Use Adaptation Editor in SAP Business Application Studio to create adaptation projects that extend delivered SAP Fiori elements apps. Supported app types and common extension functions you can override via ControllerExtension (template-based extension points). Note: Flexible Column Layout is not supported by the Adaptation Editor.

Supported pages and extension points (high level):
- List Report / Analytical List Page
  - Add extra fields to Smart Filter Bar
  - Add columns to tables
  - Add toolbar buttons and controller logic
  - Override template-based extension functions: onInitSmartFilterBar, provideExtensionAppStateData, restoreExtensionAppStateData, ensureFieldsForSelect, addFilters
- Object Page
  - Toolbar actions, additional sections, header fields, form fields
  - Override: provideExtensionStateData, restoreExtensionStateData, ensureFieldsForSelect, addFilters
- Overview Page
  - Add filter bar fields, global actions, cards
  - Override: provideExtensionAppStateData, restoreExtensionAppStateData, addFilters, provideStartupExtension, provideExtensionNavigation, provideCustomActionPress, provideCustomParameter

Reference the API and examples:
- Adaptation extension example: https://help.sap.com/docs/bas/developing-sap-fiori-app-in-sap-business-application-studio/extending-sap-fiori-application
- Controller extensions API (FPM): https://ui5.sap.com/#/api/sap.fe.core.controllerextensions
- Generic List Report controller extension API: https://ui5.sap.com/#/api/sap.suite.ui.generic.template.ListReport.controllerFrameworkExtensions%23overview
- FPM explorer (controllerExtensions): https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/controllerExtensions/controllerExtensionsOverview
- SAPUI5 flexibility general guide: ../04_Essentials/sapui5-flexibility-adapting-uis-made-easy-a8e55aa.md

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Note: Example module for a controller extension that overrides template-based extension points.
// Recommended file path in your adaptation project (example): webapp/extension/AdaptationControllerExtension.js

sap.ui.define([
  "sap/ui/model/Filter",
  "sap/ui/model/FilterOperator"
], function(Filter, FilterOperator) {
  "use strict";

  return {
    // Use 'override.templateBaseExtension' to supply template-based extension functions
    override: {
      templateBaseExtension: {
        // Example: add custom filters into a List Report / ALP
        // fnAddFilter(fnFilter, sControlId) is provided by the framework; call it with your Filter and control id.
        addFilters: function(fnAddFilter, sControlId) {
          // Add a filter: Status eq 'Open'
          var oFilter = new Filter("Status", FilterOperator.EQ, "Open");
          fnAddFilter(oFilter, sControlId);
        },

        // Ensure additional OData select fields are requested for the current context (List Report / Object Page)
        // Framework will call this to know which properties need to be included in $select
        ensureFieldsForSelect: function(fnEnsureFields) {
          // Provide an array of property names that must be selected by the framework
          fnEnsureFields(["AdditionalField1", "AdditionalField2"]);
        }
      }
    }
  };
});
```

**STEP**: 2 — Persisting and restoring custom extension state (List Report / Overview / Object Page)

**DESCRIPTION**: Return small serializable state objects to be stored in the app state via provideExtensionAppStateData / provideExtensionStateData and restore them in corresponding restore* functions. Use these hooks to persist UI selections or custom variables across navigation and app state restore.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: provide/restore extension app state for List Report or Overview Page
sap.ui.define([], function() {
  "use strict";

  return {
    override: {
      templateBaseExtension: {
        // Called when the framework collects extension state to persist in the app state
        provideExtensionAppStateData: function() {
          // Return a JSON-serializable object. Keep it small.
          return {
            myCustomFlag: !!this._myCustomFlag,
            selectedKeys: this._selectedKeys || []
          };
        },

        // Called by framework to restore previously persisted extension state
        restoreExtensionAppStateData: function(oExtensionState) {
          if (!oExtensionState) {
            return;
          }
          // Restore internal variables and reapply to UI as needed
          this._myCustomFlag = !!oExtensionState.myCustomFlag;
          this._selectedKeys = oExtensionState.selectedKeys || [];
          // Example: reapply selection or UI update
          // this.byId("myTable").setSelectedKeys(this._selectedKeys);
        }
      }
    }
  };
});
```

**STEP**: 3 — Object Page: provideExtensionStateData / restoreExtensionStateData example

**DESCRIPTION**: For Object Page specific state persistence, implement provideExtensionStateData and restoreExtensionStateData to store per-object UI state (e.g., expanded sections, custom field values).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Object Page example: persist UI state for the current object
sap.ui.define([], function() {
  "use strict";

  return {
    override: {
      templateBaseExtension: {
        provideExtensionStateData: function() {
          // Store expand/collapse state or other object-specific flags
          return {
            sectionExpanded: this._sectionExpanded === true,
            localDraftIndicator: this._localDraft || false
          };
        },

        restoreExtensionStateData: function(oState) {
          if (!oState) {
            return;
          }
          this._sectionExpanded = !!oState.sectionExpanded;
          this._localDraft = !!oState.localDraftIndicator;

          // reapply UI state, e.g., expand/collapse sections
          // var oSection = this.byId("myCustomSection");
          // if (oSection) { oSection.setVisible(this._sectionExpanded); }
        }
      }
    }
  };
});
```

**STEP**: 4 — Overview page: handling custom actions (provideCustomActionPress sample)

**DESCRIPTION**: On Overview pages, override provideCustomActionPress to intercept custom action execution from cards or filter bar and provide custom logic.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Overview page example: intercept a custom action press
sap.ui.define([], function() {
  "use strict";

  return {
    override: {
      templateBaseExtension: {
        // sActionId: identifier of the custom action; oContext: optional execution context
        provideCustomActionPress: function(sActionId, oContext) {
          if (sActionId === "MyCustomOverviewAction") {
            // Implement custom behavior here
            // e.g., open dialog, call OData action, navigate, etc.
            // return true to signal that the action has been handled by the extension
            // and no default handling is required
            this._openMyCustomDialog(oContext);
            return true;
          }
          // Return false if not handled to allow default processing
          return false;
        }
      }
    }
  };
});
```

**STEP**: 5 — Implementation notes and best practices

**DESCRIPTION**: Practical guidelines for writing adaptation extensions:
- Keep extension state small and JSON-serializable.
- Use provided framework callbacks (fnAddFilter, fnEnsureFields, etc.) rather than directly manipulating internal template data providers.
- Test in Safe Mode and use the FPM explorer and API reference to verify function signatures.
- Adaptation Editor in SAP Business Application Studio creates adaptation projects on top of delivered apps—use it to scaffold and deploy your controller extension modules.
- The template-based extension keys used above (override.templateBaseExtension.*) are how adaptation projects consume extension functions. Consult the API links above for exact signatures relevant to your app template and UI5/Fiori elements version.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "references": {
    "Adaptation Editor how-to": "https://help.sap.com/docs/bas/developing-sap-fiori-app-in-sap-business-application-studio/extending-sap-fiori-application",
    "ListReport controller framework extensions": "https://ui5.sap.com/#/api/sap.suite.ui.generic.template.ListReport.controllerFrameworkExtensions%23overview",
    "FE controllerextensions API": "https://ui5.sap.com/#/api/sap.fe.core.controllerextensions",
    "FPM explorer (controllerExtensions)": "https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/controllerExtensions/controllerExtensionsOverview",
    "SAPUI5 Flexibility guide": "../04_Essentials/sapui5-flexibility-adapting-uis-made-easy-a8e55aa.md",
    "More extension function details": "details-of-extension-functions-used-for-extending-delivered-apps-82630e5.md",
    "Adaptation extension example (adding table toolbar button)": "adaptation-extension-example-adding-a-button-to-the-table-toolbar-in-the-list-report-a269671.md"
  }
}
```
--------------------------------

**TITLE**: Extending Generated SAP Fiori Elements Apps Using App Extensions

**INTRODUCTION**: Short reference for implementing app extensions in generated SAP Fiori elements applications. Shows manifest changes, controller extension file placement, common extension hooks (List Report / Object Page), and how to add UI fragments via manifest. Emphasizes using only the documented ExtensionAPI and avoiding manipulation of internal framework objects.

**TAGS**: fiori-elements, sapui5, app-extension, manifest, controller-extension, view-extension, extensionAPI, odata-v2, odata-v4

**STEP**: 1 — Choose extension approach

**DESCRIPTION**: Decide whether the required change can be done with annotations or manifest settings. If not, choose an app extension approach:
- Controller extension (add JavaScript controller to extend framework controller behavior)
- View/fragment injection (add XML fragment into an existing generated view)
- Manifest-only changes (resource additions, component settings)

Prefer manifest/annotation changes before using code extensions. Read and follow the ExtensionAPI rules: use only documented ExtensionAPI functions.

**LANGUAGE**: text

**CODE**:
```text
Files referenced in examples:
- webapp/manifest.json             (application descriptor)
- webapp/extension/                (folder for extension controllers & fragments)
  - extension/ListReportExt.controller.js
  - extension/ObjectPageExt.controller.js
  - fragment/CustomButton.fragment.xml
```

**STEP**: 2 — Add a controller extension mapping in manifest.json

**DESCRIPTION**: Map the generated framework controller to your custom controller using the sap.ui5.controllerExtensions section of manifest.json. Replace the framework controller name with the exact controller id used by your floorplan (ListReport / ObjectPage examples shown).

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (snippet)
{
  "sap.ui5": {
    "controllerExtensions": {
      // Example for List Report (OData V2 / V4)
      "sap.suite.ui.generic.template.ListReport.view.ListReport": {
        "controllerName": "my.app.extension.ListReportExt"
      },

      // Example for Object Page (OData V2 / V4)
      "sap.suite.ui.generic.template.ObjectPage.view.Details": {
        "controllerName": "my.app.extension.ObjectPageExt"
      }
    }
  }
}
```

**STEP**: 3 — Implement the controller extension file

**DESCRIPTION**: Create the extension controller implementing only extension hooks / event handlers you need. Use extension hooks provided by the floorplan (for example, onBeforeRebindTableExtension for List Report) and avoid manipulating internal controls or models directly. Use only documented ExtensionAPI methods where interaction with the framework is required.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/extension/ListReportExt.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/ui/model/Filter",
  "sap/ui/model/FilterOperator"
], function (Controller, Filter, FilterOperator) {
  "use strict";

  return Controller.extend("my.app.extension.ListReportExt", {
    /**
     * Example hook name used by List Report floorplan:
     * onBeforeRebindTableExtension(oEvent)
     *
     * Use this hook to modify binding parameters (filters, sorters) before the table is bound.
     */
    onBeforeRebindTableExtension: function (oEvent) {
      var oBindingParams = oEvent.getParameter("bindingParams");
      var aFilters = oBindingParams.filters || [];

      // Add a filter on "MyProperty"
      aFilters.push(new Filter("MyProperty", FilterOperator.EQ, "MyValue"));
      oBindingParams.filters = aFilters;
    },

    /**
     * Initialization - use only documented ExtensionAPI if needed.
     * Example: do not access internal framework controls directly.
     */
    onInit: function () {
      // the framework injects this.extensionAPI into many extension controllers;
      // use only documented ExtensionAPI functions: https://ui5.sap.com/#/api/sap.fe.core.ExtensionAPI
      if (this.extensionAPI) {
        // Example placeholder - call only documented methods, not internal ones.
        // this.extensionAPI.someDocumentedMethod(...);
      }
    }
  });
});
```

**STEP**: 4 — Inject a UI fragment using manifest viewExtensions

**DESCRIPTION**: Add an XML fragment into a specific extension point of a generated view using sap.ui.viewExtensions (in manifest). Replace the target view name and extension point with the appropriate id for your floorplan and app version.

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (snippet) - inject an XML fragment into a view extension point
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          // Target view ID used by the floorplan (example - adjust as required)
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            // Extension point name depends on the template; check floorplan docs
            "BeforeTable": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "my.app.extension.fragment.CustomButton",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Create the XML fragment to be injected

**DESCRIPTION**: Implement the fragment placed in webapp/extension/fragment. Keep fragment logic isolated and interact with the app via ExtensionAPI or controller hooks.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/extension/fragment/CustomButton.fragment.xml -->
<core:FragmentDefinition
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:layout="sap.ui.layout">
  <Button
    text="My Extension Action"
    press=".onCustomActionPress" />
</core:FragmentDefinition>
```

**STEP**: 6 — Implement fragment event handlers in controller extension

**DESCRIPTION**: Wire fragment events to methods in your controller extension. Example shows a button press handler added to the same extension controller.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/extension/ListReportExt.controller.js (append or add method)
onCustomActionPress: function () {
  // Avoid internal framework manipulation.
  // Use documented ExtensionAPI methods if you need to navigate or access shared services.
  // Example: show a message using standard UI5 API (safe):
  sap.m.MessageToast.show("Extension action executed");
}
```

**STEP**: 7 — Best practices & cautions

**DESCRIPTION**: Follow these rules when creating extensions:
- Prefer manifest settings and annotations over code extensions.
- Use only the documented ExtensionAPI (see API reference below).
- After adding an extension, display and behavioral responsibility is yours — the framework will not manage custom control state/busy handling/model usage for your code.
- Don’t access or manipulate internal controls, properties, models, or other objects created by the SAP Fiori elements framework.

**LANGUAGE**: text

**CODE**:
```text
References:
- Read Before Extending a Generated App: read-before-extending-a-generated-app-d9c146a.md
- Using the ExtensionAPI: using-the-extensionapi-bd2994b.md
- ExtensionAPI Reference (sap.fe.core.ExtensionAPI): https://ui5.sap.com/#/api/sap.fe.core.ExtensionAPI
- SAP Fiori tools - Configure Page Elements: https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/047507c86afa4e96bb3d284adb9f4726.html
- Extending List Reports and Object Pages Using App Extensions: extending-list-reports-and-object-pages-using-app-extensions-a892eb8.md
- Configuring Analytical List Page App Extensions: configuring-analytical-list-page-app-extensions-9504fb4.md
- Configuring Overview Page App Extensions: configuring-overview-page-app-extensions-b240f61.md
- Extending SAPUI5 Applications: ../08_Extending_SAPUI5_Applications/extending-apps-a264a9a.md
```
--------------------------------

**TITLE**: Extending Fiori Elements List Reports and Object Pages with App Extensions

**INTRODUCTION**: Practical, code-focused guidance for adding app extensions to SAP Fiori elements list reports and object pages. Includes manifest registration, controller extension template, fragment file placement, and safety constraints (use only the extensionAPI). Use this as a ready-to-use template to generate code for list-report and object-page extensions.

**TAGS**: fiori-elements, extension, app-extension, list-report, object-page, manifest.json, controller-extension, fragment, UI5

STEP: Prerequisites and safety
DESCRIPTION: Read prerequisite documents and follow the caution: only use SAP Fiori elements' extensionAPI and avoid manipulating framework internals (controls, models, bindings) directly.
LANGUAGE: Markdown/Links
CODE:
```text
Required reading (before extending):
- Read Before Extending a Generated App:
  ./read-before-extending-a-generated-app-d9c146a.md
- Using the extensionAPI:
  ./using-the-extensionapi-bd2994b.md

Caution:
- Use app extensions only if manifest/annotations cannot achieve the behavior.
- Use only the official extensionAPI functions provided by SAP Fiori elements.
- Do not access or manipulate internal framework controls, properties, models, or bindings directly.
```

STEP: Choose an authoring method
DESCRIPTION: Choose between SAP Fiori tools (recommended) or manual creation. SAP Fiori tools provide wizarded support for creating extension files. Manual approach requires creating files under webapp and updating manifest.json.
LANGUAGE: Markdown/Links
CODE:
```text
Options:
- SAP Fiori tools (Visual Studio Code / Business Application Studio) — recommended:
  https://help.sap.com/viewer/product/SAP_FIORI_tools/Latest/en-US

- Manual:
  - Add files under webapp/ (controller extension, fragments, css, resources).
  - Update webapp/manifest.json as shown in subsequent steps.
```

STEP: Register a controller extension in manifest.json (List Report and Object Page)
DESCRIPTION: Add controllerExtensions entries to webapp/manifest.json to attach your custom controller to the generated List Report or Object Page views. Replace the controllerName with your module path.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "controllerExtensions": {
      "sap.suite.ui.generic.template.ListReport.view.ListReport": {
        "controllerName": "my.app.ext.ListReportExtension"
      },
      "sap.suite.ui.generic.template.ObjectPage.view.Details": {
        "controllerName": "my.app.ext.ObjectPageExtension"
      }
    }
  }
}
```

STEP: Create a controller extension module (ControllerExtension template)
DESCRIPTION: Create the controller extension JavaScript at webapp/ext/ListReportExtension.controller.js (or the module path you used in manifest.controllerExtensions). Use the UI5 ControllerExtension base class and obtain the extensionAPI via this.base.getExtensionAPI(). Implement only extensionAPI-based logic and lifecycle hooks.
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/ext/ListReportExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension"
], function (ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("my.app.ext.ListReportExtension", {
    // Called when the host controller is initialized
    onInit: function () {
      // this.base is provided by ControllerExtension
      // Obtain the Fiori elements extensionAPI wrapper:
      this.extensionAPI = this.base.getExtensionAPI();
      // Use only extensionAPI methods from here on
    },

    // Example: a custom action handler that uses extensionAPI
    onCustomAction: function () {
      // Call only documented extensionAPI functions
      // Example placeholder - replace with actual extensionAPI method names
      if (this.extensionAPI && this.extensionAPI.someAuthorizedMethod) {
        this.extensionAPI.someAuthorizedMethod({ /* params */ });
      }
    }
  });
});
```

STEP: Create XML fragment(s) for UI elements
DESCRIPTION: Place fragment XML under webapp/ext/fragments and reference them from your extension controller. Keep fragment content self-contained and instantiate via standard UI5 fragment APIs inside the controller extension. Do not reach into framework internals.
LANGUAGE: XML
CODE:
```xml
<!-- File: webapp/ext/fragments/MyHeaderAction.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
  <Button text="My Custom Action" press=".onCustomAction" />
</core:FragmentDefinition>
```

STEP: Load and use fragment from the controller extension (instantiate and add to host view via extensionAPI)
DESCRIPTION: From the controller extension, create and insert controls created from fragments. Use only supported placement methods provided by extensionAPI or the host view's public API surfaced through extensionAPI. Example shows standard UI5 fragment instantiation inside the extension; adapt insertion to extensionAPI placement functions per the Using the extensionAPI documentation.
LANGUAGE: JavaScript
CODE:
```javascript
// Inside your controller extension (webapp/ext/ListReportExtension.controller.js)
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension",
  "sap/ui/core/Fragment"
], function (ControllerExtension, Fragment) {
  "use strict";

  return ControllerExtension.extend("my.app.ext.ListReportExtension", {
    onInit: function () {
      this.extensionAPI = this.base.getExtensionAPI();
    },

    openHeaderAction: function () {
      var that = this;
      // Create fragment control
      Fragment.load({
        name: "my.app.ext.fragments.MyHeaderAction",
        controller: this
      }).then(function (oFragment) {
        // Insert oFragment using extensionAPI placement methods ONLY (example placeholder)
        // Replace the pseudo-call below with the documented extensionAPI method for placement
        if (that.extensionAPI && that.extensionAPI.addHeaderAction) {
          that.extensionAPI.addHeaderAction(oFragment);
        } else {
          // Fallback: attach to host view only if documented/allowed by extensionAPI
          var oView = that.base.getView();
          oView.byId("someHeaderPlaceholder")?.addItem(oFragment);
        }
      });
    },

    onCustomAction: function () {
      // Handler called from fragment button press
      // Use only extensionAPI to trigger navigation, messages, busy handling, etc.
      // Example: placeholder extensionAPI usage
      if (this.extensionAPI && this.extensionAPI.navigate) {
        this.extensionAPI.navigate({ /* navigation params */ });
      }
    }
  });
});
```

STEP: File layout example (recommended structure)
DESCRIPTION: Recommended minimal file layout for an app extension implementation.
LANGUAGE: Markdown
CODE:
```text
webapp/
  manifest.json                 <-- updated with controllerExtensions entries
  ext/
    ListReportExtension.controller.js
    ObjectPageExtension.controller.js
    fragments/
      MyHeaderAction.fragment.xml
      MyFooterAction.fragment.xml
  i18n/
  view/
  Component.js
```

STEP: References and related information
DESCRIPTION: Keep documentation links handy; follow them for the definitive extensionAPI method list and allowed placement methods.
LANGUAGE: Markdown
CODE:
```text
Documentation:
- Using the extensionAPI (detailed methods and allowed operations):
  ./using-the-extensionapi-bd2994b.md

- Read Before Extending a Generated App (prerequisites):
  ./read-before-extending-a-generated-app-d9c146a.md

Related example:
- Adding a Custom Message Strip to List Report and Analytical List Page:
  ./adding-a-custom-message-strip-to-list-report-analytical-list-page-and-object-page-tables-0fdbefb.md
```
--------------------------------

**TITLE**: Extending SAP Fiori Elements Apps — Manifest-Based Controller Overrides (OData V2 & V4)

**INTRODUCTION**: This guide shows how to register custom controller extensions for SAP Fiori elements-based apps by adding manifest.json entries. It covers OData V2 and OData V4 scenarios, explains specificity rules (the most specific manifest key wins), and shows how page IDs are formed so you can target single pages or all pages of a view.

**TAGS**: fiori-elements-framework, app-extensions, manifest, sapui5, odata-v2, odata-v4, object-page, list-report, adaptation

**STEP**: 1 — Basic controller override (OData V2)

**DESCRIPTION**: Add view/controller override entries in manifest.json to point a view to a custom controller. Place these keys at the same manifest level as "sap.app" / "sap.ui5" (root manifest). Use the plain view name to apply to all views of that type; use the view name plus hash and page ID to target a single page instance. The most specific manifest key wins.

**LANGUAGE**: JSON

**CODE**:
```json
{
  /* add at the manifest root (same level as "sap.app" / "sap.ui5") */
  "sap.suite.ui.generic.template.ObjectPage.view.Details": {
    "controllerName": "SalesOrder.ext.controller.DetailsExtension"
  },
  "sap.suite.ui.generic.template.ObjectPage.view.Details#SalesOrder::sap.suite.ui.generic.template.ObjectPage.view.Details::SalesOrder_WD": {
    "controllerName": "SalesOrder.ext.controller.SalesOrderExtension"
  }
}
```

**STEP**: 2 — Specificity and mapping explanation (OData V2)

**DESCRIPTION**: Use the most-specific key to target a single object page instance. The manifest key format is:
- <viewId> (applies to all pages of that view), or
- <viewId>#<AppName>::<ViewName>::<EntitySetOrPageId> (applies to that specific page instance).
Example below demonstrates multiple specific overrides including entity-set metadata passed under "sap.ui.generic.app".

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.suite.ui.generic.template.ObjectPage.view.Details": {
    "controllerName": "STTASOWD20.ext.controller.DetailsExtension",
    "sap.ui.generic.app": {
      "C_STTA_SalesOrder_WD_20": {
        "EntitySet": "C_STTA_SalesOrder_WD_20"
      }
    }
  },
  "sap.suite.ui.generic.template.ObjectPage.view.Details#STTASOWD20::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20": {
    "controllerName": "STTASOWD20.ext.controller.SalesOrderExtension",
    "sap.ui.generic.app": {
      "C_STTA_SalesOrder_WD_20": {
        "EntitySet": "C_STTA_SalesOrder_WD_20"
      }
    }
  },
  "sap.suite.ui.generic.template.ObjectPage.view.Details#STTASOWD20::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrderItem_WD_20": {
    "controllerName": "STTASOWD20.ext.controller.SalesOrderItemExtension",
    "sap.ui.generic.app": {
      "C_STTA_SalesOrderItem_WD_20": {
        "EntitySet": "C_STTA_SalesOrderItem_WD_20"
      }
    }
  }
}
```
- STTASOWD20 = application name
- sap.suite.ui.generic.template.ObjectPage.view.Details = view ID
- C_STTA_SalesOrderItem_WD_20 = entity set / page ID that identifies the instance

**STEP**: 3 — Controller override and routing target (OData V4)

**DESCRIPTION**: For OData V4 / SAP Fiori elements (FE) apps, override the FE controller or target a specific object page using the manifest routing target ID. Register a global override and a page-specific override (using the hash-based page ID formed as <AppId>::<TargetName>).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.fe.templates.ObjectPage.ObjectPageController": {
    "controllerName": "SalesOrder.ext.OPExtend"
  },
  "sap.fe.templates.ObjectPage.ObjectPageController#SalesOrder::SalesOrderManageObjectPage": {
    "controllerName": "SalesOrder.ext.SalesOrderOPExtend"
  }
}
```

Example manifest routing that defines the page target (page ID = MyApplicationID::MainEntityObjectPage):
```json
{
  "sap.app": {
    "id": "MyApplicationID",
    "type": "application"
  },
  "sap.ui5": {
    "routing": {
      "config": {
        "async": true
      },
      "routes": [
        {
          "pattern": "MainEntity({key}):?query:",
          "name": "MainEntityObjectPage",
          "target": "MainEntityObjectPageTarget"
        }
      ],
      "targets": {
        "MainEntityObjectPageTarget": {
          "type": "Component",
          "id": "MainEntityObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "contextPath": "/MainEntity"
            }
          }
        }
      }
    }
  }
}
```
- Page ID example: MyApplicationID::MainEntityObjectPage (used after the hash to target a page instance)

**STEP**: 4 — Where to place code and controller files

**DESCRIPTION**: Implement the controllers referenced by controllerName in your extension folder, for example:
- webapp/ext/controller/DetailsExtension.controller.js
- webapp/ext/controller/SalesOrderExtension.controller.js
or follow your project structure for UI5 controllers. Ensure manifest entries reference the correct module path (dot notation or relative as per your build).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: webapp/ext/controller/SalesOrderExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";
  return Controller.extend("SalesOrder.ext.controller.SalesOrderExtension", {
    onInit: function () {
      // extension initialization
    }
    // implement extension hooks / overrides here
  });
});
```

**STEP**: 5 — Additional features: Adaptation extensions (OData V2)

**DESCRIPTION**: For adaptation projects (customers/partners adding functionality upgrade-safely), use adaptation extensions. This is supported only for specific floorplans: List Report, Object Page, Overview Page, and Analytical List Page. See:
- Extending Generated Apps Using App Extensions (extending-generated-apps-using-app-extensions-340cdb2.md)
- Extending Delivered Apps Using Adaptation Extensions (extending-delivered-apps-using-adaptation-extensions-52fc48b.md)

**LANGUAGE**: text

**CODE**:
```text
Supported floorplans for adaptation extensions:
- List Report
- Object Page
- Overview Page
- Analytical List Page
```
--------------------------------

**TITLE**: Extend Bookmark Function to Force Static Tiles in SAP Fiori Launchpad

**INTRODUCTION**: Add an onSaveAsTileExtension controller extension to a Fiori elements List Report or Analytical List Page to force saving static tiles (or set a custom service URL) when users create bookmarks via the Share -> Bookmark action. Applicable only to SAP Fiori elements for OData V2 and only affects tiles created via the bookmark function.

**TAGS**: fiori-elements-framework, bookmark, launchpad, tiles, controller-extension, OData V2, SAP Fiori

**STEP**: 1 — Prerequisites and behavior
**DESCRIPTION**: Confirm applicability and behavior before implementing:
- Only for SAP Fiori elements using OData V2.
- This extension point only runs for tiles added using the bookmark function (Share -> Bookmark).
- Default behavior: List Report and Analytical List Page create dynamic tiles (except when semantic date range fields are used and filled — then static tile can be created automatically). Object pages create static tiles by default.
- Use this extension to: (a) force static tile creation by setting serviceUrl to an empty string, or (b) override the serviceUrl to a specific value.

**LANGUAGE**: Text

**CODE**:
```text
Behavior summary:
- If oShareInfo.serviceUrl === "" => LAUNCHPAD tile will be created as static tile.
- If oShareInfo.serviceUrl is a non-empty string => LAUNCHPAD tile will be created as dynamic tile which fetches the given service URL.
- This extension executes only when the tile is created using the bookmark function (Share -> Bookmark).
- This is only supported for Fiori elements with OData V2.
```

**STEP**: 2 — Register a controller extension in manifest.json
**DESCRIPTION**: Add a controller extension entry in your app's manifest.json. Provide one example for List Report and one for Analytical List Page. Change controllerName to your extension module path (namespace + file name without .js). This must be done before implementing the extension module.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "controllerExtensions": {
      "sap.suite.ui.generic.template.ListReport.controller.ListReport": {
        "controllerName": "my.app.ext.ListReportExtension"
      },
      "sap.suite.ui.generic.template.AnalyticalListPage.controller.AnalyticalListPage": {
        "controllerName": "my.app.ext.AnalyticalListPageExtension"
      }
    }
  }
}
```

**STEP**: 3 — Implement the controller extension module (force static tile)
**DESCRIPTION**: Create the extension module referenced in manifest.json. Implement onSaveAsTileExtension(oShareInfo) and set oShareInfo.serviceUrl to an empty string to force a static tile. Place the file under webapp/ (or your app's module path) matching "my.app.ext.ListReportExtension".

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/extension/ListReportExtension.js
sap.ui.define([], function () {
  "use strict";
  return {
    /**
     * Called when the user saves a tile via Share -> Bookmark.
     * @param {object} oShareInfo - object controlling tile creation
     *   e.g. { title: "...", subtitle: "...", serviceUrl: "<url>|''", ... }
     */
    onSaveAsTileExtension: function (oShareInfo) {
      // Force a static tile by setting serviceUrl to an empty string
      oShareInfo.serviceUrl = "";
    }
  };
});
```

**STEP**: 4 — Implement the controller extension module (set a custom dynamic service URL)
**DESCRIPTION**: If you want a dynamic tile that hits a custom service URL (instead of the default), set serviceUrl to that URL string.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/extension/ListReportExtension.js
sap.ui.define([], function () {
  "use strict";
  return {
    onSaveAsTileExtension: function (oShareInfo) {
      // Force a dynamic tile to use a specific OData service URL
      oShareInfo.serviceUrl = "/sap/opu/odata/sap/MY_CUSTOM_TILE_SERVICE/";
    }
  };
});
```

**STEP**: 5 — Notes and troubleshooting
**DESCRIPTION**: Keep these checks in mind:
- The extension runs only for tiles created by the bookmark/share action.
- If semantic date range fields are configured and any are filled, the framework may already return a static tile unless overridden here.
- Test tile creation from the running app's Share -> Bookmark, then verify tile type and service URL in the Launchpad designer or by inspecting the bookmark payload.
- Ensure your manifest.json controllerName matches the module namespace and path where the JS file resides.
--------------------------------

**TITLE**: Extending Delivered Fiori Elements App Manifests via an Adaptation Project

**INTRODUCTION**: Practical, code-focused recipes for adding pages, changing page/app configuration, adding annotations, and including reuse components in an adaptation project's manifest.appdescr_variant (and related files). Use these snippets to programmatically produce changes merged into the delivered app manifest.

**TAGS**: sapui5, fiori-elements, adaptation, manifest, manifest.appdescr_variant, OData, annotations, reuse-component, neo-app.json

**STEP**: Prerequisites and manifest format

**DESCRIPTION**: Ensure environment and manifest format prerequisites are met before applying adaptation changes.

- SAPUI5 >= 1.108 (ABAP platform 2021+) required.  
- In the app's manifest.json, pages and subpages must use the object format within sap.ui.generic.app (array format supported since SAPUI5 1.133).  
- Adaptation changes are placed in the adaptation project's manifest.appdescr_variant file (content[]).  
- Local annotation files live in the adaptation project (e.g., changes/annotations/annotations.xml).

**LANGUAGE**: text

**CODE**:
```text
Prerequisites:
- SAPUI5 >= 1.108
- manifest.json: sap.ui.generic.app pages/subpages in object format (or array format for >=1.133)
- Adaptation changes: adaptationProject/manifest.appdescr_variant (content[])
- Annotation file example path: changes/annotations/annotations.xml
```

**STEP**: Change merge parameter template (required fields)

**DESCRIPTION**: Use the following JSON skeletons as templates. Always set changeType, parentPage (component and optional entitySet), and entityPropertyChange with propertyPath, operation ("UPSERT"), and propertyValue. For adding pages use appdescr_ui_generic_app_addNewObjectPage. For adding OData annotations use appdescr_app_addAnnotationsToOData. For UI5 component usages and libraries use appdescr_ui5_addComponentUsages and appdescr_ui5_addLibraries.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ObjectPage",
      "entitySet": "YOUR_ENTITY_SET"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings/...",
      "operation": "UPSERT",
      "propertyValue": {
        // new settings to be merged into the manifest
      }
    }
  }
}
```

**STEP**: Add a new subobject page (new navigation node)

**DESCRIPTION**: Add a new detail/subobject page that navigates from a parent entitySet using a navigation property. Place this change in manifest.appdescr_variant content[].

- childPage.id must be unique and prefixed when targeting customer/customer_base layer (prefix "customer."). No prefix required for vendor layer.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_addNewObjectPage",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ObjectPage",
      "entitySet": "C_STTA_SalesOrder_WD_20"
    },
    "childPage": {
      "id": "customer.ObjectPage|to_extendedNode",
      "definition": {
        "navigationProperty": "to_extendedNode",
        "entitySet": "C_STTA_ExtendedNode"
      }
    }
  }
}
```

**STEP**: Configure a node (createMode and table type)

**DESCRIPTION**: Set createMode and tableSettings for a section/facet of an ObjectPage. Use propertyPath = component/settings/sections/<facetId> or the correct facet ID when modifying existing nodes.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ObjectPage",
      "entitySet": "C_STTA_SalesOrder_WD_20"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings/sections/extendedFacetId",
      "operation": "UPSERT",
      "propertyValue": {
        "createMode": "inline",
        "tableSettings": {
          "tableType": "GridTable"
        }
      }
    }
  }
}
```

**STEP**: Modify application-level settings (createMode, flexibleColumnLayout)

**DESCRIPTION**: Merge application-level settings (settings under sap.suite.ui.generic.template). Use parentPage.component = "sap.suite.ui.generic.template".

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template"
    },
    "entityPropertyChange": {
      "propertyPath": "settings",
      "operation": "UPSERT",
      "propertyValue": {
        "tableSettings": {
          "createMode": "creationRows"
        },
        "flexibleColumnLayout": {
          "defaultTwoColumnLayoutType": "TwoColumnsMidExpanded",
          "defaultThreeColumnLayoutType": "ThreeColumnsEndExpanded"
        }
      }
    }
  }
}
```

**STEP**: External navigation and inbound parameters

**DESCRIPTION**: Merge externalNavigationSettings and inboundParameters at app-level.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template"
    },
    "entityPropertyChange": {
      "propertyPath": "settings",
      "operation": "UPSERT",
      "propertyValue": {
        "externalNavigationSettings": {
          "defaultOutboundSettings": {
            "refreshStrategyOnAppRestore": {
              "entitySets": {
                "STTA_C_MP_Product": "self"
              }
            }
          }
        },
        "inboundParameters": {
          "Supplier": {
            "useForCreate": true
          }
        }
      }
    }
  }
}
```

**STEP**: Add filterSettings (historySettings and dateSettings) on ListReport

**DESCRIPTION**: Add complex filterSettings including historySettings and dateSettings for a ListReport entitySet.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "entitySet": "STTA_C_MP_Product"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings",
      "operation": "UPSERT",
      "propertyValue": {
        "filterSettings": {
          "historySettings": {
            "historyEnabled": "enabled"
          },
          "dateSettings": {
            "useDateRange": false,
            "selectedValues": "DAYS,WEEK,MONTH,DATERANGE",
            "fields": {
              "SemanticDate1": {
                "selectedValues": "TOMORROW",
                "exclude": true
              },
              "SemanticDate2": {
                "defaultValue": {
                  "operation": "LASTYEAR"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Table and list report UI options (enableTableFilterInPageVariant, dataLoadSettings, condensed layout)

**DESCRIPTION**: Merge table-level and list report UI options.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "entitySet": "STTA_C_MP_Product"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings",
      "operation": "UPSERT",
      "propertyValue": {
        "enableTableFilterInPageVariant": true,
        "dataLoadSettings": {
          "loadDataOnAppLaunch": "never"
        },
        "condensedTableLayout": true
      }
    }
  }
}
```

**STEP**: TableSettings: type, multiSelect, selectAll, multiEdit

**DESCRIPTION**: Change tableSettings for the ListReport table.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "entitySet": "STTA_C_MP_Product"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings/tableSettings",
      "operation": "UPSERT",
      "propertyValue": {
        "type": "GridTable",
        "multiSelect": true,
        "selectAll": false,
        "multiEdit": {
          "enabled": true
        }
      }
    }
  }
}
```

**STEP**: Add fields to createWithParameterDialog

**DESCRIPTION**: Add fields to the createWithParameterDialog dialog under tableSettings for ListReport.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "entitySet": "STTA_C_SO_SalesOrder_ND"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings/tableSettings/createWithParameterDialog/fields",
      "operation": "UPSERT",
      "propertyValue": {
        "CurrencyCode": { "path": "CurrencyCode" }
      }
    }
  }
}
```

**STEP**: Object page editableHeaderContent and showRelatedApps

**DESCRIPTION**: Toggle header content editability and related apps visibility for a specific ObjectPage entitySet.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ObjectPage",
      "entitySet": "STTA_C_MP_Product"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings",
      "operation": "UPSERT",
      "propertyValue": {
        "editableHeaderContent": false,
        "showRelatedApps": false
      }
    }
  }
}
```

**STEP**: Add createMode for ObjectPage tableSettings

**DESCRIPTION**: Set createMode and multiSelect/selectAll for an ObjectPage's table settings.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ObjectPage",
      "entitySet": "STTA_C_SO_SalesOrder_ND"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings/tableSettings",
      "operation": "UPSERT",
      "propertyValue": {
        "createMode": "creationRows",
        "multiSelect": true,
        "selectAll": false
      }
    }
  }
}
```

**STEP**: Note about unsupported filterSettings items

**DESCRIPTION**: filter[] configurations per-field and customDateRangeImplementation inside filterSettings are not supported in adaptation merges.

**LANGUAGE**: text

**CODE**:
```text
Note: Adding or modifying filter[] configurations per field and customDateRangeImplementation inside filterSettings is not supported.
```

**STEP**: Include a selection presentation variant (ListReport annotationPath) and add local annotation file

**DESCRIPTION**: Reference a SelectionPresentationVariant via annotationPath in the ListReport settings and add the annotation file into the OData annotations dataSource using appdescr_app_addAnnotationsToOData. Create a local annotation XML at changes/annotations/annotations.xml and reference it in the change.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "entitySet": "STTA_C_MP_Product"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings",
      "operation": "UPSERT",
      "propertyValue": {
        "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#DefaultSPV"
      }
    }
  }
}
```

**STEP**: Add local OData annotation file to the app dataSource

**DESCRIPTION**: Reference the newly added local annotation XML in the app's OData annotation dataSources. The local file path is typically changes/annotations/annotations.xml.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_app_addAnnotationsToOData",
  "content": {
    "dataSourceId": "mainService",
    "annotations": ["customer.localAnnotationsNew"],
    "annotationsInsertPosition": "END",
    "dataSource": {
      "customer.localAnnotationsNew": {
        "uri": "changes/annotations/annotations.xml",
        "type": "ODataAnnotation"
      }
    }
  }
}
```

**STEP**: Example annotation file skeleton (changes/annotations/annotations.xml)

**DESCRIPTION**: Create a local annotation file for selection presentation variant and other annotations. Use correct OData edmx structure and include proper vocabulary references. Replace namespace, schema, and annotation content per your service model.

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="http://docs.oasis-open.org/odata/odata/v4.0/cs01/vocabularies/Org.OData.Capabilities.V1.xml">
    <edmx:Include Alias="Capabilities" Namespace="Org.OData.Capabilities.V1"/>
  </edmx:Reference>
  <edmx:Reference Uri="/sap/bc/ui5_ui5/ui2/ushell/resources/sap/ushell/components/factsheet/vocabularies/UI.xml">
    <edmx:Include Alias="UI" Namespace="com.sap.vocabularies.UI.v1"/>
  </edmx:Reference>
  <edmx:DataServices>
    <Schema Namespace="STTA_PROD_MAN" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <!-- Add Annotation/SelectionPresentationVariant definitions here -->
      <!-- Example SelectionVariant/SelectionPresentationVariant entries go here -->
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: Include a reuse component in the adaptation project

**DESCRIPTION**: Add an embedded reuse component to an ObjectPage and declare the component usage and library in manifest.appdescr_variant. Also add necessary neo-app.json headerWhiteList entries for certain reuse components (e.g., attachments).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ObjectPage",
      "entitySet": "C_PaymentRunPlanTP"
    },
    "entityPropertyChange": {
      "propertyPath": "embeddedComponents",
      "operation": "UPSERT",
      "propertyValue": {
        "simple::Attachments": {
          "id": "simple::Attachments",
          "componentUsage": "attachmentReuseComponent",
          "title": "Attachment",
          "settings": {
            "mode": "C",
            "objectType": "SCASE",
            "objectKey": "{PaymentRunPlanName}",
            "isGuid": true
          }
        }
      }
    }
  }
}
```

**STEP**: Declare component usage (manifest.appdescr_variant)

**DESCRIPTION**: Declare the component usage name and target library for the reuse component.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui5_addComponentUsages",
  "content": {
    "componentUsages": {
      "attachmentReuseComponent": {
        "name": "sap.se.mi.plm.lib.attachmentservice.attachment.components.stcomponent",
        "settings": {}
      }
    }
  }
}
```

**STEP**: Add required libraries (manifest.appdescr_variant)

**DESCRIPTION**: Ensure the reuse component's parent library is declared (minVersion/lazy settings).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "changeType": "appdescr_ui5_addLibraries",
  "content": {
    "libraries": {
      "sap.se.mi.plm.lib.attachmentservice": {
        "minVersion": "Active",
        "lazy": true
      }
    }
  }
}
```

**STEP**: neo-app.json: add headerWhiteList entries for reuse components

**DESCRIPTION**: Add header names required by reuse components to neo-app.json -> headerWhiteList (consuming application).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "headerWhiteList": [
    "objecttype",
    "objectkey",
    "slug",
    "MarkForDeletion",
    "documentType",
    "documentNumber",
    "documentVersion",
    "documentPart",
    "semanticobjecttype"
  ]
}
```
--------------------------------

**TITLE**: Extension Point for List Report Header (customHeader fragments)

**INTRODUCTION**: Use the list report header extension point to add custom UI above the filter bar. Register separate UI5 XML fragments for expanded and collapsed header states in manifest.json and implement those fragments as .fragment.xml files in your project. This document shows the exact manifest entry, module-to-file mapping, and example fragment contents to plug into a Fiori elements List Report (SAP FE) app.

**TAGS**: fiori-elements, sap.fe, list-report, header-extension, manifest.json, fragments, UI5, extension-point

**STEP**: 1 — Register customHeader fragments in manifest.json

**DESCRIPTION**: Add a "customHeader" entry under the List Report target settings. Provide module names for expanded and collapsed header fragments. Module names map to files by replacing dots with slashes and appending ".fragment.xml".

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (excerpt)
{
  "sap.app": {
    // ...
  },
  "sap.ui5": {
    "routing": {
      // ...
    },
    "targets": {
      "sample": {
        "type": "Component",
        "id": "Default",
        "name": "sap.fe.templates.ListReport",
        "options": {
          "settings": {
            "contextPath": "/RootEntity",
            "variantManagement": "Page",
            "initialLoad": true,
            "liveMode": true,
            "content": {
              "header": {
                "customHeader": {
                  "expandedHeaderFragment": "sap.fe.core.fpmExplorer.customListReportHeaderContent.CustomExpandedHeader",
                  "collapsedHeaderFragment": "sap.fe.core.fpmExplorer.customListReportHeaderContent.CustomCollapsedHeader"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

Notes:
- Module name "sap.fe.core.fpmExplorer.customListReportHeaderContent.CustomExpandedHeader" resolves to file:
  webapp/sap/fe/core/fpmExplorer/customListReportHeaderContent/CustomExpandedHeader.fragment.xml
- Similarly for the collapsed fragment.

**STEP**: 2 — Create the expanded header fragment

**DESCRIPTION**: Implement the expanded header XML fragment. Use UI5 controls, data binding, and any needed IDs. This fragment is displayed when the List Report header is expanded.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/sap/fe/core/fpmExplorer/customListReportHeaderContent/CustomExpandedHeader.fragment.xml -->
<core:FragmentDefinition
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:layout="sap.ui.layout">
  <!-- Example: two-column layout with title + description -->
  <VBox class="sapUiSmallMargin">
    <HBox justifyContent="SpaceBetween" alignItems="Center">
      <VBox>
        <Title text="Custom Expanded Header" level="H2" />
        <Text text="{/HeaderDescription}" />
      </VBox>
      <Button text="Custom Action" press=".onCustomHeaderAction" />
    </HBox>
    <!-- Example: additional controls that may interact with the List Report -->
    <Toolbar>
      <Label text="Quick Filter:"/>
      <Input placeholder="Enter value" liveChange=".onQuickFilterLiveChange"/>
    </Toolbar>
  </VBox>
</core:FragmentDefinition>
```

Implementation notes:
- event handlers (.onCustomHeaderAction, .onQuickFilterLiveChange) must be implemented in the corresponding controller (component controller or view controller depending on your app wiring).
- Use data binding paths available in your app (e.g., properties from /RootEntity or model names).

**STEP**: 3 — Create the collapsed header fragment

**DESCRIPTION**: Implement the collapsed header XML fragment. Keep it compact; it is displayed when the header is collapsed.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/sap/fe/core/fpmExplorer/customListReportHeaderContent/CustomCollapsedHeader.fragment.xml -->
<core:FragmentDefinition
  xmlns="sap.m"
  xmlns:core="sap.ui.core">
  <HBox justifyContent="SpaceBetween" alignItems="Center" class="sapUiSmallMargin">
    <Title text="Custom Collapsed Header" level="H3" />
    <Button icon="sap-icon://action" press=".onCollapsedAction" tooltip="Collapsed action"/>
  </HBox>
</core:FragmentDefinition>
```

**STEP**: 4 — Implement controller handlers and module placement

**DESCRIPTION**: Place any controller logic where the fragments can resolve their event handlers. Typical options:
- Put handlers on the List Report controller or a component-level controller and reference them by relative path when the fragment is loaded by the framework.
- Ensure the module path of your controller is reachable; event handler names in fragments are method names resolved against the control's controller context.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/controller/CustomHeader.controller.js (example)
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/m/MessageToast"
], function (Controller, MessageToast) {
  "use strict";
  return Controller.extend("your.app.namespace.controller.CustomHeader", {
    onCustomHeaderAction: function () {
      MessageToast.show("Custom expanded header action triggered");
    },
    onQuickFilterLiveChange: function (oEvent) {
      var sValue = oEvent.getParameter("value");
      // implement quick filter push to list report filter or model update
      console.log("Quick filter value:", sValue);
    },
    onCollapsedAction: function () {
      MessageToast.show("Collapsed header action triggered");
    }
  });
});
```

Integration notes:
- Ensure this controller is loaded (e.g., declared in component.js or used by the view). If the fragment event handlers are not resolved, attach handlers programmatically after fragment initialization.

**STEP**: 5 — Verify and debug

**DESCRIPTION**: Run the app and confirm:
- Expanded header fragment is visible when header is expanded.
- Collapsed header fragment appears when header is collapsed.
- Buttons and inputs trigger your handlers.

Helpful commands:
- Start UI5 app (e.g., npm start / ui5 server)
- Open the Flexible Programming Model explorer live example:
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/customElements/customListReportHeaderContent

**LANGUAGE**: text

**CODE**:
```text
File mapping summary:
- manifest.json entry -> module name(s):
  sap.fe.core.fpmExplorer.customListReportHeaderContent.CustomExpandedHeader
  sap.fe.core.fpmExplorer.customListReportHeaderContent.CustomCollapsedHeader

- Files to create:
  webapp/sap/fe/core/fpmExplorer/customListReportHeaderContent/CustomExpandedHeader.fragment.xml
  webapp/sap/fe/core/fpmExplorer/customListReportHeaderContent/CustomCollapsedHeader.fragment.xml

- Optional controller:
  webapp/controller/CustomHeader.controller.js
```


--------------------------------

**TITLE**: React to Back-End Property Updates with extensionAPI.watchProperty (SAP Fiori elements, OData V4)

**INTRODUCTION**: Use extensionAPI.watchProperty in a page controller extension to run custom logic when a back-end property value changes. This is applicable for SAP Fiori elements with OData V4. 1:n navigation properties are not supported. Call watchProperty inside your controller extension (commonly in onInit) and implement the callback to handle newValue, oldValue, isInitial, and context.

**TAGS**: fiori-elements-framework, OData V4, extensionAPI, watchProperty, controller-extension, SAPUI5

**STEP**: 1 — Callback parameters and behavior

**DESCRIPTION**: Reference the callback signature and behavior. Use these parameters to decide what to do when a property is (re)loaded or updated from the back end. Note: isInitial === true when the property is received for the first time from the back end.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Callback signature for extensionAPI.watchProperty
// newValue  : the new value of the property
// oldValue  : the previous value of the property (undefined if not known)
// isInitial : true when the property is loaded for the first time from the back end
// context   : page context object (useful to get binding/context information)
function onPropertyChange(newValue, oldValue, isInitial, context) {
    // Implement your update logic here
}
```

**STEP**: 2 — Implement watchProperty in a Controller Extension (JavaScript sample)

**DESCRIPTION**: Add a controller extension file and call this.base.getExtensionAPI().watchProperty inside onInit. The sample shows how to display and hide messages using showMessages and hideMessage when a boolean property isHotCountry becomes true/false. Replace "isHotCountry" with your property name and adapt message handling as needed.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define(
    [
        "sap/ui/core/mvc/ControllerExtension",
        "sap/ui/core/message/Message",
        "sap/ui/core/message/MessageType"
    ],
    function (ControllerExtension, Message, MessageType) {
        "use strict";

        return ControllerExtension.extend("watchProperties.basic.OPExtend", {
            override: {
                onInit: function () {
                    // Register a watcher for a single property named "isHotCountry"
                    this.base.getExtensionAPI().watchProperty("isHotCountry",
                        (newValue, oldValue, isInitial, context) => {
                            // Example: show an informational message when newValue === true
                            if (newValue === true) {
                                const messages = [
                                    new Message({
                                        message: "Employee is in a hot country",
                                        type: MessageType.Information
                                    })
                                ];
                                this.base.getExtensionAPI().showMessages(messages);
                            } else {
                                // Hide previously shown message(s)
                                this.base.getExtensionAPI().hideMessage();
                            }
                        }
                    );
                }
            }
        });
    }
);
```

**STEP**: 3 — Practical notes and constraints

**DESCRIPTION**: Keep these implementation details in mind when coding:
- Only for SAP Fiori elements with OData V4.
- 1:n navigation properties are not supported by watchProperty.
- Call watchProperty in the page controller extension (commonly onInit) so the watcher is active for the page lifecycle.
- Use the context parameter if you need binding or entity information within the callback.

**LANGUAGE**: Plain text

**CODE**:
```text
Notes:
- Replace "isHotCountry" with your target property name.
- Use showMessages(messagesArray) to surface UI messages and hideMessage() to clear them.
- The callback receives (newValue, oldValue, isInitial, context).
- Ensure any cleanup or state handling fits your page lifecycle if you create long-lived resources.
```
--------------------------------

**TITLE**: Extension Points for Forms on the Object Page (OData V2 & V4)

**INTRODUCTION**: Actionable guidance and code snippets for extending forms on the Object Page in SAP Fiori elements. Covers: use-of-extensionAPI guidance, OData V2 SmartFormExtension manifest entry, OData V4 custom form elements (XML fragment + manifest controlConfiguration), custom field properties, UI model and metadata binding examples, and a live example link.

**TAGS**: fiori-elements-framework, object-page, forms, extension-points, custom-fields, manifest, xmlfragment, ODataV2, ODataV4

**STEP**: 1 — Extension API and general caution

**DESCRIPTION**: Use app extensions only when manifest settings or annotations cannot achieve the needed behavior. Always use only the SAP Fiori elements extensionAPI. Do not access or manipulate internal framework controls, properties, models, or other internal objects. After adding an extension you are responsible for its display and system behavior.

**LANGUAGE**: Text

**CODE**:
```Text
Guideline:
- Use only the SAP Fiori elements extensionAPI for integrating app extensions.
- Avoid direct manipulation of controls/models created by Fiori elements.
- Prefer manifest settings or annotations before creating app extensions.
```

**STEP**: 2 — OData V2: Add fields to an existing FieldGroup via SmartFormExtension (manifest.json)

**DESCRIPTION**: Register a fragment as a SmartFormExtension to add fields into an existing FieldGroup on the Object Page. The key format is "SmartFormExtension|<EntityName>|<FieldGroupAnnotation>".

Notes:
- For OData V2 SmartFormExtension, className must be "sap.ui.core.Fragment".

**LANGUAGE**: JSON

**CODE**:
```json
// File: manifest.json (snippet)
{
  "sap.suite.ui.generic.template.ObjectPage.view.Details": {
    "SmartFormExtension|STTA_C_MP_Product|com.sap.vocabularies.UI.v1.FieldGroup::GeneralInformation": {
      "className": "sap.ui.core.Fragment",
      "fragmentName": "STTA_MP.ext.fragments.SmartFormGroupElement",
      "type": "XML"
    }
  }
}
```

**STEP**: 3 — OData V4: Overview — two required pieces for custom fields

**DESCRIPTION**: For OData V4 custom form elements you must:
1. Implement the XML fragment that contains the fragment content (the fragment is the UI control(s) you want to add).
2. Register the custom field definition in the manifest (controlConfiguration) to position it and provide label/keys.

**LANGUAGE**: Text

**CODE**:
```Text
Two-step process:
1) Create XML fragment defining the custom form element (UI content).
2) Register the custom field in manifest.json under routing -> targets -> <ObjectPageTarget> -> options -> settings -> controlConfiguration -> @com.sap.vocabularies.UI.v1.FieldGroup -> fields
```

**STEP**: 4 — OData V4: XML fragment example (CustomFormElement.fragment.xml)

**DESCRIPTION**: Example fragment defining the form element content. Place this fragment file in your project (for example: webapp/ext/fragments/CustomFormElement.fragment.xml or matching the fragmentName used in the manifest).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/fragments/CustomFormElement.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
    <Text id="customFieldFormSoldToPartyInputField" text="{SoldToParty}" />
</core:FragmentDefinition>
```

**STEP**: 5 — OData V4: Register custom fields in manifest.json (controlConfiguration)

**DESCRIPTION**: Register custom fields by adding entries under controlConfiguration for the relevant FieldGroup annotation. Provide: key, template (fragment alias or module), label (i18n or metaModel binding), position (placement + anchor). The manifest snippet below shows two custom fields, where the second is positioned after the first.

**LANGUAGE**: JSON

**CODE**:
```json
// File: manifest.json (snippet)
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.FieldGroup": {
                  "fields": {
                    "customFormElementAnchor": {
                      "template": "ObjectPageStructure.ext.CustomField",
                      "label": "{i18n>myFieldLabel1}",
                      "position": {
                        "placement": "After",
                        "anchor": "DataField::SalesOrder"
                      }
                    },
                    "customFormElementAnchor2": {
                      "template": "ObjectPageStructure.ext.CustomField",
                      "label": "{i18n>myFieldLabel2}",
                      "position": {
                        "placement": "After",
                        "anchor": "customFormElementAnchor"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — Custom field properties (keys, label, position, template)

**DESCRIPTION**: Required/used properties for each custom field entry in controlConfiguration. Use these to identify, position, label, and map to fragment/template.

**LANGUAGE**: Text

**CODE**:
```Text
Properties:
- key: Identifier for the custom field. Allowed characters: A-Za-z0-9, :, _, -
- label: Any Unicode string OR metadata binding (see metadata binding example)
- position:
  - placement: "After" | "Before"
  - anchor: "<key_of_column>" -> the key of another field used as placement anchor
- template: Module/fragment identifier (follows Fragment.load syntax). Should reference the fragment that renders the custom field.

Notes:
- The key is used as an anchor reference by other custom fields.
- Template should point to a fragment that is accessible at runtime, e.g. ObjectPageStructure.ext.CustomField -> resolves to a fragment module.
```

**STEP**: 7 — Use the UI model expression inside fragments to react to edit mode

**DESCRIPTION**: Example showing how to bind a control property (enabled) to the ui model editMode using an expression binding in XML fragments.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Use inside your fragment -->
<Button text="Save"
        enabled="{= ${ui>/editMode} === 'Editable'}" />
```

**STEP**: 8 — Metadata binding for custom field labels (manifest.json)

**DESCRIPTION**: Use metaModel path binding to derive label values from metadata instead of i18n. This snippet shows label resolved from the meta model.

**LANGUAGE**: JSON

**CODE**:
```json
// File: manifest.json (snippet)
{
  "customFormElementAnchor3": {
    "template": "ObjectPageStructure.ext.CustomField",
    "label": "{metaModel>/SalesOrderManage/SoldToParty@com.sap.vocabularies.Common.v1.Label}",
    "position": {
      "placement": "After",
      "anchor": "customFormElementAnchor"
    }
  }
}
```

**STEP**: 9 — SmartForm / Fragment implementation notes

**DESCRIPTION**: Implementation constraints and mapping details.

**LANGUAGE**: Text

**CODE**:
```Text
Notes:
- OData V2: SmartFormExtension supports only "sap.ui.core.Fragment" as className.
- Template resolution: "template" entries follow Fragment.load syntax (module/fragment path).
- Ensure fragmentName/module path in manifest matches the actual fragment file location.
- After creation, extension display and runtime behavior (bindings, busy handling, layout) are the application's responsibility.
```

**STEP**: 10 — Live example and further reading

**DESCRIPTION**: Explore and test code in the flexible programming model explorer.

**LANGUAGE**: Text

**CODE**:
```Text
Live example:
- Custom Form Element Explorer: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/customElements/customElementsOverview/customFormElementContent

Related documentation:
- Using the extensionAPI
- Defining and Adapting Sections
```
--------------------------------

**TITLE**: Extension Points and Manifest Configurations for Object Page Header Facets (OData V2 & V4)

**INTRODUCTION**: Practical, code-focused reference for adding or replacing Object Page header facets and header fields in SAP Fiori Elements applications. Includes manifest.json patterns (viewExtensions and content/annotation-based settings), available extension keys, sample XML fragments for custom header facets (display and editable), and the extensionAPI setCustomMessage usage.

**TAGS**: fiori-elements-framework, object-page, header-facets, extension-points, manifest, sapui5, odata-v2, odata-v4, custom-header-facet, custom-header-field, extensionAPI

**STEP**: 1 — Add a header facet extension (OData V2) via viewExtensions in manifest.json

**DESCRIPTION**: Use viewExtensions in manifest.json to insert, replace or append a header facet implementation (an XML view) into the Object Page Details view for a specific entity set and annotation path. Format the extension key as:
- <Scenario>|<EntitySet_Name>|headerEditable::<Annotation_Information>
Provide className (sap.ui.core.mvc.View), viewName (module path), type ("XML"), and optional bVisibleOnEdit (true/false). Only use extensionAPI in your fragment controller; do not manipulate Fiori Elements internals.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "BeforeHeaderFacet|STTA_C_MP_Product|headerEditable::com.sap.vocabularies.UI.v1.Chart::SpecificationWidthBulletChart": {
            "className": "sap.ui.core.mvc.View",
            "viewName": "STTA_MP.ext.fragments.HeaderExtensionFacet",
            "type": "XML",
            "bVisibleOnEdit": true
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Available OData V2 extension keys (insert position and facet types)

**DESCRIPTION**: Use these keys as the manifest extension key (replace placeholders). They target standard header facets, simple header facets, image/NoImage scenarios, dataPoint-only header, or replace entire header.

**LANGUAGE**: JSON

**CODE**:
```json
// Standard object header facet
"BeforeHeaderFacet|<EntitySet>|headerEditable::<AnnotationPath>"
"ReplaceHeaderFacet|<EntitySet>|headerEditable::<AnnotationPath>"
"AfterHeaderFacet|<EntitySet>|headerEditable::<AnnotationPath>"

// Simple object header facet
"BeforeSimpleHeaderFacet|<EntitySet>|headerEditable::<AnnotationPath>"
"ReplaceSimpleHeaderFacet|<EntitySet>|headerEditable::<AnnotationPath>"
"AfterSimpleHeaderFacet|<EntitySet>|headerEditable::<AnnotationPath>"

// Replace entire object page header (no UI.HeaderFacet annotation must exist)
"ReplaceHeaderExtensionFacet|<EntitySet>"

// No-image header extension (only when no ImageUrl/TypeImageUrl present in UI.HeaderInfo)
"NoImageExtensionFacet|<EntitySet>"

// Insert after image (only when image exists)
"AfterImageExtensionFacet|<EntitySet>"

// DataPoint-only header facet
"BeforeHeaderDataPoint|<EntitySet>|<AnnotationPath>"
"ReplaceHeaderDataPoint|<EntitySet>|<AnnotationPath>"
"AfterHeaderDataPoint|<EntitySet>|<AnnotationPath>"
```

**STEP**: 3 — Show custom status message in Object Page header (extensionAPI.setCustomMessage)

**DESCRIPTION**: Attach to page data loaded event via extensionAPI.attachPageDataLoaded and call extensionAPI.setCustomMessage with an object { message, type } where type is sap.ui.core.MessageType.*.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define([], function () {
    return {
        onInit: function () {
            // attach handler to page data loaded
            this.extensionAPI.attachPageDataLoaded(this.onPageDataLoaded.bind(this));
        },
        onPageDataLoaded: function (oEvent) {
            // example: read property 'quantity' from current context
            var quantity = oEvent.context.getObject().quantity;
            var oMsg = {
                message: quantity == 0 ? "Product Not Available!" : "Product Available!",
                type: quantity == 0 ? sap.ui.core.MessageType.Error : sap.ui.core.MessageType.Success
            };
            // set custom message on the object page header
            this.extensionAPI.setCustomMessage(oMsg);
        }
        // ... other handlers
    };
});
```

**STEP**: 4 — Define custom header facets (OData V4) — content-based manifest configuration

**DESCRIPTION**: Add custom header facets in the routing target options > settings > content.header.facets. Use unique keys. Content-based entries have higher priority than annotation-based controlConfiguration entries. Define template (module path to XMLFragment), optional templateEdit, title/subTitle (binding or i18n), position with placement ("Before"|"After") and anchor (facet key), visible/stashed, requestGroupId and flexSettings.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  "facets": {
                    "CustomHeaderFacet1": {
                      "template": "SalesOrder.ext.CustomHeaderFacetColumnChart",
                      "stashed": false,
                      "visible": "{= %{OverallSDProcessStatus} === 'C'}",
                      "position": {
                        "placement": "After",
                        "anchor": "NetValueDataHeader"
                      },
                      "flexSettings": {
                        "designtime": "not-adaptable-visibility"
                      }
                    },
                    "CustomHeaderFacet2": {
                      "template": "SalesOrder.ext.CustomHeaderFacetDataPoint",
                      "templateEdit": "SalesOrder.ext.CustomHeaderFacetDataPointEdit",
                      "title": "{i18n>customHeaderFacet2-CustomDataPoint}",
                      "subTitle": "{i18n>customHeaderFacet2-CarRental}",
                      "requestGroupId": "LongRunners",
                      "stashed": false,
                      "position": {
                        "placement": "After",
                        "anchor": "CustomHeaderFacet1"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Define custom header facets (OData V4) — annotation-based controlConfiguration fallback

**DESCRIPTION**: When not present in content-based configuration, provide controlConfiguration under settings with @com.sap.vocabularies.UI.v1.HeaderFacets.facets mapping. Keys must match facet keys referenced in the header facet annotation or the custom keys.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  "...": "see content-based sample above"
                }
              },
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.HeaderFacets": {
                  "facets": {
                    "CustomHeaderFacet2": {
                      "template": "SalesOrder.ext.CustomHeaderFacetOverwritten",
                      "title": "Custom Error",
                      "subTitle": "Should never appear!",
                      "stashed": false,
                      "position": {
                        "placement": "After",
                        "anchor": "CustomHeaderFacet1"
                      }
                    },
                    "CustomHeaderFacet3": {
                      "template": "SalesOrder.ext.CustomHeaderFacetHarveyBall",
                      "templateEdit": "SalesOrder.ext.CustomHeaderFacetHarveyBallEdit",
                      "title": "{i18n>customHeaderFacet2-CustomProgress}",
                      "stashed": false,
                      "position": {
                        "placement": "After",
                        "anchor": "CustomHeaderFacet2"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — Custom header facet properties (quick reference)

**DESCRIPTION**: Use these properties in your custom header facet entry (content or controlConfiguration). Keep the property names and supported values as shown.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "template": "Module path of XMLFragment (Fragment.load syntax)",
  "templateEdit": "Module path of editable XMLFragment (optional)",
  "title": "Text or binding expression (optional; use i18n binding if needed)",
  "subTitle": "Text or binding expression (optional)",
  "stashed": false, // Boolean (optional)
  "visible": true, // Boolean or binding expression (optional)
  "position": {
    "placement": "Before | After", // placement relative to anchor
    "anchor": "FacetKey"           // target facet key used as anchor
  },
  "requestGroupId": "Heroes | Decoration | Workers | LongRunners", // grouping for $batch
  "flexSettings": {
    "designtime": "Default | not-adaptable-visibility | not-adaptable | not-adaptable-tree | not-removable"
  }
}
```

**STEP**: 7 — Example: custom header facet display fragment (HarveyBallMicroChart)

**DESCRIPTION**: XMLFragment used as the display template for a custom header facet. Use this fragment module path in the manifest template property.

**LANGUAGE**: XML

**CODE**:
```xml
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:mc="sap.suite.ui.microchart">
    <VBox id="CustomHeaderFacetHarveyBall" displayInline="true">
        <mc:HarveyBallMicroChart size="S" total="100" totalScale="%" press="press">
            <mc:items>
                <mc:HarveyBallMicroChartItem
                    fraction="{= ((100 > 0) ? ((${Progress} > 100) ? 100 : ((${Progress} &lt; 0) ? 0 : (${Progress} / 100 * 100))) : 0) }"
                    color="Good"
                    fractionScale="%"
                />
            </mc:items>
        </mc:HarveyBallMicroChart>
    </VBox>
</core:FragmentDefinition>
```

**STEP**: 8 — Example: editable custom header facet fragment (FormElement + macro:Field)

**DESCRIPTION**: When the object page is in edit mode, the templateEdit fragment is displayed inside a FormContainer. Use FormElement with macro:Field to bind editable fields.

**LANGUAGE**: XML

**CODE**:
```xml
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:f="sap.ui.layout.form" xmlns:macro="sap.fe.macros">
    <f:FormElement label="Number of Items">
        <f:fields>
            <macro:Field id="NumberItems" metaPath="fieldControlType_item" />
        </f:fields>
    </f:FormElement>
    <f:FormElement label="Classification">
        <f:fields>
            <macro:Field id="IncotermsClassification" metaPath="IncotermsClassification" />
        </f:fields>
    </f:FormElement>
</core:FragmentDefinition>
```

**STEP**: 9 — Add custom header fields (OData V4) via annotation-based controlConfiguration

**DESCRIPTION**: Define fields inside controlConfiguration keyed by the field group qualifier (e.g. "@com.sap.vocabularies.UI.v1.FieldGroup#ObjectPageHeaderData"). Each field entry defines label (optional), template (module path to XMLFragment), and position (placement and anchor = property name or field key).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "LineItemsObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.FieldGroup#ObjectPageHeaderData": {
                  "fields": {
                    "CustomField1": {
                      "label": "{i18n>ObjectPageHeaderFacetFieldLabel1}",
                      "template": "ManageItems.ext.CustomHeaderFacetFieldGroupForm",
                      "position": {
                        "placement": "Before",
                        "anchor": "DataField::headerDate"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 10 — Metadata annotation example for FieldGroup qualifier (to find qualifier used in controlConfiguration)

**DESCRIPTION**: FieldGroup qualifier is used in controlConfiguration key: @com.sap.vocabularies.UI.v1.FieldGroup#<Qualifier>. Use metadata to find the qualifier.

**LANGUAGE**: XML

**CODE**:
```xml
<Schema>
    <Annotations Target="<PageName>">
        <Annotation Term="UI.FieldGroup" Qualifier="ObjectPageHeaderData">
            <!-- records -->
        </Annotation>
    </Annotations>
</Schema>
```

**STEP**: 11 — Priority rule & anchor key guidance

**DESCRIPTION**: - Content-based configuration overrides annotation-based configuration for the same keys. - For correct placement use an anchor key: header facets use FacetKey (from UI.Facet annotation), header fields use property name from field group/property annotation. If you need help finding anchor keys, consult "Finding the Right Key for the Anchor".

**LANGUAGE**: JSON

**CODE**:
```json
// Priority: content.header.facets (manifest content-based) > controlConfiguration (annotation-based)
// Anchor: use FacetKey (for facets) or property name (for fields) when setting position.anchor
```

**STEP**: 12 — Runtime and integration notes (actionable)

**DESCRIPTION**: - Only use the official extensionAPI when interacting with the page (attachPageDataLoaded, setCustomMessage, etc.). - If you replace the full header (ReplaceHeaderExtensionFacet), remove UI.HeaderFacet annotations from metadata. - Use bVisibleOnEdit: false to hide the entire header extension in edit mode. - Use requestGroupId to group backend requests to $batch groups for better perceived performance.

**LANGUAGE**: JSON

**CODE**:
```json
// Example: Hide header extension in edit mode
{
  "className": "sap.ui.core.mvc.View",
  "viewName": "STTA_MP.ext.fragments.HeaderExtensionFacet",
  "type": "XML",
  "bVisibleOnEdit": false
}
```
--------------------------------

**TITLE**: Extension Points for Pages — Custom Pages in SAP Fiori elements (OData V4)

**INTRODUCTION**: Instructions and ready-to-use code examples to add custom pages to an SAP Fiori elements app (OData V4). Shows manifest routing targets, custom XML view(s) with binding context, custom page controller using the routing controller extension for context-based navigation, and how to use building blocks (macros:Table) inside a custom page. Place XML views under app/webapp following your sap.app.id namespace (viewName uses sap.app.id prefix).

**TAGS**: fiori-elements-framework, sap-fe, custom-page, routing, odata-v4, fpm, building-blocks, macros, xml-view, controller

**STEP**: 1 — Add routing targets to manifest.json

**DESCRIPTION**: Add routing routes and targets to your app manifest (manifest.json). Define custom pages as targets of type "Component" using name "sap.fe.core.fpm" (for flexible programming model support) and point viewName to the XML view (prefix viewName with your sap.app.id and relative path under app/webapp). Use contextPath to bind the OData entity set to the custom component.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": ":?query:",
          "name": "customPage",
          "target": "customPage"
        },
        {
          "pattern": "/RootEntity({key}):?query:",
          "name": "objectPage",
          "target": "objectPage"
        },
        {
          "pattern": "/RootEntity({key})/items({key2}):?query:",
          "name": "customDetailPage",
          "target": "customDetailPage"
        }
      ],
      "targets": {
        "customPage": {
          "type": "Component",
          "id": "customPage",
          "name": "sap.fe.core.fpm",
          "options": {
            "settings": {
              "viewName": "your.app.namespace.fpmExplorer.customPageContent.CustomPage",
              "contextPath": "/RootEntity",
              "navigation": {
                "RootEntity": {
                  "detail": {
                    "route": "objectPage"
                  }
                }
              }
            }
          }
        },
        "objectPage": {
          "type": "Component",
          "id": "objectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "contextPath": "/RootEntity",
              "editableHeaderContent": false,
              "navigation": {
                "items": {
                  "detail": {
                    "route": "customDetailPage"
                  }
                }
              }
            }
          }
        },
        "customDetailPage": {
          "type": "Component",
          "id": "customDetailPage",
          "name": "sap.fe.core.fpm",
          "options": {
            "settings": {
              "viewName": "your.app.namespace.fpmExplorer.customPageContent.CustomDetailPage",
              "contextPath": "/ChildEntity",
              "navigation": {}
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Custom page target properties (summary & required keys)

**DESCRIPTION**: Use these keys in a target definition to ensure flexible programming model behavior. viewName must include your sap.app.id prefix and the path relative to app/webapp. contextPath is the entity set binding (e.g., "/RootEntity"). Use "sap.fe.core.fpm" as name to enable FPM features.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "type": "Component",
  "id": "customPage",                    /* unique_page_id */
  "name": "sap.fe.core.fpm",             /* required to support FPM and building blocks */
  "options": {
    "settings": {
      "viewName": "your.app.namespace.fpmExplorer.customPageContent.CustomPage", /* sap.app.id + path + view file */
      "contextPath": "/RootEntity",    /* entity set root for data binding */
      "navigation": { /* optional navigation mapping to other routes */ }
    }
  }
}
```

**STEP**: 3 — Implement a custom XML view using the binding context (GenericTile example)

**DESCRIPTION**: Create the XML view file at app/webapp/fpmExplorer/customPageContent/CustomPage.view.xml (matching viewName). The binding context is available in the view and controls. Example: iterating /RootEntity bound to a HorizontalLayout with GenericTile items. The controller onPressed uses the binding context to navigate.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
    id="application-product"
    height="100%"
    controllerName="sap.fe.core.fpmExplorer.customPageContent.CustomPage"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:l="sap.ui.layout"
    xmlns:macros="sap.fe.macros">
    <Page>
        <content>
            <l:HorizontalLayout id="TileContainerExpanded" allowWrapping="true" content="{/RootEntity}" class="sapUiTinyMarginTopBottom">
                <GenericTile header="{TitleProperty}" subheader="{DescriptionProperty}" press="onPressed" class="sapUiTinyMarginEnd">
                    <TileContent unit="{unit}" footer="{footer}">
                        <NumericContent withMargin="false" value="{kpivalue}" valueColor="{color}" indicator="{trend}" scale="{scale}" />
                    </TileContent>
                </GenericTile>
            </l:HorizontalLayout>
        </content>
    </Page>
</mvc:View>
```

**STEP**: 4 — Implement the custom page controller with context-based navigation

**DESCRIPTION**: Create the controller at app/webapp/fpmExplorer/customPageContent/CustomPage.controller.js. Use sap.fe.core.PageController (provides this.routing controller extension) and call this.routing.navigate(oContext) to navigate using the binding context.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define(["sap/fe/core/PageController", "sap/ui/core/UIComponent"], function(PageController, UIComponent) {
    "use strict";

    return PageController.extend("sap.fe.core.fpmExplorer.customPageContent.CustomPage", {
        onPressed: function(oEvent) {
            // Get binding context of the pressed GenericTile (or any control)
            var oContext = oEvent.getSource().getBindingContext();
            // Navigate using the routing controller extension (context-based navigation)
            this.routing.navigate(oContext);
        }
    });
});
```

**STEP**: 5 — Use building blocks (macros:Table) in a custom page (with standard routing support)

**DESCRIPTION**: Use the macros Table building block inside your custom XML view. The table respects UI annotations, routing, and draft flow just like in standard pages. No explicit row press handler required for navigation when navigation is defined in target settings.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
    id="application-product-table"
    height="100%"
    controllerName="sap.fe.core.fpmExplorer.customPageContent.CustomPage"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:macros="sap.fe.macros">
    <Page>
        <content>
            <macros:Table contextPath="/RootEntity" metaPath="@com.sap.vocabularies.UI.v1.LineItem" id="macroTable" />
        </content>
    </Page>
</mvc:View>
```

**STEP**: 6 — Notes and live example

**DESCRIPTION**: Important constraints and reference:
- Applicable only to SAP Fiori elements for OData V4.
- viewName must contain sap.app.id as prefix and map to files under app/webapp.
- Use "sap.fe.core.fpm" for Component targets to enable FPM features and building blocks.
- Live playground: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/customElements/customElementsOverview/customPageContent

**LANGUAGE**: TEXT

**CODE**:
```text
Applicable only to SAP Fiori elements (OData V4).
Place XML view files under app/webapp using the namespace prefix in viewName.
Use sap.fe.core.fpm as target.name to enable FPM features and building blocks.
Live example: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/customElements/customElementsOverview/customPageContent
```
--------------------------------

**TITLE**: Extension Points and Custom Sections for Object Page (SAP Fiori elements)

**INTRODUCTION**: This document shows how to add application-specific sections to the Object Page in SAP Fiori elements. It covers:
- OData V2: manifest-based view/fragment extensions using extension keys (BeforeFacet / ReplaceFacet / AfterFacet).
- OData V4: manifest-based custom sections via routing target settings (content.body.sections).
Includes action-oriented steps, JSON/XML code examples, fragment templates, and required properties.

**TAGS**: fiori-elements-framework, object-page, extension-points, custom-sections, manifest.json, sap.ui.viewExtensions, sap.ui5, ODataV2, ODataV4

**STEP**: 1 — Important constraints & recommended API
**DESCRIPTION**: Use app extensions only when annotations or manifest settings cannot achieve the required UI/behavior. Always use the SAP Fiori elements extensionAPI and never directly manipulate internal framework controls, models, or properties created by the framework.
**LANGUAGE**: Text
**CODE**:
```Text
Caution:
- Use app extensions only when necessary.
- Use only the extensionAPI of SAP Fiori elements.
- Do NOT access or manipulate internal controls, properties, models or framework internals.
```

**STEP**: 2 — OData V2: Add extension points to manifest.json (BeforeFacet / ReplaceFacet / AfterFacet)
**DESCRIPTION**: For OData V2 object pages, define app extensions under "extends" -> "extensions" -> "sap.ui.viewExtensions". Each extension key follows this pattern:
  "<Placement>|<EntitySet>|<AnnotationPath>[|<optionalKey>]"

Placement values: BeforeFacet | ReplaceFacet | AfterFacet
- AnnotationPath example: to_ProductText::com.sap.vocabularies.UI.v1.LineItem
- You must supply the entitySet name (e.g., SEPMRA_C_PD_Product).
Add either a view or a fragment (XML) via className/fragmentName/type. Use sap.ui.generic.app.title and optional key property to identify multiple insertions.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "BeforeFacet|SEPMRA_C_PD_Product|to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "nw.epm.refapps.st.prod.manage.ext.BeforeFacetTest",
            "type": "XML",
            "sap.ui.generic.app": {
              "title": "Facet Breakout before Product Text LineItem"
            }
          },
          "BeforeFacet|SEPMRA_C_PD_Product|to_ProductText::com.sap.vocabularies.UI.v1.LineItem|1": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "nw.epm.refapps.st.prod.manage.ext.BeforeFacetTestNew",
            "type": "XML",
            "sap.ui.generic.app": {
              "title": "Facet Breakout before Product Text LineItem",
              "key": "1"
            }
          },
          "AfterFacet|SEPMRA_C_PD_Product|to_Supplier::com.sap.vocabularies.UI.v1.Identification": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "nw.epm.refapps.st.prod.manage.ext.AfterFacetTest",
            "type": "XML",
            "sap.ui.generic.app": {
              "title": "Facet Breakout after Supplier Identification"
            }
          },
          "AfterFacet|SEPMRA_C_PD_Product|to_Supplier::com.sap.vocabularies.UI.v1.Identification|1": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "nw.epm.refapps.st.prod.manage.ext.AfterFacetTest",
            "type": "XML",
            "sap.ui.generic.app": {
              "title": "Facet Breakout after Supplier Identification",
              "key": 1
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — OData V2: XML fragment template (example)
**DESCRIPTION**: Provide an XML fragment referenced by fragmentName in the manifest. Keep fragment self-contained (bindings to view model/ui model allowed). Do not query or manipulate internal object page controls.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: webapp/nw/epm/refapps/st/prod/manage/ext/BeforeFacetTest.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:uxap="sap.uxap">
  <VBox>
    <Text text="Custom BeforeFacet content for Product Text" />
    <!-- Use bindings to models only (oData model, ui model, etc.) -->
  </VBox>
</core:FragmentDefinition>
```

**STEP**: 4 — OData V4: Define custom sections in manifest.json (sap.ui5.routing.targets -> options.settings.content.body.sections)
**DESCRIPTION**: For OData V4, declare additional sections under the target route settings. Each section needs:
- key (object key in the JSON object; e.g., "customSection")
- template: module path to the UI5 fragment (mandatory for content)
- title: text or binding expression (recommended: i18n binding)
- position: { placement: "Before" | "After", anchor: "<sectionKeyOrFacetId>" } (anchor can be FacetId)
You can also define subSections inside a section to create nested subsections and position them relative to each other.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "customSection": {
                      "template": "SalesOrder.ext.CustomSection",
                      "title": "{i18n>customSection}",
                      "position": {
                        "placement": "Before",
                        "anchor": "SalesOrderItems"
                      }
                    },
                    "anotherCustomSection": {
                      "title": "Multiple Subsections",
                      "subSections": {
                        "firstSubSectionKey": {
                          "title": "First Subsection",
                          "template": "SalesOrder.ext.CustomFieldForm"
                        },
                        "secondSubSectionKey": {
                          "title": "Second Subsection",
                          "template": "SalesOrder.ext.CustomFieldForm2",
                          "position": {
                            "placement": "After",
                            "anchor": "firstSubSectionKey"
                          }
                        }
                      },
                      "position": {
                        "placement": "After",
                        "anchor": "customSection"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — OData V4: XML fragment template for custom section
**DESCRIPTION**: Implement the fragment referenced by the template path. Use standard XML fragment format and bind controls to the relevant models (odata, ui). For forms inside subsections, include the alignment class (see next step).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: webapp/SalesOrder/ext/CustomSection.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:form="sap.ui.layout.form">
  <VBox>
    <Text text="{i18n>customSectionHeader}" />
    <!-- Use UI building blocks (Form, Table, etc.). Bind to models and use ui model bindings as needed -->
  </VBox>
</core:FragmentDefinition>
```

**STEP**: 6 — Custom Section Properties (what to define and how)
**DESCRIPTION**: Use these properties when defining a custom section. All mandatory properties are marked.
- template (mandatory for content): module path to fragment (string). Must follow Fragment.load syntax (e.g., "SalesOrder.ext.CustomSection").
- title (mandatory): text or binding expression; typically i18n binding (e.g., "{i18n>customSection}").
- position: object that controls placement relative to another section.
  - position.placement: "Before" | "After" (default After).
  - position.anchor (mandatory when using position): key or FacetId of target section.
- visible: boolean or binding expression (default true). Use to toggle section rendering.
- actions: actions object (same format as adding custom actions using extension points).
Action: when adding a section, always provide title and either template or subSections. If using subSections, each subSection should have title and template.

**LANGUAGE**: Text
**CODE**:
```Text
Property actions:
- Use the same actions object format used for custom actions in Fiori elements.
- Place actions under the custom (sub-)section declaration.
```

**STEP**: 7 — Form alignment class for subsections
**DESCRIPTION**: When using Form controls inside a custom subsection, add class="sapUxAPObjectPageSubSectionAlignContent" to ensure correct alignment inside Object Page subsections.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Example Form inside a subsection fragment -->
<form:Form class="sapUxAPObjectPageSubSectionAlignContent" xmlns:form="sap.ui.layout.form" >
  <form:FormContainer>
    <form:FormElement>
      <form:label>
        <Label text="{i18n>someLabel}" />
      </form:label>
      <form:fields>
        <Input value="{pathToProperty}" />
      </form:fields>
    </form:FormElement>
  </form:FormContainer>
</form:Form>
```

**STEP**: 8 — Using the UI model binding inside fragments
**DESCRIPTION**: Use the ui model to react to editMode or other view-model state in fragment controls. Use expression binding for boolean properties.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Example: enable control only when ui>/editMode is 'Editable' -->
<Input enabled="{= ${ui>/editMode} === 'Editable'}" value="{pathToField}" />
```

**STEP**: 9 — Live example and final notes
**DESCRIPTION**:
- Live example: flexible programming model explorer — Custom Section:
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/customElements/customElementsOverview/customSectionContent
- Notes to implementers:
  - Ensure a LineItem service is available if your fragment/table uses LineItem data (e.g., service.cds in examples).
  - Add i18n translations for any title or text bindings.
  - For OData V2 use keys formatted as "<Placement>|<EntitySet>|<AnnotationPath>[|<optionalKey>]" under sap.ui.viewExtensions.
  - For OData V4 use routing target options.settings.content.body.sections and subSections with template and position.
**LANGUAGE**: Text
**CODE**:
```Text
Checklist:
- Add fragment files to corresponding module paths used in manifest templates.
- Register fragments with correct module path and file location (webapp/<module_path>.fragment.xml).
- Test section placement by setting position.anchor to a known FacetId (OData V4) or annotation path + entitySet (OData V2).
- Use extensionAPI for any controller-level interaction.
```
--------------------------------

**TITLE**: Object Page — Add Custom Subsections (Extension Points) for OData V2 and V4

**INTRODUCTION**: Practical reference to add custom subsections to an Object Page in SAP Fiori elements. Includes manifest.json patterns for OData V2 extension points (BeforeSubSection / AfterSubSection / ReplaceSubSection) and the OData V4 content-based custom subsection approach. Contains valid JSON examples, an XML fragment example, location conventions, and best-practice constraints (use extensionAPI only, lazy-loading support).

**TAGS**: fiori-elements-framework, object-page, extension-points, subsections, facets, sections, manifest.json, ODataV2, ODataV4, xmlfragment, lazy-loading

**STEP**: 1 — Add extension point entries (OData V2) to manifest.json

**DESCRIPTION**: Insert custom subsection views or fragments into an existing facet by adding entries under sap.ui.viewExtensions for the ObjectPage details view. Keys follow this pattern:
- BeforeSubSection|<EntitySet>|<AnnotationPath>::<AnnotationTerm>
- AfterSubSection|<EntitySet>|<AnnotationPath>::<AnnotationTerm>
- ReplaceSubSection|<EntitySet>|<AnnotationPath>::<AnnotationTerm>

Specify the entitySet name and the full annotation path. You may reference a view (className: "sap.ui.core.mvc.View") or a fragment. Use sap.ui.generic.app.enableLazyLoading to enable lazy loading when supported.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.viewExtensions": {
    "sap.suite.ui.generic.template.ObjectPage.view.Details": {
      "BeforeSubSection|STTA_C_MP_Product|to_ProductSalesData::com.sap.vocabularies.UI.v1.Chart": {
        "className": "sap.ui.core.mvc.View",
        "viewName": "STTA_MP.ext.view.ProductSalesPrice",
        "type": "XML",
        "sap.ui.generic.app": {
          "title": "Target Sales Prices",
          "enableLazyLoading": true
        }
      },
      "AfterSubSection|STTA_C_MP_Product|to_ProductSalesData::com.sap.vocabularies.UI.v1.LineItem": {
        "className": "sap.ui.core.Fragment",
        "fragmentName": "STTA_MP.ext.fragment.ProductSalesList", 
        "type": "XML",
        "sap.ui.generic.app": {
          "title": "Sales Price List",
          "enableLazyLoading": true
        }
      },
      "ReplaceSubSection|STTA_C_MP_Product|to_ProductTextType::com.sap.vocabularies.UI.v1.LineItem": {
        "className": "sap.ui.core.mvc.View",
        "viewName": "STTA_MP.ext.view.ProductTextReplacement",
        "type": "XML",
        "sap.ui.generic.app": {
          "title": "Replaced Product Text",
          "enableLazyLoading": false
        }
      }
    }
  }
}
```

**STEP**: 2 — Add custom subsection via manifest.json content block (OData V4)

**DESCRIPTION**: For OData V4 (Flex Programming Model / FE V4), define custom subsections in the routing target settings under sap.ui5.routing.targets.<Target>.options.settings.content.body.sections.<customSectionKey>.subSections.<subSectionKey>. Use:
- type: XMLFragment (or View)
- name: fragment name (e.g., SalesOrder.ext.CustomSubSection)
- title: i18n binding supported
- position: placement (Before | After | Replace) and anchor (existing section/subSection ID or custom key)

Place the JSON inside your manifest.json routing target that hosts the Object Page.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "myObjectPageSection": {
                      "subSections": {
                        "customSubSection": {
                          "type": "XMLFragment",
                          "name": "SalesOrder.ext.CustomSubSection",
                          "title": "{i18n>customSubSection}",
                          "position": {
                            "placement": "After",
                            "anchor": "someSubSection"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — XML fragment file for an OData V4 custom subsection (fragment path and content)

**DESCRIPTION**: Create the fragment referenced in the manifest (name = SalesOrder.ext.CustomSubSection corresponds to file path convention SalesOrder/ext/CustomSubSection.fragment.xml or namespaced location as configured). Example shows a simple table-building-block style fragment; adapt to supported controls and the LineItem service.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- file: webapp/ext/CustomSubSection.fragment.xml -->
<core:FragmentDefinition
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:table="sap.m"
  xmlns:fe="sap.fe.macros">
  <VBox class="sapUiSmallMargin">
    <Title text="{i18n>customSubSection}" level="H2" />
    <!-- Example: simple table using FE building blocks is possible.
         Replace with your supported controls/BBs and bindings. -->
    <Table inset="false" width="100%">
      <columns>
        <Column>
          <Text text="{i18n>colProduct}" />
        </Column>
        <Column>
          <Text text="{i18n>colValue}" />
        </Column>
      </columns>
      <items>
        <ColumnListItem>
          <cells>
            <Text text="{Product/Name}" />
            <Text text="{Price}" />
          </cells>
        </ColumnListItem>
      </items>
    </Table>
  </VBox>
</core:FragmentDefinition>
```

**STEP**: 4 — Key rules, best practices and constraints

**DESCRIPTION**: Implementation notes you must follow in code:
- For OData V2 use the "facet" terminology in manifest entries; for OData V4 use "section".
- For OData V2 keys, include EntitySet and full annotation path (annotation term appended with ::).
  Example key pattern: "BeforeSubSection|EntitySetName|AnnotationPath::com.sap.vocabularies.UI.v1.LineItem"
- You can provide either a View or a Fragment as the extension; do NOT add ObjectPageSection, subSections, or ObjectPageSubSection tags in the fragment/view — the template already defines those wrapper tags.
- Use only the SAP Fiori elements extensionAPI for interaction with framework internals. Do not manipulate internal controls, models, or properties created by the framework.
- Use sap.ui.generic.app.enableLazyLoading: true to enable lazy loading for custom subsections where supported.
- For custom subsections using building blocks (Table / LineItem), ensure the corresponding service/LineItem is available (e.g., service.cds in samples).
  
**LANGUAGE**: TEXT

**CODE**:
```text
- Terminology: OData V2 -> "facet"/"subsection"; OData V4 -> "section"/"subSection".
- ExtensionAPI only: Use only provided extensionAPI functions. Do NOT access internal controls/models of Fiori elements.
- Lazy loading: set sap.ui.generic.app.enableLazyLoading = true in the extension entry to enable lazy load behavior.
- Fragment vs View: Either is allowed; do NOT include ObjectPageSection or ObjectPageSubSection tags in your fragment/view.
- Keys for V2: "BeforeSubSection|<EntitySet>|<AnnotationPath>::<Term>" (entitySet mandatory).
- Anchor placement for V4: use anchor property pointing to the existing section/subSection key or a custom section key.
- Live example: Flexible Programming Model Explorer -> Custom Subsection (ensure LineItem service present).
```
--------------------------------

**TITLE**: Adding Custom Columns to SAP Fiori Elements Tables (OData V4) and Extension Points (OData V2)

**INTRODUCTION**: This guide shows exactly how to add custom columns to Fiori Elements tables (OData V4) using view fragments + manifest.json controlConfiguration and how to pick the correct extension points for OData V2. Includes ready-to-use XML fragment, manifest.json column configuration, controller extension (JS), allowed key characters, and configuration options used by the framework (sorting, availability, positioning, template reference).

**TAGS**: fiori-elements-framework, extension, tables, custom-columns, manifest, fragment, controller-extension, ODataV4, ODataV2, responsive-table, grid-table

**STEP**: 1 — Pick the extension point (OData V2)
**DESCRIPTION**: Choose the correct extension point name for the table type and floorplan when targeting OData V2 apps. Use the format patterns below (replace placeholders).
**LANGUAGE**: text
**CODE**:
```text
Mappings (OData V2):
- All tables (Object Page):
    onBeforeRebindTableExtension

- Responsive table (List Report):
    ResponsiveTableColumnsExtension|<EntitySet>
    ResponsiveTableCellsExtension|<EntitySet>

- Responsive table (Object Page):
    ResponsiveTableColumnsExtension|<tableEntitySet>|<FacetID_or_AnnotationPath>
    ResponsiveTableCellsExtension|<tableEntitySet>|<FacetID_or_AnnotationPath>

- Grid table (List Report):
    GridTableColumnsExtension|<EntitySet>

- Grid table (Object Page):
    GridTableColumnsExtension|<tableEntitySet>|<FacetID_or_AnnotationPath>

- Analytical table (List Report):
    AnalyticalTableColumnsExtension|<EntitySet>

- Analytical table (Object Page):
    GridTableColumnsExtension|AnalyticalTableColumnsExtension|<tableEntitySet>|<FacetID_or_AnnotationPath>

- Tree table (List Report):
    TreeTableColumnsExtension|<EntitySet>

Notes:
- <EntitySet> is the entity set of the current page.
- <tableEntitySet> is the entity set of the table you are extending (use for object page table column extensions).
- To replace default navigation:
    - List Report responsive table: ListReportExtension
    - Object Page responsive table: DetailsExtension
```

**STEP**: 2 — Create fragment for custom column content
**DESCRIPTION**: Implement a fragment that contains the control(s) rendered inside the custom column cell. Use FragmentDefinition and include IDs for event handlers that map to your controller extension.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: SalesOrder/ext/fragment/CustomColumnLRButton.fragment.xml -->
<core:FragmentDefinition
    xmlns:core="sap.ui.core"
    xmlns="sap.m"
    xmlns:l="sap.ui.layout">
    <l:VerticalLayout id="myVL">
        <Button
            id="myButtonId"
            text="{i18n>LR.Custom_Column|Button}"
            press="SalesOrder.ext.controller.LRExtend.buttonPressed" />
    </l:VerticalLayout>
</core:FragmentDefinition>
```

**STEP**: 3 — Add custom column definitions in manifest.json (controlConfiguration)
**DESCRIPTION**: Add custom columns under the routing targets' options.settings.controlConfiguration. Provide key, header, template (fragment), position, properties (for sorting/filtering), availability, width, importance, horizontalAlign, tooltip, required.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ListReport.ListReportController": {
            "controllerName": "SalesOrder.ext.controller.LRExtend"
          },
          "sap.fe.templates.ListReport.ObjectPageController": {
            "controllerName": "SalesOrder.ext.controller.OPExtend"
          }
        }
      }
    },
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "columns": {
                    "CustomColumnRating": {
                      "header": "{i18n>LR.Custom_Column|Button}",
                      "width": "10em",
                      "importance": "High",
                      "horizontalAlign": "Center",
                      "position": {
                        "placement": "After",
                        "anchor": "DataFieldForAnnotation::FieldGroup::multipleActionFields"
                      },
                      "template": "SalesOrder.ext.fragment.CustomColumnLRButton",
                      "availability": "Default",
                      "properties": [
                        "ID",
                        "TotalNetAmount",
                        "_CustomerPaymentTerms/CustomerPaymentTerms",
                        "_ShipToParty/BusinessPartner"
                      ]
                    }
                  }
                }
              }
            }
          }
        },
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                  "columns": {
                    "CustomColumnOnObjectPage": {
                      "header": "AnotherColumnLabel",
                      "template": "SalesOrder.ext.fragment.CustomColumnOPButton",
                      "availability": "Adaptation"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Implement controller extension (fragment handler + optional overrides)
**DESCRIPTION**: Place event handlers (used by fragment controls) in your controller extension. Use sap.ui.define and extend sap.ui.core.mvc.ControllerExtension. Keep only the public extensionAPI and do not manipulate framework internals.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// File: SalesOrder/ext/controller/LRExtend.controller.js
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension",
  "sap/m/MessageBox"
], function (ControllerExtension, MessageBox) {
  "use strict";

  return ControllerExtension.extend("SalesOrder.ext.controller.LRExtend", {
    /**
     * Handler referenced in the fragment button press attribute.
     */
    buttonPressed: function () {
      MessageBox.show("Button pressed!");
    },

    /**
     * Optional: override lifecycle hooks or public methods of the base controller
     * Put custom code in override blocks as needed.
     */
    override: {
      routing: {
        onBeforeNavigation: function (oContextInfo) {
          // Custom code
        }
      },
      editFlow: {
        onBeforeDelete: function (oParameters) {
          // Custom code
        }
      }
    }
  });
});
```

**STEP**: 5 — Key naming rules and ID generation (OData V4)
**DESCRIPTION**: Use allowed characters for custom column keys and understand how UI.DataField columns are keyed by the framework.
**LANGUAGE**: text
**CODE**:
```text
Allowed characters for custom column "key":
- Letters (a-z, A-Z)
- Numbers (0-9)
- Colon (:)
- Underscore (_)
- Dash (-)

OData / UI.DataField key generation:
- UI.DataField annotation columns: keys follow pattern ...::C::<AnnotationType>::<Property> (e.g. SalesOrder::...::C::FieldGroup::...)
- Custom columns: ID pattern contains ...C::CustomColumn::<key>

Example ID in DOM:
sap.m.Label id="SalesOrder::SalesOrderManageList--fe::table::SalesOrderManage::LineItem::C::FieldGroup::multipleActionFields-innerColumnHeader"
```

**STEP**: 6 — Column configuration options (reference)
**DESCRIPTION**: Use these configuration options in the manifest custom column object. Values marked as required should be provided if needed by your UX; otherwise framework defaults apply.
**LANGUAGE**: text
**CODE**:
```text
Supported column properties and meanings:

- key
  Allowed characters: aA-zZ, 0-9, :, _, -
  Unique identifier for the custom column (used as reference/anchor).

- header
  Any Unicode string | i18n text | metadata path (i18n recommended)
  Shown in table header and add/remove dialog.

- tooltip
  Any Unicode string | i18n text
  Shown on header hover. If unspecified, header text is used.

- width
  "auto" | "<value>" (px, em, %) | "inherit"
  If omitted, framework default applies.

- importance
  "High" | "Medium" | "Low"
  Controls responsive pop-in order: Low hidden first, then Medium, High always visible.

- horizontalAlign
  "Begin" | "Center" | "End"
  Aligns header and content horizontally.

- position
  { "placement": "After"|"Before", "anchor": "<key_of_referenced_column>" }
  Defines position relative to anchor column. Use FieldId to reference annotation columns.

- template
  "Relative.path.to.fragment" (matches Fragment.load syntax)
  The fragment that defines the column cell content (see STEP 2).

- availability
  "Default" | "Adaptation" | "Hidden"
  Default: shown in table.
  Adaptation: initially hidden in table, available via key-user add/remove.
  Hidden: not available in table nor adaptation.

- properties
  String or array of property paths (e.g. "TotalNetAmount", "_NavProperty/Prop")
  Used for:
    - Sorting & filtering dialogs
    - Message handling (linking messages to column)
    - Export to spreadsheet/PDF (each property is exported)
    - Copy row/range operations

- required
  true|false
  Visual indicator (asterisk) in header when true. No automatic validation performed.
```

**STEP**: 7 — Enable sorting & filtering for custom column
**DESCRIPTION**: Provide a properties array in the custom column definition. These properties appear in the sorting dialog and are used for sorting/filtering and message linking.
**LANGUAGE**: JSON
**CODE**:
```json
"properties": [
  "TotalNetAmount",
  "_CustomerPaymentTerms/CustomerPaymentTerms"
]
```

**STEP**: 8 — Useful notes and limitations
**DESCRIPTION**: Important constraints and references you must consider while implementing custom columns.
**LANGUAGE**: text
**CODE**:
```text
- The UI model can be used inside fragments. Example binding for enabled:
    enabled="{= ${ui>/editMode} === 'Editable'}"

- To correctly position a custom column you must find an anchor element. See:
  Finding the Right Key for the Anchor: finding-the-right-key-for-the-anchor-6ffb084.md

- When using the Table building block (sap.fe.core Table building block), defining custom columns in manifest.json is not supported.
  See: The Table Building Block: the-table-building-block-3801656.md

- For OData V2 extension points, use the mappings in STEP 1.

- Live example (Flexible Programming Model Explorer):
  Custom Column example URL:
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/customElements/customElementsOverview/customColumnContent
```

**STEP**: 9 — Quick manifest example (full custom column object template)
**DESCRIPTION**: Copy this template and change values: key, header, template path, properties, anchor, availability, width, importance.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "CustomColumnExampleKey": {
    "header": "{i18n>MY.CustomHeader}",
    "tooltip": "{i18n>MY.CustomTooltip}",
    "width": "12em",
    "importance": "Medium",
    "horizontalAlign": "Center",
    "position": {
      "placement": "After",
      "anchor": "SomeAnnotationFieldId"
    },
    "template": "YourApp.ext.fragment.YourCustomFragment",
    "availability": "Adaptation",
    "properties": [
      "Property1",
      "_Nav/Property2"
    ],
    "required": false
  }
}
```
--------------------------------

**TITLE**: Add Custom Views (Tabs) to a Fiori Elements List Report (OData V4)

**INTRODUCTION**: Step-by-step, code-focused guide to (1) declare custom view tabs in the manifest, (2) implement XML fragments for custom content (table and button), (3) attach a fragment-level custom handler, and (4) register and implement a List Report controller extension that applies filterConditions to custom tabs. Applicable to SAP Fiori elements for OData V4. Requirement: at least one annotation view must exist.

**TAGS**: fiori-elements, list-report, custom-view, manifest, fragment, controller-extension, odata-v4

STEP: 1 — Declare custom views (tabs) in the manifest

DESCRIPTION: Add custom tab entries to the List Report component configuration. Each entry must have a unique key, optional label (supports i18n), and template name referencing the XML fragment/controller module using the application id as prefix (sap.app.id + path under webapp). The example below defines one annotation tab and two custom tabs.

LANGUAGE: JSON

CODE:
```json
{
  "BusinessPartnersList": {
    "type": "Component",
    "id": "BusinessPartnersList",
    "name": "sap.fe.templates.ListReport",
    "options": {
      "settings": {
        "contextPath": "/BusinessPartners",
        "views": {
          "paths": [
            {
              "key": "tab1",
              "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#All"
            },
            {
              "key": "tab2",
              "label": "Custom View with Table",
              "template": "BusinessPartners.ext.CustomViewTable"
            },
            {
              "key": "tab3",
              "label": "{i18n>LRCustomViewWithButton}",
              "template": "BusinessPartners.ext.CustomViewWithButton"
            }
          ],
          "showCounts": true
        }
      }
    }
  }
}
```

STEP: 2 — Custom view properties reference

DESCRIPTION: Use these properties when defining each entry in "views.paths":

LANGUAGE: JSON

CODE:
```json
// Properties (conceptual)
{
  "key": "<unique_tab_id>",         // Unique tab identifier
  "label": "<tab_title>",           // Tab title (supports localization, e.g. "{i18n>key}")
  "template": "<sap.app.id>.<path>.<FragmentName>" // Module name: sap.app.id + relative path under webapp + fragment name
}
```

STEP: 3 — Implement an XML fragment for a custom tab with a sap.m.Table

DESCRIPTION: Create an XML fragment that will be referenced by the template name in the manifest (example template: BusinessPartners.ext.CustomViewTable). Place fragment file under webapp following your app namespace (module path). This fragment binds items to /BusinessPartners and defines columns/cells used by the custom tab.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/ext/CustomViewTable.fragment.xml
     Module name referenced in manifest: BusinessPartners.ext.CustomViewTable -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:u="sap.ui.unified">
  <Table id="customViewWithTable" items="{
      path: '/BusinessPartners',
      sorter: { path: 'Name' }
    }">
    <headerToolbar>
      <OverflowToolbar>
        <content>
          <Title text="Business partners" level="H2" />
          <ToolbarSpacer />
        </content>
      </OverflowToolbar>
    </headerToolbar>
    <infoToolbar>
      <OverflowToolbar>
        <Label text="List of business partners" />
      </OverflowToolbar>
    </infoToolbar>
    <columns>
      <Column width="15em"><Text text="Partner Name" /></Column>
      <Column minScreenWidth="Tablet" demandPopin="true"><Text text="Country" /></Column>
      <Column minScreenWidth="Desktop" demandPopin="true" hAlign="End"><Text text="Region" /></Column>
      <Column minScreenWidth="Desktop" demandPopin="true" hAlign="Center"><Text text="Segment" /></Column>
      <Column minScreenWidth="Desktop" demandPopin="true" hAlign="Center"><Text text="Sales Amount" /></Column>
      <Column minScreenWidth="Desktop" demandPopin="true" hAlign="Center"><Text text="Sales Amount (local currency)" /></Column>
    </columns>
    <items>
      <ColumnListItem type="Active">
        <cells>
          <ObjectIdentifier text="{Name}" />
          <Text text="{Country}" />
          <Text text="{Region}" />
          <Text text="{Segment}" />
          <u:Currency value="{SalesAmount}" currency="{Currency}" />
          <u:Currency value="{SalesAmountLocalCurrency}" currency="{LocalCurrency}" />
        </cells>
      </ColumnListItem>
    </items>
  </Table>
</core:FragmentDefinition>
```

STEP: 4 — Implement an XML fragment with a custom handler (button example)

DESCRIPTION: Create an XML fragment that declares a fragment-level handler using core:require. Reference the handler module path (module name prefix follows sap.app.id conventions). Attach event handlers (e.g., press="handler.onPress").

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/ext/CustomViewWithButton.fragment.xml
     Module name referenced in manifest: BusinessPartners.ext.CustomViewWithButton -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
  <Panel headerText="Business Partners" class="sapUiResponsiveMargin" width="auto"
         core:require="{handler: 'BusinessPartners/ext/CustomButton'}">
    <content>
      <Button text="IBN" id="customButton1" class="sapUiSmallMarginEnd" press="handler.onPress" />
    </content>
  </Panel>
</core:FragmentDefinition>
```

STEP: 5 — Implement the fragment-level custom handler module

DESCRIPTION: Implement the handler module referenced in core:require (example path BusinessPartners/ext/CustomButton). The module should export functions referenced by the fragment (onPress in this example). Use MessageBox or other UI APIs as needed.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/ext/CustomButton.js
sap.ui.define(["sap/m/MessageBox"], function(MessageBox) {
  "use strict";

  return {
    someHandler: function(oEvent) {
      // custom logic here
    },
    onPress: function(oEvent) {
      // Using MessageBox to demonstrate an action on press
      MessageBox.show("You pressed the custom action");
    }
  };
});
```

STEP: 6 — Register a List Report controller extension in the manifest

DESCRIPTION: Register a controller extension that overrides ListReport lifecycle methods (onViewNeedsRefresh and onPendingFilters). The extension controller module name is referenced here (example: SalesOrder.ext.LRExtend or BusinessPartners.ext.LRExtend).

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ListReport.ListReportController": {
            "controllerName": "BusinessPartners.ext.LRExtend"
          }
        }
      }
    }
  }
}
```

STEP: 7 — Implement the controller extension to apply filterConditions to custom tab content

DESCRIPTION: Implement override methods:
- onViewNeedsRefresh(mParameters): mParameters.filterConditions contains the filterConditions from the filterbar. Convert them into OData filters using the extension API (createFiltersFromFilterConditions) and apply to the custom tab binding(s). Use mParameters.additionalParameters cause to distinguish refresh reasons (e.g., "tabChanged" or "search") if available.
- onPendingFilters(): show overlay/grayout of custom tab content while filters are pending.

The sample below demonstrates applying filters to the table with id "customViewWithTable". Adjust the view ID selector to match your generated control ID within the List Report. The sample also shows how to remove or change certain filterConditions before conversion.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/ext/LRExtend.js
sap.ui.define(["sap/ui/core/mvc/ControllerExtension", "sap/ui/model/Filter"], function(ControllerExtension, Filter) {
  "use strict";
  return ControllerExtension.extend("BusinessPartners.ext.LRExtend", {
    override: {
      onViewNeedsRefresh: function(mParameters) {
        var oFilterInfo = mParameters.filterConditions;
        if (oFilterInfo) {
          // Clone filterConditions before modifying
          var duplicateFilterInfo = Object.assign({}, oFilterInfo);

          // Example: remove Region filter if it contains "Bavaria"
          if (
            duplicateFilterInfo.Region &&
            duplicateFilterInfo.Region.map(item => item.values).findIndex(i => i.includes("Bavaria")) !== -1
          ) {
            delete duplicateFilterInfo.Region;
          }

          // Locate the table in the custom tab (adjust generated ID as needed)
          var oTable = this.getView().byId("BusinessPartners::BusinessPartnersList--fe::CustomTab::tab2--customViewWithTable"),
              oBinding = oTable && oTable.getBinding("items"),
              // Convert filterConditions to OData filters and $search
              oConvertedFilter = this.base.getExtensionAPI().createFiltersFromFilterConditions(duplicateFilterInfo);

          if (oTable && oBinding && oConvertedFilter) {
            oTable.setShowOverlay(false); // remove overlay if previously set
            var oFilter = new Filter({ filters: oConvertedFilter.filters, and: true });
            oBinding.filter(oFilter);
            // Apply $search via changeParameters
            oBinding.changeParameters({ $search: oConvertedFilter.search });
          }
        }
      },

      onPendingFilters: function() {
        // When filter changes are pending, gray out the current custom tab content
        var oTable = this.getView().byId("BusinessPartners::BusinessPartnersList--fe::CustomTab::tab2--customViewWithTable");
        if (oTable) {
          oTable.setShowOverlay(true);
        }
      }
    }
  });
});
```

STEP: 8 — Notes and tips

DESCRIPTION: Quick reminders and behavior details to follow during implementation.

LANGUAGE: JSON

CODE:
```json
{
  "notes": [
    "This approach is applicable only for SAP Fiori elements for OData V4.",
    "At least one annotation-based view must be present for custom views to be enabled.",
    "The template name (e.g., 'BusinessPartners.ext.CustomViewTable') must use the sap.app.id prefix followed by the path under webapp and the fragment/module name.",
    "Control IDs inside fragments may be prefixed / altered by the framework; inspect the rendered DOM or use view.byId with the fully qualified id generated by Fiori Elements if needed.",
    "Use this.base.getExtensionAPI().createFiltersFromFilterConditions(filterConditions) to convert filterConditions to OData filters and $search."
  ]
}
```
--------------------------------

**TITLE**: SAP Fiori elements — FAQs (Actionable Code Patterns & Snippets)

**INTRODUCTION**: This document extracts key, actionable code patterns and snippets from the SAP Fiori elements FAQs. It focuses on concrete manifest and annotation examples you can paste or adapt in apps (OData V4) to configure libraries, control visibility/enablement, define value-help/text behavior, and enable value validation. All links to the referenced topics are preserved for deeper reading.

**TAGS**: fiori-elements-framework, annotations, manifest.json, value-help, ui.hidden, operationavailable, draft, side-effects, navigation, actions, filter-bar, table, object-page, chart

**STEP**: 1 — Configure required SAP Fiori elements libraries in manifest.json

**DESCRIPTION**: Include the required runtime libraries in your application's manifest.json to ensure proper loading and performance. Use sap.fe.templates for standard floorplans (List Report, Object Page). For custom apps or when using building blocks, include sap.fe.core and sap.fe.macros.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "dependencies": {
      "minUI5Version": "1.87.0",
      "libs": {
        "sap.fe.templates": {},
        "sap.fe.core": {},
        "sap.fe.macros": {}
      }
    }
  }
}
```

Notes:
- For a standard floorplan (List Report, Object Page) you typically need only "sap.fe.templates".
- For a custom app based on the flexible programming model, include at least "sap.fe.core". Add "sap.fe.macros" when using building blocks.

**STEP**: 2 — Configure text mapping for value help (wrong vs correct)

**DESCRIPTION**: When value help entries show only the key in the field until save, ensure the text annotation on the field points to a different property (text) in the value-help entity. Example below shows the wrong and correct annotation usage.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Wrong: text points to same property (leads to missing text update) -->
<Annotations Target="TestService.CategoryType/CategoryId">
  <Annotation Term="Common.Text" Path="CategoryId"/>
</Annotations>

<!-- Correct: text points to a separate description property -->
<Annotations Target="TestService.CategoryType/CategoryId">
  <Annotation Term="Common.Text" Path="CategoryDescription"/>
</Annotations>
```

Reference: Field and Field Help section in FAQs.

**STEP**: 3 — Hide controls or parts of the UI using UI.Hidden and CreateHidden/UpdateHidden/DeleteHidden

**DESCRIPTION**: Annotate properties or actions to hide fields or standard action buttons. Use UI.Hidden on properties or CreateHidden/UpdateHidden/DeleteHidden to hide standard Create/Edit/Delete buttons.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Hide a property in the UI -->
<Annotations Target="MyService.MyEntity/MyProperty">
  <Annotation Term="UI.Hidden" Bool="true"/>
</Annotations>

<!-- Hide standard Create/Edit/Delete buttons for an entity -->
<Annotations Target="MyService.MyEntity">
  <Annotation Term="UI.CreateHidden" Bool="true"/>
  <Annotation Term="UI.UpdateHidden" Bool="true"/>
  <Annotation Term="UI.DeleteHidden" Bool="true"/>
</Annotations>
```

Links for details: Hiding Features Using the UI.Hidden Annotation; Adding Actions to Tables; Enabling Actions in the Object Page Header.

**STEP**: 4 — Control enablement of actions using OperationAvailable

**DESCRIPTION**: Use OperationAvailable to control whether an action button is enabled. Annotate actions or action parameters as required so that the front end can enable/disable UI affordances.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: disable an unbound action -->
<Annotations Target="MyService.MyAction">
  <Annotation Term="Common.OperationAvailable" Bool="false"/>
</Annotations>

<!-- Example: enable an action only in certain cases (Bool="true" or dynamic expressions) -->
<Annotations Target="MyService.MyAction">
  <Annotation Term="Common.OperationAvailable" Bool="true"/>
</Annotations>
```

Reference: OperationAvailable overview (Actions in the List Report).

**STEP**: 5 — Value help validation: supported annotation patterns

**DESCRIPTION**: The value help is a helper by default; explicit validation requires specific annotations or types. Use these patterns to enforce validation for value-help fields.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Property typed as GUID enforces validation on input -->
<Property Name="Id" Type="Edm.Guid" Nullable="false" />

<!-- Mark a property as a currency/unit for validation -->
<Annotations Target="MyService.MyEntity/Amount">
  <Annotation Term="Common.IsCurrency"/>
</Annotations>

<Annotations Target="MyService.MyEntity/Quantity">
  <Annotation Term="Common.IsUnit"/>
</Annotations>

<!-- Use fixed values validating against a fixed value-help list -->
<Annotations Target="MyService.MyEntity/MyProperty">
  <Annotation Term="Common.ValueHelpWithFixedValues" Bool="true"/>
</Annotations>

<!-- Use the value list for validation (requires back end supporting ValueListForValidation) -->
<Annotations Target="MyService.MyEntity/MyProperty">
  <Annotation Term="Common.ValueListForValidation" Path="MyValueList"/>
</Annotations>
```

Reference: Value help validation items in Field and Field Help FAQ.

**STEP**: 6 — Draft handling guidance (behavioral; no code injection)

**DESCRIPTION**: SAP Fiori elements for OData V4 supports create/edit/delete scenarios only when the OData service is draft-enabled. For non-draft services you can build read-only apps. See Draft Handling and Prerequisites topics for backend/tooling requirements. Do not attempt to bypass draft logic from the UI—implement draft on the service side.

References:
- Draft Handling: draft-handling-ed9aa41.md
- Prerequisites for Using SAP Fiori Elements: prerequisites-for-using-sap-fiori-elements-f2344b5.md

**LANGUAGE**: JSON

**CODE**:
```json
{
  "note": "Enable draft handling at the OData service level. No UI-level toggle will enable full create/edit/delete without a draft-enabled service."
}
```

**STEP**: 7 — Refreshing UI data: side effects (annotation-driven)

**DESCRIPTION**: Side effects are declared in the back end and annotated to inform the front end which properties/controls must be refreshed after changes. Annotate implemented side effects so the UI fetches updated values.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Generic pattern: annotate action or property with a SideEffects entry to list targets to refresh.
     Concrete side-effect annotation syntax depends on your service OData metadata/annotation format. -->
<Annotations Target="MyService.MyEntity">
  <Annotation Term="Org.OData.Capabilities.V1.SideEffects">
    <!-- Side effect entries (dimension, property, navigation targets) -->
  </Annotation>
</Annotations>
```

Reference: Side Effects topic: side-effects-18b17bd.md

**STEP**: 8 — Navigation: semantic object handling and hiding unavailable intents

**DESCRIPTION**: Use semantic object mapping and Common.SemanticObjectUnavailableActions to control which intents/actions are passed and which to hide. This prevents exposing sensitive or irrelevant intents and maps fields when source and target use different names.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: hide unwanted actions for a semantic object -->
<Annotations Target="MyService.SomeSemanticObject">
  <Annotation Term="Common.SemanticObjectUnavailableActions">
    <!-- List of unavailable action names -->
  </Annotation>
</Annotations>

<!-- Semantic object mapping is described in the outbound navigation topic and typically configured
     in the UI annotation or manifest routing configuration depending on your scenario. -->
```

References:
- Navigation from an App (Outbound Navigation): navigation-from-an-app-outbound-navigation-d782acf.md
- Navigation to an App (Inbound/Deep Linking): navigation-to-an-app-inbound-navigation-c337d8b.md

**STEP**: 9 — Charts & aggregation differences (OData V2 vs V4)

**DESCRIPTION**: In OData V4 you must explicitly request dimensions/measures for aggregations in chart queries (client-driven). In OData V2, you send required properties and the server aggregates measures by default. Ensure backend aggregation support in OData V4 and annotate accordingly.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "note": "For OData V4 charts enable backend aggregation and ensure the client passes dimensions/measures. See Enabling Aggregation in the Back End in Configuring Charts."
}
```

Reference: Configuring Charts: configuring-charts-653ed0f.md

**STEP**: 10 — Extensions / Building Blocks / Key user adaptation

**DESCRIPTION**: If standard behaviors don't fit requirements, use app extensions or building blocks to add custom logic while retaining standard features. For key-user adaptation, enable the app accordingly.

**LANGUAGE**: LINKS

**CODE**:
```text
- Extending List Reports and Object Pages Using App Extensions:
  extending-list-reports-and-object-pages-using-app-extensions-a892eb8.md

- Flexible Programming Model Explorer (samples):
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/overview/introduction

- Enabling an App for Key User Adaptation:
  enabling-an-app-for-key-user-adaptation-ccd45ba.md
```

References preserved from the FAQ for sample patterns and examples.


--------------------------------

**TITLE**: Run and Explore SAP Fiori elements (OData V4) Feature Showcase and Sample Apps

**INTRODUCTION**: This document collects the repositories, commands, and minimal deployment steps to clone, run, and inspect the SAP Fiori elements for OData V4 feature showcase apps and example apps (CAP and RAP-based). Use it to quickly obtain the source code, launch local CAP-based demo servers, or deploy RAP samples to an ABAP platform for exploration and code inspection.

**TAGS**: fiori-elements, OData V4, CAP, RAP, SAP, samples, sflight, feature-showcase, abap, node, cds

STEP: 1 — Clone the repositories

DESCRIPTION: Clone the public GitHub repositories for feature showcase and sample apps. Use Git to fetch the code locally.

LANGUAGE: Shell

CODE:
```bash
# Feature showcase based on CAP (Fiori elements - OData V4)
git clone https://github.com/SAP-samples/fiori-elements-feature-showcase.git

# Feature showcase based on RAP (ABAP Platform)
git clone https://github.com/SAP-samples/abap-platform-fiori-feature-showcase.git

# CAP SFLIGHT sample
git clone https://github.com/SAP-samples/cap-sflight.git

# RAP SFLIGHT sample (ABAP repository)
git clone https://github.com/SAP-samples/abap-platform-refscen-flight.git
```

STEP: 2 — Run CAP-based feature showcase locally (developer machine)

DESCRIPTION: Typical quick-start to run a CAP-based Fiori elements app locally. Prerequisites: Node.js, npm, and @sap/cds or the SAP Cloud SDK tooling. Commands below are generic — check repo README for repo-specific scripts. Inspect the Fiori app at webapp/manifest.json and local OData endpoints at the CDS server URL.

LANGUAGE: Shell

CODE:
```bash
# 1. Enter repository
cd fiori-elements-feature-showcase
# or example app
cd cap-sflight

# 2. Install dependencies (use npm or yarn depending on repo)
npm install

# 3. Build and launch CAP server and Fiori preview
# If the repo provides 'cds' scripting:
npx cds watch          # watches CDS services and serves Fiori apps (if configured)
# OR use provided npm script (check package.json)
npm start

# 4. Open the app in the browser
# Typical local URL:
# http://localhost:4004/<service-path>/webapp/index.html
# or the UI preview URL printed by cds watch
```

STEP: 3 — Key file locations to inspect Fiori elements implementation

DESCRIPTION: For code-focused inspection, open the following files in the cloned repositories to see how Fiori elements and OData V4 are configured and extended.

LANGUAGE: JSON / XML / CDS

CODE:
```text
# Typical Fiori elements app files to inspect:
<repo-root>/app/webapp/manifest.json      # Fiori elements app descriptor (pages, templates, routes)
<repo-root>/app/webapp/Component.js       # UI5 component bootstrap (if present)
<repo-root>/app/webapp/i18n/i18n.properties  # translations
<repo-root>/srv                       # CAP CDS service definitions and logic
<repo-root>/db                        # CAP domain models (cds)
<repo-root>/webapp/                    # UI5 / Fiori elements web resources
```

STEP: 4 — Deploy RAP-based feature showcase and samples to ABAP Platform

DESCRIPTION: RAP samples require an ABAP platform (on-prem or trial) and deployment via abapGit or transport. The repository contains ABAP objects. Use abapGit in your ABAP system to pull the repository and activate objects. Then register/activate the OData service in the ABAP system and configure a Fiori launchpad or use the Fiori launchpad sandbox.

LANGUAGE: Shell / ABAP deployment

CODE:
```bash
# Example: prepare the RAP repository for abapGit
# 1. Clone locally to inspect
git clone https://github.com/SAP-samples/abap-platform-fiori-feature-showcase.git

# 2. On ABAP system: use abapGit to pull repository from GitHub URL above
#    - In abapGit UI: "New" -> provide repo URL -> pull -> activate

# 3. In ABAP system:
#    - Activate the OData service (SAP Gateway / ICF) for the project
#    - Assign required roles and catalogs for Fiori launchpad access
#    - Launch the Fiori app via the FLP tile / semantic object or test via SAP GUI / browser
```

STEP: 5 — CAP SFLIGHT specific quick commands

DESCRIPTION: Launch and inspect CAP SFLIGHT sample. Check model files, services, and sample data.

LANGUAGE: Shell / CDS

CODE:
```bash
cd cap-sflight
npm install
npx cds watch       # launches CDS server and serves app (if configured)
# Inspect CDS model files:
ls srv/*.cds
ls db/*.cds
# OData V4 endpoints usually exposed under:
# http://localhost:4004/<ServiceName>/$metadata
```

STEP: 6 — RAP SFLIGHT deployment notes

DESCRIPTION: For RAP SFLIGHT, deploy to an ABAP developer system. Use abapGit to transfer repository content, then register and test services in the ABAP system. Follow the repo README for object-specific instructions.

LANGUAGE: Text

CODE:
```text
# Key steps:
1. Open abapGit in your ABAP dev system (transaction /UI5/ or via UI).
2. Create a new repo pointing to:
   https://github.com/SAP-samples/abap-platform-refscen-flight.git
3. Pull and activate the objects.
4. Register OData services in /IWFND/MAINT_SERVICE or the Service Maintenance.
5. Test the UI via Fiori Launchpad or directly via the app URL.
```

STEP: 7 — Explore live examples (Flexible Programming Model)

DESCRIPTION: Use the SAP UI5 online test explorer to view live examples of the Flexible Programming Model and Fiori elements demo pages.

LANGUAGE: URL

CODE:
```text
# Live UI5 explorer for Flexible Programming Model / Fiori elements
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/overview/introduction
```

STEP: 8 — Where to find more information in the repos

DESCRIPTION: Each repository contains a README with detailed, repo-specific instructions — follow those for advanced setups, Docker containers, cloud deployments, or CI/CD.

LANGUAGE: Text

CODE:
```text
# Open the repository README files:
# fiori-elements-feature-showcase README
<repo-root>/README.md
# abap-platform-fiori-feature-showcase README
<repo-root>/README.md
# cap-sflight README
<repo-root>/README.md
# abap-platform-refscen-flight README
<repo-root>/README.md
```


--------------------------------

**TITLE**: Field Help: Configure Value Help, Text Arrangement, Filters, and Pickers (OData V4, SAP Fiori elements)

**INTRODUCTION**: Practical, code-focused guide for implementing field help (value help, dropdowns, date pickers, validation, hierarchical and context-dependent value helps) in SAP Fiori elements for OData V4. Includes XML metadata annotations, ABAP CDS and CAP CDS examples. Use these snippets to enable value help dialogs, type-ahead, fixed-value dropdowns, client validation, sorting, hierarchies, timezones, and fetch-on-demand.

**TAGS**: ValueList, ValueHelp, Common.ValueList, ValueListReference, ValueListMapping, TextArrangement, Text, ValueListForValidation, PresentationVariant, SelectionFields, FetchValues, DateTimeOffset, Timezone, ABAP CDS, CAP CDS, XML

STEP: Basic Value Help (XML metadata)
DESCRIPTION: Add a local ValueList annotation for a property. Key elements: CollectionPath (value help entity set), SearchSupported, Parameters (ValueListParameterInOut/Input/DisplayOnly).
LANGUAGE: XML
CODE:
```xml
<Annotations Target="Self.ArtistsType/CountryOfOrigin">
    <Annotation Term="Common.ValueList">
        <Record>
            <PropertyValue Property="CollectionPath" String="myEntityName"/>
            <PropertyValue Property="SearchSupported" Bool="true"/>
            <PropertyValue Property="Parameters">
                <Collection>
                    <Record Type="Common.ValueListParameterInOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="CountryOfOrigin"/>
                        <PropertyValue Property="ValueListProperty" String="CountryCode"/>
                    </Record>
                    <Record Type="Common.ValueListParameterDisplayOnly">
                        <PropertyValue Property="ValueListProperty" String="CountryCode_Text"/>
                    </Record>
                    <Record Type="Common.ValueListParameterDisplayOnly">
                        <PropertyValue Property="ValueListProperty" String="CountryIndicator"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: Basic Value Help (ABAP CDS)
DESCRIPTION: Define value help in ABAP CDS using @Consumption.valueHelpDefinition; set entity name and element, optionally label and qualifier.
LANGUAGE: ABAP CDS
CODE:
```abap
@Consumption.valueHelpDefinition:
        [{
          entity :{
            name    : 'myEntityName',     " ValueList CollectionPath
            element : 'CountryCode'       " ValueListProperty of ValueListParameterInOut
          },
          label  : 'mylabel',
          qualifier: 'test'
        }]
CountryOfOrigin, " LocalDataProperty of ValueListParameterInOut
```

STEP: Basic Value Help (CAP CDS)
DESCRIPTION: Define ValueList on a CAP CDS entity property. Use Common.ValueList with CollectionPath and Parameters; include Text annotation on collection key if needed.
LANGUAGE: CAP CDS
CODE:
```cap
entity Artist {
    CountryOfOrigin : String(40) @(Common: {
        Label: 'Country',
        ValueList: {
            CollectionPath: 'myEntityName',
            Parameters: [
                {
                    $Type: 'Common.ValueListParameterInOut',
                    LocalDataProperty: CountryOfOrigin,
                    ValueListProperty: 'CountryCode'
                },
                {
                    $Type: 'Common.ValueListParameterDisplayOnly',
                    ValueListProperty: 'CountryCode_Text'
                },
                {
                    $Type: 'Common.ValueListParameterDisplayOnly',
                    ValueListProperty: 'CountryIndicator'
                }
            ]
        }
    });
}
```

STEP: ValueListReference -> external service (XML)
DESCRIPTION: Point to a referenced metadata document (another service) using ValueListReferences; path string is relative to the main metadata file.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="Self.ArtistsType/CountryOfOrigin">
    <Annotation Term="Common.ValueListReferences">
        <Collection>
            <String>
                ../../../../srvd_f4/sap/myentityname/0001;ps='srvd-sadl_gw_appmusicdr_definition-0001';va='com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.et-c_mdbu_v4_artisttp.countryoforigin'/$metadata
            </String>
        </Collection>
    </Annotation>
</Annotations>
```

STEP: ValueListMapping in referenced metadata (XML)
DESCRIPTION: In the referenced metadata file, define Common.ValueListMapping for the property with Label, CollectionPath and Parameters.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="ParentService.ArtistsType/CountryOfOrigin">
    <Annotation Term="Common.ValueListMapping">
        <Record>
            <PropertyValue Property="Label" String="Country Code Value Help"/>
            <PropertyValue Property="CollectionPath" String="myEntityName"/>
            <PropertyValue Property="Parameters">
                <Collection>
                    <Record Type="Common.ValueListParameterInOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="CountryOfOrigin"/>
                        <PropertyValue Property="ValueListProperty" String="CountryCode"/>
                    </Record>
                    <Record Type="Common.ValueListParameterDisplayOnly">
                        <PropertyValue Property="ValueListProperty" String="CountryCode_Text"/>
                    </Record>
                    <Record Type="Common.ValueListParameterDisplayOnly">
                        <PropertyValue Property="ValueListProperty" String="CountryIndicator"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: Display Text and TextArrangement (XML)
DESCRIPTION: Annotate the property with Common.Text (path to description on value help entity) and UI.TextArrangement to control how value and text are shown. Also annotate collection key in the value help entity with Common.Text and UI.TextArrangement.
LANGUAGE: XML
CODE:
```xml
<!-- On consuming property -->
<Annotations Target="sap.capire.officesupplies.CatalogAdminService.Products/currency_code">
     <Annotation Term="Common.Text" Path="currency/name">
          <Annotation Term="UI.TextArrangement" EnumMember="UI.TextArrangementType/TextFirst"/>
     </Annotation>
     <Annotation Term="Common.ValueList">
          <Record Type="Common.ValueListType">
               <PropertyValue Property="CollectionPath" String="Currencies"/>
               <PropertyValue Property="Label" String="Währung"/>
               <PropertyValue Property="Parameters">
                    <Collection>
                         <Record Type="Common.ValueListParameterInOut">
                              <PropertyValue Property="LocalDataProperty" PropertyPath="currency_code"/>
                              <PropertyValue Property="ValueListProperty" String="code"/>
                         </Record>
                         <Record Type="Common.ValueListParameterDisplayOnly">
                              <PropertyValue Property="ValueListProperty" String="name"/>
                         </Record>
                    </Collection>
               </PropertyValue>
          </Record>
     </Annotation>
     <Annotation Term="Common.Label" String="Währung"/>
     <Annotation Term="Core.Description" String="Währungscode gemäß ISO 4217"/>
</Annotations>

<!-- On value help collection key -->
<Annotations Target="sap.capire.officesupplies.CatalogAdminService.Currencies/code">
     <Annotation Term="Common.Text" Path="name">
          <Annotation Term="UI.TextArrangement" EnumMember="UI.TextArrangementType/TextFirst"/>
     </Annotation>
     <Annotation Term="Common.Label" String="Währungscode"/>
</Annotations>
```

STEP: Display Text and TextArrangement (ABAP CDS)
DESCRIPTION: Annotate ABAP CDS view with @Consumption.valueHelpDefinition and @ObjectModel.text / @UI.textArrangement for the consuming property and the value help entity key.
LANGUAGE: ABAP CDS
CODE:
```abap
annotate view PRODUCTS with {
     @Consumption.valueHelpDefinition:
     [{
          entity :{
               name : 'Currencies',
               element : 'code'
          },
          label : 'Currency'
     }]

     @ObjectModel: {
          text: {
               element: [ 'name' ]
          }
     }
     @UI.textArrangement: #TEXT_First
     currency_code;
}

annotate view Currencies with {
     @ObjectModel.representativeKey: 'code'
     @UI.selectionField: true
     @ObjectModel.text: {
          element: 'name'
     }
     @UI.textArrangement: #TEXT_FIRST
     code;
     name;
};
```

STEP: Display Text and TextArrangement (CAP CDS)
DESCRIPTION: CAP CDS example using @Common.Text and TextArrangement on consuming property and Currencies entity key.
LANGUAGE: CAP CDS
CODE:
```cap
annotate sap.fe.officesupplies.CatalogAdminService.Products with {
     @Common.Label : 'Currency'
     @Common : {
          Text : currency.name,
          TextArrangement : #TextOnly
     }
     @Common.ValueListWithFixedValues : true
     @Common.ValueList : {
          $Type : 'Common.ValueListType',
          Label : 'Currency',
          CollectionPath : 'Currencies',
          Parameters : [
               {
                    $Type : 'Common.ValueListParameterInOut',
                    LocalDataProperty : currency_code,
                    ValueListProperty : 'code'
               },
               {
                    $Type : 'Common.ValueListParameterDisplayOnly',
                    ValueListProperty : 'name'
               }
          ]
     }
     @Core.Description : 'A currency code as specified in ISO 4217'
     currency_code
};

annotate Currencies with {
     code @(Common: {
          Text : name,
          TextArrangement: #TextFirst
     });
}
```

STEP: TextArrangement behavior summary
DESCRIPTION: Use UI.TextArrangement to control display. Common behaviors:
- Not annotated: show Value.
- Common.Text present but no TextArrangement: dialog shows Value, dropdown shows Description Value.
- TextFirst/TextLast/TextOnly/TextSeparate influence dialog and dropdown as described in metadata. Note: TextOnly supported in value help tables and type-ahead; some arrangements are ignored for certain UI controls.
LANGUAGE: JSON
CODE:
```json
{
  "TextArrangementOptions": [
    "TextFirst",
    "TextLast",
    "TextSeparate",
    "TextOnly"
  ],
  "Guideline": "Annotate Common.Text on property and on value help collection key; set UI.TextArrangement where required."
}
```

STEP: Control type-ahead columns via Importance (CAP/JSON snippet)
DESCRIPTION: Use @UI.Importance (High) on parameters to limit number of visible columns in type-ahead to those marked High.
LANGUAGE: CAP CDS
CODE:
```cap
ValueList : {
    Label          : 'Sold-to Party',
    CollectionPath : 'Customer',
    Parameters     : [
        {
            $Type             : 'Common.ValueListParameterInOut',
            LocalDataProperty : SoldToParty,
            ValueListProperty : 'Customer',
            "@UI.Importance" : #High
        },
        {
            $Type             : 'Common.ValueListParameterDisplayOnly',
            ValueListProperty : 'CustomerName',
            "@UI.Importance" : #High
        }
    ]
}
```

STEP: Sorting via UI.PresentationVariant (XML)
DESCRIPTION: Change default sorting of value help table/dropdown using UI.PresentationVariant and reference it via PresentationVariantQualifier property in Common.ValueList.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd.SalesOrderItem/Material">
    <Annotation Term="Common.ValueList">
        <Record Type="Common.ValueListType">
            <PropertyValue Property="CollectionPath" String="C_MaterialBySlsOrgDistrChnl"/>
            <PropertyValue Property="Label" String="Materials for Manage Sales Order"/>
            <PropertyValue Property="Parameters">
                <Collection>
                    <Record Type="Common.ValueListParameterInOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="Material"/>
                        <PropertyValue Property="ValueListProperty" String="Material"/>
                    </Record>
                    <Record Type="Common.ValueListParameterOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="RequestedQuantityUnit"/>
                        <PropertyValue Property="ValueListProperty" String="RequestedQuantityUnit"/>
                    </Record>
                    <Record Type="Common.ValueListParameterDisplayOnly">
                        <PropertyValue Property="ValueListProperty" String="MaterialName"/>
                    </Record>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="PresentationVariantQualifier" String="SortOrderPV"/>
        </Record>
    </Annotation>
</Annotations>

<Annotations Target="com.c_salesordermanage_sd.EntityContainer/C_MaterialBySlsOrgDistrChnl">
    <Annotation Term="UI.PresentationVariant" Qualifier="SortOrderPV">
        <Record Type="UI.PresentationVariantType">
            <PropertyValue Property="Visualizations">
                <Collection>
                    <AnnotationPath>@UI.LineItem</AnnotationPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="SortOrder">
                <Collection>
                    <Record Type="Common.SortOrderType">
                        <PropertyValue Property="Property" PropertyPath="MaterialName"/>
                        <PropertyValue Property="Descending" Bool="false"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: Hierarchical value help (RecursiveHierarchyQualifier) (XML)
DESCRIPTION: Define PresentationVariant with RecursiveHierarchyQualifier and InitialExpansionLevel; reference via ValueList PresentationVariantQualifier.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="Self.ArtistsType/CountryOfOrigin">
    <Annotation Term="Common.ValueList">
        <Record>
            <PropertyValue Property="CollectionPath" String="myEntityName"/>
            <PropertyValue Property="SearchSupported" Bool="true"/>
            <PropertyValue Property="Parameters">
                <Collection>
                    <Record Type="Common.ValueListParameterInOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="CountryOfOrigin"/>
                        <PropertyValue Property="ValueListProperty" String="CountryCode"/>
                    </Record>
                    <Record Type="Common.ValueListParameterDisplayOnly">
                        <PropertyValue Property="ValueListProperty" String="CountryCode_Text"/>
                    </Record>
                    <Record Type="Common.ValueListParameterDisplayOnly">
                        <PropertyValue Property="ValueListProperty" String="CountryIndicator"/>
                    </Record>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="PresentationVariantQualifier" String="Country_Pres"/>
        </Record>
    </Annotation>
    <Annotation Term="UI.PresentationVariant" Qualifier="Country_Pres">
        <Record>
            <PropertyValue Property="Visualizations">
                <Collection>
                    <AnnotationPath>@UI.LineItem#DefaultLineItem</AnnotationPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="InitialExpansionLevel" Int="2"/>
            <PropertyValue Property="RecursiveHierarchyQualifier" String="CountryHierarchy"/>
        </Record>
    </Annotation>
</Annotations>
```

STEP: Hierarchical value help (ABAP CDS / CAP CDS)
DESCRIPTION: ABAP and CAP CDS equivalents: set presentationVariantQualifier in valueHelpDefinition and define UI.presentationVariant with recursiveHierarchyQualifier + initialExpansionLevel.
LANGUAGE: ABAP CDS
CODE:
```abap
@Consumption.valueHelpDefinition: [
  {
    entity: {
      name    : 'myEntityName',
      element : 'CountryCode'
    },
    label: 'mylabel',
    qualifier: 'test',
    presentationVariantQualifier: 'Country_Pres'
  }
]
@UI.presentationVariant: [
  {
    visualizations: [
      { type: #AS_LINEITEM, qualifier: 'DefaultLineItem' }
    ],
    initialExpansionLevel: 2,
    recursiveHierarchyQualifier: 'CountryHierarchy',
    qualifier: 'Country_Pres'
  }
]
CountryOfOrigin,
```

LANGUAGE: CAP CDS
CODE:
```cap
entity Artist {
  CountryOfOrigin : String(40) @(Common: {
    Label: 'Country',
    ValueList: {
      CollectionPath: 'myEntityName',
      Parameters: [
        { $Type: 'Common.ValueListParameterInOut', LocalDataProperty: CountryOfOrigin, ValueListProperty: 'CountryCode' },
        { $Type: 'Common.ValueListParameterDisplayOnly', ValueListProperty: 'CountryCode_Text' },
        { $Type: 'Common.ValueListParameterDisplayOnly', ValueListProperty: 'CountryIndicator' }
      ],
      PresentationVariantQualifier: 'Country_Pres'
    }
  });

  UI: {
    PresentationVariant #Country_Pres: {
      Visualizations: ['@UI.LineItem#DefaultLineItem'],
      InitialExpansionLevel: 2,
      RecursiveHierarchyQualifier: 'CountryHierarchy'
    }
  }
}
```

STEP: ValueListForValidation (XML)
DESCRIPTION: Enable client-side validation against the value help entity. Add Common.ValueListForValidation (string qualifier or conditional If expression returning qualifier). Values failing validation are not sent to backend.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/IncotermsVersion">
    <Annotation Term="Common.IsUpperCase" Bool="true"/>
    <Annotation Term="Common.Label" String="Incoterms Version"/>
    <Annotation Term="Common.Text" Path="_IncotermsVersion/IncotermsVersion_Text"/>
    <Annotation Term="Common.ValueListForValidation" String=""/>
    <Annotation Term="Common.ValueList">
        <!-- Definition of ValueList here -->
    </Annotation>
</Annotations>
```

STEP: ValueListForValidation (conditional binding example)
DESCRIPTION: Use conditional If-Then-Else expression to select a qualifier at runtime based on other property values.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd.HeaderPartner/BusinessPartner">
    <Annotation Term="com.sap.vocabularies.Common.v1.ValueListForValidation">
        <If>
            <Eq>
                <Path>PartnerFunction</Path>
                <String>WE</String>
            </Eq>
            <String>BusinessPartner</String>
            <String />
        </If>
    </Annotation>
</Annotations>
```

STEP: Context-Dependent Value Help (ValueListRelevantQualifiers)
DESCRIPTION: Configure valid qualifiers dependent on another property value using Common.ValueListRelevantQualifiers (collection with conditional expression entries). Ensure all ValueList definitions share same In/Out parameters.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd.HeaderPartner/BusinessPartner">
    <Annotation Term="com.sap.vocabularies.Common.v1.ValueListRelevantQualifiers">
        <Collection>
            <String />
            <If>
                <Eq>
                    <Path>PartnerFunction</Path>
                    <String>WE</String>
                </Eq>
                <String>BusinessPartner</String>
            </If>
        </Collection>
    </Annotation>
    <Annotation Term="Common.ValueList" Qualifier="BusinessPartner">
        <!-- Definition of ValueList for qualifier BusinessPartner -->
    </Annotation>
    <Annotation Term="Common.ValueList">
        <!-- Definition of ValueList without qualifier -->
    </Annotation>
</Annotations>
```

STEP: InitialValueIsSignificant (XML + CDS)
DESCRIPTION: Mark an IN parameter (Edm.String) as significant even if initial (e.g., empty string) with InitialValueIsSignificant Bool="true".
LANGUAGE: XML
CODE:
```xml
<Annotation Term="Common.ValueList">
    <Record Type="Common.ValueListType">
        <PropertyValue Property="CollectionPath" String="ShippingCondition"/>
        <PropertyValue Property="Label" String="Shipping Condition"/>
        <PropertyValue Property="Parameters">
            <Collection>
                <Record Type="Common.ValueListParameterInOut">
                    <PropertyValue Property="LocalDataProperty" PropertyPath="ShippingCondition"/>
                    <PropertyValue Property="ValueListProperty" String="ShippingCondition"/>
                </Record>
                <Record Type="Common.ValueListParameterIn">
                    <PropertyValue Property="LocalDataProperty" PropertyPath="SoldToParty"/>
                    <PropertyValue Property="ValueListProperty" String="SoldToParty"/>
                    <PropertyValue Property="InitialValueIsSignificant" Bool="true"/>
                </Record>
                <Record Type="Common.ValueListParameterDisplayOnly">
                    <PropertyValue Property="ValueListProperty" String="ShippingCondition_Text"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

LANGUAGE: CAP CDS
CODE:
```cap
ShippingCondition : ShippingCondition @(Common: {
    Text: _ShippingCondition.ShippingCondition_Text,
    TextArrangement: #TextFirst,
    IsUpperCase: true,
    ValueList: {
        Label: 'Shipping Condition',
        CollectionPath: 'ShippingCondition',
        Parameters: [
            { $Type: 'Common.ValueListParameterInOut', LocalDataProperty: ShippingCondition, ValueListProperty: 'ShippingCondition' },
            { $Type: 'Common.ValueListParameterIn', LocalDataProperty: SoldToParty, ValueListProperty: 'SoldToParty', InitialValueIsSignificant: true },
            { $Type: 'Common.ValueListParameterDisplayOnly', ValueListProperty: 'ShippingCondition_Text' }
        ]
    }
});
```

STEP: Multiple Value Helps (collective search help)
DESCRIPTION: Define multiple Common.ValueList annotations on the same property using different qualifiers; Fiori will expose multiple value helps.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd.HeaderPartner/BusinessPartner">
    <Annotation Term="Common.ValueList" Qualifier="BusinessPartner">
        <!-- Definition of ValueList for BusinessPartner -->
    </Annotation>
    <Annotation Term="Common.ValueList" Qualifier="SingleColumn">
        <!-- Definition of ValueList SingleColumn -->
    </Annotation>
    <Annotation Term="Common.ValueList">
        <!-- Definition of default ValueList without qualifier -->
    </Annotation>
</Annotations>
```

STEP: Value Help for Draft-Enabled Entities
DESCRIPTION: Behavior note: Value help for draft-enabled entities shows only active documents. (No code required)

STEP: FetchValuesType: fetch-on-demand (XML)
DESCRIPTION: Configure value help to not load data immediately by setting FetchValues = 2 so users can first set filters and then click Go.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="Common.ValueList">
   <Record Type="Common.ValueListType">
       <PropertyValue Property="CollectionPath" String="ShippingCondition"/>
       <PropertyValue Property="Label" String="Shipping Condition"/>
       <PropertyValue Property="FetchValues" Int="2"/>
       <PropertyValue Property="Parameters">
           <Collection>
               <Record Type="Common.ValueListParameterInOut">
                   <PropertyValue Property="LocalDataProperty" PropertyPath="ShippingCondition"/>
                   <PropertyValue Property="ValueListProperty" String="ShippingCondition"/>
               </Record>
               <Record Type="Common.ValueListParameterIn">
                   <PropertyValue Property="LocalDataProperty" PropertyPath="SoldToParty"/>
                   <PropertyValue Property="ValueListProperty" String="SoldToParty"/>
               </Record>
               <Record Type="Common.ValueListParameterDisplayOnly">
                   <PropertyValue Property="ValueListProperty" String="ShippingCondition_Text"/>
               </Record>
           </Collection>
       </PropertyValue>
   </Record>
</Annotation>
```

STEP: SelectionFields (filter panel) and Searchable (SearchRestrictions)
DESCRIPTION: Use UI.SelectionFields on value help entity to define filter panel fields. Use Capabilities.SearchRestrictions(Searchable) to control the presence of search field and type-ahead behavior. By default, entity sets are searchable.
LANGUAGE: CAP CDS / XML
CODE:
```cap
annotate Customer with @(Capabilities.SearchRestrictions : {
    Searchable : true
});
```

STEP: Filter UI behavior and operators summary
DESCRIPTION: Filter panel expands by default only when: at least one filter field is mandatory, entity set not search-enabled, or ValueList.FetchValues = 2. Use Capabilities.FilterRestrictions to control AllowedExpressions (SingleValue/MultiValue/MultipleRange) and available filter operators. (No code change here; see filter restrictions vocabulary.)

STEP: Guid fields: use Common.ExternalID for descriptions (CAP CDS)
DESCRIPTION: For Edm.Guid fields, do not use Common.Text + TextOnly. Instead annotate Common.ExternalID with the readable description path.
LANGUAGE: CAP CDS
CODE:
```cap
category @(Common: {
    ExternalID : category.name,  // readable identifier
    FieldControl : #Mandatory,
    ValueList : {
        $Type : 'Common.ValueListType',
        CollectionPath : 'Categories',
        Label : '{i18n>Categories}',
        Parameters : [
            { $Type : 'Common.ValueListParameterInOut', LocalDataProperty : category_ID, ValueListProperty : 'ID' },
            { $Type : 'Common.ValueListParameterDisplayOnly', ValueListProperty : 'name' }
        ]
    }
});
```

STEP: Date and DateTime pickers and Timezone (XML & CAP CDS)
DESCRIPTION: - Edm.Date => date picker rendered. - Edm.DateTimeOffset => date/time picker rendered. - Specify timezone using Common.Timezone either as fixed IANA string or Path to another property. If not specified DateTimeOffset is converted/displayed in UI timezone.
LANGUAGE: XML
CODE:
```xml
<!-- Edm.Date property -->
<EntityType Name="SalesOrderManage">
   <Property Name="SalesOrderDate" Type="Edm.Date"/>
</EntityType>

<!-- Edm.DateTimeOffset properties and timezone annotations -->
<EntityType Name="SalesOrderManage">
   <Property Name="timeDefault" Type="Edm.DateTimeOffset"/>
   <Property Name="testTimeFixed" Type="Edm.DateTimeOffset"/>
   <Property Name="testTime" Type="Edm.DateTimeOffset"/>
   <Property Name="testTimezone" Type="Edm.String"/>
</EntityType>

<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/testTimeFixed">
   <Annotation Term="Common.Timezone" String="Asia/Riyadh"/>
   <Annotation Term="Common.Label" String="Timestamp with fixed timezone"/>
</Annotations>

<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/testTime">
   <Annotation Term="Common.Timezone" Path="testTimezone"/>
   <Annotation Term="Common.Label" String="Datetime Stamp with Timezone based on Property"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cap
entity SalesOrderManage {
    timeDefault : DateTime;
    testTimeFixed : DateTime @Common: { Timezone: 'Asia/Riyadh' };
    testTimezone : String;
    testTime : DateTime @Common: { Timezone: testTimezone };
}
```

STEP: Enable history of recently entered values (Launchpad setting)
DESCRIPTION: To show history of recently entered values for filter bar fields, enable INPUTFIELD_HISTORY in SAP Fiori launchpad parameters.
LANGUAGE: Text
CODE:
```text
Parameter to enable in SAP Fiori launchpad: INPUTFIELD_HISTORY
See: Manage Launchpad Settings:
https://help.sap.com/docs/SAP_S4HANA_CLOUD/4fc8d03390c342da8a60f8ee387bca1a/22d573aead754b80abca18ec71872fb7.html
```

STEP: Misc / Links / Notes
DESCRIPTION: - Value help for draft-enabled entities shows only active documents. - Parameterized value help service is not supported. - Live examples: Field - Format Options, Field - Edit Mode, Field - Multi Value Field, Filter Bar - Overview. - See further features: further-features-of-the-field-f49a0f7.md
LANGUAGE: Text
CODE:
```text
Live examples:
- Field - Format Options: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/fieldFormatOptions
- Field - Edit Mode: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/fieldEdit
- Field - Multi Value Field: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/multiValueField
- Filter Bar - Overview: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/filterBar/filterBarDefault

Additional doc:
- Value Help as a Dropdown List: value-help-as-a-dropdown-list-2a0a630.md
- Further Features of the Field: further-features-of-the-field-f49a0f7.md
```
--------------------------------

**TITLE**: Finding the Right Key for the Anchor (SAP Fiori elements for OData V4)

**INTRODUCTION**: Quick, actionable guide to locate DOM and metadata keys to use as position.anchor when placing custom elements (header facets, header fields, table columns, sections/subsections) in SAP Fiori elements (OData V4). Use the browser Developer Tools (DevTools) DOM inspector and network $metadata response to derive the correct anchor string.

**TAGS**: fiori-elements-framework, OData V4, anchors, position.anchor, header facet, table column, DOM, metadata, manifest.json

**STEP**: Open Developer Tools

**DESCRIPTION**: Open the browser Developer Tools to inspect DOM and Network. Hotkeys:
- Windows: CTRL + SHIFT + I
- macOS: CMD + OPT + I

**LANGUAGE**: text

**CODE**:
```text
Open DevTools → Elements tab (DOM inspector) → Network tab (filter by "$metadata")
```

**STEP**: Find Anchor for Header Facet

**DESCRIPTION**: In the DOM inspector search for either "fe::HeaderFacetContainer" (standard facet) or "fe::HeaderFacetCustomContainer" (custom facet). The token immediately following this string in the element ID is the facet key to use as position.anchor.

Examples:
- Element ID: AppName::AppNameObjectPage--fe::HeaderFacetContainer::AnchorHeaderFacetName
- Derived position.anchor: AnchorHeaderFacetName

Use the derived key string exactly as the value of position.anchor.

**LANGUAGE**: HTML/DOM

**CODE**:
```html
<!-- Example DOM element id you will find in DevTools -->
id="AppName::AppNameObjectPage--fe::HeaderFacetContainer::AnchorHeaderFacetName"

<!-- Anchor to use -->
position.anchor = "AnchorHeaderFacetName"
```

**STEP**: Find Anchor for Header Facet Field (Header Field inside a Facet)

**DESCRIPTION**: In the DOM inspector search for "fe::HeaderFacet::Form". Fields inside the form use a key pattern composed of the DataField type and the property name: DataFieldAbstractType::PropertyName. For most cases the prefix is "DataField".

Examples:
- Element ID: AppName::AppNameObjectPage--fe::HeaderFacet::Form::HeaderFacetName::DataField::PropertyName::Field
- Derived position.anchor: DataField::PropertyName

Use this combined type::property string as position.anchor to place your custom header field relative to that field.

**LANGUAGE**: HTML/DOM

**CODE**:
```html
<!-- Example DOM element id for a header field -->
id="AppName::AppNameObjectPage--fe::HeaderFacet::Form::HeaderFacetName::DataField::PropertyName::Field"

<!-- Anchor to use -->
position.anchor = "DataField::PropertyName"
```

**STEP**: Find Anchor for Table Column — Step 1: Discover DOM Column ID

**DESCRIPTION**: In the DOM inspector search for the prefix:
fe::table::AppName::LineItem::C::
(replace AppName with your application name). The element ID will have this prefix followed by the column name or group.

Examples:
- fe::table::AppName::LineItem::C::PersonName
- fe::table::AppName::LineItem::C::FieldGroup::multipleFields

The suffix after the prefix gives the column name portion used when composing the anchor key.

**LANGUAGE**: HTML/DOM

**CODE**:
```html
<!-- Example DOM column ids -->
id="...--fe::table::AppName::LineItem::C::PersonName"
id="...--fe::table::AppName::LineItem::C::FieldGroup::multipleFields"
```

**STEP**: Find Anchor for Table Column — Step 2: Determine Column Type from $metadata

**DESCRIPTION**: In DevTools Network tab, filter by "$metadata", open the metadata XML response and search for the <Annotation Term="UI.LineItem"> block. Each Record inside the collection has a Type (DataField / DataFieldForAction / DataFieldForAnnotation / etc.) and a Value or Target property indicating the column/property. Compose the anchor key as:
DataFieldAbstractType::ColumnName
(where DataFieldAbstractType is the Record Type and ColumnName is the property name or annotation target).

Sample metadata snippet and mapping rules included.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Sample UI.LineItem annotation excerpt from $metadata -->
<Annotation Term="UI.LineItem">
    <Collection>
        <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="PersonName"/>
        </Record>
        <Record Type="UI.DataFieldForAction">
            <PropertyValue Property="Action" String="ChangePresence"/>
        </Record>
        <Record Type="UI.DataFieldForAnnotation">
            <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#multipleFields"/>
        </Record>
        ...
    </Collection>
</Annotation>

<!-- Examples of composed anchors based on above -->
position.anchor = "DataField::PersonName"
position.anchor = "DataFieldForAction::ChangePresence"
position.anchor = "DataFieldForAnnotation::FieldGroup::multipleFields"
```

**STEP**: Use Custom Column Key from manifest.json as Anchor

**DESCRIPTION**: If you defined custom columns in manifest.json under the table's columns collection with custom keys, use that exact key as the position.anchor to reference the custom column directly.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": { /* ... */ },
  "sap.ui5": {
    "models": { /* ... */ }
  },
  "pages": [
    {
      "component": {
        "name": "YourComponent",
        "settings": {
          "columns": [
            {
              "key": "MyCustomColumnKey",
              "label": "Custom Column",
              "template": { "type": "Text", "path": "CustomProperty" }
            }
          ]
        }
      }
    }
  ]
}

<!-- Anchor referencing the custom column key -->
position.anchor = "MyCustomColumnKey"
```

**STEP**: Find Anchor for Section or Subsection

**DESCRIPTION**: In the DOM inspector search for "fe::FacetSection" (section) or "fe::FacetSubSection" (subsection). The token immediately after these strings in the element ID is the facet key to use as position.anchor.

Example:
- Element ID: AppName::AppNameObjectPage--fe::FacetSection::AnchorSectionFacetName
- Derived position.anchor: AnchorSectionFacetName

**LANGUAGE**: HTML/DOM

**CODE**:
```html
<!-- Example DOM element id for a section -->
id="AppName::AppNameObjectPage--fe::FacetSection::AnchorSectionFacetName"

<!-- Anchor to use -->
position.anchor = "AnchorSectionFacetName"
```

**STEP**: Generic position.anchor usage pattern (manifest / custom placement)

**DESCRIPTION**: Use the derived anchor string in your customization definition where position.anchor is required. Include placement (Before/After) as appropriate for your use case.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "customization": {
    "component": "YourComponent",
    "action": "addCustomElement",
    "position": {
      "anchor": "DataField::PersonName",
      "placement": "After"
    },
    "settings": {
      /* custom element settings */
    }
  }
}
```
--------------------------------

**TITLE**: Flexible Programming Model — actionable extension patterns for SAP Fiori elements (OData V4)

**INTRODUCTION**: This document provides concrete, ready-to-use code patterns for extending SAP Fiori elements applications using the Flexible Programming Model (FPM). It demonstrates how to:
- declare and implement XML Extension Points (fragments)
- register controller extensions
- add a custom page (treated like a custom page inside an Fiori elements-based shell)
- include building-block fragments

Use these patterns inside webapp/ (or your component root) and manifest.json. Keep file paths and names consistent across examples.

**TAGS**: sap-fe, fiori-elements, flexible-programming-model, extension-points, controller-extensions, custom-page, fragments, building-blocks, manifest

STEP: 1 — Declare and implement an Extension Point with a fragment

DESCRIPTION: Add an ExtensionPoint placeholder in the base XML view (provided by the framework or template). Then implement the fragment and register it through manifest.json viewExtensions so the framework injects the fragment into the placeholder.

LANGUAGE: XML, JSON

CODE:
```XML
<!-- webapp/view/BaseObjectPage.view.xml (or framework template view) -->
<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m">
  <!-- ... framework content ... -->
  <!-- Placeholder ExtensionPoint name must match the manifest registration -->
  <ExtensionPoint name="MyCustomSection"/>
</mvc:View>
```

```XML
<!-- webapp/fragments/MyCustomSection.fragment.xml -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:layout="sap.ui.layout">
  <Panel headerText="Custom Section (fragment)">
    <Text text="Injected content from MyCustomSection.fragment.xml" />
  </Panel>
</core:FragmentDefinition>
```

```JSON
// manifest.json (excerpt) — register fragment to the extension point of the framework view
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.fe.templates.ObjectPage.view.ObjectPage": {
            "MyCustomSection": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "my.app.fragments.MyCustomSection",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

STEP: 2 — Create and register a controller extension

DESCRIPTION: Provide a controller extension that augments or overrides lifecycle hooks of the framework controller. Map the framework controller name to your extension implementation in manifest.json under sap.ui.controllerExtensions. Implement the controller extension file under webapp/ (JS or TS).

LANGUAGE: JSON, JavaScript

CODE:
```JSON
// manifest.json (excerpt) — register controller extension
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ObjectPage.controller.ObjectPage": {
            "controllerName": "my.app.ext.ObjectPageExtension"
          }
        }
      }
    }
  }
}
```

```javascript
// webapp/controller/ObjectPageExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";
  return Controller.extend("my.app.ext.ObjectPageExtension", {
    onInit: function () {
      // Called after the extension controller is initialized.
      // Use this to attach to model events, modify bindings, or add custom handlers.
      // Example: subscribe to route matched event
      const oRouter = this.getOwnerComponent().getRouter();
      oRouter.getRoute("object").attachMatched(this._onRouteMatched, this);
    },

    _onRouteMatched: function (oEvent) {
      // custom logic when route matches
      // oEvent.getParameter("arguments") -> route arguments
    },

    // Example custom event handler to be referenced from fragments or views:
    onMyCustomAction: function (oEvent) {
      // handle button press or similar
    }
  });
});
```

STEP: 3 — Add a custom page and treat it as a custom page inside the FPM shell

DESCRIPTION: Define a routing target in manifest.json that points to your custom XML view and controller. This lets you add full custom pages into the Fiori elements app while reusing the shell and navigation.

LANGUAGE: JSON, XML, JavaScript

CODE:
```JSON
// manifest.json (excerpt) — routing -> targets -> CustomPage
{
  "sap.ui5": {
    "routing": {
      "config": {
        "routerClass": "sap.m.routing.Router",
        "viewType": "XML",
        "viewPath": "my.app.view",
        "controlId": "app",
        "controlAggregation": "pages",
        "async": true
      },
      "routes": [
        {
          "name": "custom",
          "pattern": "custom",
          "target": "CustomPage"
        }
      ],
      "targets": {
        "CustomPage": {
          "viewName": "CustomPage",
          "viewLevel": 2
        }
      }
    }
  }
}
```

```XML
<!-- webapp/view/CustomPage.view.xml -->
<mvc:View controllerName="my.app.controller.CustomPage" xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m">
  <Page title="Custom Page in FPM">
    <content>
      <Text text="This is a fully custom page inside the Fiori elements shell."/>
      <!-- Insert building-block fragments or custom UI5 controls here -->
    </content>
  </Page>
</mvc:View>
```

```javascript
// webapp/controller/CustomPage.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";
  return Controller.extend("my.app.controller.CustomPage", {
    onInit: function () {
      // initialization logic for the custom page
    }
  });
});
```

STEP: 4 — Use a building block inside a fragment or view

DESCRIPTION: Building blocks (FE macros / FE building blocks) are reusable UI pieces provided by the framework. Include them via fragments or directly in views. Below is a generic fragment usage pattern — replace the building block control names with the specific building block you need from the Building Blocks documentation.

LANGUAGE: XML

CODE:
```XML
<!-- webapp/fragments/BuildingBlockExample.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m" xmlns:fe="sap.fe.macros">
  <!-- Example: include a building block macro or custom control -->
  <!-- Replace fe:SampleBuildingBlock with the actual building block tag and properties -->
  <fe:SampleBuildingBlock id="bbSample" title="Sample Building Block" />
</core:FragmentDefinition>
```

STEP: 5 — References and testing resources

DESCRIPTION: Use the following official resources while developing and testing extensions. The Flexible Programming Model Explorer demonstrates live examples for building blocks, extension points, and custom pages.

LANGUAGE: URL

CODE:
```text
Flexible Programming Model Explorer:
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/overview/introduction

Related documentation: Building Blocks
building-blocks-24c1304.md
```
--------------------------------

**TITLE**: Form Entry Object Page (Fiori elements, OData V4) — Configuration & Examples

**INTRODUCTION**: This document shows the exact manifest and component changes and controller-extension usage required to create a Form Entry Object Page in SAP Fiori elements (OData V4). The Form Entry Object Page hides the object page header and navigation bar and can optionally start the app directly in create mode. It also explains enabling the singleDraftForCreate behavior both globally via manifest.json and programmatically via the EditFlow extension.

**TAGS**: fiori-elements-framework, object-page, form-entry, odata-v4, sap.fe, manifest.json, Component.js, singleDraftForCreate, EditFlow, controller-extension

**STEP**: 1 — Add a Form Entry Object Page target to manifest.json

**DESCRIPTION**: Add a routing target entry for the form entry object page. Place this target under manifest.json -> sap.ui5 -> routing -> targets. The target uses the standard ObjectPage component but hides the header and anchor/navigation bar via settings.content.header.visible and settings.content.header.anchorBarVisible.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "FormRootObjectPage": {
          "type": "Component",
          "id": "FormRootObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "contextPath": "/FormRoot",
              "editableHeaderContent": false,
              "content": {
                "header": {
                  "visible": false,
                  "anchorBarVisible": false
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Start the application automatically in create mode (Component.js)

**DESCRIPTION**: To launch the application directly in creation mode, implement getStartupParameters in your main App Component. Return a promise that resolves to { preferredMode: ["create"] }. Place this code in your Component.js file for the app component that extends sap.fe.core.AppComponent.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: Component.js
sap.ui.define(["sap/fe/core/AppComponent"], function(AppComponent) {
    "use strict";

    return AppComponent.extend("FormTemplate.Component", {
        metadata: {
            manifest: "json"
        },
        // Start the app in creation mode
        getStartupParameters: function() {
            return Promise.resolve({
                preferredMode: ["create"]
            });
        }
    });
});
```

**STEP**: 3 — Enable singleDraftForCreate globally in manifest.json

**DESCRIPTION**: Prevent creation of a new entity while an unsaved draft exists by enabling singleDraftForCreate. Add this setting under manifest.json -> sap.fe -> app. When true, the app looks for entities with IsActiveEntity=false and HasActiveEntity=false and opens the existing draft in edit mode instead of creating a new one.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.fe": {
    "app": {
      "singleDraftForCreate": true
    }
  }
}
```

**STEP**: 4 — Enable singleDraftForCreate via EditFlow controller extension (programmatic)

**DESCRIPTION**: Use the EditFlow controller extension to enable singleDraftForCreate programmatically when creating documents. Call editFlow.createDocument(listBinding, { singleDraftForCreate: true }) from your controller extension handler where you have access to the relevant ListBinding. The createDocument call will open the newly created entity in edit mode only if there are no unsaved drafts; otherwise it will open the latest unsaved draft.

Include this code in your controller extension file (e.g., controller/EditFlowExtension.controller.js) or in any handler where you have access to the EditFlow and the ListBinding.

- listBinding: a reference to the OData ListBinding for the collection (e.g., obtained from a table or list).
- editFlow.createDocument signature: createDocument(ListBinding, { singleDraftForCreate: true })

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File (example): controller/EditFlowExtension.controller.js
sap.ui.define([], function() {
    "use strict";

    return {
        // Example handler called from UI (e.g., custom action) that triggers create
        onCreateWithSingleDraftCheck: function(listBinding) {
            // 'editFlow' must be obtained according to your extension context.
            // Many Fiori Elements extension contexts expose an EditFlow instance as shown below.
            // Replace the following access with the correct one for your extension/context.
            var editFlow = this.getOwnerComponent && this.getOwnerComponent().getEditFlow
                ? this.getOwnerComponent().getEditFlow()
                : this._editFlow; // fallback placeholder

            if (!editFlow) {
                throw new Error("EditFlow instance not available in this context");
            }

            // Create document with singleDraftForCreate enabled.
            // If an unsaved draft exists (IsActiveEntity=false & HasActiveEntity=false),
            // the existing draft will be opened in edit mode instead of creating a new one.
            editFlow.createDocument(listBinding, { singleDraftForCreate: true })
                .then(function(oCreatedContext) {
                    // oCreatedContext: binding context of opened/created entity
                    // handle navigation, notifications or further init here
                })
                .catch(function(oError) {
                    // handle error
                });
        }
    };
});
```

**STEP**: 5 — Notes and behavior summary

**DESCRIPTION**: Summary of behavior to keep in mind when implementing:
- The Form Entry Object Page uses the standard ObjectPage template (sap.fe.templates.ObjectPage) with header and anchor bar visibility turned off.
- Setting getStartupParameters -> preferredMode: ["create"] forces the app to open in create mode at startup.
- singleDraftForCreate (manifest) or editFlow.createDocument(..., { singleDraftForCreate: true }) ensures users cannot create additional new entities while an unsaved draft exists; existing draft will be opened in edit mode instead.
- All snippets belong to OData V4 / SAP Fiori elements for OData V4.
--------------------------------

**TITLE**: Form Facet (Object Page Header Field Group)

**INTRODUCTION**: Show how to add a form facet to an Object Page header by adding a UI.ReferenceFacet to UI.HeaderFacets that targets a UI.FieldGroup (or UI.Identification). The ReferenceFacet label becomes the section title. Example demonstrates a "Sales Area" header facet containing SalesOrganization, DistributionChannel (conditionally hidden), and OrganizationDivision with high importance.

**TAGS**: fiori-elements-framework, annotations, UI.ReferenceFacet, UI.FieldGroup, ObjectPage, CDS, CAP, ABAP, XML, OData

**STEP**: 1 — XML OData Annotations: Add ReferenceFacet and FieldGroup (annotations.xml)

**DESCRIPTION**: Add a UI.ReferenceFacet entry to UI.HeaderFacets that targets the UI.FieldGroup qualifier "OrgData". Define the UI.FieldGroup (qualifier OrgData) and include UI.DataField records for SalesOrganization, DistributionChannel (hidden when Delivered), and OrganizationDivision. Set UI.Importance to High where shown.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Place inside your annotations file (e.g., annotations.xml) -->
<Annotation Term="UI.HeaderFacets">
    <Collection>
        ...
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Sales Area" />
            <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#OrgData" />
        </Record>
        ...
    </Collection>
</Annotation>

<Annotation Term="UI.FieldGroup" Qualifier="OrgData">
    <Record Type="UI.FieldGroupType">
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SalesOrganization"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="DistributionChannel"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                    <Annotation Term="UI.Hidden" Path="Delivered"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="OrganizationDivision"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 2 — ABAP CDS Annotations: Define header facet and field group on entity (ABAP CDS)

**DESCRIPTION**: Annotate an ABAP CDS entity to add a header ReferenceFacet (type FIELDGROUP_REFERENCE, purpose HEADER) that targets qualifier 'OrgData'. Use @UI.fieldGroup annotations on the logical fields to group them under qualifier 'OrgData', set importance to HIGH, and mark the DistributionChannel field as hidden when Delivered.

**LANGUAGE**: ABAP

**CODE**:
```abap
@UI.Facet: [
  {
    label: '{@i18n>@SalesArea}',
    targetQualifier: 'OrgData',
    type: #FIELDGROUP_REFERENCE,
    purpose: #HEADER
  },
  ...
]
product;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    position: 10 ,
    qualifier: 'OrgData'
  }
]
SALESORGANIZATION;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    hidden: true,
    position: 20 ,
    qualifier: 'OrgData'
  }
]
DISTRIBUTIONCHANNEL;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    position: 30 ,
    qualifier: 'OrgData'
  }
]
ORGANIZATIONDIVISION;
```

**STEP**: 3 — CAP (Core Data Services) Annotations: annotate service with HeaderFacets and FieldGroup (srv or annotations CDS)

**DESCRIPTION**: In CAP CDS, annotate the service or entity to add UI.HeaderFacets with a UI.ReferenceFacet pointing to UI.FieldGroup#OrgData. Define UI.FieldGroup #OrgData with Data entries for SalesOrganization, DistributionChannel (hidden conditionally via UI.Hidden), and OrganizationDivision. Mark importance as High.

**LANGUAGE**: CDS

**CODE**:
```cds
annotate service.Products with @(
  UI.HeaderFacets : [
    {
        $Type : 'UI.ReferenceFacet',
        Label : '{@i18n>@SalesArea}',
        Target : '@UI.FieldGroup#OrgData'
    },
   ...
  ],
  UI.FieldGroup #OrgData : {
    $Type : 'UI.FieldGroupType',
    Data : [
        {
            $Type : 'UI.DataField',
            Value : SalesOrganization,
            ![@UI.Importance] : #High
        },
        {
            $Type : 'UI.DataField',
            Value : DistributionChannel,
            ![@UI.Importance] : #High,
            ![@UI.Hidden] : Delivered
        },
        {
            $Type : 'UI.DataField',
            Value : OrganizationDivision,
            ![@UI.Importance] : #High
        }
    ]
  }
);
```
--------------------------------

**TITLE**: Configure Numeric Display Precision for Fiori Elements (Metadata and Annotations)

**INTRODUCTION**: This guide shows how to control how numeric values are formatted (number of decimal places and scaling) in SAP Fiori elements overview pages. Two approaches are supported: set the scale in the OData metadata (EntityType Property Scale) or provide formatting via UI annotations (DataPoint ValueFormat with NumberOfFractionalDigits and ScaleFactor). The UI uses SAPUI5 sap.ui.core.format.NumberFormat behind the scenes to render numbers.

**TAGS**: fiori-elements, odata, annotations, datapoint, numberformat, sapui5, cds, abap, cap

**STEP**: 1 — Set decimal precision in OData metadata (Edm.Decimal Scale)
**DESCRIPTION**: Edit your OData service metadata (CSDL) to set the Scale attribute on Edm.Decimal properties. The Scale value indicates how many fractional digits should be displayed by the UI.
**LANGUAGE**: XML
**CODE**:
```xml
<EntityType Name="Product" sap:content-version="1">
    ...
    <!-- Set Scale="3" to display three decimal places in the UI -->
    <Property Name="Price" Type="Edm.Decimal" Precision="16" Scale="3" sap:unit="CurrencyCode" sap:label="Unit Price"/>
    <Property Name="Width" Type="Edm.Decimal" Precision="13" Scale="3" sap:unit="DimUnit" sap:label="Dimensions"/>
    <Property Name="Depth" Type="Edm.Decimal" Precision="13" Scale="3" sap:unit="DimUnit" sap:label="Dimensions"/>
    <Property Name="Height" Type="Edm.Decimal" Precision="13" Scale="3" sap:unit="DimUnit" sap:label="Dimensions"/>
    ...
</EntityType>
```

**STEP**: 2 — Provide formatting via XML annotation: DataPoint ValueFormat
**DESCRIPTION**: Add a UI.DataPoint annotation (XML) and use the ValueFormat record (UI.NumberFormat) to specify ScaleFactor and NumberOfFractionalDigits. ScaleFactor multiplies/divides the raw value for presentation (common for thousands). NumberOfFractionalDigits controls displayed fractional digits.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="Price">
    <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
        <PropertyValue Property="Title" String="Unit Price"/>
        <PropertyValue Property="Description" Path="Name"/>
        <PropertyValue Property="Value" Path="Price"/>
        <PropertyValue Property="ValueFormat">
            <Record Type="com.sap.vocabularies.UI.v1.NumberFormat">
                <!-- ScaleFactor: 1000 (e.g., show value / 1000) -->
                <PropertyValue Property="ScaleFactor" Decimal="1000"/>
                <!-- NumberOfFractionalDigits: 1 -> show 1 decimal place -->
                <PropertyValue Property="NumberOfFractionalDigits" Iint="1"/>
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 3 — Provide formatting via ABAP CDS annotation (DataPoint)
**DESCRIPTION**: In ABAP CDS views, use @UI.dataPoint with valueFormat to set scaleFactor and numberOfFractionalDigits for a field. This annotation will be consumed by the Fiori elements UI to render the value accordingly.
**LANGUAGE**: ABAP
**CODE**:
```abap
@UI.dataPoint: {
  title: 'Unit Price',
  description: 'Name',
  valueFormat: {
    scaleFactor: 1000,
	numberOfFractionalDigits: 1
  }
}
Price;
```

**STEP**: 4 — Provide formatting via CAP CDS annotation (DataPoint)
**DESCRIPTION**: In CAP (Core Data Services) model annotations, declare UI.DataPoint with ValueFormat as UI.NumberFormat and set ScaleFactor and NumberOfFractionalDigits. This is used by the Fiori elements generator to control display precision.
**LANGUAGE**: CDS
**CODE**:
```cds
UI.DataPoint #Price : {
    $Type : 'UI.DataPointType',
    Title : 'Unit Price',
    Description : Name,
    Value : Price,
    ValueFormat : {
        $Type : 'UI.NumberFormat',
        ScaleFactor : 1000,
        NumberOfFractionalDigits : 1
    }
}
```

**STEP**: 5 — How the framework uses these values (implementation note)
**DESCRIPTION**: The Fiori elements framework reads either the OData metadata Scale attribute or the DataPoint.ValueFormat.NumberOfFractionalDigits and ScaleFactor, and formats numbers using sap.ui.core.format.NumberFormat. Use metadata for property-level defaults; use annotations to override presentation (format and scale) per UI scenario. If both exist, annotation-based ValueFormat typically controls UI presentation for the annotated DataPoint. Example behavior:
- Property Scale="3" -> UI displays 3 fractional digits.
- ValueFormat.NumberOfFractionalDigits=1 -> UI displays 1 fractional digit.
- ValueFormat.ScaleFactor=1000 -> UI divides/multiplies raw value accordingly before formatting.

**LANGUAGE**: JavaScript
**CODE**:
```javascript
// Example: SAPUI5 formatting (framework applies this automatically based on metadata/annotations)
const oNumberFormat = sap.ui.core.format.NumberFormat.getFloatInstance({
  minFractionDigits: 1, // derived from NumberOfFractionalDigits or Scale
  maxFractionDigits: 1
});
const formatted = oNumberFormat.format(1234.567); // "1234.6" if 1 fractional digit
```
--------------------------------

**TITLE**: Further Field Features for SAP Fiori elements (OData V4): Texts, External IDs, Fiscal Types, Visibility, Field Control, Editability, Tooltips, Units-of-Measure Scale Check

**INTRODUCTION**: Practical, code-centric guide showing how to annotate OData V4 services (XML, ABAP CDS, CAP CDS) to control field text exposure and arrangement, readable GUIDs, fiscal patterns, visibility (UI.Hidden), enablement (FieldControl), editability (Core.* / FieldControl), DataPoint tooltips (Common.QuickInfo) and skipping unit-of-measure scale validation. Use in SAP Fiori elements (OData V4).

**TAGS**: fiori-elements-framework, annotations, OData V4, Common.Text, UI.TextArrangement, Common.ExternalID, fiscal, UI.Hidden, FieldControl, Core.Computed, Core.Immutable, Common.QuickInfo, DoNotCheckScaleOfMeasuredQuantity

STEP: Text and TextArrangement (Common.Text / UI.TextArrangement)
DESCRIPTION: Define a textual description for an ID property with Common.Text and control how text and ID are displayed with UI.TextArrangement. Property-level TextArrangement overrides entity-set-level fallback. TextArrangement options: TextFirst (default, "Text (ID)"), TextLast ("ID (Text)"), TextOnly ("Text"), TextSeparate ("ID").
LANGUAGE: XML
CODE:
```xml
<!-- Property-level Common.Text + TextArrangement -->
<Annotations Target="com.c_salesordermanage_sd/SalesOrganization">
  <Annotation Term="Common.Text" Path="SalesOrganization_Text">
    <Annotation Term="UI.TextArrangement" EnumMember="UI.TextArrangementType/TextOnly"/>
  </Annotation>
</Annotations>

<!-- EntitySet-level fallback TextArrangement (used only when property-level not set) -->
<Annotations Target="SalesOrder"> <!-- Main EntitySet -->
  <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@ObjectModel.text.element: ['SalesOrganization_Text']
@UI.textArrangement: #TEXT_ONLY
SalesOrganization
```

LANGUAGE: CDS
CODE:
```cds
annotate com.c_salesordermanage_sd with {
  SalesOrganization @( Common : {
    Text: SalesOrganization_Text,
    TextArrangement : #TextOnly
  });
};
```

STEP: Display readable IDs for Edm.Guid (Common.ExternalID)
DESCRIPTION: For Edm.Guid properties define Common.ExternalID to point to a readable identifier property. The UI shows the readable ID; Common.Text/TextArrangement apply to the readable ID property. ValueHelp (Common.ValueList collectionPath) should be defined on the GUID property.
LANGUAGE: XML
CODE:
```xml
<!-- Map GUID property to readable externalId -->
<Annotations Target="ExternalIdService.Entities/myGuidProperty">
  <Annotation Term="Common.ExternalID" Path="externalId"/>
</Annotations>
```

LANGUAGE: CDS
CODE:
```cds
annotate ExternalIdService.Entities : myGuidProperty with @(Common: { ExternalID: externalId });
```

DESCRIPTION (notes):
- Common.Text and UI.TextArrangement are evaluated for the externalId property (readable ID), not for the GUID.
- Value helps: define collectionPath of Common.ValueList on the Edm.Guid property; the entity for the value help can expose Guid -> readable ID mapping.

STEP: Fiscal Annotations (string-based fiscal patterns)
DESCRIPTION: Annotate Edm.String fiscal fields to indicate fiscal patterns. CAP CDS annotation names are listed with their pattern. ABAP CDS equivalents use Semantics.fiscal.* annotations where available.
LANGUAGE: Reference (patterns)
CODE:
```text
CAP CDS -> Pattern -> ABAP CDS
IsFiscalYearPeriod      -> YYYYPPP    -> Semantics.fiscal.yearPeriod
IsDayOfFiscalYear       -> d          -> N/A (no ABAP equivalent)
IsFiscalPeriod          -> PPP        -> Semantics.fiscal.period
IsFiscalQuarter         -> Q          -> Semantics.fiscal.quarter
IsFiscalWeek            -> WW         -> Semantics.fiscal.week
IsFiscalYear            -> YYYY       -> Semantics.fiscal.year
IsFiscalYearQuarter     -> YYYYQ      -> Semantics.fiscal.yearQuarter
IsFiscalYearWeek        -> YYYYWW     -> Semantics.fiscal.yearWeek
Semantics.fiscal.yearVariant (ABAP only) -> N/A (CAP CDS)
```

LANGUAGE: XML
CODE:
```xml
<!-- Example XML annotations for LineItems fiscal fields -->
<Annotations Target="sap.fe.manageitems.TechnicalTestingService.LineItems/fiscalYearPeriod">
  <Annotation Term="Common.IsFiscalYearPeriod" Bool="true"/>
  <Annotation Term="Common.Label" String="Fiscal Year Period"/>
</Annotations>
<Annotations Target="sap.fe.manageitems.TechnicalTestingService.LineItems/fiscalDayOfYear">
  <Annotation Term="Common.IsDayOfFiscalYear" Bool="true"/>
  <Annotation Term="Common.Label" String="Fiscal Day Of Year"/>
</Annotations>
<!-- ... fiscalPeriod, fiscalQuarter, fiscalWeek, fiscalYear, fiscalYearQuarter, fiscalWeekYear ... -->
```

LANGUAGE: ABAP CDS
CODE:
```abap
DEFINE VIEW SalesOrderItemHistoryOvw as select from ...
{
  @Semantics.fiscal.yearPeriod: true
  fiscalYearPeriod,

  @Semantics.fiscal.period: true
  fiscalPeriod,

  @Semantics.fiscal.year: true
  fiscalYear,
  ...
}
```

LANGUAGE: CDS
CODE:
```cds
fiscalYearPeriod  : String  @title: 'Fiscal Year Period'   @Common.IsFiscalYearPeriod : true;
fiscalDayOfYear   : String  @title: 'Fiscal Day Of Year'   @Common.IsDayOfFiscalYear  : true;
fiscalPeriod      : String  @title: 'Fiscal Period'        @Common.IsFiscalPeriod     : true;
fiscalQuarter     : String(1) @title: 'Fiscal Quarter'     @Common.IsFiscalQuarter    : true;
fiscalWeek        : String  @title: 'Fiscal Week'          @Common.IsFiscalWeek       : true;
fiscalYear        : String  @title: 'Fiscal Year'          @Common.IsFiscalYear       : true;
fiscalYearQuarter : String(5) @title: 'Fiscal Year Quarter' @Common.IsFiscalYearQuarter: true @Common.IsDigitSequence: true;
fiscalWeekYear    : String  @title: 'Fiscal Week Year'     @Common.IsFiscalYearWeek   : true;
```

STEP: Visibility - UI.Hidden (property-level, DataField-level, path-based)
DESCRIPTION: Control field visibility with UI.Hidden either on a Property annotation or within a UI.DataField. Path-based UI.Hidden targets another property (e.g., HasDraftEntity). ABAP CDS does not support path-based UI.Hidden; use local XML for path-based cases.
LANGUAGE: XML
CODE:
```xml
<!-- UI.Hidden within a DataField -->
<Record Type="UI.DataField">
  <PropertyValue Property="Value" Path="TotalNetAmount" />
  <Annotation Term="UI.Hidden" Bool="false" />
</Record>

<!-- UI.Hidden on property -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/TotalNetAmount">
  <Annotation Term="Common.Label" String="Net Amount"/>
  <Annotation Term="Measures.ISOCurrency" Path="TransactionCurrency"/>
  <Annotation Term="UI.Hidden" Bool="true" />
</Annotations>

<!-- Path-based UI.Hidden: hide ModifiedAt when HasDraftEntity = true (FieldGroup qualifier) -->
<Annotations Target="SAP__self.ProductsType">
  <Annotation Term="SAP__UI.FieldGroup" Qualifier="AdministrativeData">
    <Record>
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="SAP__UI.DataField">
            <Annotation Term="SAP__UI.Hidden" Path="HasDraftEntity"/>
            <PropertyValue Property="Label" String="Modified at"/>
            <PropertyValue Property="Value" Path="ModifiedAt"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>

<!-- Always hidden property ID -->
<Annotations Target="SAP__self.ProductsType/ID">
  <Annotation Term="SAP__UI.Hidden"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
" Example: mark TOTALNETAMOUNT hidden via local ABAP view annotation
@UI.hidden: true
TOTALNETAMOUNT;

" ProductsType ID always hidden
annotate view PRODUCTSTYPE with {
  @UI.hidden: true
  id;
}
```

LANGUAGE: CDS
CODE:
```cds
annotate com.c_salesordermanage_sd.SalesOrderManage with {
  TotalNetAmount
    @UI.Hidden
    @Common.Label : 'Net Amount'
    @Measures.ISOCurrency : TransactionCurrency;
};

entity ProductsType : {
  ID @UI.Hidden;
};

entity ProductsType : {
  UI.FieldGroup #AdministrativeData : {
    Data : [
      {
        $Type : 'UI.DataField',
        Label : 'Modified at',
        Value : ModifiedAt,
        ![@UI.Hidden] : HasDraftEntity
      }
    ]
  }
}
```

STEP: FieldControl (Common.FieldControl) and enablement
DESCRIPTION: Use Common.FieldControl (enum FieldControlType) to control enablement/read-only/mandatory/inapplicable. FieldControl can be static (EnumMember) or path-based (dynamic). When path-based, the path property must be Edm.Byte. ABAP CDS exposes @ObjectModel.mandatory but not @ObjectModel.readOnly and cannot express path-based FieldControl; use XML metadata for advanced cases.
LANGUAGE: XML
CODE:
```xml
<!-- Property-level FieldControl static -->
<Annotations Target="SAP__self.ArtistsType/Name">
  <Annotation Term="SAP__common.FieldControl" EnumMember="SAP__common.FieldControlType/Mandatory"/>
</Annotations>

<!-- DataField-level FieldControl (read-only in specific UI usage) -->
<Record Type="UI.DataField">
  <PropertyValue Property="Value" Path="TotalNetAmount" />
  <Annotation Term="SAP__common.FieldControl" EnumMember="SAP__common.FieldControlType/ReadOnly"/>
</Record>

<!-- Path-based field control example -->
<Annotations Target="SAP__self.ReviewsType/AvailabilityCode">
  <Annotation Term="SAP__Common.FieldControl" Path="__FieldControl/AvailabilityCode_FC"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
" Mandatory via ABAP CDS (only @ObjectModel.mandatory supported)
@ObjectModel.mandatory: true
Name;
```

LANGUAGE: CDS
CODE:
```cds
entity Artist : {
  Name : {
    FieldControl : #Mandatory
  }
}

" DataField-level FieldControl
{
  $Type : 'UI.DataField',
  Value : TotalNetAmount,
  ![@Common.FieldControl] : #ReadOnly
}
```

DESCRIPTION (FieldControl value map):
```text
FieldControl Value -> Behavior -> EnumMember
Mandatory   -> Must be non-null on save/update (backend validation required). Column header marked mandatory in edit mode.
            -> SAP__common.FieldControlType/Mandatory

Optional    -> Property may be null.
            -> SAP__common.FieldControlType/Optional

ReadOnly    -> Property cannot be changed (non-editable in edit mode).
            -> SAP__common.FieldControlType/ReadOnly

Inapplicable-> No meaning in current state, rendered disabled. Static Inapplicable is ignored by Fiori elements; dynamic Inapplicable renders disabled.
            -> SAP__common.FieldControlType/Inapplicable
```

NOTES:
- Path-based FieldControl must point to an Edm.Byte property.
- Fields in Insert/Update Restrictions marked RequiredProperties are rendered mandatory only in create/update flows. See adding-actions-to-tables-b623e0b.md.

STEP: Editability (Core.Computed, Core.Immutable, Common.FieldControl)
DESCRIPTION: Mark fields as non-editable or conditionally editable:
- Core.Computed true: always non-editable.
- Core.Immutable true: non-editable in edit mode, but editable in create mode.
- Common.FieldControl can be static #ReadOnly or path-based dynamic.
LANGUAGE: XML
CODE:
```xml
<!-- Core.Computed: CreatedAt always read-only -->
<Annotations Target="SAP__self.ProductsType/CreatedAt">
  <Annotation Term="Core.Computed"/>
</Annotations>

<!-- Static FieldControl read-only for SupplierName -->
<Annotations Target="SAP__self.ProductsType/SupplierName">
  <Annotation Term="SAP__Common.FieldControl" EnumMember="com.sap.vocabularies.Common.v1.FieldControl/ReadOnly"/>
</Annotations>

<!-- Dynamic FieldControl: read-only when __FieldControl/AvailabilityCode_FC == 1 -->
<Annotations Target="SAP__self.ReviewsType/AvailabilityCode">
  <Annotation Term="SAP__Common.FieldControl" Path="__FieldControl/AvailabilityCode_FC"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
" Core vocabulary annotations are not supported in ABAP CDS for Core.Computed/Core.Immutable.
" Mandatory via @ObjectModel.mandatory is supported; @ObjectModel.readOnly is not exposed.
```

LANGUAGE: CDS
CODE:
```cds
entity ProductsType : {
  CreatedAt : {
    Core.Computed: true
  }
}

entity ProductsType : {
  SupplierName : {
    Common.FieldControl : #ReadOnly
  }
}

entity ReviewsType : {
  Common.FieldControl : __FieldControl.AvailabilityCode_FC
}
```

NOTES:
- ABAP CDS cannot express path-based FieldControl or Core.* local metadata for some cases; use local XML metadata for these scenarios.

STEP: DataPoint tooltip (Common.QuickInfo)
DESCRIPTION: Add tooltip text for a UI.DataPoint when no explicit label exists by adding Common.QuickInfo. ABAP CDS does not support Common.QuickInfo for dataPoint; qualifier auto-generated in ABAP case.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Rating">
  <Record Type="UI.DataPointType">
    <Annotation Term="Common.QuickInfo" String="Rating Indicator "/>
    <PropertyValue Property="TargetValue" Int="5"/>
    <PropertyValue Property="Title" String="Rating"/>
    <PropertyValue Property="Value" Path="Rating"/>
    <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Rating"/>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  title: 'Rating',
  visualization: #RATING,
  targetValue: 5
}
Rating;
" Note: Common.QuickInfo not supported for dataPoint in ABAP CDS; qualifier auto-generated.
```

LANGUAGE: CDS
CODE:
```cds
UI.DataPoint #Rating : {
  $Type : 'UI.DataPointType',
  TargetValue : 5,
  Title : 'Rating',
  Value : Rating,
  Visualization : #Rating,
  ![@Common.QuickInfo] : 'Rating Indicator ',
}
```

STEP: Disable standard validation of decimal places for units (DoNotCheckScaleOfMeasuredQuantity)
DESCRIPTION: Use com.sap.vocabularies.UI.v1.DoNotCheckScaleOfMeasuredQuantity (Bool) to disable central validation that enforces maximum decimals defined by the unit/currency customizing. Setting true disables the check and allows more fractional digits (subject to field's own decimal-limit). Setting false enforces the central check.
LANGUAGE: XML
CODE:
```xml
<!-- Disable central scale check on a measured quantity field -->
<Annotations Target="MyService.MyEntity/MeasuredQuantity">
  <Annotation Term="com.sap.vocabularies.UI.v1.DoNotCheckScaleOfMeasuredQuantity" Bool="true"/>
</Annotations>
```

DESCRIPTION (notes):
- The per-field decimal limits still apply: the annotation only disables the central unit/currency code list scale check, not the field's own max-decimal constraint.
- For background on units/currencies and code list customizing, see: ../04_Essentials/currency-and-unit-customizing-in-odata-v4-4d1b9d4.md

References:
- Field Help Text/TextArrangement: field-help-a5608ea.md (Using the Text and TextArrangement Annotation)
- ABAP CDS semantics docs: https://help.sap.com/docs/abap-cloud/abap-rap/semantics-annotations
- Live example: Field - Fiscal types (FPM explorer): https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/fieldFiscals
--------------------------------

**TITLE**: Post-Generation Changes for SAP Fiori Elements Apps (manifest.json & annotations)

**INTRODUCTION**: After generating a SAP Fiori elements app, update manifest.json and annotation files to enable or modify runtime features (draft handling, flexible layout, annotation overlays, etc.). This document gives concise, code-focused examples and file locations to apply common post-generation changes and points to extension guides and floorplan-specific docs.

**TAGS**: fiori-elements-framework, manifest.json, annotations, sap.ui.generic.app, extension, list-report, object-page, worklist, analytical-list-page, overview-pages

STEP: 1 — Locate manifest.json and annotation files

DESCRIPTION: Files you will modify are inside the app webroot. Confirm these paths before editing.

LANGUAGE: none

CODE:
```
File paths (relative to project root):
- webapp/manifest.json         # main app descriptor to change features and references
- webapp/annotations/*.xml     # local OData annotation files (example location)
- webapp/annotations/*.cds     # (if using CDS-generated annotations)
- webapp/ext/                  # extension folder (custom controllers, fragments, etc.)
```

STEP: 2 — Minimal manifest.json structure: add dataSources and generic app settings

DESCRIPTION: Use this pattern to add the OData service, reference local annotation files, and enable common generic app settings (draft handling, flexible column layout). Replace ids, URIs, entitySet names, and paths for your app.

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "id": "com.example.myapp",
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/MY_SERVICE_SRV/",
        "type": "OData",
        "settings": {
          "annotations": [
            { "uri": "annotations/annotations.xml" }
          ]
        }
      }
    }
  },
  "sap.ui.generic.app": {
    "settings": {
      "isDraftEnabled": true,
      "flexibleColumnLayout": true
    },
    "pages": [
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport"
        }
      }
    ]
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      }
    }
  }
}
```

STEP: 3 — Example local annotation XML file

DESCRIPTION: Place local annotation artifacts under webapp/annotations/. This XML skeleton shows referencing standard UI vocabulary and adding a simple annotation. Adjust Target, Namespace, and annotation content to match your service.

LANGUAGE: XML

CODE:
```xml
<!-- webapp/annotations/annotations.xml -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="https://sap.github.io/odata-vocabularies/vocabularies/UI.xml">
    <edmx:Include Namespace="UI" Alias="UI"/>
  </edmx:Reference>
  <edmx:DataServices>
    <Schema Namespace="Z_MY_ANNOTATIONS" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <!-- Example: add UI.HeaderInfo for an entity type -->
      <Annotations Target="MY_SERVICE_SRV.Product">
        <Annotation Term="UI.HeaderInfo">
          <Record>
            <PropertyValue Property="TypeName" String="Product"/>
          </Record>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

STEP: 4 — Enable or change floorplan-specific settings in manifest.json

DESCRIPTION: Floorplans expose different settings. Use sap.ui.generic.app settings and page component names to configure behavior. Example: switch from List Report to Object Page or add Analytical List Page component.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "settings": {
      "isDraftEnabled": false,
      "flexibleColumnLayout": false
    },
    "pages": [
      {
        "entitySet": "SalesOrders",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      },
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage"
        }
      }
    ]
  }
}
```

STEP: 5 — Add a local annotation reference for multiple annotation files

DESCRIPTION: If you have multiple local annotation files, reference them in the dataSources settings array. Ordering can be important (service annotations vs. local overlays).

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/MY_SERVICE_SRV/",
        "type": "OData",
        "settings": {
          "annotations": [
            { "uri": "annotations/service-annotations.xml" },
            { "uri": "annotations/overrides.xml" }
          ]
        }
      }
    }
  }
}
```

STEP: 6 — Extension approaches and references

DESCRIPTION: Two extension paths: use SAP Fiori tools (recommended for in-IDE guided extensions) or manual extension. Use the VS Code SAP Fiori tools extension to scaffold extensions, or follow manual extension docs when you need complete control.

LANGUAGE: none

CODE:
```
Resources:
- Configure Page Elements (SAP Fiori tools): 
  https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/047507c86afa4e96bb3d284adb9f4726.html

- Manual extension guide (project docs):
  extending-sap-fiori-elements-based-apps-358cf25.md

Suggested local extension folder:
- webapp/ext/                 # place custom controllers, fragments, and extension code here
```

STEP: 7 — Floorplan-specific post-generation docs (links / filenames)

DESCRIPTION: Use these floorplan-specific guides for configuration examples and advanced manifest/annotation changes.

LANGUAGE: none

CODE:
```
Floorplan-specific documents (local documentation filenames):
- List Report and Object Page:     list-report-and-object-page-c0eec49.md
- Worklist:                        worklist-d1d588f.md
- Analytical List Page:            analytical-list-page-3d33684.md
- Overview Pages:                  overview-pages-c64ef8c.md
```
--------------------------------

**TITLE**: Fiori Elements — General Concepts (Actionable Reference for Code Generation)

**INTRODUCTION**: Practical, code-focused reference of core Fiori Elements concepts and common artifacts (manifest entries, OData/annotation wiring, CDS annotations, annotation XML, project structure, and controller extension). Use these snippets as templates when generating or modifying Fiori Elements applications.

**TAGS**: fiori-elements, ui5, annotations, OData, manifest.json, CDS, i18n, extension-points

**STEP**: 1 — Project structure (recommended)
**DESCRIPTION**: Typical file layout for a Fiori Elements application. Use these paths when generating files or wiring manifest references.
**LANGUAGE**: none
**CODE**:
```
/webapp
  /annotations
    annotations.xml         # local annotation file (OData V2/V4)
  /controller
    ObjectPage.controller.js
  /i18n
    i18n.properties
  /localService
    metadata.xml            # optional local metadata for mock/testing
  Component.js
  manifest.json
  index.html
  /src
    -- optional app logic, CDS artifacts, etc.
```

**STEP**: 2 — manifest.json: core entries (dataSources, models, generic app/pages)
**DESCRIPTION**: Minimal, actionable manifest snippet wiring the OData service, local annotation file, and declaring a generic page (List Report / Object Page) used by Fiori Elements templates. Replace URIs and entitySet names with your values.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.app": {
    "id": "my.app",
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/MY_SERVICE_SRV/",
        "type": "OData",
        "settings": {
          "odataVersion": "2.0"
        }
      },
      "mainAnnotations": {
        "type": "ODataAnnotation",
        "settings": {
          "localUri": "annotations/annotations.xml"
        }
      }
    }
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "preload": true
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Books",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        }
      },
      {
        "entitySet": "Books",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      }
    ]
  }
}
```

**STEP**: 3 — Annotation XML: UI.LineItem and UI.Field examples
**DESCRIPTION**: Annotate the entity to control list/report fields and object page sections. Use these snippets in annotations/annotations.xml and reference from manifest (localUri above).
**LANGUAGE**: XML
**CODE**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="http://docs.oasis-open.org/odata/odata/v4.0/cs01/vocabularies/Org.OData.Core.V1.xml" />
  <edmx:Reference Uri="http://docs.oasis-open.org/odata/odata/v4.0/cs01/vocabularies/UI.xml" />
  <edmx:DataServices>
    <Schema Namespace="MyApp.Annotations" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <Annotations Target="MyService.Books">
        <Annotation Term="UI.LineItem">
          <Collection>
            <Record Type="UI.DataField">
              <PropertyValue Property="Label" String="Title"/>
              <PropertyValue Property="Value">
                <Path>Title</Path>
              </PropertyValue>
            </Record>
            <Record Type="UI.DataField">
              <PropertyValue Property="Label" String="Author"/>
              <PropertyValue Property="Value">
                <Path>Author</Path>
              </PropertyValue>
            </Record>
          </Collection>
        </Annotation>

        <Annotation Term="UI.FieldGroup" Qualifier="Main">
          <Record>
            <PropertyValue Property="Label" String="General"/>
            <PropertyValue Property="Data">
              <Collection>
                <Record Type="UI.DataField">
                  <PropertyValue Property="Label" String="ISBN"/>
                  <PropertyValue Property="Value"><Path>ISBN</Path></PropertyValue>
                </Record>
              </Collection>
            </PropertyValue>
          </Record>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 4 — CDS: annotate a domain entity (CDS example)
**DESCRIPTION**: If using ABAP CDS or CAP CDS, add UI annotations in the CDS model to generate annotations or metadata consumed by Fiori Elements.
**LANGUAGE**: CDS
**CODE**:
```cds
namespace my.app;

using { cuid } from '@sap/cds/common';

entity Books {
  key ID    : UUID default cuid();
  Title     : String(200);
  Author    : String(100);
  ISBN      : String(20);
}

annotate my.app.Books with {
  @UI.lineItem: [
    { Value: Title, Label: 'Title' },
    { Value: Author, Label: 'Author' }
  ]
  @UI.fieldGroup: [{
    label: 'Main',
    data: [
      { value: ISBN, label: 'ISBN' }
    ]
  }]
}
```

**STEP**: 5 — Component/Controller extension: register and implement a controller extension
**DESCRIPTION**: Register a controller extension in manifest.json and implement the JS controller to add custom logic (hook into lifecycle events). Replace template controller names and namespaces as applicable.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.controller.ObjectPage": {
            "controllerName": "my.app.ext.ObjectPage"
          }
        }
      }
    }
  }
}
```

**LANGUAGE**: JavaScript
**CODE**:
```javascript
// webapp/controller/ObjectPage.controller.js
sap.ui.define(["sap/ui/core/mvc/Controller"], function(Controller) {
  "use strict";
  return Controller.extend("my.app.ext.ObjectPage", {
    onInit: function() {
      // called when the controller is instantiated
      // add custom initialization or event handlers
    },

    onBeforeRebindTable: function(oEvent) {
      // example hook supported by some templates
      // modify binding parameters before data is fetched
    }
  });
});
```

**STEP**: 6 — i18n resource wiring
**DESCRIPTION**: Add an i18n model entry and example i18n.properties key-value pair.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "models": {
      "i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "settings": {
          "bundleName": "my.app.i18n.i18n"
        }
      }
    }
  }
}
```

**LANGUAGE**: Properties
**CODE**:
```
# webapp/i18n/i18n.properties
appTitle=My Fiori Elements App
listTitle=Books
```

**STEP**: 7 — Local testing: metadata.xml for mock/local usage
**DESCRIPTION**: Provide a local metadata.xml in the localService folder for offline/testing. Reference it via dataSources.settings.localUri in manifest if needed.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- localService/metadata.xml (trimmed sample) -->
<edmx:Edmx Version="4.0" xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx">
  <edmx:DataServices>
    <Schema Namespace="MyService" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <EntityType Name="Books">
        <Key>
          <PropertyRef Name="ID"/>
        </Key>
        <Property Name="ID" Type="Edm.Guid"/>
        <Property Name="Title" Type="Edm.String"/>
        <Property Name="Author" Type="Edm.String"/>
        <Property Name="ISBN" Type="Edm.String"/>
      </EntityType>
      <EntityContainer Name="Container">
        <EntitySet Name="Books" EntityType="MyService.Books"/>
      </EntityContainer>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 8 — Quick checklist for code generation
**DESCRIPTION**: Actionable list to validate when generating or updating a Fiori Elements app.
**LANGUAGE**: none
**CODE**:
```
- Ensure manifest.json lists the OData service in sap.app.dataSources (mainService).
- Add annotation file reference (localUri) as an ODataAnnotation dataSource.
- Map the default model ("") to the mainService dataSource under sap.ui5.models.
- Declare pages/components under sap.ui.generic.app.pages (ListReport/ObjectPage) or sap.fe templates.
- Place UI annotations in annotations/annotations.xml or generate from CDS.
- Register controller extensions under sap.ui5.extends.extensions.sap.ui.controllerExtensions as needed.
- Wire i18n under sap.ui5.models.i18n with bundleName pointing to webapp/i18n/i18n.properties.
- For local testing, include localService/metadata.xml and reference it via dataSources.mainService.settings.localUri.
```

--------------------------------

**TITLE**: Fiori Elements — General Concepts and Configuration (Actionable Reference)

**INTRODUCTION**: Consolidated, developer-focused checklist linking core Fiori elements configuration topics. Use this as a quick reference to navigate related documentation, identify required configuration files and annotations, and start implementation tasks. Each step points to the exact documentation file and gives a short, actionable instruction you can use when writing code or updating configuration.

**TAGS**: fiori-elements-framework, configuration, annotations, manifest, routing, ux, variants, responsiveness, value-help

**STEP**: 1 — Generic and Custom Actions

**DESCRIPTION**: Use generic actions available in SAP Fiori elements and implement app-specific actions via annotations or extension points. Review the provided doc to identify which generic actions you can use and where to place custom action code or annotation fragments.

**LANGUAGE**: Documentation/Markdown

**CODE**:
```markdown
Related doc: actions-cbf16c5.md
Actionable tasks:
- Inspect annotation fragments for com.sap.vocabularies.UI.v1.Action.
- Decide whether to use built-in generic actions or implement custom actions in controller extensions.
- Place annotation snippets under: <your-app>/annotations/*.xml or in CDS annotations.
```

**STEP**: 2 — Using Messages

**DESCRIPTION**: Understand when and how the system generates messages. Implement message handling and UI display behavior according to the scenarios described in the documentation.

**LANGUAGE**: Documentation/Markdown

**CODE**:
```markdown
Related doc: using-messages-239b192.md
Actionable tasks:
- Map backend message types to UI presentation (error, warning, info).
- Ensure message handling code lives in the UI controller or message handling module.
- Configure message popovers or dialog behavior in the view/controller as needed.
```

**STEP**: 3 — Enabling the Flexible Column Layout

**DESCRIPTION**: Determine when to use two- or three-column layout. Follow the doc to enable flexible column layout and wire app routing / navigation targets to the layout structure.

**LANGUAGE**: Documentation/Markdown

**CODE**:
```markdown
Related doc: enabling-the-flexible-column-layout-e762257.md
Actionable tasks:
- Review routing targets that map to begin/mid/end columns.
- Confirm flexible column layout support in your app template and manifest.
- Add / update routing targets and layout configuration in <your-app>/webapp/manifest.json as required.
```

**STEP**: 4 — Configuring the Application Title

**DESCRIPTION**: Configure the application title that SAP Fiori launchpad generates. Use the manifest configuration to set a localized title and verify launchpad integration.

**LANGUAGE**: JSON

**CODE**:
```json
// File: <your-app>/webapp/manifest.json
{
  "sap.app": {
    "id": "your.app.id",
    "title": "Your App Title" // Localize via i18n if needed
  }
}
```

**STEP**: 5 — Managing Variants

**DESCRIPTION**: Implement variant management for filters and content areas. Consult the doc for supported variant types and storage options, then add variant management configuration to the relevant controls.

**LANGUAGE**: Documentation/Markdown

**CODE**:
```markdown
Related doc: managing-variants-8ce658e.md
Actionable tasks:
- Identify controls that support variants (filter bar, table columns).
- Configure variant management in view XML or via annotations.
- Decide on persistence (localStorage, backend) and implement save/load handlers.
```

**STEP**: 6 — Responsiveness Options Example

**DESCRIPTION**: Apply responsiveness options—e.g., evaluate Importance annotation to decide which fields appear in toolbars or condensed UIs. Use this doc as a guide to annotate fields with Importance semantics.

**LANGUAGE**: Documentation/Markdown

**CODE**:
```markdown
Related doc: responsiveness-options-example-69efbe7.md
Actionable tasks:
- Annotate fields with com.sap.vocabularies.UI.v1.Importance (High/Medium/Low).
- Test rendering in pages with toolbars (list report table, object page table, smart chart).
- Adjust UI composition or truncate rules based on Importance values.
```

**STEP**: 7 — Value Help as a Dropdown List

**DESCRIPTION**: Render value help as a dropdown for a fixed set of values. Follow the documentation to detect fixed-value scenarios and implement the dropdown variant of value help.

**LANGUAGE**: Documentation/Markdown

**CODE**:
```markdown
Related doc: value-help-as-a-dropdown-list-2a0a630.md
Actionable tasks:
- Determine if the value help domain is fixed (static list).
- Configure the value help to render a dropdown list instead of a dialog.
- Add configuration/annotation to the relevant property or value help definition.
```

**STEP**: 8 — Using Images, Initials, and Icons

**DESCRIPTION**: Integrate images, initials, or icons for entity representations. Review the doc to choose the correct control and annotation pattern for each use case.

**LANGUAGE**: Documentation/Markdown

**CODE**:
```markdown
Related doc: using-images-initials-and-icons-5760b63.md
Actionable tasks:
- Choose control: sap.m.Avatar, sap.m.Image, or semantic icon usage.
- Provide image URL attributes in OData payload or CDS annotations.
- Handle fallback initials and ARIA attributes for accessibility.
```

**STEP**: 9 — Keyboard Shortcuts

**DESCRIPTION**: Implement or customize keyboard shortcuts for basic operations in Fiori elements apps. Follow the doc to register shortcuts and map them to actions.

**LANGUAGE**: Documentation/Markdown

**CODE**:
```markdown
Related doc: keyboard-shortcuts-0cd318c.md
Actionable tasks:
- Identify common shortcuts (search, save, navigation).
- Register shortcuts in the app startup or component initialization.
- Map shortcuts to semantic actions or controller methods.
```

**STEP**: 10 — Initial Expansion Level for Tables

**DESCRIPTION**: Set the number of expanded levels for hierarchy/analytical tables in List Reports and Analytical List Pages using the PresentationVariant initial expansion level property.

**LANGUAGE**: Documentation/Markdown

**CODE**:
```markdown
Related doc: initial-expansion-level-for-tables-in-list-reports-analytical-list-pages-bc05d35.md
Actionable tasks:
- Locate or create the PresentationVariant annotation for the table.
- Set the initialExpansionLevel/presentation variant property to the desired integer.
- Test initial expanded row levels in List Report and Analytical List Page scenarios.
```


--------------------------------

**TITLE**: Generative AI Features in SAP Fiori elements (S/4HANA Cloud 2502)

**INTRODUCTION**: Short developer-focused guide for integrating and documenting two SAP Fiori elements generative AI capabilities: AI-Assisted Easy Filter (list report) and AI-Assisted Smart Summarization (object page). Includes prerequisites, repository asset locations, and example UI5 controller integration snippets. Replace example endpoints with your back-end/service endpoints or use the built-in S/4HANA Cloud capabilities where available.

**TAGS**: fiori-elements-framework, sap-s4hana, generative-ai, ai-assisted, list-report, object-page, ui5

**STEP**: 1 - Prerequisites & references

**DESCRIPTION**: Verify entitlement and authorization for generative AI features in S/4HANA Cloud Public Edition 2502. Keep links and screenshots in your repository and document admin steps in the app README.

**LANGUAGE**: TEXT

**CODE**:
```TEXT
Prerequisites:
- SAP S/4HANA Cloud Public Edition 2502
- Additional entitlement and authorization may be required to use generative AI features.
- Admins: verify entitlement/access in the SAP Cloud cockpit and assign required roles.

Reference docs and screenshots included in repository:
- Help (AI-Assisted Easy Filter):
  https://help.sap.com/docs/SAP_S4HANA_CLOUD/4fc8d03390c342da8a60f8ee387bca1a/804ed39a7dd34720912483ddfb847087.html?locale=en-US&state=PRODUCTION&version=2502.500

- Help (AI-Assisted Smart Summarization):
  https://help.sap.com/docs/SAP_S4HANA_CLOUD/4fc8d03390c342da8a60f8ee387bca1a/6c1bc21f01c840cba336404fb249cf95.html?locale=en-US&state=PRODUCTION&version=2502.500

Repository image assets (preserve these paths):
- images/AI-Assisted_Easy_Filter_6254f19.png
- images/AI-Assisted_Smart_Summarization_e3ea9c8.png
```

**STEP**: 2 - Repository layout for documentation & assets

**DESCRIPTION**: Keep screenshots and documentation next to your app source for CI and content retrieval by RAG agents.

**LANGUAGE**: TEXT

**CODE**:
```TEXT
Recommended repository structure:
- /webapp/
  - manifest.json
  - Component.js
  - controller/
    - ObjectPage.controller.js
    - ListReport.controller.js
  - view/
    - ObjectPage.view.xml
    - ListReport.view.xml
  - i18n/
  - images/
    - AI-Assisted_Easy_Filter_6254f19.png
    - AI-Assisted_Smart_Summarization_e3ea9c8.png
- README_AI_FEATURES.md  <-- Document entitlements, links, how-to and replacement endpoints
```

**STEP**: 3 - Integration pattern: AI-Assisted Easy Filter (List Report)

**DESCRIPTION**: Example UI5 controller extension pattern: take a natural-language query from the user, call a generative AI service to produce OData filter expressions (or a filter DSL), apply the resulting filter to the SmartFilterBar, and trigger the list refresh. Replace the example endpoint (/api/generative-ai/filter) with your back-end or platform-provided endpoint.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// controller/ListReport.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/ui/model/Filter",
  "sap/ui/model/FilterOperator"
], function (Controller, Filter, FilterOperator) {
  "use strict";

  return Controller.extend("my.app.controller.ListReport", {
    onInit: function () {
      // initialization if needed
    },

    onOpenAiFilterDialog: function () {
      // open a simple prompt/dialog to get natural language input
      var sNlQuery = prompt("Enter filter in natural language (e.g. 'open sales orders in Germany'):");
      if (!sNlQuery) {
        return;
      }
      this._applyNaturalLanguageFilter(sNlQuery);
    },

    _applyNaturalLanguageFilter: async function (sNlQuery) {
      try {
        // Example POST to back-end AI service that returns structured filters
        // Response example: { filters: [ { path: "Country", operator: "EQ", value: "DE" }, ... ] }
        const response = await fetch("/api/generative-ai/filter", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ query: sNlQuery, entitySet: "SalesOrders" })
        });

        if (!response.ok) {
          throw new Error("AI service failed: " + response.statusText);
        }

        const result = await response.json();

        // Convert returned filters to UI5 Filters and apply to SmartFilterBar
        const aFilters = (result.filters || []).map(f => {
          // Map operator names from service to FilterOperator if needed
          let op = FilterOperator.EQ;
          if (f.operator === "CONTAINS") { op = FilterOperator.Contains; }
          if (f.operator === "GT") { op = FilterOperator.GT; }
          // extend mapping as required

          return new Filter({ path: f.path, operator: op, value1: f.value });
        });

        // Get SmartFilterBar by id in view (ensure correct id or use core lookup)
        const oSmartFilterBar = this.getView().byId("smartFilterBar"); // adjust id to your view
        if (oSmartFilterBar && typeof oSmartFilterBar.setFilterData === "function") {
          // Option A: set filter data object if service returns name:value mapping
          // oSmartFilterBar.setFilterData({ Country: "DE", SalesOrganization: "1000" });

          // Option B: programmatically apply and trigger search (apply as search filters)
          // Attach custom filter(s) to the table binding directly
          const oTable = this.getView().byId("listReportTable"); // adjust id
          const oBinding = oTable.getBinding("items") || oTable.getBinding("rows");
          if (oBinding) {
            oBinding.filter(aFilters, "Application");
          }
          // Or trigger SmartFilterBar search if you used setFilterData
          if (oSmartFilterBar.search) { oSmartFilterBar.search(); }
        } else {
          // fallback: apply filter to table binding
          const oTable = this.getView().byId("listReportTable");
          if (oTable) {
            const oBinding = oTable.getBinding("items") || oTable.getBinding("rows");
            if (oBinding) {
              oBinding.filter(aFilters, "Application");
            }
          }
        }
      } catch (err) {
        // handle error - show message to user
        console.error("NL filter failed", err);
        alert("Failed to apply AI-assisted filter: " + err.message);
      }
    }
  });
});
```

**STEP**: 4 - Integration pattern: AI-Assisted Smart Summarization (Object Page)

**DESCRIPTION**: Example UI5 controller extension pattern: send object context fields to a summarization service, receive a textual summary, display in a dialog, and provide a copy-to-clipboard action. Replace /api/generative-ai/summarize with your back-end/platform endpoint or enable built-in feature.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// controller/ObjectPage.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/m/Dialog",
  "sap/m/Text",
  "sap/m/Button",
  "sap/m/Toolbar",
  "sap/m/ToolbarSpacer",
  "sap/m/MessageToast"
], function (Controller, Dialog, Text, Button, Toolbar, ToolbarSpacer, MessageToast) {
  "use strict";

  return Controller.extend("my.app.controller.ObjectPage", {
    onInit: function () {
      // initialization
    },

    onGenerateSummary: async function () {
      try {
        // Extract current entity context data from the view/model
        const oContext = this.getView().getBindingContext();
        if (!oContext) {
          MessageToast.show("No entity context available.");
          return;
        }

        // Get entity payload - you may pick specific properties
        const oData = oContext.getObject();
        // Example: pass entire entity or a reduced payload
        const payload = { entitySet: "SalesOrder", entity: oData };

        const response = await fetch("/api/generative-ai/summarize", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(payload)
        });

        if (!response.ok) {
          throw new Error("Summarization service failed: " + response.statusText);
        }

        const result = await response.json();
        const sSummaryText = result.summary || "No summary returned.";

        // Show summary in dialog with copy option
        const oText = new Text({ text: sSummaryText });
        const oDialog = new Dialog({
          title: "AI-Assisted Summary",
          content: [oText],
          beginButton: new Button({
            text: "Copy",
            press: async function () {
              try {
                await navigator.clipboard.writeText(sSummaryText);
                MessageToast.show("Summary copied to clipboard");
              } catch (err) {
                MessageToast.show("Copy failed");
              }
            }
          }),
          endButton: new Button({
            text: "Close",
            press: function () {
              oDialog.close();
              oDialog.destroy();
            }
          })
        });

        oDialog.open();
      } catch (err) {
        console.error("Summarization failed", err);
        MessageToast.show("Failed to generate summary: " + err.message);
      }
    }
  });
});
```

**STEP**: 5 - Document & security notes

**DESCRIPTION**: Document required entitlements, data privacy considerations, and replace sample endpoints with actual back-end endpoints or platform features. Add short README entry so RAG agents or CI pipelines know how to use the examples.

**LANGUAGE**: TEXT

**CODE**:
```TEXT
README_AI_FEATURES.md (sample content):

Generative AI features used:
- AI-Assisted Easy Filter (List Report)
- AI-Assisted Smart Summarization (Object Page)

S/4HANA Cloud release: Public Edition 2502
Notes:
- Additional entitlement and authorization may be required. Contact tenant admin.
- Replace example endpoints (/api/generative-ai/filter, /api/generative-ai/summarize) with:
  * Platform-provided endpoints (if available on your tenant) OR
  * A custom back-end that integrates with your chosen generative AI provider
- Implement server-side controls: rate limiting, logging, PII handling, consent and audit.
- Reference help pages:
  - Easy Filter: https://help.sap.com/docs/SAP_S4HANA_CLOUD/.../804ed39a7dd34720912483ddfb847087.html
  - Smart Summarization: https://help.sap.com/docs/SAP_S4HANA_CLOUD/.../6c1bc21f01c840cba336404fb249cf95.html
```

--------------------------------

**TITLE**: Enable Generic Create/Delete Action Buttons in Object Page Tables (OData V2 & V4)

**INTRODUCTION**: This document shows how to control the display and enabled state of the Create and Delete toolbar buttons for tables on the Fiori Elements Object Page using annotations. Includes examples for OData V2 (service metadata/annotations) and OData V4 (XML annotations and CAP CDS). Use these annotations in your service metadata or annotation files to enable/disable actions based on back-end Boolean properties.

**TAGS**: fiori-elements-framework, annotations, odata-v2, odata-v4, cds, creatable-path, deletable-path, object-page, table-toolbar

**STEP**: Display Create Button (behavior & rules)

**DESCRIPTION**: The Create button appears in the table toolbar only when the Object Page is in Edit mode. Use a creatable-path to point to a Boolean property on the root entity. If the property value is true the Create button is shown; if false it is hidden. The creatable-path must reference a property on the root entity in the back end. (Image reference: images/CreatablePath_ObPTable_1d6a9b1.png)

**LANGUAGE**: Notes

**CODE**:
```text
- Create button appears only when the Object Page is in Edit mode.
- Define creatable-path to a Boolean root-entity property:
    * true  -> Create button displayed
    * false -> Create button hidden
- creatable-path must point to a property on the root entity.
- Image reference (optional): images/CreatablePath_ObPTable_1d6a9b1.png
```

**STEP**: Enable Create Button — OData V2 (NavigationProperty sap:creatable-path)

**DESCRIPTION**: Add sap:creatable-path on the NavigationProperty element in your V2 service metadata (or annotation XML) to point to the root-entity Boolean property that controls create permission for that navigation property.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: in service metadata or annotation fragment for OData V2 -->
<NavigationProperty Name="to_ProductText" sap:creatable-path="CanCreateProductText" .../>
```

**STEP**: Enable Create Button — OData V4 (InsertRestrictions / NonInsertableNavigationProperties)

**DESCRIPTION**: For OData V4, add an Org.OData.Capabilities.V1.InsertRestrictions annotation on the root entity. Use NonInsertableNavigationProperties with an <If> that checks the Boolean property (e.g., CanCreateProductText). The example ensures to_ProductText is non-insertable when CanCreateProductText is false (via Not).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: Annotations file for OData V4 -->
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_Product">
    <Annotation Term="Org.OData.Capabilities.V1.InsertRestrictions">
        <Record>
            <PropertyValue Property="NonInsertableNavigationProperties">
                <Collection>
                    <If>
                        <!-- If NOT CanCreateProductText then mark navigation property as NonInsertable -->
                        <Not>
                            <Path>CanCreateProductText</Path>
                        </Not>
                        <NavigationPropertyPath>to_ProductText</NavigationPropertyPath>
                    </If>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: Enable/Disable Delete Button — Behavior & Rules

**DESCRIPTION**: Use deletable-path (V2) or DeleteRestrictions/Deletable (V4) to control the Delete toolbar button per entity set. The deletable-path or Deletable path must point to a Boolean property on the entity. The Delete button is enabled if the selected item's property is true. For multiple selection, the button is enabled if at least one selected item is deletable.

**LANGUAGE**: Notes

**CODE**:
```text
- Define deletable-path (V2) or Deletable/Path (V4) to a Boolean entity property:
    * true  -> Delete button enabled for that item
    * false -> Delete button disabled for that item
- Multiple selection: button enabled if >= 1 selected item has property = true
```

**STEP**: Enable/Disable Delete Button — OData V2 (EntitySet sap:deletable-path)

**DESCRIPTION**: Add sap:deletable-path to the EntitySet element in the V2 service metadata to point to the Boolean property (e.g., Delete_mc) that controls deletability.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: in V2 service metadata (EntityContainer/EntitySet) -->
<EntitySet Name="STTA_C_MP_ProductText"
           EntityType="STTA_PROD_MAN.STTA_C_MP_ProductTextType"
           sap:deletable-path="Delete_mc"
           sap:content-version="1"/>
```

**STEP**: Enable/Disable Delete Button — OData V4 (Annotation XML)

**DESCRIPTION**: For OData V4, add the Org.OData.Capabilities.V1.DeleteRestrictions annotation targeting the entity set and set the Deletable property to the Boolean path (e.g., Delete_mc).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: Annotations file for OData V4 -->
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductText">
   <Annotation Term="Org.OData.Capabilities.V1.DeleteRestrictions">
        <Record>
            <PropertyValue Property="Deletable" Path="Delete_mc"/>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: Enable/Disable Delete Button — OData V4 (CAP CDS Annotation)

**DESCRIPTION**: For CAP-based services, use a CDS annotate statement to set Capabilities.DeleteRestrictions.Deletable to the Boolean field.

**LANGUAGE**: CDS

**CODE**:
```sql
/* Example: CAP CDS file or annotation file */
annotate STTA_PROD_MAN.STTA_C_MP_ProductText with @(
  Capabilities.DeleteRestrictions : {
    Deletable : Delete_mc
  }
);
```

**STEP**: Related Files and Links

**DESCRIPTION**: Reference to related sample and extension documents.

**LANGUAGE**: Notes

**CODE**:
```text
- Related example: Example: Adding Custom Filter Fields in Table Toolbar
  File: example-adding-custom-filter-fields-in-table-toolbar-e34f78f.md
- See also: Adding Actions to Tables (adding-actions-to-tables-b623e0b.md)
```
--------------------------------

**TITLE**: Grouping Fields with UI.FieldGroup and UI.ConnectedFields (Fiori Elements)

**INTRODUCTION**: This guide shows how to group related fields in SAP Fiori Elements (OData V2/V4) using UI.FieldGroup and UI.ConnectedFields annotations. It provides actionable annotation examples for XML service metadata, ABAP CDS, and CAP CDS, plus manifest.json settings for table display and text area label merging. Use these snippets to implement grouped fields in object pages, forms, and tables, and to render semantically connected fields side-by-side or as templates.

**TAGS**: UI.FieldGroup, UI.ConnectedFields, Fiori Elements, annotations, OData V2, OData V4, ABAP CDS, CAP CDS, manifest.json, LineItem

STEP: 1 — Define a UI.FieldGroup (Object Page / Form)
DESCRIPTION: Create a FieldGroup that collects multiple DataFields for a form-like grouped display. Use Qualifier to reference the group from a ReferenceFacet (object page) or LineItem (table). If all grouped fields are hidden, the container is hidden automatically.
LANGUAGE: XML
CODE:
```xml
<!-- XML OData Annotation: FieldGroup qualifier "Dimensions" -->
<Annotation Term="UI.FieldGroup" Qualifier="Dimensions">
  <Record>
    <PropertyValue Property="Label" String="Dimensions"/>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="BaseUnit"/></Record>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Height"/></Record>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Width"/></Record>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Depth"/></Record>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Weight"/></Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 2 — Define the same FieldGroup in ABAP CDS
DESCRIPTION: Annotate individual properties with @UI.fieldGroup qualifiers and positions so the UI groups them in the specified order.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [
  { type: #STANDARD, position: 1, qualifier: 'Dimensions', groupLabel: 'Dimensions' }
]
BaseUnit;

@UI.fieldGroup: [
  { type: #STANDARD, position: 2, qualifier: 'Dimensions' }
]
Height;

@UI.fieldGroup: [
  { type: #STANDARD, position: 3, qualifier: 'Dimensions' }
]
Width;

@UI.fieldGroup: [
  { type: #STANDARD, position: 4, qualifier: 'Dimensions' }
]
Depth;

@UI.fieldGroup: [
  { type: #STANDARD, position: 5, qualifier: 'Dimensions' }
]
Weight;
```

STEP: 3 — Define the same FieldGroup in CAP CDS
DESCRIPTION: Use UI.FieldGroup with Data entries to define the group in CAP (CSN-like) CDS.
LANGUAGE: CAP CDS
CODE:
```cds
UI.FieldGroup #Dimensions : {
    $Type : 'UI.FieldGroupType',
    Label : 'Dimensions',
    Data : [
        { $Type : 'UI.DataField', Value : BaseUnit },
        { $Type : 'UI.DataField', Value : Height },
        { $Type : 'UI.DataField', Value : Width },
        { $Type : 'UI.DataField', Value : Depth },
        { $Type : 'UI.DataField', Value : Weight }
    ]
}
```

STEP: 4 — Reference FieldGroup from an Object Page (ReferenceFacet)
DESCRIPTION: Add a ReferenceFacet that targets the FieldGroup defined with qualifier. This renders the group in the object page form section.
LANGUAGE: XML
CODE:
```xml
<!-- XML OData Annotation: ReferenceFacet pointing to UI.FieldGroup#Dimensions -->
<Annotation Term="UI.Facets">
  <Collection>
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="Dimensions" />
      <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#Dimensions"/>
    </Record>
  </Collection>
</Annotation>
```

STEP: 5 — Reference FieldGroup from ABAP CDS Facet
DESCRIPTION: ABAP CDS facet that references the field group by qualifier to create a reference facet in the object page.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Facet: [
  {
    label: 'Dimensions',
    targetQualifier: 'Dimensions',
    type: #FIELDGROUP_REFERENCE,
    purpose: #STANDARD
  }
]
```

STEP: 6 — Link FieldGroup in a Table LineItem (DataFieldForAnnotation)
DESCRIPTION: To show grouped fields within a table cell, add a UI.DataFieldForAnnotation to the LineItem with Target pointing to the FieldGroup qualifier. Avoid using grid tables (row height truncation). If multiple DataFieldForAction buttons exist in the FieldGroup, do not set a column header label to hide it.
LANGUAGE: XML
CODE:
```xml
<!-- XML OData Annotation: LineItem with DataFieldForAnnotation referencing FieldGroup#FieldGroup1 -->
<Annotation Term="UI.LineItem">
  <Collection>
    ...
    <Record Type="UI.DataFieldForAnnotation">
      <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#FieldGroup1" />
      <PropertyValue Property="Label" String="Type Information"/>
    </Record>
    ...
  </Collection>
</Annotation>
```

STEP: 7 — Define a FieldGroup for table usage (XML)
DESCRIPTION: Example FieldGroup containing a DataField and a DataFieldForAction for table line item rendering.
LANGUAGE: XML
CODE:
```xml
<!-- XML OData Annotation: FieldGroup qualifier "FieldGroup1" containing a data field and action -->
<Annotation Term="UI.FieldGroup" Qualifier="FieldGroup1">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="ContractType"/>
        </Record>
        <Record Type="UI.DataFieldForAction">
          <PropertyValue Property="Label" String="Dummy Button"/>
          <PropertyValue Property="Action" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 8 — Define FieldGroup for table in ABAP CDS
DESCRIPTION: ABAP CDS annotations for a field and an action inside the same field group qualifier.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [{ type: #STANDARD, position: 1, qualifier: 'FieldGroup1' }]
ContractType;

@UI.fieldGroup: [
  {
    label: 'Dummy Button',
    dataAction: 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2',
    type: #FOR_ACTION,
    position: 2,
    qualifier: 'FieldGroup1'
  }
]
contractName;
```

STEP: 9 — Define FieldGroup for table in CAP CDS
DESCRIPTION: CAP CDS FieldGroup equivalent with DataField and DataFieldForAction entries.
LANGUAGE: CAP CDS
CODE:
```cds
UI.FieldGroup #FieldGroup1 : {
    Data : [
        { $Type : 'UI.DataField', Value : ContractType },
        {
          $Type : 'UI.DataFieldForAction',
          Label : 'Dummy Button',
          Action : 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2'
        }
    ]
}
```

STEP: 10 — Use ConnectedFields to render semantically connected fields side-by-side (OData V2 XML)
DESCRIPTION: Define ConnectedFields with Data entries (a dictionary of data fields), a Template for display, and attach the ConnectedFields via a FieldGroup DataFieldForAnnotation in a form. ConnectedFields are only valid in form sections, not headers or tables.
LANGUAGE: XML
CODE:
```xml
<!-- OData V2 XML: ConnectedFields qualifier "ConnectedDateTime" -->
<Annotation Term="com.sap.vocabularies.UI.v1.ConnectedFields" Qualifier="ConnectedDateTime">
  <Record>
    <PropertyValue Property="Data">
      <Record>
        <PropertyValue Property="SalesOrderDate">
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Value" Path="SalesOrderDate"/>
          </Record>
        </PropertyValue>
        <PropertyValue Property="SalesOrderTime">
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Value" Path="TrialTOD"/>
          </Record>
        </PropertyValue>
      </Record>
    </PropertyValue>
    <PropertyValue Property="Label" String="Connected DateTime"/>
    <PropertyValue Property="Template" String="{SalesOrderDate} / {SalesOrderTime}"/>
  </Record>
</Annotation>

<!-- FieldGroup referencing the ConnectedFields -->
<Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup" Qualifier="OrderData">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
          <PropertyValue Property="Target" AnnotationPath="@UI.ConnectedFields#ConnectedDateTime"/>
          <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
        </Record>
        <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
          <PropertyValue Property="Target" AnnotationPath="@UI.ConnectedFields#ConnectedData"/>
          <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 11 — ConnectedFields examples for OData V4 (XML)
DESCRIPTION: OData V4 XML uses UI.ConnectedFields and UI.FieldGroupType. Provide Data as Core.Dictionary entries and Template for formatting.
LANGUAGE: XML
CODE:
```xml
<!-- OData V4 XML: ConnectedFields -> ConnectedDateTime -->
<Annotation Term="UI.ConnectedFields" Qualifier="ConnectedDateTime">
  <Record Type="UI.ConnectedFieldsType">
    <PropertyValue Property="Data">
      <Record Type="Core.Dictionary">
        <PropertyValue Property="SalesOrderDate">
          <Record Type="UI.DataField">
            <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            <PropertyValue Property="Value" Path="SalesOrderDate"/>
          </Record>
        </PropertyValue>
        <PropertyValue Property="SalesOrderTime">
          <Record Type="UI.DataField">
            <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            <PropertyValue Property="Value" Path="TrialTOD"/>
          </Record>
        </PropertyValue>
      </Record>
    </PropertyValue>
    <PropertyValue Property="Label" String="Connected DateTime"/>
    <PropertyValue Property="Template" String="{SalesOrderDate} / {SalesOrderTime}"/>
  </Record>
</Annotation>

<!-- FieldGroup referencing connected fields -->
<Annotation Term="UI.FieldGroup" Qualifier="OrderData">
  <Record Type="UI.FieldGroupType">
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataFieldForAnnotation">
          <PropertyValue Property="Target" AnnotationPath="@UI.ConnectedFields#ConnectedDateTime"/>
        </Record>
        <Record Type="UI.DataFieldForAnnotation">
          <PropertyValue Property="Target" AnnotationPath="@UI.ConnectedFields#ConnectedData"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 12 — ConnectedFields examples in ABAP CDS and CAP CDS
DESCRIPTION: ABAP CDS and CAP CDS snippets to define ConnectedFields and embed them into a FieldGroup. ConnectedFields cannot be used in header sections or tables; only in form sections.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.connectedFields: [
  {
    importance: #HIGH,
    name: 'SalesOrderDate',
    qualifier: 'ConnectedDateTime',
    template: '{SalesOrderDate} / {SalesOrderTime}',
    groupLabel: 'Connected DateTime'
  }
]
SALESORDERDATE;

@UI.connectedFields: [
  {
    importance: #HIGH,
    name: 'SalesOrderTime',
    qualifier: 'ConnectedDateTime'
  }
]
TRIALTOD;
```

LANGUAGE: CAP CDS
CODE:
```cds
ConnectedFields #ConnectedDateTime : {
    Label : 'Connected DateTime',
    Template: '{SalesOrderDate} / {SalesOrderTime}',
    Data: {
      SalesOrderDate: { $Type: 'UI.DataField', Value: SalesOrderDate, ![@UI.Importance]: #High },
      SalesOrderTime: { $Type: 'UI.DataField', Value: TrialTOD, ![@UI.Importance]: #High }
    }
};

ConnectedFields #ConnectedData : {
    Label : 'Connected Data',
    Template: '{ShippingCondition} - {PurchaseOrderByCustomerr}',
    Data: {
      ShippingCondition: { $Type: 'UI.DataField', Value: ShippingCondition, ![@UI.Importance]: #High },
      PurchaseOrderByCustomerr: { $Type: 'UI.DataField', Value: PurchaseOrderByCustomer, ![@UI.Importance]: #High }
    }
};

FieldGroup #OrderData : {
  Data : [
    { $Type : 'UI.DataFieldForAnnotation', Target : '@UI.ConnectedFields#ConnectedDateTime' },
    { $Type : 'UI.DataFieldForAnnotation', Target : '@UI.ConnectedFields#ConnectedData' }
  ]
}
```

STEP: 13 — Enable labels inside FieldGroup table column (OData V4 manifest.json)
DESCRIPTION: Show field labels inside a table column that renders a FieldGroup by setting "showDataFieldsLabel": true in manifest controlConfiguration. Use the column key format DataFieldForAnnotation::FieldGroup::<qualifier>.
LANGUAGE: JSON
CODE:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem": {
      "columns": {
        "DataFieldForAnnotation::FieldGroup::myFieldGroup": {
          "showDataFieldsLabel": true
        }
      }
    }
  }
}
```

STEP: 14 — Merge TextArea label with section title (manifest.json)
DESCRIPTION: If a FieldGroup contains only one MultiLineText (TextArea), hide the TextArea label and display only the section/subsection title by enabling useSingleTextAreaFieldAsNotes at the section level in manifest.json. Mandatory text areas always show label in edit mode.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "ReferenceFacet1": {
                      "useSingleTextAreaFieldAsNotes": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 15 — Tips, Restrictions and Implementation Notes
DESCRIPTION: Action-oriented notes for implementers to avoid common pitfalls and respect constraints.
LANGUAGE: JSON
CODE:
```json
{
  "notes": [
    "Do not use grid tables for FieldGroup in table cells: row height truncates UI elements. Use responsive or analytical tables.",
    "FieldGroup is not supported in grid tables.",
    "If a LineItem contains multiple DataFieldForAction entries inside a FieldGroup, omit the LineItem column Label to hide the column header.",
    "ConnectedFields can only be used in form sections (not in header sections) and cannot be rendered inside tables.",
    "Navigation (links) inside ConnectedFields: use DataFieldWithURL, DataFieldWithIntentBasedNavigation, SemanticObject on data fields, or DataFieldWithNavigationPath. Define navigation on the individual data fields making up the ConnectedFields.",
    "If no HeaderFacet is present and HeaderInfo has no images, the expand/collapse and pin buttons in the object page header are hidden.",
    "If a subsection contains only one group and titles match, the group title is hidden."
  ]
}
```
--------------------------------

**TITLE**: Grouping Fields with UI.FieldGroup and UI.ConnectedFields (Fiori Elements)

**INTRODUCTION**: Practical, code-focused guide for grouping related fields in SAP Fiori Elements using UI.FieldGroup (form and table usage) and UI.ConnectedFields (side-by-side semantic display). Includes XML, ABAP CDS, CAP CDS, and manifest.json examples for OData V2 and V4 scenarios. Use these snippets to declare annotations that group fields in object pages, facets, line items, tables, and configure table/manifest behavior.

**TAGS**: fiori-elements, annotations, UI.FieldGroup, UI.ConnectedFields, LineItem, Facets, manifest.json, ODataV2, ODataV4, ABAP-CDS, CAP-CDS

STEP: 1 - Define a UI.FieldGroup (Object Page / Form)
DESCRIPTION: Create a FieldGroup qualifier and list DataField entries (BaseUnit, Height, Width, Depth, Weight). Use this annotation for object page forms (UI.ReferenceFacet targets this FieldGroup).
LANGUAGE: XML
CODE:
```xml
<!-- UI.FieldGroup definition (XML) -->
<Annotation Term="UI.FieldGroup" Qualifier="Dimensions">
  <Record>
    <PropertyValue Property="Label" String="Dimensions"/>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="BaseUnit"/></Record>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Height"/></Record>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Width"/></Record>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Depth"/></Record>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Weight"/></Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 2 - Define the same UI.FieldGroup in ABAP CDS
DESCRIPTION: ABAP CDS field-group qualifiers per-property. Use qualifier 'Dimensions' and position ordering.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [{
  type: #STANDARD, position: 1, qualifier: 'Dimensions', groupLabel: 'Dimensions'
}]
BaseUnit;

@UI.fieldGroup: [{ type: #STANDARD, position: 2, qualifier: 'Dimensions' }]
Height;

@UI.fieldGroup: [{ type: #STANDARD, position: 3, qualifier: 'Dimensions' }]
Width;

@UI.fieldGroup: [{ type: #STANDARD, position: 4, qualifier: 'Dimensions' }]
Depth;

@UI.fieldGroup: [{ type: #STANDARD, position: 5, qualifier: 'Dimensions' }]
Weight;
```

STEP: 3 - Define the same UI.FieldGroup in CAP CDS
DESCRIPTION: CAP CDS FieldGroup qualifier definition with Data array pointing to fields.
LANGUAGE: CDS
CODE:
```cds
// CAP CDS FieldGroup definition
UI.FieldGroup #Dimensions : {
  $Type : 'UI.FieldGroupType',
  Label : 'Dimensions',
  Data : [
    { $Type : 'UI.DataField', Value : BaseUnit },
    { $Type : 'UI.DataField', Value : Height },
    { $Type : 'UI.DataField', Value : Width },
    { $Type : 'UI.DataField', Value : Depth },
    { $Type : 'UI.DataField', Value : Weight }
  ]
}
```

STEP: 4 - Reference FieldGroup from UI.Facets (Object Page)
DESCRIPTION: Add a ReferenceFacet to the object page facets that targets the FieldGroup qualifier. This wires the FieldGroup into a form subsection on the page.
LANGUAGE: XML
CODE:
```xml
<!-- Reference the FieldGroup from UI.Facets -->
<Annotation Term="UI.Facets">
  <Collection>
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="Dimensions" />
      <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#Dimensions"/>
    </Record>
  </Collection>
</Annotation>
```

STEP: 5 - Reference FieldGroup in ABAP CDS Facets
DESCRIPTION: ABAP CDS facet entry linking to the FieldGroup qualifier for object page layout.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Facet: [{
  label: 'Dimensions',
  targetQualifier: 'Dimensions',
  type: #FIELDGROUP_REFERENCE,
  purpose: #STANDARD
}]
```

STEP: 6 - Use FieldGroup inside a Table LineItem (Link FieldGroup via DataFieldForAnnotation)
DESCRIPTION: In lists/tables, include a DataFieldForAnnotation in UI.LineItem and point its Target to the FieldGroup qualifier. Avoid grid table (row-height truncation) and do not supply a Label if you must hide the column header when using multiple action buttons.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.LineItem">
  <Collection>
    <!-- other line items -->
    <Record Type="UI.DataFieldForAnnotation">
      <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#FieldGroup1" />
      <PropertyValue Property="Label" String="Type Information"/>
    </Record>
    <!-- other line items -->
  </Collection>
</Annotation>
```

STEP: 7 - LineItem mapping in ABAP CDS for FieldGroup
DESCRIPTION: ABAP CDS snippet that places a FieldGroup reference inside the line item (use type #AS_FIELDGROUP and valueQualifier).
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [
  {
    label: 'Type Information',
    type: #AS_FIELDGROUP,
    valueQualifier: 'FieldGroup1'
  }
]
producttype;
```

STEP: 8 - LineItem mapping in CAP CDS for FieldGroup
DESCRIPTION: CAP CDS DataFieldForAnnotation entry in UI.LineItem targeting the FieldGroup qualifier.
LANGUAGE: CDS
CODE:
```cds
UI.LineItem : [
  {
    $Type : 'UI.DataFieldForAnnotation',
    Target : '@UI.FieldGroup#FieldGroup1',
    Label : 'Type Information'
  }
]
```

STEP: 9 - FieldGroup with DataField and DataFieldForAction (Table cell content)
DESCRIPTION: Define a FieldGroup qualifier (FieldGroup1) that contains a DataField and a DataFieldForAction (dummy button). Use this for table cell stacked contents.
LANGUAGE: XML
CODE:
```xml
<!-- FieldGroup that contains a DataField and a DataFieldForAction -->
<Annotation Term="UI.FieldGroup" Qualifier="FieldGroup1">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="ContractType"/>
        </Record>
        <Record Type="UI.DataFieldForAction">
          <PropertyValue Property="Label" String="Dummy Button"/>
          <PropertyValue Property="Action" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 10 - FieldGroup with Action in ABAP CDS
DESCRIPTION: ABAP CDS definitions linking fields and an action into a field group qualifier 'FieldGroup1'.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [{ type: #STANDARD, position: 1, qualifier: 'FieldGroup1' }]
ContractType;

@UI.fieldGroup: [
  {
    label: 'Dummy Button',
    dataAction: 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2',
    type: #FOR_ACTION,
    position: 2,
    qualifier: 'FieldGroup1'
  }
]
contractName;
```

STEP: 11 - FieldGroup with Action in CAP CDS
DESCRIPTION: CAP CDS FieldGroup configuration with DataField and DataFieldForAction.
LANGUAGE: CDS
CODE:
```cds
UI.FieldGroup #FieldGroup1 : {
  Data : [
    { $Type : 'UI.DataField', Value : ContractType },
    { $Type : 'UI.DataFieldForAction',
      Label : 'Dummy Button',
      Action : 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2'
    }
  ]
}
```

STEP: 12 - Define Semantically Connected Fields (ConnectedFields) — XML (OData V4)
DESCRIPTION: Use UI.ConnectedFields to display related fields side-by-side and provide a Template for combined display. This example binds SalesOrderDate and SalesOrderTime into a ConnectedDateTime qualifier; then FieldGroup references those ConnectedFields via DataFieldForAnnotation.
LANGUAGE: XML
CODE:
```xml
<!-- ConnectedFields definitions (OData V4 / UI namespace) -->
<Annotation Term="UI.ConnectedFields" Qualifier="ConnectedDateTime">
  <Record Type="UI.ConnectedFieldsType">
    <PropertyValue Property="Data">
      <Record Type="Core.Dictionary">
        <PropertyValue Property="SalesOrderDate">
          <Record Type="UI.DataField">
            <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            <PropertyValue Property="Value" Path="SalesOrderDate"/>
          </Record>
        </PropertyValue>
        <PropertyValue Property="SalesOrderTime">
          <Record Type="UI.DataField">
            <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            <PropertyValue Property="Value" Path="TrialTOD"/>
          </Record>
        </PropertyValue>
      </Record>
    </PropertyValue>
    <PropertyValue Property="Label" String="Connected DateTime"/>
    <PropertyValue Property="Template" String="{SalesOrderDate} / {SalesOrderTime}"/>
  </Record>
</Annotation>

<!-- FieldGroup referencing ConnectedFields -->
<Annotation Term="UI.FieldGroup" Qualifier="OrderData">
  <Record Type="UI.FieldGroupType">
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataFieldForAnnotation">
          <PropertyValue Property="Target" AnnotationPath="@UI.ConnectedFields#ConnectedDateTime"/>
        </Record>
        <Record Type="UI.DataFieldForAnnotation">
          <PropertyValue Property="Target" AnnotationPath="@UI.ConnectedFields#ConnectedData"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 13 - ConnectedFields in ABAP CDS
DESCRIPTION: ABAP CDS connected fields definitions: define names, qualifier, template and groupLabel for SalesOrderDate/SalesOrderTime.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.connectedFields: [{
  importance: #HIGH,
  name: 'SalesOrderDate',
  qualifier: 'ConnectedDateTime',
  template: '{SalesOrderDate} / {SalesOrderTime}',
  groupLabel: 'Connected DateTime'
}]
SALESORDERDATE;

@UI.connectedFields: [{
  importance: #HIGH,
  name: 'SalesOrderTime',
  qualifier: 'ConnectedDateTime'
}]
TRIALTOD;
```

STEP: 14 - ConnectedFields in CAP CDS
DESCRIPTION: CAP CDS ConnectedFields examples (ConnectedDateTime and ConnectedData) including Template and Data dictionary entries.
LANGUAGE: CDS
CODE:
```cds
ConnectedFields #ConnectedDateTime : {
  Label    : 'Connected DateTime',
  Template : '{SalesOrderDate} / {SalesOrderTime}',
  Data : {
    SalesOrderDate : { $Type: 'UI.DataField', Value: SalesOrderDate, ![@UI.Importance] : #High },
    SalesOrderTime : { $Type: 'UI.DataField', Value: TrialTOD,         ![@UI.Importance] : #High }
  }
}

ConnectedFields #ConnectedData : {
  Label    : 'Connected Data',
  Template : '{ShippingCondition} - {PurchaseOrderByCustomerr}',
  Data : {
    ShippingCondition : { $Type: 'UI.DataField', Value: ShippingCondition,             ![@UI.Importance] : #High },
    PurchaseOrderByCustomerr : { $Type: 'UI.DataField', Value: PurchaseOrderByCustomer, ![@UI.Importance] : #High }
  }
}

FieldGroup #OrderData : {
  Data : [
    { $Type : 'UI.DataFieldForAnnotation', Target : '@UI.ConnectedFields#ConnectedDateTime' },
    { $Type : 'UI.DataFieldForAnnotation', Target : '@UI.ConnectedFields#ConnectedData' }
  ]
}
```

STEP: 15 - OData V2 ConnectedFields example (XML)
DESCRIPTION: V2 vocabulary uses com.sap.vocabularies.UI.v1.ConnectedFields with Template and Data entries. Useful for legacy V2 services.
LANGUAGE: XML
CODE:
```xml
<!-- V2-style ConnectedFields -->
<Annotation Term="com.sap.vocabularies.UI.v1.ConnectedFields" Qualifier="ConnectedDateTime">
  <Record>
    <PropertyValue Property="Data">
      <Record>
        <PropertyValue Property="SalesOrderDate">
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Value" Path="SalesOrderDate"/>
          </Record>
        </PropertyValue>
        <PropertyValue Property="SalesOrderTime">
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Value" Path="TrialTOD"/>
          </Record>
        </PropertyValue>
      </Record>
    </PropertyValue>
    <PropertyValue Property="Label" String="Connected DateTime"/>
    <PropertyValue Property="Template" String="{SalesOrderDate} / {SalesOrderTime}"/>
  </Record>
</Annotation>
```

STEP: 16 - Enable field labels inside FieldGroup column (OData V4 / manifest)
DESCRIPTION: To show individual field labels inside a table column that renders a FieldGroup, set controlConfiguration key for the LineItem column to showDataFieldsLabel: true. Replace myFieldGroup with your FieldGroup key (DataFieldForAnnotation::FieldGroup::myFieldGroup).
LANGUAGE: JSON
CODE:
```json
// manifest.json snippet (controlConfiguration for LineItem column)
"controlConfiguration": {
  "@com.sap.vocabularies.UI.v1.LineItem": {
    "columns": {
      "DataFieldForAnnotation::FieldGroup::myFieldGroup": {
        "showDataFieldsLabel": true
      }
    }
  }
}
```

STEP: 17 - Merge TextArea label with section title (manifest.json)
DESCRIPTION: If a FieldGroup has only a single MultiLineText property, hide the TextArea label and show only the section/subsection title by enabling useSingleTextAreaFieldAsNotes at the section level in routing target options.
LANGUAGE: JSON
CODE:
```json
// manifest.json: enable merging TextArea label into section/subsection title
"sap.ui5": {
  "routing": {
    "targets": {
      "SalesOrderManageObjectPage": {
        "options": {
          "settings": {
            "content": {
              "body": {
                "sections": {
                  "ReferenceFacet1": {
                    "useSingleTextAreaFieldAsNotes": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 18 - Navigation and restrictions for ConnectedFields and FieldGroups
DESCRIPTION: Guidance and restrictions to apply in code:
- Navigation types allowed for semantically connected fields: DataFieldWithURL, semantic object (via intent), DataFieldWithIntentBasedNavigation, DataFieldWithNavigationPath. Define navigation terms on the individual data fields inside the ConnectedFields annotation.
- Restrictions: ConnectedFields can only be used inside form sections (not header sections) and cannot be rendered in tables. FieldGroup is not supported in grid tables. When using multiple DataFieldForAction in one cell, omit the LineItem column Label to hide the column header.
LANGUAGE: JSON
CODE:
```json
{
  "notes": [
    "ConnectedFields navigation: use DataFieldWithURL, SemanticObject, DataFieldWithIntentBasedNavigation, or DataFieldWithNavigationPath on the DATAFIELD entries",
    "Restrictions: ConnectedFields only in form sections; cannot be rendered in tables",
    "FieldGroup is not supported in grid tables (use responsive table/list)",
    "If multiple DataFieldForAction buttons are used in a LineItem FieldGroup, do not set a Label on the DataFieldForAnnotation to avoid a column header"
  ]
}
```

STEP: 19 - Practical tips & behavior notes
DESCRIPTION: Quick actionable points to keep in implementation and testing:
- A UI.FieldGroup container is hidden when all grouped fields are hidden.
- If no Headerfacet or HeaderInfo images exist, expand/collapse and pin buttons in object page header are hidden.
- If a subsection has only one group and subsection title equals group title, the group title is hidden automatically.
- Table personalization: users can filter/sort/group only the individual properties (columns) contained in the UI.FieldGroup collection (same entity type as LineItem).
LANGUAGE: JSON
CODE:
```json
{
  "behavior": [
    "UI.FieldGroup container hidden if all inner fields are hidden",
    "No HeaderFacet + no HeaderInfo images => header expand/collapse & pin buttons hidden",
    "Single-group subsection with same title => group title hidden",
    "Table personalization applies to individual properties inside UI.FieldGroup only"
  ]
}
```
--------------------------------

**TITLE**: Handling Inconsistent Input in Fiori Elements (draft and non-draft / OData V2)

**INTRODUCTION**: This document gives actionable, code-ready patterns to detect and handle technical inconsistencies (e.g., non-numeric characters in number fields, length overflow) that prevent saving or activating drafts in Fiori Elements apps. It covers draft-enabled apps (including Apply on subobject pages) and non-draft OData V2 apps. Focus is on preventing the save/activate/apply actions until inconsistencies are fixed and on showing the appropriate user message.

**TAGS**: fiori-elements-framework, odata-v2, draft, validation, sapui5, message-handling, ui5

**STEP**: 1 - Detect technical inconsistencies on the UI model

**DESCRIPTION**: Implement client-side validators that detect technical issues before attempting save/activate/submit. Return a structured list of issues so calling code can decide to block actions and display messages.

**LANGUAGE**: TypeScript

**CODE**:
```typescript
// utils/validation.ts
export type ValidationIssue = {
  fieldPath: string;    // Model path (e.g. "/SalesOrderItems/0/Quantity")
  message: string;      // Human-friendly message
  code?: string;        // Optional error code
  technical?: boolean;  // Mark technical inconsistencies (true)
};

export function validateEntityForTechnicalIssues(entity: Record<string, any>, schema?: any): ValidationIssue[] {
  const issues: ValidationIssue[] = [];

  // Example checks: numeric field and length constraint
  if (entity.Quantity !== undefined && isNaN(Number(entity.Quantity))) {
    issues.push({
      fieldPath: "", // caller can map to UI path
      message: "Quantity must be a number",
      code: "TECH_INVALID_NUMBER",
      technical: true
    });
  }

  if (entity.ShortText && entity.ShortText.length > 40) {
    issues.push({
      fieldPath: "",
      message: "ShortText exceeds maximum length (40)",
      code: "TECH_MAX_LENGTH",
      technical: true
    });
  }

  return issues;
}
```

**STEP**: 2 - Block draft activation / saving in draft-enabled apps

**DESCRIPTION**: Before activating or saving a draft, call validators. If any technical issues exist, prevent the framework action and surface an error message. Use model.hasPendingChanges() to detect local edits and integrate with the draft flow.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// controller/DraftActions.controller.js
sap.ui.define([
  "sap/m/MessageBox",
  "sap/ui/core/MessageType",
  "sap/ui/core/message/Message",
  "sap/ui/core/message/MessageManager"
], function(MessageBox, MessageType, Message, MessageManager) {
  "use strict";

  return {
    onActivateDraft: function(oEvent) {
      const oModel = this.getView().getModel(); // OData V2 model
      const hasChanges = oModel.hasPendingChanges && oModel.hasPendingChanges();

      // gather current entity data (depends on your app binding)
      const oContext = this.getView().getBindingContext();
      const oEntity = oContext && oContext.getObject();

      // validate (use the function from Step 1)
      const issues = validateEntityForTechnicalIssues(oEntity);

      if (issues.length > 0) {
        // Block activation and show a concise message indicating technical issues must be resolved
        MessageBox.error("There are technical inconsistencies in the data. Please correct them before activating the draft.", {
          actions: [MessageBox.Action.CLOSE]
        });

        // Optionally add messages to the MessageManager for targeting UI controls
        const oMM = MessageManager.getMessageManager();
        const aMessages = issues.map(issue => new Message({
          message: issue.message,
          type: MessageType.Error,
          target: issue.fieldPath || oContext && oContext.getPath(),
          additionalText: issue.code,
          // processor can be set if you want the message to be associated with a model binding
        }));
        oMM.addMessages(aMessages);

        return; // prevent activation call
      }

      // No technical issues — proceed with draft activation (example call, may differ in your framework)
      this._activateDraftInternal(); // placeholder for your activation handler
    }
  };
});
```

**STEP**: 3 - Handle Apply on a subobject page (ensure UI & draft contents match)

**DESCRIPTION**: The Apply button must ensure UI content equals stored draft content. Compare serialized UI values with draft values. If mismatches are caused by technical inconsistencies, show message and block Apply.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// controller/SubObject.controller.js
onApplySubobject: function() {
  const oView = this.getView();
  const oModel = oView.getModel();
  const oUIContext = oView.getBindingContext(); // UI-binding context
  const uiData = oUIContext.getObject();

  // Retrieve draft data from the draft entity (implementation will vary)
  const draftPath = oUIContext.getPath(); // assumes draft stored at same path
  const draftData = oModel.getObject(draftPath);

  // Quick structural comparison - you can do a deeper/smart diff
  const same = JSON.stringify(normalizeForCompare(uiData)) === JSON.stringify(normalizeForCompare(draftData));

  // Validate the UI data for technical issues
  const issues = validateEntityForTechnicalIssues(uiData);

  if (!same || issues.length > 0) {
    // If differences are caused by technical inconsistencies, show message and block Apply
    sap.m.MessageBox.error(
      "Contents of the UI and the draft differ. Resolve technical inconsistencies before using Apply.",
      { actions: [sap.m.MessageBox.Action.CLOSE] }
    );
    return;
  }

  // proceed with apply operation
  this._applySubobjectInternal();
},

function normalizeForCompare(obj) {
  // Remove transient properties, convert undefined -> null, etc.
  // Implement as needed for your app
  return obj;
}
```

**STEP**: 4 - Non-draft apps (OData V2) — validate before submitChanges

**DESCRIPTION**: In non-draft OData V2 apps, call validators before oModel.submitChanges(). If technical issues exist, block the submit and show a message prompting fixes.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// controller/Save.controller.js
onSave: function() {
  const oModel = this.getView().getModel(); // OData V2 model
  // gather the entities to be submitted (depends on your app structure)
  const aChangedEntities = this._collectChangedEntities(); // returns array of entity objects

  // Validate each entity for technical inconsistencies
  let aIssues = [];
  aChangedEntities.forEach(entity => {
    aIssues = aIssues.concat(validateEntityForTechnicalIssues(entity));
  });

  if (aIssues.length > 0) {
    sap.m.MessageBox.error("Please correct technical input errors before saving.");
    // Optionally add to MessageManager for UI control highlights (see Step 2)
    return; // block submitChanges
  }

  // No technical issues — submit to backend
  oModel.submitChanges({
    success: function(oData) {
      // handle success
    },
    error: function(oErr) {
      // backend errors (business/state messages) will be handled here or by framework
    }
  });
}
```

**STEP**: 5 - Present messages and keep them focused on technical inconsistencies

**DESCRIPTION**: Display only technical inconsistency messages when blocking save/activate/apply. Do not include business validation errors (e.g., missing business partner) in this blocking message — those are shown as state messages when saving. Use a MessageManager for persistent message lists and target messages to bindings so UI controls show the error state.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// utils/messageHelpers.js
sap.ui.define([
  "sap/ui/core/message/Message",
  "sap/ui/core/message/MessageManager",
  "sap/ui/core/MessageType"
], function(Message, MessageManager, MessageType) {
  "use strict";

  return {
    addTechnicalMessages: function(issues, oModelOrProcessor) {
      const oMM = MessageManager.getMessageManager();
      const aMessages = issues
        .filter(i => i.technical) // ensure only technical ones
        .map(i => new Message({
          message: i.message,
          type: MessageType.Error,
          target: i.fieldPath || "/", // map to real binding path if available
          processor: oModelOrProcessor // optional: associate message with model binding
        }));
      oMM.addMessages(aMessages);
    },

    clearTechnicalMessages: function() {
      const oMM = MessageManager.getMessageManager();
      // remove messages you added; implement filtering as needed
      oMM.removeAllMessages(); // or filter and remove only technical messages
    }
  };
});
```

**NOTES / GUIDELINES**:
- The system message that blocks save/activate should list only technical inconsistencies; business-related errors are displayed as state messages during/after save by the backend.
- Keep client-side validators in sync with backend constraints (types, lengths, precision) to avoid false positives/negatives.
- Use MessageManager to maintain a list of messages that can be bound to the MessagePopover for user inspection.
- For subobject Apply, ensure you compare a canonical representation of UI vs draft (filter out transient metadata and timestamps).
--------------------------------

**TITLE**: Configure and Use the preferredMode Startup Parameter for SAP Fiori Elements Object Pages

**INTRODUCTION**: This reference shows how to configure and use the preferredMode start-up / URL parameter to open object pages in display, edit, create, or to invoke unbound actions. It includes manifest.json settings, metadata function import examples, Component.js startup parameter injection, and URL examples for both OData V2 and OData V4 scenarios. Use these code snippets as drop-in configurations and runtime examples.

**TAGS**: preferredMode, manifest.json, inboundParameters, useForCreate, callUnboundAction, createWith, autoCreateWith, Component.js, OData V2, OData V4, URL parameters

STEP: 1 — Overview of supported preferredMode values and behaviors
DESCRIPTION: Quick actionable summary of supported preferredMode values and their effect on object page launch (both OData V2 and V4).
LANGUAGE: text
CODE:
```text
Supported preferredMode values and high-level behaviors:
- preferredMode=display
  - Opens object page in display mode unless a draft for the user exists (draft opens in edit).
- preferredMode=edit
  - Opens object page in edit mode; creates a draft if none exists.
  - Accepts a key (technical/semantic) via URL or startup parameter to identify the target object.
- preferredMode=create
  - Opens the object page in Create mode.
  - POST-based draft creation: creates a new draft by POST (unless application uses newAction).
  - newAction-based creation: calls a configured function import; URL parameter prefill not supported for newAction.
- preferredMode=callUnboundAction
  - Triggers an unbound action on navigation. Requires the target app to map action names in manifest.json and the action to be present in service metadata.
- preferredMode=createWith:<ActionName> or autoCreateWith:<ActionName> (OData V4)
  - createWith: Opens create mode and triggers the specified action (shows parameter dialog if action has parameters).
  - autoCreateWith: Same as createWith, but skips parameter dialog if all action parameters can be resolved from the navigation context.
Notes:
- If the target app does not define an object page or external navigation overrides internal navigation, the list report is shown (no double navigation).
- If the app uses a custom view instead of the template, preferredMode=create may not open the object page in create mode; list report is launched.
```

STEP: 2 — Launch the app in create mode via FLP tile or URL
DESCRIPTION: Use a start-up parameter on the FLP tile or append preferredMode=create to external navigation URLs; you can also append additional field values to prefill fields (subject to manifest inboundParameters/useForCreate).
LANGUAGE: URL
CODE:
```text
# Tile / startup parameter (FLP):
preferredMode=create

# External navigation URL example (sets DefectCategory field to 01):
#Defect-displayWorklist?preferredMode=create&DefectCategory=01

# Example:
…#SalesOrder-manage?preferredMode=create&SalesOrderType=OR&Supplier=ABC
```

STEP: 3 — Configure manifest.json to accept inbound parameters for POST-based create (useForCreate)
DESCRIPTION: Declare inboundParameters in the target application's manifest.json to specify which URL parameters are used during POST-based create. Use "useForCreate": true for each parameter you want passed to the create call.
LANGUAGE: JSON
CODE:
```json
// Example manifest.json snippet (sap.ui.generic.app or options.settings depending on app)
{
  "sap.ui.generic.app": {
    "_version": "1.2.0",
    "settings": {
      "inboundParameters": {
        "DefectCategory": {
          "useForCreate": true
        }
      }
    },
    "pages": [
      {
        // object page config...
      }
    ]
  }
}

/* Alternate structure used in some templates (options.settings) */
{
  "options": {
    "settings": {
      "contextPath": "/SalesOrderManage",
      "inboundParameters": {
        "SalesOrderType": {
          "useForCreate": true
        }
      }
    }
  }
}
```

STEP: 4 — Behavior of URL parameters when preferredMode=create (POST vs NewAction)
DESCRIPTION: Actionable differences:
- POST-based create: Only parameters flagged with "useForCreate": true in manifest are passed to backend POST create.
- NewAction-based create (function import annotated with newAction): Navigation context values are applied into the action parameter dialog for matching technical names; "useForCreate" is ignored.
LANGUAGE: text
CODE:
```text
Example POST-based create behavior:
- manifest.json inboundParameters:
  "SalesOrderType": { "useForCreate": true }
- Incoming URL:
  …#SalesOrder-manage?preferredMode=create&SalesOrderType=OR&Supplier=ABC
- Result: Only SalesOrderType=OR is passed to the backend create call; Supplier is ignored.

Example NewAction() behavior:
- NewAction is invoked; all matching parameters from navigation context are taken into the action parameter dialog (even if hidden).
- "useForCreate" manifest setting is not considered for NewAction-based create.
```

STEP: 5 — Configure callUnboundAction (map action names in manifest and define FunctionImport in metadata)
DESCRIPTION: Map a logical action identifier from the source app to function import(s) in the target app via manifest inboundParameters (useForActionResolution). Provide FunctionImport definitions in the OData metadata (metadata.xml). Use a URL with preferredMode=callUnboundAction and specify myActionName plus any inbound action parameters.
LANGUAGE: JSON / XML / URL
CODE:
```json
// manifest.json snippet: map a logical action name to available unbound function import(s)
{
  "sap.ui.generic.app": {
    "_version": "1.2.0",
    "settings": {
      "inboundParameters": {
        "myActionName": {
          "useForActionResolution": {
            "myCreateWithNameAndStreet": "myCreate1",
            "myCreateWithoutNameAndStreet": "myCreate3"
          }
        }
      }
    }
  }
}
```
```xml
<!-- metadata.xml: FunctionImport definitions (OData V2) -->
<FunctionImport Name="myCreate1" ReturnType="cds_zvd_drafts_customer_sd.CustomerType" EntitySet="Customer" m:HttpMethod="POST">
  <Parameter Name="ResultIsActiveEntity" Type="Edm.Boolean" Mode="In" Nullable="true" sap:label="Result is active"/>
  <Parameter Name="Name" Type="Edm.String" Mode="In" MaxLength="40" Nullable="true" sap:label="Customer Name"/>
  <Parameter Name="Street" Type="Edm.String" Mode="In" MaxLength="40" Nullable="true" sap:label="Customer Street"/>
</FunctionImport>

<FunctionImport Name="myCreate3" ReturnType="cds_zvd_drafts_customer_sd.CustomerType" EntitySet="Customer" m:HttpMethod="POST">
  <Parameter Name="ResultIsActiveEntity" Type="Edm.Boolean" Mode="In" Nullable="true" sap:label="Result is active"/>
</FunctionImport>
```
```text
# URL example to call myCreate1 with inbound parameters:
#NewActionTest-NewActionTest?preferredMode=callUnboundAction&myActionName=myCreate1&ResultIsActiveEntity=true&Name=myName
```

STEP: 6 — Configure OData V4 preferredMode with createWith / autoCreateWith in manifest
DESCRIPTION: For OData V4 apps you can set preferredMode defaultValue to createWith:<Action> or autoCreateWith:<Action>. The action is called when the app opens in create mode. If action has parameters, a parameter dialog appears unless autoCreateWith resolved all parameters from navigation context.
LANGUAGE: JSON
CODE:
```json
// manifest.json snippet: preferredMode defaultValue for createWith
{
  "sap.ui5": {
    "models": { /* ... */ }
  },
  "sap.ui.generic.app": {
    "settings": {
      "preferredMode": {
        "defaultValue": {
          "value": "createWith:com.c_salesordermanage_sd.CreateWithSalesOrderType",
          "format": "value"
        }
      }
    }
  }
}

// For autoCreateWith:
{
  "sap.ui.generic.app": {
    "settings": {
      "preferredMode": {
        "defaultValue": {
          "value": "autoCreateWith:com.c_salesordermanage_sd.CreateWithSalesOrderType",
          "format": "value"
        }
      }
    }
  }
}
```

STEP: 7 — preferredMode=edit — startup parameter via Component.js (programmatic) and URL approach
DESCRIPTION: Inject preferredMode=edit plus object key either as a launchpad startup parameter, Component.js getStartupParameters override, or via URL parameter to open the object page directly in edit mode and create a draft if necessary.
LANGUAGE: JavaScript / URL
CODE:
```javascript
// Component.js: supply startup parameters programmatically (SAP Fiori App Component)
sap.ui.define(["sap/fe/core/AppComponent"], function(AppComponent) {
  "use strict";

  return AppComponent.extend("FormTemplate.Component", {
    metadata: {
      manifest: "json"
    },

    getStartupParameters: function() {
      // Provide preferredMode and an object key (ID)
      return Promise.resolve({
        preferredMode: ["edit"],
        ID: "1"
      });
    }
  });
});
```
```text
// URL example to open object with key ID=1 in edit mode:
#Manage-items?preferredMode=edit&ID=1
```

STEP: 8 — Important operational notes and fallbacks
DESCRIPTION: Keep these operational rules in mind when implementing preferredMode handling.
LANGUAGE: text
CODE:
```text
- No double navigation: If the target app doesn't define an object page in manifest.json or external navigation overrides internal object navigation, the list report is shown instead of navigating twice.
- For custom object page views (not using default template), preferredMode=create (or URL param) might not open the object page in create mode; the list report may be launched.
- For NewAction() based creation: parameter values from navigation context are passed into the action parameter dialog even for hidden fields if they match the technical parameter name.
```

STEP: 9 — Quick manifest.json example combining inboundParameters and pages
DESCRIPTION: Minimal example showing how inboundParameters and pages are arranged in manifest.json for POST-based create scenario.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": { /* ... */ },
  "sap.ui.generic.app": {
    "_version": "1.2.0",
    "settings": {
      "inboundParameters": {
        "SalesOrderType": {
          "useForCreate": true
        },
        "DefectCategory": {
          "useForCreate": true
        }
      }
    },
    "pages": [
      {
        "entitySet": "SalesOrder",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      }
    ]
  }
}
```
--------------------------------

**TITLE**: Handling Semantic Key Fields for List Reports and Object Pages (Fiori Elements)

**INTRODUCTION**: This document shows how to declare semantic key fields via annotations (XML, ABAP CDS, CAP CDS) and describes the exact UI rendering logic used by SAP Fiori elements for semantic key fields in list report tables, object pages and subobject pages. Use these examples when generating annotations or implementing UI behavior for list reports.

**TAGS**: fiori-elements, semantic-key, annotations, Common.SemanticKey, ODataV2, ODataV4, responsive-table, object-identifier, CDS, CAP, ABAP

STEP: 1 — Add Common.SemanticKey annotation (XML)
DESCRIPTION: Add the Common.SemanticKey annotation to the entity in the OData metadata using XML annotations. Target the entity (example: STTA_PROD_MAN.STTA_C_MP_ProductType) and list the semantic key property path(s). This is applicable to list reports and object pages.
LANGUAGE: XML
CODE:
```xml
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="STTA_PROD_MAN.STTA_C_MP_ProductType">
    <Annotation Term="Common.SemanticKey">
        <Collection>
            <PropertyPath>ProductForEdit</PropertyPath>
        </Collection>
    </Annotation>
</Annotations>
```

STEP: 2 — Add Common.SemanticKey annotation (ABAP CDS)
DESCRIPTION: For ABAP CDS views, declare the semantic key using the @ObjectModel.semanticKey annotation. Provide property name(s) inside the array.
LANGUAGE: CDS (ABAP)
CODE:
```abap
@ObjectModel: {
  semanticKey: [ 'ProductForEdit' ]
}

define view C_MP_PRODUCT {
  // Fields including ProductForEdit must be defined here
}
```

STEP: 3 — Add Common.SemanticKey annotation (CAP CDS)
DESCRIPTION: For CAP (Node.js) CDS, annotate the entity with Common.SemanticKey using the annotate statement. Use the entity name and property(s) as shown.
LANGUAGE: CDS (CAP)
CODE:
```c
annotate STTA_PROD_MAN.STTA_C_MP_ProductType @(
  Common.SemanticKey : [ ProductForEdit ]
);
```

STEP: 4 — Rendering logic in responsive tables (ObjectIdentifier)
DESCRIPTION: SAP Fiori elements uses ObjectIdentifier for semantic key fields in responsive table rows. Follow these rendering rules exactly when generating UI or tests:
LANGUAGE: text
CODE:
```
- Component used: ObjectIdentifier.
- If both text and ID are available:
  - First line (bold): the text.
  - Second line (normal): the ID.
- If only ID is available (no text):
  - Single line (bold): the ID. No second line is rendered.
- If a semantic object is linked to the field in a responsive table:
  - Do NOT use ObjectIdentifier.
  - Display the ID as an interactive link (single-line link).
- Image references for examples:
  - images/Semantic_Key_Fields_in_a_Table_Text_and_ID_d58b9d9.png
```

STEP: 5 — Rendering logic in other tables (grid/table, non-responsive)
DESCRIPTION: For grid and other non-responsive tables SAP Fiori elements renders the semantic key field as a label with the whole content in bold. Behavior differs based on TextArrangement and OData version; replicate the behavior below when producing UI or docs:
LANGUAGE: text
CODE:
```
- Component: label with entire content rendered in bold.
- If an associated text is available, the framework reads the text and combines ID+text according to TextArrangement.
- When no TextArrangement is configured:
  - OData V2:
    - If text available: display "ID (Text)" (ID shown with text in parentheses).
    - If no text: display "ID" only.
  - OData V4:
    - If text available: display "Text" only.
    - If no text: display "ID" only.
- Example arrangement: TextFirst (text shown first then ID as configured). See image:
  - images/Semantic_Key_Fields_in_a_Table_TextFirst_40b9a46.png
```

STEP: 6 — Link behavior in other tables when semantic object is present
DESCRIPTION: When a semantic object is linked to the semantic key field:
LANGUAGE: text
CODE:
```
- In responsive tables:
  - ID is displayed as a link (object identifier is replaced by a link).
- In other (non-responsive) tables:
  - The entire content (ID and text together) is displayed as a single link.
  - No text wrapping is applied to that linked content.
```

STEP: 7 — Usage constraints and applicability
DESCRIPTION: Important implementation notes to preserve behavior and compatibility.
LANGUAGE: text
CODE:
```
- The Common.SemanticKey setting is available only for the default DataField (default control binding).
- The semantic key handling logic described above applies to:
  - List reports (tables)
  - Object pages and subobject pages
- Ensure the annotated property(ies) (e.g., ProductForEdit) are exposed in the entity metadata and bound to the table column/field.
```

STEP: 8 — Related resources
DESCRIPTION: Reference links and files to include in generated docs or tests.
LANGUAGE: text
CODE:
```
- Related docs: settings-for-list-report-tables-4c2d17a.md
  (Title: Settings for List Report Tables — shows additional table configuration via annotations and manifest.json)
- Image assets referenced:
  - images/Semantic_Key_Fields_in_a_Table_Text_and_ID_d58b9d9.png
  - images/Semantic_Key_Fields_in_a_Table_TextFirst_40b9a46.png
```
--------------------------------

**TITLE**: Harvey Ball Micro Chart (UI.Chart + UI.DataPoint) - Annotation Examples for XML, ABAP CDS, and CAP CDS

**INTRODUCTION**: This document provides action-oriented, ready-to-use annotation examples and requirements to render a Harvey Ball Micro Chart (single-measure vs. maximum) in Fiori Elements. Includes XML (OData annotations), ABAP CDS, and CAP CDS code samples. Use these snippets to add the chart to your metadata/annotations and to configure semantic coloring via Criticality.

**TAGS**: fiori-elements-framework, harvey-ball, microchart, UI.Chart, UI.DataPoint, annotations, CDS, ABAP, CAP, XML, SAPUI5

STEP: 1 - UI.Chart (XML) — configure Harvey Ball Micro Chart and reference UI.DataPoint
DESCRIPTION: Set UI.Chart properties: use ChartType = Pie, provide a single Measure, and add MeasureAttributes where DataPoint references a UI.DataPoint annotation (AnnotationPath). Title and Description map to the chart title and subtitle. Include Qualifier if you need multiple charts.
LANGUAGE: XML
CODE:
```XML
<!-- File: annotations.xml (OData annotations) -->
<Annotations Target="YourService.YourEntityType">
  <!-- Harvey Ball Chart annotation with qualifier -->
  <Annotation Term="UI.Chart" Qualifier="SpecificationWidthHarveyChart">
    <Record>
      <PropertyValue EnumMember="UI.ChartType/Pie" Property="ChartType" />
      <PropertyValue Property="Title" String="Sold to Produced Harvey Chart" />
      <PropertyValue Property="Description" String="Harvey Chart" />
      <PropertyValue Property="Measures">
        <Collection>
          <!-- single measure path -->
          <PropertyPath>Sold</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="MeasureAttributes">
        <Collection>
          <Record Type="UI.ChartMeasureAttributeType">
            <!-- reference the UI.DataPoint annotation on the same entity (no qualifier) -->
            <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <!-- DataPoint annotation referenced above -->
  <Annotation Term="UI.DataPoint">
    <Record>
      <PropertyValue Path="Sold" Property="Value" />
      <PropertyValue Path="Produced" Property="MaximumValue" />
      <!-- optional: criticality for semantic coloring -->
      <PropertyValue Path="criticalityValue" Property="Criticality" />
    </Record>
  </Annotation>
</Annotations>
```

STEP: 2 - UI.Chart (ABAP CDS) — add chart annotation to a CDS view
DESCRIPTION: Add @UI.Chart annotation block in an ABAP CDS view definition. Use chartType: #PIE, list the measure(s), and map measureAttributes to DataPoint via asDataPoint: true.
LANGUAGE: ABAP CDS
CODE:
```ABAP CDS
@UI.Chart: [
  {
    title: 'Sold to Produced Harvey Chart',
    description: 'Harvey Chart',
    chartType: #PIE,
    measures: [
      'Sold'                     /* single measure field name */
    ],
    measureAttributes: [
      {
        measure: 'Sold',
        role: #AXIS_1,
        asDataPoint: true         /* indicates this measure is backed by a DataPoint */
      }
    ],
    qualifier: 'SpecificationWidthHarveyChart' /* optional qualifier */
  }
]
annotate view STTA_C_MP_PRODUCT with {
  // Add other annotations as required for the view
}
```

STEP: 3 - UI.Chart (CAP CDS) — add chart annotation in CAP model
DESCRIPTION: Define UI.Chart annotation in CAP CDS. Use ChartType : #Pie and include MeasureAttributes referencing a DataPoint via DataPoint : '@UI.DataPoint'.
LANGUAGE: CDS
CODE:
```CDS
// In your .cds file (annotations or service layer)
using { UI } from '@sap/cds/common';

annotate MyService.MyEntity with {
  @UI.Chart #SpecificationWidthHarveyChart : {
      ChartType : #Pie,
      Title : 'Sold to Produced Harvey Chart',
      Description : 'Harvey Chart',
      Measures : [ Sold ],
      MeasureAttributes : [
          {
              $Type : 'UI.ChartMeasureAttributeType',
              DataPoint : '@UI.DataPoint'
          }
      ]
  }
}
```

STEP: 4 - UI.DataPoint (XML) — define value, maximum, and criticality
DESCRIPTION: Define UI.DataPoint to supply the numeric Value (measure), MaximumValue (reference for the Harvey Ball), and optional Criticality for semantic coloring. The DataPoint must be referenced by the Chart MeasureAttributes DataPoint.
LANGUAGE: XML
CODE:
```XML
<!-- File: annotations.xml -->
<Annotation Term="UI.DataPoint">
  <Record>
    <!-- Value: measured value to display -->
    <PropertyValue Path="Sold" Property="Value" />
    <!-- MaximumValue: maximum/target value for the Harvey ball -->
    <PropertyValue Path="Produced" Property="MaximumValue" />
    <!-- Criticality: optional semantic coloring (supported) -->
    <PropertyValue Path="criticalityValue" Property="Criticality" />
  </Record>
</Annotation>
```

STEP: 5 - UI.DataPoint (ABAP CDS) — ABAP CDS DataPoint example
DESCRIPTION: In ABAP CDS, annotate the measure field (or separate line) with @UI.dataPoint mapping criticality and maximumValue. Ensure the DataPoint is linked from UI.Chart measureAttributes as shown in STEP 2.
LANGUAGE: ABAP CDS
CODE:
```ABAP CDS
// Example in an ABAP CDS view item
@UI.dataPoint: {
  criticality: 'criticalityValue',   /* name of field/expression providing criticality */
  maximumValue: 20                   /* constant or reference field; can be numeric or field name */
}
Sold;
```

STEP: 6 - UI.DataPoint (CAP CDS) — CAP CDS DataPoint example
DESCRIPTION: Define UI.DataPoint in CAP CDS with Value, MaximumValue, and Criticality fields.
LANGUAGE: CDS
CODE:
```CDS
// In .cds annotations file
annotate MyService.MyEntity with {
  @UI.DataPoint : {
      Value : Sold,
      MaximumValue : Produced,
      Criticality : criticalityValue
  }
}
```

STEP: 7 - Mandatory annotations and quick checklist
DESCRIPTION: Use this checklist to validate required annotations before deploying the chart. Each item is required for the Harvey Ball Micro Chart to render correctly; Criticality is required only if semantic coloring is desired.
LANGUAGE: JSON
CODE:
```JSON
{
  "required": [
    "UI.Chart -> ChartType: Pie",
    "UI.Chart -> Measures: single measure defined (e.g., Sold)",
    "UI.Chart -> MeasureAttributes -> DataPoint: reference to UI.DataPoint",
    "UI.DataPoint -> MaximumValue: set (e.g., Produced)"
  ],
  "optional_for_semantic_coloring": [
    "UI.DataPoint -> Criticality"
  ]
}
```

Step: 8 - Implementation notes and tips
DESCRIPTION: Actionable tips for implementers:
- Always set UI.Chart ChartType to Pie for Harvey Ball micro charts.
- The DataPoint provides the relationship (Value vs. MaximumValue). The UI.Chart MeasureAttributes must reference this DataPoint (AnnotationPath or asDataPoint).
- For multiple charts on one entity, use Qualifier values (UI.Chart Qualifier) and reference matching qualified DataPoint if needed.
- Semantic coloring supports only the Criticality property on the UI.DataPoint.
LANGUAGE: Text
CODE:
```text
- ChartType must be Pie.
- Provide exactly one measure in Measures for a Harvey Ball.
- Reference the UI.DataPoint from MeasureAttributes using AnnotationPath (XML) or asDataPoint:true (ABAP CDS).
- Define MaximumValue in UI.DataPoint (field or constant).
- Use Criticality in UI.DataPoint to enable semantic coloring (supported).
```
--------------------------------

**TITLE**: Header Facets — Implementing UI.HeaderFacets and Header Behavior in Fiori Elements Object Pages

**INTRODUCTION**: This document shows how to define header facets (UI.ReferenceFacet) for Fiori Elements object page headers using XML annotations, ABAP CDS, and CAP CDS. It includes steps to enable carousel header on desktop via manifest.json and guidance for stashing header facets so they are not loaded until enabled by key-user adaptation.

**TAGS**: fiori-elements-framework, object-page, header-facets, annotations, UI.HeaderFacets, ReferenceFacet, DataPoint, manifest.json, carousel, stashing, ODataV2, ODataV4, CDS, CAP

STEP: 1 — Header Facets overview and Annotation structure

DESCRIPTION: Header facets are defined by the annotation term UI.HeaderFacets, which contains a collection of UI.ReferenceFacet records. Each UI.ReferenceFacet has a Target property that typically references a UI.DataPoint (qualified by a qualifier like #Price) or a navigation path to an annotation on a related entity (e.g., to_StockAvailability/@UI.DataPoint#StockAvailability). Use this structure to expose contact data, rating indicators, datapoints, or custom header elements.

LANGUAGE: XML

CODE:
```xml
<!-- XML annotation example: define header facets as a collection of ReferenceFacet records -->
<Annotation Term="UI.HeaderFacets">
    <Collection>
        <!-- Reference to a DataPoint using a qualifier -->
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Price" />
        </Record>

        <!-- Reference to a DataPoint on a related navigation target -->
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Target" AnnotationPath="to_StockAvailability/@UI.DataPoint#StockAvailability" />
        </Record>

        <!-- Add additional ReferenceFacet records as needed -->
    </Collection>
</Annotation>
```

STEP: 2 — Implement HeaderFacets in ABAP CDS

DESCRIPTION: Use @UI.Facet in ABAP CDS to declare header facets. For each facet, set type: #DATAPOINT_REFERENCE and purpose: #HEADER. Use targetQualifier for local DataPoint qualifiers and targetElement for navigation targets.

LANGUAGE: CDS (ABAP)

CODE:
```abap
@UI.Facet: [
  {
    targetQualifier: 'Price',
    type: #DATAPOINT_REFERENCE,
    purpose: #HEADER
  },
  {
    targetQualifier: 'StockAvailability',
    targetElement: 'TO_STOCKAVAILABILITY',
    type: #DATAPOINT_REFERENCE,
    purpose: #HEADER
  }
]
define view entity MyService_Test {  /* replace with your CDS entity */
  key SalesOrder     : abap.char(10);
  /* ... other elements ... */
}
```

STEP: 3 — Implement HeaderFacets in CAP CDS (Node.js CAP)

DESCRIPTION: In CAP, annotate the service/entity with UI.HeaderFacets as an array of UI.ReferenceFacet objects. Provide Label, ID, and Target pointing to a DataPoint annotation (e.g., '@UI.DataPoint#Price') or to a navigation annotation (e.g., 'to_StockAvailability@UI.DataPoint#StockAvailability').

LANGUAGE: CDS (CAP)

CODE:
```cds
annotate c_salesordermanage_sd.SalesOrderManage with @(UI : {
  HeaderFacets : [
    {
      $Type : 'UI.ReferenceFacet',
      Label : 'Price',
      ID    : 'Price',
      Target: '@UI.DataPoint#Price'
    },
    {
      $Type : 'UI.ReferenceFacet',
      Label : 'Stock Availability',
      ID    : 'StockAvailability',
      Target: 'to_StockAvailability@UI.DataPoint#StockAvailability'
    }
  ]
});
```

STEP: 4 — Default behavior: mobile vs desktop and horizontal scroll container

DESCRIPTION: By default, mobile devices use a header container with a horizontal layout that enables scrolling for header facets. Desktop uses the dynamic or static header. No code changes required to get the default responsive behavior; define UI.HeaderFacets as shown above and the Object Page will render accordingly.

LANGUAGE: None

CODE:
```text
Default behavior summary:
- Mobile: header facets shown inside a horizontal scroll container (scrollable).
- Desktop: header facets shown in dynamic or static header layout (non-scrolling by default).
```

STEP: 5 — Enable carousel header on desktop (manifest.json)

DESCRIPTION: To render header facets as a carousel on desktops, set "showHeaderAsCarouselOnDesktop": true in manifest.json for each ObjectPage component. This setting must be specified at each component level under sap.ui.generic.app -> pages -> component -> settings.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "showHeaderAsCarouselOnDesktop": true
          }
        },
        "pages": [
          {
            "navigationProperty": "to_ProductText",
            "entitySet": "STTA_C_MP_ProductText",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "showHeaderAsCarouselOnDesktop": true
              }
            }
          }
        ]
      }
    ]
  }
}
```

STEP: 6 — Stashing header facets (defer loading until enabled by key-user adaptation)

DESCRIPTION: If you want header facets to be initially not visible and not loaded, mark them as stashed in manifest.json. Stashed header facets are added by key users at runtime using UI adaptation (flexibility). The exact manifest structure for stashing depends on your Fiori Elements version; the example below shows a common pattern: include a headerFacets array in the component settings and mark specific facets with "stashed": true. Verify the exact property names for your framework version and consult "Adapting the UI" for runtime enabling.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MyEntity",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "headerFacets": [
              {
                "id": "Price",
                "label": "Price",
                "target": "@UI.DataPoint#Price",
                "stashed": true
              },
              {
                "id": "StockAvailability",
                "label": "Stock Availability",
                "target": "to_StockAvailability@UI.DataPoint#StockAvailability",
                "stashed": true
              }
            ]
          }
        }
      }
    ]
  }
}
```

STEP: 7 — Runtime note and references

DESCRIPTION: Key users can enable stashed header facets using the UI adaptation (key-user) tools at runtime, which causes the facets to be loaded and become visible to end users. For implementation details and version-specific manifest keys, refer to "Adapting the UI" documentation for your Fiori Elements version.

LANGUAGE: None

CODE:
```text
References:
- Check "Adapting the UI" for instructions on key-user adaptation and enabling stashed controls at runtime.
- Ensure manifest.json settings for showHeaderAsCarouselOnDesktop are set per component level.
```
--------------------------------

**TITLE**: Hiding Features with the UI.Hidden Annotation (Fiori elements / Object Page)

**INTRODUCTION**: Guide and ready-to-use code snippets showing how to hide UI features on SAP Fiori elements object pages using the UI.Hidden annotation. Includes XML, ABAP CDS, and CAP CDS examples for header facets, sections, quick views, data fields, and table columns. Use these snippets directly in annotation files or CDS sources.

**TAGS**: fiori-elements-framework, UI.Hidden, annotations, OData V4, CDS, CAP, XML, ABAP

STEP: 1 — UI.Hidden basics and conditional usage

DESCRIPTION: Use these UI.Hidden annotation variants to control visibility. Default behavior: the presence of <Annotation Term="UI.Hidden"/> means true (hidden). Use Bool="false" to show, Bool="true" to hide, and Path="booleanProperty" to evaluate a Boolean property. For conditional expressions in OData V4, use edmJSON (If/Or/Eq XML-style example shown). Note: Path must reference a Boolean property; SAPUI5 expression binding is not supported. edmJSON/conditional usage applies to SAP Fiori elements for OData V4 only.

LANGUAGE: XML

CODE:
```xml
<!-- Default: presence implies true (hidden) -->
<Annotation Term="UI.Hidden" />

<!-- Explicitly not hidden -->
<Annotation Term="UI.Hidden" Bool="false" />

<!-- Explicitly hidden -->
<Annotation Term="UI.Hidden" Bool="true" />

<!-- Hide when the boolean path evaluates to true -->
<Annotation Term="UI.Hidden" Path="edit_mode" />

<!-- Conditional hiding using edmJSON (OData V4 only):
     Hidden when displayCriteria == value_A OR value_B -->
<Annotation Term="UI.Hidden">
    <If>
        <Or>
            <Eq>
                <Path>displayCriteria</Path>
                <String>value_A</String>
            </Eq>
            <Eq>
                <Path>displayCriteria</Path>
                <String>value_B</String>
            </Eq>
        </Or>
    </If>
</Annotation>
```

STEP: Header Facets — XML Annotation

DESCRIPTION: Hide individual header facets by adding UI.Hidden to the ReferenceFacet Record. Use Bool, empty annotation, or Path to a Boolean property.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.HeaderFacets">
    <Collection>
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Net Amount" />
            <PropertyValue Property="ID" String="NetValueDataHeader" />
            <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#NetValue" />
            <Annotation Term="UI.Hidden" Bool="true" />
        </Record>
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Contact Info" />
            <PropertyValue Property="ID" String="ContactHeader" />
            <PropertyValue Property="Target" AnnotationPath="_SoldToParty/@Communication.Contact" />
            <Annotation Term="UI.Hidden" />
        </Record>
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Credit Limit Consumption" />
            <PropertyValue Property="ID" String="CreditLimitChartHeader" />
            <PropertyValue Property="Target" AnnotationPath="_CreditLimitDetails/@UI.Chart#CreditLimitChart" />
            <Annotation Term="UI.Hidden" Path="editActionIsEnabled" />
        </Record>
    </Collection>
</Annotation>
```

STEP: Header Facets — ABAP CDS Annotation

DESCRIPTION: Corresponding ABAP CDS examples to hide header facets. Use hidden: true, hidden: #( 'path' ), or hidden: #(boolean-expression) style.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.Facet: [
  {
    hidden: true,
    label: 'Net Amount',
    id: 'NetValueDataHeader',
    targetQualifier: 'NetValue',
    type: #DATAPOINT_REFERENCE,
    purpose: #HEADER
  },
  {
    hidden: true,
    label: 'Contact Info',
    id: 'ContactHeader',
    targetElement: '_SOLDTOPARTY',
    type: #CONTACT_REFERENCE,
    purpose: #HEADER
  },
  {
    hidden: #('editActionIsEnabled'),
    label: 'Credit Limit Consumption',
    id: 'CreditLimitChartHeader',
    targetQualifier: 'CreditLimitChart',
    targetElement: '_CREDITLIMITDETAILS',
    type: #CHART_REFERENCE,
    purpose: #HEADER
  }
]
Test;
```

STEP: Header Facets — CAP CDS Annotation

DESCRIPTION: CAP CDS representation for header facets; use ![@UI.Hidden] : true | property.

LANGUAGE: CAP CDS

CODE:
```cds
HeaderFacets : [
    {
        $Type             : 'UI.ReferenceFacet',
        Label             : 'Net Amount',
        ID                : 'NetValueDataHeader',
        Target            : '@UI.DataPoint#NetValue',
        ![@UI.Hidden]     : true
    },
    {
        $Type             : 'UI.ReferenceFacet',
        Label             : 'Contact Info',
        ID                : 'ContactHeader',
        Target            : '_SoldToParty/@Communication.Contact',
        ![@UI.Hidden]     : true
    },
    {
        $Type             : 'UI.ReferenceFacet',
        Label             : 'Credit Limit Consumption',
        ID                : 'CreditLimitChartHeader',
        Target            : '_CreditLimitDetails/@UI.Chart#CreditLimitChart',
        ![@UI.Hidden]     : editActionIsEnabled
    }
]
```

STEP: Sections on Object Page — XML Annotation

DESCRIPTION: Hide entire sections (CollectionFacet) by applying UI.Hidden to the facet Record. To hide a subsection, hide its content or apply UI.Hidden to the subsection Record.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.Facets">
    <Collection>
        <Record Type="UI.CollectionFacet">
            <PropertyValue Property="Label" String="Header" />
            <PropertyValue Property="ID" String="HeaderInfo" />
            <PropertyValue Property="Facets">
                <Collection>
                    <Record Type="UI.CollectionFacet">
                        <PropertyValue Property="ID" String="GeneralInfo" />
                        <PropertyValue Property="Label" String="General Information" />
                        <PropertyValue Property="Facets">
                            <Collection>
                                ……..
                               …….
                            </Collection>
                        </PropertyValue>
                        <Annotation Term="UI.Hidden" Bool="true" />
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Collection>
</Annotation>
```

STEP: Sections on Object Page — ABAP CDS Annotation

DESCRIPTION: ABAP CDS: declare facets and set hidden: true on the subsection facet to hide it.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.Facet: [
  {
    label: 'Header',
    id: 'HeaderInfo',
    type: #COLLECTION,
    purpose: #STANDARD
  },
  {
    hidden: true,
    id: 'GeneralInfo',
    label: 'General Information',
    parentId: 'HeaderInfo',
    purpose: #STANDARD
  },
  …..
  …..
]
Test;
```

STEP: Sections on Object Page — CAP CDS Annotation

DESCRIPTION: CAP CDS: hide a collection facet (subsection) with ![@UI.Hidden] : true.

LANGUAGE: CAP CDS

CODE:
```cds
Facets : [
  {
    $Type  : 'UI.CollectionFacet',
    Label  : 'Header',
    ID     : 'HeaderInfo',
    Facets : [
      {
        $Type         : 'UI.CollectionFacet',
        ID            : 'GeneralInfo',
        Label         : 'General Information',
        Facets        : [
            ……
           ……
        ],
        ![@UI.Hidden] : true
      }
    ]
  }
]
```

STEP: Quick Views — XML Annotation

DESCRIPTION: Hide quick view reference facets or field groups by adding UI.Hidden on the ReferenceFacet. Use Path to a Boolean property to toggle visibility.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.QuickViewFacets">
    <Collection>
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Material" />
            <PropertyValue Property="Target" AnnotationPath="@Communication.Contact" />
            <Annotation Term="UI.Hidden" Bool="true" />
        </Record>
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Address" />
            <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SoldToQuickView" />
            <Annotation Term="UI.Hidden" Path="edit_Ac" />
        </Record>
    </Collection>
</Annotation>
```

STEP: Quick Views — ABAP CDS Annotation

DESCRIPTION: ABAP CDS quick view facet examples: use hidden true or hidden #(path) to control visibility.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.Facet: [
  {
    hidden: true,
    label: 'Material',
    type: #CONTACT_REFERENCE,
    purpose: #QUICK_VIEW
  },
  {
    hidden: #('edit_Ac'),
    label: 'Address',
    targetQualifier: 'SoldToQuickView',
    type: #FIELDGROUP_REFERENCE,
    purpose: #QUICK_VIEW
  }
]
Test;
```

STEP: Quick Views — CAP CDS Annotation

DESCRIPTION: CAP CDS quick view examples using ![@UI.Hidden].

LANGUAGE: CAP CDS

CODE:
```cds
UI.QuickViewFacets : [
  {
    $Type  : 'UI.ReferenceFacet',
    Label  : 'Material',
    Target : '@Communication.Contact',
    ![@UI.Hidden] : true
  },
  {
    $Type  : 'UI.ReferenceFacet',
    Label  : 'Address',
    Target : '@UI.FieldGroup#SoldToQuickView',
    ![@UI.Hidden] : edit_Ac
  }
]
```

STEP: DataField Records in Header Facets — XML Annotation

DESCRIPTION: Hide individual UI.DataField elements within a FieldGroup by adding UI.Hidden on the DataField record. To hide a whole FieldGroup or Identification, either hide every DataField inside or hide the wrapper ReferenceFacet / DataFieldForAnnotation.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="OrgData">
    <Record Type="UI.FieldGroupType">
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SalesOrganization" />
                    <Annotation Term="UI.Hidden" Bool="true" />
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="DistributionChannel" />
                    <Annotation Term="UI.Hidden" Path="Delivered" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: DataField Records in Header Facets — ABAP CDS Annotation

DESCRIPTION: ABAP CDS examples marking DataFields hidden or conditional via a Boolean path.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.fieldGroup: [
  {
    hidden: true,
    value: 'SALESORGANIZATION',
    type: #STANDARD,
    qualifier: 'OrgData'
  }
]
SALESORGANIZATION;

@UI.fieldGroup: [
  {
    hidden: #('Delivered'),
    value: 'DISTRIBUTIONCHANNEL',
    type: #STANDARD,
    qualifier: 'OrgData'
  }
]
DISTRIBUTIONCHANNEL;
```

STEP: DataField Records in Header Facets — CAP CDS Annotation

DESCRIPTION: CAP CDS FieldGroup samples: use ![@UI.Hidden] on individual DataField entries.

LANGUAGE: CAP CDS

CODE:
```cds
FieldGroup #OrgData : [
  {
    Label : 'Org Data',
    Data  : [
      {
        $Type         : 'UI.DataField',
        Value         : SalesOrganization,
        ![@UI.Hidden] : true
      },
      {
        $Type         : 'UI.DataField',
        Value         : DistributionChannel,
        ![@UI.Hidden] : Delivered
      }
    ]
  }
]
```

STEP: DataField Records in Facets — XML Annotation

DESCRIPTION: Hide DataField records in any facet by applying UI.Hidden on each DataField. To hide an entire FieldGroup or Identification, either hide all DataField entries or hide the wrapper (ReferenceFacet / DataFieldForAnnotation).

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="OrderData">
    <Record Type="UI.FieldGroupType">
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SoldToParty" />
                    <Annotation Term="UI.Hidden" Bool="true" />
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="ImageUrl" />
                    <Annotation Term="UI.Hidden" Path="edit_Ac" />
                </Record>
                …..
                ……
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: DataField Records in Facets — ABAP CDS Annotation

DESCRIPTION: ABAP CDS examples to hide DataField entries inside a FieldGroup by qualifier.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.fieldGroup: [
  {
    hidden: true,
    value: 'SOLDTOPARTY',
    type: #STANDARD,
    qualifier: 'OrderData'
  }
]
SOLDTOPARTY;

@UI.fieldGroup: [
  {
    hidden: #('edit_Ac'),
    value: 'IMAGEURL',
    type: #STANDARD,
    qualifier: 'OrderData'
  }
]
IMAGEURL;
```

STEP: DataField Records in Facets — CAP CDS Annotation

DESCRIPTION: CAP CDS FieldGroup example hiding DataField entries or conditioning them on a boolean property.

LANGUAGE: CAP CDS

CODE:
```cds
FieldGroup #OrderData : {
  Data : [
    {
      $Type         : 'UI.DataField',
      Value         : SoldToParty,
      ![@UI.Hidden] : true
    },
    {
      $Type         : 'UI.DataField',
      Value         : ImageUrl,
      ![@UI.Hidden] : edit_Ac
    },
    …..
    ……
  ]
}
```

STEP: DataField Records in Tables (LineItem) — XML Annotation

DESCRIPTION: Hide table columns (LineItem entries) by adding UI.Hidden Bool="true" to the DataField record (static true hides column). For actions, setting hidden will prevent rendering of the column. Note: footer may still render to display bound messages.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.LineItem">
    <Collection>
        <Record Type="UI.DataFieldForAction">
            <PropertyValue Property="Label" String="Bound Action with params" />
            <PropertyValue Property="Action" String="com.c_salesordermanage_sd_aggregate.CreateWithSalesOrderType" />
            <Annotation Term="UI.Hidden" Bool="true" />
        </Record>
    </Collection>
</Annotation>
```

STEP: DataField Records in Tables (LineItem) — ABAP CDS Annotation

DESCRIPTION: ABAP CDS LineItem example hiding an action column.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.lineItem: [
  {
    hidden: true,
    label: 'Bound Action with params',
    dataAction: 'com.c_salesordermanage_sd_aggregate.CreateWithSalesOrderType',
    type: #FOR_ACTION
  }
]
TEST;
```

STEP: DataField Records in Tables (LineItem) — CAP CDS Annotation

DESCRIPTION: CAP CDS LineItem example hiding a DataFieldForAction column.

LANGUAGE: CAP CDS

CODE:
```cds
LineItem : {
  $value : [
    {
      $Type        : 'UI.DataFieldForAction',
      Label        : 'Bound Action with params',
      Action       : 'com.c_salesordermanage_sd.CreateWithSalesOrderType',
      ![@UI.Hidden] : true
    }
  ]
}
```

STEP: Implementation notes and image references

DESCRIPTION: Additional implementation notes:
- The UI.Hidden path value must reference a Boolean property in the service metadata.
- Use edmJSON/conditional annotations only with OData V4 (SAP Fiori elements for OData V4).
- SAPUI5 expression binding is not supported in annotation Path for UI.Hidden.
- Hiding the wrapper (ReferenceFacet/DataFieldForAnnotation) can hide entire FieldGroup/Identification in OData V4.
- Footer behavior: Even if all footer actions are hidden, the footer might still render to show bound messages from the backend.
- Reference images used in the source documentation (for UI preview) are located at: images/Section_Object_Page_1_4d0d970.png, images/Content_in_Quick_Views_1_5ee9d69.png, images/Header_Facets_1_ba72afc.png, images/DataField_Records_in_Facets_1_b6dea7a.png

LANGUAGE: text

CODE:
```text
Notes:
- Path values for UI.Hidden must point to Boolean properties.
- Use edmJSON conditional annotations (If/Or/...) for OData V4 only.
- To hide UI.FieldGroup or UI.Identification completely, hide all contained DataField records or hide the wrapper (ReferenceFacet/DataFieldForAnnotation).
- The UI may still show footer sections to display backend-bound messages even if actions are hidden.
```
--------------------------------

**TITLE**: Highlight Line Items by Criticality in Fiori Elements Tables

**INTRODUCTION**: Add semantic highlights to table line items by annotating the entity type with a criticality property. This enables color coding (and optionally icons) for rows or object status fields based on the property's value. Use these annotations in OData service metadata or CDS definitions consumed by Fiori elements apps.

**TAGS**: fiori-elements, annotations, criticality, UI.LineItem, CDS, CAP, OData, XML

**STEP**: 1 — Criticality value mapping and behavior

**DESCRIPTION**: Use a numeric property (derived from com.sap.vocabularies.UI.v1.CriticalityType) to indicate row/field criticality. The property values and UI meaning:
- 0 — Neutral
- 1 — Negative (red)
- 2 — Critical (orange)
- 3 — Positive (green)
- 5 — New Item (blue) — for items created outside the app that need attention

Behavior notes:
- If the field is represented with UI.CriticalityRepresentationType/WithIcon (default), Fiori elements also sets an appropriate icon (for example, Negative -> sap-icon://status-negative).
- If the field is marked with UI.CriticalityRepresentationType/WithoutIcon, the field is rendered without an icon.
- For OData V2 analytical tables, the criticality provider must be a property (not a dimension).

**LANGUAGE**: Plain

**CODE**:
```text
Criticality property: numeric property on the entity or view representing criticality.
Vocabulary reference: com.sap.vocabularies.UI.v1.CriticalityType
```

**STEP**: 2 — XML annotation: add LineItem criticality (OData metadata / annotation file)

**DESCRIPTION**: Annotate the UI.LineItem of the entity type (the one used by the table) with UI.Criticality referencing the property that returns criticality values. Place this annotation alongside the LineItem collection in the entity metadata annotations file.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: annotations.xml -->
<Annotations Target="MyService.MyEntityType">
  <!-- LineItem annotation with a UI.Criticality path pointing to the criticality property -->
  <Annotation Term="UI.LineItem">
    <!-- LineItem-level criticality: path to the property that carries overall row criticality -->
    <Annotation Term="UI.Criticality" Path="Element_transporting_criticality_of_complete_LineItem" />
    <Collection>
      <!-- Example DataField records in the LineItem -->
      <Record Type="UI.DataField">
        <PropertyValue Property="Label" String="ID" />
        <PropertyValue Property="Value" Path="ID" />
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Label" String="Status" />
        <PropertyValue Property="Value" Path="Status" />
        <!-- Optionally control icon rendering: WithIcon (default) or WithoutIcon -->
        <!--
        <Annotation Term="UI.CriticalityRepresentationType" EnumMember="UI.CriticalityRepresentationType/WithoutIcon" />
        -->
      </Record>
      <!-- more DataField records -->
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 3 — ABAP CDS: add LineItem criticality (ABAP CDS view)

**DESCRIPTION**: For ABAP CDS, add the criticality provider to the @UI.lineItem annotation using the criticality attribute. Place this on the view definition or annotate the view separately.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.lineItem: [{ criticality: 'Element_transporting_criticality_of_complete_LineItem',
                 lineItem: [{ position: 10, label: 'ID', element: ID },
                            { position: 20, label: 'Status', element: Status }]
               }]
define view ZMy_View as select from ZMy_Table {
  key ID,
      Status,
      Element_transporting_criticality_of_complete_LineItem
}
```

Alternative: annotate the view with a separate annotate statement:
```abap
@UI.lineItem: [{ criticality: 'Element_transporting_criticality_of_complete_LineItem' }]
annotate view ZMy_View with { }
```

**STEP**: 4 — CAP CDS: add LineItem criticality (CAP model)

**DESCRIPTION**: In CAP CDS (srv or db model), add UI.LineItem definition and attach UI.Criticality to the LineItem using the annotation syntax. Use the bang (!) form to add the UI.Criticality annotation to the LineItem target.

**LANGUAGE**: CDS (CAP)

**CODE**:
```cds
namespace my.cap;

using { cuid } from '@sap/cds/common';

entity MyEntity {
  key ID : UUID;
  Status : String;
  Element_transporting_criticality_of_complete_LineItem : Integer; // criticality provider
}

annotate MyEntity with {
  @UI.LineItem: [
    { @UI.Hidden: false,
      $Type: 'UI.DataField',
      Value: ID
    },
    { $Type: 'UI.DataField', Value: Status }
  ],
  // Attach the criticality provider to the LineItem annotation
  !@UI.Criticality: Element_transporting_criticality_of_complete_LineItem
};
```

**STEP**: 5 — Control icon rendering (optional)

**DESCRIPTION**: If you want to remove the automatically added icon and only use color highlighting, mark the DataField with UI.CriticalityRepresentationType/WithoutIcon. Example show in XML and CAP/ABAP equivalents.

**LANGUAGE**: XML

**CODE**:
```xml
<Record Type="UI.DataField">
  <PropertyValue Property="Label" String="Status" />
  <PropertyValue Property="Value" Path="Status" />
  <!-- Render without icon -->
  <Annotation Term="UI.CriticalityRepresentationType" EnumMember="UI.CriticalityRepresentationType/WithoutIcon" />
</Record>
```

**LANGUAGE**: CDS (CAP)

**CODE**:
```cds
// In CAP annotate block, for a specific LineItem data field
@UI.CriticalityRepresentationType: 'WithoutIcon'   // or WithIcon
{ $Type: 'UI.DataField', Value: Status }
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
// Example ABAP CDS element annotation to hide icon (pseudo-syntax)
@UI.Identification: [{ Label: 'Status' }]
@UI.CriticalityRepresentationType: 'WithoutIcon'
Status : String;
```

**STEP**: 6 — OData V2 analytical table constraint

**DESCRIPTION**: For SAP Fiori elements OData V2 analytical tables, ensure the criticality provider is defined as a property (not a dimension). Otherwise the criticality-based highlighting will not work.

**LANGUAGE**: Plain

**CODE**:
```text
Constraint: For OData V2 analytical tables, criticality property must be an EDM Property (not an analytical dimension).
```
--------------------------------

**TITLE**: Highlighting Numeric Values with DataPoint Criticality

**INTRODUCTION**: Show how to highlight numeric values in SAP Fiori elements by using the com.sap.vocabularies.UI.v1.DataPoint annotation. Provide both a static criticality example and a dynamic threshold-based example using CriticalityCalculation. Include OData annotation XML and CDS annotation patterns so agents can generate or modify metadata and CDS files.

**TAGS**: fiori-elements-framework, annotations, DataPoint, Criticality, CriticalityCalculation, CDS, OData, metadata

**STEP**: 1 — Static criticality on a numeric property

**DESCRIPTION**: Use a DataPoint annotation with a static Criticality enum to color/highlight a numeric value. Place this in your OData annotation file (annotations.xml) or in a CDS annotation block. Replace EntityType and Property names with your model names.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: annotations/annotations.xml -->
<Annotations Target="MyService.MyEntity/Amount">
  <Annotation Term="com.sap.vocabularies.UI.v1.DataPoint">
    <Record>
      <!-- Value: path to the numeric property -->
      <PropertyValue Property="Value" Path="Amount"/>
      <!-- Title displayed above or next to the value -->
      <PropertyValue Property="Title" String="Total Sales"/>
      <!-- Static criticality: Positive, Critical, Negative, Neutral -->
      <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Positive"/>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: CDS

**CODE**:
```cds
// File: db/schema.cds or annotations in ABAP CDS
entity MyEntity {
  key ID : UUID;
  Amount : Decimal(15,2);
}

// CDS-style UI DataPoint annotation (ABAP CDS / CAP CDS syntax differs)
// Replace names and values as appropriate
@UI.dataPoint: {
  value: 'Amount',
  title: 'Total Sales',
  criticality: #Positive
}
entity MyEntityAnnotated as projection on MyEntity;
```

**STEP**: 2 — Dynamic criticality with thresholds (CriticalityCalculation)

**DESCRIPTION**: Use CriticalityCalculation to compute criticality based on numeric thresholds. The example below shows OData XML using CriticalityCalculation with CriticalityConditions and a CDS-style example expressing the same logic. Adjust operators, threshold values, and improvingDirection for your scenario.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: annotations/annotations.xml -->
<Annotations Target="MyService.MyEntity/Amount">
  <Annotation Term="com.sap.vocabularies.UI.v1.DataPoint">
    <Record>
      <PropertyValue Property="Value" Path="Amount"/>
      <PropertyValue Property="Title" String="Total Sales"/>
      <PropertyValue Property="CriticalityCalculation">
        <Record Type="com.sap.vocabularies.UI.v1.CriticalityCalculationType">
          <!-- Use ImprovingDirection when higher values are better (Maximize) or lower are better (Minimize) -->
          <PropertyValue Property="ImprovingDirection" EnumMember="com.sap.vocabularies.UI.v1.ImprovingDirectionType/Maximize"/>
          <PropertyValue Property="CriticalityConditions">
            <Collection>
              <!-- Positive when Amount > 100000 -->
              <Record Type="com.sap.vocabularies.UI.v1.CriticalityCondition">
                <PropertyValue Property="Operator" EnumMember="com.sap.vocabularies.UI.v1.ComparisonOperatorType/GT"/>
                <PropertyValue Property="Value" Int="100000"/>
                <PropertyValue Property="Result" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Positive"/>
              </Record>

              <!-- Critical when 50000 <= Amount <= 100000 -->
              <Record Type="com.sap.vocabularies.UI.v1.CriticalityCondition">
                <PropertyValue Property="Operator" EnumMember="com.sap.vocabularies.UI.v1.ComparisonOperatorType/BT"/>
                <PropertyValue Property="Value" Int="50000"/>
                <PropertyValue Property="Value2" Int="100000"/>
                <PropertyValue Property="Result" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Critical"/>
              </Record>

              <!-- Default: Negative -->
              <Record Type="com.sap.vocabularies.UI.v1.CriticalityCondition">
                <PropertyValue Property="Result" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Negative"/>
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: CDS

**CODE**:
```cds
// CDS-style pseudocode for CriticalityCalculation (ABAP CDS or equivalent)
// Adjust to the exact annotation syntax of your CDS flavor (ABAP vs CAP)
@UI.dataPoint: {
  value: 'Amount',
  title: 'Total Sales',
  criticalityCalculation: {
    improvingDirection: #Maximize,
    criticalityConditions: [
      { operator: #GT, value: 100000, result: #Positive },
      { operator: #BT, value: 50000, value2: 100000, result: #Critical },
      { result: #Negative }
    ]
  }
}
entity MyEntityAnnotated as projection on MyEntity;
```

**STEP**: 3 — Placement and usage notes

**DESCRIPTION**: Where to put annotations and what to verify:
- OData (annotations.xml) approach: include the DataPoint annotation under the targeted property or entity in your service annotations file and register it in the manifest/ui5 configuration where needed.
- CDS approach: add the @UI.dataPoint / @UI.DataPoint block in your CDS file or in an annotation extension; ensure the vocabulary com.sap.vocabularies.UI.v1 is available.
- Values in CriticalityCalculation use the enum types from com.sap.vocabularies.UI.v1 (CriticalityType, ImprovingDirectionType, ComparisonOperatorType).
- Test in your Fiori elements app to confirm color/visual indication (positive/negative/critical) appears for the numeric value.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "note": "Use the XML or CDS patterns above. In manifest.json, ensure annotation files are referenced under 'sap.ui5': { 'models': { '': { 'dataSource': { /* register OData & annotation files */ } } } }"
}
```
--------------------------------

**TITLE**: Create and Extend an SAP Fiori Elements App (Practical Code Examples)

**INTRODUCTION**: Practical, code-focused guidance for creating a SAP Fiori elements app: configure OData data sources, add UI annotations, scaffold and run the app with UI5 tooling, and implement a simple extension point. Use these snippets directly in your webapp manifest, annotation files, ui5.yaml and controller code.

**TAGS**: fiori-elements-framework, sap, fiori, odata, annotations, sap-fiori-tools, ui5, manifest.json, ui5.yaml

**STEP**: 1 — Configure OData service and annotation files in manifest.json

**DESCRIPTION**: Add your OData service and annotation file entries to webapp/manifest.json. This example shows how to declare the main OData service and a local annotation file (localUri). Adjust service URI, odataVersion and localUri to match your backend and annotation file path (webapp/annotations/annotations.xml).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "my.fiori.app",
    "applicationVersion": { "version": "1.0.0" }
  },
  "sap.applications": {},
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      },
      "annotations": {
        "dataSource": "annotations"
      }
    }
  },
  "sap.app": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/Z_MY_SERVICE_SRV/",
        "type": "OData",
        "settings": {
          "odataVersion": "2.0"
        }
      },
      "annotations": {
        "uri": "annotations/annotations.xml",
        "type": "ODataAnnotation",
        "settings": {
          "localUri": "annotations/annotations.xml"
        }
      }
    }
  }
}
```

**STEP**: 2 — Create a UI annotation file (annotations/annotations.xml)

**DESCRIPTION**: Provide UI annotations to enable or modify default features for Fiori elements (List Report / Object Page). This example shows common UI.v1 annotations: a LineItem (table columns) and FieldGroup (object page section). Save as webapp/annotations/annotations.xml and reference it from manifest.json (see Step 1).

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="http://docs.oasis-open.org/odata/ns/edm">
    <edmx:Include Namespace="Org.OData.Core.V1" Alias="Core"/>
  </edmx:Reference>

  <edmx:DataServices>
    <Schema Namespace="Z_MY_SERVICE" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <Annotations Target="Z_MY_SERVICE.MyEntityType">
        <Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
          <Collection>
            <Record Type="com.sap.vocabularies.UI.v1.DataField">
              <PropertyValue Property="Value">
                <Path>PropertyA</Path>
              </PropertyValue>
              <PropertyValue Property="Label" String="Property A"/>
            </Record>
            <Record Type="com.sap.vocabularies.UI.v1.DataField">
              <PropertyValue Property="Value">
                <Path>PropertyB</Path>
              </PropertyValue>
              <PropertyValue Property="Label" String="Property B"/>
            </Record>
          </Collection>
        </Annotation>

        <Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup">
          <Record>
            <PropertyValue Property="Data" >
              <Collection>
                <Record Type="com.sap.vocabularies.UI.v1.DataField">
                  <PropertyValue Property="Value"><Path>PropertyA</Path></PropertyValue>
                  <PropertyValue Property="Label" String="Property A"/>
                </Record>
                <Record Type="com.sap.vocabularies.UI.v1.DataField">
                  <PropertyValue Property="Value"><Path>PropertyB</Path></PropertyValue>
                  <PropertyValue Property="Label" String="Property B"/>
                </Record>
              </Collection>
            </PropertyValue>
          </Record>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 3 — Scaffold and run the app with UI5 tooling (ui5.yaml and package.json)

**DESCRIPTION**: Use UI5 Tooling locally or SAP Fiori tools in VS Code. Add ui5.yaml and basic package.json scripts to run a local dev server. This example assumes the app sources live under webapp/.

**LANGUAGE**: YAML

**CODE**:
```yaml
# ui5.yaml (place at project root)
specVersion: '2.2'
metadata:
  name: my.fiori.app
type: application
resources:
  configuration:
    paths:
      webapp: webapp
```

**LANGUAGE**: JSON

**CODE**:
```json
{
  "name": "my-fiori-elements-app",
  "version": "1.0.0",
  "scripts": {
    "start": "ui5 serve --config=ui5.yaml --open /index.html",
    "build": "ui5 build --clean"
  },
  "devDependencies": {
    "@ui5/cli": "^2.14.0"
  }
}
```

- To scaffold using the Yeoman generator (optional command-line approach):
  - Run: npx @sap/generator-fiori (follow prompts to generate a Fiori elements app)
  - Or use SAP Business Application Studio / VS Code with SAP Fiori tools extension to create a Fiori elements project.

**STEP**: 4 — Implement a simple controller extension for a List Report

**DESCRIPTION**: Extend a standard Fiori elements view by registering a controller extension in manifest.json and adding the controller implementation file. This pattern uses sap.ui.controllerExtensions to point to your custom controller that can add event handlers or lifecycle methods.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "my.fiori.app.ext.ListReportExt"
          }
        }
      }
    }
  }
}
```

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/extension/ListReportExt.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("my.fiori.app.ext.ListReportExt", {
    onInit: function () {
      // Initialization code for extended List Report
      // Example: attach to selection change or modify smart filter bar
      var oView = this.getView();
      // Custom logic here
      // console.log("ListReport extension initialized");
    },

    onCustomAction: function (oEvent) {
      // Custom event handler invoked from UI (e.g. custom action)
      var oSelectedContexts = oEvent.getParameter && oEvent.getParameter("selectedContexts");
      // Implement custom behavior
    }
  });
});
```

**STEP**: 5 — References and next actions

**DESCRIPTION**: Use the following links (placeholders in documentation) to dive deeper:
- Prerequisites for Using SAP Fiori Elements: see your workspace docs or internal link prerequisites-for-using-sap-fiori-elements-f2344b5.md
- Working With UI Annotations: see working-with-ui-annotations-83c89cc.md
- Extending SAP Fiori Elements-Based Apps: see extending-sap-fiori-elements-based-apps-358cf25.md

Use the code snippets above as direct file contents or templates:
- webapp/manifest.json: update dataSources and sap.ui5 models and controller extension mapping
- webapp/annotations/annotations.xml: UI annotation definitions
- ui5.yaml and package.json: local dev server and build
- webapp/extension/ListReportExt.controller.js: controller extension implementation
--------------------------------

**TITLE**: Configure Hybrid View (Chart + Table) for ALP in SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: Enable and configure the Hybrid View (chart + table combined) in the Analytical List Page (ALP). This document provides concise, copy-paste-ready manifest/settings snippets and actionable constraints to implement hybrid mode and ensure correct chart↔table interactions (highlights, filtering, auto-hide).

**TAGS**: fiori-elements-framework, analytical-list-page, hybrid-view, ALP, chart, table, manifest, ODataV2, ODataV4, configuration

STEP: Enable hybrid view for OData V2

DESCRIPTION: Add the ALP setting to load the default content view as a combined chart + table. Place this snippet in your application manifest settings section where ALP settings are defined (manifest.json — the ALP settings object). This enables the initial view to show chart and table together.

LANGUAGE: JSON

CODE:
```json
"settings": {
  "defaultContentView": "charttable"
}
```

STEP: Enable hybrid view for OData V4

DESCRIPTION: Set the defaultPath for ALP views to "both" in the manifest. Insert the entries shown into the manifest location that configures ALP views (manifest.json — the ALP views.paths[] entry). This ensures the initial rendering shows the chart above and the table below.

LANGUAGE: JSON

CODE:
```json
"views": {
  "paths": [{
    ...
    "defaultPath": "both"
  }]
}
```

STEP: Ensure chart context dimensions are visible columns in the table

DESCRIPTION: For highlights and accurate mapping between chart selection and table records, add the chart context dimensions as visible columns in the table annotation/UI configuration. This makes highlights and filtered selections in the chart correctly reflect in the table.

LANGUAGE: JSON / Annotation (conceptual)

CODE:
```json
// Example: ensure these dimension properties are included in the UI.LineItem (table)
"UI.LineItem": [
  { "RecordType": "UI.DataField", "Label": "Country", "Value": "{Country}" },
  { "RecordType": "UI.DataField", "Label": "Product", "Value": "{Product}" },
  // include all chart context dimension properties here
]
```

STEP: Configure and understand Auto-hide behavior

DESCRIPTION: The hybrid view supports an auto-hide feature that determines whether non-selected (non-highlighted) table records are shown. When auto-hide is OFF: chart selection highlights matching records but keeps non-matching records visible. When auto-hide is ON: chart selection acts as an additional filter and only records affected by the chart selection are displayed.

LANGUAGE: Notes / Behavior

CODE:
```text
Behavior:
- auto-hide = OFF  => highlights matching records; non-matching records remain visible
- auto-hide = ON   => chart selection behaves as a filter; only matching records displayed
```

STEP: Device and resolution constraints

DESCRIPTION: Hybrid view is primarily intended for large screens. Apply these constraints in UI/feature gating logic or document them for product behavior:

- Hybrid mode is not available on tablets or smartphones.
- Hybrid view is available on laptops with screen height > 900px.
- Hybrid view is disabled for analytical and grid table types when in cozy mode AND screen height < 900px.
- Responsive tables are exempt from the above restriction (responsive tables may still show hybrid view).

LANGUAGE: Notes / Behavior

CODE:
```text
Constraints:
- Not available: tablets, smartphones
- Available: laptops with screen height > 900px
- Disabled: analytical & grid tables in cozy mode when height < 900px
- Exception: responsive tables are NOT subject to the cozy-mode <900px restriction
```

STEP: Related configuration reference

DESCRIPTION: Use the Content Area / descriptor configuration to define UI.Chart and UI.LineItem annotations and navigation. See the related documentation file for more details and examples.

LANGUAGE: Reference

CODE:
```text
Related docs:
- Configuring the Content Area: configuring-the-content-area-fc7d73c.md
  (Describes: UI.Chart, UI.LineItem annotations and descriptor configuration for ALP)
```
--------------------------------

**TITLE**: Illustrated Message and No-Data Handling for SAP Fiori Elements (OData V4)

**INTRODUCTION**: Configure how Fiori Elements displays no-data states for tables (illustrated message vs text) and add custom actions to illustrated messages using the beforeRebindTable extension point. Includes manifest configuration and a controller extension example that builds and applies an sap.m.IllustratedMessage to a table.

**TAGS**: fiori-elements-framework, odata-v4, manifest.json, ui5, illustrated-message, no-data, beforeRebindTable, controller-extension

**STEP**: Enable text instead of illustrated message on Object Page

**DESCRIPTION**: Set the page-level manifest option useTextForNoDataMessages to true to force a plain text no-data message (instead of an illustrated message) for all tables on that page. Place this under the page (Component/targets) settings for the Object Page. When this option is used, override default texts in your app i18n (see Maintaining Standard Texts for Tables).

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (component/target page settings)
{
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "contextPath": "/SalesOrderManage",
        "enhanceI18n": "i18n/SalesOrderObjectPage.properties",
        "variantManagement": "Control",
        "showRelatedApps": true,
        "sectionLayout": "Tabs",
        "useTextForNoDataMessages": true,
        "controlConfiguration": {
          ...
        }
      }
    }
  }
}
```

**STEP**: Wire the beforeRebindTable extension point in manifest

**DESCRIPTION**: Add a beforeRebindTable hook for the specific LineItem table in controlConfiguration. This instructs Fiori Elements to call your extension function before the table is rebound so you can inspect filters/search and set a custom no-data control.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (targets -> page target)
{
  "targets": {
    "sample": {
      "type": "Component",
      "id": "Default",
      "name": "sap.fe.templates.ObjectPage",
      "viewLevel": 1,
      "options": {
        "settings": {
          "contextPath": "/RootEntity",
          "editableHeaderContent": false,
          "variantManagement": "Control",
          "controlConfiguration": {
            "_Child/@com.sap.vocabularies.UI.v1.LineItem": {
              "tableSettings": {
                "beforeRebindTable": ".extension.sap.fe.core.fpmExplorer.OPExtend.onTableRefresh"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Implement the controller extension that creates and applies an IllustratedMessage

**DESCRIPTION**: Create a controller extension module named sap.fe.core.fpmExplorer.OPExtend that implements onTableRefresh(event). The event provides collectionBindingInfo API; inspect filters and $search to determine UI state. Build an sap.m.IllustratedMessage, add Buttons (or other additionalContent), and apply it to the table using table.setNoData(illustratedMessage). The sample below uses MessageToast for demo actions and sets illustration type/size. Adjust table id, message text, and actions to match your app.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// sap.fe.core.fpmExplorer.OPExtend.js
sap.ui.define(
  [
    "sap/ui/core/mvc/ControllerExtension",
    "sap/ui/model/Filter",
    "sap/ui/model/FilterOperator",
    "sap/m/IllustratedMessage",
    "sap/m/IllustratedMessageType",
    "sap/m/Button",
    "sap/m/MessageToast",
    "sap/m/IllustratedMessageSize"
  ],
  function (
    ControllerExtension,
    Filter,
    FilterOperator,
    IllustratedMessage,
    IllustratedMessageType,
    Button,
    MessageToast,
    IllustratedMessageSize
  ) {
    "use strict";

    return ControllerExtension.extend("sap.fe.core.fpmExplorer.OPExtend", {
      onTableRefresh: function (event) {
        var collectionBindingInfoAPI = event.getParameter("collectionBindingInfo");
        // Update this ID to your table's control ID if different
        var table = this.getView().byId("fe::table::_Child::LineItem::Table");
        var illustratedMessage = new IllustratedMessage();

        var showDialogNoData = function () {
          return MessageToast.show("Action when No Data in edit mode");
        };
        var showDialogFilterSearch = function () {
          return MessageToast.show("Action when No Data with filter or search");
        };

        // Detect filters or search applied
        var hasFilters =
          collectionBindingInfoAPI.getFilters &&
          collectionBindingInfoAPI.getFilters().aFilters &&
          collectionBindingInfoAPI.getFilters().aFilters.length > 0;
        var hasSearch = collectionBindingInfoAPI.collectionBindingInfo &&
                        collectionBindingInfoAPI.collectionBindingInfo.parameters &&
                        collectionBindingInfoAPI.collectionBindingInfo.parameters.$search;

        if (hasFilters || hasSearch) {
          illustratedMessage.setTitle("No Data");
          illustratedMessage.setDescription("Change Search or filter criteria.");
          illustratedMessage.setIllustrationType(IllustratedMessageType.NoSearchResults);
          illustratedMessage.setIllustrationSize(IllustratedMessageSize.Dot);
          illustratedMessage.addAdditionalContent(new Button({ text: "My Action", press: showDialogFilterSearch }));
          table.setNoData(illustratedMessage);
        } else {
          // No filter or search and table in edit mode
          illustratedMessage.setTitle("No Item found");
          illustratedMessage.setDescription("Please create some.");
          illustratedMessage.setIllustrationType(IllustratedMessageType.NoSearchResults);
          illustratedMessage.setIllustrationSize(IllustratedMessageSize.Dot);
          illustratedMessage.addAdditionalContent(
            new Button({ text: "Create New Item", visible: "{ui>/isEditable}", press: showDialogNoData })
          );
          table.setNoData(illustratedMessage);
        }
      }
    });
  }
);
```

**STEP**: Notes and follow-ups

**DESCRIPTION**: 
- The manifest useTextForNoDataMessages option applies to all tables within that page/component.
- If you enable useTextForNoDataMessages, override default no-data texts in your i18n resource (example: i18n/SalesOrderObjectPage.properties).
- The beforeRebindTable extension is invoked before the table binding is refreshed — use collectionBindingInfo API to inspect filters and search parameters.
- Example live demo: Building Blocks - Table - Table No Data in the flexible programming model explorer (UI5 test resources).
--------------------------------

**TITLE**: In/Out Mappings in Common.ValueList Annotation (SAP Fiori elements, OData V2)

**INTRODUCTION**: This guide provides concise, code-focused examples and templates for adding Common.ValueList annotations with In/Out parameter mappings. Use these mappings to link filter fields of a main entity to properties of a value-help (value list) entity so that (a) the value help content can be filtered by main-entity values (In), and (b) the selected value from the value help is written back as the main-entity property name (Out). Note: In/Out mappings in OData V2 are supported only for Analytical List Page.

**TAGS**: fiori-elements-framework, odata-v2, valuehelp, valueList, annotations, xml, abap-cds, cap-cds

STEP: ValueList annotation structure (properties & parameter types)

DESCRIPTION: Use this XML skeleton to define ValueList annotations. Important properties: Label (optional), CollectionPath (required, target entity set), SearchSupported (Bool), and Parameters (collection of Common.ValueListParameterIn / Out / InOut records). Each parameter record must set LocalDataProperty (main entity property) and ValueListProperty (property in the value-help entity).

LANGUAGE: XML

CODE:
```xml
<!-- ValueList skeleton for a target property -->
<Annotations Target="<<YourServiceNamespace.Type/PropertyName>>">
  <Annotation Term="Common.ValueList" Qualifier="QualifierName">
    <Record>
      <PropertyValue Property="Label" String="LabelText"/>
      <PropertyValue Property="CollectionPath" String="TargetEntitySet"/>
      <PropertyValue Property="SearchSupported" Bool="true|false"/>
      <PropertyValue Property="Parameters">
        <Collection>
          <!-- OUT parameter: selected value from value list maps to LocalDataProperty -->
          <Record Type="Common.ValueListParameterOut">
            <PropertyValue Property="LocalDataProperty" PropertyPath="LocalProperty"/>
            <PropertyValue Property="ValueListProperty" String="ValueListPropertyName"/>
          </Record>
          <!-- IN parameter: LocalDataProperty filters records in the value-help entity -->
          <Record Type="Common.ValueListParameterIn">
            <PropertyValue Property="LocalDataProperty" PropertyPath="LocalProperty"/>
            <PropertyValue Property="ValueListProperty" String="ValueListPropertyName"/>
          </Record>
          <!-- INOUT combines both behaviors -->
          <Record Type="Common.ValueListParameterInOut">
            <PropertyValue Property="LocalDataProperty" PropertyPath="LocalProperty"/>
            <PropertyValue Property="ValueListProperty" String="ValueListPropertyName"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Specify selection fields (examples for xml / ABAP CDS / CAP CDS)

DESCRIPTION: Define the selection (filter) fields in the main entity. These selection fields are the candidates for ValueList annotations.

LANGUAGE: XML

CODE:
```xml
<!-- XML SelectionFields on an entity -->
<Annotation Term="UI.SelectionFields">
  <Collection>
    <PropertyPath>RegionID</PropertyPath>
    <PropertyPath>CountryID</PropertyPath>
    <PropertyPath>PlantID</PropertyPath>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.selectionField: [{ position: 1, element: 'REGIONID' }]
REGIONID;

@UI.selectionField: [{ position: 2, element: 'COUNTRYID' }]
COUNTRYID;

@UI.selectionField: [{ position: 3, element: 'PLANTID' }]
PLANTID;
```

LANGUAGE: CDS

CODE:
```cds
// CAP CDS: Selection fields
UI.SelectionFields : [
  RegionID,
  CountryID,
  PlantID
];
```

STEP: Concrete example — CountryID ValueList (XML)

DESCRIPTION: Add a ValueList annotation on Z0020.CDS Z0020Type/CountryID to fetch values from entity set Z0022. Use an OUT parameter to map CountryIdentifier -> CountryID (so selected value writes to CountryID) and an IN parameter to filter Country value help by RegionID via RegionIdentifier. Set SearchSupported to false.

LANGUAGE: XML

CODE:
```xml
<Annotations Target="Z0020_CDS.Z0020Type/CountryID">
  <Annotation Term="Common.ValueList" Qualifier="0020_Country">
    <Record>
      <PropertyValue Property="Label" String="Country"/>
      <PropertyValue Property="CollectionPath" String="Z0022"/>
      <PropertyValue Bool="false" Property="SearchSupported"/>
      <PropertyValue Property="Parameters">
        <Collection>
          <Record Type="Common.ValueListParameterOut">
            <PropertyValue Property="LocalDataProperty" PropertyPath="CountryID"/>
            <PropertyValue Property="ValueListProperty" String="CountryIdentifier"/>
          </Record>
          <Record Type="Common.ValueListParameterIn">
            <PropertyValue Property="LocalDataProperty" PropertyPath="RegionID"/>
            <PropertyValue Property="ValueListProperty" String="RegionIdentifier"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: CountryID ValueList — ABAP CDS equivalent

DESCRIPTION: Define a consumption value help in ABAP CDS using additionalBinding array: usage #RESULT -> Out, usage #FILTER -> In.

LANGUAGE: ABAP CDS

CODE:
```abap
@Consumption.valueHelpDefinition: [{
  entity: { name: 'Z0022' },
  label: 'Country',
  additionalBinding: [
    {
      localElement: 'CountryID',
      element: 'CountryIdentifier',
      usage: #RESULT         // Common.ValueListParameterOut
    },
    {
      localElement: 'RegionID',
      element: 'RegionIdentifier',
      usage: #FILTER         // Common.ValueListParameterIn
    }
  ]
}]
CountryID;
```

STEP: CountryID ValueList — CAP CDS equivalent

DESCRIPTION: CAP CDS annotation example: ValueList qualifier with Parameters array using $Type to denote In/Out record types.

LANGUAGE: CDS

CODE:
```cds
CountryID : UUID @( Common : {
  ValueList #0020_Country : {
    Label : 'Country',
    CollectionPath : 'Z0022',
    Parameters : [
      {
        $Type : 'Common.ValueListParameterOut',
        LocalDataProperty : CountryID,
        ValueListProperty : 'CountryIdentifier'
      },
      {
        $Type : 'Common.ValueListParameterIn',
        LocalDataProperty : RegionID,
        ValueListProperty : 'RegionIdentifier'
      }
    ]
  }
});
```

STEP: PlantID ValueList mapping (XML)

DESCRIPTION: Example ValueList on PlantID fetching from Z0023. OUT maps PlantNumber -> PlantID. IN parameters filter by RegionID -> RegionNumber and CountryID -> CountryNumber so the Plant value help is filtered by the selected region and/or country.

LANGUAGE: XML

CODE:
```xml
<Annotations Target="Z0020_CDS.Z0020Type/PlantID">
  <Annotation Term="Common.ValueList" Qualifier="0020_Plant">
    <Record>
      <PropertyValue Property="Label" String="Plant"/>
      <PropertyValue Property="CollectionPath" String="Z0023"/>
      <PropertyValue Bool="false" Property="SearchSupported"/>
      <PropertyValue Property="Parameters">
        <Collection>
          <Record Type="Common.ValueListParameterOut">
            <PropertyValue Property="LocalDataProperty" PropertyPath="PlantID"/>
            <PropertyValue Property="ValueListProperty" String="PlantNumber"/>
          </Record>
          <Record Type="Common.ValueListParameterIn">
            <PropertyValue Property="LocalDataProperty" PropertyPath="RegionID"/>
            <PropertyValue Property="ValueListProperty" String="RegionNumber"/>
          </Record>
          <Record Type="Common.ValueListParameterIn">
            <PropertyValue Property="LocalDataProperty" PropertyPath="CountryID"/>
            <PropertyValue Property="ValueListProperty" String="CountryNumber"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Runtime behavior examples and important notes

DESCRIPTION: Concrete behavior rules you should enforce or test:

- OUT mapping: When a user selects a value from the value help, the selected property is taken from ValueListProperty but applied to the main entity filter under LocalDataProperty.
  - Example: selecting CountryIdentifier = "001" yields filter: $filter=CountryID="001" (NOT CountryIdentifier="001").

- IN mapping: If LocalDataProperty already has a value in the filter (e.g., RegionID="ABC"), the value help fetch for another field (e.g., Country) will be filtered by ValueListProperty = "ABC".
  - Example: RegionID="ABC" => Country value help shows only rows with RegionIdentifier="ABC".

- Visibility constraint (tip): Out parameters are applied only if the target LocalDataProperty is visible in the filter bar.

- OData V2 limitation: In/Out mappings are supported only for Analytical List Page in Fiori elements (OData V2).

LANGUAGE: text

CODE:
```
Behavior examples:
1) Out mapping:
   ValueListProperty: CountryIdentifier = "001"
   LocalDataProperty: CountryID
   Resulting filter applied to main entity: $filter=CountryID="001"

2) In mapping:
   Main filter: RegionID="ABC"
   ValueList IN parameter: ValueListProperty = RegionIdentifier
   Country value help query is restricted: $filter=RegionIdentifier="ABC"

Important:
- Ensure LocalDataProperty is present/visible in filter bar for OUT to be applied.
- Test on Analytical List Page for OData V2.
```
--------------------------------

**TITLE**: Embed Reuse Components into an Object Page (Fiori Elements)

**INTRODUCTION**: This guide shows how to embed reuse components as sections on an Object Page for SAP Fiori elements apps (OData V2 and V4). It includes manifest.json examples, binding and settings patterns, default-visibility control, dependency declarations, and placement notes — all optimized for code generation.

**TAGS**: fiori-elements, reuse-component, manifest.json, object-page, ODataV2, ODataV4, sap.ui5, embeddedComponents

STEP: 1 — When to use reuse components
DESCRIPTION: Use a reuse component when you need a rectangular, encapsulated UI area that is reused across apps (eg. attachments, output management). If a UI is used only once or is a small extension, prefer view/fragment extensions instead.
LANGUAGE: text
CODE:
```
- Reuse components are rectangular UI areas embedded via manifest.json.
- They inherit the Object Page binding context unless you override it with the "binding" property.
- Use title property with an i18n key for translatable titles.
- Choose between:
  1) Referencing a component usage (componentUsage / componentName in sap.ui.generic.app pages for V2)
  2) Addressing the component directly (embeddedComponent.name in V4 / routing targets)
```

STEP: 2 — OData V2: Basic manifest.json embedding (sap.ui.generic.app/pages -> embeddedComponents)
DESCRIPTION: Add reuse component instances under the ObjectPage definition in "sap.ui.generic.app" -> "pages" -> "ObjectPage|YourEntity" -> "embeddedComponents". Each entry must have a property name equal to its "id".
LANGUAGE: JSON
CODE:
```json
// manifest.json (fragment)
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|myRootEntity": {
        "entitySet": "myRootEntity",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": {
          "ObjectPage|myRootEntity": {
            "entitySet": "myRootEntity",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage"
            },
            "embeddedComponents": {
              "myFirstComponentEmbedding": {
                "id": "myFirstComponentEmbedding",
                "componentUsage": "myUsage",
                "title": "{{I18N_KEY_FOR_FIRST_REUSE_COMPONENT_TITLE}}",
                "settings": {
                  "documentNumber": "{documentNumber}"
                }
              },
              "mySecondComponentEmbedding": {
                "id": "mySecondComponentEmbedding",
                "componentName": "theOtherReuseComponentQualifiedName",
                "title": "{{I18N_KEY_FOR_SECOND_REUSE_COMPONENT_TITLE}}",
                "binding": "myNavProperty"
              }
            },
            "pages": {
              // sub-pages ...
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — V2: Binding context and settings patterns
DESCRIPTION: The reuse component inherits the Object Page binding context by default. Override or narrow it with the "binding" property (path relative to the page context). Pass component-specific properties via "settings". Settings values can be binding strings (simple or expression).
LANGUAGE: JSON
CODE:
```json
// settings examples (fragment)
{
  "myFirstComponentEmbedding": {
    "settings": {
      "documentNumber": "{documentNumber}"                         // simple binding
    }
  },
  "mySecondComponentEmbedding": {
    "binding": "myNavProperty"                                    // relative path from page context
  },
  "myThirdComponentEmbedding": {
    "settings": {
      "documentNumber": "{= ${documentNumber} || ${documentId} }"  // expression binding
    }
  }
}
```

STEP: 4 — V2: Default visibility (hiddenByDefault + runtime API)
DESCRIPTION: Control initial visibility with the "hiddenByDefault" boolean (set on the same level as id/title/settings). The reuse component implementation can call extensionAPI.setSectionHidden(false/true) at runtime to unhide or hide per-object.
LANGUAGE: JSON
CODE:
```json
// manifest fragment: set default hidden
{
  "embeddedComponents": {
    "myConditionalEmbedding": {
      "id": "myConditionalEmbedding",
      "title": "{{I18N_KEY}}",
      "hiddenByDefault": true,
      "settings": { /* ... */ }
    }
  }
}
```

STEP: 5 — Declare reuse component service dependencies
DESCRIPTION: If the reuse component requires its own OData service, declare that dependency in both "sap.ui5"/"dependencies"/"libs" and in "sap.ui5"/"dependencies"/"component".
LANGUAGE: JSON
CODE:
```json
// manifest.json (fragment)
{
  "sap.ui5": {
    "dependencies": {
      "libs": {
        "sap.ui.core": {},
        "sap.m": {}
        // Add required libraries of the reuse component here
      },
      "components": {
        "path.to.reuseComponent": {}
        // Also declare the reuse component itself if needed
      }
    }
  }
}
```

STEP: 6 — Placement and order of sections on Object Page
DESCRIPTION: By default, embedded component sections are appended to the page in the order they appear in the manifest. You can reorder sections with the Adaptation Editor or use placement settings (V4 example shows explicit placement).
LANGUAGE: text
CODE:
```
- Default order = declaration order in manifest.
- Use Adaptation Editor to move sections visually.
- For programmatic placement, use V4 "position": { "placement": "After|Before", "anchor": "<sectionId>" } or the V4 targets-controlId approach.
```

STEP: 7 — OData V4: Preferred manifest.json embedding (routing -> targets -> options -> settings -> content.body.sections)
DESCRIPTION: For V4 Object Pages, embed reuse components as a section in the target's options.settings.content.body.sections. Provide "embeddedComponent.name" and "settings" there. Use "position" to anchor placement relative to other sections.
LANGUAGE: JSON
CODE:
```json
// manifest.json (OData V4 preferred fragment)
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": "myEntitySet({key}):?query:",
          "name": "myObjectPage",
          "target": "myObjectPage"
        }
      ],
      "targets": {
        "myObjectPage": {
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "customSectionReuse": {
                      "title": "{i18n>customSectionReuse}",
                      "embeddedComponent": {
                        "name": "path.to.reuseComponent",
                        "settings": {
                          "exampleSettings": "{somePropertyName}"
                        }
                      },
                      "position": {
                        "placement": "After",
                        "anchor": "someOtherSection"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 8 — OData V4: Alternate targets-based embedding (component target as a child)
DESCRIPTION: Alternative V4 approach: declare the ObjectPage target and a second Component target for the reuse component. Use "parent", "controlId", "controlAggregation", and "clearControlAggregation" to place the component into a section.
LANGUAGE: JSON
CODE:
```json
// manifest.json (OData V4 alternative fragment)
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": "myEntitySet({key}):?query:",
          "name": "myObjectPage",
          "target": ["myObjectPage", "ReuseComponent"]
        }
      ],
      "targets": {
        "myObjectPage": {
          "type": "Component",
          "id": "myObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "ReuseComponentContainer": {
                      "position": {
                        "placement": "Before",
                        "anchor": "GeneralInfo"
                      },
                      "title": "Reuse Container",
                      "subSections": {
                        "ReuseContainer": {
                          "id": "ReuseComponentContainer"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "ReuseComponent": {
          "type": "Component",
          "id": "Reuse",
          "name": "path.to.reuseComponent",
          "options": {
            "settings": {
              "exampleSettings": "{somePropertyName}"
            }
          },
          "parent": "myObjectPage",
          "controlId": "ReuseComponentContainer",
          "controlAggregation": "blocks",
          "clearControlAggregation": true
        }
      }
    }
  }
}
```

STEP: 9 — V4: Default visibility using SAPUI5 standard binding
DESCRIPTION: In V4, control visibility via standard SAPUI5 binding expressions on the reuse component container/section. Use expression binding to test the relevant property(s).
LANGUAGE: JSON
CODE:
```json
// manifest.json (V4 visibility example)
{
  "customSectionReuse": {
    "title": "{i18n>customSectionReuse}",
    "embeddedComponent": {
      "name": "path.to.reuseComponent",
      "settings": {
        "exampleSettings": "{somePropertyName}"
      }
    },
    "visible": "{= !!${SalesOrder} }"   // visible when SalesOrder has a value
  }
}
```

STEP: 10 — Implementation notes and rules
DESCRIPTION: Preserve these technical rules when generating code or scaffolding:
LANGUAGE: text
CODE:
```
- For V2 embeddedComponents: the object property name (key) and the "id" value MUST be identical.
- Use "componentUsage" (usage alias) or "componentName" (fully qualified component name) in V2.
- The embedding inherits the Object Page binding context unless "binding" overrides with a relative path.
- Settings accept binding strings or expression bindings.
- hiddenByDefault (V2) controls default hidden state; use extensionAPI.setSectionHidden(...) in the reuse component to change visibility at runtime.
- Declare any reuse component OData/service/library dependencies under sap.ui5.dependencies.libs and sap.ui5.dependencies.components.
- V4 reuse components for Fiori elements are compatible with standard SAPUI5 freestyle components; V2 reuse components are not compatible with freestyle apps.
```

--------------------------------

**TITLE**: Dynamically Influence Table OData Requests with beforeRebindTable (Fiori Elements OData V4)

**INTRODUCTION**: Use the beforeRebindTable extension to read and modify a table's collection binding before it issues an OData V4 request. You can inspect existing sorters/filters/selects, add new filters/sorters, and request additional properties (selects) programmatically.

**TAGS**: fiori-elements, odata-v4, beforeRebindTable, table, controller-extension, manifest.json, ui5

**STEP**: 1 — Enable the beforeRebindTable handler in controlConfiguration

**DESCRIPTION**: Add the beforeRebindTable entry to the table control configuration in manifest.json. Provide the extension path to the handler function in your controller extension. This registers the callback that will be invoked before the table binding is re-evaluated.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (fragment showing controlConfiguration for the LineItem table)
{
  "controlConfiguration": {
    "_Child/@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "beforeRebindTable": ".extension.sap.fe.core.fpmExplorer.OPExtend.onTableRefresh"
      }
    }
  }
}
```

**STEP**: 2 — Register the controller extension in sap.ui5 extends

**DESCRIPTION**: Declare your controller extension class name under sap.ui5 -> extends -> extensions -> sap.ui.controllerExtensions so the framework knows which controller extension provides onTableRefresh.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (fragment showing controller extension registration)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ObjectPage.ObjectPageController": {
            "controllerName": "sap.fe.core.fpmExplorer.OPExtend"
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Implement the controller extension and the onTableRefresh handler

**DESCRIPTION**: Create a UI5 ControllerExtension module with the declared name. Implement onTableRefresh(event), obtain the CollectionBindingInfo API from the event, then call addFilter, addSorter and addSelect on that API. Ensure you import ControllerExtension, Filter, FilterOperator and Sorter. The example below:
- Adds a filter BooleanProperty EQ false
- Adds a sorter on ID descending
- Requests the TagStatus property in the $select

Place the module file in your project path that maps to the module name (e.g., webapp/extension/sap/fe/core/fpmExplorer/OPExtend.js) and ensure the module name matches "sap.fe.core.fpmExplorer.OPExtend".

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/extension/sap/fe/core/fpmExplorer/OPExtend.js
sap.ui.define(
  [
    "sap/ui/core/mvc/ControllerExtension",
    "sap/ui/model/Filter",
    "sap/ui/model/FilterOperator",
    "sap/ui/model/Sorter"
  ],
  function (ControllerExtension, Filter, FilterOperator, Sorter) {
    "use strict";

    return ControllerExtension.extend("sap.fe.core.fpmExplorer.OPExtend", {
      /**
       * Called before the table binding is re-applied.
       * @param {sap.ui.base.Event} event Event containing the collection binding info API
       */
      onTableRefresh: function (event) {
        // Retrieve the CollectionBindingInfo API from the event.
        // Use getParameter("collectionBindingInfo") which returns the API object.
        var collectionBindingInfoAPI = event.getParameter("collectionBindingInfo");

        if (!collectionBindingInfoAPI) {
          return;
        }

        // 1) Add a filter: BooleanProperty EQ false
        var filter = new Filter({
          path: "BooleanProperty",
          operator: FilterOperator.EQ,
          value1: false
        });
        collectionBindingInfoAPI.addFilter(filter);

        // 2) Add a sorter: ID descending (true indicates descending in sap.ui.model.Sorter constructor)
        var sorter = new Sorter("ID", true);
        collectionBindingInfoAPI.addSorter(sorter);

        // 3) Request additional properties in the $select (adds TagStatus to the request)
        collectionBindingInfoAPI.addSelect(["TagStatus"]);
      }
    });
  }
);
```

**STEP**: 4 — Test and verify in the Flexible Programming Model Explorer (examples)

**DESCRIPTION**: Use the FPM explorer examples to validate behavior and reference patterns for table extensibility and custom columns/actions.

**LANGUAGE**: JSON

**CODE**:
```json
// Useful example URLs to test and refer to
// - Table Extensibility:
//   https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/controllerExtensions/tableExtensibility
// - Table - Custom Columns / Actions:
//   https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/tableCustoms
```

Note: This approach applies only to SAP Fiori elements for OData V4. The same beforeRebindTable extension point is available for the Table building block as well.
--------------------------------

**TITLE**: Initial Expansion Level for Tables in SAP Fiori Elements List Reports & Analytical List Pages

**INTRODUCTION**: Configure how many grouping levels in table controls are expanded on initial render by setting initialExpansionLevel on the UI.PresentationVariant annotation. Applicable to SAP Fiori elements for OData V2 only. Use PresentationVariant (directly or via SelectionPresentationVariant) for content areas and tabs.

**TAGS**: fiori-elements-framework, odata-v2, annotations, UI.PresentationVariant, UI.SelectionPresentationVariant, initialExpansionLevel, list-report, analytical-list-page, table, groupBy

**STEP**: 1 - Applicability & quick rule

**DESCRIPTION**: When to use this setting and a key constraint. initialExpansionLevel controls number of expanded grouping levels. It is supported only when PresentationVariant annotations exist for the content area (ALP / List Report) or for tabs in List Reports that have PresentationVariant annotations. The value must not exceed the number of grouped columns.

**LANGUAGE**: Text

**CODE**:
```Text
Applicable: SAP Fiori elements (OData V2) only.
Rule: initialExpansionLevel <= number of GroupBy columns.
Requirement: PresentationVariant annotation must exist for content area or tabs.
```

**STEP**: 2 - Expected behavior per table type

**DESCRIPTION**: Behavior of initialExpansionLevel for Analytical Table, Responsive Table, and Tree Table.

**LANGUAGE**: Text

**CODE**:
```Text
Analytical Table: default initialExpansionLevel = 0 (if not set).
Responsive Table: ignores initialExpansionLevel; effectively expands to one level (groups are always expanded).
Tree Table:
  - List Report: first level is automatically expanded (independent of initialExpansionLevel).
  - Analytical List Page: default initialExpansionLevel = 0 (if not set).
```

**STEP**: 3 - Define initialExpansionLevel directly in UI.PresentationVariant (XML)

**DESCRIPTION**: Create a UI.PresentationVariant annotation for the entity with GroupBy and InitialExpansionLevel. Use Qualifier when needed (e.g., Default). This PresentationVariant can be referenced directly by tabs or by the content area if qualifiers and manifest binding allow it.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.PresentationVariant" Qualifier="Default">
    <Record>
        <PropertyValue Property="Visualizations">
            <Collection>
                <AnnotationPath>@UI.LineItem#DefaultLineItem</AnnotationPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="GroupBy">
            <Collection>
                <PropertyPath>ProductId</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="InitialExpansionLevel" Int="1"/>
        <PropertyValue Property="SortOrder">
            <Collection>
                <Record>
                    <PropertyValue Property="Property" PropertyPath="ProductCategory" />
                    <PropertyValue Property="Descending" Bool="false" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 4 - Define initialExpansionLevel in ABAP CDS (UI.presentationVariant)

**DESCRIPTION**: ABAP CDS snippet showing presentationVariant with groupBy, initialExpansionLevel and qualifier. Annotate the view to expose the PresentationVariant used by the Fiori element page.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.presentationVariant: [
  {
    visualizations: [
      {
        type: #AS_LINEITEM,
        qualifier: 'DefaultLineItem'
      }
    ],
    groupBy: [
      'PRODUCTID'
    ],
    initialExpansionLevel: 1,
    sortOrder: [
      {
        by: 'PRODUCTCATEGORY',
        direction: #ASC
      }
    ],
    qualifier: 'Default'
  }
]
annotate view STTA_C_MP_Product with {
  // field-level annotations...
}
```

**STEP**: 5 - Define initialExpansionLevel in CAP CDS (UI.PresentationVariant)

**DESCRIPTION**: CAP CDS (core language) representation of the PresentationVariant with Visualizations, GroupBy, InitialExpansionLevel and SortOrder.

**LANGUAGE**: CDS

**CODE**:
```cds
UI.PresentationVariant #Default : {
    Visualizations : [
        '@UI.LineItem#DefaultLineItem',
    ],
    GroupBy : [
        ProductId
    ],
    InitialExpansionLevel : 1,
    SortOrder : [
        {
            Property : ProductCategory,
            Descending : false
        }
    ]
}
```

**STEP**: 6 - Use SelectionPresentationVariant that references a PresentationVariant (XML)

**DESCRIPTION**: If you use a SelectionPresentationVariant for content area or tab, ensure the PresentationVariant is referenced by path (not inlined). The SelectionPresentationVariant should include a PresentationVariant path to the named PresentationVariant (qualifier). This keeps initialExpansionLevel in the referenced PresentationVariant effective.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.SelectionPresentationVariant" Qualifier="MainContent">
    <Record>
        <PropertyValue Property="ID" String=""/>
        <PropertyValue Property="Text" String=""/>
        <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#Default"/>
        <PropertyValue Property="PresentationVariant" Path="@UI.PresentationVariant#Default"/>
    </Record>
</Annotation>
```

**STEP**: 7 - Use SelectionPresentationVariant in ABAP CDS

**DESCRIPTION**: ABAP CDS example that connects a SelectionPresentationVariant to a PresentationVariant via qualifiers. Use selectionPresentationVariant/presentationVariant qualifiers rather than inlining the PresentationVariant.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.selectionPresentationVariant: [{
  id: '',
  text: '',
  selectionVariantQualifier: 'Default',
  presentationVariantQualifier: 'Default',
  qualifier: 'MainContent'
}]
```

**STEP**: 8 - Use SelectionPresentationVariant in CAP CDS

**DESCRIPTION**: CAP CDS example using explicit references to SelectionVariant and PresentationVariant by path (qualifier). The PresentationVariant referenced must exist separately (see step 5).

**LANGUAGE**: CDS

**CODE**:
```cds
UI.SelectionPresentationVariant #MainContent : {
    ID : '',
    Text : '',
    SelectionVariant : ![@UI.SelectionVariant#Default],
    PresentationVariant : ![@UI.PresentationVariant#Default]
},
```

**STEP**: 9 - Manifest / tab binding rules and qualifier behavior

**DESCRIPTION**: How manifest qualifiers and tab annotation paths affect which PresentationVariant is used:
- If no tabs: default PresentationVariant (no qualifier) is considered.
- If manifest qualifier is defined for content area:
  - If no matching SelectionPresentationVariant with that qualifier exists, but a matching PresentationVariant exists => content area associates directly with that PresentationVariant.
- If manifest qualifier is not defined:
  - If no default SelectionPresentationVariant exists but a default PresentationVariant exists => content area associates with default PresentationVariant.
- Tabs in List Reports: a tab can point directly to a PresentationVariant if the manifest's annotation path for the tab references the PresentationVariant annotation (use qualifiers and annotation paths to target the PresentationVariant).

**LANGUAGE**: Text

**CODE**:
```Text
Manifest binding behavior:
- No tabs => use default PresentationVariant (qualifierless).
- Qualifier set in manifest:
    - Prefer SelectionPresentationVariant matching qualifier.
    - If none, but PresentationVariant with qualifier exists => use that PresentationVariant.
- If tab annotation path in manifest points to a PresentationVariant => tab uses that PresentationVariant directly (ensure qualifier/path matches).
```

**STEP**: 10 - Practical checklist before deployment

**DESCRIPTION**: Quick validation checklist to ensure initialExpansionLevel behaves as expected in your app.

**LANGUAGE**: Text

**CODE**:
```Text
Checklist:
- Targeting OData V2 Fiori elements only.
- PresentationVariant exists for the content area or tab.
- If using SelectionPresentationVariant, ensure it references a non-inline PresentationVariant via Path/qualifier.
- initialExpansionLevel value <= number of GroupBy columns.
- Verify table type behavior (Analytical / Responsive / Tree) in the target view (List Report or ALP).
- For List Report tabs, ensure manifest annotation path points to the intended PresentationVariant/SelectionPresentationVariant.
```

**Related Information**:
- Configuring Tables: configuring-tables-f4eb70f.md
- Configuring Table-Only View as Default: configuring-the-table-only-view-as-the-default-option-d074e26.md
- Configuring Default Settings (Visualizations, Sort Order, Filter Values): configuring-default-settings-visualizations-sort-order-filter-values-49a6ba5.md
--------------------------------

**TITLE**: Inline Edit Configuration and Usage for SAP Fiori elements (OData V4)

**INTRODUCTION**: Practical, code-focused guide for enabling and configuring inline edit in SAP Fiori elements applications (OData V4). Includes manifest.json snippets, field group and annotation usage, runtime behavior, error handling, action/navigation prompts, restrictions, and back-end requirements.

**TAGS**: sapui5, fiori-elements, inline-edit, manifest.json, OData V4, object-page, list-report, field-groups, connected-fields, draft

**STEP**: 1 — Overview and Requirements

**DESCRIPTION**: Summary of what inline edit does and prerequisites before configuring it in code.
- Purpose: Allow users to edit specific fields or connected field groups directly in the active version (no draft) on ListReport and ObjectPage templates.
- Templates supported: sap.fe.templates.ListReport, sap.fe.templates.ObjectPage.
- Required: OData V4 service with draft-enabled entity set (unless backend bypass is implemented); SAPUI5 >= 1.136.
- Not supported: collaborative draft enabled, flexible column layout, stream property fields, multi-input fields.
- UI behavior (runtime): editable fields display underline and an Edit (pencil) icon on hover; double-click or Enter opens inline edit; Save (check) commits immediately (patch), Cancel (x) or Esc discards.
- Special notes:
  - Double-click is not supported for responsive tables.
  - Inline edit is not available if the object already has a draft.
  - Immediate side effects are not triggered for properties that belong to the same connectedFields group.

**LANGUAGE**: Plain English

**CODE**:
```Plain English
No code for this step — ensure your app uses OData V4 and ListReport/ObjectPage templates that reference a draft-enabled entity, and UI5 >= 1.136.
```

**STEP**: 2 — Enable Inline Edit at Page Level (manifest.json)

**DESCRIPTION**: Add an inlineEdit configuration object to the page-level component configuration in manifest.json. Use "enabledFields" or "disabledFields" to control which properties are editable. Use "connectedFields" to define groups of fields edited together. If disabledFields (or "disabledFields": []) is empty, inline editing is enabled for all fields.

- Keys:
  - enabledFields: array of property names or FieldGroup annotation paths to allow inline edit only for these fields.
  - disabledFields (or disableFields in conceptual docs): array of property names or FieldGroup annotation paths to disable inline edit.
  - connectedFields: array of arrays or annotation strings; each element defines which fields must be edited together. Elements can be arrays listing properties or a FieldGroup annotation string.
- FieldGroup annotation syntax examples:
  - "@com.sap.vocabularies.UI.v1.FieldGroup#TripData"
  - "navigationProperty/@com.sap.vocabularies.UI.v1.FieldGroup#GroupName"

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (page component settings)
{
  "MyListReport": {
    "type": "Component",
    "name": "sap.fe.templates.ListReport",
    "id": "MyListReport",
    "options": {
      "settings": {
        "inlineEdit": {
          // Option A: enable all fields (disabledFields empty)
          "disabledFields": []
        }
      }
    }
  }
}
```

**STEP**: 3 — Example: Enable Specific Fields + Connected Fields (ListReport)

**DESCRIPTION**: Configure a ListReport page to allow inline edit only for specific properties and declare a connected field pair (BeginDate, EndDate). Use property names for enabledFields and an array-of-arrays for connectedFields.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (TravelList example)
{
  "TravelList": {
    "type": "Component",
    "name": "sap.fe.templates.ListReport",
    "id": "TravelList",
    "options": {
      "settings": {
        "inlineEdit": {
          "enabledFields": [
            "to_Customer_CustomerID",
            "BeginDate",
            "EndDate",
            "BookingFee"
          ],
          "connectedFields": [
            ["BeginDate", "EndDate"]
          ]
        },
        "contextPath": "/Travel",
        "initialLoad": "Enabled",
        "navigation": {
          "Travel": {
            "detail": {
              "route": "TravelObjectPage"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Example: Use FieldGroup Annotations & Mixed connectedFields (ObjectPage)

**DESCRIPTION**: Enable inline edit using UI FieldGroup annotations (annotation path strings). Demonstrates mixing a FieldGroup annotation and a property-array for connectedFields.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (TravelObjectPage example)
{
  "TravelObjectPage": {
    "type": "Component",
    "id": "TravelObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "entitySet": "Travel",
        "inlineEdit": {
          "enabledFields": [
            "@com.sap.vocabularies.UI.v1.FieldGroup#TripData",
            "to_Booking/@com.sap.vocabularies.UI.v1.FieldGroup#Flight"
          ],
          "connectedFields": [
            ["BeginDate", "EndDate"],
            "to_Booking/@com.sap.vocabularies.UI.v1.FieldGroup#Flight"
          ]
        }
      }
    }
  }
}
```

**STEP**: 5 — Runtime Interaction Patterns (Code-level expectations)

**DESCRIPTION**: Implementations and tests should expect the following runtime interactions:
- Opening inline edit:
  - Click pencil icon, or double-click field (except responsive tables), or press Enter when field focused.
- Committing changes:
  - Click Save (check icon) or press Enter while editing -> client issues a PATCH request to active entity (no draft creation).
- Canceling:
  - Click Cancel (x) or press Esc -> revert UI to previous value.
- Group behavior:
  - If a property belongs to a connectedFields group, editing one property will switch the entire group to edit mode and Save will commit the group in a single request.
- Side-effect behavior:
  - Immediate side effects originating and targeting properties within the same connectedFields group are not triggered.

**LANGUAGE**: Plain English

**CODE**:
```Plain English
No code — ensure front-end tests and handlers expect PATCH to active entity and group-edit semantics.
```

**STEP**: 6 — Error Management Behavior

**DESCRIPTION**: How inline edit errors are surfaced and how the UI should react programmatically:
- If server returns error on inline PATCH:
  - Show a message button in the page footer (message popover).
  - Keep the changed field(s) and any related error fields in edit mode so the user can correct them.
  - If an error references a field not present on the page, inline edit cannot fix it; user must switch to full edit mode (draft) to fix.
- If an error references a field in a connected group, the entire group is opened for editing.

**LANGUAGE**: Plain English

**CODE**:
```Plain English
Implement client message handling to:
- Display footer message button when PATCH fails.
- Mark related fields (or entire connected group) as editable after error.
- If error target not on page, present a prompt to switch to full edit mode.
```

**STEP**: 7 — Action Execution and Navigation Prompts

**DESCRIPTION**: Define behaviors and expectations when actions or navigations are triggered while inline editing is open.
- If user triggers an action during inline edit:
  - Prompt: Save or Discard current inline changes. After choice, user must re-trigger action (action not auto-executed).
- If user triggers navigation from a table while inline editing:
  - Prompt: Save or Discard current inline changes. After choice, navigation occurs.
- Exceptions: Navigation triggered via browser navigation icons, FLP header, or intent-based navigation will proceed immediately and current inline changes will be lost (no prompt).

**LANGUAGE**: Plain English

**CODE**:
```Plain English
Front-end should present a modal or message dialog to Save/Discard before executing actions or in-app navigations initiated from table rows or inline contexts. Do not intercept browser or FLP navigation (these will discard changes).
```

**STEP**: 8 — Back-End Considerations

**DESCRIPTION**: Back-end must accept direct patching of the active entity (no draft). Implementation notes per technology:
- General: Inline edit issues a PATCH to the active instance; ensure business logic is safe to run without draft semantics.
- ABAP (RAP):
  - Follow ABAP RESTful Application Programming Model recommendations for business objects and side effects.
  - Link: https://help.sap.com/docs/abap-cloud/abap-rap/abap-restful-application-programming-model
- CAP (Cloud Application Programming):
  - Ensure bypass draft option is configured correctly so active entity can be patched.
  - CAP Node.js docs (Bypassing the SAP Fiori Draft Flow): https://cap.cloud.sap/docs/node.js/fiori#bypassing-the-sap-fiori-draft-flow
  - CAP Java docs (Bypassing the SAP Fiori Draft Flow): https://cap.cloud.sap/docs/java/fiori-drafts#bypassing-draft-flow

**LANGUAGE**: Plain English

**CODE**:
```Plain English
Server-side: Accept PATCH on active entity, validate and return field-level errors in OData error structure for client to map to specific fields/groups.
```

**STEP**: 9 — Implementation Checklist (Quick actionable items)

**DESCRIPTION**: Copy this checklist into your project plan to implement inline edit.
- [ ] Ensure UI5 version >= 1.136 and Fiori elements OData V4.
- [ ] Confirm draft-enabled service or backend bypass configuration.
- [ ] Add inlineEdit configuration to manifest.json at page component level (ListReport/ObjectPage).
- [ ] Define enabledFields or disabledFields explicitly; keep disabledFields: [] to enable all.
- [ ] Define connectedFields arrays for related properties or use FieldGroup annotations.
- [ ] Implement UI handlers for open/edit/save/cancel and for showing footer messages on error.
- [ ] Ensure backend accepts direct PATCH to active entity and returns field-referential errors where required.
- [ ] Test action and navigation prompt flows; test browser/FLP/intent navigation behavior.

**LANGUAGE**: Plain English

**CODE**:
```Plain English
Use this checklist to verify both front-end manifest settings and back-end adjustments are implemented and tested.
```
--------------------------------

**TITLE**: Key User Capabilities — Fiori Elements UI Adaptation (Actions & Annotation Examples)

**INTRODUCTION**: This document summarizes the key-user UI adaptation capabilities available in Fiori Elements overview page applications and provides action-oriented instructions and annotation examples to ensure adaptations render readable labels and metadata in "Adapt UI" mode. Use this when preparing role assignments, instructing users how to enter adaptation mode, and when adding or improving OData/CDS annotations to support UI adaptation.

**TAGS**: fiori-elements-framework, key-user, ui-adaptation, flexibility, annotations, sapui5

**STEP**: 1 — Prerequisites (Role assignments)

**DESCRIPTION**: Ensure the user has the correct key-user role to enable UI adaptation features.

- SAP Business Technology Platform: assign FlexKeyUser role.
- On-premise SAP systems: assign SAP_UI_FLEX_KEY_USER role.
- Reference: SAPUI5 Flexibility documentation for further details: ../04_Essentials/sapui5-flexibility-adapting-uis-made-easy-a8e55aa.md

**LANGUAGE**: Plain text

**CODE**:
```text
Required roles:
- BTP / Cloud: FlexKeyUser
- On-premise: SAP_UI_FLEX_KEY_USER

Reference doc:
../04_Essentials/sapui5-flexibility-adapting-uis-made-easy-a8e55aa.md
```

**STEP**: 2 — Enter UI Adaptation Mode

**DESCRIPTION**: How to open the adaptation mode in the running overview page application.

- In the running Fiori overview page, open the user actions menu (user avatar or actions button).
- Choose "Adapt UI" to enter key-user adaptation mode.
- While in adaptation mode, perform operations such as hide/show cards, add cards, edit card properties, modify filter/variant settings, and publish changes.

**LANGUAGE**: Plain text

**CODE**:
```text
UI path:
User actions menu -> Adapt UI
```

**STEP**: 3 — User Interface Adaptation Features (Actionable list)

**DESCRIPTION**: Action-focused list of available adaptation features and what each enables you to change.

- Hide Card: mark a card hidden on initial load; hidden cards appear in Manage Cards.
- Add Card: add from list of available/hidden cards.
- Edit Card: change title, subtitle, KPI header/value/description, chart type, sorting, navigation; disable individual card generation for Insights (S/4HANA Cloud Public Edition scenario).
- Add/Delete Views: add or remove view switch field on a card.
- Modify Card Size: change card rows/columns and layout size.
- Create Card: create static link list card or KPI card.
- Basic card operations: cut, copy, paste, save, cancel, reset, publish.
- Adapt Filters: add/remove filter fields and default values; save as variant.
- Adapt Variants: rename, save, save-as-new, and manage views/variants.

**LANGUAGE**: Plain text

**CODE**:
```text
Adaptation actions (summary):
- Hide / Show cards
- Add / Delete cards
- Edit: title, subtitle, KPI header/value/description, chart type, sorting/navigation
- Modify card size (rows/columns)
- Create cards: static link list, KPI
- Manage: cut/copy/paste/save/cancel/reset/publish
- Adapt Filters: add/remove fields, set default values, persist in variants
- Adapt Variants: rename, save, save-as, manage variants/views
```

**STEP**: 4 — Best Practices — Maintain property labels via annotations

**DESCRIPTION**: Maintain clear property labels for the listed annotations so they display meaningfully in UI adaptation mode. Below are example OData annotation snippets (XML EDMX-style) that explicitly set the text/label/description properties for PresentationVariant, SelectionVariant, DataPoint, Identification (DataFieldForIntentBasedNavigation / DataFieldWithUrl), and Chart annotations.

Use the Target values for your service/entity/property names. Replace MyService.MyEntityType and property names with actual service and entity names.

**LANGUAGE**: XML (OData annotations)

**CODE**:
```xml
<!-- PresentationVariant: set Text property (display label in adaptation mode) -->
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant">
    <Record>
      <PropertyValue Property="Text" String="Sales Orders - Default Presentation"/>
    </Record>
  </Annotation>
</Annotations>

<!-- SelectionVariant: set Text property to label filter set -->
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant">
    <Record>
      <PropertyValue Property="Text" String="Default Filters - Sales Orders"/>
    </Record>
  </Annotation>
</Annotations>

<!-- DataPoint: set Title (readable label) and link the Value property -->
<Annotations Target="MyService.MyEntityType/TotalRevenue">
  <Annotation Term="com.sap.vocabularies.UI.v1.DataPoint">
    <Record>
      <PropertyValue Property="Title" String="Total Revenue"/>
      <PropertyValue Property="Value" Path="TotalRevenue"/>
    </Record>
  </Annotation>
</Annotations>

<!-- Identification: use DataFieldForIntentBasedNavigation and DataFieldWithUrl with Label property
     Label priority: DataFieldForIntentBasedNavigation / DataFieldWithUrl label is used -->
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.Identification">
    <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
        <PropertyValue Property="Label" String="Customer"/>
        <PropertyValue Property="SemanticObject" String="Customer"/>
        <PropertyValue Property="Action" String="display"/>
        <PropertyValue Property="Value" Path="CustomerID"/>
      </Record>
      <Record Type="com.sap.vocabularies.UI.v1.DataFieldWithUrl">
        <PropertyValue Property="Label" String="Customer Website"/>
        <PropertyValue Property="Url" String="https://example.com/customers/{CustomerID}"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>

<!-- Chart annotation: set Description property for charts -->
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.Chart">
    <Record>
      <PropertyValue Property="Description" String="Revenue by Month"/>
      <!-- Add Dimensions/Measures as needed -->
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 5 — CDS/Cap Examples (optional CD S snippets for service model annotations)

**DESCRIPTION**: Example CDS-style annotations (CAP) to convey the same intent in server-side model. Replace entity and field names accordingly. Note: CDS UI annotation keys vary by framework version; adapt to your project conventions.

**LANGUAGE**: CDS

**CODE**:
```cds
namespace my.company;

using { cuid } from '@sap/cds/common';

entity SalesOrder {
  key ID       : UUID @title : 'Sales Order ID';
  CustomerID   : String(36) @title : 'Customer';
  TotalRevenue : Decimal(15,2) @title : 'Total Revenue';
  CreatedAt    : Timestamp;
}

// Example CAP/UI annotations (adjust to your CAP tooling)
entity SalesOrder with {
  @UI.lineItem: [{ value: TotalRevenue, label: 'Total Revenue' }]
  @UI.identification: [{ value: CustomerID, label: 'Customer' }]
} ;
```

**STEP**: 6 — Practical tips for authors and implementers

**DESCRIPTION**: Short actionable tips to ensure adaptation works and is user-friendly.

- Always provide Text/Label/Title/Description properties in annotations for PresentationVariant, SelectionVariant, DataPoint, Identification/DataField*, and Chart to improve readability in Adapt UI.
- Test Adapt UI in an environment where the user has the key-user role assigned.
- After making changes in Adapt UI, use publish/save workflows to persist changes according to your flexibility setup (BTP or on-premise transport mechanism).
- For Insights generation control (S/4HANA Cloud Public Edition), ensure flags for card generation are exposed so key users can enable/disable cards individually.

**LANGUAGE**: Plain text

**CODE**:
```text
Tips:
- Provide readable labels in annotations (Text / Label / Title / Description)
- Verify role assignment before testing Adapt UI
- Publish or save changes per your platform’s flexibility lifecycle
- For S/4HANA Cloud: check Insights generation flags if you need to control card inclusion
```
--------------------------------

**TITLE**: Key Value Facet (UI.DataPoint) — Annotation Examples for Fiori Elements

**INTRODUCTION**: This document provides concise, copy-pasteable annotation examples for rendering key-value style Data Points (UI.DataPoint) in SAP Fiori Elements. It includes XML annotation, ABAP CDS, and CAP CDS variants, plus examples that include criticality. Use these qualifiers with a UI.ReferenceFacet to render the DataPoint title and value in a key value facet.

**TAGS**: fiori-elements-framework, annotations, UI.DataPoint, key-value, OData V4, ABAP CDS, CAP CDS, XML

STEP: 1 — XML Annotation: Simple UI.DataPoint (ProductCategory)
DESCRIPTION: Define a UI.DataPoint annotation with a qualifier (#ProductCategory). The Title is an i18n key and Value points to the ProductCategory property. Place this in your annotations XML file.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="ProductCategory">
  <Record>
    <PropertyValue Property="Value" Path="ProductCategory"/>
    <PropertyValue Property="Title" String="{@i18n>ProductCategory}"/>
  </Record>
</Annotation>
```

STEP: 2 — ABAP CDS: Simple UI.dataPoint (ProductCategory)
DESCRIPTION: ABAP CDS fragment to expose the same DataPoint. Use the @UI.dataPoint annotation with an i18n title. Include this in your CDS view/entity definition.
LANGUAGE: CDS (ABAP)
CODE:
```abap
@UI.dataPoint: {
  title: '{@i18n>@ProductCategory}'
}
ProductCategory;
```

STEP: 3 — CAP CDS: Simple UI.DataPoint (ProductCategory)
DESCRIPTION: CAP CDS annotation that declares a UI.DataPoint with Value and Title. Use the qualifier #ProductCategory in your annotation file.
LANGUAGE: CDS (CAP)
CODE:
```cap
UI.DataPoint #ProductCategory : {
    Value : ProductCategory,
    Title : '{@i18n>@ProductCategory}'
}
```

STEP: 4 — XML Annotation: UI.DataPoint with Criticality (StockAvailability)
DESCRIPTION: Define a DataPoint that binds Criticality to a path. The DataPoint shows Title, Value, and a color based on criticality. Place in your annotations XML file.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="StockAvailability">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Availability" />
    <PropertyValue Property="Value" Path="stock/availability" />
    <PropertyValue Property="Criticality" Path="stock/availability"/>
  </Record>
</Annotation>
```

STEP: 5 — ABAP CDS: UI.dataPoint with Criticality (StockAvailability)
DESCRIPTION: ABAP CDS fragment that declares a DataPoint with criticality bound to an entity path. Include in the CDS view/entity.
LANGUAGE: CDS (ABAP)
CODE:
```abap
@UI.dataPoint: {
  title: 'Availability',
  criticality: 'stock/availability'
}
stock/availability;
```

STEP: 6 — CAP CDS: UI.DataPoint with Criticality (StockAvailability)
DESCRIPTION: CAP CDS annotation declaring a DataPoint with Value, Title, and Criticality bound to a path.
LANGUAGE: CDS (CAP)
CODE:
```cap
UI.DataPoint #StockAvailability : {
    Value : stock/availability,
    Title : Availability,
    Criticality : stock/availability
}
```

STEP: 7 — How to Render as a Key Value Facet (usage)
DESCRIPTION: To render a DataPoint as a key value facet in the UI, add a UI.ReferenceFacet in your Facets collection that points to the UI.DataPoint qualifier (for example, @UI.DataPoint#ProductCategory or @UI.DataPoint#StockAvailability). The ReferenceFacet will render the DataPoint Title and Value in the key-value style facet.
LANGUAGE: TEXT
CODE:
```text
Instruction:
- Add a UI.ReferenceFacet in your UI.Facets collection that references the DataPoint qualifier, e.g. @UI.DataPoint#ProductCategory
- The UI will render the DataPoint Title and Value as a Key Value Facet (see images/Key_Value_Facet_aed9f13.jpg)
```

STEP: 8 — Tip: Semantic Object and Navigation (behavior note + links)
DESCRIPTION: If you annotate the DataPoint Value with a semantic object (making it a link), the value will render as a link but criticality styling will not be shown. For details on enabling navigation from DataPoint title or value, consult the linked docs.
LANGUAGE: TEXT
CODE:
```text
Behavior note:
- Adding a semantic object to the DataPoint Value turns it into a navigation link but prevents criticality color from being shown.
References:
- Using a Link (add semantic object): navigation-from-an-app-outbound-navigation-d782acf.md
- Enable navigation from header facet title (OData V4): navigation-from-header-facet-title-fa0ca22.md
```
--------------------------------

**TITLE**: Keyboard Shortcuts — Implementation and Customization for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: This document provides concise, action-oriented instructions and ready-to-use code examples for:
- Using standard SAP Fiori Elements keyboard shortcuts
- Redirecting standard shortcuts to custom actions (OData V2)
- Defining custom keyboard shortcuts for custom actions, annotated action buttons, and navigation buttons (OData V2 & V4)
- V4-specific default-positive-action behavior and command-to-shortcut mappings

Use these snippets directly in your application manifest.json and UI annotation files. Preserve focus/visibility prerequisites described for correct behavior.

**TAGS**: fiori-elements-framework, keyboard-shortcuts, manifest.json, annotations, OData V2, OData V4, sap.ui.commands

STEP: 1 — Standard Keyboard Shortcuts (Quick Reference)
DESCRIPTION: Copyable list of available standard shortcuts, prerequisites, and applicable floorplans.
LANGUAGE: text
CODE:
```
Standard Shortcuts (Windows / macOS) — Prerequisite -> Applicable Floorplans -> Result

- Cancel / Discard Draft
  - Shortcut: Esc / Esc
  - Prerequisite: Focus anywhere on Object Page in edit mode
  - Floorplan: Object Page
  - Result: Equivalent to Cancel (non-draft) or Discard Draft (draft apps)

- Create
  - Shortcut: Ctrl+Enter / Cmd+Enter
  - Prerequisite: Focus on table
  - Floorplans: List Report, Object Page
  - Result: Equivalent to Create

- Create with Filters (NOT applicable for OData V4)
  - Shortcut: Shift+Ctrl+Enter / Shift+Cmd+Enter
  - Prerequisite: Focus on table
  - Floorplan: List Report
  - Result: Equivalent to Create With Filters

- Delete (page level)
  - Shortcut: Ctrl+Del / Cmd+Fn+Delete (or Cmd+← if no delete key)
  - Prerequisite: Focus anywhere on Object Page in display mode
  - Floorplan: Object Page
  - Result: Equivalent to Delete on object page

- Delete (table entry)
  - Shortcut: Ctrl+D / Cmd+D
  - Prerequisite: Focus on table (selection required for multi-delete or cell focus for single)
  - Floorplans: List Report, Object Page
  - Result: Equivalent to Delete in a table
  - Note: Works only for read-only/display-only content; edit fields use Del/Backspace

- Edit (page level)
  - Shortcut: Ctrl+E / Cmd+E
  - Prerequisite: Focus anywhere on Object Page
  - Floorplan: Object Page
  - Result: Equivalent to Edit on object page

- Export as
  - Shortcut: Shift+Ctrl+E / Shift+Cmd+E
  - Prerequisite: Focus on table
  - Floorplans: Analytical List Page, List Report, Object Page
  - Result: Equivalent to Export to Excel > Export As

- Go (SmartFilterBar)
  - Shortcut: Enter / Enter
  - Prerequisite: Focus inside SmartFilterBar input fields
  - Floorplans: Analytical List Page, List Report, Object Page
  - Result: Triggers search

- Go (Visual Filter, NOT applicable for OData V4)
  - Shortcut: Ctrl+Enter / Cmd+Enter
  - Prerequisite: Focus on any element in the visual filter panel
  - Floorplan: Analytical List Page (visual filter)
  - Result: Triggers Go for visual filter

- Open error list
  - Shortcut: Ctrl+Shift+M / Cmd+Shift+M
  - Prerequisite: Focus anywhere on Object Page in edit mode
  - Floorplan: Object Page
  - Result: Equivalent to Error button

- Save (page level)
  - Shortcut: Ctrl+S / Cmd+S
  - Prerequisite: Page in edit mode; focus anywhere on Object Page
  - Floorplan: Object Page
  - Result: Equivalent to Save on object page

- Select row in analytical or grid tables
  - Shortcut: Shift+Space / Shift+Space
  - Prerequisite: Focus on a table cell
  - Floorplans: Analytical List Page, List Report, Object Page
  - Result: Selects the entire row

- Share (NOT applicable for OData V4)
  - Shortcut: Shift+Ctrl+S / Shift+Cmd+S
  - Prerequisite: Focus on list report or object page (focus on filter bar opens ActionSheet near Share button)
  - Floorplans: Analytical List Page, List Report, Object Page
  - Result: Opens share ActionSheet

- Table settings
  - Shortcut: Ctrl+, / Ctrl,
  - Prerequisite: Focus on table
  - Floorplans: Analytical List Page, List Report, Object Page
  - Result: Equivalent to Table Settings button
```

STEP: 2 — Redirect Standard Shortcuts to Custom Actions (OData V2)
DESCRIPTION: To override standard actions so their standard keyboard shortcuts trigger your extension code, add a custom action in manifest.json with the "logicalAction" property set to the standard action name. The custom action must satisfy the same UI rendering conditions as the original standard action.
LANGUAGE: JSON
CODE:
```json
// Example: Replace List Report standard Create action with custom action
{
  "sap.ui.controllerExtensions": {
    "sap.suite.ui.generic.template.ListReport.view.ListReport": {
      "controllerName": "STTA_SO_ND.ext.controller.ListReportExtension",
      "sap.ui.generic.app": {
        "STTA_C_SO_SalesOrder_ND": {
          "EntitySet": "STTA_C_SO_SalesOrder_ND",
          "Actions": {
            "CreateExt": {
              "id": "CreateExt",
              "text": "Create (Ext)",
              "press": "onCreateWithParameters",
              "logicalAction": "Create"
            }
          }
        }
      }
    }
  }
}
```

LANGUAGE: JSON
CODE:
```json
// Example: Replace Object Page Delete (header) and Section Create using logicalAction
{
  "sap.ui.controllerExtensions": {
    "sap.suite.ui.generic.template.ObjectPage.view.Details": {
      "controllerName": "STTA_SO_ND.ext.controller.DetailsExtension",
      "sap.ui.generic.app": {
        "STTA_C_SO_SalesOrder_ND": {
          "EntitySet": "STTA_C_SO_SalesOrder_ND",
          "Header": {
            "Actions": {
              "MySmartTableDelete": {
                "id": "customdelete",
                "text": "Custom Delete",
                "press": "fnCustomDelete",
                "logicalAction": "Delete"
              }
            }
          },
          "Sections": {
            "to_Item::com.sap.vocabularies.UI.v1.LineItem": {
              "id": "to_Item::com.sap.vocabularies.UI.v1.LineItem",
              "Actions": {
                "MySmartTableCreate": {
                  "id": "customcreate",
                  "text": "CustomCreate",
                  "press": "fnCustomCreate",
                  "logicalAction": "Create"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

DESCRIPTION (supported redirections):
```
List Report supported redirections:
- Create            -> Ctrl+Enter
- CreateWithFilters -> Shift+Ctrl+Enter  (not for OData V4)
- Delete            -> Ctrl+D

Object Page supported redirections:
- Header: Save -> Ctrl+S, Edit -> Ctrl+E, Delete -> Ctrl+Del
- Sections: Create -> Ctrl+Enter, Delete -> Ctrl+D
```

STEP: 3 — Define New Keyboard Shortcuts for Custom Actions (OData V2)
DESCRIPTION: Define a command mapping in sap.ui.commands and link that command to a custom action in the manifest. Use "description" to show a friendly label in the keyboard shortcuts popup. Add controller extension/action handler to implement the behavior.
LANGUAGE: JSON
CODE:
```json
// manifest.json excerpt: define sap.ui.commands mapping and custom action wiring
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.commands": {
          "sap.suite.ui.generic.template.ListReport#sap.suite.ui.generic.template.ListReport::STTA_C_MP_Product": {
            "ChangePriceCommand": {
              "shortcut": "Ctrl+G",
              "description": "Change Price"
            }
          }
        }
      }
    }
  },
  "sap.ui.controllerExtensions": {
    "sap.suite.ui.generic.template.ListReport.view.ListReport": {
      "controllerName": "STTA_MP.ext.controller.ListReportExtension",
      "sap.ui.generic.app": {
        "STTA_C_MP_Product": {
          "EntitySet": "STTA_C_MP_Product",
          "Actions": {
            "ChangePrice": {
              "id": "ChangePrice",
              "text": "Change price",
              "press": "onChangePrice",
              "command": "ChangePriceCommand"
            }
          }
        }
      }
    }
  }
}
```
DESCRIPTION:
- "ChangePriceCommand.shortcut" maps key combo to the command.
- "ChangePriceCommand.description" is shown in the keyboard shortcuts popup. If omitted, the action id is shown.

STEP: 4 — Define Custom Shortcuts for DataFieldForAction (Annotation-based) and DataFieldForIntentBasedNavigation
DESCRIPTION: For action/navigation annotations, create a command mapping and reference that command in the annotated action via sap.ui.generic.app settings (annotatedActions or outbounds). The command key must be defined under sap.ui.commands with the component key "<Component Name>#<Component ID without app ID prefix>".
LANGUAGE: XML
CODE:
```xml
<!-- DataFieldForAction annotation (XML snippet) -->
<Record Type="UI.DataFieldForAction">
  <!-- ... -->
  <PropertyValue Property="Action" String="<Schema Namespace>.<EntityContainer Name>/<FunctionImport Name>" />
</Record>
```

LANGUAGE: JSON
CODE:
```json
// manifest.json excerpt: annotate the function import with a command and map command to shortcut
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.commands": {
          "<Component Name>#<Component ID without app ID prefix>": {
            "<Command Name>": {
              "shortcut": "Ctrl+B"
            }
          }
        }
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|<Entity Set Name>": {
        "component": {
          "settings": {
            "annotatedActions": {
              "<FunctionImport Name>": {
                "command": "<Command Name>"
              }
            }
          }
        }
      }
    }
  }
}
```

LANGUAGE: XML
CODE:
```xml
<!-- DataFieldForIntentBasedNavigation annotation (XML snippet) -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
  <PropertyValue Property="SemanticObject" String="<Semantic Object>" />
  <PropertyValue Property="Action" String="<Action>" />
</Record>
```

LANGUAGE: JSON
CODE:
```json
// manifest.json excerpt: define outbound navigation + command mapping for navigation action
{
  "sap.app": {
    "crossNavigation": {
      "inbounds": {},
      "outbounds": {
        "<Outbound Navigation Name>": {
          "semanticObject": "<Semantic Object>",
          "action": "<Action>"
        }
      }
    }
  },
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.commands": {
          "<Component Name>#<Component ID without app ID prefix>": {
            "<Command Name>": {
              "shortcut": "Ctrl+B"
            }
          }
        }
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|<Entity Set Name>": {
        "component": {
          "settings": {
            "outbounds": {
              "<Outbound Navigation Name>": {
                "command": "<Command Name>"
              }
            }
          }
        }
      }
    }
  }
}
```

NOTE:
- Custom keyboard shortcuts for inline DataFieldForAction or inline DataFieldForIntentBasedNavigation actions inside tables are NOT supported.
- To find the correct component key ("<Component Name>#<Component ID without app ID prefix>"), see guidance on Adding Custom Actions Using Extension Points.

STEP: 5 — OData V4: Default Positive Action Behavior and Command Mapping
DESCRIPTION: V4 behavior notes and manifest examples for mapping command names to shortcuts in sap.fe templates.
LANGUAGE: text
CODE:
```
Default Positive Action (Ctrl/Cmd + Enter or Ctrl/Cmd + Return)
- Triggered in List Report, Object Page, Subobject Page when focus is NOT on a control that uses the same keys.
- Prioritization: If focus is on a table with a Table Create action, that table create takes precedence.
- Default positive actions:
  - List Report: Go button on filter bar
  - Object Page: positive semantic action or default Edit (display) / Save (edit)
  - Subobject Page: application positive semantic action or Apply button

Restrictions & Notes:
- Standard shortcut does not trigger inline primary actions within tables.
- Header/footer buttons are global (triggered irrespective of focus), unless the same shortcut is mapped to a control closer to the current focus.
- Avoid reusing standard shortcuts for custom buttons to prevent unexpected behavior.
```

LANGUAGE: JSON
CODE:
```json
// Example: Map annotation 'BOUND' and 'IBNI' commands to shortcuts (OData V4 style / sap.fe templates)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.commands": {
          "sap.fe.templates.ListReport": {
            "BOUND": {
              "shortcut": "Ctrl+B"
            }
          },
          "sap.fe.templates.ObjectPage": {
            "IBNI": {
              "shortcut": "Ctrl+K"
            }
          },
          // For object page instance-specific mapping append "#<ObjectPageID>"
          "sap.fe.templates.ObjectPage#SalesOrderManageObjectPage": {
            "IBNI": {
              "shortcut": "Ctrl+I"
            }
          }
        }
      }
    }
  }
}
```

FINAL NOTES (Action checklist):
- To redirect a standard shortcut: add a custom action in manifest with logicalAction set to the standard action name and implement the press handler.
- To define a custom shortcut: create a command entry under sap.ui.commands and reference it via command in annotatedActions or outbounds (or in controllerExtensions Action definitions).
- Verify focus and visibility prerequisites (table focus, SmartFilterBar, edit/display mode, etc.) to ensure the shortcut is invoked.
- Test on both Windows and macOS for platform-specific keys (Cmd vs Ctrl, Fn+Delete where needed).
--------------------------------

**TITLE**: Line Chart Card — Configuration and Annotation Examples for Fiori Elements

**INTRODUCTION**: This document provides concise, code-focused examples and guidance for implementing a Line Chart Card in SAP Fiori Elements. It covers how to define category/series roles and measures, a manifest-based card configuration (Overview Page / OVP style), and OData/CDS annotation examples to drive the chart data. Use these snippets to wire up a line chart that shows trends over time with semantic coloring support.

**TAGS**: fiori-elements, line-chart, cards, overview-page, ovp, manifest.json, annotations, OData, CDS, semantic-coloring

STEP: Define roles and best practices

DESCRIPTION: Summary of how dimensions and measures are interpreted by a Line Chart Card. Use this as a checklist when preparing OData properties or CDS fields.

LANGUAGE: text

CODE:
```text
- Category (x-axis):
  - A dimension with role = "category".
  - If none provided, the first dimension is used.
  - Recommended: use time-based properties (date, day, quarter, year) for the category axis.

- Series:
  - A dimension with role = "series".
  - Each unique value produces a distinct colored line.
  - If multiple dimensions are set to series, their combined values are treated as one series key (single color per combined value).

- Measures (y-axis):
  - Numeric properties used as measures.
  - Each measure becomes a separate colored line when multiple measures are present.

- Semantic Coloring:
  - Supported. Enable semantic coloring via chart configuration or annotations to apply business semantics (colors based on thresholds or status).
```

STEP: Manifest-based Line Chart Card (OVP / Overview Page) — manifest.json snippet

DESCRIPTION: Example JSON fragment to add a line chart card under the OVP / Overview Page configuration in webapp/manifest.json. Adjust entitySet, property names, and labels to match your OData model. This generic structure demonstrates dimensions (category + series), measures, and semantic coloring flag.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "lineChartCard": {
        "component": {
          "name": "sap.ovp.cards.charts.Line"
        },
        "properties": {
          "title": "Sales Over Time",
          "subTitle": "By region",
          "entitySet": "SalesOrderSet",
          "selectionAnnotationPath": "@com.sap.vocabularies.UI.v1.SelectionFields",
          "chart": {
            "chartType": "line",
            "dimensions": [
              {
                "property": "OrderDate",
                "role": "category",
                "type": "date",
                "label": "Order Date"
              },
              {
                "property": "Region",
                "role": "series",
                "label": "Region"
              }
            ],
            "measures": [
              {
                "property": "Amount",
                "label": "Sales Amount",
                "unitProperty": "Currency"
              }
            ],
            "semanticColoring": true,
            "colorPalette": "sap_viz_palette_custom" 
          },
          "presentationVariantPath": "@com.sap.vocabularies.UI.v1.PresentationVariant#LineChartPV"
        }
      }
    }
  }
}
```

STEP: OData V4 Annotation (XML) — com.sap.vocabularies.UI.v1.Chart example

DESCRIPTION: OData annotation example that declares a Line Chart with one measure and two dimensions (OrderDate as category, Region as series). Place this in your annotations XML (for example app/annotations/LineChartAnnotations.xml) and ensure it is referenced from the manifest.

LANGUAGE: XML

CODE:
```xml
<Annotations Target="YourServiceNamespace.SalesOrderType">
  <Annotation Term="com.sap.vocabularies.UI.v1.Chart">
    <Record>
      <!-- Chart type -->
      <PropertyValue Property="ChartType" String="Line" />

      <!-- Measures -->
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>Amount</PropertyPath>
        </Collection>
      </PropertyValue>

      <!-- Dimensions with explicit roles -->
      <PropertyValue Property="Dimensions">
        <Collection>
          <Record>
            <PropertyValue Property="PropertyPath">
              <PropertyPath>OrderDate</PropertyPath>
            </PropertyValue>
            <PropertyValue Property="Label" String="Order Date" />
            <PropertyValue Property="Role" String="Category" />
          </Record>
          <Record>
            <PropertyValue Property="PropertyPath">
              <PropertyPath>Region</PropertyPath>
            </PropertyValue>
            <PropertyValue Property="Label" String="Region" />
            <PropertyValue Property="Role" String="Series" />
          </Record>
        </Collection>
      </PropertyValue>

      <!-- Optional: enable semantic color by referencing a ColorSemantic annotation or custom term -->
      <PropertyValue Property="SemanticColoring" Bool="true" />
    </Record>
  </Annotation>
</Annotations>
```

STEP: CDS Annotation Example (CAP / CDS) — annotate entity for line chart

DESCRIPTION: CDS-style annotations to define a chart on an entity. Use this in a .cds file or annotation file inside your CAP project. Adjust property names to match your entity. This example declares a LINE chart with measures and dimensions and maps roles.

LANGUAGE: CDS

CODE:
```cds
using { cuid, managed } from '@sap/cds/common';

entity SalesOrder : managed {
  key ID       : UUID;
  OrderDate    : Date;
  Region       : String(50);
  Amount       : Decimal(15,2);
  Currency     : String(3);
}

annotate SalesOrder with
  @UI.chart: {
    type: #LINE,
    measures: [ { name: 'Amount' } ],
    dimensions: [
      { name: 'OrderDate', role: #CATEGORY, label: 'Order Date' },
      { name: 'Region', role: #SERIES, label: 'Region' }
    ],
    selectionFields: [ 'OrderDate', 'Region' ]
  }
;
```

STEP: Tips for implementation and troubleshooting

DESCRIPTION: Practical tips for common problems and expected behaviors.

LANGUAGE: text

CODE:
```text
- If no dimension has role="category", the first dimension will be used as the category axis.
- Use a single time-based property for category to produce a meaningful trend line (avoid string categories for time series).
- When multiple measures are present, each becomes a separate colored line. When multiple series dimensions are present, their combined values form one series key.
- Semantic coloring:
  - Turn on semanticColoring in card config or include SemanticColoring/ColorVocabulary annotations if supported by your platform.
  - Verify the color palette setting matches your design tokens or viz palettes used in the app.
- File locations:
  - Manifest card configuration: webapp/manifest.json (sap.ovp.cards or sap.ui5.card configuration depending on app type)
  - OData annotations: app/annotations/*.xml (or annotations in service metadata)
  - CDS annotations: srv/schema.cds or db/data-model.cds in CAP projects
- Validate:
  - Check annotation files are correctly referenced in manifest (sap.app/dataSources -> annotations).
  - Use browser devtools console to review any binding/annotation parsing errors.
```


--------------------------------

**TITLE**: Line Micro Chart Annotations for SAP Fiori Elements

**INTRODUCTION**: This document provides concise, copy-pasteable annotation examples and actionable rules to implement a Line Micro Chart in SAP Fiori Elements (OData V4). Includes XML, ABAP CDS and CAP CDS examples for UI.Chart, UI.DataPoint and calendar-related dimension annotations, plus mandatory validation rules and visual semantics.

**TAGS**: fiori-elements-framework, line-micro-chart, UI.Chart, UI.DataPoint, CDS, ABAP, CAP, XML, annotations

**STEP**: 1 — UI.Chart (XML Annotation)

**DESCRIPTION**: Add a UI.Chart annotation of type Line. Set Title, Description, ChartType, Measures, Dimensions and MeasureAttributes (each MeasureAttribute references a UI.DataPoint via AnnotationPath). Use Qualifier to reference this chart from your UI configuration.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.Chart" Qualifier="SpecificationWidthLineChart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Product Width Specification Line Chart"/>
        <PropertyValue Property="Description" String="Describe Line Chart"/>
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Line"/>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>Width</PropertyPath>
                <PropertyPath>Depth</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>Day</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
             <Collection>
                  <Record Type="UI.ChartMeasureAttributeType">
                       <PropertyValue Property="Measure" PropertyPath="Width"/>
                       <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2"/>
                       <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Width"/>
                  </Record>
                  <Record Type="UI.ChartMeasureAttributeType">
                      <PropertyValue Property="Measure" PropertyPath="Depth"/>
                      <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2"/>
                      <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Depth"/>
                  </Record>
              </Collection>
         </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 2 — UI.Chart (ABAP CDS Annotation)

**DESCRIPTION**: ABAP CDS equivalent of the XML UI.Chart. Use the @UI.Chart annotation array on a view or include it in an annotate view block. Qualifier is supported.

**LANGUAGE**: ABAP CDS

**CODE**:
```
@UI.Chart: [
  {
    title: 'Product Width Specification Line Chart',
    description: 'Describe Line Chart',
    chartType: #LINE,
    measures: [
      'WIDTH',
      'DEPTH'
    ],
    dimensions: [
      'DAY',
      'DAY'
    ],
    measureAttributes: [
      {
        measure: 'Width',
        role: #AXIS_2,
        asDataPoint: true
      },
      {
        measure: 'Depth',
        role: #AXIS_2,
        asDataPoint: true
      }
    ],
    qualifier: 'SpecificationWidthtLineChart'
  }
]
annotate view STTA_C_MP_PRODUCT with {

}
```

**STEP**: 3 — UI.Chart (CAP CDS Annotation)

**DESCRIPTION**: CAP CDS JSON-like syntax for UI.Chart. Use UI.Chart #<Qualifier> for the chart definition. Each MeasureAttribute references a DataPoint using the DataPoint annotation value.

**LANGUAGE**: CDS

**CODE**:
```
UI.Chart #SpecificationWidthLineChart : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Product Width Specification Line Chart',
    Description : 'Describe Line Chart',
    ChartType : #Line,
    Measures : [
        Width,
        Depth
    ],
    Dimensions : [
        Day,
        Day
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Width,
            Role : #Axis2,
            DataPoint : '@UI.DataPoint#Width'
        },
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Depth,
            Role : #Axis2,
            DataPoint : '@UI.DataPoint#Depth'
        }
    ]
}
```

**STEP**: 4 — UI.DataPoint (XML Annotation)

**DESCRIPTION**: Define DataPoints for measures referenced by MeasureAttributes.DataPoint. Include Value (path), optional Description and Criticality (path or fixed enum). Criticality controls semantic coloring of the line.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Width">
    <Record>
        <PropertyValue Property="Value" Path="Width"/>
        <PropertyValue Property="Description" String="Line Micro Chart"/>
        <PropertyValue Property="Criticality" Path="criticalityValue"/>
    </Record>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="Depth">
    <Record>
        <PropertyValue Property="Value" Path="Depth"/>
        <PropertyValue Property="Criticality" Path="criticalityValue"/>
    </Record>
</Annotation>
```

**STEP**: 5 — UI.DataPoint (ABAP CDS)

**DESCRIPTION**: ABAP CDS DataPoint annotation examples. Attach @UI.dataPoint to elements in a view or in an annotate block.

**LANGUAGE**: ABAP CDS

**CODE**:
```
@UI.dataPoint: {
  description: 'Line Micro Chart',
  targetValueElement: 'Weight',
  criticality: 'criticalityValue'
}
Width;

@UI.dataPoint: {
  criticality: 'criticalityValue'
}
Depth;
```

**STEP**: 6 — UI.DataPoint (CAP CDS)

**DESCRIPTION**: CAP CDS DataPoint definitions. Use UI.DataPoint #<Qualifier> syntax to create named data points referenced by UI.Chart.MeasureAttributes.DataPoint.

**LANGUAGE**: CDS

**CODE**:
```
UI.DataPoint #Width : {
    Value : Width,
    Description : 'null',
    Criticality : criticalityValue
},

UI.DataPoint #Depth : {
    Value : Depth,
    Criticality : criticalityValue
}
```

**STEP**: 7 — Calendar / String-based Dimension Support (XML)

**DESCRIPTION**: Line micro charts support string-based dimension fields annotated as calendar types. Example: annotate a property as Common.IsCalendarYear to enable parsing of YYYY values.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="com.c_salesordermanage_sd_aggregate.SalesOrderItem/OrderYear"> 
  <Annotation Term="Common.IsCalendarYear" Bool="true" /> 
</Annotations>
```

**STEP**: 8 — Calendar / String-based Dimension Support (ABAP CDS)

**DESCRIPTION**: ABAP CDS annotation to mark a field as calendar-year (or other calendar semantics). Use @Semantics.calendar.* annotations.

**LANGUAGE**: ABAP CDS

**CODE**:
```
annotate view C_SALESORDERMANAGE_SD_AGGREGATE.SALESORDERITEM with { 
 @Semantics.calendar.year: true 
 OrderYear 
} 
```

**STEP**: 9 — Calendar / String-based Dimension Support (CAP CDS)

**DESCRIPTION**: CAP CDS example marking a String(4) property as Common.IsCalendarYear.

**LANGUAGE**: CDS

**CODE**:
```
OrderYear : String(4) @(Common.IsCalendarYear : true);
```

**STEP**: 10 — Mandatory Annotations and Validation Rules

**DESCRIPTION**: Checklist and behavioral rules to validate and implement Line Micro Chart correctly.

**LANGUAGE**: TEXT

**CODE**:
```
Mandatory annotations:
- UI.Chart -> ChartType must be "Line".
- UI.Chart -> Dimensions must be defined.
- UI.Chart -> Measures must be defined.
- UI.Chart -> MeasureAttributes must be defined and each measure attribute used for plotting must include DataPoint.
- UI.DataPoint -> Value must be present for each DataPoint referenced.

Key rules:
- The first measure MUST have both UI.Chart Measures entry and a corresponding UI.Chart MeasureAttribute with a DataPoint. If the first measure is missing these, the chart will not display even if later measures are configured.
- If subsequent measures do not have MeasureAttributes with DataPoint, they will not be plotted.
- For semantic coloring, only the Criticality annotation is supported:
  - If Criticality is a fixed Enum value, the entire line is colored accordingly (e.g., Criticality.Negative => Red).
  - If Criticality is a path, the criticality of the last data point determines the line color.
- Ensure unit of measure consistency across all data points (same UoM).
- Recommended measures: prefer 1 measure, maximum 3 measures for clarity.
- Labeling behavior: top-left shows the smallest measure value at the first dimension value; top-right shows the largest measure value at the last dimension value when multiple measures are plotted.
- Dimension data types:
  - Prefer float-based numeric dimensions or ensure values can be cast to float.
  - String-based dimensions are allowed only if annotated to denote calendar values (Common.IsCalendarYear, Common.IsCalendarQuarter, Common.IsCalendarMonth, Common.IsCalendarWeek, Common.IsCalendarYearMonth, Common.IsCalendarDate) and must match the expected formats/regex patterns for each calendar annotation.
```

--------------------------------

**TITLE**: Link List Card - manifest.json configuration examples (static and dynamic)

**INTRODUCTION**: Quick reference for configuring SAP Fiori Link List Cards (sap.ovp.cards.linklist) in the app manifest. Includes descriptor settings (title, subtitle), staticContent examples, dynamic card examples for standard and carousel layouts, common properties, navigation types, and the OData V4 template note. Use these JSON snippets directly in manifest.json under the "sap.ovp" section.

**TAGS**: fiori-elements-framework, ovp, linklist, manifest.json, sap.ovp, staticContent, carousel, standard, smartlink, quickview

STEP: Descriptor - Title
DESCRIPTION: Set the card title that appears at the top of the Link List Card. Place inside the card's settings object in manifest.json.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card005_RecentContacts": {
        "model": "purchaseOrder",
        "template": "sap.ovp.cards.linklist",
        "settings": {
          "title": "Recent Contacts",
          "entitySet": "SalesShare"
        }
      }
    }
  }
}
```

STEP: Descriptor - Subtitle
DESCRIPTION: Add a subtitle directly below the title. Property is commonly "subTitle" (some examples use "subtitle" — include whichever your runtime expects). Example shows "subTitle" with a header link (targetUri).
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card005_RecentContacts": {
        "model": "purchaseOrder",
        "template": "sap.ovp.cards.linklist",
        "settings": {
          "title": "Recent Contacts",
          "targetUri": "https://en.abc.org/wiki/abc_2",
          "subTitle": "by Importance of Interaction",
          "entitySet": "SalesShare"
        }
      }
    }
  }
}
```

STEP: Static Link List Card - staticContent (full example)
DESCRIPTION: Define static list items directly in manifest.json using staticContent. Each item may contain title, subTitle, imageUri, imageAltText, targetUri, openInNewWindow. Use this to create a static link list without backend OData calls.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card005_RecentContacts": {
        "model": "purchaseOrder",
        "template": "sap.ovp.cards.linklist",
        "settings": {
          "title": "Recent Contacts",
          "targetUri": "https://en.wikipedia.org/wiki/Mangalyaan_2",
          "subTitle": "by Importance of Interaction",
          "listFlavor": "standard",
          "sortBy": "Employee",
          "entitySet": "Zme_Overdue",
          "sortOrder": "ascending",
          "defaultSpan": {
            "rows": 24,
            "cols": 2,
            "showOnlyHeader": true
          },
          "staticContent": [
            {
              "title": "Jim Smith",
              "subTitle": "Sales",
              "imageUri": "img/JD.png",
              "imageAltText": "Jim Smith",
              "targetUri": "https://google.com",
              "openInNewWindow": true
            },
            {
              "title": "Alice Wilson",
              "subTitle": "Sales",
              "imageUri": "img/AW.png",
              "imageAltText": "Alice Wilson",
              "targetUri": "https://google.com",
              "openInNewWindow": true
            },
            {
              "title": "Daniel Quote",
              "subTitle": "Production",
              "imageUri": "img/DQ.png",
              "imageAltText": "Daniel Quote",
              "targetUri": "https://google.com",
              "openInNewWindow": true
            },
            {
              "title": "Kate Holly",
              "subTitle": "Sales",
              "imageUri": "img/Kate.png",
              "imageAltText": "Kate Holly",
              "targetUri": "https://google.com",
              "openInNewWindow": true
            },
            {
              "title": "Aurora Smith",
              "subTitle": "HR",
              "imageUri": "img/KJ.png",
              "imageAltText": "Aurora Smith",
              "targetUri": "https://google.com",
              "openInNewWindow": true
            },
            {
              "title": "Wong Lee",
              "subTitle": "Management",
              "imageUri": "img/YM.png",
              "imageAltText": "Wong Lee",
              "targetUri": "https://google.com",
              "openInNewWindow": true
            }
          ]
        }
      }
    }
  }
}
```

STEP: Dynamic Link List Card - Standard layout (OData V2/V4)
DESCRIPTION: Configure a dynamic link list card that reads items from the backend entitySet. Use listFlavor "standard" to render ordered items with optional subtitle and image. Include annotation paths for quick view and identification where needed.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card20": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.linklist",
        "settings": {
          "title": "Dynamic Linklist Card",
          "targetUri": "https://en.abc.org/wiki/A_2",
          "subtitle": "NEW CARD",
          "listFlavor": "standard",
          "sortBy": "Name",
          "entitySet": "ProductSet",
          "sortOrder": "ascending",
          "headerAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#header1",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#identify1"
        }
      }
    }
  }
}
```

STEP: Dynamic Link List Card - Carousel layout
DESCRIPTION: Configure a carousel view to emphasize images and allow wider image area. Use listFlavor "carousel". Example uses localized title token via binding.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card_20": {
        "model": "HEPM_OVP_TECH_VAL",
        "template": "sap.ovp.cards.linklist",
        "settings": {
          "title": "{{card20_title}}",
          "entitySet": "Hepmra_C_OFT_Employee",
          "listFlavor": "carousel",
          "sortBy": "Employee",
          "sortOrder": "ascending"
        }
      }
    }
  }
}
```

STEP: OData V4 Template Note
DESCRIPTION: For SAP Fiori elements OData V4 projects, use the V4 template identifier. All other settings remain the same.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card_20": {
        "template": "sap.ovp.cards.v4.linklist",
        "settings": {
          "title": "Linklist V4",
          "entitySet": "ProductSet",
          "listFlavor": "standard"
        }
      }
    }
  }
}
```

STEP: Common properties & navigation types
DESCRIPTION: Reference list of frequently used settings and supported navigation types. Use them in settings or staticContent items.
LANGUAGE: JSON
CODE:
```json
{
  "commonSettings": {
    "title": "string",
    "subTitle / subtitle": "string",             /* header subtitle */
    "targetUri": "https://... (header link)",
    "entitySet": "ODataEntitySet",
    "listFlavor": "standard | carousel",
    "sortBy": "PropertyName",
    "sortOrder": "ascending | descending",
    "headerAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#id",
    "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#id",
    "defaultSpan": { "rows": number, "cols": number, "showOnlyHeader": boolean },
    "staticContent[]": [
      {
        "title": "string",
        "subTitle": "string",
        "imageUri": "img/.. or URL",
        "imageAltText": "string",
        "targetUri": "https://...",
        "openInNewWindow": true
      }
    ]
  },
  "navigationTypes": [
    "Quick view (uses annotations / identification paths to show contact info)",
    "Cross app navigation (SmartLink / semantic object intent-based)",
    "External URL (targetUri / openInNewWindow)"
  ]
}
```
--------------------------------

**TITLE**: List Cards — configuring sap.ovp list cards with LineItem annotations (condensed/extended, standard/bar, images)

**INTRODUCTION**: Quick actionable reference for adding and configuring List Cards in SAP Fiori elements (OVP). Shows manifest settings, annotation usage (qualified and unqualified), field-to-UI mapping rules, behavior for condensed/extended + standard/bar flavors, sorting by Importance, and how to enable images/icons with XML, ABAP CDS, and CAP CDS examples.

**TAGS**: fiori-elements-framework, ovp, list-card, manifest, annotations, LineItem, DataField, DataPoint, imageSupported

**STEP**: 1 — Add a List Card to the manifest (V2 and V4)
**DESCRIPTION**: Add the list card entry under "sap.ovp" -> "cards" in the application manifest. Use "sap.ovp.cards.list" for OData V2 and "sap.ovp.cards.v4.list" for OData V4. Set entitySet, template, optional listFlavor, sortBy/sortOrder, and annotationPath (qualified or unqualified).
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card04": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.list",                // Use "sap.ovp.cards.v4.list" for OData V4
        "settings": {
          "entitySet": "Products",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#bar", // optional qualifier; omit qualifier to use default LineItem
          "listFlavor": "bar",                    // "bar" or "standard"
          "sortBy": "Price",
          "sortOrder": "descending",
          "category": "{{card04_category}}"
        }
      }
    }
  }
}
```

**STEP**: 2 — Use annotationPath qualifiers (multiple LineItem variants)
**DESCRIPTION**: Point annotationPath to a qualified LineItem when using multiple LineItem annotations for the same entity type. If annotationPath is not present, the unqualified com.sap.vocabularies.UI.v1.LineItem is used.
**LANGUAGE**: JSON
**CODE**:
```json
// Use qualified LineItem:
"annotationPath": "com.sap.vocabularies.UI.v1.LineItem#Qualifier1"

// Use unqualified LineItem (default):
"annotationPath": "com.sap.vocabularies.UI.v1.LineItem"
```

**STEP**: 3 — Field mapping rules and runtime sorting
**DESCRIPTION**: DataField and DataPoint display rules:
- By default the card maps fields from the configured LineItem (collection of DataFieldAbstract).
- At runtime fields are ordered by optional Importance (com.sap.vocabularies.UI.v1.ImportanceType) first, then by their order in the annotation.
- DataFieldForAnnotation referencing a DataPoint is treated specially (DataPoint displayed on right/top depending on flavor).
- If DataPoint records are missing, DataField records fill the right side positions.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// Runtime ordering pseudo-logic:
// 1. Sort entries in LineItem by Importance (High > Medium > Low) if present
// 2. Then stable-sort by original annotation order
// 3. Map sorted entries to visible slots according to list type/flavor (see next step)
```

**STEP**: 4 — Layout mapping: condensed vs extended, standard vs bar (slots & max items)
**DESCRIPTION**: Map DataField / DataPoint / DataFieldForAnnotation to UI slots per list type and flavor. Max displayed list items depends on type: condensed => up to 3 items; extended => up to 5 or 6 depending on flavor below.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// Condensed - Standard (up to 3 items):
// slot TL = first DataField (top-left)
// slot BL = second DataField (bottom-left)
// slot TR = first DataFieldForAnnotation with DataPoint target (top-right) OR next DataField
// maxItems = 3

// Extended - Standard (up to 6 items):
// Left side: DataField records (up to 3 left-side positions)
// Right side: DataPoint records (up to 3 right-side positions)
// If fewer DataPoint records, fill right side with next DataField records
// maxItems = 6

// Condensed - Bar (up to 3 items):
// TL title = first DataField
// Bar (beneath title) = first DataPoint  (displayed as bar + numeric value at right of bar)
// Additional right numeric = second DataPoint (optional)
// maxItems = 3

// Extended - Bar (up to 5 items):
// TL title = first DataField
// BL = second DataField (optional)
// Bar at bottom = first DataPoint (bar + numeric value at right-bottom)
// Right column above/below = two additional DataPoint records (stacked)
// Only one DataPoint can be highlighted (criticality) — the first displayed
// maxItems = 5
```

**STEP**: 5 — Enable images/icons in condensed list cards
**DESCRIPTION**: To render images or icons on condensed lists, set "imageSupported": true in descriptor settings for the card and annotate the LineItem DataField with IconUrl (or Icon) in your annotations. The card uses an image control (not avatar). Examples shown for XML Annotation, ABAP CDS, and CAP CDS.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "cardWithImages": {
        "template": "sap.ovp.cards.list",
        "settings": {
          "entitySet": "Products",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#withImage",
          "imageSupported": true
        }
      }
    }
  }
}
```

**STEP**: 6 — Example: XML LineItem annotation with IconUrl
**DESCRIPTION**: XML annotation showing IconUrl in DataField for images/icons.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem" Qualifier="withImage">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="IconUrl" Path="web_address"/>
      <PropertyValue Property="Value" Path="MaterialName"/>
    </Record>
    <!-- Add more DataField / DataFieldForAnnotation / DataPoint records as needed -->
  </Collection>
</Annotation>
```

**STEP**: 7 — Example: ABAP CDS LineItem snippet (showing value field)
**DESCRIPTION**: ABAP CDS example for a simple line item entry. Add IconUrl similarly by using UI.DataField with IconUrl property in CDS if supported.
**LANGUAGE**: CDS
**CODE**:
```cql
// ABAP CDS snippet
@UI.lineItem: [{ value: 'MATERIALNAME' }]
MATERIALNAME;
```

**STEP**: 8 — Example: CAP CDS LineItem with IconUrl
**DESCRIPTION**: CAP CDS annotation example using UI.LineItem and DataField with IconUrl and Value.
**LANGUAGE**: CDS
**CODE**:
```cql
// CAP CDS snippet
UI.LineItem : [
  {
    $Type : 'com.sap.vocabularies.UI.v1.DataField',
    IconUrl : web_address,
    Value : MaterialName
  }
]
```

**STEP**: 9 — Notes & important behavior (concise)
**DESCRIPTION**: Preserve these runtime and implementation notes when coding:
- In OData V4 use template "sap.ovp.cards.v4.list"; all other manifest keys are the same as V2.
- Multiple LineItem annotations distinguished by qualifiers: use annotationPath with qualifier e.g. "com.sap.vocabularies.UI.v1.LineItem#Qualifier1".
- Sorting: Importance annotation (com.sap.vocabularies.UI.v1.ImportanceType) is applied first, then annotation order.
- DataPoint criticality highlighting: when multiple DataPoints are present only the first displayed DataPoint (by layout order) is highlighted for criticality.
- For images/icons the card uses an image control; ensure "imageSupported": true and annotate IconUrl in the LineItem.
--------------------------------

**TITLE**: List Report and Object Page (SAP Fiori Elements, OData V2)

**INTRODUCTION**: Configure a SAP Fiori Elements app that uses a List Report to browse objects and an Object Page to view/edit a selected object. This guide provides concrete manifest and annotation examples for OData V2 (webapp/manifest.json and webapp/annotations/*.xml). Use these snippets to scaffold a List Report + Object Page app or to adapt an existing Fiori Elements project.

**TAGS**: fiori-elements, odata-v2, manifest.json, annotations, list-report, object-page, sapui5, sap.suite.ui.generic.template

STEP: 1 — Add OData V2 data source and models to manifest.json

DESCRIPTION: Configure the OData V2 service, register it as the default model, and enable it for the generic templates. Place this content in webapp/manifest.json (merge into existing manifest).

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "id": "com.example.ListReportObjectPage",
    "applicationVersion": { "version": "1.0.0" },
    "title": "List Report and Object Page"
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "preload": true
      }
    }
  },
  "sap.applications": {},
  "sap.platform.hcp": {},
  "sap.ui.generic.app": {
    "settings": {},
    "pages": [
      {
        "name": "ListReport",
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport"
        }
      },
      {
        "name": "ObjectPage",
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      }
    ]
  },
  "sap.app": {},
  "dataSources": {
    "mainService": {
      "uri": "/sap/opu/odata/sap/ZMY_SERVICE_SRV/",
      "type": "OData",
      "settings": { "odataVersion": "2.0" }
    }
  }
}
```

STEP: 2 — Configure the default model entry in sap.ui5 -> models (if not using dataSource mapping above)

DESCRIPTION: Alternative or additional model configuration under sap.ui5 to explicitly reference the OData V2 dataSource and settings (place inside webapp/manifest.json -> sap.ui5).

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "synchronizationMode": "None",
          "operationMode": "Server",
          "defaultBindingMode": "TwoWay"
        }
      }
    },
    "resources": {}
  }
}
```

STEP: 3 — Minimal annotation file for List Report (LineItem) and Object Page (HeaderInfo + Facets)

DESCRIPTION: Create UI annotations to show table columns in the List Report and header/facets in the Object Page. Save as webapp/annotations/annotations.xml and register it in the manifest (or in annotation configuration). Adjust entity type and property names to match your service metadata.

LANGUAGE: XML

CODE:
```xml
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="1.0" xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx">
  <edmx:DataServices>
    <Schema Namespace="ZMY_SERVICE" xmlns="http://schemas.microsoft.com/ado/2008/09/edm">
      <EntityType Name="Product">
        <Key>
          <PropertyRef Name="ProductID"/>
        </Key>
        <Property Name="ProductID" Type="Edm.String"/>
        <Property Name="Name" Type="Edm.String"/>
        <Property Name="Category" Type="Edm.String"/>
        <Property Name="Price" Type="Edm.Decimal"/>
      </EntityType>

      <!-- UI Annotations -->
      <Annotations Target="ZMY_SERVICE.Product">
        <!-- List Report: table layout -->
        <Annotation Term="UI.LineItem">
          <Collection>
            <Record Type="UI.DataField">
              <PropertyValue Property="Label" String="ID"/>
              <PropertyValue Property="Value" Path="ProductID"/>
            </Record>
            <Record Type="UI.DataField">
              <PropertyValue Property="Label" String="Name"/>
              <PropertyValue Property="Value" Path="Name"/>
            </Record>
            <Record Type="UI.DataField">
              <PropertyValue Property="Label" String="Category"/>
              <PropertyValue Property="Value" Path="Category"/>
            </Record>
            <Record Type="UI.DataField">
              <PropertyValue Property="Label" String="Price"/>
              <PropertyValue Property="Value" Path="Price"/>
            </Record>
          </Collection>
        </Annotation>

        <!-- Object Page: Header information -->
        <Annotation Term="UI.HeaderInfo">
          <Record>
            <PropertyValue Property="TypeName" String="Product"/>
            <PropertyValue Property="Title" Path="Name"/>
            <PropertyValue Property="Description" Path="Category"/>
          </Record>
        </Annotation>

        <!-- Object Page: Facets / Sections -->
        <Annotation Term="UI.Facets">
          <Collection>
            <Record Type="UI.ReferenceFacet">
              <PropertyValue Property="Label" String="General"/>
              <PropertyValue Property="Target">
                <Record Type="UI.CollectionFacet">
                  <PropertyValue Property="ID" String="GeneralSection"/>
                  <PropertyValue Property="Label" String="General"/>
                </Record>
              </PropertyValue>
            </Record>
          </Collection>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

STEP: 4 — Register annotation file(s) in manifest.json

DESCRIPTION: Tell the generic runtime where to find the annotations file. Add an annotations entry under sap.ui5/models/ or under sap.ui.generic.app -> settings/annotation.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "models": {
      "": { "dataSource": "mainService" }
    },
    "annotations": {
      "localAnnotations": {
        "type": "com.sap.vocabularies.Common.v1",
        "uri": "annotations/annotations.xml"
      }
    }
  }
}
```

STEP: 5 — Navigation behavior (List Report -> Object Page)

DESCRIPTION: When both ListReport and ObjectPage pages are declared for the same entitySet in sap.ui.generic.app.pages, the Fiori Elements runtime automatically enables navigation from the list to the object page using the selected row's key. No additional routing is required for standard navigation. To customize navigation targets, use sap.ui.generic.app.pages name fields or NavigationRelated configuration in the manifest.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "name": "ListReport",
        "entitySet": "Products",
        "component": { "name": "sap.suite.ui.generic.template.ListReport" }
      },
      {
        "name": "ObjectPage",
        "entitySet": "Products",
        "component": { "name": "sap.suite.ui.generic.template.ObjectPage" }
      }
    ]
  }
}
```

STEP: 6 — Notes and compatibility

DESCRIPTION: The Object Page can also be used together with the Analytical List Page (ALP). For ALP-specific configuration and additional features, see the Analytical List Page documentation at webapp/docs/analytical-list-page-3d33684.md or your project doc folder.

LANGUAGE: TEXT

CODE:
```text
- Object Page works with:
  - List Report (standard)
  - Analytical List Page (ALP) — use ALP template plus same Object Page configuration
- Ensure OData service exposes the expected entitySet (e.g., "Products") and keys.
- Adjust annotations to reflect actual entity property names and UI needs.
```


--------------------------------

**TITLE**: List Report Elements — Implementation Guide for Fiori Elements (SmartFilterBar + SmartTable)

**INTRODUCTION**: Short, actionable guide showing how to implement the main List Report elements used in SAP Fiori Elements apps: application header, Smart Filter Bar (with variant management and share actions), Smart Table (table configuration and export), and an optional footer toolbar with actions. Includes minimal manifest.json wiring and XML view snippets for direct integration into a Fiori Elements project.

**TAGS**: fiori-elements-framework, list-report, smartfilterbar, smarttable, sapui5, manifest, annotations, variant-management, share-menu

STEP: 1 — XML View: SmartFilterBar + SmartTable (List Report Main Layout)

DESCRIPTION: Create the List Report XML view that exposes the SmartFilterBar (filter area with variant management and share actions) and the SmartTable (list). Use the same entitySet name for both controls. Persist the filter bar state using persistencyKey.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/view/ListReport.view.xml -->
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:smartFilterBar="sap.ui.comp.smartfilterbar"
  xmlns:smartTable="sap.ui.comp.smarttable"
  controllerName="your.namespace.controller.ListReport"
  displayBlock="true">

  <!-- Application Header is provided by Fiori Launchpad / shell in typical setups -->

  <!-- Smart Filter Bar with variant management and persistency -->
  <smartFilterBar:SmartFilterBar
    id="smartFilterBar"
    entitySet="MyEntitySet"
    persistencyKey="MyApp_SmartFilterBar"
    useToolbar="true"
    showRestoreButton="true"
    showClearButton="true"
    smartVariant="true" />

  <!-- Smart Table bound to the same entity set -->
  <smartTable:SmartTable
    id="smartTable"
    entitySet="MyEntitySet"
    tableType="ResponsiveTable"            <!-- Use ResponsiveTable, AnalyticalTable, GridTable as required -->
    header="My Entity List"
    showRowCount="true"
    useExportToExcel="true"
    enableAutoBinding="true"
    useVariantManagement="true"
    showVariantManagement="true">

    <!-- Custom toolbar aggregation for custom actions (Share menu, Send Email, Save as Tile) -->
    <smartTable:customToolbar>
      <Toolbar id="listReportToolbar">
        <ToolbarSpacer/>
        <!-- Generic Share menu placeholder (implement onPress handlers in controller) -->
        <OverflowToolbarButton icon="sap-icon://action" text="Share" press="onSharePress"/>
        <!-- Send Email -->
        <Button icon="sap-icon://email" text="Send Email" press="onSendEmailPress"/>
        <!-- Save as Tile -->
        <Button icon="sap-icon://pushpin-off" text="Save as Tile" press="onSaveAsTilePress"/>
      </Toolbar>
    </smartTable:customToolbar>

  </smartTable:SmartTable>

  <!-- Optional footer toolbar: place at bottom of view (example) -->
  <Toolbar id="footerToolbar">
    <Button id="footerAction1" text="Footer Action 1" press="onFooterAction1"/>
    <ToolbarSpacer/>
    <Text text="Optional footer actions"/>
  </Toolbar>

</mvc:View>
```

STEP: 2 — Controller: Hook Share, Email, Tile, and Footer Actions

DESCRIPTION: Implement controller methods for toolbar actions. Use available services (e.g., sap.m.URLHelper for email or Fiori Launchpad services for Save as Tile) to implement behavior. Keep handlers small and testable.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/controller/ListReport.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/m/MessageToast",
  "sap/m/URLHelper"
], function(Controller, MessageToast, URLHelper) {
  "use strict";

  return Controller.extend("your.namespace.controller.ListReport", {

    onInit: function() {
      // Init logic if needed
    },

    onSharePress: function() {
      // Open share actions (could show a Popover with options)
      MessageToast.show("Open share menu (implement UI as needed)");
    },

    onSendEmailPress: function() {
      // Pre-fill email; replace values as appropriate
      var subject = "Items from List Report";
      var body = "Please find the list details attached or referenced...";
      URLHelper.triggerEmail(null, subject, body);
    },

    onSaveAsTilePress: function() {
      // Save as Tile typically uses FLP services (sap.ushell.services.Personalization or Bookmark service)
      MessageToast.show("Save as Tile requested. Invoke FLP Bookmark service in FLP context.");
      // Example placeholder:
      // var oBookmarkService = sap.ushell.Container.getService("Bookmark");
      // oBookmarkService.addBookmark({...});
    },

    onFooterAction1: function() {
      MessageToast.show("Footer action triggered");
    }

  });
});
```

STEP: 3 — Manifest: Register List Report Page with Generic Template (minimal fragment)

DESCRIPTION: Configure manifest.json so the Fiori Elements runtime recognizes the List Report page. Provide an entry under sap.ui.generic.app.pages using the ListReport template name sap.suite.ui.generic.template.ListReport. Replace EntitySetName with your OData entity set.

LANGUAGE: JSON

CODE:
```json
// File: manifest.json (fragment)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "tableType": "ResponsiveTable",
            "smartVariantManagement": true,
            "showRowCount": true
          }
        },
        "navigation": {}
      }
    ]
  }
}
```

STEP: 4 — CDS / OData Annotations (Optional): Expose fields for filter bar and table

DESCRIPTION: Provide OData annotations or CDS annotations so the SmartFilterBar and SmartTable automatically render filter fields and columns. Example below shows annotation for fields and line items in a simplified JSON-like representation (convert to real annotation syntax for your stack).

LANGUAGE: JSON

CODE:
```json
// Example annotation fragments (conceptual; use actual EDMX / CDS annotation syntax)
{
  "EntityType": {
    "MyEntityType": {
      "Properties": {
        "ID": { "EdmType": "Edm.String" },
        "Name": { "EdmType": "Edm.String" },
        "CreatedAt": { "EdmType": "Edm.DateTimeOffset" }
      },
      "Annotations": {
        "UI": {
          "LineItem": [
            { "Value": "ID" },
            { "Value": "Name" },
            { "Value": "CreatedAt" }
          ],
          "SelectionFields": [
            { "Value": "Name" },
            { "Value": "CreatedAt" }
          ]
        }
      }
    }
  }
}
```

STEP: 5 — Loading Behavior and Further Configuration References

DESCRIPTION: Use the following references to refine runtime behavior and additional features:
- Loading behavior on initial launch: implement or adapt caching and initial binding strategies as described in your project's Loading Behavior documentation.
- Configure further list report features (filter behavior, multiple selection, quick variant selection) or shared behavior via manifest settings and annotations.

LANGUAGE: Text / Links

CODE:
```text
See documentation:
- Loading Behavior of Data on Initial Launch of the Application (project-specific doc or company wiki)
- Configuring List Report Features (project-specific doc)
- Configuring Further Common Features (project-specific doc)
```

Notes:
- Replace "MyEntitySet" and "MyEntityType" with actual OData entity set/type names.
- Use the Fiori Launchpad services (sap.ushell.Container.getService...) to implement Save as Tile/bookmark functionality when running inside FLP.
- For production, implement proper error handling, i18n texts, and test variant persistence keys.
--------------------------------

**TITLE**: Control initial data loading on app launch (Fiori elements V2 & V4)

**INTRODUCTION**: This document summarizes all manifest.json settings and runtime rules that determine whether list/chart data is loaded automatically when a Fiori elements app is launched. It covers navigation-context overrides, variant behavior, V2 manifest keys (dataLoadSettings.loadDataOnAppLaunch and quickVariantSelectionX.enableAutoBinding) and V4 manifest key (options.settings.initialLoad). Use the provided JSON snippets to configure automatic loading for single-view and multi-view apps.

**TAGS**: fiori-elements-framework, manifest.json, loadDataOnAppLaunch, initialLoad, quickVariantSelectionX, enableAutoBinding, ODataV2, ODataV4, ListReport, AnalyticalListPage

STEP: 1 — Core rules (navigation context, variants, Apply Automatically)
DESCRIPTION: Summarizes runtime rules that always apply regardless of manifest settings. Use this as decision logic when implementing app behavior or automated tests.
LANGUAGE: text
CODE:
```text
- If the app is launched with a navigation context (a context id passed in the target URL), data is loaded on initial launch regardless of standard-variant settings.

- If launched from a tile with no navigation context:
  - If a default variant exists, that variant is launched. Initial load follows that variant's "Apply Automatically" setting (user-managed under Manage Views).
  - If no default variant exists, the Standard variant is launched. Initial load follows manifest settings (see V2/V4 below) unless the user overrides "Apply Automatically".

- If any mandatory filter field is missing, automatic data load is NOT triggered; "Apply Automatically" is deselected for that variant.

- Recommendation: provide sensible default filter values to avoid empty charts/tables on initial launch.
```

STEP: 2 — OData V2: manifest.json setting dataLoadSettings.loadDataOnAppLaunch
DESCRIPTION: Use this manifest snippet under your page configuration to control initial load for ListReport pages. Replace <EntitySet> with your entity set name. Valid values: "always", "never", "ifAnyFilterExist" (or omit to use default behavior equivalent to "ifAnyFilterExist").
LANGUAGE: JSON
CODE:
```json
{
  "pages": {
    "ListReport|SalesOrder": {
      "entitySet": "SalesOrder",
      "component": {
        "name": "sap.suite.ui.generic.template.ListReport",
        "list": true,
        "settings": {
          "dataLoadSettings": {
            "loadDataOnAppLaunch": "always"
          }
        }
      }
    }
  }
}
```

STEP: 2a — V2: loadDataOnAppLaunch behaviors (reference)
DESCRIPTION: Use these behaviors to choose the manifest value and to implement tests or documentation.
LANGUAGE: text
CODE:
```text
- "always": Standard variant data is always loaded on app launch. Users can deselect "Apply Automatically" in Manage Views to override.

- "never": Standard variant data is not loaded automatically. Users must click Go. Users can select "Apply Automatically" to override.

- "ifAnyFilterExist" (default / undefined): Load only if default filter values exist (admin/user-saved or passed from another app). "Apply Automatically" is selected by default; users can deselect it. If any mandatory filter is missing, data load is NOT triggered and "Apply Automatically" becomes deselected.
```

STEP: 2b — V2: alternative for multi-view quickVariantSelectionX.enableAutoBinding
DESCRIPTION: For multi-view configurations, you can instead toggle quickVariantSelectionX.enableAutoBinding. SAP recommends using loadDataOnAppLaunch, but enableAutoBinding is an alternative for quickVariantSelectionX.
LANGUAGE: JSON
CODE:
```json
{
  "pages": {
    "ListReport|SalesOrder": {
      "entitySet": "SalesOrder",
      "component": {
        "name": "sap.suite.ui.generic.template.ListReport",
        "settings": {
          "quickVariantSelectionX": {
            "enableAutoBinding": false
          }
        }
      }
    }
  }
}
```

STEP: 3 — OData V4: manifest.json setting options.settings.initialLoad
DESCRIPTION: Use this options.settings.initialLoad setting for FE V4 templates (e.g., AnalyticalListPage or ObjectPage list components). Valid values: "Auto" (default), "Disabled", "Enabled". Replace component id/name/contextPath per your app.
LANGUAGE: JSON
CODE:
```json
{
  "SalesOrderManageList": {
    "type": "Component",
    "id": "SalesOrderManageList",
    "name": "sap.fe.templates.AnalyticalListPage",
    "options": {
      "settings": {
        "contextPath": "/SalesOrderManage",
        "initialLoad": "Enabled"
      }
    }
  }
}
```

STEP: 3a — V4: initialLoad behaviors (reference)
DESCRIPTION: Use these behaviors to select the correct initialLoad value and to author user guidance or tests.
LANGUAGE: text
CODE:
```text
- "Auto": Initial data loads only if default filter values are present. Default setting. "Apply Automatically" text: "If predefined filter values are available, the content loads automatically." Users can deselect to override.

- "Disabled": No initial load for the Standard variant. User must click Go. Users can select "Apply Automatically" to override.

- "Enabled": Initial load occurs for the Standard variant. Users can deselect "Apply Automatically" to override.
```

STEP: 4 — Implementation checklist and common patterns
DESCRIPTION: Quick actionable checklist and example patterns to apply in projects.
LANGUAGE: text
CODE:
```text
- Edit manifest.json in your app project.
  - For V2 ListReport: set pages.<PageName>.component.settings.dataLoadSettings.loadDataOnAppLaunch.
  - For multi-view V2: optionally set quickVariantSelectionX.enableAutoBinding (recommended: use loadDataOnAppLaunch).
  - For V4 Fiori elements: set options.settings.initialLoad at the component definition.

- Ensure navigation context behavior is respected: passing context in the FLP target mapping or URL will trigger load regardless of Standard-variant settings.

- Ensure mandatory filters are present or provide default values to avoid empty initial displays.

- Validate with end-user settings:
  - Manage Views dialog controls the "Apply Automatically" checkbox; users can override manifest defaults.
```
--------------------------------

**TITLE**: Localization of UI Texts for SAP Fiori elements (Create/Override i18n keys & manifest setup)

**INTRODUCTION**: Step-by-step, code-focused guide for developers to (1) create i18n resource files, (2) reference i18n keys from annotations, (3) add custom resource bundles, and (4) configure manifest.json so SAP Fiori elements uses application-specific text overrides. Includes sample annotation patterns (XML, ABAP CDS, CAP CDS), manifest models, recommended key formats, and full lists of template keys (OData V2 & V4) and deprecated keys to preserve.

**TAGS**: i18n, localization, sapui5, fiori-elements, manifest.json, annotations, ODataV2, ODataV4, resource-bundle

STEP: 1 — Create i18n folder structure and default properties file

DESCRIPTION: Create resource bundle folder structure inside webapp and add base i18n/i18n.properties. Follow patterns for entity-specific i18n subfolders when needed (ListReport, ObjectPage). Use these files for app-specific text overrides.

LANGUAGE: text

CODE:
```text
Folder structure (create in your app root):
<root-folder>/
  webapp/
    i18n/
      i18n.properties                          # general app-level resource bundle
      ListReport/
        <EntitySet>/
          i18n.properties                      # ListReport overrides for EntitySet
      ObjectPage/
        <EntitySet>/
          i18n.properties                      # ObjectPage overrides for EntitySet
        <SubEntitySet>/
          i18n.properties                      # Subobject page overrides

Notes:
- Number of object-page i18n files corresponds to number of object pages in the app.
- Use property files with standard Java .properties encoding (UTF-8 as required).
```

STEP: 2 — Define the @i18n resource model in manifest.json (required when annotations reference {@i18n>key})

DESCRIPTION: Add a ResourceModel entry named "@i18n" (or "i18n") in the sap.ui5.models section. Use "uri" to point to the resource bundle relative to webapp.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "models": {
      "@i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "uri": "i18n/i18n.properties"
      },
      "i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "uri": "i18n/i18n.properties"
      },
      "i18n|sap.suite.ui.generic.template.ListReport|POHeaders": {
        "type": "sap.ui.model.resource.ResourceModel",
        "uri": "i18n/ListReport/POHeaders/i18n.properties"
      },
      "i18n|sap.suite.ui.generic.template.ObjectPage|POHeaders": {
        "type": "sap.ui.model.resource.ResourceModel",
        "uri": "i18n/ObjectPage/POHeaders/i18n.properties"
      },
      "i18n|sap.suite.ui.generic.template.ObjectPage|POItems": {
        "type": "sap.ui.model.resource.ResourceModel",
        "uri": "i18n/ObjectPage/POItems/i18n.properties"
      }
    }
  }
}
```

STEP: 3 — Reference i18n keys in annotations (XML, ABAP CDS, CAP CDS)

DESCRIPTION: Use {@i18n>KeyName} in annotations where label text should come from the app's resource bundle. Ensure the app defines the @i18n model (see STEP 2). Add the referenced key to the appropriate i18n properties file.

LANGUAGE: XML

CODE:
```xml
<!-- XML Annotation sample: UI.LineItem with i18n reference -->
<Annotation Term="UI.LineItem">
  <Collection>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Add random item"/>
      <PropertyValue Property="Action" String="com.c_salesordermanage_sd.AddRandomItem"/>
    </Record>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="{@i18n>CopyActionText}"/>
      <PropertyValue Property="Action" String="com.c_salesordermanage_sd.CopyItem"/>
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.lineItem: [
  {
    label: 'Add random item',
    dataAction: 'PUSHDOWN:com.c_salesordermanage_sd.AddRandomItem',
    type: #FOR_ACTION,
    position: 1 
  },
  {
    label: '{@i18n>CopyActionText}',
    dataAction: 'PUSHDOWN:com.c_salesordermanage_sd.CopyItem',
    type: #FOR_ACTION,
    position: 2 
  }
];
```

LANGUAGE: CAP CDS

CODE:
```javascript
// CAP CDS (example fragment):
LineItem : [
  {
    $Type  : 'UI.DataFieldForAction',
    Label  : 'Add random item',
    Action : 'com.c_salesordermanage_sd.AddRandomItem'
  },
  {
    $Type  : 'UI.DataFieldForAction',
    Label  : '{@i18n>CopyActionText}',    // i18n key
    Action : 'com.c_salesordermanage_sd.CopyItem'
  }
  // ...
]
```

STEP: 4 — Add/override keys in i18n properties files (app-level or entity-specific)

DESCRIPTION: Add key=value lines to the chosen properties file (app-level or entity-specific). Use plain property format. Add only the keys you need to change.

LANGUAGE: Properties

CODE:
```properties
# webapp/i18n/i18n.properties (app-level)
CopyActionText=Copy Selected Item
CREATE_OBJECT=Create
CREATE_DIALOG_TITLE=New Object

# webapp/i18n/customSalesOrderLR.properties (example custom resource bundle)
C_OPERATIONS_ACTION_CONFIRM_MESSAGE|SalesOrderManage|ReturnInProcess=Confirm the returns?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL|SalesOrderManage=Delete the selected Sales Orders?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR|SalesOrderManage=Delete this Sales Order?
```

STEP: 5 — Configure enhanceI18n in manifest.json targets (Fiori elements will load custom bundle)

DESCRIPTION: To tell Fiori elements to load your custom resource bundle for a template target (ListReport, ObjectPage, etc.), add "enhanceI18n": "<path to properties>" under options.settings of the target in manifest.json.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "type": "Component",
          "id": "SalesOrderManageList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/SalesOrderManage",
              "enhanceI18n": "i18n/customSalesOrderLR.properties"
            }
          }
        }
      }
    }
  }
}
```

STEP: 6 — Key naming conventions and examples (formatting for shared vs entity/action-specific keys)

DESCRIPTION: Use base key names for global overrides. To scope overrides to an entity set or navigation property, append either "|<EntitySet>" or "|<NavigationProperty>" or include action name: "|<EntitySet>|<ActionName>". For navigation entity sets use the navigation property name (e.g. _Items).

LANGUAGE: text

CODE:
```text
Rules & Examples:
- Global override (applies to all templates / entities):
  C_COMMON_DIALOG_OK=Okie?

- Entity-specific override (main entity):
  C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR|SalesOrderManage=Delete this Sales Order?

- Navigation entity (use navigation property name):
  C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR|_Items=Delete this Sales Order Item?

- Action-specific override (entity + action):
  C_OPERATIONS_ACTION_CONFIRM_MESSAGE|SalesOrderManage|ReturnInProcess=Confirm the returns?
  C_OPERATIONS_ACTION_CONFIRM_MESSAGE|_Items|ReturnInProcess=Confirm the returns for the selected items?

Notes:
- If action-name or entity name is not appended, SAP Fiori elements falls back to its default resource bundle.
- Always include the entity set name or navigation property name when overriding action parameter popovers or confirmation popovers.
```

STEP: 7 — Example: Add a copy action key used in annotation (complete flow)

DESCRIPTION: Example flow: annotation references {@i18n>CopyActionText} → add key to webapp/i18n/i18n.properties → ensure @i18n ResourceModel is defined in manifest (STEP 2).

LANGUAGE: Properties

CODE:
```properties
# webapp/i18n/i18n.properties
CopyActionText=Copy Selected Item
```

STEP: 8 — OData V2 — List of List Report-specific keys from template lib (quick reference)

DESCRIPTION: List of keys available for overriding in List Report (source: ..>>lib>i18n). Use these exact key names in your custom properties file to override default texts. (Add only keys you need.)

LANGUAGE: text

CODE:
```text
List Report Specific Key from ..>>lib>i18n
Key: ST_GENERIC_UNSAVED_CHANGES_CHECKBOX
Default: Also delete objects with unsaved changes.
Used In: Delete confirmation dialog when multiple objects include unsaved changes.

Key: ST_GENERIC_DELETE_SELECTED_PLURAL
Default: Delete the selected objects?
Used In: Delete confirmation dialog for multiple active/own draft objects.

Key: ST_GENERIC_DELETE_UNSAVED_CHANGES
Default: Another user edited this object without saving the changes: {1}  Delete anyway?
Used In: Delete confirmation when object includes unsaved changes by another user.

Key: ST_GENERIC_DELETE_UNSAVED_CHANGES_PLURAL
Default: Other users have edited the selected objects without saving the changes. Delete them anyway?
Used In: Delete confirmation for multiple objects with unsaved changes.

Key: ST_GENERIC_DELETE_LOCKED
Default: This object cannot be deleted. It is currently locked by {1}.
Used In: Confirmation when object is locked by another user.

Key: ST_GENERIC_NOT_DELETABLE
Default: This object cannot be deleted.
Used In: When object is non-deletable.

Key: ST_GENERIC_DELETE_LOCKED_PLURAL
Default: The selected objects are currently locked by other users and cannot be deleted.
Used In: Multiple objects locked by others.

Key: ST_GENERIC_DELETE_UNDELETABLE
Default: {0} of {1} objects cannot be deleted.
Used In: Delete confirmation when some selected objects can't be deleted.

Key: ST_GENERIC_CURRENTLY_LOCKED_PLURAL
Default: {0} of {1} objects are currently locked by other users and cannot be deleted.
Used In: Delete confirmation where some are locked.

Key: ST_GENERIC_DELETE_REMAINING
Default: Do you still want to delete the remaining object?
Used In: When some selections are locked/non-deletable but one can be deleted.

Key: ST_GENERIC_DELETE_REMAINING_PLURAL
Default: Do you still want to delete the remaining {0} objects?
Used In: Same as above (plural).

Key: ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES
Default: The remaining object has unsaved changes. Do you still want to delete it?
Used In: Remaining object has unsaved changes by other user.

Key: ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES_PLURAL
Default: The remaining objects have unsaved changes by other users. Do you still want to delete them?
Used In: Same as above (plural).

Key: ST_GENERIC_DELETE_SUCCESS_PLURAL
Default: Objects were deleted.
Used In: Success toast for multiple deletions.

Key: ST_GENERIC_DELETE_ERROR
Default: The selected object cannot be deleted.
Used In: Toast when deletion fails at backend.
```

STEP: 9 — OData V2 — ListReport > i18n keys (List Report target specific)

DESCRIPTION: Common List Report keys stored under ..>>ListReport>i18n. Override by providing same key in ListReport entity-specific properties file.

LANGUAGE: text

CODE:
```text
List Report Specific Key from ..>>ListReport>i18n
Key: CREATE_OBJECT
Default: Create
Used In: Label for create buttons in list report.

Key: CREATE_DIALOG_TITLE
Default: New Object
Used In: Title of Create dialog (createWithParameterDialog configured).

Key: PARTIAL_UPDATE
Default: {0} of {1} objects updated ??
Used In: Message box after partial update (mass edit).

Key: DIALOG_TITLE_NEW_ACTION_FOR_CREATE
Default: Create Object
Used In: Param dialog title for NewAction.

Key: DIALOG_ACTION_BUTTON_NEW_ACTION_FOR_CREATE
Default: Continue
Used In: Button label in action parameter dialog.

Key: MULTI_EDIT_DIALOG_TITLE
Default: Edit ({0})
Used In: Mass edit dialog title.
```

STEP: 10 — OData V2 — ObjectPage > i18n keys (Object page target specific)

DESCRIPTION: Object page keys stored under ..>>ObjectPage>i18n and lib. Override where relevant.

LANGUAGE: text

CODE:
```text
Key: DRAFT_LOCK_EXPIRED
Default: Another user edited this object without saving the changes: {0} If you take over, any changes will be lost.
Used In: Confirmation when editing an object with expired lock.

Key: OBJECT_SAVED
Default: Your changes have been saved
Used In: Toast on successful save.

Key: ITEM_CREATED
Default: Item created
Used In: Toast on successful sub-object/item creation.

Key: WAITING_SMARTTABLE
Default: Please wait while the data is loading...
Used In: Smart table while loading.

Key: OBJECT_NOT_MODIFIED
Default: You haven't made any changes
Used In: Toast when Save is pressed but no changes present.

Key: OBJECT_CREATED
Default: Object was created.
Used In: Toast on object created.

Key: DELETE_WITH_OBJECTINFO
Default: Delete this object ({1} {2})?
Used In: Delete confirmation in flexible column layout.

Key: DELETE_WITH_OBJECTTITLE
Default: Delete Object {0}?
Used In: Delete confirmation in full screen mode with title.

Key: SHOW_SIDE_CONTENT / HIDE_SIDE_CONTENT
Default: Show Details / Hide Details
Used In: Toggle side content button labels.

Key: DELETE_SELECTED_ITEM
Default: Delete Item?
Used In: Delete confirmation for items without title/description.

Key: DELETE_SELECTED_ITEMS
Default: Delete the selected items?
Used In: Delete confirmation from object page smart table.

Key: DELETE_SUCCESS_PLURAL_WITH_COUNT
Default: {0} items have been deleted.
Used In: Toast for multiple item deletion.

Key: DELETE_SUCCESS_WITH_COUNT
Default: {0} item has been deleted.
Used In: Toast for single item deletion.

Key: DELETE_ERROR_PLURAL_WITH_COUNT, DELETE_ERROR_WITH_COUNT, DELETE_ERROR
Default: {various}
Used In: Errors on delete operations.

Key: ITEM_DELETED
Default: Item deleted
Used In: Toast for single item deletion.

Key: DELETE_UNDELETABLE_ITEMS / DELETE_UNDELETABLE_ITEM
Default: {0} of {1} items cannot be deleted. / This item cannot be deleted.
Used In: Messages when some items are non-deletable.

Key: ENTER_MANDATORY
Default: Enter a value for field: {0}
Used In: Message popover for InsertRestriction-based mandatory fields (non-draft).

Key: CREATE_DIALOG_TITLE
Default: New Item
Used In: Create dialog title for object page table.
```

STEP: 11 — OData V2 — Object Page + Subobject Page keys from ..>>lib>i18n (common)

DESCRIPTION: Common delete/draft/error related keys used across ObjectPage/SubobjectPage.

LANGUAGE: text

CODE:
```text
Key: ST_GENERIC_DELETE_SELECTED
Default: Delete this object?
Used In: Delete confirmation for deleting object without object title (header delete).

Key: ST_GENERIC_DRAFT_LOCKED_BY_USER
Default: Another user edited this object without saving the changes: {1} If you take over, any changes will be lost.
Used In: Confirmation when object is locked by another user.

Key: DELETE_WITH_OBJECTTITLE
Default: Delete Object {0}?
Used In: Delete confirmation when object has title.

Key: ST_GENERIC_OBJECT_DELETED
Default: Object was deleted.
Used In: Toast on successful deletion.

Key: REQUIRED_PROP_ERROR|<EntitySet>|<navigationProperty>| com.sap.vocabularies.UI.v1.LineItem|<Required Property Name>
Default: Enter a value.
Used In: Required field missing message (draft cannot be created).
```

STEP: 12 — OData V2 — Shared keys across List Report, Object Page and ALP (lib i18n)

DESCRIPTION: Keys for no-data states, draft/lock messages, message strips and general confirmation texts.

LANGUAGE: text

CODE:
```text
Examples:
- ST_GENERIC_LOCKED_OBJECT_POPOVER_TEXT
  Default: You cannot edit this object at the moment. It is locked by {0}
  Used In: Edit attempt while object locked.

- ST_GENERIC_UNSAVED_OBJECT_POPOVER_TEXT
  Default: This object has unsaved changes by {0}.
  Used In: Popover showing unsaved changes by another user.

- NEW_OBJECT
  Default: New Object
  Used In: Header title for newly created drafts/unsaved objects.

- UNNAMED_OBJECT
  Default: Unnamed Object
  Used In: Header title for draft objects in edit mode.

- NOITEMS_SMARTTABLE / NOITEMS_SMARTTABLE_WITH_FILTER / NOITEMS_SMARTTABLE_WITH_FILTER_FOR_SEGMENTEDBUTTON
  Defaults: No items available. / No items available. Try adjusting the search or filter parameters. / There are no items for the selected filter criteria and table view.
  Used In: No-data displays for tables with/without filter and segmented buttons.

- NOITEMS_SMARTCHART / NOITEMS_LR_SMARTCHART / NOITEMS_SMARTCHART_WITH_FILTER
  Defaults: No data found. / There is no data for the selected filter criteria and chart view. / No data found. Try adjusting the filter parameters.
  Used In: Chart no-data states.

- SMARTCHART_INITIAL_NODATA / NOITEMS_LR_SMARTTABLE / NODATA_SMARTTABLE_LR
  Defaults: To start, set the relevant filters and choose "Go".
  Used In: Search-triggered vs initial no-data states.

- ACTION_CONFIRM (note: can also be ACTION_CONFIRM|<EntitySetName><ActionName>)
  Default: Confirm this action?
  Used In: Action confirmation popover.
```

STEP: 13 — OData V2 — AnalyticalPage keys

DESCRIPTION: Keys used on Analytical List Page (ALP) for chart/table no-data and message strips.

LANGUAGE: text

CODE:
```text
Key: NODATA_SMARTCHART_ALP
Default: To start, set the relevant filters and choose "Go".
Used In: ALP smart chart when no search triggered.

Key: NODATA_SMARTTABLE_ALP
Default: To start, set the relevant filters and choose "Go".
Used In: ALP smart table when no search triggered.

Key: MESSAGE_MULTIPLE_VALUES_L_FORM / MESSAGE_MULTIPLE_VALUES_S_FORM
Defaults: Some of the filters aren't relevant for the tab "{1}" ({0}). Settings these filters has no effect on the results. / You can't use the following filters on the "{1}" tab: "{0}"
Used In: Message strip when filters not relevant for selected tab (desktop vs mobile).
```

STEP: 14 — OData V4 — Allowed override keys (sap.fe.templates; use enhanceI18n similarly)

DESCRIPTION: For OData V4 template-based apps using sap.fe.templates, only the keys in this allowed list may be overwritten via a custom resource bundle. Developer recommendations are included per key; use the exact key names. (Add only keys you need.)

LANGUAGE: text

CODE:
```text
OData V4 - Keys you can override (examples & recommendations)
- C_OPERATIONS_ACTION_CONFIRM_MESSAGE
  Default: Confirm this action?
  Recommendation: Replace with shorter or concrete action name.

- C_COMMON_DIALOG_OK
  Default: OK
  Recommendation: Overwrite with action name when used as action confirm.

- C_OPERATIONS_ACTION_PARAMETER_REQUIRED
  Default: Invalid entry
  Recommendation: Provide a specific message.

- C_COMMON_ACTION_PARAMETER_DIALOG_CANCEL
  Default: Cancel

- C_ACTION_PARTIAL_FRAGMENT_SAPFE_BOUND_ACTION
  Default: 1 selected object can't be processed.
  Recommendation: Overwrite with concrete object name (e.g. '1 selected sales order can't be processed.')

- C_ACTION_PARTIAL_FRAGMENT_SAPFE_BOUND_ACTION_PLURAL
  Default: {0} selected objects can't be processed.
  Recommendation: Overwrite with concrete object name.

- C_APP_COMPONENT_SAPFE_ETAG_LATE_PROPERTY
  Default: This action may not work. Refresh the data to work with the most recent version.

- M_FIELD_RUNTIME_DRAFT_POPOVER_LOCKED_BY_KNOWN
  Default: This object is currently being edited by {0}.
  Recommendation: Overwrite with concrete object.

- M_FIELD_RUNTIME_DRAFT_POPOVER_UNSAVED_CHANGES_BY_KNOWN
  Default: This object has unsaved changes made by {0}.
  Recommendation: Overwrite with concrete object.

- M_FIELD_RUNTIME_DRAFT_POPOVER_UNSAVED_CHANGES_BY_UNKNOWN
  Default: This object has unsaved changes made by another user.
  Recommendation: Overwrite with concrete object.

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_SINGLE_OBJECT_LOCKED
  Default: This object is currently locked by {0} so it cannot be deleted.

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO
  Default: Delete object {0} "{1}"?
  Details: Parameters {0} = UI.HeaderInfo.Title, {1} = UI.HeaderInfo.Description.
  Logic: fallback to other keys if header info missing.

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_ONLY
  Default: Delete object {0}?

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR
  Default: Delete this object?

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL
  Default: Delete the selected objects?

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_CHANGES
  Default: The selected object has unsaved changes by {0}. Delete anyway?

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_CHANGES_MULTIPLE_OBJECTS
  Default: The selected objects have unsaved changes by other users. Delete anyway?

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL_NON_DELETABLE
  Default: Delete the remaining objects?

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR_NON_DELETABLE
  Default: Delete the remaining objects?

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_ONE_OBJECT_NON_DELETABLE
  Default: 1 out of {0} selected objects has delete restrictions so it cannot be deleted.

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_NON_DELETABLE
  Default: {0} out of {1} selected objects have delete restrictions so they cannot be deleted.

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_LOCKED
  Default: {0} out of {1} objects are currently locked so they cannot be deleted.

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_ONE_OBJECT_LOCKED
  Default: 1 out of {0} selected objects is currently locked by {1} so it cannot be deleted.

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_AND_FEW_OBJECTS_LOCKED_SINGULAR
  Default: The remaining object has unsaved changes made by {0}. Do you still want to delete it?

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_AND_FEW_OBJECTS_LOCKED_PLURAL
  Default: The remaining objects have unsaved changes made by other users. Do you still want to delete them?

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_UNSAVED_SINGULAR
  Default: Also delete objects with unsaved changes by {0}?

- C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_UNSAVED_PLURAL
  Default: Also delete objects with unsaved changes by other users?

- C_TRANSACTION_HELPER_DELETE_TOAST_SINGULAR
  Default: Object deleted.

- C_TRANSACTION_HELPER_DELETE_TOAST_PLURAL
  Default: Objects were deleted.

- C_COMMON_OBJECT_PAGE_CANCEL
  Default: Cancel

- C_TRANSACTION_HELPER_OBJECT_CREATED
  Default: Object created

- C_TRANSACTION_HELPER_OBJECT_SAVED
  Default: Object saved

- C_TRANSACTION_HELPER_DRAFT_DISCARD_MESSAGE
  Default: Discard all changes?

- C_TRANSACTION_HELPER_DRAFT_DISCARD_BUTTON
  Default: Discard

- C_COMMON_OBJECT_PAGE_DISCARD_DRAFT
  Default: Discard Draft

- T_TABLE_AND_CHART_NO_DATA_TEXT
  Default: To start, set the relevant filters and choose "Go".

- T_TABLE_AND_CHART_NO_DATA_TEXT_WITH_FILTER
  Default: No data found. Try adjusting the search or filter parameters.

- M_TABLE_AND_CHART_NO_DATA_TEXT_MULTI_VIEW
  Default: There are no items for the selected filter criteria and view.

- M_TABLE_AND_CHART_NO_FILTERS_NO_DATA_TEXT
  Default: No items available.

- C_ROUTING_NAVIGATION_DISABLED_TITLE
  Default: Navigation is currently not possible.

- T_ANNOTATION_HELPER_DEFAULT_HEADER_TITLE_NO_HEADER_INFO
  Default: Unnamed Object

- C_DRAFT_OBJECT_PAGE_DRAFT_UNSAVED_CHANGES
  Default: Another user edited this object without saving the changes: {0} If you start editing, those changes will be lost.

- C_DRAFT_OBJECT_PAGE_DRAFT_LOCKED_BY_USER
  Default: You can't edit this object at the moment. It is locked by {0}.

- Various paginator & accessibility (screen reader) and draft dataloss popup keys...
(Use exact key names when overriding; refer to SAP Fiori elements documentation for remaining keys.)
```

STEP: 15 — OData V4 — Deprecated keys list

DESCRIPTION: Keys deprecated in the OData V4 template; do not use these for overrides. Provided for reference and migration.

LANGUAGE: text

CODE:
```text
Deprecated keys (OData V4):
- C_EDIT_FLOW_GENERIC_LOCKED_OBJECT_POPOVER_TEXT_ADDITIONAL_USER
  Message Handling: The scenario no longer occurs.
  Used In: Draft info when owner not available (deprecated).

- C_COMMON_APPLY_ERROR
  Message Handling: Regular message handling invoked on any errors.
  Used In: Error while saving an object.

- C_TRANSACTION_HELPER_TRANSIENT_CONTEXT_MESSAGE
  Message Handling: Regular message handling invoked on errors.
  Used In: Error short text when backend update cannot be done due to availability/connection issues.

- C_TRANSACTION_HELPER_TRANSIENT_CONTEXT_DESCRIPTION
  Message Handling: Regular message handling invoked on errors.
  Used In: Error description when backend update cannot be done due to availability/connection issues.
```

STEP: 16 — Best practices & notes (action-oriented)

DESCRIPTION: Actionable recommendations to implement overrides safely.

LANGUAGE: text

CODE:
```text
Best practices:
- Only add keys you need to change (reduces translation cost).
- For annotation text referencing, always ensure the @i18n model exists in manifest.json.
- For action/confirmation popovers always append entity set and action name to key when overriding (mandatory for action-specific messages).
- For navigation entity overrides use navigation property name (e.g., _Items) not the target entity set.
- Use entity-specific i18n files (i18n/ListReport/<EntitySet>/i18n.properties) for scoped overrides; use enhanceI18n target setting to point to custom bundle.
- Validate your property files (UTF-8) and reload app/component to verify custom texts are applied.
- If a default text is not overridable (generic application component texts), you cannot change them through enhanceI18n.
```


--------------------------------

**TITLE**: Maintaining and Overriding Standard Texts for Charts (SAP Fiori elements)

**INTRODUCTION**: This guide explains how to override the standard "no data" UI texts shown in charts for SAP Fiori elements apps (OData V2 and OData V4). It lists the i18n keys to change, shows default values, highlights limitations, and gives ready-to-drop i18n examples. Use these entries in your app's i18n properties file (typically webapp/i18n/i18n.properties).

**TAGS**: fiori-elements, i18n, smartchart, smarttable, no-data, ODataV2, ODataV4, localization

STEP: 1 — Locate your i18n file
DESCRIPTION: Confirm the resource bundle file used by your app and its path. Common default path: webapp/i18n/i18n.properties (or i18n_en.properties for language variants). If needed, confirm manifest.json model configuration.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "models": {
      "i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "settings": {
          "bundleName": "your.app.namespace.i18n.i18n"
        }
      }
    }
  }
}
```

STEP: 2 — Override standard texts for SAP Fiori elements (OData V2)
DESCRIPTION: Add or change these keys in your i18n properties to override default chart messages in OData V2 apps. Replace right-hand values with your localized/custom messages.
LANGUAGE: Properties
CODE:
```properties
# webapp/i18n/i18n.properties (OData V2 - SmartChart messages)
# When no filters are applied and no data is found (object page chart)
NOITEMS_SMARTCHART=No data found.

# When filters are applied and search shows no results (object page chart)
NOITEMS_SMARTCHART_WITH_FILTER=No data found. Try adjusting the search or filter parameters.

# When no filters are applied and no data is found (list report chart)
NOITEMS_LR_SMARTCHART=To start, set the relevant filters and choose "Go".
```

STEP: 3 — Override standard texts for SAP Fiori elements (OData V4)
DESCRIPTION: For OData V4, use these keys in the i18n properties. Default texts are shown for reference — override values as required. Note usage context for each key (List Report vs. multi-view List Reports).
LANGUAGE: Properties
CODE:
```properties
# webapp/i18n/i18n.properties (OData V4 - List report and multi-view messages)

# To add a text when no filters are applied and no data is found (List Report)
# Default: To start, set the relevant filters and choose "Go".
T_TABLE_AND_CHART_NO_DATA_TEXT=To start, set the relevant filters and choose "Go".

# To add a text when filters are applied and no data is found (List Report)
# Default: Try adjusting the search or filter criteria.
T_TABLE_AND_CHART_NO_DATA_TEXT_WITH_FILTER=Try adjusting the search or filter criteria.

# To add a text for list reports with multiple views when filters are applied and no data is found
# Default: Try adjusting the selected filter criteria or view.
M_TABLE_AND_CHART_NO_DATA_TEXT_MULTI_VIEW=Try adjusting the selected filter criteria or view.
```

STEP: 4 — Examples: localized/customized entries
DESCRIPTION: Example customizing messages. Use simple string values; quotes inside values are allowed. Add translations for other locales in language-specific property files (e.g., i18n_de.properties).
LANGUAGE: Properties
CODE:
```properties
# Example custom English messages
NOITEMS_SMARTCHART=No chart data available.
NOITEMS_SMARTCHART_WITH_FILTER=No results. Please change your filters or search terms.
NOITEMS_LR_SMARTCHART=No data to display. Set filters and press "Go".

T_TABLE_AND_CHART_NO_DATA_TEXT=Set filters and press "Go" to display chart data.
T_TABLE_AND_CHART_NO_DATA_TEXT_WITH_FILTER=No data found. Adjust filter or search criteria.
M_TABLE_AND_CHART_NO_DATA_TEXT_MULTI_VIEW=No matching data in this view. Try a different view or modify filters.
```

STEP: 5 — Limitations and important notes
DESCRIPTION: Keep these constraints in mind when customizing:
- You cannot override the title of illustrated messages used by OData V4 illustrated "no data" views.
- For OData V4 object page illustrated messages where no search nor filters are applied, the title "No item available" and description "When there are, you'll find them here." cannot be overridden.
- Keys apply to specific contexts (List Report vs Object Page). Use the keys outlined above for the intended page type.

STEP: 6 — Verify changes at runtime
DESCRIPTION: Reload the application (clear cache if needed) and navigate to affected List Report / Object Page charts. Trigger both "no filters" and "filters applied" scenarios to confirm that your i18n values are used.
LANGUAGE: None
CODE:
```text
- Run the app (e.g., npm start / Fiori launchpad)
- Open List Report and Object Page with charts
- Test: no filters -> see T_TABLE_AND_CHART_NO_DATA_TEXT / NOITEMS_LR_SMARTCHART
- Test: filters applied but no results -> see T_TABLE_AND_CHART_NO_DATA_TEXT_WITH_FILTER / NOITEMS_SMARTCHART_WITH_FILTER
```
--------------------------------

**TITLE**: Maintain and Override Standard Table Texts via i18n (SAP Fiori elements)

**INTRODUCTION**: Quick reference to override standard UI texts shown by tables (list report and object page) in SAP Fiori elements apps for OData V2 and OData V4. Shows i18n keys, exact key formats, file locations, and concrete examples to paste into your i18n properties file.

**TAGS**: fiori-elements-framework, i18n, smarttable, list-report, object-page, odata-v2, odata-v4, localization

**STEP**: 1 — i18n file location
**DESCRIPTION**: Add or edit text keys in your app's i18n properties file. Common locations:
- Global app i18n: webapp/i18n/i18n.properties (or language-specific like i18n_en.properties)
- Page-specific i18n: if your page is configured with a dedicated i18n file in the manifest, edit that file instead.

**LANGUAGE**: Text / File path
**CODE**:
```text
# Typical location:
webapp/i18n/i18n.properties
# or language specific:
webapp/i18n/i18n_en.properties
```

**STEP**: 2 — Override standard texts for OData V2 (List Report)
**DESCRIPTION**: Add these keys to the list report i18n file to change messages for empty tables and when filters are applied.
- NOITEMS_LR_SMARTTABLE: message when no filters applied and table is empty.
- NOITEMS_LR_SMARTTABLE_WITH_FILTER: message when filters applied and no data found.
- NOITEMS_MULTIVIEW_LR_SMARTTABLE_WITH_FILTER: message for multi-view mode when filters applied and no data found.

**LANGUAGE**: properties
**CODE**:
```properties
# List Report (OData V2) - add to i18n.properties
NOITEMS_LR_SMARTTABLE=No items available. Try adding some entries.
NOITEMS_LR_SMARTTABLE_WITH_FILTER=No items found. Adjust your filters or search.
NOITEMS_MULTIVIEW_LR_SMARTTABLE_WITH_FILTER=No items for the selected view and filter criteria.
```

**STEP**: 3 — Override standard texts for OData V2 (Object Page)
**DESCRIPTION**: Use the following key pattern in the object page i18n file to target specific SmartTable instances. Replace <EntitySetName> and <SmartTableId> with your values. Examples given below.

Key patterns:
- NOITEMS_SMARTTABLE|<EntitySetName>|<SmartTableId>=<text>
- NOITEMS_SMARTTABLE_WITH_FILTER|<EntitySetName>|<SmartTableId>=<text>
- NOITEMS_SMARTTABLE_WITH_FILTER_FOR_SEGMENTEDBUTTON|<EntitySetName>|<SmartTableId>=<text>

**LANGUAGE**: properties
**CODE**:
```properties
# Object Page (OData V2) - examples
# Format: NOITEMS_SMARTTABLE|<EntitySetName>|<SmartTableId>=<Your text>

# Example: no filters applied, table empty
NOITEMS_SMARTTABLE|C_STTA_SalesOrder_WD_20|ContactsID=No contacts found.

# Example: filters applied, no data found
NOITEMS_SMARTTABLE_WITH_FILTER|C_STTA_SalesOrder_WD_20|ContactsID=No contacts found. Change filters.

# Example: segmented button + filters, no data found for the selected segment/view
NOITEMS_SMARTTABLE_WITH_FILTER_FOR_SEGMENTEDBUTTON|C_STTA_SalesOrder_WD_20|ContactsID=No contacts found for the selection criteria.
```

**STEP**: 4 — Override illustrated message descriptions for OData V4
**DESCRIPTION**: For OData V4, the illustrated messages use a title and a description. You can override the description text only. Add these keys to the page-level i18n file (or app i18n if page uses it).

Description keys:
- T_TABLE_AND_CHART_NO_DATA_TEXT — default: To start, set the relevant filters and choose "Go".
- T_TABLE_AND_CHART_NO_DATA_TEXT_WITH_FILTER — default: Try adjusting the search or filter criteria.
- M_TABLE_AND_CHART_NO_DATA_TEXT_MULTI_VIEW — default: Try adjusting the selected filter criteria or view.

Important: You cannot override the illustrated message title; only the description keys above are customizable.

**LANGUAGE**: properties
**CODE**:
```properties
# Illustrated message descriptions (OData V4) - add to i18n.properties for the page
T_TABLE_AND_CHART_NO_DATA_TEXT=To start, set the relevant filters and press "Go".
T_TABLE_AND_CHART_NO_DATA_TEXT_WITH_FILTER=No results. Try adjusting the search or filter criteria.
M_TABLE_AND_CHART_NO_DATA_TEXT_MULTI_VIEW=No results for the selected view. Try changing the view or filters.

# Note: titles of illustrated messages cannot be overridden via i18n.
```

**STEP**: 5 — Default message mapping (reference)
**DESCRIPTION**: Quick reference of default messages used by Fiori elements (preserve behavior if not overridden).

**LANGUAGE**: properties (comments)
**CODE**:
```properties
# Default message mapping (do not add unless overriding)
# OData V2 defaults:
# - No filters, object page table: "No items available."
# - No filters, list report: "To start, set the relevant filters and choose \"Go\"."
# - With filters, object page: "No items available. Try adjusting the search or filter parameters."
# - With filters, list report: "No data found. Try adjusting the search or filter criteria."
# - Multi-view, no data (object page): "There are no items for the selected filter criteria and table view."
# - Multi-view, no data (list report): "There is no data for the selected filter criteria and table view."

# OData V4 defaults (illustrated messages):
# - List report, no filters: title "No data found", description "To start, set the relevant filters and choose \"Go\"."
# - List report, with filters: title "No data found", description "Try adjusting the search or filter criteria."
# - Multi-view: title "No data found", description "Try adjusting the selected filter criteria or view."
# - Object page, no search nor filters: title "No items available", description "When there are, you'll find them here." (title/description not overrideable)
```
--------------------------------

**TITLE**: Managing Variants — Configure and Use Variant Management in SAP Fiori Elements

**INTRODUCTION**: This guide explains how to configure page-level and control-level variant management in SAP Fiori Elements (OData V2 and V4), shows manifest.json snippets to enable/disable each mode, and documents runtime behavior (which variant loads on initial launch). Use these snippets directly in webapp/manifest.json and follow the behavioral notes when writing app logic or tests.

**TAGS**: fiori-elements-framework, manifest.json, variant-management, smartVariantManagement, variantManagement, OData-v2, OData-v4, ListReport, ObjectPage

STEP: 1 — Modes and important rules

DESCRIPTION: Summary of variant management modes and key rules to follow in code/configuration. Do not enable both modes at the same time for the same page/control.

LANGUAGE: Text

CODE:
```text
- Page-level variant management:
  - Captures: filter selection, filter mode, view mode, auto-hide icon state (eye-icon),
    chart & table configuration (measures/dimensions), sort order, grouping.
  - Enabled by default.

- Control-level variant management:
  - Defines separate variants for controls (e.g., filters and table sections).
  - Filter variant stores filter area selections and filter mode only.
  - Useable on List Report and Object Page (requires enabling as shown below).

- Important rules:
  - Do NOT use page-level and control-level management simultaneously for the same page,
    as this confuses end users.
  - For Object Page specifics, consult: enabling-variant-management-on-the-object-page-f26d42b.md
```

STEP: 2 — Configure Variant Management for OData V2 (smartVariantManagement)

DESCRIPTION: Add or change smartVariantManagement in webapp/manifest.json under "sap.ui.generic.app". Setting smartVariantManagement true enables page-level management; false enables control-level management. If undefined, default is true. The SAP Fiori generator sets defaults: List Report/Object Page/Worklist => true; Analytical List Page => false.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "XXXXXX_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "gridTable": false,
            "multiSelect": false,
            "smartVariantManagement": true
          }
        }
      }
    ]
  }
}
```

Notes:
- Set "smartVariantManagement": true to enable page-level variant management.
- Set "smartVariantManagement": false to enable control-level variant management.
- You can also change this via the SAP Page Editor (UI tool).

STEP: 3 — Configure Variant Management for OData V4 (variantManagement)

DESCRIPTION: Set variantManagement for routing targets in webapp/manifest.json under "sap.ui5.routing.targets.[YourTarget].options.settings.variantManagement". Possible values: "Page" (enable page-level), "None" (disable page-level => control-level enabled).

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "variantManagement": "Page"
            }
          }
        },
        "SalesOrderManageObject": {
          "options": {
            "settings": {
              "variantManagement": "None"
            }
          }
        }
      }
    }
  }
}
```

Notes:
- "Page" = page-level variant management.
- "None" = page-level disabled (controls can use control-level variant management).
- This setting can also be modified by the Page Editor.

STEP: 4 — Which Variant Loads on Initial Load (behavior to consider in code/tests)

DESCRIPTION: Behavior rules to implement or test when your app is launched. Use these rules to write startup logic or to design automated UI tests that assert expected variant and filter state.

LANGUAGE: Text

CODE:
```text
Behavior summary:

- Table and chart controls:
  - SAP Fiori elements loads the end-user's default variant (the variant marked as default).

- Filter control or page variant:
  - If app is launched through external navigation with a navigation context
    (URL parameters or xAppState):
      - Incoming navigation context is applied and overwrites filter values of the
        end-user default variant.
      - Result: Filterbar shows "Standard*" where "*" means variant is modified/not clean.
      - Table/chart personalizations from the user's default variant are retained.

    Example external URL that overrides filters:
      /SalesOrders?salesOrganization=1000
      (Any incoming filter parameter or xAppState will override stored filter values.)

  - If navigation to the List Report happens with NO navigation context:
      - Loads the end-user default variant (if configured).
      - If no end-user default variant exists, falls back to "Standard" variant.
      - In this no-navigation-context case, FLP end-user default values are applied.

Use this logic when implementing startup handling or when writing tests that verify filterbar and table/chart states.
```

STEP: 5 — Enable Control-Level Variant Management on Object Page (reference)

DESCRIPTION: For Object Page use, enable control-level variant management explicitly as needed. If using OData V2 set smartVariantManagement to false for the page; if using OData V4 set variantManagement to "None" for the target. See project-specific docs for additional steps.

LANGUAGE: Text

CODE:
```text
- For OData V2 (manifest.json):
  Set "smartVariantManagement": false in the ListReport/ObjectPage settings:
  (See Step 2 JSON fragment.)

- For OData V4 (manifest.json):
  Set "variantManagement": "None" under the routing target options.settings:
  (See Step 3 JSON fragment.)

- Additional Object Page enablement details:
  See: enabling-variant-management-on-the-object-page-f26d42b.md
```
--------------------------------

**TITLE**: Micro Chart Facet — Annotations and Examples for Fiori Elements

**INTRODUCTION**: This document provides concise, copy-paste-ready annotation examples (XML, ABAP CDS, CAP CDS) and implementation notes to add a MicroChart control as a header facet on an Object Page in SAP Fiori Elements. It covers UI.Chart, UI.DataPoint, UI.HeaderFacets/UI.ReferenceFacet, unit-of-measure, and PresentationVariant sort order. Use these snippets in your local annotations files or CDS annotations.

**TAGS**: fiori-elements-framework, microchart, UI.Chart, UI.DataPoint, UI.HeaderFacets, UI.ReferenceFacet, PresentationVariant, Measures.ISOCurrency, ODataV2, ODataV4

STEP: 1 — XML: Basic Micro Chart Facet (DataPoint + Chart + HeaderFacet)
DESCRIPTION: Add UI.DataPoint and UI.Chart annotations for an entity and reference the chart from the header using UI.HeaderFacets. Place in your local annotations XML file (e.g., annotations.xml).
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.BookingType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <!-- DataPoint referenced from the chart measure attribute -->
    <Annotation Term="SAP__UI.DataPoint" Qualifier="FlightPrice">
        <Record>
            <PropertyValue Property="Value" Path="FlightPrice"/>
        </Record>
    </Annotation>

    <!-- Chart definition used as a micro chart -->
    <Annotation Term="SAP__UI.Chart" Qualifier="FlightPrice">
        <Record Type="SAP__UI.ChartDefinitionType">
            <PropertyValue Property="ChartType" EnumMember="SAP__UI.ChartType/Column"/>
            <PropertyValue Property="Title" String="Flight Price"/>
            <PropertyValue Property="Measures">
                <Collection>
                    <PropertyPath>FlightPrice</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="MeasureAttributes">
                <Collection>
                    <Record Type="SAP__UI.ChartMeasureAttributeType">
                        <PropertyValue Property="DataPoint" AnnotationPath="@SAP__UI.DataPoint#FlightPrice"/>
                        <PropertyValue Property="Role" EnumMember="SAP__UI.ChartMeasureRoleType/Axis1"/>
                        <PropertyValue Property="Measure" PropertyPath="FlightPrice"/>
                    </Record>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="Dimensions">
                <Collection>
                    <PropertyPath>FlightDate</PropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>

<!-- Reference the chart in the header facets of the parent entity/view -->
<Annotations Target="SAP__self.TravelType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="SAP__UI.HeaderFacets">
        <Collection>
            <Record Type="SAP__UI.ReferenceFacet">
                <PropertyValue Property="ID" String="FlightPrice"/>
                <PropertyValue Property="Target" AnnotationPath="_Booking/@SAP__UI.Chart#FlightPrice"/>
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```

STEP: 2 — ABAP CDS: Basic Micro Chart Facet (chart + data point + header facet)
DESCRIPTION: Annotate the entity (and views) in ABAP CDS. Use @UI.chart with qualifier and reference it via @UI.facet on the view (purpose: #HEADER).
LANGUAGE: ABAP CDS
CODE:
```abap
//@Scope: [ENTITY] ("BOOKING")
@UI: {
  chart: [ {
    title      : 'Flight Price',
    qualifier  : 'FlightPrice',
    chartType  : #COLUMN,
    measures   : [ 'FlightPrice' ],
    measureAttributes: [
      {
        measure  : 'FlightPrice',
        role     : #AXIS_1,
        asDataPoint: true    "asDataPoint maps to @UI.DataPoint reference
      }
    ],
    dimensions : [ 'FlightDate' ]
  } ]
}

//@DataPoint annotation on the property (use qualifier FlightPrice)
@UI.dataPoint: { title: 'Flight Price' }
FlightPrice;

//@Scope: [VIEW] ("TRAVEL")
annotate view VIEWNAME with {
  @UI.facet: [ {
    targetElement: '_Booking',
    targetQualifier: 'FlightPrice',
    type: #CHART_REFERENCE,
    purpose: #HEADER
  } ]
}
```

STEP: 3 — CAP CDS: Basic Micro Chart Facet (chart + data point + header facet)
DESCRIPTION: CAP CDS annotate for Bookings and Travel views. Use UI.Chart and reference with UI.HeaderFacets.
LANGUAGE: CAP CDS
CODE:
```cds
annotate Booking with @(UI: {
  DataPoint #FlightPrice: { Value: FlightPrice },

  Chart #FlightPrice: {
    $Type            : 'UI.ChartDefinitionType',
    Title            : 'Flight Price',
    ChartType        : #Column,
    Measures         : [ FlightPrice ],
    Dimensions       : [ FlightDate ],
    MeasureAttributes: [{
      $Type    : 'UI.ChartMeasureAttributeType',
      Measure  : FlightPrice,
      Role     : #Axis1,
      DataPoint: '@UI.DataPoint#FlightPrice'
    }]
  }
});

annotate Travel with @(UI: {
  HeaderFacets: [{
    $Type : 'UI.ReferenceFacet',
    ID    : 'FlightPrice',
    Target: '_Booking/@UI.Chart#FlightPrice'
  }]
});
```

STEP: 4 — UI.HeaderFacets/UI.ReferenceFacet (alternate example)
DESCRIPTION: Example showing UI.HeaderFacets referencing a chart located via a navigation property (note: navigation properties may be restricted in templates — see notes).
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="UI.HeaderFacets">
        <Collection>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Target" AnnotationPath="to_ProductSalesPrice/@UI.Chart"/>
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```

STEP: 5 — UI.Chart properties (title & subtitle)
DESCRIPTION: Use UI.Chart Title for the micro chart title and UI.Chart Description for the subtitle. Map these in your Chart annotation.
LANGUAGE: XML
CODE:
```xml
<!-- Example: Title + Description -->
<Annotation Term="SAP__UI.Chart" Qualifier="FlightPrice">
    <Record Type="SAP__UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Flight Price"/>
        <PropertyValue Property="Description" String="Average per month"/>
        ...
    </Record>
</Annotation>
```

STEP: 6 — UI.DataPoint usage and criticality support
DESCRIPTION: The Chart MeasureAttributes property DataPoint must refer to a UI.DataPoint annotation using AnnotationPath. Micro charts support UI.DataPoint Criticality and CriticalityCalculation.
LANGUAGE: XML
CODE:
```xml
<!-- DataPoint annotation -->
<Annotation Term="SAP__UI.DataPoint" Qualifier="FlightPrice">
    <Record>
        <PropertyValue Property="Value" Path="FlightPrice"/>
        <!-- Optional: Criticality or CriticalityCalculation -->
        <!-- <PropertyValue Property="Criticality" EnumMember="SAP__UI.Criticality/Neutral"/> -->
    </Record>
</Annotation>

<!-- Chart measure attribute referencing the datapoint -->
<Record Type="SAP__UI.ChartMeasureAttributeType">
    <PropertyValue Property="DataPoint" AnnotationPath="@SAP__UI.DataPoint#FlightPrice"/>
    <PropertyValue Property="Measure" PropertyPath="FlightPrice"/>
    <PropertyValue Property="Role" EnumMember="SAP__UI.ChartMeasureRoleType/Axis1"/>
</Record>
```

STEP: 7 — Unit of Measure (footer) via Measures.ISOCurrency
DESCRIPTION: Apply Measures.ISOCurrency to the value property type to display currency in the micro chart footer. Examples for XML, ABAP CDS, and CAP CDS.
LANGUAGE: XML
CODE:
```xml
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" 
             Target="STTA_PROD_MAN.STTA_C_MP_ProductSalesPriceType/AreaChartPrice">
    <Annotation Term="Measures.ISOCurrency" Path="Currency"/>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@Semantics.amount.currencyCode: 'Currency'
AreaChartPrice;
@Semantics.currencyCode: true
Currency;
```
LANGUAGE: CAP CDS
CODE:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductSalesPriceType with {
  @Measures.ISOCurrency : Currency
  AreaChartPrice;
}
```

STEP: 8 — PresentationVariant: Sorting micro chart data
DESCRIPTION: Apply UI.PresentationVariant with SortOrder to control sort order for micro chart data. Micro charts only use SortOrderType (SortOrder/Descending). Reference the PresentationVariant from UI.HeaderFacets.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.BookingType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <!-- DataPoint + Chart (same as step 1) -->
    <Annotation Term="SAP__UI.PresentationVariant">
        <Record Type="SAP__UI.PresentationVariantType">
            <PropertyValue Property="SortOrder">
                <Collection>
                    <Record Type="SAP__Common.SortOrderType">
                        <PropertyValue Property="Property" PropertyPath="FlightPrice" />
                        <PropertyValue Property="Descending" Bool="false" />
                    </Record>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="Visualizations">
                <Collection>
                    <AnnotationPath>@SAP__UI.Chart#FlightPrice</AnnotationPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>

<Annotations Target="SAP__self.TravelType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="SAP__UI.HeaderFacets">
        <Collection>
            <Record Type="SAP__UI.ReferenceFacet">
                <PropertyValue Property="ID" String="FlightPrice"/>
                <PropertyValue Property="Target" AnnotationPath="_Booking/@SAP__UI.PresentationVariant"/>
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
//@Scope: [ENTITY] ("BOOKING")
@UI: {
  presentationVariant: [ {
    sortOrder: [ { by: 'FlightPrice', direction: #ASC } ],
    visualizations: [ { type: #AS_CHART, qualifier: 'FlightPrice' } ]
  } ],
  chart: [ { qualifier: 'FlightPrice', chartType: #COLUMN, measures: ['FlightPrice'], dimensions: ['FlightDate'] } ]
}

//@Scope: [VIEW] ("TRAVEL")
annotate view VIEWNAME with {
  @UI.facet: [ { targetElement: '_Booking', type: #PRESENTATIONVARIANT_REFERENCE, purpose: #HEADER } ]
}
```
LANGUAGE: CAP CDS
CODE:
```cds
annotate Booking with @(UI: {
  Chart #FlightPrice: { /* chart definition */ },
  PresentationVariant: {
    Visualizations: ['@UI.Chart#FlightPrice'],
    SortOrder: [{
      Property  : FlightPrice,
      Descending: false
    }]
  }
});

annotate Travel with @(UI: { HeaderFacets: [{
  $Type : 'UI.ReferenceFacet',
  ID    : 'FlightPrice',
  Target: '_Booking/@UI.PresentationVariant'
}]});
```

STEP: 9 — Implementation notes & limitations (OData V2 and V4)
DESCRIPTION: Key constraints and supported features to consider when implementing micro chart facets.
LANGUAGE: TEXT
CODE:
```text
- OData V2:
  - Template does NOT support using navigation properties inside the UI.Chart term. Avoid chart annotations that reference navigation paths in V2 templates.

- OData V4:
  - Supports in-page and external navigation from the header facet title (see "Navigation from Header Facet Title").
  - Comparison micro chart type is supported.
  - Navigation properties inside UI.Chart are not supported for micro chart usage here.

- General restrictions:
  - Micro charts REQUIRE backend-aggregated data. The client does not perform server-side aggregation on entity sets for micro charts. Ensure the backend exposes one aggregated record per dimension key.
  - Micro charts consider only the SortOrder property from UI.PresentationVariant (ignore other PresentationVariant properties).
  - DataPoint referenced from Chart MeasureAttributes must point to a UI.DataPoint (supports Criticality and CriticalityCalculation).
```

STEP: 10 — Related resources
DESCRIPTION: Quick links to micro chart type documentation for details and examples.
LANGUAGE: TEXT
CODE:
```text
- Area Micro Chart: area-micro-chart-1467f2b.md
- Bullet Micro Chart: bullet-micro-chart-b915166.md
- Radial Micro Chart: radial-micro-chart-51eb569.md
- Line Micro Chart: line-micro-chart-e5cb2af.md
- Column Micro Chart: column-micro-chart-1a4ecb8.md
- Harvey Micro Chart: harvey-micro-chart-de4f8bf.md
- Stacked Bar Micro Chart: stacked-bar-micro-chart-9c93837.md
- Comparison Micro Chart: comparison-micro-chart-9d126f1.md
```
--------------------------------

**TITLE**: Migrate SAP Fiori Projects from SAP Web IDE to SAP Business Application Studio or Visual Studio Code

**INTRODUCTION**: Practical, code-focused migration steps to move an existing SAP Fiori project created in SAP Web IDE into SAP Business Application Studio (BAS) or Visual Studio Code (VS Code). Covers two common export/import flows (Git or ZIP), local preparation, required extension/tooling installation, and commands to build and run the project locally. Keeps changes minimal and highlights places to check for Web IDE specific artifacts.

**TAGS**: fiori-elements-framework, migration, sap-web-ide, business-application-studio, visual-studio-code, git, npm, ui5

STEP: 1 — Export project from SAP Web IDE

DESCRIPTION: Export your project from SAP Web IDE using one of two methods. Prefer Git if the project is already versioned. Otherwise download the project as a ZIP from the Web IDE workspace.

LANGUAGE: Shell

CODE:
```bash
# Option A — If the project is in a Git repository in Web IDE (preferred)
# Clone from the remote repository to your local machine or to a BAS workspace
git clone https://your.git.server/your-project-repo.git
cd your-project-repo

# Option B — If you only have a ZIP from Web IDE
# Download the ZIP from Web IDE -> Workspace -> Export -> Download as Zip
unzip path/to/your-project.zip -d your-project-folder
cd your-project-folder
```

STEP: 2 — Clean Web IDE-specific artifacts

DESCRIPTION: Remove or inspect artifacts created only for Web IDE (workspace-specific files, locks). Keep project sources: webapp/, manifest.json, xs-app.json, package.json, ui5.yaml, mta.yaml if present.

LANGUAGE: Shell

CODE:
```bash
# Example: remove Web IDE workspace metadata folder if present
rm -rf .webide  # or any Web IDE specific folders found in the root

# Verify important files are present
ls -la | sed -n '1,200p'
# Ensure you see:
# - webapp/ (or src/)
# - manifest.json
# - package.json
# - ui5.yaml (optional)
# - mta.yaml (if multi-target app)
```

STEP: 3 — Import project into Business Application Studio or Visual Studio Code

DESCRIPTION: Open the project folder in BAS or VS Code. In BAS, use a Dev Space for Fiori/UI5 development. In VS Code, open the folder and install recommended extensions (see next step).

LANGUAGE: Shell

CODE:
```bash
# Open in VS Code (local)
code .

# In SAP Business Application Studio:
# 1) Create/Open a Dev Space configured for SAP Fiori/UI5
# 2) Use File -> Open Workspace and select the folder you uploaded or cloned
```

STEP: 4 — Install required extensions and CLI tools

DESCRIPTION: Install SAP Fiori tooling and UI5/BAS helpers. At minimum: SAP Fiori tools extension(s) in the editor and the project runtime dependencies via npm. Install optional CLI tools if you will build MTA or CAP artifacts.

LANGUAGE: Shell

CODE:
```bash
# Install project dependencies
# Use npm ci for reproducible installs if package-lock.json exists
npm ci
# or
npm install

# Optional global tools (only if you will run builds requiring them)
# UI5 Tooling (local dev server, build tasks)
npm install --global @ui5/cli

# For MTA-based projects
# npm install --global mbt

# For CAP projects (optional)
# npm install --global @sap/cds

# Note:
# - In VS Code, install "SAP Fiori tools" extension pack from the Extensions view.
# - In BAS, select a Dev Space with SAP Fiori tools preinstalled.
```

STEP: 5 — Update configuration files if needed (manifest.json, ui5.yaml, package.json)

DESCRIPTION: Verify and, if necessary, update sap.ui5 versions, library references, and npm scripts. Remove references to Web IDE proprietary services or configurations. Ensure start scripts are present for local preview.

LANGUAGE: JSON

CODE:
```json
// Example checks to perform (no direct replace):
// - package.json should include a start/dev script
{
  "scripts": {
    "start": "ui5 serve --open index.html",
    "build": "ui5 build --clean-dest"
  }
}

// - ui5.yaml should exist for @ui5/cli based projects:
// Sample minimal ui5.yaml
{
  "specVersion": "2.2",
  "metadata": {
    "name": "your.project.name"
  },
  "type": "application",
  "resources": {
    "configuration": [
      "sapui5.yaml"
    ]
  }
}
```

STEP: 6 — Run and test the UI locally

DESCRIPTION: Start the UI5 local server and test the app in the browser. Use ui5 serve when using @ui5/cli; fallback to npm scripts defined in package.json if present.

LANGUAGE: Shell

CODE:
```bash
# If using UI5 Tooling (recommended)
ui5 serve --config=ui5.yaml

# Or use npm script
npm run start

# Open a browser and navigate to the URL provided by the serve output (typically http://localhost:8080)
```

STEP: 7 — (Optional) Prepare for deployment to SAP BTP / Cloud Foundry

DESCRIPTION: If the project contains mta.yaml, build an MTAR; otherwise follow the standard Cloud Foundry deployment flow for HTML5 apps or Node/CAP apps. Refer to platform-specific docs for exact deploy steps.

LANGUAGE: Shell

CODE:
```bash
# If your project is multi-target (mta.yaml)
# 1) Build the MTA archive (requires mbt)
mbt build

# 2) The build produces mta_archives/*.mtar
# Use your platform's deploy procedure (Cloud Foundry / Neo) — example links:
# - Deployment for MTA: https://help.sap.com/docs/SAP_FIORI_tools/...
```

STEP: 8 — Verify behavior and perform post-migration checks

DESCRIPTION: Checklist of items to validate after migration:
- Application runs locally via ui5 serve or npm start.
- All OData services configured in manifest.json or xs-app.json are reachable (adjust CORS/proxy if necessary).
- UI5 and library versions match supported targets in target environment.
- Remove Web IDE-specific project properties and service bindings.
- Commit the migrated project to a Git remote for ongoing version control.

LANGUAGE: Shell

CODE:
```bash
# Example: commit and push migrated project (if new Git repo)
git init
git add .
git commit -m "Migrate project from SAP Web IDE to BAS/VS Code"
git remote add origin https://your.git.server/your-new-repo.git
git push -u origin main
```

STEP: 9 — References and further reading

DESCRIPTION: Use official migration and BAS guidance for platform-specific details.

LANGUAGE: JSON

CODE:
```json
{
  "Migration guide": "https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/70d41f3ee29d453a90efab3ce025d450.html",
  "App Development Using BAS": "../05_Developing_Apps/app-development-using-sap-business-application-studio-6bbad66.md"
}
```

Caution: SAP Web IDE is no longer available via SAP Business Technology Platform trial accounts. References to SAP Web IDE are only relevant if you still have access via a productive SAP BTP account. Consider using SAP Business Application Studio as an alternative.
--------------------------------

**TITLE**: Migrating from registerControllerExtensions API (Fiori elements, OData V2)

**INTRODUCTION**: This guide shows exactly how to migrate from the deprecated registerControllerExtensions API to manifest-driven controller extensions in SAPUI5 2.0 for Fiori elements (OData V2). It covers required manifest.json changes, controller extension code patterns, press handler wiring, and accessing extensionAPI from controller extensions.

**TAGS**: fiori-elements-framework, sapui5, migration, controller-extensions, manifest, object-page, odata-v2

**STEP**: 1 — Update manifest.json: register child controllers under sap.ui.controllerExtensions

**DESCRIPTION**: Replace runtime registration via registerControllerExtensions with static declarations under sap.ui.controllerExtensions in manifest.json. Use the key format: <FLOOR_PLAN_NAME>#<STABLE_ID_OF_VIEW>. Move header/section action content from the parent extension into each child controller's sap.ui.generic.app configuration. Remove the parent controller extension entry.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.controllerExtensions": {
    "sap.suite.ui.generic.template.ObjectPage.view.Details#STTASOWD20::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20": {
      "controllerName": "STTASOWD20.ext.controller.SalesOrderExtension",
      "sap.ui.generic.app": {
        "C_STTA_SalesOrder_WD_20": {
          "EntitySet": "C_STTA_SalesOrder_WD_20",
          "Header": {
            "Actions": {
              "ObjectPageCustomAction": {
                "id": "ObjectPageCustomAction",
                "text": "Custom Action 1",
                "press": ".extension.STTASOWD20.ext.controller.SalesOrderExtension.onObjectPage1CustomAction",
                "determining": true,
                "applicablePath": "IsActiveEntity"
              }
            }
          },
          "Sections": {
            "Actions": {
              "...": "..." 
            }
          }
        }
      }
    },
    "sap.suite.ui.generic.template.ObjectPage.view.Details#STTASOWD20::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrderItem_WD_20": {
      "controllerName": "STTASOWD20.ext.controller.SalesOrderItemExtension",
      "sap.ui.generic.app": {
        "C_STTA_SalesOrderItem_WD_20": {
          "EntitySet": "C_STTA_SalesOrderItem_WD_20",
          "Header": {
            "Actions": {
              "...": "..."
            }
          },
          "Sections": {
            "Actions": {
              "...": "..."
            }
          }
        }
      }
    }
  }
}
```

Notes:
- The long keys above are required. Replace STTASOWD20 and stable view IDs with your app's values.
- Remove the parent controller extension entry (e.g., DetailsExtension) from sap.ui.controllerExtensions after migrating content.

---

**STEP**: 2 — Convert child controllers to sap.ui.core.mvc.ControllerExtension

**DESCRIPTION**: Remove the parent controller file (DetailsExtension.controller.js). Ensure each child controller extension file extends sap.ui.core.mvc.ControllerExtension, place overridden lifecycle and framework methods inside override, and add custom methods after override.

File: webapp/ext/controller/SalesOrderExtension.controller.js

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension"
], function (ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("STTASOWD20.ext.controller.SalesOrderExtension", {
    override: {
      // SAPUI5 lifecycle methods or framework extension hooks go here
      onInit: function () {
        // optional: initialize access to extensionAPI
        this.extensionAPI = this.getView().getController().extensionAPI;
      },

      // example ObjectPage framework hooks (keep names exact)
      adaptNavigationParameterExtension: function (oSelectionVariant, oObjectInfo) {
        // implement
      },

      beforeSaveExtension: function () {
        // implement
      },

      // any other overrides (onBeforeRendering, onAfterRendering, etc.)
      onBeforeRendering: function () {
        // implement
      }
    },

    // custom methods after override
    onObjectPage1CustomAction: function (oEvent) {
      // custom handler implementation
    },

    onSalesOrderInfo: function () {
      // custom method
    }
  });
});
```

File: webapp/ext/controller/SalesOrderItemExtension.controller.js (similar structure)
```javascript
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension"
], function (ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("STTASOWD20.ext.controller.SalesOrderItemExtension", {
    override: {
      onInit: function () {
        this.extensionAPI = this.getView().getController().extensionAPI;
      },
      // other overrides...
    },

    // custom methods
    onSalesOrderItemInfo: function () {
      // implement
    }
  });
});
```

Rules:
- Place all overridden methods (SAPUI5 lifecycle and ObjectPage controllerFrameworkExtensions methods) under override.
- Add custom methods (event handlers, helpers) outside override.
- Remove any registerControllerExtensions usage and parent controller file.

---

**STEP**: 3 — Update press handlers in manifest, views and fragments

**DESCRIPTION**: Change press handler references from method name strings to the extension path format: ".extension.<CONTROLLER_MODULE_NAME>.<METHOD_NAME>". Use this syntax in manifest sap.ui.generic.app definitions and in view/fragment press attributes.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "C_STTA_SalesOrder_WD_20": {
      "EntitySet": "C_STTA_SalesOrder_WD_20",
      "Header": {
        "Actions": {
          "ObjectPageCustomAction": {
            "id": "ObjectPageCustomAction",
            "text": "Custom Action 1",
            "press": ".extension.STTASOWD20.ext.controller.SalesOrderExtension.onObjectPage1CustomAction",
            "determining": true,
            "applicablePath": "IsActiveEntity"
          }
        }
      }
    }
  }
}
```

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Use same ".extension.<module>.<method>" format in views/fragments -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
  <Button id="previousMemoBtn" text="{i18n>yes}"
          press=".extension.STTASOWD20.ext.controller.SalesOrderExtension.onPressPreviousMemo" />
</core:FragmentDefinition>
```

Notes:
- The leading dot (".extension...") is required.
- Update every manifest action, view and fragment press attribute referencing extension handlers.

---

**STEP**: 4 — Access extensionAPI from controller extensions

**DESCRIPTION**: When you need extensionAPI inside a controller extension, get it from the underlying view controller: this.getView().getController().extensionAPI. Initialize and reuse it on onInit.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension"
], function (ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("STTASOWD20.ext.controller.SalesOrderExtension", {
    override: {
      onInit: function () {
        // Initialize reference to extensionAPI
        this.extensionAPI = this.getView().getController().extensionAPI;
      }
    },

    onSalesOrderInfo: function () {
      // Using extensionAPI to get selected contexts from a table inside the view
      var aSelectedContexts = this.extensionAPI.getSelectedContexts("SalesOrderItemsID::responsiveTable");
      // process aSelectedContexts
    }
  });
});
```

Final checklist:
- Remove parent controller file (e.g., DetailsExtension.controller.js).
- Add child controller entries under sap.ui.controllerExtensions in manifest.json using the required key format.
- Move header/section action config from parent entry to the respective child controller's sap.ui.generic.app block.
- Ensure all overridden methods are within override in ControllerExtension classes.
- Update all press handlers to ".extension.<module>.<method>" in manifest, views and fragments.
- Access extensionAPI via this.getView().getController().extensionAPI.
--------------------------------

**TITLE**: Modify startup parameters in SAP Fiori elements (OData V2) using modifyStartupExtension

**INTRODUCTION**: This document shows how to implement the modifyStartupExtension extension in your application extension.controller.js to modify startup parameters passed from a source app or the Fiori launchpad. Use it to transform SelectionVariant values, set semantic date ranges, and pick a default tab for multi-view list reports. Applicable only to SAP Fiori elements for OData V2.

**TAGS**: fiori-elements, odata-v2, modifyStartupExtension, extension, selectionVariant, smartfilterbar, analytical-list-page, list-report, overview-page, semanticDates

STEP: 1 — Overview: oStartupObject properties and when the extension is called

DESCRIPTION: The modifyStartupExtension receives an object (oStartupObject) you can mutate before the app applies it. The extension is called only during initial navigation to the analytical list page or list report (not on variant changes, filter changes, back/refresh with iAppState). Available properties:
- selectionVariant: SelectionVariant object passed from source app (modify it).
- urlParameters: URL parameters used to decide which tab to load dynamically (list report only).
- selectedQuickVariantSelectionKey: Optional tab key defined in the manifest; setting this overrides the default tab (list report only).
- semanticDates: Semantic date ranges object you can override.

LANGUAGE: JSON

CODE:
```json
{
  "oStartupObject": {
    "selectionVariant": { "<SelectionVariant API methods>": true },
    "urlParameters": { "paramName": "value" },
    "selectedQuickVariantSelectionKey": "_tab2",
    "semanticDates": {
      "Dates": [
        {
          "PropertyName": "PickingDate",
          "Data": {
            "operation": "YESTERDAY",
            "value1": null,
            "value2": null,
            "key": "filterPickingDate",
            "calendarType": "Gregorian"
          }
        }
      ]
    }
  }
}
```

STEP: 2 — List Report: transform selectionVariant, modify parameters, set semanticDates, select default tab

DESCRIPTION: Implement modifyStartupExtension in extension.controller.js to (a) remove/add or rename parameters before they are applied to the SmartFilterBar, (b) add select options (ranges or single values), (c) override semanticDates, and (d) set selectedQuickVariantSelectionKey to choose a tab on startup.

LANGUAGE: JavaScript

CODE:
```javascript
// File: extension.controller.js (application extension controller)
modifyStartupExtension: function (oStartupObject) {
    // Ensure selectionVariant exists
    var oSelectionVariant = oStartupObject && oStartupObject.selectionVariant;
    if (oSelectionVariant) {
        // Example: remove an incoming parameter
        oSelectionVariant.removeParameter("TaxAmount");

        // Example: add/rename a parameter expected by the target app
        // Combine or add a parameter the SmartFilterBar will use
        oSelectionVariant.addParameter("Product", "EPM-2365436");

        // Example: add a select option (single value)
        oSelectionVariant.addSelectOption("Country", "I", "EQ", "US");

        // Example: add a range select option (between 1000 and 5000)
        // Use operator "BT" (between) and provide Low and High via API signature
        oSelectionVariant.addSelectOption("Price", "I", "BT", "1000", "5000");
    }

    // Override or add a parameter and set semanticDates for a date property
    if (!oStartupObject.semanticDates) {
        oStartupObject.semanticDates = { Dates: [] };
    }
    // Ensure the selectionVariant has the parameter (could be empty)
    if (oSelectionVariant) {
        oSelectionVariant.addParameter("PickingDate", "");
    }
    // Set a semantic date range for PickingDate
    oStartupObject.semanticDates = {
        "Dates": [
            {
                "PropertyName": "PickingDate",
                "Data": {
                    "operation": "YESTERDAY",
                    "value1": null,
                    "value2": null,
                    "key": "filterPickingDate",
                    "calendarType": "Gregorian"
                }
            }
        ]
    };

    // Choose a default tab defined in manifest quickVariantSelection
    oStartupObject.selectedQuickVariantSelectionKey = "_tab2";
}
```

STEP: 3 — Analytical List Page: inspect selectionVariant and add select options or defaults

DESCRIPTION: For analytical list page navigation, modify the selectionVariant and semanticDates as required. Check existing select options safely before mutating selectionVariant.

LANGUAGE: JavaScript

CODE:
```javascript
// File: extension.controller.js (application extension controller)
modifyStartupExtension: function (oStartupObject) {
    var oSelectionVariant = oStartupObject && oStartupObject.selectionVariant;
    if (!oSelectionVariant) {
        return;
    }

    // Safe read of a select option: getSelectOption may return undefined or array
    var aCustomerCountry = oSelectionVariant.getSelectOption && oSelectionVariant.getSelectOption("CustomerCountry");
    if (Array.isArray(aCustomerCountry) && aCustomerCountry.length > 0 && aCustomerCountry[0].Low === "AR") {
        // Add additional select options based on incoming filter context
        oSelectionVariant.addSelectOption("WBSElement", "I", "EQ", "BLUE PRINT VALIDATION");
        oSelectionVariant.addSelectOption("CompanyCode", "I", "EQ", "EASI");
    }

    // Add an empty select option for property 'c' (example)
    oSelectionVariant.addSelectOption("c", "I", "EQ", "");

    // Override semanticDates
    oStartupObject.semanticDates = {
        "Dates": [
            {
                "PropertyName": "SemanticCustomDate",
                "Data": {
                    "operation": "YESTERDAY",
                    "value1": null,
                    "value2": null,
                    "key": "SemanticCustomDate",
                    "calendarType": "Gregorian"
                }
            }
        ]
    };
}
```

STEP: 4 — Overview Page: simple select option modification

DESCRIPTION: For overview page apps, modify the selection variant passed in by adding select options. The extension signature can be the same (modifyStartupExtension) or follow your application extension contract — implement in extension.controller.js.

LANGUAGE: JavaScript

CODE:
```javascript
// File: extension.controller.js (application extension controller)
modifyStartupExtension: function (oStartupObject) {
    // In some overview page variants the argument may be named differently,
    // but typically you receive the SelectionVariant object to mutate:
    var oCustomSelectionVariant = oStartupObject && oStartupObject.selectionVariant ? oStartupObject.selectionVariant : oStartupObject;

    // Add a select option for SupplierName
    oCustomSelectionVariant.addSelectOption("SupplierName", "I", "EQ", "Talpa");
}
```

STEP: 5 — Implementation notes & best practices

DESCRIPTION:
- This extension is only executed on initial navigation into the analytical list page or list report. It is not executed on variant changes or normal filter bar changes.
- Use defensive checks (existence of selectionVariant, getSelectOption returns) before manipulating selectionVariant.
- Use selectedQuickVariantSelectionKey only for choosing default tabs in list reports with multiple views/tables.
- semanticDates must follow the JSON structure shown in Step 1.
- Preserve the SelectionVariant API methods: removeParameter, addParameter, addSelectOption, getSelectOption.

LANGUAGE: JSON

CODE:
```json
{
  "notes": [
    "Applicable only to SAP Fiori elements for OData V2",
    "modifyStartupExtension runs on initial navigation only",
    "selectionVariant API methods: removeParameter, addParameter, addSelectOption, getSelectOption"
  ]
}
```
--------------------------------

**TITLE**: Multi-Selection for Intent-Based Navigation (SAP Fiori elements for OData V4)

**INTRODUCTION**: Explains how multi-selection is passed in intent-based navigation for SAP Fiori elements (OData V4). Describes the default behavior, the caveat when records lack a unique key, and the exact selectionVariant format sent to the target app.

**TAGS**: fiori-elements-framework, odata-v4, intent-based-navigation, multi-selection, selection-variant

**STEP**: 1 — Scope and default behavior

**DESCRIPTION**: Multi-selection for intent-based navigation is enabled by default. This topic applies only to SAP Fiori elements for OData V4. No configuration is required to send multiple selected row contexts during intent-based navigation.

**LANGUAGE**: Text

**CODE**:
```Text
Default: Multi-selection for intent-based navigation is enabled by default (SAP Fiori elements, OData V4).
Scope: Only applicable to SAP Fiori elements for OData V4.
```

**STEP**: 2 — Caveat: records without unique key fields

**DESCRIPTION**: If the selected rows do not have a unique key (i.e., you cannot identify each record by a single combined key), the selectionVariant is constructed per-property. In the target app each property becomes an AND of OR-values, which can produce unintended combinations (extra records). Example: three selected records with properties P1 and P2 produce P1=(A OR B) AND P2=(X OR Y), which yields the extraneous combination (B,X) if (B,X) did not exist in the original selection.

**LANGUAGE**: JSON

**CODE**:
```json
// Selected records (example)
[
  { "Record": 1, "P1": "A", "P2": "X" },
  { "Record": 2, "P1": "B", "P2": "Y" },
  { "Record": 3, "P1": "A", "P2": "Y" }
]

// Resulting selection logic applied by the target:
// P1 = (A OR B)
// P2 = (X OR Y)
// Combined => (P1=A OR P1=B) AND (P2=X OR P2=Y)
// This allows combination {P1=B, P2=X} which may not be present in the original selection.
```

**STEP**: 3 — Structure of the selectionVariant that is passed

**DESCRIPTION**: The navigation context is passed as a selectionVariant. Each property that appears in any selected row becomes a SelectOptions entry. Each distinct property value is added as a Range with Sign="I" and Option="EQ". Below is a representative sample structure (as sent to the target app).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
{
  "selectionVariant": {
    "SelectOptions": [
      {
        "PropertyName": "SalesOrder",
        "Ranges": [
          { "Sign": "I", "Option": "EQ", "Low": "2919682", "High": null }, // context from 1st record for "SalesOrder"
          { "Sign": "I", "Option": "EQ", "Low": "2915717", "High": null }  // context from 2nd record for "SalesOrder"
        ]
      },
      {
        "PropertyName": "SalesOrderType",
        "Ranges": [
          { "Sign": "I", "Option": "EQ", "Low": "OR", "High": null }, // context from 1st record for "SalesOrderType"
          { "Sign": "I", "Option": "EQ", "Low": "SE", "High": null }  // context from 2nd record for "SalesOrderType"
        ]
      },
      {
        "PropertyName": "TransactionCurrency",
        "Ranges": [
          { "Sign": "I", "Option": "EQ", "Low": "EUR", "High": null },
          { "Sign": "I", "Option": "EQ", "Low": "USD", "High": null }
        ]
      }
      // ...
    ]
  }
}
```
--------------------------------

**TITLE**: Multiple Views on List Report Tables (Fiori Elements)

**INTRODUCTION**: This reference explains how to implement multiple views (variants) on a List Report table in SAP Fiori elements (OData V2/V4). It covers choosing single-table vs multiple-table modes, which OData UI annotations to use, manifest configuration examples (including view visibility and per-tab entity sets), APIs to refresh tabs, and steps to add views using SAP Fiori Tools. Use the code samples directly in your app manifest or controller extensions.

**TAGS**: fiori-elements-framework, list-report, multiple-views, manifest.json, odata-v4, odata-v2, annotations, variant-management, ui5, extension-api

STEP: Choose display mode (single table vs multiple table)

DESCRIPTION: Decide how you want views rendered in the UI and note runtime constraints and UI behavior.

LANGUAGE: Text

CODE:
```Text
- Single Table Mode:
  - One table instance, one table toolbar and one variant management control.
  - A segmented button is rendered in the table toolbar to switch views. If > 3 views, a select control is used.
  - Use when views differ only in filter criteria or small presentation changes.

- Multiple Table Mode:
  - One table instance per view (n views => n tables).
  - An icon tab bar is rendered above the tables. Only the selected tab's table is visible.
  - Use when views require different presentationVariants or SelectionPresentationVariant (different sort orders, different visualizations) or when you want charts as tab content.
  - Restriction: Do not use StandardList or ObjectList in multiple view scenarios.

- Important:
  - If a property is used in multiple views but not listed in SelectionFields, remove it from the FilterBar so users cannot add it via Adapt Filters.
```

STEP: Choose OData UI annotations

DESCRIPTION: Select the correct annotation type depending on whether you only filter data (SelectionVariant) or also control presentation (PresentationVariant, SelectionPresentationVariant). Provide annotation links in manifest via annotationPath.

LANGUAGE: Text

CODE:
```Text
- SelectionVariant: Use when you only describe which data (filter criteria) should be displayed in a view.
  - Can be referenced in manifest via: "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#MyVariant"

- PresentationVariant: Use when you only want a different visualization/presentation.
  - Reference accordingly if the view only changes visualization.

- SelectionPresentationVariant: Use when you want to describe both which data (filters) and how it is presented (sort, visualizations).
  - Note: SelectionPresentationVariant is supported in multiple table mode and multiple table mode with charts only.
```

STEP: Configure manifest.json — sample for OData V4 multi-tab settings (sticky header, variant management, view visibility, multiple entity sets)

DESCRIPTION: Copy and adapt this manifest.json fragment into your app target/settings. This shows:
- variantManagement
- initialLoad
- stickyMultiTabHeader
- views array with key, annotationPath, contextPath, and visible (boolean / path / binding expression)
- an example where a tab uses a different contextPath (entity set)

LANGUAGE: JSON

CODE:
```json
{
  "targets": {
    "DraftList": {
      "type": "Component",
      "id": "DraftList",
      "name": "sap.fe.templates.ListReport",
      "options": {
        "settings": {
          "contextPath": "/FirstDraft",
          "variantManagement": "Control",
          "initialLoad": "Enabled",
          "stickyMultiTabHeader": false,
          "views": {
            "paths": [
              {
                "key": "tab1",
                "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#One",
                "visible": "{= ${/MySingleton/IsViewAvailable} === true}"
              },
              {
                "key": "tab2",
                "contextPath": "/SecondDraft",
                "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Two"
              }
            ]
          }
        }
      }
    }
  }
}
```

STEP: Examples for view "visible" property variants

DESCRIPTION: The "visible" property in a view supports:
- Boolean
- Path (singleton or specific record)
- UI5 expression binding

LANGUAGE: JSON

CODE:
```json
{
  "views": {
    "paths": [
      {
        "key": "tabBoolean",
        "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#A",
        "visible": true
      },
      {
        "key": "tabPath",
        "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#B",
        "visible": "/MySingleton/IsViewAvailable"
      },
      {
        "key": "tabExpression",
        "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#C",
        "visible": "{= ${/MySingleton/IsViewAvailable} === true }"
      }
    ]
  }
}
```

STEP: Use different entity sets per tab

DESCRIPTION: To display different entity sets per tab (e.g., sales orders vs suppliers), set contextPath on the corresponding view object in the manifest (see manifest.json sample above). Each tab may point to a different contextPath / entitySet.

LANGUAGE: JSON

CODE:
```json
{
  "views": {
    "paths": [
      {
        "key": "salesOrders",
        "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Sales",
        "contextPath": "/SalesOrderSet"
      },
      {
        "key": "suppliers",
        "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Suppliers",
        "contextPath": "/SupplierSet"
      }
    ]
  }
}
```

STEP: Refresh view content and counts programmatically (OData V4)

DESCRIPTION: Fiori Elements V4 auto-refreshes view content when first opened and after filter changes. Use extensionAPI methods to control refresh behavior programmatically from controller extensions.

LANGUAGE: JavaScript

CODE:
```javascript
// From a List Report controller extension (this.extensionAPI is provided by FE)
this.extensionAPI.setTabContentToBeRefreshedOnNextOpening("tab1"); // mark tab to refresh on next open
this.extensionAPI.refreshTabsCount(); // refresh counts shown for all tabs
```

References (API docs):
- setTabContentToBeRefreshedOnNextOpening: https://ui5.sap.com/#/api/setTabContentToBeRefreshedOnNextOpening
- refreshTabsCount: https://ui5.sap.com/#/api/refreshTabsCount

STEP: Add multiple views with SAP Fiori Tools (Page Map / Page Editor)

DESCRIPTION: Manual UI steps to add a new table view and columns via SAP Fiori Tools (Page Map -> Page Editor).

LANGUAGE: Text

CODE:
```Text
1. Launch the Page Map (e.g., right-click project folder -> Show Page Map).
2. Open the Page Editor for the List Report (click Edit/pencil icon).
3. Click Add (+) next to Views.
4. Click Add Table View.
5. Select an Entity (entity set for the tab).
6. Click Add.
7. Expand the new table view node.
8. Click Add (+) next to Columns.
9. Click Add Basic Columns.
10. Select desired columns.
11. Click Add.
12. Click the new view node and set View Label (rename).
13. Preview the app to verify the new view (Previewing an Application).
```

STEP: Notes, best practices and references

DESCRIPTION: Summarized reminders and links for annotation vocabulary and extensibility.

LANGUAGE: Text

CODE:
```Text
- Use SelectionVariant when you only need to define filter criteria for a view.
- Use SelectionPresentationVariant when you need to define both filters and presentation (supported in multiple table mode).
- Use PresentationVariant when only the visualization changes.
- Multiple table mode supports charts on tabs (Multiple table mode with charts).
- Do not use StandardList or ObjectList in multiple view scenarios (restriction).
- For annotation reference and semantics, consult the OData UI vocabulary:
  https://github.com/SAP/odata-vocabularies/blob/main/vocabularies/UI.md
- For controller extension and custom views see:
  Extension Points for Views in the List Report (use controller extensions and extensionAPI).
- Live FPM example: Multi Mode Extensibility
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/controllerExtensions/multiModeExtensibility
```
--------------------------------

**TITLE**: Outbound Navigation in SAP Fiori Elements — URLs and Intent-Based Navigation (DataFieldWithUrl, DataFieldWithIntentBasedNavigation, DataFieldForIntentBasedNavigation)

**INTRODUCTION**: Practical, code-focused reference for implementing external outbound navigation from Fiori Elements apps. Covers:
- Absolute or property-based URL links (DataFieldWithUrl)
- Intent-based navigation via semantic objects (global/local links and buttons)
- Mapping and controls (RequiresContext, NavigationAvailable, Mapping, SemanticObjectMapping, SemanticObjectUnavailableActions)
- Excluding sensitive/inapplicable properties and V4-specific handling
Includes XML, ABAP CDS, CAP CDS, controller (JS) and manifest.json examples for direct use.

**TAGS**: fiori-elements, outbound-navigation, semantic-object, DataFieldWithUrl, DataFieldWithIntentBasedNavigation, DataFieldForIntentBasedNavigation, CDS, CAP, ABAP, XML, manifest.json, mapping

STEP: 1 — Use a URL: DataFieldWithUrl (property path or absolute URL)
DESCRIPTION: Two options to render a link: use a property path (pass URL from entity property) or an absolute URL string. Examples in XML OData annotation, ABAP CDS and CAP CDS.
LANGUAGE: XML
CODE:
```xml
<!-- DataFieldWithUrl: property path (URL property provided on entity) -->
<Record Type="UI.DataFieldWithUrl">
    <PropertyValue Property="Label" String="Column label" />
    <PropertyValue Property="Value" Path="URL"/>
    <PropertyValue Property="Url" Path="URL"/>
</Record>

<!-- DataFieldWithUrl: absolute URL -->
<Record Type="UI.DataFieldWithUrl">
    <PropertyValue Property="Url" String="https://www.sap.com"/>
    <PropertyValue Property="Value" String="SAP"/>
    <PropertyValue Property="Label" String="Company"/>
</Record>
```

LANGUAGE: ABAP CDS
CODE:
```abap
// DataFieldWithUrl using ABAP CDS (example for line item / field group)
@UI.lineItem: [{ type: #WITH_URL, url: 'URL' }]
URL;

// Absolute URL (example)
@UI.lineItem: [{ label: 'Company', type: #WITH_URL, url: 'https://www.sap.com' }]
```

LANGUAGE: CAP CDS / JSON-like annotation
CODE:
```json
// CAP CDS structure examples (UI annotations in service/schema)
{
    "$Type" : "UI.DataFieldWithUrl",
    "Value" : URL,
    "Url"   : URL,
    "Label" : "Column label"
},
{
    "$Type" : "UI.DataFieldWithUrl",
    "Url"   : "https://www.sap.com",
    "Value" : "SAP",
    "Label" : "Company"
}
```

STEP: 2 — Global semantic object association (make property a smart link)
DESCRIPTION: Annotate a property with Common.SemanticObject to render as a smart link wherever used as a DataField. If multiple targets, system shows popover; can enhance with quick view. Examples: XML, ABAP CDS, CAP CDS. Supports path-based dynamic semantic object (use Path returning string).
LANGUAGE: XML
CODE:
```xml
<!-- Global semantic object (static) -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item/CostCenter">
    <Annotation Term="com.sap.vocabularies.Common.v1.SemanticObject" String="CostCenter"/>
</Annotations>

<!-- Dynamic semantic object via Path -->
<Annotations Target="myService.SalesorderManage/SoldToParty">
   <Annotation Term="Common.SemanticObject" Path="solToPartySemanticObject"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
// Annotate property with semantic object in ABAP CDS (example)
annotate view ITEM with {
    @Consumption.semanticObject: 'CostCenter'
    costcenter;
}
```

LANGUAGE: CAP CDS
CODE:
```cds
// CAP CDS: semantic object annotation on entity field
annotate ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item with {
    @Common.SemanticObject : 'CostCenter'
    CostCenter
};

// Path-based (dynamic) semantic object example (field solToPartySemanticObject must exist)
SoldToParty: String(10) @( Common.SemanticObject: solToPartySemanticObject );
```

STEP: 3 — Local link: DataFieldWithIntentBasedNavigation (render link in a specific UI context)
DESCRIPTION: Use DataFieldWithIntentBasedNavigation to show a link only in specific LineItem/FieldGroup (tables/forms). Must specify both SemanticObject and Action to ensure unique target (direct navigation). Examples for XML, ABAP CDS, CAP CDS.
LANGUAGE: XML
CODE:
```xml
<Record Type="UI.DataFieldWithIntentBasedNavigation">
    <PropertyValue Property="Label" String="My Link for navigation" />
    <PropertyValue Property="Value" Path="SomePath" />
    <PropertyValue Property="SemanticObject" String="MySemanticObject"/>
    <PropertyValue Property="Action" String="manage"/>
</Record>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [
  {
    label: 'My Link for navigation',
    value: 'SOMEPATH',
    semanticObjectAction: 'manage',
    type: #WITH_INTENT_BASED_NAVIGATION
  }
]
@Consumption.semanticObject: 'MySemanticObject'
```

LANGUAGE: CAP CDS
CODE:
```cps
{
    $Type : 'UI.DataFieldWithIntentBasedNavigation',
    Label : 'My Link for navigation',
    Value : SomePath,
    SemanticObject : 'MySemanticObject',
    Action : 'manage'
},
```

STEP: 4 — Button: DataFieldForIntentBasedNavigation (intent-based navigation triggers)
DESCRIPTION: Use DataFieldForIntentBasedNavigation to render a button that triggers intent navigation. Control RequiresContext (Bool) to enable only when selection exists. Use NavigationAvailable to enable/disable via a path. Examples include NavigationAvailable path-based usage and RequiresContext true/false.
LANGUAGE: XML
CODE:
```xml
<!-- Simple intent button -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
    <PropertyValue Property="Label" String="My Button for navigation"/>
    <PropertyValue Property="SemanticObject" String="MySemanticObject"/>
    <PropertyValue Property="Action" String="manage"/>
</Record>

<!-- RequiresContext true: button disabled until selection -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
   <PropertyValue Property="SemanticObject" String="EPMProduct"/>
   <PropertyValue Property="Action" String="manage_st"/>
   <PropertyValue Property="Label" String="IBNWithContext"/>
   <PropertyValue Property="RequiresContext" Bool="true"/>
</Record>

<!-- NavigationAvailable path: enable if property 'isDeletable' is true for selection -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
    <PropertyValue Property="SemanticObject" String="v4Freestyle"/>
    <PropertyValue Property="Action" String="Inbound"/>
    <PropertyValue Property="Label" String="IBN with context"/>
    <PropertyValue Property="RequiresContext" Bool="true"/>
    <PropertyValue Property="NavigationAvailable" Path="isDeletable"/>
</Record>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [
  {
    label: 'My Button for navigation',
    semanticObjectAction: 'manage',
    type: #FOR_INTENT_BASED_NAVIGATION
  }
]
@Consumption.semanticObject: 'MySemanticObject'

// Example with requiresContext and label
{
    semanticObject: 'EPMProduct',
    semanticObjectAction: 'manage_st',
    label: 'IBNWithContext',
    requiresContext: true,
    type: #FOR_INTENT_BASED_NAVIGATION
}
```

LANGUAGE: CAP CDS
CODE:
```cps
{
    $Type : 'UI.DataFieldForIntentBasedNavigation',
    Label : 'My Button for navigation',
    SemanticObject : 'MySemanticObject',
    Action : 'manage',
},

// Example with RequiresContext and NavigationAvailable path
{
    $Type              : 'UI.DataFieldForIntentBasedNavigation',
    SemanticObject     : 'v4Freestyle',
    Action             : 'Inbound',
    Label              : 'IBN',
    NavigationAvailable: isDeletable,
    RequiresContext    : false
}
```

STEP: 5 — Mapping semantic object properties (SemanticObjectMapping and Mapping on button)
DESCRIPTION: Rename properties passed in navigation context. Use Common.SemanticObjectMapping for property-level mapping or Mapping property on DataFieldForIntentBasedNavigation to control outgoing key names. Empty values are not passed. Examples for XML, ABAP CDS, CAP CDS and DataFieldForIntentBasedNavigation Mapping.
LANGUAGE: XML
CODE:
```xml
<!-- Property-level: map local property to semantic property -->
<Annotations Target="com.c_salesordermanage_sd.defaultParamsForSalesOrderCreate/SoldToParty">
     <Annotation Term="Common.SemanticObject" String="Customer"/>
     <Annotation Term="Common.SemanticObjectMapping">
          <Collection>
               <Record Type="Common.SemanticObjectMappingType">
                    <PropertyValue Property="LocalProperty" PropertyPath="SoldToPartyID"/>
                    <PropertyValue Property="SemanticObjectProperty" String="CustomerID"/>
               </Record>
          </Collection>
     </Annotation>
</Annotations>

<!-- DataFieldForIntentBasedNavigation: Mapping collection -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
    ...
    <PropertyValue Property="Mapping">
        <Collection>
            <Record>
                <PropertyValue Property="LocalProperty" PropertyPath="nameOfSourceProperty"/>
                <PropertyValue Property="SemanticObjectProperty" String="nameOfTargetProperty"/>
            </Record>
        </Collection>
    </PropertyValue>
</Record>
```

LANGUAGE: ABAP CDS
CODE:
```abap
// Example of mapping on field (example representation)
{
  type: #FOR_INTENT_BASED_NAVIGATION,
  semanticObject: 'nameOfSemanticObject',
  semanticObjectAction: 'nameOfSemanticObjectAction',
  semanticObjectBinding: [
    {
      localElement: 'nameOfSourceProperty',
      element: 'nameOfTargetProperty'
    }
  ]
}
```

LANGUAGE: CAP CDS
CODE:
```cps
// Field-level mapping (SemanticObjectMapping)
SoldToParty : String(10) @(Common : { 
    SemanticObject       : 'Customer',
    SemanticObjectMapping: 'SoldToPartyID'[
        {
          LocalProperty          : SoldToPartyID,
          SemanticObjectProperty : 'CustomerID'
        }
    ]
});

// DataFieldForIntentBasedNavigation: Mapping on the button
{
     $Type   : 'UI.DataFieldForIntentBasedNavigation',
     Mapping : [
         {
             LocalProperty          : nameOfSourceProperty,
             SemanticObjectProperty : 'nameOfTargetProperty'
         }
     ]
}
```

STEP: 6 — Hide unwanted semantic object actions (SemanticObjectUnavailableActions)
DESCRIPTION: Use Common.SemanticObjectUnavailableActions (with optional qualifier) to hide specific actions from the smart link popover (works for quick-view and link popover). Example: hide 'manage' and 'analyze'.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="MyService.SalesOrderManage/SoldToParty">
    <Annotation Term="Common.SemanticObject" Qualifier="SalesOrder" String="SalesOrder"/>
    <Annotation Term="Common.SemanticObjectMapping" Qualifier="SalesOrder">
        <Collection>
            <Record Type="Common.SemanticObjectMappingType">
                <PropertyValue Property="LocalProperty" PropertyPath="SoldToParty"/>
                <PropertyValue Property="SemanticObjectProperty" String="SoldToParty"/>
            </Record>
        </Collection>
    </Annotation>

    <!-- hide action for qualifier SalesOrder -->
    <Annotation Term="Common.SemanticObjectUnavailableActions" Qualifier="SalesOrder">
        <Collection>
            <String>manageVM</String>
        </Collection>
    </Annotation>

    <!-- hide action globally for this semantic object -->
    <Annotation Term="Common.SemanticObjectUnavailableActions">
        <Collection>
            <String>manage</String>
        </Collection>
    </Annotation>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cps
annotate myService.SalesorderManage {
    @Common.SemanticObject : 'SalesOrder'
    @Common.SemanticObject #SalesOrder : 'SalesOrder'
    @Common.SemanticObjectUnavailableActions #SalesOrder : ['analyze']
    @Common.SemanticObjectUnavailableActions : ['manage']
    OrderID
};
```

STEP: 7 — Exclude properties and sensitive data from navigation context (UI.ExcludeFromNavigationContext, PersonalData.IsPotentiallySensitive, FieldControl)
DESCRIPTION: Use annotations to prevent sensitive or inapplicable properties from being passed during outbound navigation. V4 additionally removes measures and personalData annotated fields automatically. Show XML, ABAP CDS, CAP CDS samples and FieldControl path example.
LANGUAGE: XML
CODE:
```xml
<!-- Mark property as potentially sensitive -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/ID">
    <Annotation Term="com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive" />
</Annotations>

<!-- Exclude a property explicitly from navigation context -->
<Annotations Target="ZEPM_C_SALESORDERITEMQUERY_CDS.ZEPM_C_SALESORDERITEMKPIResult/BusinessPartner">
    <Annotation Term="UI.ExcludeFromNavigationContext" Bool="true"/>
</Annotations>

<!-- FieldControl path (V4) - inapplicable when resolved to 'Inapplicable' -->
<Annotations Target="SAP__self.ReviewsType/AvailabilityCode">
    <Annotation Term="SAP__Common.FieldControl" Path="__FieldControl/AvailabilityCode_FC"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
// mark as potentially sensitive (ABAP CDS)
annotate view SALESORDERMANAGE with {
  @Semantics.personalData.isPotentiallySensitive: true
  ID;
}
```

LANGUAGE: CAP CDS
CODE:
```cps
// CAP annotation examples
annotate com.c_salesordermanage_sd.SalesOrderManage {
    @PersonalData.IsPotentiallySensitive
    ID
};

annotate com.c_salesordermanage_sd.SalesOrderManage {
    @UI.ExcludeFromNavigationContext : true
    ID
};

annotate SAP__self.ReviewsType {
    @Common.FieldControl : __FieldControl.AvailabilityCode_FC
    AvailabilityCode
};
```

STEP: 8 — Multi-entity set target resolution (pass extra parameter with adaptNavigationParameterExtension and use manifest.json useForTargetResolution)
DESCRIPTION: When target app has multiple entity set tabs, pass a key-value parameter from source app extension controller using adaptNavigationParameterExtension. Mark the parameter in target manifest.json inboundParameters with useForTargetResolution true. Then configure pages components to resolve target based on that key.
LANGUAGE: JavaScript
CODE:
```javascript
// ListReportExtension.controller.js (source app)
adaptNavigationParameterExtension: function(oSelectionVariant, oObjectInfo) {
    if (oObjectInfo.semanticObject === "EPMSalesOrder" && oObjectInfo.action === "manage_sttasomv") {
        oSelectionVariant.addParameter("<Key>", "<Value1>");
    }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// ObjectPageExtension.controller.js (alternate source)
adaptNavigationParameterExtension: function(oSelectionVariant, oObjectInfo) {
    if (oObjectInfo.semanticObject === "EPMSalesOrder" && oObjectInfo.action === "manage_sttasomv") {
        oSelectionVariant.addParameter("<Key>", "<Value2>");
    }
}
```

LANGUAGE: JSON
CODE:
```json
// target app manifest.json: mark inbound parameter to use for target resolution
{
  "sap.ui.generic.app": {
    "settings": {
      "inboundParameters": {
        "<Key>": {
          "useForTargetResolution": true
        }
      }
    }
  }
}
```

LANGUAGE: JSON
CODE:
```json
// manifest.json: pages + pages.objectpage targetResolution example (fragment)
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|<EntitySet1>": {
        "entitySet": "<EntitySet1>",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "quickVariantSelectionX": {
              "variants": {
                "1": { "key":"1", "entitySet":"<EntitySet1>", "annotationPath":"com.sap.vocabularies.UI.v1.SelectionVariant#VAR1" },
                "2": { "key":"2", "entitySet":"<EntitySet2>", "annotationPath":"com.sap.vocabularies.UI.v1.SelectionVariant#VAR2" }
              }
            }
          }
        },
        "pages": {
          "ObjectPage|<EntitySet1>": {
            "entitySet": "<EntitySet1>",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "targetResolution": { "<Key>": "<Value1>" }
              }
            }
          },
          "ObjectPage|<EntitySet2>": {
            "entitySet": "<EntitySet2>",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "targetResolution": { "<Key>": "<Value2>" }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 9 — V4: rules for merged navigation context, special semantic link handling, and parameter passing (SelectionVariant/xAppState)
DESCRIPTION: Rules applied when building outbound navigation SelectionVariant/xAppState:
- If property name exists only in one entity set: pass without entity set prefix.
- If property technical name appears in multiple entity sets: pass both unprefixed value and prefixed values (EntitySet.Property).
- Navigation entity set properties (starting with _) are generally ignored for page-level context unless selected.
- When semantic link field clicked, only the semantic link field value is used for that technical field; other values with same technical name are ignored.
- Parameters are added to SelectionVariant SelectOptions both as "$Parameter.<Name>" and "<Name>".
Provide examples demonstrating merged context behavior are conceptual (see scenarios).
LANGUAGE: JSON
CODE:
```json
// Outbound parameter handling (xAppState selectionVariant representation):
// Parameter "P_CompanyCode" becomes:
// SelectionVariant → SelectOptions → "$Parameter.P_CompanyCode" : { /* value */ }
// SelectionVariant → SelectOptions → "P_CompanyCode"           : { /* same value */ }
{}
```

STEP: 10 — V4: automatic removal of sensitive/inapplicable data on outbound navigation
DESCRIPTION: In OData V4 outbound navigation:
- Remove properties annotated as Measures (com.sap.vocabularies.Analytics.v1.Measures)
- Remove properties with PersonalData.IsPotentiallySensitive
- Remove properties annotated with UI.ExcludeFromNavigationContext
- Remove properties with FieldControl that resolve to Inapplicable at runtime
Caution: Sensitive properties beyond one navigation level may not be removed.

LANGUAGE: XML
CODE:
```xml
<!-- Example remove-sensitive annotation -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/ID">
    <Annotation Term="com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive" />
</Annotations>
<!-- Explicit exclude from navigation context -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/ID">
    <Annotation Term="UI.ExcludeFromNavigationContext" Bool="true"/>
</Annotations>
```

STEP: 11 — Restrictions & practical notes
DESCRIPTION: Key restrictions and behavior to code against:
- OData V2: link control rendered only if field is in Display mode.
- OData V4: filter fields using operators "Not Equal To" or "Not Empty" are not transported to the target; parameters are not supported in this scenario.
- NavigationAvailable: prefer path-based dynamic checks; avoid static true/false.
- UI.Hidden on DataFieldForIntentBasedNavigation can be used to hide buttons (static true/false or path) except inline buttons where this isn't allowed.
- RequiresContext only controls enabled state; any available context is always passed.
CODE:
```text
// Practical checklist for implementation:
- Ensure SemanticObject + Action specified for direct navigation.
- For dynamic target resolution across tabs, implement adaptNavigationParameterExtension() in source and set useForTargetResolution in target manifest.
- Use SemanticObjectMapping / Mapping to rename context fields sent to target.
- Annotate sensitive fields with PersonalData.IsPotentiallySensitive or UI.ExcludeFromNavigationContext to prevent leaking.
- For NavigationAvailable, use a Path to a boolean property (avoid static true/false).
- Remember V4-specific filtering: Not Equal To / Not Empty filter fields are excluded from outbound context.
```


--------------------------------

**TITLE**: Navigation from Header Facet Title (SAP Fiori elements, OData V4)

**INTRODUCTION**: Configure header facet titles (data points, rating/progress indicators, micro charts) to enable either in-page navigation (to a section/subsection on the same Object Page) or external navigation (to another application) via manifest.json and crossNavigation. This is specific to SAP Fiori elements for OData V4.

**TAGS**: fiori-elements-framework, sap-fe, object-page, header-facet, manifest.json, crossNavigation, navigation, microchart, datapoint

**STEP**: 1 - Enable In-Page Navigation from a Header Facet Title

**DESCRIPTION**: Add a controlConfiguration entry for the header item in the component's options.settings in manifest.json. Use the annotation qualifier (for example @com.sap.vocabularies.UI.v1.DataPoint#Qualifier) as the key. Provide navigation.targetSections with sectionId and/or subSectionId. You can specify only sectionId (first subsection shown) or subSectionId. Supported controls: data point, rating indicator, progress indicator, micro chart. If the target section/subsection is not found, the UI shows an error message.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": { }
  },
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.DataPoint#NetValue": {
            "navigation": {
              "targetSections": {
                "sectionId": "SalesOrder::SalesOrderManageObjectPage--fe::FacetSection::HeaderInfo",
                "subSectionId": "SalesOrder::SalesOrderManageObjectPage--fe::FacetSubSection::SalesOrderHeaderPartner"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 - Enable External Navigation from a Header Data Point

**DESCRIPTION**: Configure navigation.targetOutbound.outbound in controlConfiguration with a qualifier that references an entry in the crossNavigation.outbounds section. Define the outbound with semanticObject, action and parameters. Use "value.format": "binding" and "value.value": "<FieldName>" to map a field from the current navigation context to the outbound parameter. The resulting link merges the object page context with the data point context.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.DataPoint#NetValue": {
            "navigation": {
              "targetOutbound": {
                "outbound": "ExternalNavigation"
              }
            }
          }
        }
      }
    }
  },
  "crossNavigation": {
    "outbounds": {
      "ExternalNavigation": {
        "semanticObject": "SalesOrder",
        "action": "display",
        "parameters": {
          "SoldToParty": {
            "value": {
              "value": "CustomerName",
              "format": "binding"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 - Enable External Navigation from a Micro Chart in the Header

**DESCRIPTION**: Configure the chart qualifier under controlConfiguration and set navigation.targetOutbound.outbound to the outbound qualifier in crossNavigation. The chart context is merged with the page context and passed to the target. For 1:n micro charts (multiple records displayed), multiple technical IDs are passed using the OR operator. If the external app is not configured or authorization is missing, the title renders as plain text (no link). If both in-page and external navigation are configured for the same header item, external navigation takes precedence. Only one external target is supported.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.Chart#CreditLimitDetails": {
            "navigation": {
              "targetOutbound": {
                "outbound": "ExternalNavigation"
              }
            }
          }
        }
      }
    }
  },
  "crossNavigation": {
    "outbounds": {
      "ExternalNavigation": {
        "semanticObject": "SalesOrder",
        "action": "display",
        "parameters": {
          "SoldToParty": {
            "value": {
              "value": "CustomerName",
              "format": "binding"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 - Quick Implementation Checklist (apply when editing manifest.json)

**DESCRIPTION**: Follow these checks when implementing header facet navigation:
- Use the annotation qualifier as the key under controlConfiguration (e.g., @com.sap.vocabularies.UI.v1.DataPoint#Qualifier or @com.sap.vocabularies.UI.v1.Chart#Qualifier).
- For in-page navigation: set navigation.targetSections.sectionId and/or .subSectionId (section IDs must match Object Page section IDs).
- For external navigation: set navigation.targetOutbound.outbound to a crossNavigation.outbounds qualifier and define the outbound mapping.
- Parameter mapping: use { "value": { "value": "<FieldName>", "format": "binding" } }.
- Note precedence: external navigation overrides in-page navigation.
- Supported header controls: data point, rating indicator, progress indicator, micro chart.
--------------------------------

**TITLE**: Inbound Navigation for SAP Fiori Elements — Deep Linking, Incoming Filters, and FLP Defaults

**INTRODUCTION**: Practical, code-focused guidance for implementing inbound navigation into SAP Fiori elements applications. Covers: applying incoming filter values to the filter bar, FLP target-mapping and user-default handling (including special DisplayCurrency behavior), deep linking to object and subobject pages for OData V2/V4, manifest settings (allowDeepLinking), routing for semantic keys, sort order merging from xapp-state, and flexible column layout fullscreen handling.

**TAGS**: fiori-elements-framework, inbound-navigation, deep-linking, manifest.json, OData-v2, OData-v4, FLP, filters, semantic-keys, flexible-column-layout, xapp-state, DisplayCurrency

STEP: 1 — Handling Incoming Filters and FLP Default Values
DESCRIPTION: Apply incoming navigation context values to filter bar fields of the target app. If the incoming value targets a field not currently visible in the filter bar, bring that filter into the visible area. When navigation originates from SAP Fiori launchpad (FLP), default values from target mapping or user defaults may also be applied. Special case: DisplayCurrency/P_DisplayCurrency is set from the FLP user default for dynamic tiles with navigation context if incoming context does not provide it. Note: user default values from FLP mark the standard variant as dirty. Image reference (preserve in docs): images/Handling_Default_Values_from_FLP_9c2ee88.png
LANGUAGE: JSON
CODE:
```json
{
  "behavior": {
    "incoming_filters": "Incoming value applied to matching filter field; non-visible filter is made visible",
    "match_rules": [
      "Exact fully-qualified property name match",
      "Match when leading entity set name in incoming context is discarded",
      "P_ prefix may be added/removed to match target filter parameter"
    ],
    "FLP_defaults": {
      "intent_based_navigation": "Only standard target mapping values considered",
      "static_tile_no_context": "Use FLP target mapping defaults if no user default variant",
      "dynamic_tile_with_context": {
        "DisplayCurrency": "If missing in incoming context, set from FLP user default",
        "other_fields": "Ignore FLP user default values except standard target mapping"
      },
      "note": "FLP user defaults mark standard variant as dirty"
    },
    "image": "images/Handling_Default_Values_from_FLP_9c2ee88.png"
  }
}
```

STEP: 2 — Deep Linking: Technical Keys (OData metadata)
DESCRIPTION: To deep-link directly to an object page (active or draft) provide all technical keys for the entity set in the URL. The back-end metadata defines technical keys.
LANGUAGE: XML
CODE:
```xml
<!-- Example: EntityType with technical keys -->
<EntityType Name="SalesOrderManage">
  <Key>
    <PropertyRef Name="ID"/>
    <PropertyRef Name="IsActiveEntity"/>
  </Key>
  <!-- Other properties -->
</EntityType>

<!-- Example deep link URL (technical keys):
...?ID=11111111-aaaa-bbbb-cccc-ddddeeeeffff&IsActiveEntity=true
-->
```

STEP: 3 — Deep Linking to Subobject Pages: manifest allowDeepLinking (OData V2 / V4)
DESCRIPTION: Enable deep linking to subobject pages by setting allowDeepLinking: true in manifest.json for each subobject page level that should be directly reachable. If multiple pages on the same level have allowDeepLinking true, the first entry is used. To reach n-th level directly, set allowDeepLinking:true on all levels 1..n.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "ProductTextObjectPage": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "options": {
            "settings": {
              "contextPath": "/STTA_C_MP_ProductText",
              "allowDeepLinking": true
            }
          }
        }
      }
    },
    "pages_example": {
      "ObjectPage1": {
        "allowDeepLinking": true,
        "SubObjectPage1": {
          "allowDeepLinking": true,
          "SubObjectPage2": {
            "allowDeepLinking": true,
            "SubObjectPage3": {
              "allowDeepLinking": true
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — Inbound Sort Order from xapp-state (List Report / Analytical List Page)
DESCRIPTION: If xapp-state carries sorters during inbound navigation, the framework reads and applies them to the table. Navigation sorters are merged with existing sorters but always take priority. Merge precedence:
1) Navigation sorter (highest priority)
2) Default user variant sorter (if exists)
3) PresentationVariant annotate sorter
4) Otherwise only navigation sorters are applied
LANGUAGE: JSON
CODE:
```json
{
  "xapp-state_sorter_behavior": {
    "priority": [
      "navigation_sorters",
      "user_default_variant_sorters",
      "PresentationVariant_annotation_sorters"
    ],
    "notes": "Sorters from navigation override or merge with existing sorters; navigation always wins on conflicts"
  }
}
```

STEP: 5 — Flexible Column Layout: Fullscreen on External Inbound Navigation
DESCRIPTION: For apps using Flexible Column Layout (FCL), open a unique object in fullscreen on external inbound navigation by setting defaultLayoutTypeIfExternalNavigation to MidColumnFullScreen (main objects) or EndColumnFullScreen (sub-objects). If launched from FLP and FCL is enabled, defaultLayout is considered; for external navigation defaultLayoutTypeIfExternalNavigation is used.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "pages": {
      "ObjectPage|C_STTA_BusinessPartner": {
        "entitySet": "C_STTA_BusinessPartner",
        "defaultLayoutType": "TwoColumnsMidExpanded",
        "defaultLayoutTypeIfExternalNavigation": "MidColumnFullScreen",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "allowDeepLinking": true
          }
        }
      }
    }
  },
  "notes": {
    "external_navigation": "defaultLayoutTypeIfExternalNavigation is considered",
    "flp_launch": "defaultLayout is considered"
  }
}
```

STEP: 6 — OData V4: Semantic Keys — Annotations and Routing for Deep Linking
DESCRIPTION: For OData V4, applications can deep-link to object pages by passing semantic keys (application-defined semantically-unique keys). Ensure annotations and routing patterns are configured. When both semantic and technical keys are provided, semantic keys take precedence.
LANGUAGE: XML
CODE:
```xml
<!-- Semantic key annotation (OData V4 XML annotation) -->
<Annotation Term="Common.SemanticKey">
  <Collection>
    <PropertyPath>SalesOrder</PropertyPath>
  </Collection>
</Annotation>

<!-- Example deep link URL:
...?SalesOrder=10025
-->
```

STEP: 7 — OData V4: Semantic Key Examples for Backends (ABAP CDS, CAP CDS)
DESCRIPTION: Show how to declare semantic keys in ABAP CDS and CAP CDS so FE routing and deep linking work with semantic keys.
LANGUAGE: ABAP / CAP
CODE:
```abap
/* ABAP CDS Example */
@ObjectModel: {
  semanticKey: [ 'SalesOrder' ]
}
define view SALESORDERMANAGE {
  /* fields including SalesOrder */
}
```

```
// CAP CDS Example
// in .cds file or annotation model:
namespace your.namespace;

entity SalesOrderManage {
  key SalesOrder : Integer;
  /* other fields */
}

/* annotation */
Common.SemanticKey : [
  SalesOrder
]
```

STEP: 8 — OData V4: Manifest Routing Example for Object Page (semantic key in pattern)
DESCRIPTION: Define routing pattern with a placeholder {key} that maps to the entity context path. Use level value to indicate object page level.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": "/yourEntity({key}):?query:",
          "name": "default",
          "target": "sample"
        }
      ],
      "targets": {
        "sample": {
          "type": "Component",
          "id": "Default",
          "name": "sap.fe.templates.ObjectPage",
          "level": 1,
          "options": {
            "settings": {
              "contextPath": "/yourEntity"
            }
          }
        }
      }
    }
  }
}
```

STEP: 9 — OData V4: Subobject Page Deep Linking in manifest
DESCRIPTION: Enable subobject deep linking by setting allowDeepLinking:true in the target component options for the subobject object page in manifest.json. Provide semantic or technical keys for object page and all subobject levels up to n to reach the n-th level directly. Ensure semantic key names are unique across entity sets.
LANGUAGE: JSON
CODE:
```json
{
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "contextPath": "/SalesOrderManage",
        "allowDeepLinking": true
      }
    }
  },
  "note": "To deep-link to level N, pass object page keys plus semantic keys for all subobject levels 1..N in URL"
}
```

STEP: 10 — Handling Incoming Filters for Navigation Entity Set Properties (qualified names and P_ prefix)
DESCRIPTION: Incoming filter values for navigation properties are applied if:
- Fully qualified incoming name matches a fully qualified property in the target, OR
- Match occurs when the leading entity set name is discarded from the incoming context.
Also, match when P_ prefix is added/removed (incoming may have P_ but target not, or vice versa). Example incoming context: "SO._PO.Status" matches the first applicable "Status" in the target following the lookup order described.
LANGUAGE: JSON
CODE:
```json
{
  "incoming_example": "SO._PO.Status",
  "matching_order": [
    "target has main entity set 'SO' with navigation entity set '_PO' with 'Status' filter",
    "target has a first-level navigation entity set 'SO' which has further navigation entity set '_PO' with 'Status' filter"
  ],
  "p_prefix_handling": "Match if name equals with addition or removal of leading 'P_' prefix"
}
```

STEP: 11 — Restrictions and Notes
DESCRIPTION: Important restrictions and notes to follow when implementing inbound navigation:
- Deep linking is not supported for apps configured with parameters or mandatory filters.
- allowDeepLinking is required only for subobject pages, not for object pages.
- To deep-link to a given subobject level, allowDeepLinking must be true for every level up to that level.
- For stand-alone apps (no FLP), adjust deep-linking links in annotations/manifest as needed.
LANGUAGE: JSON
CODE:
```json
{
  "restrictions": [
    "No deep linking for apps with parameters or mandatory filters",
    "allowDeepLinking required for subobject pages' levels only",
    "All levels 1..N must have allowDeepLinking:true to deep-link to level N",
    "Standalone apps require custom links; FLP required for intent-based deep linking"
  ]
}
```
--------------------------------

**TITLE**: Configure Navigation to an Object Page in Edit Mode (manifest.json)

**INTRODUCTION**: This guide shows how to configure SAP Fiori Elements apps so an Object Page opens directly in edit mode. Includes settings for OData V2 (editFlow, navToListOnSave) and OData V4 (openInEditMode). Apply changes in webapp/manifest.json under the page definitions for the related entity set.

**TAGS**: fiori-elements, manifest.json, edit-mode, editFlow, navToListOnSave, openInEditMode, OData V2, OData V4

**STEP**: 1 — Enable direct edit navigation (OData V2 List Report)
**DESCRIPTION**: Edit webapp/manifest.json and add the editFlow setting with value "direct" under the List Report page entry that targets your entity set. This makes navigation to the Object Page open in edit mode.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "editFlow": "direct"
            /* other settings... */
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Configure Object Page save navigation behavior (OData V2)
**DESCRIPTION**: By default, when editFlow is "direct", the Object Page footer shows Save, Cancel and Save and Next. The Save action navigates back to the list. To prevent navigation to the list after Save (keep user on the object page and switch to display mode), set navToListOnSave to false on the Object Page page entry.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "navToListOnSave": false
            /* other settings... */
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Behavioral summary (OData V2)
**DESCRIPTION**: Quick reference for behavior after applying the above settings:
- editFlow: "direct" -> Object Page opens in edit mode; footer shows Save, Cancel, and Save and Next.
- Save -> by default navigates back to the List Report.
- Save and Next -> saves current and opens next object in edit mode.
- navToListOnSave: false -> Save does not navigate to list; Object Page switches to display mode.
**LANGUAGE**: text
**CODE**:
```
Behavior:
- editFlow: "direct" => Save | Cancel | Save and Next appear.
- Default Save => navigates to List Report.
- Save and Next => saves current and opens next object in edit mode.
- navToListOnSave: false => Save keeps user on object page and switches to display mode.
```

**STEP**: 4 — Enable openInEditMode (OData V4)
**DESCRIPTION**: For OData V4-based Fiori Elements apps, set openInEditMode to true in the manifest.json page or table options (options.settings) that target the relevant entitySet. This opens the object in edit mode when navigated from tables or lists.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "SomePage|LineItems": {
        "entitySet": "LineItems",
        "component": {
          "name": "sap.sap.ui.generic.template.ObjectPage", /* example component */
          "settings": {
            /* other settings... */
          }
        },
        "options": {
          "settings": {
            "entitySet": "LineItems",
            "openInEditMode": true
            /* other settings... */
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Behavioral note (OData V4)
**DESCRIPTION**: When openInEditMode is set to true, the table’s context menu will not show the "Open in New Tab" option. Use this setting only when you want direct edit navigation and are aware of the missing context menu entry.
**LANGUAGE**: text
**CODE**:
```
Note: openInEditMode: true => "Open in New Tab" is removed from the table context menu.
```
--------------------------------

**TITLE**: Navigation from List Report to Object and Subobject Pages (Fiori Elements)

**INTRODUCTION**: Configure table chevron navigation so a List Report opens an Object Page, and an Object Page opens a Subobject Page. This focuses on the manifest.json entries required for SAP Fiori Elements (OData V4). Annotations for table chevron behavior and semantic navigation are required separately (not included here).

**TAGS**: fiori-elements-framework, OData V4, navigation, manifest.json, list-report, object-page, subobject-page

**STEP**: 1 — Purpose and prerequisites

**DESCRIPTION**: Use the table chevron in a List Report table to navigate to an Object Page. From the Object Page you can navigate to a Subobject Page. Ensure your metadata annotations for navigation and selection are present (these are configured separately). This document shows the manifest.json target/navigation configuration for OData V4.

**LANGUAGE**: text

**CODE**:
```text
File: manifest.json (project root or component manifest)
Purpose: Add targets and navigation entries to map routes between List Report, Object Page, and Subobject Page.
```

**STEP**: 2 — Configure target components and navigation routes (OData V4)

**DESCRIPTION**: Edit manifest.json and add target definitions for:
- List Report target (sap.fe.templates.ListReport)
- Object Page target (sap.fe.templates.ObjectPage)
Add navigation mapping under the List Report target options.navigation to route the List Report selection to the Object Page. Add an internal navigation mapping in the Object Page options.settings.navigation for subobject navigation.

Preserve the specified "contextPath" and "variantManagement" settings as needed by your app. Use consistent "id" and "route" names.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "your.app.id"
  },
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "type": "Component",
          "id": "SalesOrderManageList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/SalesOrderManage",
              "variantManagement": "Page"
              /* other List Report settings */
            },
            "navigation": {
              "SalesOrderManage": {
                "detail": {
                  "route": "SalesOrderManageObjectPage"
                }
              }
            }
          }
        },
        "SalesOrderManageObjectPage": {
          "type": "Component",
          "id": "SalesOrderManageObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "contextPath": "/SalesOrderManage",
              "navigation": {
                "_Item": {
                  "detail": {
                    "route": "SalesOrderItemObjectPage" /* subobject page route */
                  }
                }
              },
              "variantManagement": "Control"
              /* other Object Page settings */
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — File placement and route naming

**DESCRIPTION**: Place the above changes in your app manifest.json under the sap.ui5 → routing → targets section. Ensure:
- Route names used in "route" fields correspond to target/route definitions elsewhere in your routing configuration.
- Component ids and names match your application's components.
- contextPath points to the correct entity set (here: /SalesOrderManage).

**LANGUAGE**: text

**CODE**:
```text
Example: Confirm that your routing configuration contains routes referenced by these targets, e.g.:
"routes": [
  {
    "name": "SalesOrderManage",
    "pattern": "SalesOrderManage",
    "target": "SalesOrderManageList"
  },
  {
    "name": "SalesOrderManageObjectPage",
    "pattern": "SalesOrderManage/{SalesOrderManage}",
    "target": "SalesOrderManageObjectPage"
  },
  {
    "name": "SalesOrderItemObjectPage",
    "pattern": "SalesOrderManage/{SalesOrderManage}/Item/{_Item}",
    "target": "SalesOrderItemObjectPage"
  }
]
```

**STEP**: 4 — Reference for OData V2

**DESCRIPTION**: For OData V2-specific internal navigation guidance, consult the "Configuring Internal Navigation" documentation referenced in SAP Fiori Elements V2 docs.

**LANGUAGE**: text

**CODE**:
```text
Reference: Configuring Internal Navigation (OData V2) — see: configuring-internal-navigation-2c65f07.md
```
--------------------------------

**TITLE**: Implementing Non-Draft SAP Fiori Elements (OData V2) Applications

**INTRODUCTION**: This guide gives concise, actionable code examples and patterns for building non-draft SAP Fiori elements apps based on OData V2. It focuses on saving data explicitly, detecting unsaved changes, securing extension points, handling navigation/data-loss, and concurrency considerations. Use these snippets in UI5 controller extensions or custom modules for Fiori elements apps that do NOT use draft handling.

**TAGS**: fiori-elements-framework, odata-v2, non-draft, sapui5, ui5, data-loss, secured-execution, save, hasPendingChanges

STEP: 1 - Non-draft constraints (checklist)
DESCRIPTION: Quick checklist you must follow for non-draft apps. Use this as runtime or design-time checks (no draft and no mixed draft/non-draft entity sets).
LANGUAGE: JavaScript
CODE:
```javascript
// Non-draft checklist (implement as runtime validation or developer checklist):
// - Only applicable for OData V2.
// - Do NOT mix draft and non-draft entity sets in the same app.
//   Exception: a draft-enabled parent can contain a non-draft child only for display.
// - Users must explicitly Save changes before leaving a page.
// - No automatic saving, no server-side draft locks, no device switch continuation.
// - Typical unsupported features: partial save/continue later, automatic async save,
//   in-memory action/field control adjustments during entry, editable-table sorting/filtering.
```

STEP: 2 - Create transient entries and persist explicitly (createEntry + submitChanges)
DESCRIPTION: For non-draft flows, create transient entries client-side and call submitChanges() when user clicks Save. Use OData V2 model methods: createEntry and submitChanges.
LANGUAGE: JavaScript
CODE:
```javascript
// Example: create a new subitem and persist only when the user clicks Save.
// Controller extension snippet (UI5, OData V2)

// create a transient entry bound to a form
onAddSubitem: function () {
  const oModel = this.getView().getModel(); // sap.ui.model.odata.v2.ODataModel
  const sEntitySet = "SubItems";
  const oContext = oModel.createEntry("/" + sEntitySet, {
    properties: {
      // default properties for the new entry
      Name: "",
      Quantity: 0
    }
  });
  // bind form to the transient context
  this.getView().byId("subItemForm").setBindingContext(oContext);
},

// Save handler: submit all pending changes to back end
onSave: function () {
  const oModel = this.getView().getModel();
  if (!oModel.hasPendingChanges()) {
    sap.m.MessageToast.show("No changes to save.");
    return;
  }
  oModel.submitChanges({
    success: (oData, response) => {
      sap.m.MessageToast.show("Save successful.");
      // refresh binding or navigate as needed
    },
    error: (oError) => {
      sap.m.MessageBox.error("Save failed: " + oError.message);
    }
  });
}
```

STEP: 3 - Detect unsaved changes and show data-loss confirmation before navigation
DESCRIPTION: Use the model method hasPendingChanges() to detect unsaved changes and show an explicit data-loss confirmation (MessageBox). Also add a beforeunload handler to warn on browser-level navigation if desired.
LANGUAGE: JavaScript
CODE:
```javascript
// Example: guard internal navigation (e.g., table chevron or navigation arrows)
onNavigateAway: function (fnNavigate) {
  const oModel = this.getView().getModel();
  if (oModel.hasPendingChanges()) {
    sap.m.MessageBox.confirm(
      "You have unsaved changes. Do you want to discard changes and continue?",
      {
        onClose: (sAction) => {
          if (sAction === sap.m.MessageBox.Action.OK) {
            // discard changes and navigate
            oModel.resetChanges(); // reset local changes
            fnNavigate();
          } else {
            // stay on page
          }
        }
      }
    );
  } else {
    fnNavigate();
  }
}

// Example: warn when user attempts to close/refresh browser (note: custom message may be ignored)
window.addEventListener("beforeunload", function (event) {
  const oModel = sap.ui.getCore().byId("app").getModel(); // example model lookup
  if (oModel && oModel.hasPendingChanges()) {
    // Most browsers ignore the custom message; presence of returnValue triggers prompt
    event.preventDefault();
    event.returnValue = "";
    return "";
  }
});
```

STEP: 4 - Implement a securedExecution helper for extension points
DESCRIPTION: Implement a reusable securedExecution wrapper that accepts parameters:
- busy.set (show busy indicator),
- busy.check (only run if not busy),
- dataloss.popup (show data-loss confirmation),
- dataloss.navigation (navigation-style data-loss text).
Use this for extension points or custom actions to ensure consistent UX and data-loss handling in non-draft scenarios.
LANGUAGE: JavaScript
CODE:
```javascript
// securedExecution(fn, params)
// params: { busy: { set: boolean, check: boolean }, dataloss: { popup: boolean, navigation: boolean } }

function securedExecution(fn, params = {}) {
  const oModel = this.getView().getModel();
  const busySet = params.busy && params.busy.set === true;
  const busyCheck = params.busy && params.busy.check === true;
  const datalossPopup = params.dataloss && params.dataloss.popup === true;
  const datalossNavigation = params.dataloss && params.dataloss.navigation === true;

  // busy check: if requested and app is already busy, skip execution
  if (busyCheck && this._isAppBusy) {
    return Promise.resolve(); // ignore or return a resolved promise
  }

  const exec = () => {
    if (busySet) {
      sap.ui.core.BusyIndicator.show(0);
      this._isAppBusy = true;
    }
    return Promise.resolve()
      .then(() => fn())
      .finally(() => {
        if (busySet) {
          sap.ui.core.BusyIndicator.hide();
          this._isAppBusy = false;
        }
      });
  };

  // dataloss handling
  if (datalossPopup && oModel.hasPendingChanges()) {
    const sText = datalossNavigation
      ? "You have unsaved changes. Navigating away will discard your changes. Continue?"
      : "You have unsaved changes. This action will discard your changes. Continue?";
    return new Promise((resolve, reject) => {
      sap.m.MessageBox.confirm(sText, {
        onClose: (sAction) => {
          if (sAction === sap.m.MessageBox.Action.OK) {
            exec().then(resolve).catch(reject);
          } else {
            resolve(); // user cancelled: do nothing
          }
        }
      });
    });
  }

  // default execution path
  return exec();
}

// Usage example inside a controller:
// securedExecution.call(this, () => { return this._doSensitiveAction(); }, { busy: { set: true, check: true }, dataloss: { popup: true, navigation: false }});
```

STEP: 5 - Concurrency note: refresh before editing if you need latest server state
DESCRIPTION: Non-draft apps do not lock or automatically refresh data when editing begins. If you want to reduce overwrites, explicitly refresh or re-read the entity before allowing edit.
LANGUAGE: JavaScript
CODE:
```javascript
// Refresh entity before editing (to reduce last-save wins problems)
onStartEdit: function (sPath) {
  const oModel = this.getView().getModel();
  // sPath = "/EntitySet('KEY')"
  oModel.read(sPath, {
    success: (oData) => {
      // rebind view/form to refreshed data
      this.getView().byId("objectForm").setBindingContext(new sap.ui.model.Context(oModel, sPath));
      // now allow edit
      this._enableEditMode();
    },
    error: (oError) => {
      sap.m.MessageBox.error("Failed to refresh data before editing.");
    }
  });
}

// Optionally, call oModel.refresh(true) to refresh caches (note: may trigger multiple requests)
```

STEP: 6 - UI: enable/disable Save button based on pending changes
DESCRIPTION: Bind the Save button enabled state to model.hasPendingChanges or update programmatically on model change events.
LANGUAGE: JavaScript
CODE:
```javascript
// Programmatic enable/disable example (subscribe to model events)
onInit: function () {
  const oModel = this.getView().getModel();
  // listen to requestCompleted/requestSent to update button state after operations
  oModel.attachRequestCompleted(this._updateSaveButtonState.bind(this));
  oModel.attachRequestSent(this._updateSaveButtonState.bind(this));
},

_updateSaveButtonState: function () {
  const oModel = this.getView().getModel();
  const bHasChanges = oModel.hasPendingChanges();
  this.getView().byId("saveButton").setEnabled(bHasChanges);
}
```

STEP: 7 - Navigation and known discard behaviors
DESCRIPTION: Known behaviors that cause data loss in non-draft apps. Use explicit warnings where possible but note browser and launchpad actions may not show dialogs:
LANGUAGE: JavaScript
CODE:
```javascript
// Known actions that discard data (document and guard where possible):
// - Fiori Back / Home: display data-loss message via securedExecution with dataloss.popup=true
// - FLP Sign out: may result in data loss without a message (cannot reliably intercept in all environments)
// - Browser back/forward/bookmark/refresh/close: can be partially guarded with beforeunload, but some actions bypass dialogs.

// Example guard when wiring the app's global navigation
this.getRouter().attachBeforeRouteMatched((oEvent) => {
  // call onNavigateAway with actual navigation function bound
  this.onNavigateAway(() => {
    this.getRouter().navTo(oEvent.getParameter("name"), oEvent.getParameter("arguments"));
  });
});
```

STEP: 8 - Limitations summary (developer reference)
DESCRIPTION: Keep this short and copy into developer readme or runtime checks. It reiterates features not available with non-draft apps.
LANGUAGE: PlainText
CODE:
```
// Non-draft limitations to document for product owners and developers:
// - No automatic "no data loss" guarantee, no auto-save, no session/device switch continuation.
// - No "save as incomplete/continue later" workflow.
// - No server-side locking: concurrent edits -> last save wins.
// - No in-edit calculations/field control/actions without saving first.
// - Actions requiring unsaved data or side effects may not work as in draft apps.
// - Editable-table features like sorting/filtering during edit are limited.
```
--------------------------------

**TITLE**: Object Page Elements — Configuration and Annotations for SAP Fiori Elements Object Page

**INTRODUCTION**: This document provides concise, actionable examples and configuration snippets for implementing and customizing the SAP Fiori Elements Object Page. It covers manifest mapping, UI annotations for header info, header facets, content sections (field groups / tables), paginator behavior, and draft/footer actions. Use these snippets when generating code or annotations for object pages (OData V4 recommended; some notes for OData V2 limitations are included).

**TAGS**: fiori-elements, object-page, annotations, manifest.json, com.sap.vocabularies.UI.v1, headerinfo, facets, fieldgroup, paginator, draft

STEP: 1 — Map an Object Page in manifest.json

DESCRIPTION: Create a page entry in manifest.json to map an entityset to the Object Page template. This is the minimal JSON manifest snippet required to route to an Object Page using the generic template. Add more "settings" entries as required for your app (e.g., flexibleColumnLayout, navigation).

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "preload": true
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        },
        "route": "ProductObjectPage",
        "settings": {
          "navigationProperty": "",
          "title": "{{objectPage.title}}"
        }
      }
    ]
  },
  "sap.app": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/XXXXX_SRV/",
        "type": "OData",
        "settings": {
          "odataVersion": "4.0"
        }
      }
    }
  }
}
```

STEP: 2 — Define Header Info (Header title, subtitle, image) via OData annotations (JSON)

DESCRIPTION: Use the com.sap.vocabularies.UI.v1.HeaderInfo annotation to specify title, subtitle, image URL, and optionally image mime type. This example shows how to set the object type label, title mapped to a property, and an image path. For OData V2, image usage in the content area is limited per platform constraints; header image typically works across versions when the service exposes image URL/mime.

LANGUAGE: JSON

CODE:
```json
{
  "Annotations": {
    "Products": {
      "com.sap.vocabularies.UI.v1.HeaderInfo": {
        "TypeName": { "String": "Product" },
        "Title": { "Path": "ProductName" },
        "Description": { "Path": "ShortDescription" },
        "ImageUrl": { "Path": "ImageUrl" },
        "ImageMimeType": { "Path": "ImageMimeType" }
      }
    }
  }
}
```

STEP: 3 — Add Header Facets (label-field pairs, data points) using UI.Facets + UI.LineItem (reference by AnnotationPath)

DESCRIPTION: Place important label/value pairs or small visualizations in header facets. This example shows a Facet that references a specially named LineItem (#Header) that contains label/value pairs such as price and availability. Limit header label-field pairs to a recommended maximum (e.g., five) for clarity.

LANGUAGE: JSON

CODE:
```json
{
  "Annotations": {
    "Products": {
      "com.sap.vocabularies.UI.v1.Facets": [
        {
          "Label": { "String": "Header Facet" },
          "Target": {
            "AnnotationPath": "@com.sap.vocabularies.UI.v1.LineItem#Header"
          }
        }
      ],
      "com.sap.vocabularies.UI.v1.LineItem": {
        "#Header": [
          {
            "Label": { "String": "Price" },
            "Value": { "Path": "Price" }
          },
          {
            "Label": { "String": "Availability" },
            "Value": { "Path": "AvailabilityStatus" }
          }
        ]
      }
    }
  }
}
```

STEP: 4 — Define Content Sections: ReferenceFacet + FieldGroup (field groups or tables inside sections)

DESCRIPTION: Use ReferenceFacet to point to FieldGroup annotations or CollectionFacets that render as sections in the Object Page content area. FieldGroup organizes properties in the form layout; CollectionFacet references a nested collection (table) if required.

LANGUAGE: JSON

CODE:
```json
{
  "Annotations": {
    "Products": {
      "com.sap.vocabularies.UI.v1.Facets": [
        {
          "Label": { "String": "General Information" },
          "Target": {
            "AnnotationPath": "@com.sap.vocabularies.UI.v1.FieldGroup#Main"
          }
        },
        {
          "Label": { "String": "Sales Items" },
          "Target": {
            "AnnotationPath": "@com.sap.vocabularies.UI.v1.CollectionFacet#SalesItems"
          }
        }
      ],
      "com.sap.vocabularies.UI.v1.FieldGroup": {
        "#Main": [
          { "Data": { "Path": "ProductName" }, "Label": { "String": "Product Name" } },
          { "Data": { "Path": "ProductCategory" }, "Label": { "String": "Category" } },
          { "Data": { "Path": "Manufacturer" }, "Label": { "String": "Manufacturer" } }
        ]
      },
      "com.sap.vocabularies.UI.v1.CollectionFacet": {
        "#SalesItems": {
          "Label": { "String": "Sales Items" },
          "Target": {
            "AnnotationPath": "@com.sap.vocabularies.UI.v1.LineItem#SalesItemsTable"
          }
        }
      },
      "com.sap.vocabularies.UI.v1.LineItem": {
        "#SalesItemsTable": [
          { "Value": { "Path": "ItemId" }, "Label": { "String": "Item ID" } },
          { "Value": { "Path": "Quantity" }, "Label": { "String": "Qty" } },
          { "Value": { "Path": "Price" }, "Label": { "String": "Unit Price" } }
        ]
      }
    }
  }
}
```

STEP: 5 — Anchor Navigation (automatic based on Facets)

DESCRIPTION: Anchor navigation on the Object Page is generated automatically from the Facets defined in the annotations. Ensure each Facet has a Label and Target to appear in the anchor navigation bar; no extra manifest configuration is required.

LANGUAGE: JSON

CODE:
```json
{
  "notes": "Ensure each entry in com.sap.vocabularies.UI.v1.Facets has a Label and a valid Target (FieldGroup, ReferenceFacet, CollectionFacet). Anchor links are created from those Labels automatically."
}
```

STEP: 6 — Paginator Buttons: behavior and conditions

DESCRIPTION: The paginator (Next/Previous) is provided by Fiori elements when the following conditions are met: user navigated from a list, that list contains at least two entries, and the current page is a subobject page. On the first object page, paginator buttons are disabled by default. With OData V2 you can adapt the UI to enable them. This is a behavioral note — no specific manifest key is required in most standard apps; check your app framework version for extension points if you must change default behavior.

LANGUAGE: JSON

CODE:
```json
{
  "paginator": {
    "behavior": [
      "Visible only when user came from a list and list has >= 2 entries",
      "Visible only on subobject pages",
      "Disabled on first object page by default",
      "In OData V2, UI adaptation can enable paginator (see adapting-the-ui-list-report-and-object-page-0d2f1a9.md)"
    ],
    "references": [
      "Adapting the UI: List Report and Object Page - adapting-the-ui-list-report-and-object-page-0d2f1a9.md"
    ]
  }
}
```

STEP: 7 — Footer bar, Actions and Draft Handling

DESCRIPTION: Footer actions and the Show Messages button appear in the object page footer. For draft-enabled apps, footer includes Apply/Discard actions for subitem object pages (create/edit). Apply saves the draft and navigates up one level. Toast messages are shown on successful operations. For flexible column layouts, Apply closes the subobject and returns to the main object. Use Draft Handling annotations and generic capabilities to enable draft behavior.

LANGUAGE: JSON

CODE:
```json
{
  "draft": {
    "notes": [
      "Enable draft handling in your service and app to show footer Apply/Discard in create/edit mode.",
      "Apply action: saves draft and navigates one step up; shows toast on success.",
      "In flexible column layout, Apply closes subobject and returns to main object."
    ],
    "references": [
      "Draft Handling - draft-handling-ed9aa41.md"
    ]
  }
}
```

STEP: 8 — Controls and Further Annotation References

DESCRIPTION: Use the UXAP controls library and the set of UI annotations to fine-tune individual Object Page elements. The links below point to the control reference and annotation configuration guidance (preserve in your docs and code generators to navigate to detailed pages).

LANGUAGE: JSON

CODE:
```json
{
  "related": [
    {
      "subject": "Controls related to object pages",
      "link": "../10_More_About_Controls/sap-uxap-de71337.md"
    },
    {
      "subject": "Annotations used to set up various elements of object pages",
      "links": [
        "Configuring Object Page Features - configuring-object-page-features-d26d3dd.md",
        "Configuring Further Common Features - configuring-further-common-features-a4d3c46.md"
      ]
    }
  ]
}
```
--------------------------------

**TITLE**: Overriding Horizontal Alignment of Annotation-Based Table Columns (manifest.json)

**INTRODUCTION**: This shows how to override the horizontal alignment of columns generated from the UI.LineItem annotation in SAP Fiori elements (OData V4) by adding controlConfiguration entries in manifest.json.

**TAGS**: fiori-elements-framework, sapui5, manifest.json, annotations, OData V4, table, alignment, LineItem

**STEP**: 1 — Add horizontalAlign override in manifest.json

**DESCRIPTION**: Open your app manifest.json and locate the page configuration for the object/page where the annotation-based table is rendered. Under the page's options.settings.controlConfiguration entry, target the LineItem annotation key and specify the column by its DataField name (for example "DataField::Material"). Set "horizontalAlign" to the desired value ("Begin", "Center", or "End").

Place the following snippet into manifest.json (merge with existing content in the page configuration):

**LANGUAGE**: JSON

**CODE**:
```json
"SalesOrderManageObjectPage": {
    "options": {
        "settings": {
            "controlConfiguration": {
                "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                    "columns": {
                        "DataField::Material": {
                            "horizontalAlign": "Center"
                        }
                    }
                }
            }
        }
    }
}
```

File: manifest.json (add the snippet under the appropriate page or view configuration)

**STEP**: 2 — Supported values and multiple-column example

**DESCRIPTION**: Supported values for "horizontalAlign" are "Begin", "Center", and "End". Example showing overrides for multiple annotation-based columns:

**LANGUAGE**: JSON

**CODE**:
```json
"SalesOrderManageObjectPage": {
    "options": {
        "settings": {
            "controlConfiguration": {
                "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                    "columns": {
                        "DataField::Material": {
                            "horizontalAlign": "Center"
                        },
                        "DataField::Quantity": {
                            "horizontalAlign": "End"
                        },
                        "DataField::Description": {
                            "horizontalAlign": "Begin"
                        }
                    }
                }
            }
        }
    }
}
```

**STEP**: 3 — Notes and applicability

**DESCRIPTION**: This override method applies only to SAP Fiori elements for OData V4. The visual result appears in the rendered table column alignments (example image path referenced in original doc: images/Overriding_the_Horizontal_Alignment_of_Annotation-Based_Table_Columns_fc4e1b4.png).
--------------------------------

**TITLE**: Overview Page Card — manifest.json configuration for SAP Fiori Overview Pages (OVP)

**INTRODUCTION**: Configure Overview Page (OVP) cards in the application manifest (manifest.json). This guide shows how to declare cards, set header properties, configure KPI headers via annotations, enable/disable Insights integration, and notes about card actions and ordering. Use these snippets directly in manifest.json.

**TAGS**: fiori-elements-framework, sap.ovp, overview-page, cards, manifest.json, KPI, annotations, insights, SAPUI5

**STEP**: 1 — Declare sap.ovp and cards object in manifest.json

**DESCRIPTION**: Add the top-level sap.ovp key and define the cards object. Card IDs are the property names. Cards are displayed at runtime in the order they appear in the cards object. Include globalFilterModel and globalFilterEntityType if applicable.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (partial)
{
  "sap.ovp": {
    "_version": "1.1.0",
    "globalFilterModel": "ZCD204_EPM_DEMO_SRV",
    "globalFilterEntityType": "SalesOrder",
    "cards": {
      "card00": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.stack",
        "settings": {
          "category": "{{card00_category}}",
          "title": "{{card00_title}}",
          "subTitle": "{{card00_subTitle}}"
        }
      },
      "card01": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.table",
        "settings": {
          "title": "{{card01_title}}"
        }
      }
    }
  }
}
```

**STEP**: 2 — Configure card header properties (title, subtitle, category, counter behavior)

**DESCRIPTION**: In each card's settings object, provide the header properties. title is mandatory. subTitle is mandatory when showing KPI or DataPoint headers. Title and subtitle are limited to two lines. Table and list cards automatically show a counter (records displayed / total) based on current filters.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (card header settings)
"card00": {
  "model": "ZCD204_EPM_DEMO_SRV",
  "template": "sap.ovp.cards.stack",
  "settings": {
    "category": "{{card00_category}}",
    "title": "{{card00_title}}",       // mandatory
    "subTitle": "{{card00_subTitle}}"  // mandatory if KPI/DataPoint header
  }
}
```

**STEP**: 3 — Configure KPI/DataPoint header via annotations (aggregation support required)

**DESCRIPTION**: To display KPI headers, OData service must support backend aggregation. Configure annotation paths in the card settings pointing to the appropriate annotation terms: DataPoint, PresentationVariant, SelectionVariant, Identification (or other UI annotations). These keys are: entitySet, identificationAnnotationPath, selectionAnnotationPath, chartAnnotationPath, presentationAnnotationPath, dataPointAnnotationPath.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (KPI / chart card with annotation paths)
"card02": {
  "model": "ZCD204_EPM_DEMO_SRV",
  "template": "sap.ovp.cards.charts.bubble",
  "settings": {
    "entitySet": "SalesOrders",
    "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#bubble",
    "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#bubble",
    "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#bubble",
    "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#bubble",
    "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#bubble"
  }
}
```

**STEP**: 4 — Card actions availability and requirements

**DESCRIPTION**: Card header actions (Refresh, Add Card to Insights, Manage Cards) are available in SAPUI5 >= 1.110. No extra manifest keys are required to enable these actions (they appear in the card header UI). Ensure your application uses a compatible SAPUI5 runtime version to expose these actions.

**LANGUAGE**: JSON

**CODE**:
```json
// No manifest change required for actions; ensure SAPUI5 runtime meets version requirement.
// Example: index.html or bootstrap should load SAPUI5 >= 1.110
// e.g., <script id="sap-ui-bootstrap" src="https://sapui5.hana.ondemand.com/1.110.0/resources/sap-ui-core.js"></script>
```

**STEP**: 5 — Integrate cards with Insights (My Home) and limit behavior

**DESCRIPTION**: Users can add analytical, list, and table cards to the Insights section (My Home). To control whether a card can be added to Insights, set enableAddToInsights in the card settings (default: true). Note: Insights shows at most 8 cards; if full, selected cards go to Edit Insights dialog. If a card has custom navigation, navigation from Insights goes to the parent overview page.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (disable adding this card to Insights)
"card01": {
  "model": "MODEL",
  "template": "sap.ovp.cards.charts.analytical",
  "settings": {
    "title": "{{card01_title}}",
    "subTitle": "{{card01_subTitle}}",
    "entitySet": "C_EntitySet",
    "enableAddToInsights": false,
    "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#SV",
    "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#Chart",
    "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#PV",
    "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#DP",
    "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification"
  }
}
```

**STEP**: 6 — Notes and best practices

**DESCRIPTION**: Consolidated important behaviors and constraints:
- Card ID = property name in "cards" object; order in the manifest determines display order.
- Use backend aggregation for KPI/DataPoint headers; annotations required: com.sap.vocabularies.UI.v1.DataPoint, PresentationVariant, SelectionVariant, Identification.
- Counter in header is shown only for table and list cards.
- Insights: max 8 cards; manage via enableAddToInsights and the Manage Cards/Insights UI.
- If custom navigation is enabled, Insights navigation returns to the parent overview application.

**LANGUAGE**: JSON

**CODE**:
```json
// Example manifest top-level summary (combine key elements)
{
  "sap.ovp": {
    "_version": "1.1.0",
    "globalFilterModel": "ZCD204_EPM_DEMO_SRV",
    "globalFilterEntityType": "SalesOrder",
    "cards": {
      "card00": { /* stack card with header */ },
      "card01": { /* table card with enableAddToInsights:false */ },
      "card02": { /* bubble chart with annotation paths */ }
    }
  }
}
```
--------------------------------

**TITLE**: SAP Fiori Elements — Overview Page (OVP) Quick Start and Manifest/Component Examples

**INTRODUCTION**: This document gives concise, code-focused examples and file locations for building a SAP Fiori Overview Page (OVP) application. It includes the minimal Component.js that extends the OVP application component, a manifest.json skeleton containing data source and sap.ovp card definitions (chart, list, stack), and a small OData annotation snippet (UI.Chart). Use these examples as copy‑paste starters and adapt entitySet names, annotation paths, and service URLs to your project.

**TAGS**: fiori-elements, ovp, overview-page, manifest, sap.ovp, Component.js, annotations, OData

STEP: 1 — Create the UI Component that extends the OVP application component

DESCRIPTION: Add Component.js in your webapp folder. The component must extend the overview page application component provided by the OVP library and reference the manifest for configuration.

LANGUAGE: JavaScript

CODE:
```JavaScript
// File: webapp/Component.js
sap.ui.define([
  "sap/ovp/app/Component" // OVP application component
], function (OVPComponent) {
  "use strict";
  return OVPComponent.extend("my.company.ovp.Component", {
    metadata: {
      manifest: "json"
    }
  });
});
```

STEP: 2 — Minimal manifest.json structure with OData dataSource and OVP card definitions

DESCRIPTION: Create manifest.json in your webapp folder. This example shows:
- OData V2 data source and default model mapping
- UI5 library dependency on sap.ovp
- sap.ovp configuration with three example cards (analytical chart, list, stack)
- containerLayout.maxColumns set to 5 (OVP supports up to five responsive columns)

Modify entitySet, annotation paths, service URL, and card keys to match your backend and annotations.

LANGUAGE: JSON

CODE:
```JSON
// File: webapp/manifest.json (extract)
{
  "sap.app": {
    "id": "my.company.ovp",
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/ZMY_SERVICE_SRV/",
        "type": "OData",
        "settings": {
          "odataVersion": "2.0"
        }
      }
    }
  },
  "sap.ui5": {
    "dependencies": {
      "libs": {
        "sap.ovp": {},
        "sap.ui.comp": {},
        "sap.m": {},
        "sap.ui.table": {}
      }
    },
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "odataVersion": "2.0"
        }
      }
    },
    "rootView": {
      "viewName": "sap.ovp.app.Ovp", 
      "type": "JS"
    }
  },
  "sap.ovp": {
    "containerLayout": {
      "maxColumns": 5
    },
    "cards": {
      "SalesByRegionChart": {
        "model": "",
        "template": "sap.ovp.cards.charts.analytical",
        "settings": {
          "title": "Sales by Region",
          "entitySet": "SalesOrders",
          "chartAnnotationPath": "@UI.Chart#SalesByRegion"
        }
      },
      "OpenOrdersList": {
        "model": "",
        "template": "sap.ovp.cards.list",
        "settings": {
          "title": "Open Orders",
          "entitySet": "SalesOrders",
          "annotationPath": "@com.sap.vocabularies.UI.v1.LineItem"
        }
      },
      "TopCustomersStack": {
        "model": "",
        "template": "sap.ovp.cards.stack",
        "settings": {
          "title": "Top Customers",
          "entitySet": "Customers",
          "annotationPath": "@com.sap.vocabularies.UI.v1.LineItem"
        }
      }
    }
  }
}
```

STEP: 3 — Example OData V2 XML annotation for a chart used by the OVP card

DESCRIPTION: Add or update annotations (XML) in your annotation file or service metadata to expose chart definitions and qualifiers referenced in the manifest (chartAnnotationPath or annotationPath). Below example defines a UI.Chart qualifier SalesByRegion for the SalesOrders entity.

LANGUAGE: XML

CODE:
```XML
<!-- File: annotations.xml (or service annotations) -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:DataServices>
    <Schema xmlns="http://docs.oasis-open.org/odata/ns/edm" Namespace="ZMY_SERVICE">
      <Annotations Target="ZMY_SERVICE.SalesOrders">
        <Annotation Term="UI.Chart" Qualifier="SalesByRegion">
          <Record Type="UI.ChartDefinition">
            <PropertyValue Property="Measures">
              <Collection>
                <PropertyPath>TotalAmount</PropertyPath>
              </Collection>
            </PropertyValue>
            <PropertyValue Property="Dimensions">
              <Collection>
                <PropertyPath>Region</PropertyPath>
              </Collection>
            </PropertyValue>
            <PropertyValue Property="ChartType" String="Donut"/>
          </Record>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

STEP: 4 — Smart filter (global filters) and card interactivity

DESCRIPTION: OVP supports an application-level Smart Filter and card-to-card navigation. Implement Smart Filter using standard UI annotations (Filterable, UI.SelectionFields) or by including a SmartFilterBar on top of the OVP root view. Card navigation and contextual actions are configured via annotation (com.sap.vocabularies.Common.v1). Use entity-level annotations for filterable properties and define action semantics in annotations to enable clickable areas and navigation.

LANGUAGE: CDS / Annotations (example fragment)

CODE:
```Text
// Example annotation hints (conceptual)
// - Mark filterable properties using UI.SelectionFields or FilterRestrictions
// - Define navigation actions using com.sap.vocabularies.Common.v1.Semantics or UI.LineItem with IntentBasedNavigation

// Example (CDS-like pseudocode):
@UI.selectionField: [{ position: 10 }]
element Region : String;

@UI.lineItem: [{ value: TotalAmount, label: 'Amount' }]
// For intent-based navigation add semantic action annotations on an action binding
```

STEP: 5 — Deployment and keep-alive note

DESCRIPTION: Deploy the webapp (webapp/Component.js + webapp/manifest.json + annotations served via data source). If you run multiple overview page applications and use sap-keep-alive mode, upgrade SAPUI5 to version 1.96 or above to avoid lifecycle issues.

LANGUAGE: Plain text

CODE:
```Text
// Recommendation:
// - Ensure UI5 runtime >= 1.96 when using multiple OVP apps with sap-keep-alive
// - Host annotation XML where the OData service exposes it or provide an annotations file via manifest dataSources
```

STEP: 6 — Further reading / guided development

DESCRIPTION: Use the SAP Fiori generator to scaffold an Overview Page application and Guided Development in SAP Business Application Studio or VS Code to add and customize cards. See the official guides for detailed card templates and annotation formats.

LANGUAGE: Plain text

CODE:
```Text
// Reference links:
// - Guided Development and card authorship: https://help.sap.com/docs/SAP_FIORI_tools
// - Building an App (OVP plugin): building-an-app-9834a0a.md (local docs)
```
--------------------------------

**TITLE**: Passing Variant IDs as URL Parameters (Fiori Elements)

**INTRODUCTION**: Show how to obtain a variant ID from a control or page and pass it as a URL parameter (or via manifest outbound parameters) when navigating between Fiori Elements apps (Analytical List Page / List Report). Include examples for control-level and page-level variants and manifest updates for OData V2 and OData V4.

**TAGS**: fiori-elements, sapui5, variants, manifest.json, crossNavigation, ODataV2, ODataV4, URL-parameters

STEP: 1 — Retrieve the variant ID programmatically (control or page)
DESCRIPTION: Get the stable ID instance of the control or filter bar in the source app and call the control API to obtain the current variant ID. Use this variant ID as the URL parameter value (do not pass the variant name).
LANGUAGE: JavaScript
CODE:
```javascript
// Example: retrieve a control-level variant ID (filterbar, chart, table) or page-level variant
sap.ui.define(["sap/ui/core/Element"], function(Element) {
  "use strict";

  // Replace "myFilterBarId" with the stable ID of the control (defined in view or manifest)
  var controlInstance = Element.getElementById("myFilterBarId"); // or sap.ui.getCore().byId("myFilterBarId")
  if (controlInstance && typeof controlInstance.getCurrentVariantId === "function") {
    var variantId = controlInstance.getCurrentVariantId(); // e.g. "id_1542011587281_230_page"
    // Use variantId when constructing navigation URL or when adding parameters to manifest
    console.log("Variant ID:", variantId);
  } else {
    console.warn("Control not found or does not support getCurrentVariantId()");
  }
});
```

STEP: 2 — Construct navigation URL with variant parameters (examples)
DESCRIPTION: Append the relevant variant parameter(s) to the target app URL. Use the variant ID string retrieved previously. Examples below show page-level and control-level parameters.
LANGUAGE: Text
CODE:
```text
# Page variant parameter (page-level)
https://abc.com/ui#SalesOrder-analyze_deliv_perf?sap-ui-fe-variant-id=id_1542011587281_980_page

# Filter bar control variant parameter (page-level filter bar control)
https://abc.com/ui#SalesOrder-analyze_deliv_perf?sap-ui-fe-filterbar-variant-id=id_1542011587281_230_page

# Chart control variant parameter
https://abc.com/ui#SalesOrder-analyze_deliv_perf?sap-ui-fe-chart-variant-id=id_1574157179885_675_chart

# Table control variant parameter
https://abc.com/ui#SalesOrder-analyze_deliv_perf?sap-ui-fe-table-variant-id=id_1574157179595_331_table

# Both chart and table control variants (URL-encoded "&" separating params)
https://abc.com/ui#SalesOrder-analyze_deliv_perf?sap-ui-fe-chart-variant-id=id_1574157179885_675_chart&sap-ui-fe-table-variant-id=id_1574157179595_331_table
```

STEP: 3 — Add outbound crossNavigation parameter in manifest.json (OData V2)
DESCRIPTION: Configure an outbound in manifest.json to include a variant ID parameter when navigating out. For OData V2 examples, add the parameter as a string value under the app's crossNavigation/outbounds entry.
LANGUAGE: JSON
CODE:
```json
// manifest.json (fragment)
{
  "sap.app": { /* ... */ },
  "sap.ui5": { /* ... */ },
  "crossNavigation": {
    "inbounds": {
      /* ... */
    },
    "outbounds": {
      "EPMProductManage": {
        "semanticObject": "EPMProduct",
        "action": "manage",
        "parameters": {
          "sap-ui-fe-variant-id": "id_1542011587281_980_page"
        }
      }
    }
  }
}
```

STEP: 4 — Add outbound crossNavigation parameter in manifest.json (OData V4)
DESCRIPTION: For OData V4 / Fiori Elements V4 outbound parameters, provide the parameter value using the "value" object and set "format" to "plain".
LANGUAGE: JSON
CODE:
```json
// manifest.json (fragment) - OData V4 style outbound parameter
{
  "sap.app": { /* ... */ },
  "sap.ui5": { /* ... */ },
  "crossNavigation": {
    "outbounds": {
      "ProductDetails": {
        "semanticObject": "Manage",
        "action": "items",
        "parameters": {
          "sap-ui-fe-variant-id": {
            "value": {
              "value": "id_1633600133090_222",
              "format": "plain"
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Parameter precedence, fallback, and validation rules
DESCRIPTION: Rules when passing page and control variant IDs together and expected behavior on invalid IDs.
LANGUAGE: Text
CODE:
```text
- If both a page variant (sap-ui-fe-variant-id) and a control variant (e.g. sap-ui-fe-table-variant-id) are present:
  - Page-variant-based ALP/List Report: the page-level variant wins and control variant IDs are ignored.
  - Control-variant-based ALP/List Report: the control variant ID is applied. If the control variant ID is missing, the page variant ID applies to the control.
- If the passed variant ID does not exist in the target app, the app uses the default/standard variant.
- Passing a variant ID in the URL overrides the user's saved default variant.
- Always pass the variant ID string (not the variant name).
```

STEP: 6 — Quick checklist for implementation
DESCRIPTION: Checklist to ensure correct behavior when integrating variant ID navigation.
LANGUAGE: Text
CODE:
```text
- Retrieve variant ID via control API: getCurrentVariantId()
- Confirm the variant ID exists in the target app (same control/page)
- Use the correct URL parameter name for the variant type:
  - Page: sap-ui-fe-variant-id
  - Filter bar: sap-ui-fe-filterbar-variant-id
  - Chart: sap-ui-fe-chart-variant-id
  - Table: sap-ui-fe-table-variant-id
- Update manifest.json outbound parameters for programmatic navigation (use OData V2 or V4 format accordingly)
- Test navigation with valid, missing, and invalid variant IDs to verify fallback to default variant
```
--------------------------------

**TITLE**: Placing and Managing Reuse Component Instances on the Object Page (OData V2 & V4)

**INTRODUCTION**: Practical, code-focused guidance and ready-to-use examples for placing, grouping, hiding, refreshing and title-integration of reuse component instances on SAP Fiori elements Object Pages (both OData V2 and OData V4). Includes manifest.json routing/embeddedComponents examples and extension API usage (component.js/controller snippets).

**TAGS**: fiori-elements-framework, reuse-component, object-page, embeddedComponents, manifest.json, sap.ui5.routing, OData V2, OData V4, extensionAPI, stRefreshTrigger, SetSectionHidden, setAsTitleOwner

**STEP**: Add a reuse component as a subsection to an existing section (OData V2)

**DESCRIPTION**: Use embeddedComponents in manifest.json and set leadingSectionIdOrPath to the section ID or annotation path (collection facet ID or reference facet annotation path). This attaches the reuse component as a final subsection of the specified section during templating. Place this in manifest.json under the corresponding app descriptor entry for embeddedComponents.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "embeddedComponents": {
    "tableTest": {
      "id": "tableTest",
      "componentName": "STTA_MP.reuseComponents.tableTest",
      "title": "{{SalesPriceReuse}}",
      "leadingSectionIdOrPath": "GeneralInformation",
      "settings": {
        "navigationProperty": "to_ProductSalesPrice"
      }
    }
  }
}
```

**STEP**: Group reuse components into a single section (OData V2)

**DESCRIPTION**: Define multiple embeddedComponents and use groupTitle on the leading component to form a grouped section. Use one component's ID as leadingSectionIdOrPath for the others. If grouping configuration is invalid (e.g., a reuse component reused elsewhere), the framework falls back to separate sections.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "embeddedComponents": {
    "stateTest": {
      "id": "stateTest",
      "componentUsage": "stateTest",
      "title": "{{stateReuse}}",
      "groupTitle": "{{reuseGroupTitle}}"
    },
    "situationsTest": {
      "id": "situationsTest",
      "componentName": "STTA_MP.reuseComponents.situationsTest",
      "title": "{{situationsReuse}}",
      "settings": {
        "productKey": "{ProductForEdit}"
      },
      "leadingSectionIdOrPath": "stateTest"
    }
  }
}
```

**STEP**: Hide a reuse component via API (OData V2)

**DESCRIPTION**: Call the extension API SetSectionHidden from the reusable component (component.js or controller) to hide the section/subsection that hosts only reuse components. The API is named sap.suite.ui.generic.template.ObjectPage.extensionAPI.ExtensionAPI.setSectionHidden and takes a single Boolean argument. Use attachPageDataLoaded to evaluate context and set visibility.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// component.js (inside your reusable component)
// Register on page data loaded and set section hidden based on context
function fnRegisterOnPageDataLoaded(oExtensionAPI) {
    oExtensionAPI.attachPageDataLoaded(function (oEvent) {
        var oContextData = oEvent.context.getObject();
        // setSectionHidden expects true/false. Hide when ProductCategory !== "Notebooks"
        (oExtensionAPI.setSectionHidden || jQuery.noop)(oContextData.ProductCategory !== "Notebooks");
    });
}
```

**STEP**: Trigger refresh of a reuse component using stRefreshTrigger (OData V2)

**DESCRIPTION**: The reuse component should expose a stRefresh() function which the framework calls when stRefreshTrigger changes. Configure stRefreshTrigger in embeddedComponents settings. Examples: single property, multiple properties concatenation, and expression-based triggers.

**LANGUAGE**: JSON

**CODE**:
```json
// Trigger refresh when changing the value of a property
{
  "embeddedComponents": {
    "priceComponentEmbedding": {
      "id": "priceComponentEmbedding",
      "componentUsage": "priceComponentUsage",
      "title": "{{I18N_KEY_FOR_PRICE_COMPONENT_TITLE}}",
      "settings": {
        "stRefreshTrigger": "{Price}"
      }
    }
  }
}
```

```json
// Trigger refresh when changing the values of multiple properties
{
  "embeddedComponents": {
    "priceComponentEmbedding": {
      "id": "priceComponentEmbedding",
      "componentUsage": "priceComponentUsage",
      "title": "{{I18N_KEY_FOR_PRICE_COMPONENT_TITLE}}",
      "settings": {
        "stRefreshTrigger": "{Price}{Supplier}"
      }
    }
  }
}
```

```json
// Trigger refresh when changing the values of a computed combination of properties
{
  "embeddedComponents": {
    "priceComponentEmbedding": {
      "id": "priceComponentEmbedding",
      "componentUsage": "priceComponentUsage",
      "title": "{{I18N_KEY_FOR_PRICE_COMPONENT_TITLE}}",
      "settings": {
        "stRefreshTrigger": "{= ${Price}+${Supplier}}"
      }
    }
  }
}
```

**STEP**: Set the section/subsection title to come from a control inside the reuse component (setAsTitleOwner)

**DESCRIPTION**: Use setAsTitleOwner to hide the section title and use the control's title instead. For SmartTable/SmartChart scenario, bind initialise in XML and call setAsTitleOwner for SmartTable/SmartChart in the initialise handler. For other controls, call setAsTitleOwner in onInit with the control instance. The control must expose a header or text property.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- reuse component view (XML) -->
<st:SmartTable id="SalesPriceFacetID" initialise="SalesPriceInitialise"/>
```

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// reuse component controller
SalesPriceInitialise: function (oEvent) {
    var oSmartTable = oEvent.getSource();
    // getExtensionAPI is a helper to obtain extension API for the control
    var oExtensionAPI = extensionAPI.getExtensionAPI(oSmartTable);
    // register the SmartTable/SmartChart as title owner for the section/subsection
    oExtensionAPI.setAsTitleOwner(oSmartTable);
}
```

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// For non-SmartTable controls: call in onInit of the reuse component controller
onInit: function () {
    var oControl = this.byId("myControlId"); // control must have header/text
    var oExtensionAPI = extensionAPI.getExtensionAPI(oControl);
    oExtensionAPI.setAsTitleOwner(oControl);
}
```

**STEP**: Place reuse components into custom subsections using UI5 routing (OData V4)

**DESCRIPTION**: For OData V4 object pages, add custom subsections in the object page target content and then add the reuse component as a separate target that uses type "Component". In manifest.json: add the reuse component target with parent set to the object page target, controlId matching the subsection controlId, controlAggregation usually "blocks", and clearControlAggregation true (optional). Add the reuse component name as a target in the object page route.

Place this JSON under "sap.ui5.routing" in manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": "myEntitySet({key}):?query:",
          "name": "myObjectPage",
          "target": ["myObjectPage", "ReuseComponent", "ReuseComponent2"]
        }
      ],
      "targets": {
        "myObjectPage": {
          "type": "Component",
          "id": "myObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "mySection": {
                      "subSections": {
                        "ReuseContainer": {
                          "title": "{i18n>reuseTitle}",
                          "controlId": "firstReuseContainer",
                          "position": {
                            "placement": "After",
                            "anchor": "someSubSection"
                          }
                        }
                      }
                    },
                    "ReuseComponentContainer": {
                      "position": {
                        "placement": "Before",
                        "anchor": "mySubSection"
                      },
                      "title": "Reuse Container",
                      "subSections": {
                        "ReuseContainer": {
                          "controlId": "secondReuseContainer"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "ReuseComponent": {
          "type": "Component",
          "id": "Reuse",
          "name": "path/to/reuseComponent",
          "options": {
            "settings": {
              "exampleSettings": "{somePropertyName}"
            }
          },
          "parent": "myObjectPage",
          "controlId": "firstReuseContainer",
          "controlAggregation": "blocks",
          "clearControlAggregation": true
        },
        "ReuseComponent2": {
          "type": "Component",
          "id": "Reuse2",
          "name": "path/to/reuseComponent2",
          "options": {
            "settings": {
              "exampleSettings": "{somePropertyName}"
            }
          },
          "parent": "myObjectPage",
          "controlId": "secondReuseContainer",
          "controlAggregation": "blocks",
          "clearControlAggregation": true
        }
      }
    }
  }
}
```

**STEP**: Hide a reuse component in OData V4

**DESCRIPTION**: A reuse component is bound to its custom subsection; hide the reuse component by hiding the corresponding subsection via extension points for subsections (i.e., apply hiding logic to the subsection control or routing target that contains the component).

**LANGUAGE**: JSON

**CODE**:
```json
// Example: hide the subsection by routing/config or extension which controls the subsection visibility.
// (Implementation depends on the extension point you use to manage the subsection)
{
  "myObjectPage": {
    "options": {
      "settings": {
        "content": {
          "body": {
            "sections": {
              "mySection": {
                "subSections": {
                  "ReuseContainer": {
                    "visible": false
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Refresh reuse components in OData V4

**DESCRIPTION**: The reuse component must implement property setters for exposed properties so that when the framework updates those properties (via binding or routing), the component reacts (e.g., performs data fetch or UI refresh) inside the setter or in onBeforeRendering/onAfterRendering as needed.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// In reuse component (Component.js or controller) implement setters for bound properties
// Example: if "exampleSettings" is passed as an option, implement a setter to react to changes
sap.ui.define([
  "sap/ui/core/Control"
], function (Control) {
  return Control.extend("path.to.reuseComponent.MyControl", {
    metadata: {
      properties: {
        exampleSettings: { type: "string", defaultValue: null }
      }
    },
    setExampleSettings: function (sValue) {
      this.setProperty("exampleSettings", sValue, true); // suppress re-render by default
      // react to the property change: refresh data/UI here
      this._refreshOnSettingsChange(sValue);
      return this;
    },
    _refreshOnSettingsChange: function (sValue) {
      // implement refresh logic (bind, fetch data, call stRefresh-style function, etc.)
    }
  });
});
```
--------------------------------

**TITLE**: Plain Text Facet for Object Page Header (UI.ReferenceFacet + UI.FieldGroup + UI.MultiLineText)

**INTRODUCTION**: Create a plain text facet in the object page header to display a single multiline text field (e.g., product description). Use UI.HeaderFacets / UI.ReferenceFacet to reference a UI.FieldGroup qualifier (PlainText) that contains a UI.DataField pointing to the Description property. Mark the Description property as UI.MultiLineText.

**TAGS**: fiori-elements-framework, UI.ReferenceFacet, UI.FieldGroup, UI.MultiLineText, annotations, CDS, XML, ABAP, CAP

STEP: 1 — Define the UI.FieldGroup qualifier "PlainText" with a UI.DataField for Description

DESCRIPTION: Create a FieldGroup annotation with qualifier PlainText. The FieldGroup's Data collection should contain a UI.DataField whose Value is the Description property.

LANGUAGE: XML
CODE:
```xml
<!-- Annotation file (e.g., annotations.xml) -->
<Annotation Term="UI.FieldGroup" Qualifier="PlainText">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="Description"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
/* In a CDS view or annotation file */
@UI.fieldGroup: [
  {
    qualifier: 'PlainText'
  }
]
/* Ensure the field group is applied to the appropriate entity/element */
DESCRIPTION;
```

LANGUAGE: CAP CDS (annotations JSON-style)
CODE:
```json
/* In an annotations file or CAP annotations block */
UI.FieldGroup#PlainText : {
  Data : [
    {
      $Type : "UI.DataField",
      Value : Description
    }
  ]
}
```

STEP: 2 — Add a UI.ReferenceFacet (inside UI.HeaderFacets) that references the FieldGroup#PlainText

DESCRIPTION: Place a ReferenceFacet into header facets (UI.HeaderFacets or UI.HeaderFacet term) and set Label and Target to point to the FieldGroup qualifier PlainText. Examples: XML (HeaderFacets container), ABAP CDS @UI.facet (fieldgroup reference), and CAP CDS object for UI.ReferenceFacet.

LANGUAGE: XML
CODE:
```xml
<!-- Attach to the entity or service root annotations (e.g., annotations.xml) -->
<Annotation Term="UI.HeaderFacets">
  <Collection>
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="{@i18n>@ProductDescription}"/>
      <!-- Target points at the navigation property and the FieldGroup qualifier -->
      <PropertyValue Property="Target" AnnotationPath="to_ProductTextInCurrentLang/@UI.FieldGroup#PlainText"/>
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
/* Use @UI.facet in the CDS entity to create a reference facet for header */
@UI.facet: [
  {
    label:        '{@i18n>@ProductDescription}',
    purpose:      #STANDARD,
    type:         #FIELDGROUP_REFERENCE,
    targetElement: '_ProductTextInCurrentLang',   /* navigation or element name */
    targetQualifier: 'PlainText'
  }
]
/* Place the annotation on the corresponding entity or projection */
```

LANGUAGE: CAP CDS (annotations JSON-style)
CODE:
```json
/* In CAP annotation file where you define facets */
{
  "$Type": "UI.ReferenceFacet",
  "Label": "{@i18n>@ProductDescription}",
  "Target": "to_ProductTextInCurrentLang/@UI.FieldGroup#PlainText"
}
```

STEP: 3 — Mark the Description property as multiline text (UI.MultiLineText)

DESCRIPTION: Annotate the Description property with UI.MultiLineText so the framework treats it as multiline text for the header facet rendering.

LANGUAGE: XML
CODE:
```xml
<!-- Example target is STTA_PROD_MAN.STTA_C_MP_ProductTextType/Description -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductTextType/Description">
  <Annotation Term="UI.MultiLineText"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
/* Annotate the view element as multiline text */
annotate view STTA_C_MP_PRODUCTTEXTTYPE with {
  @UI.multiLineText: true
  description;
}
```

LANGUAGE: CAP CDS
CODE:
```json
/* CAP-style annotation block */
annotate STTA_PROD_MAN.STTA_C_MP_ProductTextType with {
  @UI.MultiLineText
  Description
};
```

STEP: 4 — (Optional) Define CDS annotation element multiLineText and apply it in CDS sources

DESCRIPTION: If you want a dedicated CDS annotation definition for multiLineText, define it and then use it on the Description field.

LANGUAGE: CDS (Annotation Definition)
CODE:
```
//@Scope: #ELEMENT
multiLineText: Boolean default true;
```

LANGUAGE: CDS (Source usage)
CODE:
```
// Apply the annotation to the field declaration in the CDS source
@UI.multiLineText
Description: String;
```
--------------------------------

**TITLE**: Prefilling Fields Using the DefaultValuesFunction (Fiori elements / OData)

**INTRODUCTION**: Use the DefaultValuesFunction to provide default values when creating a new entity or when prefilling action parameters in SAP Fiori elements. This shows the exact OData FunctionImport and annotation patterns to wire a backend function to the DefaultValuesFunction annotation.

**TAGS**: fiori-elements, OData V2, OData V4, DefaultValuesFunction, annotations, FunctionImport, metadata

STEP: Applicability and behavior

DESCRIPTION: When to use DefaultValuesFunction and key behavior notes:
- Applicable scenarios:
  - SAP Fiori elements for OData V2 non-draft apps.
  - SAP Fiori elements for OData V2 and OData V4 draft apps only when using empty row mode (inline creation / empty row).
- Multiselect behavior: for multiselect only the DefaultValuesFunction without any input parameters is called.
- Implementation overview: implement a FunctionImport on the OData service and add an annotation with Term com.sap.vocabularies.Common.v1.DefaultValuesFunction whose String value is the FunctionImport name. The annotation target points to the EntitySet (for root entity creation) or the navigation property (for item creation).

LANGUAGE: Text

CODE:
```text
Applicability:
- OData V2 non-draft applications
- OData V2 and OData V4 drafts in empty row (inline creation) mode

Behavior:
- Multiselect: only DefaultValuesFunction without input parameters is called
- Configure a FunctionImport and reference it via
  Annotation Term="com.sap.vocabularies.Common.v1.DefaultValuesFunction" String="<FunctionImportName>"
```

STEP: Create entity — FunctionImport + DefaultValuesFunction annotation (root entity)

DESCRIPTION: Add a FunctionImport that returns the default values type and annotate the EntitySet/EntityType root target with the DefaultValuesFunction annotation. Place the FunctionImport in your service metadata (Schema) and the annotation in the annotations section (or same edmx) targeted at the EntitySet or EntityType path.

LANGUAGE: XML

CODE:
```xml
<!-- FunctionImport that returns default values for creating a root entity -->
<FunctionImport Name="GetDefaultsForRoot" ReturnType="cds_zrc_dv_defaultvalues.ZRC_DV_A_Create" m:HttpMethod="GET"/> 

<!-- Annotation that binds the FunctionImport to the entity root (EntitySet or EntityType path) -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="cds_zrc_dv_defaultvalues.cds_zrc_dv_defaultvalues_Entities/Root">
  <Annotation Term="com.sap.vocabularies.Common.v1.DefaultValuesFunction" String="GetDefaultsForRoot"/>
</Annotations>
```

STEP: Navigation property / item create — FunctionImport + DefaultValuesFunction annotation (item)

DESCRIPTION: For creation of a child/item via a navigation property, add a FunctionImport that takes identifying parameters (e.g., parent key) and annotate the navigation property target path with DefaultValuesFunction referencing the FunctionImport name.

LANGUAGE: XML

CODE:
```xml
<!-- FunctionImport for item creation; includes a parameter (parent UUID) -->
<FunctionImport Name="GetDefaultsForItem" ReturnType="cds_zrc_dv_defaultvalues.ZRC_DV_A_Create" m:HttpMethod="GET" sap:action-for="cds_zrc_dv_defaultvalues.RootType">
  <Parameter Name="UUID" Type="Edm.Guid" Mode="In"/>
</FunctionImport>

<!-- Annotation that binds the FunctionImport to the navigation property (to_Item) -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="cds_zrc_dv_defaultvalues.RootType/to_Item">
  <Annotation Term="com.sap.vocabularies.Common.v1.DefaultValuesFunction" String="GetDefaultsForItem"/>
</Annotations>
```

STEP: Implementation checklist (action-oriented)

DESCRIPTION: Checklist to implement DefaultValuesFunction end-to-end:
- Implement FunctionImport in the OData service metadata (within <Schema>).
- Ensure FunctionImport ReturnType maps to a complex/type that returns default values (e.g., ZRC_DV_A_Create).
- Expose FunctionImport via GET (or appropriate HTTP method) as shown.
- Add annotation Target pointing to the EntitySet or navigation property path and set Term com.sap.vocabularies.Common.v1.DefaultValuesFunction with the FunctionImport name as String.
- For navigation/item case, include any required input parameters (e.g., parent key) on the FunctionImport.
- Validate behavior in the UI: create action or empty-row creation should call the FunctionImport and prefill fields.

LANGUAGE: Text

CODE:
```text
Implementation checklist:
1. Add FunctionImport to service metadata (<Schema>).
2. Define ReturnType that contains the default values payload.
3. Use m:HttpMethod (e.g., GET) and parameter(s) when needed.
4. Add <Annotations> with Term="com.sap.vocabularies.Common.v1.DefaultValuesFunction"
   and String="<FunctionImportName>" targeting the EntitySet or navigation property.
5. For multiselect: provide a parameterless DefaultValuesFunction if multiselect is used.
```

STEP: Related docs / references

DESCRIPTION: Additional documentation referenced by name (use these file names to locate the full content in your docs repository).

LANGUAGE: Text

CODE:
```text
Prefilling Fields When Creating a New Entity: prefilling-fields-when-creating-a-new-entity-11ff444.md
Prefilling Fields When Creating a New Entity Using an Extension Point: prefilling-fields-when-creating-a-new-entity-using-an-extension-point-189e2d8.md
Actions overview: actions-cbf16c5.md
```
--------------------------------

**TITLE**: Prefilling Fields When Creating a New Entity (Fiori Elements)

**INTRODUCTION**: This reference explains how to prefill fields when creating a new entity in SAP Fiori Elements apps. It covers server-side prefill for draft-enabled entities, how to transfer values from the front end, OData V2 UI extension options, and OData V4 NewAction annotation. Use these patterns when you need default values or values coming from a prior user interaction (cross-app navigation or UI selection).

**TAGS**: fiori-elements-framework, odata, odata-v2, odata-v4, draft, prefill, default-values, extension-point, DefaultValuesFunction, NewAction, cross-app-navigation, CAP

**STEP**: 1 — Server-side prefill for draft-enabled entities

**DESCRIPTION**: Implement server-side logic to set default/prefill values for new entities. For draft-enabled services, the back-end draft/create handler is the recommended place to add defaults so every creation (UI or API) receives the same initial values. Example shown for SAP CAP (Node.js) service implementation using a before CREATE handler.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// srv/handlers.js (SAP CAP service implementation)
// Register handlers in your service module (module.exports = srv => { ... })
module.exports = (srv) => {
  // Prefill fields before CREATE for entity "SalesOrders"
  srv.before('CREATE', 'SalesOrders', (req) => {
    // req.data contains client-supplied values (if any)
    // Set default values or override fields here
    req.data.Status = req.data.Status || 'NEW';
    req.data.CreatedBy = req.user.id || 'anonymous';
    // Combine values coming from front-end or other logic
    if (!req.data.Priority && req.data.CustomerType === 'VIP') {
      req.data.Priority = 'High';
    }
  });

  // Alternatively, implement more complex draft behavior in custom actions/handlers
};
```

**STEP**: 2 — Passing values from the front end to the back end

**DESCRIPTION**: If values are known on the front end (for example, from a previous user action or cross-app navigation), include them in the create request payload or pass them as navigation parameters. The server-side CREATE handler then receives these values in req.data and can apply or augment them. Examples below show an OData V2/V4 UI5 ODataModel create call and a cross-app navigation parameter pattern.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// UI5: direct ODataModel create with prefilling values in the payload
var oModel = this.getView().getModel(); // ODataModel (V2 or V4)
oModel.create("/SalesOrders", {
  Customer: "CUST_123",
  Status: "NEW",
  RequestedDeliveryDate: "2025-10-20"
}, {
  success: function(oCreatedEntity) { /* handle success */ },
  error: function(oError) { /* handle error */ }
});

// Cross-app navigation: pass semantic parameters (example)
sap.ushell.Container.getService('CrossApplicationNavigation').toExternal({
  target: { semanticObject: 'SalesOrder', action: 'create' },
  params: { Customer: 'CUST_123', SourceContext: 'APP_XYZ' }
});
// The receiving app can map these parameters to the create payload (see "Handling of the preferredMode Parameter").
```

**STEP**: 3 — Use caution: UX considerations

**DESCRIPTION**: Only prefill when the user expects defaults or when fields are visible. Prefilling unexpected fields can confuse users. Avoid prefill if fields might be hidden or unrelated to the user's context.

**LANGUAGE**: Text

**CODE**:
```text
Note:
- Use prefill features carefully: users may not expect prefilled values.
- Do not prefill fields that are not or might not be visible to the user.
```

**STEP**: 4 — Additional OData V2: UI-side extension points and DefaultValuesFunction

**DESCRIPTION**: For OData V2 Fiori Elements apps there are additional UI-side options:
- Use the extension point documented in "Prefilling Fields When Creating a New Entity Using an Extension Point" to inject front-end logic.
- Use DefaultValuesFunction to compute values for creation on the UI layer (documented separately).

Follow the linked docs for detailed examples:
- Prefilling Fields When Creating a New Entity Using an Extension Point: prefilling-fields-when-creating-a-new-entity-using-an-extension-point-189e2d8.md
- Prefilling Fields Using the DefaultValuesFunction: prefilling-fields-using-the-defaultvaluesfunction-5ada91c.md

**LANGUAGE**: Text

**CODE**:
```text
Links:
- Extension point doc: prefilling-fields-when-creating-a-new-entity-using-an-extension-point-189e2d8.md
- DefaultValuesFunction doc: prefilling-fields-using-the-defaultvaluesfunction-5ada91c.md
```

**STEP**: 5 — OData V4: Define NewAction to collect parameters at creation (List Report)

**DESCRIPTION**: For OData V4 list reports, define a NewAction annotation that exposes parameters so users can provide values during creation. If POST-based creation occurs and there are non-computed key fields or immutable fields, a dialog is shown to the user. Place the annotation in your service’s CDS/EDMX annotation file or annotation XML.

**LANGUAGE**: XML

**CODE**:
```XML
<!-- Example annotation to reference a NewAction for draft root -->
<Annotation Term="Common.DraftRoot">
    <Record Type="Common.DraftRootType">
        <PropertyValue Property="NewAction" String="com.sap.gateway.srvd.c_salesordermanage_sd.v0001.CreateWithSalesOrderType"/>
        <!-- Additional properties as needed -->
    </Record>
</Annotation>
```

**STEP**: 6 — Related references

**DESCRIPTION**: Use these documents for deeper integration points and behaviors:
- Handling of the preferredMode Parameter: handling-of-the-preferredmode-parameter-bfaf3cc.md
- Actions in the List Report: actions-in-the-list-report-993e99e.md

**LANGUAGE**: Text

**CODE**:
```text
Related Information:
- Handling of the preferredMode Parameter: handling-of-the-preferredmode-parameter-bfaf3cc.md
- Actions in the List Report: actions-in-the-list-report-993e99e.md
```
--------------------------------

**TITLE**: Prefill Fields on Create Using List Report Extension (OData V2)

**INTRODUCTION**: Provide end users the option to "Create with Filters" in a Fiori elements List Report (OData V2). This passes values from the SmartFilterBar (or default values) into the new-entity creation flow by implementing a getPredefinedValuesForCreateExtension extension function. The manifest enables the menu button; the extension function builds the name→value map used during creation.

**TAGS**: fiori-elements-framework, sapui5, odata-v2, list-report, smartfilterbar, extension, create-with-filters

**STEP**: 1 - Enable "Create with Filters" menu button in manifest.json

**DESCRIPTION**: Add the createWithFilters setting to the target List Report page in sap.ui.generic.app/pages to replace the standard Create button with a menu offering "Create Object" and "Create with Filters". This example shows the minimal manifest fragment to enable the extension strategy.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.6.0",
    "settings": { },
    "pages": {
      "ListReport|myEntitySet": {
        "entitySet": "myEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "createWithFilters": {
              "strategy": "extension"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 - Behavior and i18n notes

**DESCRIPTION**: Result: the Create button becomes a menu with two entries:
- Primary: label uses i18n key CREATE_NEW_OBJECT (default: "Create Object") — recommend replacing it with a specific label (e.g., "Create New Product").
- Secondary: "Create with Filters" — do not override.
Note: "Create with Filters" is enabled only if the table data corresponds to the displayed filter values (user may need to press "Go" first).

**LANGUAGE**: Text

**CODE**:
```text
- Primary button label: i18n key "CREATE_NEW_OBJECT" (recommend customizing)
- Secondary menu entry: "Create with Filters" (keep default)
- The menu entry is enabled only when displayed list data corresponds to the current filter selection.
```

**STEP**: 3 - Implement getPredefinedValuesForCreateExtension(oSmartFilterBar)

**DESCRIPTION**: Implement this extension function in your List Report controller extension. The function receives an instance of sap.ui.comp.smartfilterbar.SmartFilterBar and must return an object mapping field names to values for the create action. Use the SmartFilterBar UI state SelectionVariant to inspect SelectOptions. Only transfer a field value if exactly one range exists and that range has Sign === "I" and Option === "EQ" (unique equality). Use this method for fields that are available and editable on the object page and cannot be changed by UI adaptation to avoid surprising end users.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example implementation for transferring "ProductCategory" and "Supplier"
getPredefinedValuesForCreateExtension: function(oSmartFilterBar) {
    var oRet = {};
    var oSelectionVariant = oSmartFilterBar.getUiState().getSelectionVariant();
    var aSelectOptions = oSelectionVariant && oSelectionVariant.SelectOptions ? oSelectionVariant.SelectOptions : [];

    var fnTransfer = function(sFieldname) {
        for (var i = 0; i < aSelectOptions.length; i++) {
            var oSelectOption = aSelectOptions[i];
            if (oSelectOption.PropertyName === sFieldname) {
                if (oSelectOption.Ranges && oSelectOption.Ranges.length === 1) {
                    var oFilter = oSelectOption.Ranges[0];
                    if (oFilter.Sign === "I" && oFilter.Option === "EQ") {
                        oRet[sFieldname] = oFilter.Low;
                    }
                }
                break;
            }
        }
    };

    fnTransfer("ProductCategory");
    fnTransfer("Supplier");

    return oRet;
}
```

**STEP**: 4 - Implement getPredefinedValuesForCreateExtension(oSmartFilterBar, oDefaultValues) to use DefaultValuesFunction

**DESCRIPTION**: If you also want to use values provided by the DefaultValuesFunction as fallbacks, implement the two-parameter signature. The function should prefer unique filter values from the SmartFilterBar and fall back to fields from oDefaultValues when no unique filter exists.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example implementation using oDefaultValues as fallback
getPredefinedValuesForCreateExtension: function(oSmartFilterBar, oDefaultValues) {
    var oRet = {};
    var oSelectionVariant = oSmartFilterBar.getUiState().getSelectionVariant();
    var aSelectOptions = oSelectionVariant && oSelectionVariant.SelectOptions ? oSelectionVariant.SelectOptions : [];

    var fnTransfer = function(sFieldname) {
        var transferred = false;
        for (var i = 0; i < aSelectOptions.length; i++) {
            var oSelectOption = aSelectOptions[i];
            if (oSelectOption.PropertyName === sFieldname) {
                if (oSelectOption.Ranges && oSelectOption.Ranges.length === 1) {
                    var oFilter = oSelectOption.Ranges[0];
                    if (oFilter.Sign === "I" && oFilter.Option === "EQ") {
                        oRet[sFieldname] = oFilter.Low;
                        transferred = true;
                    }
                }
                break;
            }
        }
        if (!transferred && oDefaultValues && Object.prototype.hasOwnProperty.call(oDefaultValues, sFieldname)) {
            oRet[sFieldname] = oDefaultValues[sFieldname];
        }
    };

    fnTransfer("ProductCategory");
    fnTransfer("Supplier");

    return oRet;
}
```

**STEP**: 5 - Best practices and constraints

**DESCRIPTION**: Keep these rules in mind when implementing:
- Only prefill fields that are present and editable on the create/object page and cannot be changed via UI adaptation.
- Ensure values from filters are single EQ ranges (Sign "I", Option "EQ", single range).
- Confirm users can see and edit the prefilled fields on the object page to avoid saving unseen data.
- For cross-app navigation prefilling, use the cross-app navigation approach (different topic).
--------------------------------

**TITLE**: Prerequisites and Quick Checks for Building SAP Fiori Elements Apps (OData V4)

**INTRODUCTION**: This document lists concise, developer-focused prerequisites and quick verification steps required to build SAP Fiori elements apps using OData V4. Use the checks and sample requests to validate services, tool setup, backend compatibility, and system requirements before scaffolding or coding the UI.

**TAGS**: sap, fiori-elements, odata-v4, cap, abap, value-help, draft, sap-fiori-tools, prerequisites

**STEP**: 1 — Service and Data Model Constraints

**DESCRIPTION**: SAP Fiori elements apps expect a single OData service to provide the data for all controls. Exceptions: KPI tags on Analytical List Page and Value Help implemented via ValueHelp/ValueListReference. Ensure your service design follows this rule.

**LANGUAGE**: TEXT

**CODE**:
```TEXT
Rules:
- Fiori elements supports one OData service as the data source for all UI controls.
- Exceptions: KPI tags used in Analytical List Page, and Value Help (ValueHelp/ValueListReference) may use separate services.
- If a separate value-help service is used via ValueListReference, it must meet the same OData query-option requirements listed below.
```

**STEP**: 2 — Required OData V4 Query Options & Quick HTTP Tests

**DESCRIPTION**: Confirm the service supports the OData query options required by Fiori elements: $count, $skip, $top. Use these sample HTTP requests to validate behavior (replace host, service name, and entity set).

**LANGUAGE**: REST

**CODE**:
```REST
# 1) Validate $count support
GET https://myserver.example.com/odata/MyService/Items?$count=true
# Expect: JSON response with '@odata.count' or equivalent count semantics.

# 2) Validate $skip and $top paging support
GET https://myserver.example.com/odata/MyService/Items?$skip=20&$top=10
# Expect: returns items 21..30 (or fewer) and supports paging semantics.

# 3) Example value help service (ValueListReference must support same options)
GET https://myserver.example.com/odata/MyValueHelpService/ValueHelpEntity?$count=true&$top=50
```

**STEP**: 3 — Quick curl Examples to Verify Endpoints

**DESCRIPTION**: Use curl to test the service endpoints from a CLI. Replace credentials and URLs.

**LANGUAGE**: SHELL

**CODE**:
```bash
# Test $count
curl -u USER:PWD "https://myserver.example.com/odata/MyService/Items?\$count=true" -H "Accept: application/json"

# Test skip/top paging
curl -u USER:PWD "https://myserver.example.com/odata/MyService/Items?\$skip=10&\$top=20" -H "Accept: application/json"
```

**STEP**: 4 — Tooling: SAP Fiori tools (BAS / VS Code)

**DESCRIPTION**: Use SAP Fiori tools (extensions) in SAP Business Application Studio or Visual Studio Code to build Fiori elements apps. For OData V4 edit scenarios, the service must be draft-enabled.

**LANGUAGE**: TEXT

**CODE**:
```TEXT
- Use: SAP Fiori tools (VS Code extension pack or SAP Business Application Studio)
- Note: For edit scenarios in OData V4, service must be draft-enabled (draft handling required).
- Installation: In VS Code, open Extensions view and install "SAP Fiori tools" extension pack, or use SAP Business Application Studio (see SAP Help links below).
```

**STEP**: 5 — Back-End Frameworks and Reference Links

**DESCRIPTION**: Use the framework docs below to build OData V4 services. If using CAP, note the default OData protocol and security compatibility requirements.

**LANGUAGE**: TEXT

**CODE**:
```TEXT
Documentation and recommended back-end references:
- SAP S/4HANA: ABAP RESTful Application Programming Model
  https://help.sap.com/viewer/fc4c71aa50014fd1b43721701471913d/latest/en-US
- SAP BTP ABAP Environment: ABAP RAP
  https://help.sap.com/viewer/923180ddb98240829d935862025004d6/Cloud/en-US/289477a81eec4d4e84c0302fb6835035.html
- SAP Cloud Application Programming Model (CAP)
  https://cap.cloud.sap/docs/

Notes:
- CAP defaults to OData V4. Some projects may need OData V2 to support existing V2 UIs.
- If using CAP + OData V4, ensure back-end security configuration matches the app design.
  See: security-configuration-ba0484b.md
```

**STEP**: 6 — System Requirements and Draft Handling

**DESCRIPTION**: Confirm ABAP server version for transactional apps with draft capabilities. Draft-enabled transactional apps require specific ABAP AS versions.

**LANGUAGE**: TEXT

**CODE**:
```TEXT
System requirements:
- Development of new transactional (draft-enabled) apps requires:
  ABAP Application Server: SAP NetWeaver AS for ABAP 7.51 innovation package SP02 or higher.
- Draft capabilities are NOT available with SAP NetWeaver AS for ABAP 7.50.
- Recommendation: Keep systems up-to-date; use 7.5 SP01 or higher where applicable.
- See Draft Handling documentation: draft-handling-ed9aa41.md
```

**STEP**: 7 — Tutorials and Hands-On Examples

**DESCRIPTION**: Start with the following tutorial collections for OData V4 and Fiori tools examples.

**LANGUAGE**: TEXT

**CODE**:
```TEXT
Tutorials:
- OData V4 Travel example group:
  https://developers.sap.com/group.fiori-tools-odata-v4-travel.html
- OData V4 Incident example group:
  https://developers.sap.com/group.fiori-tools-odata-v4-incident.html
```
--------------------------------

**TITLE**: Progress Indicator Facet — Add a progress indicator to an Object Page header facet

**INTRODUCTION**: This document describes step-by-step code annotations required to render a Progress Indicator in an Object Page header facet for SAP Fiori elements. It contains concrete XML, ABAP CDS, and CAP CDS examples to:
- register a UI.ReferenceFacet in UI.HeaderFacets
- define a UI.DataPoint with Visualization = Progress
- annotate the Value property with unit/currency and footer label
It also lists rendering rules and special-value behavior required by UI runtime.

**TAGS**: fiori-elements-framework, progress-indicator, ui.headerfacets, ui.datapoint, odata-v2, odata-v4, cds, abap, cap

STEP: 1 — Register ReferenceFacet in UI.HeaderFacets (point to a UI.DataPoint)
DESCRIPTION: Add a UI.ReferenceFacet record in UI.HeaderFacets that references a UI.DataPoint qualifier (here "Progress"). Use AnnotationPath to point to the DataPoint. Examples for XML annotation, ABAP CDS, and CAP CDS.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProjectType">
  <Annotation Term="UI.HeaderFacets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <!-- Navigation path to the DataPoint entity and qualifier #Progress -->
        <PropertyValue Property="Target" AnnotationPath="to_ProgressType/@UI.DataPoint#Progress"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view STTA_C_MP_PROJECTTYPE with {
  @UI.Facet: [
    {
      targetQualifier: 'Progress',   // qualifier name of the DataPoint
      targetElement: 'TO_PROGRESSTYPE', // navigation element to the DataPoint entity
      type: #DATAPOINT_REFERENCE,
      purpose: #HEADER
    }
  ]
  test;
}
```

LANGUAGE: CAP CDS
CODE:
```sql
annotate STTA_PROD_MAN.STTA_C_MP_ProjectType @(
  UI.HeaderFacets : [
    {
      $Type   : 'UI.ReferenceFacet',
      Target  : 'to_ProgressType/@UI.DataPoint#Progress'
    }
  ]
);
```

STEP: 2 — Define the UI.DataPoint (qualifier: Progress)
DESCRIPTION: Create a UI.DataPoint annotation on the entity that contains the data for the progress indicator. Include Title (mandatory), Value (mandatory), optional Description (subtitle), TargetValue (required for non-% uom or absent uom), Criticality, and Visualization = Progress. Provide XML, ABAP CDS, and CAP CDS examples.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProgressType">
  <Annotation Term="UI.DataPoint" Qualifier="Progress">
    <Record>
      <PropertyValue Property="Title" String="{@i18n>Title}"/>
      <PropertyValue Property="Description" String="{@i18n>SubTitle}"/>
      <PropertyValue Property="Value" Path="Progress"/>
      <PropertyValue Property="TargetValue" Decimal="150"/>
      <PropertyValue Property="Criticality" Path="Criticality"/>
      <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Progress"/>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view STTA_C_MP_PROGRESSTYPE with {
  @UI.dataPoint: {
    title: '{@i18n>Title}',
    description: '{@i18n>SubTitle}',
    value: Progress,           // property name that supplies the current value
    targetValue: 150,
    criticality: 'Criticality',
    visualization: #PROGRESS
  }
  progress; // the source property of the annotation (the qualifier will be "progress")
}
```

LANGUAGE: CAP CDS
CODE:
```sql
annotate STTA_PROD_MAN.STTA_C_MP_ProgressType @(
  UI.DataPoint#Progress : {
    Title         : '{@i18n>Title}',
    Description   : '{@i18n>SubTitle}',
    Value         : Progress,       // property name that supplies the current value
    TargetValue   : 150,
    Criticality   : Criticality,
    Visualization : #Progress
  }
);
```

STEP: 3 — Annotate Value property for Unit of Measure (UoM) and Footer label
DESCRIPTION: Annotate the entity property that is used as DataPoint.Value (here "Value" / "Progress") with Measures.Unit (or Measures.ISOCurrency) and add Common.Label for footer text. Use the annotation target path <EntityType>/<ValueProperty>. Provide XML, ABAP CDS, and CAP CDS variants for both Unit and ISOCurrency usages.

LANGUAGE: XML (Unit)
CODE:
```xml
<!-- Annotate the Value property to reference a unit-of-measure property UoM and add footer text -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProgressType/Value">
  <Annotation Term="Measures.Unit" Path="UoM"/>
  <Annotation Term="Common.Label" String="{@i18n>Footer}"/>
</Annotations>
```

LANGUAGE: XML (ISOCurrency)
CODE:
```xml
<!-- Annotate the Value property to reference an ISO currency property UoM and add footer text -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProgressType/Value">
  <Annotation Term="Measures.ISOCurrency" Path="UoM"/>
  <Annotation Term="Common.Label" String="{@i18n>Footer}"/>
</Annotations>
```

LANGUAGE: ABAP CDS (Unit)
CODE:
```abap
" Mark UoM property as unit and link value to unit
@Semantics.unitOfMeasure: true
UoM;

@Semantics.quantity.unitOfMeasure: 'UoM'
Value;
" Add label for footer in the annotation file as needed (UI labels or i18n)
```

LANGUAGE: ABAP CDS (ISOCurrency)
CODE:
```abap
@Semantics.currencyCode: true
UoM;

@Semantics.amount.currencyCode: 'UoM'
Value;
```

LANGUAGE: CAP CDS (Unit)
CODE:
```sql
annotate STTA_PROD_MAN.STTA_C_MP_ProgressType with {
  @Measures.Unit : UoM,
  @Common.Label  : '{@i18n>Footer}',
  Value
};
```

LANGUAGE: CAP CDS (ISOCurrency)
CODE:
```sql
annotate STTA_PROD_MAN.STTA_C_MP_ProgressType with {
  @Measures.ISOCurrency : UoM,
  @Common.Label         : '{@i18n>Footer}',
  Value
};
```

STEP: 4 — Rendering rules and runtime behavior (must-read for implementation)
DESCRIPTION: Enforce these rules in metadata / validators and rely on runtime behavior when generating UI:

LANGUAGE: Text
CODE:
```text
- Mandatory fields:
  - DataPoint.Title: required (header facet must have a title).
  - DataPoint.Value: required (progress can't be calculated without a value).
  - DataPoint.TargetValue: required when UoM is not "%" or when no UoM is provided.

- Optional fields:
  - Unit of Measure (Measures.Unit or Measures.ISOCurrency)
  - Description (subtitle)
  - Footer (Common.Label)

- UoM semantics:
  - If UoM value is "%" then DataPoint.Value is treated as direct percentage.
  - If UoM is not "%" or not provided, progress = Value / TargetValue.

- Special values and safety:
  - Division by zero -> progress = 0.
  - progress < 0 -> progress bar shows no color; numeric value still displayed.
  - progress > 100 -> progress bar filled completely; numeric value still displayed.

- Note: "UI" refers to the vocabulary alias for com.sap.vocabularies.UI.v1.
```

STEP: 5 — Additional examples for OData V2 and OData V4 (concise)
DESCRIPTION: Quick-copy examples for ABAP CDS (OData V2) and CAP CDS (OData V4) showing a minimal DataPoint annotation.

LANGUAGE: ABAP CDS (OData V2)
CODE:
```abap
@UI.dataPoint: {
  title: '{@i18n>Title}',
  description: '{@i18n>SubTitle}',
  targetValue: 150,
  criticality: 'Criticality',
  visualization: #PROGRESS
}
ProjectProgress.Progress
```

LANGUAGE: CAP CDS (OData V4)
CODE:
```sql
@UI : {
  DataPoint #Progress : {
    Value         : Progress,
    TargetValue   : 100,
    Title         : 'Progress',
    Visualization : #Progress
  }
}
```
--------------------------------

**TITLE**: Make a Key Field Editable in SAP Fiori Elements (OData V2, Draft Handling)

**INTRODUCTION**: Provide an additional editable field that mirrors an existing key property so users can edit its value in draft applications. Use the additional property in the UI; keep the original key property for navigation and persistence. Map the navigation parameter to the editable field using the com.sap.vocabularies.Common.v1.EditableFieldFor annotation. Applicable only for OData V2 and draft-enabled applications built on existing databases.

**TAGS**: fiori-elements-framework, odata-v2, draft, annotations, EditableFieldFor, CDS, XML, CAP

STEP: 1 — Add an additional editable property to the data model

DESCRIPTION: Add a non-key property that will be editable in the UI (for example SalesOrderForEdit). In active instances, this editable field must always equal the real key property (SalesOrder). In drafts, users edit the editable field only; on activation, copy the editable value into the real key. Example CDS entity snippet showing added fields.

LANGUAGE: CDS

CODE:
```CDS
namespace STTA_SALES_ORDER_WD_20_SRV;

entity C_STTA_SalesOrderItem_WD_20Type {
  key SalesOrder       : String(10);   // existing key (must remain the persisted key)
  SalesOrderForEdit    : String(10);   // new editable field shown in the UI
  key SalesOrderItem   : String(6);    // another key (example)
  SalesOrderItemForEdit: String(6);    // editable mirror for SalesOrderItem
}
```

STEP: 2 — Annotate the editable property for OData V2 (XML annotation)

DESCRIPTION: Use the com.sap.vocabularies.Common.v1.EditableFieldFor annotation in your OData V2 annotation XML so navigation parameters that carry the key value get mapped to the editable field. This instructs Fiori elements to map incoming navigation parameter values to the editable field used in filters and pages.

LANGUAGE: XML

CODE:
```xml
<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrderItem_WD_20Type/SalesOrderForEdit">
    <Annotation Term="com.sap.vocabularies.Common.v1.EditableFieldFor" PropertyPath="SalesOrder"/>
</Annotations>

<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrderItem_WD_20Type/SalesOrderItemForEdit">
    <Annotation Term="com.sap.vocabularies.Common.v1.EditableFieldFor" PropertyPath="SalesOrderItem"/>
</Annotations>
```

STEP: 3 — Annotate the editable property in CAP CDS (alternative to XML annotations)

DESCRIPTION: If you use CAP CDS annotations, add the EditableFieldFor annotation in CDS. This is the CDS-side equivalent that tells the runtime which editable field maps back to the real key for navigation/filter mapping.

LANGUAGE: CDS

CODE:
```CDS
annotate STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrderItem_WD_20Type with {
  @Common.EditableFieldFor : SalesOrder
  SalesOrderForEdit;
};

annotate STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrderItem_WD_20Type with {
  @Common.EditableFieldFor : SalesOrderItem
  SalesOrderItemForEdit;
};
```

STEP: 4 — UI and runtime behavior guidelines (implementation checklist)

DESCRIPTION: Follow these steps to ensure correct UX and backend behavior when using an editable key mirror field:
- Show only the editable mirror fields (SalesOrderForEdit, SalesOrderItemForEdit) in the UI. Hide the real key properties from the UI.
- Use the real key properties (SalesOrder, SalesOrderItem) for navigation parameters and semantic object attribute mapping. The EditableFieldFor annotation ensures incoming navigation parameters map to the editable properties used in filters/pages.
- Ensure that in active instances the editable field equals the key (synchronized). In draft mode, users modify only the editable field.
- On draft activation, copy the editable field values into the actual key fields (backend logic / activation handler). After activation the framework will navigate from the draft instance to the active instance automatically.
- Applicable only for OData V2 and draft-enabled apps built on existing databases; for new models prefer artificial GUID keys and keep semantic fields non-key where possible.

LANGUAGE: text

CODE:
```text
Implementation checklist:
1) Add editable mirror properties to the entity (see step 1).
2) Add EditableFieldFor annotations (XML for OData V2 or CDS for CAP) (see steps 2 & 3).
3) Hide original key properties in the UI; show only the editable mirrors.
4) Implement backend activation logic that copies SalesOrderForEdit -> SalesOrder on draft activation.
5) Verify navigation: incoming navigation parameter mapped to SalesOrderForEdit via EditableFieldFor.
```
--------------------------------

**TITLE**: Quick View Cards — Annotation and manifest configuration for SAP Fiori Elements (OVP)

**INTRODUCTION**: This guide shows exactly how to configure Quick View Cards for Fiori Elements / OVP using OData annotations (HeaderInfo, Facets, FieldGroup, Identification) and how to reference those annotations from manifest.json (annotationPath / identificationAnnotationPath). Includes annotated XML examples and manifest.json snippets for stack/object-stream and table cards, plus rules for footer actions and UI behavior.

**TAGS**: fiori-elements-framework, annotations, manifest.json, com.sap.vocabularies.UI.v1, HeaderInfo, Facets, FieldGroup, Identification, QuickView, OVP, stack-card, objectStream

STEP: 1 — Define HeaderInfo and Facets annotations (XML)

DESCRIPTION: Add com.sap.vocabularies.UI.v1.HeaderInfo to present entity header details (TypeNamePlural, ImageUrl, Title, Description). Define com.sap.vocabularies.UI.v1.Facets with a qualifier and ReferenceFacet entries that reference FieldGroup annotations. Use FieldGroup annotations to hold fields; set IsSummary="true" on FieldGroup(s) you want shown in the quick view card content area.

LANGUAGE: XML

CODE:
```xml
<!-- annotations.xml -->
<Annotations Target="YourServiceNamespace.BusinessPartnerType">

  <!-- HeaderInfo: entity header shown in quick view cards -->
  <Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeNamePlural" String="Business Partners"/>
      <PropertyValue Property="ImageUrl" Path="PhotoUrl"/>
      <PropertyValue Property="Title" Path="FullName"/>
      <PropertyValue Property="Description" Path="Role"/>
    </Record>
  </Annotation>

  <!-- Facets: grouped content for detail area; qualifier used in manifest -->
  <Annotation Term="com.sap.vocabularies.UI.v1.Facets" Qualifier="Qualifier2">
    <Collection>
      <!-- ReferenceFacet pointing to a FieldGroup (see FieldGroup#ContactGroup below) -->
      <Record Type="com.sap.vocabularies.UI.v1.ReferenceFacet">
        <PropertyValue Property="Label" String="Contact Details"/>
        <PropertyValue Property="Target">
          <!-- Reference to a FieldGroup by annotation path -->
          <AnnotationPath>com.sap.vocabularies.UI.v1.FieldGroup#ContactGroup</AnnotationPath>
        </PropertyValue>
      </Record>

      <!-- Additional ReferenceFacet -->
      <Record Type="com.sap.vocabularies.UI.v1.ReferenceFacet">
        <PropertyValue Property="Label" String="Address"/>
        <PropertyValue Property="Target">
          <AnnotationPath>com.sap.vocabularies.UI.v1.FieldGroup#AddressGroup</AnnotationPath>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>

  <!-- FieldGroup definitions referenced by ReferenceFacet above.
       Set IsSummary=true to include these fields in quick view card content. -->
  <Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup" Qualifier="ContactGroup">
    <Record>
      <PropertyValue Property="Label" String="Contact"/>
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Label" String="Email"/>
            <PropertyValue Property="Value" Path="Email"/>
          </Record>
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Label" String="Phone"/>
            <PropertyValue Property="Value" Path="Phone"/>
          </Record>
        </Collection>
      </PropertyValue>
      <!-- Mark as summary so it appears in the quick view card content area -->
      <PropertyValue Property="IsSummary" Bool="true"/>
    </Record>
  </Annotation>

  <Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup" Qualifier="AddressGroup">
    <Record>
      <PropertyValue Property="Label" String="Address"/>
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Label" String="Street"/>
            <PropertyValue Property="Value" Path="Street"/>
          </Record>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="IsSummary" Bool="false"/>
    </Record>
  </Annotation>

</Annotations>
```

STEP: 2 — Configure manifest.json: reference Facets annotation for stack / object stream cards

DESCRIPTION: In manifest.json, point objectStreamCardsSettings.annotationPath (or annotationPath for quick view) to the com.sap.vocabularies.UI.v1.Facets term with the qualifier used in annotations. If annotationPath is omitted, the unqualified com.sap.vocabularies.UI.v1.Facets term is used.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card00": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.stack",
        "settings": {
          "category": "{{card01_category}}",
          "entitySet": "BusinessPartners",
          "objectStreamCardsSettings": {
            "annotationPath": "com.sap.vocabularies.UI.v1.Facets#Qualifier2"
          }
        }
      }
    }
  }
}
```

STEP: 3 — Configure manifest.json: identificationAnnotationPath for actions (table or other cards)

DESCRIPTION: To populate the quick view card footer buttons you must reference an Identification annotation (com.sap.vocabularies.UI.v1.Identification) with a qualifier in manifest.json via identificationAnnotationPath. Example below shows table card using an Identification qualifier.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card01": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.table",
        "settings": {
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#Qualifier1",
          "entitySet": "BusinessPartners"
        }
      }
    }
  }
}
```

STEP: 4 — Define Identification annotation for footer actions (XML)

DESCRIPTION: Use com.sap.vocabularies.UI.v1.Identification (optionally qualified) to specify actions to show in quick view card footers. Supported action types:
- com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation — semantic navigation (intent-based)
- com.sap.vocabularies.UI.v1.DataFieldForAction — OData bound/unbound action

Action rendering rules:
- 0 actions: no footer displayed.
- 1 action: single button aligned to the right.
- 2 actions: two buttons shown in provided order (recommend positive on left, negative on right).
- >2 actions: "Actions" button appears; opens an ActionSheet listing actions in metadata order.
Clicking an action triggers the OData request; complex actions may open a parameter dialog or confirmation.

LANGUAGE: XML

CODE:
```xml
<!-- annotations.xml -->
<Annotations Target="YourServiceNamespace.BusinessPartnerType">

  <Annotation Term="com.sap.vocabularies.UI.v1.Identification" Qualifier="Qualifier1">
    <Collection>
      <!-- Intent-based navigation action -->
      <Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
        <PropertyValue Property="Label" String="Open Details"/>
        <PropertyValue Property="Action" String="SemanticObject-action"/>
      </Record>

      <!-- OData action -->
      <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
        <PropertyValue Property="Label" String="Approve"/>
        <PropertyValue Property="Action" String="YourServiceNamespace.ApproveAction"/>
      </Record>

      <!-- Additional actions will be aggregated into an ActionSheet if >2 -->
      <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
        <PropertyValue Property="Label" String="Reject"/>
        <PropertyValue Property="Action" String="YourServiceNamespace.RejectAction"/>
      </Record>
    </Collection>
  </Annotation>

</Annotations>
```

STEP: 5 — UI behavior, overflow toolbar, and sizing notes

DESCRIPTION: Implementation notes and UI details to consider when generating cards:
- Footer action buttons are placed inside sap.m.OverflowToolbar. If buttons don’t fit, remaining actions move into overflow (or become the Actions button).
- If more than two actions exist, an Actions button opens an ActionSheet listing actions in metadata order.
- Card heights align to content; header and footer are fixed. If content overflows, the content area gets a vertical scrollbar (header/footer remain visible).
- If no identificationAnnotationPath is provided or no actions defined, footer is not shown.

LANGUAGE: JSON

CODE:
```json
{
  "_notes": {
    "overflowToolbar": "Footer actions are rendered inside sap.m.OverflowToolbar to adapt to available width",
    "scrolling": "Card content scrolls vertically if content height exceeds card; header/footer remain fixed",
    "noActions": "If Identification annotation is missing or empty, footer area is not displayed"
  }
}
```
--------------------------------

**TITLE**: Quick Views: Configuration Examples for Currency, Supplier, and SoldTo Entities

**INTRODUCTION**: Action-focused examples showing how to configure Quick View facets for Fiori Elements. Includes EDMX association (referential constraint) and annotations in XML (OData), ABAP CDS, and CAP CDS for OData V2 and V4 scenarios. Use these snippets to add Quick View facets to your service metadata and CDS/annotation files.

**TAGS**: fiori-elements-framework, quick-view, annotations, ODataV2, ODataV4, EDMX, ABAP-CDS, CAP-CDS, XML, UI.QuickViewFacets

STEP: 1 — Add referential constraint association for Currency (EDMX)
DESCRIPTION: If the service does not expose a referential constraint between your entity and the currency type, add an Association with a ReferentialConstraint to the service EDMX/metadata file so Quick View navigation can resolve the related entity.
LANGUAGE: XML
CODE:
```xml
<Association Name="assoc_6D52161C1362D99A31996E5BB23202E8" sap:content-version="1">
    <End Type="STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType" Multiplicity="1" Role="FromRole_assoc_6D52161C1362D99A31996E5BB23202E8"/>
    <End Type="STTA_PROD_MAN.I_CurrencyType" Multiplicity="0..1" Role="ToRole_assoc_6D52161C1362D99A31996E5BB23202E8"/>
    <ReferentialConstraint>
        <Principal Role="FromRole_assoc_6D52161C1362D99A31996E5BB23202E8">
            <PropertyRef Name="Currency"/>
        </Principal>
        <Dependent Role="ToRole_assoc_6D52161C1362D99A31996E5BB23202E8">
            <PropertyRef Name="Currency"/>
        </Dependent>
    </ReferentialConstraint>
</Association>
```

STEP: 2 — Quick View Facets for Currency (OData XML Annotation)
DESCRIPTION: Add UI.QuickViewFacets and UI.FieldGroup annotations to the Currency type in your annotation XML file so the Currency quick view displays Decimals, CurrencyISOCode, and AlternativeCurrencyKey. Also add a semantic object on the source property to enable navigation.
LANGUAGE: XML
CODE:
```xml
<!-- QuickViewFacets annotation for Currency-->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType/Currency">
    <Annotation Term="Common.SemanticObject" String="EPMProduct"/>
</Annotations>           
<Annotations Target="STTA_PROD_MAN.I_CurrencyType">           
    <Annotation Term="UI.QuickViewFacets">
        <Collection>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#CurrencyQuickViewPOC_FieldGroup_1" />
            </Record>           
        </Collection>
    </Annotation>
    <Annotation Term="UI.FieldGroup" Qualifier="CurrencyQuickViewPOC_FieldGroup_1">
        <Record>
            <PropertyValue Property="Data">
                <Collection>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Decimals" />
                        <PropertyValue Property="Value" Path="Decimals"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="CurrencyISOCode" />
                        <PropertyValue Property="Value" Path="CurrencyISOCode"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="AlternativeCurrencyKey" />
                        <PropertyValue Property="Value" Path="AlternativeCurrencyKey"/>
                    </Record>                            
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>   
</Annotations>
```

STEP: 3 — Quick View Facets for Currency (ABAP CDS)
DESCRIPTION: Use ABAP CDS annotate view blocks to add a semantic object to the currency property and define a field group qualifier used for quick view facets. Place this in the related ABAP CDS view annotations.
LANGUAGE: ABAP CDS
CODE:
```abap
annotate view STTA_C_MP_PRODUCTSALESDATA with {
  @Consumption.semanticObject: 'EPMProduct'
  currency;
}

annotate view I_CURRENCYTYPE with {
@UI.Facet: [
  {
    targetQualifier: 'CurrencyQuickViewPOC_FieldGroup_1',
    type: #FIELDGROUP_REFERENCE,
    purpose: #QUICK_VIEW
  }
]
@UI.fieldGroup: [
  {
    label: 'Decimals',
    value: 'DECIMALS',
    type: #STANDARD,
    position: 1 ,
    qualifier: 'CurrencyQuickViewPOC_FieldGroup_1'
  }
]
decimals;
@UI.fieldGroup: [
  {
    label: 'CurrencyISOCode',
    value: 'CURRENCYISOCODE',
    type: #STANDARD,
    position: 2 ,
    qualifier: 'CurrencyQuickViewPOC_FieldGroup_1'
  }
]
currencyisocode;
@UI.fieldGroup: [
  {
    label: 'AlternativeCurrencyKey',
    value: 'ALTERNATIVECURRENCYKEY',
    type: #STANDARD,
    position: 3 ,
    qualifier: 'CurrencyQuickViewPOC_FieldGroup_1'
  }
]
alternativecurrencykey;
}
```

STEP: 4 — Quick View Facets for Currency (CAP CDS)
DESCRIPTION: In CAP model or annotation file, annotate the ProductSalesData type with a Common.SemanticObject and annotate the I_CurrencyType with UI.QuickViewFacets and a UI.FieldGroup qualifier. Use these annotations in your .cds or service.cds annotation block.
LANGUAGE: CAP CDS
CODE:
```cap
annotate STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType with {
    @Common.SemanticObject : 'EPMProduct'
    Currency
};
annotate STTA_PROD_MAN.I_CurrencyType with @(
    UI.QuickViewFacets : [
        {
            $Type : 'UI.ReferenceFacet',
            Target : '@UI.FieldGroup#CurrencyQuickViewPOC_FieldGroup_1'
        }
    ],
    UI.FieldGroup #CurrencyQuickViewPOC_FieldGroup_1 : {
        Data : [
            {
                $Type : 'UI.DataField',
                Label : 'Decimals',
                Value : Decimals
            },
            {
                $Type : 'UI.DataField',
                Label : 'CurrencyISOCode',
                Value : CurrencyISOCode
            },
            {
                $Type : 'UI.DataField',
                Label : 'AlternativeCurrencyKey',
                Value : AlternativeCurrencyKey
            }
        ]
    }
);
```

STEP: 5 — Quick View Facets for Supplier (OData V2 XML Annotation)
DESCRIPTION: Configure Quick View facets for SupplierType including semantic attributes for Email, URL, and PhoneNumber. Add multiple ReferenceFacet entries and two field group qualifiers to show grouped fields in the quick view.
LANGUAGE: XML
CODE:
```xml
<!-- QuickViewFacets annotation for Supplier-->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType/EmailAddress" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <Annotation Term="com.sap.vocabularies.Communication.v1.IsEmailAddress" Bool="true"/>
</Annotations>      

<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType/URL" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <Annotation Term="Org.OData.Core.V1.IsUrl" Bool="true"/>
</Annotations>
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType/PhoneNumber" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <Annotation Term="com.sap.vocabularies.Communication.v1.IsPhoneNumber" Bool="true"/>
</Annotations>
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType">                
    <Annotation Term="UI.QuickViewFacets">
        <Collection>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SupplierQuickViewPOC_FieldGroup_1" />
            </Record>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SupplierQuickViewPOC_FieldGroup_2" />
            </Record>        
        </Collection>
    </Annotation>
    <Annotation Term="UI.FieldGroup" Qualifier="SupplierQuickViewPOC_FieldGroup_1">
        <Record>
            <PropertyValue Property="Label" String="The first field group label" />
            <PropertyValue Property="Data">
                <Collection>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Supplier" />
                        <PropertyValue Property="Value" Path="Supplier"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Company Name" />
                        <PropertyValue Property="Value" Path="CompanyName"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Email Address" />
                        <PropertyValue Property="Value" Path="EmailAddress"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="to_Address / FormattedAddress" />
                        <PropertyValue Property="Value" Path="to_Address/FormattedAddress"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
    <Annotation Term="UI.FieldGroup" Qualifier="SupplierQuickViewPOC_FieldGroup_2">
        <Record>
            <PropertyValue Property="Label" String="The second field group label" />
            <PropertyValue Property="Data">
                <Collection>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Phone Number" />
                        <PropertyValue Property="Value" Path="PhoneNumber"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="URL" />
                        <PropertyValue Property="Value" Path="URL"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="to_Address / AddressValidityStartDate" />
                        <PropertyValue Property="Value" Path="to_Address/AddressValidityStartDate"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: 6 — Quick View Facets for Supplier (ABAP CDS)
DESCRIPTION: Annotate the Supplier view in ABAP CDS: add UI.Facet entries of type FIELDGROUP_REFERENCE for quick view purpose and define UI.fieldGroup qualifiers for each field included in the quick view groups. Include semantic annotations for email and telephone where applicable.
LANGUAGE: ABAP CDS
CODE:
```abap
annotate view STTA_C_MP_SUPPLIER with {
@UI.Facet: [
  {
    targetQualifier: 'SupplierQuickViewPOC_FieldGroup_1',
    type: #FIELDGROUP_REFERENCE,
    purpose: #QUICK_VIEW
  },
  {
    targetQualifier: 'SupplierQuickViewPOC_FieldGroup_2',
    type: #FIELDGROUP_REFERENCE,
    purpose: #QUICK_VIEW
  }
]
@UI.fieldGroup: [
  {
    label: 'Supplier',
    value: 'SUPPLIER',
    type: #STANDARD,
    position: 1 ,
    qualifier: 'SupplierQuickViewPOC_FieldGroup_1',
    groupLabel: 'The first field group label'
  }
]
supplier;
@UI.fieldGroup: [
  {
    label: 'Company Name',
    value: 'COMPANYNAME',
    type: #STANDARD,
    position: 2 ,
    qualifier: 'SupplierQuickViewPOC_FieldGroup_1'
  }
]
companyname;
@UI.fieldGroup: [
  {
    label: 'Email Address',
    value: 'EMAILADDRESS',
    type: #STANDARD,
    position: 3 ,
    qualifier: 'SupplierQuickViewPOC_FieldGroup_1'
  }
]
@Semantics:   { eMail: { address: true, type:  [ #PREF, #WORK ] } }
emailaddress;
@UI.fieldGroup: [
  {
    label: 'to_Address / FormattedAddress',
    value: 'TO_ADDRESS/FORMATTEDADDRESS',
    type: #STANDARD,
    position: 4 ,
    qualifier: 'SupplierQuickViewPOC_FieldGroup_1'
  }
]
to_address/formattedaddress;
@UI.fieldGroup: [
  {
    label: 'Phone Number',
    value: 'PHONENUMBER',
    type: #STANDARD,
    position: 5 ,
    qualifier: 'SupplierQuickViewPOC_FieldGroup_2'
  }
]
@Semantics.telephone.type: #WORK
phonenumber;
@UI.fieldGroup: [
  {
    label: 'URL',
    value: 'URL',
    type: #STANDARD,
    position: 6 ,
    qualifier: 'SupplierQuickViewPOC_FieldGroup_2'
  }
]
url;
@UI.fieldGroup: [
  {
    label: 'to_Address / AddressValidityStartDate',
    value: 'TO_ADDRESS/ADDRESSVALIDITYSTARTDATE',
    type: #STANDARD,
    position: 7 ,
    qualifier: 'SupplierQuickViewPOC_FieldGroup_2'
  }
]
to_address/addressvaliditystartdate;
}
```

STEP: 7 — Quick View Facets for SoldTo / Generic Quick View (OData V4 XML)
DESCRIPTION: For OData V4 services, add UI.QuickViewFacets and UI.FieldGroup annotations to the entity or property to define quick view reference facets and field groups (example uses SoldToQuickView and QVFacet qualifiers). Use these in the entity annotation section of your .xml annotation file.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.QuickViewFacets">
   <Collection>
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="Label FieldGroup 1"/>
      <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SoldToQuickView"/>
    </Record>
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="Label FieldGroup 2"/>
      <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#QVFacet"/>
    </Record>
   </Collection>
</Annotation>
<Annotation Term="UI.FieldGroup" Qualifier="SoldToQuickView">
   <Record Type="UI.FieldGroupType">
     <PropertyValue Property="Data">
      <Collection>
       <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="PostalCode"/>
       </Record>
       <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="CityName"/>
       </Record>
      </Collection>
     </PropertyValue>
   </Record>
</Annotation>
<Annotation Term="UI.FieldGroup" Qualifier="QVFacet">
   <Record Type="UI.FieldGroupType">
     <PropertyValue Property="Data">
      <Collection>
       <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Country"/>
       </Record>
      </Collection>
     </PropertyValue>
   </Record>
</Annotation>
```

STEP: 8 — Quick View Facets for SoldTo / Generic Quick View (ABAP CDS)
DESCRIPTION: ABAP CDS equivalent: add @UI.Facet entries for two fieldgroup references and define the UI.fieldGroup qualifiers with the fields PostalCode, CityName, and Country. Place these annotations in the CDS view for the related entity.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Facet: [
  {
    label: 'Label FieldGroup 1',
    targetQualifier: 'SoldToQuickView',
    type: #FIELDGROUP_REFERENCE,
    purpose: #QUICK_VIEW
  },
  {
    label: 'Label FieldGroup 2',
    targetQualifier: 'QVFacet',
    type: #FIELDGROUP_REFERENCE,
    purpose: #QUICK_VIEW
  }
]
@UI.fieldGroup: [
  {
    value: 'POSTALCODE',
    type: #STANDARD,
    position: 1 ,
    qualifier: 'SoldToQuickView'
  }
]
POSTALCODE;

@UI.fieldGroup: [
  {
    value: 'CITYNAME',
    type: #STANDARD,
    position: 2 ,
    qualifier: 'SoldToQuickView'
  }
]
CITYNAME;

@UI.fieldGroup: [
  {
    value: 'COUNTRY',
    type: #STANDARD,
    position: 1 ,
    qualifier: 'QVFacet'
  }
]
COUNTRY;
```

STEP: 9 — Quick View Facets for SoldTo / Generic Quick View (CAP CDS)
DESCRIPTION: CAP annotation syntax for UI.QuickViewFacets and UI.FieldGroup qualifiers. Include this block in your .cds annotation section or a service-level annotation file to expose the quick view facets for OData V4 scenarios.
LANGUAGE: CAP CDS
CODE:
```cap
UI.QuickViewFacets : [
    {
        $Type : 'UI.ReferenceFacet',
        Label : 'Label FieldGroup 1',
        Target : '@UI.FieldGroup#SoldToQuickView'
    },
    {
        $Type : 'UI.ReferenceFacet',
        Label : 'Label FieldGroup 2',
        Target : '@UI.FieldGroup#QVFacet'
    },
],
UI.FieldGroup #SoldToQuickView : {
    $Type : 'UI.FieldGroupType',
    Data : [
        {
            $Type : 'UI.DataField',
            Value : PostalCode
        },
        {
            $Type : 'UI.DataField',
            Value : CityName
        }
    ]
},
UI.FieldGroup #QVFacet : {
    $Type : 'UI.FieldGroupType',
    Data : [
        {
            $Type : 'UI.DataField',
            Value : Country
        }
    ]
},
```
--------------------------------

**TITLE**: Radial Micro Chart — UI.Chart and UI.DataPoint Annotations (XML / ABAP CDS / CAP CDS)

**INTRODUCTION**: This document shows the exact annotations required to render a Radial Micro Chart (percentage donut) in Fiori Elements. It contains actionable, copy-paste annotation examples (XML, ABAP CDS, CAP CDS), explains mandatory fields, and covers semantic coloring rules and restrictions (unit label not shown).

**TAGS**: fiori-elements-framework, radial-micro-chart, UI.Chart, UI.DataPoint, annotations, OData, ABAP, CDS, CAP, XML

**STEP**: 1 — Define UI.Chart (Radial/Donut) with MeasureAttributes pointing to a DataPoint

**DESCRIPTION**: Create a UI.Chart annotation with ChartType = Donut (radial micro chart). Provide Measures and MeasureAttributes. In MeasureAttributes, reference the UI.DataPoint via AnnotationPath (XML) or DataPoint/asDataPoint (CDS) so the chart uses the DataPoint value and criticality for coloring. Title and Description map to the chart title and subtitle.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- UI.Chart annotation (XML) -->
<Annotation Term="UI.Chart" Qualifier="SpecificationWidthRadialChart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Product Width Specification"/>
        <PropertyValue Property="Description" String="No navigation with qualifier"/>
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Donut"/>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>Width</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="Width"/>
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                    <!-- Link to UI.DataPoint qualifier 'Width' -->
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Width"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Chart: [
  {
    title: 'Product Width Specification',
    description: 'No navigation with qualifier',
    chartType: #DONUT,
    measures: [
      'WIDTH'
    ],
    measureAttributes: [
      {
        measure: 'Width',
        role: #AXIS_1,
        asDataPoint: true
      }
    ],
    qualifier: 'SpecificationWidthRadialChart'
  }
]
annotate view STTA_C_MP_PRODUCT with { }
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.Chart #SpecificationWidthRadialChart : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Product Width Specification',
    Description : 'No navigation with qualifier',
    ChartType : #Donut,
    Measures : [
        Width
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Width,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#Width'
        }
    ]
}
```

**STEP**: 2 — Define UI.DataPoint for the measure used by the chart

**DESCRIPTION**: Define the UI.DataPoint qualifier referenced by the chart (example qualifier: Width). Include Value (required), optional TargetValue, and either Criticality or CriticalityCalculation (see rules). The DataPoint qualifier must match the DataPoint reference used in MeasureAttributes.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- UI.DataPoint annotation (XML) -->
<Annotation Term="UI.DataPoint" Qualifier="Width">
    <Record>
        <PropertyValue Property="Value" Path="Width"/>
        <PropertyValue Property="TargetValue" Path="Weight"/>
        <PropertyValue Property="Criticality" Path="criticalityValue"/>
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.dataPoint: {
  criticality: 'criticalityValue'
}
Width;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.DataPoint #Width : {
    Value : Width,
    TargetValue : Weight,
    Criticality : criticalityValue
}
```

**STEP**: 3 — Combined example (XML) — chart annotation + data point in one file

**DESCRIPTION**: Use this combined XML when adding both annotations to the same annotation file. Ensures Chart -> MeasureAttributes -> DataPoint link is present and uses the qualifier "Width".

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Combined annotations: UI.Chart (Donut) with UI.DataPoint #Width -->
<Annotations Target="YourService.YourEntityType">
    <Annotation Term="UI.Chart" Qualifier="SpecificationWidthRadialChart">
        <Record Type="UI.ChartDefinitionType">
            <PropertyValue Property="Title" String="Product Width Specification"/>
            <PropertyValue Property="Description" String="No navigation with qualifier"/>
            <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Donut"/>
            <PropertyValue Property="Measures">
                <Collection>
                    <PropertyPath>Width</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="MeasureAttributes">
                <Collection>
                    <Record Type="UI.ChartMeasureAttributeType">
                        <PropertyValue Property="Measure" PropertyPath="Width"/>
                        <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                        <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Width"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>

    <Annotation Term="UI.DataPoint" Qualifier="Width">
        <Record>
            <PropertyValue Property="Value" Path="Width"/>
            <PropertyValue Property="TargetValue" Path="Weight"/>
            <PropertyValue Property="Criticality" Path="criticalityValue"/>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 4 — Mandatory fields, semantic coloring rules, and rendering notes

**DESCRIPTION**: Checklist and rules to validate the radial micro chart implementation.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "MandatoryAnnotations": [
    "UI.Chart -> ChartType must be 'Donut'",
    "UI.Chart -> Measures (e.g. 'Width')",
    "UI.Chart -> MeasureAttributes -> DataPoint (must reference UI.DataPoint qualifier)",
    "UI.DataPoint -> Value (required)"
  ],
  "SemanticColoring": {
    "SupportedAnnotations": [
      "UI.DataPoint -> Criticality",
      "UI.DataPoint -> CriticalityCalculation"
    ],
    "OverrideRule": "UI.DataPoint.Criticality overrides UI.DataPoint.CriticalityCalculation",
    "IfUsingCriticalityCalculation": [
      "UI.DataPoint -> CriticalityCalculation",
      "UI.DataPoint -> CriticalityCalculation/ImprovementDirection (required)"
    ]
  },
  "RenderingNotes": [
    "Radial micro chart displays percentage values. Unit of measure label is not rendered.",
    "Chart uses DataPoint for semantic coloring and target comparison."
  ]
}
```

**STEP**: 5 — References and image asset

**DESCRIPTION**: Use the official UI5 sample and include image asset path for documentation.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "UI5Sample": "https://ui5.sap.com/1.82.5/#/entity/sap.suite.ui.microchart.RadialMicroChart",
  "Image": "images/Radial_Micro_Chart_551f7f3.png"
}
```
--------------------------------

**TITLE**: Rating Indicator Facet — Add read-only rating (stars) to Object Page header

**INTRODUCTION**: This reference shows how to add a read-only Rating Indicator facet to an Object Page header in SAP Fiori Elements. It includes XML local annotations, CAP CDS, and ABAP CDS examples for aggregated and non-aggregated ratings, how to set the maximum number of stars (TargetValue), and how to control the subtitle (SampleSize or Description).

**TAGS**: fiori-elements-framework, rating, UI.DataPoint, UI.ReferenceFacet, annotations, CDS, CAP, XML

STEP: Add a Rating Indicator Facet (general)
DESCRIPTION: Create a UI.ReferenceFacet that points to a UI.DataPoint which uses UI.VisualizationType/Rating. The DataPoint Value is the path to the backend field that provides the rating value.
LANGUAGE: XML
CODE:
```xml
<!-- Reference facet pointing to a DataPoint with VisualizationType Rating -->
<Annotation Term="UI.Facets">
    <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Target" AnnotationPath="to_ProductRating/@UI.DataPoint#RatingDP" />
    </Record>
</Annotation>

<!-- DataPoint definition -->
<Annotation Term="UI.DataPoint" Qualifier="RatingDP">
    <Record>
        <PropertyValue Property="Title" String="{@i18n>@ProductRatingTitle}" />
        <PropertyValue Property="Value" Path="Rating" />
        <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Rating" />
        <!-- Optional: TargetValue or SampleSize/Description as shown in the specific examples -->
    </Record>
</Annotation>
```

STEP: Aggregated Rating — local annotations only
DESCRIPTION: Use an aggregated rating to show average rating + sample count. Aggregated ratings must use local (XML) annotations. Set SampleSize (path) for subtitle count; set TargetValue in the annotation to define the maximum number of stars.
LANGUAGE: XML
CODE:
```xml
<!-- Add a ReferenceFacet that points to an Aggregated DataPoint (local annotation required) -->
<Annotation Term="UI.Facets">
    <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Target" AnnotationPath="to_ProductRating/@UI.DataPoint#Aggregated" />
    </Record>
</Annotation>

<!-- Aggregated DataPoint -->
<Annotation Term="UI.DataPoint" Qualifier="Aggregated">
    <Record>
        <PropertyValue Property="Title" String="{@i18n>@ProductAverageRating}" />
        <PropertyValue Property="Value" Path="AverageRating" />
        <!-- Set the maximum number of stars explicitly -->
        <PropertyValue Property="TargetValue" Int="5" />
        <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Rating" />
        <!-- Subtitle count: path to total number of ratings -->
        <PropertyValue Property="SampleSize" Path="ReviewCount" />
    </Record>
</Annotation>
```

STEP: Aggregated Rating — CAP CDS example
DESCRIPTION: CAP CDS equivalent of the Aggregated DataPoint (qualifier Aggregated). Use SampleSize for subtitle and TargetValue for max stars.
LANGUAGE: CAP CDS
CODE:
```cds
UI.Facets : {
    $Type : 'UI.ReferenceFacet',
    Target : 'to_ProductRating/@UI.DataPoint#Aggregated'
},

UI.DataPoint #Aggregated : {
    Title : '{@i18n>@ProductAverageRating}',
    Value : AverageRating,
    TargetValue : 5,
    Visualization : #Rating,
    SampleSize : ReviewCount
}
```

STEP: Aggregated Rating — ABAP CDS (sample)
DESCRIPTION: Example placeholder showing where an aggregated DataPoint annotation would be applied in ABAP CDS. (Use local XML annotations for aggregated in Fiori Elements; ABAP example is illustrative.)
LANGUAGE: CDS
CODE:
```abap
@UI.headerInfo: {
  typeName: 'Product',
  typeNamePlural: 'Products',
  title: {
    value: 'ProductID',
    type: #STANDARD
  }
}
annotate view STTA_C_MP_PRODUCT with {
    // Additional annotations here. For aggregated rating prefer local XML DataPoint as shown above.
}
```

STEP: Non-Aggregated Rating — behavior and subtitle
DESCRIPTION: Non-aggregated rating shows a single rating (e.g., user's rating). Subtitle is rendered by DataPoint Description. TargetValue can be a path to a backend field (MaxRating) or a literal. Non-aggregated ratings may use local or CDS annotations.
LANGUAGE: XML
CODE:
```xml
<!-- Reference facet pointing to a NonAggregated DataPoint -->
<Record Type="UI.ReferenceFacet">
    <PropertyValue Property="Target" AnnotationPath="to_ProductRating/@UI.DataPoint#NonAggregated"/>
</Record>

<!-- Non-aggregated DataPoint -->
<Annotation Term="UI.DataPoint" Qualifier="NonAggregated">
   <Record>
      <PropertyValue Property="Title" String="{@i18n>@ProductUserRating}"/>
      <!-- Subtitle text: set Description to display descriptive subtitle -->
      <PropertyValue Property="Description" String="{@i18n>@MyRating}"/>
      <PropertyValue Property="Value" Path="Rating"/>
      <!-- TargetValue can be a path to the backend MaxRating field -->
      <PropertyValue Property="TargetValue" Path="MaxRating"/>
      <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Rating"/>
   </Record>
</Annotation>
```

STEP: Non-Aggregated Rating — CAP CDS example
DESCRIPTION: CAP CDS DataPoint for a non-aggregated rating where Description is used for subtitle and TargetValue references MaxRating.
LANGUAGE: CAP CDS
CODE:
```cds
UI.Facets : {
    $Type : 'UI.ReferenceFacet',
    Target : 'to_ProductRating/@UI.DataPoint#NonAggregated'
},

UI.DataPoint #NonAggregated : {
    Title : '{@i18n>@ProductUserRating}',
    Description : '{@i18n>@MyRating}',
    Value : Rating,
    TargetValue : MaxRating,
    Visualization : #Rating
}
```

STEP: Non-Aggregated Rating — ABAP CDS example
DESCRIPTION: ABAP CDS sample showing facet and data point annotations for a non-aggregated rating. The Description field renders the subtitle.
LANGUAGE: CDS
CODE:
```abap
@UI.facet: [
 {
  id:            'rating',
  type:          #DATAPOINT_REFERENCE,
  targetElement: '_ProductRating',
  targetQualifier: 'NonAggregated'
 }
]
product;

@UI.dataPoint: {
  title: '{@i18n>@ProductUserRating}',
  description: '{@i18n>@MyRating}',
  targetValueElement: 'MaxRating',
  visualization: #RATING
}
Rating;
```

STEP: Set Maximum Number of Stars (TargetValue)
DESCRIPTION: Two approaches to set TargetValue (maximum stars):
- Literal in annotation (aggregated example uses TargetValue Int or CAP CDS TargetValue).
- Path to a backend field (e.g., TargetValue Path="MaxRating" or CAP CDS TargetValue : MaxRating).
LANGUAGE: XML
CODE:
```xml
<!-- Literal TargetValue (max 5 stars) -->
<PropertyValue Property="TargetValue" Int="5" />

<!-- TargetValue from backend field -->
<PropertyValue Property="TargetValue" Path="MaxRating" />
```

STEP: Subtitle control (SampleSize vs Description)
DESCRIPTION: For aggregated ratings use SampleSize (path) to display count in subtitle; annotate SampleSize with Common.Label if you want custom text concatenated with the count. For non-aggregated ratings set Description on the DataPoint to render subtitle text.
LANGUAGE: XML
CODE:
```xml
<!-- Aggregated: SampleSize drives subtitle count -->
<PropertyValue Property="SampleSize" Path="ReviewCount" />
<!-- Optionally add a label to SampleSize in terms of Common.Label (local annotation) -->

<!-- Non-aggregated: Description drives subtitle -->
<PropertyValue Property="Description" String="{@i18n>@MyRating}" />
```

STEP: Edit Mode behavior (UI notes)
DESCRIPTION: In Edit mode the rating indicator moves into the header facet and shows only the title. For aggregated rating the number of ratings is shown in parentheses after the stars. Note: rating indicator remains read-only in edit mode. (No code change required; behavior provided by Fiori Elements.)

STEP: Additional Features — OData V4 / CDS DataPoint snippet
DESCRIPTION: Example CDS DataPoint annotation style for OData V4 that defines a rating DataPoint with a fixed TargetValue.
LANGUAGE: CDS
CODE:
```cds
@UI: DataPoint #Rating : {
    Value         : Rating,
    TargetValue   : 5.0,
    Title         : 'Rating',
    Visualization : #Rating
}
```
--------------------------------

**TITLE**: Read Before Extending a Generated SAP Fiori Elements App (Guidelines + Code Examples)

**INTRODUCTION**: Concise, developer-focused rules and ready-to-use code patterns for building extensions for SAP Fiori elements generated apps. Covers cautions, allowed APIs, model access patterns, registering application models, and recommended usage for OData function imports (use extensionAPI). Use these snippets inside view/controller extension files only.

**TAGS**: fiori-elements, sapui5, extensionAPI, models, odata, view-extension, best-practices

**STEP**: 1 — Core caution and integration rule

**DESCRIPTION**: Summary of the core rule: use extensionAPI only for interactions with framework-provided controls and services; extension code becomes the app's responsibility. Link to official extensionAPI documentation.

**LANGUAGE**: Text

**CODE**:
```text
Caution:
- Use app extensions only when manifest settings, annotations or standard configuration cannot achieve the requirement.
- For any interaction with SAP Fiori elements provided behavior or controls, use only the official extensionAPI.
- Do NOT access/manipulate internal controls, internal models, or other template internals created by SAP Fiori elements.
References:
- Using the extensionAPI: using-the-extensionapi-bd2994b.md
- View extension reference: ../08_Extending_SAPUI5_Applications/view-extension-403c050.md
```

**STEP**: 2 — Using the standard SAPUI5 API inside an extension

**DESCRIPTION**: Use standard SAPUI5 API only on UI elements you defined inside your view/controller extension. Access your extension-created controls by their IDs. Do not access UI elements that are not defined within your extension.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example inside a controller extension (controller .js)
onInit: function () {
  // Access the default view and elements that you created in this extension only:
  const oMyButton = this.byId("myExtensionButton"); // ID belongs to your extension view
  if (oMyButton) {
    oMyButton.setVisible(false); // allowed for elements you created
  }

  // BAD: Do NOT access controls that belong to the template or other extensions:
  // const oTemplateControl = sap.ui.getCore().byId("__templateControlId"); // avoid
}
```

**STEP**: 3 — Accessing models: allowed models and forbidden access

**DESCRIPTION**: Which models you can read/write and how. Default OData model is available but changing it can cause side effects. The named "ui" model is readable only; it is forbidden to change its properties. The SAP Fiori Elements private model must not be accessed. You can attach your own application JSON model but prefer a namespaced model name and attach it to elements local to your extension or to the whole view only if necessary.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Get the default (OData) model specified in manifest.json
const oDefaultModel = this.getView().getModel(); // use with care (read/bind)

// Get the named UI model (read-only)
const oUiModel = this.getView().getModel("ui");
const bEnabled = oUiModel && oUiModel.getProperty("/enabled"); // read allowed

// Forbidden: DO NOT change UI model properties
// oUiModel.setProperty("/enabled", false); // DO NOT DO THIS

// Forbidden: DO NOT access SAP Fiori Elements private models
// const oPrivateModel = this.getView().getModel("_sap_fe"); // DO NOT DO THIS

// Register your own JSON model scoped to this extension (preferred)
const oMyJson = new sap.ui.model.json.JSONModel({ flag: true });
this.getView().setModel(oMyJson, "com.mycompany.myExtensionModel"); // namespaced
// Use com.mycompany.myExtensionModel for data-binding in your extension-only controls
```

**STEP**: 4 — Attaching a model to a specific control (recommended containment pattern)

**DESCRIPTION**: Attach application-specific models to controls that you create inside your extension to avoid interfering with the template or other app code.

**LANGUAGE**: XML + JavaScript

**CODE**:
```xml
<!-- Example fragment (myExtension.fragment.xml) -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
  <Button id="myExtensionButton" text="Do Something" />
</core:FragmentDefinition>
```

```javascript
// In the extension controller after fragment is placed/created
const oLocalModel = new sap.ui.model.json.JSONModel({ localData: 123 });
this.byId("myExtensionButton").setModel(oLocalModel, "myExtensionModel");
// Bindings on controls you created can reference "myExtensionModel>..."
```

**STEP**: 5 — Calling OData function imports: use extensionAPI.invokeActions (OData V2 recommendation)

**DESCRIPTION**: Do not call function imports directly on the template-managed OData model. For function imports or system logic related to template components, always use the extensionAPI (extension API guarantees compatibility and supported behavior). If you interact only with controls generated inside your extension, using standard APIs is fine.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Recommended: use extensionAPI to invoke function imports / actions
// NOTE: The concrete signature can depend on Fiori elements version/extensionAPI implementation.
// This is a pattern/example showing intent — consult your version's extensionAPI docs.

const aActions = [
  {
    name: "MyFunctionImport",           // function import or action name exposed by backend/template
    // binding or context: provide the correct binding context if action is bound
    binding: this.getView().getBindingContext(), 
    urlParameters: { Param1: "value" }  // optional params
  }
];

this.extensionAPI.invokeActions(aActions)
  .then(function (aResults) {
    // handle results
  })
  .catch(function (oError) {
    // handle error
  });

// If your scenario only manipulates controls defined in your extension, you can
// also use the standard OData model callFunction/callAction patterns on a model
// you own. Prefer extensionAPI for template-integrated actions.
```

**STEP**: 6 — Forbidden namespaces and services

**DESCRIPTION**: Do not use internal template namespaces or services that are intended only for freestyle or internal template implementation. Using them may cause side effects or break compatibility.

**LANGUAGE**: Text

**CODE**:
```text
Do NOT use:
- sap.ui.generic.app (services intended for freestyle SAPUI5 apps or internal use)
- sap.fe.navigation (not for extension usage inside Fiori elements)
- sap.ui.generic.template (internal template services) 

If you need functionality provided by the template, call it via the official extensionAPI only.
```

**STEP**: 7 — UI model properties summary (V2 and V4)

**DESCRIPTION**: Quick reference of UI model properties you can read (but must not modify) for V2 and V4 templates.

**LANGUAGE**: JSON

**CODE**:
```json
// SAP Fiori Elements OData V2 UI model (read-only)
{
  "ui": {
    "enabled": true,    // whether interactive UI elements should be enabled
    "editable": false,  // whether input-like controls should be editable
    "createMode": false // whether UI displays an entity being created (no active version)
  }
}

// SAP Fiori Elements OData V4 UI model (read-only)
{
  "ui": {
    "editMode": "Display" // "Editable" or "Display"
  }
}
```

**STEP**: 8 — ManagedObject note when attaching models

**DESCRIPTION**: You are allowed to access models you attached to a ManagedObject yourself. If you attach a model at runtime to an object you created, it is fine to access/change it. Avoid changing models attached by the template.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Allowed: you attach a model to an object and then use it
const oModelLocal = new sap.ui.model.json.JSONModel({ counter: 0 });
const oMyControl = this.byId("myExtensionControl"); // control you created
oMyControl.setModel(oModelLocal, "localModel");

// Later you can change it safely because you attached it
oMyControl.getModel("localModel").setProperty("/counter", 1);

// DO NOT change models you didn't attach (template private models or "ui" model)
```
--------------------------------

**TITLE**: Rebinding an Object Page Table on Every Instance Change (OData V2)

**INTRODUCTION**: Rebind a table in an Object Page every time the object page instance changes (for example when switching from one entity instance to another, or from display to edit). Applicable to SAP Fiori elements for OData V2. This guide shows the manifest changes and the controller extension code required to trigger a rebind on each instance change without causing duplicate batch calls.

**TAGS**: fiori-elements-framework, OData V2, object page, table, rebind, manifest, extensionAPI

**STEP**: 1 — Manifest: enable loadingBehavior for the subsection containing the table

**DESCRIPTION**: Add a loadingBehavior block for the subsection that contains the table. Set waitForHeaderData to true to prevent multiple batch calls. Optionally set waitForViewportEnter per your performance/UX needs. Place this under the object page settings -> sections -> <subsectionId> in manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "sections": {
              "subsection1": {
                "loadingBehavior": {
                  "waitForHeaderData": true,
                  "waitForViewportEnter": true
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

Notes:
- manifest.json path: sap.ui.generic.app -> pages -> component -> settings -> sections -> <subsectionId> -> loadingBehavior
- waitForHeaderData must be true to avoid duplicate batch calls.

**STEP**: 2 — Controller extension: attach pageDataLoaded to rebind the table on instance change

**DESCRIPTION**: In your object page controller extension (e.g., ext/controller/CISalesOrder.js), attach the pageDataLoaded event in onInit and implement a handler that calls extensionAPI.rebind(tableId). Provide the full table ID of the table you want to rebind. Also implement onBeforeRebindTableExtension to customize binding parameters (filters, sorters) and ensure you only act on the target table by checking its ID.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: ext/controller/CISalesOrder.js
sap.ui.define([
  "sap/ui/base/Object",
  "sap/m/MessageBox",
  "sap/ui/model/Filter",
  "sap/ui/model/FilterOperator"
], function(BaseObject, MessageBox, Filter, FilterOperator) {
  "use strict";

  // Replace this with your actual table ID
  var salesOrderItemTableId = "STTASOWD20::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20--SalesOrderItemsID::Table";

  return BaseObject.extend("STTASOWD20.ext.controller.CISalesOrder", {

    onInit: function(oController) {
      // Keep controller reference and attach pageDataLoaded
      this.oController = oController;
      this.oController.extensionAPI.attachPageDataLoaded(this.rebindSalesorderItemTable.bind(this));
    },

    rebindSalesorderItemTable: function() {
      // Rebind the specific table every time the page data is loaded (instance change)
      this.oController.extensionAPI.rebind(salesOrderItemTableId);
    },

    onBeforeRebindTableExtension: function(oEvent) {
      // This hook is called before any table is rebound; filter to the specific table ID
      if (oEvent.getSource().getId() === salesOrderItemTableId) {
        // Modify binding params if needed: add/remove filters, change sort order, etc.
        // Example: add a filter
        // var filter = new Filter("so_item_pos", FilterOperator.GE, "1");
        // oEvent.mParameters.bindingParams.filters.push(filter);
      }
    }

  });
});
```

**STEP**: 3 — Behavior and results

**DESCRIPTION**: With the manifest loadingBehavior set and the pageDataLoaded handler attached, the specified table will be rebound each time the object page instance changes. This avoids only refreshing the table and ensures binding recalculation when required.

**LANGUAGE**: Text

**CODE**:
```text
Result:
- Table rebinds on every object page instance change.
- Ensure waitForHeaderData: true in manifest to prevent duplicate batch calls.
- Applicable only to SAP Fiori elements for OData V2.
```

**STEP**: 4 — Reference

**DESCRIPTION**: Additional reading for subsection loading behavior configuration.

**LANGUAGE**: Text

**CODE**:
```text
See: Defining the Loading Behavior of Object Page Subsections
Path/Doc: defining-the-loading-behavior-of-object-page-subsections-6b84249.md
```
--------------------------------

**TITLE**: Reduce OData Entity Sets in Metadata via a Feature Toggle (Fiori Elements, OData V2)

**INTRODUCTION**: Short how-to for reducing entity sets exposed in application metadata by adding a feature toggle annotation to CDS views. When the backend feature toggle is deactivated, the entity set is removed from the OData V2 $metadata, which automatically removes related UI artifacts (tabs in list reports, sections on object pages) in SAP Fiori elements apps.

**TAGS**: fiori-elements-framework, odata-v2, cds, feature-toggle, metadata, entityset, sap

**STEP**: 1 — Create feature toggle in the backend system

**DESCRIPTION**: Define a feature toggle in the backend (ABAP / SAP system) using your chosen feature toggle framework (name it consistently). This step is backend-specific: create the toggle and be able to switch its state between Activated and Deactivated. Note: the feature toggle name is referenced directly in the CDS annotation.

**LANGUAGE**: Text

**CODE**:
```Text
# Example: choose a stable toggle name
Toggle name: Toggle_Name
# Create toggle in backend administration (ABAP / Feature Toggle framework)
# Ensure you can set it to: Activated or Deactivated
```

**STEP**: 2 — Annotate the CDS view with the feature toggle

**DESCRIPTION**: Place the feature toggle annotation exactly on the CDS view that represents the entity you want to hide/show from the app metadata. Use the annotation syntax shown below: `@feature:'Toggle_Name'`. When the toggle is Deactivated the entity will not appear in the OData $metadata.

**LANGUAGE**: CDS

**CODE**:
```CDS
@AbapCatalog.sqlViewName: 'ZMY_VIEW'
@EndUserText.label: 'My Entity View'
@feature: 'Toggle_Name'
define view ZC_MyEntity
  as select from some_table
{
  key field1   as ID,
      field2   as Name,
      field3   as Status
}
```

**STEP**: 3 — Build/activate CDS and register OData service

**DESCRIPTION**: Activate the CDS view in the backend and ensure the OData V2 service that exposes the CDS view is built/registered (registered in /IWFND/MAINT_SERVICE or equivalent). No special changes are required in the Fiori elements app—UI removal happens automatically based on the metadata served by the backend.

**LANGUAGE**: Text

**CODE**:
```Text
# Example backend tasks:
# 1. Activate CDS object in ABAP (SE80 / ADT).
# 2. Ensure OData service exposes the CDS view (service registration).
# 3. Restart or refresh service cache if necessary.
```

**STEP**: 4 — Verify metadata presence/absence (HTTP check)

**DESCRIPTION**: Call the OData V2 $metadata endpoint to confirm whether the entity set appears. If the feature toggle is Activated the EntitySet is present; if Deactivated it is removed from $metadata. Use curl or any HTTP client to fetch metadata and inspect the <EntitySet> collection.

**LANGUAGE**: HTTP

**CODE**:
```bash
# Example: fetch OData V2 metadata
curl -u user:pass "https://<host>/sap/opu/odata/sap/<SERVICE_NAME>/$metadata" -o metadata.xml

# Quick grep to check for an entity set named MyEntitySet
grep -n "EntitySet Name=\"MyEntitySet\"" metadata.xml || echo "EntitySet not found"
```

**STEP**: 5 — Example metadata XML fragments (present vs absent)

**DESCRIPTION**: Reference XML snippets show what to look for. If present, an EntitySet entry exists. If the feature toggle is deactivated and the annotation worked, this entry will not appear.

**LANGUAGE**: XML

**CODE**:
```XML
<!-- Present when feature toggle is ACTIVATED -->
<EntitySet Name="MyEntitySet" EntityType="MyService.MyEntityType" />

<!-- Absent when feature toggle is DEACTIVATED -->
<!-- (No EntitySet entry for MyEntitySet in the Schema/EntityContainer) -->
```

**STEP**: 6 — UI impact (Fiori elements List Report / Object Page)

**DESCRIPTION**: Behavior summary for app developers:
- List report with multiple tabs: tabs bound to the reduced entity set are removed automatically when the entity set is absent.
- Object page: sections bound to the reduced entity set are removed automatically when the entity set is absent.
No additional UI code changes are required in the Fiori elements app; behavior is metadata-driven.

**LANGUAGE**: Text

**CODE**:
```Text
# Summary:
# - Toggle Activated => EntitySet present in $metadata => related tabs/sections visible.
# - Toggle Deactivated => EntitySet removed from $metadata => related tabs/sections hidden.
```
--------------------------------

**TITLE**: Refreshing ALP Data with Component.refreshBinding (OData V2)

**INTRODUCTION**: Use the Component.refreshBinding() API (implemented in webapp/Component.js) to reload header, filter, and content data for SAP Fiori elements Analytical List Page (ALP) applications using OData V2. This performs an in-app data refresh without a full browser reload, preserving filter selections and personalization settings.

**TAGS**: fiori-elements-framework, analytical-list-page, ALP, OData V2, refreshBinding, Component.js, controller-extension

**STEP**: 1 — Purpose and applicability

**DESCRIPTION**: Explain the purpose and scope of refreshBinding and when to use it. Applicable only to SAP Fiori elements for OData V2 ALP apps. Use this to reload data for header, filter bar (compact or visual filter), and content areas without reloading the entire page.

**LANGUAGE**: Text

**CODE**:
```Text
- API: Component.refreshBinding()
- Location: webapp/Component.js (callable from controllers/extension code via this.getOwnerComponent())
- Use case: Refresh data for ALP header, filter, and content without triggering a browser refresh
- Applicable to: SAP Fiori elements Analytical List Page (ALP) using OData V2 only
```

**STEP**: 2 — Behavioral details and important notes

**DESCRIPTION**: What is retained and what is lost during refreshBinding. Include caveats about main chart selection and filter mode AutoHide.

**LANGUAGE**: Text

**CODE**:
```Text
Behavior:
- Retained:
  - Filter bar selections (compact or visual filter)
  - Personalization settings (sorting, grouping, etc.)
- Lost:
  - Main chart selection is cleared during refreshBinding.
  - If filter mode is AutoHide, losing the main chart selection may change the displayed table data.

Recommendation:
- If your application relies on main chart selection persistence, take explicit steps to store/restore the selection before/after calling refreshBinding.
```

**STEP**: 3 — Minimal controller extension example (call refreshBinding)

**DESCRIPTION**: Example of calling refreshBinding from a controller extension method. Place this in your controller extension file (e.g., webapp/controller/Extension.controller.js). The snippet checks that the component and method exist before calling.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// File: webapp/controller/Extension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("my.app.controller.Extension", {
    onRefreshAction: function () {
      // Get the owning component (webapp/Component.js)
      var oComponent = this.getOwnerComponent();

      // Safely call refreshBinding if available
      if (oComponent && typeof oComponent.refreshBinding === "function") {
        oComponent.refreshBinding();
      } else {
        // Optional: fallback / logging
        /* eslint-disable no-console */
        console.warn("refreshBinding is not available on the owner component.");
      }
    }
  });
});
```

**STEP**: 4 — Example usage in XML view (trigger the controller method)

**DESCRIPTION**: Wire a UI control (button) in the view to the controller extension method that calls refreshBinding.

**LANGUAGE**: XML

**CODE**:
```XML
<!-- File: webapp/view/SomeView.view.xml -->
<Button
  text="Refresh Data"
  press=".onRefreshAction" />
```

**STEP**: 5 — Related information and extension reference

**DESCRIPTION**: Link to additional documentation for configuring ALP app extensions.

**LANGUAGE**: Text

**CODE**:
```Text
See also:
- Configuring Analytical List Page App Extensions:
  configuring-analytical-list-page-app-extensions-9504fb4.md
```
--------------------------------

**TITLE**: Refresh Data When Returning to an App Running with sap-keep-alive

**INTRODUCTION**: Quick reference for adding controller-extension hooks to refresh specific data when an app using sap-keep-alive is suspended and later restored (back navigation). Covers OData V2 (onLeaveAppExtension) and OData V4 (onSuspend / onRestore) extension points used in SAP Fiori elements controllers.

**TAGS**: sapui5, fiori-elements, odata, sap-keep-alive, controller-extension, onLeaveAppExtension, onSuspend, onRestore

**STEP**: 1 — OData V2: Implement onLeaveAppExtension to provide a reactivate callback

**DESCRIPTION**: Implement onLeaveAppExtension in your ObjectPage/ListReport controller extension. The method is invoked when the application is about to be suspended because of an external navigation. Return a function from onLeaveAppExtension that will be called when the app is reactivated (back navigation). Use that callback to refresh models, rebinding, or execute custom logic to update specific controls/data.

Reference: API docs for ObjectPage controller framework extensions — https://ui5.sap.com/#/api/sap.suite.ui.generic.template.ObjectPage.controllerFrameworkExtensions

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example controller extension for OData V2 (ObjectPage or ListReport)
// Place in your controller extension file (e.g. webapp/ext/YourExt.controller.js)
return ControllerExtension.extend("your.namespace.Extension", {
    // Implement the onLeaveAppExtension hook
    onLeaveAppExtension: function (bIsDestroyed) {
        // Called when the app is suspended. Add any pre-suspend logic here.
        Log.info("onLeaveAppExtension called! App is being suspended.");

        // Return a function that will be called when the app is reactivated (back navigation).
        var fnReactivate = function () {
            // Put restore/refresh logic here. Example: refresh the default model
            // or rebind specific controls.
            var oView = this.getView ? this.getView() : null;
            if (oView) {
                // Example: refresh the default model (OData V2)
                var oModel = oView.getModel();
                if (oModel && typeof oModel.refresh === "function") {
                    oModel.refresh(true);
                }
                // Example: refresh a table binding by id (uncomment and replace id)
                // var oTable = oView.byId("myTableId");
                // if (oTable && oTable.getBinding && oTable.getBinding("items")) {
                //     oTable.getBinding("items").refresh();
                // }
            }
            sap.m.MessageToast.show("App reactivated: data refresh triggered");
        }.bind(this);

        return fnReactivate;
    }
});
```

**STEP**: 2 — OData V4: Implement onSuspend and onRestore in viewState override

**DESCRIPTION**: For OData V4 apps running with sap-keep-alive, implement viewState.onSuspend and viewState.onRestore inside a controller extension override. onSuspend is called when the app/page is suspended; onRestore is called when it is restored (back navigation). Use onSuspend to persist minimal state if needed, and onRestore to rebind or refresh models/bindings for the visited pages that require fresh data.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example controller extension for OData V4 list report or object page
// Place in your controller extension file (e.g. webapp/ext/YourExt.controller.js)
return ControllerExtension.extend("your.namespace.LRExtend", {
    override: {
        viewState: {
            // Called when the app/page is suspended (external navigation)
            onSuspend: function() {
                // Save transient UI state if required (selection, scroll pos, etc.)
                // Example: store a flag or minimal state in a local variable or model
                // this._mySavedState = { selectedKey: this.getView().byId("mySelect").getSelectedKey() };
            },
            // Called when the app/page is restored (back navigation)
            onRestore: function() {
                // Rebind or refresh the controls / models that must show fresh data.
                var oView = this.getView ? this.getView() : null;
                if (oView) {
                    // Example: refresh the OData V4 model (if supported)
                    var oModel = oView.getModel();
                    if (oModel && typeof oModel.refresh === "function") {
                        // Force refresh of caches / calls as needed
                        oModel.refresh(true);
                    }

                    // Example: refresh a control binding (replace "myTableId" and "items"/"rows")
                    // var oTable = oView.byId("myTableId");
                    // if (oTable) {
                    //     var oBinding = oTable.getBinding("items") || oTable.getBinding("rows");
                    //     if (oBinding && typeof oBinding.refresh === "function") {
                    //         oBinding.refresh();
                    //     }
                    // }

                    // Optionally restore transient UI state
                    // if (this._mySavedState) { this.getView().byId("mySelect").setSelectedKey(this._mySavedState.selectedKey); }
                }
            }
        }
    }
});
```
--------------------------------

**TITLE**: Refresh Entity Sets in sap-keep-alive Mode (manifest configuration examples for OData V2 & V4)

**INTRODUCTION**: Quick, code-focused reference showing how to configure entity-set refresh behavior when an SAP Fiori app is restored in sap-keep-alive mode. Includes manifest.json examples for OData V2 and OData V4, extension API usage, and notes about containment paths and ETag requirements.

**TAGS**: fiori-elements-framework, sapui5, manifest, sap-keep-alive, ODataV2, ODataV4, crossNavigation, refreshStrategyOnAppRestore, extensionAPI

STEP: 1 — Entity set options
DESCRIPTION: Two supported refresh strategies for entity sets. Use these keywords in manifest configuration values.
LANGUAGE: Text
CODE:
```
self
  - Only the specified entity set itself is refreshed.

includingDependents
  - Refreshes the specified entity set and its dependent navigation properties,
    but only if there is a UI control bound to the dependent entity.
  - Does NOT refresh dependents that have no control bound in the UI.
```

STEP: 2 — OData V2: Manifest pattern (ObjectPage / ListReport navigation configuration)
DESCRIPTION: Configure refreshStrategyOnAppRestore under "sap.ui.generic.app" pages for outbound navigation targets referenced by "sap.app" crossNavigation. Use this block to override default behavior for chevron/external navigation back to the app.
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "...": "...",
    "crossNavigation": {
      "outbounds": {
        "<OutboundTarget>": {
          "semanticObject": "<SemanticObject>",
          "action": "<Action>"
        }
      }
    }
  },
  "...": "...",
  "sap.ui.generic.app": {
    "...": "...",
    "pages": {
      "ListReport|<ListReportEntitySet>": {
        "...": "...",
        "pages": {
          "ObjectPage|<ObjectPageEntitySet>": {
            "...": "...",
            "navigation": {
              "display": {
                "path": "sap.apps.crossNavigation.outbounds",
                "target": "<OutboundTarget>",
                "refreshStrategyOnAppRestore": {
                  "entitySets": {
                    "<EntitySetToRefresh>": "self",
                    "<AnotherEntitySetToRefresh>": "includingDependents"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — OData V2: Default and per-outbound refresh strategies (externalNavigationSettings)
DESCRIPTION: Define default outbound settings and per-outbound overrides for external navigations. Place under "sap.ui.generic.app" -> "settings" -> "externalNavigationSettings".
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "...": "...",
    "crossNavigation": {
      "outbounds": {
        "<OutboundTarget1>": {
          "semanticObject": "<SemanticObject1>",
          "action": "<Action1>"
        },
        "<OutboundTarget2>": {
          "semanticObject": "<SemanticObject2>",
          "action": "<Action2>"
        }
      }
    }
  },
  "...": "...",
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "externalNavigationSettings": {
        "defaultOutboundSettings": {
          "refreshStrategyOnAppRestore": {
            "entitySets": {
              "<EntitySetToRefresh>": "self",
              "<AnotherEntitySetToRefresh>": "includingDependents"
            }
          }
        },
        "outbounds": {
          "<OutboundTarget1>": {
            "refreshStrategyOnAppRestore": {
              "entitySets": {
                "<EntitySetToRefresh>": "includingDependents"
              }
            }
          },
          "<OutboundTarget2>": {
            "refreshStrategyOnAppRestore": {
              "entitySets": {
                "<AnotherEntitySetToRefresh>": "self"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — OData V2: Extension navigation (navigateExternal)
DESCRIPTION: When using extension APIs to trigger external navigation, pass an outbound target to navigateExternal. The refreshStrategyOnAppRestore defined for that outbound target is applied when the app is restored.
LANGUAGE: JavaScript
CODE:
```javascript
// Extension Class (e.g., controller extension)
onListNavigationExtension: function (oEvent) {
    var oNavigationController = this.extensionAPI.getNavigationController();
    // Pass the outbound target defined in sap.app.crossNavigation.outbounds
    oNavigationController.navigateExternal("<OutboundTarget>");
    return true;
}
```

STEP: 5 — OData V2: Reuse component / setRefreshBehaviour
DESCRIPTION: For reuse components or smart link usages, register a before-navigation callback to set refresh behavior using the navigation controller API setRefreshBehaviour.
LANGUAGE: JavaScript
CODE:
```javascript
// Example reuse component stStart function
stStart: function(oModel, oBindingContext, oExtensionAPI) {
    var oComponentModel = this.getComponentModel();
    var oBinding = oComponentModel.bindProperty("/state");
    oBinding.attachChange(function(){
        oExtensionAPI.onCustomStateChange();
        this.setMessage();
    }.bind(this));
    this.adaptToBindingContext(oBindingContext);

    var oNavPopOverLink = this.getRootControl().getContent()[0].getContent()[7];
    var oNavigationController = oExtensionAPI.getNavigationController();

    // Bind a before-navigation callback to set refresh behaviour for entity set "EPMSalesOrder"
    // The API expects the entitySet name (string) or a configuration; refer to the navigationController docs.
    oNavPopOverLink.setBeforeNavigationCallback(
        oNavigationController.setRefreshBehaviour.bind(null, "EPMSalesOrder")
    );
},
```

STEP: 6 — OData V4: Manifest routing target example (per-page, intents and defaultBehavior)
DESCRIPTION: Configure refreshStrategyOnAppRestore per routing target. The resolution logic: exact semanticObject-action ("intents" key with full inbound name) → semanticObject-only ("intents" key) → page-level defaultBehavior. Use this structure under the target's options.settings.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "type": "Component",
          "id": "SalesOrderManageList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "...": "...",
              "refreshStrategyOnAppRestore": {
                "defaultBehavior": {
                  "SalesOrderManage": "self"
                }
              }
            }
          }
        },
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "...": "...",
              "refreshStrategyOnAppRestore": {
                "intents": {
                  "v4Freestyle": {
                    // matched when semanticObject matches (action differs or missing)
                    "SalesOrderItem": "includingDependents"
                  },
                  "v4Freestyle-Inbound": {
                    // matched when semanticObject-action (= inbound) matches exactly
                    "SalesOrderItem": "includingDependents"
                  }
                },
                "defaultBehavior": {
                  // fallback when no matching intent is found
                  "SalesOrderManage/_Item": "includingDependents"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 7 — OData V4: Switch off default chevron refresh for specific intents
DESCRIPTION: To disable the default chevron refresh for a semanticObject (except the exact inbound if present), provide an empty object for that intent under refreshStrategyOnAppRestore.intents. This prevents automatic refresh for those intent matches.
LANGUAGE: JSON
CODE:
```json
"refreshStrategyOnAppRestore": {
  "intents": {
    "v4Freestyle-Inbound": {
      "SalesOrderItem": "includingDependents"
    },
    "v4Freestyle": {} // Empty -> no refresh for other intents matching the v4Freestyle semantic object
  }
}
```

STEP: 8 — Important behavior notes and implementation reminders
DESCRIPTION: Key runtime behavior and manifest syntax rules to apply when implementing refresh strategies.
LANGUAGE: Text
CODE:
```
- Create navigation: For external Create navigations, the table entity set is refreshed by default on back navigation (cannot be overridden in Fiori Elements OData V2).

- Chevron navigation: Default refresh happens for chevron external navigation but can be overridden or disabled via manifest configuration (see steps above).

- Other external navigation (including navigateExternal from extensions): No refresh by default. Use refreshStrategyOnAppRestore in manifest to define refresh lists.

- When navigateExternal is used, the outbound target's refreshStrategyOnAppRestore is used.

- ETag: If backend is NOT ETag-enabled, and List Report table is configured in Flexible Column Layout, refresh may trigger for all dependents. To avoid excessive refresh, enable ETag support in the backend.

- Containment / parameterized entities: If specifying a containment-based or parameterized entity path, start with a leading slash (e.g., "/Customer/Set") consistent with "contextPath" manifest property. For regular entity sets use no leading slash (e.g., "SalesOrderItem").

- Internal navigation after restore: After restoring and then navigating forward internally within the app, data requests are always sent to the backend irrespective of these restore-refresh settings.

- Use exact keys for intents in V4: intent keys correspond to the inbound name (semanticObject[-action]) as resolved by the launchpad; prioritization: exact inbound match > semanticObject-only match > page-level defaultBehavior.
```
--------------------------------

**TITLE**: Configure entity-set refresh on app restore (sap-keep-alive) for Overview Pages (OVP)

**INTRODUCTION**: Configure which OData entity sets should be refreshed automatically when an Overview Page (OVP) view is restored by the SAP Fiori launchpad sap-keep-alive mechanism. Add settings into webapp/manifest.json under the "sap.ovp" section so that specified entity sets are refreshed (value "self") when the user returns to the source application.

**TAGS**: fiori-elements-framework, sapui5, overview-pages, manifest.json, sap-keep-alive, sap.ovp, entity-sets, app-restore

**STEP**: 1 - Add refreshStrategyOnAppRestore to manifest.json

**DESCRIPTION**: Edit webapp/manifest.json and add the refreshStrategyOnAppRestore.entitySets mapping under "sap.ovp". Use the entity set name as the key and "self" as the value to instruct OVP to refresh that entity set when the view is restored by sap-keep-alive.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters",  /* Deprecated since SAPUI5 1.54 */
    "globalFilterEntitySet": "ZFilterEntitySet", /* Available from SAPUI5 1.54 onwards */
    "smartVariantRequired": true,
    "enableLiveFilter": true,
    "containerLayout": "resizable",
    "refreshStrategyOnAppRestore": {
      "entitySets": {
        "<entitySetToRefresh>": "self"
      }
    },
    "cards": {
      /* card definitions */
    }
  }
}
```

**STEP**: 2 - Refresh multiple entity sets

**DESCRIPTION**: To refresh more than one entity set on app restore, add multiple entries under refreshStrategyOnAppRestore.entitySets. Each key is an entity set name; each value currently supports "self" to refresh that entity set when returning to the source app.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "refreshStrategyOnAppRestore": {
      "entitySets": {
        "SalesOrderHeaderSet": "self",
        "SalesOrderItemSet": "self",
        "ZCustomEntitySet": "self"
      }
    }
  }
}
```

**STEP**: 3 - Real-world example and notes

**DESCRIPTION**: Example for a SalesOrder OVP where the SalesOrderHeaderSet should be refreshed on restore. Notes: "self" triggers a reload of the entity set when the view is restored by sap-keep-alive. Keep in mind that globalFilterEntityType is deprecated (SAPUI5 >= 1.54 prefers globalFilterEntitySet).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntitySet": "GlobalFiltersSet",
    "refreshStrategyOnAppRestore": {
      "entitySets": {
        "SalesOrderHeaderSet": "self"
      }
    },
    "cards": {
      "SalesOrderList": {
        "component": {
          "name": "sap.ovp.cards.list",
          "settings": {
            "entitySet": "SalesOrderHeaderSet"
          }
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Replace Standard Save in Mass Edit Dialog (OData V2 & V4)

**INTRODUCTION**: Instructions and code-ready examples to implement custom save logic for the Mass Edit dialog in SAP Fiori Elements. Includes actionable controller-extension code for OData V2 (beforeMultiEditSaveExtension) and OData V4 (customMassEditSave in editFlow override). Use these examples inside your List Report or Object Page controller extension to invoke custom actions/function imports and control whether the framework runs its default save/cleanup.

**TAGS**: fiori-elements-framework, mass-edit, save, extension, controller-extension, odata-v2, odata-v4, invokeAction, function-import

**STEP**: OData V2 — Implement beforeMultiEditSaveExtension in controller extension

**DESCRIPTION**: Add a beforeMultiEditSaveExtension function to your List Report or controller extension. The function receives an array aContextsToBeUpdated. Each element contains:
- sContextPath: string — the binding/context path to be updated
- oUpdateData: object — dictionary of property paths and updated values

Return a Promise from the extension. Use this.extensionAPI.invokeActions (or your custom OData function import/action) to perform server-side update. The framework performs cleanup (closing dialog, etc.) after the returned Promise resolves or rejects.

Place this method inside your controller extension file for the List Report or Object Page.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: <your_extension>/ListReport.controller.js (or object page controller extension)
// Add the method inside your controller extension object

beforeMultiEditSaveExtension: function (aContextsToBeUpdated) {
    // aContextsToBeUpdated - array of objects:
    //   aContextsToBeUpdated[].sContextPath - context path (string)
    //   aContextsToBeUpdated[].oUpdateData - object with updated property values

    var oApi = this.extensionAPI; // provided by Fiori Elements controller extension

    // Return a Promise so the framework can perform cleanup after completion
    return new Promise(function (fnResolve, fnReject) {
        // Example: call a function import / action for mass update
        // Replace "YourService/YourFunctionImport" with your backend function import/action name
        var oPromise = oApi.invokeActions(
            "YourService/YourFunctionImport",
            [],                 // URL parameters for the function import (if any)
            aContextsToBeUpdated // pass contexts and update data to the backend
        );

        oPromise.then(fnResolve, fnReject);
    });
}

// Example usage notes:
// - If you omit this extension, the framework executes the default mass-edit save.
// - Ensure your backend function import/action accepts the structure you pass (contexts + update data).
```

**STEP**: OData V4 — Implement customMassEditSave in editFlow override

**DESCRIPTION**: For OData V4, override editFlow.customMassEditSave inside a ControllerExtension module. Return true from customMassEditSave to prevent the framework's default save. aParameters contains:
- aParameters.aContexts: array of selected contexts
- aParameters.oUpdateData: dictionary mapping propertyPath -> newValue

Use this.base.editFlow.invokeAction to call a backend action (with contexts and parameterValues). Handle errors and optionally display UI messages. Place this module as a controller extension (List Report or Object Page).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: <your_extension>/MassEditControllerExtension.js
sap.ui.define([
    "sap/ui/core/mvc/ControllerExtension",
    "sap/m/MessageToast"
], function (ControllerExtension, MessageToast) {
    "use strict";

    return ControllerExtension.extend("your.namespace.MassEditExt", {
        override: {
            editFlow: {
                /**
                 * customMassEditSave is invoked when the mass edit dialog save is triggered.
                 * Return true to prevent the framework default mass-edit save.
                 *
                 * @param {object} aParameters
                 * @param {Array}  aParameters.aContexts - the selected contexts for mass edit
                 * @param {object} aParameters.oUpdateData - propertyPath -> value dictionary
                 * @returns {Promise<boolean>|boolean} return true to skip default save (or a Promise resolving to true)
                 */
                customMassEditSave: async function (aParameters) {
                    try {
                        // Example: invoke a backend action named "Service.customUpdateAction"
                        await this.base.editFlow.invokeAction("Service.customUpdateAction", {
                            contexts: aParameters.aContexts,
                            parameterValues: aParameters.oUpdateData
                        });

                        // Optionally show success UI feedback
                        MessageToast.show("Mass edit saved via custom action.");
                    } catch (e) {
                        // Handle error and show message
                        MessageToast.show("Custom mass-save failed: " + e.toString());
                    }

                    // Returning true prevents the framework default mass-edit save/processing
                    return true;
                }
            }
        }
    });
});
```

**STEP**: Notes & Best Practices

**DESCRIPTION**:
- OData V2: The framework runs the default save if beforeMultiEditSaveExtension is not defined. When defined, return a Promise so the framework can run cleanup after the Promise settles.
- OData V4: customMassEditSave must return true (or resolve to true) to prevent default save. If you return false or do not return true, the framework will execute the default save after your extension.
- Use the extension APIs (this.extensionAPI or this.base.editFlow.invokeAction) to invoke backend actions/function imports. Replace placeholder service/action strings with your actual service and action names.
- Test with multiple selected contexts and verify the payload shape expected by your backend action/function import.
--------------------------------

**TITLE**: Configure field responsiveness using com.sap.vocabularies.UI.v1.Importance

**INTRODUCTION**: Use the UI.Importance annotation to control which fields are visible on phone, tablet, and desktop in SAP Fiori elements pages with toolbars (e.g., List Report tables, Object Page tables, Smart Chart toolbars). High = visible on phone; High+Medium = visible on tablet; High+Medium+Low = visible on desktop. This guide shows how to add OData annotation XML, register it in the app manifest, and sample expected behavior.

**TAGS**: fiori-elements-framework, annotations, UI.Importance, responsiveness, manifest, annotations.xml

**STEP**: Create an OData annotations XML file

**DESCRIPTION**: Add an annotations file that targets individual properties and sets com.sap.vocabularies.UI.v1.Importance. Place the file under your app project, e.g. webapp/annotations/responsiveness.annotations.xml. Replace the Target values with your service/entity/property names.

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="http://docs.oasis-open.org/odata/odata/v4.0/cs01/vocabularies/Org.OData.Core.V1.xml" />
  <edmx:Reference Uri="http://sap.com/adt/edd/vocabularies/UI/v1">
    <!-- optional: include other references as needed -->
  </edmx:Reference>

  <edmx:DataServices>
    <!-- Annotate individual properties of an entity type -->
    <!-- Example entity fully qualified name: MyService.Product -->
    <Annotations Target="MyService.Product/Color">
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance">
        <EnumMember>com.sap.vocabularies.UI.v1.ImportanceType/High</EnumMember>
      </Annotation>
    </Annotations>

    <Annotations Target="MyService.Product/Name">
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance">
        <EnumMember>com.sap.vocabularies.UI.v1.ImportanceType/Medium</EnumMember>
      </Annotation>
    </Annotations>

    <Annotations Target="MyService.Product/Description">
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance">
        <EnumMember>com.sap.vocabularies.UI.v1.ImportanceType/Low</EnumMember>
      </Annotation>
    </Annotations>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: Register the annotations file in manifest.json (app-level)

**DESCRIPTION**: Ensure the annotation file is known to the app and bound to the OData data source. Below is a common pattern where the annotation file is referenced in the data source settings. Adjust "uri" and file paths to your project structure.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "my.app.id",
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/ZMY_SERVICE_SRV/",
        "type": "OData",
        "settings": {
          "annotations": [
            "annotations/responsiveness.annotations.xml"
          ]
        }
      }
    }
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      }
    }
  }
}
```

**STEP**: Expected rendering behavior and verification

**DESCRIPTION**: After deploying and running the Fiori elements app:
- Fields annotated with ImportanceType/High appear on mobile phones.
- Fields annotated with High or Medium appear on tablets.
- Fields annotated with High, Medium, or Low appear on desktop.
To test: open the List Report or Object Page in different device emulators or browser responsive modes and confirm visibility of the annotated properties in toolbars/tables/line items.

**LANGUAGE**: text

**CODE**:
```text
Verification checklist:
- Mobile emulator (small width): only properties with Importance = High are visible.
- Tablet emulator (medium width): properties with Importance = High or Medium are visible.
- Desktop (large width): properties with Importance = High, Medium, or Low are visible.
```

**STEP**: Notes and best practices

**DESCRIPTION**: Use Importance only for fields that appear in toolbar contexts or rendered lists/tables. Do not rely on Importance for security or access control (use backend authorization). Keep annotation file scope minimal (target specific properties) to avoid unintended UI changes.

**LANGUAGE**: text

**CODE**:
```text
Best practices:
- Target only the properties you need to control for responsiveness.
- Keep annotation file path under webapp/annotations and reference it in manifest.json.
- Use Importance combined with other UI annotations (e.g., FieldControl) as needed.
```
--------------------------------

**TITLE**: SAP Fiori Elements — Developer Action Recipes (extension points, custom columns, actions, view caching)

**INTRODUCTION**: Concise, code-focused recipes for common SAP Fiori Elements development tasks: register controller and view extensions, inject a custom column into a table, declare a custom action via annotations, and enable view keep-alive in the manifest. Use these snippets as drop-in examples; adjust entitySet, view names, namespaces, and fragment code to your app.

**TAGS**: fiori-elements, extension-points, manifest.json, controller-extension, view-extension, annotations, UI.LineItem, DataFieldForAction, sap-keep-alive, webapp

STEP: 1 — Register a controller extension for List Report
DESCRIPTION: Register a controller extension in webapp/manifest.json and implement the extension controller in webapp/extension. Use this to hook lifecycle events (onInit, onBeforeBinding) or add behavior without altering generated files.
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (excerpt)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "my.app.extension.ListReportExtension"
          }
        }
      }
    }
  }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/extension/ListReportExtension.controller.js
sap.ui.define(["sap/ui/core/mvc/Controller"], function (Controller) {
  "use strict";
  return Controller.extend("my.app.extension.ListReportExtension", {
    onInit: function () {
      // custom onInit code for List Report
      // e.g., attach to events, extend filter bar behavior
      // this.getView() available here
    },

    // Example: custom method invoked from a view fragment or button
    onMyCustomAction: function (oEvent) {
      // implement custom logic
    }
  });
});
```

STEP: 2 — Inject a custom column into a table using a view extension fragment
DESCRIPTION: Use viewExtensions in manifest.json to add an XML fragment before or after a specific extension point of a generated view (List Report / Object Page). The fragment contains the UI5 controls to be inserted (e.g., a Column and template cell).
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (excerpt)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details::ObjectPage|ObjectPage_1": {
            "BeforeLineItem": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "my.app.fragments.CustomColumn",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

LANGUAGE: XML
CODE:
```xml
<!-- File: webapp/extension/fragments/CustomColumn.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:table="sap.ui.table">
  <!-- Example for a responsive table: add a custom column cell in the LineItem area -->
  <!-- For object page smart table, adjust namespace and content accordingly -->
  <Text text="{myModel>CustomField}" />
  <!-- If you need to add a Column control (sap.ui.table.Column) in a table macro scenario, use the proper table type fragment -->
</core:FragmentDefinition>
```

STEP: 3 — Declare a custom (annotation-based) action for an entity set
DESCRIPTION: Add a UI annotation DataFieldForAction to expose an action in the LineItem or a header. This snippet shows an OData annotation fragment (XML) to add an unbound/bound action into UI.LineItem. Adjust action name and label to your service action.
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations/Annotations.xml (UI annotations excerpt) -->
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="UI.LineItem">
    <Collection>
      <!-- existing DataFields... -->
      <Record Type="UI.DataFieldForAction">
        <PropertyValue Property="Action" String="com.sap.service.MyCustomAction" />
        <PropertyValue Property="Label" String="My Custom Action" />
        <!-- Use Determining to place action appropriately -->
        <PropertyValue Property="Inline" Bool="true" />
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: 4 — Enable a view to be kept alive (sap-keep-alive) to keep state across navigation
DESCRIPTION: Configure routing target settings in the manifest to keep the view instance alive (cache/back navigation behavior). Set keepAlive: true in the routing target settings for the List Report or Object Page route target.
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (routing target excerpt)
{
  "sap.ui5": {
    "routing": {
      "config": {
        "routerClass": "sap.m.routing.Router",
        "viewType": "XML",
        "viewPath": "my.app.view",
        "controlId": "app",
        "controlAggregation": "pages"
      },
      "routes": [
        {
          "name": "list",
          "pattern": "",
          "target": "List"
        }
      ],
      "targets": {
        "List": {
          "viewName": "ListReport",
          "viewLevel": 1,
          "controlAggregation": "pages",
          "settings": {
            "keepAlive": true
          }
        }
      }
    }
  }
}
```

STEP: 5 — Quick references and actionable next steps (links from original feature map)
DESCRIPTION: Use these referenced docs for the feature-specific implementation details and full examples (preserve file names and paths from the feature map). The code snippets above are entry points — follow linked docs for detailed options and annotation formats.
LANGUAGE: JSON
CODE:
```json
// Key docs from original feature map (file names / paths)
[
  "extending-generated-apps-using-app-extensions-340cdb2.md",
  "extending-list-reports-and-object-pages-using-app-extensions-a892eb8.md",
  "extension-points-for-tables-d525522.md",
  "adding-custom-actions-using-extension-points-7619517.md",
  "actions-cbf16c5.md",
  "configuring-tables-f4eb70f.md",
  "sap-keep-alive-note: refresh-entity-sets-in-sap-keep-alive-mode-3c65f2c.md"
]
```

STEP: 6 — Common properties and tags to search in the feature map
DESCRIPTION: Use these keywords when searching the original feature map for concrete implementation patterns, property names, and feature-specific docs. They map to UI behavior or manifest/annotation properties referenced in the feature map.
LANGUAGE: JSON
CODE:
```json
{
  "commonProperties": [
    "enableAddCardToInsights",
    "ImageUrl",
    "isCurrency",
    "useSemanticDateRange",
    "defaultPath",
    "showMicroChartLabel",
    "enableExport",
    "enableMassEdit",
    "sap-keep-alive",
    "SelectionVariant",
    "FilterDefaultValue",
    "UI.LineItem",
    "DataFieldForAction",
    "Edm.Stream"
  ]
}
```

--------------------------------

**TITLE**: SAP Fiori Elements Tutorials, Courses, and Blogs — Resource Index for Code Authors

**INTRODUCTION**: Consolidated, actionable index of official SAP Fiori Elements tutorials, learning journeys, and blog articles. Use the listed links directly to open tutorials, download pages for offline review, or script retrieval of resources for automated documentation pipelines and training datasets.

**TAGS**: fiori-elements-framework, sap-fiori, tutorials, learning-journeys, odata-v4, CAP, RAP, sapui5, blogs

STEP: 1 — Tutorials (Direct links)
DESCRIPTION: Official step-by-step tutorials. Open them in a browser or fetch HTML for offline use. Each link points to an SAP Developers tutorial that contains prerequisites, step-by-step instructions, and sample projects.
LANGUAGE: Bash
CODE:
```bash
# Open tutorial URLs in default browser (macOS/Linux/Windows WSL)
# macOS:
open "https://developers.sap.com/group.fiori-tools-odata-v4-travel.html"
open "https://developers.sap.com/group.fiori-tools-odata-v4-incident.html"
open "https://developers.sap.com/group.fiori-tools-lrop.html"
open "https://developers.sap.com/group.fiori-elements-mockserver-opa.html"
open "https://developers.sap.com/group.sapui5-adaptation-projects.html"

# Linux (xdg-open):
xdg-open "https://developers.sap.com/group.fiori-tools-odata-v4-travel.html"
xdg-open "https://developers.sap.com/group.fiori-tools-odata-v4-incident.html"
xdg-open "https://developers.sap.com/group.fiori-tools-lrop.html"
xdg-open "https://developers.sap.com/group.fiori-elements-mockserver-opa.html"
xdg-open "https://developers.sap.com/group.sapui5-adaptation-projects.html"

# Download HTML for offline parsing (wget or curl)
wget -q -O fiori-travel.html "https://developers.sap.com/group.fiori-tools-odata-v4-travel.html"
curl -s -o fiori-incident.html "https://developers.sap.com/group.fiori-tools-odata-v4-incident.html"
```

STEP: 2 — Courses and Learning Journeys (Structured learning)
DESCRIPTION: Full courses and learning journeys on learning.sap.com. Use these links to enroll or to fetch course landing pages for automation or content indexing.
LANGUAGE: Bash
CODE:
```bash
# Open course pages
open "https://learning.sap.com/courses/developing-and-extending-sap-fiori-elements-apps"
open "https://learning.sap.com/learning-journeys/developing-an-sap-fiori-elements-app-based-on-a-cap-odata-v4-service"
open "https://learning.sap.com/learning-journeys/getting-started-with-creating-an-sap-fiori-elements-app-based-on-an-odata-v4-rap-service"

# Download course landing pages for reference
curl -s -o course-fiori-elements.html "https://learning.sap.com/courses/developing-and-extending-sap-fiori-elements-apps"
curl -s -o lj-cap-odata-v4.html "https://learning.sap.com/learning-journeys/developing-an-sap-fiori-elements-app-based-on-a-cap-odata-v4-service"
```

STEP: 3 — Blogs (Tag index and selected articles)
DESCRIPTION: Blog posts and tag index on SAP Community. If individual article links fail, use the main community page or the tag index to find updated links. The listed blog posts showcase Fiori Elements features with CAP and RAP/CDS annotations.
LANGUAGE: Bash
CODE:
```bash
# Primary blog/tag pages
open "https://blogs.sap.com/tags/ed5c1ef6-932f-4c19-b2ba-1be375109ff5/"
open "https://community.sap.com/"

# Specific recommended articles
open "https://blogs.sap.com/2021/12/07/the-sap-fiori-elements-feature-showcase-with-cap-cds-annotations/"
open "https://blogs.sap.com/2022/12/19/the-sap-fiori-elements-feature-showcase-with-rap-and-abap-cds-annotations/"

# Download blog HTML for indexing
curl -s -o blog-feature-cap-cds.html "https://blogs.sap.com/2021/12/07/the-sap-fiori-elements-feature-showcase-with-cap-cds-annotations/"
curl -s -o blog-feature-rap-abap.html "https://blogs.sap.com/2022/12/19/the-sap-fiori-elements-feature-showcase-with-rap-and-abap-cds-annotations/"
```

STEP: 4 — Fallback / Search strategy on SAP Community
DESCRIPTION: If links are broken or moved, use SAP Community search, tag browsing, or site navigation to find updated content. Example demonstrates a browser search URL that looks for keywords on the SAP Community domain.
LANGUAGE: Bash
CODE:
```bash
# Google site search pattern (open in browser)
# Replace KEYWORDS with search terms like "Fiori Elements CAP CDS annotations"
open "https://www.google.com/search?q=site:community.sap.com+Fiori+Elements+CAP+CDS+annotations"

# Direct SAP Community search page (open)
open "https://community.sap.com/search"
# Then paste keywords: Fiori Elements, CAP CDS, RAP, OData V4
```

STEP: 5 — Recommended automation snippets for content pipelines
DESCRIPTION: Minimal examples to bulk-download listed resources into a directory for parsing, indexing, or automated dataset creation.
LANGUAGE: Bash
CODE:
```bash
mkdir -p sap-fiori-resources
cd sap-fiori-resources

# List of resource URLs (repeat as needed)
urls=(
  "https://developers.sap.com/group.fiori-tools-odata-v4-travel.html"
  "https://developers.sap.com/group.fiori-tools-odata-v4-incident.html"
  "https://developers.sap.com/group.fiori-tools-lrop.html"
  "https://developers.sap.com/group.fiori-elements-mockserver-opa.html"
  "https://developers.sap.com/group.sapui5-adaptation-projects.html"
  "https://learning.sap.com/courses/developing-and-extending-sap-fiori-elements-apps"
  "https://learning.sap.com/learning-journeys/developing-an-sap-fiori-elements-app-based-on-a-cap-odata-v4-service"
  "https://learning.sap.com/learning-journeys/getting-started-with-creating-an-sap-fiori-elements-app-based-on-an-odata-v4-rap-service"
  "https://blogs.sap.com/tags/ed5c1ef6-932f-4c19-b2ba-1be375109ff5/"
  "https://blogs.sap.com/2021/12/07/the-sap-fiori-elements-feature-showcase-with-cap-cds-annotations/"
  "https://blogs.sap.com/2022/12/19/the-sap-fiori-elements-feature-showcase-with-rap-and-abap-cds-annotations/"
)

for url in "${urls[@]}"; do
  filename=$(echo "$url" | sed 's|https\?://||; s|[^a-zA-Z0-9]|-|g').html
  curl -s -L "$url" -o "$filename"
done

# Verify downloads
ls -1 *.html
```
--------------------------------

**TITLE**: Enable "Save and Close" Navigation from Object Page to List Report (Fiori elements, OData V2)

**INTRODUCTION**: Instructions to configure the Object Page so the Save button also navigates back to the List Report when a draft is saved. Applicable to SAP Fiori elements for OData V2. This is configured in manifest.json by setting the navToListOnSave flag under the ObjectPage component settings.

**TAGS**: fiori-elements, sapui5, odata-v2, manifest.json, object-page, navigation, save, draft

**STEP**: 1 — Add navToListOnSave flag to manifest.json

**DESCRIPTION**: Edit your application's manifest.json to set navToListOnSave to true under the ObjectPage component settings for the target EntitySet. This enables "Save and Close" behavior: when the user clicks Save and the draft is successfully saved, the app navigates back to the List Report. If the flag is false or absent, default behavior keeps the user on the Object Page.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "pages": {
    "ObjectPage|STTA_C_MP_Product": {
      "entitySet": "STTA_C_MP_Product",
      "component": {
        "name": "sap.suite.ui.generic.template.ObjectPage",
        "settings": {
          "navToListOnSave": true,
          "showRelatedApps": true,
          "tableType": "ResponsiveTable",
          "editableHeaderContent": true,
          "sections": {
            "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
              "navigationProperty": "to_ProductText",
              "entitySet": "STTA_C_MP_ProductText",
              "multiSelect": true,
              "createMode": "inline",
              "tableType": "ResponsiveTable"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Behavior and verification

**DESCRIPTION**: After deployment, verify:
- Open the Object Page for the configured entity (STTA_C_MP_Product in the example).
- Create or edit a draft record and click Save.
- When navToListOnSave is true, the draft is saved and the app navigates automatically to the List Report.
- When navToListOnSave is false or not set, the app remains on the Object Page (default).

**LANGUAGE**: None

**CODE**:
```text
Verification steps:
1. Navigate to the Object Page for the configured EntitySet.
2. Create or edit a draft and click Save.
3. Confirm navigation behavior:
   - If navToListOnSave = true -> navigate back to List Report after save.
   - If navToListOnSave = false or absent -> stay on Object Page (default).
```

**STEP**: 3 — Notes and scope

**DESCRIPTION**: Important details and scope:
- This configuration applies only to SAP Fiori elements for OData V2.
- Place the configuration in your app's manifest.json under the pages section for the ObjectPage target.
- The example uses entitySet STTA_C_MP_Product and a related section to_ProductText; adapt names to your application.
--------------------------------

**TITLE**: Scatter Chart Card (Fiori Elements) — Annotation Examples and Rules

**INTRODUCTION**: Use a Scatter Chart card to visualize the distribution of data points across two measures (x and y). The first measure (assigned to an axis role) maps to the x-axis (valueAxis feed UID). The second measure is plotted on the y-axis. This document provides precise, copy-pasteable annotation examples for XML, ABAP CDS, and CAP CDS, plus concise actionable rules for chart roles, dimensions, series, and categories.

**TAGS**: fiori-elements, UI.Chart, scatter, annotations, CDS, ABAP, CAP, XML, OVP, chart

STEP: 1 — Key rules and constraints

DESCRIPTION: Action-oriented rules to follow when creating a Scatter Chart card. Use these to validate and build annotations programmatically.

LANGUAGE: Text

CODE:
```
- ChartType: set to Scatter.
  - XML: UI.ChartType/Scatter
  - ABAP CDS: #SCATTER
  - CAP CDS: #Scatter

- Measures:
  - Scatter chart uses two measures: one for x-axis, one for y-axis.
  - Assign a Role to each measure using Axis roles.
    - Preferred role for x-axis: Axis1
    - Fallback rules for role assignment:
      - Axis1 (UI.ChartMeasureRoleType/Axis1)
      - If Axis1 not present, Axis2 becomes x-axis (Axis2 = UI.ChartMeasureRoleType/Axis2)
      - If neither Axis1 nor Axis2 present, Axis3 is used (UI.ChartMeasureRoleType/Axis3)
  - The measure assigned to an Axis role is mapped to the chart's valueAxis feed UID → x-axis.

- Dimensions:
  - Maximum of two dimensions supported.
  - If a dimension has no role, all members are rendered:
    - As equal-sized bubbles
    - With the same color
  - Series role:
    - Only one dimension can be assigned to Series.
    - Members of this dimension get different colors.
  - Category role:
    - Only one dimension can be assigned to Category.
    - Members of this dimension get different shapes.

- Visual/asset note:
  - Example image path: ../01_Whats-New/images/Whats_New_140_OVP_Scatter_Chart_f264ec1.png
```

STEP: 2 — XML Annotation example (annotations.xml / metadata extension)

DESCRIPTION: Copy this XML annotation into your annotations file (e.g., annotations.xml or manifest extension). It defines a Scatter chart with two measures (Axis1 and Axis2) and one dimension.

LANGUAGE: XML

CODE:
```xml
<!-- Put this in your annotation file (e.g., annotations.xml) or annotation extension -->
<Annotation Term="UI.Chart" Qualifier="Eval_by_Currency_Scatter">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Scatter Chart no role" />
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Scatter" />
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="salesshare" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                </Record>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="totalsales" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="DimensionAttributes">
            <Collection>
                <Record Type="UI.ChartDimensionAttributeType">
                    <PropertyValue Property="Dimension" PropertyPath="suppliercompany" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 3 — ABAP CDS Annotation example (place inside CDS view or annotation include)

DESCRIPTION: Drop this annotation into your ABAP CDS view annotations. Use qualifier to reference this chart definition. The chartType uses #SCATTER and measure role values use #AXIS_1/#AXIS_2.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.Chart: [
  {
    title: 'Scatter Chart no role',
    chartType: #SCATTER,
    measureAttributes: [
      {
        measure: 'salesshare',
        role: #AXIS_1
      },
      {
        measure: 'totalsales',
        role: #AXIS_2
      }
    ],
    dimensionAttributes: [
      {
        dimension: 'suppliercompany'
      }
    ],
    qualifier: 'Eval_by_Currency_Scatter'
  }
]
annotate view VIEWNAME with { }
```

STEP: 4 — CAP CDS Annotation example (cds file or annotation extension)

DESCRIPTION: Use this CAP CDS-style annotation in your .cds file or annotations file. It follows the UI annotation JSON-like structure for CAP.

LANGUAGE: CDS

CODE:
```cds
UI.Chart #Eval_by_Currency_Scatter : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Scatter Chart no role',
    ChartType : #Scatter,
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : salesshare,
            Role : #Axis1
        },
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : totalsales,
            Role : #Axis2
        }
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : suppliercompany
        }
    ]
},
```

STEP: 5 — Practical checklist before deployment

DESCRIPTION: Quick validation checklist to include in CI or pre-deployment static checks.

LANGUAGE: Text

CODE:
```
- Ensure ChartType is set to Scatter for the annotation qualifier used by the card.
- Verify exactly two measures are provided and each has distinct measure property paths.
- Verify at least one measure has Role = Axis1 (preferred). If not present, ensure roles follow fallback.
- Confirm dimensions <= 2; if using Series or Category roles, only one dimension assigned per role.
- Validate property paths (Measure and Dimension) match the OData/CDS fields exposed by the service.
- If using OVP card, configure the card to reference the correct annotation qualifier (Qualifier = 'Eval_by_Currency_Scatter').
```
--------------------------------

**TITLE**: Security Configuration for SAP Fiori elements (OData V4) — Annotations and Code Patterns

**INTRODUCTION**: This document collects concise, actionable code examples and configuration patterns to secure SAP Fiori elements apps (OData V4). It focuses on annotating potentially sensitive data, enabling safe uploads (AcceptableMediaTypes), masking fields, modifying navigation contexts to remove sensitive data, and backend upload validation (file size / MIME checks / virus-scan hooks). Use these snippets in CAP/CDS, OData metadata (EDMX), UI5 extension code, and Node/Express back ends.

**TAGS**: fiori-elements, OData V4, CAP, CDS, annotations, security, upload, PersonalData, Common.Masked, AcceptableMediaTypes, extensionAPI, navigation

**STEP**: 1 — Annotate sensitive properties and mask fields in CDS (CAP)

**DESCRIPTION**: In CAP CDS models, add PersonalData and Common annotations to mark potentially sensitive fields and to indicate UI masking. Add AcceptableMediaTypes on binary/stream properties to instruct the UI which MIME types are allowed for upload. Replace namespaces, entity names and types to match your model.

**LANGUAGE**: CDS

**CODE**:
```cds
namespace my.app;

using { PersonalData } from '@sap/cds/common';
using { Common, Core } from '@sap/cds/common';

entity Employee {
  key ID         : UUID;
  firstName      : String;
  lastName       : String;

  // Mark as potentially sensitive (prevents caching/history/store-restore where applicable)
  @PersonalData.IsPotentiallySensitive: true
  ssn            : String;

  // Mask the input in the UI (visual masking only; data is still submitted to backend)
  @Common.Masked: true
  bankAccount    : String;

  // File/attachment field - indicate allowed media types for the UI upload control
  // The exact type may vary; Binary is used here as a generic binary container.
  @Core.AcceptableMediaTypes: ['image/png', 'application/pdf']
  attachment     : Binary;
}
```

**STEP**: 2 — Annotate sensitive properties and AcceptableMediaTypes in OData EDMX (service metadata)

**DESCRIPTION**: If you provide or customize the OData EDMX metadata, add the PersonalData and Core annotations directly to Property definitions (Edm types). This is the OData V4 XML form of the same CDS annotations and is consumed by SAP Fiori elements.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- service/metadata.xml (EDMX fragment) -->
<EntityType Name="Employee">
  <Key>
    <PropertyRef Name="ID" />
  </Key>

  <Property Name="ID" Type="Edm.Guid" Nullable="false" />
  <Property Name="firstName" Type="Edm.String" />
  <Property Name="lastName" Type="Edm.String" />

  <!-- Mark property as potentially sensitive -->
  <Property Name="ssn" Type="Edm.String">
    <Annotation Term="PersonalData.IsPotentiallySensitive" Bool="true" />
  </Property>

  <!-- Masking annotation (UI-side visual masking) -->
  <Property Name="bankAccount" Type="Edm.String">
    <Annotation Term="Common.Masked" Bool="true" />
  </Property>

  <!-- Stream/attachment property with AcceptableMediaTypes -->
  <Property Name="attachment" Type="Edm.Stream">
    <Annotation Term="Core.AcceptableMediaTypes">
      <Collection>
        <String>image/png</String>
        <String>application/pdf</String>
      </Collection>
    </Annotation>
  </Property>
</EntityType>
```

**STEP**: 3 — Use extensionAPI to remove sensitive data from outbound navigation context

**DESCRIPTION**: When implementing app extensions, use the SAP Fiori elements extensionAPI to adapt outbound navigation contexts and remove sensitive fields. This snippet shows a minimal extension function that strips specified properties from the context before navigation.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/extension/navigation/AdaptNavigationContext.js
// Example extension module that removes sensitive fields from navigation context

export default {
  // The actual hook name and signature depends on your Fiori elements version.
  // This pattern demonstrates receiving the navigation context and returning a modified copy.
  adaptNavigationContext: function (navigationContext) {
    // Make a shallow copy to avoid side effects
    const ctx = { ...navigationContext };

    // Remove known sensitive properties
    delete ctx.ssn;
    delete ctx.bankAccount;
    // Remove any other sensitive fields before navigation
    // delete ctx.<sensitiveProperty>;

    return ctx;
  }
};
```

**STEP**: 4 — Implement backend upload validation: MIME types, size limit, and virus-scan hooks (Node/Express example)

**DESCRIPTION**: The back end must enforce file size limits, allowed MIME types, and perform virus scanning. This Node/Express example uses multer for upload handling, applies a file size limit and MIME filter, and shows where to plug in a virus-scan step before persistence.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// srv/upload.js (Express-based handler)
const express = require('express');
const multer = require('multer');
const app = express();

// multer in-memory storage for scanning; adjust to disk storage as needed
const storage = multer.memoryStorage();
const upload = multer({
  storage,
  limits: { fileSize: 5 * 1024 * 1024 }, // 5 MB max
  fileFilter: (req, file, cb) => {
    const allowed = ['image/png', 'application/pdf'];
    if (allowed.includes(file.mimetype)) {
      cb(null, true);
    } else {
      cb(new Error('INVALID_FILE_TYPE'));
    }
  }
});

app.post('/upload', upload.single('file'), async (req, res) => {
  try {
    // req.file holds the uploaded file buffer
    const fileBuffer = req.file.buffer;
    const mimetype = req.file.mimetype;

    // -- PLUG IN VIRUS SCANNER HERE --
    // Example: await virusScanner.scanBuffer(fileBuffer);
    // If scanner reports infected, reject upload and return error.

    // After validation and scanning, persist to storage/back end
    // e.g., store in database, object store, or call CAP service to create entity

    res.status(201).send({ message: 'Upload accepted' });
  } catch (err) {
    // map errors to appropriate responses
    res.status(400).send({ error: err.message });
  }
});

module.exports = app;
```

**STEP**: 5 — UI-side: prevent copy/export actions for sensitive data (manifest-level guidance)

**DESCRIPTION**: Use annotations or component manifest settings to disable export or clipboard for views/tables that show sensitive columns. In general, mark the columns with PersonalData.IsPotentiallySensitive to have the framework suppress export/copy actions. Example below shows a table column annotation in CDS and refers to the table behavior.

**LANGUAGE**: CDS / Notes

**CODE**:
```cds
// CDS fragment: mark table column sensitive so Fiori elements disables export/copy
entity Orders {
  key ID         : UUID;
  orderNumber    : String;

  @PersonalData.IsPotentiallySensitive: true
  customerEmail  : String; // export/copy will be disabled by the framework for this column
}
```

**STEP**: 6 — References and related pages (file names for internal cross-reference)

**DESCRIPTION**: Keep these internal documentation pages in mind when implementing the behaviors above. They describe additional security-focused behaviors and UI controls referenced by the annotations.

**LANGUAGE**: Notes

**CODE**:
```text
Related documentation pages (for deeper behavior and configuration):
- enabling-stream-support-b236d32.md
- enabling-the-upload-functionality-d59dbec.md
- using-the-export-button-4bab6f2.md
- tables-c0f6592.md
- enabling-the-history-of-recently-entered-values-37dbf1f.md
- caching-the-last-executed-request-4215eca.md
- store-restore-the-application-state-46bf248.md
- creating-an-extension-to-modify-properties-in-the-navigation-context-199a496.md
- navigation-from-an-app-outbound-navigation-d782acf.md
- the-share-microsoft-teams-functionality-ff89e4b.md
- different-representations-of-a-field-c18ada4.md
```

--------------------------------

**TITLE**: Setting Authorizations for Overview Page Cards (requireAppAuthorization)

**INTRODUCTION**: Add runtime authorization checks to Overview Page (OVP) cards so cards are only displayed when the user is authorized to navigate to the target application. This is configured in manifest.json using the requireAppAuthorization property on each card. At runtime the Cross Application Navigation service (isIntentSupported) verifies the intent; if supported the card is shown.

**TAGS**: fiori-elements-framework, SAPUI5, ovp, cards, manifest.json, authorization, cross-application-navigation, requireAppAuthorization

**STEP**: 1 — Where to add requireAppAuthorization

**DESCRIPTION**: Edit the application's manifest.json and add requireAppAuthorization under the target card settings: manifest.json -> "sap.ovp" -> "cards" -> "<cardId>" -> "settings". The value is an intent string in the form "#SemanticObject-action" that corresponds to an inbound defined in the target application (the intent used for navigation).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card01": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.stack",
        "settings": {
          "title": "Stack Card Title",
          "subTitle": "Stack Card",
          "requireAppAuthorization": "#Action-toappnavsample",
          "entitySet": "SalesOrderSet"
        }
      }
    }
  }
}
```

**STEP**: 2 — Intent value and expectations

**DESCRIPTION**: Use a navigation intent that matches a target app inbound. Example syntax: "#SemanticObject-action". At runtime Fiori Launchpad's Cross Application Navigation service checks this intent with isIntentSupported; if the user is authorized for that intent the card is rendered, otherwise the card (or preview) is not shown. The check occurs only at runtime in the FLP shell.

**LANGUAGE**: plain

**CODE**:
```text
Intent syntax examples:
  "#Action-toappnavsample"
  "#PurchaseOrder-display"

Behavior:
  - FLP uses the Cross Application Navigation service (isIntentSupported) at runtime.
  - If isIntentSupported returns supported, the card is displayed.
  - If not supported, the card (or card preview) is hidden to avoid navigation errors.
```

**STEP**: 3 — Design-time and adaptation limitations (important)

**DESCRIPTION**: The requireAppAuthorization check is not executed during design time for overview page cards. Consequently:
  - The property will not be effective while editing the overview page in design time.
  - It does not work when creating UI adaptation projects or when extending via UI adaptation scenarios (e.g., creating extension projects from Business Application Studio or Visual Studio Code).

**LANGUAGE**: plain

**CODE**:
```text
Limitations:
  - requireAppAuthorization is evaluated only at runtime (FLP).
  - No effect in design time, adaptation projects, or UI adaptation extension workflows.
```
--------------------------------

**TITLE**: Setting Criticality for Action Buttons (UI.DataFieldForAction)

**INTRODUCTION**: Configure semantic (positive/negative) styling for action buttons by adding the Criticality annotation to UI.DataFieldForAction. Use these annotations for actions in table rows (inline), object page header, and object page footer. This guide provides ready-to-use XML, ABAP CDS, and CAP CDS examples and lists supported values and constraints.

**TAGS**: fiori-elements-framework, annotations, criticality, UI.DataFieldForAction, XML, ABAP CDS, CAP CDS, ODataV4

**STEP**: 1 — Overview and placement

**DESCRIPTION**: Add Criticality to action annotations of type UI.DataFieldForAction. Supported placements: inline table rows, object page header, object page footer. Criticality enables semantic button rendering (positive = green, negative = red). Use only for DataFieldForAction.

**LANGUAGE**: text

**CODE**:
```
- Annotation target: UI.DataFieldForAction
- Supported locations: Table rows (inline), Object Page Header, Object Page Footer
- Effect: Renders a semantic action button (Positive/Negative)
- Applies to: Bound or unbound actions referenced by the Action property
```

**STEP**: 2 — XML Annotation example (annotations file)

**DESCRIPTION**: Place this Record inside your annotations XML (e.g., webapp/annotations/annotations.xml or your dedicated annotations file). Use within UI.LineItem, UI.HeaderFacets, or other UI annotation containers where actions are defined. The example marks the action as Positive.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataFieldForAction">
        <PropertyValue Property="Determining" Bool="true"/>
        <PropertyValue Property="Label" String="Positive (Dummy)"/>
        <PropertyValue Property="Action" String="com.c_salesordermanage_sd_aggregate.DummyBoundAction"/>
        <PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Positive"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 3 — ABAP CDS annotation example

**DESCRIPTION**: Use this pattern inside an ABAP CDS view annotation block (attach to @UI.lineItem or @UI.fieldGroup). The dataAction should reference the action name (prefixed if required, e.g., PUSHDOWN:). This example declares a FOR_ACTION entry.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.lineItem: [
  {
    label       : 'Positive (Dummy)',
    dataAction  : 'PUSHDOWN:com.c_salesordermanage_sd_aggregate.DummyBoundAction',
    type        : #FOR_ACTION,
    // Criticality in ABAP CDS is represented by the action semantics:
    // use semantic annotations or UI.SemanticKey if supported, else handle via metadata exposure
  }
]
```

**STEP**: 4 — CAP (CAPS) CDS / UI annotation example

**DESCRIPTION**: For SAP CAP (service.cds) UI annotations (JSON-like) add a UI.DataFieldForAction object. Use Criticality as #Positive or #Negative. Place inside the view/entity annotations (e.g., annotations.cds or annotations.json for the service).

**LANGUAGE**: JSON (CAP CDS)

**CODE**:
```json
{
  "$Type": "UI.DataFieldForAction",
  "Determining": true,
  "Label": "Positive (Dummy)",
  "Action": "com.c_salesordermanage_sd_aggregate.DummyBoundAction",
  "Criticality": "#Positive"
}
```

**STEP**: 5 — Supported Criticality values and equivalents

**DESCRIPTION**: Two supported criticality states for actions. Use enum member form in XML, numeric values or enum tokens where applicable, and symbolic tokens for CAP.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "UI.CriticalityType/Positive": {
    "numericEquivalent": 3,
    "meaning": "Positive/Green (Completed / Available / On Track / Acceptable)",
    "xmlExample": "Criticality EnumMember='UI.CriticalityType/Positive'",
    "capExample": "Criticality: #Positive"
  },
  "UI.CriticalityType/Negative": {
    "numericEquivalent": 1,
    "meaning": "Negative/Red (Attention / Overload / Alert)",
    "xmlExample": "Criticality EnumMember='UI.CriticalityType/Negative'",
    "capExample": "Criticality: #Negative"
  }
}
```

**STEP**: 6 — Notes and constraints

**DESCRIPTION**: Important behavioral and compatibility notes to follow when using Criticality on actions.

**LANGUAGE**: text

**CODE**:
```
- Criticality is supported only for UI.DataFieldForAction.
- Emphasized buttons (e.g., SAVE, EDIT, APPLY) and semantic (critical) buttons cannot be used together on the same page: there is only one primary action.
- When an action is marked with Criticality, previously emphasized buttons on the page are no longer rendered emphasized.
- In SAP Fiori elements for OData V4, object page header allows a critical action only as the left-most action.
- Ensure the Action property points to a valid bound/unbound action exposed by your OData/CAP/ABAP service.
```
--------------------------------

**TITLE**: Set Default Column Widths for SAP Fiori Elements Tables

**INTRODUCTION**: Configure default column widths for table line items in SAP Fiori elements using the CSS annotation com.sap.vocabularies.HTML5.v1.CssDefaults, CAP CDS annotations, or manifest.json controlConfiguration/settings. Use these options to override automatic width calculation and to include column headers in width calculations.

**TAGS**: fiori-elements, sap, annotations, CssDefaults, manifest.json, CDS, XML, JSON, table, columns, UI.LineItem

**STEP**: 1 — Use CssDefaults in XML Annotations (UI.LineItem)

**DESCRIPTION**: Add the com.sap.vocabularies.HTML5.v1.CssDefaults annotation to a DataField or DataFieldWithIntentBasedNavigation entry in the UI.LineItem to set a fixed width (em, rem, or %). Example below shows two line item entries with explicit widths.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.LineItem">
    <Collection>
        <Record Type="UI.DataFieldWithIntentBasedNavigation">
            <PropertyValue Property="SemanticObject" String="EPMSalesOrder" />
            <PropertyValue Property="Action" String="display_sttabupa" />
            <PropertyValue Property="Value" Path="bp_id" />
            <Annotation Term="com.sap.vocabularies.HTML5.v1.CssDefaults">
                <Record>
                    <PropertyValue Property="width" String="10rem" />
                </Record>
            </Annotation>
        </Record>

        <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="currency_code" />
            <Annotation Term="com.sap.vocabularies.HTML5.v1.CssDefaults">
                <Record>
                    <PropertyValue Property="width" String="15rem" />
                </Record>
            </Annotation>
        </Record>
    </Collection>
</Annotation>
```

**STEP**: 2 — Use CssDefaults in CAP CDS (Core Data Services)

**DESCRIPTION**: In CAP CDS, annotate LineItem entries using the JSON-like CDS syntax to set width via the ![@HTML5.CssDefaults] shorthand. Use this inside your service or entity view definitions.

**LANGUAGE**: CDS

**CODE**:
```cds
LineItem : {
    {
        $Type : 'UI.DataFieldForIntentBasedNavigation',
        SemanticObject : 'EPMSalesOrder',
        Action : 'display_sttabupa',
        Value : 'bp_id',
        Label : 'IBN',
        ![@HTML5.CssDefaults] : { width : '10rem' }
    },
    {
        $Type : 'UI.DataField',
        Value : currency_code,
        ![@HTML5.CssDefaults] : { width : '15rem' }
    },
}
```

**STEP**: 3 — Configure Column Width in manifest.json (controlConfiguration)

**DESCRIPTION**: Set column width per column key using controlConfiguration in manifest.json. The column key format identifies the column (example: "DataField::SalesOrderItemCategory"). Width can be specified in em/rem/%.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "controlConfiguration": {
      "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
        "columns": {
          "DataField::SalesOrderItemCategory": {
            "width": "10em"
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Include Column Header in Width Calculation (manifest.json setting)

**DESCRIPTION**: Enable widthIncludingColumnHeader globally for table default calculation and override per-column under settings.columns by specifying widthIncludingColumnHeader: true. This causes the engine to include the column label when computing default widths.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": { },
  "sap.ui5": {
    "models": { },
    "settings": {
      "tableSettings": {
        "multiEdit": { "enabled": true },
        "widthIncludingColumnHeader": true
      },
      "columns": {
        "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation::bp_id": {
          "widthIncludingColumnHeader": true
        },
        "com.sap.vocabularies.UI.v1.DataField::gross_amount": {
          "widthIncludingColumnHeader": true
        }
      }
    }
  }
}
```

**STEP**: 5 — Default Width Algorithm, Limits, and Control Defaults

**DESCRIPTION**: Use these rules when deciding whether to set explicit widths or to rely on automatic calculation:
- The Fiori elements algorithm considers property type, label, referenced properties, text arrangement, maxLength (for String), and Precision (for numeric types).
- Recommended to supply accurate maxLength/Precision to improve automatic results.
- Global lower limit: 3 rem; upper limit: 20 rem.
- Allowed units: em, rem, or % (relative to table width).
- On mobile devices: columns are adjusted automatically to occupy available width.

Default widths for columns that contain specific UI controls:
- Images: 5 rem
- Rating indicator: 6.875 rem
- Progress indicator: 6.875 rem
- Charts: 20 rem

**LANGUAGE**: text

**CODE**:
```text
Rules:
- Provide accurate maxLength (String) or Precision (numeric) in metadata to improve auto-width.
- Min width = 3rem, Max width = 20rem.
- Units supported: em, rem, %.

Control default widths:
- Images: 5rem
- Rating indicator: 6.875rem
- Progress indicator: 6.875rem
- Charts: 20rem

Mobile behavior:
- Table columns auto-adjust on mobile to fill available width.
```

**STEP**: 6 — Column Key and Reference Notes

**DESCRIPTION**: Use the correct column key to target a column in manifest.json controlConfiguration or settings.columns. The key format is typically:
- For LineItem DataField entries: "DataField::<PropertyName>"
- For DataFieldWithIntentBasedNavigation: "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation::<property>" or similar fully qualified form depending on your metadata. See your service metadata or the guideline "Finding the Right Key for the Anchor" to locate the exact key.

**LANGUAGE**: text

**CODE**:
```text
Example column key formats:
- "DataField::SalesOrderItemCategory"
- "com.sap.vocabularies.UI.v1.DataField::gross_amount"
- "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation::bp_id"

Tip:
- Inspect the generated UI metadata or use the linked guide "Finding the Right Key for the Anchor" to determine the exact key used by your app.
```
--------------------------------

**TITLE**: Configure Table Header Text and Visibility in manifest.json (SAP Fiori Elements)

**INTRODUCTION**: Instructions and code examples to set the table header text and control its visibility for Fiori Elements tables via the manifest.json controlConfiguration settings. Use these settings per target (List Report, Object Page) and per table annotation path.

**TAGS**: fiori-elements, manifest.json, table-settings, header, headerVisible, controlConfiguration, LineItem, ObjectPage, ListReport

**STEP**: 1 — Where to place the settings

**DESCRIPTION**: Add table header configuration under sap.ui5.routing.targets.<TargetName>.options.settings.controlConfiguration.<AnnotationPath>.tableSettings in manifest.json. The common annotation path keys are:
- "@com.sap.vocabularies.UI.v1.LineItem" (for the main list table)
- "_<NavigationProperty>/@com.sap.vocabularies.UI.v1.LineItem" (for related tables on an object page)

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "<TargetName>": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "<AnnotationPath>": {
                  "tableSettings": {
                    "header": "<Header Text>",
                    "headerVisible": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Set the table header text

**DESCRIPTION**: Provide a string value for "header" inside tableSettings to change the header text displayed above the table.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "header": "Another header",
                    "headerVisible": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Hide the table header

**DESCRIPTION**: Set "headerVisible": false inside tableSettings to hide the header text for that specific table.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "headerVisible": false
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Configure multiple tables (Object Page example)

**DESCRIPTION**: Apply different header text and visibility per related table on an Object Page using their annotation paths (navigation property + LineItem). Example shows one related table with custom header visible and another table with header hidden.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "_Partner/@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "header": "Another header for the Partners",
                    "headerVisible": true
                  }
                },
                "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "headerVisible": false
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Key notes and best practices

**DESCRIPTION**: Actionable reminders:
- Use the exact annotation path key syntax as shown: either "@com.sap.vocabularies.UI.v1.LineItem" or "_<NavigationProperty>/@com.sap.vocabularies.UI.v1.LineItem".
- header accepts a string literal displayed in UI; headerVisible is boolean.
- These settings are per-target; ensure you place them under the correct routing target (List Report vs Object Page).
--------------------------------

**TITLE**: Configure Table Types for Fiori Elements List Report and Object Page

**INTRODUCTION**: Action-oriented reference for setting and annotating table types (ResponsiveTable, GridTable, AnalyticalTable, TreeTable) in manifest.json and via OData annotations for SAP Fiori Elements (OData V2 and V4). Includes examples for list report and object page, annotation samples for enabling analytical capabilities, grouping and aggregation, tree table activation, row count configuration, and important behavioral restrictions.

**TAGS**: fiori-elements-framework, manifest.json, tableSettings, tableTypes, analytical-table, tree-table, grid-table, responsive-table, object-page, list-report, OData-v2, OData-v4, annotations

STEP: Set table type in manifest.json for List Report (OData V2)
DESCRIPTION: Add or change tableSettings.type under sap.ui.generic.app -> pages -> component.settings to choose the rendered table (ResponsiveTable, GridTable, AnalyticalTable, TreeTable) for a List Report. If AnalyticalTable is specified, ensure backend analytical capabilities (sap:semantics=aggregate) or fallback occurs.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Zfarvd_Bs_Hd_Bo",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "tableSettings": {
              "type": "GridTable",
              "personalization": true
            }
          }
        }
      }
    ]
  }
}
```

STEP: Set table type in manifest.json for Object Page (OData V2)
DESCRIPTION: Define tableSettings at the object page level or per section. Section-level tableSettings takes precedence over object-page-level settings.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": [
          {
            "entitySet": "STTA_C_MP_Product",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "sections": {
                  "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
                    "navigationProperty": "to_ProductText",
                    "entitySet": "STTA_C_MP_ProductText",
                    "tableSettings": {
                      "type": "TreeTable",
                      "personalization": true,
                      "hierarchyQualifier": "ProductTextHierarchy"
                    }
                  }
                }
              }
            }
          }
        ]
      }
    ]
  }
}
```

STEP: Backward compatibility: tableTypes vs tableSettings and section override
DESCRIPTION: tableTypes is supported for backward compatibility but prefer tableSettings. A section-level tableSettings overrides page-level tableSettings.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "showRelatedApps": true,
            "tableSettings": {
              "type": "ResponsiveTable"
            },
            "sections": {
              "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
                "navigationProperty": "to_ProductText",
                "entitySet": "STTA_C_MP_ProductText",
                "tableSettings": {
                  "type": "GridTable"
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: Table type selection logic (OData V2)
DESCRIPTION: Summarize default and fallback behavior used to determine table type on list reports/ALPs in OData V2.
LANGUAGE: text
CODE:
```
- If manifest tableSettings.type == "AnalyticalTable" but entitySet lacks analytical capabilities -> fallback to GridTable.
- If manifest type is not specified:
  - Smartphone/Tablet -> ResponsiveTable.
  - Desktop -> Aggregate-based service -> AnalyticalTable; Non-aggregate service -> ResponsiveTable.
- If sap:semantics == "aggregate" on backend and manifest.type not set -> AnalyticalTable is rendered.
```

STEP: Set table type under sap.ui5 routing targets (OData V4)
DESCRIPTION: For Fiori Elements (sap.fe) apps (OData V4), configure controlConfiguration -> @com.sap.vocabularies.UI.v1.LineItem -> tableSettings in the target options (sap.ui5.routing.targets) to choose the table type.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "type": "Component",
          "id": "SalesOrderManageList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "type": "ResponsiveTable",
                    "personalization": true
                  }
                }
              }
            }
          }
        },
        "SalesOrderManageObjectPage": {
          "type": "Component",
          "id": "SalesOrderManageObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "controlConfiguration": {
                "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "type": "GridTable",
                    "personalization": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Annotate an entity set as analytical (Aggregation.ApplySupported)
DESCRIPTION: Mark an entity set as supporting aggregation so AnalyticalTable is allowed/rendered. Provide XML and CAP CDS forms.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="sap.fe.managepartners.ManagePartnersService.Customers">
  <Annotation Term="Aggregation.ApplySupported"/>
</Annotations>
```

LANGUAGE: CDS
CODE:
```cds
// at root level of your entity definition in CDS
@Aggregation.ApplySupported : {}
entity Customers {
  key ID : UUID;
  // ...
}
```

STEP: Define GroupableProperties for AnalyticalTable
DESCRIPTION: Annotate which properties are groupable (required for grouping in AnalyticalTable). Provide XML and CAP CDS examples.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="sap.fe.managepartners.ManagePartnersService.Customers">
  <Annotation Term="Aggregation.ApplySupported">
    <PropertyValue Property="GroupableProperties">
      <Collection>
        <PropertyPath>Segment</PropertyPath>
        <PropertyPath>Country</PropertyPath>
      </Collection>
    </PropertyValue>
  </Annotation>
</Annotations>
```

LANGUAGE: CDS
CODE:
```cds
@Aggregation.ApplySupported : {
  GroupableProperties: [ Segment, Country ]
}
entity Customers {
  key ID : UUID;
  Segment : String;
  Country : String;
}
```

STEP: Define Aggregatable (Measure) Properties and CustomAggregate
DESCRIPTION: Annotate measure properties and register Aggregation.CustomAggregate at entity-container level. Provide XML and CAP CDS.
LANGUAGE: XML
CODE:
```xml
<!-- Property-level annotations -->
<Annotations Target="sap.fe.managepartners.ManagePartnersService.BusinessPartners/SalesAmount">
  <Annotation Term="Aggregation.default" EnumMember="Aggregation.defaultType/SUM"/>
  <Annotation Term="Analytics.Measure" Bool="true"/>
</Annotations>

<!-- Entity container-level CustomAggregate with qualifier "SalesAmount" -->
<Annotations Target="sap.fe.managepartners.ManagePartnersService.EntityContainer">
  <Annotation Term="Aggregation.CustomAggregate" Qualifier="SalesAmount" String="Edm.Decimal"/>
</Annotations>
```

LANGUAGE: CDS
CODE:
```cds
// Property-level
SalesAmount @Analytics.Measure : true @Aggregation.default : #SUM;

// Entity-level CustomAggregate qualifier
@Aggregation.CustomAggregate #SalesAmount : 'Edm.Decimal'
entity BusinessPartners {
  key ID : UUID;
  SalesAmount : Decimal;
}
```

STEP: Enable/Disable Search and other Transformations (Aggregation.ApplySupported.Transformations)
DESCRIPTION: Use Transformations list under Aggregation.ApplySupported to enable/disable 'search' and other transformations for AnalyticalTable & charts. Provide XML and CAP CDS examples.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="sap.fe.managepartners.ManagePartnersService.Customers">
  <Annotation Term="Aggregation.ApplySupported">
    <Record Type="Aggregation.ApplySupportedType">
      <PropertyValue Property="Transformations">
        <Collection>
          <String>search</String>
          <String>topcount</String>
          <String>bottomcount</String>
          <String>identity</String>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CDS
CODE:
```cds
@Aggregation.ApplySupported : {
  Transformations : [
    'search',
    'topcount',
    'bottomcount',
    'identity'
  ]
}
entity Customers { key ID : UUID; }
```

STEP: Configure aggregationOnLeafLevel in manifest.json
DESCRIPTION: When using AnalyticalTable, set analyticalConfiguration.aggregationOnLeafLevel to true to compute aggregation only on visible columns; note navigation/bound actions disabled if key properties are hidden.
LANGUAGE: JSON
CODE:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "type": "AnalyticalTable",
        "analyticalConfiguration": {
          "aggregationOnLeafLevel": true
        },
        "personalization": true
      }
    }
  }
}
```

STEP: Activate TreeTable with hierarchyQualifier
DESCRIPTION: Enable TreeTable and specify hierarchyQualifier (hierarchy defined in backend). TreeTable is supported only for ABAP RAP services.
LANGUAGE: JSON
CODE:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "type": "TreeTable",
        "hierarchyQualifier": "SalesOrgHierarchy",
        "personalization": true
      }
    }
  }
}
```

STEP: Configure visible row count and mode (rowCount, rowCountMode)
DESCRIPTION: Set rowCount and rowCountMode in tableSettings to control number of visible rows. rowCountMode values: Fixed, Auto, Interactive. Note: rowCountMode doesn't apply to ResponsiveTable; default behavior depends on section layout and table control.
LANGUAGE: JSON
CODE:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "type": "GridTable",
        "rowCount": 10,
        "rowCountMode": "Fixed",
        "personalization": true
      }
    }
  }
}
```

STEP: Important notes, restrictions, and behavioral details
DESCRIPTION: Concise list of restrictions and behaviors to apply in code/configuration and during validation/testing.
LANGUAGE: text
CODE:
```
- OData V2: If manifest.type == AnalyticalTable but entitySet lacks analytical capabilities -> GridTable fallback.
- OData V4: If manifest.type == AnalyticalTable but entitySet lacks analytical capabilities -> empty table.
- Analytical tables only display properties annotated as groupable or aggregatable; otherwise properties are not requested and show no values.
- Analytical tables do not support navigation properties (they render empty columns if included); navigation properties cannot be added via personalization.
- Analytical table + draft-enabled service: only active entities displayed; Editing Status filter removed; draft indicator shown; creation requires save/discard. AnalyticalTable cannot be used in List Report with flexible column layout for draft-enabled service.
- If aggregationOnLeafLevel = true and key properties are not visible, navigation and bound actions are disabled (unless key props added via table settings). Overriding rowPress does not remove navigation indicator.
- TreeTable support: ABAP RAP only.
- Transformation filters: Ensure backend supports transformation filters for aggregate controls and add appropriate Transformation annotations (e.g., 'filter').
- For grid table design guidelines and constraints, refer to: https://experience.sap.com/fiori-design-web/grid-table/
```
--------------------------------

**TITLE**: Setting Units of Measure for Numeric Properties (OData metadata, XML annotations, CAP CDS)

**INTRODUCTION**: Show how to expose and annotate unit-of-measure and currency information so UI (Fiori Elements) displays units next to numeric values. Includes: adding sap:unit/sap:semantics in the OData metadata (EDMX), adding Org.OData.Measures.V1 annotations in an annotation XML, and annotating in CAP CDS.

**TAGS**: fiori-elements-framework, OData, EDMX, annotations, Org.OData.Measures.V1, unit-of-measure, ISOCurrency, CDS, XML, sap:unit, metadata

**STEP**: 1 — Add sap:unit and sap:semantics in the OData metadata (EDMX)

**DESCRIPTION**: Edit your OData service metadata (EDMX) file—typically the $metadata document—to add sap:unit attributes on numeric properties that should display a unit. Use sap:semantics="unit-of-measure" for the unit property and sap:semantics="currency-code" for currency code properties. The numeric property receives sap:unit="<UnitPropertyName>".

**LANGUAGE**: XML

**CODE**:
```xml
<EntityType Name="Product" sap:content-version="1">
    <Key>
        <PropertyRef Name="ProductID"/>
    </Key>
    <Property Name="ProductID" Type="Edm.String" Nullable="false" MaxLength="10" sap:label="Product ID" sap:updatable="false"/>
    <Property Name="TypeCode" Type="Edm.String" MaxLength="2" sap:label="Prod. Type Code"/>
    <Property Name="Category" Type="Edm.String" MaxLength="40" sap:label="Prod. Cat."/>
    <Property Name="Name" Type="Edm.String" MaxLength="255" sap:label="Product Name" sap:sortable="false" sap:filterable="false"/>
    <Property Name="NameLanguage" Type="Edm.String" MaxLength="1" sap:label="Language" sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false"/>
    <Property Name="Description" Type="Edm.String" MaxLength="255" sap:label="Prod.Descrip." sap:sortable="false" sap:filterable="false"/>
    <Property Name="DescriptionLanguage" Type="Edm.String" MaxLength="1" sap:label="Language" sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false"/>
    <Property Name="SupplierID" Type="Edm.String" MaxLength="10" sap:label="Bus. Part. ID"/>
    <Property Name="SupplierName" Type="Edm.String" MaxLength="80" sap:label="Company Name" sap:creatable="false" sap:updatable="false"/>
    <Property Name="TaxTarifCode" Type="Edm.Byte" sap:label="Prod. Tax Code"/>
    <Property Name="MeasureUnit" Type="Edm.String" MaxLength="3" sap:label="Qty. Unit" sap:semantics="unit-of-measure"/>
    <Property Name="WeightMeasure" Type="Edm.Decimal" Precision="13" Scale="3" sap:unit="WeightUnit" sap:label="Wt. Measure"/>
    <Property Name="WeightUnit" Type="Edm.String" MaxLength="3" sap:label="Qty. Unit" sap:semantics="unit-of-measure"/>
    <Property Name="CurrencyCode" Type="Edm.String" MaxLength="5" sap:label="Currency" sap:semantics="currency-code"/>
    <Property Name="Price" Type="Edm.Decimal" Precision="16" Scale="3" sap:unit="CurrencyCode" sap:label="Unit Price"/>
    <Property Name="Width" Type="Edm.Decimal" Precision="13" Scale="3" sap:unit="DimUnit" sap:label="Dimensions"/>
    <Property Name="Depth" Type="Edm.Decimal" Precision="13" Scale="3" sap:unit="DimUnit" sap:label="Dimensions"/>
    <Property Name="Height" Type="Edm.Decimal" Precision="13" Scale="3" sap:unit="DimUnit" sap:label="Dimensions"/>
    <Property Name="DimUnit" Type="Edm.String" MaxLength="3" sap:label="Dim. Unit" sap:semantics="unit-of-measure"/>
    <Property Name="CreatedAt" Type="Edm.DateTime" Precision="7" sap:label="Time Stamp" sap:creatable="false" sap:updatable="false"/>
    <Property Name="ChangedAt" Type="Edm.DateTime" Precision="7" ConcurrencyMode="Fixed" sap:label="Time Stamp" sap:creatable="false" sap:updatable="false"/>
    <NavigationProperty Name="ToSalesOrderLineItems" Relationship="GWSAMPLE_BASIC.Assoc_Product_SalesOrderLineItems" FromRole="FromRole_Assoc_Product_SalesOrderLineItems" ToRole="ToRole_Assoc_Product_SalesOrderLineItems"/>
    <NavigationProperty Name="ToSupplier" Relationship="GWSAMPLE_BASIC.Assoc_BusinessPartner_Products" FromRole="ToRole_Assoc_BusinessPartner_Products" ToRole="FromRole_Assoc_BusinessPartner_Products"/>
</EntityType>
```

**STEP**: 2 — Add Org.OData.Measures.V1 annotations in an annotation XML document

**DESCRIPTION**: If you prefer or require annotation documents, add Org.OData.Measures.V1.Unit or Org.OData.Measures.V1.ISOCurrency annotations. Place these <Annotations> blocks in your annotation XML file (e.g., annotations.xml) targeting specific entity properties.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="GWSAMPLE_BASIC.Product/WeightMeasure">
    <Annotation Term="Org.OData.Measures.V1.Unit" Path="WeightUnit"/>
</Annotations>
<Annotations Target="GWSAMPLE_BASIC.Product/Width">
    <Annotation Term="Org.OData.Measures.V1.Unit" Path="DimUnit"/>
</Annotations>
<Annotations Target="GWSAMPLE_BASIC.Product/Depth">
    <Annotation Term="Org.OData.Measures.V1.Unit" Path="DimUnit"/>
</Annotations>
<Annotations Target="GWSAMPLE_BASIC.Product/Height">
    <Annotation Term="Org.OData.Measures.V1.Unit" Path="DimUnit"/>
</Annotations>
<Annotations Target="GWSAMPLE_BASIC.Product/Price">
    <Annotation Term="Org.OData.Measures.V1.ISOCurrency" Path="CurrencyCode"/>
</Annotations>
```

**STEP**: 3 — Annotate units and currencies in CAP CDS

**DESCRIPTION**: In CAP (Core Data Services) model/annotation files (.cds), annotate the entity properties using @Measures.Unit and @Measures.ISOCurrency. This adds the equivalent metadata so generated OData/annotation files include unit/currency semantics.

**LANGUAGE**: CDS

**CODE**:
```cds
annotate GWSAMPLE_BASIC.Product with {
  @Measures.Unit : WeightUnit
  WeightMeasure
};

annotate GWSAMPLE_BASIC.Product with {
  @Measures.Unit : DimUnit
  Width
};

annotate GWSAMPLE_BASIC.Product with {
  @Measures.Unit : DimUnit
  Depth
};

annotate GWSAMPLE_BASIC.Product with {
  @Measures.Unit : DimUnit
  Height
};

annotate GWSAMPLE_BASIC.Product with {
  @Measures.ISOCurrency : CurrencyCode
  Price
};
```
--------------------------------

**TITLE**: Object Page Header Setup (UI.HeaderInfo) — XML / ABAP CDS / CAP CDS Examples

**INTRODUCTION**: This document shows how to define the Object Page header for Fiori Elements apps using the UI.HeaderInfo annotation. It lists the exact vocabulary mappings you need and provides ready-to-use examples for three contexts: OData XML annotations, ABAP CDS, and CAP CDS. Use these snippets to display title, subtitle/description, image, type name and icons/initials on the Object Page header.

**TAGS**: fiori-elements-framework, annotations, object-page, UI.HeaderInfo, HeaderInfo, XML, CDS, ABAP, CAP, UI

STEP: HeaderInfo vocabulary mapping and behavior

DESCRIPTION: Use these vocabulary terms to populate the object page header. Implement one of the code patterns below depending on your stack (XML annotations, ABAP CDS, CAP CDS). Notes:
- Title: com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value → object title field or DataField expression.
- Description: com.sap.vocabularies.UI.v1.HeaderInfo/Description/Value → subtitle.
- Image: com.sap.vocabularies.UI.v1.HeaderInfo/ImageUrl → image URL property (relative or absolute).
- TypeName / TypeNamePlural: com.sap.vocabularies.UI.v1.HeaderInfo/TypeName, TypeNamePlural → text used for the back navigation link and plural label.
- TypeImageUrl: com.sap.vocabularies.UI.v1.HeaderInfo/TypeImageUrl → icon for the type.
- Initials: com.sap.vocabularies.UI.v1.HeaderInfo/Initials → initials to show when no image.
- The object page supports the dynamic header (see framework docs if you need runtime variant/disambiguation).

LANGUAGE: None

CODE:
```text
Vocabulary mappings (use exactly these semantics in your annotations):

- Title:       UI.HeaderInfo -> PropertyValue Property="Title" -> Record Type="UI.DataField" -> PropertyValue Property="Value" Path="<titleProperty>"
- Description: UI.HeaderInfo -> PropertyValue Property="Description" -> Record Type="UI.DataField" -> PropertyValue Property="Value" Path="<subtitleProperty>"
- ImageUrl:    UI.HeaderInfo -> PropertyValue Property="ImageUrl" Path="<imageUrlProperty>"
- TypeName:    UI.HeaderInfo -> PropertyValue Property="TypeName" String="<TypeNameText>"
- TypeNamePlural: UI.HeaderInfo -> PropertyValue Property="TypeNamePlural" String="<TypeNamePluralText>"
- TypeImageUrl / Initials: use corresponding HeaderInfo properties to set icons/initials
```

STEP: XML Annotation example (OData metadata annotation file)

DESCRIPTION: Add this XML snippet to your annotation file that is either embedded in the OData service metadata or provided as a separate annotations XML file referenced by the Fiori Elements app (e.g., webapp/annotations/<name>.xml). Ensure your manifest.json references the annotation file (Fiori Elements reads annotations from the service metadata and/or annotation files referenced in the app).

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/annotations/objectPageHeader.xml (or embed in service metadata) -->
<Annotations Target="YourService.YourEntityType">
    <Annotation Term="UI.HeaderInfo">
        <Record Type="UI.HeaderInfoType">
            <PropertyValue Property="Description">
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SalesOrderTypeName"/>
                </Record>
            </PropertyValue>
            <PropertyValue Property="ImageUrl" Path="ImageUrl"/>
            <PropertyValue Property="Title">
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SalesOrder"/>
                </Record>
            </PropertyValue>
            <PropertyValue Property="TypeName" String="Sales Order"/>
            <PropertyValue Property="TypeNamePlural" String="Sales Orders"/>
            <!-- Optional: <PropertyValue Property="TypeImageUrl" Path="TypeImageUrl"/> -->
            <!-- Optional: <PropertyValue Property="Initials" Path="Initials"/> -->
        </Record>
    </Annotation>
</Annotations>
```

STEP: ABAP CDS Annotation example

DESCRIPTION: Add the following @UI.headerInfo annotation to the ABAP CDS view DDL source (in ADT). Replace field names with your CDS elements. Activate the CDS view so the runtime metadata exposes the header info.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.headerInfo: {
  typeName: 'Product',
  typeNamePlural: 'Products',
  imageUrl: 'PRODUCTPICTUREURL',
  title: {
    value: '_PRODUCTTEXTINCURRENTLANG.NAME',
    type: #STANDARD
  },
  description: {
    value: 'PRODUCT',
    type: #STANDARD
  }
}
annotate view STTA_C_MP_PRODUCT with {
  // If additional UI annotations needed, add them here
}
```

STEP: CAP CDS Annotation example

DESCRIPTION: Create a UI annotations CDS file in your CAP project (e.g., app/annotations.cds or annotations/<service>.cds). Register/load it per your CAP project conventions. Use UI.HeaderInfo block to set header values for the target entity.

LANGUAGE: CDS

CODE:
```cds
// File: app/annotations.cds (or annotations/<service>.cds)
using { UI } from '@sap/cds/common';

annotate <namespace>.<EntityName> with {
  @UI.HeaderInfo : {
      TypeName : 'Product',
      TypeNamePlural : 'Products',
      ImageUrl : ProductPictureURL,
      Title : {
          $Type : 'UI.DataField',
          Value : to_ProductTextInCurrentLang.Name
      },
      Description : {
          $Type : 'UI.DataField',
          Value : Product
      }
  }
}
```

STEP: Additional notes and next steps

DESCRIPTION: Use the following follow-up docs and features as needed:
- For image, initials, and icon display rules, consult "Using Images, Initials, and Icons".
- To show a custom status or add header extension points (facets), consult "Extension Points for Object Page Header Facets".
- For dynamic header behavior, consult the Object Page Header documentation in the framework.

LANGUAGE: None

CODE:
```text
References:
- Using Images, Initials, and Icons: using-images-initials-and-icons-5760b63.md
- Object Page Header details: ../10_More_About_Controls/object-page-header-6e340c1.md
- Extension Points for Object Page Header Facets: extension-points-for-object-page-header-facets-61cf0ee.md
```
--------------------------------

**TITLE**: Settings for List Report Tables (Draft & Editing Status, Table Type)

**INTRODUCTION**: This document describes how to configure draft/editing status display and table type for List Report tables in SAP Fiori Elements. It includes concrete annotation examples (OData V2 and CDS) and a manifest.json snippet to select responsive vs. grid table rendering. Use these snippets directly in annotation files or CDS sources and in webapp/manifest.json.

**TAGS**: fiori-elements-framework, annotations, list-report, editing-status, draft, manifest.json, OData V2, CDS, table-type

**STEP**: 1 — Add Draft & Semantic Key Annotations (OData V2 XML)

**DESCRIPTION**: Add SemanticKey on the EntityType and UI.HeaderInfo / UI.LineItem annotations to ensure the editing status (Draft / Unsaved Changes by Another User / Locked by Another User) is displayed correctly. In responsive tables the status is shown in the key column; in grid tables it is shown in a dedicated column next to the key column. This XML example shows a typical OData V2 annotations file with SemanticKey, HeaderInfo (Title), and LineItem including the semantic key field.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: annotations.xml (OData V2 annotations) -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="1.0">
  <edmx:DataServices>
    <Schema xmlns="http://docs.oasis-open.org/odata/ns/edm" Namespace="MyService">
      <!-- EntityType with SemanticKey -->
      <EntityType Name="SalesOrder">
        <Key>
          <PropertyRef Name="SalesOrderID" />
        </Key>
        <Property Name="SalesOrderID" Type="Edm.String" Nullable="false" />
        <Property Name="CustomerName" Type="Edm.String" />
        <Property Name="Description" Type="Edm.String" />
      </EntityType>

      <!-- SemanticKey annotation -->
      <Annotations Target="MyService.SalesOrder">
        <Annotation Term="com.sap.vocabularies.Common.v1.SemanticKey">
          <Collection>
            <PropertyPath>SalesOrderID</PropertyPath>
          </Collection>
        </Annotation>

        <!-- UI HeaderInfo: Title used as fallback for editing status placement -->
        <Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo">
          <Record>
            <PropertyValue Property="Title">
              <Record Type="com.sap.vocabularies.UI.v1.DataField">
                <PropertyValue Property="Value">
                  <Path>SalesOrderID</Path>
                </PropertyValue>
              </Record>
            </PropertyValue>
          </Record>
        </Annotation>

        <!-- UI LineItem: list columns, include semantic key field as first column -->
        <Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
          <Collection>
            <!-- First column: semantic key field -->
            <Record Type="com.sap.vocabularies.UI.v1.DataField">
              <PropertyValue Property="Label" String="Order ID"/>
              <PropertyValue Property="Value">
                <Path>SalesOrderID</Path>
              </PropertyValue>
            </Record>
            <!-- Additional columns -->
            <Record Type="com.sap.vocabularies.UI.v1.DataField">
              <PropertyValue Property="Label" String="Customer"/>
              <PropertyValue Property="Value">
                <Path>CustomerName</Path>
              </PropertyValue>
            </Record>
            <Record Type="com.sap.vocabularies.UI.v1.DataField">
              <PropertyValue Property="Label" String="Description"/>
              <PropertyValue Property="Value">
                <Path>Description</Path>
              </PropertyValue>
            </Record>
          </Collection>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 2 — Fallback behavior for OData V2 (Title / Description)

**DESCRIPTION**: If no semantic key is present in the LineItem annotation, the runtime checks UI.HeaderInfo Title Value Path (or the first available Title/Description path) to decide where to display the draft/editing status. Below is an XML example where no semantic key column is present in LineItem; the Title path is used as fallback.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: no semantic key included in LineItem -> HeaderInfo/Title used -->
<Annotations Target="MyService.SalesOrder">
  <!-- HeaderInfo Title present -->
  <Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo">
    <Record>
      <PropertyValue Property="Title">
        <Record Type="com.sap.vocabularies.UI.v1.DataField">
          <PropertyValue Property="Value">
            <Path>CustomerName</Path>
          </PropertyValue>
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>

  <!-- LineItem does NOT include SalesOrderID, so Title (CustomerName) is used for status -->
  <Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
    <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Label" String="Customer"/>
        <PropertyValue Property="Value"><Path>CustomerName</Path></PropertyValue>
      </Record>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Label" String="Description"/>
        <PropertyValue Property="Value"><Path>Description</Path></PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 3 — CDS Annotations Equivalent (Core Data Services)

**DESCRIPTION**: If using CDS, add @Common.SemanticKey and UI annotations for LineItem and HeaderInfo. The following CDS snippet shows equivalent annotation usage to ensure editing status is linked to the semantic key or header title.

**LANGUAGE**: CDS

**CODE**:
```cds
// File: srv/cds/sales-order.cds
using { cuid } from '@sap/cds/common';

entity SalesOrder {
  key SalesOrderID : String(36);
  CustomerName       : String;
  Description        : String;
}

annotate SalesOrder with {
  @Common.SemanticKey : ['SalesOrderID']
  SalesOrderID;

  @UI.headerInfo: {
    title: { value: SalesOrderID }
  }

  @UI.lineItem: [
    { label: 'Order ID', value: SalesOrderID },
    { label: 'Customer', value: CustomerName },
    { label: 'Description', value: Description }
  ]
}
```

**STEP**: 4 — Select Table Type in manifest.json (webapp/manifest.json)

**DESCRIPTION**: Configure the List Report table rendering (ResponsiveTable vs GridTable) in the application manifest. The tableType setting determines whether the editing status appears in the key column (ResponsiveTable) or in a dedicated column (GridTable). Place this snippet under webapp/manifest.json within the sap.ui.generic.app pages configuration for the ListReport component.

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (snippet)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrder",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": {
            "tableType": "ResponsiveTable" // use "GridTable" to render a grid table with separate status column
          }
        }
      }
    ]
  }
}
```

**STEP**: 5 — Summary of Runtime Rules (Quick Reference)

**DESCRIPTION**: Summary of how the runtime decides where to display editing status:
- If LineItem contains a semantic key column: show draft status in that column (responsive) or in a separate status column (grid).
- If no semantic key column in LineItem but entity has a SemanticKey and it appears in the table: draft shown in the first semantic key column.
- If no semantic key annotation is available or no semantic key column used: runtime checks UI.HeaderInfo/Title/Value/Path and uses Title or Description column as fallback.

**LANGUAGE**: JSON

**CODE**:
```json
// Quick reference (no runtime config required)
// 1. Prefer LineItem semantic key column
// 2. Else if entity SemanticKey present and included in table -> use first semantic key column
// 3. Else use HeaderInfo.Title.Value.Path as fallback
{}
```
--------------------------------

**TITLE**: Object Page Table Settings in manifest.json (Fiori Elements)

**INTRODUCTION**: Quick-reference, code-focused patterns to configure object page tables via manifest.json for Fiori Elements apps. Includes manifest path, typical keys, and concrete JSON examples for common table types (Responsive, Analytical, Grid, Tree), personalization (p13n), inline creation/deletion, and presentation variants. Replace placeholders (EntitySet, section IDs) with your app-specific values.

**TAGS**: fiori-elements-framework, manifest.json, object-page, table, sapui5, ObjectPage

**STEP**: 1 — Manifest location and page key pattern

**DESCRIPTION**: Use the manifest.json at the app root. The Object Page entry is typically keyed by "ObjectPage|<EntitySet>" within "sap.ui.generic.app.pages" (or as an array entry depending on your Fiori Elements version). Put table settings under component.settings -> sections -> <SectionID> -> table.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|SalesOrder": {
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "entitySet": "SalesOrder",
            "sections": {
              "SalesOrderItems": {
                "table": {
                  "id": "to_SalesOrderItems",
                  "type": "ResponsiveTable",
                  "multiSelect": true,
                  "selectionMode": "Multi",
                  "inlineDelete": false,
                  "showRowCount": true
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Responsive Table (sap.m.Table) example

**DESCRIPTION**: Configure a responsive table on an object page: selection mode, multi-selection, inline delete, and personalization (p13nMode).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|SalesOrder": {
        "component": {
          "settings": {
            "sections": {
              "LineItems": {
                "table": {
                  "id": "LineItems::Responsive",
                  "type": "ResponsiveTable",
                  "multiSelect": true,
                  "selectionMode": "MultiToggle",
                  "inlineDelete": true,
                  "showRowCount": true,
                  "p13nMode": ["Column", "Filter", "Sort", "Resize"]
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Analytical Table example

**DESCRIPTION**: Configure an AnalyticalTable (sap.ui.table.AnalyticalTable) for large datasets and analytics features (condensed layout, grouping, export).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|PurchaseOrder": {
        "component": {
          "settings": {
            "sections": {
              "Analytics": {
                "table": {
                  "id": "PO_Analytical",
                  "type": "AnalyticalTable",
                  "condensedTableLayout": true,
                  "enableExport": true,
                  "selectionMode": "Multi",
                  "p13nMode": ["Column", "Sort", "Filter"]
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — GridTable and TreeTable examples

**DESCRIPTION**: Examples for GridTable (sap.ui.table.Table) and TreeTable. Use these when you need fixed columns or hierarchical data.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|Inventory": {
        "component": {
          "settings": {
            "sections": {
              "StockGrid": {
                "table": {
                  "id": "Stock_Grid",
                  "type": "GridTable",
                  "selectionMode": "Single",
                  "showRowCount": false,
                  "p13nMode": ["Column", "Sort"]
                }
              },
              "BillOfMaterials": {
                "table": {
                  "id": "BOM_Tree",
                  "type": "TreeTable",
                  "selectionMode": "Multi",
                  "inlineDelete": false,
                  "p13nMode": ["Column"]
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Creation settings (inline and dialog) and inline delete

**DESCRIPTION**: Enable creation of new rows directly in the table (Inline) or via dialog. Toggle inline deletion.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|SalesOrder": {
        "component": {
          "settings": {
            "sections": {
              "LineItems": {
                "table": {
                  "id": "LineItems::CreateExample",
                  "type": "ResponsiveTable",
                  "creation": {
                    "enabled": true,
                    "createMode": "Inline"  /* alternatives: "Dialog" or custom */
                  },
                  "inlineDelete": true
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — PresentationVariant and Quick Variant Selection (sorting / filtering / initial view)

**DESCRIPTION**: Link presentationVariant or quickVariantSelection to define initial sorting, filters, and default column configuration. These are typically referenced by annotation IDs or by providing configuration here.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|SalesOrder": {
        "component": {
          "settings": {
            "sections": {
              "LineItems": {
                "table": {
                  "id": "LineItems::PV",
                  "type": "ResponsiveTable",
                  "presentationVariant": "com.sap.vocabularies.UI.v1.PresentationVariant#SalesOrderLineItemsPV",
                  "quickVariantSelection": {
                    "variants": {
                      "Default": {
                        "presentationVariant": "com.sap.vocabularies.UI.v1.PresentationVariant#Default"
                      },
                      "Top10": {
                        "presentationVariant": "com.sap.vocabularies.UI.v1.PresentationVariant#Top10"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 7 — Notes and best practices

**DESCRIPTION**: Keep these points in mind:
- Replace placeholder keys (EntitySet, section IDs, annotation IDs) with your app-specific values.
- The exact manifest structure can differ slightly between Fiori Elements versions; adapt the "pages" shape (object keyed by "ObjectPage|EntitySet" or an array) to your project template.
- Use p13nMode to control which personalization options are offered.
- For large/analytical datasets prefer AnalyticalTable; for hierarchical data use TreeTable.
- All changes go into manifest.json at the app root and may require app reload to take effect.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "manifestLocation": "/<project-root>/webapp/manifest.json"
}
```
--------------------------------

**TITLE**: Sharing Overview Pages (Save as Tile and Send Email)

**INTRODUCTION**: Provide code-ready patterns to preserve the current filter bar state in the URL so the SAP Fiori Launchpad "Save As Tile" stores the app with that state, and to generate an email link that opens the app with the same state. Use these snippets in an Overview Page controller (webapp/controller/Overview.controller.js) that contains a SmartFilterBar (id "smartFilterBar").

**TAGS**: fiori-elements-framework, sapui5, overview-page, smartfilterbar, sharing, launchpad, email, deep-linking

**STEP**: 1 - Serialize SmartFilterBar state into the URL

**DESCRIPTION**: Read the SmartFilterBar filter state and put it into the browser URL so that any FLP tile creation or external link will include the current state. Use JSON serialization or convert filters into query parameters. Update history (replaceState) so no navigation occurs.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/controller/Overview.controller.js
// Assumes the view contains a SmartFilterBar with id = "smartFilterBar"

onInit: function () {
  this._oSmartFilterBar = this.byId("smartFilterBar");
},

// Option A: Put full filter JSON into a single "filters" query param
getFilterStateUrl_JSON: function () {
  const oFilterData = this._oSmartFilterBar.getFilterData(); // object representing filter values
  const sFilterJson = encodeURIComponent(JSON.stringify(oFilterData));
  const sBaseUrl = window.location.origin + window.location.pathname;
  return `${sBaseUrl}?filters=${sFilterJson}`;
},

// Option B: Convert filter data to individual key=value query parameters (flat)
getFilterStateUrl_QueryParams: function () {
  const oFilterData = this._oSmartFilterBar.getFilterData();
  const aParams = [];
  for (const key in oFilterData) {
    if (!oFilterData.hasOwnProperty(key) || oFilterData[key] == null) { continue; }
    // If value is complex (ranges/arrays), stringify it
    const sValue = typeof oFilterData[key] === "string" ? oFilterData[key] : JSON.stringify(oFilterData[key]);
    aParams.push(`${encodeURIComponent(key)}=${encodeURIComponent(sValue)}`);
  }
  const sBaseUrl = window.location.origin + window.location.pathname;
  return `${sBaseUrl}?${aParams.join("&")}`;
},

// Write the chosen URL to the browser address bar without reloading
updateBrowserUrlWithFilters: function (useJson = true) {
  const sUrl = useJson ? this.getFilterStateUrl_JSON() : this.getFilterStateUrl_QueryParams();
  history.replaceState(null, null, sUrl);
}
```

**STEP**: 2 - Save as Tile on the SAP Fiori Launchpad (user flow)

**DESCRIPTION**: Once the filter state is embedded in the URL, the FLP "Save As Tile" action will save the URL as the tile's target. On the filter bar, instruct users to click: Share > Save As Tile > Fill required fields > Ok. No additional code is required on the client if the URL already contains the filter state. Ensure updateBrowserUrlWithFilters() is called before the user clicks Share.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Call this before the user clicks Share > Save As Tile
onPrepareForSaveAsTile: function () {
  // Put latest filters into the URL
  this.updateBrowserUrlWithFilters(true); // true -> JSON option; or false for query params
  // Now the FLP Save As Tile action will capture the current URL including filter state
}
```

**STEP**: 3 - Send Email with the current filter state

**DESCRIPTION**: Generate a mailto: link containing the current URL (with serialized filters) as the body. Call updateBrowserUrlWithFilters() first so the link includes the latest state.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Open the user's email client with subject + body that includes the current app URL
onShareSendEmail: function () {
  // Ensure URL reflects current filters
  this.updateBrowserUrlWithFilters(true); // or false to use query params
  const sUrl = window.location.href;
  const sSubject = encodeURIComponent("Open app with current filters");
  const sBody = encodeURIComponent("Open this app with the current filter state:\n\n" + sUrl);
  // Launch default mail client
  window.location.href = `mailto:?subject=${sSubject}&body=${sBody}`;
}
```

**STEP**: 4 - Read filters from URL on app start (restore state)

**DESCRIPTION**: On application start (or component/route match), parse the incoming URL, extract the "filters" JSON or query params, and apply them to the SmartFilterBar so the overview page opens with the same filter state.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Call during onInit or route match to restore filter values from the URL
restoreFilterStateFromUrl: function () {
  const oUrlParams = new URLSearchParams(window.location.search);
  if (oUrlParams.has("filters")) {
    // JSON-encoded state
    try {
      const sFilters = decodeURIComponent(oUrlParams.get("filters"));
      const oFilterData = JSON.parse(sFilters);
      this._oSmartFilterBar.setFilterData(oFilterData);
    } catch (e) {
      // handle parse error
      console.error("Failed to parse filters param", e);
    }
  } else {
    // Example for query-param style; adapt keys to your filter names
    const oFilterData = {};
    for (const [k, v] of oUrlParams.entries()) {
      try {
        // if value is JSON (ranges etc.), parse it
        oFilterData[k] = JSON.parse(decodeURIComponent(v));
      } catch (e) {
        oFilterData[k] = decodeURIComponent(v);
      }
    }
    if (Object.keys(oFilterData).length) {
      this._oSmartFilterBar.setFilterData(oFilterData);
    }
  }
}
```

Notes:
- The SmartFilterBar API methods used: getFilterData() and setFilterData(object).
- The FLP "Save As Tile" action stores the current application URL; therefore ensure filters are serialized into the URL before the user triggers Save As Tile.
- For complex filter state or large payloads consider sanitizing or compressing the serialized data, or use a server-side bookmark service if URL length is a concern.
--------------------------------

**TITLE**: Enable Show More/Show Less and Show Details/Hide Details for Object Page Reference Facets

**INTRODUCTION**: This guide shows how to enable UI controls that reveal or hide content in Object Page reference facets in SAP Fiori Elements. Use UI.PartOfPreview = false to (a) make a reference facet hidden by default so the Object Page shows a Show More / Show Less control, and (b) make fields/tables inside a visible reference facet hidden by default so the facet toolbar shows Show Details / Hide Details. Includes XML, ABAP CDS, and CAP CDS examples for code generation.

**TAGS**: fiori-elements-framework, object-page, reference-facet, UI.PartOfPreview, ShowMore, ShowDetails, ABAP-CDS, CAP, XML, ODataV4

STEP: 1 — Enable Show More / Show Less for a Reference Facet (ReferenceFacet not part of preview)

DESCRIPTION: Set UI.PartOfPreview = false on a UI.ReferenceFacet record so the facet is initially hidden and the Object Page displays a Show More button. This works for reference facets that are implemented under a collection facet (and whose Target is a FieldGroup). If you omit this annotation, the default is UI.PartOfPreview = true (facet shown in preview).

LANGUAGE: XML

CODE:
```xml
<!-- XML Annotation: ReferenceFacet hidden from preview (Show More appears) -->
<Record Type="UI.ReferenceFacet">
    <PropertyValue Property="Label" String="{@i18n>@ShipToAddress}"/>
    <PropertyValue Property="ID" String="ShipToAddress"/>
    <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#ShipToAddress"/>
    <Annotation Term="UI.PartOfPreview" Bool="false"/>
</Record>
```

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.Facet: [{
    type: #FIELDGROUP_REFERENCE,
    label: 'Ship-To Address',
    targetQualifier: 'ShipToAddress',
    isPartOfPreview: false
}]
```

LANGUAGE: CAP CDS

CODE:
```jsonc
// CAP CDS: Facets in a annotations.cds or corresponding JSON representation
Facets: [{
    $Type : 'UI.ReferenceFacet',
    Label : '{@i18n>@ShipTo_NotPartOfPreview}',
    Target : '@UI.FieldGroup#ShipToAddress',
    ![@UI.PartOfPreview] : false
}]
```

STEP: 2 — Enable Show Details / Hide Details for Fields or Tables inside a Reference Facet (OData V4)

DESCRIPTION: For OData V4 applications, to hide specific DataFields or tables inside a visible reference facet (so the facet toolbar shows Show Details), set UI.PartOfPreview = false on the DataField or table annotation. This only applies if the containing reference facet itself is visible (i.e., not initially hidden). Nesting UI.PartOfPreview inside a reference facet that is initially hidden is not supported.

LANGUAGE: XML

CODE:
```xml
<!-- XML Annotation: DataField hidden from preview inside a visible reference facet -->
<Record Type="UI.DataField">
    <PropertyValue Property="Label" String="{@i18n>@StreetName}" />
    <PropertyValue Property="Value" Path="StreetName" />
    <Annotation Term="UI.PartOfPreview" Bool="false" />
</Record>
```

LANGUAGE: ABAP CDS

CODE:
```text
// No ABAP CDS sample available in the source. Use local XML annotation for DataField hiding.
```

LANGUAGE: CAP CDS

CODE:
```jsonc
// CAP CDS: Field group with DataFields hidden from preview (Show Details appears)
FieldGroup#ShipToAddress: {
    Data: [{
        $Type                : 'UI.DataField',
        Label                : '{@i18n>@StreetName}',
        Value                : StreetName,
        ![@UI.PartOfPreview] : false
    }]
}
```

STEP: 3 — Restrictions, Defaults, and Implementation Notes

DESCRIPTION:
- Default behavior: If UI.PartOfPreview is not set, the default is UI.PartOfPreview = true (shown in preview).
- Applicable scope:
  - Show More / Show Less: Only for reference facets whose Target is a FieldGroup (form representation). Not applicable to reference facets that target tables or charts.
  - Show Details / Hide Details: Only for data fields and tables included inside a visible reference facet. You cannot set UI.PartOfPreview for items inside a reference facet that is initially hidden (no nesting).
- Availability: Show Details / Hide Details is an additional feature available in SAP Fiori Elements for OData V4.
- Visual resources (image file paths from source documentation):
  - images/Object_Page_Facets_Show_More_f0f38e7.png
  - images/Object_Page_Hiding_A_Facet_From_the_UI_Show_Less_Button_a360c97.png
  - images/Showing_Fields_Inside_Reference_Facets_Show_Details_Link_01c3179.png
  - images/Hiding_Fields_Inside_Reference_Facets_Hide_Details_Link_985838c.png

LANGUAGE: Text

CODE:
```text
- Default: UI.PartOfPreview = true unless explicitly set to false.
- ShowMore/ShowLess: Only for ReferenceFacet -> Target = FieldGroup.
- ShowDetails/HideDetails: Only for fields/tables inside a visible ReferenceFacet; nesting UI.PartOfPreview is not possible.
- OData V4: ShowDetails/HideDetails feature supported.
```

STEP: 4 — Live Example and Exploration

DESCRIPTION: Explore a live example in the flexible programming model explorer to see Show/Hide behavior and test annotations.

LANGUAGE: Text

CODE:
```text
Live example: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/advancedFeatures/showMore
```
--------------------------------

**TITLE**: Side Effect Annotation Examples for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: Collection of practical, copy-pasteable examples that demonstrate how to declare SideEffects annotations for SAP Fiori Elements. Use these examples to trigger server-side function imports, refresh target properties or entities, refresh navigation targets, handle 1:1 and 1:n associations, and to define side effects programmatically in ABAP (MPC_EXT) and in ABAP CDS (RAP BDEF).

**TAGS**: fiori-elements-framework, OData, side-effects, annotations, XML, ABAP, CDS, MPC_EXT, TriggerAction

STEP: TriggerAction with TargetProperties (recalculate prices)
DESCRIPTION: Trigger a function import (TriggerAction) when source properties change; refresh specified target properties. Use when UnitPrice or ProductQuantity are validated to recalc GrossPrice and NetPriceIncludingTax.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrder_WD_20Type">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="CalculatePrice">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>UnitPrice</PropertyPath>
                    <PropertyPath>ProductQuantity</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetProperties">
                <Collection>
                    <String>GrossPrice</String>
                    <String>NetPriceIncludingTax</String>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TriggerAction" String="STTA_SALES_ORDER_WD_20_SRV.STTA_SALES_ORDER_WD_20_SRV_Entities/CalculatePriceIncludingRegionalTax"/>
        </Record>
    </Annotation>
</Annotations>
```

STEP: TriggerAction without Targets (call action only)
DESCRIPTION: Invoke a TriggerAction function import on changes of source properties without refreshing any targets. Useful when action performs side effects but no client-side refresh is required.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrder_WD_20Type">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="CalculatePrice">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>UnitPrice</PropertyPath>
                    <PropertyPath>ProductQuantity</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TriggerAction" String="STTA_SALES_ORDER_WD_20_SRV.STTA_SALES_ORDER_WD_20_SRV_Entities/CalculatePriceIncludingRegionalTax"/>
        </Record>
    </Annotation>
</Annotations>
```

STEP: Define Side Effects programmatically in MPC_EXT (ABAP)
DESCRIPTION: Create SideEffects annotations inside the DEFINE method of an MPC_EXT class using the vocabulary annotation model API. Use to generate annotations at runtime or during registration.
LANGUAGE: ABAP
CODE:
```ABAP
* define Side Effects for Purchase Order:
    DATA lo_ann_target TYPE REF TO /iwbep/if_mgw_vocan_ann_target.   " Vocabulary Annotation Target
    DATA lo_annotation TYPE REF TO /iwbep/if_mgw_vocan_annotation.   " Vocabulary Annotation
    DATA lo_collection TYPE REF TO /iwbep/if_mgw_vocan_collection.   " Vocabulary Annotation Collection
    DATA lo_function   TYPE REF TO /iwbep/if_mgw_vocan_function.     " Vocabulary Annotation Function
    DATA lo_fun_param  TYPE REF TO /iwbep/if_mgw_vocan_fun_param.    " Vocabulary Annotation Function Parameter
    DATA lo_property   TYPE REF TO /iwbep/if_mgw_vocan_property.     " Vocabulary Annotation Property
    DATA lo_record     TYPE REF TO /iwbep/if_mgw_vocan_record.       " Vocabulary Annotation Record
    DATA lo_reference  TYPE REF TO /iwbep/if_mgw_vocan_reference.    " Vocabulary Annotation Reference

    lo_reference = vocab_anno_model->create_vocabulary_reference( iv_vocab_id = '/IWBEP/VOC_COMMON'
                                                                  iv_vocab_version = '0001').
    lo_reference->create_include( iv_namespace = 'com.sap.vocabularies.Common.v1' ).
    lo_reference = vocab_anno_model->create_vocabulary_reference( iv_vocab_id = '/IWBEP/VOC_CORE'
                                                                  iv_vocab_version = '0001').
    lo_reference->create_include( iv_namespace = 'Org.OData.Core.V1' ).

    lo_ann_target = vocab_anno_model->create_annotations_target( 'MM_PUR_PO_AI_MAINTAIN.C_PurchaseOrderEnhWDType' ) ##NO_TEXT .

    lo_annotation = lo_ann_target->create_annotation( iv_term = 'com.sap.vocabularies.Common.v1.SideEffects' ) ##NO_TEXT .

    lo_record     = lo_annotation->create_record( )  ##NO_TEXT.
    lo_property   = lo_record->create_property( 'SourceProperties' )   ##NO_TEXT.
    lo_collection = lo_property->create_collection( ).

    lo_collection->create_simple_value( )->set_property_path( 'Supplier' )  ##NO_TEXT .
    lo_collection->create_simple_value( )->set_property_path( 'CompanyCode' )  ##NO_TEXT .
    lo_collection->create_simple_value( )->set_property_path( 'DocumentCurrency' )  ##NO_TEXT .
    lo_collection->create_simple_value( )->set_property_path( 'PurchasingGroup' )  ##NO_TEXT.
    lo_collection->create_simple_value( )->set_property_path( 'PurchasingOrganization' )  ##NO_TEXT.
```

STEP: Refresh Price on multiple source properties (multi-input)
DESCRIPTION: When fields like Amount, Discount, or a multi-input property change, refresh the Price property. Demonstrates nested property paths (e.g., ProductDetail/DeliveryLocations).
LANGUAGE: XML
CODE:
```XML
<Annotations Target="NAMESPACE.ENTITYTYPE">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="PriceChanged">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>Amount</PropertyPath>
                    <PropertyPath>Discount</PropertyPath>
                    <PropertyPath>ProductDetail/DeliveryLocations</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetProperties">
                <Collection>
                    <String>Price</String>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: Refresh 1:1 navigation target when supplier changes
DESCRIPTION: When Supplier changes, refresh controls bound to the 1:1 navigation property toSupplier.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="NAMESPACE.ENTITYTYPE">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="SupplierChanged">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>Supplier</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetEntities">
               <Collection>
                   <NavigationPropertyPath>toSupplier</NavigationPropertyPath>
               </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: Force full entity read due to field control
DESCRIPTION: Change a single property (Status) but require a server read of the whole entity (e.g., to evaluate field controls). Use an empty NavigationPropertyPath in TargetEntities to indicate full-entity refresh.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="NAMESPACE.ENTITYTYPE">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="PriceChanged">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>Status</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetEntities">
                <Collection>
                    <NavigationPropertyPath></NavigationPropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: React on structural changes of a 1:n association
DESCRIPTION: Refresh header or aggregate properties (OverallAmount) when items in a 1:n association (toSalesOrderItems) are created or deleted.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="NAMESPACE.ENTITYTYPE">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="ReactOnItemCreationOrDeletion">
        <Record>
            <PropertyValue Property="SourceEntities">
                <Collection>
                    <NavigationPropertyPath>toSalesOrderItems</NavigationPropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetProperties">
                <Collection>
                    <String>OverallAmount</String>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: Side effect after executing an action (function import) with entity & property targets
DESCRIPTION: Define side effects for an action function import. Example: Setcurrency action updates a property from an associated entity and refreshes controls bound to to_Item.
LANGUAGE: XML
CODE:
```XML
<!-- The function import "Setcurrency" is expected to refresh 
     the "Currency_Code_Text" coming from the associated entity "to_Currency" -->
<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.STTA_SALES_ORDER_WD_20_SRV_Entities/Setcurrency">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects">
        <Record>
            <PropertyValue Property="TargetProperties">
                <Collection>
                    <PropertyPath>to_Currency/Currency_Code_Text</PropertyPath>
                </Collection>
            </PropertyValue>

            <!-- Side Effects for action annotation with an entity as a target.
                 Controls associated with "to_Item" will be refreshed -->
            <PropertyValue Property="TargetEntities">
                <Collection>
                    <NavigationPropertyPath>to_Item</NavigationPropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: Refresh navigation target to root entity (navigation to root)
DESCRIPTION: Update the root entity (to_SalesOrder) when an item property (TaxAmount) changes. Two variants: refresh the navigation target entity, or refresh all properties of the root entity using "to_SalesOrder/*".
LANGUAGE: XML
CODE:
```XML
<!-- Variant A: Refresh the navigation target entity -->
<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrderItem_WD_20Type">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="TaxAmountChanged">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                     <PropertyPath>TaxAmount</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetEntities">
               <Collection>
                     <NavigationPropertyPath>to_SalesOrder</NavigationPropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    <Annotation>
</Annotations>

<!-- Variant B: Refresh all properties on the root entity (to_SalesOrder/*) -->
<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrderItem_WD_20Type">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="TaxAmountChanged">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>TaxAmount</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetProperties">
                <Collection>
                    <String>to_SalesOrder/*</String>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: Side effect on 1:1 associated entity set property (smart field in smart form)
DESCRIPTION: Add a side effect when a smart field bound to a 1:1 associated entity changes; triggers a side effect call. Replace placeholders with your schema/entity and navigation/property names.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="<Schema Namespace>.<EntityType Name>">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="<Qualifier Name (Optional)>">
        <PropertyValue Property="SourceProperties">
            <Collection>
                <PropertyPath><1:1 Associated Navigation Property Name.Ex:to_Rating/Rating>/<Property Name></PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="TargetProperties">
            <Collection>
                <String><Target Property Name></String>
            </Collection>
        </PropertyValue>
    </Annotation>
</Annotations>
```

STEP: ABAP CDS (RAP) side effects block examples (OData V4 / Behavior Definition)
DESCRIPTION: Define side effects in RAP behavior definitions (BDEF). Use this block to specify field-to-field, field-to-entity, actions affecting fields/entities, messages, and permission changes.
LANGUAGE: CDS
CODE:
```CDS
side effects {
    field IntegerValue affects field ProgressIntegerValue, field RadialIntegerValue;
    field Timestamp affects field IANATimestamp;
    field Supplier affects entity toSupplier;
    action changeCriticality affects field CriticalityCode;
    action resetTimesChildCreated affects field TimesChildCreated, permissions ( action resetTimesChildCreated );
    action overwriteTimezone affects $self;
    determine action validateDate executed on field ValidTo affects messages;
    $self affects permissions ( update _Child );
    determine action updateTimes executed on entity _Child affects field TotalPieces;
}
```
--------------------------------

**TITLE**: Implementing and Annotating Side Effects in SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: This guide describes how to declare and implement side effect annotations so the Fiori front end refreshes UI fields/entities when backend changes occur. It contains actionable rules, restrictions, and ready-to-use code samples for OData V2, OData V4 (XML and CAP CDS), JavaScript extension APIs to register custom fields/columns, and manifest.json config for extension fields.

**TAGS**: fiori-elements, side-effects, odata-v2, odata-v4, annotations, sapui5, extension-api, cap, cds, xml, json, javascript

**STEP**: 1 — Default Side Effects (Summary)

**DESCRIPTION**: Default side effects that are available out-of-the-box (no annotation required). Useful to know expected automatic refreshes.

**LANGUAGE**: Text

**CODE**:
```text
Default behaviors (no annotation required):
- Create new entity/draft (list or object page): parent page list binding refreshed.
- Delete entity: parent page list binding refreshed to remove entity.
- Create draft for active object: list report binding refreshed to show draft.
- Discard/Activate draft: list binding refreshed to show active version.
- Triggering bound actions: collection refreshed if action returns instance different from bound instance (e.g., copy).
```

**STEP**: 2 — Side Effect Annotation Format & Rules

**DESCRIPTION**: Key elements, rules and restrictions to author side effect annotations. Always include Source (properties/entities/structural change), Target (properties/entities), and optional TriggerAction path. Notes about deprecated properties.

**LANGUAGE**: Text

**CODE**:
```text
Elements:
- Source: property change, action, or structural change (create/delete subitem).
- Target: property list or entity/collection (can use 1:1 or 1:n navigation properties depending on version).
- TriggerAction (optional): absolute path to function import/action executed when side effect triggers.

Important notes:
- TriggerAction replaces PreparationAction (deprecated). EffectTypes is deprecated.
- TargetProperties.type must be quoted (per SideEffectsType).
- If TriggerAction exists but no TargetProperties/TargetEntities, only TriggerAction is called.
- UI validation errors prevent side effect triggers (no request is sent).
Restrictions:
- Cannot use navigation properties as source properties.
- OData V2: only 1:n navigation properties allowed as SourceEntities.
- OData V4: allows 1:1 and 1:n SourceEntities; side effect can run in field context or parent entity context when relative.
- For V2 1:n TargetEntities: requests are not table-bound and paging is not considered.
```

**STEP**: 3 — OData V2: Sample EntityType and SideEffects Annotation

**DESCRIPTION**: Example showing entity definition (length constraint) and SideEffects annotation to refresh the whole entity when ProductCategory/MainProductCategory changes. Use in local XML annotation files or backend annotations.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- EntityType definition (EDMX style excerpt) -->
<EntityType Name="SEPMRA_I_ProductCategoryType" sap:label="Category" sap:content-version="1">
    <Key>
        <PropertyRef Name="ProductCategory"/>
    </Key>
    <Property Name="ProductCategory" Type="Edm.String" Nullable="false" MaxLength="40" sap:label="Category"/>
    <Property Name="MainProductCategory" Type="Edm.String" MaxLength="40" sap:label="Main Category" sap:value-list="fixed-values"/>
    <NavigationProperty Name="to_MainCategory" Relationship="STTA_PROD_MAN.assoc_BBDC3EA034F824A7382F8EEF561C1160"
        FromRole="FromRole_assoc_BBDC3EA034F824A7382F8EEF561C1160"
        ToRole="ToRole_assoc_BBDC3EA034F824A7382F8EEF561C1160"/>
</EntityType>

<!-- SideEffects annotation for the EntityType -->
<Annotations Target="NAMESPACE.ENTITYTYPE">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="ProductChanged">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>ProductCategory</PropertyPath>
                    <PropertyPath>MainProductCategory</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetEntities">
                <Collection>
                    <!-- Empty NavigationPropertyPath denotes the whole entity is the target -->
                    <NavigationPropertyPath></NavigationPropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 4 — Register Custom Field for Side Effects (OData V2/V4 Extension API)

**DESCRIPTION**: Use extensionAPI.registerCustomFieldForSideEffect in onAfterRendering to register custom form fields. Keep returned callback and call it in the custom field's event handler with FieldName.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Path: extension controller (e.g., webapp/ext/controller/ObjectPageExtension.js)
sap.ui.define("SOwoExt.ext.controller.ObjectPageExtension", ["sap/m/MessageBox"], function (MessageBox) {
    "use strict";
    var CustomFieldGroupChangeRegister;

    return {
        onCheckBoxEvent: function (oEvent) {
            var oView = this.getView();
            var model = oView.getModel();
            var context = oView.getBindingContext();
            var sFields = "SrcgProjNotesAreForbidden";
            var data = oEvent.getParameter("selected");

            // update model property
            model.setProperty(context.getPath() + "/" + sFields, data);

            // notify framework about change (invoke callback with FieldName)
            CustomFieldGroupChangeRegister("SrcgProjNotesAreForbidden");
        },

        onAfterRendering: function () {
            var oView = this.getView();
            var sEntitySet = "C_STTA_SalesOrder_WD_20";
            var sProperty = "SrcgProjNotesAreForbidden";
            var oControl = sap.ui.getCore().getElementById(
                "SOwoExt::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20--srcgProjNotesAreForbiddenCheckBox"
            );

            // register custom field for side effects: (oControl, FieldName, EntitySet)
            CustomFieldGroupChangeRegister = this.extensionAPI.registerCustomFieldForSideEffect(oControl, sProperty, sEntitySet);
        }
    };
});
```

**STEP**: 5 — Register Custom Column for Side Effects (Tables)

**DESCRIPTION**: Use extensionAPI.registerCustomColumnForSideEffect in onAfterRendering to register custom table column controls (responsive/grid table). Invoke returned callback in column event handlers with FieldName.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define("SOwoExt.ext.controller.ObjectPageExtension", ["sap/m/MessageBox"], function (MessageBox) {
    "use strict";
    var CustomFieldGroupChangeRegister;

    return {
        onSubSectionEnteredExtension: function (subSection) {
            if (subSection.getId().indexOf("C_STTA_SalesOrder_WD_20--to_Item") !== -1) {
                var sourcingProjectItemTreeTable = this.oView.byId(
                    "SOwoExt::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20--to_Item::com.sap.vocabularies.UI.v1.LineItem::responsiveTable"
                );

                sourcingProjectItemTreeTable.addEventDelegate({
                    onAfterRendering: function () {
                        var oControl = this.oView.byId(
                            "SOwoExt::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20--to_Item::com.sap.vocabularies.UI.v1.LineItem::responsiveTable"
                        );

                        // register custom column for side effects: (oTableControl, FieldName, EntitySet)
                        CustomFieldGroupChangeRegister = this.extensionAPI.registerCustomColumnForSideEffect(
                            oControl,
                            "Raiseamount_ac",
                            "C_STTA_SalesOrderItem_WD_20"
                        );
                    }
                }, this);
            }
        },

        onCheckBoxPressed: function () {
            // call callback with FieldName when column control is changed
            var sProperty = "Raiseamount_ac";
            CustomFieldGroupChangeRegister(sProperty);
        }
    };
});
```

**STEP**: 6 — OData V4: Define Side Effects on Unbound Actions (XML)

**DESCRIPTION**: For unbound actions you must use absolute paths. This XML sample shows an unbound action declared in schema and SideEffects annotation targeting a full entity set to refresh the list.

**LANGUAGE**: XML

**CODE**:
```xml
<Schema Namespace="sap.fe.core.Service" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <EntityContainer Name="EntityContainer">
    <ActionImport Name="unBoundAction" Action="sap.fe.core.Service.unBoundAction" />
    ...
  </EntityContainer>

  <Action Name="unBoundAction" IsBound="false" />

  <Annotations Target="sap.fe.core.Service.RootEntity">
    <Annotation Term="UI.LineItem" Qualifier="sample7">
      <Collection>
        <Record Type="UI.DataFieldForAction">
          <PropertyValue Property="Label" String="Table Refresh" />
          <PropertyValue Property="Action" String="sap.fe.core.Service.EntityContainer/unBoundAction" />
          <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/ChangeSet" />
        </Record>
      </Collection>
    </Annotation>
  </Annotations>

  <Annotations Target="sap.fe.core.Service.UnboundAction()">
    <Annotation Term="Common.SideEffects">
      <Record Type="Common.SideEffectsType">
        <PropertyValue Property="TargetEntities">
          <Collection>
            <!-- Absolute path to EntityContainer/EntitySet -->
            <NavigationPropertyPath>/sap.fe.core.Service.EntityContainer/RootEntity</NavigationPropertyPath>
          </Collection>
        </PropertyValue>
      </Record>
    </Annotation>
  </Annotations>
</Schema>
```

**STEP**: 7 — OData V4: CAP CDS Example for an Unbound Action Side Effect

**DESCRIPTION**: CAP CDS example showing a LineItem UI entry for an unbound action and the @Common.SideEffects annotation using absolute path.

**LANGUAGE**: CDS

**CODE**:
```cds
// LineItem annotation with an unbound action
annotate RootEntity with @(
  UI: {
    LineItem: [
      {
        $Type: 'UI.DataFieldForAction',
        Label: 'My Unbound action',
        Action: 'MyService.EntityContainer/unBoundAction',
        InvocationGrouping: #ChangeSet
      },
      { $Type: 'UI.DataField', Value: property1 },
      { $Type: 'UI.DataField', Value: property2 },
      { $Type: 'UI.DataField', Value: property3 }
    ]
  }
);

// service with unbound action and SideEffects annotation
service MyService {
  // Side effect annotation using an absolute path
  @Common.SideEffects: { TargetEntities: ['/MyService.EntityContainer/RootEntity'] }
  action unBoundAction();
}
```

**STEP**: 8 — ValueList Collection Refresh (OData V4 XML Example)

**DESCRIPTION**: Example showing a SideEffects annotation that targets a value list collection (absolute path) so cached value lists are refreshed when transactional data changes.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="ChangeOfProperty">
  <Record>
    <PropertyValue Property="SourceProperties">
      <Collection>
        <PropertyPath>PropertyName</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="TargetEntities">
      <Collection>
        <!-- Absolute path to ValueList collection -->
        <NavigationPropertyPath>/Namespace.EntityContainer/ValueListCollection</NavigationPropertyPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 9 — Extension Field Side Effects Configuration (OData V4 manifest.json)

**DESCRIPTION**: When using custom extension fields in ObjectPage forms for OData V4, declare the custom control and include "property" in controlConfiguration to let the framework trigger side effects for that property when focus leaves the custom field.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "MyObjectPage": {
          "type": "Component",
          "id": "Default",
          "name": "sap.fe.templates.ObjectPage",
          "viewLevel": 1,
          "options": {
            "settings": {
              "contextPath": "/RootEntity",
              "editableHeaderContent": true,
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.Identification": {
                  "fields": {
                    "customFormElementIdentification1": {
                      "template": "sap.fe.core.fpmExplorer.customFormElementContent.CustomFormElement1",
                      "label": "Custom FormElement 1",
                      "property": "NameProperty"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 10 — Practical Tips & Edge Cases

**DESCRIPTION**: Quick actionable checklist and known caveats to ensure side effects work as expected.

**LANGUAGE**: Text

**CODE**:
```text
Checklist:
- Ensure SourceProperties are valid non-navigation properties (V2) or follow allowed navigation rules (V4).
- Quote the 'type' for TargetProperties (SideEffectsType).
- If using TriggerAction, provide absolute path for unbound actions.
- For extension fields/columns: register control in onAfterRendering and call the returned callback with FieldName on change.
- Value lists: use absolute TargetEntities to refresh cached lists after changes.
Caveats:
- No side effect triggers while UI validation errors exist for source fields.
- For V2 1:n TargetEntities: paging is ignored (use carefully).
- Navigation properties are not supported as custom field sources.
```

**STEP**: 11 — References (internal docs / next steps)

**DESCRIPTION**: Links to example pages and deeper examples to implement complex scenarios.

**LANGUAGE**: Text

**CODE**:
```text
Related docs:
- Side Effect Annotations: Examples (side-effect-annotations-examples-61cf21d.md)
- Using Global Side Effects (using-global-side-effects-955ae31.md)
- Flexible Programming Model Explorer: Extension Points - Custom Form Element (live demo)
```
--------------------------------

**TITLE**: Smart Table Extensions for Analytical List Page (ALP) — Controller & Column Extensions

**INTRODUCTION**: This document provides concrete, copy-pasteable examples to:
- Extend the ALP controller to implement onBeforeRebindTableExtension and onListNavigationExtension.
- Add custom table columns via viewExtensions and XML fragments.
- Configure manifest.json (descriptor) entries required by ALP.
Applicable for SAP Fiori elements for OData V2.

**TAGS**: fiori-elements-framework, analytical-list-page, ALP, smart-table, extensions, manifest.json, fragment, OData V2

STEP: 1 — Add controller extension entry to manifest.json

DESCRIPTION: Update manifest.json to register a custom extension controller for ALP. Replace the controllerName value with your application namespace and controller file path (without .js). The example shows where to place this inside "sap.ui5". Keep other "sap.ui.generic.app" settings as needed.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "_version": "1.1.0",
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.controller.AnalyticalListPage": {
            "controllerName": "sap.poc.ftu.apps.alr.ext.controller.AnalyticalListPageExt"
          }
        }
      }
    }
  }
}
```

STEP: 2 — Implement extension controller (onBeforeRebindTableExtension + onListNavigationExtension)

DESCRIPTION: Create the extension controller file at path: webapp/sap/poc/ftu/apps/alr/ext/controller/AnalyticalListPageExt.js. Implement onBeforeRebindTableExtension to modify binding parameters (e.g., add filters or custom URL parameters) before table binding. Implement onListNavigationExtension to perform conditional navigation; return true to stop default navigation, return false to allow standard internal navigation. Use extensionAPI.getNavigationController().navigateExternal(target) for external navigation.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/sap/poc/ftu/apps/alr/ext/controller/AnalyticalListPageExt.js
sap.ui.define([], function() {
    "use strict";
    return {
        /**
         * Called by ALP before the table is rebound.
         * Use oEvent.getParameter('bindingParams') to add filters or parameters.
         * Example: add a custom filter based on a control value.
         */
        onBeforeRebindTableExtension: function(oEvent) {
            // Retrieve binding params (depending on ALP version)
            var oBindingParams = oEvent.getParameter && oEvent.getParameter("bindingParams") || oEvent.bindingParams;
            // Example: add a custom filter (requires sap.ui.model.Filter)
            // var oFilter = new sap.ui.model.Filter("CustomProperty", sap.ui.model.FilterOperator.EQ, "Value");
            // oBindingParams.filters.push(oFilter);

            // Debug example: alert to confirm this hook is called (remove in production)
            // alert('onBeforeRebindTableExtension called!');
        },

        /**
         * Conditional navigation per row.
         * Return true to block default navigation (you handled navigation),
         * return false to allow standard ALP navigation.
         *
         * oEvent.getSource() is the table row item (or event source) — getBindingContext() for row data.
         */
        onListNavigationExtension: function(oEvent) {
            // Get navigation controller from extensionAPI (available in ALP extension controller)
            // Note: this.extensionAPI is injected by Fiori elements runtime
            var oNavigationController = this.extensionAPI && this.extensionAPI.getNavigationController && this.extensionAPI.getNavigationController();

            // Obtain selected row context and object
            var oBindingContext = oEvent.getSource && oEvent.getSource().getBindingContext && oEvent.getSource().getBindingContext();
            var oObject = oBindingContext && oBindingContext.getObject && oBindingContext.getObject();

            if (!oObject || !oNavigationController) {
                // Fallback: allow default navigation if no custom decision can be made
                return false;
            }

            // Example conditional logic: perform external navigation for specific CostCenter
            if (oObject.CostCenter === "300-1000") {
                // Use external navigation target name defined in manifest or routing
                oNavigationController.navigateExternal("ActualCostsKPIDetails");
                // Return true to prevent default internal navigation
                return true;
            }

            // Return false to trigger the default internal navigation behavior
            return false;
        }
    };
});
```

STEP: 3 — Add viewExtensions entry to manifest.json to define a custom column fragment

DESCRIPTION: Register a fragment that defines a custom AnalyticalColumn for a specific entity set. The key format is "AnalyticalTableColumnsExtension|<EntitySetName>". Set fragmentName to the fragment path (without extension) using your app namespace. The fragment type is XML and className is "sap.ui.core.Fragment".

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "_version": "1.1.0",
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
            "AnalyticalTableColumnsExtension|CZ_EASILINEITEMS_SADL": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "sap.poc.ftu.apps.alr.ext.fragment.CustomColumn",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — Create the custom column fragment (XML)

DESCRIPTION: Create fragment file at webapp/sap/poc/ftu/apps/alr/ext/fragment/CustomColumn.fragment.xml. Use the AnalyticalColumn control inside the fragment. Provide p13nData via core:CustomData (stringified JSON) so column personalization works. The JSON must be included as a string value.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/sap/poc/ftu/apps/alr/ext/fragment/CustomColumn.fragment.xml -->
<core:FragmentDefinition
    xmlns:core="sap.ui.core"
    xmlns="sap.m"
    xmlns:table="sap.ui.table">
    <table:AnalyticalColumn width="150px" autoResizable="true">
        <!-- Column header -->
        <Label text="My Extended Column" />
        <!-- Cell template -->
        <table:template>
            <Label text="{MyExtendedProperty}" /> <!-- bind to a property from the table row context -->
        </table:template>
        <!-- Column personalization metadata -->
        <table:customData>
            <core:CustomData key="p13nData"
                value='{"columnKey":"Test","columnIndex":"1"}' />
        </table:customData>
    </table:AnalyticalColumn>
</core:FragmentDefinition>
```

STEP: 5 — Notes & behavior summary (implementation guidance)

DESCRIPTION: Quick actionable points to follow when implementing extensions:
- Applicability: This approach targets SAP Fiori elements for OData V2 (ALP).
- Manifest changes: Add both sap.ui.controllerExtensions and sap.ui.viewExtensions under "sap.ui5" -> "extends" -> "extensions".
- Controller file path: Use the full namespace path in controllerName (e.g., "sap.poc.ftu.apps.alr.ext.controller.AnalyticalListPageExt") and place the .js file accordingly under webapp/.
- Fragment path: Use fragmentName matching file location (e.g., "sap.poc.ftu.apps.alr.ext.fragment.CustomColumn") and place the .fragment.xml under webapp/.
- onBeforeRebindTableExtension: Modify oEvent.getParameter('bindingParams').filters or .sorter to affect the table query.
- onListNavigationExtension: Use this.extensionAPI.getNavigationController().navigateExternal(target) for external navigation; return true to stop default navigation, return false to allow it.
--------------------------------

**TITLE**: Stack Card (OVP) — manifest and metadata configuration for Object Stream and Quick View Cards

**INTRODUCTION**: This document shows how to configure a Stack Card in an SAP OVP (Overview Page) application. It covers manifest.json settings for the stack card, object stream behavior (up to 20 quick view cards), flags controlling footer actions, custom placeholder text, and the required OData metadata (EDMX) relationships (navigation properties and association sets). Use these snippets directly in your project manifest and service metadata.

**TAGS**: fiori-elements-framework, ovp, stack-card, object-stream, quick-view, SAPUI5, manifest.json, EDMX, metadata, navigation-property

**STEP**: Add a Stack Card to manifest.json

**DESCRIPTION**: Add a stack card configuration inside sap.ovp.cards in webapp/manifest.json. Key settings used:
- model: reference to the OData model (e.g., "salesOrder")
- template: must be "sap.ovp.cards.stack"
- settings.title / subTitle: display texts
- requireAppAuthorization: (optional) semantic action for navigation
- itemText: custom text appended to the placeholder card
- entitySet: dominant entity set (used to fetch object stream items)
- identificationAnnotationPath: identification annotation path (used for quick view cards)
- objectStreamCardsSettings.showFirstActionInFooter: controls whether the first footer action is the navigation action (true/false)

Place this JSON under "sap.ovp" -> "cards" in webapp/manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card00": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.stack",
        "settings": {
          "title": "Stack Card Title",
          "subTitle": "Stack Card",
          "requireAppAuthorization": "#Action-toappnavsample",
          "itemText": "items awaiting approval",
          "entitySet": "SalesOrderSet",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification,com.sap.vocabularies.UI.v1.Identification#item2",
          "objectStreamCardsSettings": {
            "showFirstActionInFooter": false
          }
        }
      }
    }
  }
}
```

**STEP**: Configure objectStreamCardsNavigationProperty (optional, for secondary-entity display)

**DESCRIPTION**: When you want the stack to represent items from a primary entity (e.g., BusinessPartnerSet) and display related secondary items (e.g., SalesOrder), set:
- entitySet to the primary entity set (BusinessPartnerSet)
- objectStreamCardsNavigationProperty to the navigation property name (ToSalesOrders)
This instructs the stack card to fetch the related SalesOrder items via the navigation property. Note: this navigation-property setting is irrelevant for quick view cards that directly use identification annotation items.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card01": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.stack",
        "settings": {
          "title": "Business Partner — Sales Orders",
          "entitySet": "BusinessPartnerSet",
          "objectStreamCardsNavigationProperty": "ToSalesOrders",
          "objectStreamCardsSettings": {
            "showFirstActionInFooter": true
          }
        }
      }
    }
  }
}
```

**STEP**: Object Stream behavior and placeholder card rules

**DESCRIPTION**: Implement these runtime rules in UI or rely on built-in OVP behavior:
- Object stream displays up to 20 quick view cards. Clicking the number on the right opens the object stream.
- The placeholder card appears only when the object stream has exactly 20 quick view cards (to provide additional information).
- When counting items shown to the user, exclude the placeholder card from the 20-card limit.
- itemText in stack card settings adds custom text to the placeholder card (e.g., "items awaiting approval").

No additional code required beyond the manifest settings shown above.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "notes": [
    "Object stream shows up to 20 quick view cards.",
    "Placeholder card appears only when object stream has 20 quick view cards.",
    "itemText adds custom text to the placeholder card (shown with the default placeholder message)."
  ]
}
```

**STEP**: Quick view cards — identification annotation usage

**DESCRIPTION**: To populate each quick view card, use the identification annotation path in the stack card settings (identificationAnnotationPath). This points to com.sap.vocabularies.UI.v1.Identification (optionally with a qualifier) that defines fields for the quick view card display. Ensure your OData service metadata contains the corresponding annotation.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "settings": {
    "entitySet": "SalesOrderSet",
    "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification,com.sap.vocabularies.UI.v1.Identification#item2"
  }
}
```

**STEP**: Required EDMX metadata example (entity types, navigation property, association and association set)

**DESCRIPTION**: The stack card relies on OData navigation properties and association sets so that related entities can be resolved. Below is a complete EDMX excerpt demonstrating:
- BusinessPartner entity with NavigationProperty ToSalesOrders
- SalesOrder entity with NavigationProperty ToBusinessPartner
- Association Assoc_BusinessPartner_SalesOrders and AssociationSet mapping

Include this in your service metadata (e.g., via your OData service or static EDMX).

**LANGUAGE**: XML

**CODE**:
```xml
<EntityType Name="BusinessPartner" sap:content-version="1">
    <Key>
        <PropertyRef Name="BusinessPartnerID"/>
    </Key>
    <Property Name="Address" Type="GWSAMPLE_BASIC.CT_Address" Nullable="false"/>
    <Property Name="BusinessPartnerID" Type="Edm.String" Nullable="false" MaxLength="10" sap:label="Bus. Part. ID" sap:creatable="false" sap:updatable="false"/>
    <Property Name="CompanyName" Type="Edm.String" MaxLength="80" sap:label="Company Name"/>
    <Property Name="WebAddress" Type="Edm.String" sap:label="Web Address" sap:sortable="false" sap:filterable="false" sap:semantics="url"/>
    <Property Name="EmailAddress" Type="Edm.String" MaxLength="255" sap:label="E-Mail Address" sap:semantics="email"/>
    <Property Name="PhoneNumber" Type="Edm.String" MaxLength="30" sap:label="Phone No." sap:semantics="tel"/>
    <Property Name="FaxNumber" Type="Edm.String" MaxLength="30" sap:label="Fax Number"/>
    <Property Name="LegalForm" Type="Edm.String" MaxLength="10" sap:label="Legal Form"/>
    <Property Name="CurrencyCode" Type="Edm.String" MaxLength="5" sap:label="Currency" sap:semantics="currency-code"/>
    <Property Name="BusinessPartnerRole" Type="Edm.String" MaxLength="3" sap:label="Bus. Part. Role"/>
    <Property Name="CreatedAt" Type="Edm.DateTime" Precision="7" sap:label="Time Stamp" sap:creatable="false" sap:updatable="false"/>
    <Property Name="ChangedAt" Type="Edm.DateTime" Precision="7" ConcurrencyMode="Fixed" sap:label="Time Stamp" sap:creatable="false" sap:updatable="false"/>
    <NavigationProperty Name="ToSalesOrders" Relationship="GWSAMPLE_BASIC.Assoc_BusinessPartner_SalesOrders" FromRole="FromRole_Assoc_BusinessPartner_SalesOrders" ToRole="ToRole_Assoc_BusinessPartner_SalesOrders"/>
    <NavigationProperty Name="ToContacts" Relationship="GWSAMPLE_BASIC.Assoc_BusinessPartner_Contacts" FromRole="FromRole_Assoc_BusinessPartner_Contacts" ToRole="ToRole_Assoc_BusinessPartner_Contacts"/>
    <NavigationProperty Name="ToProducts" Relationship="GWSAMPLE_BASIC.Assoc_BusinessPartner_Products" FromRole="FromRole_Assoc_BusinessPartner_Products" ToRole="ToRole_Assoc_BusinessPartner_Products"/>
</EntityType>

<EntityType Name="SalesOrder" sap:content-version="1">
    <Key>
        <PropertyRef Name="SalesOrderID"/>
    </Key>
    <Property Name="SalesOrderID" Type="Edm.String" Nullable="false" MaxLength="10" sap:label="Sa. Ord. ID" sap:creatable="false" sap:updatable="false"/>
    <Property Name="SalesOrderGuid" Type="Edm.Guid" Nullable="false" sap:label="SalesOrder GUID" sap:creatable="false" sap:updatable="false"/>
    <Property Name="Note" Type="Edm.String" MaxLength="255" sap:label="Description" sap:updatable="false" sap:sortable="false" sap:filterable="false"/>
    <Property Name="NoteLanguage" Type="Edm.String" MaxLength="1" sap:label="Language" sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false"/>
    <Property Name="CustomerID" Type="Edm.String" MaxLength="10" sap:label="Bus. Part. ID" sap:updatable="false"/>
    <Property Name="CustomerName" Type="Edm.String" MaxLength="80" sap:label="Company Name" sap:creatable="false" sap:updatable="false"/>
    <Property Name="CurrencyCode" Type="Edm.String" MaxLength="5" sap:label="Currency" sap:updatable="false" sap:semantics="currency-code"/>
    <Property Name="GrossAmount" Type="Edm.Decimal" Precision="16" Scale="3" sap:unit="CurrencyCode" sap:label="Gross Amt." sap:creatable="false" sap:updatable="false"/>
    <Property Name="NetAmount" Type="Edm.Decimal" Precision="16" Scale="3" sap:unit="CurrencyCode" sap:label="Net Amt." sap:creatable="false" sap:updatable="false"/>
    <Property Name="TaxAmount" Type="Edm.Decimal" Precision="16" Scale="3" sap:unit="CurrencyCode" sap:label="Tax Amt." sap:creatable="false" sap:updatable="false"/>
    <Property Name="LifecycleStatus" Type="Edm.String" MaxLength="1" sap:label="PO Lifecycle" sap:creatable="false" sap:updatable="false"/>
    <Property Name="LifecycleStatusDescription" Type="Edm.String" MaxLength="60" sap:label="Lifecycle Descript." sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false"/>
    <Property Name="BillingStatus" Type="Edm.String" MaxLength="1" sap:label="PO Confirmation" sap:creatable="false" sap:updatable="false"/>
    <Property Name="BillingStatusDescription" Type="Edm.String" MaxLength="60" sap:label="Billing Description" sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false"/>
    <Property Name="DeliveryStatus" Type="Edm.String" MaxLength="1" sap:label="PO Ordering" sap:creatable="false" sap:updatable="false"/>
    <Property Name="DeliveryStatusDescription" Type="Edm.String" MaxLength="60" sap:label="Delivery Description" sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false"/>
    <Property Name="CreatedAt" Type="Edm.DateTime" Precision="7" sap:label="Time Stamp" sap:creatable="false" sap:updatable="false"/>
    <Property Name="ChangedAt" Type="Edm.DateTime" Precision="7" sap:label="Time Stamp" sap:creatable="false" sap:updatable="false"/>
    <NavigationProperty Name="ToBusinessPartner" Relationship="GWSAMPLE_BASIC.Assoc_BusinessPartner_SalesOrders" FromRole="ToRole_Assoc_BusinessPartner_SalesOrders" ToRole="FromRole_Assoc_BusinessPartner_SalesOrders"/>
    <NavigationProperty Name="ToLineItems" Relationship="GWSAMPLE_BASIC.Assoc_SalesOrder_SalesOrderLineItems" FromRole="FromRole_Assoc_SalesOrder_SalesOrderLineItems" ToRole="ToRole_Assoc_SalesOrder_SalesOrderLineItems"/>
</EntityType>

<Association Name="Assoc_BusinessPartner_SalesOrders" sap:content-version="1">
    <End Type="GWSAMPLE_BASIC.BusinessPartner" Multiplicity="1" Role="FromRole_Assoc_BusinessPartner_SalesOrders"/>
    <End Type="GWSAMPLE_BASIC.SalesOrder" Multiplicity="*" Role="ToRole_Assoc_BusinessPartner_SalesOrders"/>
    <ReferentialConstraint>
        <Principal Role="FromRole_Assoc_BusinessPartner_SalesOrders">
            <PropertyRef Name="BusinessPartnerID"/>
        </Principal>
        <Dependent Role="ToRole_Assoc_BusinessPartner_SalesOrders">
            <PropertyRef Name="CustomerID"/>
        </Dependent>
    </ReferentialConstraint>
</Association>

<EntityContainer Name="GWSAMPLE_BASIC_Entities" m:IsDefaultEntityContainer="true">
    <EntitySet Name="BusinessPartnerSet" EntityType="GWSAMPLE_BASIC.BusinessPartner" sap:content-version="1"/>
    <EntitySet Name="SalesOrderSet" EntityType="GWSAMPLE_BASIC.SalesOrder" sap:updatable="false" sap:content-version="1"/>
    <AssociationSet Name="Assoc_BusinessPartner_SalesOrders_AssocS" Association="GWSAMPLE_BASIC.Assoc_BusinessPartner_SalesOrders" sap:creatable="false" sap:updatable="false" sap:deletable="false" sap:content-version="1">
        <End EntitySet="BusinessPartnerSet" Role="FromRole_Assoc_BusinessPartner_SalesOrders"/>
        <End EntitySet="SalesOrderSet" Role="ToRole_Assoc_BusinessPartner_SalesOrders"/>
    </AssociationSet>
</EntityContainer>
```
--------------------------------

**TITLE**: Stacked Bar Micro Chart Annotations (UI.Chart + UI.DataPoint)

**INTRODUCTION**: Quick, code-focused examples to implement a Stacked Bar Micro Chart in Fiori Elements by adding UI.Chart and UI.DataPoint annotations. Includes equivalent samples for OData XML annotations, ABAP CDS and CAP CDS. Use these snippets to configure a BarStacked chart using a single measure (Width) and its DataPoint (#Width).

**TAGS**: fiori-elements-framework, UI.Chart, UI.DataPoint, StackedBarMicroChart, annotations, UI5, CDS, CAP, ABAP, XML

**STEP**: 1 — Add UI.Chart (XML)

**DESCRIPTION**: Add a UI.Chart annotation with qualifier SalesPriceStackedBarChart. Set ChartType to BarStacked, include the measure property Width, and map MeasureAttributes to the UI.DataPoint qualifier @UI.DataPoint#Width.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotation Term="UI.Chart" Qualifier="SalesPriceStackedBarChart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Sales Price"/>
        <PropertyValue Property="Description" String="Stacked BarChart"/>
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/BarStacked"/>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>Width</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="Width"/>
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Width"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 2 — Add UI.Chart (ABAP CDS)

**DESCRIPTION**: Annotate your ABAP CDS view with a UI.Chart entry using qualifier SalesPriceStackedBarChart. Use WIDTH as the measure and map it as a measure attribute with asDataPoint true.

**LANGUAGE**: ABAP CDS

**CODE**:
```ABAP CDS
@UI.Chart: [
  {
    title: 'Sales Price',
    description: 'Stacked BarChart',
    chartType: #BAR_STACKED,
    measures: [
      'WIDTH'
    ],
    measureAttributes: [
      {
        measure: 'Width',
        role: #AXIS_1,
        asDataPoint: true
      }
    ],
    qualifier: 'SalesPriceStackedBarChart'
  }
]
annotate view STTA_C_MP_PRODUCT with {
}
```

**STEP**: 3 — Add UI.Chart (CAP CDS)

**DESCRIPTION**: In CAP (.cds) model, declare UI.Chart with qualifier #SalesPriceStackedBarChart. Use ChartType #BarStacked, Measures list containing Width, and MeasureAttributes linking to DataPoint @UI.DataPoint#Width.

**LANGUAGE**: CAP CDS

**CODE**:
```CAP CDS
UI.Chart #SalesPriceStackedBarChart : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Sales Price',
    Description : 'Stacked BarChart',
    ChartType : #BarStacked,
    Measures : [
        Width
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Width,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#Width'
        }
    ]
}
```

**STEP**: 4 — Add UI.DataPoint (XML)

**DESCRIPTION**: Create a UI.DataPoint annotation qualified as Width. Ensure Value points to the same entity property used as the measure (Width). Optionally include TargetValue, ForecastValue, Min/Max, and Criticality.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotation Term="UI.DataPoint" Qualifier="Width">
    <Record>
        <PropertyValue Property="Value" Path="Width"/>
        <PropertyValue Property="Description" String="Stacked Bar Micro Chart"/>
        <PropertyValue Property="TargetValue" Path="Weight"/>
        <PropertyValue Property="ForecastValue" Path="Height"/>
        <PropertyValue Property="MinimumValue" Decimal="0"/>
        <PropertyValue Property="MaximumValue" Decimal="100"/>
        <PropertyValue Property="Criticality" Path="criticalityValue"/>
    </Record>
</Annotation>
```

**STEP**: 5 — Add UI.DataPoint (ABAP CDS)

**DESCRIPTION**: Add UI.dataPoint annotation for the Width element in ABAP CDS. The Value is Width and additional properties can be set (target, forecast, min/max, criticality).

**LANGUAGE**: ABAP CDS

**CODE**:
```ABAP CDS
@UI.dataPoint: {
  description: 'Stacked Bar Micro Chart',
  targetValueElement: 'Weight',
  forecastValue: 'Height',
  minimumValue: 0,
  maximumValue: 100,
  criticality: 'criticalityValue'
}
Width;
```

**STEP**: 6 — Add UI.DataPoint (CAP CDS)

**DESCRIPTION**: Define UI.DataPoint #Width in CAP model. Map Value to Width and set optional properties as needed.

**LANGUAGE**: CAP CDS

**CODE**:
```CAP CDS
UI.DataPoint #Width : {
    Value : Width,
    Description : 'Stacked Bar Micro Chart',
    TargetValue : Weight,
    ForecastValue : Height,
    MinimumValue : 0,
    MaximumValue : 100,
    Criticality : criticalityValue
}
```

**STEP**: 7 — Validation / Implementation Checklist

**DESCRIPTION**: Ensure the following properties reference the exact same entity property (Width) to make the stacked bar measure work correctly:
- Chart.Measures -> contains the property name (e.g., Width)
- Chart.MeasureAttributes.Measure -> points to the same property (e.g., Width)
- MeasureAttributes.DataPoint -> references the DataPoint qualifier that defines Value (e.g., @UI.DataPoint#Width)
- DataPoint.Value -> Path set to the same property (e.g., Width)

Failure to align these four references will cause incorrect or missing measure values in the Stacked Bar Micro Chart.
--------------------------------

**TITLE**: Stacked Column Chart Card — Configuration and Annotation Examples for SAP Fiori Elements OVP

**INTRODUCTION**: This document provides concise, code-focused examples and exact configuration patterns to implement a stacked column chart card in an OVP (Overview Page) using Fiori elements. It shows the manifest.json card registration, the OData UI.Chart annotation (XML) to define dimensions/measures with roles (category/series), and an example color palette configuration. Use these snippets as drop-in examples; adapt paths and property names to your service/entity.

**TAGS**: fiori-elements, ovp, stacked-column, chart, annotation, manifest, UI.Chart, category, series, color-palette

STEP: 1 — Register Stacked Column Card in manifest.json

DESCRIPTION: Add a cards entry for the stacked column chart to your application's manifest.json. Use an annotationPath that points to the UI.Chart annotation id in your OData service. Set card template to the chart/card type supported by your OVP runtime (example shows generic chart card template). Include optional settings such as title and a color palette array.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "stackedColumnSales": {
        "template": "sap.ovp.cards.charts", 
        "model": "myODataModel",
        "settings": {
          "title": "Sales by Category (Stacked)",
          "annotationPath": "com.sap.vocabularies.UI.v1.Chart#StackedSales",
          "chartType": "StackedColumn",
          "colorPalette": [
            "#5B8FF9",
            "#61DDAA",
            "#65789B",
            "#F6BD16",
            "#7262fd",
            "#78D3F8"
          ],
          "entitySet": "SalesSet"
        }
      }
    }
  }
}
```

STEP: 2 — Define UI.Chart OData Annotation (XML): Dimensions, Series, Measures

DESCRIPTION: Create a UI.Chart annotation in your service metadata that references the stacked chart. Define at least one Dimension with Role = Category. Optionally define a Dimension with Role = Series to stack by a categorical property. Add each Measure used in the stacked stack. The example below demonstrates a named annotation (annotation id = #StackedSales).

LANGUAGE: XML

CODE:
```xml
<!-- Example EDMX snippet to add to your OData service metadata annotations -->
<Annotations Target="YourServiceNamespace.SalesType">
  <Annotation Term="com.sap.vocabularies.UI.v1.Chart" Qualifier="StackedSales">
    <Record Type="com.sap.vocabularies.UI.v1.ChartType">
      <!-- Set chart type to a stacked column variant -->
      <PropertyValue Property="ChartType" EnumMember="com.sap.vocabularies.UI.v1.ChartType/StackedColumn" />
      <PropertyValue Property="Title" String="Sales by Region and Segment (Stacked)" />
      <PropertyValue Property="Dimensions">
        <Collection>
          <!-- Category dimension: X-axis grouping -->
          <Record Type="com.sap.vocabularies.UI.v1.ChartDimension">
            <PropertyValue Property="Value" Path="Region" />
            <PropertyValue Property="Label" String="Region" />
            <PropertyValue Property="Role" EnumMember="com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Category" />
          </Record>

          <!-- Optional Series dimension: stacks within each category -->
          <Record Type="com.sap.vocabularies.UI.v1.ChartDimension">
            <PropertyValue Property="Value" Path="Segment" />
            <PropertyValue Property="Label" String="Segment" />
            <PropertyValue Property="Role" EnumMember="com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Series" />
          </Record>
        </Collection>
      </PropertyValue>

      <PropertyValue Property="Measures">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.ChartMeasure">
            <PropertyValue Property="Value" Path="SalesAmount" />
            <PropertyValue Property="Label" String="Sales Amount" />
          </Record>
          <!-- Add more measures if stacking by measures (not recommended to mix with series-dimensions) -->
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 3 — Minimal Example: When stacking only by measures (alternative)

DESCRIPTION: If you instead choose to stack measures (rather than a series dimension), omit the Series dimension and include multiple measures. Recommendation: do not mix measure-based stacking with dimension-based series stacking in the same chart.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.Chart" Qualifier="StackedSalesByMeasures">
  <Record>
    <PropertyValue Property="ChartType" EnumMember="com.sap.vocabularies.UI.v1.ChartType/StackedColumn" />
    <PropertyValue Property="Dimensions">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.ChartDimension">
          <PropertyValue Property="Value" Path="Region" />
          <PropertyValue Property="Role" EnumMember="com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Category" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Measures">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.ChartMeasure">
          <PropertyValue Property="Value" Path="SalesAmount" />
          <PropertyValue Property="Label" String="Sales" />
        </Record>
        <Record Type="com.sap.vocabularies.UI.v1.ChartMeasure">
          <PropertyValue Property="Value" Path="Cost" />
          <PropertyValue Property="Label" String="Cost" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 4 — Key Rules and Recommendations (for runtime mapping)

DESCRIPTION: Keep these actionable rules to ensure the stacked chart renders correctly:
- Always provide at least one Dimension with Role = Category (values placed on the x-axis).
- Optional: provide a Dimension with Role = Series to stack categorical segments within each category.
- If you stack by Measures instead, define multiple Measures and do not combine measure-stacking with a series dimension in the same chart.
- Provide a color palette either in the card settings (manifest) or via theme tokens to ensure semantic coloring.
- Ensure the annotationPath in manifest.json matches the Qualifier/ID of the Chart annotation in your service.

LANGUAGE: JSON

CODE:
```json
{
  "rules": [
    "At least one Dimension with Role = Category required",
    "Optional Dimension with Role = Series for categorical stacking",
    "Stack by dimensions OR by measures — do not mix both",
    "Use colorPalette in card settings for semantic colors",
    "annotationPath must reference the Chart annotation qualifier (e.g., #StackedSales)"
  ]
}
```

STEP: 5 — Example Minimal EntitySet and Property Mapping (for reference)

DESCRIPTION: Example entity fields expected by the chart annotations. Replace names with your actual service properties.

LANGUAGE: JSON

CODE:
```json
{
  "EntitySet": "SalesSet",
  "EntityType": "SalesType",
  "Properties": [
    { "name": "Region", "type": "Edm.String" },
    { "name": "Segment", "type": "Edm.String" },
    { "name": "SalesAmount", "type": "Edm.Decimal" },
    { "name": "Cost", "type": "Edm.Decimal" }
  ]
}
```

Use these snippets to: register the card in manifest.json, create the UI.Chart annotation in your OData service metadata (EDMX/XML), and choose stacking either by series-dimension or by measures. Adjust annotation Qualifier, entity names, and property paths to match your backend.
--------------------------------

**TITLE**: Status Colors and Icons — UI Criticality Annotations for Fiori elements

**INTRODUCTION**: Show how to configure status colors and icons for fields in Fiori elements via UI annotations. Use these annotations on UI.LineItem, UI.Identification, and UI.FieldGroup field records to point to a model property that contains the criticality value. Includes XML, ABAP CDS and CAP CDS examples, value mappings, representation behavior, and the OData V4 extension.

**TAGS**: fiori-elements, annotations, ui.lineitem, criticality, ui.identification, ui.fieldgroup, CDS, CAP, ABAP, XML, ODataV4

**STEP**: 1 — Applicable annotations and rule
**DESCRIPTION**: Use the UI annotations UI.LineItem, UI.Identification, and UI.FieldGroup. For each DataField (or equivalent) set the Criticality attribute to reference (Path) a property in your service/entity that contains the criticality value. The referenced property must yield the numeric criticality code (see mapping step).
**LANGUAGE**: Text
**CODE**:
```text
Annotations that support Criticality:
- UI.LineItem -> Record Type="UI.DataField"
- UI.Identification -> Record Type="UI.DataField"
- UI.FieldGroup -> Record Type="UI.DataField"

Action: Add a PropertyValue with Property="Criticality" and Path="<yourCriticalityProperty>" on the DataField record.
```

**STEP**: 2 — XML Annotation example (OData metadata or annotation file)
**DESCRIPTION**: Add a UI.LineItem annotation that references a navigation property to the resource holding the criticality and value. Use PropertyValue with Path to point to the criticality property.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.LineItem">
   <Collection>
      <Record Type="UI.DataField">
         <PropertyValue Property="Criticality" Path="to_ProductStock/StockCriticality"/>
         <PropertyValue Property="Value" Path="to_ProductStock/StockEmergencyLevel"/>
         <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
      </Record>
   </Collection>
</Annotation>
```

**STEP**: 3 — ABAP CDS annotation example
**DESCRIPTION**: Use ABAP CDS UI.lineItem annotation on the projection/entity: set criticality to the path of the property (use the underscore-qualified path syntax in ABAP CDS).
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.lineItem: [
  {
    criticality: '_ProductStock.StockCriticality',
    value: '_ProductStock.StockEmergencyLevel',
    importance: #HIGH
  }
]
```

**STEP**: 4 — CAP CDS annotation example
**DESCRIPTION**: Use CAP CDS UI.LineItem annotation syntax. Reference the attribute by path (to_ProductStock.StockCriticality). Use UI.Importance if needed.
**LANGUAGE**: CDS
**CODE**:
```cds
UI.LineItem : [
    {
        $Type : 'UI.DataField',
        Criticality : to_ProductStock.StockCriticality,
        Value : to_ProductStock.StockEmergencyLevel,
        ![@UI.Importance] : #High
    }
]
```

**STEP**: 5 — Criticality numeric mapping (CriticalityType from com.sap.vocabularies.UI.v1)
**DESCRIPTION**: Implement the referenced property to return these numeric codes. Fiori elements maps these values to colors (and icons, by default).
**LANGUAGE**: Text
**CODE**:
```text
CriticalityType numeric values:
0 -> Neutral
1 -> Negative   (red)
2 -> Critical   (orange)
3 -> Positive   (green)

Note: For OData V4 (see Step 7) an additional value is supported:
5 -> Information (blue)
```

**STEP**: 6 — Icon representation behavior and customizing texts
**DESCRIPTION**: Default behavior and how to change icon rendering and status text:
- By default Fiori elements assumes CriticalityRepresentationType/WithIcon and renders ObjectStatus with the matching icon (e.g. status-negative for Negative).
- If you set CriticalityRepresentationType/WithoutIcon on the DataField, the ObjectStatus is rendered without the icon.
- The property referenced by Criticality can also carry non-static text values (labels) to display as the status text — supply customized strings via that property if you need localized or dynamic texts.
**LANGUAGE**: Text
**CODE**:
```text
Default: WithIcon -> ObjectStatus shows color + corresponding sap-icon://status-<type> (e.g., status-negative).
If annotated with CriticalityRepresentationType/WithoutIcon -> ObjectStatus shows only color + text.

To customize the status text: ensure the property referenced by Path returns the desired text/label (localized or dynamic).
```

**STEP**: 7 — OData V4 specific extension
**DESCRIPTION**: For SAP Fiori elements built on OData V4, support the additional criticality type:
- 5 = Information (blue)
Include this value in your property output if you want an information/blue status in V4 apps.
**LANGUAGE**: Text
**CODE**:
```text
OData V4 additional CriticalityType value:
5 -> Information (blue)

Ensure your OData V4 service returns 5 for the property referenced by Criticality to render a blue information status.
```

**STEP**: 8 — Reference image and visual examples
**DESCRIPTION**: Visual examples for list report and object page status use — include image in docs or design artifacts.
**LANGUAGE**: Text
**CODE**:
```text
Example image path:
images/LROP_Status_Colors_and_Icons_75aa307.png

Use this image in documentation to show how colors/icons look in List Report and Object Page contexts.
```
--------------------------------

**TITLE**: Store and Restore Application State (iAppState) in SAP Fiori elements

**INTRODUCTION**: This guide explains what the Fiori elements iAppState stores/restores and gives concrete, copy-pasteable code patterns for adding custom state handling in extended apps (controller extensions). Use these patterns so that your custom UI elements are included in the saved application state and restored automatically by the Fiori elements framework.

**TAGS**: fiori-elements, iAppState, app-state, state-persistence, sapui5, controller-extension, custom-state, object-page, list-report

STEP: 1 — What the framework stores/restores (summary)

DESCRIPTION: Summary list of UI state items that SAP Fiori elements automatically persists in the iAppState and restores on navigation/refresh/share (applies to List Report and Object Page).

LANGUAGE: Text

CODE:
```Text
- Filter bar: values of filter fields (Go button state when available).
- Variant: chosen variant behaviour
  - OData V2: restores chosen variant if it was stored in a 'clean' state; 'dirty' chosen variant falls back to Standard (dirty indicator).
  - OData V4: chosen variant is restored if available; fallback to Standard only if variant unavailable.
- Object Page: tab/section selection and personalization of lists/charts (via the object page personalization mechanisms).
- Custom UI elements: requires implementing controller extension custom state handlers (see steps below).
Restrictions / Notes:
- Fields annotated PersonalData.v1.IsPotentiallySensitive are not stored/restored (unless used in filter context).
- V2: visibility changes of filter fields are not stored; added filters from Adapt Filters are stored.
- Chart/table selection and table scroll position are not stored.
- FLP must be configured to persist iAppState in backend for URL-based restore after browser refresh.
- V4: drilldown filters applied via View By are not stored/restored.
```

STEP: 2 — Implement custom state capture (controller extension)

DESCRIPTION: Implement getCustomAppStateData() in your controller extension to return a plain object with the state you want stored in the iAppState. The Fiori elements framework calls this method automatically during the iAppState save flow and merges your object into the iAppState payload.

LANGUAGE: JavaScript

CODE:
```javascript
// Example: Controller extension for a Fiori elements page (List Report or Object Page).
// Add this file to your extension folder and register it in manifest if required.
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("my.app.ext.MyPageExtension", {
    /**
     * Called by the framework when the iAppState is created/saved.
     * Return a plain object containing only serializable values (primitives, arrays, objects).
     */
    getCustomAppStateData: function () {
      var oState = {};
      // Example: store a switch state and a selected key from a UI5 control
      var oSwitch = this.byId("mySwitch");
      if (oSwitch) {
        oState.mySwitch = !!oSwitch.getState();
      }
      var oSelect = this.byId("mySelect");
      if (oSelect) {
        oState.mySelectKey = oSelect.getSelectedKey();
      }
      // Include any other small, serializable state you need to persist
      return oState;
    }
  });
});
```

STEP: 3 — Implement state restore (controller extension)

DESCRIPTION: Implement restoreCustomAppStateData(oCustomData) to reapply stored values to your custom UI controls. The framework calls this method when the iAppState is restored (navigation back, URL share, refresh if persisted).

LANGUAGE: JavaScript

CODE:
```javascript
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/base/Log"
], function (Controller, Log) {
  "use strict";

  return Controller.extend("my.app.ext.MyPageExtension", {
    /**
     * Called by the framework with the custom object previously returned by getCustomAppStateData().
     * Ensure this method tolerates missing/older payload shapes for forward/backward compatibility.
     */
    restoreCustomAppStateData: function (oCustomData) {
      if (!oCustomData) {
        return;
      }
      try {
        // Restore switch state
        var oSwitch = this.byId("mySwitch");
        if (oSwitch && typeof oCustomData.mySwitch !== "undefined") {
          oSwitch.setState(!!oCustomData.mySwitch);
        }

        // Restore selected key on a Select control
        var oSelect = this.byId("mySelect");
        if (oSelect && oCustomData.mySelectKey) {
          oSelect.setSelectedKey(oCustomData.mySelectKey);
        }

        // Generic pattern: for each control you persisted, detect presence and set property
        // Keep restore idempotent and safe if control is not rendered yet.
      } catch (e) {
        Log.error("Error restoring custom app state", e);
      }
    }
  });
});
```

STEP: 4 — Restore object page personalization and tab selection (pattern)

DESCRIPTION: For object page controls (tabs, smart tables, smart charts) follow the same capture/restore pattern. Capture necessary keys (for example selectedIconTabKey) in getCustomAppStateData and apply them in restoreCustomAppStateData using control APIs (setSelectedKey or equivalent).

LANGUAGE: JavaScript

CODE:
```javascript
// Capture example (inside getCustomAppStateData)
oState.selectedTab = this.byId("ObjectPageIconTabBar")?.getSelectedKey();

// Restore example (inside restoreCustomAppStateData)
var sTabKey = oCustomData && oCustomData.selectedTab;
if (sTabKey) {
  var oTabBar = this.byId("ObjectPageIconTabBar");
  if (oTabBar && typeof oTabBar.setSelectedKey === "function") {
    oTabBar.setSelectedKey(sTabKey);
  }
}
```

STEP: 5 — Handle sensitive fields and variant differences (guidance)

DESCRIPTION: Follow rules for sensitive fields and variants:
- Do not persist fields annotated with PersonalData.v1.IsPotentiallySensitive (the framework omits them unless used as filter fields). Avoid including such values in getCustomAppStateData output.
- Be aware of variant behavior differences:
  - OData V2: dirty variants may fall back to Standard when restoring.
  - OData V4: chosen variant is restored if available; fallback occurs only if variant unavailable.

LANGUAGE: Text

CODE:
```Text
- Sensitive data: Do not include potentially sensitive values in getCustomAppStateData.
- Variants:
  - OData V2: chosen variant restored only if stored "clean". Dirty chosen variants may revert.
  - OData V4: chosen variant restored if available; otherwise fallback to Standard.
```

STEP: 6 — Sharing and FLP persistence (pattern & notes)

DESCRIPTION: When the app is shared via SAP Fiori Launchpad, the iAppState key is typically added to the shared URL (FLP configuration must persist iAppState in the backend for reliable restore after browser refresh). Use FLP services (CrossApplicationNavigation / AppState) to build or query shareable URLs if needed. The framework normally integrates iAppState into the Share dialog.

LANGUAGE: Text

CODE:
```Text
- The launchpad inserts the app-state key into the URL (sap-iapp-state or equivalent parameter).
- Ensure FLP AppState persistence is enabled if you need restore after a full browser refresh.
- If you build custom Share buttons, use FLP services (CrossApplicationNavigation, AppState) to obtain hrefForExternal and include the app state key produced by the framework.
```

STEP: 7 — Merging changes from other flex layers (behavior notes)

DESCRIPTION: When restoring iAppState, Fiori elements merges end-user personalization present in iAppState with other flex-layer changes (key-user changes) when the variant from iAppState is available. There are scenarios where merging does not occur (e.g., dynamic tiles created by user via Save as Tile or integration cards).

LANGUAGE: Text

CODE:
```Text
- Normal merge: changes from other flex layers (key-user) are merged with iAppState user personalization when variant in iAppState is available.
- Exceptions (no merge): navigating from user-created dynamic tiles or from integration cards — end-user changes are not retained by design.
- If the variant in the iAppState is unavailable to the target user, the app loads the Standard variant and applies the full shared state on top; removed columns/fields or position changes may not be retained.
- For single-valued fields, the merge logic gives priority to the iAppState value over other-layer values.
```

STEP: 8 — Testing checklist

DESCRIPTION: Use this checklist to validate store/restore behavior during development and after deployment.

LANGUAGE: Text

CODE:
```Text
- Test filter values persist after navigation away + back.
- Test chosen variant behavior (V2 vs V4) — clean vs dirty variants.
- Test object page tab selection and personalization restored.
- Test custom controls: toggle -> save -> navigate back -> verify restore.
- Test that sensitive fields are not stored/restored.
- Test URL share: click Share -> open shared URL in a new session -> verify state restored.
- Test behavior when variants are unavailable to a target user (shared URL scenario).
```


--------------------------------

**TITLE**: Support for Extended OData Annotations (OData V4) — Examples and Usage

**INTRODUCTION**: This document provides actionable, code-focused examples for using extended OData V4 annotations supported by SAP Fiori elements. It shows how to use IF-expressions for dynamic behavior (FieldControl, UI.Hidden, OperationAvailable, Update/Insert/DeleteRestrictions) and how to use the odata.concat function for object page header titles. Use these snippets in your OData annotation XML files (local annotation files or service metadata extensions).

**TAGS**: fiori-elements-framework, odata-v4, annotations, FieldControl, UI.Hidden, OperationAvailable, UpdateRestrictions, InsertRestrictions, DeleteRestrictions, odata.concat

**STEP**: 1 — Applicability

**DESCRIPTION**: Confirm that your application uses SAP Fiori elements for OData V4. The extended annotations and IF-expression support shown below apply only to OData V4 based Fiori elements apps.

**LANGUAGE**: Text

**CODE**:
```text
Applicable only for: SAP Fiori elements for OData V4
```

**STEP**: 2 — Supported Annotation Terms

**DESCRIPTION**: Use IF-expressions and dynamic evaluations with these annotation terms in OData V4. Each term supports conditional expressions as shown in the examples below.

**LANGUAGE**: Text

**CODE**:
```text
Supported annotation terms:
- com.sap.vocabularies.Common.v1.FieldControl
- com.sap.vocabularies.UI.v1.Hidden (UI.Hidden)
- com.sap.vocabularies.Common.v1.OperationAvailable (Core.OperationAvailable)
- Capabilities.UpdateRestrictions (SAP__capabilities.UpdateRestrictions)
- Capabilities.InsertRestrictions (SAP__capabilities.InsertRestriction)
- Capabilities.DeleteRestrictions (SAP__capabilities.DeleteRestriction)
```

**STEP**: 3 — FieldControl with IF-expression (XML example)

**DESCRIPTION**: Dynamic FieldControl using an If expression. The example compares the property FieldControlDynamicIfValue to integer 5. If equal, return EnumMember Common.FieldControlType/ReadOnly, otherwise Common.FieldControlType/Optional. Use Target to point to the annotated element (entity or field).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="sap.fe.core.FieldEdit.RootEntity/FieldControlDynamicIf">
    <Annotation Term="com.sap.vocabularies.Common.v1.FieldControl">
        <If>
            <Eq>
                <Path>FieldControlDynamicIfValue</Path>
                <Int>5</Int>
            </Eq>
            <EnumMember>Common.FieldControlType/ReadOnly</EnumMember>
            <EnumMember>Common.FieldControlType/Optional</EnumMember>
        </If>
    </Annotation>
</Annotations>
```

**STEP**: 4 — UpdateRestrictions / InsertRestrictions (NavigationRestrictions example)

**DESCRIPTION**: Configure navigation property level restrictions with dynamic Insertable and Updatable values. Example uses Capabilities.NavigationRestrictions -> RestrictedProperties collection. For InsertRestrictions, the Insertable value comes from a Path (owner/isVerified). For UpdateRestrictions, Updatable is calculated via an If expression using Or + Eq (Null or empty string) on owner/isVerified, returning Bool false or Bool true accordingly.

Keep the Target/Annotation placement where navigation restrictions are defined (e.g., entity or navigation property annotation).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="Capabilities.NavigationRestrictions">
    <Record Type="Capabilities.NavigationRestrictionsType">
        <PropertyValue Property="RestrictedProperties">
            <Collection>
                <Record Type="Capabilities.NavigationPropertyRestriction">
                    <PropertyValue Property="NavigationProperty" NavigationPropertyPath="_Item" />
                    <PropertyValue Property="InsertRestrictions">
                        <Record Type="Capabilities.InsertRestrictionsType">
                            <!-- Insertable bound to a data path -->
                            <PropertyValue Property="Insertable" Path="owner/isVerified" />
                        </Record>
                    </PropertyValue>
                    <PropertyValue Property="UpdateRestrictions">
                        <Record Type="Capabilities.UpdateRestrictionsType">
                            <PropertyValue Property="Updatable">
                                <If>
                                    <Or>
                                        <Eq>
                                            <Null />
                                            <Path>owner/isVerified</Path>
                                        </Eq>
                                        <Eq>
                                            <String />
                                            <Path>owner/isVerified</Path>
                                        </Eq>
                                    </Or>
                                    <Bool>false</Bool>
                                    <Bool>true</Bool>
                                </If>
                            </PropertyValue>
                        </Record>
                    </PropertyValue>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 5 — odata.concat on Object Page Header Title (XML example)

**DESCRIPTION**: Use the odata.concat function to construct the object page header title by concatenating DB values (e.g., CompanyName and LegalForm) and optional literal strings. Place this under the HeaderInfo.Title DataField of the relevant entity (Target points to the entity, e.g., SAP__self.BusinessPartner).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="SAP__self.BusinessPartner">
    <Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo">
        <Record Type="com.sap.vocabularies.UI.v1.HeaderInfoType">
            <PropertyValue Property="TypeName" String="Business Partner" />
            <PropertyValue Property="TypeNamePlural" String="Business Partners" />
            <PropertyValue Property="Title">
                <Record Type="com.sap.vocabularies.UI.v1.DataField">
                    <PropertyValue Property="Label" String="Name" />
                    <PropertyValue Property="Value">
                        <Apply Function="odata.concat">
                            <Path>CompanyName</Path>
                            <String />
                            <Path>LegalForm</Path>
                        </Apply>
                    </PropertyValue>
                </Record>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```
--------------------------------

**TITLE**: Support for Terminologies (SAP Fiori elements, OData V4)

**INTRODUCTION**: Configure SAPUI5 terminologies so a Fiori elements application can switch wording for different scenarios/industries. This requires: (1) enhancing a ResourceModel in the app descriptor (manifest.json) with a terminology bundle and (2) adding that model (or resource files) to the SAP Fiori elements template via enhanceI18n. Applicable only to SAP Fiori elements for OData V4.

**TAGS**: fiori-elements-framework, i18n, terminologies, sapui5, manifest.json, app-descriptor, odata-v4

**STEP**: 1 — Define a resource model with terminologies in manifest.json

**DESCRIPTION**: Add or update the "models" section in manifest.json to include a ResourceModel that declares a terminology object. Use bundleUrlRelativeTo: "manifest" for manifest-relative paths. Provide supportedLocales and fallbackLocale as needed.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "models": {
    "i18n": {
      "type": "sap.ui.model.resource.ResourceModel",
      "settings": {
        "bundleUrl": "i18n/i18n.properties",
        "supportedLocales": ["en", "de"],
        "fallbackLocale": "en",
        "terminologies": {
          "travel": {
            "bundleUrl": "i18n/terminologies/travel/i18n.terminologies.travel.properties",
            "bundleUrlRelativeTo": "manifest",
            "supportedLocales": ["en", "de"]
          }
        }
      }
    }
    /* other models... */
  }
}
```

**STEP**: 2 — Add the resource model (or resource files) to the SAP Fiori elements template via enhanceI18n

**DESCRIPTION**: The Fiori elements template does not automatically consume enhanced models. In the route/target component settings of the manifest, add an enhanceI18n array containing resource file paths and/or model names (model keys from "models"). The template resolves i18n keys by checking entries in the array from last to first; the last element has highest priority. Models without terminologies are allowed but will not trigger terminology substitution.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "targets": {
    "LineItemsList": {
      "type": "Component",
      "id": "LineItemsList",
      "name": "sap.fe.templates.ListReport",
      "options": {
        "settings": {
          "contextPath": "/LineItems",
          "enhanceI18n": [
            "i18n/ManageItemsListReport.properties",
            "i18n"
          ],
          "variantManagement": "Page",
          "initialLoad": true,
          "navigation": {
            "LineItems": {
              "detail": {
                "route": "LineItemsObjectPage"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Terminology bundle file placement and naming

**DESCRIPTION**: Store terminology resource bundles under a path referenced by the terminology bundleUrl. Example filename in sample model: i18n/terminologies/travel/i18n.terminologies.travel.properties. Use manifest-relative paths if bundleUrlRelativeTo is "manifest". Provide localized variants as needed (e.g., i18n.terminologies.travel_de.properties).

**LANGUAGE**: JSON (path examples)

**CODE**:
```json
// Example file paths (place under your webapp folder)
"i18n/i18n.properties"
"i18n/ManageItemsListReport.properties"
"i18n/terminologies/travel/i18n.terminologies.travel.properties"
"i18n/terminologies/travel/i18n.terminologies.travel_de.properties"
```

**STEP**: 4 — Key resolution behavior and guidance

**DESCRIPTION**: When enhanceI18n contains multiple entries, lookup order is:
- Check the last element in enhanceI18n array (highest priority).
- If key not found, check previous elements in reverse order.
- If still not found, fallback to the template default texts.

Notes:
- enhanceI18n accepts any mix of resource file paths and model names.
- If a model in enhanceI18n has an attached terminology, terminology-aware keys will be substituted accordingly.
- Models without terminology will not trigger terminology substitutions even if a terminology is activated elsewhere.

**LANGUAGE**: JSON (behavior summary)

**CODE**:
```json
// Example: enhanceI18n: ["fileA.properties", "modelKey"]
// Resolution order:
// 1) modelKey (last element)
// 2) fileA.properties
// 3) template defaults
```

**STEP**: 5 — Reference

**DESCRIPTION**: For conceptual background on terminologies (concept details, recommended key patterns), refer to the SAP documentation page: Terminologies (local docs path in repository).

**LANGUAGE**: Text

**CODE**:
```text
See: ../04_Essentials/terminologies-eba8d25.md
```
--------------------------------

**TITLE**: Table Cards — manifest and annotation configuration for SAP Fiori elements (OVP)

**INTRODUCTION**: Practical, code-focused reference for creating and configuring table cards (3-column layout) in SAP OVP/Fiori elements. Includes manifest (sap.ovp) card settings and required OData/UI annotations (XML, ABAP CDS, CAP CDS), plus examples for units, KPIs, presentation/selection variants, line items, smart links, contact info, text arrangement, and alignment behavior.

**TAGS**: ovp, fiori-elements, manifest, annotations, LineItem, DataPoint, KPI, PresentationVariant, SelectionVariant, smart-links, sap.ovp.cards.v4.table

**STEP**: 1 — Card descriptor: basic manifest settings (title, subTitle, entitySet, template)
**DESCRIPTION**: Add a table card entry to webapp/manifest.json under sap.ovp.cards. For OData V2 use template "sap.ovp.cards.table"; for OData V4 use "sap.ovp.cards.v4.table". Configure title, subTitle, entitySet, annotation paths, and disableTableCardFlexibility as needed.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters",
    "disableTableCardFlexibility": false,
    "cards": {
      "card014": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.table",
        "settings": {
          "title": "Sales Forecast",
          "subTitle": "per Supplier",
          "entitySet": "SalesShare",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line"
        }
      }
    }
  }
}
```

**STEP**: 2 — Display unit of measure: metadata sap:unit or ISOCurrency annotation
**DESCRIPTION**: To show units next to numeric values, either add sap:unit in the OData metadata (EDM) or add Org.OData.Measures.V1.ISOCurrency in annotations. Use metadata for direct binding, or annotation for annotation-driven UoM.
**LANGUAGE**: XML (metadata)
**CODE**:
```xml
<!-- Option 1: OData metadata (Schema <EntityType>/<Property>) -->
<Property Name="CurrencyCode" Type="Edm.String" MaxLength="5" sap:label="Currency" sap:updatable="false" sap:semantics="currency-code"/>
<Property Name="GrossAmount" Type="Edm.Decimal" Precision="16" Scale="3" sap:unit="CurrencyCode" sap:label="Gross Amt." sap:creatable="false" sap:updatable="false"/>
```
**LANGUAGE**: XML (annotation)
**CODE**:
```xml
<!-- Option 2: Annotation document -->
<Annotations Target="GWSAMPLE_BASIC.SalesOrder/GrossAmount">
  <Annotation Term="Org.OData.Measures.V1.ISOCurrency" Path="CurrencyCode"/>
</Annotations>
```

**STEP**: 3 — KPI annotation: descriptor + UI.KPI examples (XML, ABAP CDS, CAP CDS)
**DESCRIPTION**: Set the KPI annotation path in sap.ovp.kpiAnnotationPath in manifest. Provide UI.KPI annotation (XML/ABAP/CDS) with DataPoint, Detail, PresentationVariant references.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ovp": {
    "kpiAnnotationPath": "com.sap.vocabularies.UI.v1.KPI#AllActualCosts"
  }
}
```
**LANGUAGE**: XML
**CODE**:
```xml
<!-- UI.KPI XML sample (qualifier Eval_by_Country-Generic) -->
<Annotation Term="UI.KPI" Qualifier="Eval_by_Country-Generic">
  <Record>
    <PropertyValue Property="DataPoint" Path="@UI.DataPoint#Eval_by_Country-Generic" />
    <PropertyValue Property="Detail">
      <Record Type="UI.KPIDetailType">
        <PropertyValue Property="DefaultPresentationVariant" Path="@UI.PresentationVariant#Eval_by_Currency1" />
        <PropertyValue Property="AlternativePresentationVariants">
          <Collection>
            <Path>@UI.PresentationVariant#Eval_by_Currency_Column</Path>
          </Collection>
        </PropertyValue>
        <PropertyValue String="Action" Property="SemanticObject" />
        <PropertyValue String="toappnavsample" Property="Action" />
      </Record>
    </PropertyValue>
    <PropertyValue String="String for KPI Annotation" Property="ID" />
    <PropertyValue Property="SelectionVariantQualifier" Path="@UI.SelectionVariant#Eval_by_Currency_1" />
  </Record>
</Annotation>

<!-- DataPoint XML referenced above -->
<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Country_Generic">
  <Record>
    <PropertyValue Property="Value" Path="Currency" />
    <PropertyValue String="test" Property="Title" />
  </Record>
</Annotation>
```
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.KPI: [
  {
    detail: {
      defaultPresentationVariantQualifier: 'Eval_by_Currency1',
      alternativePresentationVariantQualifiers: [ 'Eval_by_Currency_Column' ],
      semanticObject: 'Action',
      semanticObjectAction: 'toappnavsample'
    },
    selectionVariantQualifier: 'Eval_by_Currency_1',
    id: 'String for KPI Annotation',
    qualifier: 'Eval_by_Country-Generic',
    dataPoint.title: 'test'
  }
]
```
**LANGUAGE**: CAP CDS
**CODE**:
```cds
UI.KPI #AllActualCosts : {
  $Type : 'UI.KPIType',
  Detail : {
    $Type : 'UI.KPIDetailType',
    DefaultPresentationVariant : ![@UI.PresentationVariant#Eval_by_Currency1],
    AlternativePresentationVariants : [ ![@UI.PresentationVariant#Eval_by_Currency_Column] ],
    SemanticObject : 'Action',
    Action : 'toappnavsample'
  },
  SelectionVariant : ![@UI.SelectionVariant#Eval_by_Currency_1],
  DataPoint : ![@UI.DataPoint#Eval_by_Country-Generic],
  ID : 'String for KPI Annotation'
},
```

**STEP**: 4 — PresentationVariant and SelectionVariant (sorting, grouping, parameters)
**DESCRIPTION**: Define PresentationVariant qualifier to control maxItems, groupBy, sortOrder, visualizations. Use SelectionVariant to predefine select options and parameters (card-level filters).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- PresentationVariant XML (qualifier Eval_by_Currency1) -->
<Annotation Term="UI.PresentationVariant" Qualifier="Eval_by_Currency1">
  <Record>
    <PropertyValue Property="MaxItems" Int="5" />
    <PropertyValue Property="GroupBy">
      <Collection>
        <PropertyPath>Country</PropertyPath>
        <PropertyPath>Currency</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record>
          <PropertyValue Property="Property" PropertyPath="TotalSales" />
          <PropertyValue Property="Descending" Bool="true" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
        <AnnotationPath>@UI.Chart#Eval_by_Currency_Donut</AnnotationPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```
**LANGUAGE**: CAP CDS
**CODE**:
```cds
UI.SelectionVariant #Eval_by_Currency_1 : {
  SelectOptions : [
    { PropertyName : Country, Ranges : [ { Sign : #I, Option : #EQ, Low : 'IN' } ] }
  ],
  Parameters : [
    { $Type : 'UI.Parameter', PropertyName : Currency_Target, PropertyValue : 'EUR' },
    { $Type : 'UI.Parameter', PropertyName : UoM_Target, PropertyValue : 'KGM' }
  ]
}
```

**STEP**: 5 — DataPoint annotation (value, formatting, criticality, trend)
**DESCRIPTION**: Define UI.DataPoint or @UI.dataPoint to show value, title, format, criticality calculation, target, and trend. DataPoint can be referenced by DataFieldForAnnotation (third column).
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Country_Generic">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Sales India - Generic Card" />
    <PropertyValue Property="Value" Path="Sales" />
    <PropertyValue Property="ValueFormat">
      <Record>
        <PropertyValue Property="ScaleFactor" Decimal="2" />
        <PropertyValue Property="NumberOfFractionalDigits" Int="1" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="CriticalityCalculation">
      <Record>
        <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Minimize" />
        <PropertyValue Property="DeviationRangeHighValue" String="7300" />
        <PropertyValue Property="ToleranceRangeHighValue" String="7200" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="TargetValue" String="2.000" />
    <PropertyValue Property="TrendCalculation">
      <Record>
        <PropertyValue Property="ReferenceValue" String="5201680" />
        <PropertyValue Property="DownDifference" Decimal="10000000.0" />
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.dataPoint: {
  title: 'Sales India - Generic Card',
  valueFormat: { scaleFactor: 2, numberOfFractionalDigits: 1 },
  criticalityCalculation: {
    improvementDirection: #MINIMIZE,
    deviationRangeHighValue: 7300,
    toleranceRangeHighValue: 7200
  },
  targetValue: 2.000,
  trendCalculation: { referenceValue: 'refValElement', downDifference: 10000000.0 }
}
Sales;
```

**STEP**: 6 — Configure LineItem: table columns via com.sap.vocabularies.UI.v1.LineItem
**DESCRIPTION**: Use LineItem (optionally with qualifier) to declare DataField and DataFieldForAnnotation. DataFieldForAnnotation with Target referencing a DataPoint is used for third column highlighting. If manifest annotationPath is qualified, that LineItem#Qualifier is used.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- LineItem without qualifier (default) -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Order ID"/>
      <PropertyValue Property="Value" Path="SalesOrderID"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
      <PropertyValue Property="Label" String="TaxAmount"/>
      <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.DataPoint#TaxAmount"/>
    </Record>
  </Collection>
</Annotation>

<!-- LineItem with qualifier (View4) -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem" Qualifier="View4"> ... </Annotation>
```
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.lineItem: [{ label: 'Order ID', position: 10, qualifier: 'View4' }]
SALESORDERID;

@UI.lineItem: [{ label: 'TaxAmount', valueQualifier: 'TaxAmount', type: #AS_DATAPOINT, position: 40, qualifier: 'View4' }]
PROPERTY_NAME;
```
**LANGUAGE**: CAP CDS
**CODE**:
```cds
UI.LineItem #View4 : [
  { $Type : 'UI.DataField', Label : 'Order ID', Value : SalesOrderID },
  { $Type : 'UI.DataFieldForAnnotation', Label : 'TaxAmount', Target : '@UI.DataPoint#TaxAmount' }
]
```

**STEP**: 7 — Manifest: set annotationPath with qualifier per card instance
**DESCRIPTION**: Use different LineItem qualifiers for multiple cards on the same entityType by setting annotationPath with qualifier in the card settings.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card02": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.table",
        "settings": {
          "title": "Sales Orders With Analytical Header",
          "subTitle": "Sales Orders With Analytical Header",
          "listFlavor": "bar",
          "listType": "extended",
          "entitySet": "SalesOrderSet",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line_without_trend",
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line"
        }
      }
    }
  }
}
```

**STEP**: 8 — Example: Product Name, Supplier, WeightMeasure (3-column table)
**DESCRIPTION**: Example shows DataPoint qualifier WeightMeasure used as DataFieldForAnnotation third column; first two columns are DataField properties (Name, SupplierName).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- DataPoint for WeightMeasure -->
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="WeightMeasure">
  <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
    <PropertyValue Property="Title" String="Weight"/>
    <PropertyValue Property="Description" Path="Name"/>
    <PropertyValue Property="Value" Path="WeightMeasure"/>
    <PropertyValue Property="CriticalityCalculation">
      <Record>
        <PropertyValue Property="ImprovementDirection" EnumMember="com.sap.vocabularies.UI.v1.CriticalityCalculationType/Maximize"/>
        <PropertyValue Property="ToleranceRangeLowValue" Int="2"/>
        <PropertyValue Property="DeviationRangeLowValue" Int="4"/>
      </Record>
    </PropertyValue>
  </Record>
</Annotation>

<!-- LineItem: first two DataFields + DataFieldForAnnotation referencing DataPoint -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataField"><PropertyValue Property="Label" String="Product ID"/><PropertyValue Property="Value" Path="ProductID"/></Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField"><PropertyValue Property="Label" String="Product Name"/><PropertyValue Property="Value" Path="Name"/><Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/High"/></Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"><PropertyValue Property="Label" String="Weight Measure"/><PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.DataPoint#WeightMeasure"/></Record>
  </Collection>
</Annotation>
```
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.dataPoint: { title: 'Weight', description: 'Name', valueFormat: { scaleFactor: 2, numberOfFractionalDigits: 1 }, criticalityCalculation: { improvementDirection: #MAXIMIZE, deviationRangeHighValue: 4.3, toleranceRangeHighValue: 2.5 } }
WeightMeasure;

@UI.lineItem: [{ label: 'Product ID', position: 10 }] PRODUCTID;
@UI.lineItem: [{ importance: #HIGH, label: 'Product Name', position: 30 }] NAME;
@UI.lineItem: [{ label: 'Weight Measure', valueQualifier: 'WeightMeasure', type: #AS_DATAPOINT, position: 60 }] PROPERTY_NAME;
```

**STEP**: 9 — Smart links: semantic object on entity property
**DESCRIPTION**: Enable smart links by annotating the property with SemanticObject. Use XML annotation or CDS variants.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="GWSAMPLE_BASIC.SalesOrder/SalesOrderID">
  <Annotation Term="com.sap.vocabularies.Common.v1.SemanticObject" String="OVP" />
</Annotations>
```
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
annotate view SALESORDER with {
  @Consumption.semanticObject: 'OVP'
  salesorderid;
}
```
**LANGUAGE**: CAP CDS
**CODE**:
```cds
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.SemanticObject : 'OVP'
  SalesOrderID
};
```

**STEP**: 10 — Contact information using Communication.Contact annotation
**DESCRIPTION**: Use DataFieldForAnnotation to reference ToBusinessPartner/@Communication.Contact to display contact details (phone/email) in table card rows.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- LineItem referencing contact annotation -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem" Qualifier="NewSalesOrders">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataField"><PropertyValue Property="Label" String="Order ID (Company)"/><PropertyValue Property="Value" Path="SalesOrderID"/></Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"><PropertyValue Property="Label" String="Created by (Role)" /><PropertyValue Property="Target" AnnotationPath="ToBusinessPartner/@com.sap.vocabularies.Communication.v1.Contact" /></Record>
  </Collection>
</Annotation>

<!-- Communication.Contact sample -->
<Annotation Term="com.sap.vocabularies.Communication.v1.Contact">
  <Record>
    <PropertyValue Property="tel">
      <Collection>
        <Record><PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/fax" /><PropertyValue Property="uri" Path="FaxNumber" /></Record>
        <Record><PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/work com.sap.vocabularies.Communication.v1.PhoneType/preferred" /><PropertyValue Property="uri" Path="PhoneNumber" /></Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="email">
      <Collection>
        <Record><PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.ContactInformationType/preferred com.sap.vocabularies.Communication.v1.ContactInformationType/work" /><PropertyValue Property="address" Path="EmailAddress" /></Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```
**LANGUAGE**: CAP CDS
**CODE**:
```cds
UI.LineItem #NewSalesOrders : [
  { $Type : 'UI.DataField', Label : 'Order ID (Company)', Value : SalesOrderID },
  { $Type : 'UI.DataFieldForAnnotation', Label : 'Created by (Role)', Target : 'ToBusinessPartner/@Communication.Contact' }
]

Communication.Contact : {
  tel : [ { type : #fax, uri : FaxNumber }, { type : [ #work, #pref ], uri : PhoneNumber } ],
  email : [ { type : [ #pref, #work ], address : EmailAddress } ]
}
```

**STEP**: 11 — TextArrangement: display text relative to key (TextFirst/TextLast/TextOnly)
**DESCRIPTION**: Annotate the property with Common.Text and UI.TextArrangement to control text formatting shown in table cells (e.g., "Customer (ID)" vs "ID (Customer)" vs "Customer").
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="GWSAMPLE_BASIC.SalesOrder/CustomerID">
  <Annotation Term="com.sap.vocabularies.Common.v1.Text" Path="Supplier_Name">
    <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast" />
  </Annotation>
</Annotations>
```
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
annotate view SALESORDER with {
  @UI.TextArrangement: #TEXT_LAST
  customerid;
}
```
**LANGUAGE**: CAP CDS
**CODE**:
```cds
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.Text : Supplier_Name
  @UI.TextArrangement : #TextLast
  CustomerID
};
```

**STEP**: 12 — Text alignment rules (summary)
**DESCRIPTION**: Use this quick mapping when choosing DataField/DataPoint types for expected alignment in the table column:
- DataField or Contact annotation => left aligned
- DataPoint or DataField of Edm.DateTime/Edm.DateTimeOffset => right aligned
- DataPoint with Criticality or DataPoint with Edm.String property => center aligned
**LANGUAGE**: JSON
**CODE**:
```json
{
  "alignmentRules": [
    { "annotationField": "DataField or Contact", "tableAlignment": "Left" },
    { "annotationField": "DataPoint OR DataField property type Edm.DateTime/Edm.DateTimeOffset", "tableAlignment": "Right" },
    { "annotationField": "DataPoint with Criticality OR DataPoint with property type Edm.String", "tableAlignment": "Center" }
  ]
}
```
--------------------------------

**TITLE**: Table Groupings (SAP Fiori elements)

**INTRODUCTION**: Practical reference for enabling, configuring, and restricting row groupings in SAP Fiori elements tables. Covers supported table types, UI5 integration points for grouping headers, formatting behavior for common OData types, how to disable grouping (OData V4), and how to define default grouping and totals via PresentationVariant annotations (XML and CAP CDS).

**TAGS**: fiori-elements-framework, grouping, analytical-table, responsive-table, ODataV2, ODataV4, PresentationVariant, manifest.json, annotations, UI5

**STEP**: Supported table types and high-level restrictions

**DESCRIPTION**: Which table types support grouping and key analytic restrictions you must obey when implementing grouping.

**LANGUAGE**: Text

**CODE**:
```Text
Supported tables:
- sap.m.Table (Responsive Table) -> grouping supported
- sap.ui.Table.AnalyticalTable -> grouping supported
- GridTable and TreeTable -> NOT supported

Analytical table restrictions:
- Grouping can only be activated for dimension (non-aggregatable) columns.
- Grouping is performed server-side; header formatters do not change grouping keys.
- TextArrangement annotation is NOT supported for grouping headers in analytical tables.
- Displaying values with units of measure is NOT supported in analytical table grouping headers.
```

**STEP**: OData V2 — Set grouping header text (UI5 integration)

**DESCRIPTION**: How SAP Fiori elements automatically wires grouping header formatters and how to explicitly set or emulate grouping keys in UI5 code. Provide examples for ResponsiveTable (Sorter.fnGroup) and AnalyticalTable (AnalyticalColumn.groupHeaderFormatter).

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// Responsive table: set grouping function on a Sorter.
// The third parameter can be a grouping function that returns the group key for each context.
var oSorter = new sap.ui.model.Sorter("Country", /*descending*/ false,
    function (oContext) {
        // return grouping key for the group header
        return oContext.getProperty("Country"); // or any formatted label
    }
);

// Example: binding with sorters (inside a controller)
this.byId("myResponsiveTable").getBinding("items").sort([oSorter]);

// Analytical table: set groupHeaderFormatter on AnalyticalColumn.
// groupHeaderFormatter receives a Context/Value depending on API; return the header text.
var oAnalyticalColumn = new sap.ui.table.AnalyticalColumn({
    label: "Country",
    template: new sap.m.Text({ text: "{Country}" }),
    // groupHeaderFormatter will be used to display the header for a group
    groupHeaderFormatter: function (vValueOrContext) {
        // vValueOrContext may be the raw value or a context; return formatted header text
        if (!vValueOrContext) {
            return "";
        }
        // Example: if passed a context
        if (vValueOrContext.getProperty) {
            return vValueOrContext.getProperty("Country");
        }
        // otherwise assume a raw value
        return String(vValueOrContext);
    }
});
```

**STEP**: Grouping header types and formatting behavior

**DESCRIPTION**: Mapping of common OData types and SAP display formats to the unformatted value and the formatted header text SAP Fiori elements produces for grouping headers. Use these patterns to anticipate group header display and to implement custom formatters if required.

**LANGUAGE**: JSON

**CODE**:
```JSON
[
  {
    "ODataType": "Edm.DateTimeOffsetDate",
    "SAPDisplayFormat": "Date",
    "ODataExample": "/Date(1485471600000 +0000)/",
    "Unformatted": "Fri Jan 27 2017 00:00:00 GMT+0100 (CET)",
    "Formatted": "Jan 26, 2017",
    "Comments": "UTC"
  },
  {
    "ODataType": "Edm.DateTimeOffset",
    "SAPDisplayFormat": "",
    "ODataExample": "/Date(1485471600000 +0000)/",
    "Unformatted": "Fri Jan 27 2017 00:00:00 GMT+0100 (CET)",
    "Formatted": "Jan 27, 2017, 12:00:00 AM",
    "Comments": ""
  },
  {
    "ODataType": "Edm.DateTime",
    "SAPDisplayFormat": "Date",
    "ODataExample": "/Date(1485471600000 +0000)/",
    "Unformatted": "Fri Jan 27 2017 00:00:00 GMT+0100 (CET)",
    "Formatted": "Jan 26, 2017",
    "Comments": "UTC"
  },
  {
    "ODataType": "Edm.DateTime",
    "SAPDisplayFormat": "",
    "ODataExample": "/Date(1485471600000 +0000)/",
    "Unformatted": "Fri Jan 27 2017 00:00:00 GMT+0100 (CET)",
    "Formatted": "Jan 27, 2017, 12:00:00 AM",
    "Comments": ""
  },
  {
    "ODataType": "Edm.Time",
    "SAPDisplayFormat": "Time",
    "ODataExample": "PT11H13M01S",
    "Unformatted": "[object Object] -> {ms: 43980000, __edmType: 'Edm.Time'}",
    "Formatted": "11:13:01 AM",
    "Comments": ""
  },
  {
    "ODataType": "Edm.String",
    "SAPDisplayFormat": "Date",
    "ODataExample": "20180313",
    "Unformatted": "20180313",
    "Formatted": "Mar 13, 2018",
    "Comments": ""
  },
  {
    "ODataType": "Edm.Boolean",
    "SAPDisplayFormat": "",
    "ODataExample": "true",
    "Unformatted": "true",
    "Formatted": "Yes",
    "Comments": ""
  },
  {
    "ODataType": "Edm.Decimal",
    "SAPDisplayFormat": "",
    "ODataExample": "10",
    "Unformatted": "10",
    "Formatted": "10.000 m*",
    "Comments": "Unit of measure"
  },
  {
    "ODataType": "Edm.Decimal",
    "SAPDisplayFormat": "",
    "ODataExample": "2498.00",
    "Unformatted": "2498.00",
    "Formatted": "2,498.00 EUR*",
    "Comments": "Currency"
  },
  {
    "ODataType": "Edm.String",
    "SAPDisplayFormat": "",
    "ODataExample": "m",
    "Unformatted": "m",
    "Formatted": "Meter (m)*",
    "Comments": "Unit of measure and TextArrangement"
  },
  {
    "ODataType": "Edm.String",
    "SAPDisplayFormat": "",
    "ODataExample": "EUR",
    "Unformatted": "EUR",
    "Formatted": "Euro (EUR)*",
    "Comments": "Currency and TextArrangement"
  }
]
```

Note: Units of measure or currencies in grouping headers are supported only in responsive tables (not in analytical table grouping headers).

**STEP**: OData V4 — Disable grouping for responsive tables via manifest.json

**DESCRIPTION**: Use the table personalization settings in the manifest to turn off grouping at runtime for a responsive table.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
    "tableSettings": {
      "type": "ResponsiveTable",
      "condensedTableLayout": true,
      "personalization": {
        "column": true,
        "sort": false,
        "group": false
      }
      // ...
    }
  }
}
```

**STEP**: Define default groups and totals (PresentationVariant — XML and CAP CDS)

**DESCRIPTION**: How to define default group levels and totals loaded at application start. Use UI.PresentationVariant or SelectionPresentationVariant. Provide examples for XML annotation and CAP CDS. Important: PresentationVariant.Visualizations must be provided.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotations Target="sap.fe.managepartners.ManagePartnersService.EntityContainer/BusinessPartners">
  <Annotation Term="UI.PresentationVariant">
    <Record Type="UI.PresentationVariantType">
      <PropertyValue Property="GroupBy">
        <Collection>
          <PropertyPath>Country</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Total">
        <Collection>
          <PropertyPath>SalesAmount</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Visualizations">
        <Collection>
          <AnnotationPath>@UI.Chart</AnnotationPath>
          <AnnotationPath>@UI.LineItem</AnnotationPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: CDS

**CODE**:
```CDS
// CAP CDS PresentationVariant example
annotate ViewOrEntity with {
  @UI.PresentationVariant : {
    GroupBy : [ Country ],
    Total : [ SalesAmount ],
    Visualizations : [ '@UI.Chart', '@UI.LineItem' ]
  }
};
```

**STEP**: PresentationVariant behavior, defaults, and runtime restrictions

**DESCRIPTION**: Operational notes and restrictions to implementers about defaults and runtime behavior.

**LANGUAGE**: Text

**CODE**:
```Text
Caution:
- PresentationVariant.Visualizations MUST be provided. If missing, the PresentationVariant is ignored.
- Chart visualizations are rendered only in the Analytical List Page (ALP). In the List Report, only the LineItem is rendered.

Default totals:
- If no PresentationVariant is defined for an analytical table, totals are provided by default for all aggregatable columns.
- If a PresentationVariant defines Total: [ ... ] then totals are provided only for listed aggregatable properties.
- If Total is present but empty -> no totals are provided.
- If Total is missing -> totals provided by default for all aggregatable properties.

Runtime restrictions:
- Filtering on aggregatable properties is not supported (removed from filter bar and filter dialog).
- If a group contains multiple units/currencies, totals cannot be computed directly. The table shows "Show Details" which opens a popup with totals per unit/currency.
- Responsive tables support only one level of grouping. If multiple group levels are specified in a PresentationVariant, only the first level is applied.
```

--------------------------------

**TITLE**: SAP Fiori Elements — Tables: Configuration and Annotation Examples (OData V2 & V4)

**INTRODUCTION**: This reference collects actionable, copy-paste-ready configuration and annotation examples for working with tables in SAP Fiori elements. Use these snippets to set table type, selection mode, column visibility and importance, dynamic data loading, copy behavior, freezing columns, search restrictions, and context-menu behavior. Includes XML, manifest JSON, ABAP CDS, CAP CDS and small JS examples where relevant.

**TAGS**: Fiori Elements, tables, manifest.json, UI.LineItem, UI.Importance, UI.Hidden, scrollThreshold, threshold, copy, freeze, ColumnWidth, SearchRestrictions, NavigationRestrictions, context menu

STEP: 1 — Set Table Type (List Report / Object Page / Analytical List Page)
DESCRIPTION: Configure which table control is rendered. Examples show AnalyticalTable for analytical list pages and enabling gridTable for list/object pages. Use these in manifest.json under the component settings for the page.
LANGUAGE: JSON
CODE:
```json
// Analytical List Page: set AnalyticalTable and multiSelect options
"component": {
    "name": "sap.suite.ui.generic.template.AnalyticalListPage",
    "list": true,
    "settings": {
        "tableSettings": {
            "type": "AnalyticalTable",
            "multiSelect": true,
            "selectAll": false,
            "selectionLimit": 10
        }
    }
}

// List Report: enable grid table
"component": {
    "name": "sap.suite.ui.generic.template.ListReport",
    "list": true,
    "settings": {
        "gridTable": true,
        "tableSettings": {
            "scrollThreshold": 600
        }
    }
}

// Object Page: enable grid table
"component": {
    "name": "sap.suite.ui.generic.template.ObjectPage",
    "settings": {
        "gridTable": true,
        "tableSettings": {
            "scrollThreshold": 600
        }
    }
}
```

STEP: 2 — Configure Selection Mode (single / multi)
DESCRIPTION: By default, templates use single-selection. Enable multi-selection and selection limits via tableSettings in the manifest.
LANGUAGE: JSON
CODE:
```json
// Analytical List Page: enable multi-select and set limits
"component": {
    "name": "sap.suite.ui.generic.template.AnalyticalListPage",
    "list": true,
    "settings": {
        "tableSettings": {
            "type": "AnalyticalTable",
            "multiSelect": true,
            "selectAll": false,
            "selectionLimit": 10
        }
    }
}
```

STEP: 3 — Show or Hide Copy to Clipboard Button (per-page and per-table)
DESCRIPTION: Control visibility of the Copy to Clipboard toolbar button using "copy" in tableSettings (OData V2 examples) or disableCopyToClipboard (OData V4 controlConfiguration).
LANGUAGE: JSON
CODE:
```json
// List Report: hide copy button
"sap.ui.generic.app": {
    "pages": {
        "ListReport|<EntitySetName>": {
            "entitySet": "<EntitySetName>",
            "component": {
                "name": "sap.suite.ui.generic.template.ListReport",
                "settings": {
                    "tableSettings": {
                        "copy": false
                    }
                }
            }
        }
    }
}

// Analytical List Page: show copy button
"sap.ui.generic.app": {
    "pages": {
        "ListReport|<EntitySetName>": {
            "entitySet": "<EntitySetName>",
            "component": {
                "name": "sap.suite.ui.generic.template.AnalyticalListPage",
                "settings": {
                    "tableSettings": {
                        "copy": true
                    }
                }
            }
        }
    }
}

// Object Page: example with per-section override
"sap.ui.generic.app": {
    "pages": {
        "ListReport|<EntitySetName>": {
            ...
            "pages": {
                "ObjectPage|<EntitySetName>": {
                    "entitySet": "<EntitySetName>",
                    "component": {
                        "name": "sap.suite.ui.generic.template.ObjectPage",
                        "settings": {
                            "sections": {
                                "SalesOrderItemsID": {
                                    "navigationProperty": "<NavigationProperty>",
                                    "entitySet": "<NavigationEntitySetName>",
                                    "tableSettings": {
                                        "copy": true
                                    }
                                }
                            },
                            "tableSettings": {
                                "copy": false
                            }
                        }
                    }
                }
            }
        }
    }
}

// OData V4: disable copy to clipboard via controlConfiguration
"sap.ui5": {
    "routing": {
        "targets": {
            "SalesOrderManageList": {
                "options": {
                    "settings": {
                        "controlConfiguration": {
                            "@com.sap.vocabularies.UI.v1.LineItem": {
                                "tableSettings": {
                                    "disableCopyToClipboard": true
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
```

STEP: 4 — Exclude Custom Actions from Context Menu (controller extension registration)
DESCRIPTION: When defining custom actions in controller extensions, exclude them from the table context menu by setting excludeFromContextMenu: true in the actions definition in the controllerExtensions manifest section.
LANGUAGE: JSON
CODE:
```json
"sap.ui.controllerExtensions": {
    "sap.suite.ui.generic.template.ListReport.view.ListReport": {
        "controllerName": "STTA_MP.ext.controller.ListReportExtension",
        "sap.ui.generic.app": {
            "STTA_C_MP_Product": {
                "EntitySet": "STTA_C_MP_Product",
                "Actions": {
                    "CopyWithNewSupplier": {
                        "id": "CopyWithNewSupplier",
                        "text": "Copy with new Supplier",
                        "press": "onCopyWithNewSupplier",
                        "excludeFromContextMenu": true
                    }
                }
            }
        }
    }
}
```

STEP: 5 — Retrieve Selected Contexts for Custom Actions (synchronous use)
DESCRIPTION: Use extensionAPI.getSelectedContexts() inside synchronous action handlers to get the row contexts associated with a context menu or toolbar action. Must be used synchronously.
LANGUAGE: JavaScript
CODE:
```javascript
// Example custom action handler in extension controller (synchronous)
onCopyWithNewSupplier: function(oEvent) {
    // this.extensionAPI must be available in the extension controller
    var aSelectedContexts = this.extensionAPI.getSelectedContexts();
    // process selected contexts synchronously
    aSelectedContexts.forEach(function(oContext) {
        var sKey = oContext.getProperty("ID"); // example property
        // implement action logic
    });
}
```

STEP: 6 — Show/Hide Columns Based on UI.Importance (XML annotation)
DESCRIPTION: Use UI.Importance on UI.LineItem fields to control behavior on narrow screens: High = always visible (pop-in), Medium/None = hidden when space is limited, Low = hidden first. Example XML shows High/None/Low usage.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductSalesPriceType">
     <Annotation Term="UI.LineItem">
          <Collection>
               <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="PriceDay" />
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
               </Record>
               <Record Type="UI.DataField">
                     <PropertyValue Property="Value" Path="TargetPrice" />
                     <!-- This will be treated with default importance "None" which is same as "Medium" -->
               </Record>
               <Record Type="UI.DataField">
                     <PropertyValue Property="Value" Path="DiscountPriceTarget" />
                     <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Low" />
               </Record>
          </Collection>
     </Annotation>
</Annotations>
```

STEP: 7 — Hide Table Columns or Fields Using UI.Hidden (XML / ABAP CDS / CAP CDS)
DESCRIPTION: Hide entire columns by setting UI.Hidden to static true or hide specific fields with a path expression (path-based UI.Hidden). If path-based UI.Hidden evaluates true for all rows, only fields are hidden (not entire column). Examples for UI.LineItem / DataFieldForAnnotation and ABAP/CAP CDS variants are included.
LANGUAGE: XML
CODE:
```xml
<!-- Example: hide a DataFieldForAnnotation using path-based UI.Hidden -->
<Annotation Term="UI.LineItem">
    <Collection>
        <Record Type="UI.DataFieldForAnnotation">
            <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#multipleActionFields" />
            <PropertyValue Property="Label" String="Sold-To Party" />
            <Annotation Term="UI.Hidden" Path="Delivered" />
        </Record>
    </Collection>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [
  {
    hidden: true,
    label: 'Sold-To Party',
    type: #AS_FIELDGROUP, 
    hidden: #('Delivered'),
    valueQualifier: ' multipleActionFields'
  }
]
TEST;
```
LANGUAGE: CAP CDS
CODE:
```cap
LineItem : {
    $value : [
        {
            $Type : 'UI.DataFieldForAnnotation',
            Target : '@UI.FieldGroup#multipleActionFields',
            Label  : 'Sold-To Party',
            ![@UI.Hidden] : Delivered
        }
    ]
}
```

STEP: 8 — Column Width Defaults and CssDefaults Annotation
DESCRIPTION: SAP Fiori elements calculates default text column widths using the metadata MaxLength (limits: 3 rem – 20 rem). To override default width via annotations, use com.sap.vocabularies.HTML5.v1.CssDefaults on the field/line item. See "Setting the Default Column Width" for detailed usage.
LANGUAGE: XML
CODE:
```xml
<!-- Use com.sap.vocabularies.HTML5.v1.CssDefaults on a field to influence CSS defaults (conceptual example) -->
<Annotation Term="com.sap.vocabularies.HTML5.v1.CssDefaults">
    <!-- Implementation-specific values depend on the annotation usage; see setting-the-default-column-width documentation -->
</Annotation>
```

STEP: 9 — Configure threshold (preload rows) in manifest.json (OData V2)
DESCRIPTION: threshold preloads additional rows (added to visible rows). Example shows threshold: 400 for list, object, and analytical list pages.
LANGUAGE: JSON
CODE:
```json
// List Report
"component": {
    "name": "sap.suite.ui.generic.template.ListReport",
    "list": true,
    "settings": {
        "gridTable": true,
        "tableSettings": {
            "threshold": 400
        }
    }
}

// Object Page
"component": {
    "name": "sap.suite.ui.generic.template.ObjectPage",
    "settings": {
        "gridTable": true,
        "tableSettings": {
            "threshold": 400
        }
    }
}

// Analytical List Page
"component": {
    "name": "sap.suite.ui.generic.template.AnalyticalListPage",
    "list": true,
    "settings": {
        "tableSettings": {
            "type": "AnalyticalTable",
            "multiSelect": true,
            "selectAll": false,
            "selectionLimit": 10,
            "threshold": 400
        }
    }
}
```

STEP: 10 — Configure scrollThreshold for dynamic loading (OData V2 & V4)
DESCRIPTION: scrollThreshold controls how many rows are requested while scrolling (default 300). For analytical/tree tables scrollThreshold must be > threshold. Examples for list, object, analytical list pages and V4 controlConfiguration are included.
LANGUAGE: JSON
CODE:
```json
// List Report
"component": {
    "name": "sap.suite.ui.generic.template.ListReport",
    "list": true,
    "settings": {
        "gridTable": true,
        "tableSettings": {
            "scrollThreshold": 600
        }
    }
}

// Object Page
"component": {
    "name": "sap.suite.ui.generic.template.ObjectPage",
    "settings": {
        "gridTable": true,
        "tableSettings": {
            "scrollThreshold": 600
        }
    }
}

// Analytical List Page
"component": {
    "name": "sap.suite.ui.generic.template.AnalyticalListPage",
    "list": true,
    "settings": {
        "tableSettings": {
            "type": "AnalyticalTable",
            "multiSelect": true,
            "selectAll": false,
            "selectionLimit": 10,
            "scrollThreshold": 600
        }
    }
}

// OData V4: controlConfiguration example for scrollThreshold
"sap.ui5": {
    "routing": {
        "targets": {
            "SalesOrderManageList": {
                "options": {
                    "settings": {
                        "controlConfiguration": {
                            "@com.sap.vocabularies.UI.v1.LineItem": {
                                "tableSettings": {
                                    "type": "GridTable",
                                    "scrollThreshold": 200
                                }
                            }
                        }
                    }
                }
            }
        }
    }
}
```

STEP: 11 — Freeze First Columns (GridTable only)
DESCRIPTION: Freeze the first N columns to keep them visible during horizontal scrolling by setting frozenColumnCount in the manifest (not available for responsive table).
LANGUAGE: JSON
CODE:
```json
"_Item/@com.sap.vocabularies.UI.v1.LineItem": {
    "tableSettings": {
        "type": "GridTable",
        "frozenColumnCount": 3
    }
}
```

STEP: 12 — Include Column Header When Calculating Column Width
DESCRIPTION: Use widthIncludingColumnHeader setting at table level or column level in controlConfiguration. Column-level setting overrides table-level.
LANGUAGE: JSON
CODE:
```json
"controlConfiguration": {
     "@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
                   "widthIncludingColumnHeader": true
            },
            "columns": {
                   "DataField::commonProperty": {
                        "widthIncludingColumnHeader": false
                   }
            }
     }
}
```

STEP: 13 — Copying Multiple Rows and Keyboard Shortcuts for Range Selection
DESCRIPTION: Users can copy multiple rows or ranges to clipboard. Provide keyboard shortcuts and behaviors used during selection and range operations.
LANGUAGE: TEXT
CODE:
```text
Key combinations and behaviors:
- [Space]                : Selects the cell that the focus is set on. If used inside a selection, removes the selection.
- [Shift] + [Arrow keys] : Adjusts an existing selection. If used outside a selection, creates a new selection.
- [Shift] + [Space]      : Transforms the current selection into a row selection, based on the table selection mode.
- [Control] + [Space]    : Expands the selection to all cells in a column (up to the range limit).
- [Control] + [Shift] + [A] : Clears the selection.

Notes:
- To select a range with the mouse, click+drag. For editable cells that would get focus on selection, press CTRL (Windows) or CMD (macOS) before selecting to prevent focus.
- Copyed content may bundle amount+unit or value+description — adapt before pasting into other Fiori tables.
```

STEP: 14 — Search Field Behavior and Search Restrictions (XML / CAP)
DESCRIPTION: A table shows a search field when the entity set is sap:searchable true. Configure SearchRestrictions either at the parent entity using Capabilities.NavigationRestrictions.RestrictedProperties (NavigationProperty pointing to table entity), or directly on the child entity using SAP__capabilities.SearchRestrictions. Examples for non-containment and containment scenarios.
LANGUAGE: XML
CODE:
```xml
<!-- Navigation Restrictions at Parent Entity (non-containment) -->
<Annotations Target="com.c_salesordermanage_sd.Container/SalesOrderManage">
   <Annotation Term="Capabilities.NavigationRestrictions">
      <Record>
         <PropertyValue Property="RestrictedProperties">
            <Collection>
               <Record>
                  <PropertyValue Property="NavigationProperty" NavigationPropertyPath="_Items" />
                  <PropertyValue Property="SearchRestrictions">
                     <Record>
                        <PropertyValue Property="Searchable" Bool="false" />
                     </Record>
                  </PropertyValue>
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>

<!-- Child Entity SearchRestrictions (non-containment) -->
<Annotations Target="com.c_salesordermanage_sd.Container/SalesOrderItem">
   <Annotation Term="SAP__capabilities.SearchRestrictions">
      <Record>
         <PropertyValue Property="Searchable" Bool="false" />
      </Record>
   </Annotation>
</Annotations>

<!-- Containment example: Parent NavigationRestrictions -->
<Annotations Target="sap.fe.test.MyService.EntityContainer/Customer">
   <Annotation Term="Capabilities.NavigationRestrictions">
      <Record>
         <PropertyValue Property="RestrictedProperties">
            <Collection>
               <Record>
                  <PropertyValue Property="NavigationProperty" NavigationPropertyPath="Set/_PartnerItems" />
                  <PropertyValue Property="SearchRestrictions">
                     <Record>
                        <PropertyValue Property="Searchable" Bool="false" />
                     </Record>
                  </PropertyValue>
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>

<!-- Containment example: Child entity SearchRestrictions -->
<Annotations Target="SAP__self.Container/ItemPartner">
   <Annotation Term="SAP__capabilities.SearchRestrictions">
      <Record>
         <PropertyValue Property="Searchable" Bool="false" />
      </Record>
   </Annotation>
</Annotations>
```
LANGUAGE: CAP CDS
CODE:
```cap
// Non-containment scenario: entity-level SearchRestrictions
entity SalesOrderItem @(Capabilities:{
   SearchRestrictions : {Searchable : false}
}) { ... }

// Parent-level NavigationRestrictions (non-containment)
entity SalesOrderManage @(
   Capabilities: {
      NavigationRestrictions: {
         RestrictedProperties: [{
            NavigationProperty : _Items,
            SearchRestrictions : { Searchable : false }
         }]
      }
   }
) { ... }

// Containment scenario: service-level NavigationRestrictions
service MyService {
    @Capabilities.NavigationRestrictions.RestrictedProperties : [{
        $Type              : 'Capabilities.NavigationPropertyRestriction',
        NavigationProperty : 'Set/_PartnerItems',
        SearchRestrictions : {Searchable : false}
    }]
}
```

STEP: 15 — Smart Multi-Input Column Rendering & Vertical Alignment
DESCRIPTION: Smart multi-input is auto-rendered for 1:N association columns in responsive/grid tables. Vertical alignment of responsive tables can be set via sap.ui.generic.app.settings.tableColumnVerticalAlignment = Top|Middle|Bottom.
LANGUAGE: JSON
CODE:
```json
// Set vertical alignment for responsive table (manifest.json)
"sap.ui.generic.app": {
    "settings": {
        "tableColumnVerticalAlignment": "Top" // or "Middle" | "Bottom"
    }
}
```

Related files and docs (preserve for lookup):
- Defining Line Items annotations: defining-line-items-f0e1e17.md
- Table type guidance: setting-the-table-type-7f844f1.md
- Copy/paste details: copying-and-pasting-from-external-applications-to-tables-f6a8fd2.md
- Extension points for custom columns: extension-points-for-tables-d525522.md
- Setting default column width: setting-the-default-column-width-a765253.md
- Configuring tables: configuring-tables-f4eb70f.md
- Navigating to object page in edit mode: navigation-to-an-object-page-in-edit-mode-8665847.md
- Enabling multiple selection: enabling-multiple-selection-in-tables-116b5d8.md
- Enabling table personalization: enabling-table-personalization-3e2b4d2.md
- Additional manifest controlConfiguration path examples: manifest.json sections shown above.
--------------------------------

**TITLE**: Chart Building Block — XML usage, personalization, and public APIs

**INTRODUCTION**: Practical, code-focused reference for adding the SAP Fiori Elements Chart building block to an XML view, configuring its key properties, enabling personalization, and using public APIs to get/set presentation and selection variants. Includes manifest override example and backend aggregation requirement.

**TAGS**: fiori-elements-framework, chart, macros, personalization, presentation-variant, selection-variant, manifest.json, XML, JavaScript

**STEP**: 1 — Add Chart building block to an XML view

**DESCRIPTION**: Add the Chart macro to your XML view. Declare the macros namespace and provide either metaPath (absolute or relative) and/or contextPath. Example shows a chart with ID, contextPath, metaPath, event handler for selection, personalization options, and multiple selection mode.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/view/ChartView.view.xml -->
<mvc:View
    controllerName="my.app.controller.ChartView"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    xmlns:macros="sap.fe.macros"
    xmlns="sap.m">
    <!-- Chart building block -->
    <macros:Chart
        id="chartDefault"
        contextPath="/RootEntitySet"                    <!-- optional if metaPath is absolute -->
        metaPath="@com.sap.vocabularies.UI.v1.Chart"   <!-- relative or absolute annotation path -->
        dataPointsSelected=".onChartSelectionChanged"  <!-- controller event handler -->
        personalization="Sort,Type,Item"               <!-- enable personalization tabs -->
        selectionMode="Multiple"                       <!-- selection mode: None/Single/Multiple -->
    />
</mvc:View>
```

**STEP**: 2 — Rules for contextPath and metaPath

**DESCRIPTION**: Use an absolute metaPath or provide contextPath when metaPath is relative. If metaPath is relative and contextPath is omitted, the parent binding path of the Chart is used as contextPath.

**LANGUAGE**: text

**CODE**:
```text
Rules:
- If metaPath is absolute, contextPath is optional.
- If metaPath is relative and no contextPath is given, the parent binding path is used as contextPath.
```

**STEP**: 3 — Ensure backend supports aggregation

**DESCRIPTION**: The entity set used by the Chart must support aggregation. Enable aggregation in the backend service. See the project documentation link for backend configuration details.

**LANGUAGE**: text

**CODE**:
```text
See: Configuring Charts -> Enabling Aggregation in the Back End
File: configuring-charts-653ed0f.md
Anchor: #loio653ed0f4f0d743dbb33ace4f68886c4e__enabling_aggregation_subsection
```

**STEP**: 4 — Personalization, selection variants, and limitations

**DESCRIPTION**: Enable chart personalization using the personalization property. Use public APIs to get/set presentation and selection variants. Note: get/set selection variant methods work only if chart personalization is enabled and they only consider variants applied directly to the chart (not model-bound variants).

**LANGUAGE**: text

**CODE**:
```text
Personalization:
- personalization attribute controls tabs shown, e.g., "Sort,Type,Item".
- selectionMode controls selection behavior: "None", "Single", "Multiple".

Variant APIs (available on the Chart control):
- getPresentationVariant()
- setPresentationVariant(presentationVariant)
- getSelectionVariant()
- setSelectionVariant(selectionVariant)

Notes:
- getSelectionVariant()/setSelectionVariant() work only when personalization is enabled.
- getSelectionVariant() returns only variants applied directly to the chart, not those applied to a bound model.
- You can also get/set the currently visible variant ID via the control API.
```

**STEP**: 5 — Example: call public APIs from the controller

**DESCRIPTION**: Use the Chart control ID to obtain the macro instance and call public APIs. The example demonstrates reading and applying presentation and selection variants and reading the current variant ID.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/controller/ChartView.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function(Controller) {
  "use strict";

  return Controller.extend("my.app.controller.ChartView", {
    onInit: function() {
      // get chart macro instance by ID
      this._oChart = this.byId("chartDefault");
    },

    // Example: read the current presentation variant
    readPresentationVariant: async function() {
      if (!this._oChart) { return; }
      const pv = await this._oChart.getPresentationVariant(); // returns a Promise or value per API
      console.log("Presentation Variant:", pv);
      return pv;
    },

    // Example: apply a presentation variant object
    applyPresentationVariant: function(presentationVariant) {
      if (!this._oChart) { return; }
      this._oChart.setPresentationVariant(presentationVariant);
    },

    // Example: read and apply selection variant (requires personalization enabled)
    readSelectionVariant: async function() {
      if (!this._oChart) { return; }
      const sv = await this._oChart.getSelectionVariant();
      console.log("Selection Variant:", sv);
      return sv;
    },

    applySelectionVariant: function(selectionVariant) {
      if (!this._oChart) { return; }
      this._oChart.setSelectionVariant(selectionVariant);
    },

    // Example: get/set current visible variant ID
    getCurrentVariantId: function() {
      return this._oChart.getCurrentVariantId && this._oChart.getCurrentVariantId();
    },

    setCurrentVariantId: function(variantId) {
      return this._oChart.setCurrentVariantId && this._oChart.setCurrentVariantId(variantId);
    },

    // Selection event handler defined in XML
    onChartSelectionChanged: function(oEvent) {
      // handle selection change
      const selected = oEvent.getParameter("dataPoints"); // event parameter name may vary by implementation
      console.log("Chart selection changed:", selected);
    }
  });
});
```

**STEP**: 6 — Manifest.json overrides

**DESCRIPTION**: Chart properties such as headerVisible, header, and selectionMode can be defined in the Chart building block or in manifest.json. When both are present, manifest.json values take precedence. Example manifest snippet shows overriding selectionMode and headerVisible.

**LANGUAGE**: JSON

**CODE**:
```json
// File: manifest.json (extract)
{
  "sap.ui5": {
    "models": { /* ... */ }
  },
  "sap.app": { /* ... */ },
  "sap.ui": {
    "flexibility": { /* ... */ }
  },
  "sap.fiori": { /* ... */ },
  "sap.card": { /* ... */ },
  "sap.ui5": {
    "routing": { /* ... */ }
  },
  "sap.ui5": {
    "extensions": {
      "sap.ui.viewReplacements": {}
    }
  },
  "sap.fe": {
    "charts": {
      "chartDefault": {
        "selectionMode": "Single",
        "headerVisible": true,
        "header": "Sales Overview"
      }
    }
  }
}
```
(Note: actual manifest path and structure varies by application template. manifest.json values override XML macro attributes.)

**STEP**: 7 — Live examples and API reference

**DESCRIPTION**: Use the live examples and API reference for interactive testing and full method signatures.

**LANGUAGE**: text

**CODE**:
```text
Live examples:
- Chart - Interacting via APIs:
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/chart/chartPublicAPIs
- Chart Title example:
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/chart/chartDefault

API Reference:
- Chart macro API:
  https://ui5.sap.com/#/api/sap.fe.macros.Chart
```

**STEP**: 8 — Quick notes & gotchas

**DESCRIPTION**: Consolidated actionable reminders for implementation.

**LANGUAGE**: text

**CODE**:
```text
- Ensure backend entity set supports aggregation before binding the Chart.
- If metaPath is relative, supply contextPath or rely on parent binding path.
- Enable personalization to use selection-variant APIs.
- manifest.json settings take precedence over attributes in the Chart macro.
- Use the Chart macro ID to access public APIs from the controller.
- Consult the API Reference for exact method signatures and return types.
```
--------------------------------

**TITLE**: Field Building Block (sap.fe.macros.Field) — Usage, Configuration, and Examples

**INTRODUCTION**: Concise guide for instantiating and configuring the sap.fe.macros.Field building block in XML fragments and programmatically in controllers. Includes manifest-based configuration (controlConfiguration), formatOptions examples (currency display, measureDisplayMode, displayMode), value-list radio buttons, JSON model binding, and restrictions for manifest settings.

**TAGS**: fiori-elements-framework, Field, sap.fe.macros, macros, fragment, manifest.json, controlConfiguration, formatOptions, currency, value-help, radio-buttons, JSON-model, dialog, Form

STEP: 1 — Basic instantiation in an XML fragment
DESCRIPTION: Use the Field building block inside a fragment. Ensure you declare the macros namespace (sap.fe.macros). Use metaPath to refer to the property from the service metadata.
LANGUAGE: XML
CODE:
```xml
<!-- Custom fragment: use macros namespace sap.fe.macros and bind to a metadata property -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:macros="sap.fe.macros">
    <VBox width="30vw">
        <Text text="Basic Field: " />
        <macros:Field metaPath="MyProperty" id="myPropertyField" />
    </VBox>
</core:FragmentDefinition>
```

STEP: 2 — Use Field inside a FormElement (auto label)
DESCRIPTION: Place the Field inside the fields aggregation of a FormElement to get an automatic label derived from metadata.
LANGUAGE: XML
CODE:
```xml
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:macros="sap.fe.macros">
    <Form>
        <FormContainer>
            <FormElement>
                <fields>
                    <macros:Field metaPath="address/street" id="streetField"/>
                </fields>
            </FormElement>
        </FormContainer>
    </Form>
</core:FragmentDefinition>
```

STEP: 3 — Programmatic creation in a controller (dynamic runtime usage)
DESCRIPTION: Create a Field at runtime in a controller and add it to a Dialog. Provide formatOptions (example: max text length) and bind the dialog to an entity context.
LANGUAGE: JavaScript
CODE:
```javascript
createField: function () {
    // FormatOptions constructor imported/available in your controller context
    const maxLength = new sap.fe.macros.FormatOptions({ textMaxLength: 10 });
    const field = new sap.fe.macros.Field({
        metaPath: "/Entities/singleLine",
        formatOptions: maxLength
    });

    const newDialog = new sap.m.Dialog({
        title: "Dialog",
        content: [
            new sap.m.Label({ text: "My field", labelFor: field }),
            field
        ],
        beginButton: new sap.m.Button({
            text: "OK",
            press: function () { newDialog.close(); }
        }),
        endButton: new sap.m.Button({
            text: "Cancel",
            press: function () { newDialog.close(); }
        })
    });
    newDialog.addStyleClass("sapUiContentPadding");
    // Bind dialog to entity instance so Field resolves metadata context
    newDialog.bindElement("/Entities(1)");
    this.getExtensionAPI().addDependent(newDialog); // from extension API
    newDialog.open();
}
```

STEP: 4 — Manifest-based controlConfiguration (readOnly example)
DESCRIPTION: Configure Field properties via manifest.json controlConfiguration. Example shows applying readOnly to a specific field within a FieldGroup qualifier using DataField path key.
Note restriction: readOnly and semanticObject manifest settings require the Field to be inside a field group in standard UI, or inside a Form with assigned field group for custom pages/sections.
LANGUAGE: JSON
CODE:
```json
// manifest.json (fragment)
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.FieldGroup#myQualifier": {
                  "fields": {
                    "DataField::myFormTextField": {
                      "readOnly": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Available manifest settings and formatOptions parameters
DESCRIPTION: List of supported manifest settings and formatOptions keys for controlConfiguration. Use these in manifest controlConfiguration or nested <formatOptions> in XML fragments.
LANGUAGE: JSON
CODE:
```json
// Supported settings for Field controlConfiguration:
{
  "settings": {
    "readOnly": true,
    "semanticObject": "SemanticObjectName",
    "formatOptions": {
      "textLinesEdit": 1,
      "textMaxLines": 3,
      "textMaxCharactersDisplay": 100,
      "textExpandBehaviorDisplay": "..." ,
      "textMaxLength": 50
    }
  }
}
```

STEP: 6 — formatOptions examples: currency measureDisplayMode and displayMode
DESCRIPTION: Use formatOptions as nested XML elements inside macros:Field to modify currency presentation:
- measureDisplayMode: controls currency input visibility (ReadOnly, Hidden).
- displayMode: controls how value and description are displayed (ValueDescription, DescriptionValue).
LANGUAGE: XML
CODE:
```xml
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:macros="sap.fe.macros">
    <VBox width="30vw">
        <!-- Numeric with currency: default -->
        <Text text="Numeric Field with Currency - no format Option:" />
        <macros:Field metaPath="numberWithCurrency" id="numberWithCurrencyField" />

        <!-- currency measureDisplayMode=ReadOnly -->
        <Text text="Numeric Field with Currency - measureDisplayMode=ReadOnly:" />
        <macros:Field metaPath="numberWithCurrency" id="numberWithCurrencyFieldCurrencyReadOnly">
            <formatOptions measureDisplayMode="ReadOnly" />
        </macros:Field>

        <!-- currency measureDisplayMode=Hidden -->
        <Text text="Numeric Field with Currency - measureDisplayMode=Hidden:" />
        <macros:Field metaPath="numberWithCurrency" id="numberWithCurrencyFieldCurrencyHidden">
            <formatOptions measureDisplayMode="Hidden" />
        </macros:Field>

        <!-- currency displayMode examples -->
        <Text text="Currency Field - displayMode=ValueDescription:" />
        <macros:Field metaPath="currencyField_code" id="currencyFieldValueDescription">
            <formatOptions displayMode="ValueDescription" />
        </macros:Field>

        <Text text="Currency Field - displayMode=DescriptionValue:" />
        <macros:Field metaPath="currencyField_code" id="currencyFieldDescriptionValue">
            <formatOptions displayMode="DescriptionValue" />
        </macros:Field>
    </VBox>
</core:FragmentDefinition>
```

STEP: 7 — Value list with fixed values: radio buttons (horizontal layout)
DESCRIPTION: Render a Field with a fixed value list as radio buttons. Use formatOptions useRadioButtons="true". To render horizontally, set radioButtonsHorizontalLayout="true". The radio group defaults to vertical.
LANGUAGE: XML
CODE:
```xml
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:macros="sap.fe.macros">
    <VBox>
        <Text text="Field with fixed value list as radio buttons:" />
        <macros:Field metaPath="FieldWithFixedValueList" id="FieldWithFixedValueListRadioButtonsHorizontal">
            <formatOptions useRadioButtons="true" radioButtonsHorizontalLayout="true" />
        </macros:Field>
    </VBox>
</core:FragmentDefinition>
```

STEP: 8 — Bind Field to JSON model value / description
DESCRIPTION: Use the value property to bind to a JSON model path for displaying/editing JSON-backed data. Use description property to bind a description (only with value binding). Supported for text, date/time pickers, value help, and object status (rating indicator editing is not supported).
LANGUAGE: XML
CODE:
```xml
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:macros="sap.fe.macros">
    <VBox>
        <!-- Bind value to JSON model -->
        <macros:Field
            id="myCustomField"
            metaPath="/RootEntity/name"
            value="{myJSONModel>/customModelBindingPath}" />

        <!-- Bind value and description to JSON model -->
        <macros:Field
            id="myCustomFieldWithDescription"
            metaPath="/RootEntity/name"
            value="{myJSONModel>/customModelBindingPath}"
            description="{myJSONModel>/customModelDescriptionBindingPath}" />
    </VBox>
</core:FragmentDefinition>
```

STEP: 9 — API reference
DESCRIPTION: Direct link to the Field API reference for properties, events, and methods.
LANGUAGE: URL
CODE:
```text
https://ui5.sap.com/#/api/sap.fe.macros.Field
```
--------------------------------

**TITLE**: FilterBar Building Block (sap.fe.macros.FilterBar)

**INTRODUCTION**: Use the FilterBar building block to embed a filter bar in Fiori Elements applications. This doc provides actionable XML and controller code examples for common tasks: basic embedding, wiring event handlers, programmatic search triggering, interacting with SelectionVariant, and configuring transient personalization.

**TAGS**: fiori-elements-framework, filterbar, sap.fe.macros, personalization, selectionvariant, triggerSearch, FilterField

**STEP**: 1 — Basic XML embedding and handlers

**DESCRIPTION**: Add the FilterBar macro in an XML view. Provide an id, metaPath (annotation path for selection fields), and handler bindings for search and filtersChanged. Use the same id to access the control in controller code.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- XML view fragment or view -->
<macros:FilterBar
    xmlns:macros="sap.fe.macros"
    metaPath="@com.sap.vocabularies.UI.v1.SelectionFields#SF1"
    id="FilterBar"
    search=".handlers.onSearch"
    filtersChanged=".handlers.onFiltersChanged"
/>
```

**STEP**: 2 — Implementing event handlers in controller (onSearch / onFiltersChanged)

**DESCRIPTION**: Implement the handler functions referenced from XML. Example shows typical controller methods called by the FilterBar macro. Adapt to your controller framework (Controller.extend, ES6 class, or manifest routing handlers).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Controller methods (example using standard UI5 controller)
onSearch: function (oEvent) {
    // Called when user triggers the 'Go' action
    // oEvent contains filter information; use oEvent.getParameter(...) as needed
    console.log("FilterBar search triggered", oEvent);
    // e.g., trigger list binding update or custom logic
},

onFiltersChanged: function (oEvent) {
    // Called when filter values change
    // Use this to react to incremental filter changes
    console.log("Filters changed", oEvent);
}
```

**STEP**: 3 — Triggering filter search programmatically (triggerSearch)

**DESCRIPTION**: Call triggerSearch() on the FilterBar instance to validate mandatory fields and execute the Go action. Behavior: validates required filters; if any mandatory field is empty, focus moves to the first missing mandatory field, no error message is shown, and search is not triggered.

Call this after the FilterBar control is available (e.g., onInit after view initialization or in a route handler).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: call from a controller method after view is initialized
onInit: async function () {
    // Wait or ensure view is rendered; then:
    const oFilterBar = this.byId("FilterBar"); // use the same id as in XML
    if (oFilterBar && typeof oFilterBar.triggerSearch === "function") {
        // triggerSearch may be async - allow for Promise resolution
        await oFilterBar.triggerSearch();
        // After resolve, the search action was executed if validation passed
    }
}

// Example: call later (e.g., after data is set)
onSomeAction: async function () {
    const oFilterBar = this.byId("FilterBar");
    await oFilterBar.triggerSearch();
}
```

**STEP**: 4 — Interacting via SelectionVariant format (getSelectionVariant / setSelectionVariant)

**DESCRIPTION**: Use the FilterBar APIs to get or set the SelectionVariant programmatically. Note: custom filter fields are excluded from these APIs. Both methods are async and return/expect a SelectionVariant object.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Get current SelectionVariant from FilterBar
async function readSelectionVariant(controller) {
    const oFilterBar = controller.byId("FilterBar");
    // Returns Promise<SelectionVariant>
    const oSelectionVariant = await oFilterBar.getSelectionVariant();
    console.log("SelectionVariant:", oSelectionVariant);
    return oSelectionVariant;
}

// Set a SelectionVariant on FilterBar
async function applySelectionVariant(controller, selectionVariant) {
    const oFilterBar = controller.byId("FilterBar");
    // Accepts SelectionVariant object or equivalent structure
    await oFilterBar.setSelectionVariant(selectionVariant);
    // After setSelectionVariant you may trigger search if desired:
    await oFilterBar.triggerSearch();
}
```

**STEP**: 5 — Enabling transient (non-persisted) personalization

**DESCRIPTION**: To prevent persisting personalization changes (transient filter bar state during the session), set ignorePersonalizationChanges="true" on the FilterBar macro. Important constraints and recommendations are included.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Use a new unique id when enabling ignorePersonalizationChanges -->
<macros:FilterBar
    xmlns:macros="sap.fe.macros"
    metaPath="@com.sap.vocabularies.UI.v1.SelectionFields"
    ignorePersonalizationChanges="true"
    id="FilterBarTransient"
/>
```

Additional guidance:
- Do not reuse an existing FilterBar ID when using ignorePersonalizationChanges—create a new ID.
- When personalization is ignored, variants and iAppState application to the filter are not applied. Use this only for truly transient contexts (e.g., custom dialog or value help dialog).
- This setting is experimental. See Compatibility Rules: ../02_Read-Me-First/compatibility-rules-91f0873.md
- For variants: managing-variants-8ce658e.md
- For iAppState: store-restore-the-application-state-46bf248.md
- For personalization control details: ../09_Developing_Controls/how-to-enable-personalization-for-sapui5-controls-5f215c1.md

**STEP**: 6 — Restrictions and best practices

**DESCRIPTION**: Collects important restrictions and implementation notes to follow when using FilterBar.

**LANGUAGE**: Text

**CODE**:
```text
- The FilterBar building block cannot open the visual filter bar (no UI to "bring up" visual filter).
- If you place a FilterBar in a custom section or custom subsection connected to a navigation entity,
  ensure that all controls that need to be filtered by the FilterBar are located in the same UI fragment
  as the FilterBar macro (same fragment scope).
- Custom filter fields are not included in getSelectionVariant() or setSelectionVariant() calls.
- ignorePersonalizationChanges should only be used for transient contexts (dialogs, value help).
```

**STEP**: 7 — Links and API reference

**DESCRIPTION**: Useful links and live examples for testing and deeper API details.

**LANGUAGE**: Text

**CODE**:
```text
Live examples:
- Filter Bar - Overview:
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/filterBar/filterBarDefault
- Filter Bar - Default Values (FilterDefaultValue):
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/filterBar/filterBarAnnotationDefaults
- Filter Bar - Interacting via APIs:
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/filterBar/filterBarPublicAPIs

Related docs:
- FilterField building block: the-filterfield-building-block-2df7837.md
- Compatibility Rules (experimental features): ../02_Read-Me-First/compatibility-rules-91f0873.md
- Managing Variants: managing-variants-8ce658e.md
- Store/Restore the Application State (iAppState): store-restore-the-application-state-46bf248.md
- How to Enable Personalization for SAPUI5 Controls:
  ../09_Developing_Controls/how-to-enable-personalization-for-sapui5-controls-5f215c1.md

API reference:
- sap.fe.macros.FilterBar API: https://ui5.sap.com/#/api/sap.fe.macros.FilterBar
```
--------------------------------

**TITLE**: Adding Custom FilterField XML Fragments to a FilterBar (sap.fe.macros.FilterBar)

**INTRODUCTION**: This guide shows how to add custom XML fragments as filter fields to a sap.fe.macros.FilterBar using the FilterField building block. It includes a ready-to-use XML view snippet that registers fragments, examples of fragment files, and minimal controller handlers for search and filterChanged events.

**TAGS**: sapui5, ui5, fiori-elements, filterbar, filterfield, fragment, xml, macros, example

STEP: 1 — Add FilterField entries to your FilterBar XML view

DESCRIPTION: Insert macross:FilterBar into your XML view and add one or more macros:FilterField entries inside macros:filterFields. Each FilterField references an XML fragment via core:Fragment with fragmentName (use your application module path). Set attributes like key, label, and required on the FilterField. Provide handlers for search and filterChanged on the FilterBar.

LANGUAGE: XML

CODE:
```xml
<mvc:View
  controllerName="my.app.controller.List"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  xmlns:core="sap.ui.core">
  <macros:FilterBar
    metaPath="@com.sap.vocabularies.UI.v1.SelectionFields#SF1"
    id="FilterBar"
    showMessages="true"
    search=".handlers.onSearch"
    filterChanged=".handlers.onFiltersChanged">

    <macros:filterFields>
      <!-- Name filter uses a fragment located at my.app.view.fragments.NameFilterXMLFileName -->
      <macros:FilterField key="NameProperty" label="Name">
        <core:Fragment fragmentName="my.app.view.fragments.NameFilterXMLFileName" type="XML" />
      </macros:FilterField>

      <!-- Street filter; required="true" is applied on FilterField -->
      <macros:FilterField key="StreetProperty" label="Street" required="true">
        <core:Fragment fragmentName="my.app.view.fragments.StreetFilterXMLFileName" type="XML" />
      </macros:FilterField>
    </macros:filterFields>

  </macros:FilterBar>
</mvc:View>
```

STEP: 2 — Create the XML fragment file(s) that define the control(s) for each filter field

DESCRIPTION: Create a UI5 XML fragment for each FilterField. Place fragments under your view/fragment folder (module path used above). Use core:FragmentDefinition as root. Keep the fragment minimal (control(s) only) and bind inputs to the properties you expect (for example, "Name" or "Street"). The FilterField label/required attributes are set on the macros:FilterField element, not necessarily inside the fragment.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/view/fragments/NameFilterXMLFileName.fragment.xml
     Module path used in fragmentName: my.app.view.fragments.NameFilterXMLFileName -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
  <!-- Example: simple Input bound to the "Name" property -->
  <Input id="NameFilterInput" value="{path: 'Name'}" placeholder="Enter name" />
</core:FragmentDefinition>
```

```xml
<!-- File: webapp/view/fragments/StreetFilterXMLFileName.fragment.xml
     Module path used in fragmentName: my.app.view.fragments.StreetFilterXMLFileName -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
  <!-- Example: simple Input bound to the "Street" property -->
  <Input id="StreetFilterInput" value="{path: 'Street'}" placeholder="Enter street" />
</core:FragmentDefinition>
```

STEP: 3 — Implement controller handlers for search and filterChanged

DESCRIPTION: The FilterBar attributes search and filterChanged reference handler functions on the controller. Implement minimal handlers to receive events and apply custom logic or forward filter data to the list binding.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/controller/List.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function(Controller) {
  "use strict";

  return Controller.extend("my.app.controller.List", {

    // Called when the FilterBar search button is pressed (or Enter)
    handlers: {
      onSearch: function(oEvent) {
        // oEvent contains standard FilterBar search event parameters
        // Implement search logic here, e.g., trigger table binding refresh
        // Example: this._applyFiltersAndRefresh();
        console.log("FilterBar search triggered", oEvent);
      },

      // Called when the filters change (user interaction)
      onFiltersChanged: function(oEvent) {
        // oEvent.getParameter("filters") or other parameters depend on the macro's event signature
        // Use this to read filter information, validate, or enable/disable actions
        console.log("FilterBar filters changed", oEvent);
      }
    }

  });
});
```

STEP: 4 — Conventions, file naming, and paths

DESCRIPTION: Use module-style fragmentName values (dot-separated) that map to your fragment file location. Example mapping:
- fragmentName="my.app.view.fragments.NameFilterXMLFileName"
- file path: webapp/view/fragments/NameFilterXMLFileName.fragment.xml

Notes:
- Set key and label on macros:FilterField for identification and display.
- Set required="true" on macros:FilterField to mark the field mandatory in the FilterBar.
- The fragment content should be the control(s) only (no top-level View), using core:FragmentDefinition.

LANGUAGE: text

CODE:
```text
Recommended mapping:
fragmentName: my.app.view.fragments.NameFilterXMLFileName
Fragment file: webapp/view/fragments/NameFilterXMLFileName.fragment.xml
```

STEP: 5 — Reference docs

DESCRIPTION: Use the following official references for API details and fragment examples.

LANGUAGE: text

CODE:
```text
API Reference (FilterField):
https://ui5.sap.com/#/api/sap.fe.macros.filterBar.FilterField

Guide: Adding Custom Fields to the Filter Bar:
https://sdk.openui5.org/topic/adding-custom-fields-to-the-filter-bar-5fb9f57.md
(also available in your Fiori elements docs)
```

--------------------------------

**TITLE**: FlexibleColumnLayoutActions Building Block (sap.fe.macros.FlexibleColumnLayoutActions)

**INTRODUCTION**: Use this building block to add the standard Close, Enter Full Screen and Exit Full Screen action buttons that appear in the top-right of a FlexibleColumnLayout. Instantiate the building block inside an XML fragment that is enabled for Fiori Elements/Building Block usage.

**TAGS**: fiori-elements-framework, flexible-column-layout, building-block, sap.fe.macros, ui5, XML

**STEP**: 1 — Add building block namespace to the fragment

**DESCRIPTION**: Create or edit an XML fragment and declare the macros building-block namespace (sap.fe.macros). This enables use of the FlexibleColumnLayoutActions tag.

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<core:FragmentDefinition
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:macros="sap.fe.macros">
  <!-- building block elements will be instantiated here -->
</core:FragmentDefinition>
```

**STEP**: 2 — Instantiate FlexibleColumnLayoutActions in the fragment

**DESCRIPTION**: Place the FlexibleColumnLayoutActions building block tag where you want the control tree for the Close / Enter Full Screen / Exit Full Screen buttons to be created. The building block generates the standard control tree and wiring for these actions in a FlexibleColumnLayout-based application.

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<core:FragmentDefinition
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:macros="sap.fe.macros">

  <!-- Instantiates Close, Enter Full Screen and Exit Full Screen buttons -->
  <macros:FlexibleColumnLayoutActions/>
</core:FragmentDefinition>
```

**STEP**: 3 — Use fragment in a view or component

**DESCRIPTION**: Include the fragment (that contains the building block) in your view or component where the FlexibleColumnLayout header actions should appear. Ensure the surrounding layout is a FlexibleColumnLayout so the generated actions behave correctly.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: include fragment inside a view or another fragment -->
<core:Fragment
  fragmentName="your.app.namespace.fragments.FCLHeaderActions"
  type="XML" />
```

**STEP**: 4 — Reference API documentation

**DESCRIPTION**: For full API details, configuration options, and behavior, consult the official UI5 API Reference for sap.fe.macros.FlexibleColumnLayoutActions.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "apiReference": "https://ui5.sap.com/#/api/sap.fe.macros.FlexibleColumnLayoutActions"
}
```
--------------------------------

**TITLE**: Form Building Block (sap.fe.macros.Form) — Usage and Examples

**INTRODUCTION**: Quick, actionable guide showing how to instantiate a Form using the sap.fe.macros.Form building block in XML views. Covers referencing a FieldGroup annotation, pointing to a CollectionFacet that contains FieldGroups, and adding inline FormElement entries with placement and anchor controls. Use these snippets directly in UI5 XML views.

**TAGS**: fiori-elements-framework, sap.fe.macros, Form, FieldGroup, CollectionFacet, UI5, XML

**STEP**: 1 — Add basic Form bound to a FieldGroup annotation

**DESCRIPTION**: Create a Form that is automatically built from a FieldGroup annotation. Place this inside an XML view; include the macros namespace mapping (xmlns:macros="sap.fe.macros"). Use the metaPath attribute to reference the FieldGroup annotation by qualifier (e.g., #General). Set id and title as needed.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
    controllerName="my.app.Controller"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    xmlns:macros="sap.fe.macros">
    <!-- Form bound to a FieldGroup annotation -->
    <macros:Form
        id="myForm"
        metaPath="@com.sap.vocabularies.UI.v1.FieldGroup#General"
        title="My Title" />
</mvc:View>
```

**STEP**: 2 — Add inline FormElement(s) to a Form

**DESCRIPTION**: Add custom/inline elements to the auto-generated form. Inline elements are declared as child nodes of macros:Form. Use attributes:
- metaPath: property path inside the entity (e.g., "ID")
- id: control id
- label: visible label text
- placement: position relative to anchor (e.g., "After", "Before")
- anchor: reference to an existing DataField ID inside the generated form (format often "DataField::<ID>")

This snippet demonstrates adding a single FormElement positioned after a named anchor.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
    controllerName="my.app.Controller"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    xmlns:macros="sap.fe.macros">
    <macros:Form
        id="myForm"
        metaPath="@com.sap.vocabularies.UI.v1.FieldGroup#General"
        title="My Title">

        <!-- Inline FormElement added after an existing DataField anchor -->
        <macros:FormElement
            metaPath="ID"
            id="formElementMacroID"
            label="ID Property After Number"
            placement="After"
            anchor="DataField::NumberProperty" />
    </macros:Form>
</mvc:View>
```

**STEP**: 3 — Point Form to a CollectionFacet that contains multiple FieldGroups

**DESCRIPTION**: When a CollectionFacet groups several FieldGroups, point the Form metaPath to the CollectionFacet annotation. The Form will render FieldGroups within that facet. Replace #FacetQualifier with your CollectionFacet qualifier.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
    controllerName="my.app.Controller"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    xmlns:macros="sap.fe.macros">
    <!-- Form bound to a CollectionFacet (which contains FieldGroups) -->
    <macros:Form
        id="facetForm"
        metaPath="@com.sap.vocabularies.UI.v1.CollectionFacet#FacetQualifier"
        title="Facet-Based Form" />
</mvc:View>
```

**STEP**: 4 — Reference: Form API

**DESCRIPTION**: Consult the official API reference for all properties, events and aggregation details of sap.fe.macros.Form.

**LANGUAGE**: text

**CODE**:
```
https://ui5.sap.com/#/api/sap.fe.macros.Form
```
--------------------------------

**TITLE**: FormElement building block (sap.fe.macros.FormElement)

**INTRODUCTION**: Use the FormElement building block to add a labeled, visibility-controlled field inside a Form. Labels are taken automatically from annotations by default or can be set manually. When used simply, the FormElement auto-creates a Field with the same metaPath. Use the fields aggregation to configure the Field in detail.

**TAGS**: fiori-elements-framework, sap.fe.macros, FormElement, FormContainer, Field, metaPath, UI5, form

STEP: 1 — Minimal usage: add FormElement inside Form -> FormContainer -> formElements

DESCRIPTION: Place the FormElement inside the formElements aggregation of a FormContainer which is inside a Form. This minimal instantiation creates a Field automatically using the same metaPath. Ensure your fragment or view declares the sap.ui.layout.form and sap.fe.macros namespaces.

LANGUAGE: XML

CODE:
```xml
<f:Form xmlns:f="sap.ui.layout.form" xmlns:macros="sap.fe.macros">
  <f:layout>
    <f:ColumnLayout columnsM="2" columnsL="3" columnsXL="4" labelCellsLarge="12" />
  </f:layout>
  <f:formContainers>
    <f:FormContainer>
      <f:formElements>
        <!-- Minimal FormElement: auto-creates a Field using metaPath -->
        <macros:FormElement metaPath="MyProperty" id="myID" />
      </f:formElements>
    </f:FormContainer>
  </f:formContainers>
</f:Form>
```

STEP: 2 — Behavior: automatic Field creation

DESCRIPTION: Using a FormElement with a metaPath (as in Step 1) automatically instantiates a Field building block with the same metaPath. Use this when default Field behavior and annotation-derived labels are sufficient.

LANGUAGE: XML

CODE:
```xml
<!-- No additional code required: FormElement(metaPath="MyProperty") => auto-created Field(metaPath="MyProperty") -->
```

STEP: 3 — Explicit Field configuration via fields aggregation

DESCRIPTION: To configure the inner Field in detail (custom properties, control types, id, etc.), add a macros:fields aggregation inside the FormElement and declare one or more macros:Field entries. Keep the metaPath consistent or override as needed.

LANGUAGE: XML

CODE:
```xml
<f:Form xmlns:f="sap.ui.layout.form" xmlns:macros="sap.fe.macros">
  <f:layout>
    <f:ColumnLayout columnsM="2" columnsL="3" columnsXL="4" labelCellsLarge="12" />
  </f:layout>
  <f:formContainers>
    <f:FormContainer>
      <f:formElements>
        <macros:FormElement metaPath="MyProperty" id="myID">
          <macros:fields>
            <!-- Explicit Field configuration: configure control, validation, formatting, etc. -->
            <macros:Field metaPath="MyProperty" id="myFieldId" />
          </macros:fields>
        </macros:FormElement>
      </f:formElements>
    </f:FormContainer>
  </f:formContainers>
</f:Form>
```

STEP: 4 — Label and visibility controls

DESCRIPTION: FormElement provides label and visibility behavior. Labels default to annotation text; you can override manually (use the FormElement property to set a custom label if supported) and use visibility bindings or annotation-driven visibility expression. Check the API reference for exact property names and binding patterns.

LANGUAGE: XML

CODE:
```xml
<!-- Example: override label (property name depends on API; check reference) -->
<macros:FormElement metaPath="MyProperty" id="myID" label="Custom Label" visible="{= ${someModel>/flag} }" />
```

STEP: 5 — Allowed usage contexts

DESCRIPTION: Use FormElement inside standard form containers and also in custom extension spots such as custom header facets, custom sections, custom pages, and custom table columns within Fiori elements applications.

LANGUAGE: TEXT

CODE:
```text
Allowed contexts: custom header facets, custom sections, custom pages, custom table columns (and all spots where FormContainer.formElements is supported).
```

STEP: 6 — API reference

DESCRIPTION: For complete API (properties, aggregations, events, methods) and up-to-date details, consult the official UI5 API reference for sap.fe.macros.FormElement.

LANGUAGE: TEXT

CODE:
```text
API Reference: https://ui5.sap.com/#/api/sap.fe.macros.FormElement
```
--------------------------------

**TITLE**: MessageButton building block — embed, extend, and manage bound messages

**INTRODUCTION**: Short, actionable guide for embedding the sap.fe.macros.MessageButton building block into an XML view, implementing the optional extension hooks (visibilityChange and beforeShowMessageButton) to control visibility, rendering and behavior, and managing the message lifecycle (clearing messages after actions). Experimental feature — use only for prototypes or internal POCs.

**TAGS**: fiori-elements-framework, messagebutton, building-block, ui5, sap.fe.macros, message-model, extension-hooks

**STEP**: 1 — Embed MessageButton in an XML view

**DESCRIPTION**: Add the MessageButton macro to an XML view. Include the macros namespace and set the optional visibilityChange property to point to a controller method that will be called before the control is displayed. Place the macro inside the parent container you want to show/hide (for example, a footer toolbar).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example XML view fragment -->
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:core="sap.ui.core"
  xmlns:macros="sap.fe.macros"
  controllerName="my.app.controller.Detail">

  <!-- Footer toolbar (example parent container) -->
  <Toolbar id="footerToolbar">
    <!-- MessageButton macro: visibilityChange references controller method -->
    <macros:MessageButton visibilityChange=".handleMessageButtonVisibility" />
  </Toolbar>

</mvc:View>
```

**STEP**: 2 — Implement visibilityChange handler (control parent visibility)

**DESCRIPTION**: Implement the handler referenced in the XML (visibilityChange). This handler is invoked before the MessageButton control is displayed. Use it to toggle the parent container (for example, footer toolbar) visibility or perform any pre-display logic.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Controller: my/app/controller/Detail.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function(Controller) {
  "use strict";

  return Controller.extend("my.app.controller.Detail", {
    /**
     * visibilityChange handler invoked by the MessageButton macro before display.
     * @param {boolean} bVisible - true => messages will be shown (control visible)
     */
    handleMessageButtonVisibility: function(bVisible) {
      // Example: show or hide footer toolbar that contains the MessageButton
      const oFooter = this.byId("footerToolbar");
      if (oFooter) {
        oFooter.setVisible(Boolean(bVisible));
      }
      // Additional logic can be added here (analytics, custom UI updates, ...)
    }
  });
});
```

**STEP**: 3 — Implement beforeShowMessageButton hook to control rendering, grouping, and link behavior

**DESCRIPTION**: Implement the controller extension hook beforeShowMessageButton to customize how messages are handled just before the MessageButton popover would open. Use this hook to:
- decide whether the MessageButton should render the messages (prevent default rendering and provide your own UI),
- group messages into logical groups (instead of default "General"),
- override the default message link action (for example, change navigation or focus behavior).

The framework will call your hook with a parameters object. The concrete shape may vary; typical parameters include the list of messages and callback utilities. The example below shows a defensive pattern that reads messages, filters non-technical bound messages, optionally prevents default rendering and shows a custom dialog, and supplies a custom link handler.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Controller: my/app/controller/Detail.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/m/Dialog",
  "sap/m/MessageStrip",
  "sap/m/Button",
  "sap/m/List",
  "sap/m/StandardListItem"
], function(Controller, Dialog, MessageStrip, Button, List, StandardListItem) {
  "use strict";

  return Controller.extend("my.app.controller.Detail", {
    /**
     * beforeShowMessageButton hook
     * Note: the framework calls this hook and passes information about the messages.
     * The exact parameter structure may vary; use the object defensively.
     *
     * Example usage:
     * - filter out technical messages
     * - if in edit mode, render messages in a dialog instead of default popover
     * - supply a custom link handler for message navigation
     *
     * @param {Object} oParams - parameters provided by the framework (inspect in runtime)
     *   Expected fields (may vary): messages: Array, preventDefault: Function, setLinkHandler: Function, setGroupedMessages: Function
     */
    beforeShowMessageButton: function(oParams) {
      oParams = oParams || {};
      const aMessages = oParams.messages || []; // Array of message objects provided by runtime
      // Filter: keep only bound, non-technical messages (property names depend on your message objects)
      const aBoundNonTechnical = aMessages.filter(function(m) {
        // Use properties present in your messages. Example properties: technical, bound
        return !m.technical && Boolean(m.bound);
      });

      if (aBoundNonTechnical.length === 0) {
        // No relevant messages — let default behavior continue
        return;
      }

      // Example: if page is NOT in edit mode, render a custom dialog and prevent default popover rendering
      // Replace the property path /editable with your app's edit-mode flag
      const bEditMode = this.getView().getModel("viewModel")?.getProperty("/editable");
      if (!bEditMode && typeof oParams.preventDefault === "function") {
        // Prevent the MessageButton building block from rendering the popover
        oParams.preventDefault();

        // Build a simple dialog that lists messages and shows a message strip for each
        const oList = new List({
          items: aBoundNonTechnical.map((m) => new StandardListItem({
            title: m.message || m.text || "Message",
            type: "Active",
            press: () => {
              // Custom link handler: focus or navigate based on message target
              // Each message object may provide target info (inspect runtime object for field names)
              if (m.target) {
                // Example: focus the control by id stored in m.target
                const oTarget = this.byId(m.target);
                if (oTarget && oTarget.focus) {
                  oTarget.focus();
                }
              }
            }
          }))
        });

        const oDialog = new Dialog({
          title: "Messages",
          content: oList,
          beginButton: new Button({
            text: "Close",
            press: function() { oDialog.close(); }
          }),
          afterClose: function() { oDialog.destroy(); }
        });
        oDialog.open();

        // Optionally, if the framework allows, supply a custom link handler for MessageButton UI
        if (typeof oParams.setLinkHandler === "function") {
          oParams.setLinkHandler(function(m) {
            // Custom behavior for clicks on message links inside the MessageButton popover
            if (m && m.target) {
              const oTarget = this.byId(m.target);
              if (oTarget && oTarget.focus) {
                oTarget.focus();
              }
            }
          }.bind(this));
        }

        // Optionally group messages and provide them back to the building block
        if (typeof oParams.setGroupedMessages === "function") {
          oParams.setGroupedMessages([
            { groupTitle: "Validation", messages: aBoundNonTechnical.filter(msg => msg.severity === "Error") },
            { groupTitle: "Info", messages: aBoundNonTechnical.filter(msg => msg.severity !== "Error") }
          ]);
        }
      }

      // If you do not call preventDefault(), the building block will continue and display
      // its default message popover and count handling.
    }
  });
});
```

**STEP**: 4 — Manage the message lifecycle (clear outdated messages after actions)

**DESCRIPTION**: The message model is managed by your application — clear messages that are no longer relevant after user actions (for example after a successful Save), and ensure state messages are added only after finalizing actions. Use the UI5 MessageManager to remove messages globally or remove individual messages as appropriate.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: clear all messages after Save
onSave: function() {
  // Perform save logic...
  // On successful save, clear messages that are no longer applicable:
  const oMessageManager = sap.ui.getCore().getMessageManager();
  if (oMessageManager) {
    oMessageManager.removeAllMessages(); // removes all messages managed by MessageManager
  }

  // Alternatively, remove or update specific messages via message manager APIs if needed
}
```

**STEP**: 5 — Useful links and references

**DESCRIPTION**: Official references and live example for quick inspection.

**LANGUAGE**: Text / Links

**CODE**:
```text
Live example (Flexible Programming Model Explorer):
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/features/messageButtonDefault

API Reference:
https://ui5.sap.com/#/api/sap.fe.macros.MessageButton
```

--------------------------------

**TITLE**: The `MicroChart` Building Block

**INTRODUCTION**: Use the MicroChart building block (sap.fe.macros.MicroChart) as a standalone macro inside any XML view/container. Provide metaPath and optional contextPath to bind the chart to the OData metadata and data. This guide shows minimal XML usage, contextPath rules, a pattern for "no data" handling, and links to the live example and API.

**TAGS**: fiori-elements-framework, sapui5, microchart, macros, ui5, flexible-programming-model, XML-view

**STEP**: 1 — Add MicroChart to an XML view

**DESCRIPTION**: Add the MicroChart macro to an XML view. Include the macros namespace (sap.fe.macros). Provide metaPath, optional contextPath, and batchGroupId as shown.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/view/MyMicroChart.view.xml -->
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:core="sap.ui.core"
  xmlns:macros="sap.fe.macros"
  displayBlock="true">
  <VBox>
    <macros:MicroChart
      id="bar"
      metaPath="@com.sap.vocabularies.UI.v1.Chart#BarStackedPath"
      contextPath="/RootEntity/_Item"
      batchGroupId="$auto.abc" />
  </VBox>
</mvc:View>
```

**STEP**: 2 — Rules for metaPath and contextPath (absolute vs relative)

**DESCRIPTION**: Use an absolute metaPath (starts with '/') or a relative metaPath. If metaPath is absolute, contextPath is optional. If metaPath is relative and no contextPath is provided, the parent binding path (the view/control binding where the macro is placed) is used as contextPath.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Absolute metaPath: contextPath optional -->
<macros:MicroChart
  id="chartAbsolute"
  metaPath="/SomeEntityType@com.sap.vocabularies.UI.v1.Chart#BarStackedPath"  <!-- absolute path -->
  batchGroupId="$auto.abc" />

<!-- Relative metaPath with explicit contextPath -->
<macros:MicroChart
  id="chartRelativeWithContext"
  metaPath="@com.sap.vocabularies.UI.v1.Chart#BarStackedPath"   <!-- relative -->
  contextPath="/RootEntity/_Item"
  batchGroupId="$auto.abc" />

<!-- Relative metaPath without contextPath: parent binding path is used -->
<!-- Place this inside a control bound to /RootEntity/_Item -->
<HBox binding="{/RootEntity/_Item}">
  <macros:MicroChart
    id="chartRelativeParentBound"
    metaPath="@com.sap.vocabularies.UI.v1.Chart#BarStackedPath"
    batchGroupId="$auto.abc" />
</HBox>
```

**STEP**: 3 — Handle "no data" and control micro chart visibility/size

**DESCRIPTION**: The MicroChart macro follows standard UI5 visibility and sizing patterns. Use container sizing/CSS classes to influence rendered size, and use control visibility bindings to display a fallback (e.g., text) when no data exists. Example below shows a simple "no data" fallback using expression binding on the container data path.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Pattern: show MicroChart only when data exists; otherwise show a No Data Text -->
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  xmlns:m="sap.m">
  <!-- expression binding checks if the context path node exists -->
  <macros:MicroChart
    id="microChartWithVisibility"
    metaPath="@com.sap.vocabularies.UI.v1.Chart#BarStackedPath"
    contextPath="/RootEntity/_Item"
    visible="{= ${/RootEntity/_Item} ? true : false }"
    batchGroupId="$auto.abc"
    class="myMicroChartSizeClass" />
  <m:Text
    text="No data available"
    visible="{= ${/RootEntity/_Item} ? false : true }" />
</mvc:View>

<!-- CSS class to influence size (example in style file) -->
/* File: webapp/css/style.css */
.myMicroChartSizeClass {
  width: 240px; /* influence rendered micro chart width */
  height: 80px; /* influence rendered micro chart height */
}
```

**STEP**: 4 — Reference links (live example & API)

**DESCRIPTION**: Inspect the live flexible programming model explorer example and the API reference for all available properties and advanced scenarios (header visibility, sizing options, no-data API, etc.).

**LANGUAGE**: TEXT

**CODE**:
```text
Live example: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/microchart/microChartDefault
API Reference: https://ui5.sap.com/#/api/sap.fe.macros.MicroChart
```
--------------------------------

**TITLE**: Page Building Block (sap.fe.macros.Page) — Flexible Programming Model Page

**INTRODUCTION**: Use the macros:Page building block to create a flexible programming model (FPM) page with an object-page–like layout. Configure title, description, avatar and arbitrary child content (Panel, Text, other UI5 controls). The example below shows a runnable XML view containing two panels.

**TAGS**: fiori-elements-framework, sap.fe.macros, Page, UI5, XMLView, FPM, object-page

**STEP**: 1 — Create an XML view using macros:Page

**DESCRIPTION**: Add a UI5 XML view that uses the sap.fe.macros.Page building block. Include the required namespaces and use sap.m.Panel and sap.m.Text as children. Save this file as e.g. webapp/view/Page.view.xml.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
  controllerName="my.app.controller.Page"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  xmlns:m="sap.m"
  displayBlock="true">

  <!-- Page building block with title, description and avatar -->
  <macros:Page
    title="Page title"
    description="Page description"
    avatarSrc="sap-icon://page">

    <!-- First content panel -->
    <m:Panel headerText="First content" id="firstContent">
      <m:Text text="This is the first content of the page" />
    </m:Panel>

    <!-- Second content panel -->
    <m:Panel headerText="Second content" id="secondContent">
      <m:Text text="This is the second content, it is properly padded" />
    </m:Panel>

  </macros:Page>
</mvc:View>
```

**STEP**: 2 — Use alternative child controls or nested layouts

**DESCRIPTION**: You can replace or enrich the Panel content with any UI5 controls (VBox, HBox, Layouts, Forms, custom controls). Example below nests a VBox in a panel for structured content.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
  controllerName="my.app.controller.Page"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  xmlns:m="sap.m"
  displayBlock="true">

  <macros:Page title="Page title" description="Page description" avatarSrc="sap-icon://page">

    <m:Panel headerText="Structured content">
      <m:VBox>
        <m:Text text="Line 1" />
        <m:Text text="Line 2" />
      </m:VBox>
    </m:Panel>

  </macros:Page>
</mvc:View>
```

**STEP**: 3 — References (API and live example)

**DESCRIPTION**: Official API reference and live example explorer links.

**LANGUAGE**: text

**CODE**:
```
API Reference: https://ui5.sap.com/#/api/sap.fe.macros.Page
Live Example (FPM Explorer): https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/page/pageDefault
```
--------------------------------

**TITLE**: Paginator Building Block - Usage and Controller Initialization

**INTRODUCTION**: Quick reference for adding the sap.fe.macros.Paginator building block to an XML view and initializing it from a controller. Shows how to wire the paginator to a list/table binding and set an initial paging context so end users can traverse large lists using paginator buttons.

**TAGS**: sap-ui5, fiori-elements, paginator, macros, UI5, building-block, controller, OData, list-binding

**STEP**: 1 — Add Paginator macro to an XML view

**DESCRIPTION**: Insert the Paginator building block into your XML view. Use a stable id so the controller can find and initialize it. This snippet goes into your view file (example file path: webapp/view/Main.view.xml).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/view/Main.view.xml -->
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  controllerName="your.namespace.controller.Main">

  <!-- Example list/table that has an items/rows binding -->
  <List id="myList" items="{/Products}">
    <!-- item template -->
  </List>

  <!-- Add the Paginator building block -->
  <macros:Paginator
    id="paginator" />
</mvc:View>
```

**STEP**: 2 — Initialize Paginator in the controller: attach list binding and initial context

**DESCRIPTION**: In the controller, retrieve the list control, obtain its list binding (the ODataListBinding or client list binding used for items/rows), then pass that binding to the Paginator building block. Also set the initial paging context (for example: start index, page size or other context shape required). The example shows a common pattern: get the list binding and call setListBinding and setInitialContext on the paginator instance. Adjust the context shape to your implementation/API requirements.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/controller/Main.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("your.namespace.controller.Main", {
    onInit: function () {
      var oView = this.getView();

      // 1) Find the list/table control that has the binding to the collection
      var oList = oView.byId("myList");
      if (!oList) {
        return;
      }

      // 2) Get the list binding (items aggregation for sap.m.List; rows for table)
      var oListBinding = oList.getBinding("items") || oList.getBinding("rows");
      if (!oListBinding) {
        return;
      }

      // 3) Find the paginator control (sap.fe.macros.Paginator)
      var oPaginator = oView.byId("paginator");
      if (!oPaginator) {
        return;
      }

      // 4) Attach the binding to the paginator so it can control paging/navigation
      // Note: setListBinding/setInitialContext are the typical methods to initialize the paginator.
      // If your framework version uses different method names or properties, adapt accordingly.
      if (typeof oPaginator.setListBinding === "function") {
        oPaginator.setListBinding(oListBinding);
      } else {
        // Fallback: set a property or model entry that the paginator reads
        oPaginator.setProperty("listBinding", oListBinding);
      }

      // 5) Set an initial paging context (example shape: startIndex and pageSize)
      var oInitialContext = {
        startIndex: 0,
        pageSize: 20
      };

      if (typeof oPaginator.setInitialContext === "function") {
        oPaginator.setInitialContext(oInitialContext);
      } else {
        // Fallback: expose via a model or property used by your paginator implementation
        oPaginator.setProperty("initialContext", oInitialContext);
      }

      // Optional: If the paginator exposes an API to refresh or to compute total counts, call it
      if (typeof oPaginator.refresh === "function") {
        oPaginator.refresh();
      }
    }
  });
});
```

**STEP**: 3 — Reference and live example

**DESCRIPTION**: Use the official API reference and live explorer example to confirm method names and available properties for your installed library version.

**LANGUAGE**: JSON (links only)

**CODE**:
```json
{
  "API Reference": "https://ui5.sap.com/#/api/sap.fe.macros.Paginator",
  "Live Example (fpmExplorer)": "https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/features/paginatorDefault"
}
```
--------------------------------

**TITLE**: RichTextEditor Building Block (SAP Fiori Elements / UI5) - XML View Usage and Configuration

**INTRODUCTION**: Use the RichTextEditor building block to display formatted text in read mode and allow inline editing in edit mode. This document provides actionable XML view snippets and configuration examples for button groups and plugins, with a complete view context and links to the live example and API reference.

**TAGS**: Fiori, UI5, SAP Fiori Elements, RichTextEditor, macros, XML, view, buttonGroups, plugins

**STEP**: 1 — Add RichTextEditor to an XML view

**DESCRIPTION**: Place the RichTextEditor building block in an XML view. Include the macros and richtexteditor namespaces and bind the control to a model property (example: custom>/myFormattedValue). Provide id and required attributes as needed.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/view/RichTextExample.view.xml -->
<mvc:View
  controllerName="my.app.controller.RichTextExample"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  xmlns:richtexteditor="sap.ui.richtexteditor">
  <macros:RichTextEditor
    id="myRichTextEditor"
    value="{custom>/myFormattedValue}"
    required="true">

    <!-- Button groups and plugins are configured below -->
    <macros:buttonGroups>
      <richtexteditor:ButtonGroup
        name="font-style"
        visible="true"
        priority="10"
        customToolbarPriority="10"
        buttons="bold,italic" />
      <richtexteditor:ButtonGroup
        name="styleselect"
        visible="true"
        priority="10"
        customToolbarPriority="10"
        buttons="styleselect" />
      <richtexteditor:ButtonGroup
        name="table"
        visible="true"
        priority="10"
        customToolbarPriority="10"
        buttons="table" />
    </macros:buttonGroups>

    <macros:plugins>
      <richtexteditor:Plugin name="autoresize" />
    </macros:plugins>

  </macros:RichTextEditor>
</mvc:View>
```

**STEP**: 2 — Configure button groups (actions and options)

**DESCRIPTION**: Define ButtonGroup entries to customize the toolbar. Use attributes: name, visible, priority, customToolbarPriority, and buttons (comma-separated). Place ButtonGroup elements inside <macros:buttonGroups>.

**LANGUAGE**: XML

**CODE**:
```xml
<macros:buttonGroups>
  <richtexteditor:ButtonGroup
    name="font-style"
    visible="true"
    priority="10"
    customToolbarPriority="10"
    buttons="bold,italic" />
  <richtexteditor:ButtonGroup
    name="styleselect"
    visible="true"
    priority="10"
    customToolbarPriority="10"
    buttons="styleselect" />
  <richtexteditor:ButtonGroup
    name="table"
    visible="true"
    priority="10"
    customToolbarPriority="10"
    buttons="table" />
</macros:buttonGroups>
```

**STEP**: 3 — Configure plugins (editor behavior)

**DESCRIPTION**: Add Plugin entries to enable editor plugins (for example autoresize). Place Plugin elements inside <macros:plugins>.

**LANGUAGE**: XML

**CODE**:
```xml
<macros:plugins>
  <richtexteditor:Plugin name="autoresize" />
  <!-- Add additional plugins by name as required, e.g. "code", "lists", etc. -->
</macros:plugins>
```

**STEP**: 4 — Live example and API reference

**DESCRIPTION**: Use the live flexible programming model explorer for a working example and the API reference for full property/method/event details.

**LANGUAGE**: text

**CODE**:
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/rte
https://ui5.sap.com/#/api/sap.fe.macros.RichTextEditor
--------------------------------

**TITLE**: Share Building Block — Configure Send Email and Collaboration Manager Visibility

**INTRODUCTION**: Use the sap.fe.macros.Share building block in Freestyle SAPUI5 / Fiori Elements applications to provide end users sharing options (Send Email, Share to Microsoft Teams, Save as Tile, Share in SAP Jam). Configure visibility of Send Email and Collaboration Manager via the shareOptions properties showSendEmail and showCollaborationManager. By default both are false.

**TAGS**: fiori-elements, sapui5, share, macros, sap.fe.macros, flexible-programming-model, ui5

**STEP**: 1 — Add the Share building block to an XML view

**DESCRIPTION**: Insert the Share macro control into an XML view where you want to expose sharing options. Use the shareOptions aggregation to configure visibility flags.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: View XML (e.g., view.xml) -->
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  controllerName="my.app.controller.MyController">

  <!-- Place the Share building block where appropriate (toolbar, header, etc.) -->
  <macros:Share id="shareWithStaticProperties">
    <macros:shareOptions showSendEmail="false" showCollaborationManager="true" />
  </macros:Share>

</mvc:View>
```

**STEP**: 2 — Configure visibility statically (XML)

**DESCRIPTION**: Set showSendEmail and showCollaborationManager to true/false directly in XML for static configuration. Defaults: showSendEmail = false, showCollaborationManager = false.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Static configuration example -->
<macros:Share id="shareStatic">
  <macros:shareOptions showSendEmail="true" showCollaborationManager="false" />
</macros:Share>
```

**STEP**: 3 — Configure visibility dynamically using model binding (XML + controller)

**DESCRIPTION**: Bind the shareOptions boolean flags to your model so you can toggle visibility at runtime. Example shows using a named JSON model "settings".

**LANGUAGE**: XML

**CODE**:
```xml
<!-- XML: bind to properties in a JSON model named "settings" -->
<macros:Share id="shareDynamic">
  <macros:shareOptions
    showSendEmail="{settings>/showSendEmail}"
    showCollaborationManager="{settings>/showCollaborationManager}" />
</macros:Share>
```

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Controller: initialize the settings model and update properties at runtime
sap.ui.define(["sap/ui/core/mvc/Controller", "sap/ui/model/json/JSONModel"],
  function (Controller, JSONModel) {
    return Controller.extend("my.app.controller.MyController", {
      onInit: function () {
        var oSettings = new JSONModel({
          showSendEmail: false,
          showCollaborationManager: true
        });
        this.getView().setModel(oSettings, "settings");
      },

      // Toggle Send Email at runtime
      onToggleSendEmail: function () {
        var oModel = this.getView().getModel("settings");
        var bCurrent = oModel.getProperty("/showSendEmail");
        oModel.setProperty("/showSendEmail", !bCurrent);
      }
    });
  }
);
```

**STEP**: 4 — Programmatic creation (JavaScript)

**DESCRIPTION**: Create the Share macro programmatically in JS code using the sap.fe.macros.Share class and attach it to a parent control.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define([
  "sap/ui/core/Control",
  "sap/fe/macros/Share"
], function (Control, Share) {
  "use strict";

  // Create a Share instance programmatically
  var oShare = new Share({
    shareOptions: {
      showSendEmail: false,
      showCollaborationManager: true
    }
  });

  // Example: add to a toolbar or other container
  var oToolbar = this.byId("myToolbar"); // obtain reference to a container
  oToolbar.addContent(oShare);
});
```

**STEP**: 5 — Reference and live examples

**DESCRIPTION**: Use the official API reference for full property/method details and check live examples in the Flexible Programming Model explorer.

**LANGUAGE**: JSON (links only)

**CODE**:
```json
{
  "API Reference": "https://ui5.sap.com/#/api/sap.fe.macros.Share",
  "Live Example - Share Building Block Usage": "https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/features/shareDefault",
  "Live Example - Share Controller Extension Usage": "https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/controllerExtensions/controllerExtensionsOverview/shareExtensibility"
}
```
--------------------------------

**TITLE**: Share Functionality — Configure, Customize, and Control Share Options in SAP Fiori Elements

**INTRODUCTION**: This document shows how to configure and extend the built-in Share functionality in SAP Fiori elements apps (List Report, Object Page, Subobject Page). It includes actionable code changes for manifest.json, a controller extension to customize email subjects, toggling visibility of Share menu options (app-level and page-level), and adding semantic bookmarking annotations so drafts can be shared reliably.

**TAGS**: fiori-elements-framework, sapui5, manifest.json, controller-extension, share, semantic-bookmarking, ODataV2, ODataV4, SAP Jam, Microsoft Teams, Collaboration Manager, tiles

**STEP**: 1 — Overview and behavior summary

**DESCRIPTION**: Quick actionable summary of default share behavior and important rules to keep in mind when implementing Share options and semantic bookmarking.

**LANGUAGE**: Text

**CODE**:
```text
- Share is available on List Report, Object Page, Subobject Page.
- For Flexible Column Layout, Share is shown at the highest view level.
- Share button is hidden for newly created objects in draft mode.
- OData V2: For draft objects with an existing active instance, Share directly uses the active instance URL.
- OData V4: For draft objects with an existing active instance, Share uses semantic bookmarking (if semantic keys defined). If no semantic keys, the active instance URL is shared.
- Save as Tile is always visible (cannot be hidden).
- Share options (Send Email, Microsoft Teams, Collaboration Manager) can be shown/hidden using manifest.json properties (see steps below).
- MS Teams option requires SAP Fiori launchpad/ushell and is applicable only on launchpad.
- For SAP Fiori elements OData V2: tile creation type can be changed from dynamic to static via extension (see extending-bookmark docs).
```

**STEP**: 2 — Customize email subject via controller extension (OData V4 / Object Page)

**DESCRIPTION**: Add a controller extension mapping in manifest.json and implement the controller extension to override/modify the share metadata (email subject). This uses the sap.fe.core.controllerextensions.Share API (adaptShareMetadata).

- Modify manifest.json to register a controller extension for the ObjectPage base controller.
- Implement OPExtend.controller.js to override share.adaptShareMetadata and change oShareMetadata.email.title.

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (add under "sap.ui5")
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ObjectPage.ObjectPageController": {
            "controllerName": "SalesOrder.ext.OPExtend"
          }
        }
      }
    }
  }
}
```

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/SalesOrder/ext/OPExtend.controller.js
sap.ui.define(["sap/ui/core/mvc/ControllerExtension"], function(ControllerExtension) {
  "use strict";
  return ControllerExtension.extend("SalesOrder.ext.OPExtend", {
    // override lifecycle hooks or public methods of the base controller
    override: {
      onInit: function() {
        // optional initialization
      },
      share: {
        adaptShareMetadata: function(oShareMetadata) {
          // Customize email title/subject
          oShareMetadata.email = oShareMetadata.email || {};
          oShareMetadata.email.title = "test email subject";
          return oShareMetadata;
        }
      }
    }
  });
});
```

**STEP**: 3 — Application-level configuration: hide/show Share options

**DESCRIPTION**: Configure app-wide visibility for share options in the "sap.fe.app.share" section. When an application-level property is false, it hides the option everywhere regardless of page-level settings. If true or undefined, page-level settings apply.

Properties:
- showSendEmail (boolean or expression)
- teams.showMsTeamsOptions (boolean)
- showCollaborationManager (boolean)

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (application-level settings under "sap.fe")
{
  "sap.fe": {
    "app": {
      "share": {
        "showSendEmail": "{= !${isVerified} }",
        "teams": {
          "showMsTeamsOptions": false
        },
        "showCollaborationManager": true
      }
    }
  }
}
```

**STEP**: 4 — Page-level configuration: routing target share settings

**DESCRIPTION**: Configure share visibility per routing target (per page). Page-level settings are evaluated only if application-level property is true or undefined. Use settings.share for ListReport, ObjectPage, etc. Example shows hiding Send Email for a list report, and conditional MS Teams visibility.

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (page-level routing targets)
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "type": "Component",
          "id": "SalesOrderManageList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "share": {
                "showSendEmail": false,
                "teams": {
                  "showMsTeamsOptions": "{= ${Delivered} }"
                }
              }
            }
          }
        },
        "SalesOrderManageObjectPage": {
          "type": "Component",
          "id": "SalesOrderManageObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "share": {
                "teams": {
                  "showMsTeamsOptions": true
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Share options property mapping (quick reference)

**DESCRIPTION**: Map UI share menu options to manifest properties for quick reference.

**LANGUAGE**: Text

**CODE**:
```text
Share option                    manifest property
------------------------------------------------
Send E-Mail                     sap.fe.app.share.showSendEmail  (app-level)
                                settings.share.showSendEmail    (page-level)

Microsoft Teams                 sap.fe.app.share.teams.showMsTeamsOptions
                                settings.share.teams.showMsTeamsOptions

Collaboration Manager           sap.fe.app.share.showCollaborationManager
                                settings.share.showCollaborationManager
```

**STEP**: 6 — Semantic bookmarking: add semantic keys so drafts can be shared

**DESCRIPTION**: Add Common.SemanticKey annotations (XML or CDS) on the entity set/entity to ensure the URL uses semantic keys rather than technical keys. When semantic keys are present, sharing a draft URL allows other users to open the corresponding active copy. If semantic keys are missing, draft-sharing may produce URLs with technical keys and other users cannot open the draft.

- Add annotation to your annotation file (or to CDS view).
- Be aware of limitations: not supported for subobject pages, or when not all semantic keys are available in the current context.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: annotations.xml -->
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="Common.SemanticKey">
    <Collection>
      <PropertyPath>SalesOrder</PropertyPath>
    </Collection>
  </Annotation>
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
// In ABAP CDS view definition for the entity type
@ObjectModel: {
  semanticKey: [ 'SalesOrder' ]
}
define view SALESORDERMANAGE as select from <table> {
  key SalesOrder,
  ...
}
```

**LANGUAGE**: CDS

**CODE**:
```cds
// CAP CDS snippet (schema or entity annotations)
entity SalesOrder {
  key SalesOrder : String;
  // ...
}

// In the annotations file for CAP:
using Common from '@sap/cds/common';

annotate SalesOrder with {
  @Common.SemanticKey : [
    SalesOrder
  ]
};
```

**STEP**: 7 — Additional notes & platform-specific features

**DESCRIPTION**: Keep these actionable platform details in mind when implementing Share:

- Share in SAP Jam: available only on platforms integrated with SAP Jam.
- Save as Tile: when creating tiles, list report dynamic tiles include record count and applied filters. You can make tiles static using an extension (see "Extending the Bookmark Function to Save Static Tiles to the SAP Fiori Launchpad").
- Share: Microsoft Teams is only available when app runs on SAP Fiori launchpad with ushell configured.
- Collaboration Manager: opens SAP Collaboration Manager dialog with URL including iAppState and page title. See SAP Collaboration Manager docs for setup.

**LANGUAGE**: Text

**CODE**:
```text
References:
- Controller extension API: https://ui5.sap.com/#/api/sap.fe.core.controllerextensions.Share
- SAP Collaboration Manager setup: https://help.sap.com/docs/SAP%20Collaboration%20Manager/...
- Extending bookmark function (Save static tiles): refer to "Extending the Bookmark Function to Save Static Tiles to the SAP Fiori Launchpad" guide.
```
--------------------------------

**TITLE**: Share: Microsoft Teams — Fiori Elements Integration and Annotations Guide

**INTRODUCTION**: Practical, developer-focused instructions and code examples for enabling, controlling, and securing the "Share: Microsoft Teams" feature in SAP Fiori elements apps. Includes admin links, annotation examples to mark sensitive data, examples for shareable header actions and data formatting, and manifest examples showing overrides that affect card sharing.

**TAGS**: fiori-elements, sap-s4hana, microsoft-teams, annotations, personal-data, manifest.json, odata, cds, ui-annotations

**STEP**: 1 — Admin integration links / prerequisites

**DESCRIPTION**: System administrators must enable Microsoft Teams integration for the cloud or on-premise S/4HANA environments before end users can use the Share: Microsoft Teams feature. Also be aware that application state records (used to shorten long URLs) are cleaned up after inactivity.

**LANGUAGE**: none

**CODE**:
```text
Cloud admin guide:
https://help.sap.com/docs/SAP_S4HANA_CLOUD/0f69f8fb28ac4bf48d2b57b9637e81fa/257ec7408db6420682462cd1d000e744.html

On-prem guide:
https://help.sap.com/docs/SAP_S4HANA_ON-PREMISE/8308e6d301d54584a33cd04a9861bc52/849465e69b7a490a88049fe0b24fb01e.html?version=2023.000

Application state cleanup:
https://help.sap.com/docs/ABAP_PLATFORM_NEW/a7b390faab1140c087b8926571e942b7/6107ee41f89a43c9af0aa279fe039cca.html
```

**STEP**: 2 — Mark sensitive or personal fields to prevent leaking data via "As Card"

**DESCRIPTION**: If your app contains sensitive or personal data, mark such properties so they can be excluded from cards. Use the PersonalData vocabulary annotations: com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive and com.sap.vocabularies.PersonalData.v1.IsPotentiallyPersonal. Provide these annotations in your service metadata (annotation XML) or CDS model.

**LANGUAGE**: CDS

**CODE**:
```cds
namespace my.company;

entity Customer {
  key ID   : UUID;
  Name     : String(100);
  Email    : String(100);
  Salary   : Decimal(13,2) @com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive: true;
  SSN      : String(11)   @com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive: true;
  Phone    : String(20)   @com.sap.vocabularies.PersonalData.v1.IsPotentiallyPersonal: true;
}
```

**LANGUAGE**: XML (OData annotation file)

**CODE**:
```xml
<Annotations Target="my.company.Customer">
  <Annotation Term="com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive">
    <Record>
      <!-- Apply to specific properties -->
    </Record>
  </Annotation>

  <!-- Per-property annotation example -->
  <Annotations Target="my.company.Customer/Salary">
    <Annotation Term="com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive" Bool="true"/>
  </Annotations>
  <Annotations Target="my.company.Customer/SSN">
    <Annotation Term="com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive" Bool="true"/>
  </Annotations>
  <Annotations Target="my.company.Customer/Phone">
    <Annotation Term="com.sap.vocabularies.PersonalData.v1.IsPotentiallyPersonal" Bool="true"/>
  </Annotations>
</Annotations>
```

**STEP**: 3 — Define header actions that can be shared as a card (annotation-based only)

**DESCRIPTION**: Cards support only annotation-based header actions (DataFieldForAction) that are not overridden by manifest settings. Cards display only the first two supported actions. If actions are bound, the page context is passed. Use Common.IsActionCritical for confirmation actions (note: confirmation message text in card uses the default i18n key text).

**LANGUAGE**: XML (OData UI annotations — header actions)

**CODE**:
```xml
<Annotations Target="my.company.CustomerType">
  <Annotation Term="UI.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeName" String="Customer"/>
      <PropertyValue Property="Actions">
        <Collection>
          <!-- First displayed action -->
          <Record Type="UI.DataFieldForAction">
            <PropertyValue Property="Action" String="ConfirmOrder"/>
            <PropertyValue Property="Label" String="Confirm"/>
            <!-- InParameters show as dropdown fields in the Teams card (limited support) -->
            <PropertyValue Property="InParameters">
              <Collection>
                <PropertyPath>OrderID</PropertyPath>
              </Collection>
            </PropertyValue>
            <!-- Mark as critical (confirmation) -->
            <Annotation Term="com.sap.vocabularies.Common.v1.IsActionCritical">
              <Record>
                <PropertyValue Property="Value" Bool="true"/>
              </Record>
            </Annotation>
          </Record>

          <!-- Second displayed action -->
          <Record Type="UI.DataFieldForAction">
            <PropertyValue Property="Action" String="AssignToOwner"/>
            <PropertyValue Property="Label" String="Assign"/>
          </Record>

          <!-- Additional actions are ignored by the card (only first two shown) -->
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: CDS (DataFieldForAction / IsActionCritical example)

**CODE**:
```cds
entity Customer {
  key ID : UUID;
  Name    : String;
  // UI header actions declared in CDS via annotation syntax (example)
  @UI.headerInfo: {
    typeName: 'Customer',
    actions: [
      { action: 'ConfirmOrder', label: 'Confirm', @com.sap.vocabularies.Common.v1.IsActionCritical: true },
      { action: 'AssignToOwner', label: 'Assign' }
    ]
  }
}
```

**STEP**: 4 — Action parameter limitations and guidance

**DESCRIPTION**: Action parameter fields in Teams cards have limited UI support. They do not support field help (value help, dropdowns, date pickers), default values, or IN/OUT parameter mapping interactions. Keep parameter types simple (string/number) and avoid complex value help expectations for card actions.

**LANGUAGE**: none

**CODE**:
```text
Guidance:
- Use simple scalar parameters only (no complex types requiring value help).
- Do not rely on IN/OUT parameter mappings to populate dependent fields inside Teams card.
- If you rely on manifest-based or function-bound overrides for actions, they will not be available in a Teams card.
```

**STEP**: 5 — Control header facets shown on cards & restrictions

**DESCRIPTION**: Header facets can be shared as part of a card. The card only shows facets visible to the recipient. Cards do not support header facets containing micro charts, rating indicators, or progress indicators, nor custom facets or icon-based images. If your app modifies facet visibility/position/titles via manifest.json or custom code, the Teams card might not match the object page.

**LANGUAGE**: XML (facet annotation example)

**CODE**:
```xml
<!-- Example object page facets declaration -->
<Annotations Target="my.company.CustomerType">
  <Annotation Term="UI.Facets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Summary"/>
        <PropertyValue Property="Target">
          <Record Type="UI.DataPoint">
            <PropertyValue Property="AnnotationPath" String="@UI.HeaderFacets/0"/>
          </Record>
        </PropertyValue>
      </Record>

      <!-- Avoid micro chart, rating, progress, custom facets if card is required -->
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 6 — Numeric/currency formatting control for cards

**DESCRIPTION**: Data formatting can differ between object page and card. If you control precision using DataPoint.NumberOfFractionalDigits or use custom OData v4 formatters, formatting on cards may change. Specify DataPoint.NumberOfFractionalDigits to control fractional digits.

**LANGUAGE**: XML (DataPoint.NumberOfFractionalDigits)

**CODE**:
```xml
<Annotations Target="my.company.Customer/Salary">
  <Annotation Term="UI.DataPoint">
    <Record>
      <PropertyValue Property="Value" Path="Salary"/>
      <PropertyValue Property="NumberOfFractionalDigits">
        <Int>2</Int>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: CDS (NumberOfFractionalDigits example)

**CODE**:
```cds
entity Customer {
  key ID : UUID;
  Salary : Decimal(13,2)
    @UI.dataPoint: { value: 'Salary', numberOfFractionalDigits: 2 };
}
```

**STEP**: 7 — Manifest overrides that affect card sharing (and sample JSON)

**DESCRIPTION**: Actions or UI behavior overridden in manifest.json (via binding expressions or functions) can prevent annotation-based actions from being shared as a card. If you need cards to show actions, do not override those annotation-based actions in the manifest. Below is a typical manifest path where actions or sections may be overridden.

**LANGUAGE**: JSON (manifest.json excerpt)

**CODE**:
```json
{
  "sap.ui5": {
    "models": { /* ... */ },
    "routing": { /* ... */ },
    "sap.ui.generic.app": {
      "pages": [
        {
          "entitySet": "Customer",
          "component": {
            "name": "sap.suite.ui.generic.template.ObjectPage",
            "settings": {
              "header": {
                "actions": [
                  {
                    "id": "ActionCustom",
                    "text": "{{CUSTOM_ACTION}}",
                    "visible": "{= ${someModel>/flag} }",
                    "press": ".onCustomAction" // manifest-based handling -> NOT supported in Teams cards
                  }
                ]
              }
            }
          }
        }
      ]
    }
  }
}
```

**STEP**: 8 — Incognito / third-party cookie note for end users

**DESCRIPTION**: End users using browser incognito mode must allow third-party cookies; otherwise Teams share will produce HTTP 401 Unauthorized. Inform users in release notes or help pages.

**LANGUAGE**: none

**CODE**:
```text
User guidance:
- If seeing "Authentication Information HTTP Status 401 - Unauthorized" in incognito mode, enable third-party cookies for the session.
```

**STEP**: 9 — Security and documentation references

**DESCRIPTION**: Link to security configuration and integration admin guides for full deployment and security considerations.

**LANGUAGE**: none

**CODE**:
```text
Security configuration (app-specific guidance):
See security-configuration-ba0484b.md (project docs)

Integration links (repeated):
- Cloud: https://help.sap.com/docs/SAP_S4HANA_CLOUD/...
- On-prem: https://help.sap.com/docs/SAP_S4HANA_ON-PREMISE/...
```
--------------------------------

**TITLE**: Table Building Block (sap.fe.macros.Table) — Instantiation, Actions, APIs, and Extensibility

**INTRODUCTION**: Practical, code-focused reference for using the Table building block (sap.fe.macros.Table) in Fiori Elements flexible programming model. Covers instantiation, actions and action groups, creation options, FilterBar linking, programmatic APIs (presentation/selection variants, variant IDs, messages), dynamic request modification (beforeRebindTable), and triggering inline creation via editFlow.createDocument. Use these snippets directly in fragments and controller extensions.

**TAGS**: fiori-elements, sap.fe.macros, Table, UI5, building-blocks, FilterBar, actions, edit-flow, variants, collectionBindingInfo

STEP: 1 — Instantiate Table Building Block

DESCRIPTION: Add the Table building block to a fragment or XML view. The metaPath accepts an entitySet or a navigation property; you can reference a LineItem annotation path. Ensure the macros namespace is declared (xmlns:macros="sap.fe.macros").

LANGUAGE: XML

CODE:
```xml
<!-- Examples: entitySet, navigation property, nav property LineItem annotation -->
<macros:Table xmlns:macros="sap.fe.macros" metaPath="/MyEntitySet" id="MyEntityTable" />

<macros:Table xmlns:macros="sap.fe.macros" metaPath="MyNavProperty" id="MyNavPropertyTable" />

<macros:Table xmlns:macros="sap.fe.macros" metaPath="MyNavProperty/@com.sap.vocabularies.UI.v1.LineItem" id="MyNavPropertyLineItemTable" />
```

STEP: 2 — Add Bound/Unbound Actions and Action Groups

DESCRIPTION: Define table-level actions inside the Table's macros:actions aggregation. Use `requiresSelection="true"` to make an action bound (operates on selected rows). Use `placement` and `anchor` to position actions relative to existing anchors. Group actions with macros:ActionGroup; group children become menu items.

LANGUAGE: XML

CODE:
```xml
<macros:Table xmlns:macros="sap.fe.macros"
              metaPath="@com.sap.vocabularies.UI.v1.LineItem"
              readOnly="true"
              id="LineItemTablePageCustomActions">

    <!-- Creation options example (see STEP 3) -->
    <creationMode name="InlineCreationRows" inlineCreationRowsHiddenInEditMode="true" />

    <!-- Table actions: placed inside the Table -->
    <macros:actions>
        <!-- Bound action (requires selection) placed after an anchor action -->
        <macros:Action
            key="customAction"
            text="My Custom Action"
            press=".onPressAction"
            placement="After"
            anchor="DataFieldForAction::Service.toggleBoolean"
            requiresSelection="true" />

        <!-- Grouped actions attached to the customAction anchor -->
        <macros:ActionGroup
            text="Grouped Actions"
            placement="After"
            anchor="customAction">
            <macros:Action text="Menu Action 1" press=".onPressMenuAction" />
            <macros:Action text="Menu Action 2" press=".onPressMenuAction" />
        </macros:ActionGroup>
    </macros:actions>
</macros:Table>
```

STEP: 3 — Specify Creation Options (creationMode)

DESCRIPTION: Configure how new rows/documents are created for the table via the creationMode aggregation. See API reference for TableCreationOptions for available modes.

LANGUAGE: XML

CODE:
```xml
<macros:Table xmlns:macros="sap.fe.macros"
              metaPath="@com.sap.vocabularies.UI.v1.LineItem"
              readOnly="true"
              id="LineItemTableWithCreationOptions">
    <creationMode name="InlineCreationRows" inlineCreationRowsHiddenInEditMode="true" />
    <!-- other aggregations (actions, columns, etc.) -->
</macros:Table>
<!-- API reference: https://ui5.sap.com/#/api/sap.fe.macros.table.TableCreationOptions -->
```

STEP: 4 — Link a FilterBar (same view or different view)

DESCRIPTION: Connect a FilterBar instance to the table using the Table's filterBar attribute (accepts local or global ID). This wires selection fields/filters to the table binding.

LANGUAGE: XML

CODE:
```xml
<Panel headerText="Table in Display Mode with FilterBar">
    <macros:FilterBar xmlns:macros="sap.fe.macros"
                      metaPath="@com.sap.vocabularies.UI.v1.SelectionFields#SF1"
                      id="FilterBar" />
    <macros:Table xmlns:macros="sap.fe.macros"
                  metaPath="@com.sap.vocabularies.UI.v1.LineItem"
                  displayMode="true"
                  id="LineItemTable"
                  filterBar="FilterBar" />
</Panel>
```

STEP: 5 — Use Table Programmatic APIs (presentation/selection variants, variant IDs, messages, isSearchable)

DESCRIPTION: Obtain the Table control (by ID) and call public APIs to get/set presentation and selection variants, set/get current variant ID, and send/remove messages. Toggle the Search field via the isSearchable parameter on the Table definition (set in XML). Use these APIs in controllers or controller extensions.

LANGUAGE: JavaScript

CODE:
```javascript
// Get table control (example uses view-local ID)
var table = this.getView().byId("LineItemTable");

// Presentation Variant (get / set)
var pv = table.getPresentationVariant(); // get current presentation variant object
table.setPresentationVariant(pv);        // set a presentation variant

// Selection Variant (requires table personalization enabled)
var sv = table.getSelectionVariant();
table.setSelectionVariant(sv);

// Current variant ID (programmatic set/get)
table.setCurrentVariantID("myVariantId");
var currentId = table.getCurrentVariantID();

// Messages: send and remove messages related to the table
table.sendMessage({
    type: "Error",
    message: "Row-level validation error",
    target: "/EntitySet('ID')"
});
table.removeMessage(/* messageId or message object depending on API */);

// Disable Search field in toolbar by setting isSearchable in XML:
// <macros:Table ... isSearchable="false" ... />
```

STEP: 6 — Influence Table Request Dynamically (beforeRebindTable)

DESCRIPTION: Use the beforeRebindTable hook on the Table to access CollectionBindingInfo before the table rebinds. Add filters, sorters, or additional select properties via collectionBindingInfo API. Add beforeRebindTable=".tableRefreshed" on the Table and implement the handler in the page/controller extension.

LANGUAGE: XML

CODE:
```xml
<macros:Table xmlns:macros="sap.fe.macros"
              metaPath="@com.sap.vocabularies.UI.v1.LineItem"
              readOnly="true"
              id="LineItemTablePageCustomActions"
              isSearchable="false"
              beforeRebindTable=".tableRefreshed">
</macros:Table>
```

LANGUAGE: JavaScript

CODE:
```javascript
sap.ui.define(
    [
        "sap/fe/core/PageController",
        "sap/m/MessageBox",
        "sap/ui/model/Filter",
        "sap/ui/model/FilterOperator",
        "sap/ui/model/Sorter"
    ],
    function (PageController, MessageBox, Filter, FilterOperator, Sorter) {
        "use strict";

        return PageController.extend("sap.fe.core.fpmExplorer.tableCustoms.Page", {
            tableRefreshed: function (event) {
                // Retrieve collectionBindingInfo API from event parameters
                var collectionBindingInfoAPI = event.getParameter("collectionBindingInfo");

                // Add a filter: BooleanProperty == false
                var filter = new Filter({
                    path: "BooleanProperty",
                    operator: FilterOperator.EQ,
                    value1: false
                });
                collectionBindingInfoAPI.addFilter(filter);

                // Add a sorter: ID descending
                var sorter = new Sorter("ID", true);
                collectionBindingInfoAPI.addSorter(sorter);

                // Request an additional property in the OData request
                collectionBindingInfoAPI.addSelect(["TagStatus"]);
            }
        });
    }
);
```

STEP: 7 — Trigger Creation of a New Document Within a Table (editFlow.createDocument)

DESCRIPTION: From an editFlow controller extension, get a reference to the table control and call this.base.editFlow.createDocument(table, options) to trigger creation. Provide creation mode, position, and initial data payload.

LANGUAGE: JavaScript

CODE:
```javascript
// Example inside a controller extension method

// Get the table API (use the table's global or local id as appropriate)
var table = this.getView().byId("fe::table::_Child::LineItem::Table");

// Create document within the table using editFlow
this.base.editFlow
    .createDocument(table, {
        creationMode: coreLibrary.CreationMode.Inline, // creation mode enum
        createAtEnd: true,
        data: {
            ChildTitleProperty: "Child Object Custom Title",
            ChildDescriptionProperty: "Child Custom Description"
        }
    })
    .then(function () {
        MessageToast.show("Custom create action successfully invoked");
    });
```
--------------------------------

**TITLE**: TreeTable Building Block (sap.fe.macros.TreeTable)

**INTRODUCTION**: Use the TreeTable building block to render hierarchical (tree) tables in UI5 XML views without exposing tree-specific parameters in the generic Table building block. Provide an OData metaPath pointing to the LineItem annotation and a hierarchyQualifier referencing the hierarchy annotation. Useful for display-only or editable tree table UIs in Fiori elements / Flexible Programming Model apps.

**TAGS**: fiori-elements-framework, sap.fe.macros, TreeTable, UI5, XML, Flexible-Programming-Model

**STEP**: 1 — Minimal XML usage example

**DESCRIPTION**: Copy this minimal XML view to add a TreeTable. Adjust metaPath to your entity's LineItem annotation and hierarchyQualifier to the qualifier defined in your OData metadata. Use readOnly="true" for display-only trees. Keep or change controllerName as needed.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
	xmlns="sap.m"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:macros="sap.fe.macros"
	controllerName="sap.fe.core.fpmExplorer.treeTable.TreeTable"
>
	<Page enableScrolling="true">
		<Panel headerText="Tree table in Display Mode">
			<macros:TreeTable
				metaPath="/Products/@com.sap.vocabularies.UI.v1.LineItem"
				hierarchyQualifier="ProductsHierarchy"
				readOnly="true"
				id="treeTable"
			/>
		</Panel>
	</Page>
</mvc:View>
```

**STEP**: 2 — Common properties and their types

**DESCRIPTION**: Properties you will commonly set on the TreeTable. Use these to bind the correct annotation path and configure behavior.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "metaPath": {
    "type": "OData annotation path (string)",
    "description": "Path to the LineItem annotation for the entity, e.g. '/Products/@com.sap.vocabularies.UI.v1.LineItem'",
    "required": true
  },
  "hierarchyQualifier": {
    "type": "string",
    "description": "Qualifier of the hierarchy annotation in the service metadata, e.g. 'ProductsHierarchy'",
    "required": true
  },
  "readOnly": {
    "type": "boolean",
    "description": "Renders the tree table in display-only mode when true",
    "required": false,
    "default": false
  },
  "id": {
    "type": "string",
    "description": "Control ID to reference the TreeTable in code",
    "required": false
  },
  "controllerName": {
    "type": "string",
    "description": "Optional view controller name; example in sample uses 'sap.fe.core.fpmExplorer.treeTable.TreeTable'",
    "required": false
  }
}
```

**STEP**: 3 — Live example (Flexible Programming Model Explorer)

**DESCRIPTION**: Open the live example to see a working TreeTable in the FPM explorer.

**LANGUAGE**: text

**CODE**:
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/treeTable

**STEP**: 4 — Further documentation and API reference

**DESCRIPTION**: References for deeper details: a conceptual doc on Tree Tables and the API reference for the TreeTable macro.

**LANGUAGE**: text

**CODE**:
- Conceptual doc: tree-tables-7cf7a31.md
- API Reference: https://ui5.sap.com/#/api/sap.fe.macros.TreeTable
--------------------------------

**TITLE**: VariantManagement building block — page-level variant management for flexible programming model SAPUI5 apps

**INTRODUCTION**: Use the VariantManagement building block to enable page-level variant management for any flex-enabled controls (FilterBar, Table, Chart, etc.) in flexible programming model SAPUI5 (fiori elements) applications. This will capture and save flex-relevant user personalization changes across linked controls into user-defined variants.

**TAGS**: fiori-elements-framework, VariantManagement, SAPUI5, flexible-programming-model, FilterBar, Table, Chart, variantManagement, macros

STEP: 1 — Choose variant-management scope

DESCRIPTION: Decide whether you need page-level or control-level variant management.
- Page-level: Use the VariantManagement building block. It links multiple flex-enabled controls and saves personalization changes from all linked controls into variants.
- Control-level: Do not use the VariantManagement building block. Instead enable the control's built-in variantManagement property on the specific control (Table or Chart). Use the control-level property if you only want variant management for a single control.

LANGUAGE: text

CODE:
```text
# Summary:
# - Page-level: add <macros:VariantManagement for="ControlID1,ControlID2,..."> to your XML view
# - Control-level: set the control's variantManagement property (see the Table/Chart API reference)
```

STEP: 2 — Implement page-level VariantManagement in an XML view

DESCRIPTION: Add the VariantManagement building block into your XML view (for example, a DynamicPage). Use the `for` association to list the IDs of flex-enabled controls that should be linked (comma-separated). The building block captures flex-relevant personalization changes for these controls and saves them into user-created variants. You can set additional properties such as `showSetAsDefault` and `headerLevel`.

Place this code in the XML view file where your page title/heading is defined (e.g., View.view.xml).

LANGUAGE: XML

CODE:
```xml
<!-- View.view.xml -->
<f:DynamicPage id="FilterBarVMWithTable" class="sapUiResponsiveContentPadding">
    <f:title>
        <f:DynamicPageTitle id="_IDGenDynamicPageTitle1">
            <f:heading>
                <!-- VariantManagement building block linked to FilterBar and LineItemTable controls -->
                <macros:VariantManagement
                    id="vm"
                    for="FilterBar,LineItemTable"
                    showSetAsDefault="true"
                    headerLevel="H2" />
            </f:heading>
        </f:DynamicPageTitle>
    </f:title>

    <f:header>
        <f:DynamicPageHeader id="_IDGenDynamicPageHeader1" pinnable="true">
            <VBox id="_IDGenVBox1">
                <!-- FilterBar control (linked via 'for' above) -->
                <macros:FilterBar metaPath="@com.sap.vocabularies.UI.v1.SelectionFields" id="FilterBar" />
            </VBox>
        </f:DynamicPageHeader>
    </f:header>

    <f:content>
        <!-- Table control (linked via 'for' above). The VariantManagement building block will capture changes for this table. -->
        <macros:Table metaPath="@com.sap.vocabularies.UI.v1.LineItem" readOnly="true" id="LineItemTable" filterBar="FilterBar" />
    </f:content>
</f:DynamicPage>
```

STEP: 3 — Notes on the `for` association and behavior

DESCRIPTION: Implementation details and expected behavior:
- The `for` association accepts a comma-separated list of control IDs (strings). Example: for="FilterBar,LineItemTable".
- Once linked, VariantManagement automatically captures flex-relevant user personalization changes for all linked controls (FilterBar, Table, Chart, etc.) and saves them when the user saves a variant.
- Use `showSetAsDefault="true"` to allow the user to set a variant as default from the Variant Management UI.
- Use `headerLevel` to control the rendered header semantic level (e.g., H2).

LANGUAGE: text

CODE:
```text
# Behavior:
# - 'for' links controls by ID: for="ControlIdA,ControlIdB,..."
# - VariantManagement captures and saves personalization changes for linked controls into the created variant
# - showSetAsDefault="true" exposes "Set as Default" option in the variant dialog
# - headerLevel controls rendered heading semantics (H1, H2, etc.)
```

STEP: 4 — Where to find API docs and live examples

DESCRIPTION: Reference links for API details and a live example in the flexible programming model explorer.

LANGUAGE: text

CODE:
```text
# API Reference for VariantManagement building block:
https://ui5.sap.com/#/api/sap.fe.macros.VariantManagement

# API Reference for Table macro (control-level variantManagement details):
https://ui5.sap.com/#/api/sap.fe.macros.Table

# Live example (Filter Bar - Table With Variant Management):
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/filterBar/filterBarVMWithTable
```
--------------------------------

**TITLE**: Time Series Chart Card — Implementation Guide and Code Samples

**INTRODUCTION**: Practical, code-focused guide for implementing a Time Series Chart Card in SAP Fiori Elements (Analytical Card). Includes the automatic time-axis requirements, metadata and annotation code samples for XML UI.Chart, ABAP CDS and CAP CDS.

**TAGS**: fiori-elements-framework, time-series, UI.Chart, OData, metadata, CDS, ABAP, CAP, XML

**STEP**: 1 — Time Series Axis Requirements (Action Checklist)

**DESCRIPTION**: Validate and apply the conditions that enable an automatic time axis for analytical cards. Use these rules as pre-deployment checks in code generation or CI validation scripts.

**LANGUAGE**: Text

**CODE**:
```text
Requirements for automatic Time Axis (must all apply):

1. ChartType must be one of:
   - VerticalBullet, StackedColumn, Scatter, Line, Bubble, Column, Waterfall,
     Combination, DualCombination

2. Dimension counts:
   - Bubble, Column, Waterfall, Combination: exactly ONE dimension
   - Line: ONE or TWO dimensions (second dimension can be the color/series)
   - For a color/series dimension, the dimension must have uid 'color' and role = Series

3. Dimension data types:
   - Preferred: edm.datetime (e.g., Edm.DateTime)
   - If edm.string: the OData metadata must include sap:semantics indicating one of:
     "year (YYYY)", "yearweek (YYYYWW)", "yearmonth (YYYYMM)", "yearquarter (YYYYQ)"

4. Measure counts:
   - Bubble: exactly TWO measures
   - Combination: at least TWO measures
   - VerticalBullet, StackedColumn, Scatter: at least ONE measure + ONE dimension
   - Scatter supports extra color and shape dimensions

Use these checks to generate/validate: OData metadata, UI.Chart annotations, or CDS annotations.
```

**STEP**: 2 — OData Metadata: Date Property (Edm.DateTime)

**DESCRIPTION**: Add/verify the OData property metadata for the time dimension using Edm.DateTime (recommended). Ensure sap:aggregation-role="dimension" is present for the time property.

**LANGUAGE**: XML

**CODE**:
```xml
<Property Name="Date" Type="Edm.DateTime"
          sap:display-format="Date"
          sap:label="Date"
          sap:aggregation-role="dimension"/>
```

**STEP**: 3 — OData Metadata: String-Based Time Dimension (Semantics)

**DESCRIPTION**: If the time dimension is an Edm.String, annotate its semantics in OData metadata so Fiori Elements recognizes it as time-based. Ensure one of the allowed semantics is set: year, yearweek, yearmonth, yearquarter.

**LANGUAGE**: Text

**CODE**:
```text
Example semantics values to include in the OData metadata for an Edm.String time property:
- sap:semantics="year"       -> format YYYY
- sap:semantics="yearweek"   -> format YYYYWW
- sap:semantics="yearmonth"  -> format YYYYMM
- sap:semantics="yearquarter"-> format YYYYQ

Note: exact syntax depends on your EDM metadata generator. Confirm the generated metadata contains the semantic string.
```

**STEP**: 4 — XML Annotation: UI.Chart (Line with Time + Currency Series)

**DESCRIPTION**: Use this UI.Chart annotation in the service metadata or annotation file to configure a time-series line chart with a Category (time) dimension and a Series (currency) dimension. Keep qualifier unique.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.Chart" Qualifier="Line-Time_-Currency">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="View1" />
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Line"/>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="SalesShare" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Eval_by_CtryCurr_-SalesShare"/>
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="DimensionAttributes">
            <Collection>
                <Record Type="UI.ChartDimensionAttributeType">
                    <PropertyValue Property="Dimension" PropertyPath="Date" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
                </Record>
                <Record Type="UI.ChartDimensionAttributeType">
                    <PropertyValue Property="Dimension" PropertyPath="Sales_CURRENCY"/>
                    <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Series"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 5 — ABAP CDS Annotation: UI.Chart (Line with Time + Currency Series)

**DESCRIPTION**: Add the ABAP CDS @UI.Chart annotation to expose a time-series line chart. Use qualifier to separate multiple charts on the same view/entity. Set measureAttributes and dimensionAttributes as shown.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Chart: [
  {
    title: 'View1',
    chartType: #LINE,
    measureAttributes: [
      {
        measure: 'SalesShare',
        role: #AXIS_1,
        asDataPoint: true
      }
    ],
    dimensionAttributes: [
      {
        dimension: 'Date',
        role: #CATEGORY
      },
      {
        dimension: 'Sales_CURRENCY',
        role: #SERIES
      }
    ],
    qualifier: 'Line-Time-Currency'
  }
]
annotate view VIEWNAME with { }
```

**STEP**: 6 — CAP CDS Annotation: UI.Chart (Line with Time + Currency Series)

**DESCRIPTION**: Use CAP CDS (annotations in CDS JSON-like format) to define the UI.Chart annotation for time-series charts. Reference DataPoint annotations with the DataPoint annotation path format.

**LANGUAGE**: CAP CDS

**CODE**:
```cap
UI.Chart #Line-Time-Currency : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'View1',
    ChartType : #Line,
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : SalesShare,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#Eval_by_CtryCurr-SalesShare'
        }
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : Date,
            Role : #Category
        },
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : Sales_CURRENCY,
            Role : #Series
        }
    ]
}
```

**STEP**: 7 — Implementation Notes (Quick Actions for Code Generators)

**DESCRIPTION**: Concrete actions for generators and CI validations to produce correct time-series charts.

**LANGUAGE**: Text

**CODE**:
```text
- Validate chartType against allowed list and emit an error/warning if unsupported.
- Enforce dimension count rules per chart type before generating UI.Chart annotations.
- Ensure time dimension property in OData metadata is either Edm.DateTime OR Edm.String with correct sap:semantics.
- For Bubble charts: ensure exactly two measures in MeasureAttributes.
- For Combination charts: ensure at least two measures.
- If using a Series/color dimension, set its role to Series in DimensionAttributes.
- Generate unique qualifier values for multiple charts on the same entity/view.
- When emitting DataPoint references, match the annotation path format used in your metadata (e.g., @UI.DataPoint#Qualifier-Name).
```
--------------------------------

**TITLE**: Toggling Between Draft and Saved Values (SAP Fiori elements — OData V2 & V4)

**INTRODUCTION**: This document describes the UI behavior and actionable steps for toggling between draft and saved values in draft-enabled SAP Fiori elements applications (OData V2 and OData V4). Use this to implement, test, or automate UI behavior on list reports and object pages where drafts and saved versions coexist.

**TAGS**: fiori-elements-framework, draft, list-report, object-page, odata-v2, odata-v4, ui-behavior, ui-testing

STEP: List Report — Editing Status filter behavior

DESCRIPTION: Draft-enabled list reports include an additional filter entry named "All (Hiding Drafts)". When this value is selected, only saved objects and their saved data are shown in the list report table. If a saved object has a corresponding draft, the list entry still shows the saved data (not the draft).

LANGUAGE: text

CODE:
```text
Editing Status filter entry: "All (Hiding Drafts)"
Behavior:
- Table rows show only saved objects with saved values.
- Drafts are not shown in the list even if a draft exists for an object.
```

STEP: List Report → Object Page navigation behavior

DESCRIPTION: When navigating from the list report to an object page (with "All (Hiding Drafts)" selected), if a draft exists for the selected object, the object page opens displaying the saved version. The UI displays a "Return to Draft" affordance (or "Saved Version/Draft" menu) to allow switching to the draft.

LANGUAGE: text

CODE:
```text
Navigation scenario:
- From list report (All (Hiding Drafts)) --> select saved object row
- Object page initial state: Saved version shown
- If a draft exists: UI indicates availability and exposes a "Return to Draft" action
```

STEP: Object Page — Saved Version / Draft toggle and popover

DESCRIPTION: On object pages where a draft exists, a "Saved Version / Draft" button is visible. Clicking the button opens a popover that lists the saved and draft versions and allows toggling between them. The button label indicates which version is currently displayed (e.g., "Draft" when the draft is shown, "Saved Version" when the saved version is shown).

LANGUAGE: text

CODE:
```text
Object page UI elements:
- Toggle button label examples: "Saved Version" / "Draft"
- Action: Click opens popover -> choose "Show Draft" or "Show Saved Version"
- Result: Page reloads/refreshes to display selected version's values
UI hint: Button label reflects currently visible version.
```

STEP: Navigating back to the List Report

DESCRIPTION: When returning from the object page back to the list report while the list report filter is "All (Hiding Drafts)", only saved objects with their saved values are displayed. The list report does not automatically show drafts even if you previously viewed a draft on the object page.

LANGUAGE: text

CODE:
```text
Back navigation behavior:
- Context: List report filter = "All (Hiding Drafts)"
- After viewing object page (draft or saved), navigating back -> list still displays only saved objects with saved values
```

STEP: Classic Header (OData V2) — header toolbar behavior

DESCRIPTION: For SAP Fiori elements OData V2 apps that use the classic header, the UI shows the "Display Saved Version" / "Return to Draft" button in the header toolbar instead of the menu button next to the title. Use this label mapping when writing tests or customizing header toolbar behavior.

LANGUAGE: text

CODE:
```text
Classic header (OData V2) button labels:
- Toolbar button: "Display Saved Version" or "Return to Draft"
- Location: header toolbar (classic header) — not the menu next to title
```

STEP: Reference images and resources

DESCRIPTION: Preserve original illustrative assets and related documentation links for implementation guidance and visual verification.

LANGUAGE: text

CODE:
```text
Images referenced:
- images/Toggling_Between_Draft_and_Saved_Values_1_6817734.png
- images/Object_Page_Draft_Version_is_Shown_Including_Toggle_Popover_fbdd6a2.png
- images/Object_Page_Saved_Version_is_Shown_4d6823f.png

Related documentation:
- draft-handling-ed9aa41.md
```
--------------------------------

**TITLE**: Toggling Object Page Header Field Editability (Fiori Elements)

**INTRODUCTION**: Enable or disable editability of fields in the Object Page header via the manifest property editableHeaderContent. This document shows where to add the property for OData V2 and OData V4 apps, explains default behavior differences, and lists constraints that still apply at the field/facet level.

**TAGS**: fiori-elements-framework, manifest, editableHeaderContent, ODataV2, ODataV4, object-page, header

**STEP**: 1 — Default behavior and high-level rules

**DESCRIPTION**: Summary of default behaviors and how editableHeaderContent interacts with per-field/facet editability. Actionable notes you must consider when toggling header editability.

- OData V2: header is NOT editable by default. Set editableHeaderContent: true to enable header editing.
- OData V4: header IS editable by default. Set editableHeaderContent: false to disable header editing.
- Setting editableHeaderContent controls whether header fields can be edited globally; individual fields/facets still require to be editable (annotations/metadata). Non-editable controls (e.g., micro chart facets) or fields marked ReadOnly remain non-editable even when editableHeaderContent is true.

**LANGUAGE**: TEXT

**CODE**:
```text
Defaults:
- OData V2: editableHeaderContent default = false  -> set to true to enable header edit
- OData V4: editableHeaderContent default = true   -> set to false to disable header edit

Behavior:
- editableHeaderContent controls header-level editability.
- Individual field/facet editability still enforced by annotations/metadata.
- Micro chart facets are not editable. ReadOnly fields remain non-editable.
```

**STEP**: 2 — Enable header editability in OData V2 (manifest.json)

**DESCRIPTION**: Add editableHeaderContent: true under the ObjectPage component's settings in sap.ui.generic.app.pages for the target entitySet. File: manifest.json. This enables editing of header fields for that Object Page (per-field editability still applies).

**LANGUAGE**: JSON

**CODE**:
```json
"sap.ui.generic.app": {
    "pages": [
        {
            "entitySet": "SEPMRA_C_PD_Product",
            "component": {
                "name": "sap.suite.ui.generic.template.ListReport",
                "list": true
            },
            "pages": [
                {
                    "entitySet": "SEPMRA_C_PD_Product",
                    "component": {
                        "name": "sap.suite.ui.generic.template.ObjectPage",
                        "settings": {
                            "editableHeaderContent": true
                        }
                    },
                    "pages": [
                        {
                            "navigationProperty": "to_ProductText",
                            "entitySet": "SEPMRA_C_PD_ProductText",
                            "component": {
                                "name": "sap.suite.ui.generic.template.ObjectPage"
                            }
                        }
                    ]
                }
            ]
        }
    ]
}
```

**STEP**: 3 — Enable header editability in OData V4 (manifest.json)

**DESCRIPTION**: For OData V4 Fiori elements apps, set editableHeaderContent under the target options.settings for the Object Page component in sap.ui5.routing.targets. File: manifest.json. The example shows enabling header editability for a SalesOrderItemObjectPage. (In V4 the header is editable by default; set to false to disable.)

**LANGUAGE**: JSON

**CODE**:
```json
"sap.ui5": {
    ...
    "routing": {
            ...
            {
                "pattern": "SalesOrderManage({key})/_Item({key2}):?query:",
                "name": "SalesOrderItemObjectPage",
                "target": "SalesOrderItemObjectPage"
            }
        ],
        "targets": {
            "SalesOrderItemObjectPage": {
                "type": "Component",
                "id": "SalesOrderItemObjectPage",
                "name": "sap.fe.templates.ObjectPage",
                "options": {
                    "settings": {
                        "contextPath": "/SalesOrderItem",
                        "editableHeaderContent": true,
                        ...
                    }
                }
            }
        }
    }
}
```

**STEP**: 4 — Disable header editability in OData V4 (manifest.json) — optional

**DESCRIPTION**: To turn off header editability in a V4 app (if you prefer header fields not be editable by default), set editableHeaderContent to false in the same location under sap.ui5.routing.targets target options.settings.

**LANGUAGE**: JSON

**CODE**:
```json
"options": {
    "settings": {
        "contextPath": "/SalesOrderItem",
        "editableHeaderContent": false
    }
}
```

**STEP**: 5 — Behavior and constraints to validate in code/tests

**DESCRIPTION**: After changing editableHeaderContent, validate the following in your UI and automation tests:
- Individual fields marked ReadOnly remain non-editable.
- Facets that are inherently non-editable (e.g., micro chart facets) remain non-editable.
- Editing exposure: ensure actions (save/cancel) and change handling are available if header fields become editable.
- If using annotations or metadata to control editability, ensure those annotations are present and processed by the template.

**LANGUAGE**: TEXT

**CODE**:
```text
Validation checklist:
- Confirm header input controls become editable when editableHeaderContent = true (V2) or not disabled (V4).
- Confirm fields with ReadOnly metadata remain non-editable.
- Confirm micro chart and other non-editable facets remain unchanged.
- Confirm save/cancel and draft handling (if applicable) behave correctly after enabling header edits.
```
--------------------------------

**TITLE**: Tree Tables — Configuration and Extension Samples for SAP Fiori Elements (OData V4)

**INTRODUCTION**: This document collects concise, action-oriented manifest and extension code examples, annotations, and behavioral notes required to enable and extend TreeTable functionality in SAP Fiori elements for OData V4. Use these snippets to configure tableSettings in manifest.json, implement controller extension callbacks, and add backend annotations to control hierarchy behavior (drag/drop, create modes, copy/paste, restrictions).

**TAGS**: TreeTable, manifest.json, ControllerExtension, hierarchy, drag-and-drop, createMode, createInPlace, copy-paste, OData V4, annotations, RecursiveHierarchyActions

STEP: Enable TreeTable in manifest.json

DESCRIPTION: Configure the page tableSettings to use a TreeTable and reference the hierarchy qualifier that matches the Hierarchy.RecursiveHierarchy annotation qualifier on the page entity set.

LANGUAGE: JSON

CODE:
```json
// manifest.json (page/tableSettings)
{
  "tableSettings": {
    "type": "TreeTable",
    "hierarchyQualifier": "NodesHierarchy",
    "personalization": true
  }
}
```

STEP: TreeTable behavior notes for Draft-enabled services and FCL

DESCRIPTION: Key behavioral restrictions and notes to consider when using TreeTable with draft-enabled services and Flexible Column Layout.

LANGUAGE: text

CODE:
```text
- Applicable only for SAP Fiori elements for OData V4.
- With draft-enabled service:
  - Only active entities are displayed.
  - Editing Status field is not displayed in the filter bar.
  - Draft indicator shown if a draft exists for an active record.
  - New objects must be saved or discarded when created.
  - Saved object draft behavior and navigation remain unchanged.
  - Same extension points as object page.
- Expansion state of a tree table in an object page is NOT retained when switching between edit and display mode.
- Restriction: TreeTable cannot be displayed on the List Report with a draft-enabled service in the Flexible Column Layout (FCL).
```

STEP: Configure supported creation modes and custom create menu entries

DESCRIPTION: Configure creation mode (Inline, NewPage, CreationDialog). For custom menu-based create options use nodeType with propertyName and values. Use creationFields referencing a FieldGroup or comma-separated list. Provide isCreateEnabled as a controller extension callback reference.

LANGUAGE: JSON

CODE:
```json
// manifest.json - custom create mode example (menu options)
{
  "tableSettings": {
    "type": "TreeTable",
    "hierarchyQualifier": "NodesHierarchy",
    "personalization": true,
    "creationMode": {
      "name": "Inline",
      "nodeType": {
        "propertyName": "nodeType",
        "values": {
          "Zone": "Create a new Zone",
          "Intermediary": "Create a new Intermediary node",
          "Line": "Create a new Line item"
        }
      },
      "isCreateEnabled": ".extension.hierarchy-edit.custom.OPExtend.enableCreate"
    }
  }
}
```

STEP: Configure a CreationDialog with node-specific creation fields

DESCRIPTION: Use "CreationDialog" for creationMode and specify creationFields globally or per nodeType value. The creationFields may be a property name or point to a FieldGroup annotation.

LANGUAGE: JSON

CODE:
```json
// manifest.json - CreationDialog with node-specific creationFields
{
  "tableSettings": {
    "type": "TreeTable",
    "hierarchyQualifier": "NodesHierarchy",
    "personalization": true,
    "creationMode": {
      "name": "CreationDialog",
      "creationFields": "Title",
      "nodeType": {
        "propertyName": "nodeType",
        "values": {
          "Zone": "Create a new Zone",
          "Intermediary": {
            "label": "Create a new Intermediary node",
            "creationFields": "Category"
          },
          "Line": "Create a new Line item"
        }
      },
      "isCreateEnabled": ".extension.hierarchy-edit.custom.OPExtend.enableCreate"
    }
  }
}
```

STEP: Implement isCreateEnabled extension callback (ControllerExtension)

DESCRIPTION: Implement the callback that controls whether the Create button/menu entries are enabled. The callback receives the selected menu item value (null for standard mode) and the parent context (undefined if creating at root). Example uses ControllerExtension to export enableCreate.

LANGUAGE: JavaScript

CODE:
```javascript
// webapp/extension/hierarchy-edit.custom.OPExtend.js
sap.ui.define(["sap/ui/core/mvc/ControllerExtension"], function (ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("hierarchy-edit.custom.OPExtend", {
    // Callback to enable Create actions
    // value: selected menu item value (null for standard create)
    // parentContext: binding context of parent or undefined for root
    enableCreate: function (value, parentContext) {
      switch (parentContext?.getProperty("nodeType")) {
        case "Zone":
          return value !== "Zone"; // Anything but 'Zone' under 'Zone'
        case "Intermediary":
          return value === "Line"; // Only 'Line' under 'Intermediary'
        case "Line":
          return false; // Nothing under 'Line'
        default:
          return value === "Zone"; // Only 'Zone' at root level
      }
    }
  });
});
```

STEP: Place newly created node at position calculated by backend (createInPlace)

DESCRIPTION: Use createInPlace:true in creationMode to let backend determine the node's real position under its parent according to sort/filter criteria. If the node cannot be visualized due to filters, a message toast is shown (except specific FCL/NewPage behavior noted below).

LANGUAGE: JSON

CODE:
```json
// manifest.json - createInPlace example
{
  "tableSettings": {
    "type": "TreeTable",
    "hierarchyQualifier": "NodesHierarchy",
    "personalization": true,
    "creationMode": {
      "name": "Inline",
      "createInPlace": true,
      "nodeType": {
        "propertyName": "nodeType",
        "values": {
          "Zone": "Create a new Zone",
          "Intermediary": "Create a new Intermediary node",
          "Line": "Create a new Line item"
        }
      },
      "isCreateEnabled": ".extension.hierarchy-edit.custom.OPExtend.enableCreate"
    }
  }
}
```

STEP: createInPlace behavior notes for FCL/NewPage

DESCRIPTION: Notes specific to Flexible Column Layout with NewPage + createInPlace combination.

LANGUAGE: text

CODE:
```text
- Note: In Flexible Column Layout (FCL), using NewPage + createInPlace, the new entry is shown (for example, in a subobject page),
  but no message toast is displayed if it cannot be shown on the object page due to the applied filter criteria.
```

STEP: Enable drag & drop - manifest.json hooks

DESCRIPTION: Wire isMoveToPositionAllowed and isNodeMovable extension callbacks in manifest.json to implement custom move/cut behavior control.

LANGUAGE: JSON

CODE:
```json
// manifest.json - enable drag and drop callbacks
{
  "tableSettings": {
    "type": "TreeTable",
    "hierarchyQualifier": "NodesHierarchy",
    "personalization": true,
    "creationMode": { /* ... */ },
    "isMoveToPositionAllowed": ".extension.hierarchy-edit.custom.OPExtend.moveToPositionAllowed",
    "isNodeMovable": ".extension.hierarchy-edit.custom.OPExtend.nodeMovable"
  }
}
```

STEP: Implement drag & drop callbacks (ControllerExtension)

DESCRIPTION: Implement moveToPositionAllowed(sourceContext, parentContext) to allow/forbid drops and nodeMovable(sourceContext) to allow/forbid drag or cut. parentContext is null when dropping as root.

LANGUAGE: JavaScript

CODE:
```javascript
// webapp/extension/hierarchy-edit.custom.OPExtend.js
sap.ui.define(["sap/ui/core/mvc/ControllerExtension"], function (ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("hierarchy-edit.custom.OPExtend", {
    // Callback for Drop and Paste actions
    // sourceContext: binding context of dragged/cut node
    // parentContext: binding context of target parent, null when dropping as root
    moveToPositionAllowed: function (sourceContext, parentContext) {
      switch (parentContext?.getProperty("nodeType")) {
        case "Zone":
          return sourceContext?.getProperty("nodeType") === "Intermediary"; // Only 'Intermediary' under 'Zone'
        case "Intermediary":
          return sourceContext?.getProperty("nodeType") === "Line"
            && sourceContext?.getProperty("name") !== 'Dublin'; // Only 'Line' under 'Intermediary' and 'Dublin' cannot be moved
        case "Line":
          return false; // Nothing under 'Line'
        default:
          return false;
      }
    },

    // Callback for Drag and Cut actions
    // sourceContext: binding context of node to be moved/cut
    nodeMovable: function (sourceContext) {
      return sourceContext?.getProperty("name") !== 'USA'; // 'USA' node cannot be moved or cut
    }
  });
});
```

STEP: Move Up / Move Down notes and restrictions

DESCRIPTION: Summary of when Move Up/Down is supported and when it is disabled.

LANGUAGE: text

CODE:
```text
- Move Up/Down supported when ChangeNextSiblingAction term is defined in RecursiveHierarchyActions.
- Not supported for root entities in RAP when ChangeNextSiblingAction is not set.
- Restrictions disabling move up/down:
  - Node created without createInPlace (displayed "out of place") => move operations disabled.
  - If previous sibling is "out of place", moving up is disabled.
  - If a sort is applied to the table, move up/down is disabled.
  - If isNodeMovable or isMoveToPositionAllowed returns false for that node/position.
```

STEP: Enable Cut & Paste (same extension points as drag & drop)

DESCRIPTION: Use isNodeMovable (cut) and isMoveToPositionAllowed (paste) to control cut/paste operations. Backend determines final position on paste.

LANGUAGE: text

CODE:
```text
- Cut action: controlled by isNodeMovable(sourceContext).
- Paste action: controlled by isMoveToPositionAllowed(sourceContext, parentContext).
- Position of pasted node under its parent is defined by backend logic; ensure backend handles ordering.
```

STEP: Enable Copy & Paste extension points (manifest.json)

DESCRIPTION: From SAPUI5 1.136, enable copy/paste via isNodeCopyable and isCopyToPositionAllowed extension callbacks.

LANGUAGE: JSON

CODE:
```json
// manifest.json - enable copy/paste callbacks
{
  "tableSettings": {
    "type": "TreeTable",
    "hierarchyQualifier": "NodesHierarchy",
    "personalization": true,
    "creationMode": { /* ... */ },
    "isNodeCopyable": ".extension.hierarchy-edit.custom.OPExtend.enableCopy",
    "isCopyToPositionAllowed": ".extension.hierarchy-edit.custom.OPExtend.enablePasteFromCopy"
  }
}
```

STEP: Context Menu behavior

DESCRIPTION: Right-click on a node opens context menu containing bound actions only. Multi-selection excludes tree-specific actions (cut/paste/expand/collapse entire node).

LANGUAGE: text

CODE:
```text
- Context menu opens on right-click for a single node; other nodes are greyed out.
- Only bound actions are displayed in the menu.
- Tree-specific actions (cut, paste, expand entire node, collapse entire node) are NOT supported with multi-selection.
```

STEP: Disable hierarchy change operations via annotations (CDS/OData annotations sample)

DESCRIPTION: Use Capabilities.UpdateRestrictions and NonUpdatableNavigationProperties on the navigation property to the parent to disable drag/drop and cut/paste programmatically from the service side. Example shows an annotated entity and capability annotation.

LANGUAGE: CDS / Annotation (as provided)

CODE:
```cds
// CDS-like model + annotation example (service metadata / model)
@odata.draft.enabled
entity TreeTableSubEntityWithUpdateRestriction {
  @Core.Immutable: true
  @Common.Label  : 'ID'
  key ID               : String;
  parent               : String;

  @Common.Label  : 'Org level name'
  name                 : String;

  @UI.Hidden     : true
  orgID                : String;

  @Core.Computed : true
  @UI.Hidden     : true
  DistanceFromRoot     : Integer64;

  Superordinate        : Association to TreeTableSubEntityWithUpdateRestriction
                           on Superordinate.ID = parent;
  Organization         : Association to TreeTableEntity
                           on Organization.ID = orgID;
}

// Annotate to disable updates on navigation property Superordinate
annotate TreeTableSubEntityWithUpdateRestriction with @(Capabilities: {UpdateRestrictions: {NonUpdatableNavigationProperties: [Superordinate]}});
```

STEP: Prevent reordering of root nodes via RecursiveHierarchyActions annotation (XML)

DESCRIPTION: Set ChangeSiblingForRootsSupported Bool="false" in the RecursiveHierarchyActions annotation to prevent move-up/down and dropping between root nodes. If not defined, it defaults to true.

LANGUAGE: XML

CODE:
```xml
<!-- RecursiveHierarchyActions annotation example with ChangeSiblingForRootsSupported -->
<edmx:Reference Uri="/sap/opu/odata/IWFND/CATALOGSERVICE;v=2/Vocabularies(TechnicalName='%2FIWBEP%2FVOC_HIERARCHY',Version='0001',SAP__Origin='LOCAL')/$value">
  <edmx:Include Namespace="com.sap.vocabularies.Hierarchy.v1" Alias="SAP__hierarchy"/>
</edmx:Reference>

<Annotations Target="SAP__self.HierarchyEntityType">
  <Annotation Term="SAP__hierarchy.RecursiveHierarchyActions" Qualifier="HierarchyNode">
    <Record>
      <PropertyValue Property="ChangeNextSiblingAction" String="SAP__self.changeNextSibling"/>
      <PropertyValue Property="CopyAction" String="SAP__self.copy"/>
      <PropertyValue Property="ChangeSiblingForRootsSupported" Bool="false"/>
    </Record>
  </Annotation>
</Annotations>
```

STEP: TreeTable building block references

DESCRIPTION: Links and references for the TreeTable macro and live examples for developers.

LANGUAGE: text

CODE:
```text
- API reference: https://ui5.sap.com/#/api/sap.fe.macros.TreeTable
- Live example (Flexible Programming Model Explorer): https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/treeTable
```

--------------------------------

**TITLE**: Types of Cards (SAP Fiori elements OVP / manifest.json examples)

**INTRODUCTION**: Quick reference and actionable manifest.json examples for configuring transactional and analytical cards (table, list, analytical chart, link list) in SAP Fiori elements overview pages. Includes how to enable automatic refresh and notes about V2-only card types (stack, quick view).

**TAGS**: fiori-elements-framework, sap.ovp, manifest.json, overview-page, cards, OData V2, OData V4, analytical-chart, LineItem, refresh

STEP: Card types and annotation mapping (overview)
DESCRIPTION: Map common card types to their main annotation or component reference so you can pick the correct manifest configuration.
LANGUAGE: text
CODE:
```text
- Table card
  - Data source: use the LineItem annotation term
    com.sap.vocabularies.UI.v1.LineItem
  - Typical template key: "sap.ovp.cards.table"

- List card
  - Data source: use the LineItem annotation term
    com.sap.vocabularies.UI.v1.LineItem
  - Typical template key: "sap.ovp.cards.list"

- Analytical chart card
  - Template component: sap.ovp.cards.charts.analytical
  - Chart annotations typically referenced by annotationPath (UI/Analytics chart annotations)

- Link list card
  - Displays link items with image/icon and optional subtitle
  - Configured in manifest under cards; uses a list style with link items
```

STEP: Add card entries to the descriptor (manifest.json) — global config + refresh example
DESCRIPTION: Place the sap.ovp configuration in your app descriptor (manifest.json). The global refresh interval is defined under "sap.ovp". The minimum/default refresh time is 1 minute. Example shows a global refresh interval of 12 minutes and the cards container.
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "id": "com.example.ovpapp",
    "applicationVersion": { "version": "1.0.0" }
  },
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters",
    "refreshIntervalInMinutes": 12,
    "disableTableCardFlexibility": false,
    "cards": {
      /* Add card definitions here (see next steps) */
    }
  }
}
```

STEP: Example — Table card configuration (using LineItem annotation)
DESCRIPTION: Configure a table card that reads UI LineItem annotations. Replace entitySet and annotationPath with your service entity and annotation path.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "SalesOrdersTable": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.table",
        "title": "Sales Orders",
        "entitySet": "SalesOrderSet",
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem",
        "settings": {
          "navigation": {
            "route": "SalesOrderDetail"
          }
        }
      }
    }
  }
}
```

STEP: Example — List card configuration (using LineItem annotation)
DESCRIPTION: Configure a list card that reads UI LineItem annotations. Limit displayed fields if required in annotations.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "TopCustomersList": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.list",
        "title": "Top Customers",
        "entitySet": "CustomerSet",
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem",
        "settings": {
          "maxItems": 6
        }
      }
    }
  }
}
```

STEP: Example — Analytical chart card configuration
DESCRIPTION: Configure an analytical chart card by setting the template to sap.ovp.cards.charts.analytical and referencing the appropriate chart annotation path. Replace entitySet and annotationPath with your analytics entity and annotation.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "SalesByRegionChart": {
        "model": "analyticsModel",
        "template": "sap.ovp.cards.charts.analytical",
        "title": "Sales by Region",
        "entitySet": "SalesAnalyticsSet",
        "annotationPath": "com.sap.vocabularies.UI.v1.Chart",
        "settings": {
          "chartType": "column" /* optional override; primary config comes from annotations */
        }
      }
    }
  }
}
```

STEP: Example — Link list card configuration
DESCRIPTION: Configure a link-list style card that displays links with optional icon/subtitle. Use LineItem-based annotations or a custom annotation mapping that produces link items.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "RelevantLinks": {
        "model": "linkModel",
        "template": "sap.ovp.cards.list",
        "title": "Relevant Links",
        "entitySet": "LinkSet",
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem",
        "settings": {
          "isLinkList": true,
          "maxItems": 10
        }
      }
    }
  }
}
```

STEP: Enable/adjust automatic refresh interval
DESCRIPTION: The manifest sap.ovp property refreshIntervalInMinutes controls auto refresh. The minimum and default value is 1 minute. Set to desired integer minutes.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "refreshIntervalInMinutes": 5,
    "cards": {
      "ExampleCard": {
        "template": "sap.ovp.cards.table",
        "entitySet": "ExampleSet",
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem"
      }
    }
  }
}
```

STEP: Additional features — V2-only cards (Stack and Quick View)
DESCRIPTION: Stack and Quick View cards are available only in SAP Fiori elements for OData V2. Use them only when your application uses OData V2 runtime. Configure them similarly under sap.ovp.cards but ensure your platform/runtime supports these V2-only templates and annotations.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "MyStackCard": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.stack", /* V2 only; verify runtime */
        "title": "Stack Card (V2 only)",
        "entitySet": "SalesOrderSet",
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem"
      },
      "QuickViewCard": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.quickview", /* V2 only; verify runtime */
        "title": "Quick View (V2 only)",
        "entitySet": "SalesOrderSet",
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem"
      }
    }
  }
}
```


--------------------------------

**TITLE**: Configure UI Controls in Object Page Header (Fiori Elements) via Annotations

**INTRODUCTION**: This document shows how to configure object page header UI controls (title, description, image/avatar, and identification fields) using annotation files. Include these annotations in your service metadata so Fiori Elements renders the header content automatically. Examples are provided in OData CSDL XML and JSON Annotation formats (commonly used for OData V4 / Fiori Elements).

**TAGS**: fiori-elements, annotations, object-page, header, UI.HeaderInfo, identification, image, annotations.xml, annotations.json

**STEP**: 1 — Define header content (title, description, image) using OData CSDL XML annotations

**DESCRIPTION**: Create or edit an annotation file (XML) and attach it in your service metadata. Use the com.sap.vocabularies.UI.v1.HeaderInfo annotation to provide title, description and image. Place the file under your app annotations folder (example path shown).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: app/annotations/Product.annotations.xml -->
<?xml version="1.0" encoding="UTF-8"?>
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="http://docs.oasis-open.org/odata/odata/v4.0/odata-vocabularies.xml">
    <edmx:Include Namespace="Org.OData.Core.V1" Alias="Core"/>
    <edmx:Include Namespace="com.sap.vocabularies.UI.v1" Alias="UI"/>
  </edmx:Reference>

  <edmx:DataServices>
    <Schema Namespace="MyService.Annotations" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <!-- Target the entity type in the metadata: ServiceNamespace.EntityType -->
      <Annotations Target="MyService.Product">
        <Annotation Term="UI.HeaderInfo">
          <Record>
            <!-- TypeName/Plural optional friendly names -->
            <PropertyValue Property="TypeName" String="Product"/>
            <PropertyValue Property="TypeNamePlural" String="Products"/>

            <!-- Title and Description: use Path to reference entity properties -->
            <PropertyValue Property="Title">
              <Record>
                <PropertyValue Property="Value" Path="Name"/>
              </Record>
            </PropertyValue>

            <PropertyValue Property="Description">
              <Record>
                <PropertyValue Property="Value" Path="ShortDescription"/>
              </Record>
            </PropertyValue>

            <!-- ImageUrl: a property on the entity that contains a URL to the image -->
            <PropertyValue Property="ImageUrl">
              <String>ImageUrl</String>
            </PropertyValue>
          </Record>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 2 — Define header content (title, description, image) using OData JSON annotations

**DESCRIPTION**: Alternative to XML: use JSON annotation file. This is useful if your toolchain expects JSON-based annotation files. Ensure the JSON file is loaded into the service metadata.

**LANGUAGE**: JSON

**CODE**:
```json
// File: app/annotations/annotations.json
{
  "@context": {
    "UI": "com.sap.vocabularies.UI.v1",
    "Core": "Org.OData.Core.V1"
  },
  "MyService.Product": {
    "UI.HeaderInfo": {
      "TypeName": "Product",
      "TypeNamePlural": "Products",
      "Title": {
        "Value": { "Path": "Name" }
      },
      "Description": {
        "Value": { "Path": "ShortDescription" }
      },
      "ImageUrl": { "Path": "ImageUrl" }
    }
  }
}
```

**STEP**: 3 — Add identification fields shown below the header (XML)

**DESCRIPTION**: Use com.sap.vocabularies.UI.v1.Identification to list key information shown directly below the header title. Add multiple PropertyValue Records for each identification field. This example adds Category and CreatedAt.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: app/annotations/Product.identification.xml -->
<?xml version="1.0" encoding="UTF-8"?>
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="http://docs.oasis-open.org/odata/odata/v4.0/odata-vocabularies.xml">
    <edmx:Include Namespace="com.sap.vocabularies.UI.v1" Alias="UI"/>
  </edmx:Reference>

  <edmx:DataServices>
    <Schema Namespace="MyService.Annotations" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <Annotations Target="MyService.Product">
        <Annotation Term="UI.Identification">
          <Collection>
            <Record>
              <PropertyValue Property="Label" String="Category"/>
              <PropertyValue Property="Value">
                <Record>
                  <PropertyValue Property="Value" Path="Category"/>
                </Record>
              </PropertyValue>
            </Record>
            <Record>
              <PropertyValue Property="Label" String="Created At"/>
              <PropertyValue Property="Value">
                <Record>
                  <PropertyValue Property="Value" Path="CreatedAt"/>
                </Record>
              </PropertyValue>
            </Record>
          </Collection>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 4 — Add identification fields (JSON)

**DESCRIPTION**: Same identification configuration using JSON annotations.

**LANGUAGE**: JSON

**CODE**:
```json
// File: app/annotations/identification.json
{
  "@context": {
    "UI": "com.sap.vocabularies.UI.v1"
  },
  "MyService.Product": {
    "UI.Identification": [
      {
        "Label": "Category",
        "Value": { "Value": { "Path": "Category" } }
      },
      {
        "Label": "Created At",
        "Value": { "Value": { "Path": "CreatedAt" } }
      }
    ]
  }
}
```

**STEP**: 5 — Example metadata properties used by the annotations (entity schema reference)

**DESCRIPTION**: Example entity properties referenced by the annotation files. Ensure these properties exist in your OData service entity type.

**LANGUAGE**: EDMX (entity type snippet for reference)

**CODE**:
```xml
<!-- File: srv/ServiceMetadata.entityType.snippet.xml (for reference) -->
<EntityType Name="Product">
  <Key>
    <PropertyRef Name="ID"/>
  </Key>
  <Property Name="ID" Type="Edm.String"/>
  <Property Name="Name" Type="Edm.String"/>
  <Property Name="ShortDescription" Type="Edm.String"/>
  <Property Name="Category" Type="Edm.String"/>
  <Property Name="ImageUrl" Type="Edm.String"/>
  <Property Name="CreatedAt" Type="Edm.DateTimeOffset"/>
</EntityType>
```

Notes:
- Place your annotation files where your deployment or gateway loads annotation files (common paths: app/annotations/ or annotations/). Register/include them in your service so the Fiori Elements runtime sees them.
- Use Title/Description/Identification/ImageUrl to control the object page header content. Additional header controls (actions) are typically added via action annotations (DataFieldForAction/DataFieldForIntentBasedNavigation) in LineItem or custom UI extension points — implement those in separate annotation blocks when needed.
--------------------------------

**TITLE**: Action Control for Context-Dependent Actions in SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: Configure context-dependent actions so they are only enabled or visible for specific entity instances. For OData V2 use sap:action-for and sap:applicable-path on FunctionImports/Actions. For OData V4 use the OperationAvailable annotation. This guide provides actionable examples and behavior rules to implement in annotation/CSDL files.

**TAGS**: fiori-elements-framework, odata-v2, odata-v4, annotations, sap:action-for, sap:applicable-path, OperationAvailable, FunctionImport, Action

**STEP**: 1 — OData V2: Make a Function Import context-dependent using sap:action-for and sap:applicable-path

**DESCRIPTION**: Add sap:action-for and sap:applicable-path attributes to the FunctionImport (or Action) definition in your service metadata (CSDL) so Fiori elements evaluates a Boolean property on the entity type to decide action visibility/enabled state. The applicable-path must point to a Boolean property of the entity type. Behavior rules:
- If applicable-path evaluates to false:
  - Actions on page header level or line-item buttons in a table are hidden.
  - Actions defined as header buttons in a table are disabled (not hidden).
- Do not use UI.Hidden on DataFieldForAction in page header; UI.Hidden takes precedence and may break the recommended UX.
- If an action has dynamic parameters and for the selected instance no parameter is required, the parameter dialog is skipped (applies only to single-context select actions).

Place this snippet into your service metadata (CSDL) where FunctionImports are defined.

**LANGUAGE**: XML

**CODE**:
```xml
<FunctionImport Name="SEPMRA_C_PD_ProductCopy"
                ReturnType="SEPMRA_PROD_MAN.SEPMRA_C_PD_ProductType"
                EntitySet="SEPMRA_C_PD_Product"
                m:HttpMethod="POST"
                sap:action-for="SEPMRA_PROD_MAN.SEPMRA_C_PD_ProductType"
                sap:applicable-path="IsActiveEntity">
    <Parameter Name="ProductDraftUUID" Type="Edm.Guid" Mode="In"/>
    <Parameter Name="ActiveProduct" Type="Edm.String" Mode="In" MaxLength="10"/>
</FunctionImport>
```

**STEP**: 2 — OData V2: Notes and UX considerations (short checklist)

**DESCRIPTION**: Checklist to follow after adding sap:action-for / sap:applicable-path:
- Ensure the property referenced by sap:applicable-path is a Boolean on the target entity type.
- Verify placement: actions in page header vs table header vs line item behave differently (hidden vs disabled).
- Avoid UI.Hidden on DataFieldForAction in page header to preserve action control behavior.
- For actions with dynamic parameters: confirm single-context actions display parameter dialog only when parameters are required.

**LANGUAGE**: text

**CODE**:
```text
- sap:applicable-path -> points to Boolean property on entity type (e.g., IsActiveEntity)
- Page header & line-item buttons -> action hidden when applicable-path == false
- Table header buttons -> action disabled when applicable-path == false
- Do NOT use UI.Hidden for DataFieldForAction in page header (UI.Hidden takes precedence)
- Dynamic parameters: parameter dialog is skipped if no parameters required for selected instance (single-context actions)
```

**STEP**: 3 — OData V4: Enable/disable actions using OperationAvailable

**DESCRIPTION**: For OData V4, add an OperationAvailable annotation for the Action (or ActionImport) to enable/disable actions based on a Boolean property. Fiori elements evaluates the provided path expression against the selected instance(s). If multi-select is enabled, the action is allowed when at least one selected entry fulfills the condition. See the Actions documentation for additional patterns: actions-cbf16c5.md#loiocbf16c599f2d4b8796e3702f7d4aae6c__subsection_xkx_gwq_nsb

Example below shows a CSDL-style Annotations block pointing OperationAvailable to a Boolean path IsActionAvailable on the entity.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: annotate an Action Import or Action with OperationAvailable -->
<Annotations Target="YourService.YourEntity/YourAction">
  <!-- OperationAvailable term points to a Boolean property on the entity type -->
  <Annotation Term="com.sap.vocabularies.Common.v1.OperationAvailable">
    <Path>IsActionAvailable</Path>
  </Annotation>
</Annotations>

<!-- OR: annotate an ActionImport target -->
<Annotations Target="YourService.YourActionImport">
  <Annotation Term="com.sap.vocabularies.Common.v1.OperationAvailable">
    <Path>IsActionAvailable</Path>
  </Annotation>
</Annotations>
```

**STEP**: 4 — OData V4: Notes and multi-select behavior

**DESCRIPTION**: Implementation checks for OData V4:
- Ensure OperationAvailable references a Boolean property or expression resolvable for the selected context.
- Multi-select: if at least one selected row evaluates OperationAvailable == true, the action is enabled for the multi-selection.
- Refer to the Actions documentation for examples and advanced patterns: actions-cbf16c5.md

**LANGUAGE**: text

**CODE**:
```text
- OperationAvailable -> reference a Boolean property/expression on the entity
- Multi-select tables: action enabled when >=1 selected entries satisfy OperationAvailable
- For complex conditions, use expression paths supported by your annotation format and evaluation engine
- See: actions-cbf16c5.md#loiocbf16c599f2d4b8796e3702f7d4aae6c__subsection_xkx_gwq_nsb
```
--------------------------------

**TITLE**: Using Analytical Parameters from the Back End (SAP Fiori elements, OData V2)

**INTRODUCTION**: How to enable and use analytical parameters defined in the back end so the Fiori elements framework passes them as parameters (not $filter) to OData V2 services. Shows the runtime URL pattern and the manifest.json setting required to expose these parameters as mandatory filter controls in the List Report / Object Page.

**TAGS**: fiori-elements-framework, OData V2, analytical-parameters, manifest.json, filter-bar, parameters

**STEP**: Backend parameter usage example

**DESCRIPTION**: Analytical parameters are passed to the back end as key/value pairs (not as $filter). Use this URL pattern to call a parameterized entity or function import. This example shows the parameter P_DisplayCurrency being passed with value 'EUR'. Replace <path> with your service/host path and entity name as appropriate.

**LANGUAGE**: HTTP

**CODE**:
```http
GET http://<path>/Customer(P_DisplayCurrency='EUR')/Set?$count=true
```

**STEP**: Enable analytical parameters in the app manifest

**DESCRIPTION**: Set "considerAnalyticalParameters": true in the application's manifest.json under "sap.ui.generic.app" -> "settings". This instructs the Fiori elements framework to automatically expose analytical parameters as filter fields in the List Report and mark them mandatory. Add any other settings (e.g., forceGlobalRefresh, inboundParameters) in the same settings object. Place this snippet in your app root manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "considerAnalyticalParameters": true,
      "forceGlobalRefresh": true,
      "inboundParameters": {
        "Supplier": {
          "useForCreate": true
        }
      },
      "objectPageDynamicHeaderTitleWithVM": true
    }
  }
}
```

**STEP**: Expected UI and runtime behavior

**DESCRIPTION**: After enabling considerAnalyticalParameters:
- The framework adds filter controls for back-end analytical parameters on the List Report.
- Those filters become mandatory (the framework enforces a value before fetching data).
- When the user enters a value, the UI request includes the parameter as shown in the HTTP example (key/value pair), and the back end uses it (for example, to normalize currencies or UoM) before aggregation or response generation.

**LANGUAGE**: text

**CODE**:
```
Behavior summary:
- Filter control is auto-created and mandatory.
- Parameter is not sent in $filter; it is sent as a parameter on the entity/function call.
- Example runtime call: http://<path>/Customer(P_DisplayCurrency='EUR')/Set?$count=true
```

**STEP**: Reference for OData V4 parameterized entities

**DESCRIPTION**: For Fiori elements with OData V4 and additional details on supporting parameterized entities and filter bar configuration, consult the "Supporting Parameterized Entities" section in Configuring Filter Bars.

**LANGUAGE**: text

**CODE**:
```
See: configuring-filter-bars-4bd7590.md#loio4bd7590569c74c61a0124c6e370030f6__suppprting_parameterized_entities_subsection
```
--------------------------------

**TITLE**: Using onBefore Extension Methods in SAP Fiori elements (OData V4)

**INTRODUCTION**: Short, copy-paste examples that show how to register and implement the onBefore* extension methods (onBeforeCreate, onBeforeEdit, onBeforeSave, onBeforeDiscard, onBeforeDelete) in SAP Fiori elements for OData V4. Demonstrates use of extensionAPI.securedExecution and setting updatesDocument when custom code changes document state (so Fiori elements can show the confirmation popover).

**TAGS**: fiori-elements-framework, odata-v4, controller-extension, onBeforeSave, onBeforeCreate, securedExecution, updatesDocument, object-page, list-report

**STEP**: 1 — Register a controller extension in your manifest.json

**DESCRIPTION**: Add a controller extension mapping to attach your custom controller extension implementation to the Fiori elements framework controller (ObjectPage controller shown here). Replace the framework controller key when extending a different template (e.g., ListReport controller key).

**LANGUAGE**: JSON

**CODE**:
```json
// File: manifest.json (snippet)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ObjectPage.controller.ObjectPageController": "my.app.extension.ObjectPageExt"
        }
      }
    }
  }
}
```

**STEP**: 2 — Implement onBefore* methods in a controller extension file

**DESCRIPTION**: Create the extension file that implements onBeforeCreate, onBeforeEdit, onBeforeSave, onBeforeDiscard, and onBeforeDelete. Use this.extensionAPI.securedExecution(...) to (a) show messages in a supported context and (b) wrap custom code that changes the draft/document state. When changes are made to the document inside securedExecution, pass { updatesDocument: true } so Fiori elements displays the confirmation popover when the user attempts to cancel/navigate away.

The example below:
- Shows validation before save and prevents the save by throwing an error after showing a MessageBox.
- Demonstrates reading selected contexts in onBeforeDelete (table/list reports pass selected contexts).
- Uses MessageBox / MessageToast for user feedback (imported from sap.m).
- Uses async functions to allow awaiting asynchronous checks or calls.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/extension/ObjectPageExt.controller.js
sap.ui.define([
  "sap/m/MessageBox",
  "sap/m/MessageToast"
], function (MessageBox, MessageToast) {
  "use strict";

  return {
    /**
     * Triggered before the standard create method.
     * Use securedExecution for any UI messages or model changes.
     */
    onBeforeCreate: function (oEvent) {
      return this.extensionAPI.securedExecution(async () => {
        // Custom initialization before create
        MessageToast.show("Preparing a new object...");
        // If you need to change document/draft state, set updatesDocument: true in the securedExecution options
      }, { updatesDocument: false });
    },

    /**
     * Triggered before the standard edit flow.
     */
    onBeforeEdit: function (oEvent) {
      return this.extensionAPI.securedExecution(async () => {
        // Example: check a permission or condition
        const bCanEdit = true; // replace with real check
        if (!bCanEdit) {
          MessageBox.error("You are not allowed to edit this object.");
          // Throw to abort the standard edit flow if needed
          throw new Error("Edit prevented by extension.");
        }
      }, { updatesDocument: false });
    },

    /**
     * Triggered before the standard save operation.
     * If you modify draft data here, set updatesDocument: true.
     */
    onBeforeSave: function (oEvent) {
      return this.extensionAPI.securedExecution(async () => {
        const oView = this.getView();
        // Example validation: ensure a field has a value before save
        const oInput = oView.byId("MyField"); // replace with your control id
        const sValue = oInput ? oInput.getValue() : undefined;
        if (!sValue) {
          MessageBox.error("MyField is required before saving.");
          // Throwing an error prevents the standard save (acts as abort)
          throw new Error("Validation failed - save aborted.");
        }

        // Example: set or adjust a draft property before save
        const oModel = oView.getModel();
        // oModel.setProperty("/SomeDraftPath/Calculated", "X");
        // Because we updated the document/draft, we used updatesDocument: true below
      }, { updatesDocument: true });
    },

    /**
     * Triggered before the standard draft discard is invoked.
     */
    onBeforeDiscard: function (oEvent) {
      return this.extensionAPI.securedExecution(async () => {
        MessageToast.show("Draft will be discarded.");
        // Add cleanup logic if necessary
      }, { updatesDocument: false });
    },

    /**
     * Triggered before the standard delete method.
     * For an object page it's called for the current object; for tables it is called for each selected context / row.
     */
    onBeforeDelete: function (oEvent) {
      // Many templates pass the selected contexts in the event parameter named "contexts".
      // For object page the event might provide a single context or none depending on usage.
      const aContexts = (oEvent && oEvent.getParameter) ? oEvent.getParameter("contexts") : (oEvent && oEvent.contexts);

      return this.extensionAPI.securedExecution(async () => {
        if (Array.isArray(aContexts) && aContexts.length > 0) {
          // Example: iterate selected contexts and log keys
          aContexts.forEach(function (oBindingContext) {
            const sPath = oBindingContext.getPath(); // path to the entry
            console.log("Preparing to delete entry at path:", sPath);
            // Add additional pre-delete logic here (checks, logging, etc.)
          });
        } else {
          // Object page single-delete scenario: can inspect current context
          const oCurrentContext = this.getView().getBindingContext();
          if (oCurrentContext) {
            console.log("Preparing to delete object at path:", oCurrentContext.getPath());
          }
        }
        // If you want to block the delete, you can show an error and throw:
        // MessageBox.error("Delete blocked by extension.");
        // throw new Error("Delete prevented by extension.");
      }, { updatesDocument: false });
    }
  };
});
```

**STEP**: 3 — Guidance and best practices

**DESCRIPTION**: Key points to follow when implementing onBefore* methods:
- These extension points are available only for SAP Fiori elements with OData V4.
- Use this.extensionAPI.securedExecution(...) when:
  - You display messages from custom code (ensures message handling integration).
  - You change draft/document state inside your extension. Pass { updatesDocument: true } to allow Fiori elements to show the discard confirmation popover.
- If you need to prevent the standard operation (for validation or permission reasons), show an error (MessageBox) and throw an Error inside the securedExecution to abort the standard flow.
- onBeforeDelete may receive a "contexts" parameter (array) for table row deletions. For object page delete, inspect the current binding context if needed.

**LANGUAGE**: Plain text (guidance; no code)

**CODE**:
```text
- Only applicable for SAP Fiori elements OData V4.
- Use extensionAPI.securedExecution for messages and state changes.
- Set { updatesDocument: true } when changes within the extension update the draft/document.
- Throw an Error inside securedExecution to abort the standard operation after showing a message.
```
--------------------------------

**TITLE**: Implementing Global Side Effects in SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: Enable and configure global side effects to refresh specific target properties or invoke an action when users press Enter on input fields in draft-enabled SAP Fiori Elements apps. Covers OData V2 XML annotations, manifest.json forceGlobalRefresh configuration, and OData V4 CAP CDS annotations. Includes runtime and design-time defaults and best-practice guidance.

**TAGS**: fiori-elements-framework, global-side-effects, side-effects, draft, odata-v2, odata-v4, manifest, sapui5

**STEP**: Prerequisites and behavior summary
**DESCRIPTION**: Ensure the app uses draft handling. Global side effects are only applicable to draft-enabled applications. When pressing Enter on an input field, the global side effect defined for the corresponding entity is triggered. For OData V2, if a TriggerAction is annotated as part of a global side effect, it replaces the PreparationAction call on Enter.
**LANGUAGE**: Text
**CODE**:
```text
- Requirement: App must be draft-enabled (draft handling enabled).
- Behavior: Pressing Enter triggers the global side effect defined on the entity.
- OData V2: TriggerAction (if annotated) replaces PreparationAction on Enter.
- Recommendation: Make the annotation as specific as possible (target properties / target entities).
```

**STEP**: Add global side effect annotation (OData V2 XML)
**DESCRIPTION**: Add an annotation for the target entity in your OData V2 annotation file (e.g., annotations.xml). Use com.sap.vocabularies.Common.v1.SideEffects with a Qualifier (example: GlobalSideEffect). Define TargetProperties (collection of property names) and TriggerAction (fully qualified action name). This refreshes only the annotated targets (unless forceGlobalRefresh = true).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Example: annotations.xml -->
<Annotations Target="NAMESPACE.ENTITYTYPE">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="GlobalSideEffect">
        <Record>
            <PropertyValue Property="TargetProperties">
                <Collection>
                    <String>TaxAmount</String>
                    <String>NetAmount</String>
                    <String>GrossAmount</String>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TriggerAction" String="NAMESPACE.MyAction"/>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: Configure global refresh behavior in manifest.json (UI5 / Fiori app)
**DESCRIPTION**: To force the entire model/entity to refresh when Enter is pressed, set forceGlobalRefresh to true under sap.ui.generic.app -> settings in the app's manifest.json. If false (recommended and default), only annotated targets are refreshed and/or the annotated TriggerAction is invoked. Runtime default (if not set) is false as of SAPUI5 1.106. Newly generated apps set design-time default to false.
**LANGUAGE**: JSON
**CODE**:
```json
// File: manifest.json (root of the UI5 app)
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "forceGlobalRefresh": true
      // ... other settings ...
    }
  }
}
```
Notes:
- forceGlobalRefresh = true -> refresh entire model/entity on Enter.
- forceGlobalRefresh = false -> refresh only annotated targets and/or call TriggerAction.
- If unset -> runtime default is false (SAPUI5 >= 1.106).
- Design-time (project generator) default for new apps: "forceGlobalRefresh": false.

**STEP**: Add global side effect annotation (OData V4 / CAP CDS)
**DESCRIPTION**: For OData V4 and CAP projects, annotate the entity in your CDS file to declare a global side effect. Use Common.SideEffects with a qualifier (example: #GlobalSideEffect). Define TargetProperties (array of fields) and TriggerAction (action name string). This triggers the specified action and refreshes the listed properties on Enter.
**LANGUAGE**: CDS
**CODE**:
```sql
// Example: in a CAP CDS file (e.g., schema.cds)
annotate NAMESPACE.ENTITYTYPE @( 
  Common.SideEffects #GlobalSideEffect : {
    TargetProperties : [
      TaxAmount,
      NetAmount,
      GrossAmount
    ],
    TriggerAction : 'NAMESPACE.MyAction'
  }
);
```

**STEP**: Best practices and performance guidance
**DESCRIPTION**: Make side effect annotations as specific as possible (list exact target properties or target entities). Only use forceGlobalRefresh=true for exceptional cases where a full entity model refresh is required. Prefer targeted refreshes to optimize performance.
**LANGUAGE**: Text
**CODE**:
```text
- Prefer TargetProperties / TargetEntities over global refresh.
- Use forceGlobalRefresh = true only when necessary (performance impact).
- Verify draft handling configuration before relying on global side effects.
```

**STEP**: Reference: Draft Handling documentation
**DESCRIPTION**: See the draft handling documentation for details on how PreparationAction and TriggerAction interplay and overall draft lifecycle behavior.
**LANGUAGE**: URL
**CODE**:
```text
Draft Handling: draft-handling-ed9aa41.md
```
--------------------------------

**TITLE**: Using Images, Initials, and Icons in SAP Fiori elements Object Page Headers

**INTRODUCTION**: Provide actionable examples and guidance to display images, initials, or icons in an object page header (avatar). Includes annotation-based configuration (OData annotations) and UI5 extension fragments (sap.m.Avatar). Covers selection/fallback logic and how to change avatar shape for OData V2 via the Page Editor.

**TAGS**: fiori-elements, ui5, avatar, object-page, header, annotations, OData, sap.m.Avatar

**STEP**: 1 - Display selection and fallback logic

**DESCRIPTION**: The object page header avatar uses a deterministic selection order to pick a visual representation. Implementations should prefer setting a header ImageUrl (when available) and fall back to initials or an icon. Placeholder behavior depends on avatar shape.

- Selection order (highest to lowest priority):
  1. image source (ImageUrl / src)
  2. initials (initials string)
  3. explicit icon (sap-icon://...)
  4. placeholder icon (shape-dependent)
- Placeholder icon by shape:
  - Circular avatar -> person icon
  - Square avatar -> product icon
- File referenced in docs: images/Avatar_e9e8ed2.jpg

**LANGUAGE**: text

**CODE**:
```text
Selection order:
1) Image source (ImageUrl / src)
2) Initials
3) Icon (sap-icon://...)
4) Shape-dependent placeholder:
   - Circle => person icon
   - Square => product icon

Reference image: images/Avatar_e9e8ed2.jpg
```

**STEP**: 2 - Configure header image via OData annotations (XML annotations file)

**DESCRIPTION**: Use the standard OData UI vocabulary to populate the object page header. Set com.sap.vocabularies.UI.v1.HeaderInfo with Title and ImageUrl paths. This is the standard way for Fiori elements to pick an image for the header.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: annotations.xml (OData service annotations) -->
<Annotations Target="YourServiceNamespace.YourEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo">
    <Record>
      <!-- Title used in the header -->
      <PropertyValue Property="Title" Path="Name"/>
      <!-- ImageUrl path used by Fiori elements as first priority for avatar -->
      <PropertyValue Property="ImageUrl" Path="PictureUrl"/>
      <!-- Optional: TypeName, TypeNamePlural, etc. -->
      <PropertyValue Property="TypeName" String="Product"/>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 3 - Optional: Bind avatar in a UI5 extension (XML fragment) for custom header behavior

**DESCRIPTION**: If you need to customize the header beyond standard annotations, add an XML fragment using sap.m.Avatar inside an extension point. Bind src, initials, and icon to your model properties. Control displayShape to influence placeholder icon.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: fragments/CustomHeaderAvatar.fragment.xml -->
<!-- Use this fragment in a Fiori elements extension (e.g., ObjectPage headerContent) -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
  <Avatar
    id="objectHeaderAvatar"
    src="{path: 'entityModel>PictureUrl'}"
    initials="{path: 'entityModel>Initials'}"
    icon="{path: 'entityModel>IconName'}"
    displayShape="Square"       <!-- set "Circle" or "Square" -->
    size="L" />
</core:FragmentDefinition>
```

**STEP**: 4 - Example: manifest.json settings and extension registration (Fiori elements)

**DESCRIPTION**: Register the fragment in the manifest to inject the custom avatar into the object page header (example uses Generic Component extension points). Adjust paths and extension point names for your Fiori elements version.

**LANGUAGE**: JSON

**CODE**:
```json
/* File: webapp/manifest.json (partial - illustrative) */
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "controllerName": "my.app.controller.DetailsExtension"
          }
        }
      }
    },
    "resources": {
      "fragments": {
        "CustomHeaderAvatar": "fragments/CustomHeaderAvatar.fragment.xml"
      }
    }
  }
}
```

**STEP**: 5 - Notes for OData V2 and Page Editor

**DESCRIPTION**: For SAP Fiori elements applications based on OData V2, you can change the avatar shape (display shape) using the Page Editor in SAP Fiori Tools. Use the Page Editor to switch between circular and square shapes, which affects placeholder icon choice.

**LANGUAGE**: text

**CODE**:
```text
See: Configure Page Elements in SAP Fiori tools
URL: https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/047507c86afa4e96bb3d284adb9f4726.html
```

**STEP**: 6 - Implementation guidance and best practices

**DESCRIPTION**: Actionable tips for reliable avatar presentation:
- Prefer ImageUrl via annotations for automatic handling by Fiori elements.
- Provide initials in the payload/entity when images are not always present.
- Provide a semantic icon name when initials are not appropriate.
- When customizing via UI5 fragments, bind to the same entity model and follow the selection order.
- Control displayShape explicitly in custom fragments to ensure the desired placeholder icon appears.

**LANGUAGE**: text

**CODE**:
```text
Best practices:
- Annotation-first: com.sap.vocabularies.UI.v1.HeaderInfo.ImageUrl -> use backend-provided PictureUrl.
- Provide initials field (Initials) in the entity payload for fallback.
- Provide IconName (sap-icon://...) only if intended to override initials.
- If you add a custom Avatar (sap.m.Avatar), set displayShape="Circle" or "Square" to control placeholder semantics.
```
--------------------------------

**TITLE**: Server and Client Handling of SAP Fiori Messages (state, transition, 412/503, OData V2/V4)

**INTRODUCTION**: Action-oriented reference for implementing and consuming server-side messages in SAP Fiori Elements apps. Includes backend annotation examples for OData V4 side effects, client retry logic for 503 responses, guidance for 412 handling, and UI behavior for bound vs unbound messages and message strip usage.

**TAGS**: SAP Fiori, OData V4, OData V2, messages, state messages, transition messages, SideEffects, MessagePopover, MessageDialog, 412, 503, ExtensionAPI

STEP: 1 — Message Types (State vs Transition)

DESCRIPTION: Summarize behavior to decide how to produce and consume messages. Backend producers must know which type to send; clients render differently.

LANGUAGE: PlainText
CODE:
```text
- State message: refers to instance state (e.g., "Amount must not be negative").
  - Persisted in backend.
  - Displayed until instance state corrected.
  - Shown in message popover in edit mode; not supported on list report or object page in display mode.
- Transition message: transient, tied to the last action (e.g., "Printer not available").
  - Not persisted in backend (fire-and-forget).
  - Shown in message dialog or message toast (single success).
```

STEP: 2 — Backend Validation for Drafts and Field Changes

DESCRIPTION: Implementation checklist for backend validation and when to return state messages.

LANGUAGE: PlainText
CODE:
```text
- Validate inputs before draft activation or when user presses Enter/Validation on mobile.
- Return state messages for invalid fields. If any invalid, prevent draft activation and return draft to user.
- When user edits a field, revalidate only changed fields and add/remove corresponding state messages.
- Use multi-target messages only for special scenarios (e.g., startDate > endDate or unit-of-measure highlighting). Ensure all targets are on the same UI page.
```

STEP: 3 — Handling 412 ("Precondition Failed")

DESCRIPTION: Client behavior to allow retry when encountering 412; present confirmation popup to user and allow ignoring 412 to retry the action.

LANGUAGE: PlainText
CODE:
```text
- On HTTP 412, surface a confirmation popup allowing the user to retry or cancel.
- If user chooses retry, re-submit the request ignoring the 412 warning per business rules.
- See app's confirmation popup utilities or standard "Confirmation Popups" documentation for UI details.
```

STEP: 4 — OData V2 Specifics (Transition Messages & Draft Operations)

DESCRIPTION: Behavior differences in SAP Fiori Elements for OData V2 and guidance to avoid noisy UI.

LANGUAGE: PlainText
CODE:
```text
- Transition messages are always shown in the message dialog (also in object page edit mode).
- Treat draft operations (activate, prepare, validate) like actions.
- Avoid raising transition messages during prepare and validate operations (they show a blocking dialog in edit mode).
```

STEP: 5 — OData V4: State Messages, Message Property, and SideEffects (XML annotation)

DESCRIPTION: For OData V4, state messages are sent as complex-type body. Use SideEffects annotations to tell the client which properties/entities should cause the message model (SAP__Messages) to be (re)read/updated. If the server returns messages in an action result, the client will implicitly request SAP__Messages unless an explicit SideEffects exists.

LANGUAGE: XML
CODE:
```xml
<!-- Example 1: Side effect when Customer changes -> read SAP__Messages for that entity -->
<Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="CustomerChange">
    <Record>
        <PropertyValue Property="SourceProperties">
            <Collection>
                <PropertyPath>Customer</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="TargetProperties">
            <Collection>
                <PropertyPath>SAP__Messages</PropertyPath>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>

<!-- Example 2: Side effect for reading messages for all properties (entity-level source) -->
<Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="AllwaysReadStateMessages">
    <Record>
        <PropertyValue Property="SourceEntities">
            <Collection>
                <NavigationPropertyPath />
            </Collection>
        </PropertyValue>
        <PropertyValue Property="TargetProperties">
            <Collection>
                <PropertyPath>SAP__Messages</PropertyPath>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 6 — OData V4: When to Annotate Message Property

DESCRIPTION: Action rules for side effects and message property annotations.

LANGUAGE: PlainText
CODE:
```text
- Annotate side effects with SAP__Messages in TargetProperties for any property change that can cause messages to appear/disappear.
- If an action returns an entity and includes a message property, the client will implicitly request SAP__Messages unless you provided a side effect.
- If you provide a SideEffects annotation, explicitly include SAP__Messages in TargetProperties to ensure the client refreshes messages.
```

STEP: 7 — Bound vs Unbound Messages: Client UI Behavior

DESCRIPTION: Implementation and UI usage patterns for bound and unbound messages; decide which component to use.

LANGUAGE: PlainText
CODE:
```text
- Unbound messages: not instance-specific -> always treated as transition messages -> shown in MessageDialog.
  Usage: global service errors, maintenance messages.

- Bound messages (instance-specific): can be state or transition.
  - In edit mode: show in MessagePopover (summarized, grouped by message group/table).
  - In list report or object page display mode: bound transition messages shown in MessageDialog.
  - If exactly one bound transition success -> show a non-blocking message toast.
  - Bound transition messages are cleared when the user triggers a new action or changes data.

UI components:
- Message Button: visible only when bound messages exist; shows highest severity color and total error count.
- Message Popover: filter by severity, group name (table/section), short description, subtitle, chevron navigation to long text.
- Message Dialog: filter, type, title/subtitle, detailed description + technical details (status code, component ID, timestamps).
```

STEP: 8 — Message UI Integration: Navigation & Details

DESCRIPTION: Ensure messages from backend include navigation targets and long text for details. Client uses chevron navigation to open long descriptions and trigger navigation to the UI element.

LANGUAGE: PlainText
CODE:
```text
- Backend should supply:
  - Message group or table hint for grouping
  - Short text and optional long text
  - Navigation target (e.g., annotation or target path) to allow client navigation to the offending field/row
- Client behavior:
  - MessagePopover item click => navigate to the control/row indicated by the message target
  - MessageDialog chevron => show full technical details (status code/text, service ID, analysis, timestamp)
```

STEP: 9 — Special Handling of 503 ("Service Unavailable") — Client Retry Policy (JavaScript)

DESCRIPTION: Client-side handling logic for HTTP 503 with optional Retry-After header. Implement three behaviors based on Retry-After value: busy indicator (<5s), dialog and automatic retry (5–600s), or error page/dialog (>600s). If startup fails with 503, show error page.

LANGUAGE: JavaScript
CODE:
```javascript
// Example fetch wrapper handling 503 + Retry-After (seconds)
async function fetchWith503Handling(url, options = {}) {
  const resp = await fetch(url, options);
  if (resp.status !== 503) {
    return resp;
  }

  // 503 handling
  // If app startup fails with 503: show error page (handled by caller)
  const retryAfterHeader = resp.headers.get('retry-after');
  const retrySecs = retryAfterHeader ? parseInt(retryAfterHeader, 10) : null;

  if (retrySecs === null || isNaN(retrySecs)) {
    // No retry-after: show dialog with details and allow manual retry
    showServiceUnavailableDialog(resp);
    throw new Error('Service Unavailable (no retry-after)');
  }

  if (retrySecs < 5) {
    // Short wait: show busy indicator briefly and retry
    showBusyIndicator(true);
    await delay(retrySecs * 1000);
    showBusyIndicator(false);
    return fetch(url, options); // retry immediately
  }

  if (retrySecs >= 5 && retrySecs <= 600) {
    // Medium wait: show dialog and schedule automatic retry after retrySecs
    showServiceUnavailableDialog(resp, { autoRetryIn: retrySecs });
    return new Promise((resolve, reject) => {
      setTimeout(async () => {
        try {
          const r = await fetch(url, options);
          resolve(r);
        } catch (e) {
          reject(e);
        }
      }, retrySecs * 1000);
    });
  }

  // retrySecs > 600: treat as longer outage -> show error page or dialog
  showErrorPageOrDialog(resp);
  throw new Error('Service Unavailable (long outage)');
}

// Helper utility
function delay(ms) {
  return new Promise(resolve => setTimeout(resolve, ms));
}

// Placeholder UI functions - implement using app/dialog framework
function showBusyIndicator(active) { /* show/hide busy indicator */ }
function showServiceUnavailableDialog(resp, opts) { /* show dialog, show details and optional auto-retry info */ }
function showErrorPageOrDialog(resp) { /* navigate to error page or show blocking dialog */ }
```

STEP: 10 — Showing or Hiding the Message Strip on Object Page via ExtensionAPI

DESCRIPTION: Use ObjectPage.ExtensionAPI to show/hide the object-level message strip or display a specific status message derived from backend information.

LANGUAGE: JavaScript
CODE:
```javascript
// From a controller or extension hook where extensionAPI is available:
const messages = [
  {
    type: "Error",            // severity: Error, Warning, Success, Information
    message: "Order is blocked for delivery",
    additionalText: "Block reason: credit check",
    target: "/SalesOrder(123)" // optional: target entity or navigation
  }
];

// Show a message strip on the Object Page using the ExtensionAPI
// Refer to: https://ui5.sap.com/#/api/sap.fe.templates.ObjectPage.ExtensionAPI/methods/showMessages
if (this.extensionAPI && typeof this.extensionAPI.showMessages === "function") {
  this.extensionAPI.showMessages({ messages }); // signature may vary by framework version; see API docs
}

// To hide the message strip, use the corresponding ExtensionAPI method (see API reference).
// Note: consult the API docs for exact method signature and parameters for your Fiori Elements/UI5 version.
```

STEP: 11 — Practical Recommendations and Do's/Don'ts

DESCRIPTION: Short actionable rules to follow while designing message flows.

LANGUAGE: PlainText
CODE:
```text
Do:
- Return state messages for persistent field-level issues; clients must revalidate changed fields.
- Annotate SideEffects for properties/entities that can affect SAP__Messages to keep client synchronized.
- Provide navigation targets and long text for better UX in MessagePopover/MessageDialog.
- Use multi-target messages only for special cases and only if targets are on the same UI page.

Don't:
- Raise transition messages during prepare/validate operations (OData V2 or V4 edit flows).
- Overuse backend input validations that block user draft editing; validate on activation or explicit validation actions.
- Treat unbound messages as bound — unbound should be displayed in MessageDialog.
```


--------------------------------

**TITLE**: SAP Fiori Elements Floorplans Reference Map for Code Generation

**INTRODUCTION**: This document maps each SAP Fiori Elements floorplan to its official documentation file and image asset. Use this mapping when generating code, scaffolding apps, or embedding documentation links and previews. Each step contains a concise, machine-friendly JSON snippet you can consume directly.

**TAGS**: fiori-elements, floorplans, list-report, object-page, analytical-list-page, overview-page, worklist, documentation, assets

**STEP**: 1 — List Report and Object Page

**DESCRIPTION**: Use this floorplan when you need a list (table) view to filter/browse objects and an object page for viewing/editing/creating items. The following JSON snippet links to the documentation and the representative image asset.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "floorplan": "List Report and Object Page",
  "docFile": "list-report-and-object-page-c0eec49.md",
  "image": "images/Using_SAP_Fiori_Elements_Floorplans_List_Report_3e93d0e.png",
  "imageAlt": "List Report",
  "summary": "Predefined templates for list reports (tables) and object pages for viewing, editing, and creating objects. Typically used together: list report for browsing and object page for details."
}
```

**STEP**: 2 — Analytical List Page (ALP)

**DESCRIPTION**: Use this floorplan when you need stepwise data analysis with interactive charts, filters, KPIs, and drilldown to investigate root causes and act on transactional content. The JSON snippet points to the ALP documentation and image.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "floorplan": "Analytical List Page",
  "docFile": "analytical-list-page-3d33684.md",
  "image": "images/Using_SAP_Fiori_Elements_Floorplans_Analytical_List_Page_897c8d0.png",
  "imageAlt": "Analytical List Page",
  "summary": "Use for visualization and reporting of data with filters, interactive charts, and KPIs to analyze and act on transactional content."
}
```

**STEP**: 3 — Overview Pages

**DESCRIPTION**: Use this floorplan for data-driven apps that present large amounts of information as cards (different card types for different content). It's optimized for high-level overviews with quick filtering and actions.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "floorplan": "Overview Pages",
  "docFile": "overview-pages-c64ef8c.md",
  "image": "images/Using_SAP_Fiori_Elements_Floorplans_Overview_Page_e83a616.png",
  "imageAlt": "Overview Page",
  "summary": "Data-driven app organizing information in card format for quick filtering, viewing, and action. Helps present the big picture and focus on important tasks."
}
```

**STEP**: 4 — Worklist

**DESCRIPTION**: Use this floorplan for simple collections of items to be processed by users where heavy filtering is not required. Typical workflows involve reviewing items and taking action (complete or delegate).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "floorplan": "Worklist",
  "docFile": "worklist-d1d588f.md",
  "image": "images/Using_SAP_Fiori_Elements_Floorplans_Worklist_0393ce6.png",
  "imageAlt": "Worklist",
  "summary": "Displays a collection of items to be processed. Minimal filtering; users review item details and take action."
}
```

**STEP**: 5 — Generic Guidance and Version Reference

**DESCRIPTION**: Generic information that applies to all floorplans is available in the “How To Use SAP Fiori Elements” document. For SAPUI5 version and maintenance status, use the official version overview URL. Use these when deciding target UI5 versions or implementing common Fiori Elements patterns.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "genericInfoDoc": "how-to-use-sap-fiori-elements-20de950.md",
  "sapui5VersionStatusUrl": "https://ui5.sap.com/versionoverview.html",
  "notes": "Consult the generic document for floorplan-agnostic guidelines (patterns, annotations, deployment). Check SAPUI5 version overview for compatibility and maintenance."
}
```
--------------------------------

**TITLE**: Application Preview Generator (Create Integration & Adaptive Cards for Fiori Elements Object Pages)

**INTRODUCTION**: Step-by-step, code-focused guide to enable and use the Application Preview Generator in SAP Business Application Studio for ABAP-based Fiori elements object pages. Includes config edits, install commands, how to launch the generator, where generated files are placed, and the manifest update added automatically.

**TAGS**: fiori-elements-framework, ui5, sap-ux, cards, adaptive-card, integration-card, ABAP, ui5-tooling-v3, business-application-studio

STEP: 1 Prerequisites
DESCRIPTION: Ensure the project environment and compatibility before enabling the card generator.
LANGUAGE: Text
CODE:
```text
Requirements:
- Project cloned in SAP Business Application Studio (BAS).
- Project supports UI5 Tooling v3. If not, migrate to v3 (see: https://sap.github.io/ui5-tooling/v3/updates/migrate-v3/ and migration guidance for BAS).
- Application must be ABAP-based and the target page must be an object page (restriction: cards only for object pages; generator available only for ABAP projects).
Notes:
- Integration card is displayed by default in the UI; an adaptive card is always generated in parallel and can be chosen for display.
```

STEP: 2 Configure ui5.yaml to use latest SAP UI5 CDN
DESCRIPTION: Update ui5.yaml so the dev server and proxy use https://ui5.sap.com. This ensures the latest UI5 runtime is used by the generator and the mockserver middleware configuration is present for local testing.
LANGUAGE: YAML
CODE:
```yaml
specVersion: "3.1"
metadata:
  name: sales-order.wd.sample
type: application
resources:
  configuration:
    paths:
      webapp: webapp
server:
  customMiddleware:
  - name: fiori-tools-proxy
    afterMiddleware: compression
    configuration:
      ignoreCertError: false
      ui5:
        path:
        - /resources
        - /test-resources
        url: https://ui5.sap.com
  - name: sap-fe-mockserver
    mountPath: /
    afterMiddleware: compression
    configuration:
      annotations:
      - localPath: './mockserver/sap/opu/odata/sap/salesorder/annotations.xml'
        urlPath: '/sap/opu/odata/sap/salesorder;v=2/Annotations*'
      services:
      - urlPath: '/sap/opu/odata/sap/salesorder'
        metadataPath: './mockserver/sap/opu/odata/sap/salesorder/metadata.xml'
        mockdataPath: './mockserver/sap/opu/odata/sap/salesorder/data/'
```

STEP: 3 Install the Cards Editor (add generator tooling)
DESCRIPTION: From a terminal in your project workspace, add the cards-editor generator tooling. Choose either npx or npm init variant depending on your environment.
LANGUAGE: Shell
CODE:
```bash
# Option 1 (npx)
npx @sap-ux/create@latest add cards-editor

# Option 2 (npm init)
npm init @sap-ux@latest add cards-editor
```

STEP: 4 Launch the Cards Generator locally
DESCRIPTION: Start the project with the cards-generator start script. This launches the app and enables the Generate Card action in the user menu on object pages.
LANGUAGE: Shell
CODE:
```bash
# Start the project with cards generator enabled
npm run start-cards-generator
```

STEP: 5 Create a Card from an Object Page (UI steps)
DESCRIPTION: From the running app:
- If the app opens to a List Report, filter or search to open the target Object Page.
- Open the user menu on the Object Page and select "Generate Card".
- In the Card Generator dialog, fill in Card Header, Card Content, Card Actions, and Advanced options. A live preview shows the integration card and the corresponding adaptive card side-by-side.
- Choose Save to create the card assets into the project repository.
LANGUAGE: Text
CODE:
```text
UI flow summary:
1. Launch app -> navigate to Object Page
2. User menu -> Generate Card
3. Use dialog:
   - Card Header: title, subtitle, main indicator
   - Card Content: add properties, groups, labels, formatting
   - Card Actions: import-based actions (executable from Teams)
   - Advanced Panel: criticality, unit of measure, text arrangement (applies globally to property usage)
   - More options for properties:
     - Apply Units of Measure (string/number)
     - Apply Formatter:
       * Date: date/time formatting, UTC toggle, relative formatting
       * Number: Float, Currency, Percent, Integer
     - Apply Criticality
     - Apply Trend (string/number)
     - Apply Indicators (string/number)
4. Preview updates live. Click Save to persist.
```

STEP: 6 Files created and manifest.json update
DESCRIPTION: When you save a generated card:
- A new folder webapp/cards is created (cards stored under webapp/cards/op/...).
- The application's manifest.json receives a "sap.cards.ap" section linking the object page to the card manifest localUri. If you re-generate for the same Object Page, the existing card is overwritten.
LANGUAGE: JSON
CODE:
```json
// Example manifest.json addition (automatically added)
"sap.cards.ap": {
  "embeds": {
    "ObjectPage": {
      "default": "C_STTA_SalesOrder_WD_20",
      "manifests": {
        "C_STTA_SalesOrder_WD_20": [
          {
            "localUri": "cards/op/C_STTA_SalesOrder_WD_20"
          }
        ]
      }
    }
  }
}
```
CODE:
```text
File locations:
- Generated card folder: webapp/cards/op/<CardName>/
- Ensure webapp is committed: merge all changed files into your project repository after adding cards.
```

STEP: 7 Commit and share changes
DESCRIPTION: After card creation, merge and commit all changed project files (including webapp/cards and manifest.json) to your repository so the cards are available for other developers and for deployment.
LANGUAGE: Shell
CODE:
```bash
# Example Git workflow
git add webapp/cards manifest.json
git commit -m "Add generated integration & adaptive card for Object Page C_STTA_SalesOrder_WD_20"
git push
```

STEP: 8 Notes & Restrictions
DESCRIPTION: Quick reminders and limitations to enforce in automation or code generation flows.
LANGUAGE: Text
CODE:
```text
- Cards are only generated for Fiori Elements object pages (not for other page types).
- The generator is available only for ABAP-based projects.
- Integration card is displayed by default; adaptive card is generated alongside and can be chosen for display.
- Re-running the generator for the same object page overwrites the existing card in webapp/cards.
```
--------------------------------

**TITLE**: Using the Condensed Table Layout (manifest.json)

**INTRODUCTION**: Enable a condensed content density for grid tables (sap.ui.table / GridTable) in Fiori Elements list report and object page apps by setting the manifest.json key "condensedTableLayout": true for the relevant section or control configuration. Use these manifest fragments to apply the condensed style to specific sections or table controls.

**TAGS**: fiori-elements-framework, manifest.json, condensedTableLayout, content-density, ui.table, sap.ui.table, GridTable, ObjectPage, ListReport

**STEP**: 1 — How to enable condensed layout (general)
**DESCRIPTION**: In your application's manifest.json, add "condensedTableLayout": true inside the section or table settings that target the grid table you want to render in condensed mode. This key is evaluated per-section / per-control and will apply the condensed CSS class for grid tables when the app runs in compact mode.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "manifest.json": {
    "...": "...",
    "sap.ui.generic.app": {
      "pages": {
        "ObjectPage|<EntitySetName>": {
          "entitySet": "<EntitySetName>",
          "component": {
            "name": "sap.suite.ui.generic.template.ObjectPage",
            "settings": {
              "sections": {
                "<SectionIdentifier>": {
                  "condensedTableLayout": true
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — OData V2 example (Object Page) — manifest fragment
**DESCRIPTION**: Example manifest.json fragment for a V2 Object Page. Place this under your manifest (sap.ui.generic.app.pages). Replace entity set and section IDs with your application-specific values.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "sections": {
              "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
                "condensedTableLayout": true
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — OData V4 example (Object Page) — component/manifest fragment
**DESCRIPTION**: Example manifest/Component fragment for Fiori Elements OData V4. Use controlConfiguration.tableSettings to target the LineItem table and set type to GridTable and condensedTableLayout to true. Adjust contextPath and keys to your app.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "componentUsages": {
      "SalesOrderManageObjectPageCondensedTable": {
        "type": "Component",
        "id": "SalesOrderManageObjectPage",
        "name": "sap.fe.templates.ObjectPage",
        "options": {
          "settings": {
            "contextPath": "/SalesOrderManage",
            "controlConfiguration": {
              "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                "tableSettings": {
                  "type": "GridTable",
                  "condensedTableLayout": true
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Applicability and constraints
**DESCRIPTION**: Important limitations and runtime conditions to verify when using condensedTableLayout.
**LANGUAGE**: Plain Text
**CODE**:
```
- Applies only to grid tables (sap.ui.table / GridTable). It does NOT apply to responsive tables (sap.m.Table).
- The application must run in compact mode (content density compact). If the app runs in cozy mode, the condensed class will not be added even when condensedTableLayout is true.
- Object Page limitation: condensedTableLayout is applied only when:
  - There is exactly one section that contains a grid table (sap.ui.table), OR
  - You use an iconTabBar to navigate sections and any given section contains only one table.
  If multiple sections contain grid tables (or a section contains multiple tables) the condensed class is not applied even if the manifest key is set to true.
- File to edit: manifest.json (place fragments in the appropriate location for your app type: sap.ui.generic.app pages for V2 or sap.ui5/component usage/controlConfiguration for V4).
```
--------------------------------

**TITLE**: Export Button — Enable/Configure Spreadsheet and PDF Exports for Fiori Elements (OData V4)

**INTRODUCTION**: This reference shows how to enable/disable the Export button, configure export behavior and exported columns, set the request-size limit, and enable PDF export for SAP Fiori elements (OData V4). Use the manifest.json controlConfiguration and service annotations to control behavior. Include these examples directly in application manifest and service annotations.

**TAGS**: fiori-elements-framework, export, manifest.json, spreadsheet, pdf, controlConfiguration, exportRequestSize, ODataV4

STEP: 1 — Enable or disable Export button per page/component

DESCRIPTION: By default the Export button is enabled and shown in the table toolbar. Control it per page/component using the enableExport setting under controlConfiguration for the LineItem. Add this to the application manifest (manifest.json) target/options/settings/controlConfiguration for the List Report and Object Page components.

LANGUAGE: JSON

CODE:
```json
// manifest.json (excerpt)
{
  "SalesOrderManageList": {
    "type": "Component",
    "id": "SalesOrderManageList",
    "name": "sap.fe.templates.ListReport",
    "options": {
      "settings": {
        "contextPath": "/SalesOrderManage",
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "enableExport": false
            }
          }
        }
      }
    }
  },
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "contextPath": "/SalesOrderManage",
        "controlConfiguration": {
          "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "enableExport": true
            }
          }
        }
      }
    }
  }
}
```

STEP: 2 — Export menu behavior and "Export As..." options

DESCRIPTION: Export icon triggers export with default settings. The drop-down provides "Export" (default) and "Export As..." (opens dialog). When using "Export As..." you can enable:
- Split cells with multiple values: exports multiple columns for combined-value fields (amount+unit, price+currency, code+text, DataPoint target values, FieldGroup properties, custom column properties).
- Include filter settings: adds a second sheet with current filter state.

LANGUAGE: Text

CODE:
```
Menu behavior:
- Click export icon: starts export with default settings.
- Click drop-down -> "Export": default export.
- Click drop-down -> "Export As...": shows dialog with:
  * Split cells with multiple values:
    - Amount + unit or Price + currency -> two columns (value & unit/currency).
    - Code + value (Text / Text annotation) -> two columns (code & description). Note: TextArrangement is not considered; Text annotation always exports both.
    - dataFieldForAnnotation -> DataPoint with target value -> separate columns for property and target.
    - dataFieldForAnnotation -> FieldGroup -> each property exported to its own column.
    - Custom columns defined with multiple properties -> each property exported into separate columns (see manifest "properties" array requirement).
  * Include filter settings -> current filter included on second sheet.
```

STEP: 3 — Configure exported columns (manifest Columns / exportSettings)

DESCRIPTION: Control how columns are exported using the Columns key under controlConfiguration for the LineItem. Supported export column properties:
- type: export data type (see sap.ui.export.EdmType)
- properties: field name or array of field names
- template: formatting template with indexed placeholders {0}, {1}...
- width: column width in characters (default 10). Approx. 1 char ≈ 0.5em.
- wrap: boolean to wrap content

Provide exportSettings inside each column entry. This configuration is not supported when using the Table building block.

LANGUAGE: JSON

CODE:
```json
// manifest.json (controlConfiguration excerpt)
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "personalization": true
      },
      "columns": {
        "DataField::OverallSDProcessStatus": {
          "horizontalAlign": "Center",
          "exportSettings": {
            "template": "{0}",
            "width": "5"
          }
        },
        "CustomColumnSorting": {
          "header": " {i18n > LRCustomColumnSorting}",
          "availability": "Default",
          "template": "SalesOrder.custom.CustomColumn.CustomColumnSorting",
          "properties": [
            "ID",
            "TotalNetAmount",
            "_CustomerPaymentTerms/CustomerPaymentTerms",
            "_ShipToParty/BusinessPartner"
          ],
          "exportSettings": {
            "property": ["ID", "TotalNetAmount"],
            "template": " {0} {1}",
            "type": "String",
            "width": "100"
          }
        }
      }
    }
  }
}
```

STEP: 4 — Export to PDF: service-level annotations required

DESCRIPTION: To enable PDF export, the OData service must expose PDF as a supported format and include the PDF vocabulary feature annotation. Configure these annotations at the service level (annotation file or CSDL). Required annotations:
- Org.OData.Capabilities.V1.SupportedFormats must include "application/pdf"
- com.sap.vocabularies.PDF.v1.Feature must be configured (see PDF vocabulary)

LANGUAGE: XML

CODE:
```xml
<!-- Service annotations (example snippet, add to service annotations file or CSDL) -->
<Annotations Target="YourService.YourEntitySet">
  <!-- 1) SupportedFormats: include application/pdf -->
  <Annotation Term="Org.OData.Capabilities.V1.SupportedFormats">
    <Collection>
      <String>application/json;odata.metadata=minimal</String>
      <String>application/pdf</String>
    </Collection>
  </Annotation>

  <!-- 2) PDF feature: configure com.sap.vocabularies.PDF.v1.Feature as required by your PDF generator -->
  <Annotation Term="com.sap.vocabularies.PDF.v1.Feature">
    <!-- Configure PDF feature properties here according to the PDF vocabulary -->
  </Annotation>
</Annotations>
```

STEP: 5 — Configure exportRequestSize (limit rows per request)

DESCRIPTION: Set exportRequestSize in tableSettings to control how many records are fetched per request during export. Default is 1000. You can set a higher value per page/target in manifest routing target options.

LANGUAGE: JSON

CODE:
```json
// manifest.json (example setting exportRequestSize to 3000)
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "exportRequestSize": 3000
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 6 — Restrictions and security considerations

DESCRIPTION: Important runtime restrictions and security guidance to apply when enabling exports.

LANGUAGE: Text

CODE:
```
Restrictions:
- Columns with DataFieldForAnnotation pointing to Charts or DataFieldForAction are exported empty.
- Columns containing a multi-input field (1:N) are not exported.
- Columns with dynamic UI.Hidden expressions are still exported.
- Numbers exceeding 15 digits are rounded in the spreadsheet (JavaScript limitation).
- Export-to-spreadsheet column configuration is not supported for the Table building block.

Security notes:
- Data annotated as PersonalData.IsPotentiallySensitive can be exposed when export is enabled. To prevent leaking sensitive data, disable export via enableExport in the manifest for affected pages.
- For more security details, see Security Configuration documentation (security-configuration-ba0484b.md).
```
--------------------------------

**TITLE**: extensionAPI usage in SAP Fiori Elements (OData V2 & V4) — access patterns, sample handlers, and invokeActions examples

**INTRODUCTION**: Practical, code-focused reference for accessing the template-provided extensionAPI from controllers in Fiori Elements (List Report, Object Page, Analytical List Page). Includes V2 and V4 access patterns, a concrete onAfterActivate handler example, invokeActions parameter usage with examples, and best-practice cautions to follow when writing extension code.

**TAGS**: fiori-elements-framework, extensionAPI, OData V2, OData V4, ListReport, ObjectPage, AnalyticalListPage, invokeActions, UI5

**STEP**: 1 — Access extensionAPI in OData V2 controllers

**DESCRIPTION**: How to obtain the template-provided extensionAPI object from a controller when using SAP Fiori Elements with OData V2. This API object exposes template services; do not rely on its class name (may change) and do not instantiate classes in sap.suite.ui.generic.template.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// Inside any controller method (V2)
onInit: function() {
    // The extensionAPI for V2 templates is available as this.extensionAPI
    var oExtAPI = this.extensionAPI;

    // Example: call a generic method if available (method names are stable; class names are not)
    if (oExtAPI && typeof oExtAPI.invokeActions === "function") {
        // placeholder usage — see invokeActions examples in later steps
    }
}

/*
Template -> extensionAPI instance identifiers (informational; do not depend on names):
- List Report: sap.suite.ui.generic.template.ListReport.extensionAPI.ExtensionAPI
- Object Page: sap.suite.ui.generic.template.ObjectPage.extensionAPI.ExtensionAPI
- Analytical List Page: sap.suite.ui.generic.template.AnalyticalListPage.extensionAPI.ExtensionAPI

CAUTION:
- Do NOT create instances of classes in the sap.suite.ui.generic.template namespace.
- Do NOT access private controller properties (names starting with '_') or manipulate internal template controls/models.
*/
```

**STEP**: 2 — Access extensionAPI in OData V4 controllers

**DESCRIPTION**: How to obtain the extension API in Fiori Elements with OData V4. Use getExtensionAPI() to receive the template API object.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// Inside any controller method (V4)
onInit: function() {
    // For V4 templates, use this.getExtensionAPI()
    var oExtAPI = this.getExtensionAPI();

    // Example: call a stable method on the extension API
    if (oExtAPI && typeof oExtAPI.someMethod === "function") {
        // call oExtAPI.someMethod(...);
    }
}

/*
Template -> extensionAPI instance identifiers (informational; do not depend on names):
- List Report: sap.fe.templates.ListReport.ExtensionAPI
- Object Page:  sap.fe.templates.ObjectPage.ExtensionAPI

Note: API class names may change; rely on the documented methods instead.
*/
```

**STEP**: 3 — onAfterActivate handler example (V2): run logic after backend activation success

**DESCRIPTION**: Full example of an onAfterActivate handler that waits for the back-end activation response (via activationPromise) and sends an email if a business rule is triggered (e.g., Price > 1000). Use this pattern for activity that must run only after the server-side activation completes.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// Example controller extension file (V2)
// Register this handler in your extension controller where appropriate (e.g., extension hooks)
sap.ui.define([
    "sap/ui/core/mvc/Controller",
    "sap/m/URLHelper"
], function(Controller, URLHelper) {
    "use strict";

    return Controller.extend("my.app.controller.Extension", {
        // Hook or event handler registered by the template (name depends on template)
        onAfterActivate: function(oEvent) {
            // oEvent.activationPromise resolves after successful response from back end
            if (oEvent && oEvent.activationPromise && typeof oEvent.activationPromise.then === "function") {
                oEvent.activationPromise.then(function(oResponse) {
                    // oResponse.data contains the entity data returned from backend
                    if (oResponse && oResponse.data && oResponse.data.Price > 1000) {
                        var sSubject = "critical price change";
                        var sBody = "changed price of " + oResponse.data.Product_Text
                                    + " to " + oResponse.data.Price + " " + oResponse.data.Currency;
                        // Trigger email (UI5 helper)
                        URLHelper.triggerEmail(null, sSubject, sBody);
                    }
                }).catch(function(oError) {
                    // handle activation error if needed
                    /* eslint-disable no-console */
                    console.error("Activation failed:", oError);
                });
            }
        }
    });
});
```

**STEP**: 4 — invokeActions: parameters, behavior and example usage

**DESCRIPTION**: invokeActions executes a function import/action for one or many contexts and submits changes. This step documents parameters and provides practical code examples for invoking an action with contexts, URL parameters, and settings (e.g., grouping change sets).

Parameter summary:
- sFunctionName (string) — name of the function/action
- vContext (array | sap.ui.model.Context) — binding context(s) for which the action is called
- mUrlParameters (map) — optional URL parameters (name-value pairs) for the action
- oSettings (object) — additional settings (e.g., { bInvocationGroupingChangeSet: true })
- Returns: Promise that resolves with results; rejects on missing OData function or invalid parameters

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// Generic invokeActions usage (V2 example using this.extensionAPI)
function invokeActionExample() {
    var oExtAPI = this.extensionAPI; // V2
    var sActionName = "MyBackendAction"; // OData action name (function import if applicable)

    // Example: gather contexts (for a table's selected items)
    var oTable = this.byId("myTable"); // UI5 table control id
    var aContexts = oTable ? oTable.getSelectedContexts() : [];

    // Optional URL parameters map
    var mUrlParameters = {
        "ParamA": "ValueA",
        "ParamB": "ValueB"
    };

    // Settings: control invocation grouping of change sets (true => common changeset)
    var oSettings = {
        bInvocationGroupingChangeSet: true
    };

    // Call invokeActions; returns a Promise
    if (oExtAPI && typeof oExtAPI.invokeActions === "function") {
        oExtAPI.invokeActions(sActionName, aContexts, mUrlParameters, oSettings)
            .then(function(aResults) {
                // aResults: array with per-context results or single result depending on call
                // handle successful results (update UI, notify user, etc.)
                console.log("invokeActions results:", aResults);
            })
            .catch(function(oError) {
                // handle errors: missing OData function import or invalid input parameters
                console.error("invokeActions failed:", oError);
            });
    } else {
        console.error("extensionAPI.invokeActions not available");
    }
}

/*
Alternate calling signature notes:
- vContext can be a single sap.ui.model.Context or an array of contexts.
- mUrlParameters used to pass function/action URL query params.
- oSettings.bInvocationGroupingChangeSet controls grouping into common/unique changesets.
- invokeActions throws/rejects when action not found or parameters invalid.
*/
```

**STEP**: 5 — Best practices and cautions (quick checklist)

**DESCRIPTION**: Minimal actionable rules to follow when implementing extension hooks and handlers.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
/* Best practices (follow these in all extensions)
1. Access template APIs only via:
   - V2: this.extensionAPI
   - V4: this.getExtensionAPI()

2. Do not manipulate internal template controls, models, or other objects created by the framework.
   - e.g., do NOT rely on controller properties whose names start with '_' — treat them as private.

3. Do not instantiate classes in sap.suite.ui.generic.template (not public API).

4. Do not rely on class instance names shown in documentation; rely on the documented methods available on the extensionAPI object.

5. Use promises returned by extensionAPI methods (e.g., invokeActions, activationPromise) to sequence server-dependent logic.

6. Always add error handlers (.catch) for backend calls to surface failures and to avoid unhandled rejections.
*/
```
--------------------------------

**TITLE**: Multi-Input Field on the Object Page — Implementation Guide

**INTRODUCTION**: This guide explains how to enable and display a multi-input field on the Fiori elements Object Page. It covers the required 1:N association in the data model (ABAP CDS and CAP), how to reference the navigation property in UI annotations (XML / CDS), optional JSON binding for the UI5 MultiInput control, OData V4 capability annotations for edit/delete restrictions, and known limitations. Use these snippets directly in your CDS models, annotation files, or UI5 views.

**TAGS**: fiori-elements, multi-input, navigation-property, CDS, CAP, UI.Annotations, ODataV4, value-help, UI5

STEP: 1 — Define a 1:N association in the data model (activates multi-input)
DESCRIPTION: Create a one-to-many navigation property/composition in your data model. When the runtime detects a 1:N association for a DataField, the multi-input control is automatically activated on the Object Page.
LANGUAGE: CDS (ABAP and CAP)
CODE:
```CDS
// ABAP CDS (composition one-to-many)
composition [0..*] of SupportedMaterial as _SupportedMaterials

// CAP CDS (composition of many)
_SupportedMaterials : Composition of many SupportedMaterial on _SupportedMaterials.owner = $self;
```

STEP: 2 — Reference the navigation property in a UI LineItem (XML annotation)
DESCRIPTION: Use the navigation property path as the Value of a UI.DataField in the UI.LineItem annotation to display the target entity property values (e.g., material of each SupportedMaterial).
LANGUAGE: XML
CODE:
```XML
<!-- UI LineItem annotation referencing navigation property property path -->
<Annotation Term="UI.LineItem">
  <Collection>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="_SupportedMaterials.Material" />
    </Record>
  </Collection>
</Annotation>
```

STEP: 3 — ABAP CDS: UI annotations for Field Group and LineItem
DESCRIPTION: Add UI annotations in ABAP CDS to include the navigation property values in LineItem and field group definitions.
LANGUAGE: ABAP CDS
CODE:
```ABAP
@UI: {
  lineItem: [ { value: '_SupportedMaterials.Material', label: 'Supported Materials' } ]
}
@UI.fieldGroup: [{ position: 10, qualifier: 'FieldgroupID', value: '_SupportedMaterials.Material' }]
_SupportedMaterials;
```

STEP: 4 — CAP CDS: UI LineItem annotation (JSON-like)
DESCRIPTION: Define a UI.LineItem entry in CAP CDS annotations referencing the navigation property value.
LANGUAGE: CAP CDS
CODE:
```CAP
LineItem : {
  {
    $Type  : 'UI.DataField',
    Label  : 'Supported Materials',
    Value  : _SupportedMaterials.Material
  },
  …
}
```

STEP: 5 — Add value help on target property (recommended)
DESCRIPTION: To enable add/remove of existing values from the multi-input control, define value help on the target property (the property of the target entity, e.g., SupportedMaterial.Material). This is configured on the target property in your metadata or CDS annotations (value help provider). Also consider adding a value help annotation or VHDL as appropriate for your stack.
LANGUAGE: Text
CODE:
```text
Tip: Define a Value Help for the target property (e.g., SupportedMaterial.Material) in your service model or CDS so the multi-input offers selection from existing values. If using Fiori elements, add a ValueHelp annotation or corresponding CDS/value help definition on the target property.
```

STEP: 6 — Bind MultiInput to a JSON model (UI5 example, optional flexible programming)
DESCRIPTION: If you use flexible programming / UI5, you can bind a MultiInput control to a JSON model property that holds the selected values. This is useful for custom views or fragments.
LANGUAGE: XML + JavaScript
CODE:
```XML
<!-- XML view: MultiInput bound to a named model 'selectedModel' -->
<core:View xmlns:core="sap.ui.core" xmlns="sap.m">
  <MultiInput tokens="{selectedModel>/selectedValues}" />
</core:View>
```

```JavaScript
// JavaScript: create and set JSON model with selected values array
var oModel = new sap.ui.model.json.JSONModel({
  selectedValues: [ "MATERIAL_1", "MATERIAL_2" ]
});
this.getView().setModel(oModel, "selectedModel");
```

STEP: 7 — OData V4: Use Capabilities to control Insert/Delete (editability)
DESCRIPTION: For OData V4 and Fiori elements, use the Capabilities.InsertRestrictions and Capabilities.DeleteRestrictions annotations to mark whether the field (or its association) can be inserted (edited/added) or deleted. Use annotation records on the targeted entity or navigation property.
LANGUAGE: XML (Annotations)
CODE:
```XML
<!-- Example: mark a navigation property as non-insertable (not editable) -->
<Annotations Target="YourServiceNamespace.YourEntity/_SupportedMaterials">
  <Annotation Term="Capabilities.InsertRestrictions">
    <Record>
      <PropertyValue Property="Insertable" Bool="false"/>
    </Record>
  </Annotation>

  <Annotation Term="Capabilities.DeleteRestrictions">
    <Record>
      <PropertyValue Property="Deletable" Bool="true"/>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 8 — Known restrictions and guidelines
DESCRIPTION: Important limitations and recommended workarounds you must account for when using multi-input fields in Fiori elements.
LANGUAGE: Text
CODE:
```text
Notes / Restrictions:
- Multi-input fields are supported only in draft-enabled applications.
- You cannot mark the multi-input field as mandatory using Common.fieldControl annotation.
- The multi-input field does not support displaying more than 100 selected values. If you need to display >100 selected values, use a table (multi-input in a table is available).
- For OData V4, use Capabilities.InsertRestrictions and Capabilities.DeleteRestrictions to control edit/delete behavior on associations.
```

STEP: 9 — Images and live example
DESCRIPTION: Visual references and live demo links for implementation and testing.
LANGUAGE: Text
CODE:
```text
Images:
- images/Multi-Input_Control_on_the_Object_Page_d756a5b.png
- images/Smart_MultiInput_Control_on_the_Object_Page_Table_dcb027c.png

Live example:
- Field - Multi Value Field (UI5 FPM Explorer): 
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/multiValueField
```

Related Information:
- Tables: tables-c0f6592.md (SAP Fiori elements supports several table types.)
--------------------------------

**TITLE**: Using securedExecution in SAP Fiori elements extension code

**INTRODUCTION**: This document explains how to call the securedExecution extension API from Fiori elements extension code. Use securedExecution to run asynchronous operations that must be synchronized with user interaction state (e.g., prevent data loss, coordinate with other secured actions, update document state for OData V4). The function passed must not perform direct user interaction and must return a Promise. securedExecution itself returns a Promise that is rejected when the function is not executed.

**TAGS**: fiori-elements-framework, securedExecution, extensionAPI, odata-v2, odata-v4, extension, async, promise

**STEP**: 1 - Basic pattern (async/await)

**DESCRIPTION**: Generic pattern for calling securedExecution from an extension controller. The function passed (fnFunction) must return a Promise or be async. Do not perform direct user interactions inside fnFunction. The Promise returned by securedExecution resolves/rejects together with fnFunction if executed; otherwise it is rejected.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// In a controller extension where `this.extensionAPI` is available
onMyCustomAction: async function () {
  // Define the secured function: must return a Promise and must not show dialogs or prompts
  const fnFunction = async () => {
    // perform asynchronous work (e.g., call service, update model)
    // Example: call a custom backend service via fetch or OData model
    const result = await customService.doSomething(); // customService returns a Promise
    // Optionally update models, but avoid direct user dialogs here
    this.getView().getModel().setProperty("/somePath", result);
    return result;
  };

  try {
    // Call securedExecution; it returns a Promise
    const value = await this.extensionAPI.securedExecution(fnFunction);
    // Continue after securedExecution finished successfully
    console.log("securedExecution result:", value);
  } catch (err) {
    // securedExecution was not executed or fnFunction rejected
    console.error("securedExecution aborted or failed:", err);
  }
}
```

**STEP**: 2 - ListReport (OData V2) example: avoid data loss in non-draft scenarios

**DESCRIPTION**: For OData V2 non-draft apps, securedExecution may prevent execution when the user is editing or unsaved data exists. Use securedExecution when the action could cause data loss. The extension API instance is typically available as this.extensionAPI in controller extensions.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// ListReport controller extension (OData V2)
onQuickActionTriggered: function () {
  const fnFunction = () => {
    // Example: call a backend endpoint that does server-side processing
    return fetch("/my/service/executeAction", { method: "POST" })
      .then(response => {
        if (!response.ok) {
          throw new Error("Service call failed");
        }
        return response.json();
      })
      .then(data => {
        // update UI5 model with result (no dialogs here)
        this.getView().getModel().setProperty("/actionResult", data);
        return data;
      });
  };

  // securedExecution returns a Promise that rejects if the function is not executed
  return this.extensionAPI.securedExecution(fnFunction)
    .then(data => {
      // success handling (no user interaction inside fnFunction)
      console.log("Action completed", data);
    })
    .catch(err => {
      // either securedExecution prevented execution (e.g., unsaved changes) or fnFunction failed
      console.warn("Action not executed or failed:", err);
    });
}
```

**STEP**: 3 - OData V4: mark that the function updates the document state

**DESCRIPTION**: In OData V4 scenarios, if your secured function changes the document/object state (so the framework should treat it as document-modifying), set the updatesDocument parameter to true in the call to securedExecution. This instructs the framework that the operation may update application state.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Controller extension (OData V4) - indicate document updates
onSaveCustomChange: function () {
  const fnFunction = async () => {
    // perform state-changing async operations, e.g., call create/update on OData V4 model
    await this.getView().getModel().submitBatch(); // example: returns a Promise
    // Do not launch dialogs here
    return { success: true };
  };

  // Pass parameters to indicate state update; param name: updatesDocument: true
  return this.extensionAPI.securedExecution(fnFunction, { updatesDocument: true })
    .then(result => {
      console.log("Document-updating securedExecution completed:", result);
    })
    .catch(err => {
      console.error("securedExecution aborted or failed:", err);
    });
}
```

**STEP**: 4 - Handle cases where securedExecution does not run

**DESCRIPTION**: securedExecution may reject without executing fnFunction (for example: user in edit mode, unsaved data, or user cancelled the data-loss confirmation). Always handle rejection. If you need to differentiate between "not executed" and "executed and failed", inspect the error or implement additional application-level flags in fnFunction.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example error handling for securedExecution
const fnFunction = async () => {
  // asynchronous operation
  await someAsyncTask();
  return "ok";
};

this.extensionAPI.securedExecution(fnFunction)
  .then(result => {
    // fnFunction executed and resolved
    console.log("Executed:", result);
  })
  .catch(err => {
    // Possible reasons:
    // - securedExecution prevented running fnFunction (user in edit, unsaved changes, cancel)
    // - fnFunction executed but rejected (operation failed)
    // Distinguish by error message conventions used in your application or set flags inside fnFunction
    console.error("securedExecution error or prevention:", err);
  });
```

**STEP**: 5 - Notes and references

**DESCRIPTION**: Key rules to enforce in code:
- fnFunction must NOT perform user interactions (dialogs, confirmations, prompts).
- fnFunction must return a Promise or be async.
- The Promise returned by securedExecution is rejected when fnFunction is not executed.
- For OData V4, set { updatesDocument: true } when your code changes the object/document state.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "reference_v2": "https://ui5.sap.com/#/api/sap.suite.ui.generic.template.ListReport.extensionAPI.ExtensionAPI/methods/securedExecution",
  "reference_v4": "https://ui5.sap.com/#/api/sap.fe.core.controllerextensions.EditFlow/methods/securedExecution"
}
```
--------------------------------

**TITLE**: Validation of Required Fields in Non-draft Fiori Elements (OData V2)

**INTRODUCTION**: Configure InsertRestrictions RequiredProperties per entity set to validate mandatory fields on object creation in non-draft Fiori elements applications (OData V2). Before the create request is sent to the backend, annotated fields are validated; empty fields generate an error entry in the message popover with a link that navigates to the offending field. You can override default messages via i18n properties.

**TAGS**: fiori-elements-framework, validation, OData V2, InsertRestrictions, RequiredProperties, annotations, i18n

**STEP**: 1 — Add RequiredProperties annotation to the entity set

**DESCRIPTION**: Add the Org.OData.Capabilities.V1.InsertRestrictions annotation for each entity set you want to protect. List required properties inside RequiredProperties as PropertyPath entries. This is an XML OData annotation file (e.g., annotations.xml) and applies per entity set. Validation runs before sending the create request for non-draft apps.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Save in your annotations file (e.g., annotations.xml) and deploy with the service annotations -->
<Annotations Target="STTA_SALES_ORDER_ND_SRV_01.STTA_SALES_ORDER_ND_SRV_01_Entities/STTA_C_SO_SalesOrder_ND">
    <Annotation Term="Org.OData.Capabilities.V1.InsertRestrictions">
        <Record Type="Org.OData.Capabilities.V1.InsertRestrictionsType">
            <PropertyValue Property="RequiredProperties">
                <Collection>
                    <PropertyPath>BusinessPartnerID</PropertyPath>
                    <PropertyPath>CurrencyCode</PropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 2 — Behavior and UX

**DESCRIPTION**: When a required property (from the annotation) is empty during create (non-draft), the framework:
- Prevents the create request from being sent.
- Adds an error entry to the message popover on the page.
- Provides a navigation link in the message which focuses the related field.

Notes:
- This validation is only applicable to SAP Fiori elements for OData V2 (non-draft).
- Required fields are NOT validated during "create with dialog" flows.

**LANGUAGE**: text

**CODE**:
```text
Behavior summary:
- Trigger: Create action in non-draft app.
- Validation: Client-side check of RequiredProperties before request.
- Error presentation: Message popover entry with link to field.
- Exception: Create-with-dialog is excluded from this validation.
```

**STEP**: 3 — Override default error text (i18n)

**DESCRIPTION**: To override the framework default message for a required property, add an entry to your i18n properties file using the key format:
CREATE_MANDATORY|PropertyName = <CUSTOM TEXT>
Place entries in i18n.properties used by your app.

Example: override CurrencyCode message while leaving BusinessPartnerID default

**LANGUAGE**: Properties

**CODE**:
```properties
# i18n.properties (application resource bundle)
# Default framework text remains for BusinessPartnerID if not overridden
CREATE_MANDATORY|BusinessPartnerID = Enter a value for the Business partner ID field

# Custom override for CurrencyCode
CREATE_MANDATORY|CurrencyCode = Enter a valid currency code
```

**STEP**: 4 — Reference image and troubleshooting

**DESCRIPTION**: Screenshot reference for expected UI behavior (message popover with navigation link). If message does not appear:
- Confirm the annotation Target matches your service/container/entity set name exactly.
- Confirm the app is an OData V2 non-draft Fiori elements app.
- Ensure i18n key is deployed and loaded by the app.

**LANGUAGE**: text

**CODE**:
```text
Image asset path (reference):
images/Validation_of_Required_Fields_in_Non-Draft_Apps_1_18415a9.png
```
--------------------------------

**TITLE**: Value Help as Dropdown or Radio Button for Fixed Value Lists (SAP Fiori Elements, OData V2 & V4)

**INTRODUCTION**: Show how to render value help as a dropdown (sap.m.ComboBox / sap.m.MultiComboBox) or as radio button groups when the value help contains a fixed set of values. Includes OData V2 metadata extension, OData V4 XML annotations, ABAP CDS, CAP CDS, FilterRestrictions, and manifest.json options to enable dropdowns and radio buttons.

**TAGS**: fiori-elements-framework, odata-v2, odata-v4, annotations, cds, cap, abap, manifest.json, value-help, dropdown, radio-buttons

**STEP**: Enable dropdown list for OData V2 (EDMX / $metadata)

**DESCRIPTION**: In OData V2 services add sap:value-list="fixed-values" on the Property and sap:semantics="fixed-values" on the EntitySet. The runtime will render sap.m.ComboBox or sap.m.MultiComboBox for the value help when the entity set contains a fairly stable/fixed number of values. Place this in the service EDMX ($metadata) produced by your OData V2 service.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- $metadata (EDMX) snippet for OData V2 -->
<EntityType Name="SMART_C_ProductType" sap:label="Product" sap:content-version="1">
  <Key>...</Key>
  ...
  <Property Name="ProductCategory" Type="Edm.String" Nullable="false" MaxLength="40"
            sap:label="Category" sap:value-list="fixed-values" />
  ...
</EntityType>

<EntityContainer Name="SMART_PROD_MAN_Entities" m:IsDefaultEntityContainer="true"
                 sap:supported-formats="atom json xlsx">
  ...
  <EntitySet Name="SEPMRA_I_ProductCategory"
             EntityType="SMART_PROD_MAN.SEPMRA_I_ProductCategoryType"
             sap:creatable="false" sap:updatable="false" sap:deletable="false"
             sap:searchable="true" sap:content-version="1" sap:semantics="fixed-values" />
</EntityContainer>
```

**STEP**: Enable dropdown list for OData V4 using XML Annotations

**DESCRIPTION**: Use Common.ValueListWithFixedValues = true together with Common.ValueList to point to the collection. Add this to your local annotation file for the service (annotations.xml) or to the metadata annotations for the OData V4 service. Runtime renders a ComboBox/MultiComboBox for the property.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="sap.fe.officesupplies.CatalogAdminService.Products/currency_code">
  <Annotation Term="Common.Label" String="Currency"/>
  <Annotation Term="Common.Text" Path="currency/name">
    <Annotation Term="UI.TextArrangement" EnumMember="UI.TextArrangementType/TextOnly"/>
  </Annotation>

  <!-- Enable fixed-value list -->
  <Annotation Term="Common.ValueListWithFixedValues" Bool="true"/>

  <Annotation Term="Common.ValueList">
    <Record Type="Common.ValueListType">
      <PropertyValue Property="Label" String="Currency"/>
      <PropertyValue Property="CollectionPath" String="Currencies"/>
      <PropertyValue Property="Parameters">
        <Collection>
          <Record Type="Common.ValueListParameterInOut">
            <PropertyValue Property="LocalDataProperty" PropertyPath="currency_code"/>
            <PropertyValue Property="ValueListProperty" String="code"/>
          </Record>
          <Record Type="Common.ValueListParameterDisplayOnly">
            <PropertyValue Property="ValueListProperty" String="name"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <Annotation Term="Core.Description" String="A currency code as specified in ISO 4217"/>
</Annotations>
```

**STEP**: Equivalent ABAP CDS annotations (OData V4 / SAP backend)

**DESCRIPTION**: For ABAP CDS: annotate the view/entity to declare a value help. Use @Consumption.valueHelpDefinition to point to the value list entity and @ObjectModel.text for the text element. Use @UI.textArrangement where needed.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
annotate view PRODUCTS with {
  @Consumption.valueHelpDefinition:
  [{
    entity :{
      name    : 'Currencies',
      element : 'code'
    },
    label  : 'Currency'
  }]

  @ObjectModel: {
    text: { element: [ 'name' ] }
  }
  @UI.textArrangement: #TEXT_ONLY
  currency_code;
}
```

**STEP**: Equivalent CAP CDS annotations (OData V4 / CAP model)

**DESCRIPTION**: For CAP (Node.js/Java) CDS models: use the Common annotations on the projected entity property, set @Common.ValueListWithFixedValues to true and define @Common.ValueList with CollectionPath + Parameters.

**LANGUAGE**: CAP CDS

**CODE**:
```cap
annotate sap.fe.officesupplies.CatalogAdminService.Products with {
  @Common.Label : 'Currency'
  @Common : {
    Text            : currency.name,
    TextArrangement : #TextOnly
  }
  @Common.ValueListWithFixedValues : true
  @Common.ValueList : {
    $Type : 'Common.ValueListType',
    Label : 'Currency',
    CollectionPath : 'Currencies',
    Parameters : [
      {
        $Type : 'Common.ValueListParameterInOut',
        LocalDataProperty : currency_code,
        ValueListProperty : 'code'
      },
      {
        $Type : 'Common.ValueListParameterDisplayOnly',
        ValueListProperty : 'name'
      }
    ]
  }
  @Core.Description : 'A currency code as specified in ISO 4217'
  currency_code
};
```

**STEP**: Allow MultiValue or SingleValue in filters (FilterRestrictions)

**DESCRIPTION**: Use FilterRestrictions / SAP__capabilities.FilterRestrictions to control which filter expressions are allowed for properties backed by fixed value lists. Example shows XML annotation, ABAP CDS alternative, and CAP CDS implementation.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Add in annotation file to allow multi-value filter expressions on currency_code -->
<Annotation Term="SAP__capabilities.FilterRestrictions">
  <Record>
    <PropertyValue Property="FilterExpressionRestrictions">
      <Collection>
        <Record>
          <PropertyValue Property="Property" PropertyPath="currency_code" />
          <PropertyValue Property="AllowedExpressions" String="MultiValue" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
" Example ABAP CDS snippet (disable filter or manage filter behaviour):
@ObjectModel: {
  filter.enabled: false
}
currency_code;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cap
Capabilities.FilterRestrictions : {
  FilterExpressionRestrictions : [
    {
      Property : currency_code,
      AllowedExpressions : 'MultiValue'
    }
  ]
}
```

**STEP**: Render value help as a radio button group via annotation (show values immediately)

**DESCRIPTION**: Use Common.ValueListWithFixedValues = true and add Common.ValueListShowValuesImmediately = true to render the fixed value list as a radio button group (vertical layout by default). The ValueList must reference the property via ValueListParameterInOut or ValueListParameterOut and label sources come from Common.Text or the value list display parameter. Use only for non-Boolean fields and small value lists (recommended <= 8 items).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="sap.fe.core.ValueHelpRadioButtons.RootElement/PropWithValueList">
  <Annotation Term="Common.Label" String="Radio button field via annotation"/>
  <Annotation Term="Common.ValueListWithFixedValues" Bool="true">
    <Annotation Term="Common.ValueListShowValuesImmediately" Bool="true"/>
  </Annotation>
  <Annotation Term="Common.ValueList">
    <Record Type="Common.ValueListType">
      <PropertyValue Property="Label" String="Value list with fixed values"/>
      <PropertyValue Property="CollectionPath" String="FixedValueListEntity"/>
      <PropertyValue Property="Parameters">
        <Collection>
          <Record Type="Common.ValueListParameterInOut">
            <PropertyValue Property="LocalDataProperty" PropertyPath="PropWithValueList"/>
            <PropertyValue Property="ValueListProperty" String="KeyProp"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: CAP CDS

**CODE**:
```cap
FieldWithRadioButtons  : String @(Common: {
  ValueListWithFixedValues                                       : true,
  ValueListWithFixedValues.@Common.ValueListShowValuesImmediately: true,
  ValueList                                                      : {
    CollectionPath: 'FixedValueListEntity',
    Parameters    : [
      {
        $Type            : 'Common.ValueListParameterInOut',
        LocalDataProperty: FieldWithRadioButtons,
        ValueListProperty: 'KeyProp'
      }
    ]
  }
});

@cds.autoexpose
entity FixedValueListEntity {
  key KeyProp     : Integer @Common.Text : Description;
  Description     : String
}
```

**STEP**: Render radio button group via manifest.json controlConfiguration (horizontal layout)

**DESCRIPTION**: Instead of annotation-driven immediate rendering, configure the control via manifest.json controlConfiguration for a field in a UI.FieldGroup to render the radio button group and set radioButtonsHorizontalLayout true to use horizontal layout. Include CAP CDS example and manifest.json fragment.

**LANGUAGE**: CAP CDS

**CODE**:
```cap
FieldWithRadioButtonsViaManifest  : String @(Common: {
  ValueListWithFixedValues    : true,
  ValueList                   : {
    CollectionPath: 'FixedValueListEntity',
    Parameters    : [
      {
        $Type            : 'Common.ValueListParameterInOut',
        LocalDataProperty: FieldWithRadioButtonsViaManifest,
        ValueListProperty: 'KeyProp'
      }
    ]
  }
});

@cds.autoexpose
entity FixedValueListEntity {
  key KeyProp     : Integer @Common.Text : Description;
  Description     : String
}

UI.FieldGroup #MyFieldGroup : {
  Label: 'Line item data',
  Data : [
    {Value: FieldWithRadioButtonsViaManifest}
  ]
}
```

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (fragment)
"controlConfiguration": {
  "@com.sap.vocabularies.UI.v1.FieldGroup#MyFieldGroup": {
    "fields": {
      "DataField::FieldWithRadioButtonsViaManifest": {
        "formatOptions": {
          "fieldEditStyle"              : "RadioButtons",
          "radioButtonsHorizontalLayout": true
        }
      }
    }
  }
}
```

**STEP**: Notes, restrictions and recommendations

**DESCRIPTION**: Keep these rules and recommendations in mind when using fixed value lists and radio buttons.

**LANGUAGE**: Plaintext

**CODE**:
```
- Controls rendered for fixed-value value helps: sap.m.ComboBox (single-select) and sap.m.MultiComboBox (multi-select).
- Radio buttons: use Common.ValueListWithFixedValues=true and Common.ValueList (or controlConfiguration fieldEditStyle="RadioButtons").
- Radio button requirements:
  - Supported only for fields with ValueListWithFixedValues : true and a single ValueList annotation.
  - ValueListParameterInOut or ValueListParameterOut must reference the field itself via LocalDataProperty.
  - Labels come from Common.Text or from the ValueList display parameter; UI.TextArrangement is not supported.
  - Use only for non-Boolean value lists.
- Radio button restrictions:
  - Do not use for multiple value lists or for ValueListRelevantQualifiers.
  - Do not use for value lists with dependencies (ValueListParameterInOut or ValueListParameterIn).
  - ValueListParameterConstant filters are not applied to radio buttons (all values displayed).
- Recommendation: Use radio button group only when the value list is small (<= 8 entries) and selection semantics fit (recommended UX guidance).
- Place XML annotation snippets in the OData service annotation file (annotations.xml) or in the local annotation transport; ABAP CDS annotations belong in backend CDS views; CAP annotations belong in model .cds files.
- To control filtering capabilities (e.g., multi-value filter expressions) use SAP__capabilities.FilterRestrictions / Capabilities.FilterRestrictions as shown above.
```
--------------------------------

**TITLE**: Vertical Bullet Chart Card — OVP / UI5 Implementation Patterns

**INTRODUCTION**: This document describes how to implement a Vertical Bullet Chart Card on an SAP Fiori Overview Page (OVP) or as a standalone UI5 VizFrame. It specifies the required data mapping (dimension + measures), the roles for measures (axis1 = actual columns, axis2 = target line), and provides concrete code templates you can copy into manifest.json, XML view, and controller files. Replace placeholders (ENTITYSET, PROPERTY names) with your real model names.

**TAGS**: sapui5, fiori-elements-framework, ovp, bullet-chart, vizframe, manifest.json, overview-page

STEP: Data mapping and visualization roles
DESCRIPTION: Map your OData/entity data to chart roles. Requirements:
- At least one dimension and one measure.
- All dimensions -> axis category (used for chart category axis).
- Measures with role "axis1" -> rendered as solid-colored columns (actual values).
- Measures with role "axis2" -> rendered as a solid black line (target values).
LANGUAGE: JSON
CODE:
```json
{
  "mapping": {
    "dimension": {
      "entityProperty": "ProductName",
      "role": "axis",
      "description": "Category axis: e.g., product, region, period"
    },
    "measures": [
      {
        "entityProperty": "SalesAmount",
        "role": "axis1",
        "description": "Actual value -> rendered as a solid column"
      },
      {
        "entityProperty": "SalesTarget",
        "role": "axis2",
        "description": "Target value -> rendered as a solid black line"
      }
    ]
  }
}
```

STEP: OVP card manifest configuration (webapp/manifest.json)
DESCRIPTION: Example manifest card configuration for an Overview Page card. Use this skeleton inside "sap.ui5" -> "models" and "sap.ovp" card definitions. Replace placeholders: <CARD_ID>, <ENTITY_SET>, <DIMENSION_PROPERTY>, <MEASURE_ACTUAL>, <MEASURE_TARGET>, and annotationPath if required by your stack.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "<CARD_ID>": {
        "template": "sap.ovp.cards.charts.vizChart",
        "model": "mainModel",
        "settings": {
          "title": "Vertical Bullet Chart",
          "subTitle": "Actual vs Target",
          "vizType": "verticalBullet",              /* semantic name, adapt to your renderer */
          "entitySet": "<ENTITY_SET>",
          "dimensions": [
            {
              "entityProperty": "<DIMENSION_PROPERTY>",
              "label": "Category"
            }
          ],
          "measures": [
            {
              "entityProperty": "<MEASURE_ACTUAL>",
              "label": "Actual",
              "role": "axis1"
            },
            {
              "entityProperty": "<MEASURE_TARGET>",
              "label": "Target",
              "role": "axis2"
            }
          ]
        }
      }
    }
  }
}
```

STEP: UI5 XML view (webapp/view/VerticalBullet.view.xml)
DESCRIPTION: Standalone UI5 VizFrame view that implements a vertical bullet chart. Replace dataset/paths with your model. This uses sap.viz.ui5.controls.VizFrame + FlattenedDataset. Feed uid names are typical; adapt if your VizFrame version uses different uids. Styling ensures axis2 (target) line is black and actual bars are solid color.
LANGUAGE: XML
CODE:
```xml
<mvc:View controllerName="my.app.controller.VerticalBullet"
          xmlns:mvc="sap.ui.core.mvc"
          xmlns="sap.m"
          xmlns:viz="sap.viz.ui5.controls">
  <Page title="Vertical Bullet Chart">
    <content>
      <viz:VizFrame id="bulletViz" uiConfig="{applicationSet:'fiori'}" width="100%" height="400px" vizType="bullet">
        <viz:dataset>
          <viz.data:FlattenedDataset xmlns:viz.data="sap.viz.ui5.data">
            <viz.data:dimensions>
              <viz.data:DimensionDefinition name="Category" value="{ProductName}" />
            </viz.data:dimensions>
            <viz.data:measures>
              <viz.data:MeasureDefinition name="Actual" value="{SalesAmount}" />
              <viz.data:MeasureDefinition name="Target" value="{SalesTarget}" />
            </viz.data:measures>
          </viz.data:FlattenedDataset>
        </viz:dataset>

        <!-- Feed items: map dimension and measures to chart axes -->
        <viz:feedItems>
          <viz:FeedItem uid="categoryAxis" type="Dimension" values="Category" />
          <viz:FeedItem uid="valueAxis" type="Measure" values="Actual" />
          <!-- target feed: some VizFrame bullet implementations accept a separate feed for target -->
          <viz:FeedItem uid="targetValues" type="Measure" values="Target" />
        </viz:feedItems>
      </viz:VizFrame>
    </content>
  </Page>
</mvc:View>
```

STEP: UI5 controller for view (webapp/controller/VerticalBullet.controller.js)
DESCRIPTION: Load model, bind data to VizFrame, and set visualization properties to render axis1 as filled columns and axis2 as a black line. Adapt vizProperties to your VizFrame version and to your color palette.
LANGUAGE: JavaScript
CODE:
```javascript
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/viz/ui5/data/FlattenedDataset",
  "sap/viz/ui5/controls/common/feeds/FeedItem"
], function (Controller, FlattenedDataset, FeedItem) {
  "use strict";

  return Controller.extend("my.app.controller.VerticalBullet", {
    onInit: function () {
      var oVizFrame = this.byId("bulletViz");

      // Option A: If dataset & feeds are already defined in the XML view, just set model
      // this.getView().setModel(this.getOwnerComponent().getModel("mainModel"));

      // Option B: programmatically set dataset and feeds (example):
      var oDataset = new FlattenedDataset({
        dimensions: [{
          name: "Category",
          value: "{ProductName}"
        }],
        measures: [{
          name: "Actual",
          value: "{SalesAmount}"
        }, {
          name: "Target",
          value: "{SalesTarget}"
        }],
        data: {
          path: "/<ENTITY_SET>"
        }
      });
      oVizFrame.setDataset(oDataset);
      oVizFrame.setModel(this.getOwnerComponent().getModel()); // set default model

      oVizFrame.addFeed(new FeedItem({ uid: "categoryAxis", type: "Dimension", values: ["Category"] }));
      oVizFrame.addFeed(new FeedItem({ uid: "valueAxis", type: "Measure", values: ["Actual"] }));
      oVizFrame.addFeed(new FeedItem({ uid: "targetValues", type: "Measure", values: ["Target"] }));

      // Styling: ensure target line is black and actual bars are solid color.
      oVizFrame.setVizProperties({
        plotArea: {
          dataShape: {
            // control shape details if supported by VizFrame variant
          },
          drawingEffect: "normal"
        },
        valueAxis: {
          label: { visible: true }
        },
        categoryAxis: {
          title: { visible: false }
        },
        legend: { visible: false },
        // Example customizations: set color palette and series styles
        general: {
          layout: { padding: 0 }
        }
      });

      // If your VizFrame variant supports series-level styling, set target style to black:
      // (API varies by VizFrame version; adapt below sample to your version)
      oVizFrame.setModel(new sap.ui.model.json.JSONModel({
        // optional: custom color mapping; many projects use a custom palette instead
      }));

      // If needed, apply CSS or custom renderer to force target line black:
      // .sapViz .targetLine { stroke: #000000; stroke-width: 2px; }

    }
  });
});
```

STEP: Design notes and best practices
DESCRIPTION: Practical guidance for code generation:
- Always expose one dimension (category) and at least one measure (actual). Add target as an axis2 measure.
- axis1 measures will be shown as solid columns (actual values) — use chart color or palette configuration to control fill color.
- axis2 measures will be shown as a solid black line (target) — prefer to explicitly style this series (CSS or vizProperties) to guarantee black color across themes.
- If your OVP renderer expects specific keys (e.g., "role": "axis1"/"axis2"), ensure these appear in your card settings or annotation mapping so the shell/OVP runtime can render correctly.
LANGUAGE: JSON
CODE:
```json
{
  "bestPractices": [
    "Provide meaningful labels for dimension and measures in manifest settings",
    "Use explicit role mapping: axis1 = actual(s), axis2 = target(s)",
    "Test in both Overview Page and standalone VizFrame views (APIs can differ)",
    "If chart renderer uses different property names for feeds/vizType, adapt the feed uid names accordingly"
  ]
}
```


--------------------------------

**TITLE**: Visual Filters — Annotation and Configuration Examples for Fiori Elements

**INTRODUCTION**: Action-oriented, developer-ready reference with annotated code examples to configure Visual Filters (bar/line/donut) in SAP Fiori elements (OData V2/V4). Covers ValueList setup, PresentationVariant/Chart annotations, SelectionVariant/default values, text arrangement, scale factor, lazy loading, grouping, semantic coloring, number formatting, UoM text behavior, and controller extension hook for batching.

**TAGS**: visual-filters, annotations, ValueList, PresentationVariant, UI.Chart, SelectionVariant, Fiori-elements, OData, CDS, XML, ABAP, CAP, manifest, lazyLoadVisualFilter

STEP: 1 — Configure ValueList for Visual Filter (XML)
DESCRIPTION: Enhance the ValueList annotation on the filter field to enable a visual filter. Ensure the ValueList CollectionPath and Parameters (IN/OUT) map such that the chart dimension matches the ValueListProperty of the OUT parameter. Use PresentationVariantQualifier to point to the chart definition and SelectionVariantQualifier for default values.
LANGUAGE: XML
CODE:
```xml
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="SEPMRA_ALP_SO_ANA_SRV.SEPMRA_C_ALP_SlsOrdItemCubeALPResult/SalesOrderOverallStatus">
   <Annotation Term="Common.ValueList" Qualifier="VisualFilter">
      <Record>
         <PropertyValue Property="Label" String="Overall Status" />
         <PropertyValue Property="CollectionPath" String="SEPMRA_C_ALP_SlsOrdItemCubeALPResults" />
         <PropertyValue Property="SearchSupported" Bool="false" />
         <PropertyValue Property="PresentationVariantQualifier" String="FilterNumberOfSalesOrdersByStatus" />
         <PropertyValue Property="SelectionVariantQualifier" String="SVForStatus" />
         <PropertyValue Property="Parameters">
            <Collection>
               <Record Type="Common.ValueListParameterInOut">
                  <PropertyValue Property="LocalDataProperty" PropertyPath="SalesOrderOverallStatus" />
                  <PropertyValue Property="ValueListProperty" String="SalesOrderOverallStatus" />
               </Record>
               <Record Type="Common.ValueListParameterInOut">
                  <PropertyValue Property="LocalDataProperty" PropertyPath="MainProductCategory" />
                  <PropertyValue Property="ValueListProperty" String="MainProductCategory" />
               </Record>
               <Record Type="Common.ValueListParameterInOut">
                  <PropertyValue Property="LocalDataProperty" PropertyPath="ProductCategory" />
                  <PropertyValue Property="ValueListProperty" String="ProductCategory" />
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```

STEP: 2 — Configure ValueList for Visual Filter (CAP CDS)
DESCRIPTION: Equivalent CAP CDS annotation to produce the same ValueList configuration. Use Common.ValueList qualifier and Parameters array for IN/OUT mapping.
LANGUAGE: CDS
CODE:
```sql
annotate SEPMRA_ALP_SO_ANA_SRV.SEPMRA_C_ALP_SlsOrdItemCubeALPResult with {
  @Common.ValueList #VisualFilter : {
    Label : 'Overall Status',
    CollectionPath : 'SEPMRA_C_ALP_SlsOrdItemCubeALPResults',
    SearchSupported : false,
    PresentationVariantQualifier : 'FilterNumberOfSalesOrdersByStatus',
    SelectionVariantQualifier : 'SVForStatus',
    Parameters : [
        {
            $Type : 'Common.ValueListParameterInOut',
            LocalDataProperty : SalesOrderOverallStatus,
            ValueListProperty : 'SalesOrderOverallStatus'
        },
        {
            $Type : 'Common.ValueListParameterInOut',
            LocalDataProperty : MainProductCategory,
            ValueListProperty : 'MainProductCategory'
        },
        {
            $Type : 'Common.ValueListParameterInOut',
            LocalDataProperty : ProductCategory,
            ValueListProperty : 'ProductCategory'
        }
    ]
  }
  SalesOrderOverallStatus
};
```

STEP: 3 — Define PresentationVariant Qualifier (XML)
DESCRIPTION: Define a PresentationVariant qualifier that references a chart qualifier. The visual filter uses the first chart defined in this PresentationVariant. Use SortOrder in PresentationVariant to control chart sorting.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.PresentationVariant" Qualifier="FilterNumberOfSalesOrdersByStatus">
   <Record>
      <PropertyValue Property="Text" String="Filter: Number of Sales Order by Status" />
      <PropertyValue Property="SortOrder">
         <Collection>
            <Record Type="Common.SortOrderType">
               <PropertyValue Property="Property" PropertyPath="NumberOfSalesOrders" />
               <PropertyValue Property="Descending" Bool="true" />
            </Record>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="Visualizations">
         <Collection>
            <AnnotationPath>@UI.Chart#FilterNumberOfSalesOrdersByStatus</AnnotationPath>
         </Collection>
      </PropertyValue>
   </Record>
</Annotation>
```

STEP: 4 — Define PresentationVariant Qualifier (ABAP CDS)
DESCRIPTION: ABAP CDS representation of the PresentationVariant with sort order and visualization qualifier. Ensure qualifier name matches PresentationVariantQualifier in ValueList.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.PresentationVariant: [
  {
    text: 'Filter: Number of Sales Order by Status',
    sortOrder: [
      {
        by: 'NUMBEROFSALESORDERS',
        direction: #DESC
      }
    ],
    visualizations: [
      {
        type: #AS_CHART,
        qualifier: 'FilterNumberOfSalesOrdersByStatus'
      }
    ],
    qualifier: 'FilterNumberOfSalesOrdersByStatus'
  }
]
annotate view VIEWNAME with {
}
```

STEP: 5 — Define Chart Annotation (XML)
DESCRIPTION: Create the UI.Chart definition referenced by the PresentationVariant qualifier. Visual filters use the first dimension and first measure from the first chart. Ensure Chart Dimension matches ValueListProperty of the OUT parameter.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Chart" Qualifier="FilterNumberOfSalesOrdersByStatus">
   <Record Type="UI.ChartDefinitionType">
      <PropertyValue Property="Title" String="Sales Orders by Status" />
      <PropertyValue Property="Description" String="Number of Sales Orders by Status" />
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Donut" />
      <PropertyValue Property="Dimensions">
         <Collection>
            <PropertyPath>SalesOrderOverallStatus</PropertyPath>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="DimensionAttributes">
         <Collection>
            <Record Type="UI.ChartDimensionAttributeType">
               <PropertyValue Property="Dimension" PropertyPath="SalesOrderOverallStatus" />
               <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
            </Record>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="Measures">
         <Collection>
            <PropertyPath>NumberOfSalesOrders</PropertyPath>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="MeasureAttributes">
         <Collection>
            <Record Type="UI.ChartMeasureAttributeType">
               <PropertyValue Property="Measure" PropertyPath="NumberOfSalesOrders" />
               <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
               <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#NumberOfSalesOrders" />
            </Record>
         </Collection>
      </PropertyValue>
   </Record>
</Annotation>
```

STEP: 6 — Define Chart Annotation (ABAP CDS)
DESCRIPTION: ABAP CDS chart + measure qualification. Use asDataPoint/asDataPoint annotation so measure semantic coloring and data point settings are applied.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Chart: [
  {
    title: 'Sales Orders by Status',
    description: 'Number of Sales Orders by Status',
    chartType: #DONUT,
    dimensions: [
      'SALESORDEROVERALLSTATUS'
    ],
    dimensionAttributes: [
      {
        dimension: 'SalesOrderOverallStatus',
        role: #CATEGORY
      }
    ],
    measures: [
      'NUMBEROFSALESORDERS'
    ],
    measureAttributes: [
      {
        measure: 'NumberOfSalesOrders',
        role: #AXIS_1,
        asDataPoint: true
      }
    ],
    qualifier: 'FilterNumberOfSalesOrdersByStatus'
  }
]
annotate view VIEWNAME with {
}
```

STEP: 7 — Define Chart Annotation (CAP CDS)
DESCRIPTION: CAP CDS UI.Chart definition matching XML/ABAP chart. Include DataPoint reference in MeasureAttributes.
LANGUAGE: CDS
CODE:
```sql
UI.Chart #FilterNumberOfSalesOrdersByStatus : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Sales Orders by Status',
    Description : 'Number of Sales Orders by Status',
    ChartType : #Donut,
    Dimensions : [
        SalesOrderOverallStatus
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : SalesOrderOverallStatus,
            Role : #Category
        }
    ],
    Measures : [
        NumberOfSalesOrders
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : NumberOfSalesOrders,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#NumberOfSalesOrders'
        }
    ]
}
```

STEP: 8 — SelectionFields (Order of Visual Filter Fields)
DESCRIPTION: Use UI.SelectionFields to define the order of fields displayed in the visual filter bar. Mandatory filter fields not listed appear before SelectionFields entries.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.SelectionFields">
  <Collection>
    <PropertyPath>DeliveryCalendarYear</PropertyPath>
    <PropertyPath>SoldToParty</PropertyPath>
    <PropertyPath>Product</PropertyPath>
    <PropertyPath>MainProductCategory</PropertyPath>
    <PropertyPath>DeliveryCalendarQuarter</PropertyPath>
  </Collection>
</Annotation>
```

STEP: 9 — SelectionFields (ABAP CDS)
DESCRIPTION: ABAP CDS alternative using @UI.SelectionField positions.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.SelectionField: [{ position: 10 }]
DELIVERYCALENDARYEAR;

@UI.SelectionField: [{ position: 20 }]
SOLDTOPARTY;

@UI.SelectionField: [{ position: 30 }]
PRODUCT;

@UI.SelectionField: [{ position: 40 }]
MAINPRODUCTCATEGORY;

@UI.SelectionField: [{ position: 50 }]
DELIVERYCALENDARQUARTER;
```

STEP: 10 — Define SelectionVariant for Default/Fixed Values (XML)
DESCRIPTION: Provide default SelectOptions or Parameters to show fixed records on visual filter chart. IN/OUT parameter values in ValueList mapping take precedence over SelectionVariant values. For date values in SelectionVariant, use UTC format "YYYY-MM-DDThh:mm:ssZ" (time zeros).
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.SelectionVariant" Qualifier="SVForStatus">
   <Record>
      <PropertyValue Property="Parameters">
         <Collection>
            <Record Type="UI.Parameter">
               <PropertyValue Property="PropertyName" PropertyPath="CompanyCurrency" />
               <PropertyValue Property="PropertyValue" String="EUR" />
            </Record>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="SelectOptions">
         <Collection>
            <Record Type="UI.SelectOptionType">
               <PropertyValue Property="PropertyName" PropertyPath="SalesOrderOverallStatus" />
               <PropertyValue Property="Ranges">
                  <Collection>
                     <Record Type="UI.SelectionRangeType">
                        <PropertyValue EnumMember="UI.SelectionRangeSignType/E" Property="Sign" />
                        <PropertyValue EnumMember="UI.SelectionRangeOptionType/EQ" Property="Option" />
                        <PropertyValue Property="Low" String="D" />
                     </Record>
                  </Collection>
               </PropertyValue>
            </Record>
            <Record Type="UI.SelectOptionType">
               <PropertyValue Property="PropertyName" PropertyPath="Product" />
               <PropertyValue Property="Ranges">
                  <Collection>
                     <Record Type="UI.SelectionRangeType">
                        <PropertyValue EnumMember="UI.SelectionRangeSignType/E" Property="Sign" />
                        <PropertyValue EnumMember="UI.SelectionRangeOptionType/EQ" Property="Option" />
                        <PropertyValue Property="Low" String="HT-1502" />
                     </Record>
                  </Collection>
               </PropertyValue>
            </Record>
         </Collection>
      </PropertyValue>
   </Record>
</Annotation>
```

STEP: 11 — SelectionVariant (CAP CDS)
DESCRIPTION: CAP CDS SelectionVariant representation with Parameters and SelectOptions. Values in the Smart Filter override SelectionVariant parameters.
LANGUAGE: CDS
CODE:
```sql
UI.SelectionVariant #SVForStatus : {
    Parameters : [
        {
            $Type : 'UI.Parameter',
            PropertyName : CompanyCurrency,
            PropertyValue : 'EUR'
        }
    ],
    SelectOptions : [
        {
            $Type : 'UI.SelectOptionType',
            PropertyName : SalesOrderOverallStatus,
            Ranges : [
                {
                    $Type : 'UI.SelectionRangeType',
                    Sign : #E,
                    Option : #EQ,
                    Low : 'D'
                }
            ]
        },
        {
            $Type : 'UI.SelectOptionType',
            PropertyName : Product,
            Ranges : [
                {
                    $Type : 'UI.SelectionRangeType',
                    Sign : #E,
                    Option : #EQ,
                    Low : 'HT-1502'
                }
            ]
        }
    ]
}
```

STEP: 12 — Scale Factor in DataPoint (XML) — Chart Title Scale
DESCRIPTION: Configure UI.DataPoint ValueFormat.ScaleFactor to control scale factor displayed in chart title and axis. Avoid hard-coded scale unless value range is fixed. If not specified, Fiori determines optimal scale.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="LineChartTimeDataPoint">
    <Record Type="UI.DataPointType">
        <PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Positive"/>
        <PropertyValue Property="Title" String="Total Pricing"/>
        <PropertyValue Property="Value" Path="totalPricing"/>
        <PropertyValue Property="ValueFormat">
            <Record Type="UI.NumberFormat">
                <PropertyValue Property="ScaleFactor" Decimal="1000"/>
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 13 — TextArrangement (XML / ABAP / CAP)
DESCRIPTION: Use TextArrangement to control how dimension text and ID are combined in the visual filter bar. Types: TextFirst, TextLast, TextOnly, TextSeparate.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="ProductType">
  <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst"/> 
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.textArrangement: #TEXT_FIRST
annotate view ProductType with {
}
```

LANGUAGE: CDS
CODE:
```sql
annotate ProductType @(
  UI.TextArrangement : #TextFirst
);
```

STEP: 14 — lazyLoadVisualFilter (manifest.json) — OData V2
DESCRIPTION: Enable lazy loading for visual filters in OData V2 by setting lazyLoadVisualFilter true in the app descriptor. In V4, lazy loading is enabled by default and cannot be disabled.
LANGUAGE: JSON
CODE:
```json
"settings": {
  "qualifier": "MainContent",
  "defaultContentView": "charttable",
  "smartVariantManagement": true,
  "showGoButtonOnFilterBar": true,
  "multiSelect": true,
  "lazyLoadVisualFilter": true,
  "tableType": "AnalyticalTable"
}
```

STEP: 15 — Disable AccumulativeMeasure for Donut Negative-Value Overlay (OData V2)
DESCRIPTION: For V2 donut charts, to show an overlay message when measures include negative values, set Analytics.AccumulativeMeasure to false for the measure property.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SEPMRA_ALP_SO_ANA_SRV.Z_SEPMRA_C_ALP_QUARTERVHType/DifferenceAmount">
    <Annotation Term="Analytics.Measure" Bool="true" />
    <Annotation Term="Analytics.AccumulativeMeasure" Bool="false" />
</Annotations>
```

STEP: 16 — Group Visual Filter Calls via onBeforeRebindVisualFilterExtension (Controller JS)
DESCRIPTION: Use onBeforeRebindVisualFilterExtension extension to set oContext.groupId per dimension, consolidating visual filter calls into batches. Assign string groupId values to group fast/slow filters.
LANGUAGE: JavaScript
CODE:
```javascript
onBeforeRebindVisualFilterExtension: function(sEntityType, sDimension, sMeasure, oContext){
    'use strict';
    var Log = sap.ui.require("sap/base/Log");
    if (sDimension === "Product") {
        oContext.groupId = "Group1";
    }
    if (sDimension === "DeliveryCalendarMonth" || sDimension === "DeliveryCalendarQuarter") {
        oContext.groupId = "Group2";
    }
    Log.info("onBeforeRebindVisualFilterExtension called!");
}
```

STEP: 17 — Semantic Coloring by Measure (XML) — V2/V4
DESCRIPTION: For measure-based semantic coloring, attach a DataPoint with Criticality or CriticalityCalculation to the measure and reference it from Chart.MeasureAttributes.DataPoint. V4 supports hard-coded criticality values.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Chart" Qualifier="BarChartSoldToParty">
     <Record Type="UI.ChartDefinitionType">
          <PropertyValue Property="Title" String="Bar Chart"/>
          <PropertyValue Property="Description" String="Testing Bar Chart"/>
          <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bar"/>
          <PropertyValue Property="Measures">
               <Collection>
                    <PropertyPath>totalPricing</PropertyPath>
               </Collection>
          </PropertyValue>
          <PropertyValue Property="Dimensions">
               <Collection>
                   <PropertyPath>SoldToParty</PropertyPath>
               </Collection>
          </PropertyValue>
          <PropertyValue Property="MeasureAttributes">
               <Collection>
                    <Record Type="UI.ChartMeasureAttributeType">
                         <PropertyValue Property="Measure" PropertyPath="totalPricing"/>
                         <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                         <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#LineChartTimeDataPoint"/>
                    </Record>
               </Collection>
          </PropertyValue>
          <PropertyValue Property="DimensionAttributes">
               <Collection/>
          </PropertyValue>
     </Record>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="LineChartTimeDataPoint">
     <Record Type="UI.DataPointType">
          <PropertyValue Property="Value" Path="totalPricing"/>
          <PropertyValue Property="Title" String="Total Pricing"/>
          <PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Positive"/>
     </Record>
</Annotation>
```

STEP: 18 — DataPoint NumberOfFractionalDigits (XML / ABAP / CAP)
DESCRIPTION: Control fractional digits using UI.DataPoint.ValueFormat.NumberOfFractionalDigits. V2: any integer accepted; V4: values >2 clamp to 2. For currency measures, decimal places used only when scale factor applied; otherwise use currency defaults.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="Price">
    <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
        <PropertyValue Property="Value" Path="Price"/>
        <PropertyValue Property="ValueFormat">
            <Record Type="com.sap.vocabularies.UI.v1.NumberFormat">
                <PropertyValue Property="NumberOfFractionalDigits" Int="1"/>
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: { 
   valueFormat.numberOfFractionalDigits: 1  
}
price;
```

LANGUAGE: CDS
CODE:
```sql
UI.DataPoint #Price : {
    $Type : 'UI.DataPointType',
    Value : Price,
    ValueFormat : {
        $Type : 'UI.NumberFormat',
        NumberOfFractionalDigits : 1
    }
}
```

STEP: 19 — Unit of Measure Text Retrieval (XML)
DESCRIPTION: If a unit (currency/UoM) has a sap:text annotation on the main entity, that text is used. If main entity lacks sap:text but the value list entity set contains sap:text, the value list text is used and displayed in brackets.
LANGUAGE: XML
CODE:
```xml
<!-- Main Entity Set: DisplayCurrency no text annotation -->
<EntityType Name="ZEPM_C_SALESORDERITEMQUERYResult" sap:semantics="aggregate" sap:content-version="1">
  <Key>
    <PropertyRef Name="ID"/>
  </Key> 
  <Property Name="DisplayCurrency" Type="Edm.String" MaxLength="5" sap:aggregation-role="dimension" sap:creatable="false" sap:label="Display Currency" sap:updatable="false" sap:semantics="currency-code"/>  
</EntityType>

<!-- Value List Entity Set: DisplayCurrency with sap:text -->
<EntityType Name="ZEPM_C_SALESORDERITEMQUERYValueHelpResult" sap:semantics="aggregate" sap:content-version="1">
  <Key>
    <PropertyRef Name="ID"/>
  </Key> 
  <Property Name="DisplayCurrency" Type="Edm.String" MaxLength="5" sap:aggregation-role="dimension" sap:creatable="false" sap:label="Display Currency" sap:updatable="false" sap:semantics="currency-code" sap:text="DisplayCurrencyText"/>
  <Property Name="DisplayCurrencyText" Type="Edm.String" MaxLength="60" sap:filterable="false"/>
</EntityType>
```

STEP: 20 — Visual Filter Type / Behavior Notes (Actionable rules)
DESCRIPTION: Follow these rules when authoring visual filters:
- Visual filters use only the first measure and first dimension from the first chart in PresentationVariantQualifier.
- Sorting: For V2 bar/donut, default sort = displayed measure descending; override via PresentationVariant.SortOrder. For line charts:
  - Time-based dimensions: sort by dimension ascending, show last six time periods (annotation sort ignored).
  - Non-time dimensions: sort by dimension ascending; override via PresentationVariant.SortOrder.
- Chart displays: Bar => top/bottom 3; Line => first/last 6 points; Donut (V2) => top/bottom 2.
- Date fields must be UTC format ("YYYY-MM-DDThh:mm:ssZ") when used in SelectionVariant default values.
- Visual filter charts won't render when backend returns multiple UoMs unless a single UoM is selected or backend normalizes units.
LANGUAGE: JSON
CODE:
```json
{
  "rules": [
    "First chart -> first dimension & measure only",
    "V2 bar/donut default: sort by measure DESC (use PresentationVariant.SortOrder to change)",
    "Line (time): sort by dimension ASC; only last six time periods displayed",
    "Donut (V2): show top/bottom 2",
    "Dates in SelectionVariant must be UTC: \"2018-10-15T00:00:00Z\"",
    "Charts hidden if multiple UoMs returned"
  ]
}
```

STEP: 21 — OData V4: Manifest and Time-based Line Chart Requirement
DESCRIPTION: For OData V4 ensure each visual filter to be rendered has a manifest entry and that line charts use time-based dimensions (Edm.Date / Edm.Time / Edm.DateTimeOffset).
LANGUAGE: JSON
CODE:
```json
{
  "manifestGuidance": [
    "Add manifest property for each visual filter (see Configuring the Visual Filter Bar docs)",
    "Line charts require time-based dimension types: Edm.Date, Edm.Time, or Edm.DateTimeOffset"
  ]
}
```

Related: Use these code examples directly in your EDMX, ABAP CDS or CAP CDS model, and app manifest/controller to configure, batch, and style visual filters consistently.
--------------------------------

**TITLE**: Waterfall Chart Card — Annotations and Examples (XML, ABAP CDS, CAP CDS)

**INTRODUCTION**: Provide chart annotations to render a Waterfall chart card in Fiori Elements. This document contains requirements, behavior notes, and three ready-to-use annotation examples (XML, ABAP CDS, CAP CDS). Use these snippets in your annotation files or CDS views to display a Waterfall chart that analyzes cumulative values.

**TAGS**: fiori-elements-framework, waterfall, chart, UI.Chart, UI.ChartDefinitionType, CDS, ABAP, CAP, XML, annotations

**STEP**: 1 — Requirements and behavior summary

**DESCRIPTION**: Minimum requirements, axis/role rules, legend behavior, waterfallType options, and semantic coloring note. Use this as a checklist before adding annotations.

**LANGUAGE**: Text

**CODE**:
```Text
- Minimum:
  - At least 1 measure and 1 dimension.
- Axis & Roles:
  - Dimensions with Role=Category (or first dimension if no role) form the x-axis (category axis).
  - Dimensions with Role=Series form the cumulative data points (waterfall bars). Only one dimension allowed per role.
  - Measures form the y-axis (value axis).
  - Measures can be assigned roles (e.g., Axis2) to map to secondary axis.
- Legend:
  - By default the legend shows: the measure name and two groups "<0" and ">0".
  - If multiple measures are present, all measure names are shown in the legend instead of those groups.
- Waterfall intermediate/total markers:
  - Dimensions can support a waterfallType UID to mark intermediate totals/subtotals/total.
  - Valid waterfallType values:
    - null
    - subtotal:2  (combines the previous two data points and shows a subtotal column)
    - total      (combines all data points and shows a total column)
- Semantic coloring:
  - To enable semantic waterfall charts, add datapoint annotations (e.g., Criticality or CriticalityCalculation).
  - Semantic coloring is applied based on the datapoint annotation mapped to datapoints shown in the chart.
```

**STEP**: 2 — XML Annotation (OData annotations XML)

**DESCRIPTION**: Place this annotation in your OData annotations file (annotations.xml) or include it in your service annotation provider. Set Qualifier to reference the chart configuration if needed. This example configures a Waterfall chart with one measure (Finances) and two dimensions (SpendType as Category and Type as Series).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- annotations.xml or similar annotation provider file -->
<Annotation Term="UI.Chart" Qualifier="Waterfall_Eval_by_Country">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Revenue Waterfall" />
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Waterfall"/>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="Finances" />
                    <!-- Role can be UI.ChartMeasureRoleType/Axis2 to map to secondary axis -->
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="DimensionAttributes">
            <Collection>
                <Record Type="UI.ChartDimensionAttributeType">
                    <PropertyValue Property="Dimension" PropertyPath="SpendType" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
                </Record>
                <Record Type="UI.ChartDimensionAttributeType">
                    <PropertyValue Property="Dimension" PropertyPath="Type" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Series" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 3 — ABAP CDS Annotation example

**DESCRIPTION**: Use this block inside your ABAP CDS source or annotation include. Adjust the CDS view name and annotate the view (annotate view VIEWNAME with { }) to attach the chart qualifier to the view metadata. This config uses qualifier Waterfall_Eval_by_Country.

**LANGUAGE**: CDS

**CODE**:
```abap
@UI.Chart: [
  {
    title: 'Revenue Waterfall',
    chartType: #WATERFALL,
    measureAttributes: [
      {
        measure: 'Finances',
        role: #AXIS_2
      }
    ],
    dimensionAttributes: [
      {
        dimension: 'SpendType',
        role: #CATEGORY
      },
      {
        dimension: 'Type',
        role: #SERIES
      }
    ],
    qualifier: 'Waterfall_Eval_by_Country'
  }
]
annotate view VIEWNAME with { }
```

**STEP**: 4 — CAP (SAP Cloud Application Programming) CDS Annotation example

**DESCRIPTION**: Place this snippet in a CAP annotations file (e.g., annotations.cds) or in the same CDS model file where UI annotations are declared. Use the qualifier to reference the chart definition in Fiori UI.

**LANGUAGE**: CDS

**CODE**:
```cds
// annotations.cds (CAP)
UI.Chart #Waterfall_Eval_by_Country : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Revenue Waterfall',
    ChartType : #Waterfall,
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Finances,
            Role : #Axis2
        }
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : SpendType,
            Role : #Category
        },
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : Type,
            Role : #Series
        }
    ]
}
```

**STEP**: 5 — Implementation checklist and tips

**DESCRIPTION**: Quick actionable tips to validate and extend the chart behavior.

**LANGUAGE**: Text

**CODE**:
```Text
- Ensure the property names used in Measure and Dimension (Finances, SpendType, Type) are exposed in the OData model.
- If no dimension is explicitly marked with Role=Category, the first dimension is used as category axis.
- Only one dimension per role is supported; avoid multiple Category or Series roles.
- To make bars semantic (e.g., red/green), add datapoint annotations (Criticality/CriticalityCalculation) on the measure or calculated property used by the chart.
- Use the Qualifier (e.g., Waterfall_Eval_by_Country) to reference this chart configuration from cards or UI definitions.
- Test legend and multi-measure behavior: multiple measures show measure names; single-measure default grouping shows "<0" and ">0".
```
--------------------------------

**TITLE**: Quick Reference — Build SAP Fiori Elements Apps (List Report / Object Page)

**INTRODUCTION**: Practical, code-focused reference showing the minimal files and settings required to create a SAP Fiori Elements application (List Report / Object Page). Use these snippets to configure manifest.json, wire OData + annotation files, set template settings, and run locally. Ideal for AI code generation when scaffolding or modifying Fiori Elements apps.

**TAGS**: fiori-elements-framework, sap-fiori-elements, sapui5, manifest.json, annotations, odata, list-report, object-page, ui5

STEP: 1 — Project scaffold (concept)
DESCRIPTION: Create a Fiori Elements app using your preferred tool (Business Application Studio, SAP Fiori tools, or a Yeoman generator). Typical project root contains webapp/ with manifest.json and annotation files under webapp/annotations/. This step is conceptual — adjust to your chosen generator.
LANGUAGE: Shell
CODE:
```Shell
# Example conceptual commands (adjust for your environment/tooling)
# Use SAP Business Application Studio or any Fiori tools scaffold for "List Report/Object Page"
# Or a Yeoman generator if available in your environment.
# After scaffolding, proceed to edit the files shown below:
ls -la webapp
# webapp/
#   ├─ index.html
#   ├─ manifest.json
#   ├─ Component.js
#   ├─ annotations/
#   │    └─ annotations.xml
#   └─ i18n/
```

STEP: 2 — Minimal manifest.json for List Report / Object Page
DESCRIPTION: Configure the app to use the Fiori Elements template. Key sections: sap.app, sap.ui5 (models), sap.ui.generic.app (template/pages), dataSources for OData service and annotations. Place as webapp/manifest.json.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.app": {
    "id": "com.example.fiori.elements",
    "type": "application",
    "title": "Products (List Report / Object Page)",
    "applicationVersion": { "version": "1.0.0" }
  },
  "sap.ui5": {
    "models": {
      "i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "settings": { "bundleName": "com.example.fiori.elements.i18n.i18n" }
      },
      "": {
        "dataSource": "mainService",
        "preload": true
      }
    },
    "resources": { }
  },
  "sap.ui": {
    "technology": "UI5"
  },
  "sap.app": {},
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "entitySet": "Products",
            "tableType": "ResponsiveTable",
            "smartVariantManagement": true
          }
        }
      },
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "navigation": {}
          }
        }
      }
    ]
  },
  "sap.platform.hcp": {},
  "dataSources": {
    "mainService": {
      "uri": "/sap/opu/odata/sap/YY_PRODUCTS_SRV/",
      "type": "OData",
      "settings": { "odataVersion": "2.0" }
    },
    "annotations": {
      "uri": "annotations/annotations.xml",
      "type": "OData",
      "settings": { "localUri": "annotations/annotations.xml" }
    }
  }
}
```

STEP: 3 — Register annotation model in models (manifest snippet)
DESCRIPTION: Ensure the annotation file is registered as a model so the template resolves UI annotations at runtime. Place inside "sap.ui5/models" in manifest.json or as a separate entry if using UI5 model references.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      },
      "annotations": {
        "dataSource": "annotations",
        "settings": {
          "annotationURI": ["annotations/annotations.xml"]
        },
        "type": "sap.ui.model.odata.v2.ODataModel"
      }
    }
  }
}
```

STEP: 4 — Minimal OData annotations (XML)
DESCRIPTION: Provide UI annotations for the entity set referenced by the template. This example shows UI.LineItem (list columns) and UI.FieldGroup for object page header fields. Save as webapp/annotations/annotations.xml.
LANGUAGE: XML
CODE:
```XML
<edmx:Edmx Version="1.0" xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx">
  <edmx:Reference Uri="http://docs.oasis-open.org/odata/odata/v4/odata-annotated-metadata-xsd">
    <edmx:Include Namespace="Org.OData.Core.V1" Alias="Core"/>
  </edmx:Reference>
  <edmx:DataServices>
    <Schema Namespace="YY_PRODUCTS_SRV" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <Annotations Target="YY_PRODUCTS_SRV.Products">
        <Annotation Term="UI.HeaderInfo">
          <Record>
            <PropertyValue Property="TypeName" String="Product"/>
            <PropertyValue Property="Title" Path="Name"/>
          </Record>
        </Annotation>

        <Annotation Term="UI.LineItem">
          <Collection>
            <Record Type="UI.DataField">
              <PropertyValue Property="Value"><Path>ProductID</Path></PropertyValue>
            </Record>
            <Record Type="UI.DataField">
              <PropertyValue Property="Value"><Path>Name</Path></PropertyValue>
            </Record>
            <Record Type="UI.DataField">
              <PropertyValue Property="Value"><Path>Price</Path></PropertyValue>
            </Record>
          </Collection>
        </Annotation>

        <Annotation Term="UI.Facets">
          <Collection>
            <Record Type="UI.ReferenceFacet">
              <PropertyValue Property="ID" String="Facets1"/>
              <PropertyValue Property="Label" String="General"/>
              <PropertyValue Property="Target">
                <Record Type="UI.IntentBasedNavigation">
                  <!-- sample placeholder -->
                </Record>
              </PropertyValue>
            </Record>
          </Collection>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

STEP: 5 — Example Core Data Services (CDS) annotation snippet (optional)
DESCRIPTION: If your backend uses CDS, include UI annotations at the CDS source level. This shows a minimal CDS entity with UI annotations. Save in backend CDS sources; annotations are consumed by the OData service metadata.
LANGUAGE: CDS
CODE:
```CDS
namespace my.company;

using { cuid } from '@sap/cds/common';

entity Products : cuid {
  ProductID  : String(10);
  Name       : String(100);
  Price      : Decimal(13,2);
  locale     : String;
}

annotate Products with {
  @UI.lineItem: [
    { value: ProductID },
    { value: Name },
    { value: Price }
  ]
  @UI.headerInfo: {
    typeName: 'Product',
    title: Name
  }
}
```

STEP: 6 — Template settings (List Report options)
DESCRIPTION: Configure List Report behavior via "settings" in the manifest page component. Use these to change default table type, add QuickVariantSelection, or set selection mode.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "entitySet": "Products",
            "tableType": "ResponsiveTable",
            "showRowCount": true,
            "enableAutoBinding": true,
            "quickVariantSelection": {
              "variants": {
                "DEFAULT": { "key": "DEFAULT" }
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 7 — Run locally (UI5 tooling)
DESCRIPTION: Use UI5 tooling to run the app locally. Typical package.json scripts call ui5-server or ui5-tooling. Replace commands with your project’s scripts.
LANGUAGE: Shell
CODE:
```Shell
# Install dependencies (once)
npm install

# Start local UI5 server and open index.html (UI5 tooling must be installed/configured)
npx ui5 serve --open /index.html

# Or use package.json script if provided:
npm start
```

STEP: 8 — Extend behavior (extension points)
DESCRIPTION: For custom logic, use extension points—extend controller fragments or component. Keep extensions minimal; the bulk of UI is handled by Fiori Elements.
LANGUAGE: JavaScript
CODE:
```JavaScript
// Example: webapp/extension/ListReportExt.controller.js
sap.ui.define(["sap/ui/core/mvc/Controller"], function (Controller) {
  "use strict";
  return Controller.extend("com.example.fiori.elements.extension.ListReportExt", {
    onInit: function () {
      // custom initialization logic (use sparingly)
    }
  });
});
```

STEP: 9 — Considerations (trade-offs)
DESCRIPTION: Short, actionable guidance for decision-making:
- Initial setup effort is higher than freestyle SAPUI5 because you must define OData and annotation models.
- Gain: consistent UX, less UI code, enterprise-ready features (accessibility, translations, mobile).
- Use Fiori Elements when you want centralized, design-guideline-compliant apps and to maximize developer productivity across many apps.
LANGUAGE: JSON
CODE:
```JSON
{
  "considerations": {
    "initialEffort": "Higher vs freestyle UI5 due to OData/annotation setup",
    "benefits": [
      "Less UI coding",
      "Consistent SAP Fiori UX",
      "Built-in enterprise features (accessibility, translations, mobile)"
    ],
    "recommendedFor": "Teams building multiple business apps that benefit from shared templates and annotations"
  }
}
```
--------------------------------

**TITLE**: Working with UI Annotations — SAP Gateway, CDS, APC, Actions, and Field Control

**INTRODUCTION**: Practical, code-focused reference to discover, expose, register, and consume UI annotations for SAP Fiori applications. Includes sample HTTP requests to the Gateway catalog, sample OData annotation XML fragments, ABAP CDS UI annotation examples, and the required registry locations (SEGW, /IWBEP/REG_VOCAN, Catalog service). Use these snippets when generating code that reads or exposes UI annotations, registers Annotation Provider Classes (APC), maps actions to OData function imports, or implements field control.

**TAGS**: SAP, OData, annotations, CDS, SAP Gateway, Fiori, APC, /IWBEP/REG_VOCAN, SEGW, CATALOGSERVICE

STEP: 1 — Locate SAP vocabularies and annotation sources

DESCRIPTION: Where to find SAP-specific vocabularies and the annotation catalog. Use these locations when generating tooling or scripts that must discover or manipulate annotation sources.

LANGUAGE: Text

CODE:
```text
- SAP Gateway Service Builder (transaction SEGW) -> Extras -> Vocabulary Repository
- Register Annotation Provider Class (APC) in transaction /IWBEP/REG_VOCAN
- Gateway catalog service endpoint to query annotation providers and documents:
  /sap/opu/odata/IWFND/CATALOGSERVICE;v=2/
  Entity Set: 'Annotations'
- SAP Help Portal references: https://help.sap.com/viewer/p/SAP_NETWEAVER
- Note: Topic not updated for OData V4; most examples below assume OData V2-style annotation documents and SAP v2 compatibility APIs.
```

STEP: 2 — Query the Gateway catalog to list available annotation providers and documents

DESCRIPTION: Use HTTP (basic auth or SAP SSO) to query the Catalog service and retrieve annotation provider listings or a specific annotation document. Useful when generating code to collect annotation documents programmatically.

LANGUAGE: Shell / HTTP

CODE:
```http
# List all registered annotation entries (returns JSON or XML depending on Accept header)
curl -u <USER>:<PASS> \
  -H "Accept: application/json" \
  "https://<host>:<port>/sap/opu/odata/IWFND/CATALOGSERVICE;v=2/Annotations"

# Example: fetch a specific annotation document (replace <ID> with entry key from catalog)
curl -u <USER>:<PASS> \
  -H "Accept: application/xml" \
  "https://<host>:<port>/sap/opu/odata/IWFND/CATALOGSERVICE;v=2/Annotations('<ID>')/$value"
```

STEP: 3 — In-place annotations: how they appear in OData metadata

DESCRIPTION: In-place annotations are embedded in the service metadata ($metadata). When generating code that parses metadata, expect <Annotations> elements appended to targets (EntityTypes, Properties, EntitySets). Use these XML patterns to detect and extract UI-relevant terms (e.g., UI, Common).

LANGUAGE: XML

CODE:
```xml
<!-- Example: property-level annotation embedded inside $metadata -->
<Schema Namespace="MyServiceModel" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <EntityType Name="Product">
    <Key>
      <PropertyRef Name="ID" />
    </Key>
    <Property Name="ID" Type="Edm.String" Nullable="false" />
    <Property Name="Name" Type="Edm.String" />
    <Property Name="Price" Type="Edm.Decimal" />
  </EntityType>

  <!-- In-place annotations targeting the Product.Price property -->
  <Annotations Target="MyServiceModel.Product/Price" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="com.sap.vocabularies.UI.v1.IsReadOnly" Bool="true" />
    <!-- Or hide field using UI vocabulary -->
    <Annotation Term="com.sap.vocabularies.UI.v1.Hidden" Bool="true" />
  </Annotations>
</Schema>
```

STEP: 4 — Ex-place annotations (Annotation Provider Class, APC) and registration

DESCRIPTION: Ex-place annotations are provided by an APC outside the metadata document and bound to a service via /IWBEP/REG_VOCAN. When generating deployment or admin scripts, create entries in /IWBEP/REG_VOCAN that map service namespace to the APC class name. When producing runtime code, call the Catalog service to retrieve the APC-provided annotation documents.

LANGUAGE: Text / Example values

CODE:
```text
# Registration record fields to create/manage in /IWBEP/REG_VOCAN (create via transaction UI)
- Service namespace / service name: <SERVICE_NAMESPACE>
- Annotation Provider Class (APC): ZCL_MY_ANNOTATION_PROVIDER
- Description: "APC for exposing CDS UI annotations"
- Active: X

# After registration, the Catalog service will list an entry that references this APC.
# Tools should expect to download the annotation XML via:
GET /sap/opu/odata/IWFND/CATALOGSERVICE;v=2/Annotations('<ID>')/$value
```

STEP: 5 — Expose CDS UI annotations: ABAP CDS example

DESCRIPTION: Prefer CDS-based UI annotations in metadata extensions for reusability. Below is an ABAP CDS view example using UI annotation decorators. When generating code that reads CDS annotations or generates a metadata extension, use the same annotation keys and patterns.

LANGUAGE: ABAP CDS

CODE:
```abap
@AbapCatalog.sqlViewName: 'ZMYPRODVIEW'
@EndUserText.label: 'Product CDS View'
@AccessControl.authorizationCheck: #NOT_REQUIRED
@VDM.viewType: #BASIC
@UI.headerInfo: { typeName: 'Product', title: { value: 'Name' } }
@UI.lineItem: [
  { position: 10, label: 'ID', value: ID },
  { position: 20, label: 'Name', value: Name },
  { position: 30, label: 'Price', value: Price }
]
define view ZMY_Product
  as select from sepm_sddl_so_product   "example base table
{
  key Product as ID,
      ProductName as Name,
      Price
}
```

STEP: 6 — Generate OData annotation XML from CDS annotations (pattern)

DESCRIPTION: When CDS annotations are exposed via SAP Gateway / SADL, the platform converts CDS UI annotations into OData annotation documents (XML). Use this pattern to detect UI terms and to generate clients that consume the converted annotations.

LANGUAGE: XML

CODE:
```xml
<!-- Example annotation document produced for an entity set -->
<annotation:Edmx xmlns:annotation="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <annotation:Reference Uri="http://docs.oasis-open.org/odata/ns/edm"/>
  <annotation:Reference Uri="http://sap.com/Protocols/SAPData">
    <!-- OData annotation document structure containing UI vocabularies -->
  </annotation:Reference>

  <annotation:Annotations Target="MyServiceModel.Product">
    <annotation:Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
      <annotation:Collection>
        <annotation:Record>
          <annotation:PropertyValue Property="Label" String="ID"/>
          <annotation:PropertyValue Property="Value" Path="ID"/>
        </annotation:Record>
        <annotation:Record>
          <annotation:PropertyValue Property="Label" String="Name"/>
          <annotation:PropertyValue Property="Value" Path="Name"/>
        </annotation:Record>
      </annotation:Collection>
    </annotation:Annotation>
  </annotation:Annotations>
</annotation:Edmx>
```

STEP: 7 — Actions in UI: mapping to OData function imports

DESCRIPTION: UI actions (including draft-enabled actions like edit/save/cancel) must have corresponding implementations in the OData service. Generate metadata that includes FunctionImport entries (OData V2) or Action elements (OData V4). BOPF handles draft flows, but application-specific actions must be implemented server-side.

LANGUAGE: XML (OData metadata snippet)

CODE:
```xml
<!-- OData V2-style FunctionImport example (service $metadata) -->
<FunctionImport Name="ApproveProduct" ReturnType="Edm.Boolean" EntitySet="Products" m:HttpMethod="POST" sap:action-for="MyServiceModel.Product">
  <!-- Implement server-side behavior in your OData service -->
</FunctionImport>

<!-- OData V4 Action example -->
<Action Name="ApproveProduct">
  <Parameter Name="ProductID" Type="Edm.String" />
  <Annotation Term="Org.OData.Core.V1.IsBound" Bool="true" />
  <ReturnType Type="Edm.Boolean" />
</Action>
```

STEP: 8 — Field control: static + dynamic control via annotations and entity properties

DESCRIPTION: Field control can be static (in metadata) or dynamic (driven by entity properties). The OData service should expose the field control information either as annotations in metadata or as properties/paths that UI consumes at runtime. When generating clients, check both $metadata Annotations and runtime entity properties for field-control values.

LANGUAGE: XML

CODE:
```xml
<!-- Property-level field-control annotation (metadata) -->
<Property Name="Price" Type="Edm.Decimal">
  <!-- Static: annotation directly on property -->
  <Annotation Term="com.sap.vocabularies.UI.v1.IsReadOnly" Bool="false" />
  <!-- Dynamic: point to an entity property that carries the field control -->
  <Annotation Term="com.sap.vocabularies.Common.v1.FieldControl" Path="PriceFieldControl" />
</Property>

<!-- Example entity instance showing dynamic field control property -->
<Product>
  <ID>123</ID>
  <Name>Example</Name>
  <Price>49.95</Price>
  <!-- PriceFieldControl: e.g., 0 = editable, 1 = read-only, 2 = hidden (implementation-defined) -->
  <PriceFieldControl>1</PriceFieldControl>
</Product>
```

STEP: 9 — Best practices and recommendations for code generation

DESCRIPTION: Consolidated, action-oriented guidance when generating tools or applications that work with UI annotations.

LANGUAGE: Text

CODE:
```text
- Prefer CDS annotations in metadata extensions; expose via SAP Gateway/SADL to generate standard OData annotation XML.
- Use the Gateway Catalog (/sap/opu/odata/IWFND/CATALOGSERVICE;v=2/Annotations) to discover APC-provided annotation documents.
- For APC registration, create records in transaction /IWBEP/REG_VOCAN with APC class name and service namespace.
- When implementing actions, map each UI action to an OData FunctionImport (V2) or Action (V4) and implement server-side business logic (BOPF for drafts).
- For field control, support both static metadata annotations and dynamic entity properties; generate client code that checks both $metadata annotations and runtime values.
- Maintain annotation lifecycle in the backend: store annotations with the same lifecycle as the data model (CDS + metadata extension recommended).
- Consult SAP Help Portal for SAP-ABAP Programming Model for SAP Fiori and CDS Annotations: https://help.sap.com/viewer/p/SAP_NETWEAVER
```

STEP: 10 — Useful links and references (for generated documentation metadata)

DESCRIPTION: Preserve original reference links for deeper documentation lookups.

LANGUAGE: Text

CODE:
```text
- SAP Gateway Service Builder (SEGW) -> Vocabulary Repository
- APC registration: transaction /IWBEP/REG_VOCAN
- Catalog service: /sap/opu/odata/IWFND/CATALOGSERVICE;v=2/ (EntitySet 'Annotations')
- SAP Annotations for OData Version 2.0 (SAP-specific vocabularies): https://sap.github.io/odata-vocabularies/docs/v2-annotations.html
- SAP Help Portal: https://help.sap.com/viewer/p/SAP_NETWEAVER
- Actions reference (internal doc): Actions (actions-cbf16c5.md)
```
--------------------------------

**TITLE**: Worklist (Fiori Elements) — quick configuration guide and manifest examples

**INTRODUCTION**: This document explains how to create and configure a Worklist floorplan in SAP Fiori Elements (OData V2/V4). It focuses on the exact manifest.json settings you will change to enable variant management and table defaults for a worklist generated with the SAP Fiori application generator. Use this as a concise reference for code-level edits.

**TAGS**: fiori-elements, worklist, manifest.json, variantManagement, smartVariantManagement, smartTable, ODataV2, ODataV4

STEP: 1 — Create the Worklist application
DESCRIPTION: Generate a new Fiori Elements application and choose the Worklist Page template in the Template Selection step. You can run the SAP Fiori application generator (CLI) or use the SAP Web IDE / BAS wizard.
LANGUAGE: Shell
CODE:
```bash
# Example: run the Fiori application generator via the Yeoman generator
# This command launches the generator; then choose the "Worklist Page" template when prompted.
npx -p @sap/generator-fiori yo @sap/generator-fiori
```

STEP: 2 — Enable variant management at table level (manifest.json)
DESCRIPTION: To show variant management for the table (table-level variants), edit your application's manifest.json. Set variantManagementHidden to false inside the page component settings. This example shows a typical place in the descriptor where page/component settings live.
LANGUAGE: JSON
CODE:
```json
// manifest.json (fragment) - OData V2 / V4 worklist page
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport", 
          "settings": {
            "variantManagementHidden": false
          }
        }
      }
    ]
  }
}
```

STEP: 3 — Enable page-level variant management (manifest.json)
DESCRIPTION: To enable page-level variant management (shareable variants across the page), set smartVariantManagement to true and ensure variantManagementHidden is false. Place both flags in the same component settings block.
LANGUAGE: JSON
CODE:
```json
// manifest.json (fragment) - enable page-level variant management
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "smartVariantManagement": true,
            "variantManagementHidden": false
          }
        }
      }
    ]
  }
}
```

STEP: 4 — Configure default table behavior for Worklist
DESCRIPTION: The Worklist uses a simplified list report table. Typical defaults and relevant notes:
- Multiselect is enabled by default for worklist tables (allows processing multiple items).
- Default table type: Responsive table (table title shows row count).
- Fixed layout and scroll-to-load are default behaviors for table content.
- Export to Microsoft Excel is not available for worklist tables.
- Execute on Select action is not available.

Use the following manifest fragment to state table preferences (place under the same component settings). Note: property names below are the recommended logical settings to document intent. Depending on your SAPUI5/Fiori Elements version, control-specific configuration can also be added under controlConfiguration (see product docs).
LANGUAGE: JSON
CODE:
```json
// manifest.json (fragment) - table settings and intent
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "tableType": "ResponsiveTable",    // default table type for Worklist
            "multiSelect": true,              // multiselect enabled for Worklist tables
            "showRowCount": true,             // table title contains the row count
            "fixedLayout": true,              // fixed layout for table content
            "scrollToLoad": true              // scroll-to-load enabled
          }
        }
      }
    ]
  }
}
```

STEP: 5 — Worklist specific feature notes (V2 and V4)
DESCRIPTION: Keep these behavior notes in mind when implementing or troubleshooting worklists:
- A Worklist is a simplified List Report that does not include a SmartFilterBar. The search field is located in the table toolbar.
- Variant management: default hidden; enable via variantManagementHidden = false. For page-level (shared) variants, also set smartVariantManagement = true.
- Multiselect is enabled by default; if a table contains only line-item actions the table may be configured as no-selection by the template.
- Execute on Select action is not available in Worklist floorplan.
- Export to Excel is not available for Worklist tables.
- For OData V4 the same conceptual settings apply — configure the same manifest.json flags under the sap.ui.generic.app pages/component settings for your V4 worklist.

LANGUAGE: JSON
CODE:
```json
// manifest.json (final checklist fragment) - verify these flags exist as needed
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "variantManagementHidden": false,
            "smartVariantManagement": true,
            "tableType": "ResponsiveTable",
            "multiSelect": true
          }
        }
      }
    ]
  }
}
```

STEP: 6 — Further configuration and extension links
DESCRIPTION: For advanced configuration, navigation setup, and extending list/report pages (annotations, table columns, custom actions), consult these capabilities in your project:
- Configuring List Report Features (filtering, selection, actions)
- Configuring Navigation (cross-app navigation and intent-based)
- Configuring Tables (column settings, controlConfiguration)
- Extending List Reports and Object Pages Using App Extensions

LANGUAGE: TEXT
CODE:
```text
# References (use product docs for your Fiori Elements version)
- Building an App / Fiori generator: use "Worklist Page" template
- List Report and Object Page configuration topics in SAP Fiori Elements docs
- Configuring Filter Bars (not applicable for Worklist: no SmartFilterBar)
- Defining Multiple Views on a List Report Table for category worklists
```
--------------------------------
