
--------------------------------

**TITLE**: Actions — annotated examples and manifest configurations for SAP Fiori elements (OData V2 / V4)

**INTRODUCTION**: Practical, code-focused examples and configuration snippets for implementing generic and application-specific actions in SAP Fiori elements: intent-based navigation, OData actions (bound/unbound/static), invocation grouping, default value provisioning, action parameter layout and hiding, menus, manifest-based overrides, priorities, overflow grouping, separators, and extension hooks. Use these snippets directly in annotation files, CDS models, service code, and manifest.json overrides.

**TAGS**: fiori-elements-framework, actions, annotations, manifest.json, UI.DataFieldForAction, UI.DataFieldForIntentBasedNavigation, CDS, CAP, ABAP, OData, defaultValuesFunction

STEP: Context-independent and context-dependent external navigation (UI.DataFieldForIntentBasedNavigation)

DESCRIPTION: Use these annotation patterns to define navigation buttons that either require a selected context (RequiresContext=true) or pass the available context (RequiresContext=false). Use the correct syntax for XML annotations, ABAP CDS, and CAP CDS.

LANGUAGE: XML
CODE:
```xml
<!-- Context-independent (RequiresContext=false) -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
  <PropertyValue Property="Label" String="Navigation Tester (no context)"/>
  <PropertyValue Property="SemanticObject" String="Object"/>
  <PropertyValue Property="Action" String="Action"/>
  <PropertyValue Property="RequiresContext" Bool="false"/>
</Record>

<!-- Context-dependent (RequiresContext=true) -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
  <PropertyValue Property="Label" String="Navigation Tester (requires context)"/>
  <PropertyValue Property="SemanticObject" String="Object"/>
  <PropertyValue Property="Action" String="Action"/>
  <PropertyValue Property="RequiresContext" Bool="true"/>
</Record>
```

LANGUAGE: ABAP CDS
CODE:
```abap
{
  label: 'Navigation Tester (no context)',
  semanticObject: 'Object',
  semanticObjectAction: 'Action',
  requiresContext: false,
  type: #FOR_INTENT_BASED_NAVIGATION
}
```

LANGUAGE: CAP CDS
CODE:
```json
{
  "$Type": "UI.DataFieldForIntentBasedNavigation",
  "Label": "Navigation Tester (no context)",
  "SemanticObject": "Object",
  "Action": "Action",
  "RequiresContext": false
}
```

STEP: Define OData action button with invocation grouping (UI.DataFieldForAction InvocationGrouping)

DESCRIPTION: Control how multiple invocations for multi-selected rows are grouped: Isolated (separate changesets) or ChangeSet (all in one changeset). Use XML annotation, ABAP CDS mimic, and CAP CDS.

LANGUAGE: XML
CODE:
```xml
<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="Label" String="My Action"/>
  <PropertyValue Property="Action" String="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrder_WD_20_SRV_Entities/C_STTA_SalesOrder_WD_20My_FunctionImport"/>
  <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/Isolated"/>
</Record>
```

LANGUAGE: ABAP CDS
CODE:
```abap
{
  label: 'My Action',
  dataAction: 'PUSHDOWN:C_STTA_SalesOrder_WD_20My_FunctionImport',
  invocationGrouping: #ISOLATED,
  type: #FOR_ACTION,
  position: 1
}
```

LANGUAGE: CAP CDS
CODE:
```json
{
  "$Type": "UI.DataFieldForAction",
  "Label": "My Action",
  "Action": "STTA_SALES_ORDER_WD_20_SRV.STTA_SALES_ORDER_WD_20_SRV_Entities/C_STTA_SalesOrder_WD_20My_FunctionImport",
  "InvocationGrouping": "#Isolated"
}
```

STEP: Prefill action parameters from back end using Common.DefaultValuesFunction (FunctionImport + service code + manifest hook)

DESCRIPTION: Annotate the action with Common.DefaultValuesFunction referencing a backend function that returns default values for action parameters; implement the backend logic (CAP srv handler example); optionally override or supply defaults from the frontend using manifest defaultValuesFunction.

LANGUAGE: XML
CODE:
```xml
<!-- FunctionImport definition -->
<FunctionImport Name="GetDefaultsForSetText"
    ReturnType="cds_zrc_dv_defaultvalues.ZRC_DV_A_SetText"
    m:HttpMethod="GET"
    sap:action-for="cds_zrc_dv_defaultvalues.RootType">
  <Parameter Name="UUID" Type="Edm.Guid" Mode="In"/>
</FunctionImport>

<!-- Annotate action to use the default values function -->
<Annotations Target="cds_zrc_dv_defaultvalues.cds_zrc_dv_defaultvalues_Entities/SetText">
  <Annotation Term="com.sap.vocabularies.Common.v1.DefaultValuesFunction" String="GetDefaultsForSetText"/>
</Annotations>
```

LANGUAGE: CAP CDS (service type for returned complex type)
CODE:
```json
// service type: default params structure (example snippet in CDS projection)
{
  "type": "defaultParamsForSalesOrderCreate",
  "elements": {
    "SalesOrderType": { "$Type": "String" },
    "OverallSDProcessStatus": { "$Type": "String" },
    "LastChangedDateTime": { "$Type": "Timestamp" }
  }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// srv implementation (CAP) - return default param values for an action
srv.on("GetDefaultParamsForCustomAction", "SalesOrderManage", async req => {
  const tx = cds.transaction(req);
  const salesOrderItem = await tx.run(SELECT.one.from(SalesOrderManage).where(req.query.SELECT.from.ref[0].where));
  if (!salesOrderItem) throw new Error("Not found");
  const overallSDProcessStatus = salesOrderItem.OverallSDProcessStatus;
  const currentDateTime = new Date().toISOString();
  return {
    OverallSDProcessStatus: overallSDProcessStatus,
    SalesOrderType: "SE",
    LastChangedDateTime: currentDateTime
  };
});
```

LANGUAGE: JSON
CODE:
```json
// manifest.json snippet: front-end extension to compute default values
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "actions": {
                    "DataFieldForAction::com.c_salesordermanage_sd.CreateWithSalesOrderType": {
                      "defaultValuesFunction": "SalesOrder.ext.CustomActions.getDefaultValues"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// Custom front-end extension function referenced above (CustomActions.js)
getDefaultValues: function (oContext, aSelectedContexts) {
  if (aSelectedContexts.length > 1) {
    return { "SalesOrderType": "SO03", "SalesOrganization": "1111" };
  } else {
    return { "SalesOrderType": "SE", "SalesOrganization": "", "DistributionChannel": "03" };
  }
}
```

STEP: Enable/disable actions using Core.OperationAvailable (static true or dynamic path)

DESCRIPTION: Use Core.OperationAvailable to control enablement: Bool="true" (always enabled), or Path="PropertyName" to evaluate enablement dynamically. Show XML and CAP CDS annotate syntax.

LANGUAGE: XML
CODE:
```xml
<!-- Always enabled -->
<Annotations Target="SAP__self.CreateWithSalesOrderType">
  <Annotation Term="SAP__Core.OperationAvailable" Bool="true"/>
</Annotations>

<!-- Dynamic enablement via path -->
<Annotations Target="SAP__self.CreateWithSalesOrderType">
  <Annotation Term="SAP__Core.OperationAvailable" Path="Delivered"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
// CAP inline annotation using annotate
annotate SAP__self.CreateWithSalesOrderType with {
  Core.OperationAvailable : Delivered
};
```

STEP: Bound vs Unbound actions (metadata action definition + DataFieldForAction reference)

DESCRIPTION: Define action metadata (IsBound true/false), then reference bound/unbound actions in UI.DataFieldForAction. Provide XML action definitions and UI references; include CAP CDS action examples.

LANGUAGE: XML
CODE:
```xml
<!-- Action metadata: bound and unbound -->
<Action Name="REUNION" IsBound="true">
  <Parameter Name="_it" Type="com.namespace.ArtistsType" Nullable="false" />
  <ReturnType Type="com.namespace.ArtistsType" Nullable="false" />
</Action>

<Action Name="UnboundAction" IsBound="false">
  <ReturnType Type="com.namespace.ArtistsType" Nullable="false" />
</Action>

<!-- UI reference to a bound action -->
<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="Label" String="Reunion" />
  <PropertyValue Property="Action" String="com.namespace.REUNION" />
</Record>

<!-- UI reference to an unbound action -->
<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="Label" String="Break Up" />
  <PropertyValue Property="Action" String="com.namespace.MyContainer/BREAK_ACTION" />
</Record>
```

LANGUAGE: CAP CDS
CODE:
```cds
entity entityName as projection on db.baseEntity {
  actions {
    action REUNION(_it: $self) returns Artists;
  }
}

action UnboundAction() returns Artists;

// UI annotation example for bound/unbound actions in CAP CDS-style JSON
{
  "$Type": "UI.DataFieldForAction",
  "Label": "Bound Action",
  "Action": "com.namespace.REUNION"
},
{
  "$Type": "UI.DataFieldForAction",
  "Label": "Unbound Action",
  "Action": "com.namespace.EntityContainer/UnboundAction"
}
```

STEP: Static actions (IsBound with collection _it parameter) and UI reference

DESCRIPTION: Define a static action whose binding parameter is a collection (header context of the collection will be passed). Show XML action definition and DataFieldForAction reference and CAP CDS equivalent.

LANGUAGE: XML
CODE:
```xml
<!-- Static action definition: _it parameter typed as Collection(...) -->
<Action Name="createActiveTravel" EntitySetPath="_it" IsBound="true">
  <Parameter Name="_it" Type="Collection(com.namespace.TravelType)"/>
  <ReturnType Type="com.namespace.TravelType" Nullable="false"/>
</Action>

<!-- UI reference to call the static action -->
<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="Label" String="Static Action"/>
  <PropertyValue Property="Action" String="com.c_salesordermanage_sd.myCreateAction(com.c_salesordermanage_sd.SalesOrderManage)"/>
</Record>
```

LANGUAGE: CAP CDS
CODE:
```cds
entity Travel as projection on db.Travel actions {
  action createActiveTravel(_it: many $self) returns Travel;
}

// UI annotation (CAP CDS JSON-style)
{
  "$Type": "UI.DataFieldForAction",
  "Label": "Static Action",
  "Action": "TravelService.createActiveTravel(TravelService.Travel)"
}
```

STEP: Action parameters (single values, collections) and UI.OperationParameterFacets (grouping in dialog)

DESCRIPTION: Define action parameters in metadata (XML or CDS), annotate parameters for labels/mandatory and group parameters in the action parameter dialog using UI.OperationParameterFacets and UI.FieldGroup. Provide XML and CAP CDS examples.

LANGUAGE: XML
CODE:
```xml
<!-- Action with parameters (single values and collection param) -->
<Action Name="CreateWithSalesOrderType" EntitySetPath="_it" IsBound="true">
  <Parameter Name="_it" Type="Collection(com.namespace.SalesOrderManageType)" Nullable="false"/>
  <Parameter Name="SalesOrderType" Type="Edm.String" Nullable="false" MaxLength="4"/>
  <Parameter Name="SalesOrganization" Type="Edm.String" Nullable="false" MaxLength="4"/>
  <ReturnType Type="com.namespace.SalesOrderManageType" Nullable="false"/>
</Action>

<!-- Annotation to group parameters in dialog -->
<Annotations Target="com.namespace.CreateWithSalesOrderType(com.namespace.SalesOrderManage)">
  <Annotation Term="UI.OperationParameterFacets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="First Parameter Group"/>
        <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#FirstGroup"/>
      </Record>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Second Parameter Group"/>
        <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SecondGroup"/>
      </Record>
    </Collection>
  </Annotation>

  <Annotation Term="UI.FieldGroup" Qualifier="FirstGroup">
    <Record Type="UI.FieldGroupType">
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="UI.DataField"><PropertyValue Property="Value" Path="SalesOrderType"/></Record>
          <Record Type="UI.DataField"><PropertyValue Property="Value" Path="SalesOrganization"/></Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <Annotation Term="UI.FieldGroup" Qualifier="SecondGroup">
    <Record Type="UI.FieldGroupType">
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="UI.DataField"><PropertyValue Property="Value" Path="OrganizationDivision"/></Record>
          <Record Type="UI.DataField"><PropertyValue Property="Value" Path="DistributionChannel"/></Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
@UI : {
  OperationParameterFacets: [
    {
      $Type : 'UI.ReferenceFacet',
      Label : 'First Parameter Group',
      Target: '@UI.FieldGroup#FirstGroup'
    },
    {
      $Type : 'UI.ReferenceFacet',
      Label : 'Second Parameter Group',
      Target: '@UI.FieldGroup#SecondGroup'
    }
  ],
  FieldGroup #FirstGroup  : {
    $Type: 'UI.FieldGroupType',
    Data : [
      { $Type: 'UI.DataField', Value: SalesOrderType },
      { $Type: 'UI.DataField', Value: SalesOrganization }
    ]
  },
  FieldGroup #SecondGroup : {
    $Type: 'UI.FieldGroupType',
    Data : [
      { $Type: 'UI.DataField', Value: OrganizationDivision },
      { $Type: 'UI.DataField', Value: DistributionChannel }
    ]
  }
}
action CreateWithSalesOrderType(
  SalesOrderType : String(4) not null,
  SalesOrganization : String(4) not null,
  OrganizationDivision : String(2) not null,
  DistributionChannel : String(2) not null
) returns SalesOrderManage;
```

STEP: Parameter default values (ParameterDefaultValue, FLP user defaults, back-end function precedence)

DESCRIPTION: Provide ParameterDefaultValue annotations (path or fixed string). Evaluation order: ParameterDefaultValue first, then FLP user defaults, then backend DefaultValuesFunction. Example XML and CAP CDS annotations.

LANGUAGE: XML
CODE:
```xml
<!-- ParameterDefaultValue: path and fixed string -->
<Annotations Target="SalesOrder.CreateWithSalesOrderType/SalesOrderType">
  <Annotation Term="UI.ParameterDefaultValue" Path="_it/SalesOrderType"/>
</Annotations>
<Annotations Target="SalesOrder.CreateWithSalesOrderType/SalesOrganization">
  <Annotation Term="UI.ParameterDefaultValue" String="0001"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate SalesOrder.CreateWithSalesOrderType with {
  UI.ParameterDefaultValue : _it.SalesOrderType SalesOrderType;
};

annotate SalesOrder.CreateWithSalesOrderType with {
  UI.ParameterDefaultValue : '0001' SalesOrganization;
};
```

STEP: Hide action parameters (UI.Hidden: Bool, Path, dynamic expression / $edmJson)

DESCRIPTION: Hide parameters with UI.Hidden using Bool, a path to a boolean property, or a dynamic expression. If all parameters are hidden and mandatory fields have defaults, action executes without dialog.

LANGUAGE: XML
CODE:
```xml
<Action Name="actionWithHiddenParameters" IsBound="true">
  <Parameter Name="_it" Type="sap.fe.manageitems.TechnicalTestingService.LineItems"/>
  <Parameter Name="myParameterHiddenFalse" Type="Edm.String"/>
  <Parameter Name="myParameterHiddenTrue" Type="Edm.String"/>
  <Parameter Name="myParameterHiddenDynamicPath" Type="Edm.String"/>
  <Parameter Name="myParameterHiddenDynamicExp" Type="Edm.String"/>
</Action>

<Annotations Target=".../actionWithHiddenParameters(...)/myParameterHiddenFalse">
  <Annotation Term="UI.Hidden" Bool="false"/>
  <Annotation Term="Common.Label" String="Testparameter (Hidden=false)"/>
</Annotations>

<Annotations Target=".../actionWithHiddenParameters(...)/myParameterHiddenTrue">
  <Annotation Term="UI.Hidden" Bool="true"/>
  <Annotation Term="Common.Label" String="Testparameter (Hidden=true)"/>
</Annotations>

<Annotations Target=".../actionWithHiddenParameters(...)/myParameterHiddenDynamicPath">
  <Annotation Term="UI.Hidden" Path="_it/preferredItem"/>
  <Annotation Term="Common.Label" String="Testparameter (Hidden=Dynamic via path)"/>
</Annotations>

<Annotations Target=".../actionWithHiddenParameters(...)/myParameterHiddenDynamicExp">
  <Annotation Term="UI.Hidden">
    <If>
      <Eq>
        <Path>myParameterHiddenFalse</Path>
        <String>Show myParameterHiddenDynamicExp parameter</String>
      </Eq>
      <Bool>false</Bool>
      <Bool>true</Bool>
    </If>
  </Annotation>
  <Annotation Term="Common.Label" String="Testparameter (Hidden=Dynamic via expression)"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
@cds.odata.bindingparameter.name : '_it'
action actionWithHiddenParameters(
  @title : 'Testparameter (Hidden=false)'
  @UI.Hidden : false
  myParameterHiddenFalse : String,

  @title : 'Testparameter (Hidden=true)'
  @UI.Hidden : true
  myParameterHiddenTrue : String,

  @title : 'Testparameter (Hidden=Dynamic via path)'
  @UI.Hidden : _it.preferredItem
  myParameterHiddenDynamicPath : String,

  @title : 'Testparameter (Hidden=Dynamic via expression)'
  @UI.Hidden : {$edmJson: {$If: [{$Eq: [{$Path: 'myParameterHiddenFalse'}, 'Show myParameterHiddenDynamicExp parameter']}, false, true]}}
  myParameterHiddenDynamicExp : String
);
```

STEP: Group actions as menu buttons (UI.DataFieldForActionGroup) — annotation and manifest patterns

DESCRIPTION: Create menu groups via UI.DataFieldForActionGroup annotations or via manifest.json overrides. Examples for XML annotation group and manifest configuration for header, form, and table toolbars. Also show how to push intent-based navigation buttons into menu keys and set a defaultAction.

LANGUAGE: XML
CODE:
```xml
<!-- Annotation-based action group -->
<Record Type="UI.DataFieldForActionGroup">
  <PropertyValue Property="Label" String="Action Group" />
  <PropertyValue Property="ID" String="groupedActions" />
  <PropertyValue Property="Actions">
    <Collection>
      <Record Type="UI.DataFieldForAction">
        <PropertyValue Property="Label" String="Action 1 inside Action Group" />
        <PropertyValue Property="Action" String="com.c_salesordermanage_sd.SalesOrderManage.Action1"/>
      </Record>
      <Record Type="UI.DataFieldForAction">
        <PropertyValue Property="Label" String="Action 2 inside Action Group" />
        <PropertyValue Property="Action" String="com.c_salesordermanage_sd.SalesOrderManage.Action2"/>
      </Record>
      <Record Type="UI.DataFieldForAction">
        <PropertyValue Property="Label" String="Action 3 inside Action Group" />
        <PropertyValue Property="Action" String="com.c_salesordermanage_sd.SalesOrderManage.Action3"/>
      </Record>
    </Collection>
  </PropertyValue>
</Record>
```

LANGUAGE: JSON
CODE:
```json
// Manifest: grouping header actions and using menu (example extract)
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "content": {
        "header": {
          "actions": {
            "myFirstAction": {
              "press": "SalesOrder.ext.CustomActions.message",
              "text": "My First Action"
            },
            "mySecondAction": {
              "press": "SalesOrder.ext.CustomActions.message",
              "text": "My Second Action"
            },
            "MenuActions": {
              "text": "My Menu Button",
              "menu": [
                "myFirstAction",
                "mySecondAction",
                "DataFieldForAction::com.c_salesordermanage_sd.BoundActionWithParams"
              ]
            }
          }
        }
      }
    }
  }
}
```

LANGUAGE: JSON
CODE:
```json
// manifest: pushing an intent-based navigation button into the menu (use semantic object and action)
"MenuActions": {
  "text": "My Menu Button",
  "menu": [
    "myFirstAction",
    "DataFieldForIntentBasedNavigation::SalesOrder::manageInline"
  ]
}

// manifest: define default action for a menu
"MenuActionsCreateFromTemplate": {
  "text": "Usage Example of a defaultAction",
  "defaultAction": "DataFieldForIntentBasedNavigation::SalesOrder::defaultActionToBeCalled",
  "menu": [
    "DataFieldForAction::com.c_salesordermanage_sd.CreateFromCustomer",
    "DataFieldForAction::com.c_salesordermanage_sd.CreateFromSalesOrder",
    "DataFieldForIntentBasedNavigation::SalesOrder::manageInline"
  ]
}
```

STEP: Priority, overflow grouping, separators (manifest.json properties)

DESCRIPTION: Set visual priority behavior with priority property, group actions so they move together using overflowGroup, and show separators before groups using overflowGroups manifest entries.

LANGUAGE: JSON
CODE:
```json
// manifest: priority and overflowGroup usage
"PurchaseOrder": {
  "type": "Component",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "content": {
        "header": {
          "actions": {
            "MyCustomAction": {
              "text": "CustomActionText",
              "press": "Extension.handler",
              "priority": "AlwaysOverflow"
            }
          }
        }
      },
      "controlConfiguration": {
        "@com.sap.vocabularies.UI.v1.FieldGroup#GeneralInformation": {
          "actions": {
            "MyFormAction": {
              "priority": "Low"
            }
          }
        },
        "_Elements/@com.sap.vocabularies.UI.v1.LineItem": {
          "actions": {
            "TableCustomAction": {
              "priority": "NeverOverflow"
            }
          }
        }
      }
    }
  }
}

// manifest: overflow group and separators example
"actions": {
  "MyCustomAction1": {
    "text": "Approve",
    "priority": "Medium",
    "overflowGroup": 1
  },
  "MyCustomAction2": {
    "text": "Reject",
    "overflowGroup": 1
  },
  "MyCustomAction3": {
    "text": "Export",
    "overflowGroup": 2
  }
},
"overflowGroups": {
  "1": { "showSeparator": true },
  "2": { "showSeparator": true }
}
```

STEP: Override annotation-based enablement / visibility via manifest and implement extension handlers (controlConfiguration)

DESCRIPTION: Override annotation enablement (Core.OperationAvailable) and visibility (UI.Hidden) using manifest.controlConfiguration for actions. Use extension functions to compute enabled/visible. Example manifest snippet and CustomActions.js function.

LANGUAGE: JSON
CODE:
```json
// manifest.json: override annotation-based action enablement/visibility
"controlConfiguration": {
  "@com.sap.vocabularies.UI.v1.LineItem": {
    "actions": {
      "DataFieldForAction::com.c_salesordermanage_sd.CreateWithSalesOrderType": {
        "enabled": "SalesOrder.ext.CustomActions.enabledIfTwoSelected",
        "visible": "SalesOrder.ext.CustomActions.visibleIfAConditionIsTrue"
      }
    }
  }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// CustomActions.js: manifest-referenced handler functions
enabledIfTwoSelected: function (oBindingContext, aSelectedContexts) {
  return aSelectedContexts && aSelectedContexts.length === 2;
},
visibleIfAConditionIsTrue: function (oBindingContext, aSelectedContexts) {
  // compute and return boolean
  return true; // replace with real condition
}
```

STEP: Override annotation-based action groups using manifest keys (DataFieldForActionGroup::ID) — add/remove menu items

DESCRIPTION: Address an annotation action group by key DataFieldForActionGroup::groupId and override the menu list. Example: adding a new custom action into an annotation-based action group.

LANGUAGE: JSON
CODE:
```json
// manifest.json: add new actions to an annotation-based action group
"options": {
  "settings": {
    "contextPath": "/SalesOrderManage",
    "controlConfiguration": {
      "@com.sap.vocabularies.UI.v1.FieldGroup#OrderData": {
        "actions": {
          "myFirstAction": {
            "press": "SalesOrder.ext.CustomActions.getCustomerName",
            "visible": true,
            "enabled": true,
            "text": "My First Action"
          },
          "DataFieldForActionGroup::groupedActions": {
            "menu": [
              "DataFieldForAction::com.c_salesordermanage_sd.SalesOrderManage.Action1",
              "DataFieldForAction::com.c_salesordermanage_sd.SalesOrderManage.Action2",
              "DataFieldForAction::com.c_salesordermanage_sd.SalesOrderManage.Action3",
              "myFirstAction",
              "DataFieldForAction::com.c_salesordermanage_sd.SalesOrderManage.AnnotationAction"
            ]
          }
        }
      }
    }
  }
}
```

STEP: File upload as action parameter (stream support)

DESCRIPTION: Configure bound or unbound actions to accept file uploads as parameters. See the Enabling Stream Support topic and the upload attribute subsection for required OData configuration and annotations.

LANGUAGE: Markdown
CODE:
```text
See: Enabling Stream Support -> File Upload as an Action Parameter
File: enabling-stream-support-b236d32.md#loiob236d32d48b74304887b3dd5163548c1__subsection_upload_attribute
```

Step: References for finding keys and related pages

DESCRIPTION: Use the manifest keys and DataField prefixes as shown in examples: DataFieldForAction::..., DataFieldForIntentBasedNavigation::SemanticObject::Action, DataFieldForActionGroup::groupId. Refer to related documentation pages listed in original content for deeper behavior.

LANGUAGE: Markdown
CODE:
```text
Related docs (internal links from original content):
- adding-actions-to-tables-b623e0b.md
- adding-custom-actions-using-extension-points-7619517.md
- enabling-stream-support-b236d32.md
- prefilling-fields-using-the-defaultvaluesfunction-5ada91c.md
- configuring-navigation-a424275.md
- finding-the-right-key-for-the-anchor-6ffb084.md
```
--------------------------------

**TITLE**: Actions in the List Report — annotations and manifest changes for toolbar/global actions

**INTRODUCTION**: This document collects concise, code-first examples and configuration snippets for implementing and customizing actions in SAP Fiori elements List Report pages (table toolbar, global actions, standard actions such as Create, Copy, Delete), covering OData V2 and V4 specifics, manifest settings, and annotations.

**TAGS**: fiori-elements-framework, list-report, actions, annotations, manifest.json, odata-v2, odata-v4, copy-action, create-action, draft

STEP: Add a Copy action as a UI.LineItem annotation (XML)
DESCRIPTION: Define a DataFieldForAction in the entity UI.LineItem annotation and mark it with UI.IsCopyAction to render a Copy button (placed after Create by default). Replace the Action value with your function import/operation path.
LANGUAGE: XML
CODE:
```xml
<!-- Add to the entity type annotations (e.g. in annotations.xml or metadata) -->
<Annotation Term="UI.LineItem">
  <Collection>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy" />
      <!-- Action value: adjust to your service/function import path -->
      <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy" />
      <Annotation Term="UI.IsCopyAction" Bool="true" />
    </Record>
  </Collection>
</Annotation>
```

STEP: Add a Copy action as a CAP CDS annotation (CDS)
DESCRIPTION: CAP CDS UI annotation equivalent for UI.LineItem. Place in your CDS file where UI annotations are declared.
LANGUAGE: CDS
CODE:
```cds
// In your .cds file (UI annotations section)
annotate <your.namespace>.EntityName with {
  UI : {
    LineItem : [
      {
        $Type : 'UI.DataFieldForAction',
        Label : 'Copy',
        Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy',
        ![@UI.IsCopyAction] : true
      }
    ]
  }
};
```

STEP: Configure newAction for Create (OData V2) — DraftRoot XML annotation
DESCRIPTION: When using draft-enabled apps, define Common.DraftRoot with NewAction set to a function import. This enables using the function import for creation instead of a POST.
LANGUAGE: XML
CODE:
```xml
<!-- Example DraftRoot annotation specifying a NewAction function import -->
<Annotation Term="Common.DraftRoot">
  <Record>
    <PropertyValue Property="NewAction"
                   String="cds_zrc_ce_localized_srv.cds_zrc_ce_localized_srv_Entities/Create"/>
  </Record>
</Annotation>
```

STEP: Enable useNewActionForCreate in manifest.json (OData V2)
DESCRIPTION: Turn on draft creation using the NewAction function import by adding useNewActionForCreate=true under the ListReport page settings in your manifest.json.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|Localized": {
        "entitySet": "Localized",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "useNewActionForCreate": true
          }
        }
      }
    }
  }
}
```

STEP: Define dialog title for function-import-based Create (OData V2)
DESCRIPTION: If your NewAction function import has parameters, define a Common.Label annotation on the FunctionImport target to set the parameter-dialog title shown on Create.
LANGUAGE: XML
CODE:
```xml
<!-- Annotation to set title for the create parameter dialog -->
<Annotations Target="SAP.FCLM_BAM_ACCOUNTWD_SRV_Entities/FunctionImportName">
  <Annotation Term="Common.Label" String="Create"/>
</Annotations>
```

STEP: DraftRoot with NewAction and related properties (OData V4)
DESCRIPTION: For OData V4 draft-based apps, include Common.DraftRootType properties (NewAction, ActivationAction, EditAction, PreparationAction). Presence of NewAction enables the Create button by default; see OperationAvailable rules below for visibility.
LANGUAGE: XML
CODE:
```xml
<!-- OData V4 draft root example -->
<Annotation Term="Common.DraftRoot">
  <Record Type="Common.DraftRootType">
    <PropertyValue Property="ActivationAction" String="com.c_salesordermanage_sd.draftActivate"/>
    <PropertyValue Property="EditAction" String="com.c_salesordermanage_sd.draftEdit"/>
    <PropertyValue Property="PreparationAction" String="com.c_salesordermanage_sd.draftPrepare"/>
    <PropertyValue Property="NewAction" String="com.c_salesordermanage_sd.ReturnInProcess"/>
  </Record>
</Annotation>
```

STEP: OperationAvailable logic for Create visibility (OData V4)
DESCRIPTION: When NewAction is present, Create button visibility is controlled by OperationAvailable on the NewAction operation:
- If OperationAvailable=false => Create button NOT displayed.
- If OperationAvailable=true or not specified => Create button displayed.
- If OperationAvailable=null is ignored (treated as not specified).
LANGUAGE: JSON
CODE:
```json
// No code change required here; this snippet documents the logic to apply in your metadata/annotations.
// Ensure OperationAvailable is set on the corresponding operation/annotation if you need conditional visibility.
```

STEP: Create modes (behavioral overview)
DESCRIPTION: Choose the Create mode for user experience:
- Create page (default): navigate to an object page to enter values; the app may show a dialog for immutable properties.
- Create dialog: open a modal dialog on the list report to enter values (requires enabling dialog creation).
- External: navigate to an external app (Fiori launchpad) to perform creation.
Use the appropriate annotation/manifest settings for your project to select create mode (refer to "Enabling Object Creation Using the Dialog" or "Create Mode as an External App" for implementation details).
LANGUAGE: TEXT
CODE:
```text
Create modes (summary):
- Create page  : default navigation to object page for creation.
- Create dialog: open dialog to input new object values (requires enabling dialog creation).
- External     : trigger navigation to an external app that handles creation.
```
--------------------------------

**TITLE**: Add a "Filter Price" Button to List Report Table Toolbar (Adaptation Extension, OData V2)

**INTRODUCTION**: This guide shows how to add a button to a List Report table toolbar using an Adaptation Extension (SAP Fiori elements, OData V2). The button triggers a controller-extension function which sets a price restriction (>= 1000) and rebinds the table. The controller uses the template extension hook addFilters to inject the filter at rebind time.

**TAGS**: fiori-elements, adaptation-extension, list-report, UI5, OData V2, fragment, controller-extension, filter, toolbar, button

**STEP**: Prerequisites
**DESCRIPTION**: Confirm this topic applies and that you completed the base setup.
- This is only applicable for SAP Fiori elements with OData V2.
- Complete "Extending Delivered Apps Using Adaptation Extensions" before proceeding.
**LANGUAGE**: Text
**CODE**:
```text
Prerequisites:
- SAP Fiori elements project using OData V2.
- Adaptation Extension basics completed (see Extending Delivered Apps Using Adaptation Extensions).
```

**STEP**: Create a fragment for the toolbar button
**DESCRIPTION**: Add a fragment to the table toolbar targeting the toolbar's "content" aggregation. Name the fragment (e.g., FilterPriceButton) and paste the XML below into the generated FilterPriceButton.fragment.xml file. The Button press handler uses the extension controller function path:
".extension.ProdMan.AdaptProject.ListReportExtension.handleFilterPricePress"
Breakdown of the press path:
- .extension — required by UI adaptation tool
- ProdMan.AdaptProject — the project name
- ListReportExtension — controller extension file name (without .js)
- handleFilterPricePress — function implemented in the controller extension
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: FilterPriceButton.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
  <Button
    id="PriceBtnID"
    text="Filter Price"
    press=".extension.ProdMan.AdaptProject.ListReportExtension.handleFilterPricePress" />
</core:FragmentDefinition>
```

**STEP**: Create the controller extension file
**DESCRIPTION**: Extend the List Report controller by creating ListReportExtension.js via "Extend with Controller". Place the code below into the generated file. Implementation summary:
- handleFilterPricePress(): sets this.iPriceRestriction = "1000" and calls the template extension API rebindTable() to trigger table rebind.
- override.templateBaseExtension.addFilters(fnAddFilter, sControlId): if iPriceRestriction is set, calls fnAddFilter(this, new sap.ui.model.Filter("Price", "GE", this.iPriceRestriction)) to inject the filter into the table binding.
Preserve the override block for lifecycle hooks; custom functions should be outside override.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// File: ListReportExtension.js
/**
 *@controller Name: sap.suite.ui.generic.template.ListReport.view.ListReport
 *@viewId: STTA_MP::sap.suite.ui.generic.template.ListReport.view.ListReport::STTA_C_MP_Product
 */
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/ui/core/mvc/ControllerExtension"
], function (Controller, ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("ProdMan.AdaptProject.ListReportExtension", {

    /* Custom-defined function (outside override) */
    handleFilterPricePress: function () {
      // Set the price restriction and trigger table rebind to apply the filter
      this.iPriceRestriction = "1000";
      var oExtensionAPI = this.base.templateBaseExtension.getExtensionAPI();
      oExtensionAPI.rebindTable();
    },

    /* Override block: lifecycle methods and template extension hooks go here */
    override: {
      onInit: function () {
        // optional initialization logic
      },
      onBeforeRendering: function () {
        // optional pre-render logic
      },
      onAfterRendering: function () {
        // optional post-render logic
      },
      onExit: function () {
        // optional cleanup logic
      },

      // Template-based extension: addFilters is invoked by the template during rebind
      "templateBaseExtension": {
        addFilters: function (fnAddFilter, sControlId) {
          if (this.iPriceRestriction) {
            // Inject a filter: Price GE this.iPriceRestriction
            fnAddFilter(this, new sap.ui.model.Filter("Price", "GE", this.iPriceRestriction));
          }
        }
      }
    }
  });
});
```

**STEP**: Preview and test in adaptation editor
**DESCRIPTION**: In the adaptation editor:
1. Open the Preview tab and choose Go.
2. Verify all records initially (check Price values).
3. Click the "Filter Price" button.
4. Confirm that the table now shows only records where Price >= 1000.
**LANGUAGE**: Text
**CODE**:
```text
Preview steps:
- Adaptation Editor -> Preview -> Go
- Observe initial table contents
- Click "Filter Price" button (PriceBtnID)
- Table is rebound and filtered for Price >= 1000
```
--------------------------------

**TITLE**: Adapting Logic Before Save Operation (beforeSaveExtension for SAP Fiori Elements)

**INTRODUCTION**: Implement the beforeSaveExtension controller hook to execute custom logic immediately before a save operation in SAP Fiori Elements. The hook can return a Promise to delay or cancel the save (resolve to continue, reject to cancel). Behavior differs for OData V2 draft vs non-draft apps.

**TAGS**: fiori-elements, odata-v2, odata-v4, extension-api, beforeSaveExtension, sapui5, sap.m, object-page, generic-template

**STEP**: Implement beforeSaveExtension in ObjectPage controller extension (OData V2)

**DESCRIPTION**: Add a beforeSaveExtension method to your Object Page controller extension. This method is invoked by the framework immediately before initiating the save operation. If you return a Promise, the framework waits for it to resolve to continue the save, or rejects to cancel the save. If you return nothing (undefined), the save proceeds immediately without waiting.

Place this method in your controller extension file (e.g., controllerExtensions/<YourExtension>/Controller.js) that extends sap.suite.ui.generic.template.ObjectPage.controllerFrameworkExtensions.

Draft-specific behavior:
- In draft applications: beforeSaveExtension is called only once while saving the root object page.
- In non-draft applications: beforeSaveExtension is called for save operations from any object page.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Demo Kit reference:
// https://ui5.sap.com/#/api/sap.suite.ui.generic.template.ObjectPage.controllerFrameworkExtensions/methods/sap.suite.ui.generic.template.ObjectPage.controllerFrameworkExtensions.beforeSaveExtension

// Example implementation that opens a confirmation dialog and returns a Promise.
// Resolve to continue the save; reject to cancel it.

beforeSaveExtension: function () {
    var fnResolve, fnReject;
    var oPromise = new Promise(function (resolve, reject) {
        fnResolve = resolve;
        fnReject = reject;
    });

    // Create a confirmation dialog with Continue and Cancel buttons
    this.oDialog = new sap.m.Dialog({
        title: "BeforeSaveExtension",
        content: new sap.m.Text({
            text: "This is an example to check the beforeSaveExtension"
        }),
        beginButton: new sap.m.Button({
            text: "Continue to Save",
            press: function () {
                fnResolve();           // Resolve to continue the save
                this.oDialog.close();
            }.bind(this)
        }),
        endButton: new sap.m.Button({
            text: "Cancel Save",
            press: function () {
                fnReject();            // Reject to cancel the save
                this.oDialog.close();
            }.bind(this)
        })
    });

    this.getView().addDependent(this.oDialog);
    this.oDialog.open();

    // Return the promise; the framework waits for resolve/reject
    return oPromise;
}
```

**STEP**: Promise and return behavior (summary)

**DESCRIPTION**: Quick reference for return behavior and effect on framework save flow.

**LANGUAGE**: Text

**CODE**:
```
- If beforeSaveExtension returns a Promise:
  - resolve() => framework continues with the save operation
  - reject()  => framework cancels the save operation
- If beforeSaveExtension returns no value (undefined), the framework starts the save immediately without waiting.
- Draft apps: the extension is called only once while saving the root object page.
- Non-draft apps: the extension is called for save operations from any object page.
```

**STEP**: OData V4 and further references

**DESCRIPTION**: Use the OData V4 guidance for analogous extension points and patterns. See the referenced documentation pages for examples and platform-specific details.

**LANGUAGE**: Text

**CODE**:
```
- Demo Kit API (beforeSaveExtension): 
  https://ui5.sap.com/#/api/sap.suite.ui.generic.template.ObjectPage.controllerFrameworkExtensions/methods/sap.suite.ui.generic.template.ObjectPage.controllerFrameworkExtensions.beforeSaveExtension

- OData V4 guidance (Using custom code before standard operations):
  using-custom-code-before-standard-operations-877e5ff.md
```
--------------------------------

**TITLE**: Adapting Confirmation Dialog Texts for Deleting Table Rows (SAP Fiori Elements, OData V2 & V4)

**INTRODUCTION**: This document explains how to override the default confirmation and result messages shown when deleting rows in tables on object pages. It includes the exact i18n key formats for OData V2 and OData V4, full example snippets for custom i18n resource bundles, and the required manifest.json change for Fiori Elements (V4) projects.

**TAGS**: fiori-elements-framework, i18n, localization, OData V2, OData V4, manifest.json, properties, delete-confirmation

STEP: 1 — OData V2: i18n key format and examples

DESCRIPTION: For OData V2, provide custom texts in the application's i18n file using the following key pattern. If the LineItem annotation has a qualifier, append it after the annotation fragment.

- Key format (no qualifier):
  <i18n_Key>|<EntitySet>|<navigationProperty>|com.sap.vocabularies.UI.v1.LineItem

- Key format (with qualifier):
  <i18n_Key>|<EntitySet>|<navigationProperty>|com.sap.vocabularies.UI.v1.LineItem|<qualifier>

Use the entitySet and navigationProperty to scope the text to a specific LineItem annotation.

LANGUAGE: properties

CODE:
```properties
# Example: scoped delete confirmation for a navigation property (V2)
DELETE_SELECTED_ITEM|STTA_C_MP_Product|to_ProductText|com.sap.vocabularies.UI.v1.LineItem=Delete this row?

# Full list of V2 keys you can override (copy into your i18n file with optional scoping as above):
DELETE_SELECTED_ITEM=Delete the selected item?
DELETE_SELECTED_ITEMS=Delete the selected items?
DELETE_SUCCESS_PLURAL_WITH_COUNT={0} items have been deleted.
DELETE_SUCCESS_WITH_COUNT={0} item has been deleted.
DELETE_ERROR_PLURAL_WITH_COUNT={0} items cannot be deleted.
DELETE_ERROR_WITH_COUNT={0} item cannot be deleted.
DELETE_ERROR_PLURAL=The selected items cannot be deleted.
DELETE_ERROR=The selected item cannot be deleted.
DELETE_SUCCESS_PLURAL=The selected items have been deleted.
ITEM_DELETED=Item deleted
DELETE_UNDELETABLE_ITEMS={0} of {1} items cannot be deleted.
```

STEP: 2 — OData V4: Allowed keys and example overrides

DESCRIPTION: For OData V4, only the listed keys can be overridden in the custom i18n file. When scoping to a particular entity set, append the entitySet name using a pipe character (|). You may also append an action name for action-specific confirmation texts (see Step 4).

LANGUAGE: properties

CODE:
```properties
# V4 default keys (copy and override as needed in your custom i18n file):
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR=Delete this object?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_UNSAVED_CHANGES=Another user edited this object without saving the changes:{0} Delete anyway?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_UNSAVED_CHANGES_MULTIPLE_OBJECTS=Other users have edited the selected objects without saving the changes. Delete anyway?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL=Delete the selected objects?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_NON_DELETABLE={0} of {1} objects cannot be deleted.
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_LOCKED={0} of {1} objects are currently locked.
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_UNSAVED_AND_FEW_OBJECTS_LOCKED_SINGULAR=The remaining object has unsaved changes. Do you still want to delete it?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_UNSAVED_AND_FEW_OBJECTS_LOCKED_PLURAL=The remaining objects have unsaved changes. Do you still want to delete them?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_UNSAVED_SINGULAR=Also delete object with unsaved changes?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_UNSAVED_PLURAL=Also delete objects with unsaved changes?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTINFO_AND_FEW_OBJECTS_LOCKED_AND_NON_DELETABLE={0} out of {2} objects cannot be deleted. {1} of {2} objects are currently locked.
```

STEP: 3 — Manifest change (OData V4 / Fiori Elements projects)

DESCRIPTION: Add "enhanceI18n" to the target's settings in manifest.json to tell Fiori Elements to use your custom resource bundle. The value is the path to your custom properties file (relative to the component).

LANGUAGE: JSON

CODE:
```json
{
  "targets": {
    "SalesOrderManageList": {
      "type": "Component",
      "id": "SalesOrderManageList",
      "name": "sap.fe.templates.ListReport",
      "options": {
        "settings": {
          "contextPath": "/SalesOrderManage",
          "enhanceI18n": "i18n/customSalesOrderLR.properties"
          // other settings...
        }
      }
    }
  }
}
```

STEP: 4 — Examples: default vs custom, entity-scoped keys, action-scoped keys

DESCRIPTION: Use these patterns for overriding:
- Global (shared) resources: keep the exact key (no suffix).
- Entity-scoped: append |<EntitySet> to the key.
- Action-scoped (action confirmation popovers): append |<EntitySet>|<ActionName>.

LANGUAGE: properties

CODE:
```properties
# Shared (global) override - applies everywhere this key is used
C_COMMON_DIALOG_OK=Okie?

# Entity-scoped override - scoped to the SalesOrderManage entity set
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL|SalesOrderManage=Do you want to delete the selected Sales Orders?
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR|SalesOrderManage=Do you want to delete this Sales Order?

# Action-scoped override - scoped to SalesOrderManage entity set and the action ReturnInProcess
C_OPERATIONS_ACTION_CONFIRM_MESSAGE|SalesOrderManage|ReturnInProcess=Can you please confirm if you really want to trigger the returns?

# Example: action same name but different entity set (scoped to items)
C_OPERATIONS_ACTION_CONFIRM_MESSAGE|_Items|ReturnInProcess=Can you please confirm if you really want to trigger the returns for the chosen items?
```

STEP: 5 — Qualifier handling (OData V2 LineItem qualifiers)

DESCRIPTION: If the LineItem annotation uses a qualifier, include it in the V2 key after the annotation fragment.

LANGUAGE: properties

CODE:
```properties
# V2 LineItem with qualifier example:
DELETE_SELECTED_ITEM|STTA_C_MP_Product|to_ProductText|com.sap.vocabularies.UI.v1.LineItem#MyQualifier=Delete this qualified row?
```

STEP: 6 — Fallback behavior

DESCRIPTION: If no custom text is provided for a key (global, entity-scoped, or action-scoped), Fiori Elements falls back to the default text provided by the framework (the keys listed above).

LANGUAGE: plain

CODE:
```text
# (No code) Behavior note:
If the application does not provide a custom key, the SAP Fiori Elements resource bundle value for that key will be used as fallback.
```

--------------------------------

**TITLE**: Adapting Delete Dialog Text in Object Page Header (SAP Fiori elements, OData V2)

**INTRODUCTION**: Instructions and code examples to customize the title and text of the Delete confirmation dialog that appears when a user triggers Delete on an Object Page header in SAP Fiori elements (OData V2). Use a controller extension and implement beforeDeleteExtension to return a message object (synchronously or asynchronously). Prefer the extensionAPI and securedExecution for framework-integrated behavior.

**TAGS**: fiori-elements-framework, OData V2, extensionAPI, app-extension, controller-extension, ObjectPage, delete-dialog

**STEP**: 1 — Register the controller extension in manifest.json

**DESCRIPTION**: Add a controller extension entry for the Object Page details view in your application's manifest.json. Set controllerName to your extension controller (e.g., MY_APP.ext.controller.DetailsExtension).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "controllerName": "MY_APP.ext.controller.DetailsExtension"
        }
      }
    }
  }
}
```

**STEP**: 2 — Maintain controller extension files in your app

**DESCRIPTION**: Create and maintain the controller extension file referenced in manifest.json. Typical location (based on controllerName): webapp/ext/controller/DetailsExtension.controller.js. Keep your extension code isolated and use only the official extensionAPI to interact with Fiori elements internals.

**LANGUAGE**: text

**CODE**:
```text
// Maintain extension files under your app structure, e.g.:
// webapp/ext/controller/DetailsExtension.controller.js
// (Visual reference image in original docs: images/AppExtensionTree_ObjectPage_318f52b.png)
```

**STEP**: 3 — Implement beforeDeleteExtension (synchronous object)

**DESCRIPTION**: Return a plain object containing title and text to override the dialog. This is the simplest synchronous form.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/ext/controller/DetailsExtension.controller.js
sap.ui.define(["sap/ui/core/mvc/Controller"], function(Controller) {
  "use strict";

  return Controller.extend("MY_APP.ext.controller.DetailsExtension", {
    beforeDeleteExtension: function() {
      var oMessageText = {
        title: "My title",
        text: "My text"
      };
      return oMessageText;
    }
  });
});
```

**STEP**: 4 — Implement beforeDeleteExtension (returning a Promise)

**DESCRIPTION**: Return a Promise that resolves to the message object. Use this if message text requires asynchronous computation or service calls.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/ext/controller/DetailsExtension.controller.js
sap.ui.define(["sap/ui/core/mvc/Controller"], function(Controller) {
  "use strict";

  return Controller.extend("MY_APP.ext.controller.DetailsExtension", {
    beforeDeleteExtension: function() {
      var oMessageText = {
        title: "My title",
        text: "My text"
      };
      return Promise.resolve(oMessageText);
      // Or perform async work:
      // return new Promise(function(resolve, reject) {
      //   // async logic...
      //   resolve(oMessageText);
      // });
    }
  });
});
```

**STEP**: 5 — Implement beforeDeleteExtension using extensionAPI.securedExecution

**DESCRIPTION**: Use this.extensionAPI.securedExecution to wrap asynchronous operations while respecting Fiori elements' secured execution semantics (busy handling, error handling, etc.). The function should ultimately return an object or a Promise resolving to the object.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/ext/controller/DetailsExtension.controller.js
sap.ui.define(["sap/ui/core/mvc/Controller"], function(Controller) {
  "use strict";

  return Controller.extend("MY_APP.ext.controller.DetailsExtension", {
    beforeDeleteExtension: function() {
      var oMessageText = {
        title: "My title",
        text: "My text"
      };

      // Use securedExecution provided by the Fiori elements extensionAPI
      return this.extensionAPI.securedExecution(function() {
        return new Promise(function(resolve) {
          // perform secured async operations here
          // ...
          resolve(oMessageText);
        });
      });
    }
  });
});
```

**NOTE**: This topic applies only to SAP Fiori elements for OData V2. Use app extensions only when manifest settings or annotations cannot achieve the required behavior. For securedExecution details, see the SecuredExecution documentation (using-the-securedexecution-method-6a39150.md).
--------------------------------

**TITLE**: Adapt Delete Dialog Text for Nested Smart Table (Object Page, OData V2)

**INTRODUCTION**: Show how to register a controller extension and implement beforeLineItemDeleteExtension to customize the Delete confirmation dialog text (title, text, undeletableText) for nested Smart Tables on an Object Page. Includes three implementation patterns: synchronous object return, Promise return, and using extensionAPI.securedExecution. Applicable only for SAP Fiori elements for OData V2. Use extensionAPI only; do not manipulate framework internals.

**TAGS**: fiori-elements, ODataV2, extension, controller-extension, beforeLineItemDeleteExtension, SmartTable, ObjectPage, securedExecution

**STEP**: 1 — Register the controller extension in manifest.json

**DESCRIPTION**: Add the controller extension entry under "sap.ui.controllerExtensions" for the Object Page Details view. The controllerName should use your namespace. The example below uses "MY_APP.ext.controller.DetailsExtension".

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "controllerName": "MY_APP.ext.controller.DetailsExtension"
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Add the controller extension file

**DESCRIPTION**: Create the controller file matching the manifest controllerName. Typical file path: webapp/ext/controller/DetailsExtension.controller.js. Implement beforeLineItemDeleteExtension in that controller. The framework calls this method when the user triggers Delete in a nested Smart Table; it receives oBeforeLineItemDeleteProperties, which includes sUiElementId identifying the nested Smart Table and details about selected items.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/controller/DetailsExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function(Controller) {
  "use strict";

  return Controller.extend("MY_APP.ext.controller.DetailsExtension", {
    // Implementations of beforeLineItemDeleteExtension follow below
  });
});
```

**STEP**: 3 — Implement beforeLineItemDeleteExtension (synchronous object return)

**DESCRIPTION**: Return an object with properties title, text, and undeletableText. Compare oBeforeLineItemDeleteProperties.sUiElementId to target Smart Table id to scope the change. If not matching, return nothing to avoid changing other tables.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// inside MY_APP.ext.controller.DetailsExtension
beforeLineItemDeleteExtension: function(oBeforeLineItemDeleteProperties) {
  // Example Smart Table identifier for a nested LineItem table:
  var sTargetTableId = "My_APP::sap.suite.ui.generic.template.ObjectPage.view.Details::MY_EntitySet--to_NavProperty::com.sap.vocabularies.UI.v1.LineItem::Table";

  if (oBeforeLineItemDeleteProperties.sUiElementId !== sTargetTableId) {
    // Not our nested table — do nothing
    return;
  }

  // Return a plain object to override dialog texts synchronously
  var oMessageText = {
    title: "My title",
    text: "My text",
    undeletableText: "My undeletable text"
  };

  return oMessageText;
}
```

**STEP**: 4 — Implement beforeLineItemDeleteExtension (Promise-based return)

**DESCRIPTION**: Return a Promise that resolves to the same object structure. Useful when you need asynchronous operations (e.g., translations, backend checks) before returning dialog texts.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// inside MY_APP.ext.controller.DetailsExtension
beforeLineItemDeleteExtension: function(oBeforeLineItemDeleteProperties) {
  var sTargetTableId = "My_APP::sap.suite.ui.generic.template.ObjectPage.view.Details::MY_EntitySet--to_NavProperty::com.sap.vocabularies.UI.v1.LineItem::Table";

  if (oBeforeLineItemDeleteProperties.sUiElementId !== sTargetTableId) {
    return;
  }

  // Perform async work then resolve with the message object
  return new Promise(function(resolve, reject) {
    // Example async operation (e.g., get i18n texts or call service)
    // Simulated with setTimeout here:
    setTimeout(function() {
      resolve({
        title: "My title",
        text: "My text",
        undeletableText: "My undeletable text"
      });
    }, 0);
  });
}
```

**STEP**: 5 — Implement beforeLineItemDeleteExtension using extensionAPI.securedExecution

**DESCRIPTION**: Use this.extensionAPI.securedExecution to ensure safe execution within the Fiori elements lifecycle and permissions. securedExecution takes a callback that returns a value or Promise. Use it when your logic may access extensionAPI features or external services that should be wrapped for secured execution.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// inside MY_APP.ext.controller.DetailsExtension
beforeLineItemDeleteExtension: function(oBeforeLineItemDeleteProperties) {
  var sTargetTableId = "My_APP::sap.suite.ui.generic.template.ObjectPage.view.Details::MY_EntitySet--to_NavProperty::com.sap.vocabularies.UI.v1.LineItem::Table";

  if (oBeforeLineItemDeleteProperties.sUiElementId !== sTargetTableId) {
    return;
  }

  var oMessageText = {
    title: "My title",
    text: "My text",
    undeletableText: "My undeletable text"
  };

  // Wrap async or privileged logic in securedExecution
  return this.extensionAPI.securedExecution(function() {
    return new Promise(function(resolve /*, reject */) {
      // Do work here (e.g., authorization checks, async calls)
      resolve(oMessageText);
    });
  });
}
```

**STEP**: 6 — Behavior notes and constraints

**DESCRIPTION**: Important behavior details to implement correctly:
- oBeforeLineItemDeleteProperties contains information about selected items; sUiElementId identifies the nested Smart Table (compare this to scope your customization).
- undeletableText is shown only if one or more selected items cannot be deleted (deletablePath usage in annotations).
- This customization approach is applicable only for SAP Fiori elements for OData V2.
- Use extensionAPI only; do not access or modify framework internals (controls, models, or bindings). For securedExecution details, see the framework docs on Using the SecuredExecution Method.
--------------------------------

**TITLE**: Adapting Delete Dialog Texts (List Report) via Controller Extension

**INTRODUCTION**: Show how to register a controller extension for a Fiori elements List Report (OData V2) and implement beforeDeleteExtension to adapt the Delete dialog texts (title, text, unsavedChanges, undeletableText). Includes manifest registration and three implementation patterns: synchronous object, Promise, and extensionAPI.securedExecution.

**TAGS**: fiori-elements, odata-v2, extension, list-report, beforeDeleteExtension, manifest, sapui5, controller-extension, extensionAPI

**STEP**: 1 — Register controller extension in manifest.json

**DESCRIPTION**: Add a controller extension entry for the ListReport view in your app's manifest.json. Replace the controllerName value with your extension controller path (example: "MY_APP.ext.controller.ListReportExtension").

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "controllerName": "MY_APP.ext.controller.ListReportExtension"
        }
      }
    }
  }
}
```

**STEP**: 2 — Create controller extension file

**DESCRIPTION**: Add the controller file at the path used in the manifest. Example path: webapp/ext/controller/ListReportExtension.controller.js. Use sap.ui.define to extend the base controller and implement beforeDeleteExtension. The parameter oBeforeDeleteProperties contains information about the selected items for deletion (provided by the framework).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/ext/controller/ListReportExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("MY_APP.ext.controller.ListReportExtension", {

    /**
     * beforeDeleteExtension is called before the Delete dialog is shown.
     * oBeforeDeleteProperties contains framework-provided info about the selected items.
     * You can return an object, a Promise resolving to the object, or use extensionAPI.securedExecution.
     *
     * Return object shape (properties supported by the framework):
     * {
     *   title: "<string>",
     *   text: "<string>",
     *   unsavedChanges: "<string>",
     *   undeletableText: "<string>"
     * }
     */
    beforeDeleteExtension: function (oBeforeDeleteProperties) {
      // default synchronous example returning an object:
      var oMessageText = {
        title: "Delete items",
        text: "Are you sure you want to delete the selected items?",
        unsavedChanges: "Some selected items have unsaved changes.",
        undeletableText: "Some selected items cannot be deleted."
      };
      return oMessageText;
    }

  });
});
```

**STEP**: 3 — Implementation pattern: return a Promise

**DESCRIPTION**: If you need async processing (e.g., call backend or compute messages), return a Promise that resolves to the message object.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: return a Promise
beforeDeleteExtension: function (oBeforeDeleteProperties) {
  return new Promise(function (resolve, reject) {
    // perform async computations or service calls here
    var oMessageText = {
      title: "Delete items (async)",
      text: "This message was created asynchronously.",
      unsavedChanges: "Unsaved changes exist.",
      undeletableText: "Some items cannot be deleted."
    };
    resolve(oMessageText);
  });
}
```

**STEP**: 4 — Implementation pattern: use extensionAPI.securedExecution

**DESCRIPTION**: To integrate with Fiori elements secured execution (recommended when invoking framework-provided APIs or performing guarded actions), wrap async logic in this.extensionAPI.securedExecution and return its result (can be a Promise resolving to the message object).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: use extensionAPI.securedExecution
beforeDeleteExtension: function (oBeforeDeleteProperties) {
  var that = this;
  return this.extensionAPI.securedExecution(function () {
    return new Promise(function (resolve) {
      // perform guarded async logic here
      var oMessageText = {
        title: "Delete items (secured)",
        text: "Message created inside securedExecution.",
        unsavedChanges: "There are unsaved changes.",
        undeletableText: "Some entries are undeletable."
      };
      resolve(oMessageText);
    });
  });
}
```

**STEP**: 5 — Important notes and best practices

**DESCRIPTION**: 
- Applicable only for SAP Fiori elements for OData V2.
- Use extensions only when manifest settings or annotations cannot achieve the desired behavior.
- Use only the provided extensionAPI to interact with the framework. Do not access or manipulate internal framework controls, models, or properties directly.
- oBeforeDeleteProperties is passed by the List Report and contains info about selected items (use it to customize texts based on selection).
--------------------------------

**TITLE**: Adapting the Filter Bar (SAP Fiori Elements — OData V2 & V4)

**INTRODUCTION**: Practical, code-focused guidance to adapt the Fiori Elements filter bar. Includes manifest.json examples for OData V2 and V4 to include navigation properties, enable a Clear button, move fields to the Adapt Filters dialog, and configure case-insensitive filtering via FilterFunctions. Use these snippets in your app manifest and controller extension code.

**TAGS**: fiori-elements, filter-bar, manifest.json, ODataV2, ODataV4, navigation-properties, case-insensitive, clear-button, controlConfiguration, SelectionFields

**STEP**: 1 — Include navigation properties as filters (OData V2)

**DESCRIPTION**: For SAPUI5 >= 1.126.0, navigation properties are not added to the Adapt Filters dialog by default. Add navigation properties (either a single property or a navigation path to include all simple properties of the navigation type) using the filterSettings.navigationProperties array under your ListReport component entry in manifest.json. Navigation properties added this way will include all filterable properties of the target entity type except those annotated with Hidden or HiddenFilter.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routes": {},
    "config": {},
    "models": {}
  },
  "sap.app": {},
  "sap.ui": {},
  "ListReport|C_STTA_SalesOrder_WD_20": {
    "entitySet": "C_STTA_SalesOrder_WD_20",
    "component": {
      "name": "sap.suite.ui.generic.template.ListReport",
      "list": true,
      "settings": {
        "tableSettings": {
          "...": "..."
        },
        "filterSettings": {
          "navigationProperties": [
            "to_Supplier/EmailAddress",
            "to_DeliveryStatus"
          ]
        }
      }
    }
  }
}
```

**STEP**: 2 — Include navigation properties as filters (OData V4)

**DESCRIPTION**: For OData V4 apps, UI.SelectionFields determines filter fields. You can (A) add navigation properties directly in the UI.SelectionFields annotation (controlConfiguration) in manifest.json, or (B) use navigationProperties under controlConfiguration to populate the Adapt Filters dialog only. Each path is relative to the current entity type: if the path points to a navigation/complex type, all its simple properties are added; if it points to a simple property, only that property is added. Only one-level navigation is supported (no nested navigation).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": { "...": "..." },
  "ListReport": {
    "...": "...",
    "options": {
      "settings": {
        "...": "...",
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.SelectionFields": {
            "navigationProperties": [
              "_DistributionChannel",
              "_Partner/FullName"
            ],
            "...": "..."
          }
        },
        "...": "..."
      }
    }
  }
}
```

**STEP**: 3 — Behavior notes for OData V4 navigation filters (1:n associations)

**DESCRIPTION**: Filtering on a field from a 1:n navigation entity fetches all main records that have at least one matching related record. When you select a main record and navigate to the object page, all related records from the 1:n association are displayed (not just those that matched the filter).

**LANGUAGE**: text

**CODE**:
```text
- Navigation properties are single-level only (no nested paths).
- Properties annotated with Hidden or HiddenFilter are excluded.
- 1:n filter: main records with >=1 matching related record are returned; object page shows all related records.
```

**STEP**: 4 — Configure case-insensitive filtering via FilterFunctions (OData V4)

**DESCRIPTION**: Control case sensitivity by exposing supported filter functions in the service metadata using the Org.OData.Capabilities.V1.FilterFunctions annotation on the EntityContainer. If the service declares "tolower", Fiori Elements treats filtering as case-insensitive (caseSensitive = false). If "tolower" is absent, Fiori Elements treats filtering as caseSensitive = true. If no annotation exists, default behavior is case-insensitive (false). This affects Filter Bar, Table personalization filters, filters from semantic keys, and value help dialogs.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="namespace.EntityContainer">
  <Annotation Term="Org.OData.Capabilities.V1.FilterFunctions">
    <Collection>
      <!-- include supported functions, e.g.: -->
      <String>tolower</String>
      <!-- other supported functions -->
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 5 — Add a Clear button to the filter bar (manifest.json)

**DESCRIPTION**: Enable a Clear button in the list report filter bar by setting showClearButton to true under controlConfiguration -> @com.sap.vocabularies.UI.v1.SelectionFields. Clicking Clear removes all filter values (not restoring defaults). An active Editing Status filter resets to "All". To perform custom actions after clear, implement the onAfterClear controller extension (see next step).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageList": {
    "options": {
      "settings": {
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.SelectionFields": {
            "showClearButton": true
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — Implement onAfterClear controller extension (custom clear behavior)

**DESCRIPTION**: Implement the onAfterClear hook in your ListReport controller extension to add custom UI updates after the Clear button is clicked (for example, reset a custom segmented button).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// In your controller extension
onAfterClear: function (oEvent) {
  var oView = this.getView();
  // Example: reset a custom SegmentedButton with id "CustomSegmentedButton"
  var oSegBtn = oView.byId("CustomSegmentedButton");
  if (oSegBtn && typeof oSegBtn.setSelectedKey === "function") {
    oSegBtn.setSelectedKey("none");
  }
}
```

**STEP**: 7 — Move explicit filter fields to the Adapt Filters dialog

**DESCRIPTION**: To move a filter field from the visible filter bar into the Adapt Filters dialog, set the field's availability to "Adaptation" under controlConfiguration -> @com.sap.vocabularies.UI.v1.SelectionFields -> filterFields in manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageList": {
    "options": {
      "settings": {
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.SelectionFields": {
            "filterFields": {
              "postingDate": {
                "availability": "Adaptation"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 8 — References & API pointers (for implementation details)

**DESCRIPTION**: Use the following documentation/API resources when implementing the above:
- SmartFilterBar API: sap.ui.comp.smartfilterbar.SmartFilterBar (for programmatic control of filters)
- Configuring Default Filter Values (for setting/reading default filters)
- Configuring Filter Bars / Adding Custom Fields (for additional manifest annotation options)
--------------------------------

**TITLE**: Adapting the SAP Fiori Elements UI — manifest.json examples for Developer & Key‑User Adaptation (OData V2 & V4)

**INTRODUCTION**: Quick, code-focused reference showing where and how to configure UI adaptation settings for SAP Fiori elements apps (OData V2 and OData V4). Includes manifest.json snippets for common List Report, Object Page, Filter Bar and Table settings and the minimum runtime flexibility dependency required to enable key‑user adaptation.

**TAGS**: fiori-elements-framework, manifest.json, key-user-adaptation, sapui5, sap.ui.fl, odata-v2, odata-v4, variant-management, table-personalization

STEP: 1 — Add runtime flexibility dependency (enable SAP UI flexibility library)
DESCRIPTION: Dependency required to allow key-user UI adaptation (sap.ui.fl). Add the library to webapp/manifest.json so the runtime has the flexibility library available.
LANGUAGE: JSON
CODE:
```JSON
// File: webapp/manifest.json (fragment)
{
  "sap.ui5": {
    "dependencies": {
      "minUI5Version": "1.84.0",
      "libs": {
        "sap.ui.fl": {}
      }
    }
  }
}
```

STEP: 2 — Minimal enablement block (conceptual flag to indicate flexibility is used)
DESCRIPTION: Conceptual manifest snippet indicating the app supports adaptation features. Placement depends on the template (sap.ui.generic.app for V2, SAP Fiori elements V4 templates). Use this as a guide—actual property location can vary per project template but it must be placed in webapp/manifest.json.
LANGUAGE: JSON
CODE:
```JSON
// File: webapp/manifest.json (fragment)
// Conceptual: show that flexibility is used and managed at runtime
{
  "sap.app": {
    "id": "my.company.app"
  },
  "sap.ui5": {
    // sap.ui.fl library added in dependencies (see Step 1)
    "flexibility": {
      "enabled": true
    }
  }
}
```

STEP: 3 — List Report (OData V2) — set variant management and initial load
DESCRIPTION: Example manifest.json snippet for a Fiori Elements (OData V2) List Report page. Configure variant management (Page | Control), and initialLoad (Auto | Enabled | Disabled). Place under "sap.ui.generic.app" -> "pages" -> appropriate page entry in webapp/manifest.json.
LANGUAGE: JSON
CODE:
```JSON
// File: webapp/manifest.json (fragment) — Fiori Elements OData V2 List Report
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            // Variant Management: "Page" | "Control"
            "variantManagement": "Page",

            // Initial Load: "Auto" | "Enabled" | "Disabled"
            "initialLoad": "Auto"
          }
        }
      }
    ]
  }
}
```

STEP: 4 — Filter Bar (OData V2 / V4) — show Go / Clear and semantic date usage
DESCRIPTION: Place these filter bar options in the same page settings area as the List Report or in the filter bar settings used by the application. Use boolean flags to activate/deactivate UI elements or semantic date ranges.
LANGUAGE: JSON
CODE:
```JSON
// File: webapp/manifest.json (fragment) — Filter Bar settings
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "settings": {
            "filterBar": {
              // Display Go button in visual filter bar (analytical pages)
              "displayGoButton": true,

              // For Fiori Elements V4, or when supported, enable a Clear button
              "displayClearButton": true,

              // Use semantic date ranges defined in manifest.json filters
              "useSemanticDateRange": true
            }
          }
        }
      }
    ]
  }
}
```

STEP: 5 — Object Page (Editable Header / Table & Chart Variant Management)
DESCRIPTION: Configure header editability and variant management for tables and charts on the Object Page. Place under the object page component settings in webapp/manifest.json.
LANGUAGE: JSON
CODE:
```JSON
// File: webapp/manifest.json (fragment) — Object Page settings
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            // Make header fields editable by default when object is opened
            "openInEditMode": false,   // or true to open in edit directly

            // Header editability control
            "editableHeaderContent": true,

            // Table and Chart variant management on the object page
            "tableVariantManagement": true,
            "chartVariantManagement": true,

            // Show Related Apps button
            "showRelatedApps": true
          }
        }
      }
    ]
  }
}
```

STEP: 6 — Table (OData V2 & V4) — common personalization & performance settings
DESCRIPTION: Configure table behavior: selection mode, personalization, row counts, scroll/initial thresholds, frozen columns, condensed layout, export and Add-to-Insights. Use these settings in the relevant page or table settings in webapp/manifest.json.
LANGUAGE: JSON
CODE:
```JSON
// File: webapp/manifest.json (fragment) — Table settings (List Report / Object Page)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "settings": {
            "table": {
              // SelectionMode: "Single" | "Multi"
              "selectionMode": "Multi",

              // Enable Select All checkbox in table
              "enableSelectAll": true,

              // Limit maximum selectable rows at once (not applicable to responsive)
              "selectionLimit": 100,

              // Number of rows visible on Object Page tables (object page only)
              "rowCount": 20,

              // Initial and dynamic loading:
              "threshold": 200,         // number of records to load on initial load
              "scrollThreshold": 50,    // additional records to load when scrolling

              // Layout and width options:
              "condensedTableLayout": false,
              "widthIncludingColumnHeader": true,

              // Frozen columns count when horizontally scrolling
              "frozenColumnCount": 2,

              // Enable Export button
              "enableExport": true,

              // Table personalization (v4: Enabled | Disabled | OwnSettings)
              "personalization": {
                "mode": "Enabled" // or "Disabled" or "OwnSettings"
                // If "OwnSettings", configure own options: sorting, columns, filtering, grouping
                // Example:
                // "ownSettings": ["Sorting", "Columns", "Filtering", "Grouping"]
              },

              // Enable Add Card to Insights (only applicable for List Report, S/4HANA My Home)
              "enableAddCardToInsights": false
            }
          }
        }
      }
    ]
  }
}
```

STEP: 7 — Table creation & selection modes (Object Page)
DESCRIPTION: Create-mode options for table creation rows and selection mode options; applicable primarily to object page tables. Configure createMode and selection behavior.
LANGUAGE: JSON
CODE:
```JSON
// File: webapp/manifest.json (fragment) — Table creation and selection settings
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderItems",
        "component": {
          "settings": {
            "table": {
              // CreateMode: "NewPage" | "Inline" | "InlineCreationRows" | "InlineCreationRowsHiddenInEditPage"
              "createMode": "InlineCreationRows",

              // Selection mode for objects
              "selectionMode": "Single"
            }
          }
        }
      }
    ]
  }
}
```

STEP: 8 — Variant Management (OData V4 example showing "None" option)
DESCRIPTION: Fiori Elements OData V4 supports an additional "None" value for variantManagement. Configure in the list report component settings for V4 projects.
LANGUAGE: JSON
CODE:
```JSON
// File: webapp/manifest.json (fragment) — Fiori Elements OData V4 List Report
{
  "sap.fe.templates": {
    "ListReport": {
      "settings": {
        // Allowed values: "Page" | "Control" | "None"
        "variantManagement": "None",

        // Initial load settings: "Auto" | "Enabled" | "Disabled"
        "initialLoad": "Enabled"
      }
    }
  }
}
```

STEP: 9 — Key-user adaptation behavior (runtime notes — manifest-managed)
DESCRIPTION: Key-user adaptation stores the activated settings in the app's manifest.json (or in the UI flexibility layer) and the application reloads automatically when a key user activates a new version. Keep in mind:
- Entering key-user adaptation mode starts the app in a fresh state; changes are not preserved in the running internal app state.
- Exiting adaptation mode restores the state from before adaptation mode.
- Settings made by a key user can override end-user personalization; end users may need to reapply their personal settings.
- Embedding iFrames in SAP Fiori elements for OData V2 with UI adaptation is not recommended.

LANGUAGE: JSON
CODE:
```JSON
// No code required; this step captures runtime behavior and considerations.
// Keep these constraints in developer documentation alongside the manifest.json settings.
```

STEP: 10 — References / Where to put each snippet
DESCRIPTION: File path guidance — place manifest changes in the app descriptor:
- webapp/manifest.json — central place for all examples above.
- For Fiori Elements V2: most page-level settings go under "sap.ui.generic.app" -> "pages" -> component -> settings.
- For Fiori Elements V4: many settings go under "sap.fe.templates" or template-specific paths; verify your project template and adjust placement as required.

LANGUAGE: JSON
CODE:
```JSON
// File: webapp/manifest.json
// - Place List Report and Object Page settings under sap.ui.generic.app.pages[] for OData V2
// - For OData V4, check sap.fe.templates or the template-specific manifest path in your project
```


--------------------------------

**TITLE**: Analytical List Page — UI Adaptation Quick Reference & Code Examples

**INTRODUCTION**: Config snippets and concrete examples for adapting the UI of SAP Fiori elements Analytical List Page (OData V2). Use these manifest.json and UI-adaptation-style JSON snippets to set page-level behavior, chart/table settings, column properties, and visual-filter/button properties. Replace entitySet and IDs to match your app.

**TAGS**: fiori-elements, analytical-list-page, manifest.json, smartChart, smartTable, UI-adaptation, ODataV2

STEP: 1 — Page-level settings (manifest.json)
DESCRIPTION: Set template-level page properties: collapse filter bar, freeze header on scroll, variant management options, share/clear icons, table toolbar and page footer visibility. Place inside the page entry for the AnalyticalListPage component in webapp/manifest.json.
LANGUAGE: JSON
CODE:
```JSON
/* File: webapp/manifest.json
   Insert or update the corresponding "pages" entry for the Analytical List Page.
*/
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            /* Page header / filter bar */
            "headerExpanded": false,                       /* collapse smart filter bar */
            "preserveHeaderStateonScroll": true,           /* freeze filter bar on scroll */

            /* Variant management */
            "showSetAsDefault": true,                      /* allow Set As Default per user */
            "showShare": true,                             /* allow sharing variants */

            /* Share icon visibility */
            "share": {
              "visible": true
            },

            /* Clear button visibility (depends on Go button placement) */
            "clear": {
              "visible": true
            },

            /* Table toolbar / page footer */
            "tableToolbar": {
              "visible": true
            },
            "pageFooter": {
              "visible": true
            }
          }
        }
      }
    ]
  }
}
```

STEP: 2 — Smart Chart settings (manifest.json)
DESCRIPTION: Configure smart chart behavior: ignored chart types, selection mode, tooltip, type selection button, download/legend buttons, and the no-data text. Use comma-separated chart type keys for ignoredChartTypes.
LANGUAGE: JSON
CODE:
```JSON
/* File: webapp/manifest.json
   Add/merge under the AnalyticalListPage component "settings" or a dedicated "chartSettings" object.
*/
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "chartSettings": {
              "ignoredChartTypes": "pie,donut,heatmap",      /* hide these chart types in chooser */
              "selectionMode": "Multiple",                  /* "Single", "Multiple", or "None" */
              "showChartTooltip": true,
              "showChartTypeSelectionButton": true,
              "showDownloadButton": true,
              "showLegendButton": true,
              "noData": "No chart data available"           /* override "no data" text */
            }
          }
        }
      }
    ]
  }
}
```

STEP: 3 — Chart type keys (use in ignoredChartTypes)
DESCRIPTION: Use these exact keys (comma-separated) when setting ignoredChartTypes to hide specific chart types.
LANGUAGE: JSON
CODE:
```JSON
/* Chart type values to use in ignoredChartTypes */
{
  "bar": "Bar Chart",
  "column": "Column Chart",
  "line": "Line Chart",
  "combination": "Combined Column Line Chart",
  "pie": "Pie Chart",
  "donut": "Doughnut Chart",
  "scatter": "Scatter Plot",
  "bubble": "Bubble Chart",
  "heatmap": "Heat Map",
  "bullet": "Bullet Chart",
  "vertical_bullet": "Vertical Bullet Chart",
  "stacked_bar": "Stacked Bar Chart",
  "stacked_column": "Stacked Column Chart",
  "stacked_combination": "Combined Stacked Line Chart",
  "horizontal_stacked_combination": "Horizontal Combined Stacked Line Chart",
  "dual_bar": "Bar Chart with 2 X-Axes",
  "dual_column": "Column Chart with 2 Y-Axes",
  "dual_line": "Line Chart with 2 Y-Axes",
  "dual_stacked_bar": "Stacked Bar Chart with 2 X-Axes",
  "dual_stacked_column": "Stacked Column Chart with 2 Y-Axes",
  "dual_combination": "Combined Column Line Chart with 2 Y-Axes",
  "dual_stacked_combination": "Combined Bar Line Chart with 2 X-Axes",
  "dual_horizontal_combination": "Combined Stacked Line Chart with 2 Y-Axes",
  "dual_horizontal_stacked_combination": "Horizontal Combined Stacked Line Chart with 2 X-Axes",
  "100_stacked_bar": "100% Stacked Bar Chart",
  "100_stacked_column": "100% Stacked Column Chart",
  "100_dual_stacked_bar": "100% Stacked Bar Chart with 2 X-Axes",
  "100_dual_stacked_column": "100% Stacked Column Chart with 2 Y-Axes",
  "waterfall": "Waterfall Chart",
  "horizontal_waterfall": "Horizontal Waterfall Chart"
}
```

STEP: 4 — Chart toolbar settings (manifest.json)
DESCRIPTION: Control chart personalization/settings icon visibility and drill-down button visibility/text within the chart toolbar.
LANGUAGE: JSON
CODE:
```JSON
/* File: webapp/manifest.json
   Add/merge under the AnalyticalListPage component "settings".
*/
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "chartToolbar": {
              "personalisation": {
                "visible": true      /* show or hide chart personalization (Settings) icon */
              },
              "drillDown": {
                "visible": true,
                "textKey": "C_ContrItemMonitoringResults--chart-btnDrillDownText"
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 5 — Table settings (manifest.json)
DESCRIPTION: Configure table personalization (settings icon), Export to Excel, scrollThreshold for dynamic loading, row count and rememberSelections for responsive tables.
LANGUAGE: JSON
CODE:
```JSON
/* File: webapp/manifest.json
   Under AnalyticalListPage "settings" -> "tableSettings"
*/
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "tableSettings": {
              "personalization": {
                "visible": true    /* show/hide Settings icon for table personalization */
              },
              "enableExport": false,   /* set to false to hide Export to Excel */
              "scrollThreshold": 300,  /* default: 300; change for dynamic loading while scrolling */
              "rememberSelections": false, /* row selection persists across refresh? true/false */
              "showRowCount": true
            }
          }
        }
      }
    ]
  }
}
```

STEP: 6 — Table column properties (column-level UI adaptation example)
DESCRIPTION: Example column-level configuration for smart table columns (visibility, width, autoResizable, inResult, sort, sum). Apply in UI adaptation or manifest-based column config where supported.
LANGUAGE: JSON
CODE:
```JSON
/* Column-level snippet (merge into tableSettings.columns or UI adaptation patch) */
{
  "tableSettings": {
    "columns": [
      {
        "id": "ProductColumn",
        "property": "Product",
        "visible": false,
        "width": "200px",
        "autoResizable": true,
        "inResult": true,
        "resizable": true,
        "showSortMenuEntry": true,
        "sortOrder": "Ascending", /* "Ascending" or "Descending" */
        "sorted": true,
        "summed": false
      },
      {
        "id": "SalesColumn",
        "property": "SalesAmount",
        "visible": true,
        "width": "140px",
        "autoResizable": false,
        "inResult": true,
        "resizable": true,
        "showSortMenuEntry": true,
        "sortOrder": "Descending",
        "sorted": false,
        "summed": true
      }
    ]
  }
}
```

STEP: 7 — Visual Filters dialog (button / micro-chart properties)
DESCRIPTION: Configure Adapt Filters dialog buttons and micro charts (visibility, width, icon, activeIcon, text, busy, enabled, blocked).
LANGUAGE: JSON
CODE:
```JSON
/* Visual Filter (Adapt Filters) button examples to include in UI adaptation or manifest "settings" where supported */
{
  "visualFilter": {
    "buttons": [
      {
        "id": "MyVFButton1",
        "visible": true,
        "width": "120px",
        "icon": "sap-icon://filter",
        "activeIcon": "sap-icon://filter-accept",
        "text": "Custom Filter",
        "busy": false,
        "enabled": true,
        "blocked": false
      },
      {
        "id": "MyVFButton2",
        "visible": false,
        "width": "100px",
        "icon": "sap-icon://add",
        "text": "Hidden Button",
        "enabled": false
      }
    ],
    "microCharts": [
      {
        "id": "MyMicroChart",
        "visible": true,
        "width": "180px"
      }
    ]
  }
}
```
--------------------------------

**TITLE**: UI Adaptations for List Report and Object Page (Fiori elements — OData V2)

**INTRODUCTION**: Practical, code-focused examples showing how to adapt list-report and object-page UI elements (table and layout properties, filter bar, header, and actions). Use these XML and JSON snippets in your app fragments or manifest.json when modifying controls directly (recommended when Page Editor does not support the change). File paths referenced assume a typical UI5 project (webapp/fragment, webapp/view, manifest.json).

**TAGS**: fiori-elements, ui5, list-report, object-page, smarttable, smartfilterbar, manifest, fragment, dynamicpage, objectpagelayout

STEP: 1 — Enable/Disable "Export to Excel" button (SmartTable)
DESCRIPTION: Set the SmartTable enableExport property to show/hide the Export button in table toolbars (applies to list report or object page smart tables).
LANGUAGE: XML
CODE:
```XML
<!-- file: webapp/fragment/ListReport.fragment.xml or ObjectPage.fragment.xml -->
<smartTable:SmartTable
  id="SmartTable"
  entitySet="MyEntitySet"
  smartFilterId="SmartFilterBar"
  tableType="ResponsiveTable"
  enableExport="true"   <!-- set to "false" to hide -->
  useExportToExcel="true"
  persistencyKey="MySmartTablePersistencyKey">
  <!-- inner table / columns -->
</smartTable:SmartTable>
```

STEP: 2 — Change column width and horizontal alignment (columns defined in fragment)
DESCRIPTION: Define width and horizontal alignment for columns in fragment XML. Note: custom columns must be edited in the fragment (Page Editor does not support changing custom column widths/hAlign).
LANGUAGE: XML
CODE:
```XML
<!-- file: webapp/fragment/ListReport.fragment.xml -->
<Table:columns>
  <!-- For sap.m.Table / responsive table column -->
  <Column
    id="colName"
    width="180px"
    hAlign="Center">   <!-- hAlign values: Left, Center, Right -->
    <Text text="Column Title"/>
  </Column>
</Table:columns>

<!-- For SmartTable with annotation-based columns: use a fragment for templating custom columns -->
<smartTable:SmartTable ...>
  <Table>
    <columns>
      <Column width="200px" hAlign="Center">
        <Text text="Custom Column"/>
      </Column>
      ...
    </columns>
  </Table>
</smartTable:SmartTable>
```

STEP: 3 — Dynamic page fitContent (prevent tables from occupying whole container)
DESCRIPTION: Set DynamicPage.fitContent to false to allow tables (analytical, grid, tree) not to expand to the full container.
LANGUAGE: XML
CODE:
```XML
<!-- file: webapp/view/ListReport.view.xml -->
<DynamicPage
  id="dynamicPage"
  fitContent="false">   <!-- default true for analytical/grid/tree tables -->
  <DynamicPageTitle>...</DynamicPageTitle>
  <DynamicPageHeader>...</DynamicPageHeader>
  <DynamicPageContent>...</DynamicPageContent>
</DynamicPage>
```

STEP: 4 — Change popinLayout for better readability with many columns
DESCRIPTION: Set the table popinLayout to Block, GridSmall, or GridLarge to change how columns are popped in on small screens.
LANGUAGE: XML
CODE:
```XML
<!-- file: webapp/fragment/ListReport.fragment.xml -->
<smartTable:SmartTable ...>
  <Table
    id="innerTable"
    popinLayout="GridSmall">  <!-- values: Block (default), GridSmall, GridLarge -->
    ...
  </Table>
</smartTable:SmartTable>
```

STEP: 5 — Change scrollThreshold / threshold / growingThreshold values
DESCRIPTION: Set scrolling and loading thresholds for grid, tree, analytical, and responsive tables. Default scrollThreshold = 300. Default growingThreshold for sap.m.Table = 10 (special single-section case default 20, cannot be changed).
LANGUAGE: XML
CODE:
```XML
<!-- file: webapp/fragment/ObjectPage.fragment.xml -->
<smartTable:SmartTable ...>
  <Table
    id="objectPageTable"
    growing="true"
    growingThreshold="15"    <!-- default 10; for single-section single-subsection default is 20 and cannot be changed -->
    threshold="50"           <!-- threshold for initial data loading (grid/tree/responsive/analytical) -->
    scrollThreshold="300">   <!-- default 300 -->
    ...
  </Table>
</smartTable:SmartTable>
```

STEP: 6 — Enable/disable SmartFilterBar live mode
DESCRIPTION: Toggle liveMode on the SmartFilterBar to execute filter requests on change (true) or require explicit search (false).
LANGUAGE: XML
CODE:
```XML
<!-- file: webapp/fragment/ListReport.fragment.xml -->
<smartFilterBar:SmartFilterBar
  id="SmartFilterBar"
  entitySet="MyEntitySet"
  liveMode="false">   <!-- set to true to enable live mode -->
</smartFilterBar:SmartFilterBar>
```

STEP: 7 — Persist or reset row selection (rememberSelections)
DESCRIPTION: Control whether selections in responsive tables persist after refresh/data update.
LANGUAGE: XML
CODE:
```XML
<!-- file: webapp/fragment/ListReport.fragment.xml -->
<Table
  id="responsiveTable"
  rememberSelections="true">  <!-- default false -->
  ...
</Table>
```

STEP: 8 — Object Page: header shape and layout properties
DESCRIPTION: Set avatar shape on DynamicHeaderTitle and layout properties on ObjectPageLayout (showAnchorBar, useIconTabBar, showHeaderContent, alwaysShowContentHeader).
LANGUAGE: XML
CODE:
```XML
<!-- file: webapp/fragment/ObjectPage.fragment.xml -->
<ObjectPageLayout
  id="objectPageLayout"
  showAnchorBar="false"            <!-- hide anchor bar -->
  useIconTabBar="true"             <!-- switch to tabs -->
  showHeaderContent="true"         <!-- show header content in edit mode -->
  alwaysShowContentHeader="true">  <!-- do not collapse headers on scroll (note: small devices still auto-collapse) -->

  <ObjectPageHeader>
    <DynamicHeaderTitle
      id="dynamicHeader"
      displayShape="Circle">        <!-- Circle or Square -->
      <title>
        <ObjectPageHeaderContent>...</ObjectPageHeaderContent>
      </title>
    </DynamicHeaderTitle>
  </ObjectPageHeader>

  ...
</ObjectPageLayout>
```

STEP: 9 — Make object page tables non-editable and set navigation mode
DESCRIPTION: By default, object page tables become editable when the page is in edit mode. To keep tables non-editable and enable full keyboard navigation, set editable="false" and inner table navigationMode="Navigation".
LANGUAGE: XML
CODE:
```XML
<!-- file: webapp/fragment/ObjectPage.fragment.xml -->
<smartTable:SmartTable ... editable="false">
  <!-- inner table for a SmartTable -->
  <Table
    id="innerTable"
    navigationMode="Navigation">  <!-- ensures keyboard navigation across focusable content -->
    ...
  </Table>
</smartTable:SmartTable>
```

STEP: 10 — Enable Include Item In Selection for tables
DESCRIPTION: Keep the item selection active even when a user navigates away from the table by setting includeItemInSelection to true.
LANGUAGE: XML
CODE:
```XML
<!-- file: webapp/fragment/ObjectPage.fragment.xml -->
<Table
  id="myTable"
  includeItemInSelection="true">
  ...
</Table>
```

STEP: 11 — Change "Save and Edit" action visibility in manifest (binding to ui>/editable)
DESCRIPTION: In the manifest.json pages/actions definition for an Object Page, set the Footer action "Save and Edit" visible property to bind to {ui>/editable}. This keeps the action visible only when the UI model indicates editability.
LANGUAGE: JSON
CODE:
```JSON
/* file: manifest.json (relevant excerpt) */
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "actions": {
              "Footer": {
                "Save and Edit": {
                  "visible": "{ui>/editable}"
                }
              }
            }
          }
        },
        "entitySet": "MyEntitySet"
      }
    ]
  }
}
```

STEP: 12 — Notes on Page Editor vs direct code edits
DESCRIPTION: Use SAP Fiori tools Page Editor to set many properties visually (they map to the control/property names without spaces). When Page Editor does not support a change (custom columns, some inner controls), edit the fragment XML or manifest.json directly in the project (e.g., webapp/fragment/*.fragment.xml, webapp/view/*.view.xml, manifest.json). Preserve property names as in code: enableExport, fitContent, popinLayout, scrollThreshold, liveMode, rememberSelections, displayShape, showAnchorBar, useIconTabBar, showHeaderContent, alwaysShowContentHeader, growingThreshold, editable, includeItemInSelection, threshold.
--------------------------------

**TITLE**: Adapting Transient Messages from the Back End (Fiori elements, OData V2)

**INTRODUCTION**: Use the adaptTransientMessageExtension controller extension to intercept and adapt transient messages (from the backend) before they are displayed on List Report, Object Page, and Analytical List Page in SAP Fiori elements (OData V2). This guide shows how to register the controller extension in manifest.json and implement adaptTransientMessageExtension to add or modify transient messages safely.

**TAGS**: fiori-elements-framework, sap-ui5, extension, transient-messages, odata-v2, list-report, object-page, analytical-list-page, controller-extension

**STEP**: 1 — Register the controller extension in manifest.json

**DESCRIPTION**: Add the controller extension registration to your app's manifest.json. Place this under the sap.ui5 section. The key to use depends on the view/controller you extend (example below shows List Report). Replace controllerName with your module path.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "STTA_MP.ext.controller.ListReportExtension"
          }
          /* For Object Page:
             "sap.suite.ui.generic.template.ObjectPage.view.Details": {
               "controllerName": "STTA_MP.ext.controller.ObjectPageExtension"
             }
             For Analytical List Page:
             "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
               "controllerName": "STTA_MP.ext.controller.AnalyticalListPageExtension"
             }
          */
        }
      }
    }
  }
}
```

**STEP**: 2 — Implement adaptTransientMessageExtension in the controller extension

**DESCRIPTION**: Create the controller extension module referenced in manifest.json. Implement the adaptTransientMessageExtension function. This function is invoked always before a transient message is displayed. Use only the SAP Fiori elements extensionAPI and the sap/ui/core/Messaging API for message handling. Do not modify state messages (Messaging.getMessageManager().getMessageModel()) and do not change message targets—changing targets can break message model services.

Example implementation (adds a consolidated transient Information message when any transient message exists):

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/controller/ListReportExtension.js
sap.ui.define([
  "sap/ui/core/Messaging",
  "sap/ui/core/message/Message",
  "sap/ui/core/MessageType"
], function(Messaging, Message, MessageType) {
  "use strict";

  return {
    /**
     * Called by the framework before transient messages are displayed.
     * Add or adapt transient messages here. Only manipulate the transient
     * message model returned by Messaging.getMessageModel().
     */
    adaptTransientMessageExtension: function() {
      // Get the transient message model
      var oTransientMessageModel = Messaging.getMessageModel();

      // Defensive check: ensure model exists and has data
      if (oTransientMessageModel && oTransientMessageModel.oData && oTransientMessageModel.oData.length) {
        var sMsgText = "This message has been added through List Extension";

        // Create a new transient message (do NOT change the target of other messages)
        var oConsolidatedMessage = new Message({
          message: sMsgText,
          type: MessageType.Information,
          target: "",      // keep empty for app-level transient message
          persistent: true
        });

        // Add the message to transient message model
        Messaging.addMessages(oConsolidatedMessage);
      }
    }
  };
});
```

**STEP**: 3 — Important notes and cautions

**DESCRIPTION**: Keep these rules when implementing extensions:
- This topic applies only to SAP Fiori elements for OData V2.
- The adaptTransientMessageExtension is called only for transient messages. Do not change state messages from Messaging.getMessageManager().getMessageModel().
- Do not alter the target property of existing messages or message model internals—this can break message handling and message services.
- If your app uses Flexible Column Layout (FCL), the extension points for List Report, Object Page, and Analytical List Page may all be invoked; ensure your logic accounts for which page(s) require adaptation.
- Prefer manifest settings and annotations over extensions. Use controller extensions only when necessary, and limit interactions to the extensionAPI and documented Messaging APIs.
--------------------------------

**TITLE**: Add a Chart Facet to an Object Page (UI.ReferenceFacet → UI.Chart)

**INTRODUCTION**: Show how to add a chart facet to an Object Page content section by using UI.Facet / UI.ReferenceFacet and referencing a UI.PresentationVariant that contains a UI.Chart visualization. Includes XML (OData V4), ABAP CDS and CAP CDS examples. Notes OData V2 limitation.

**TAGS**: fiori-elements-framework, annotations, UI.Chart, UI.ReferenceFacet, UI.PresentationVariant, OData V4, OData V2, ABAP, CAP, XML, CDS

STEP: 1 — Core pattern (Object Page facet pointing to a PresentationVariant)
DESCRIPTION: Add a ReferenceFacet entry inside UI.Facets that targets the PresentationVariant holding the Chart (ReferenceFacet.Target set to the PresentationVariant annotation path). This places the chart inside a content section of the object page.
LANGUAGE: XML
CODE:
```xml
<!-- Annotations.xml (OData V4) -->
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="UI.Facets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Items"/>
        <PropertyValue Property="ID" String="SalesOrderItems"/>
        <!-- Point to the PresentationVariant on the navigation property or nested element -->
        <PropertyValue Property="Target" AnnotationPath="_Item/@UI.PresentationVariant"/>
        <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: 2 — Define the PresentationVariant with the Chart as first visualization (OData V4)
DESCRIPTION: Define a UI.PresentationVariant on the target (navigation property or element) and include the chart as the first entry in Visualizations. This makes the chart the primary visualization displayed in the facet.
LANGUAGE: XML
CODE:
```xml
<!-- Annotations.xml (OData V4) - PresentationVariant on the targeted element -->
<Annotations Target="MyService._Item">
  <Annotation Term="UI.PresentationVariant">
    <Record Type="UI.PresentationVariantType">
      <PropertyValue Property="SortOrder">
        <Collection>
          <Record Type="Common.SortOrderType">
            <PropertyValue Property="Property" PropertyPath="SalesOrderItem"/>
            <PropertyValue Property="Descending" Bool="true"/>
          </Record>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Visualizations">
        <Collection>
          <!-- Chart first -->
          <AnnotationPath>@UI.Chart</AnnotationPath>
          <!-- Fallback or alternate visualization -->
          <AnnotationPath>@UI.LineItem</AnnotationPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 3 — Note: OData V2 limitation
DESCRIPTION: If using SAP Fiori Elements for OData V2, the Object Page does not support UI.Chart with qualifiers in the same way as V4. Do not rely on UI.Chart qualifiers for V2 object page facets; prefer V4 PresentationVariant approach or check product documentation for V2-specific chart support.
LANGUAGE: TEXT
CODE:
```text
Restriction: Object Page (OData V2) does not support UI.Chart with qualifier-based usage for ReferenceFacet targets.
```

STEP: 4 — ABAP CDS: ReferenceFacet via UI.facet and PresentationVariant
DESCRIPTION: Use ABAP CDS annotations to create a PresentationVariant with a chart visualization and a UI.facet entry that references the target element. The PresentationVariant must list visualizations with the chart as the first type.
LANGUAGE: ABAP
CODE:
```abap
@UI.facet: [
  {
    id:           'SalesOrderItems',
    label:        'Items',
    type:         #PRESENTATIONVARIANT_REFERENCE,
    purpose:      #STANDARD,
    targetElement: '_Item',
    importance:   #HIGH
  }
]
@UI.PresentationVariant: [
  {
    sortOrder: [
      {
        by: 'SalesOrderItem',
        direction: #DESC
      }
    ],
    visualizations: [
      { type: #AS_CHART },
      { type: #AS_LINEITEM }
    ]
  }
]
annotate view VIEWNAME with {
  // additional field-level annotations if required
}
```

STEP: 5 — CAP CDS (service-level JSON/CDS representation)
DESCRIPTION: Example CAP CDS (JSON-like) snippet showing a UI.ReferenceFacet object and a UI.PresentationVariant that lists '@UI.Chart' first, then '@UI.LineItem'.
LANGUAGE: CDS
CODE:
```cds
// Example CAP CDS annotations (in annotations JSON or CDS format)
{
  $Type             : 'UI.ReferenceFacet',
  Label             : 'Items',
  ID                : 'SalesOrderItems',
  Target            : '_Item/@UI.PresentationVariant',
  ![@UI.Importance] : #High
}

UI.PresentationVariant: {
  SortOrder : [
    {
      $Type    : 'Common.SortOrderType',
      Property : SalesOrderItem,
      Descending : true
    }
  ],
  Visualizations : [
    '@UI.Chart',
    '@UI.LineItem'
  ]
}
```
--------------------------------

**TITLE**: Add a Contact Facet / Contact Card (OData V2 & V4) for SAP Fiori Elements

**INTRODUCTION**: This document shows how to add a contact facet (ReferenceFacet / contact card) to an Object Page or LineItem column. It includes concrete XML, ABAP CDS and CAP CDS examples for OData V2 and V4, plus the required Communication.Contact annotation to populate the contact card. Use these snippets to:
- render a contact link (smart link / reference facet)
- configure the popover contact card contents (fn, title, photo, role, org, adr, email, tel)
- map fields and supported types

**TAGS**: fiori-elements-framework, odata-v2, odata-v4, annotations, contact, ui.referencefacet, communication.contact, cds, abap, cap, xml, lineitem

STEP: 1 — Add a ReferenceFacet (OData V2) to show a Contact facet on an Object Page
DESCRIPTION: Add a UI.ReferenceFacet that points to a Contact annotation via a Navigation property. Place this in your UI annotations XML or ABAP CDS facet declaration for the entity (e.g., product).
LANGUAGE: XML
CODE:
```xml
<Record Type="UI.ReferenceFacet">
   <PropertyValue Property="Label" String="Supplier"/>
   <PropertyValue AnnotationPath="to_Supplier/@Communication.Contact" Property="Target"/>
</Record>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.facet: [
 {
  label: 'Supplier',
  type:         #CONTACT_REFERENCE,
  targetElement: '_Supplier',
  purpose: #STANDARD
 }
]
product;
```

STEP: 2 — Define the Contact annotation (Communication.Contact) for OData V2 (XML)
DESCRIPTION: Add a Communication.Contact annotation to the type or entity that represents the contact (e.g., EmployeeType). Map properties: fn (full name), title, org, role, n (name parts), photo, tel (collection), email (collection). Use Path values to map to your entity fields.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SEPMRA_PROD_MAN.SEPMRA_I_EmployeeType">
  <Annotation Term="Communication.Contact">
    <Record>
      <PropertyValue Property="fn" Path="FormattedName"/>
      <PropertyValue Property="title" Path="JobTitle"/>
      <PropertyValue Property="org" Path="CompanyName"/>
      <PropertyValue Property="role" Path="OrganizationRole"/>
      <PropertyValue Property="n">
        <Record>
          <PropertyValue Property="given" Path="FirstName"/>
          <PropertyValue Property="additional" Path="MiddleName"/>
          <PropertyValue Property="surname" Path="LastName"/>
        </Record>
      </PropertyValue>
      <PropertyValue Property="photo" Path="EmployeePictureURL"/>
      <PropertyValue Property="tel">
        <Collection>
          <Record>
            <PropertyValue Property="type" EnumMember="Communication.PhoneType/fax"/>
            <PropertyValue Property="uri" Path="FaxNumber"/>
          </Record>
          <Record>
            <PropertyValue Property="type" EnumMember="Communication.PhoneType/cell"/>
            <PropertyValue Property="uri" Path="MobilePhoneNumber"/>
          </Record>
          <Record>
            <PropertyValue Property="type" EnumMember="Communication.PhoneType/work"/>
            <PropertyValue Property="uri" Path="PhoneNumber"/>
          </Record>
          <Record>
            <PropertyValue Property="type" EnumMember=""/>
            <PropertyValue Property="address" Path="FaxNumber"/>
          </Record>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="email">
        <Collection>
          <Record>
            <PropertyValue Property="type" EnumMember="Communication.ContactInformationType/work"/>
            <PropertyValue Property="address" Path="EmailAddress"/>
          </Record>
        </Collection> 
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
define view VIEWNAME
{
  @Semantics.name.fullName: true
  FormattedName,

  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK]
  EmailAddress,
   
  @Semantics.telephone.type:  [ #FAX ] 
  FaxNumber,

  @Semantics.telephone.type:  [ #CELL ]
  MobilePhoneNumber,
  
  @Semantics.telephone.type:  [ #WORK]
  PhoneNumber,

  @Semantics.name: { jobTitle: true }   
  JobTitle,

  @Semantics.organization: { name: true }
  CompanyName,

  @Semantics.organization: { role: true, unit: true }
  OrganizationRole,

  @Semantics.name: { givenName: true }   
  FirstName,

  @Semantics.name: { additionalName: true }   
  MiddleName,

  @Semantics.name: { familyName: true }   
  LastName,

  @Semantics.address : { city: true }  
  City,

  @Semantics.contact.photo: true
  EmployeePictureURL
}
```

STEP: 3 — Add a LineItem DataFieldForAnnotation (OData V4) to create a Contact smart link column
DESCRIPTION: For OData V4, use UI.DataFieldForAnnotation in the LineItem to render a column whose Target is supplier/@Communication.Contact. This creates a link that opens the contact popover/card when clicked.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="clouds.products.CatalogService.Products">
    <Annotation Term="UI.LineItem">
        <Collection>
            <Record Type="UI.DataFieldForAnnotation">
                <PropertyValue Property="Label" String="Supplier"/>
                <PropertyValue Property="Target" AnnotationPath="supplier/@Communication.Contact"/>
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view PRODUCTS.CATALOGSERVICE.PRODUCTS with {

@UI.lineItem: [
  {
    label: 'Supplier',
    value: 'SUPPLIER',
    type: #AS_CONTACT,
    position: 1 
  }
]

test;
}
```

LANGUAGE: CAP CDS
CODE:
```cds
LineItem : [
    {
        $Type  : 'UI.DataFieldForAnnotation',
        Target : 'supplier/@Communication.Contact',
        Label  : 'Supplier'
    }]
```

STEP: 4 — Add Communication.Contact on the Supplier EntitySet (OData V4) to populate the card
DESCRIPTION: Add a Communication.Contact annotation to the EntitySet/entity that the Navigation property points to (e.g., Suppliers). Map fn, email, tel, etc., to the supplier fields so the contact card shows those values in the popover.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="clouds.products.CatalogService.Suppliers">
    <Annotation Term="Communication.Contact">
        <Record Type="Communication.ContactType">
            <PropertyValue Property="email">
                <Collection>
                    <Record Type="Communication.EmailAddressType">
                        <PropertyValue Property="type">
                            <EnumMember>Communication.ContactInformationType/work</EnumMember>
                        </PropertyValue>
                        <PropertyValue Property="address">
                            <Path>emailAddress</Path>
                        </PropertyValue>
                    </Record>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="fn">
                <Path>name</Path>
            </PropertyValue>
            <PropertyValue Property="tel">
                <Collection>
                    <Record Type="Communication.PhoneNumberType">
                        <PropertyValue Property="type">
                            <EnumMember>Communication.PhoneType/fax</EnumMember>
                        </PropertyValue>
                        <PropertyValue Property="uri">
                            <Path>faxNumber</Path>
                        </PropertyValue>
                    </Record>
                    <Record Type="Communication.PhoneNumberType">
                        <PropertyValue Property="type">
                            <EnumMember>Communication.PhoneType/work</EnumMember>
                        </PropertyValue>
                        <PropertyValue Property="uri">
                            <Path>phoneNumber</Path>
                        </PropertyValue>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
define view Suppliers
{
  @Semantics.name.fullName: true
  name,

  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK]
  emailAddress,
   
  @Semantics.telephone.type:  [ #FAX ] 
  FaxNumber,
  
  @Semantics.telephone.type:  [ #WORK]
  PhoneNumber
}
```

LANGUAGE: CAP CDS
CODE:
```cds
FieldGroup #HeaderGeneralInformation : { Data : [{
    $Type  : 'UI.DataFieldForAnnotation',
    Target : '_SoldToParty/@Communication.Contact',
    Label  : 'Contact Info'
}]},

entity Customer @( 
    cds.autoexpose,
    title                  : 'Sold-to Party',
    Communication.Contact  : {
        email : [{
            type    : #work,
            address : EmailAddress
        }],
        fn    : CustomerName,
        tel   : [{
            type : #fax,
            uri  : InternationalPhoneNumber
        }],
        adr   : [{
            type     : #work,
            code     : PostalCode,
            country  : Country,
            locality : CityName
        }]
    },
    Common.IsNaturalPerson : true
)
```

STEP: 5 — Field behavior, types, and UI notes (applies to both V2 & V4)
DESCRIPTION: Use these mapping and UI behavior rules when constructing the annotation:
- fn: displayed as card title (full name).
- title: job title displayed below the title.
- photo: displayed in card header; if absent, fallback icon is shown.
- role, org, adr: displayed in card content.
- adr: address must follow addressType definition; display order is street, code, locality, region, country as a comma-separated string. If adr includes label, only label is shown and other address fields are ignored.
- email/mail: collection of addresses with types. Supported types: preferred, work. Rendered as mailto: links in the card; clicking opens email client.
- tel: collection of phone numbers with types. Supported types include fax (#fax), preferred, cell, work. Rendered as tel: links; clicking opens phone application if the browser supports it. Use EnumMember Communication.PhoneType/fax to indicate fax.
- Where to add annotations: place ReferenceFacet / DataFieldForAnnotation on the referencing entity (object page or line item). Place Communication.Contact on the target entity (the Navigation EntitySet / Supplier entity) referenced by the Navigation property.
- Tip: If no @Contact.photo (or @Semantics.contact.photo) is provided, a fallback contact icon is displayed.

STEP: 6 — Implementation checklist (developer actions)
DESCRIPTION: Quick actionable checklist to implement:
- Add UI.ReferenceFacet (V2) or UI.DataFieldForAnnotation (V4) to the referencing annotations (Object Page facet or LineItem).
- Ensure the Target/AnnotationPath points to your Navigation property followed by @Communication.Contact (e.g., supplier/@Communication.Contact).
- Add Communication.Contact annotation to the target entity or entity type (Suppliers / EmployeeType) mapping all used fields (fn, title, photo, tel, email, adr, org, role).
- Use proper EnumMember values for tel/email types (Communication.PhoneType/*, Communication.ContactInformationType/*).
- Test: open object page or click smart link in line item to verify popover shows expected values and links (mailto:, tel:), and photo fallback if photo missing.
--------------------------------

**TITLE**: Add a Contact Quick View to a Table Using @Communication.Contact

**INTRODUCTION**: Enable a contact quick view (contact card popover) for a supplier column in a table by adding a UI.LineItem entry that references @Communication.Contact on the supplier entity/type. This document provides ready-to-use annotation examples for OData XML annotations, ABAP CDS, and CAP CDS and explains where to place them.

**TAGS**: fiori-elements-framework, annotations, Communication.Contact, UI.LineItem, OData, SAP, CDS, XML, CAP, ABAP

**STEP**: 1 — Add a DataFieldForAnnotation pointing to @Communication.Contact in UI.LineItem (ProductType / Product entity)

**DESCRIPTION**: Add a DataFieldForAnnotation entry to the UI.LineItem of your ProductType (or product entity) that targets the navigation property to Supplier and references the Communication.Contact annotation. Place this in your service annotations file (annotations.xml) or in your CDS view's @UI.lineItem definition depending on your stack.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Place in your OData Vocab annotations file (e.g., annotations.xml).
     Add under the ProductType entity UI.LineItem collection. -->
<Annotation Term="UI.LineItem">
    <Collection>
        ...
        <Record Type="UI.DataFieldForAnnotation">
            <PropertyValue Property="Label" String="{@i18n>Supplier}"/>
            <!-- Reference navigation property to Supplier and its Communication.Contact annotation -->
            <PropertyValue Property="Target" AnnotationPath="to_Supplier/@Communication.Contact"/>
            <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
        </Record>
        ...
    </Collection>
</Annotation>
```

**LANGUAGE**: ABAP

**CODE**:
```abap
" Place in your ABAP CDS view definition for the PRODUCT entity (use @UI.lineItem).
@UI.lineItem: [
  ...
  {
    importance: #HIGH,
    label: '{@i18n>@Supplier}',
    value: 'TO_SUPPLIER',        " navigation property to supplier
    type: #AS_CONTACT,           " indicates contact quick view
    position: 6
  },
  ...
]
TO_SUPPLIER;
```

**LANGUAGE**: CDS

**CODE**:
```cds
// CAP CDS / Service CDS, add to UI.LineItem for Product entity
UI.LineItem : [
  ...
  {
    $Type : 'UI.DataFieldForAnnotation',
    Label : '{@i18n>@Supplier}',
    Target : 'to_Supplier/@Communication.Contact',
    ![@UI.Importance] : #High
  },
  ...
]
```

**STEP**: 2 — Define the @Communication.Contact term on the Supplier type/entity

**DESCRIPTION**: Implement the Communication.Contact annotation on the Supplier (SupplierType) entity/type. This associates display name (fn), telephone numbers (tel) and emails (email) that the UI uses to render the contact quick view. Add this to the SupplierType annotations in your OData XML file, ABAP CDS view, or CAP CDS definition.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Add under the SupplierType entity annotations in your OData annotations file -->
<Annotation Term="Communication.Contact">
    <Record>
        <PropertyValue Property="fn" Path="CompanyName" />
        <PropertyValue Property="tel">
            <Collection>
                <Record>
                    <PropertyValue Property="type"
                                   EnumMember="Communication.PhoneType/fax" />
                    <PropertyValue Property="uri" Path="FaxNumber" />
                </Record>
                <Record>
                    <PropertyValue Property="type"
                                   EnumMember="Communication.PhoneType/preferred Communication.PhoneType/work" />
                    <PropertyValue Property="uri" Path="PhoneNumber" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="email">
            <Collection>
                <Record>
                    <PropertyValue Property="type"
                                   EnumMember="Communication.ContactInformationType/work Communication.ContactInformationType/pref" />
                    <PropertyValue Property="address" Path="EmailAddress" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP

**CODE**:
```abap
" Annotate fields in the supplier CDS view so @Communication.Contact is inferred/available.
define view VIEWNAME
{
  @Semantics.name.fullName: true
  CompanyName,

  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK]
  EmailAddress,
   
  @Semantics.telephone.type:  [ #FAX ] 
  FaxNumber,
  
  @Semantics.telephone.type:  [ #WORK]
  PhoneNumber
}
```

**LANGUAGE**: CDS

**CODE**:
```cds
// CAP CDS: explicit Communication.Contact structure for the Supplier type
Communication.Contact : {
    fn : CompanyName,
    tel : [
        {
            type : #fax,
            uri : FaxNumber
        },
        {
            type : [ #preferred, #work ],
            uri : PhoneNumber
        }
    ],
    email : [
        {
            type : [ #work, #pref ],
            address : EmailAddress
        }
    ]
}
```

**STEP**: 3 — Verify and test in Fiori Elements

**DESCRIPTION**: After adding the annotations:
- Ensure the UI.LineItem entry is placed in the product/list entity annotations (annotations.xml or CDS @UI.lineItem).
- Ensure the Communication.Contact annotation is attached to the Supplier type/entity (annotations file or CDS).
- Redeploy or refresh the metadata/annotations and open the Fiori Elements app.
- The Supplier column should render as a contact link that opens the quick view/ contact popover showing fn, phone(s), and email(s).

**LANGUAGE**: Notes

**CODE**:
```text
- XML: place UI.LineItem under ProductType entity in your service annotations file (e.g., annotations.xml).
- ABAP CDS: add @UI.lineItem entries inside the CDS view for the Product entity and annotate the Supplier CDS view with semantics.
- CAP CDS: add UI.LineItem to the service annotations.cds and define Communication.Contact on the Supplier entity/type.
- Target path example: AnnotationPath="to_Supplier/@Communication.Contact" or Target: 'to_Supplier/@Communication.Contact'
```
--------------------------------

**TITLE**: Adding a Custom Message Strip to List Report, Analytical List Page and Object Page Tables

**INTRODUCTION**: This document shows how to programmatically display a custom message strip above tables in Fiori Elements List Reports, Analytical List Pages (ALP) and Object Page tables. It covers OData V2 and V4 extension APIs, tab-scoped messages, object page table ID usage, message types, and an optional close-callback.

**TAGS**: fiori-elements-framework, odata-v2, odata-v4, extension-api, setCustomMessage, list-report, analytical-list-page, object-page, message-strip, ui5

**STEP**: 1 — OData V2: Add a custom message in List Report / Analytical List Page

**DESCRIPTION**: In your controller extension (ListReportExtension.controller.js or AnalyticalListPageExt.controller.js), call this.extensionAPI.setCustomMessage(...) inside onBeforeRebindTableExtension to display a custom message above the table. The first parameter is a message object containing message (string) and type (sap.ui.core.MessageType.*). Without additional parameters the message is shown on all tabs.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// ListReportExtension.controller.js  OR  AnalyticalListPageExt.controller.js
onBeforeRebindTableExtension: function (oEvent) {
    if (this.extensionAPI && this.extensionAPI.setCustomMessage) {
        var oMessage = {
            message: "Custom message on table",
            type: sap.ui.core.MessageType.Success // Success | Warning | Error | Information
        };

        // Show message on all tabs (omit tabKey)
        this.extensionAPI.setCustomMessage(oMessage);
    }
}
```

**STEP**: 2 — OData V2: Show messages only for specific tabs (single or multiple)

**DESCRIPTION**: When your app uses multiple tabs, pass a tabKey string or an array of tabKey strings as the second parameter to limit which tabs show the custom message. If no tabKey is provided, the message displays in all tabs.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Single tab (tabKey = "1")
this.extensionAPI.setCustomMessage(oMessage, "1");

// Multiple tabs (tabKey = ["1","2"])
this.extensionAPI.setCustomMessage(oMessage, ["1", "2"]);

// All tabs (omit tabKey)
this.extensionAPI.setCustomMessage(oMessage);
```

**STEP**: 3 — OData V2: Multiple custom messages for different object page tabs (use table ID + tab ID)

**DESCRIPTION**: For object pages with multiple tabs, call setCustomMessage for the same table ID but different tab identifiers to show different messages per tab. The table ID parameter identifies which table on the object page receives the message. Example shows two messages for two tabs.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// ObjectPageExtension.controller.js
onBeforeRebindTableExtension: function () {
    if (this.extensionAPI && this.extensionAPI.setCustomMessage) {
        var oMsg1 = {
            message: "Custom message on object page tab 1",
            type: sap.ui.core.MessageType.Success
        };
        var oMsg2 = {
            message: "Custom message on object page tab 2",
            type: sap.ui.core.MessageType.Error
        };

        // Replace the tableId string below with your actual table ID
        var sTableId = "STTASOMVLR::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20--SalesOrderItemsID::Table";

        // Display messages on specific tabs (tab identifiers e.g. "_tab1", "_tab2")
        this.extensionAPI.setCustomMessage(oMsg1, sTableId, "_tab1");
        this.extensionAPI.setCustomMessage(oMsg2, sTableId, "_tab2");
    }
}
```

**STEP**: 4 — OData V2: Message object and supported message types

**DESCRIPTION**: The setCustomMessage function (OData V2) accepts:
- message object: { message: string, type: sap.ui.core.MessageType.* }
- optional tabKey: string or array of strings (tab identifiers)
Supported types:
- sap.ui.core.MessageType.Success
- sap.ui.core.MessageType.Warning
- sap.ui.core.MessageType.Error
- sap.ui.core.MessageType.Information

**LANGUAGE**: JavaScript

**CODE**:
```javascript
var oMessage = {
    message: "Example message",
    type: sap.ui.core.MessageType.Warning
};
this.extensionAPI.setCustomMessage(oMessage, "1"); // tab key optional
```

**STEP**: 5 — OData V2: Restriction

**DESCRIPTION**: Do not use this extension API in multiple-view scenarios. It is not supported for smart charts and smart lists.

**LANGUAGE**: Text

**CODE**:
```text
Restriction: Not recommended for multiple view scenarios. Not supported for smart charts and smart lists.
```

**STEP**: 6 — OData V4: Add a custom message in List Report / Analytical List Page (with onClose callback)

**DESCRIPTION**: In OData V4, use the ListReport controller extension (extension API accessed via this.base.getExtensionAPI()) and call setCustomMessage(messageObj?, tabKey?, onClose?). The optional onClose function is executed when the user closes the custom message. Omitting the message object removes existing messages. Passing null for tabKey displays the message in all tabs; pass an array or string to restrict to specific tab keys.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example inside routing.onAfterBinding or in a controller extension
routing: {
    onAfterBinding: function (oBindingContext, mParameters) {
        var oMessage = {
            message: "onAfterBinding: Context bound. Have a nice day",
            type: sap.ui.core.MessageType.Information
        };

        var extensionAPI = this.base.getExtensionAPI();

        function fnOnClose() {
            // optional callback invoked when the message strip is closed
            sap.m.MessageToast.show("Custom message closed");
        }

        // setCustomMessage(messageObj, tabKey, onClose)
        // tabKey: null -> all tabs; or string / array for specific tabs
        extensionAPI.setCustomMessage(oMessage, null, fnOnClose);
    }
}
```

**STEP**: 7 — OData V4: Add a custom message to Object Page table using Table building block

**DESCRIPTION**: For object pages in OData V4, use the Table building block public API. Call addMessage(...) on the Table building block to attach messages to the object page table. See the Fiori Building Blocks Table API for examples and behavior.

**LANGUAGE**: Reference / JavaScript

**CODE**:
```javascript
// Example pattern (Table building block API)
// Pseudocode: adapt to your table building block instance in the component/controller
var oTableBB = this.byId("YourTableBuildingBlockId"); // get the Table building block instance
var oMessage = {
    message: "Custom message on object page table",
    type: sap.ui.core.MessageType.Success
};
// addMessage API available on Table building block (refer to official Building Blocks documentation)
oTableBB.addMessage(oMessage);
```

**STEP**: 8 — References and further reading

**DESCRIPTION**: Use these links for deep dives and live API examples:
- Table building block public APIs: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/tablePublicAPIs
- Extending List Reports and Object Pages Using App Extensions (Fiori Elements)
- Configuring Analytical List Page App Extensions (Fiori Elements)

**LANGUAGE**: Text

**CODE**:
```text
Related docs:
- Extending List Reports and Object Pages Using App Extensions
- Configuring Analytical List Page App Extensions
- Building Blocks - Table - Extensions - Table APIs (live examples)
```
--------------------------------

**TITLE**: Add a Custom Section to an Object Page (SAP Fiori Elements — OData V2 & V4)

**INTRODUCTION**: This guide provides concise, code-focused steps to add custom sections (facets) to an Object Page in SAP Fiori Elements projects for both OData V2 and OData V4. It includes exact file locations, required XML/JS/JSON snippets, i18n entries, and how to merge section titles with control titles using the official extension API.

**TAGS**: fiori-elements, object-page, extension, manifest.json, fragment, i18n, ODataV2, ODataV4, extensionAPI

---

STEP: Caution — Use extensionAPI only

DESCRIPTION: Best practice reminder: implement app extensions only when annotations/manifest settings cannot achieve the behavior. Integrate code with SAP Fiori elements using only the official extensionAPI functions; do not manipulate internal framework controls or models directly.

LANGUAGE: Markdown

CODE:
```text
Caution: Use app extensions with caution. To correctly integrate with SAP Fiori elements, use only the extensionAPI.
```

---

STEP: (OData V2) Create fragment for the new facet (view)

DESCRIPTION: Create an XML view fragment under webapp/ext/view to render the custom facet contents (example: a read-only TextArea bound to a navigation property).

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/ext/view/DescriptionBreakout.view.xml -->
<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m">
  <VBox>
    <TextArea
      id="DescriptionTextArea"
      value="{to_ProductTextInOriginalLang/Description}"
      width="30%"
      editable="false"
    />
  </VBox>
</mvc:View>
```

---

STEP: (OData V2) Add section title to i18n properties

DESCRIPTION: Add a translatable title for the new section to your resource bundle (webapp/i18n/i18n.properties).

LANGUAGE: Properties

CODE:
```properties
# File: webapp/i18n/i18n.properties
# This is the resource bundle for Manage Products
# XTIT: Title of a facet within an object page if not needed in local/annotations.xml
ProductDescription=Product Description
```

---

STEP: (OData V2) Add viewExtension entry in manifest.json

DESCRIPTION: Register the custom section by extending the ObjectPage view via sap.ui.viewExtensions. Example inserts the new view after the GeneralInformation facet. For multiple occurrences or ordering, use the naming scheme WithAnnotation|EntitySet|AnnotationName and include a "key" inside sap.ui.generic.app when needed.

LANGUAGE: JSON

CODE:
```json
// Insert into your manifest.json root (merge into existing structure)
"extends": {
  "extensions": {
    "sap.ui.viewExtensions": {
      "sap.suite.ui.generic.template.ObjectPage.view.Details": {
        "AfterFacet|SEPMRA_C_PD_Product|GeneralInformation": {
          "className": "sap.ui.core.mvc.View",
          "viewName": "ManageProducts.ext.view.DescriptionBreakout",
          "type": "XML",
          "sap.ui.generic.app": {
            "title": "{{ProductDescription}}"
          }
        }
      }
    }
  }
}

/* Example: multiple sections and use of key
"AfterFacet|SEPMRA_C_PD_Product|to_Supplier::com.sap.vocabularies.UI.v1.Identification|1": {
  "className": "sap.ui.core.mvc.View",
  "viewName": "ManageProducts.ext.view.AfterFacetTest",
  "type": "XML",
  "sap.ui.generic.app": {
    "title": "Facet Breakout after Supplier Identification",
    "key": 1
  }
}
*/
```

---

STEP: (OData V2) Merge section title with control title (table/chart)

DESCRIPTION: To hide the section title and merge it into a control title (SmartTable or SmartChart), attach an initialise handler in the fragment and call the extensionAPI.setAsTitleOwner in the controller initialise handler.

LANGUAGE: XML + JavaScript

CODE:
```xml
<!-- Fragment snippet -->
<st:SmartTable id="SalesPriceFacetID" initialise="SalesPriceInitialise"/>
```

```javascript
// Controller snippet (e.g., webapp/ext/controller/YourExtension.controller.js)
SalesPriceInitialise: function(oEvent) {
  var oSmartTable = oEvent.getSource();
  // Use the official extensionAPI to set the control as title owner
  var oExtensionAPI = extensionAPI.getExtensionAPI(oSmartTable);
  oExtensionAPI.setAsTitleOwner(oSmartTable);
}
```

---

STEP: (OData V4) Create XML fragment for the new section

DESCRIPTION: Create a fragment under webapp/ext (CustomSection.fragment.xml) for the V4 object page. Use core:require when you need a local handler module for fragment event callbacks (button press, etc.).

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/ext/CustomSection.fragment.xml -->
<core:FragmentDefinition
  xmlns:core="sap.ui.core"
  xmlns="sap.m"
  xmlns:l="sap.ui.layout">
  <l:VerticalLayout core:require="{handler: 'SalesOrder/ext/CustomColumn'}">
    <Button text="Custom Button" press="handler.buttonPressed" />
  </l:VerticalLayout>
</core:FragmentDefinition>
```

---

STEP: (OData V4) Implement fragment handler module

DESCRIPTION: If your fragment requires a handler, implement it as an AMD module in webapp/ext (or the referenced path). This module exposes functions referenced by core:require.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/ext/CustomColumn.js  (module path: SalesOrder/ext/CustomColumn)
sap.ui.define(["sap/m/MessageBox"], function (MessageBox) {
  "use strict";

  return {
    buttonPressed: function () {
      MessageBox.show("Button pressed!");
    }
  };
});
```

---

STEP: (OData V4) Add section title to i18n properties

DESCRIPTION: Add the custom section title to webapp/i18n/i18n.properties for translation.

LANGUAGE: Properties

CODE:
```properties
# File: webapp/i18n/i18n.properties
#This is the resource bundle
# XTIT: Title of a facet within an object page
customSection=Custom Section
```

---

STEP: (OData V4) Register the custom section in manifest.json (routing.targets)

DESCRIPTION: Add the new section under routing.targets.<ObjectPageTarget>.options.settings.content.body.sections. You can position the section relative to an anchor using placement Before/After. Subsections can be defined using keys. IDs (customSection etc.) become control IDs.

LANGUAGE: JSON

CODE:
```json
// Insert into manifest.json under sap.ui5.routing.targets.<YourObjectPageTarget>.options.settings.content.body.sections
{
  "customSection": {
    "template": "SalesOrder.custom.CustomSection",
    "title": "{i18n>customSection}",
    "position": {
      "placement": "Before",
      "anchor": "SalesOrderItems"
    }
  },
  "anotherCustomSection": {
    "title": "Multiple Subsections",
    "subSections": {
      "firstSubSectionKey": {
        "title": "First Subsection",
        "template": "SalesOrder.custom.CustomFieldForm"
      },
      "secondSubSectionKey": {
        "title": "Second Subsection",
        "template": "SalesOrder.custom.CustomFieldForm2",
        "position": {
          "placement": "After",
          "anchor": "firstSubSectionKey"
        }
      }
    },
    "position": {
      "placement": "After",
      "anchor": "customSection"
    }
  }
}
```

---

STEP: (OData V4) Merge section title with control title (Page layout)

DESCRIPTION: For Page layout custom sections that use building blocks within a layout, define onSectionLoaded in the manifest to call a controller method when the section is loaded. In that method call the extension API to set the control as the section title owner (setAsSectionTitleOwner). Ensure you identify and pass the correct control.

LANGUAGE: JSON + JavaScript

CODE:
```json
// manifest.json: onSectionLoaded example under the section's config
"routing": {
  "targets": {
    "SalesOrderManageObjectPage": {
      "options": {
        "settings": {
          "sectionLayout": "Page",
          "content": {
            "body": {
              "sections": {
                "customSectionTableHBox": {
                  "template": "SalesOrder.custom.CustomSectionBuildingBlockTableHBox",
                  "title": "HBox Table",
                  "onSectionLoaded": "SalesOrder.custom.CustomSection.callShowSectionTitle"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

```javascript
// Custom controller method (e.g., webapp/ext/CustomSection.controller.js)
// This method is invoked by the framework with the section control as parameter.
callShowSectionTitle: function(section) {
  // locate the inner control to which the section title should be merged
  const control = section.getSubSections()[0].getBlocks()[0].getContent().getItems()[0];
  // call the extension API helper exposed on the controller to set the section title owner
  this.setAsSectionTitleOwner(control);
}
```

Notes:
- The exact path and name used in manifest (e.g., "SalesOrder.custom.CustomSection.callShowSectionTitle") must match your module/controller namespace.
- setAsSectionTitleOwner is provided by the extensionAPI integration — ensure your controller is wired as a custom controller so this method is available.

---

STEP: Additional details & tips

DESCRIPTION: Quick references for multiple sections and ordering, and preview.

LANGUAGE: Text

CODE:
```text
- For OData V2 multiple sections: extension entry name must include an extra key part (e.g., "...|1") and sap.ui.generic.app must contain "key".
- For OData V4: section IDs defined under sections become control IDs in the application.
- Preview changes by running the app (or using SAP Fiori Tools preview) to confirm inserted sections and merged titles.
```
--------------------------------

**TITLE**: Add Micro Charts to Responsive Table Columns (Fiori Elements)

**INTRODUCTION**: Practical, code-first guide showing how to add micro charts (area, bullet, etc.) into responsive table columns in Fiori Elements apps. Includes XML, ABAP CDS, CAP CDS, and manifest.json examples for OData V2 and OData V4, how to define UI.Chart and UI.DataPoint annotations, and how to configure chart size, labels, and sorting (PresentationVariant).

**TAGS**: fiori-elements-framework, micro-chart, UI.Chart, UI.DataPoint, UI.LineItem, CDS, ODataV2, ODataV4, manifest.json, PresentationVariant, sorting

STEP: 1 - Add a micro chart into a table column (OData V2 and V4)
DESCRIPTION: Include a UI.DataFieldForAnnotation entry inside UI.LineItem. The DataFieldForAnnotation.Target must point to the UI.Chart annotation (qualifier) for the micro chart. Use the Label property for the column header text.
LANGUAGE: XML
CODE:
```xml
<!-- Example: add two micro charts (area + bullet) to a LineItem -->
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="UI.LineItem">
    <Collection>
      <!-- Standard fields -->
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Product"/>
      </Record>

      <!-- Reference an Area micro chart (qualified Chart annotation) -->
      <Record Type="UI.DataFieldForAnnotation">
        <PropertyValue Property="Target" AnnotationPath="@UI.Chart#AreaChartQualifier"/>
        <PropertyValue Property="Label" String="Sales Price"/>
      </Record>

      <!-- Reference a Bullet micro chart (qualified Chart annotation) -->
      <Record Type="UI.DataFieldForAnnotation">
        <PropertyValue Property="Target" AnnotationPath="@UI.Chart#BulletChartQualifier"/>
        <PropertyValue Property="Label" String="Revenue"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: 2 - Minimal ABAP CDS: LineItem referencing chart qualifier (OData V2)
DESCRIPTION: Show a CDS-style line item example that references a chart qualifier as a chart column in the UI.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [
  { label: 'Product', value: 'Product' },
  { label: 'Sales Price', type: #AS_CHART, valueQualifier: 'AreaChartQualifier', value: '_ProductSalesPrice' },
  { label: 'Revenue', type: #AS_CHART, valueQualifier: 'BulletChartQualifier', value: '_ProductSalesRevenue' }
]
define view MyView as select from MyServiceEntity { ... }
```

STEP: 3 - Define an Area micro chart (UI.Chart) — XML
DESCRIPTION: Define a UI.Chart (Area) with dimensions, measures and measureAttributes. Use qualifier to reference from LineItem DataFieldForAnnotation.Target.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="UI.Chart" Qualifier="AreaChartQualifier">
    <Record Type="UI.ChartDefinitionType">
      <PropertyValue Property="Title" String="Sales Price" />
      <PropertyValue Property="Description" String="Area Micro Chart" />
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Area" />
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>PriceDay</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>AreaChartPrice</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="MeasureAttributes">
        <Collection>
          <Record Type="UI.ChartMeasureAttributeType">
            <PropertyValue Property="Measure" PropertyPath="AreaChartPrice" />
            <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
            <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#AreaChartPrice" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 4 - Define an Area micro chart (UI.Chart) — ABAP CDS
DESCRIPTION: Equivalent ABAP CDS definition of the Area micro chart with qualifier.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Chart: [
  {
    title: 'Sales Price',
    description: 'Area Micro Chart',
    chartType: #AREA,
    dimensions: ['PRICEDAY'],
    measures: ['AREACHARTPRICE'],
    measureAttributes: [
      { measure: 'AREACHARTPRICE', role: #AXIS_1, asDataPoint: true }
    ],
    qualifier: 'AreaChartQualifier'
  }
]
annotate view ITEM with { }
```

STEP: 5 - Define a Bullet micro chart (UI.Chart) — XML
DESCRIPTION: Define a UI.Chart (Bullet) with measures and measureAttributes; reference a UI.DataPoint by AnnotationPath.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="UI.Chart" Qualifier="BulletChartQualifier">
    <Record Type="UI.ChartDefinitionType">
      <PropertyValue Property="Title" String="Sales Revenue" />
      <PropertyValue Property="Description" String="Bullet Micro Chart" />
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bullet" />
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>BulletChartRevenue</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="MeasureAttributes">
        <Collection>
          <Record Type="UI.ChartMeasureAttributeType">
            <PropertyValue Property="Measure" PropertyPath="BulletChartRevenue" />
            <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
            <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#BulletChartRevenue" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 6 - Define a Bullet micro chart (UI.Chart) — ABAP CDS
DESCRIPTION: ABAP CDS version of the Bullet micro chart with qualifier.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Chart: [
  {
    title: 'Sales Revenue',
    description: 'Bullet Micro Chart',
    chartType: #BULLET,
    measures: ['BULLETCHARTREVENUE'],
    measureAttributes: [
      { measure: 'BULLETCHARTREVENUE', role: #AXIS_1, asDataPoint: true }
    ],
    qualifier: 'BulletChartQualifier'
  }
]
annotate view ITEM with { }
```

STEP: 7 - Define UI.DataPoint for Area micro chart (XML)
DESCRIPTION: UI.DataPoint used by MeasureAttributes.DataPoint. Include Title (required), Value, TargetValue, and CriticalityCalculation for automatic criticality evaluation.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="UI.DataPoint" Qualifier="AreaChartPrice">
    <Record>
      <PropertyValue Property="Title" String="Sales Price" />
      <PropertyValue Property="Value" Path="AreaChartPrice" />
      <PropertyValue Property="TargetValue" Path="TargetPrice" />
      <PropertyValue Property="CriticalityCalculation">
        <Record>
          <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Target" />
          <PropertyValue Property="DeviationRangeHighValue" Path="DeviationUpperBoundPrice" />
          <PropertyValue Property="DeviationRangeLowValue" Path="DeviationLowerBoundPrice" />
          <PropertyValue Property="ToleranceRangeHighValue" Path="ToleranceUpperBoundPrice" />
          <PropertyValue Property="ToleranceRangeLowValue" Path="ToleranceLowerBoundPrice" />
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 8 - Define UI.DataPoint for Bullet micro chart (XML)
DESCRIPTION: UI.DataPoint used by Bullet measure. Include value, target, forecast, min/max and Criticality property.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="UI.DataPoint" Qualifier="BulletChartRevenue">
    <Record>
      <PropertyValue Property="Title" String="Sales Revenue" />
      <PropertyValue Property="Value" Path="BulletChartRevenue" />
      <PropertyValue Property="TargetValue" Path="TargetRevenue" />
      <PropertyValue Property="ForecastValue" Path="ForecastRevenue" />
      <PropertyValue Property="MinimumValue" Decimal="100" />
      <PropertyValue Property="MaximumValue" Decimal="300" />
      <PropertyValue Property="Criticality" Path="Criticality" />
    </Record>
  </Annotation>
</Annotations>
```

STEP: 9 - UI.DataPoint examples — ABAP CDS
DESCRIPTION: ABAP CDS versions for the Area and Bullet UI.DataPoint definitions used as data points for micro charts.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  title: 'Sales Price',
  targetValueElement: 'TargetPrice',
  criticalityCalculation: {
    improvementDirection: #TARGET,
    deviationRangeHighValueElement: 'DeviationUpperBoundPrice',
    deviationRangeLowValueElement: 'DeviationLowerBoundPrice',
    toleranceRangeHighValueElement: 'ToleranceUpperBoundPrice',
    toleranceRangeLowValueElement: 'ToleranceLowerBoundPrice'
  }
}
AreaChartPrice;

@UI.dataPoint: {
  title: 'Sales Revenue',
  targetValueElement: 'TargetRevenue',
  forecastValue: 'ForecastRevenue',
  minimumValue: 100,
  maximumValue: 300,
  criticality: 'Criticality'
}
BulletChartRevenue;
```

STEP: 10 - CDS annotation definitions (schema) for UI.Chart and UI.DataPoint
DESCRIPTION: Reference CDS structure for UI.Chart and UI.DataPoint to implement properly typed CDS annotations.
LANGUAGE: CDS
CODE:
```cds
// UI.Chart (simplified excerpt)
chart : array of {
    qualifier : String(120);
    title : String(60);
    description : String(120);
    chartType : String enum {
       AREA; BULLET; LINE; COLUMN; // ...other types
    };
    dimensions : array of elementRef;
    measures : array of elementRef;
    measureAttributes : array of {
       measure : elementRef;
       role : String(10) enum { AXIS_1; AXIS_2; AXIS_3; };
       asDataPoint : Boolean default true;
    };
}

// UI.DataPoint (simplified excerpt)
dataPoint {
    title : String(60);
    targetValue : DecimalFloat;
    targetValueElement : elementRef;
    forecastValue : elementRef;
    minimumValue : DecimalFloat;
    maximumValue : DecimalFloat;
    criticality : elementRef;
    criticalityCalculation : {
        improvementDirection : String enum { MINIMIZE; TARGET; MAXIMIZE; };
        toleranceRangeLowValue : DecimalFloat;
        toleranceRangeLowValueElement : elementRef;
        toleranceRangeHighValue : DecimalFloat;
        toleranceRangeHighValueElement : elementRef;
        deviationRangeLowValue : DecimalFloat;
        deviationRangeLowValueElement : elementRef;
        deviationRangeHighValue : DecimalFloat;
        deviationRangeHighValueElement : elementRef;
    };
};
```

STEP: 11 - OData V4: DataFieldForAnnotation entry (XML) and CAP CDS/ABAP equivalent
DESCRIPTION: For OData V4 include UI.DataFieldForAnnotation whose Target references the UI.Chart qualifier. CAP and ABAP examples show equivalent constructs.
LANGUAGE: XML
CODE:
```xml
<Record Type="UI.DataFieldForAnnotation">
  <PropertyValue Property="Target" AnnotationPath="_CreditLimitDetails/@com.sap.vocabularies.UI.v1.Chart#RadialCriticalityPathHidden" />
  <PropertyValue Property="Label" String="Credit Limit Details" />
</Record>
```
LANGUAGE: CAP CDS
CODE:
```javascript
// CAP-style annotation object (as JSON in annotations file)
{
  $Type : 'UI.DataFieldForAnnotation',
  Target : '_CreditLimitDetails/@com.sap.vocabularies.UI.v1.Chart#RadialCriticalityPathHidden',
  Label  : 'Credit Limit Details'
}
```
LANGUAGE: ABAP CDS
CODE:
```abap
{ label: 'Credit Limit Details', type: #AS_CHART, valueQualifier: 'RadialCriticalityPathHidden', value: '_CreditLimitDetails' }
```

STEP: 12 - Configure micro chart size and label visibility (manifest.json)
DESCRIPTION: Configure responsive table column microChartSize and showMicroChartLabel in manifest.json -> settings -> controlConfiguration -> @com.sap.vocabularies.UI.v1.LineItem -> columns. Defaults: microChartSize = "XS", showMicroChartLabel = false.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "models": { /* ... */ }
  },
  "sap.app": { /* ... */ },
  "sap.ui": { /* ... */ },
  "sap.ui5": {
    "componentUsages": { /* ... */ },
    "extensions": { /* ... */ },
    "config": { /* ... */ },
    "options": {
      "settings": {
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "type": "ResponsiveTable"
            },
            "columns": {
              "DataFieldForAnnotation::_CreditLimitDetails::Chart::RadialCriticalityPathHidden": {
                "settings": {
                  "microChartSize": "M",
                  "showMicroChartLabel": true
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 13 - Enable sorting of micro chart data via PresentationVariant
DESCRIPTION: To sort micro chart data (area, line, column, comparison, stacked bar types) add a UI.DataFieldForAnnotation in UI.LineItem that targets a UI.PresentationVariant (qualifier). The PresentationVariant must include Visualizations pointing to the UI.Chart qualifier and a SortOrder collection. Only SortOrder is considered by micro charts.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd.SalesOrderItem">
  <!-- LineItem: reference a PresentationVariant that contains the chart and SortOrder -->
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataFieldForAnnotation">
        <PropertyValue Property="Target" AnnotationPath="_Item/@com.sap.vocabularies.UI.v1.PresentationVariant#AreaMaxPath" />
        <PropertyValue Property="Label" String="Credit Limit Details"/>
        <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Low"/>
      </Record>
    </Collection>
  </Annotation>

  <!-- PresentationVariant contains Visualizations referencing the UI.Chart qualifier and defines SortOrder -->
  <Annotation Term="UI.PresentationVariant" Qualifier="AreaMaxPath">
    <Record Type="UI.PresentationVariantType">
      <PropertyValue Property="Visualizations">
        <Collection>
          <AnnotationPath>@UI.Chart#AreaMaxPath</AnnotationPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="SortOrder">
        <Collection>
          <Record Type="Common.SortOrderType">
            <PropertyValue Property="Property" PropertyPath="NetAmount"/>
            <PropertyValue Property="Descending" Bool="true"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <!-- Define the UI.Chart with qualifier AreaMaxPath -->
  <Annotation Term="UI.Chart" Qualifier="AreaMaxPath">
    <Record Type="UI.ChartDefinitionType">
      <!-- chart definition (dimensions/measures) -->
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Area" />
      <!-- ... -->
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```javascript
// CAP-style: define DataFieldForAnnotation in LineItem and a PresentationVariant with SortOrder
LineItem: [
  {
    $Type  : 'UI.DataFieldForAnnotation',
    Target : '_Item/@com.sap.vocabularies.UI.v1.PresentationVariant#AreaMaxPath',
    Label  : 'Credit Limit Details',
    '@UI.Importance': #Low
  }
];

annotate c_salesordermanage_sd.SalesOrderItem with @(UI: {
  PresentationVariant #AreaMaxPath: {
    Visualizations: ['@UI.Chart#AreaMaxPath'],
    SortOrder: [
      { Property: 'NetAmount', Descending: true }
    ]
  },
  Chart #AreaMaxPath: {
    // chart definition
  }
});
```

STEP: 14 - Implementation notes and restrictions
DESCRIPTION: Actionable notes to keep in mind while implementing micro charts:
- Micro charts inside table columns render in XS by default; configure microChartSize in manifest.json to change.
- set showMicroChartLabel = true in manifest.json to display labels.
- Sorting for micro charts uses only PresentationVariant.SortOrder; link DataFieldForAnnotation to the PresentationVariant (not directly to UI.Chart) to enable sort.
- The SmartMicroChart control supports UI.DataPoint.Criticality and UI.DataPoint.CriticalityCalculation.
- Micro chart columns cannot sort/filter their measures/dimensions from the column header; only Settings -> Sorting and Filtering (if the measures/dimensions are direct entity properties).
- If back-end data is missing or an error occurs, the micro chart might not render.
LANGUAGE: JSON
CODE:
```json
{
  "notes": [
    "Default microChartSize: XS",
    "Default showMicroChartLabel: false",
    "Use PresentationVariant.SortOrder to enable micro chart sorting",
    "UI.DataPoint.Title is required (micro chart does not render the title)",
    "Navigation properties in UI.Chart are not supported by the template in some cases"
  ]
}
```
--------------------------------

**TITLE**: Add a Progress Indicator to a Table (Fiori Elements)

**INTRODUCTION**: This guide shows how to add a progress indicator (visual progress bar) to a table column in SAP Fiori elements using annotations. It includes XML annotation, ABAP CDS, and CAP CDS examples, and how to change the progress bar color by using the Criticality property.

**TAGS**: fiori-elements, annotations, progress-indicator, table, UI.DataPoint, UI.LineItem, CDS, XML

**STEP**: 1 — Create a DataPoint annotation (XML) that defines a progress visualization

**DESCRIPTION**: Define a UI.DataPoint annotation (Qualifier "Progress") that sets Value, TargetValue and Visualization to the Progress enum. Place this XML in your annotation file (e.g., annotations.xml or metadata extension) for the entity that backs the table.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType">
    <!-- DataPoint defining a progress visualization -->
    <Annotation Term="UI.DataPoint" Qualifier="Progress">
        <Record>
            <!-- Value: path to the numeric value representing current progress -->
            <PropertyValue Property="Value" Path="to_StockAvailability/Quantity" />
            <!-- TargetValue: absolute or percentage maximum -->
            <PropertyValue Property="TargetValue" Decimal="100" />
            <!-- Visualization: mark as progress indicator -->
            <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Progress" />
        </Record>
    </Annotation>

    <!-- LineItem entry (see next step for details) -->
</Annotations>
```

**STEP**: 2 — Reference the DataPoint in the LineItem to render it in the table

**DESCRIPTION**: In the UI.LineItem annotation, add a UI.DataFieldForAnnotation record that references the DataPoint via the Target property using AnnotationPath="@UI.DataPoint#Progress". This instructs Fiori elements to render the progress indicator inside the table column.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType">
    <!-- ... DataPoint annotation (from previous step) ... -->

    <Annotation Term="UI.LineItem">
        <Collection>
            <Record Type="UI.DataFieldForAnnotation">
                <PropertyValue Property="Label" String="Progress" />
                <!-- Optional: set Criticality if you want color/critical behavior -->
                <PropertyValue Property="Criticality" Path="to_StockAvailability/Quantity" />
                <!-- Reference the DataPoint by qualifier -->
                <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Progress" />
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```

**STEP**: 3 — ABAP CDS example: annotate a view with a DataPoint and LineItem for progress

**DESCRIPTION**: If you use ABAP CDS views, apply @UI.dataPoint and @UI.lineItem annotations in the CDS source so the progress indicator appears in the list report / table.

**LANGUAGE**: ABAP

**CODE**:
```abap
annotate view STTA_C_MP_StockAvailability with {
  @UI.dataPoint: { targetValue: 100, visualization: #PROGRESS }
  Quantity;
}

@UI.lineItem: [
  {
    label: 'Progress',
    criticality: 'TO_STOCKAVAILABILITY/QUANTITY',
    valueQualifier: 'Progress',
    type: #AS_DATAPOINT
  }
]
progress;
```

**STEP**: 4 — CAP CDS example: annotate entity with DataPoint and LineItem

**DESCRIPTION**: For CAP (SAP Cloud Application Programming) projects, use CDS annotations in the .cds file (or annotation file) to define the DataPoint and reference it in UI.LineItem.

**LANGUAGE**: CDS

**CODE**:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductType @( 
  UI.DataPoint #Progress : {
    Value : to_StockAvailability.Quantity,
    TargetValue : 100,
    Visualization : #Progress
  },
  UI.LineItem : [
    {
      $Type : 'UI.DataFieldForAnnotation',
      Label : 'Progress',
      Criticality : to_StockAvailability.Quantity,
      Target : '@UI.DataPoint#Progress'
    }
  ]
);
```

**STEP**: 5 — Change progress bar color by adding a Criticality property

**DESCRIPTION**: To make the progress bar change color depending on state, add a Criticality property to the DataPoint that points to a property (or path) that represents criticality state. The property referenced must supply values that Fiori interprets as criticality (e.g., Good/Neutral/Bad or numerical thresholds mapped via annotations).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="Your.Namespace.YourEntity">
    <Annotation Term="UI.DataPoint" Qualifier="Quantity">
        <Record>
            <PropertyValue Property="Value" Path="Quantity"/>
            <PropertyValue Property="Title" String="{@i18n&gt;@Availability}"/>
            <PropertyValue Property="Description" String="Progress Indicator"/>
            <PropertyValue Property="TargetValue" Decimal="150"/>
            <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Progress"/>
            <!-- Criticality path controls color/state of the progress bar -->
            <PropertyValue Property="Criticality" Path="StockAvailability"/>
        </Record>
    </Annotation>
</Annotations>
```

Notes:
- Value can be absolute numbers or percentages; TargetValue defines the scale.
- Visualization must be UI.VisualizationType/Progress (XML) or #PROGRESS (CDS).
- Reference the DataPoint in the LineItem using Target AnnotationPath="@UI.DataPoint#QualifierName".
- Ensure the Criticality property returns the expected criticality values (or map them via additional annotations) so the UI can apply corresponding colors.
--------------------------------

**TITLE**: Add a Read-Only Rating Indicator to a Table (SAP Fiori Elements)

**INTRODUCTION**: Show a read-only rating indicator (stars) in a table column using UI.DataPoint / DataFieldForAnnotation. Use the field value from the back end as the rating value and set the maximum number of stars with TargetValue. Decimal values are rounded (half star shown for values between x.25 and x.74). Default maximum is 5 stars.

**TAGS**: fiori-elements-framework, odata, annotations, UI.DataPoint, rating, CDS, ABAP, CAP, XML

**STEP**: 1 — Behavior and key rules

**DESCRIPTION**: Summary of behavior to implement in code generation:
- Rating indicator is read-only and shown as stars.
- Value comes from a backend property; use the Value property (Path) or Value entry in CDS annotations.
- TargetValue (or targetValue) sets the maximum number of stars. Default = 5.
- Rounding: decimals are rounded; values between x.25 and x.74 display a half star.
- Enable visualization by using UI.DataPoint with Visualization/#RATING and adding a DataFieldForAnnotation entry in UI.LineItem that points to the DataPoint.

**LANGUAGE**: Text

**CODE**:
```Text
Rules:
- Use UI.DataPoint (visualization: #RATING) for the rating visualization.
- Use UI.DataFieldForAnnotation in UI.LineItem with Target referencing the DataPoint qualifier.
- Set TargetValue to change max stars (default = 5).
- Backend numeric value -> Value (Path) of DataPoint.
- Rounding: decimals -> half star between x.25 and x.74.
```

**STEP**: 2 — XML metadata annotation (generic XML annotations file)

**DESCRIPTION**: Add a DataPoint annotation with Visualization set to Rating and reference it from LineItem using DataFieldForAnnotation. Replace the Target and Paths to your entity and property names.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType">
  <!-- Define a named DataPoint with qualifier "Rating" -->
  <Annotation Term="UI.DataPoint" Qualifier="Rating">
    <Record>
      <!-- Backend value path used for star count -->
      <PropertyValue Property="Value" Path="to_StockAvailability/StockAvailability" />
      <!-- Maximum number of stars -->
      <PropertyValue Property="TargetValue" Decimal="4" />
      <!-- Use Rating visualization -->
      <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Rating" />
    </Record>
  </Annotation>

  <!-- Reference the DataPoint in the LineItem to display it in a table column -->
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataFieldForAnnotation">
        <PropertyValue Property="Label" String="Rating" />
        <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Rating" />
      </Record>
      <!-- other line items -->
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 3 — ABAP CDS annotation (annotate view)

**DESCRIPTION**: Use ABAP CDS annotation syntax to declare a DataPoint and a LineItem entry. The DataPoint sets visualization and targetValue; the LineItem entry uses type #AS_DATAPOINT and valueQualifier/#AS_DATAPOINT.

**LANGUAGE**: CDS (ABAP)

**CODE**:
```CDS
annotate view STTA_C_MP_PRODUCT with
{
  @UI.lineItem: [
    {
      label: 'Rating',
      valueQualifier: 'Rating',
      type: #AS_DATAPOINT,
      position: 1
    }
  ]
  @UI.dataPoint: {
    targetValue: 4,
    visualization: #RATING
  }
  to_stockavailability/stockavailability;
}
```

**STEP**: 4 — CAP CDS annotation (Service model in CAP)

**DESCRIPTION**: In CAP CDS, annotate the entity type to add UI.DataPoint (qualifier) and UI.LineItem entries. Use Value to point to the backend property, TargetValue for max stars, and Visualization set to #Rating.

**LANGUAGE**: CDS (CAP)

**CODE**:
```CDS
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with 
  @(
    UI.DataPoint #Rating : {
      Value         : to_StockAvailability.StockAvailability,
      TargetValue   : 4,
      Visualization : #Rating
    },
    UI.LineItem : [
      {
        $Type  : 'UI.DataFieldForAnnotation',
        Label  : 'Rating',
        Target : '@UI.DataPoint#Rating'
      }
    ]
  );
```

**STEP**: 5 — SAP Fiori Elements for OData V2 (CDS/annotation snippets)

**DESCRIPTION**: For OData V2 apps, enable the rating indicator by marking the LineItem entry as type #AS_DATAPOINT and adding a matching @UI.dataPoint with visualization: #RATING. Change targetValue to alter the number of stars (default 5).

**LANGUAGE**: CDS (ABAP)

**CODE**:
```CDS
@UI.lineItem: {
  position: 30,
  type: #AS_DATAPOINT
}

@UI.dataPoint: {
  visualization: #RATING
}

Product.Rating,
```

**CODE**:
```CDS
@UI.lineItem: {
  position: 30,
  type: #AS_DATAPOINT
}

@UI.dataPoint: {
  targetValue: 4,          <-- set maximum stars (default is 5)
  visualization: #RATING
}

Product.Rating,
```

**STEP**: 6 — Notes and actionable checklist

**DESCRIPTION**: Quick checklist to implement rating indicator correctly:
- Ensure the DataPoint Value path points to a numeric backend property.
- Add UI.DataPoint (qualifier) and reference with UI.DataFieldForAnnotation in LineItem.
- Set TargetValue to desired max stars (omit to use default 5).
- Confirm rounding semantics (half star for x.25–x.74).
- Image reference (for design): images/Rating_Indicator_in_Table_f83c4d3.png

**LANGUAGE**: Text

**CODE**:
```Text
Checklist:
- Backend numeric property available -> use as Value/Path.
- DataPoint qualifier created and referenced from LineItem.
- targetValue set if non-default max stars required.
- UI.DataPoint visualization = #RATING.
- Validate in UI that stars reflect rounded values (half star between x.25 and x.74).
```
--------------------------------

**TITLE**: Adding a Section to an Object Page Using SAP Fiori Tools (OData V4)

**INTRODUCTION**: Quick, action-oriented guide for adding a new Section and then adding Fields into that Section on an Object Page using SAP Fiori Tools (only applicable to SAP Fiori elements for OData V4). Includes UI steps, helpful links, and referenced assets/file paths.

**TAGS**: fiori-elements-framework, SAP Fiori tools, object page, section, fields, OData V4

**STEP**: 1 — Add a New Section (using Page Map / Page Editor)

**DESCRIPTION**: Use the Page Map and Page Editor in SAP Fiori Tools to add a new Section to the Object Page. These are UI operations; follow the exact sequence to create and wire the section to a value source.

- Launch the Page Map (e.g., right-click project folder → Show Page Map). Reference: https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/bae38e6216754a76896b926a3d6ac3a9
- Open the Object Page in the Page Editor (click the pencil/Edit icon next to Object Page).
- Under the Object Page editor, click the Add (＋) icon next to Sections.
- Choose the Section type you need.
- Enter the Section Name.
- Choose the Value Source from the dropdown (this determines where field data comes from).
- Click Add to create the Section.

**LANGUAGE**: HTML

**CODE**:
```html
<!-- Preserve UI icon styles if referenced in your workspace -->
<link rel="stylesheet" type="text/css" href="../css/sap-icons.css"/>
```

**STEP**: 2 — Add Basic Fields to the New Section

**DESCRIPTION**: After adding the Section, expand the Sections node in the Page Editor outline and add fields into the Section using the Basic Fields wizard.

- In the Page Editor outline, expand the Sections node by clicking the Arrow icon next to the Section.
- Click the Add (＋) icon next to Fields.
- Choose "Add Basic Fields".
- Select the fields you want to add from the dropdown list (these map to entity properties or annotation-driven value sources).
- Click Add to insert fields into the Section.

Reference for adding fields: https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/2953503145dd428194c6dff252744ac1.html

**LANGUAGE**: Text

**CODE**:
```text
Outline navigation pattern:
- Object Page
  - Sections
    - <Your New Section>
      - Fields
        - <Field 1>
        - <Field 2>
```

**STEP**: 3 — Preview the Updated Object Page

**DESCRIPTION**: After adding Sections and Fields, preview the application to validate layout and data binding.

- Use the Preview feature in SAP Fiori Tools / Business Application Studio.
- Reference: https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/b962685bdf9246f6bced1d1cc1d9ba1c.html

**LANGUAGE**: Text

**CODE**:
```text
Suggested validation checklist:
- Section visible on Object Page
- Fields display expected data (check Value Source mapping)
- Layout and labels are correct
- No missing icon/style references (e.g. verify ../css/sap-icons.css if icons missing)
```

**STEP**: 4 — Reference Screenshot / Assets

**DESCRIPTION**: If you maintain repository assets or documentation, reference the screenshot path shown in the original guide for orientation or embedding in docs.

**LANGUAGE**: Text

**CODE**:
```text
Screenshot path referenced in original documentation:
images/Fiori_Tools_-_Business_Application_Studio_-_Sections_Dropdown_3f19523.png
```
--------------------------------

**TITLE**: Adding Action Buttons to Forms (UI.FieldGroup, Identification, StatusInfo)

**INTRODUCTION**: This document shows how to add form action buttons (DataFieldForAction and DataFieldForIntentBasedNavigation) to sections/forms in SAP Fiori Elements. It covers XML annotations, ABAP CDS, and CAP CDS examples, how to link FieldGroup to ReferenceFacet, inline form toolbar placement, visibility/enablement rules, context passing rules, and emphasizing actions.

**TAGS**: fiori-elements-framework, annotations, UI.FieldGroup, DataFieldForAction, DataFieldForIntentBasedNavigation, OData, CDS, CAP, ABAP, XML

STEP: 1 — Add action buttons to a FieldGroup (XML)
DESCRIPTION: Add DataFieldForAction and DataFieldForIntentBasedNavigation entries to the Data collection of UI.FieldGroup. The example defines a "TechnicalData" form with two actions: a bound OData function and an intent-based navigation button.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="TechnicalData">
    <Record>
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="Width"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Medium"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="Depth"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Medium"/>
                </Record>
                <!-- Form action: bound OData function -->
                <Record Type="UI.DataFieldForAction">
                    <PropertyValue Property="Label" String="Copy"/>
                    <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy"/>
                </Record>
                <!-- Form action: intent-based navigation -->
                <Record Type="UI.DataFieldForIntentBasedNavigation">
                    <PropertyValue Property="Label" String="Manage Products (ST)" />
                    <PropertyValue Property="SemanticObject" String="EPMProduct" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Label" String="Technical Data"/>
    </Record>
</Annotation>
```

STEP: 1 — Add action buttons to a FieldGroup (ABAP CDS)
DESCRIPTION: Equivalent ABAP CDS annotations: mark fields with a qualifier 'TechnicalData' and include actions using type #FOR_ACTION and #FOR_INTENT_BASED_NAVIGATION.
LANGUAGE: ABAP
CODE:
```abap
@UI.fieldGroup: [
  {
    importance: #MEDIUM,
    position: 10,
    qualifier: 'TechnicalData',
    groupLabel: 'Technical Data'
  }
]
WIDTH;

@UI.fieldGroup: [
  {
    importance: #MEDIUM,
    position: 20,
    qualifier: 'TechnicalData'
  }
]
DEPTH;

@UI.fieldGroup: [
  {
    label: 'Copy',
    dataAction: 'STTA_C_MP_ProductCopy',
    type: #FOR_ACTION,
    position: 30,
    qualifier: 'TechnicalData'
  },
  {
    label: 'Manage Products (ST)',
    type: #FOR_INTENT_BASED_NAVIGATION,
    position: 40,
    qualifier: 'TechnicalData'
  }
]

@Consumption.semanticObject: 'EPMProduct'
product;
```

STEP: 1 — Add action buttons to a FieldGroup (CAP CDS)
DESCRIPTION: CAP CDS JSON-like annotation for UI.FieldGroup with DataFieldForAction and DataFieldForIntentBasedNavigation entries.
LANGUAGE: CDS
CODE:
```cds
UI.FieldGroup #TechnicalData : {
    Data : [
        {
            $Type : 'UI.DataField',
            Value : Width,
            ![@UI.Importance] : #Medium
        },
        {
            $Type : 'UI.DataField',
            Value : Depth,
            ![@UI.Importance] : #Medium
        },
        {
            $Type : 'UI.DataFieldForAction',
            Label : 'Copy',
            Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy'
        },
        {
            $Type : 'UI.DataFieldForIntentBasedNavigation',
            Label : 'Manage Products (ST)',
            SemanticObject : 'EPMProduct'
        }
    ],
    Label : 'Technical Data'
}
```

STEP: 2 — Link the FieldGroup to a ReferenceFacet (XML)
DESCRIPTION: Link the UI.FieldGroup qualifier to the section by using UI.ReferenceFacet.Target -> @UI.FieldGroup#Qualifier. This makes the FieldGroup form appear in the object page section toolbar.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Facets">
    <Collection>
        ...
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Technical Data"/>
            <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#TechnicalData"/>
        </Record>
        ...
    </Collection>
</Annotation>
```

STEP: 2 — Link the FieldGroup to a ReferenceFacet (ABAP CDS)
DESCRIPTION: ABAP CDS facet linking using targetQualifier and type #FIELDGROUP_REFERENCE.
LANGUAGE: ABAP
CODE:
```abap
@UI.Facet: [
  {
    label: 'Technical Data',
    targetQualifier: 'TechnicalData',
    type: #FIELDGROUP_REFERENCE,
    purpose: #STANDARD
 }
]
```

STEP: 2 — Link the FieldGroup to a ReferenceFacet (CAP CDS)
DESCRIPTION: CAP CDS ReferenceFacet entry targeting the FieldGroup qualifier.
LANGUAGE: CDS
CODE:
```cds
{
   $Type  : 'UI.ReferenceFacet',
   Label  : 'Technical Data',
   ID     : 'TechnicalData',
   Target : '@UI.FieldGroup#TechnicalData'
},
```

STEP: 3 — Add form actions via Identification (XML)
DESCRIPTION: You can add DataFieldForAction inside UI.Identification and reference the identification in a ReferenceFacet; unqualified identifications go to global actions unless marked determining.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Identification" Qualifier="ID">
    <Collection>
        ...
        <Record Type="UI.DataFieldForAction">
            <PropertyValue Property="Label" String="Break Up" />
            <PropertyValue Property="Action" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.BREAK_UP" />
        </Record>
        ...
    </Collection>
</Annotation>

<!-- Reference facet pointing to identification -->
<Annotation Term="UI.Facets">
    <Collection>
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Technical Data"/>
            <PropertyValue Property="Target" AnnotationPath="@UI.Identification#ID"/>
        </Record>
    </Collection>
</Annotation>
```

STEP: 3 — Add form actions via Identification (ABAP CDS)
DESCRIPTION: ABAP CDS syntax for UI.identification with a determining action.
LANGUAGE: ABAP
CODE:
```abap
@UI.identification: [
  {
    label: 'Break Up',
    dataAction: 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.BREAK_UP',
    type: #FOR_ACTION,
    qualifier: 'ID'
  }
]
```

STEP: 3 — Add form actions via Identification (CAP CDS)
DESCRIPTION: CAP CDS example placing a DataFieldForAction in UI.Identification.
LANGUAGE: CDS
CODE:
```cds
UI.Identification #ID : [{
    $Type  : 'UI.DataFieldForAction',
    Label  : 'Break Up',
    Action : 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.BREAK_UP'
}],
```

STEP: 4 — Add form actions via StatusInfo (XML)
DESCRIPTION: DataFieldForAction entries can also be placed in UI.StatusInfo (qualified or unqualified).
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.StatusInfo" Qualifier="SI">
    <Collection>
        ...
        <Record Type="UI.DataFieldForAction">
            <PropertyValue Property="Label" String="Move Country" />
            <PropertyValue Property="Action" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.MOVE_COUNTRY" />
        </Record>
        ...
    </Collection>
</Annotation>
```

STEP: 4 — Add form actions via StatusInfo (ABAP CDS)
DESCRIPTION: ABAP CDS @UI.statusInfo example.
LANGUAGE: ABAP
CODE:
```abap
@UI.statusInfo: [
  {
    label: 'Move Country',
    dataAction: 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.MOVE_COUNTRY',
    type: #FOR_ACTION,
    qualifier: 'SI'
  }
]
```

STEP: 4 — Add form actions via StatusInfo (CAP CDS)
DESCRIPTION: CAP CDS UI.StatusInfo example with DataFieldForAction.
LANGUAGE: CDS
CODE:
```cds
UI.StatusInfo #SI : [{
    $Type  : 'UI.DataFieldForAction',
    Label  : 'Move Country',
    Action : 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.MOVE_COUNTRY'
}],
```

STEP: 5 — Place an action inside the form toolbar (inline=true) (XML)
DESCRIPTION: Use Property Inline="true" on DataFieldForAction to render the action inside the form toolbar instead of the section toolbar.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="OrderData">
    <Record Type="UI.FieldGroupType">
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataFieldForAction">
                    <PropertyValue Property="Label" String="Facet Form Action" />
                    <PropertyValue Property="Action" String="com.c_salesordermanage_sd.FacetFormAction" />
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
                </Record>
                <Record Type="UI.DataFieldForAction">
                    <PropertyValue Property="Label" String="Facet Form Action at Form Level" />
                    <PropertyValue Property="Action" String="com.c_salesordermanage_sd.FacetFormAction2" />
                    <PropertyValue Property="Inline" Bool="true" />
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 5 — Place an action inside the form toolbar (ABAP CDS)
DESCRIPTION: ABAP CDS example for FieldGroup actions (note: Inline handling in ABAP CDS is expressed by positioning and qualifier; use Inline in XML if needed).
LANGUAGE: ABAP
CODE:
```abap
@UI.fieldGroup: [
  {
    importance: #HIGH,
    label: 'Facet Form Action',
    dataAction: 'com.c_salesordermanage_sd.FacetFormAction',
    type: #FOR_ACTION,
    position: 1 ,
    qualifier: 'OrderData'
  },
  {
    importance: #HIGH,
    label: 'Facet Form Action at Form Level',
    dataAction: 'com.c_salesordermanage_sd.FacetFormAction2',
    type: #FOR_ACTION,
    position: 2 ,
    qualifier: 'OrderData'
  }
]
```

STEP: 5 — Place an action inside the form toolbar (CAP CDS)
DESCRIPTION: CAP CDS FieldGroup with Inline property on the second action.
LANGUAGE: CDS
CODE:
```cds
FieldGroup #OrderData: {Data : [
    {
        $Type             : 'UI.DataFieldForAction',
        Label             : 'Facet Form Action',
        Action            : 'com.c_salesordermanage_sd.FacetFormAction',
        ![@UI.Importance] : #High
    },{
        $Type             : 'UI.DataFieldForAction',
        Label             : 'Facet Form Action at Form Level',
        Action            : 'com.c_salesordermanage_sd.FacetFormAction2',
        Inline            : true,
        ![@UI.Importance] : #High
    }
]}
```

STEP: 6 — Visibility and enablement of action buttons (rules and examples)
DESCRIPTION: Rules:
- Visibility is mainly controlled by UI.Hidden on the action. If Core.OperationAvailable is statically false, the action is not rendered.
- Enablement is controlled by Core.OperationAvailable:
  - static false -> button not rendered
  - static true / no value / only term present -> always enabled
  - path-based value -> enabled when path evaluates to true, disabled when false
Include sample variants: static false, static true, path-based.
LANGUAGE: XML
CODE:
```xml
<!-- Not rendered: static false -->
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Static Disabled Action" />
    <PropertyValue Property="Action" String="com.example.StaticDisabledAction" />
    <Annotation Term="Core.OperationAvailable" Bool="false" />
</Record>

<!-- Always enabled: static true -->
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Always Enabled Action" />
    <PropertyValue Property="Action" String="com.example.AlwaysEnabledAction" />
    <Annotation Term="Core.OperationAvailable" Bool="true" />
</Record>

<!-- Path-based enablement: enabled if IsActionAllowed evaluates to true -->
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Path-based Action" />
    <PropertyValue Property="Action" String="com.example.PathBasedAction" />
    <Annotation Term="Core.OperationAvailable" Path="IsActionAllowed" />
</Record>

<!-- Visibility via UI.Hidden -->
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Hidden Action" />
    <PropertyValue Property="Action" String="com.example.HiddenAction" />
    <Annotation Term="UI.Hidden" Bool="true" />
</Record>
```

STEP: 7 — Passing context when invoking a form action
DESCRIPTION: Rules:
- Bound actions receive the entire object page context when triggered.
- Unbound actions receive no context.
- DataFieldForIntentBasedNavigation: set RequiresContext="false" to allow page context to be passed; RequiresContext="true" is invalid for form-level IBN (users cannot select context in forms).
LANGUAGE: XML
CODE:
```xml
<!-- Intent-based navigation that accepts page context -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
    <PropertyValue Property="Label" String="IBN"/>
    <PropertyValue Property="SemanticObject" String="SalesOrder"/>
    <PropertyValue Property="Action" String="manageInline"/>
    <PropertyValue Property="RequiresContext" Bool="false"/>
</Record>
```

STEP: 8 — Emphasize (ghost style) the most important form action
DESCRIPTION: Use UI.Emphasized on DataFieldForAction or DataFieldForIntentBasedNavigation to highlight the action. Examples: empty term, Bool="true", or Path expression.
LANGUAGE: XML
CODE:
```xml
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Static Action" />
    <PropertyValue Property="Action" String="com.c_salesordermanage_sd.DummyStaticAction" />
    <Annotation Term="UI.Emphasized" />
</Record>
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Static Action" />
    <PropertyValue Property="Action" String="com.c_salesordermanage_sd.DummyStaticAction" />
    <Annotation Term="UI.Emphasized" Bool="true" />
</Record>
<Record Type="UI.DataFieldForAction">
    <PropertyValue Property="Label" String="Static Action" />
    <PropertyValue Property="Action" String="com.c_salesordermanage_sd.DummyStaticAction" />
    <Annotation Term="UI.Emphasized" Path="SomeEmphasizePath" />
</Record>
```

STEP: 8 — Emphasize (ABAP CDS / CAP CDS)
DESCRIPTION: ABAP and CAP equivalents to mark an action as emphasized.
LANGUAGE: ABAP
CODE:
```abap
@UI.lineItem: [{ 
  label: 'IBN',
  type: #FOR_INTENT_BASED_NAVIGATION,
  emphasized: true,
  requiresContext: true,
  semanticObjectAction: 'manageInline',
  semanticObject: 'SalesOrder'
}]
```

LANGUAGE: CDS
CODE:
```cds
{
    $Type               : 'UI.DataFieldForAction',
    Label               : 'Static Action',
    Action              : 'com.c_salesordermanage_sd.DummyStaticAction', 
    ![@UI.Emphasized]   : <<Path>>
}

{
    $Type               : 'UI.DataFieldForIntentBasedNavigation',
    SemanticObject      : 'SalesOrder',
    Action              : 'manageInline',
    Label               : 'IBN',
    RequiresContext     : false,
    ![@UI.Emphasized]   : true
}
```

STEP: 9 — Notes and references
DESCRIPTION: Additional implementation notes:
- DataFieldForAction buttons from an unqualified UI.Identification go to global actions unless marked determining (then they go to footer).
- For OData V2, UI adaptations can change action button styles.
- For more on external navigation and intent-based navigation configuration see: configuring-external-navigation-1d4a0f9.md
- To trigger an action connected to a field value on a form, see "Adding Actions to Tables".
LANGUAGE: Plain
CODE:
```text
References:
- Configuring External Navigation: configuring-external-navigation-1d4a0f9.md
- Adding Actions to Tables: adding-actions-to-tables-b623e0b.md
```
--------------------------------

**TITLE**: Adding Actions to Tables — Annotation and manifest recipes for Create/Delete and App-Specific Actions

**INTRODUCTION**: Practical, copy-paste-ready examples and concise instructions to:
- enable/disable generic Create and Delete table actions (InsertRestrictions, DeleteRestrictions, NavigationRestrictions, deletable-path),
- add annotation-based and manifest-based custom/app-specific actions (inline, toolbar, icon buttons),
- configure inline deletion and action ordering in manifest.json,
- control Update/Delete editability and creation dialogs for POST-based create flows.
Use these snippets for OData V2/V4, ABAP CDS, CAP CDS and manifest.json integration.

**TAGS**: fiori-elements, annotations, UI.LineItem, NavigationRestrictions, InsertRestrictions, DeleteRestrictions, deletable-path, inlineDelete, manifest.json, CAP, ABAP, XML, CDS

**STEP**: 1 — Enable Create via NavigationRestrictions (priority over local InsertRestrictions)
**DESCRIPTION**: When a child navigation property is controlled by Org.OData.Capabilities.V1.NavigationRestrictions on the parent entity set, NavigationRestrictions takes precedence. Use InsertRestrictions within RestrictedProperties.NavigationProperty to make the child insertable. Use this XML in your service annotations or CAP CDS for OData V4.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- XML OData Annotations: Parent entity defines NavigationRestrictions for a navigation property -->
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_Product">
  <Annotation Term="Org.OData.Capabilities.V1.NavigationRestrictions">
    <Record>
      <PropertyValue Property="RestrictedProperties">
        <Collection>
          <Record>
            <PropertyValue Property="NavigationProperty" NavigationPropertyPath="to_ProductText"/>
            <PropertyValue Property="InsertRestrictions">
              <Record>
                <PropertyValue Property="Insertable" Bool="true"/>
                <!--Or use Path: <PropertyValue Property="Insertable" Path="Insertable"/>-->
              </Record>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_Product with @(
  Capabilities.NavigationRestrictions : {
    RestrictedProperties : [
      {
        NavigationProperty : to_ProductText,
        InsertRestrictions : {
          Insertable : true
        }
      }
    ]
  }
);
```

**LANGUAGE**: ABAP CDS / RAP (behavior definition)
**CODE**:
```abap
/* RAP behavior defines create/update/delete capabilities - no XML required */
define behavior for STTA_C_MP_Product
{
  create;
  delete;
  update;

  association _ProductText
  { create;  }
};
```

**STEP**: 2 — Enable Create by direct InsertRestrictions on the entity set
**DESCRIPTION**: Use InsertRestrictions at the entity set level if NavigationRestrictions on parent is not used.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductText">
  <Annotation Term="Org.OData.Capabilities.V1.InsertRestrictions">
    <Record>
      <PropertyValue Property="Insertable" Bool="true"/>
      <!--Or Path: <PropertyValue Property="Insertable" Path="Insertable"/>-->
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductText with @(
  Capabilities.InsertRestrictions : {
    Insertable : true
  }
);
```

**STEP**: 3 — Configure DeleteRestrictions (static or path-based) and parent NavigationRestrictions precedence
**DESCRIPTION**: Use DeleteRestrictions on the entity set to show/hide the Delete button. NavigationRestrictions on a parent entity set overrides child settings. DeleteRestrictions supports Bool or Path values (deletable-path).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Example: disable delete for an entity set -->
<Annotations Target="SAP__self.Container/SalesOrderManage">
  <Annotation Term="Org.OData.Capabilities.V1.DeleteRestrictions">
    <Record>
      <PropertyValue Property="Deletable" Bool="false"/>
    </Record>
  </Annotation>
</Annotations>

<!-- Example: parent navigation restrictions with DeleteRestrictions on child navigation -->
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_Product">
  <Annotation Term="Org.OData.Capabilities.V1.NavigationRestrictions">
    <Record>
      <PropertyValue Property="RestrictedProperties">
        <Collection>
          <Record>
            <PropertyValue Property="NavigationProperty" NavigationPropertyPath="to_ProductText"/>
            <PropertyValue Property="DeleteRestrictions">
              <Record>
                <PropertyValue Property="Deletable" Bool="false"/>
              </Record>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
annotate SAP__self.SalesOrderManage with {
  SAP__capabilities.DeleteRestrictions : {
    Deletable : false
  }
};
```

**STEP**: 4 — Use deletable-path to enable/disable Delete per record (dynamic)
**DESCRIPTION**: Point Deletable to a boolean property (deletable-path). If the property value is true => deletable; false => disabled. Do not set sap:deletable annotation when using deletable-path.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_Product">
  <Annotation Term="Org.OData.Capabilities.V1.DeleteRestrictions">
    <Record>
      <PropertyValue Property="Deletable" Path="Delete_mc"/>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
annotate STTA_C_MP_Product with @(
  Capabilities.DeleteRestrictions : {
    Deletable : Delete_mc
  }
);
```

**STEP**: 5 — Add custom toolbar actions via manifest.json (custom actions + ordering)
**DESCRIPTION**: Define custom toolbar actions and set order/anchor/position for standard/custom actions using controlConfiguration under the target page settings in manifest.json. Example shows placing a custom action after Create and moving Delete before Create.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "actions": {
                    "StandardAction::Delete": {
                      "position": {
                        "anchor": "StandardAction::Create",
                        "placement": "Before"
                      }
                    },
                    "CustomAction::MyCustom1": {
                      "press": "SalesOrder.custom.CustomActions.CustomAction1",
                      "enabled": true,
                      "text": "Custom Action",
                      "command": "COMMON",
                      "position": {
                        "anchor": "StandardAction::Create",
                        "placement": "After"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — Define annotation-based actions (UI.LineItem) — toolbar and inline row actions
**DESCRIPTION**: Use UI.LineItem to define actions that appear in the toolbar (no Inline or Inline=false) or as per-row inline columns (Inline=true). Provide the XML, ABAP CDS and CAP CDS equivalents. The order of LineItem entries defines the order of columns.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.LineItem">
  <Collection>
    <!-- Toolbar actions (no Inline property) -->
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy with new Supplier"/>
      <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopywithparams"/>
      <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/Isolated"/>
    </Record>

    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Activate"/>
      <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductActivation"/>
      <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/ChangeSet"/>
    </Record>

    <!-- Table columns -->
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="Product"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="ProductCategory"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="to_Supplier/CompanyName"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>

    <!-- Inline per-row action column -->
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy"/>
      <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy"/>
      <PropertyValue Property="Inline" Bool="true"/>
      <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/Isolated"/>
    </Record>

    <!-- Inline intent-based navigation -->
    <Record Type="UI.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="Label" String="Manage Products (ST)"/>
      <PropertyValue Property="SemanticObject" String="EPMProduct"/>
      <PropertyValue Property="Action" String="manage_st"/>
      <PropertyValue Property="Inline" Bool="true"/>
    </Record>

    <!-- DataFieldWithIntentBasedNavigation: renders link -->
    <Record Type="UI.DataFieldWithIntentBasedNavigation">
      <PropertyValue Property="Label" String="Weight (with IBN)"/>
      <PropertyValue Property="Action" String="manage_st_test"/>
      <PropertyValue Property="Value" Path="Weight"/>
      <PropertyValue Property="SemanticObject" String="EPMProduct"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
  </Collection>
</Annotation>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.lineItem: [
  {
    label: 'Copy with new Supplier',
    dataAction: 'PUSHDOWN:STTA_C_MP_ProductCopywithparams',
    invocationGrouping: #ISOLATED,
    type: #FOR_ACTION,
    position: 1
  },
  {
    label: 'Activate',
    dataAction: 'PUSHDOWN:STTA_C_MP_ProductActivation',
    invocationGrouping: #CHANGE_SET,
    type: #FOR_ACTION,
    position: 2
  },
  {
    label: 'Product',
    importance: #HIGH,
    value: 'PRODUCT',
    type: #STANDARD,
    position: 3
  },
  {
    label: 'Copy',
    dataAction: 'PUSHDOWN:STTA_C_MP_ProductCopy',
    invocationGrouping: #ISOLATED,
    type: #FOR_ACTION,
    position: 8
  }
]
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
UI.LineItem : [
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'Copy with new Supplier',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopywithparams',
    InvocationGrouping : #Isolated
  },
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'Activate',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductActivation',
    InvocationGrouping : #ChangeSet
  },
  {
    $Type : 'UI.DataField',
    Value : Product,
    ![@UI.Importance] : #High
  },
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'Copy',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy',
    Inline : true,
    InvocationGrouping : #Isolated
  },
  {
    $Type : 'UI.DataFieldForIntentBasedNavigation',
    Label : 'Manage Products (ST)',
    SemanticObject : 'EPMProduct',
    Action : 'manage_st',
    Inline : true
  }
];
```

**STEP**: 7 — Render inline buttons with icons (DataFieldForAction & DataFieldForIntentBasedNavigation)
**DESCRIPTION**: Replace button text with icon using IconUrl. Tooltip uses the button label. Icon inline is supported for inline actions only (not for ABAP CDS inline).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- DataFieldForAction with icon -->
<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="Label" String="Navigate via Action"/>
  <PropertyValue Property="Action" String="com.c_salesordermanage_sd.ActionNavigation"/>
  <PropertyValue Property="Inline" Bool="true"/>
  <PropertyValue Property="IconUrl" String="sap-icon://arrow-right"/>
</Record>

<!-- DataFieldForIntentBasedNavigation with icon -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
  <PropertyValue Property="SemanticObject" String="v4Freestyle"/>
  <PropertyValue Property="Action" String="Inbound"/>
  <PropertyValue Property="Label" String="IBN Inline"/>
  <PropertyValue Property="RequiresContext" Bool="true"/>
  <PropertyValue Property="Inline" Bool="true"/>
  <PropertyValue Property="IconUrl" String="sap-icon://arrow-left"/>
</Record>
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
/* DataFieldForAction inline with icon */
{
  $Type   : 'UI.DataFieldForAction',
  Label   : 'Navigate via Action',
  Action  : 'com.c_salesordermanage_sd.ActionNavigation',
  Inline  : true,
  IconUrl : 'sap-icon://arrow-right'
},

/* DataFieldForIntentBasedNavigation inline with icon */
{
  $Type           : 'UI.DataFieldForIntentBasedNavigation',
  SemanticObject  : 'v4Freestyle',
  Action          : 'Inbound',
  Label           : 'IBN Inline',
  RequiresContext : true,
  Inline          : true,
  IconUrl         : 'sap-icon://arrow-left'
}
```

**STEP**: 8 — Enable inline row Delete buttons (tableSettings.inlineDelete) — OData V2
**DESCRIPTION**: For responsive tables, enable inline delete per row by setting tableSettings.inlineDelete: true in manifest.json. Note: inlineDelete and multiselect cannot be enabled at the same time.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "models": {},
    "componentUsages": {},
    "sap.app": {}
  },
  "tableSettings": {
    "inlineDelete": true
  }
}
```

**STEP**: 9 — Control Update/Delete editability via UpdateRestrictions / DeleteRestrictions
**DESCRIPTION**: Use UpdateRestrictions/ DeleteRestrictions terms to set Updatable/Deletable using Bool or Path. Path points to a property in the entity indicating editability.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- UpdateRestrictions - set Updatable via path -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/Material">
  <Annotation Term="Org.OData.Capabilities.V1.UpdateRestrictions">
    <Record Type="Org.OData.Capabilities.V1.UpdateRestrictionsType">
      <PropertyValue Property="Updatable" Path="owner.isUpdatable"/>
    </Record>
  </Annotation>
</Annotations>

<!-- DeleteRestrictions - set Deletable via path -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/Material">
  <Annotation Term="Org.OData.Capabilities.V1.DeleteRestrictions">
    <Record Type="Org.OData.Capabilities.V1.DeleteRestrictionsType">
      <PropertyValue Property="Deletable" Path="owner.isDeletable"/>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
/* Example combined capability annotation */
annotate com.c_salesordermanage_sd.SalesOrderManage with @Capabilities: {
  Insertable : false,
  Deletable  : 'isDeletable',
  Updatable  : true
};
```

**STEP**: 10 — POST-based Create: show Create dialog for non-computed visible key fields and RequiredProperties
**DESCRIPTION**: For POST-based create (not NewAction), the runtime pops up a dialog to collect key and required non-computed fields. Mark key fields with Core.ComputedDefaultValue when needed. Use InsertRestrictions.RequiredProperties to ensure dialog fields appear.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Mark key as computed default value and set display text -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/ID">
  <Annotation Term="Common.Text" String="SalesOrder">
    <Annotation Term="UI.TextArrangement" EnumMember="UI.TextArrangementType/TextOnly" />
  </Annotation>
  <Annotation Term="Common.Label" String="Sales Order" />
  <Annotation Term="Core.ComputedDefaultValue" Bool="true" />
</Annotations>

<!-- InsertRestrictions with RequiredProperties -->
<Annotation Term="Org.OData.Capabilities.V1.InsertRestrictions">
  <Record Type="Org.OData.Capabilities.V1.InsertRestrictionsType">
    <PropertyValue Property="Insertable" Bool="true"/>
    <PropertyValue Property="RequiredProperties">
      <Collection>
        <PropertyPath>PurchaseOrderByCustomer</PropertyPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
entity SalesOrderManage @(
    title : 'Manage Sales Order'
) {
  key ID : UUID @(
    title                     : 'Sales Order',
    Common.Text               : SalesOrder,
    Core.ComputedDefaultValue : true
  );
  // ... other properties
}

/* Required properties example in CAP */
InsertRestrictions : {
  Insertable : true,
  RequiredProperties : [ PurchaseOrderByCustomer ]
}
```

**STEP**: 11 — Trigger actions from field values (DataFieldWithAction) and pass the field value to action parameters
**DESCRIPTION**: Use DataFieldWithAction to render a property as a link that triggers an action. Use UI.ParameterDefaultValue annotation to populate action parameter values from the record.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- DataFieldWithAction: link that triggers an action -->
<Record Type="UI.DataFieldWithAction">
  <PropertyValue Property="Value" Path="PurchaseOrderByCustomer"/>
  <PropertyValue Property="Action" String="com.c_salesordermanage_sd.ActionDataFieldWith"/>
  <PropertyValue Property="Label" String="Customer Reference"/>
</Record>

<!-- Pass field value to action parameter -->
<Annotations Target="com.c_salesordermanage_sd.ActionDataFieldWith(com.c_salesordermanage_sd.SalesOrderManage)/PurchaseOrderByCustomer">
  <Annotation Term="UI.ParameterDefaultValue" Path="_it/PurchaseOrderByCustomer"/>
  <Annotation Term="Common.Label" String="Customer Reference"/>
</Annotations>
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
{
  $Type : 'UI.DataFieldWithAction',
  Value : PurchaseOrderByCustomer,
  Label : 'Customer Reference',
  Action : 'com.c_salesordermanage_sd.ActionDataFieldWith'
},
/* Parameter default mapping done using UI.ParameterDefaultValue in service annotations */
```

**STEP**: 12 — Enable single-selection requirement for bound actions (manifest.json enableOnSelect)
**DESCRIPTION**: Make a bound (annotation-based) action enabled only when a single applicable row is selected by setting enableOnSelect to "single" under the LineItem actions in the manifest. Values: "single" or "multi" (default).
**LANGUAGE**: JSON
**CODE**:
```json
{
  "@com.sap.vocabularies.UI.v1.LineItem": {
    "actions": {
      "DataFieldForAction::com.c_salesordermanage_sd.CreateWithSalesOrderType": {
        "enableOnSelect": "single"
      }
    }
  }
}
```

**STEP**: 13 — Notes & constraints (quick reference)
**DESCRIPTION**: Quick actionable constraints to follow when implementing:
- NavigationRestrictions on parent entity set override child Insert/DeleteRestrictions.
- deletable-path requires removing sap:deletable static annotation.
- inlineDelete works only for responsive tables and cannot be combined with multiselect.
- Inline action icon buttons ignore Criticality and are supported only for inline actions.
- ABAP CDS has limited inline support for certain annotations; prefer XML annotations for some runtime features (inline icons, inline actions).
**LANGUAGE**: JSON
**CODE**:
```json
{
  "implementationNotes": [
    "Parent Org.OData.Capabilities.V1.NavigationRestrictions overrides child Insert/DeleteRestrictions.",
    "Use deletable-path (DeleteRestrictions.Deletable Path) to enable per-record delete; do not set sap:deletable simultaneously.",
    "tableSettings.inlineDelete: true is only for responsive tables; inlineDelete and multiselect cannot be enabled together.",
    "IconUrl for inline actions: label becomes tooltip; Criticality ignored for icon buttons.",
    "enableOnSelect manifest setting only works for annotation-based bound actions (not inline or static actions)."
  ]
}
```
--------------------------------

**TITLE**: Adding Confirmation Popovers for Actions (IsActionCritical annotation)

**INTRODUCTION**: Show a confirmation popover when a user triggers a UI action. Applicable only for actions that do not open an action-parameter dialog. Provide XML and CAP CDS examples to annotate an action so the Fiori Elements framework displays a confirmation popover.

**TAGS**: fiori-elements-framework, annotations, IsActionCritical, confirmation, action, CDS, XML

**STEP**: 1 — Confirm action eligibility

**DESCRIPTION**: Ensure the action you want to protect with a confirmation popover does not use an action-parameter dialog. The IsActionCritical popover is supported only for parameterless (no UI parameter dialog) actions.

**LANGUAGE**: Plain

**CODE**:
```text
# Requirement
# - Action must be parameterless (no action parameter dialog)
# - Target the correct fully-qualified action name: <Service>.<EntitySet>/<ActionName>
```

**STEP**: 2 — Add XML annotation (OData/Local XML annotation)

**DESCRIPTION**: Add the com.sap.vocabularies.Common.v1.IsActionCritical annotation to the action in your annotations XML to enable a confirmation popover. Use the fully-qualified target (Service.EntitySet/Action). Place this in your project's local XML annotation file used by the Fiori Elements app (e.g., annotations.xml).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="GWSAMPLE_BASIC.GWSAMPLE_BASIC_Entities/RegenerateAllData">
    <Annotation Term="com.sap.vocabularies.Common.v1.IsActionCritical" Bool="true"/>
</Annotations>
```

**STEP**: 3 — Add CAP CDS annotation (if using CAP)

**DESCRIPTION**: In CAP CDS, add an annotation for the action using the annotate ... with syntax. This sets Common.IsActionCritical to true for the specified action. Use your service/action fully-qualified name.

**LANGUAGE**: CDS

**CODE**:
```cql
annotate GWSAMPLE_BASIC.RegenerateAllData with @(Common.IsActionCritical : true);
```

**STEP**: 4 — ABAP CDS note / fallback

**DESCRIPTION**: There is no ABAP CDS sample provided here. If you are working in an ABAP environment, use a local XML annotation file to add the IsActionCritical annotation (same XML snippet as Step 2).

**LANGUAGE**: Plain

**CODE**:
```text
# ABAP CDS:
# No sample available. Use the local XML annotation (see Step 2) to add IsActionCritical.
```

**STEP**: 5 — Add action-specific messages (localization)

**DESCRIPTION**: You can provide action-specific labels/messages displayed in the confirmation popover. Manage localized UI text via your app's i18n/localization resources. See Localization of UI Texts for details.

**LANGUAGE**: Plain

**CODE**:
```text
# Reference
# - Localization of UI Texts: localization-of-ui-texts-b8cb649.md
# - Add localized strings for button labels, titles, and messages used by the confirmation popover.
```
--------------------------------

**TITLE**: Adding UI.ConnectedFields to a Table (OData V4)

**INTRODUCTION**: Show two semantically related properties in a single editable table column using UI.ConnectedFields. Includes ready-to-use code snippets for XML annotations, ABAP CDS, and CAP CDS (OData V4). Also points to related topics for alignment and editing/semantic-key behavior.

**TAGS**: fiori-elements, odata-v4, annotations, UI.ConnectedFields, connectedfields, ui.connectedfields, cds, abap, cap, xml, lineitem

**STEP**: 1 — Applicability and purpose

**DESCRIPTION**: Use ConnectedFields only for SAP Fiori elements with OData V4. ConnectedFields let you render multiple related fields (for example BeginDate and EndDate) inside a single table column while keeping each field individually editable. Add the ConnectedFields annotation on the target entity and reference it from the UI.LineItem collection.

**LANGUAGE**: Text

**CODE**:
```text
Applicability: SAP Fiori elements for OData V4 only.
Purpose: Represent multiple, semantically related properties in one table column while keeping each individual field editable (example: Business Trip Dates combining BeginDate and EndDate).
```

**STEP**: 2 — XML Annotation example (place in your annotation file, e.g., annotations.xml)

**DESCRIPTION**: Add a UI.ConnectedFields record with a unique qualifier (TripDates) that defines Label, Template and Data dictionary entries for each field. Then reference the connected-fields annotation from UI.LineItem using a DataFieldForAnnotation whose Target points to @UI.ConnectedFields#TripDates.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="TravelService.Travel">
  <Annotation Term="UI.ConnectedFields" Qualifier="TripDates">
    <Record Type="UI.ConnectedFieldsType">
      <PropertyValue Property="Label" String="Business Trip Dates"/>
      <PropertyValue Property="Template" String="{BeginDate}/{EndDate}"/>
      <PropertyValue Property="Data">
        <Record Type="Core.Dictionary">
          <PropertyValue Property="BeginDate">
            <Record Type="UI.DataField">
              <PropertyValue Property="Value" Path="BeginDate"/>
            </Record>
          </PropertyValue>
          <PropertyValue Property="EndDate">
            <Record Type="UI.DataField">
              <PropertyValue Property="Value" Path="EndDate"/>
            </Record>
          </PropertyValue>
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>

  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataFieldForAnnotation">
        <PropertyValue Property="Target" AnnotationPath="@UI.ConnectedFields#TripDates"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 3 — ABAP CDS annotation example (inside your CDS view or a separate annotate block)

**DESCRIPTION**: Use @UI.connectedField to define name, qualifier, template, and groupLabel. Then add @UI.lineItem with an entry using type #AS_CONNECTED_FIELDS and the valueQualifier that matches the connected field qualifier.

**LANGUAGE**: ABAP

**CODE**:
```abap
annotate view Travel with {
    @UI.connectedField : [
        {
           name: 'Dates',
           qualifier: 'TripDates',
           template: '{BeginDate} / {EndDate}',
           groupLabel: 'Business Trip Dates'
        } 
    ] 
    
    @UI.lineItem: [
        {
            type: #AS_CONNECTED_FIELDS, 
            valueQualifier: 'TripDates'
        } 
    ]
}
```

**STEP**: 4 — CAP CDS (service-level) annotation example

**DESCRIPTION**: Annotate the service entity with UI.ConnectedFields using the #TripDates qualifier. Define Label, Template and Data entries (UI.DataField for each property). Add a UI.LineItem entry that targets the connected fields annotation.

**LANGUAGE**: CDS

**CODE**:
```cds
annotate service.Travel @( 
    UI.ConnectedFields #TripDates: {
          Label: 'Business Trip Dates',
          Template: '{BeginDate} / {EndDate}',
          Data: {
              BeginDate: {
                  $Type: 'UI.DataField',
                  Value: BeginDate
              },
              EndDate: {
                  $Type: 'UI.DataField',
                  Value: EndDate
              }
          }
      },

    UI.LineItem: [
        {
          $Type: 'UI.DataFieldForAnnotation',
          Target: '@UI.ConnectedFields#TripDates'
        } 
    ]
)
```

**STEP**: 5 — Behavior and presentation notes

**DESCRIPTION**: By default the connected-fields column contents are left-aligned. You can override horizontal alignment using manifest settings (see the linked topic). Adding a semantic key to connected fields does not change editing status—see the linked topics for editing and semantic-key handling.

**LANGUAGE**: Text

**CODE**:
```text
Default alignment: left.
To override alignment: use manifest settings (see "Overriding the Horizontal Alignment of Annotation-Based Table Columns"):
  overriding-the-horizontal-alignment-of-annotation-based-table-columns-fb93920.md

Editing status & semantic keys:
  - Editing Status: editing-status-668ea18.md
  - Handling Semantic Key Fields: handling-semantic-key-fields-aa2793c.md
```
--------------------------------

**TITLE**: Adding Custom Actions Using Extension Points (SAP Fiori elements — OData V2 & V4)

**INTRODUCTION**: This document shows how to add custom action buttons (list report global, table toolbars, object page header, section/form, footer) using controller extension files and manifest configuration for SAP Fiori elements apps. Includes concrete file paths, manifest JSON snippets, controller/handler signatures and how to wire keyboard shortcuts (V2) or enabled/visible handlers (V4).

**TAGS**: fiori-elements-framework, extension-points, custom-actions, manifest.json, sapui5, odata-v2, odata-v4, controller-extension

**STEP**: 1 — Create controller extension files (V2) / handler script (V4)

**DESCRIPTION**: Create extension controllers (V2) or a JS handler module (V4) under your app webapp ext folder. Implement handler functions that will be referenced from the manifest. For V2 handlers use only the SAP Fiori elements extensionAPI inside handlers.

- File path(s):
  - V2 controllers: my_app/webapp/ext/controller/MyListReportExt.controller.js, MyObjectPageExt.controller.js, MySubObjectPageExt.controller.js
  - V4 handler module: my_app/webapp/ext/CustomActions.js

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// V2 controller extension example: my_app/webapp/ext/controller/MyListReportExt.controller.js
sap.ui.define([], function() {
    "use strict";
    return {
        // Handler for custom list report table action or global action
        onCustomAction1: function(oEvent) {
            // Use the extensionAPI only (do not manipulate internal FE controls directly)
            // Example: access event/source properties, selected contexts etc.
            // Implementation goes here...
        },

        onCustomAction2: function(oEvent) {
            // another handler
        }
    };
});
```

```javascript
// V4 handler module example: my_app/webapp/ext/CustomActions.js
sap.ui.define([], function () {
    "use strict";
    return {
        // Handler invoked on press for a custom action
        // oContext : binding context of the current entity (for object page row)
        // aSelectedContexts : array of binding contexts for selected table rows (for table actions)
        message: function (oContext, aSelectedContexts) {
            // Implementation, e.g. show message or navigate
            alert("message");
        },

        // Example enablement function used for "enabled" or "visible"
        enabledForCompletedOnly: function (oBindingContext, aSelectedContexts) {
            if (aSelectedContexts && aSelectedContexts.length === 1) {
                return true;
            }
            return false;
        }
    };
});
```

**STEP**: 2 — V2: Add custom actions in manifest.json (controllerExtensions & commands)

**DESCRIPTION**: Under sap.ui5 → extends → extensions, register controllerExtensions for ListReport or ObjectPage, and declare action definitions (id, text, press handler name, requiresSelection, applicablePath, command, global, determining). If using keyboard shortcuts, also add sap.ui.commands entry keyed by "<ComponentName>#<Component ID without app ID prefix>".

Important details:
- Action "id" must equal action name.
- "global" default = false. If a determining property is set along with global, global takes precedence.
- "requiresSelection" default = true (table toolbar).
- "determining" is deprecated (compatibility only) — use with caution for footer actions.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.commands": {
          // Key format: <ComponentName>#<Component ID without app ID prefix>
          "sap.suite.ui.generic.template.ListReport#sap.suite.ui.generic.template.ListReport::STTA_C_MP_Product": {
            "MyCustomCommand": {
              "shortcut": "Ctrl+G"
            }
          }
        },
        "sap.ui.controllerExtensions": {
          // ListReport controller extension and entity-specific actions example
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "my_app.ext.controller.ListReportExtension",
            "sap.ui.generic.app": {
              "SMART_C_Product": {
                "EntitySet": "SMART_C_Product",
                "Actions": {
                  "MyTableAction": {
                    "id": "MyTableAction",
                    "text": "{i18n>MY_TABLE_ACTION}",
                    "press": "onCustomAction1",
                    "requiresSelection": true,
                    "applicablePath": "/Status",
                    "command": "MyCustomCommand"
                  },
                  "MyGlobalAction": {
                    "id": "MyGlobalAction",
                    "text": "{i18n>MY_GLOBAL_ACTION}",
                    "press": "onCustomAction2",
                    "global": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — V2: Object page and facet-specific actions (manifest.json snippets)

**DESCRIPTION**: For object page header, table toolbar (facet), form facet or footer, extend the same controller extension entry but place action blocks under "Header", "Sections", or "Actions" (facet id). For table facet, set requiresSelection as needed. For footer (object page) set "determining": true if required (deprecated). Provide component key for controller mapping as described.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          // Object page header actions example (entity set placeholder)
          "sap.suite.ui.generic.template.ObjectPage.view.Details#my_app::sap.suite.ui.generic.template.ObjectPage.view.Details::SMART_C_Product": {
            "controllerName": "my_app.ext.controller.DetailsExtension",
            "sap.ui.generic.app": {
              "SMART_C_Product": {
                "EntitySet": "SMART_C_Product",
                "Header": {
                  "Actions": {
                    "MyHeaderAction": {
                      "id": "MyHeaderAction",
                      "text": "{i18n>MY_HEADER_ACTION}",
                      "press": "onCustomAction1",
                      "applicablePath": "/Stage",
                      "command": "MyHeaderCommand"
                    }
                  }
                }
              }
            }
          },

          // Object page table toolbar action for a SmartTable facet (use facet ID)
          "sap.suite.ui.generic.template.ObjectPage.view.Details#my_app::sap.suite.ui.generic.template.ObjectPage.view.Details::SMART_C_Product": {
            "controllerName": "my_app.ext.controller.DetailsExtension",
            "sap.ui.generic.app": {
              "SMART_C_Product": {
                "Sections": {
                  "LineItems::com.sap.vocabularies.UI.v1.LineItem": {
                    "id": "LineItems::com.sap.vocabularies.UI.v1.LineItem",
                    "Actions": {
                      "FacetTableAction": {
                        "id": "FacetTableAction",
                        "text": "{i18n>FACET_TABLE_ACTION}",
                        "press": "onCustomAction2",
                        "requiresSelection": false,
                        "applicablePath": "/Status"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — V2: Footer / determining actions and list report global actions

**DESCRIPTION**: Footer actions in V2 (list report/footer) are supported but determining buttons are deprecated. For list report global actions, place them in the ListReport controller extension "Actions" block with "global": true.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          // Example: footer action for object page (note: determining is deprecated)
          "sap.suite.ui.generic.template.ObjectPage.view.Details#my_app::sap.suite.ui.generic.template.ObjectPage.view.Details::SMART_C_Product": {
            "controllerName": "my_app.ext.controller.DetailsExtension",
            "sap.ui.generic.app": {
              "SMART_C_Product": {
                "EntitySet": "SMART_C_Product",
                "Header": {
                  "Actions": {
                    "FooterActionDeprecated": {
                      "id": "FooterActionDeprecated",
                      "text": "{i18n>FOOTER_ACTION}",
                      "press": "onCustomAction1",
                      "determining": true
                    }
                  }
                }
              }
            }
          },

          // List report global action example
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "my_app.ext.controller.ListReportExtension",
            "sap.ui.generic.app": {
              "SMART_C_Product": {
                "EntitySet": "SMART_C_Product",
                "Actions": {
                  "ExportLog": {
                    "id": "ExportLog",
                    "text": "{i18n>EXPORT_LOG}",
                    "press": "onExportLog",
                    "global": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — How to construct the component key for sap.ui.commands (V2)

**DESCRIPTION**: The sap.ui.commands entry key is "<ComponentName>#<Component ID without app ID prefix>". To get the component ID you can fetch it from an XmlView or ComponentContainer at runtime and remove the app component prefix.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example to get owner component id via XmlView element:
sap.ui.require(["sap/ui/core/Element"], function(Element) {
    var id = Element.getElementById('STTA_MP::sap.suite.ui.generic.template.ListReport.view.ListReport::STTA_C_MP_Product')
                .getController().getOwnerComponent().getId();
    // id looks like: application-EPMProduct-manage_st-component---sap.suite.ui.generic.template.ListReport::STTA_C_MP_Product
    // Remove the app component prefix + dashes to get: sap.suite.ui.generic.template.ListReport::STTA_C_MP_Product
});

// Or using ComponentContainer id:
sap.ui.require(["sap/ui/core/Element"], function(Element) {
    var comp = Element.getElementById('__xmlview0-__clone0--host').getComponent();
    // then comp.getId() ... strip prefix as above
});
```

**STEP**: 6 — V4: Add controlConfiguration actions in manifest.json (routing → targets → options → settings → controlConfiguration)

**DESCRIPTION**: For OData V4, define actions under routing targets controlConfiguration or under target options/settings/content/header or footer. Each action supports: press (handler reference as <appId>.<Folder>.<Script>.<method>), text, enabled, visible, position (placement & anchor), inline (for forms). Handler signatures:
- press handler: function(oContext, aSelectedContexts)
- enabled/visible: boolean or handler (same signature)

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "<ListReportTargetName>": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "actions": {
                    "myCustomAction": {
                      "press": "my.app.ext.CustomActions.message",
                      "text": "{i18n>MY_CUSTOM_ACTION}",
                      "enabled": "my.app.ext.CustomActions.enabledForCompletedOnly",
                      "visible": true
                    }
                  }
                }
              }
            }
          }
        },

        "<ObjectPageTargetName>": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  "actions": {
                    "MyObjectHeaderAction": {
                      "press": "my.app.ext.CustomActions.message",
                      "text": "{i18n>HEADER_ACTION}",
                      "position": {
                        "placement": "Before",
                        "anchor": "DataFieldForAction::Action"
                      }
                    }
                  }
                },

                "footer": {
                  "actions": {
                    "MyFooterAction": {
                      "press": "my.app.ext.CustomActions.message",
                      "text": "{i18n>FOOTER_ACTION}"
                    }
                  }
                }
              },

              "controlConfiguration": {
                "NavigationPropertyFromRootEntityType/@com.sap.vocabularies.UI.v1.LineItem": {
                  "actions": {
                    "ObjectPageTableAction": {
                      "press": "my.app.ext.CustomActions.message",
                      "text": "{i18n>TABLE_ACTION}",
                      "enabled": true,
                      "visible": true
                    }
                  }
                },

                "@com.sap.vocabularies.UI.v1.FieldGroup#OrderData": {
                  "actions": {
                    "customSectionAction": {
                      "press": "my.app.ext.CustomActions.message",
                      "visible": true,
                      "enabled": true,
                      "text": "Alert",
                      "position": {
                        "placement": "After",
                        "anchor": "DataFieldForIntentBasedNavigation::SalesOrder::manageInline"
                      }
                    },

                    "customFormAction": {
                      "press": "my.app.ext.CustomActions.message",
                      "visible": true,
                      "enabled": false,
                      "text": "Action on Form",
                      "inline": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 7 — V4: Handler reference format and signature

**DESCRIPTION**: In manifest.json, "press", "enabled", and "visible" can be a string pointing to a JS module method using the format:
  "<ApplicationId>.<FolderName>.<ScriptFileName>.<MethodName>"
Create the referenced module under webapp/ext and export the method using sap.ui.define. Signature:
- press: function(oContext, aSelectedContexts) { ... }
- enabled/visible: function(oContext, aSelectedContexts) { return true/false; }

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: my_app/webapp/ext/CustomActions.js
sap.ui.define([], function () {
    "use strict";
    return {
        // press handler
        navigateExternal: function (oContext, aSelectedContexts) {
            // navigation logic
        },

        // enablement used in manifest "enabled"
        enabledForCompletedOnly: function (oBindingContext, aSelectedContexts) {
            // return boolean
            return (aSelectedContexts && aSelectedContexts.length === 1);
        }
    };
});
```

**STEP**: 8 — Quick manifest property checklist & conventions

**DESCRIPTION**: Use this checklist when defining an action:
- action "id" must equal the action name used as the JSON key
- "text" typically binding to i18n: "{i18n>KEY}"
- "press": for V2 controller extension => name of method implemented in extension controller (e.g., "onCustomAction1"); for V4 use full module method path (e.g., "my.app.ext.CustomActions.message")
- "requiresSelection": default true for table toolbar actions (V2)
- "global": false by default (V2 list report actions)
- "command": name of sap.ui.commands entry for keyboard shortcuts (V2)
- "position": placement ("Before" | "After") and "anchor" (another action name)
- "inline": if true for form actions, action appears on form toolbar

**LANGUAGE**: JSON

**CODE**:
```json
{
  "actionKey": {
    "id": "actionKey",
    "text": "{i18n>ACTION_TEXT}",
    "press": "onCustomAction",
    "requiresSelection": true,
    "global": false,
    "applicablePath": "/Property",
    "command": "MyCommand"
  }
}
```

**STEP**: 9 — References & examples to explore

**DESCRIPTION**: For hands-on examples, check SAP Fiori development portal examples (FPM explorer) for custom actions and object page extensions.

**LANGUAGE**: N/A

**CODE**:
```text
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/topic/floorplanObjectPage/customAction
```
--------------------------------

**TITLE**: Adding Custom Fields to the Filter Bar (OData V2 & V4) — Manifest, Fragments, and Controller Extensions

**INTRODUCTION**: Practical, code-focused guide showing how to add and handle custom filter fields in SAP Fiori elements (OData V2 and V4). Includes manifest.json entries, XML fragment templates, controller/handler code for filtering, exporting, custom operators, required-field UI state, and metadata-bound labels. Use these snippets directly in your project, adapting keys, namespaces, and paths.

**TAGS**: fiori-elements, filter-bar, custom-filter, manifest.json, fragment, controller-extension, export, custom-operator, filterValues

STEP: 1 — Add view and controller extensions (OData V2)
DESCRIPTION: Add a view extension (fragment) and controller extension in the manifest.json for ListReport (OData V2). This connects a custom XML fragment for the SmartFilterBar and a controller extension to implement lifecycle methods like onBeforeRebindTableExtension, getCustomAppStateDataExtension, restoreCustomAppStateDataExtension, onInitSmartFilterBarExtension.
LANGUAGE: JSON
CODE:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "controllerName": "my_app.ext.controller.ListReportExtension"
        }
      },
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "SmartFilterBarControlConfigurationExtension|<myEntityset>": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "<myNamespace>.ext.fragment.CustomFilter",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

STEP: 2 — Mandatory extension methods (OData V2 controller)
DESCRIPTION: Implement these extension methods in your controller extension to integrate custom filter state with the ListReport lifecycle.
LANGUAGE: JavaScript
CODE:
```javascript
// my_app/ext/controller/ListReportExtension.js
sap.ui.define([], function() {
  "use strict";
  return {
    // Called during SmartFilterBar initialization to set defaults or bind custom controls
    onInitSmartFilterBarExtension: function(oEvent) {
      // initialize custom filter controls or defaults here
    },

    // Called before table rebind; must apply custom filters to bindingParameters.filters
    onBeforeRebindTableExtension: function(oEvent) {
      var oBindingParams = oEvent.getParameter("bindingParams");
      // compute and push filters into oBindingParams.filters
    },

    // Save state of custom controls for app-state/variant management
    getCustomAppStateDataExtension: function(oCustomData) {
      // read and store custom control values into oCustomData
    },

    // Restore state of custom controls from app-state
    restoreCustomAppStateDataExtension: function(oCustomData) {
      // read oCustomData and restore control values
    }
  };
});
```

STEP: 3 — Modify exported filter labels/values (onBeforeExportTableExtension)
DESCRIPTION: When exporting a table, modify oExportParams.filterSettings to convert raw filter expressions into user-friendly labels/values (e.g., convert OverallCost <= 1000 -> Cost = Low).
LANGUAGE: JavaScript
CODE:
```javascript
sap.ui.define([
  "sap/ui/export/util/Filter"
], function (ExportFilter) {
  "use strict";

  return {
    /**
     * Modify exported filter settings to display user-friendly labels.
     * @param {object} oExportParams - export parameters (includes includeFilterSettings, filterSettings array)
     */
    onBeforeExportTableExtension: function (oExportParams) {
      if (!oExportParams || !oExportParams.includeFilterSettings) {
        return;
      }

      var aFilterSettings = oExportParams.filterSettings || [];

      // ID of the custom Cost combobox in the SmartFilterBar fragment (update to your control ID)
      var COST_COMBOBOX_ID = "STTA_MP::sap.suite.ui.generic.template.ListReport.view.ListReport::STTA_C_MP_Product--CustomFilter-OverallCost-combobox";
      var oCostCombobox = sap.ui.getCore().byId(COST_COMBOBOX_ID);

      if (oCostCombobox && oCostCombobox.getValue()) {
        var oRawValue, sNewCostValue;

        // find and remove existing filter for property "OverallCost"
        for (var i = 0; i < aFilterSettings.length; i++) {
          var oCurrentFilter = aFilterSettings[i];
          if (oCurrentFilter.getProperty && oCurrentFilter.getProperty() === "OverallCost") {
            oRawValue = oCurrentFilter.rawValues && oCurrentFilter.rawValues[0];
            aFilterSettings.splice(i, 1);
            break;
          }
        }

        // derive user label from raw filter condition
        if (oRawValue && oRawValue.operator === "<=" && oRawValue.value === "1000") {
          sNewCostValue = "Low";
        } else {
          sNewCostValue = "High";
        }

        // create and push a new user-friendly export filter
        var sProperty = "OverallCost",
            sLabel = "Cost",
            oNewRawValue = { operator: "==", value: sNewCostValue },
            oCostFilter = new ExportFilter(sProperty, oNewRawValue, sLabel);

        aFilterSettings.push(oCostFilter);
      }
    }
  };
});
```

STEP: 4 — Manifest configuration for custom filter fields (OData V4)
DESCRIPTION: Define custom filter fields in manifest.json controlConfiguration under SelectionFields. Use key matching metadata property for predefined-operator filters or a unique key plus "property" for custom-operator filters. Configure label, template (fragment path), required, availability, and position.
LANGUAGE: JSON
CODE:
```json
{
  "targets": {
    "SalesOrderManageList": {
      "type": "Component",
      "id": "SalesOrderManageList",
      "name": "sap.fe.templates.ListReport",
      "options": {
        "settings": {
          "contextPath": "/SalesOrderManage",
          "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.SelectionFields": {
              "navigationProperties": ["_Partner", "_DistributionChannel"],
              "filterFields": {
                "Rating": {
                  "label": "{i18n>CustomRatingFilter}",
                  "availability": "Default",
                  "template": "<ProjectFolder>.ext.CustomRatingFilter",
                  "required": true,
                  "position": {
                    "placement": "After",
                    "anchor": "SalesOrder"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Simple custom filter fragment (predefined operators) — bind to filterValues
DESCRIPTION: XML fragment showing a RatingIndicator bound to the internal filterValues model. Binding to filterValues supports variant and app-state handling. Default operator EQ is used unless formatOptions override it.
LANGUAGE: XML
CODE:
```xml
<!-- <ProjectFolder>/ext/CustomRatingFilter.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m" xmlns:l="sap.ui.layout">
  <HBox alignItems="Center" width="100%">
    <RatingIndicator id="MyCustomRatingIndicatorId"
      core:require="{ Value: 'sap/fe/macros/filter/type/Value' }"
      value="{ path: 'filterValues>', type: 'Value' }" />
  </HBox>
</core:FragmentDefinition>
```

STEP: 6 — Fragment with change/reset handlers using setFilterValues (dynamic filtering)
DESCRIPTION: Fragment uses a handler module to call setFilterValues when value changes or reset is pressed. The handler module should be located at the provided path and expose onValueChanged and onReset functions that call setFilterValues.
LANGUAGE: XML
CODE:
```xml
<!-- <ProjectFolder>/ext/CustomRatingFilterWithHandler.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m" xmlns:l="sap.ui.layout">
  <HBox alignItems="Center" core:require="{handler: '<ProjectFolder>/ext/CustomRating'}" width="100%">

    <!-- RatingIndicator value reading from filterValues and invoking handler.onValueChanged -->
    <RatingIndicator id="MyCustomRatingIndicatorId"
      value="{= ${filterValues>} ? ${filterValues>}.substring(1) : null }"
      change="handler.onValueChanged" />

    <core:Icon src="sap-icon://reset"
      press="handler.onReset"
      class="sapUiSmallMarginBegin" />
  </HBox>
</core:FragmentDefinition>
```

LANGUAGE: JavaScript
CODE:
```javascript
// <ProjectFolder>/ext/CustomRating.js
sap.ui.define([], function() {
  "use strict";
  return {
    onValueChanged: function(oEvent) {
      // value param depends on control; call setFilterValues(key, value)
      // In extension fragments, "this" typically refers to the fragment controller bound to the extension API context.
      this.setFilterValues("Rating", oEvent.getParameter("value"));
    },
    onReset: function() {
      // remove the filter value for "Rating"
      this.setFilterValues("Rating");
    }
  };
});
```

STEP: 7 — Custom operators: fragment, operator implementation, and manifest registration
DESCRIPTION: For multi-value or complex logic, implement a custom operator function and register it in sap.fe.macros.filter.customFilterOperators in manifest.json. The fragment binds selectedKeys to filterValues with type MultiValue and formatOptions.operator referencing your operator.
LANGUAGE: XML
CODE:
```xml
<!-- <ProjectFolder>/ext/CustomRatingMulti.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
  <MultiComboBox
    width="100%"
    selectedKeys="{path: 'filterValues>', type: 'sap.fe.macros.filter.type.MultiValue', formatOptions: { operator: 'SalesOrder.ext.onMultiValueRatingLevels' }}">
    <layoutData>
      <FlexItemData growFactor="1" />
    </layoutData>
    <items>
      <core:Item key="low" text="low" />
      <core:Item key="medium" text="medium" />
      <core:Item key="high" text="high" />
    </items>
  </MultiComboBox>
</core:FragmentDefinition>
```

LANGUAGE: JSON
CODE:
```json
{
  "sap.fe": {
    "macros": {
      "filter": {
        "customFilterOperators": [
          {
            "name": "SalesOrder.ext.CustomRating.onMultiValueRatingLevels"
          }
        ]
      }
    }
  }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// <ProjectFolder>/ext/CustomRatingOperators.js
sap.ui.define(["sap/ui/model/Filter", "sap/ui/model/FilterOperator"], function(Filter, FilterOperator) {
  "use strict";
  return {
    /**
     * values: array of selected keys from MultiComboBox (e.g. ["low","medium"])
     * Returns a sap.ui.model.Filter combining per-value sub-filters (OR logic).
     */
    onMultiValueRatingLevels: function (values) {
      if (!values || !values.length) {
        return null;
      }

      var aFilters = [];

      values.forEach(function(value) {
        switch (value) {
          case "low":
            aFilters.push(new Filter({ path: "Rating", operator: FilterOperator.EQ, value1: 1 }));
            break;
          case "medium":
            // medium maps to multiple rating values: 2,3,4
            aFilters.push(new Filter({ path: "Rating", operator: FilterOperator.EQ, value1: 2 }));
            aFilters.push(new Filter({ path: "Rating", operator: FilterOperator.EQ, value1: 3 }));
            aFilters.push(new Filter({ path: "Rating", operator: FilterOperator.EQ, value1: 4 }));
            break;
          case "high":
            aFilters.push(new Filter({ path: "Rating", operator: FilterOperator.EQ, value1: 5 }));
            break;
          default:
            break;
        }
      });

      // Combine all computed filters with OR
      return new Filter({ filters: aFilters, and: false });
    }
  };
});
```

STEP: 8 — Custom filter marked required with UI validation
DESCRIPTION: Define required = true in manifest.json. To add dynamic visual indicator like red frame for missing values, implement a valueState formatter and bind valueState in fragment to it.
LANGUAGE: XML
CODE:
```xml
<!-- <ProjectFolder>/ext/CustomRequiredInput.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
  <Input
    core:require="{
      handler: 'SalesOrder/ext/CustomRating',
      Value: 'sap/fe/macros/filter/type/Value'
    }"
    value="{path: 'filterValues>', type: 'Value', formatOptions: { operator: 'Contains' }}"
    valueState="{path: 'filterValues>', formatter: 'handler.onFilterInputFormatValue'}"
    placeholder="{i18n>customStringFilterPlaceholder}" />
</core:FragmentDefinition>
```

LANGUAGE: JavaScript
CODE:
```javascript
// SalesOrder/ext/CustomRating.js  (formatter part)
sap.ui.define(["sap/ui/core/ValueState"], function (ValueState) {
  "use strict";
  return {
    // formatter used in fragment to set valueState depending on presence of string value
    onFilterInputFormatValue: function (sValue) {
      if (!sValue) {
        return ValueState.Error;
      } else {
        return ValueState.None;
      }
    }
  };
});
```

STEP: 9 — Metadata-bound label and property example (manifest snippet)
DESCRIPTION: Example of using metadata binding for label, pointing template fragment and property name.
LANGUAGE: JSON
CODE:
```json
{
  "MyCustomSoldToPartyThing": {
    "label": "{metaModel>/SalesOrderManage/SoldToParty@com.sap.vocabularies.Common.v1.Label}",
    "property": "Rating",
    "template": "SalesOrder.ext.CustomSoldToParty",
    "required": true,
    "position": {
      "placement": "After",
      "anchor": "MyCustomRatingThing"
    }
  }
}
```

Step: 10 — Notes and best practices (short)
DESCRIPTION: Key integration points to remember for code generation:
- Bind filter control's value to the internal model: value="{filterValues>}" to support variant and app-state handling.
- For predefined-operator custom filters, use the metadata property name as the key and omit "property".
- For custom-operator filters, use a unique key and set "property" to the main metadata property; register operator name under sap.fe.macros.filter.customFilterOperators in manifest.json.
- Use extension API methods (onBeforeRebindTableExtension, getCustomAppStateDataExtension, restoreCustomAppStateDataExtension, onInitSmartFilterBarExtension, onBeforeExportTableExtension) for tight integration with Fiori elements.
--------------------------------

**TITLE**: Add Custom Filters to an OVP Overview Page (SmartFilterBar extension)

**INTRODUCTION**: This guide shows how to add custom filter controls to the SmartFilterBar on a SAP Fiori Overview Page (OVP). It includes the XML fragment for the filter UI, a controller extension that provides filter logic and app-state persistence, and the manifest.json changes required to register the view/controller extensions. Use this when you need filters not provided by the metadata-driven SmartFilterBar.

**TAGS**: fiori-elements-framework, sapui5, ovp, smartfilterbar, extension, custom-filter, manifest.json

**STEP**: 1 — Create the custom filter fragment (XML)

**DESCRIPTION**: Create an XML fragment defining ControlConfiguration entries that add custom controls to the SmartFilterBar. Important attributes:
- groupId: associates the custom control with a filter group (if absent, default group is used).
- key: the entity property name used by the filter logic.
- visibleInAdvancedArea: true/false to control placement in advanced area.
- Input id: the control id used by the controller to read/write values.

Place file under your extension namespace, e.g. webapp/ext/customFilter.fragment.xml or src/ext/customFilter.fragment.xml. The fragmentName used in manifest.json must match.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/customFilter.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m"
                         xmlns:smartfilterbar="sap.ui.comp.smartfilterbar"
                         xmlns:core="sap.ui.core">
    <!-- Product ID Filter (in Basic group/advanced area) -->
    <smartfilterbar:ControlConfiguration groupId="_BASIC"
                                          key="ProductID"
                                          label="Product ID (Extension)"
                                          visibleInAdvancedArea="true">
        <smartfilterbar:customControl>
            <Input id="ProductID" type="Text"/>
        </smartfilterbar:customControl>
    </smartfilterbar:ControlConfiguration>

    <!-- Sales Order ID Filter (in GlobalFilters group/default area) -->
    <smartfilterbar:ControlConfiguration groupId="GlobalFilters"
                                          key="SalesOrderID"
                                          label="Sales Order ID (Extension)"
                                          visibleInAdvancedArea="false">
        <smartfilterbar:customControl>
            <Input id="SalesOrderID" type="Text"/>
        </smartfilterbar:customControl>
    </smartfilterbar:ControlConfiguration>
</core:FragmentDefinition>
```

**STEP**: 2 — Implement the controller extension with filter logic and app-state handlers (JavaScript)

**DESCRIPTION**: Create a controller extension that exposes three methods used by the OVP framework:
- getCustomFilters(): read control values and return a sap.ui.model.Filter (or undefined) to be applied globally.
- getCustomAppStateDataExtension(oCustomData): save custom-control values into the app state object passed in.
- restoreCustomAppStateDataExtension(oCustomData): restore custom-control values from the app state object.

Use the same controllerName as referenced in manifest.json (example: my_app.ext.controller.OverViewPageExt). Ensure sap.ui.model.Filter is required.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/customFilter.controller.js
sap.ui.define([
    "sap/ui/core/mvc/Controller",
    "sap/ui/model/Filter"
], function (Controller, Filter) {
    "use strict";

    return Controller.extend("my_app.ext.controller.OverViewPageExt", {
        /**
         * Return a combined filter built from custom controls.
         * The framework calls this to get additional filters to apply.
         * @returns {sap.ui.model.Filter|undefined}
         */
        getCustomFilters: function () {
            var oView = this.getView();
            var sProductID = oView.byId("ProductID") && oView.byId("ProductID").getValue();
            var sSalesOrderID = oView.byId("SalesOrderID") && oView.byId("SalesOrderID").getValue();

            var aFilters = [];

            if (sProductID) {
                aFilters.push(new Filter({
                    path: "ProductID",
                    operator: "EQ",
                    value1: sProductID
                }));
            }

            if (sSalesOrderID) {
                aFilters.push(new Filter({
                    path: "SalesOrderID",
                    operator: "EQ",
                    value1: sSalesOrderID
                }));
            }

            if (aFilters.length) {
                // Combine filters with AND (true)
                return new Filter(aFilters, true);
            }
            // If no custom filters, return undefined
        },

        /**
         * Save custom control state into provided object for app-state persistence.
         * Framework will store the returned object as part of the app state.
         * @param {object} oCustomData
         */
        getCustomAppStateDataExtension: function (oCustomData) {
            if (!oCustomData) {
                return;
            }
            var oView = this.getView();
            var oProductField = oView.byId("ProductID");
            var oSalesOrderField = oView.byId("SalesOrderID");

            if (oProductField) {
                oCustomData.ProductID = oProductField.getValue();
            }
            if (oSalesOrderField) {
                oCustomData.SalesOrderID = oSalesOrderField.getValue();
            }
        },

        /**
         * Restore custom control state from the object provided by the framework.
         * @param {object} oCustomData
         */
        restoreCustomAppStateDataExtension: function (oCustomData) {
            if (!oCustomData) {
                return;
            }
            var oView = this.getView();

            if (oCustomData.ProductID) {
                var oProductField = oView.byId("ProductID");
                if (oProductField) {
                    oProductField.setValue(oCustomData.ProductID);
                }
            } else {
                // ensure empty state is restored
                var oProductFieldEmpty = oView.byId("ProductID");
                if (oProductFieldEmpty) {
                    oProductFieldEmpty.setValue("");
                }
            }

            if (oCustomData.SalesOrderID) {
                var oSalesOrderField = oView.byId("SalesOrderID");
                if (oSalesOrderField) {
                    oSalesOrderField.setValue(oCustomData.SalesOrderID);
                }
            } else {
                var oSalesOrderFieldEmpty = oView.byId("SalesOrderID");
                if (oSalesOrderFieldEmpty) {
                    oSalesOrderFieldEmpty.setValue("");
                }
            }
        }
    });
});
```

**STEP**: 3 — Register the fragment and controller extension in manifest.json (JSON)

**DESCRIPTION**: Add controller extension under sap.ui.controllerExtensions and register the fragment under sap.ui.viewExtensions. Ensure the viewExtensions key matches the component/view you extend (for OVP it's sap.ovp.app.Main). Use the same entity type/set in both viewExtensions and sap.ovp configuration. Note: as of SAPUI5 1.54, globalFilterEntityType is deprecated — prefer globalFilterEntitySet.

Update manifest.json in your project root (webapp/manifest.json).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.ovp.app.Main": {
          "controllerName": "my_app.ext.controller.OverViewPageExt"
        }
      },
      "sap.ui.viewExtensions": {
        "sap.ovp.app.Main": {
          "SmartFilterBarControlConfigurationExtension|GlobalFilters": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "webapp.ext.customFilter",  // or the fragmentName you used, e.g. sap.ovp.demo.ext.customFilter
            "type": "XML"
          }
        }
      }
    }
  },
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntitySet": "GlobalFilters",
    "globalFilterEntityType": "GlobalFilters" // Deprecated since SAPUI5 1.54; keep only if required
    /* other sap.ovp settings */
  }
}
```

**STEP**: 4 — Notes and best practices

**DESCRIPTION**:
- Ensure the fragmentName in manifest.json exactly matches the fragment file path / namespace.
- Ensure the same entity type/entity set is used in viewExtensions and sap.ovp globalFilter settings.
- Prefer globalFilterEntitySet (SAPUI5 >= 1.54); avoid relying on deprecated globalFilterEntityType.
- Keep control IDs unique and scoped to avoid collisions with other controls.
- If you use different namespaces, update controllerName and fragmentName accordingly.
--------------------------------

**TITLE**: Add Custom Input Fields to the Mass Edit Dialog (OData V2 & V4)

**INTRODUCTION**: This guide shows how to add custom input controls to the Mass Edit dialog for SAP Fiori Elements projects (OData V2 and OData V4). It includes manifest.json entries, fragment XML files, and controller/extension snippets to handle custom save logic. Use stable control IDs and place controls inside the required container (GroupElement for V2, FormContainer for V4).

**TAGS**: fiori-elements-framework, odata-v2, odata-v4, mass-edit, manifest.json, fragment, controller-extension, viewExtension

STEP: OData V2 — Register a ViewExtension fragment for Mass Edit fields

DESCRIPTION: Add a MultiEditFieldsExtension fragment to the extended sap.ui5 section of manifest.json. The key is "MultiEditFieldsExtension|<Entity>" or "MultiEditFieldsExtension|<Entity>|<KeyIdentifier>" when using quickVariantSelectionX. Provide fragmentName and type XML. Controls in the fragment must be wrapped by a sfo:GroupElement. Provide stable control IDs and handle input values in beforeMultiEditSaveExtension.

LANGUAGE: JSON

CODE:
```json
// manifest.json (basic MultiEditFieldsExtension + Entity)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "MultiEditFieldsExtension|STTA_C_SO_SalesOrder_ND": {  // MultiEditFieldsExtension + Entity
              "className": "sap.ui.core.Fragment",
              "fragmentName": "STTA_SO_ND.ext.fragments.MultiEditFieldsExtension",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Register ViewExtension with quickVariantSelectionX (variant-specific Mass Edit)

DESCRIPTION: When using quickVariantSelectionX, append the key identifier after a pipe to the MultiEditFieldsExtension fragment key. Also configure the list page quickVariantSelectionX entry and enable multiEdit in tableSettings.

LANGUAGE: JSON

CODE:
```json
// manifest.json (MultiEditFieldsExtension tied to a variant key)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "MultiEditFieldsExtension|C_STTA_SalesOrder_WD_20|1": {  // Key identifier appended with pipe
              "className": "sap.ui.core.Fragment",
              "fragmentName": "ManageSalesOrderWithTableTabs.ext.fragments.MultiEditFieldsExtension",
              "type": "XML"
            }
          }
        }
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [{
      "entitySet": "C_STTA_SalesOrder_WD_20",
      "component": {
        "name": "sap.suite.ui.generic.template.ListReport",
        "list": true,
        "settings": {
          "quickVariantSelectionX": {
            "showCounts": true,
            "variants": {
              "0": {
                "key": "1", // <-- key identifier
                "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive",
                "tableSettings": {
                  "multiEdit": {
                    "enabled": true
                  }
                }
              }
            }
          }
        }
      }
    }]
  }
}
```

STEP: OData V2 — MultiEditFieldsExtension fragment (XML)

DESCRIPTION: Create an XML fragment with controls wrapped by a sfo:GroupElement. Provide stable IDs for controls so they can be accessed in the controller/extension (for example via Core.byId).

LANGUAGE: XML

CODE:
```xml
<!-- STTA_SO_ND.ext.fragments.MultiEditFieldsExtension.fragment.xml -->
<core:FragmentDefinition xmlns:sfo="sap.ui.comp.smartform" xmlns:core="sap.ui.core" xmlns="sap.m">
  <sfo:GroupElement>
    <Label text="Rating Bar" labelFor="RI_default"/>
    <RatingIndicator id="RI_default" maxValue="5" class="sapUiSmallMarginBottom" value="4"/>
  </sfo:GroupElement>
</core:FragmentDefinition>
```

STEP: OData V2 — Handle values with beforeMultiEditSaveExtension

DESCRIPTION: Implement beforeMultiEditSaveExtension in the controller extension to read values from the fragment controls (use Core.byId with stable IDs) and modify the update payload or short-circuit default save handling. This method is called before the framework performs mass-edit save.

LANGUAGE: JavaScript

CODE:
```javascript
// Example controller extension snippet for beforeMultiEditSaveExtension
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension",
  "sap/ui/core/Core"
], function (ControllerExtension, Core) {
  "use strict";
  return ControllerExtension.extend("my.app.Extension", {
    override: {
      beforeMultiEditSaveExtension: function (oEvent) {
        // Read a control inside the custom fragment by its stable ID
        const rating = Core.byId("RI_default") && Core.byId("RI_default").getValue && Core.byId("RI_default").getValue();
        // Modify oEvent.oUpdateData or perform validation as needed
        // Return nothing or a Promise. To block default save, follow framework contract (implementation specific).
      }
    }
  });
});
```

STEP: OData V4 — Register a custom fragment for Mass Edit (manifest)

DESCRIPTION: For OData V4, set controlConfiguration.tableSettings.enableMassEdit.customFragment under options.settings.contextPath to point to the fragment name. Controls in the fragment must be wrapped in a form:FormContainer and use stable IDs.

LANGUAGE: JSON

CODE:
```json
// manifest.json (OData V4 customFragment)
{
  "options": {
    "settings": {
      "contextPath": "/RootEntity",
      "variantManagement": "Control",
      "controlConfiguration": {
        "_Child/@com.sap.vocabularies.UI.v1.LineItem": {
          "tableSettings": {
            "type": "GridTable",
            "enableMassEdit": {
              "customFragment": "sap.fe.core.fpmExplorer.ext.fragment.customMassEdit"
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V4 — customMassEdit fragment (XML)

DESCRIPTION: Create the referenced fragment with a form:FormContainer containing form elements and controls (use stable IDs). This fragment will appear inside the Mass Edit dialog.

LANGUAGE: XML

CODE:
```xml
<!-- sap.fe.core.fpmExplorer.ext.fragment.customMassEdit.fragment.xml -->
<core:FragmentDefinition xmlns:form="sap.ui.layout.form" xmlns:core="sap.ui.core" xmlns="sap.m">
  <form:FormContainer>
    <form:formElements>
      <form:FormElement label="Execute with the custom Save">
        <form:fields>
          <CheckBox id="myCheckBox"/>
        </form:fields>
      </form:FormElement>
    </form:formElements>
  </form:FormContainer>
</core:FragmentDefinition>
```

STEP: OData V4 — Implement customMassEditSave in controller extension

DESCRIPTION: Implement editFlow.customMassEditSave in a controller extension (list report or object page). The method receives aParameters containing aContexts (selected contexts) and oUpdateData (propertyPath->value). Retrieve fragment controls via Core.byId, perform custom action (for example call an OData action via invokeAction), and return true to indicate custom save handled (prevent default), or false to let framework continue default handling.

LANGUAGE: JavaScript

CODE:
```javascript
// ControllerExtension implementing customMassEditSave
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension",
  "sap/m/MessageToast",
  "sap/ui/core/Core"
], function (ControllerExtension, MessageToast, Core) {
  "use strict";

  return ControllerExtension.extend("sap.fe.core.fpmExplorer.OPExtend", {
    override: {
      editFlow: {
        customMassEditSave: async function (aParameters) {
          // aParameters.aContexts: array containing the selected contexts for the mass edit
          // aParameters.oUpdateData: dictionary containing propertyPath -> updated value

          // Retrieve the control within the custom fragment by its stable ID
          const isSelected = Core.byId("customMassEdit--myCheckBox") && Core.byId("customMassEdit--myCheckBox").getSelected && Core.byId("customMassEdit--myCheckBox").getSelected();

          // Execute the custom save action if selected
          if (isSelected) {
            await this.base.editFlow
              .invokeAction("Service.customUpdateAction", {
                contexts: aParameters.aContexts,
                parameterValues: aParameters.oUpdateData
              })
              .catch(function (e) {
                MessageToast.show("Custom save failed");
              });
          }
          // Return true to indicate custom save handled (prevents default mass-edit),
          // return false to allow default mass-edit handling.
          return !!isSelected;
        }
      }
    }
  });
});
```

STEP: Important Requirements & Notes

DESCRIPTION:
- OData V2: Custom controls in fragments must be wrapped by sfo:GroupElement.
- OData V4: Custom controls in fragments must be wrapped by form:FormContainer.
- Always provide stable IDs for custom input fields to retrieve values via Core.byId.
- OData V2: Use beforeMultiEditSaveExtension to read inputs and alter/validate the update payload before default save.
- OData V4: Use editFlow.customMassEditSave to implement/replace save behavior.
--------------------------------

**TITLE**: Adding Custom Messages with securedExecution (SAP Fiori elements)

**INTRODUCTION**: How to add and display custom transition messages from template extensions using the extensionAPI.securedExecution (starts a busy session). Includes concrete code examples for OData V2 and OData V4, required imports, and runtime behavior of transition vs non-transition messages.

**TAGS**: fiori-elements-framework, securedExecution, messaging, ui5, odata-v2, odata-v4, transition-messages

STEP: 1 — securedExecution behavior (overview)

DESCRIPTION: Quick summary of securedExecution behavior that matters when adding messages:
- securedExecution starts a busy session: prior transition messages are removed automatically.
- Messages added to sap.ui.core.Messaging during the busy session are collected and displayed at the end of the busy session according to severity.
- Make messages transition messages by setting persistent: true (lifetime controlled by Fiori elements framework). persistent: false messages are removed by Messaging when their bound entity is reloaded.
- Use mParameters.sActionLabel to provide the action label for the securedExecution session; note it has no effect for single transition info messages (toast shown).

LANGUAGE: JavaScript

CODE:
```javascript
// Conceptual notes (no runtime code required):
// - Call this.extensionAPI.securedExecution(fn, mParameters) in extension controllers (ListReport/Overview pages).
// - For Freestyle or OData V4 editors use this.editFlow.securedExecution(fn) when available.
// - Messages added inside fn via sap/ui/core/Messaging are queued and shown after the busy session ends.
// - persistent:true => "transition message" (framework deletes them at appropriate times).
// - persistent:false => lifetime managed by Messaging (removed on entity reload).
```

STEP: 2 — OData V2: Add a transition message after an asynchronous read (full controller example)

DESCRIPTION: Example shows required UI5 module imports and how to call extensionAPI.securedExecution from a controller extension. Replace sBindingPath with your entity binding path. mParameters.sActionLabel is optional and used for labeling the busy action.

LANGUAGE: JavaScript

CODE:
```javascript
sap.ui.define([
  "sap/ui/core/messaging/Messaging",       // Note: module path variations may exist; ensure correct import in your project
  "sap/ui/core/message/Message",          // Message class
  "sap/ui/core/MessageType",
  "sap/ui/core/mvc/Controller"
], function(Messaging, Message, MessageType, Controller) {
  return Controller.extend("my.ext.Controller", {
    onCustomButtonPressed: function(oEvent) {
      var oSource = oEvent.getSource();
      var oModel = oSource.getModel();
      var sBindingPath = "/EntitySet('KEY')"; // <-- replace with your binding path

      var fnFunction = function() {
        return new Promise(function(fnResolve, fnReject) {
          oModel.read(sBindingPath, {
            success: function(oResponse) {
              var oMessage = new Message({
                message: "We have received the following response: " + JSON.stringify(oResponse),
                persistent: true,                    // create transition message
                type: MessageType.Success
              });
              Messaging.addMessages(oMessage);
              fnResolve();
            },
            error: fnReject
          });
        });
      };

      var mParameters = {
        sActionLabel: oSource.getText() // or "Your custom text"
      };

      // extensionAPI is available in Fiori elements extension controllers
      this.extensionAPI.securedExecution(fnFunction, mParameters);
    }
  });
});
```

STEP: 3 — OData V2: Add a transition message without asynchronous operations (immediate message)

DESCRIPTION: When no async operation is needed, return a resolved Promise and add the message inside. securedExecution still creates the busy session and triggers message display semantics.

LANGUAGE: JavaScript

CODE:
```javascript
sap.ui.define([
  "sap/ui/core/messaging/Messaging",
  "sap/ui/core/message/Message",
  "sap/ui/core/MessageType",
  "sap/ui/core/mvc/Controller"
], function(Messaging, Message, MessageType, Controller) {
  return Controller.extend("my.ext.Controller", {
    onCustomButtonPressed: function(oEvent) {
      var oSource = oEvent.getSource();

      var fnAddMessage = function() {
        return new Promise(function(fnResolve) {
          var oMessage = new Message({
            message: "Custom button was pressed",
            persistent: true,               // transition message
            type: MessageType.Success
          });
          Messaging.addMessages(oMessage);
          fnResolve();
        });
      };

      var mParameters = {
        sActionLabel: oSource.getText()
      };

      this.extensionAPI.securedExecution(fnAddMessage, mParameters);
    }
  });
});
```

STEP: 4 — OData V4: Add a transition message inside editFlow.securedExecution

DESCRIPTION: For OData V4 (edit flow) use this.editFlow.securedExecution to create the busy session. Import Messaging and Message modules. If your message has no target, supply an empty string. Note: both code and target are mandatory in OData V4 scenarios—if there is no target set target: "".

LANGUAGE: JavaScript

CODE:
```javascript
sap.ui.define([
  "sap/ui/core/messaging/Messaging",
  "sap/ui/core/message/Message",
  "sap/ui/core/MessageType"
], function(Messaging, Message, MessageType) {
  "use strict";

  return {
    securedExecution: function(oContext, aSelectedContexts) {
      // Use editFlow.securedExecution in OData V4 edit flows
      this.editFlow.securedExecution(function() {
        Messaging.addMessages(new Message({
          message: "Server says hello",
          target: "",               // mandatory: provide empty string if no target exists
          persistent: true,         // transition message
          type: MessageType.Success,
          code: "123"               // code is mandatory in this scenario
        }));
      });
    }
  };
});
```

STEP: 5 — Tips, rules & references

DESCRIPTION: Quick actionable rules to follow:
- persistent: true marks a transition message (framework controls removal); persistent: false lifecycle handled by Messaging.
- sActionLabel: pass into mParameters to label the busy action. Single info transition messages show a toast, so sActionLabel will not be visible in that case.
- For OData V4 messages: code and target are mandatory. If no target exists, use target: "".
- Always import Messaging and Message modules (module paths: sap/ui/core/messaging/Messaging and sap/ui/core/message/Message or their project-correct variants).
- For more details see the local docs:
  - using-the-securedexecution-method-6a39150.md
  - using-messages-239b192.md

LANGUAGE: JavaScript

CODE:
```javascript
// Quick checklist:
// - Import Messaging and Message: "sap/ui/core/messaging/Messaging", "sap/ui/core/message/Message"
// - Use this.extensionAPI.securedExecution(fn, mParameters) for V2 ListReport/Generic pages
// - Use this.editFlow.securedExecution(fn) for V4 edit flows
// - For V4 messages supply code and target (use target: "" if none)
// - persistent:true => transition message (framework-driven lifetime)
```
--------------------------------

**TITLE**: Adding Dynamic Side Content to Object Page Sections (SAP Fiori Elements)

**INTRODUCTION**: This guide shows how to add dynamic side content (right-hand preview panel) to Object Page sections and subsections in SAP Fiori Elements for both OData V2 and V4. It includes manifest configuration, fragment/view usage, i18n keys for custom button text, how to toggle side content programmatically, and the equalSplit option.

**TAGS**: fiori-elements, object-page, side-content, dynamic-side-content, manifest, odata-v2, odata-v4, fragment, extensionAPI, i18n

STEP: 0 — Caution & best practices

DESCRIPTION: Use app extensions only when manifest settings or annotations cannot achieve the required behavior. Use only the official extensionAPI from SAP Fiori elements. Avoid manipulating framework-internal controls/models. Keep side content compact (no tables, avoid horizontal scroll); intended for small previews.

LANGUAGE: text

CODE:
```text
- Use extensionAPI only (see: Extension API documentation).
- Side content is for small previews only; avoid tables and horizontal scroll.
- Keep layout and busy handling within the app extension code responsibility.
```

STEP: 1 — Add dynamic side content (OData V2 — extension points in manifest.json)

DESCRIPTION: For OData V2 object pages, add extensions under sap.ui.viewExtensions for the OPA ObjectPage view. The extension key format is:
<Different_Scenario>|<EntitySet_Name>|<Annotation_Information_of_Subsection>
Supported insertion points: BeforeMainContent and AfterMainContent. Configure className, fragmentName (or viewName), type and optional equalSplit.

LANGUAGE: json

CODE:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "AfterMainContent|STTA_C_MP_Product|GeneralInformationForm": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.SideContentExtension",
            "type": "XML",
            "equalSplit": true
          },
          "BeforeMainContent|STTA_C_MP_Product|to_ProductSalesData::com.sap.vocabularies.UI.v1.Chart": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.SideContentExtension",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

STEP: 2 — Provide an XML fragment for OData V2 side content

DESCRIPTION: Implement the fragment referenced by fragmentName. Use a compact layout (no tables). Example fragment file path: webapp/ext/fragments/SideContentExtension.fragment.xml

LANGUAGE: xml

CODE:
```xml
<!-- webapp/ext/fragments/SideContentExtension.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
  <VBox renderType="bare">
    <Text text="Side content title" />
    <Text text="{path: 'ProductName'}" />
    <!-- add small preview controls only -->
  </VBox>
</core:FragmentDefinition>
```

STEP: 3 — Custom button label for show/hide side content (i18n key pattern for OData V2)

DESCRIPTION: To override the default "Show Details"/"Hide Details" texts for the subsection toolbar button, add key/value pairs to the entity-set-specific i18n.properties. Replace annotation separators (--, ::, etc.) with a vertical bar | in keys.

LANGUAGE: text

CODE:
```text
# i18n for entity set STTA_C_MP_Product
ShowSideContent|STTA_C_MP_Product|GeneralInformationForm=Show product details
HideSideContent|STTA_C_MP_Product|GeneralInformationForm=Hide product details

# Example for annotation-based subsection:
ShowSideContent|STTA_C_MP_Product|to_ProductSalesData|com.sap.vocabularies.UI.v1.Chart=Show sales chart
HideSideContent|STTA_C_MP_Product|to_ProductSalesData|com.sap.vocabularies.UI.v1.Chart=Hide sales chart
```

STEP: 4 — Add dynamic side content (OData V4 — manifest.json settings)

DESCRIPTION: For OData V4, define sideContent under the routing target settings: either per section (no subsections) or per subSection key. Use "template" to point to an XML fragment module name and optional equalSplit flag.

LANGUAGE: json

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "SectionKeyWithoutSub": {
                      "sideContent": {
                        "template": "SalesOrder.ext.CustomSideContent"
                      }
                    },
                    "SectionWithSubSections": {
                      "subSections": {
                        "SubSectionKey": {
                          "sideContent": {
                            "template": "SalesOrder.ext.CustomSideContent",
                            "equalSplit": true
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Provide XML fragment for OData V4 side content (module fragment)

DESCRIPTION: Implement the fragment module referenced by the template path. Place fragment file at the module path used (e.g., webapp/ext/CustomSideContent.fragment.xml) and ensure namespace/module naming matches.

LANGUAGE: xml

CODE:
```xml
<!-- webapp/ext/CustomSideContent.fragment.xml (module name SalesOrder.ext.CustomSideContent) -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
  <VBox renderType="Bare">
    <Title text="Customer Info" />
    <Text text="{CustomerName}" />
    <Text text="{CustomerPhone}" />
  </VBox>
</core:FragmentDefinition>
```

STEP: 6 — Register an action and toggle side content programmatically (OData V4 example)

DESCRIPTION: Define a UI action in manifest controlConfiguration to call a controller extension method. Implement an extension module that calls this.showSideContent("<SideContent-Key>", [true|false]) to toggle or explicitly show/hide side content.

LANGUAGE: json

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "controlConfiguration": {
                  "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                    "actions": {
                      "CustomActionToggleSideContent": {
                        "press": "Namespace.ext.customSectionSideContent.toggleSideContent",
                        "text": "Show/Hide Side Content",
                        "enabled": true,
                        "visible": true
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

LANGUAGE: javascript

CODE:
```javascript
// webapp/ext/customSectionSideContent.js
sap.ui.define([], function() {
  "use strict";
  return {
    toggleSideContent: function(oBindingContext) {
      // Toggles the side content identified by the key configured in manifest
      this.showSideContent("customerInfo");          // toggles
      // Examples:
      // this.showSideContent("customerInfo", true);  // show explicitly
      // this.showSideContent("customerInfo", false); // hide explicitly
    }
  };
});
```

STEP: 7 — SideContent template properties and equalSplit

DESCRIPTION: The sideContent object supports:
- template: module path string for Fragment.load style.
- equalSplit: boolean. When true, layout splits 50:50 between main and side content. When false or omitted, responsiveness determines split (default behavior). Prefer equalSplit for clearer 1:1 preview layout.

LANGUAGE: text

CODE:
```text
Properties:
- template: "module.path.to.Fragment"   (required)
- equalSplit: true | false              (optional, default false)
```

STEP: 8 — Determine section/subSection/sideContent keys (practical rules)

DESCRIPTION: Use these simplified rules to locate the right keys for manifest sideContent and for showSideContent calls:
- Level 0 Reference Facet (RF) or Table: Section-Key and SubSection-Key are the facet id at level 0 (e.g., SalesOrderItems). SideContent-Key = Section-Key.
- Collection Facet (CF) at Level 0: side content display depends on nesting; if CF contains RF at next level, SideContent-Key is the CF level key or the CF@Level1 key depending on nesting.
- For facet-based subsections, use the subsection-key shown in the manifest under subSections.
- When the annotation info contains separators (like :: or --), replace them with | when forming keys for OData V2 i18n keys or extension keys.
- Scenario exception: In some nested cases (e.g., scenario 4.1 in Fiori documentation), SubSection-Key and SideContent-Key differ — if side content doesn't appear, inspect the facet nesting in the manifest/annotations to identify the exact key (use the facet id shown in the app's metadata or manifest).

LANGUAGE: text

CODE:
```text
Common examples:
- Section-Key (Level0 RF): "SalesOrderItems"
- SideContent-Key for that section: "SalesOrderItems"
- i18n key (V2): ShowSideContent|EntitySet|AnnotationInfo (replace separators with |)
```

STEP: 9 — Visual behavior and recommendations

DESCRIPTION: equalSplit true = 50:50 visualization. Without equalSplit, side content width is responsive (typically 1:3 or 1:2 depending on device). For clarity, prefer equalSplit for preview-style content.

LANGUAGE: text

CODE:
```text
- equalSplit: true  => main : side = 1 : 1
- equalSplit: false => responsive split (default)
Recommendation: Use equalSplit for better visualization of side content previews.
```

Step: 10 — Quick checklist before deploying side content

DESCRIPTION: Validate these items before shipping:
- Side content fragment module path matches manifest template/fragmentName.
- className/type set correctly (sap.ui.core.Fragment + XML) for V2 or template module for V4.
- i18n keys (ShowSideContent/HideSideContent) added for custom labels.
- Use only extensionAPI functions (this.showSideContent) in extension JS modules.
- Avoid tables and wide controls in side content.

LANGUAGE: text

CODE:
```text
Checklist:
- Fragment exists at declared path.
- Manifest sideContent/extends entries are valid JSON.
- i18n keys added per entity set.
- Toggle code uses this.showSideContent correctly.
- Side content remains compact and responsive.
```


--------------------------------

**TITLE**: Add a filterable "Price" field to the Smart Filter Bar (Fiori elements, OData V2)

**INTRODUCTION**: This guide shows how to add a new filterable field ("Price") with two filter options to the Smart Filter Bar of a List Report in SAP Fiori elements (OData V2) by creating a fragment (ControlConfiguration), an extension controller that applies the filter logic, adding i18n texts, and registering the view/controller extension in manifest.json.

**TAGS**: fiori-elements-framework, smart-filter-bar, filter, extension, ODataV2, UI5, SAP Fiori, i18n

**STEP**: 1 — Create fragment and controller files

**DESCRIPTION**: Create the folder structure and files in your app (webapp). The fragment adds a ControlConfiguration to the Smart Filter Bar and declares a ComboBox with two items. The controller implements onBeforeRebindTableExtension to read the ComboBox selection and push corresponding filters to the table bindingParams.

File paths:
- webapp/ext/fragment/Custom.Filter.fragment.xml
- webapp/ext/controller/Custom.Filter.controller.js

Use the fragment XML below. The ControlConfiguration key is "CustomPriceFilter" and index controls placement in the filter bar.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/ext/fragment/Custom.Filter.fragment.xml -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:smartfilterbar="sap.ui.comp.smartfilterbar"
    xmlns:core="sap.ui.core">
  <!-- Price Filter -->
  <smartfilterbar:ControlConfiguration
      key="CustomPriceFilter"
      index="3"
      label="{i18n>xfld.Price}"
      visibleInAdvancedArea="true"
      groupId="_BASIC">
    <smartfilterbar:customControl>
      <ComboBox id="CustomPriceFilter-combobox">
        <core:Item id="CustomPriceFilterItem0" key="0" text="{i18n>xtit.Price_0-100}"/>
        <core:Item id="CustomPriceFilterItem1" key="1" text="{i18n>xtit.Price_GE100}"/>
      </ComboBox>
    </smartfilterbar:customControl>
  </smartfilterbar:ControlConfiguration>
</core:FragmentDefinition>
```

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/ext/controller/Custom.Filter.controller.js
sap.ui.define([], function () {
    "use strict";
    return {
        // This hook is called before the table rebind. Use it to inject filters.
        onBeforeRebindTableExtension: function (oEvent) {
            var oBindingParams = oEvent.getParameter("bindingParams");
            oBindingParams.parameters = oBindingParams.parameters || {};

            var oSmartTable = oEvent.getSource();
            // The Smart Filter Bar associated to the SmartTable
            var oSmartFilterBar = this.byId(oSmartTable.getSmartFilterId());
            var vCategory;

            if (oSmartFilterBar instanceof sap.ui.comp.smartfilterbar.SmartFilterBar) {
                // Get the custom control by key defined in the fragment
                var oCustomControl = oSmartFilterBar.getControlByKey("CustomPriceFilter");
                if (oCustomControl instanceof sap.m.ComboBox) {
                    vCategory = oCustomControl.getSelectedKey();
                    // If ComboBox does not fire change automatically, call oCustomControl.fireChange() where appropriate
                    switch (vCategory) {
                        case "0":
                            // Price between 0 - 100
                            oBindingParams.filters.push(new sap.ui.model.Filter("Price", "LE", "100"));
                            break;
                        case "1":
                            // Price greater than 100
                            oBindingParams.filters.push(new sap.ui.model.Filter("Price", "GT", "100"));
                            break;
                        default:
                            break;
                    }
                }
            }
        }
    };
});
```

**STEP**: 2 — Add i18n entries for the field label and options

**DESCRIPTION**: Add the translatable texts to your i18n file so the fragment label and ComboBox items show localized text.

File path:
- webapp/i18n/i18n.properties

**LANGUAGE**: properties

**CODE**:
```
#XFLD: Custom filter breakout label
xfld.Price=Price
#XTIT: Price range 0-100
xtit.Price_0-100=Price between 0-100
#XTIT: Price range Over 100
xtit.Price_GE100=Price: Over 100
```

**STEP**: 3 — Register view and controller extension in manifest.json

**DESCRIPTION**: Declare the controller extension and the view (fragment) extension so the List Report loads your fragment and controller logic. Adjust the "controllerName" and "fragmentName" to your app's namespace. The example below assumes an application namespace of "my_app" and maps the files created under webapp/ext.

Insert/update the extends section under "sap.ui5" in manifest.json (or merge into your existing "extends"):

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "my_app.ext.controller.Custom.Filter"
          }
        },
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "SmartFilterBarControlConfigurationExtension|SEPMRA_C_PD_Product": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "my_app.ext.fragment.Custom.Filter",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Notes and best practices

**DESCRIPTION**:
- This is applicable only to SAP Fiori elements for OData V2.
- You can only add new fields to the Smart Filter Bar — to change an existing field you must remove it from annotations and re-add it as a new field.
- Use app extensions sparingly; prefer manifest settings or annotations where possible.
- When implementing UI controls that do not trigger a change event, call .fireChange() on the control so the Smart Filter Bar recognizes a change and shows the overlay indicating the filter state differs from displayed data.
- Use the index property on ControlConfiguration to control the position of the filter in the Smart Filter Bar.
--------------------------------

**TITLE**: Adding Multiple Fields to One Column in Responsive Tables (UI.FieldGroup + UI.LineItem)

**INTRODUCTION**: This guide shows how to group multiple fields (IDs, descriptions, action buttons, intent navigation, charts, visualizations) into a single responsive table column using UI.FieldGroup and reference it from UI.LineItem. Includes XML, ABAP CDS, and CAP CDS examples and implementation notes for OData V2/V4.

**TAGS**: fiori-elements-framework, annotations, UI.FieldGroup, UI.LineItem, OData V2, OData V4, CDS, CAP, ABAP, XML

STEP: 1 — Define UI.FieldGroup with DataFields (XML)
DESCRIPTION: Create a UI.FieldGroup annotation that contains a collection of fields to be rendered together in one responsive table column. Use UI.DataField for values and UI.DataFieldForAction for action buttons. Replace property paths and action identifiers with your entity-specific values.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="FieldGroup1">
    <Record>
        <PropertyValue Property="Data">
            <Collection>
                <!-- Display a property value (ID / description) -->
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="ContractType"/>
                </Record>

                <!-- Display an action button in the same column -->
                <Record Type="UI.DataFieldForAction">
                    <PropertyValue Property="Label" String="Dummy Button"/>
                    <PropertyValue Property="Action" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 2 — Define UI.FieldGroup with DataFields (ABAP CDS)
DESCRIPTION: ABAP CDS variant: annotate properties and/or fields with @UI.fieldGroup qualifiers to assemble the group. Use type #STANDARD for normal fields and #FOR_ACTION for actions. Ensure qualifier matches the UI.LineItem reference.
LANGUAGE: CDS
CODE:
```c
/* ABAP CDS - Field for value */
@UI.fieldGroup: [
  {
    value: 'CONTRACTTYPE',
    type: #STANDARD,
    position: 1,
    qualifier: 'FieldGroup1'
  }
]
CONTRACTTYPE;

/* ABAP CDS - Field for action in same group */
@UI.fieldGroup: [
  {
    label: 'Dummy Button',
    dataAction: 'PUSHDOWN:com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2',
    type: #FOR_ACTION,
    position: 2,
    qualifier: 'FieldGroup1'
  }
]
contractname;
```

STEP: 3 — Define UI.FieldGroup with DataFields (CAP CDS)
DESCRIPTION: CAP CDS variant: declare UI.FieldGroup with Data array and include UI.DataField and UI.DataFieldForAction entries. Use the same qualifier name referenced in UI.LineItem.Target.
LANGUAGE: CDS
CODE:
```c
/* CAP CDS - FieldGroup definition */
UI.FieldGroup #FieldGroup1 : {
    Data : [
        {
            $Type : 'UI.DataField',
            Value : ContractType
        },
        {
            $Type : 'UI.DataFieldForAction',
            Label : 'Dummy Button',
            Action : 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2'
        }
    ]
}
```

STEP: 4 — Reference FieldGroup from UI.LineItem (XML)
DESCRIPTION: Reference the FieldGroup from UI.LineItem using a DataFieldForAnnotation with AnnotationPath pointing to the FieldGroup qualifier. This causes the UI to render the group's fields within a single table column.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.LineItem">
    <Collection>
        <!-- other line item entries -->
        <Record Type="UI.DataFieldForAnnotation">
            <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#FieldGroup1" />
            <PropertyValue Property="Label" String="Type Information"/>
        </Record>
        <!-- other line item entries -->
    </Collection>
</Annotation>
```

STEP: 5 — Reference FieldGroup from UI.LineItem (ABAP CDS)
DESCRIPTION: ABAP CDS variant: add a @UI.lineItem entry of type #AS_FIELDGROUP and set valueQualifier to the FieldGroup qualifier.
LANGUAGE: CDS
CODE:
```c
@UI.lineItem: [
  {
    label: 'Type Information',
    type: #AS_FIELDGROUP,
    valueQualifier: 'FieldGroup1'
  }
]
producttype;
```

STEP: 6 — Reference FieldGroup from UI.LineItem (CAP CDS)
DESCRIPTION: CAP CDS variant: include a UI.DataFieldForAnnotation in UI.LineItem with Target referencing the FieldGroup qualifier.
LANGUAGE: CDS
CODE:
```c
UI.LineItem : [
    {
        $Type : 'UI.DataFieldForAnnotation',
        Target : '@UI.FieldGroup#FieldGroup1',
        Label : 'Type Information'
    }
]
```

STEP: 7 — Allowed annotation types inside UI.FieldGroup
DESCRIPTION: Use these annotation types inside the FieldGroup.Data collection to compose the semantic column content. Choose types supported by your Fiori elements/OData version.
LANGUAGE: TEXT
CODE:
```
Allowed UI.FieldGroup entries:
- UI.DataField
- UI.DataFieldForAction
- UI.DataFieldForIntentBasedNavigation
- UI.DataFieldForAnnotation
    - Communication.Contact
    - UI.Visualization/Rating
    - UI.Visualization/Progress

(Additional in OData V2)
- UI.DataFieldWithNavigationPath
- UI.DataFieldForAnnotation
    - UI.Chart
```

STEP: 8 — Restrictions and behavior (OData V2 and V4)
DESCRIPTION: Implementation and runtime caveats to consider when using UI.FieldGroup in responsive tables. Apply these when enabling features like Excel export or table personalization.
LANGUAGE: TEXT
CODE:
```
Restrictions:
- OData V2 Excel export: only the first visible field of the semantically connected column is exported.
- OData V4 Excel export: none of the fields inside the semantically connected column are exported.
- Table personalization: users can only filter, sort, and group on the individual properties inside the FieldGroup (properties must belong to the same entity type as the UI.LineItem). You cannot filter/sort/group by the combined column header; use the individual property names (e.g., Height, Weight).

Example:
Column header "Combined" shows Height and Weight in one column via FieldGroup.
Personalization must use Height or Weight individually, not "Combined".
```

STEP: 9 — TextArrangement behavior note
DESCRIPTION: When an ID property and its corresponding sap:text property (description) are both included in the same FieldGroup column, TextArrangement is not applied — default behavior is idOnly. For other scenarios you can still define textArrangement to display ID and description.
LANGUAGE: TEXT
CODE:
```
Note:
- If property and its sap:text property are shown in the same FieldGroup column, TextArrangement is ignored and defaults to idOnly.
- In all other cases, define textArrangement as needed to show both ID and description in the table column.
```
--------------------------------

**TITLE**: Add Segmented Buttons (SelectionVariant) to Object Page Table Toolbar

**INTRODUCTION**: This guide shows how to add segmented buttons (or a selection box when there are 4+ variants) to a table toolbar on an Object Page by defining SelectionVariant annotations and wiring them into the application manifest. Use these variants to filter the table when a user picks a button. Includes examples in XML annotations, ABAP CDS, CAP CDS, and manifest.json for both OData V2 and OData V4 setups.

**TAGS**: fiori-elements, selectionvariant, segmented-button, manifest.json, ODataV2, ODataV4, annotations, CDS, CAP

STEP: 1 — Define SelectionVariant (XML annotation)
DESCRIPTION: Create SelectionVariant annotations with qualifiers. Each SelectionVariant provides a Text (used as button/option label) and SelectOptions/Ranges used to filter the table when selected. Save in your UI annotation XML (e.g., annotations.xml).
LANGUAGE: XML
CODE:
```xml
<!-- Example UI.SelectionVariant annotations with qualifiers "SimpleFilter" and "ComplexFilter" -->
<Annotation Term="UI.SelectionVariant" Qualifier="SimpleFilter">
  <Record>
    <PropertyValue Property="Text" String="Tax amount less than 10 USD" />
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record Type="UI.SelectOptionType">
          <PropertyValue Property="PropertyName" PropertyPath="tax_amount" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record Type="UI.SelectionRangeType">
                <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/LT" />
                <PropertyValue Property="Low" String="10" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>

<Annotation Term="UI.SelectionVariant" Qualifier="ComplexFilter">
  <Record>
    <PropertyValue Property="Text" String="Net Amount between 10 and 40 And Gross Amount Less than 100 USD" />
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record Type="UI.SelectOptionType">
          <PropertyValue Property="PropertyName" PropertyPath="net_amount" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record Type="UI.SelectionRangeType">
                <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/BT" />
                <PropertyValue Property="Low" String="10" />
                <PropertyValue Property="High" String="40" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>

        <Record Type="UI.SelectOptionType">
          <PropertyValue Property="PropertyName" PropertyPath="gross_amount" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record Type="UI.SelectionRangeType">
                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/LT" />
                <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                <PropertyValue Property="Low" String="100" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 2 — Define SelectionVariant (ABAP CDS)
DESCRIPTION: Declare the same SelectionVariant semantics in ABAP CDS using @UI.selectionVariant with qualifier and filter expression. Place in your CDS view where UI annotations are defined.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.selectionVariant: [
  {
    text: 'Tax amount less than 10 USD',
    qualifier: 'SimpleFilter',
    filter: 'tax_amount LT 10'
  }
]

@UI.selectionVariant: [
  {
    text: 'Net Amount between 10 and 40 And Gross Amount Less than 100 USD',
    qualifier: 'ComplexFilter',
    filter: 'net_amount GE 10 and net_amount LE 40 and gross_amount LT 100'
  }
]
```

STEP: 3 — Define SelectionVariant (CAP CDS)
DESCRIPTION: Declare selection variants in CAP CDS using UI.SelectionVariant with qualifiers. Place in your .cds file used for UI annotations.
LANGUAGE: CDS
CODE:
```cds
UI.SelectionVariant #SimpleFilter : {
  Text : 'Tax amount less than 10 USD',
  SelectOptions : [
    {
      $Type : 'UI.SelectOptionType',
      PropertyName : tax_amount,
      Ranges : [
        {
          $Type : 'UI.SelectionRangeType',
          Sign : #I,
          Option : #LT,
          Low : '10'
        }
      ]
    }
  ]
},
UI.SelectionVariant #ComplexFilter : {
  Text : 'Net Amount between 10 and 40 And Gross Amount Less than 100 USD',
  SelectOptions : [
    {
      $Type : 'UI.SelectOptionType',
      PropertyName : net_amount,
      Ranges : [
        {
          Sign : #I,
          Option : #BT,
          Low : '10',
          High : '40'
        }
      ]
    },
    {
      $Type : 'UI.SelectOptionType',
      PropertyName : gross_amount,
      Ranges : [
        {
          $Type : 'UI.SelectionRangeType',
          Option : #LT,
          Sign : #I,
          Low : '100'
        }
      ]
    }
  ]
}
```

STEP: 4 — Wire SelectionVariant into manifest.json (OData V2 / ObjectPage)
DESCRIPTION: For SAP Fiori elements OData V2 Object Page, add quickVariantSelection under component.settings.sections.<SectionID>. Each variant entry references an annotationPath: "com.sap.vocabularies.UI.v1.SelectionVariant#<Qualifier>" and provides a key. showCounts controls whether counts are displayed next to button labels.
LANGUAGE: JSON
CODE:
```json
// manifest.json (place under "component" -> "settings" -> "sections" -> "<YourSectionID>")
"component": {
  "name": "sap.suite.ui.generic.template.ObjectPage",
  "settings": {
    "sections": {
      "SalesOrderItemsID": {
        "navigationProperty": "to_Item",
        "entitySet": "C_STTA_SalesOrderItem_WD_20",
        "createMode": "inline",
        "quickVariantSelection": {
          "showCounts": true,
          "variants": {
            "0": {
              "key": "_tab2",
              "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#SimpleFilter"
            },
            "1": {
              "key": "_tab3",
              "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#ComplexFilter"
            }
          }
        }
      }
    },
    "showRelatedApps": true
  }
}
```

STEP: 5 — Wire SelectionVariant into manifest.json (OData V4 / FE Object Page)
DESCRIPTION: For SAP Fiori elements OData V4, add quickVariantSelection under options.settings.controlConfiguration for the table control. Use "paths" array with annotationPath entries. Use showCounts and hideTableTitle as needed.
LANGUAGE: JSON
CODE:
```json
// manifest.json (sample FE component configuration)
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "contextPath": "/SalesOrderManage",
      "controlConfiguration": {
        "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
          "tableSettings": {
            "type": "GridTable",
            "quickVariantSelection": {
              "paths": [
                { "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#SimpleFilter" },
                { "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#ComplexFilter" }
              ],
              "showCounts": true,
              "hideTableTitle": true
            }
          }
        }
      }
    }
  }
}
```

STEP: 6 — Behavior rules and implementation notes
DESCRIPTION: Important behaviors you must consider and implement accordingly.
LANGUAGE: text
CODE:
```
- Rendering:
  - If number of variants (paths/variants entries) <= 3 -> segmented buttons rendered.
  - If number of variants >= 4 -> selection box rendered.

- Annotation combination rules:
  - If SelectionVariant contains multiple SelectOptionType entries targeting the same property -> those filters are combined with OR.
  - If SelectOptionType entries target different properties -> those filters are combined with AND.

- Counts:
  - When the table initially loads, two count calls are made to determine record counts shown in button text (this is expected behavior when showCounts=true).
  - OData V2: set "showCounts": false to avoid showing counts in button text and to avoid the extra count calls.
  - OData V4: "showCounts" defaults to false. When true, counts appear next to button labels and the table title count is hidden.
  - hideTableTitle (OData V4): set to true to hide the table title and show only the segmented buttons/selection box. Use only if SelectionVariant Text is self-explanatory.

- Labeling:
  - The SelectionVariant Text property is used as the button/option label; ensure it is descriptive.

- Placement:
  - OData V2: quickVariantSelection placed under component.settings.sections.<SectionID>.
  - OData V4: quickVariantSelection placed under options.settings.controlConfiguration for the specific table control path.

- Note on counts performance:
  - Consider UX/performance trade-offs when enabling showCounts because it triggers additional OData calls.
```


--------------------------------

**TITLE**: Add or Remove Object-Page Subpages (manifest.json) for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: This guide shows how to programmatically add and remove subpages (detail subpages) for object pages by editing the manifest.json. It covers:
- OData V2: nested "sap.ui.generic.app" pages structure with 1:n associations rendered as tables.
- OData V4: adding a route and target under "sap.ui5.routing".
Also notes the recommended use of SAP Fiori tools (Page Map) for UI-driven changes. Apply edits in manifest.json in your app (project root or webapp/manifest.json).

**TAGS**: fiori-elements-framework, manifest.json, object-page, subpage, sap-ui5, routing, odata-v2, odata-v4, sap-fe, sap.fiori.tools

STEP: Recommended workflow
DESCRIPTION: Use SAP Fiori tools (Page Map) in SAP Business Application Studio or VS Code to add/remove/configure pages visually. This keeps manifest changes consistent and avoids manual syntax mistakes. If you must edit manually, follow the steps below.
LANGUAGE: text
CODE:
```text
Tool: SAP Fiori tools (Page Map) in Business Application Studio or Visual Studio Code
Action: Use Page Map to add/remove subpages, or proceed to manual edits in manifest.json as shown below.
```

STEP: Add a subpage (OData V2) — manifest structure (example)
DESCRIPTION: For OData V2 apps, add nested pages under "sap.ui.generic.app" in manifest.json. Each nested "pages" entry is an object page; use "entitySet", "component.name", and for subpages include "navigationProperty" for the 1:n relation. To remove the subpage, delete the corresponding nested pages configuration.
LANGUAGE: JSON
CODE:
```json
"sap.ui.generic.app": {
  "pages": {
    "entitySet": "SEPMRA_I_ProductWithDraft",
    "component": {
      "name": "sap.suite.ui.generic.template.ListReport",
      "list": true
    },
    "pages": {
      "entitySet": "SEPMRA_I_ProductWithDraft",
      "component": {
        "name": "sap.suite.ui.generic.template.ObjectPage"
      },
      "pages": {
        "entitySet": "SEPMRA_I_ProductTextWithDraft",
        "navigationProperty": "to_ProductText",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      }
    }
  }
}
```
Notes:
- location: manifest.json (project root or webapp/manifest.json)
- key fields: "entitySet" identifies the entity, "navigationProperty" links the sub-entity (1:n), "component.name" specifies the template.
- Removal: delete the nested "pages" block for the subpage and any references to it.

STEP: Add a subpage (OData V4) — add route and target
DESCRIPTION: For OData V4 apps, add a route in "sap.ui5.routing.routes" and a corresponding target in "sap.ui5.routing.targets" inside manifest.json. The route defines the URL pattern and target name; the target defines the component to load and its settings (contextPath). To remove the subpage, remove both the route and the target.
LANGUAGE: JSON
CODE:
```json
"sap.ui5": {
  "routing": {
    "routes": [
      {
        "pattern": "SalesOrderManage({key})/_Item({key2}):?query:",
        "name": "SalesOrderItemObjectPage",
        "target": "SalesOrderItemObjectPage"
      }
    ],
    "targets": {
      "SalesOrderItemObjectPage": {
        "type": "Component",
        "id": "SalesOrderItemObjectPage",
        "name": "sap.fe.templates.ObjectPage",
        "options": {
          "settings": {
            "contextPath": "/SalesOrderItem"
          }
        }
      }
    }
  }
}
```
Notes:
- Ensure the route pattern and target name match your navigation logic.
- "contextPath" should point to the entity set or navigation context for the subpage.
- Removal: delete the route entry from "routes" and the corresponding target object from "targets".

STEP: Generator behavior and automatic subpage creation (OData V2)
DESCRIPTION: When generating an app and selecting first- and second-level entities, the SAP Fiori generator will create the subpage configuration automatically (a 1:n association rendered as a table). Use this as a reference for expected manifest structure; you can later remove the config if you do not want the subpage.
LANGUAGE: JSON
CODE:
```json
// Example generated structure for OData V2 (same pattern as the OData V2 code block above)
"sap.ui.generic.app": {
  "pages": {
    "entitySet": "SEPMRA_I_ProductWithDraft",
    "component": {
      "name": "sap.suite.ui.generic.template.ListReport",
      "list": true
    },
    "pages": {
      "entitySet": "SEPMRA_I_ProductWithDraft",
      "component": {
        "name": "sap.suite.ui.generic.template.ObjectPage"
      },
      "pages": {
        "entitySet": "SEPMRA_I_ProductTextWithDraft",
        "navigationProperty": "to_ProductText",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      }
    }
  }
}
```

STEP: Removal checklist
DESCRIPTION: To remove a subpage:
- OData V2: delete the nested "pages" block for the subpage (including "entitySet" and "navigationProperty") from "sap.ui.generic.app".
- OData V4: delete the route from "sap.ui5.routing.routes" and the target from "sap.ui5.routing.targets".
LANGUAGE: text
CODE:
```text
OData V2: Remove nested "pages" entry for the sub-entity under "sap.ui.generic.app".
OData V4: Remove both the corresponding route object in "sap.ui5.routing.routes" and the target object in "sap.ui5.routing.targets".
```

STEP: Caution about tooling
DESCRIPTION: SAP Web IDE is deprecated for trial accounts on SAP BTP. Prefer SAP Business Application Studio or SAP Fiori tools in VS Code. References to SAP Web IDE are relevant only for productive BTP accounts that still have access.
LANGUAGE: text
CODE:
```text
Recommendation: Use SAP Business Application Studio or SAP Fiori tools (VS Code) for Page Map and manifest updates.
```
--------------------------------

**TITLE**: Add AI Icon to Fiori Elements Action Buttons (OData V4)

**INTRODUCTION**: Quick, code-focused guide to enable the SAP "AI" icon on action buttons in SAP Fiori elements (OData V4). Shows prerequisites and exact code changes for manifest.json, local XML annotations, and CAP CDS. Includes restrictions and override rules.

**TAGS**: fiori-elements, ui5, manifest.json, annotations, UI.IsAIOperation, isAIOperation, OData V4, CAP, CDS, XML, JSON

STEP: Prerequisites and rules
DESCRIPTION: Ensure environment and rules for using the AI icon. The icon must be the SAP Icons V5 "AI" icon. Applicable only to SAP Fiori elements for OData V4. The AI icon can be applied only to actions created via UI.DataFieldForAction or UI.DataFieldForActionGroup (not inline action buttons). If you process personal data with AI, provide transparency per policy. If the same setting appears in manifest.json and local annotations, manifest.json wins.
LANGUAGE: HTML
CODE:
```html
<!-- Ensure SAP icons CSS is available in your app -->
<link rel="stylesheet" type="text/css" href="../css/sap-icons.css"/>
```

STEP: Add AI icon via manifest.json
DESCRIPTION: Set isAIOperation: true for the target action in the controlConfiguration under the view's settings. This applies to actions defined in the LineItem (table) controlConfiguration. manifest.json settings override local annotations.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "ListReportExample": {
          "type": "Component",
          "name": "sap.fe.templates.ListReport",
          "id": "ListReportExample",
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "actions": {
                    "TableCustomAction": {
                      "text": "Custom Action",
                      "press": "sap.fe.core.ActionAllAreas.AnnotationUnboundAction",
                      "isAIOperation": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Add AI icon using local XML annotations (unbound/bound action)
DESCRIPTION: For local XML annotations (use when not using manifest.json or when action group requires local annotations) set UI.IsAIOperation = true on the action target. For ABAP CDS: note that ABAP CDS does not support UI.IsAIOperation — use local XML annotations instead.
LANGUAGE: XML
CODE:
```xml
<!-- Define the unbound action (example) -->
<Action Name="AIUnboundAction" IsBound="false">
    <ReturnType Type="com.c_salesordermanage_sd_aggregate.SalesOrderManage" />
</Action>

<!-- Set UI.IsAIOperation on the annotation target -->
<Annotations Target="com.c_salesordermanage_sd_aggregate.AIUnboundAction()">
    <Annotation Term="UI.IsAIOperation" Bool="true" />
</Annotations>
```

STEP: Add AI indicator in CAP CDS (useful for CAP-based services)
DESCRIPTION: For CAP CDS models, you can annotate the action with @UI.IsAIOperation : true. This example shows a service action with the annotation. Note: CAP CDS can express UI.IsAIOperation; ABAP CDS cannot.
LANGUAGE: CDS
CODE:
```cds
namespace sap.fe.core;

service ActionAllAreas {
  @odata.draft.enabled
  entity RootElement as projection on core.RootElement actions {
    @cds.odata.bindingparameter.name: 'self'
    @UI.IsAIOperation : true
    action AnnotationAction() returns RootElement;
  }
}
```

STEP: Apply AI icon for UI.DataFieldForActionGroup
DESCRIPTION: For actions inside a UI.DataFieldForActionGroup, set UI.DataFieldForAction = true on each child action element (local XML annotations). The group itself does not take UI.IsAIOperation; each child action must be annotated so the group’s buttons display the AI icon.
LANGUAGE: XML
CODE:
```xml
<!-- Example: DataFieldForActionGroup with child actions annotated locally -->
<Annotations Target="YourEntityType">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataFieldForActionGroup">
        <PropertyValue Property="Label" String="AI Actions" />
        <PropertyValue Property="Data" >
          <Collection>
            <Record Type="UI.DataFieldForAction">
              <PropertyValue Property="Action" String="YourAction1" />
            </Record>
            <Record Type="UI.DataFieldForAction">
              <PropertyValue Property="Action" String="YourAction2" />
            </Record>
          </Collection>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>

  <!-- Annotate each action target with UI.IsAIOperation -->
  <Annotation Term="UI.IsAIOperation" Target="YourService.YourAction1()" Bool="true" />
  <Annotation Term="UI.IsAIOperation" Target="YourService.YourAction2()" Bool="true" />
</Annotations>
```

STEP: Visual behavior and restrictions
DESCRIPTION: The UI framework renders the AI icon automatically before the button text when isAIOperation/UI.IsAIOperation is true. Do not attempt to add the icon to inline action buttons — only supported for UI.DataFieldForAction and UI.DataFieldForActionGroup child actions. Use manifest.json when you want a single source of truth; it overrides local annotations.
--------------------------------

**TITLE**: Enable OData $select for an OV P Card via manifest.json (addODataSelect)

**INTRODUCTION**: Use the addODataSelect manifest.json property to include an OData $select parameter on list and table cards (sap.ovp.cards.list / table) when your backend (e.g., Smart Business OData services) requires specific properties or aggregated values. This prevents unnecessary properties from being returned while ensuring required fields (including aggregated fields) are available to the card.

**TAGS**: fiori-elements-framework, OData, manifest.json, sap.ovp, addODataSelect, Smart Business, $select

STEP: 1 — Where to set addODataSelect and when to use it

DESCRIPTION: Add the addODataSelect boolean under the specific card's settings in webapp/manifest.json. Set to true when the card must receive only selected properties (for example, to obtain aggregated values from Smart Business OData services). Note: list and table cards do not add $select automatically because $select can affect navigation behavior; enable explicitly only when required.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters",  // Deprecated since SAPUI5 1.54
    "globalFilterEntitySet": "GlobalFilters",   // Use from SAPUI5 1.54
    "cards": {
      "card00": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.list",
        "settings": {
          "entitySet": "SalesOrderSet",
          "category": "Sales Orders with filters",
          "listType": "extended",
          "addODataSelect": true
        }
      }
    }
  }
}
```

STEP: 2 — File location and enabling/disabling behavior

DESCRIPTION: Place or update this manifest.json (typically at webapp/manifest.json). To disable $select behavior either omit addODataSelect or set it to false. Enabling addODataSelect instructs the card request to include a $select clause listing only the properties required by the card.

LANGUAGE: Plain Text

CODE:
```text
File: webapp/manifest.json
- Ensure the "sap.ovp" -> "cards" -> "<cardId>" -> "settings" contains:
  "addODataSelect": true    // enables sending $select for that card's OData requests
  OR
  "addODataSelect": false   // disables sending $select (or simply omit the property)
```

STEP: 3 — Example of resulting OData request with $select

DESCRIPTION: Example of an HTTP GET request the card may issue when addODataSelect is enabled. The actual selected properties depend on card metadata and card settings.

LANGUAGE: HTTP

CODE:
```http
GET /sap/opu/odata/sap/YourService/SalesOrderSet?$select=SalesOrderID,CustomerName,TotalAmount HTTP/1.1
Host: your.sap.system.example
Accept: application/json
```

STEP: 4 — Notes and best practices

DESCRIPTION: - Only enable addODataSelect for cards that require it (e.g., to display aggregated fields from Smart Business OData). - Test navigation and card behavior after enabling, because $select can affect expand/navigation scenarios. - Keep manifest JSON changes scoped to the specific card(s) needing $select to avoid unintentionally changing other cards' OData calls.

LANGUAGE: Plain Text

CODE:
```text
Best practices:
- Enable addODataSelect per-card only when necessary.
- Verify SAPUI5 version: prefer "globalFilterEntitySet" (available from 1.54); "globalFilterEntityType" is deprecated.
- After enabling, confirm the card receives the expected properties and that navigation still works as expected.
```
--------------------------------

**TITLE**: Add Titles to Object Page Tables (UI.HeaderInfo TypeNamePlural)

**INTRODUCTION**: Show how to add a title to an Object Page table by supplying the TypeNamePlural property in the UI.HeaderInfo annotation for the entity type that the table is bound to. Examples provided for XML annotations, ABAP CDS, and CAP CDS.

**TAGS**: fiori-elements-framework, object-page, annotations, UI.HeaderInfo, TypeNamePlural, table-title, CDS, CAP, XML, ABAP

**STEP**: 1 — XML Annotation for OData metadata extension
**DESCRIPTION**: Add a UI.HeaderInfo annotation to the target entity type in your OData annotation XML. Set TypeNamePlural to the display string (literal or i18n key). Provide Title and Description DataField values if needed.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: annotations.xml (or equivalent OData annotation file) -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductTextType">
    <Annotation Term="UI.HeaderInfo">
        <Record>
            <PropertyValue Property="TypeName" String="Product Text" />
            <!-- Mandatory: plural name used as table title -->
            <PropertyValue Property="TypeNamePlural" String="{@i18n>@TableTitle}" />
            <PropertyValue Property="Title">
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="Name" />
                </Record>
            </PropertyValue>
            <PropertyValue Property="Description">
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="Language" />
                </Record>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 2 — ABAP CDS Annotation
**DESCRIPTION**: Use @UI.headerInfo in ABAP CDS to provide TypeNamePlural and other header metadata. This annotation drives the table title on the Object Page for the associated CDS view/entity.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.headerInfo: {
  typeName: 'Product Text',
  typeNamePlural: '{@i18n>@TableTitle}',   " mandatory: plural label used as table title
  title: {
    value: 'NAME',
    type: #STANDARD
  },
  description: {
    value: 'LANGUAGE',
    type: #STANDARD
  }
}
annotate view STTA_C_MP_PRODUCTTEXT with {
  /* additional annotations if required */
}
```

**STEP**: 3 — CAP CDS Annotation
**DESCRIPTION**: For CAP-based services, annotate the entity in CDS (service layer) with UI.HeaderInfo and set TypeNamePlural. Use UI.DataField for Title and Description values.
**LANGUAGE**: CAP CDS
**CODE**:
```cds
// File: service.cds or model.cds (where you annotate the entity)
annotate STTA_PROD_MAN.STTA_C_MP_ProductType @( 
  UI.HeaderInfo : {
    TypeName : 'Product Text',
    TypeNamePlural : '{@i18n>@TableTitle}',  // mandatory: plural label used as table title
    Title : {
      $Type : 'UI.DataField',
      Value : Name
    },
    Description : {
      $Type : 'UI.DataField',
      Value : Language
    }
  }
);
```

**STEP**: 4 — Required considerations and UI behavior
**DESCRIPTION**: Important rules and UI behavior to apply when adding table titles.
**LANGUAGE**: Text
**CODE**:
```text
- TypeNamePlural is mandatory: without it the table title will not be shown.
- If the UI.HeaderInfo annotation is not present for the entity type, no table title is displayed.
- If a section/subsection contains only one control (table or chart), the section/subsection title is hidden and becomes the control title automatically.
- If you intentionally want the section title to be used as the control title, provide matching strings under TypeNamePlural in UI.HeaderInfo and configure the section to hide its title if needed.
- Reference image (example result): images/Adding_Titles_to_Object_page_8920264.png
- Additional reading:
  - Placing Reuse Component Instances on the Object Page: placing-reuse-component-instances-on-the-object-page-1ba7f88.md
  - Adding a Custom Section to an Object Page: adding-a-custom-section-to-an-object-page-a357047.md
```
--------------------------------

**TITLE**: Two Adjacent Tables in an Object Page Subsection (SAP Fiori elements, OData V2)

**INTRODUCTION**: This describes how to place two tables side-by-side in a subsection of an Object Page by adding UI annotations (OData V2). Add a UI.CollectionFacet with two UI.ReferenceFacet entries that point to the navigation-property-level UI.LineItem annotations (optionally qualified). This is applicable only to SAP Fiori elements for OData V2.

**TAGS**: fiori-elements-framework, odata-v2, annotations, ui.collectionfacet, ui.referencefacet, object-page, tables, responsive

**STEP**: 1 — Add CollectionFacet with two ReferenceFacet entries

**DESCRIPTION**: Add a UI.CollectionFacet record to the Object Page annotation target for the relevant entity (or entity set). Inside its Facets collection, add two UI.ReferenceFacet records. Each ReferenceFacet must set PropertyValue Target to the navigation property path that contains a UI.LineItem annotation. Use AnnotationPath with qualifier if needed (e.g., @UI.LineItem#SalesOrderItem). Update the Target attribute of the outer <Annotations> element to match your service namespace and entity or entity set.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Replace ServiceNamespace.EntityType with your actual target -->
<Annotations Target="ServiceNamespace.EntityType">
  <Annotation Term="UI.Facets">
    <Collection>
      <Record Type="UI.CollectionFacet">
        <PropertyValue Property="Label" String="Single Section Multiple Tables" />
        <PropertyValue Property="ID" String="MultiTable" />
        <PropertyValue Property="Facets">
          <Collection>
            <Record Type="UI.ReferenceFacet">
              <PropertyValue Property="Label" String="Sales Order Items" />
              <PropertyValue Property="ID" String="SalesOrderItemsID" />
              <!-- Points to navigation property 'to_Item' and UI.LineItem qualifier 'SalesOrderItem' -->
              <PropertyValue Property="Target" AnnotationPath="to_Item/@UI.LineItem#SalesOrderItem" />
              <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
            </Record>
            <Record Type="UI.ReferenceFacet">
              <PropertyValue Property="Label" String="Contacts" />
              <PropertyValue Property="ID" String="ContactsID" />
              <!-- Points to navigation property 'to_BPAContact' UI.LineItem (no qualifier) -->
              <PropertyValue Property="Target" AnnotationPath="to_BPAContact/@UI.LineItem" />
              <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
            </Record>
          </Collection>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 2 — Ensure the referenced navigation-property UI.LineItem annotations exist

**DESCRIPTION**: Each ReferenceFacet's Target must resolve to a UI.LineItem annotation on the corresponding navigation property. If you use a qualifier (e.g., #SalesOrderItem), declare the UI.LineItem annotation with the same qualifier under the navigation property target.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: declare UI.LineItem on the navigation property 'to_Item' with qualifier SalesOrderItem -->
<Annotations Target="ServiceNamespace.EntityType/to_Item">
  <Annotation Term="UI.LineItem" Qualifier="SalesOrderItem">
    <Collection>
      <!-- Define line item columns here -->
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="ItemNumber" />
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Product" />
      </Record>
      <!-- Add additional UI.DataField or UI.DataFieldForIntentBasedNavigation as needed -->
    </Collection>
  </Annotation>
</Annotations>

<!-- Example: UI.LineItem on 'to_BPAContact' without qualifier -->
<Annotations Target="ServiceNamespace.EntityType/to_BPAContact">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="ContactName" />
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Email" />
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 3 — Responsive layout behavior of the two tables

**DESCRIPTION**: The Object Page adapts table widths depending on the available container/screen size. Use this to verify layout on different breakpoints.

**LANGUAGE**: Text

**CODE**:
```
Responsive behavior (two adjacent tables inside one subsection):
- Extra Large (XL, large desktops): first table ≈ 75%, second table ≈ 25%
- Large (L, desktops): first table ≈ 66.66%, second table ≈ 33.33%
- Medium (M, tablets): first table 50%, second table 50%
- Small (S, mobiles): tables stack vertically (one below the other)
```

**STEP**: 4 — Implementation checklist

**DESCRIPTION**: Quick checklist to validate the setup during development and testing.

**LANGUAGE**: Text

**CODE**:
```
Checklist:
- Place the CollectionFacet annotation under the correct Annotations Target (ServiceNamespace.EntityType).
- Verify each ReferenceFacet.Target points to an existing navigation property annotation path.
- If using #qualifier in AnnotationPath, ensure the UI.LineItem annotation uses the same Qualifier attribute.
- Confirm UI.LineItem collections define the desired table columns (UI.DataField entries).
- Test on multiple screen sizes to confirm responsive distribution (XL/L/M/S).
```
--------------------------------

**TITLE**: Address Facet in Sections (Fiori elements for OData V2)

**INTRODUCTION**: Show an address in an Object Page section or Quick View by adding a UI.ReferenceFacet that points to a Communication.Address annotation. Only the label property of the address annotation is rendered (use \n for line breaks). Applicable to SAP Fiori elements for OData V2 only.

**TAGS**: fiori-elements, odata-v2, annotations, UI.ReferenceFacet, Communication.Address, address, object-page, quick-view, CDS, CAP, ABAP, XML

**STEP**: Applicability and rendering behavior

**DESCRIPTION**: Summary of behavior and formatting requirements. Important constraints: only the label property of the address annotation is used and rendered; other address properties are ignored. Use literal newline escapes (\n) inside the label to create multi-line formatted addresses. This guidance applies only to Fiori elements for OData V2.

**LANGUAGE**: Text

**CODE**:
```Text
- Applicable to: SAP Fiori elements for OData V2 only.
- Rendering: The UI.ReferenceFacet label is shown as the facet title; below it the address annotation's label is rendered only.
- Requirement: The address annotation's label must contain the full formatted address. Use '\n' to indicate new lines.
- Example label value:
  "Mail Drop: TNE QB\n123 Main Street\nAny Town, CA 91921-1234\nU.S.A."
- Note: Other address annotation properties are not interpreted or rendered.
- Example image path (UI preview): images/Address_Facet_8d92094.png
```

**STEP**: Add an address facet as a separate section — XML annotation

**DESCRIPTION**: Add a UI.ReferenceFacet record in your XML annotations to create a separate section that shows the Communication.Address annotation at Target. Replace the AnnotationPath with your entity navigation/annotation path (example uses to_Address/@Communication.Address).

**LANGUAGE**: XML

**CODE**:
```XML
<Record Type="UI.ReferenceFacet">
   <PropertyValue Property="Label" String="Communication Address" />
   <PropertyValue Property="Target" AnnotationPath="to_Address/@Communication.Address" />
</Record>
```

**STEP**: Add an address facet as a separate section — ABAP CDS annotation

**DESCRIPTION**: Define a UI.facet in ABAP CDS to create a separate address section. targetElement should point to the element with the address annotation (example uses _Address).

**LANGUAGE**: ABAP

**CODE**:
```ABAP
@UI.facet: [
 {
  label: 'Communication Address',
  type: #ADDRESS_REFERENCE,
  targetElement: '_Address',
  purpose: #STANDARD
 }
]
```

**STEP**: Add an address facet as a separate section — CAP (service.cds / manifest annotations)

**DESCRIPTION**: Define a UI.ReferenceFacet annotation snippet in CAP-style annotation JSON for the facet that references the Communication.Address annotation path.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
    "$Type": "UI.ReferenceFacet",
    "Label": "Communication Address",
    "Target": "to_Address/@Communication.Address"
}
```

**STEP**: Use address facet inside a FieldGroup (section) and enable Quick View link navigation — XML annotation

**DESCRIPTION**: Include a UI.DataFieldForAnnotation inside a UI.FieldGroup so the address appears as part of a section or in quick view popovers (smart link navigation). Use AnnotationPath to reference the Communication.Address annotation.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotation Term="UI.FieldGroup" Qualifier="GeneralInformation">
   <Record>
      <PropertyValue Property="Data">
         <Collection>
            <Record Type="UI.DataFieldForAnnotation">
               <PropertyValue Property="Label" String="Communication Address" />
               <PropertyValue Property="Target" AnnotationPath="to_Address/@Communication.Address"/>
            </Record>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="Label" String="Product Information"/>
   </Record>
</Annotation>
```

**STEP**: Use address facet inside a FieldGroup — ABAP CDS annotation

**DESCRIPTION**: Define a UI.fieldGroup in ABAP CDS with type #AS_ADDRESS (or appropriate type) and qualifier to include the address in a section and quick view. Ensure the address element or value is exposed (example shows _ADDRESS).

**LANGUAGE**: ABAP

**CODE**:
```ABAP
@UI.fieldGroup: [
  {
    label: 'Communication Address',
    value: '_ADDRESS',
    type: #AS_ADDRESS,
    qualifier: 'GeneralInformation',
    groupLabel: 'Product Information'
  }
]
_ADDRESS;
```

**STEP**: Use address facet inside a FieldGroup — CAP annotation

**DESCRIPTION**: CAP-style UI.FieldGroup annotation defining Data with a UI.DataFieldForAnnotation that targets the Communication.Address annotation path for quick views and sections.

**LANGUAGE**: JSON

**CODE**:
```JSON
UI.FieldGroup #GeneralInformation : {
    Data : [
        {
            "$Type": "UI.DataFieldForAnnotation",
            "Label": "Communication Address",
            "Target": "to_Address/@Communication.Address"
        }
    ],
    "Label": "Product Information"
}
```

**STEP**: Related resources

**DESCRIPTION**: Link to additional documentation about enabling quick views for link navigation (useful to enrich popovers / quick views where address facets are shown).

**LANGUAGE**: Text

**CODE**:
```Text
Enabling Quick Views for Link Navigation:
enabling-quick-views-for-link-navigation-307ced1.md
```
--------------------------------

**TITLE**: Add Address Facet to Object Page Header (UI.ReferenceFacet -> Address)

**INTRODUCTION**: This document shows how to display an address in the Object Page header by adding a UI.ReferenceFacet that points to an address annotation. It contains compact, copy-pasteable examples for XML (CSDL), ABAP CDS and CAP annotations, plus the formatting rules required for the address label.

**TAGS**: fiori-elements-framework, UI.ReferenceFacet, address, object-page, header, annotations, ABAP, CAP, XML, CDS, CSDL

**STEP**: 1 — Behavior and requirements

**DESCRIPTION**: When a UI.ReferenceFacet targets an address annotation the object page header renders:
- The ReferenceFacet label (the facet title) and
- Only the address annotation's label property (not other address fields).
Therefore the address annotation's label must contain the fully formatted address, with \n for new lines. Other address properties are ignored.

Provide the formatted address as a single string with literal newline escapes (\\n). Example formatted label used by the address annotation:

**LANGUAGE**: Plaintext

**CODE**:
```text
Example label property value (single string):
"Mail Drop: TNE QB\n123 Main Street\nAny Town, CA 91921-1234\nU.S.A."
```

**STEP**: 2 — XML (CSDL) annotation — full context and minimal record

**DESCRIPTION**: Place a UI.ReferenceFacet inside the UI.HeaderFacets annotation (CSDL). The ReferenceFacet must set Label (facet title) and Target pointing to the address annotation via AnnotationPath (e.g. @Communication.Address). Below are (A) a full CSDL context example showing HeaderFacets, and (B) the minimal Record snippet.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Full CSDL example: add this to your .xml annotation file (Annotations element) -->
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="UI.HeaderFacets">
    <Collection>
      <!-- Address facet in the object page header -->
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Shipping Address"/>
        <!-- Target must point to the address annotation, using an AnnotationPath -->
        <PropertyValue Property="Target" AnnotationPath="@Communication.Address"/>
      </Record>

      <!-- other header facets... -->
    </Collection>
  </Annotation>
</Annotations>
```

```xml
<!-- Minimal Record snippet (same semantics as shown above) -->
<Record Type="UI.ReferenceFacet">
  <PropertyValue Property="Label" String="Shipping Address"/>
  <PropertyValue Property="Target" AnnotationPath="@Communication.Address"/>
</Record>
```

**STEP**: 3 — ABAP CDS annotation

**DESCRIPTION**: In ABAP CDS, define a UI.facet on the entity and use type #AS_ADDRESS for an address facet. Place this annotation above the entity or projection definition. The UI.facet entry will be rendered as an address facet in the object page header if consumed by Fiori Elements.

**LANGUAGE**: CDS

**CODE**:
```abap
@UI.facet: [
 {
  label: 'Shipping Address',
  type:         #AS_ADDRESS,
  purpose: #STANDARD
 }
]
define root view entity YourNamespace.Product as select from SomeTable {
  key ID,
  ...
};
```

Notes:
- The facet label ('Shipping Address') is shown as the facet title.
- The address annotation referenced by the Target must provide the label string with newline characters embedded.

**STEP**: 4 — CAP / CSDL JSON annotation (example)

**DESCRIPTION**: When adding annotations in CAP/CSDL JSON format (e.g., service annotation file), create a UI.ReferenceFacet object with Label and Target referencing the address annotation path.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "$Type": "UI.ReferenceFacet",
  "Label": "Shipping Address",
  "Target": "@Communication.Address"
}
```

Usage:
- Place this object in the UI.HeaderFacets collection for the corresponding entity in your service CSN/annotations JSON.
- Ensure the referenced Annotation @Communication.Address exists and its Label contains the formatted address string with \n for new lines.

**STEP**: 5 — Example address annotation (label-only)

**DESCRIPTION**: The address annotation itself should expose the formatted address via its label property. Only the label is read for header rendering.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example address annotation (CSDL) with label containing newlines -->
<Annotations Target="YourService.YourEntityType/YourAddressProperty">
  <Annotation Term="Communication.Address">
    <Record Type="Communication.Address">
      <!-- Only the Label is interpreted for the header facet -->
      <PropertyValue Property="Label" String="Mail Drop: TNE QB\n123 Main Street\nAny Town, CA 91921-1234\nU.S.A."/>
      <!-- Other address properties (Street, City...) may be present but are NOT used in the header facet -->
    </Record>
  </Annotation>
</Annotations>
```

Summary:
- Add a UI.ReferenceFacet to UI.HeaderFacets, target the address annotation via AnnotationPath or JSON reference.
- Put the entire formatted address into the address annotation's Label, using \n for line breaks.
- Only the Label is displayed in the object page header; other address fields are ignored.
--------------------------------

**TITLE**: Analytical Cards — Chart configuration and annotations for Fiori Elements / OVP

**INTRODUCTION**: Practical, code-focused examples for configuring analytical cards (header KPI + chart) in SAP Fiori Elements / OVP. Covers responsiveness (max items, sort), chart interactivity (selection passes technical IDs), axis scaling options (ZeroAlwaysVisible, DataScope, FixedScale) and required DataPoint annotations, plus a manifest.json sample for OVP analytical cards.

**TAGS**: fiori-elements-framework, analytical-cards, ui.annotations, charts, ovp, sapui5, manifest.json, cds, abap, cap

STEP: 1 — Chart header behavior and title note
DESCRIPTION: When you configure a chart title on an analytical card, x- and y-axis descriptions are not shown (except for bubble charts). Keep titles meaningful (e.g., "Net Sales by Days Payable") so axis labels are implied by the title.
LANGUAGE: Text
CODE:
```text
Note: Configuring chart title hides axis descriptions (x/y) in analytical cards, except for bubble charts.
```

STEP: 2 — Improve chart responsiveness using UI.PresentationVariant.MaxItems (XML)
DESCRIPTION: Limit the number of records fetched and rendered using UI.PresentationVariant.MaxItems. Use this to improve rendering and selection precision in charts.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.PresentationVariant" Qualifier="Column_Eval_by_Country_123">
  <Record>
    <PropertyValue Property="MaxItems" Int="5" />
  </Record>
</Annotation>
```

STEP: 3 — Improve chart responsiveness using ABAP CDS (example)
DESCRIPTION: ABAP CDS syntax for setting maxItems via @UI.PresentationVariant annotation qualifier.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.PresentationVariant: [
  {
    maxItems: 5,
    qualifier: 'Column_Eval_by_Country_123'
  }
]
annotate view VIEWNAME with { }
```

STEP: 4 — Improve chart responsiveness using CAP CDS (example)
DESCRIPTION: CAP CDS JSON-style annotation for PresentationVariant qualifier with MaxItems.
LANGUAGE: CAP CDS
CODE:
```javascript
UI.PresentationVariant #Column_Eval_by_Country_123 : {
    MaxItems : 5
}
```

STEP: 5 — Tip: Use SortOrder to show top records
DESCRIPTION: If you want only the top N records (e.g., top 5), combine MaxItems with UI.PresentationVariant.SortOrder to fetch and render the highest-ranked records. This improves selection and readability. (See your project’s "Configuring Card Properties" docs for full details.)
LANGUAGE: Text
CODE:
```text
Tip: Use UI.PresentationVariant.SortOrder together with MaxItems to present the top N records (e.g., top 5) in the chart.
```

STEP: 6 — Chart interactivity: what is passed when a data point is selected
DESCRIPTION: When a user selects a data point in the card chart, the system passes the technical key/value(s) of the selected entity (e.g., "RegionID"="001") as URL parameters to the target application — not the display text. Use these technical parameters in the target app to filter or load details.
LANGUAGE: Text
CODE:
```text
Example: Selecting a chart point passes URL parameter like ?RegionID=001 (technical key), not ?Region=EMEA (display name).
```

STEP: 7 — Axis scaling: ZeroAlwaysVisible (XML)
DESCRIPTION: Force the chart axes to always include zero by setting AxisScaling → AutoScaleBehavior → ZeroAlwaysVisible = true in the UI.Chart annotation (XML).
LANGUAGE: XML
CODE:
```xml
<PropertyValue Property="AxisScaling">
  <Record Type="UI.ChartAxisScalingType">
    <PropertyValue Property="AutoScaleBehavior">
      <Record Type="UI.ChartAxisAutoScaleBehaviorType">
        <PropertyValue Property="ZeroAlwaysVisible" Bool="true"/>
      </Record>
    </PropertyValue>
  </Record>
</PropertyValue>
```

STEP: 8 — Axis scaling: ZeroAlwaysVisible (CAP CDS)
DESCRIPTION: CAP CDS equivalent for ZeroAlwaysVisible axis scaling.
LANGUAGE: CAP CDS
CODE:
```javascript
AxisScaling : { 
  $Type : 'UI.ChartAxisScalingType',
  AutoScaleBehavior: { 
    $Type: 'UI.ChartAxisAutoScaleBehaviorType',
    ZeroAlwaysVisible: true
  }
}
```

STEP: 9 — Axis scaling: DataScope / DataSet (XML)
DESCRIPTION: Use DataScope (DataSet) to automatically derive min/max from the entire dataset.
LANGUAGE: XML
CODE:
```xml
<PropertyValue Property="AxisScaling">
  <Record Type="UI.ChartAxisScalingType">
    <PropertyValue Property="AutoScaleBehavior">
      <Record Type="UI.ChartAxisAutoScaleBehaviorType">
        <PropertyValue Property="DataScope" EnumMember="UI.ChartAxisAutoScaleBehaviorType/DataSet"/>
      </Record>
    </PropertyValue>
  </Record>
</PropertyValue>
```

STEP: 10 — Axis scaling: DataScope / DataSet (CAP CDS)
DESCRIPTION: CAP CDS equivalent for DataScope = DataSet.
LANGUAGE: CAP CDS
CODE:
```javascript
AxisScaling : { 
  $Type : 'UI.ChartAxisScalingType',
  AutoScaleBehavior: { 
    $Type: 'UI.ChartAxisAutoScaleBehaviorType',
    DataScope: 'DataSet'
  }
}
```

STEP: 11 — Axis scaling: FixedScale (XML)
DESCRIPTION: Use FixedScale to apply fixed axis range. By default, FixedScale takes values from UI.DataPoint MinimumValue/MaximumValue for the measure(s). Set ScaleBehavior = FixedScale in UI.Chart.
LANGUAGE: XML
CODE:
```xml
<PropertyValue Property="AxisScaling">
  <Record Type="UI.ChartAxisScalingType">
    <PropertyValue Property="ScaleBehavior" EnumMember="UI.ChartAxisScaleBehaviorType/FixedScale"/>
  </Record>
</PropertyValue>
```

STEP: 12 — Axis scaling: FixedScale (CAP CDS)
DESCRIPTION: CAP CDS equivalent setting ScaleBehavior to FixedScale.
LANGUAGE: CAP CDS
CODE:
```javascript
AxisScaling : { 
  $Type : 'UI.ChartAxisScalingType',
  ScaleBehavior: #FixedScale
}
```

STEP: 13 — Define DataPoint minimum and maximum values (XML)
DESCRIPTION: When using FixedScale, define UI.DataPoint with MinimumValue and MaximumValue so the chart uses those fixed bounds. Qualify the annotation if needed.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="DataPoint_Qualifier">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="MinimumValue" Decimal="1" />
    <PropertyValue Property="MaximumValue" Decimal="5" />
    <PropertyValue Property="ValueFormat">
      <Record>
        <!-- number / value format details -->
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 14 — Define DataPoint minimum and maximum values (ABAP CDS)
DESCRIPTION: ABAP CDS syntax example for defining minimum and maximum on a measure via @UI.dataPoint.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: { 
  minimumValue: 1,
  maximumValue: 5,
  valueFormat: { }
}
property_name;
```

STEP: 15 — Define DataPoint minimum and maximum values (CAP CDS)
DESCRIPTION: CAP CDS annotated DataPoint definition (qualifier) with MinimumValue and MaximumValue.
LANGUAGE: CAP CDS
CODE:
```javascript
UI.DataPoint #DataPointQualifier : {
  $Type : 'UI.DataPointType',
  MinimumValue : 1,
  MaximumValue : 5,
  NumberFormat : { }
}
```

STEP: 16 — Manifest.json sample for OVP analytical cards (OData V2)
DESCRIPTION: Full manifest.json snippet showing dataSources and card definitions for analytical templates. For OData V4 use template "sap.ovp.cards.v4.charts.analytical" (all other settings remain the same).
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "_version": "1.1.0",
    "id": "sap.ovp.demo",
    "type": "application",
    "i18n": "i18n/i18n.properties",
    "applicationVersion": {
      "version": "1.2.2"
    },
    "title": "{{app_title}}",
    "description": "{{app_description}}",
    "dataSources": {
      "salesShare": {
        "uri": "https://abc.com/SalesShare.xsodata",
        "type": "OData",
        "settings": {
          "odataVersion": "2.0",
          "annotations": [
            "salesShareAnno"
          ]
        }
      },
      "salesShareAnno": {
        "uri": "data/salesshare/annotations.xml",
        "type": "ODataAnnotation",
        "settings": {}
      }
    }
  },
  "sap.ovp": {
    "globalFilterModel": "salesShare",
    "globalFilterEntityType": "GlobalFilters",
    "globalFilterEntitySet": "GlobalFilters",
    "cards": {
      "cardBubble": {
        "model": "salesShare",
        "template": "sap.ovp.cards.charts.analytical",
        "settings": {
          "entitySet": "SalesShare",
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Eval_by_CtryCurr",
          "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#Eval_by_CtryCurr",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#Eval_by_CtryCurr",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#Eval_by_CtryCurr",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#Eval_by_CtryCurr"
        }
      },
      "cardchartsline": {
        "model": "salesShare",
        "template": "sap.ovp.cards.charts.analytical",
        "settings": {
          "entitySet": "SalesShare",
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Eval_by_Country",
          "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#Eval_by_Country",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#Eval_by_Country",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#Eval_by_Country",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#Eval_by_Country"
        }
      },
      "cardchartsdonut": {
        "model": "salesShare",
        "template": "sap.ovp.cards.charts.analytical",
        "settings": {
          "entitySet": "SalesShare",
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Eval_by_Currency",
          "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#Eval_by_Currency",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#Eval_by_Currency",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#Eval_by_Currency",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#Eval_by_Currency"
        }
      }
    }
  }
}
```

STEP: 17 — Manifest note for OData V4
DESCRIPTION: For SAP Fiori elements with OData V4, set the template to sap.ovp.cards.v4.charts.analytical. All manifest settings otherwise remain the same as V2.
LANGUAGE: Text
CODE:
```text
Note: For OData V4 use template "sap.ovp.cards.v4.charts.analytical" in the manifest. Other settings are identical to the V2 manifest entries above.
```

Related Information: See "Configuring Charts" in project docs for advanced chart configuration and mapping of UI.Chart properties.
--------------------------------

**TITLE**: Analytical List Page (ALP) — Manifest and Annotation Configuration Examples

**INTRODUCTION**: Practical, ready-to-use configuration snippets and annotation examples to implement an Analytical List Page (ALP) in a SAP Fiori Elements application. Includes manifest.json entries, visual filter bar settings, KPI/title-area configuration, chart and table annotations (UI.Chart and UI.LineItem), and a minimal extension hook. Use these as direct copy-paste starting points and adapt entity names, annotation paths, and presentationVariant IDs to your service.

**TAGS**: analytical-list-page, ALP, manifest.json, annotations, visual-filter-bar, KPI, UI.Chart, UI.LineItem, ODataV4, fiori-elements

STEP: 1 — Add an ALP page entry to manifest.json

DESCRIPTION: Add a new page object under the top-level application configuration to register an Analytical List Page. Replace entitySet, presentationVariant, and IDs with your application-specific names. This snippet assumes Fiori Elements OData V4 and a template component named "sap.fe.templates.AnalyticalListPage" — if your project uses a different runtime/template, adapt the component name accordingly.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "defaultBindingMode": "TwoWay"
        }
      }
    }
  },
  "sap.ui": {
    "technology": "UI5"
  },
  "sap.app": {
    "id": "com.example.alp"
  },
  "sap.fe": {
    "templates": {
      "AnalyticalListPage": {}
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "name": "sap.fe.templates.AnalyticalListPage",
          "settings": {
            "chart": {
              "presentationVariant": "PV_SalesOrder_Chart"
            },
            "defaultLayoutType": "ChartAndTable", 
            "visualFilterBar": {
              "visible": true
            },
            "kpiCards": {
              "visible": true
            }
          }
        }
      }
    ]
  }
}
```

STEP: 2 — Enable and configure the Visual Filter Bar (manifest)

DESCRIPTION: Turn on the visual filter bar and specify the annotation path(s) for the visual filters if needed. Use the annotation path(s) that point to the VisualFilter annotations in your annotation file (annotations.xml). The example shows enabling visual filters and connecting to a presentationVariant and a visualFilter annotation record.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "name": "sap.fe.templates.AnalyticalListPage",
          "settings": {
            "visualFilterBar": {
              "visible": true,
              "annotationPath": "@com.sap.vocabularies.UI.v1.LineItem" 
            },
            "chart": {
              "presentationVariant": "PV_SalesOrder_Chart"
            }
          }
        }
      }
    ]
  }
}
```

STEP: 3 — Define UI.Chart annotation (OData V4 annotations XML)

DESCRIPTION: Provide a UI.Chart annotation that points to dimensions and measures to render the chart area. Attach this to the EntityType that backs the SalesOrderSet. Replace Target values, Measure/Dimension paths, and titles with your metadata names.

LANGUAGE: XML

CODE:
```xml
<!-- file: annotations/annotations.xml -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:DataServices>
    <Schema xmlns="http://docs.oasis-open.org/odata/ns/edm" Namespace="MyService">
      <Annotations Target="MyService.SalesOrderType">
        <Annotation Term="UI.Chart">
          <Record>
            <PropertyValue Property="Title" String="Sales by Country"/>
            <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
            <PropertyValue Property="Measures">
              <Collection>
                <PropertyPath>NetAmount</PropertyPath>
              </Collection>
            </PropertyValue>
            <PropertyValue Property="Dimensions">
              <Collection>
                <PropertyPath>Country</PropertyPath>
              </Collection>
            </PropertyValue>
          </Record>
        </Annotation>
      </Annotations>

      <!-- PresentationVariant referenced from manifest (PV_SalesOrder_Chart) -->
      <Annotations Target="MyService.SalesOrderType">
        <Annotation Term="UI.PresentationVariant" Qualifier="PV_SalesOrder_Chart">
          <Record>
            <PropertyValue Property="Visualizations">
              <Collection>
                <Annotation Path="UI.Chart"/>
              </Collection>
            </PropertyValue>
            <PropertyValue Property="SortOrder">
              <Collection>
                <Record>
                  <PropertyValue Property="Property" PropertyPath="NetAmount"/>
                  <PropertyValue Property="Descending" Bool="true"/>
                </Record>
              </Collection>
            </PropertyValue>
          </Record>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

STEP: 4 — Define UI.LineItem annotation for the table area (OData V4 annotations XML)

DESCRIPTION: Provide a UI.LineItem annotation for the same EntityType to specify the table columns. The ALP will use this to render the table area. Adjust PropertyPath values and labels as needed.

LANGUAGE: XML

CODE:
```xml
<!-- file: annotations/annotations.xml (append) -->
<edmx:DataServices>
  <Schema xmlns="http://docs.oasis-open.org/odata/ns/edm" Namespace="MyService">
    <Annotations Target="MyService.SalesOrderType">
      <Annotation Term="UI.LineItem">
        <Collection>
          <Record Type="UI.DataField">
            <PropertyValue Property="Label" String="Order ID"/>
            <PropertyValue Property="Value">
              <Path>SalesOrderID</Path>
            </PropertyValue>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Label" String="Customer"/>
            <PropertyValue Property="Value">
              <Path>CustomerName</Path>
            </PropertyValue>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Label" String="Net Amount"/>
            <PropertyValue Property="Value">
              <Path>NetAmount</Path>
            </PropertyValue>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Label" String="Currency"/>
            <PropertyValue Property="Value">
              <Path>CurrencyCode</Path>
            </PropertyValue>
          </Record>
        </Collection>
      </Annotation>
    </Annotations>
  </Schema>
</edmx:DataServices>
```

STEP: 5 — Configure KPI tags in the title area (manifest + annotation)

DESCRIPTION: Expose KPI cards / tags at the header/title area by pointing a KPI annotation or kpiCards configuration from the manifest to annotation records. The example shows manifest entry and a sample KPI annotation record (OData V4).

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "name": "sap.fe.templates.AnalyticalListPage",
          "settings": {
            "kpiCards": {
              "annotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo" 
            }
          }
        }
      }
    ]
  }
}
```

LANGUAGE: XML

CODE:
```xml
<!-- file: annotations/annotations.xml (KPI example) -->
<edmx:DataServices>
  <Schema xmlns="http://docs.oasis-open.org/odata/ns/edm" Namespace="MyService">
    <Annotations Target="MyService.SalesOrderType">
      <Annotation Term="UI.HeaderInfo">
        <Record>
          <PropertyValue Property="TypeName" String="Sales Overview"/>
          <PropertyValue Property="Title">
            <String>Sales Overview</String>
          </PropertyValue>
          <PropertyValue Property="Description">
            <String>KPIs for sales performance</String>
          </PropertyValue>
          <PropertyValue Property="Chart">
            <Path>NetAmount</Path>
          </PropertyValue>
        </Record>
      </Annotation>
    </Annotations>
  </Schema>
</edmx:DataServices>
```

STEP: 6 — Add a small extension hook (optional)

DESCRIPTION: If you need a controller or fragment extension (custom actions, custom filter behavior, or custom KPI card navigation), add an extension fragment and reference it from manifest under the page component settings. The example demonstrates a fragment path and the corresponding manifest entry.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "name": "sap.fe.templates.AnalyticalListPage",
          "settings": {
            "extensions": {
              "Header": {
                "fragmentName": "com.example.alp.ext.HeaderExtension"
              }
            }
          }
        }
      }
    ]
  }
}
```

LANGUAGE: XML

CODE:
```xml
<!-- file: webapp/ext/HeaderExtension.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
  <HBox class="sapUiSmallMargin">
    <Button text="Custom Action" press=".onCustomAction"/>
  </HBox>
</core:FragmentDefinition>
```

STEP: 7 — File layout and recommended file paths

DESCRIPTION: Use the following file layout to organize your ALP artifacts. Update your project to include these files at the specified paths.

LANGUAGE: JSON

CODE:
```json
{
  "recommendedFiles": [
    "webapp/manifest.json",
    "webapp/annotations/annotations.xml",
    "webapp/ext/HeaderExtension.fragment.xml",
    "webapp/extension/ControllerExtension.controller.js"
  ]
}
```

Notes and quick checklist
- Ensure annotation Targets match your service metadata EntityType names (e.g., MyService.SalesOrderType).
- presentationVariant Qualifier names (e.g., PV_SalesOrder_Chart) must match the manifest presentationVariant value.
- Visual filters require corresponding VisualFilter annotations in annotations.xml; enable visualFilterBar in the manifest component settings.
- For navigation from chart/table/KPI cards, implement semantic object and navigation targets via Link and NavigationProperty annotations or configure navigation in the manifest routing targets.

Use these snippets as drop-in examples and adapt entity names, property paths, and qualifiers to your data model.
--------------------------------

**TITLE**: Overview Page Annotations Reference (Fiori Elements)

**INTRODUCTION**: Concise reference of annotation record types used in Fiori Elements Overview Pages. Use these actionable examples when generating annotation files (XML), ABAP CDS annotations, or CAP CDS annotations. Each entry lists supported properties and provides copy-paste-ready samples.

**TAGS**: fiori-elements-framework, annotations, overview-page, UI.v1, CDS, CAP, ABAP, XML, OData

**STEP**: HeaderInfo — XML example
**DESCRIPTION**: Use com.sap.vocabularies.UI.v1.HeaderInfo to define card header metadata (type names, title, description, image). Properties: TypeName, TypeNamePlural, ImageUrl, Title, Description. Note: dynamicSubtitleAnnotationPath may be derived from manifest.json path. (See manifest configuration for overview page.)
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo" Qualifier="dynamicSubtitle">
  <Record>
    <PropertyValue Property="TypeName" String="Product"/>
    <PropertyValue Property="TypeNamePlural" String="Products"/>
    <PropertyValue Property="Title">
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Value" Path="Name"/>
      </Record>
    </PropertyValue>
    <PropertyValue Property="Description">
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Value" Path="Description"/>
      </Record>
    </PropertyValue>
    <PropertyValue Property="ImageUrl" Path="ProductPicUrl"/>
  </Record>
</Annotation>
```

**STEP**: HeaderInfo — ABAP CDS and CAP examples
**DESCRIPTION**: Equivalent header info definitions for ABAP CDS and CAP CDS.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@UI.headerInfo: {
  typeName: 'Product',
  typeNamePlural: 'Products',
  title: {
    value: 'NAME',
    type: #STANDARD
  },
  description: {
    value: 'DESCRIPTION',
    type: #STANDARD
  },
  imageUrl: 'PRODUCTPICURL'
}
annotate view VIEWNAME with { }
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.HeaderInfo #dynamicSubtitle : {
  TypeName : 'Product',
  TypeNamePlural : 'Products',
  Title : {
    $Type : 'UI.DataField',
    Value : Name
  },
  Description : {
    $Type : 'UI.DataField',
    Value : Description
  },
  ImageUrl : ProductPicUrl
}
```

**STEP**: DataField — XML example
**DESCRIPTION**: Use UI.DataField to display simple text fields. Supported properties: Label, Value (Path).
**LANGUAGE**: XML
**CODE**:
```xml
<Record Type="com.sap.vocabularies.UI.v1.DataField">
  <PropertyValue Property="Label" String="Total Sum"/>
  <PropertyValue Property="Value" Path="TotalSum"/>
</Record>
```

**STEP**: DataField — ABAP CDS and CAP examples
**DESCRIPTION**: Equivalent UI.DataField definitions for ABAP CDS and CAP CDS.
**LANGUAGE**: ABAP CDS
**CODE**:
```
{ label: 'Total Sum' }
  TOTALSUM;
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
{
  $Type : 'UI.DataField',
  Label : 'Total Sum',
  Value : TotalSum
}
```

**STEP**: DataFieldForAnnotation — XML example
**DESCRIPTION**: Use UI.DataFieldForAnnotation to reference another annotation via Target (AnnotationPath). Supported properties: Label, Target.
**LANGUAGE**: XML
**CODE**:
```xml
<Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation" Qualifier="WeightMeasure">
  <PropertyValue Property="Label" String="Weight Measure"/>
  <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.DataPoint#WeightMeasure"/>
</Record>
```

**STEP**: DataFieldForAnnotation — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS and CAP equivalents (use valueQualifier / Target).
**LANGUAGE**: ABAP CDS
**CODE**:
```
{
  label: 'Weight Measure',
  valueQualifier: 'WeightMeasure',
  type: #AS_DATAPOINT
}
Weight;
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
{
  $Type : 'UI.DataFieldForAnnotation',
  Label : 'Weight Measure',
  Target : '@UI.DataPoint#WeightMeasure'
}
```

**STEP**: DataFieldForAction — XML example
**DESCRIPTION**: Use UI.DataFieldForAction to add OData FunctionImport actions on an entity. Supported properties: Label, Action. Importance can be set with UI.Importance.
**LANGUAGE**: XML
**CODE**:
```xml
<Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
  <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/Medium" />
  <PropertyValue Property="Label" String="Confirm" />
  <PropertyValue Property="Action" String="GWSAMPLE_BASIC.GWSAMPLE_BASIC_Entities/SalesOrder_Confirm" />
</Record>
```

**STEP**: DataFieldForAction — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS and CAP equivalents (use dataAction/Action).
**LANGUAGE**: ABAP CDS
**CODE**:
```
{
  importance: #MEDIUM,
  label: 'Confirm',
  dataAction: 'GWSAMPLE_BASIC.GWSAMPLE_BASIC_Entities/SalesOrder_Confirm',
  type: #FOR_ACTION
}
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
{
  $Type : 'UI.DataFieldForAction',
  Label : 'Confirm',
  Action : 'GWSAMPLE_BASIC.GWSAMPLE_BASIC_Entities/SalesOrder_Confirm',
  ![@UI.Importance] : #Medium
}
```

**STEP**: DataFieldForIntentBasedNavigation — XML example
**DESCRIPTION**: Use UI.DataFieldForIntentBasedNavigation to configure intent-based navigation (SemanticObject, Action, Label). Supports UI.Importance.
**LANGUAGE**: XML
**CODE**:
```xml
<Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
  <PropertyValue Property="SemanticObject" String="SemanticObject1"/>
  <PropertyValue Property="Action" String="Action1"/>
  <PropertyValue Property="Label" String="App1"/>
  <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/Medium"/>
</Record>
```

**STEP**: DataFieldForIntentBasedNavigation — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS and CAP equivalents using semanticObject/action mapping.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@Consumption.semanticObject: 'SemanticObject1'
annotate view VIEWNAME with {
  @UI.lineItem: [
    {
      importance: #MEDIUM,
      semanticObjectAction: 'Action1',
      label: 'App1',
      type: #FOR_INTENT_BASED_NAVIGATION
    }
  ]
  property_name;
}
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
{
  $Type : 'UI.DataFieldForIntentBasedNavigation',
  SemanticObject : 'SemanticObject1',
  Action : 'Action1',
  Label : 'App1',
  ![@UI.Importance] : #Medium
}
```

**STEP**: DataFieldWithUrl — XML example
**DESCRIPTION**: Use UI.DataFieldWithUrl to create external links or intent-based navigation with URL templates. Supported properties: Url (can use odata.fillUriTemplate / odata.uriEncode), Label, Value.
**LANGUAGE**: XML
**CODE**:
```xml
<Record Type="com.sap.vocabularies.UI.v1.DataFieldWithUrl">
  <PropertyValue Property="Label" String="Link to"/>
  <PropertyValue Property="Value" String="Google Maps"/>
  <PropertyValue Property="Url">
    <Apply Function="odata.fillUriTemplate">
      <String>https://www.google.de/maps/place/{street},{city}</String>
      <LabeledElement Name="street">
        <Apply Function="odata.uriEncode">
          <Path>Address/Street</Path>
        </Apply>
      </LabeledElement>
      <LabeledElement Name="city">
        <Apply Function="odata.uriEncode">
          <Path>Address/City</Path>
        </Apply>
      </LabeledElement>
    </Apply>
  </PropertyValue>
</Record>
```

**STEP**: DataFieldWithUrl — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS and CAP equivalents (type #WITH_URL / $edmJson filled template).
**LANGUAGE**: ABAP CDS
**CODE**:
```
{
  label: 'Link to',
  type: #WITH_URL
}
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
{
  $Type : 'UI.DataFieldWithUrl',
  Value : 'Google Maps',
  Label : 'Link to',
  Url   : {
    $edmJson : {
      $Apply: [
        'https://www.google.de/maps/place/{street},{city}',
        {
          $LabeledElement : {
            $Apply    : [{$Path : 'Address/Street'}],
            $Function : 'odata.uriEncode'
          },
          $Name : 'street'
        },
        {
          $LabeledElement : {
            $Apply    : [{$Path : 'Address/City'}],
            $Function : 'odata.uriEncode'
          },
          $Name : 'city'
        }
      ],
      $Function : 'odata.fillUriTemplate'
    }
  }
}
```

**STEP**: DataPoint — XML example
**DESCRIPTION**: Use UI.DataPoint to show formatted numeric or KPI values with criticality and trend. Supported properties: Title, Value, ValueFormat/NumberFormat (ScaleFactor, NumberOfFractionalDigits), Criticality (enum), CriticalityCalculation (ImprovementDirection + ranges), TargetValue, TrendCalculation (ReferenceValue, DownDifference).
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Country">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Sales India - Line Card" />
    <PropertyValue Property="Value" Path="Sales" />
    <PropertyValue Property="NumberValueFormat">
      <Record>
        <PropertyValue Property="ScaleFactor" IntDecimal="0" />
        <PropertyValue Property="NumberOfFractionalDigits" Int="3" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="CriticalityCalculation">
      <Record>
        <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Minimizinge" />
        <PropertyValue Property="DeviationRangeHighValue" String="7300" />
        <PropertyValue Property="ToleranceRangeHighValue" String="7200" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="TargetValue" String="2.000 " />
    <PropertyValue Property="TrendCalculation">
      <Record>
        <PropertyValue Property="ReferenceValue" String="5201680" />
        <PropertyValue Property="DownDifference" IntDecimal="10000000.0" />
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: DataPoint — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS and CAP equivalents for DataPoint configuration.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@UI.dataPoint: { 
  title: 'Sales India - Line Card',
  valueFormat: { scaleFactor: 0, numberOfFractionalDigits: 3 },
  criticalityCalculation: { 
    improvementDirection: #MINIMIZE,
    deviationRangeHighValue: 7300,
    toleranceRangeHighValue: 7200
  },
  targetValue: 2.000,
  trendCalculation: { referenceValue: 'refValElement', downDifference: 10000000.0 }
}
Sales;
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.DataPoint #Eval_by_Country : {
  $Type : 'UI.DataPointType',
  Title : 'Sales India - Line Card',
  Value : Sales,
  NumberFormat : {
    ScaleFactor : 0,
    NumberOfFractionalDigits : 3
  },
  CriticalityCalculation : {
    ImprovementDirection : #Minimizing,
    DeviationRangeHighValue : '7300',
    ToleranceRangeHighValue : '7200'
  },
  TargetValue : '2.000 ',
  TrendCalculation : {
    ReferenceValue : '5201680',
    DownDifference : 10000000.0
  }
}
```

**STEP**: Identification — XML example
**DESCRIPTION**: Use UI.Identification as a container for card actions and key fields. Supported record types: DataFieldForAction, DataFieldForIntentBasedNavigation, DataFieldWithUrl, DataField.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.Identification">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="SemanticObject" String="Action"/>
      <PropertyValue Property="Action" String="toappnavsample"/>
      <PropertyValue Property="Label" String="SO Navigation (M)"/>
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/Medium"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Sales Order ID"/>
      <PropertyValue Property="Value" Path="SalesOrderID"/>
    </Record>
  </Collection>
</Annotation>
```

**STEP**: Identification — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS and CAP equivalents to declare identification fields and intent-based navigation.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@UI.identification: [
  {
    importance: #MEDIUM,
    semanticObjectAction: 'toappnavsample',
    label: 'SO Navigation (M)',
    type: #FOR_INTENT_BASED_NAVIGATION,
    position: 10
  }
]
PROPERT_NAME;

@UI.identification: [
  {
    label: 'Sales Order ID',
    position: 20
  }
]
SALESORDERID;

@Consumption.semanticObject: 'Action'
annotate view VIEWNAME with { }
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.Identification : [
  {
    $Type : 'UI.DataFieldForIntentBasedNavigation',
    SemanticObject : 'Action',
    Action : 'toappnavsample',
    Label : 'SO Navigation (M)',
    ![@UI.Importance] : #Medium
  },
  {
    $Type : 'UI.DataField',
    Label : 'Sales Order ID',
    Value : SalesOrderID
  }
]
```

**STEP**: LineItem — XML example
**DESCRIPTION**: Use UI.LineItem to define list/table columns. Supported record types: DataField, DataFieldForAnnotation, DataFieldForIntentBasedNavigation, DataFieldWithUrl.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Sales Order ID"/>
      <PropertyValue Property="Value" Path="SalesOrderID"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Customer Name"/>
      <PropertyValue Property="Value" Path="CustomerName"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation" Qualifier="TotalSum">
      <PropertyValue Property="Label" String="Total Sum"/>
      <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.DataPoint#TotalSum"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="SemanticObject" String="Action"/>
      <PropertyValue Property="Action" String="toappnavsample2"/>
      <PropertyValue Property="Label" String="SO Navigation (M)"/>
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/Medium"/>
    </Record>
  </Collection>
</Annotation>
```

**STEP**: LineItem — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS and CAP equivalents demonstrating DataPoint references and intent navigation in line items.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@UI.lineItem: [
  { label: 'Sales Order ID', position: 10 }
] SALESORDERID;

@UI.lineItem: [
  { label: 'Customer Name', position: 20 }
] CUSTOMERNAME;

@UI.lineItem: [
  { label: 'Total Sum', valueQualifier: 'TotalSum', type: #AS_DATAPOINT, position: 50 },
  { importance: #MEDIUM, semanticObjectAction: 'toappnavsample2', label: 'SO Navigation (M)', type: #FOR_INTENT_BASED_NAVIGATION, position: 80 }
] PROPERT_NAME;

@Consumption.semanticObject: 'Action'
annotate view VIEWNAME with { }
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.LineItem : [
  { $Type : 'UI.DataField', Label : 'Sales Order ID', Value : SalesOrderID },
  { $Type : 'UI.DataField', Label : 'Customer Name', Value : CustomerName },
  { $Type : 'UI.DataFieldForAnnotation', Label : 'Total Sum', Target : '@UI.DataPoint#TotalSum' },
  { $Type : 'UI.DataFieldForIntentBasedNavigation', SemanticObject : 'Action', Action : 'toappnavsample2', Label : 'SO Navigation (M)', ![@UI.Importance] : #Medium }
]
```

**STEP**: Facets / ReferenceFacet — XML example
**DESCRIPTION**: Use UI.Facets as a collection of ReferenceFacet entries. Overview pages support only ReferenceFacet record type. Use IsSummary annotation to mark summary facets.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.Facets">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.ReferenceFacet">
      <Annotation Term="com.sap.vocabularies.UI.v1.IsSummary"/>
      <PropertyValue Property="Label" String="Amounts"/>
      <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.FieldGroup#Amounts"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.ReferenceFacet">
      <Annotation Term="com.sap.vocabularies.UI.v1.IsSummary"/>
      <PropertyValue Property="Label" String="Note1"/>
      <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.FieldGroup#Status"/>
    </Record>
  </Collection>
</Annotation>
```

**STEP**: Facets — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS declares UI.Facet / isSummary and target qualifiers; CAP uses UI.ReferenceFacet with Target to UI.FieldGroup#Qualifier.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@UI.Facet: [
  { isSummary: true, label: 'Amounts', targetQualifier: 'Amounts', type: #FIELDGROUP_REFERENCE, purpose: #STANDARD },
  { isSummary: true, label: 'Note1', targetQualifier: 'Status', type: #FIELDGROUP_REFERENCE, purpose: #STANDARD }
]
PROPERT_NAME;
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.Facets : [
  { $Type : 'UI.ReferenceFacet', Label : 'Amounts', Target : '@UI.FieldGroup#Amounts', ![@UI.IsSummary] },
  { $Type : 'UI.ReferenceFacet', Label : 'Note1', Target : '@UI.FieldGroup#Status', ![@UI.IsSummary] }
]
```

**STEP**: FieldGroup — XML example
**DESCRIPTION**: Use UI.FieldGroup to group DataField entries. Contains Label and Data collection of DataField records. Qualifier identifies the field group.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup" Qualifier="Amounts">
  <Record Type="com.sap.vocabularies.UI.v1.FieldGroupType">
    <PropertyValue Property="Label" String="Amounts"/>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.DataField">
          <PropertyValue Property="Label" String="Total Sum"/>
          <PropertyValue Property="Value" Path="TotalSum"/>
        </Record>
        <Record Type="com.sap.vocabularies.UI.v1.DataField">
          <PropertyValue Property="Label" String="Net Sum"/>
          <PropertyValue Property="Value" Path="NetSum"/>
        </Record>
        <Record Type="com.sap.vocabularies.UI.v1.DataField">
          <PropertyValue Property="Label" String="Tax"/>
          <PropertyValue Property="Value" Path="Tax"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: FieldGroup — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS uses @UI.fieldGroup qualifiers on properties; CAP defines UI.FieldGroup with Data array.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@UI.fieldGroup: [{ label: 'Total Sum', position: 10, qualifier: 'Amounts', groupLabel: 'Amounts' }]
TOTALSUM;

@UI.fieldGroup: [{ label: 'Net Sum', position: 20, qualifier: 'Amounts' }]
NETSUM;

@UI.fieldGroup: [{ label: 'Tax', position: 30, qualifier: 'Amounts' }]
TAX;
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.FieldGroup #Amounts : {
  $Type : 'UI.FieldGroupType',
  Label : 'Amounts',
  Data : [
    { $Type : 'UI.DataField', Label : 'Total Sum', Value : TotalSum },
    { $Type : 'UI.DataField', Label : 'Net Sum', Value : NetSum },
    { $Type : 'UI.DataField', Label : 'Tax', Value : Tax }
  ]
}
```

**STEP**: SelectionVariant — XML example
**DESCRIPTION**: Use UI.SelectionVariant to define parameter sets and filters (SelectOptions and Parameters). Properties: ID, Text, Parameters, SelectOptions.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant">
  <Record>
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record>
          <PropertyValue Property="PropertyName" PropertyPath="TotalSum" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record>
                <PropertyValue Property="Sign" EnumMember="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I" />
                <PropertyValue Property="Option" EnumMember="com.sap.vocabularies.UI.v1.SelectionRangeOptionType/BT" />
                <PropertyValue Property="Low" String="0" />
                <PropertyValue Property="High" String="8000" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: SelectionVariant — CAP example
**DESCRIPTION**: CAP CDS representation of selection filters.
**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.SelectionVariant : {
  SelectOptions : [
    {
      PropertyName : TotalSum,
      Ranges : [
        { Sign : #I, Option : #BT, Low : '0', High : '8000' }
      ]
    }
  ]
}
```

**STEP**: PresentationVariant — XML example
**DESCRIPTION**: Use UI.PresentationVariant to control display (GroupBy, SortOrder, RequestAtLeast, Visualizations). Can be used standalone or with SelectionPresentationVariant. Use RequestAtLeast to request extra dimensions (be careful with aggregated services).
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant">
  <Record>
    <PropertyValue Property="GroupBy">
      <Collection>
        <PropertyPath>Status</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record>
          <PropertyValue Property="Property" PropertyPath="TotalSum" />
          <PropertyValue Property="Descending" Bool="true" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="RequestAtLeast">
      <Collection>
        <Record><PropertyPath>CustomerID</PropertyPath></Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: PresentationVariant — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS and CAP representations with groupBy, sortOrder, requestAtLeast and visualizations.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@UI.PresentationVariant: [
  {
    groupBy: ['STATUS'],
    sortOrder: [{ by: 'TOTALSUM', direction: #DESC }],
    requestAtLeast: ['CustomerID']
  }
]
annotate view VIEWNAME with { }
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.PresentationVariant : {
  GroupBy : [ Status ],
  SortOrder : [ { Property : TotalSum, Descending : true } ],
  RequestAtLeast : [ { CustomerID } ]
}
```

**STEP**: SelectionPresentationVariant — XML example
**DESCRIPTION**: Combine SelectionVariant and PresentationVariant by referencing their annotation paths. Properties: SelectionVariant (Path), PresentationVariant (Path).
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.SelectionPresentationVariant" Qualifier="BothSelectionAndPresentation">
  <Record>
    <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#SP2"/>
    <PropertyValue Property="PresentationVariant" Path="@UI.PresentationVariant#customer"/>
  </Record>
</Annotation>
```

**STEP**: SelectionPresentationVariant — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS uses qualifiers; CAP references UI.SelectionVariant#qualifier and UI.PresentationVariant#qualifier.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@UI.SelectionPresentationVariant: [
  {
    selectionvariantqualifier: 'SP2',
    presentationvariantqualifier: 'customer',
    qualifier: 'BothSelectionAndPresentation'
  }
]
annotate view VIEWNAME with { }
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.SelectionPresentationVariant #BothSelectionAndPresentation : {
  SelectionVariant : ![@UI.SelectionVariant#SP2],
  PresentationVariant : ![@UI.PresentationVariant#customer]
}
```

**STEP**: Chart — XML example
**DESCRIPTION**: Use UI.Chart to define chart dimensions/measures and attributes. Supported properties: Title, Description, ChartType, Measures, MeasureAttributes, Dimensions, DimensionAttributes. Ensure measures/dimensions used in attributes also exist in Measures/Dimensions lists.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.Chart">
  <Record Type="com.sap.vocabularies.UI.v1.ChartDefinitionType">
    <PropertyValue Property="Title" String="View1" />
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="TotalSum" />
          <PropertyValue Property="Role" EnumMember="com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis1" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="Status" />
          <PropertyValue Property="Role" EnumMember="com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Series" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: Chart — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS declares UI.Chart with measureAttributes/dimensionAttributes; CAP defines UI.ChartDefinitionType object.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@UI.Chart: [
  {
    title: 'View1',
    measureAttributes: [{ measure: 'TotalSum', role: #AXIS_1 }],
    dimensionAttributes: [{ dimension: 'Status', role: #SERIES }]
  }
]
annotate view VIEWNAME with { }
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.Chart : {
  $Type : 'UI.ChartDefinitionType',
  Title : 'View1',
  MeasureAttributes : [
    { $Type : 'UI.ChartMeasureAttributeType', Measure : TotalSum, Role : #Axis1 }
  ],
  DimensionAttributes : [
    { $Type : 'UI.ChartDimensionAttributeType', Dimension : Status, Role : #Series }
  ]
}
```

**STEP**: KPI — XML example
**DESCRIPTION**: Use UI.KPI to create KPI tags for overview page cards. Combines DataPoint, SelectionVariant, PresentationVariant and supports Detail with semantic object/action for navigation.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.KPI" Qualifier="Eval_by_Country_-Generic">
  <Record>
    <PropertyValue Property="DataPoint" Path="@UI.DataPoint#Eval_by_Country_-Generic" />
    <PropertyValue Property="Detail">
      <Record Type="UI.KPIDetailType">
        <PropertyValue Property="DefaultPresentationVariant" Path="@UI.PresentationVariant#Eval_by_Currency1" />
        <PropertyValue Property="AlternativePresentationVariants">
          <Collection>
            <Path>@UI.PresentationVariant#Eval_by_Currency_Column</Path>
          </Collection>
        </PropertyValue>
        <PropertyValue Property="SemanticObject" String="Action" />
        <PropertyValue Property="Action" String="toappnavsample" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="ID" String="String for KPI Annotation" />
    <PropertyValue Property="SelectionVariantQualifier" Path="@UI.SelectionVariant#Eval_by_Currency_1" />
  </Record>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Country_-Generic">
  <Record>
    <PropertyValue Property="Value" Path="Currency" />
    <PropertyValue Property="Title" String="test" />
  </Record>
</Annotation>
```

**STEP**: KPI — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS and CAP representations of KPI with DataPoint and Detail settings.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@UI.KPI: [
  {
    detail: {
      defaultPresentationVariantQualifier: 'Eval_by_Currency1',
      alternativePresentationVariantQualifiers: ['Eval_by_Currency_Column'],
      semanticObject: 'Action',
      semanticObjectAction: 'toappnavsample'
    },
    selectionVariantQualifier: 'Eval_by_Currency_1',
    id: 'String for KPI Annotation',
    qualifier: 'Eval_by_Country-Generic',
    dataPoint.title: 'test'
  }
]
Eval_by_Country-Generic;
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.KPI #AllActualCosts : {
  $Type : 'UI.KPIType',
  Detail : {
    $Type : 'UI.KPIDetailType',
    DefaultPresentationVariant : ![@UI.PresentationVariant#Eval_by_Currency1],
    AlternativePresentationVariants : [ ![@UI.PresentationVariant#Eval_by_Currency_Column] ],
    SemanticObject : 'Action',
    Action : 'toappnavsample'
  },
  SelectionVariant : ![@UI.SelectionVariant#Eval_by_Currency_1],
  DataPoint : ![@UI.DataPoint#Eval_by_Country-Generic],
  ID : 'String for KPI Annotation'
}
```

**STEP**: TextArrangement — XML example
**DESCRIPTION**: Use com.sap.vocabularies.Common.v1.Text and UI.TextArrangement to control label/value concatenation (TextFirst, TextLast, TextOnly). Bind Text to a property path. Example shows setting Text and TextArrangement on a target property.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="GWSAMPLE_BASIC.SalesOrder/CustomerID">
  <Annotation Term="com.sap.vocabularies.Common.v1.Text" Path="Supplier_Name"/>
  <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast" />
</Annotations>
```

**STEP**: TextArrangement — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS and CAP ways to annotate text arrangement and common text property.
**LANGUAGE**: ABAP CDS
**CODE**:
```
annotate view SALESORDER with {
  @UI.TextArrangement: #TEXT_LAST
  customerid;
}
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.Text : Supplier_Name
  @UI.TextArrangement : #TextLast
  CustomerID
};
```

**STEP**: PersonalData — XML example (Potentially Sensitive)
**DESCRIPTION**: Mark fields as potentially sensitive using PersonalData annotations. Use PersonalData.IsPotentiallySensitive (or Semantics.personalData.isPotentiallySensitive in ABAP) to protect sensitive properties.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="SEPMRA_OVW.SEPMRA_C_OVW_SalesOrderType/CompanyCode">
  <Annotation Term="com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"/>
</Annotations>
```

**STEP**: PersonalData — ABAP CDS and CAP examples
**DESCRIPTION**: ABAP CDS and CAP forms for marking a property as potentially sensitive.
**LANGUAGE**: ABAP CDS
**CODE**:
```
@Semantics.personalData.isPotentiallySensitive: true
CompanyCode;
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
annotate SEPMRA_OVW.SEPMRA_C_OVW_SalesOrderType with {
  @PersonalData.IsPotentiallySensitive
  CompanyCode
};
```
--------------------------------

**TITLE**: Area Micro Chart — UI.Annotation Samples (XML / ABAP CDS / CAP CDS)

**INTRODUCTION**: Action-oriented reference for implementing an Area Micro Chart using OData/UI annotations. Includes ready-to-use examples for XML annotations, ABAP CDS annotations, and CAP CDS annotations. Shows how to wire UI.Chart to a UI.DataPoint (with CriticalityCalculation) and lists mandatory requirements and tips for labels and units.

**TAGS**: AreaMicroChart, UI.Chart, UI.DataPoint, CriticalityCalculation, annotations, XML, ABAP, CDS, CAP, fiori-elements-framework

**STEP**: 1 — Purpose and important constraints
**DESCRIPTION**: Short checklist of behavior and constraints to enforce in code generation and model design.
**LANGUAGE**: Text
**CODE**:
```text
- Purpose: Show a trend area micro chart with one measure and thresholds (error/warning/acceptance/good).
- Semantic coloring: CriticalityCalculation is mandatory (use UI.DataPoint -> CriticalityCalculation).
- Dimensions/measures must NOT be from the same entity: dimensions must come from a 1:n navigation entity relative to the measure.
- Unit consistency: ensure all data points use the same unit of measure.
- Labels: first/last measure values are shown top-left/top-right; first/last dimension values are shown bottom-left/bottom-right.
- Mandatory annotations:
  - UI.Chart -> ChartType = Area
  - UI.Chart -> Dimensions
  - UI.Chart -> Measures
  - UI.Chart -> MeasureAttributes -> DataPoint
  - UI.DataPoint -> Value
  - UI.DataPoint -> CriticalityCalculation (including ImprovementDirection)
```

**STEP**: 2 — UI.Chart XML Annotation (use in metadata or annotation XML file)
**DESCRIPTION**: Add a UI.Chart annotation for an Area chart that defines title, description, a single dimension, a single measure and MeasureAttributes linking the measure to a DataPoint qualifier.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.Chart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Sales Price" />
        <PropertyValue Property="Description" String="Area Micro Chart" />
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Area" />
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>PriceDay</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>AreaChartPrice</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="AreaChartPrice" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                    <!-- Link to the DataPoint annotation via qualifier -->
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#AreaChartPrice" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 3 — UI.Chart ABAP CDS Annotation (use inside ABAP CDS view or annotation block)
**DESCRIPTION**: ABAP CDS annotation defining the Area chart, dimensions, measures and measureAttributes with asDataPoint true (connects to @UI.DataPoint qualifier).
**LANGUAGE**: ABAP
**CODE**:
```abap
@UI.Chart: [
  {
    title: 'Sales Price',
    description: 'Area Micro Chart',
    chartType: #AREA,
    dimensions: [
      'PRICEDAY'
    ],
    measures: [
      'AREACHARTPRICE'
    ],
    measureAttributes: [
      {
        measure: 'AreaChartPrice',
        role: #AXIS_1,
        asDataPoint: true
      }
    ]
  }
]
annotate view STTA_C_MP_PRODUCT with {
  // annotate fields as needed; link DataPoint qualifier below in scope of field
}
```

**STEP**: 4 — UI.Chart CAP CDS Annotation (use in .cds file or annotation block)
**DESCRIPTION**: CAP CDS JSON-like annotation that mirrors XML/ABAP definitions and points MeasureAttributes to a DataPoint qualifier.
**LANGUAGE**: CDS
**CODE**:
```cds
UI.Chart : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Sales Price',
    Description : 'Area Micro Chart',
    ChartType : #Area,
    Dimensions : [
        PriceDay
    ],
    Measures : [
        AreaChartPrice
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : AreaChartPrice,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#AreaChartPrice'
        }
    ]
}
```

**STEP**: 5 — UI.DataPoint XML Annotation (create qualifier and CriticalityCalculation)
**DESCRIPTION**: Define a DataPoint annotation (qualifier = AreaChartPrice) that provides Value, TargetValue and CriticalityCalculation with ImprovementDirection and upper/lower deviation/tolerance bounds. Use paths to entity properties.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.DataPoint" Qualifier="AreaChartPrice">
    <Record>
        <PropertyValue Property="Value" Path="AreaChartPrice" />
        <PropertyValue Property="TargetValue" Path="TargetPrice" />
        <PropertyValue Property="CriticalityCalculation">
            <Record>
                <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Target" />
                <PropertyValue Property="DeviationRangeHighValue" Path="DeviationUpperBoundPrice" />
                <PropertyValue Property="DeviationRangeLowValue" Path="DeviationLowerBoundPrice" />
                <PropertyValue Property="ToleranceRangeHighValue" Path="ToleranceUpperBoundPrice" />
                <PropertyValue Property="ToleranceRangeLowValue" Path="ToleranceLowerBoundPrice" />
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 6 — UI.DataPoint ABAP CDS Annotation
**DESCRIPTION**: Annotate the measure element in ABAP CDS with @UI.dataPoint linking target value and the criticality calculation elements. The qualifier is the name of the data point (AreaChartPrice).
**LANGUAGE**: ABAP
**CODE**:
```abap
@UI.dataPoint: {
  targetValueElement: 'TargetPrice',
  criticalityCalculation: {
    improvementDirection: #TARGET,
    deviationRangeHighValueElement: 'DeviationUpperBoundPrice',
    deviationRangeLowValueElement: 'DeviationLowerBoundPrice',
    toleranceRangeHighValueElement: 'ToleranceUpperBoundPrice',
    toleranceRangeLowValueElement: 'ToleranceLowerBoundPrice'
  }
}
AreaChartPrice;
```

**STEP**: 7 — UI.DataPoint CAP CDS Annotation
**DESCRIPTION**: CAP CDS DataPoint block that defines Value, TargetValue and CriticalityCalculation for qualifier #AreaChartPrice. Use property names from the service/entity.
**LANGUAGE**: CDS
**CODE**:
```cds
UI.DataPoint #AreaChartPrice : {
    Value : AreaChartPrice,
    TargetValue : TargetPrice,
    CriticalityCalculation : {
        ImprovementDirection : #Target,
        DeviationRangeHighValue : DeviationUpperBoundPrice,
        DeviationRangeLowValue : DeviationLowerBoundPrice,
        ToleranceRangeHighValue : ToleranceUpperBoundPrice,
        ToleranceRangeLowValue : ToleranceLowerBoundPrice
    }
}
```

**STEP**: 8 — Implementation checklist (quick copy-paste checklist for codegen)
**DESCRIPTION**: Ensure these items are implemented and validated during code generation or model validation.
**LANGUAGE**: Text
**CODE**:
```text
- Add UI.Chart with ChartType = Area.
- Provide one or more Dimensions (use 1:n navigation entity for dimension).
- Provide Measures and in MeasureAttributes set DataPoint to the DataPoint qualifier.
- Create UI.DataPoint qualifier and set Value (measure), TargetValue, and CriticalityCalculation.
- CriticalityCalculation must include ImprovementDirection and appropriate bound properties.
- Ensure unit of measure consistency across Value, TargetValue and bounds.
- Verify UI.DataPoint qualifier name matches the DataPoint reference used in UI.Chart MeasureAttributes.
```
--------------------------------

**TITLE**: Bar Chart Card (UI.Chart) with Semantic Coloring in Fiori Elements

**INTRODUCTION**: Use the UI.Chart annotation to create a Bar Chart Card in SAP Fiori Elements. For semantic coloring, associate measures with UI.DataPoint annotations that define threshold values (ToleranceRangeLowValue, ToleranceRangeHighValue, DeviationRangeLowValue, DeviationRangeHighValue) and ImprovementDirection. This doc shows a minimal, actionable set of annotations and rules to implement horizontal/vertical bar charts and semantic coloring.

**TAGS**: fiori-elements-framework, UI.Chart, UI.DataPoint, annotation, bar-chart, semantic-coloring, OData, CDS

**STEP**: 1 — Define the UI.Chart annotation for a Bar Chart
**DESCRIPTION**: Create a UI.Chart annotation of type Bar. Specify Title, ChartType, Measures, Dimensions, MeasureAttributes (map each measure to its DataPoint annotation and role), and DimensionAttributes. Use one measure when you intend to enable semantic coloring (recommended).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- UI.Chart annotation (Qualifier: Eval_by_Currency_Bar) -->
<Annotation Term="UI.Chart" Qualifier="Eval_by_Currency_Bar">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Sales by Product" />
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bar" />
    <PropertyValue Property="Measures">
      <Collection>
        <PropertyPath>Sales</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Dimensions">
      <Collection>
        <PropertyPath>Product</PropertyPath>
      </Collection>
    </PropertyValue>

    <!-- Map measure to DataPoint and Axis role -->
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="Sales" />
          <PropertyValue Property="DataPoint">
            <!-- Reference the DataPoint annotation qualifier below -->
            <AnnotationPath>@UI.DataPoint#Column_Eval_by_Country_123</AnnotationPath>
          </PropertyValue>
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
        </Record>
      </Collection>
    </PropertyValue>

    <!-- Dimension mapping -->
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="Product" />
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 2 — Define the UI.DataPoint annotation used for semantic coloring
**DESCRIPTION**: Define a UI.DataPoint annotation (qualifier matches Chart MeasureAttributes.DataPoint). Include the MeasureValue (value path or constant), ImprovementDirection (Maximize, Minimize, Target), and ThresholdValues (ToleranceRangeLowValue, ToleranceRangeHighValue, DeviationRangeLowValue, DeviationRangeHighValue). Use numeric literal or PropertyPath for values. This drives semantic coloring for bars.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- UI.DataPoint annotation for measure 'Sales' (Qualifier: Column_Eval_by_Country_123) -->
<Annotation Term="UI.DataPoint" Qualifier="Column_Eval_by_Country_123">
  <Record Type="UI.DataPointType">
    <!-- Value on which improvement is measured; typically the same measure -->
    <PropertyValue Property="Value" Path="Sales" />

    <!-- ImprovementDirection: UI.DataPointImprovementDirection/Maximize | Minimize | Target -->
    <PropertyValue Property="ImprovementDirection" EnumMember="UI.DataPointImprovementDirection/Maximize" />

    <!-- Thresholds controlling semantic coloring -->
    <PropertyValue Property="Thresholds">
      <Record Type="UI.DataPointThresholdsType">
        <PropertyValue Property="ToleranceRangeLowValue" Decimal="50000" />
        <PropertyValue Property="ToleranceRangeHighValue" Decimal="100000" />
        <PropertyValue Property="DeviationRangeLowValue" Decimal="20000" />
        <PropertyValue Property="DeviationRangeHighValue" Decimal="150000" />
      </Record>
    </PropertyValue>

    <!-- Optional: Annotation header, text, and other DataPoint properties -->
    <PropertyValue Property="Title" String="Sales DataPoint" />
  </Record>
</Annotation>
```

**STEP**: 3 — Semantic coloring rules (mapping of measure value to semantic state)
**DESCRIPTION**: Use these actionable mappings to implement or verify semantic coloring logic (UI uses these thresholds plus ImprovementDirection to decide Good/Neutral/Bad colors). Apply comparisons against the DataPoint ThresholdValues depending on ImprovementDirection.
**LANGUAGE**: plaintext
**CODE**:
```
Maximizing (higher is better)
  - Negative -> Critical: value >= DeviationRangeLowValue AND value < ToleranceRangeLowValue
  - Critical -> Positive: value >= ToleranceRangeLowValue AND value < ToleranceRangeHighValue (or >= ToleranceRangeLowValue)
  - Good when value >= ToleranceRangeLowValue (implementation-specific inclusivity as noted)

Minimizing (lower is better)
  - Positive -> Critical: value > ToleranceRangeHighValue AND value <= DeviationRangeHighValue
  - Critical -> Negative: value > DeviationRangeHighValue

Target (preferred within a closed range)
  - Negative -> Critical: value >= DeviationRangeLowValue AND value < ToleranceRangeLowValue
  - Critical -> Positive: value >= ToleranceRangeLowValue AND value < ToleranceRangeHighValue
  - Positive -> Critical: value >= ToleranceRangeHighValue AND value < DeviationRangeHighValue
  - Critical -> Negative: value >= DeviationRangeHighValue
```

**STEP**: 4 — Recommendations and legend behavior
**DESCRIPTION**: Implementation and UX notes to enforce while writing annotations or UI code:
- Prefer a single measure when semantic coloring is required. Multiple measures cause legends to show only generic Good/Bad/Neutral instead of numeric threshold values.
- When semantic coloring is enabled, the legend will display threshold values that influence the semantic color (for single-measure charts). With multiple measures, legends show only Good/Bad/Neutral labels.
- Ensure the DataPoint.Value points to the same measure used in MeasureAttributes to enable correct evaluation.
**LANGUAGE**: plaintext
**CODE**:
```
- Use one measure for semantic coloring (recommended).
- DataPoint.Value must reference the measure used in the chart MeasureAttributes.
- Define Thresholds.ToleranceRangeLow/High and DeviationRangeLow/High in the DataPoint annotation.
- Set ImprovementDirection to one of: UI.DataPointImprovementDirection/Maximize,
  UI.DataPointImprovementDirection/Minimize, UI.DataPointImprovementDirection/Target.
```

**STEP**: 5 — Full minimal example (Chart + DataPoint together)
**DESCRIPTION**: Example showing both UI.Chart and UI.DataPoint annotations combined in the same annotation file (copy into your annotations XML or extend your CDS OData annotations accordingly).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Full example: UI.Chart (Bar) + UI.DataPoint for semantic coloring -->
<Annotations Target="YourService.EntityType">
  <!-- Chart annotation -->
  <Annotation Term="UI.Chart" Qualifier="Eval_by_Currency_Bar">
    <Record Type="UI.ChartDefinitionType">
      <PropertyValue Property="Title" String="Sales by Product" />
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bar" />
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>Sales</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>Product</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="MeasureAttributes">
        <Collection>
          <Record Type="UI.ChartMeasureAttributeType">
            <PropertyValue Property="Measure" PropertyPath="Sales" />
            <PropertyValue Property="DataPoint">
              <AnnotationPath>@UI.DataPoint#Column_Eval_by_Country_123</AnnotationPath>
            </PropertyValue>
            <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
          </Record>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="DimensionAttributes">
        <Collection>
          <Record Type="UI.ChartDimensionAttributeType">
            <PropertyValue Property="Dimension" PropertyPath="Product" />
            <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <!-- DataPoint annotation (qualifier referenced above) -->
  <Annotation Term="UI.DataPoint" Qualifier="Column_Eval_by_Country_123">
    <Record Type="UI.DataPointType">
      <PropertyValue Property="Value" Path="Sales" />
      <PropertyValue Property="ImprovementDirection" EnumMember="UI.DataPointImprovementDirection/Maximize" />
      <PropertyValue Property="Thresholds">
        <Record Type="UI.DataPointThresholdsType">
          <PropertyValue Property="ToleranceRangeLowValue" Decimal="50000" />
          <PropertyValue Property="ToleranceRangeHighValue" Decimal="100000" />
          <PropertyValue Property="DeviationRangeLowValue" Decimal="20000" />
          <PropertyValue Property="DeviationRangeHighValue" Decimal="150000" />
        </Record>
      </PropertyValue>
      <PropertyValue Property="Title" String="Sales DataPoint" />
    </Record>
  </Annotation>
</Annotations>
```
--------------------------------

**TITLE**: Bubble Chart Card (Fiori Elements UI.Chart Annotation)

**INTRODUCTION**: Defines how to configure a Bubble Chart card using UI.Chart annotations in XML, ABAP CDS, or CAP CDS. Bubble charts require exactly three measures (mapped to x-axis, y-axis, bubble size) and one or two dimensions (mapped to color/shape). Use these annotations in your OData metadata or CDS views to render a bubble chart in Fiori Elements.

**TAGS**: fiori-elements-framework, UI.Chart, bubble-chart, annotations, XML, ABAP CDS, CAP CDS, visualization

**STEP**: 1 - Role-to-feed mapping and rules

**DESCRIPTION**: Summary of how measures and dimensions map to visualization feeds and the fallback rules for axis assignment. Use this when assigning Role values in MeasureAttributes/DimensionAttributes.

- Required: 3 measures (one each for x-axis, y-axis, and bubble size) and 1–2 dimensions (color/shape).
- Feeds:
  - valueAxis (x-axis) — first measure with axis role. UID of that measure is x-axis.
  - valueAxis2 (y-axis) — next measure selected for axis role (see fallback rules).
  - bubbleWidth — remaining measure (bubble size).
  - color — dimensions with Role = Series produce different colors. If two dimensions both use Series, combinations get unique colors.
  - shape — dimensions with Role = Category produce differently shaped data points. If multiple, only first Category dimension used.
- Axis role fallback logic (use exactly as below when deciding which measure becomes x or y):
  - The first measure with Role set to Axis1 becomes valueAxis (x-axis).
    - Note: Role value is set to Axis1, Axis2 (if no Axis1 for first measure), or Axis3 (if no Axis2).
  - The first measure with Role set to Axis2 becomes valueAxis2 (y-axis).
    - If there's no Axis2 for that measure, fallback order used:
      - Role = Axis2 of the first measure, else
      - Role = Axis1 of the second measure, else
      - Role = Axis3 of the first measure.
- Series behavior examples:
  - If Role = Series assigned to Year and Country, colors represent combinations: India/2015, India/2016, Germany/2015, Germany/2016.
  - If only Country is Series, Year is not, all records for a country use the same color across years.
- Recommendation: Do not use Category (shape) for bubble chart unless you explicitly need varied shapes — color (Series) is preferred.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "feeds": {
    "valueAxis": "measure with Role = Axis1 (x-axis)",
    "valueAxis2": "measure with Role = Axis2 (y-axis) using fallback rules",
    "bubbleWidth": "remaining measure (bubble size)",
    "color": "dimension(s) with Role = Series (unique colors per value or combination)",
    "shape": "dimension with Role = Category (different shapes; only first considered)"
  },
  "constraints": {
    "measures": 3,
    "dimensions": "1 or 2"
  },
  "notes": [
    "If multiple dimensions use Series, each unique combination becomes a separate color.",
    "If multiple dimensions use Category, only the first is considered for shape.",
    "Prefer Series (color) over Category (shape) for bubble charts."
  ]
}
```

**STEP**: 2 - XML Annotation example

**DESCRIPTION**: Use this XML UI.Chart annotation in your service metadata to define a Bubble Chart. Ensure you have three MeasureAttributes and one or two DimensionAttributes. Replace Measure and Dimension PropertyPath values with your entity properties and set the Qualifier to reference this chart configuration where needed.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.Chart" Qualifier="Qualifier_ID_1">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="View1" />
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bubble"/>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="SalesShare" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                </Record>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="TotalSales" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2" />
                </Record>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="Sales" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis3" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="DimensionAttributes">
            <Collection>
                <Record Type="UI.ChartDimensionAttributeType">
                    <PropertyValue Property="Dimension" PropertyPath="Product" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Series" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 3 - ABAP CDS Annotation example

**DESCRIPTION**: Embed this ABAP CDS annotation block in your CDS view definition. Replace field names (SalesShare, TotalSales, Sales, Product) and view name accordingly. The qualifier identifies this chart instance.

**LANGUAGE**: ABAP

**CODE**:
```abap
@UI.Chart: [
  {
    title: 'View1',
    chartType: #BUBBLE,
    measureAttributes: [
      {
        measure: 'SalesShare',
        role: #AXIS_1
      },
      {
        measure: 'TotalSales',
        role: #AXIS_2
      },
      {
        measure: 'Sales',
        role: #AXIS_3
      }
    ],
    dimensionAttributes: [
      {
        dimension: 'Product',
        role: #SERIES
      }
    ],
    qualifier: 'Qualifier_ID_1'
  }
]
annotate view VIEWNAME with { }
```

**STEP**: 4 - CAP CDS Annotation example

**DESCRIPTION**: Use this CAP CDS syntax when annotating your CDS model. Ensure the $Type, MeasureAttributes and DimensionAttributes follow the UI.Chart definitions. Replace identifiers and qualifier as needed.

**LANGUAGE**: CDS

**CODE**:
```cds
UI.Chart #Qualifier_ID_1 : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'View1',
    ChartType : #Bubble,
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : SalesShare,
            Role : #Axis1
        },
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : TotalSales,
            Role : #Axis2
        },
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Sales,
            Role : #Axis3
        }
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : Product,
            Role : #Series
        }
    ]
}
```

**STEP**: 5 - Semantic coloring / color palette

**DESCRIPTION**: Bubble charts support semantic coloring. Apply semantic color annotations or a color palette in your UI metadata or manifest to map dimension values to semantic colors. When Series is used, the chart uses the palette to assign colors per value or per combination (if multiple Series dimensions are present).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "note": "Semantic coloring is supported. Configure color palettes or semantic color annotations as part of your UI metadata/manifest or annotation extension. When using Role = Series, the chart maps series values to the configured palette; combinations of multiple Series dimensions receive unique palette entries."
}
```
--------------------------------

**TITLE**: Build an SAP Fiori elements UI Application (VS Code / Business Application Studio + UI5 Tooling)

**INTRODUCTION**: This guide gives actionable, code-focused steps to create, run, and build an SAP Fiori elements UI application using SAP Fiori tools (VS Code or SAP Business Application Studio) and UI5 Tooling. It includes required CLI installs, generator usage, local development commands, example config files, and a minimal manifest.json for a Fiori elements List Report / Object Page app.

**TAGS**: sap-fiori, fiori-elements, ui5, ui5-tooling, sap-fiori-tools, vscode, sap-business-application-studio, manifest, ui5.yaml, package.json

**STEP**: 1 — Install prerequisites

**DESCRIPTION**: Install Node.js LTS and the UI5 CLI, verify Node/npm versions. Optionally install additional validators used in Fiori projects.

**LANGUAGE**: Shell

**CODE**:
```bash
# Verify Node and npm (use Node LTS)
node -v
npm -v

# Install UI5 CLI globally (used for local serve and build)
npm install --global @ui5/cli

# Optional developer helpers (validator/specification)
npm install --global @sap/ux-specification
```

**STEP**: 2 — Install SAP Fiori tools (VS Code or Business Application Studio)

**DESCRIPTION**: Install the SAP Fiori tools extension pack in Visual Studio Code or use the Application Generator available in SAP Business Application Studio. The Application Generator scaffolds Fiori elements apps (List Report + Object Page, Analytical List Page, etc.). See the official SAP Fiori tools documentation for extension installation if needed:
https://help.sap.com/viewer/product/SAP_FIORI_tools/Latest/en-US

**LANGUAGE**: Text / UI

**CODE**:
```text
# In VS Code:
# 1. Open Extensions (Ctrl+Shift+X)
# 2. Search "SAP Fiori tools" or "Fiori tools - Extension Pack"
# 3. Install the extension pack and restart VS Code

# In SAP Business Application Studio:
# Use the built-in "Templates" or "SAP Fiori tools - Application Generator" menu items.
```

**STEP**: 3 — Create a new Fiori elements application using the Application Generator

**DESCRIPTION**: Use the Application Generator from the command palette (VS Code) or the BAS templates to scaffold a Fiori elements app. Typical interactive prompts: project name, data source (OData v2/v4), floorplan (List Report/Object Page), namespace/component name, and destination/service URL. After generation, the project structure will contain webapp/, manifest.json, and ui5 config files.

**LANGUAGE**: Text / Commands

**CODE**:
```text
# In VS Code Command Palette:
# 1. Open: Ctrl+Shift+P
# 2. Run: "Fiori: Open Application Generator" (or "Fiori: Create Project")
# 3. Choose "SAP Fiori elements" -> choose floorplan (List Report/Object Page)
# 4. Provide service URL (OData) or local metadata, namespace, and project folder

# In BAS, use the Application Generator wizard in the File -> New Project menu.
```

**STEP**: 4 — Minimal manifest.json for a Fiori elements List Report + Object Page

**DESCRIPTION**: Example minimal manifest.json required by Fiori elements apps: app descriptor with component name, OData dataSource, and routing to list report/object page. Keep this file at webapp/manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "com.example.fiori",
    "type": "application",
    "i18n": "i18n/i18n.properties",
    "title": "{{appTitle}}"
  },
  "sap.ui5": {
    "rootView": {
      "viewName": "com.example.fiori.view.App",
      "type": "XML",
      "id": "app"
    },
    "dependencies": {
      "minUI5Version": "1.84.0",
      "libs": {
        "sap.f": {},
        "sap.m": {},
        "sap.fe.templates": {}
      }
    },
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "synchronizationMode": "None"
        }
      }
    }
  },
  "sap.ui": {
    "technology": "UI5"
  },
  "sap.applications": {},
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport"
        }
      }
    ]
  },
  "sap.platform.hcp": {},
  "sap.platform.abap": {},
  "sap.platform.cloud": {},
  "dataSources": {
    "mainService": {
      "uri": "/sap/opu/odata/sap/Z_MY_SERVICE_SRV/",
      "type": "OData",
      "settings": {
        "odataVersion": "2.0"
      }
    }
  }
}
```

**STEP**: 5 — Add ui5.yaml for UI5 Tooling (local serve and build)

**DESCRIPTION**: Place ui5.yaml in the project root. It defines the application type and resources for @ui5/cli commands (serve/build).

**LANGUAGE**: YAML

**CODE**:
```yaml
specVersion: '2.3'
metadata:
  name: com.example.fiori
type: application
resources:
  configuration:
    paths:
      webapp: webapp
builder:
  resources:
    excludes:
      - test/**
server:
  customMiddleware:
    - name: ui5-middleware-simpleproxy
      afterMiddleware: compression
      mountPath: /sap
      configuration:
        baseUri: "https://my-backend.example.com"
```

**STEP**: 6 — package.json scripts for local dev and build

**DESCRIPTION**: Add npm scripts to run ui5 serve for local development and ui5 build for production packaging. Install any local dev dependencies.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "name": "com.example.fiori",
  "version": "1.0.0",
  "scripts": {
    "start": "ui5 serve --open /index.html",
    "build": "ui5 build --clean-dest --dest dist",
    "lint": "ui5-lint"
  },
  "devDependencies": {
    "@ui5/cli": "^3.0.0",
    "ui5-middleware-simpleproxy": "^1.0.0"
  }
}
```

**STEP**: 7 — Run locally and build for distribution

**DESCRIPTION**: Use the UI5 CLI commands to serve the app during development and build a static distribution for deployment.

**LANGUAGE**: Shell

**CODE**:
```bash
# Install local dev dependencies
npm install

# Run local dev server and open the application in the browser
npm run start
# -> opens http://localhost:8080/index.html (change port/config as needed)

# Build production-ready distribution into ./dist
npm run build
# The dist/ folder contains the optimized app assets to deploy to a web server or SAP BTP HTML5 App Repository
```

**STEP**: 8 — Deploy options (brief)

**DESCRIPTION**: After build, deploy dist/ to your chosen runtime: SAP BTP HTML5 Application Repository (use SAP CLI or Cloud Foundry CLI), ABAP front-end server, or other hosting. For SAP BTP, push the built app via SAP CLI or CI pipeline to the HTML5 runtime.

**LANGUAGE**: Text / Commands

**CODE**:
```text
# Example (high-level):
# 1. Build: npm run build
# 2. Upload dist/ to SAP BTP HTML5 Application Repository (via UI or CI/CD)
# 3. Bind the app to destinations/service instances as required

# For Cloud Foundry apps, use cf CLI or SAP Cloud SDK pipelines (project-specific).
```

**STEP**: 9 — Useful file locations in a generated project

**DESCRIPTION**: Reference of common paths produced by the Application Generator. Use these paths when writing code, modifying manifest, or adding tests.

**LANGUAGE**: Text

**CODE**:
```text
webapp/
  index.html            # App bootstrap
  manifest.json         # App descriptor (main Fiori elements configuration)
  Component.js          # Component entry point (optional with Fiori elements)
  view/                 # XML views (if present)
  i18n/                 # i18n properties for titles/labels
  localService/         # Mock server metadata (optional)
ui5.yaml                # UI5 Tooling configuration (project root)
package.json            # npm scripts and devDependencies
dist/                   # Output of ui5 build (production assets)
```

**STEP**: 10 — References

**DESCRIPTION**: Official documentation and guides.

**LANGUAGE**: Text

**CODE**:
```text
SAP Fiori tools documentation:
https://help.sap.com/viewer/product/SAP_FIORI_tools/Latest/en-US

SAP Fiori elements developer guides and floorplans:
https://experience.sap.com/fiori-design-web/

UI5 Tooling:
https://sap.github.io/ui5-tooling/
```
--------------------------------

**TITLE**: SAP Fiori elements — Building Blocks (OData V4) — Field macro usage and dynamic fragment loading

**INTRODUCTION**: This guide explains how to use SAP Fiori elements building blocks (macros) for OData V4, showing a concrete XML fragment example using the Field building block, the resulting control tree created at runtime, and how to load such a fragment dynamically using sap.fe.core.ExtensionAPI.loadFragment from an extension controller. It clarifies precedence: manifest configuration overrides XML and annotations.

**TAGS**: fiori-elements-framework, sap-fe, odata-v4, building-blocks, macros, fragments, ui5, extension-api

STEP: 1 — Prerequisites and behavior summary

DESCRIPTION:
- Building blocks (macros) are templating instructions (not runtime SAPUI5 controls) that create control trees based on bound data and attributes.
- Applicable only to SAP Fiori elements for OData V4.
- Configuration sources (in order of increasing priority): annotations -> XML fragment attributes -> manifest.json (manifest wins).
- When fragments are loaded dynamically, use sap.fe.core.ExtensionAPI.loadFragment to ensure proper lifecycle/metadata handling.

LANGUAGE: text

CODE:
```text
Prerequisites:
- App built on SAP Fiori elements (OData V4)
- Fragment files placed under webapp/view/fragments/ or equivalent
- Extension controller that has access to sap.fe.core.ExtensionAPI (e.g., a controller extension)
```

STEP: 2 — Create an XML fragment using the Field building block

DESCRIPTION:
- Create a fragment file that uses the Field macro to represent properties from the bound OData entity.
- Example shows a string property and a date property using the Field building block with readOnly="true".

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/view/fragments/CustomSection.fragment.xml -->
<!-- Use xmlns:macros="sap.fe.macros" to access building block macros -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:macros="sap.fe.macros">

    <!-- Field building block for a string property -->
    <macros:Field metaPath="MyStringProperty" readOnly="true" />

    <!-- Field building block for a date property -->
    <macros:Field metaPath="MyDateProperty" readOnly="true" />

</core:FragmentDefinition>
```

STEP: 3 — Example of the runtime control tree produced by the Field building block

DESCRIPTION:
- At runtime the Field building block produces standard UI5 controls according to the bound property type.
- Example mapping: string -> sap.m.Text, date -> sap.m.DatePicker (the exact control may vary depending on annotations and data type).

LANGUAGE: XML

CODE:
```xml
<!-- Runtime equivalent control tree produced by the Field macro -->
<!-- (This is the control structure created by the macro, shown for clarity.) -->
<m:Text xmlns:m="sap.m" value="{MyStringProperty}" />
<m:DatePicker xmlns:m="sap.m" value="{MyDateProperty}" />
```

STEP: 4 — Load the fragment dynamically from an extension controller using sap.fe.core.ExtensionAPI.loadFragment

DESCRIPTION:
- Use the ExtensionAPI.loadFragment method from your extension controller to ensure fragments load correctly in the Fiori elements runtime.
- Pass the fragment name (module path) and the controller instance so the fragment is instantiated with the correct controller context.
- After loading, insert the fragment content into a target aggregation (for example, a VBox or CustomSection container) in your view.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/controller/Extension.controller.js
// Example within a controller extension method (ES6)
onInit() {
  // 'this.extensionAPI' is available in Fiori elements controller extensions
  // Example target container in the view: <VBox id="customSectionContainer" />
}

async function loadCustomSection() {
  try {
    const fragment = await this.extensionAPI.loadFragment({
      // Module name of the fragment (path according to AMD/module loader)
      name: "my.app.view.fragments.CustomSection",
      // Provide the controller for event handling inside the fragment
      controller: this
    });

    // Example: add the loaded fragment content to a target container in the view
    const container = this.byId("customSectionContainer"); // ensure this exists in the view
    if (Array.isArray(fragment)) {
      // fragment can be an array of controls (FragmentDefinition content)
      fragment.forEach(ctrl => container.addItem(ctrl));
    } else {
      // single root control
      container.addItem(fragment);
    }
  } catch (err) {
    // Handle load errors
    // Keep error handling concise and actionable
    console.error("Failed to load fragment", err);
  }
}
```

STEP: 5 — Access and manipulate created controls (runtime)

DESCRIPTION:
- Building blocks do not exist as distinct runtime controls; they create control instances. Manipulate those instances using standard UI5 APIs (byId, findAggregation, or traversing aggregations).
- Use the view/fragment controller to locate created controls and update properties or bindings.

LANGUAGE: JavaScript

CODE:
```javascript
// Example: find and update a created control after fragment load
const textControl = this.byId("myStringControlId"); // if an id was specified in the fragment or assigned after creation
if (textControl) {
  textControl.setVisible(true);
  // Update binding or value if needed
  // textControl.bindProperty("text", { path: "NewProperty" });
}

// If IDs were not set, traverse the container aggregation
const container = this.byId("customSectionContainer");
container.getItems().forEach(item => {
  // Inspect control type and act accordingly
  const sClass = item.getMetadata().getName();
  if (sClass === "sap.m.DatePicker") {
    item.setValueState("None");
  }
});
```

STEP: 6 — Manifest vs XML vs Annotations (override precedence)

DESCRIPTION:
- The manifest.json app descriptor overrides any configuration coming from XML fragments and annotation definitions. When you need global adjustments to building-block behavior, place them in manifest.json.
- Do not rely on fragment-level attributes to be authoritative if manifest entries configure the same aspect.

LANGUAGE: text

CODE:
```text
Guidance:
- Place global overrides in manifest.json (app descriptor).
- Keep fragment attributes for local/fragment-scoped behavior only.
- Annotations define metadata-driven defaults; fragment and manifest can override them.
```

STEP: 7 — References and further examples

DESCRIPTION:
- Use the SAP Fiori development portal and the ExtensionAPI demo for live examples and details on loadFragment usage.

LANGUAGE: text

CODE:
```text
Helpful links:
- SAP Fiori development portal (live examples): https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/topic/introduction
- ExtensionAPI.loadFragment (Demo Kit overview): https://ui5.sap.com/#/api/sap.fe.core.ExtensionAPI%23overview
```
--------------------------------

**TITLE**: Bullet Micro Chart — UI.Chart and UI.DataPoint Annotations (XML, ABAP CDS, CAP CDS)

**INTRODUCTION**: Configure a Bullet Micro Chart in SAP Fiori by adding UI.Chart and UI.DataPoint annotations. Use these annotation examples directly in your XML metadata, ABAP CDS views, or CAP CDS models to display a bullet micro chart with a primary measure, target/forecast values, min/max ranges, and semantic coloring via Criticality or CriticalityCalculation.

**TAGS**: fiori-elements-framework, annotations, ui.chart, ui.datapoint, bullet, microchart, CDS, CAP, ABAP, XML

**STEP**: 1 — Add UI.Chart annotation to enable Bullet Micro Chart

**DESCRIPTION**: Declare the chart as type Bullet, specify Measures, and link MeasureAttributes to the DataPoint qualifier. Place this annotation in your metadata (OData XML), ABAP CDS view (annotate view ...), or CAP CDS model.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.Chart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Sales Revenue" />
        <PropertyValue Property="Description" String="Bullet Micro Chart" />
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bullet" />
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>BulletChartRevenue</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="BulletChartRevenue" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#BulletChartRevenue" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Chart: [
  {
    title: 'Sales Revenue',
    description: 'Bullet Micro Chart',
    chartType: #BULLET,
    measures: [
      'BULLETCHARTREVENUE'
    ],
    measureAttributes: [
      {
        measure: 'BulletChartRevenue',
        role: #AXIS_1,
        asDataPoint: true
      }
    ]
  }
]
annotate view STTA_C_MP_PRODUCT with {
  // add related @UI.DataPoint qualifier separately
}
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.Chart : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Sales Revenue',
    Description : 'Bullet Micro Chart',
    ChartType : #Bullet,
    Measures : [
        BulletChartRevenue
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : BulletChartRevenue,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#BulletChartRevenue'
        }
    ]
}
```

**STEP**: 2 — Add UI.DataPoint annotation for the measure (Value, Target, Forecast, Range, Criticality)

**DESCRIPTION**: Define the DataPoint qualifier referenced in MeasureAttributes. Provide Value (measure), TargetValue, ForecastValue, MinimumValue, MaximumValue, and Criticality or CriticalityCalculation. Use the qualifier name (BulletChartRevenue) consistently between UI.Chart and UI.DataPoint.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.DataPoint" Qualifier="BulletChartRevenue">
    <Record>
        <PropertyValue Property="Value" Path="BulletChartRevenue" />
        <PropertyValue Property="TargetValue" Path="TargetRevenue" />
        <PropertyValue Property="ForecastValue" Path="ForecastRevenue" />
        <PropertyValue Property="MinimumValue" Decimal="100" />
        <PropertyValue Property="MaximumValue" Decimal="300" />
        <PropertyValue Property="Criticality" Path="Criticality" />
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.dataPoint: {
  targetValueElement: 'TargetRevenue',
  forecastValue: 'ForecastRevenue',
  minimumValue: 100,
  maximumValue: 300,
  criticality: 'Criticality'
}
BulletChartRevenue;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.DataPoint #BulletChartRevenue : {
    Value : BulletChartRevenue,
    TargetValue : TargetRevenue,
    ForecastValue : ForecastRevenue,
    MinimumValue : 100,
    MaximumValue : 300,
    Criticality : Criticality
}
```

**STEP**: 3 — Semantic coloring rules and mandatory annotations

**DESCRIPTION**: Follow these rules when enabling semantic coloring and required elements for the Bullet Micro Chart. Criticality (explicit) overrides CriticalityCalculation (calculated). Ensure all mandatory annotations are present.

**LANGUAGE**: TEXT

**CODE**:
```
Semantic coloring:
- Both UI.DataPoint -> Criticality and UI.DataPoint -> CriticalityCalculation are supported.
- If both are present, Criticality overrides CriticalityCalculation.

Mandatory annotations for Bullet Micro Chart:
- UI.Chart -> ChartType: "Bullet"
- UI.Chart -> Measures
- UI.Chart -> MeasureAttributes -> DataPoint (annotation path or qualifier)
- UI.DataPoint -> Value
- If using CriticalityCalculation for semantic coloring:
  - UI.DataPoint -> CriticalityCalculation
  - UI.DataPoint -> CriticalityCalculation/ImprovementDirection
```

**STEP**: 4 — Implementation checklist and placement guidance

**DESCRIPTION**: Quick actionable checklist for where to place these annotations.

**LANGUAGE**: TEXT

**CODE**:
```
Checklist:
- OData/XML Metadata: add the <Annotation Term="UI.Chart"> and <Annotation Term="UI.DataPoint" Qualifier="..."> entries.
- ABAP CDS: add @UI.Chart to the view and @UI.dataPoint to the measure element; use annotate view ... with {} to reference qualifier if needed.
- CAP CDS: add UI.Chart and UI.DataPoint blocks in the .cds model where the element names (BulletChartRevenue, TargetRevenue, etc.) are defined.
- Ensure MeasureAttributes DataPoint points to the qualifier: '@UI.DataPoint#QualifierName' (XML/CAP) or asDataPoint / qualifier mapping in CDS.
- Verify field names (Value, TargetValue, ForecastValue, MinimumValue, MaximumValue, Criticality) exist on the entity or are computed fields available to the model.
```
--------------------------------

**TITLE**: Caching the Last Executed Request for List Report (Fiori elements, OData V4)

**INTRODUCTION**: This guide explains how the SAP Fiori elements List Report (OData V4, S/4HANA Cloud Public Edition) caches the last executed request on the client (request parameters only, not response). It lists conditions that disable caching, how to explicitly enable caching when a controller extension exists, and how end users can control or clear the cached request from the SAP Fiori launchpad settings.

**TAGS**: fiori-elements, odata-v4, caching, sap-s4hana-cloud, manifest, list-report, security, PersonalData.IsPotentiallySensitive

**STEP**: Applicability and behavior

**DESCRIPTION**: Confirm this caching behavior applies to your app and understand what is cached. The List Report stores the last executed request parameters on the client to allow re-triggering that request during application load to reduce perceived end-to-end response time.

Key points:
- Applies only to SAP Fiori elements for OData V4 in SAP S/4HANA Cloud Public Edition.
- The cache stores request parameters (filters, sort, paging, expanded selects) — it does NOT cache backend responses.
- Use this to improve load-time behavior by reusing request parameters automatically on app startup.

**LANGUAGE**: text

**CODE**:
```text
Applicability: SAP Fiori elements (OData V4) in SAP S/4HANA Cloud Public Edition
Cached data: Last executed request parameters only (NOT HTTP response bodies)
Effect: Triggers the cached request on app load to reduce perceived response time
```

**STEP**: Conditions that disable request caching

**DESCRIPTION**: These conditions automatically disable the client-side request cache. Check your model, annotations, and extensions before relying on caching.

Disabled when:
- Any filter in the last executed request targets properties annotated with PersonalData.IsPotentiallySensitive.
  - Annotation reference: https://github.com/SAP/odata-vocabularies/blob/main/vocabularies/PersonalData.xml#L234
  - Reason: Sensitive data must not be cached client-side.
- A controller extension is defined for the list report.
  - Reason: Extensions can modify the request (e.g., add filters for sensitive data); caching is conservatively disabled.

Action items:
- Review entity properties for the PersonalData.IsPotentiallySensitive annotation. If any are used in filters, caching will be disabled.
- If you added a controller extension and you are sure it does NOT add filters on sensitive properties, you can re-enable caching by explicitly configuring disableRequestCache = false in the manifest (see next step).

**LANGUAGE**: text

**CODE**:
```text
Disabled when:
- Request contains filters on properties annotated with PersonalData.IsPotentiallySensitive
- A list report controller extension exists (conservative disabling)

Annotation reference:
https://github.com/SAP/odata-vocabularies/blob/main/vocabularies/PersonalData.xml#L234
```

**STEP**: Enable request caching when a controller extension exists (manifest.json)

**DESCRIPTION**: If your app defines a controller extension for the list report and you are certain the extension does NOT add filters on sensitive data, you can explicitly enable request caching by setting disableRequestCache to false under the list report target's controlConfiguration.tableSettings in the manifest.json routing.targets entry.

Place the setting under:
routing -> targets -> <ListReportTarget> -> options -> settings -> controlConfiguration -> @com.sap.vocabularies.UI.v1.LineItem -> tableSettings -> disableRequestCache

Important: Only set this when you are sure no sensitive-data filters will ever be added by your extensions.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "routing": {
    "targets": {
      "RootEntityList": {
        "type": "Component",
        "name": "sap.fe.templates.ListReport",
        "id": "RootEntityList",
        "options": {
          "settings": {
            "entitySet": "RootEntity",
            "controlConfiguration": {
              "@com.sap.vocabularies.UI.v1.LineItem": {
                "tableSettings": {
                  "disableRequestCache": false
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Security and developer caution

**DESCRIPTION**: When using disableRequestCache = false, ensure compliance with data protection and security requirements:
- Verify no filters are applied to properties annotated with PersonalData.IsPotentiallySensitive.
- If unsure, keep caching disabled (default behavior when controller extensions exist).
- Review your controller extension code paths and extension points to ensure they cannot attach sensitive-data filters in future updates.

**LANGUAGE**: text

**CODE**:
```text
Security checklist before enabling caching:
- Confirm no sensitive-data filters (PersonalData.IsPotentiallySensitive) are applied by any extension or runtime logic.
- Document the decision and audit extension points that may later modify requests.
```

**STEP**: End-user cache control in SAP Fiori launchpad

**DESCRIPTION**: Inform end users that they can control cache expiration and clear the cached last executed request within the SAP Fiori launchpad settings.

Where users can act:
- SAP Fiori launchpad -> Settings -> User Activities (or equivalent FLP settings) -> Clear cached activities / user-specific cache entries

Note: The exact FLP UI labels can vary by release. Provide users with the screenshot or navigation path for your installed FLP version if needed.

**LANGUAGE**: text

**CODE**:
```text
End-user steps (FLP):
1. Open SAP Fiori launchpad Settings
2. Navigate to User Activities or relevant cache settings
3. Select clear cache / clear user activities to remove the last executed request
```
--------------------------------

**TITLE**: Changing Default Titles of New and Unnamed Objects (Fiori elements)

**INTRODUCTION**: How to override the default titles displayed for newly created and unnamed objects in SAP Fiori elements (OData V2 and V4) by adding localization keys to the i18n.properties file. Use these steps to provide application-specific titles for list reports and object pages.

**TAGS**: fiori-elements-framework, odata-v2, odata-v4, i18n, localization, new-object, unnamed-object

**STEP**: 1 — OData V2: Override default titles via i18n.properties

**DESCRIPTION**: Add or update the following keys in your i18n.properties file to change the default titles used by Fiori elements V2:
- NEW_OBJECT: title shown for newly created objects in lists and object-page tables.
- UNNAMED_OBJECT: title used for saved but unnamed items in list reports (and to define a fallback on object pages).

Notes:
- For non-draft applications, list reports do not support NEW_OBJECT and UNNAMED_OBJECT in i18n.properties.
- Fiori elements does not provide a default title for saved objects on object pages; set UNNAMED_OBJECT to define a custom fallback.

For general localization guidance see: Localization of UI Texts.

**LANGUAGE**: Properties

**CODE**:
```Properties
# i18n.properties (OData V2)
# Replace the default labels with application-specific titles
NEW_OBJECT=New MyApp Item
UNNAMED_OBJECT=MyApp — (No Title)
```

**STEP**: 2 — OData V4: Override default titles via i18n.properties

**DESCRIPTION**: Add or update the following keys in your i18n.properties file to change the default titles used by Fiori elements V4:
- T_NEW_OBJECT: title shown for newly created objects in lists and object-page tables.
- T_ANNOTATION_HELPER_DEFAULT_HEADER_TITLE_NO_HEADER_INFO: title used when a saved object remains unnamed or the header info is absent.

Behavior notes:
- In V4, a newly created object initially uses T_NEW_OBJECT ("New Object"). If saved without modification, it becomes the unnamed title defined by T_ANNOTATION_HELPER_DEFAULT_HEADER_TITLE_NO_HEADER_INFO.
- If UI.HeaderInfo.Typename is undefined, clearing or saving without editing the default title results in an empty string (""); ensure T_ANNOTATION_HELPER_DEFAULT_HEADER_TITLE_NO_HEADER_INFO is defined if you need a non-empty fallback.

For general localization guidance see: Localization of UI Texts.

**LANGUAGE**: Properties

**CODE**:
```Properties
# i18n.properties (OData V4)
# Replace the default labels with application-specific titles
T_NEW_OBJECT=New MyApp Item
T_ANNOTATION_HELPER_DEFAULT_HEADER_TITLE_NO_HEADER_INFO=MyApp — Untitled Item
```
--------------------------------

**TITLE**: Change navigation from List Report to Object Page — disable internal or redirect to external app

**INTRODUCTION**: Procedures and manifest.json code snippets to (A) disable built-in navigation from a List Report to an Object Page, and (B) replace internal navigation with intent-based external navigation. Includes examples for SAP Fiori Elements OData V2 and OData V4 and the required sap.app crossNavigation outbounds entries.

**TAGS**: fiori-elements-framework, sapui5, manifest.json, navigation, odata-v2, odata-v4, intent-based-navigation, crossNavigation, object-page, list-report

STEP: 1 — Disable internal navigation (OData V2)
DESCRIPTION: Remove the nested "pages" block under sap.ui.generic.app.pages that defines the ObjectPage. Deleting that block disables navigation from the List Report to the Object Page (no external references required).
LANGUAGE: JSON
CODE:
```json
// BEFORE: manifest.json fragment with internal navigation (remove nested "pages" to disable)
{
  "sap.ui.generic.app": {
    "pages": [{
      "entitySet": "Zfarvd_Bs_Hd_Bo",
      "component": {
        "name": "sap.suite.ui.generic.template.ListReport",
        "list": true,
        "settings": {
          "gridTable": false,
          "hideTableVariantManagement": false
        }
      },
      // Navigation to detail page — eliminate the nested "pages" block to disable navigation
      "pages": [{
        "entitySet": "Zfarvd_Bs_Hd_Bo",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      }]
    }]
  }
}

// AFTER: manifest.json fragment with internal navigation removed (navigation disabled)
{
  "sap.ui.generic.app": {
    "pages": [{
      "entitySet": "Zfarvd_Bs_Hd_Bo",
      "component": {
        "name": "sap.suite.ui.generic.template.ListReport",
        "list": true,
        "settings": {
          "gridTable": false,
          "hideTableVariantManagement": false
        }
      }
      // No nested "pages" entry => no navigation to ObjectPage
    }]
  }
}
```

STEP: 2 — Disable internal navigation (OData V4)
DESCRIPTION: In OData V4 apps using sap.ui5.routing.targets, remove the "navigation" section from the corresponding target (ListReport or ObjectPage) to prevent internal navigation to an ObjectPage/subobject page.
LANGUAGE: JSON
CODE:
```json
// BEFORE: target includes a "navigation" configuration enabling internal subobject navigation
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "ArtistList": {
          "options": {
            "settings": {
              "contextPath": "/Artists",
              "navigation": {
                "Artists": {
                  "detail": {
                    "route": "ArtistObjectPage"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}

// AFTER: "navigation" removed from the target to disable internal navigation
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "ArtistList": {
          "options": {
            "settings": {
              "contextPath": "/Artists"
              // navigation removed => no internal navigation to ArtistObjectPage
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — Enable external (intent-based) navigation from List Report to Object Page (OData V2)
DESCRIPTION: Add an outbounds entry under sap.app.crossNavigation.outbounds and reference it from the ObjectPage entry under sap.ui.generic.app.pages via a "navigation.display" block. The "path" must point to the sap.app.crossNavigation.outbounds location and "target" must match the outbound key.
LANGUAGE: JSON
CODE:
```json
// sap.app: define an outbound intent for external navigation
{
  "sap.app": {
    "_version": "1.2.0",
    "crossNavigation": {
      "inbounds": {},
      "outbounds": {
        "ExampleNavigationTarget": {
          "semanticObject": "EPMProduct",
          "action": "manage_st"
        }
      }
    }
  }
}

// sap.ui.generic.app: reference the outbound intent from the ObjectPage entry
{
  "sap.ui.generic.app": {
    "_version": "1.2.0",
    "pages": [{
      "entitySet": "STTA_C_MP_Product",
      "component": {
        "name": "sap.suite.ui.generic.template.ListReport",
        "list": true
      },
      "pages": [{
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        },
        // Redirect internal navigation to the external outbound defined above
        "navigation": {
          "display": {
            "path": "sap.app.crossNavigation.outbounds",
            "target": "ExampleNavigationTarget"
          }
        }
      }]
    }]
  }
}
```

STEP: 4 — Enable external (intent-based) navigation from ObjectPage/subobject (OData V4)
DESCRIPTION: For OData V4, add an outbound in sap.app.crossNavigation.outbounds and update sap.ui5.routing.targets.options.settings.navigation for the relevant target. You can use either a "detail" => "outbound" mapping or a "display" mapping that points to sap.app.crossNavigation.outbounds. If both are present, "display" takes priority.
LANGUAGE: JSON
CODE:
```json
// sap.app: define outbound intent(s)
{
  "sap.app": {
    "crossNavigation": {
      "outbounds": {
        "ProductDetails": {
          "semanticObject": "ProductDetails",
          "action": "manage"
        }
      }
    }
  }
}

// sap.ui5: routing snippet that replaces internal subobject navigation with external outbound
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": ":?query:",
          "name": "ArtistList",
          "target": "ArtistList"
        },
        {
          "pattern": "Artists({key}):?query:",
          "name": "ArtistDetail",
          "target": "ArtistObjectPage"
        }
      ],
      "targets": {
        "ArtistList": {
          "type": "Component",
          "id": "ArtistList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/Artists",
              "navigation": {
                "Artists": {
                  "detail": {
                    "route": "ArtistObjectPage"
                  }
                }
              }
            }
          }
        },
        "ArtistObjectPage": {
          "type": "Component",
          "id": "ArtistDetail",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "contextPath": "/Artists",
              "_tableType": "Table",
              "navigation": {
                "_Publication": {
                  "detail": {
                    // Use "outbound" to point to the outbound key, triggers external navigation instead of internal subobject
                    "outbound": "ProductDetails"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Alternative OData V4 mapping using "display" (preferred if present)
DESCRIPTION: Use a "display" mapping to point to sap.app.crossNavigation.outbounds; when both "display" and "detail" are provided, "display" takes priority. This variant references the outbound by path + target.
LANGUAGE: JSON
CODE:
```json
// navigation.display example inside a target's settings
{
  "navigation": {
    "_Publication": {
      "display": {
        "path": "sap.app.crossNavigation.outbounds",
        "target": "ProductDetails"
      }
    }
  }
}
```

STEP: 6 — Validation notes and prerequisites
DESCRIPTION:
- Ensure the path used in "display.path" is correct: sap.app.crossNavigation.outbounds (or sap.apps.crossNavigation.outbounds for some older examples); verify the exact location in your manifest.
- The "target" or "outbound" value must exactly match an existing key under sap.app.crossNavigation.outbounds.
- Examples for OData V2 may reference sap.ui.generic.app->_version 1.2.0. Adjust versions/keys according to your app manifest schema.
--------------------------------

**TITLE**: Analytical Chart Cards for Overview Pages (OVP) — Configuration Examples

**INTRODUCTION**: Practical, code-focused examples and notes for adding analytical (chart) cards to SAP Fiori Overview Pages (OVP). Includes manifest.json card configuration and OData annotation snippets to define measures, dimensions, and chart type. Also highlights automatic height and legend behavior.

**TAGS**: fiori-elements-framework, overview-page, ovp, chart-card, analytical-card, manifest.json, annotations, OData, UI.Chart

**STEP**: 1 — Add an analytical chart card to the Overview Page manifest

**DESCRIPTION**: Add a card entry under the OVP section of your application's manifest.json. Use the chart-card template and configure entitySet, chartType, measures and dimensions in settings (or reference annotationPath for annotation-driven configuration). The example below shows a self-contained settings-driven card and an annotation-driven card (using annotationPath).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "Sales_Analytical_Card": {
        "template": "sap.ovp.cards.charts.analytical",
        "title": "Sales by Region",
        "model": "odata",
        "settings": {
          "entitySet": "SalesOrders",
          "chartType": "column",        // supported: "column", "stackedColumn", "bar", "line", "area", "pie"
          "measures": [
            { "property": "Revenue", "label": "Revenue" },
            { "property": "Quantity", "label": "Quantity" }
          ],
          "dimensions": [
            { "property": "SalesRegion", "label": "Region" }
          ],
          "showLegend": true
        }
      },

      "Sales_Analytical_Card_AnnotationDriven": {
        "template": "sap.ovp.cards.charts.analytical",
        "title": "Sales (Annotation-driven)",
        "model": "odata",
        "annotationPath": "/Annotations/Namespace.SalesOrder"  // OData annotation target path (see step 2)
      }
    }
  }
}
```

**STEP**: 2 — Define chart measures and dimensions via OData annotations (XML)

**DESCRIPTION**: For annotation-driven cards, expose the chart metadata in the service metadata (annotations XML). Use the com.sap.vocabularies.UI.v1.Chart annotation to declare ChartType, Measures and Dimensions. The card's manifest annotationPath should point to the annotation target or the annotation term.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="Namespace.SalesOrder">
  <Annotation Term="com.sap.vocabularies.UI.v1.Chart">
    <Record>
      <!-- Chart types are enumerations, example uses Column -->
      <PropertyValue Property="ChartType" EnumMember="com.sap.vocabularies.UI.v1.ChartType/Column" />

      <!-- Define measures (value-bearing properties) -->
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>Revenue</PropertyPath>
          <PropertyPath>Quantity</PropertyPath>
        </Collection>
      </PropertyValue>

      <!-- Define dimension(s) used to group/segment the chart -->
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>SalesRegion</PropertyPath>
        </Collection>
      </PropertyValue>

      <!-- Optional: provide a semantic title for the chart -->
      <PropertyValue Property="Title" String="Sales by Region" />
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 3 — Important runtime behavior and visual notes

**DESCRIPTION**: Use these notes programmatically and in UI tests to set expectations about layout and rendering.

**LANGUAGE**: plain text

**CODE**:
```text
- Height: Analytical chart cards do NOT have a fixed height. The runtime automatically adjusts the card height to accommodate rendered data points and legends. Do not hard-code heights in the card definition.

- Legends: Legends are created automatically based on defined measures and dimensions. Use `showLegend: true|false` in settings or omit to rely on default behavior.

- Chart types: Supported types include ("column", "stackedColumn", "bar", "line", "area", "pie") — verify available types for your OVP version.

- Data source: Ensure the entitySet provided in manifest settings (or referenced in annotations) returns the properties used in Measures and Dimensions.

- Annotation vs settings: Use settings for quick card-local configuration. Use annotation-driven approach for centralized metadata and reuse across pages.
```

**STEP**: 4 — Example: Minimal annotation + manifest pairing (end-to-end)

**DESCRIPTION**: Minimal end-to-end example connecting manifest entry to OData chart annotation. Use this as a drop-in template and adapt entitySet/property names to your service.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "SalesChart": {
        "template": "sap.ovp.cards.charts.analytical",
        "title": "Sales Overview",
        "model": "odata",
        "annotationPath": "/Annotations/Namespace.SalesOrder" 
      }
    }
  }
}
```

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="Namespace.SalesOrder">
  <Annotation Term="com.sap.vocabularies.UI.v1.Chart">
    <Record>
      <PropertyValue Property="ChartType" EnumMember="com.sap.vocabularies.UI.v1.ChartType/Column" />
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>Revenue</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>SalesRegion</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Title" String="Sales by Region" />
    </Record>
  </Annotation>
</Annotations>
```
--------------------------------

**TITLE**: Chart Extensions for Analytical List Page (OData V2)

**INTRODUCTION**: Configure a controller extension for the Analytical List Page (ALP) to implement onBeforeRebindChartExtension. Use this to inject custom filters or modify chart binding parameters before the chart rebinds. Applicable only to SAP Fiori elements for OData V2.

**TAGS**: fiori-elements-framework, ALP, chart, onBeforeRebindChartExtension, manifest.json, controllerExtensions, OData V2

**STEP**: 1 — Add controller extension in manifest.json

**DESCRIPTION**: Add a controller extension for the ALP view by extending sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage in the "sap.ui5" -> "extends" -> "extensions" -> "sap.ui.controllerExtensions" section. Set controllerName to your extension controller namespace.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "_version": "1.1.0",
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
            "controllerName": "sap.poc.ftu.apps.alr.ext.controller.AnalyticalListPageExt",
            "sap.ui.generic.app": {
              "...": "..."
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Create the extension controller module

**DESCRIPTION**: Implement the controller referenced in manifest.json. Create the file at:
webapp/ext/controller/AnalyticalListPageExt.controller.js
Use the onBeforeRebindChartExtension event to access and modify binding parameters (oEvent.getParameter("bindingParams")). The example below shows two variants: a simple log/alert and a practical example that appends a custom filter to the chart binding.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define([
  "sap/ui/model/Filter",
  "sap/ui/model/FilterOperator"
], function (Filter, FilterOperator) {
  "use strict";

  return {
    /**
     * Triggered by ALP before the chart is rebound.
     * oEvent.getParameter("bindingParams") contains the binding configuration for the chart.
     *
     * @param {sap.ui.base.Event} oEvent
     */
    onBeforeRebindChartExtension: function (oEvent) {
      // SIMPLE: debug notification
      // alert('onBeforeRebindChartExtension called!');

      // PRACTICAL: modify the binding params to add a custom filter
      var oBindingParams = oEvent.getParameter("bindingParams");
      if (!oBindingParams) {
        // nothing to do if bindingParams is missing
        return;
      }

      // Ensure filters array exists
      oBindingParams.filters = oBindingParams.filters || [];

      // Example: add a filter on property "CustomProperty" equals "MyValue"
      var oCustomFilter = new Filter("CustomProperty", FilterOperator.EQ, "MyValue");
      oBindingParams.filters.push(oCustomFilter);

      // Optionally modify other binding parameters, e.g. urlParameters or select
      // oBindingParams.parameters = oBindingParams.parameters || {};
      // oBindingParams.parameters.$select = "Prop1,Prop2,CustomProperty";
    }
  };
});
```

**STEP**: 3 — How to access binding data and controls

**DESCRIPTION**: The event object passed to onBeforeRebindChartExtension allows you to:
- Read/modify binding params: oEvent.getParameter("bindingParams")
- Access the chart control that triggered the rebind via oEvent.getSource() or inspect oEvent.getParameter(...) as provided by ALP
Use these to add filters, change select/$expand, or supply custom query parameters before the chart fetch.

**LANGUAGE**: Text

**CODE**:
```text
- binding params: oEvent.getParameter("bindingParams")
- chart control: oEvent.getSource()
- add filters: oBindingParams.filters.push(new Filter(...))
- modify select: oBindingParams.parameters = oBindingParams.parameters || {}; oBindingParams.parameters.$select = "..."
```

**STEP**: 4 — Related information

**DESCRIPTION**: Reference documentation for broader ALP extension patterns.

**LANGUAGE**: Markdown

**CODE**:
```markdown
Configuring Analytical List Page App Extensions:
https://<your-docs-root>/configuring-analytical-list-page-app-extensions-9504fb4.md
```
--------------------------------

**TITLE**: Checking Folder Structure and Project Artifacts for SAP Fiori Elements (OData V2)

**INTRODUCTION**: Quick checklist and code-focused examples to verify the generated Fiori elements project artifacts after generation (List Report + Object Page, OData V2). Use these steps to inspect folder layout, Component.js, manifest.json (service & annotation links), local test resources, preview destination configuration (ui5*.yaml), and i18n localization resources.

**TAGS**: fiori-elements-framework, sapui5, odata-v2, manifest.json, Component.js, ui5, ui5.yaml, i18n, localService

**STEP**: 1 — Verify folder structure for List Report + Object Page

**DESCRIPTION**: Confirm the generated webapp structure and presence of required files (Component.js, manifest.json, webapp/views, webapp/localService, webapp/i18n, images). Example tree output for a typical generated project.

**LANGUAGE**: text

**CODE**:
```text
project-root/
├─ webapp/
│  ├─ Component.js
│  ├─ manifest.json
│  ├─ index.html
│  ├─ controller/
│  │  └─ Main.controller.js
│  ├─ view/
│  │  ├─ ListReport.view.xml
│  │  └─ ObjectPage.view.xml
│  ├─ localService/
│  │  ├─ metadata.xml
│  │  └─ SEPMRA_PROD_MAN_ANNO_MDL.xml
│  ├─ i18n/
│  │  └─ i18n.properties
│  └─ images/
│     └─ <icons>.png
├─ ui5*.yaml         # ui5-local.yaml / ui5.yaml for preview/destination config
└─ package.json
```

**STEP**: 2 — Inspect Component.js (do not edit)

**DESCRIPTION**: The auto-generated Component.js bootstraps the app and delegates configuration to manifest.json. Do not modify this file. Use it only to verify the app id and component extension.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/Component.js (auto-generated - do NOT edit)
sap.ui.define(["sap/ui/core/UIComponent"], function(UIComponent) {
  "use strict";
  return UIComponent.extend("my.namespace.Component", {
    metadata: {
      manifest: "json"
    },
    init: function() {
      UIComponent.prototype.init.apply(this, arguments);
      // runtime behavior is configured in manifest.json
    }
  });
});
```

**STEP**: 3 — Check manifest.json: service, dataSources, and annotations

**DESCRIPTION**: Open webapp/manifest.json and verify:
- dataSources under "sap.app" contain your main OData service URI and localUri for metadata
- the "annotations" array lists local annotation files first if present (local precedence)
- the default model in "sap.ui5.models" references the dataSource name

Use the sample minimal structure below to compare.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "my.namespace",
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/SEPMRA_PROD_MAN_SRV/",
        "type": "OData",
        "settings": {
          "localUri": "localService/metadata.xml",
          "annotations": [
            "localService/SEPMRA_PROD_MAN_ANNO_MDL.xml",
            "https://example.com/annotations/SEPMRA_PROD_MAN_ANNO_MDL.xml"
          ]
        }
      }
    }
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      }
    }
  }
}
```

**STEP**: 4 — Verify localService test resources and annotation precedence

**DESCRIPTION**: Confirm presence of localService/metadata.xml and any local annotation files (e.g., SEPMRA_PROD_MAN_ANNO_MDL.xml or annotations.xml). If a local annotations file is present and referenced first in manifest.json annotations array, it will take precedence over backend annotations during local testing.

**LANGUAGE**: text

**CODE**:
```text
# Expected files for local testing
webapp/localService/metadata.xml
webapp/localService/SEPMRA_PROD_MAN_ANNO_MDL.xml
# If you add webapp/localService/annotations.xml and reference it first in manifest.json,
# it will override backend annotations in local preview.
```

**STEP**: 5 — Inspect ui5*.yaml for preview destination configuration

**DESCRIPTION**: Preview destinations used by the Fiori tools are stored in ui5-local.yaml or ui5.yaml (project root). Open the ui5*.yaml and verify "destinations" configuration (destination name → target URL). Adapt run configuration in the Fiori extension if needed.

**LANGUAGE**: YAML

**CODE**:
```yaml
# Example ui5-local.yaml (ui5*.yaml) structure for preview destinations
server:
  destinations:
    - name: SEPMRA_BACKEND
      url: "https://backend.example.com"
      forwardAuthToken: true
    - name: SAP_GATEWAY
      url: "https://sap.gateway.example.com"
```

**STEP**: 6 — Use Run Configurations and start local preview

**DESCRIPTION**: Use the VS Code command palette to open and adapt run configurations for preview. Typical commands and npm start patterns for local UI5 preview servers.

**LANGUAGE**: text

**CODE**:
```text
# Use the Fiori Tools command in VS Code:
# Command Palette -> "Fiori: Open Run Configurations"
# Adapt destination names or URLs as needed in the opened run config.

# Common local run commands (project root)
npm install
npm start          # starts the local UI5 preview server (if defined in package.json)
# OR
npm run start
```

**STEP**: 7 — Check and use i18n properties for localization

**DESCRIPTION**: Verify i18n properties exist and are referenced in manifest.json. Use i18n to maintain UI texts.

**LANGUAGE**: text / properties

**CODE**:
```text
# File: webapp/i18n/i18n.properties
# Example entries
appTitle=My App Title
listReportTitle=Products List
objectPageTitle=Product Details

# Manifest reference (snippet)
# "sap.app": {...},
# "sap.ui5": {
#   "models": {
#     "i18n": {
#       "type": "sap.ui.model.resource.ResourceModel",
#       "settings": {
#         "bundleName": "my.namespace.i18n.i18n"
#       }
#     }
#   }
# }
```
--------------------------------

**TITLE**: Configuring Filter Modes and Visual Filters for Analytical List Page (ALP)

**INTRODUCTION**: Practical, code-focused guidance to configure ALP filter modes (visual and compact), synchronize filters between modes, and define visual-filter charts (OData V2 annotation examples). Use these steps to decide where a filter dimension appears, implement annotations that drive visual filters, and allow users to change chart type, measure, and sort order.

**TAGS**: fiori-elements-framework, analytical-list-page, visual-filter, compact-filter, annotations, OData V2, SelectionPresentationVariant, Chart

**STEP**: 1 — Decide filter placement and expected runtime behavior

**DESCRIPTION**: Determine for each filter dimension whether it should appear in:
- Visual filter (chart-based filter) — will also appear in compact filter at runtime.
- Compact filter only — for fields without visual filter configuration.

Behavior rules to encode into tests and UI expectations:
- A field configured for a visual filter always appears in compact filter mode as well.
- Fields that are only in compact filters (no visual config) are not shown as visual filters.
- Toggling between visual and compact modes must keep filter values synchronized.
- When in visual-filter mode, all compact-filter values (including those with no visual counterpart) are applied to the main content area.

**LANGUAGE**: plain

**CODE**:
```text
Decide mapping for each dimension:
- country => visual + compact
- salesRegion => compact only
- productCategory => visual + compact
- orderDate => compact only

Add tests:
- Toggle mode => visual inputs reflect compact values and vice versa
- Visual mode active => content list uses all compact filters
- Filter selection count increments per field selected (not per value)
```

**STEP**: 2 — Add Selection/Presentation annotations (OData V2) to expose fields to filters

**DESCRIPTION**: Ensure filter fields are present in the service metadata using SelectionVariant / SelectionPresentationVariant annotations so both ALP filter bars can surface them. Provide SelectionFields for compact filters and reference presentation/visualization annotations for visual filters.

Use the following skeletons in your service metadata (Annotations XML). Replace placeholders (EntityTypeName, PropertyName, ChartAnnotationName) with your actual names.

**LANGUAGE**: XML (OData V2 annotation snippet)

**CODE**:
```xml
<!-- Add SelectionPresentationVariant (references SelectionVariant and PresentationVariant) -->
<Annotations Target="YourService.YourEntityType">
  <!-- Selection variant: the fields available in the compact filter -->
  <Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant" Qualifier="CompactFilter">
    <Record>
      <PropertyValue Property="SelectOptions">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.SelectOption">
            <PropertyValue Property="PropertyName" String="Country"/>
          </Record>
          <Record Type="com.sap.vocabularies.UI.v1.SelectOption">
            <PropertyValue Property="PropertyName" String="OrderDate"/>
          </Record>
          <!-- Add other compact filter fields -->
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <!-- Presentation + visual filter linkage -->
  <Annotation Term="com.sap.vocabularies.UI.v1.SelectionPresentationVariant" Qualifier="ALPSelectionPresentation">
    <Record>
      <PropertyValue Property="SelectionVariant" Path="YourService.YourEntityType/SelectionVariant#CompactFilter"/>
      <PropertyValue Property="PresentationVariant" Path="YourService.YourEntityType/PresentationVariant#ALPPresentation"/>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 3 — Define visual-filter charts (OData V2 Chart annotation examples)

**DESCRIPTION**: For each visual filter chart, add a Chart annotation that defines chart type (bar/column, donut, line), measures, dimensions, and sort order. These charts are used by the ALP visual filter panel. The example shows common properties; adjust ChartType enum members and property names to match your metadata vocabulary.

**LANGUAGE**: XML (OData V2 annotation snippet)

**CODE**:
```xml
<Annotations Target="YourService.YourEntityType">
  <!-- Example chart annotation for a visual filter -->
  <Annotation Term="com.sap.vocabularies.UI.v1.Chart" Qualifier="SalesByCountryChart">
    <Record>
      <PropertyValue Property="Title" String="Sales by Country"/>
      <!-- ChartType values: Column (bar), Donut, Line -->
      <PropertyValue Property="ChartType" EnumMember="com.sap.vocabularies.UI.v1.ChartType/Column"/>
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>TotalRevenue</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>Country</PropertyPath>
        </Collection>
      </PropertyValue>
      <!-- optional: define default sorting for the visual filter -->
      <PropertyValue Property="SortOrder">
        <Collection>
          <Record>
            <PropertyValue Property="Property" PropertyPath="TotalRevenue"/>
            <PropertyValue Property="Descending" Bool="true"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <!-- Reference the chart in the PresentationVariant or Visualization facet used by the ALP -->
  <Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant" Qualifier="ALPPresentation">
    <Record>
      <PropertyValue Property="Visualizations">
        <Collection>
          <AnnotationPath>com.sap.vocabularies.UI.v1.Chart#SalesByCountryChart</AnnotationPath>
          <!-- Add more charts (donut, line) as needed -->
        </Collection>
      </PropertyValue>
      <!-- Optional: other presentation settings -->
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 4 — Allow runtime adjustments (chart type, measure, sort order) in ALP (OData V2)

**DESCRIPTION**: ALP supports changing chart type, measure, and sort order at runtime for visual filters. To enable this, provide multiple Chart annotations or ensure the application UI allows users to switch measures and chart types. The UI will present bar, donut, and line options. Provide chart alternatives as separate Chart annotations or expose measure properties that the ALP UI can switch between.

**LANGUAGE**: XML (OData V2 examples)

**CODE**:
```xml
<!-- Additional chart annotations for runtime chart-type / measure options -->
<Annotation Term="com.sap.vocabularies.UI.v1.Chart" Qualifier="SalesByCountry_Donut">
  <Record>
    <PropertyValue Property="Title" String="Sales by Country (Donut)"/>
    <PropertyValue Property="ChartType" EnumMember="com.sap.vocabularies.UI.v1.ChartType/Donut"/>
    <PropertyValue Property="Measures">
      <Collection>
        <PropertyPath>TotalRevenue</PropertyPath>
        <!-- Optionally include alternative measures for runtime switching -->
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Dimensions">
      <Collection>
        <PropertyPath>Country</PropertyPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>

<!-- Present all visual options in the PresentationVariant Visualizations collection -->
<Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant" Qualifier="ALPPresentation">
  <Record>
    <PropertyValue Property="Visualizations">
      <Collection>
        <AnnotationPath>com.sap.vocabularies.UI.v1.Chart#SalesByCountryChart</AnnotationPath>
        <AnnotationPath>com.sap.vocabularies.UI.v1.Chart#SalesByCountry_Donut</AnnotationPath>
        <!-- Line chart annotation path if defined -->
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 5 — Customize filter bar layout and user-exposed filters (Adapt Filters)

**DESCRIPTION**: The "Adapt Filters" action in the ALP header lets end users and adaptors show/hide and reorder filter fields and visual filters. Ensure your annotation selection fields align with what you want users to be able to add/remove. Remember:
- The filter selection count is based on number of fields selected (not field values).
- Filters applied via the filter dialog that are not visible on the filter bar still count toward the selection count.

**LANGUAGE**: plain

**CODE**:
```text
UX steps for Adapt Filters:
- Open ALP header > "Adapt Filters (n)"
- Add/remove fields listed from SelectionVariant/SelectionFields
- Reorder visual filters if enabled
- Save variant (if using variant management)

Developer checklist:
- Ensure SelectionVariant exposes all fields you want available in Adapt Filters.
- If a field must be hidden from Adapt Filters, remove it from the SelectionVariant.
```

**STEP**: 6 — Verification checklist and runtime test cases

**DESCRIPTION**: Validate configuration with the checklist and automated tests.

**LANGUAGE**: plain

**CODE**:
```text
Verification checklist:
- Visual filter fields appear in the visual filter panel and also in compact filter.
- Compact-only fields do not appear in visual panel.
- Toggling between modes preserves values (synchronization).
- Visual mode applies all compact-filter values to the main content list.
- Users can switch chart type (bar/donut/line) and change measure & sort order (if multiple Chart annotations or measures provided).
- Filter selection count increments per selected field (including hidden dialog filters).
```

--------------------------------

**TITLE**: Coloring Column Chart Cards by Threshold Values (Fiori Elements / OVP)

**INTRODUCTION**: Use DataPoint threshold annotations for the measure used in an overview page column chart (OVP) so the chart is semantically colored (Positive/Neutral/Critical/Negative). Prefer a single measure per chart. The threshold comparisons use the existing ThresholdValues tokens: ThresholdValues.DeviationRangeLowValue, ThresholdValues.ToleranceRangeLowValue, ThresholdValues.ToleranceRangeHighValue, ThresholdValues.DeviationRangeHighValue. Implement these thresholds in your annotation format (CDS / JSON / XML) to enable semantic coloring and legend entries.

**TAGS**: fiori-elements, ovp, semantic-coloring, data-point, threshold, annotations, CDS, OData

**STEP**: 1 — Choose measure and improvement direction

**DESCRIPTION**: Configure the analytic card to use a single measure for best results. Set the measure's ImprovementDirection to indicate how values should be interpreted:
- Maximizing: higher is better (e.g., sales)
- Minimizing: lower is better (e.g., cost)
- Target: preferred range (e.g., temperature)

Set ImprovementDirection in your DataPoint annotation (CDS / JSON / XML) for the measure used in the chart.

**LANGUAGE**: CDS (annotation example)

**CODE**:
```CDS
// Conceptual CDS annotation for the measure used in the card
// Replace <Entity>, <MeasureField>, and <ThresholdValues.*> with real names/paths.
entity <Entity> {
  @Analytics.measure: true
  <MeasureField> : Decimal(15,2);
}

// DataPoint annotation attached to the measure or to the semantic key used by the chart
annotate <Entity> with {
  @UI.DataPoint: {
    Value: { Path: '<MeasureField>' },
    // ImprovementDirection: Maximize | Minimize | Target
    ImprovementDirection: #Maximize      // or #Minimize, or #Target
    // Thresholds configured separately (see next steps)
  }
}
```

**STEP**: 2 — Target measure: threshold mapping (preferred-range semantics)

**DESCRIPTION**: For a Target measure (preferred within a range), map the thresholds according to the table:
- Negative -> Critical when Measure >= ThresholdValues.DeviationRangeLowValue
- Critical -> Positive when Measure >= ThresholdValues.ToleranceRangeLowValue
- Positive -> Critical when Measure > ThresholdValues.ToleranceRangeHighValue
- Critical -> Negative when Measure > ThresholdValues.DeviationRangeHighValue

Provide these conditions in your annotation's Thresholds collection (adapt to CDS/JSON/XML).

**LANGUAGE**: JSON (conceptual OData annotation payload)

**CODE**:
```json
{
  "com.sap.vocabularies.UI.v1.DataPoint": {
    "Value": { "Path": "Temperature" },
    "ImprovementDirection": "Target",
    "Thresholds": [
      {
        "Label": "Negative->Critical",
        "Comparison": ">=",
        "Value": "ThresholdValues.DeviationRangeLowValue",
        "Semantic": "Critical"
      },
      {
        "Label": "Critical->Positive",
        "Comparison": ">=",
        "Value": "ThresholdValues.ToleranceRangeLowValue",
        "Semantic": "Positive"
      },
      {
        "Label": "Positive->Critical",
        "Comparison": ">",
        "Value": "ThresholdValues.ToleranceRangeHighValue",
        "Semantic": "Critical"
      },
      {
        "Label": "Critical->Negative",
        "Comparison": ">",
        "Value": "ThresholdValues.DeviationRangeHighValue",
        "Semantic": "Negative"
      }
    ]
  }
}
```

**STEP**: 3 — Maximizing measure: threshold mapping (higher is better)

**DESCRIPTION**: For a Maximizing measure, use the mapping below:
- Negative -> Critical when Measure >= ThresholdValues.DeviationRangeLowValue
- Critical -> Positive when Measure >= ThresholdValues.ToleranceRangeLowValue

Only the lower bounds are needed for maximizing semantics.

**LANGUAGE**: JSON (conceptual OData annotation payload)

**CODE**:
```json
{
  "com.sap.vocabularies.UI.v1.DataPoint": {
    "Value": { "Path": "Sales" },
    "ImprovementDirection": "Maximize",
    "Thresholds": [
      {
        "Label": "Negative->Critical",
        "Comparison": ">=",
        "Value": "ThresholdValues.DeviationRangeLowValue",
        "Semantic": "Critical"
      },
      {
        "Label": "Critical->Positive",
        "Comparison": ">=",
        "Value": "ThresholdValues.ToleranceRangeLowValue",
        "Semantic": "Positive"
      }
    ]
  }
}
```

**STEP**: 4 — Minimizing measure: threshold mapping (lower is better)

**DESCRIPTION**: For a Minimizing measure, use the mapping below:
- Positive -> Critical when Measure > ThresholdValues.ToleranceRangeHighValue
- Critical -> Negative when Measure > ThresholdValues.DeviationRangeHighValue

Only the upper bounds are needed for minimizing semantics.

**LANGUAGE**: JSON (conceptual OData annotation payload)

**CODE**:
```json
{
  "com.sap.vocabularies.UI.v1.DataPoint": {
    "Value": { "Path": "Cost" },
    "ImprovementDirection": "Minimize",
    "Thresholds": [
      {
        "Label": "Positive->Critical",
        "Comparison": ">",
        "Value": "ThresholdValues.ToleranceRangeHighValue",
        "Semantic": "Critical"
      },
      {
        "Label": "Critical->Negative",
        "Comparison": ">",
        "Value": "ThresholdValues.DeviationRangeHighValue",
        "Semantic": "Negative"
      }
    ]
  }
}
```

**STEP**: 5 — Implementation notes and legend behavior

**DESCRIPTION**: Important behaviors to implement/consider:
- Recommendation: configure only one measure in the chart if you want clear semantic coloring and meaningful legends.
- If multiple measures exist and every measure has valid thresholds and ImprovementDirection, each measure will be colored according to its own thresholds; chart legend will show generic good/bad/neutral entries and might be less descriptive.
- If some measures lack thresholds or improvement direction, those measures will render in default (black); measures with thresholds will still be semantically colored.
- Ensure ThresholdValues.* tokens are defined/available in the data model or annotation context and referenced exactly as:
  - ThresholdValues.DeviationRangeLowValue
  - ThresholdValues.ToleranceRangeLowValue
  - ThresholdValues.ToleranceRangeHighValue
  - ThresholdValues.DeviationRangeHighValue

**LANGUAGE**: Plain (check / adapt to your annotation syntax)

**CODE**:
```text
// Checklist before deploying semantic coloring:
1. Use one primary measure in the chart where possible.
2. Set ImprovementDirection correctly: Maximize | Minimize | Target.
3. Reference ThresholdValues.* tokens exactly as defined in your model.
4. Map Threshold comparisons (>= or >) to semantic outcomes per the examples above.
5. Validate the legend behavior in multi-measure scenarios and adjust measures/annotations if necessary.
```
--------------------------------

**TITLE**: Column Chart Card — rules, annotations, and example config

**INTRODUCTION**: Short reference for implementing a Column Chart Card in Fiori (Overview Page / Fiori elements). Describes annotation rules (measures/dimensions mapping), minimum requirements, and provides actionable annotation and manifest code examples (OData V4 XML, OData JSON, CDS, and an Overview Page manifest card template). Includes image path for visual reference.

**TAGS**: fiori-elements, overview-page, ovp, chart, column-chart, annotations, UI.Chart, OData, CDS, manifest

**STEP**: 1 — Rules and constraints

**DESCRIPTION**: Summary of chart behavior and constraints that must be respected by annotation authors and card configuration code generators.

**LANGUAGE**: Plain

**CODE**:
```text
- The number of columns in a Column Chart equals the number of measures declared in the chart annotation.
- A Column Chart requires at least:
  - 1 measure (numeric value to be shown as a column)
  - 1 dimension (categorical/time value that becomes the x-axis)
- Every measure in the annotation becomes a separate column, regardless of any 'role' values in other annotations.
- Every dimension defined is placed on the axis category (x-axis), regardless of role values.
- Visual reference image path (preserve for docs and assets):
  ../01_Whats-New/images/WhatsNew_138_OVP_ColumnChart_d3b0ca9.png
```

**STEP**: 2 — OData V4 XML annotation example (UI.Chart)

**DESCRIPTION**: Minimal OData v4 EDMX XML annotation that defines a Column Chart with one dimension and two measures. Use this annotation under the EntityType or directly target the entity set to enable a Column Chart in Fiori elements.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: UI.Chart annotation in EDMX (OData V4 XML) -->
<Annotations Target="MyService.Product">
  <Annotation Term="UI.Chart">
    <Record>
      <!-- ChartType: Column -->
      <PropertyValue Property="ChartType" String="Column" />

      <!-- Dimension(s): values on the x-axis (at least one required) -->
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>Year</PropertyPath>
        </Collection>
      </PropertyValue>

      <!-- Measure(s): each measure becomes a separate column (at least one required) -->
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>SalesAmount</PropertyPath>
          <PropertyPath>ProfitAmount</PropertyPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 3 — OData Annotations JSON example (OData v4 annotations in JSON)

**DESCRIPTION**: Equivalent JSON representation of the UI.Chart annotation for services exposing annotations in JSON format.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "@com.example.MyService.Product": {
    "UI.Chart": {
      "ChartType": "Column",
      "Dimensions": [
        { "$PropertyPath": "Year" }
      ],
      "Measures": [
        { "$PropertyPath": "SalesAmount" },
        { "$PropertyPath": "ProfitAmount" }
      ]
    }
  }
}
```

**STEP**: 4 — CDS (CAP) annotation example

**DESCRIPTION**: Example of adding a chart annotation inside a CDS model (for CAP apps). Place an entity-level @UI.chart annotation that references dimensions and measures from the entity.

**LANGUAGE**: CDS

**CODE**:
```cds
namespace com.example;

entity Product {
  key ID       : UUID;
  Year         : Integer;
  SalesAmount  : Decimal(16,2);
  ProfitAmount : Decimal(16,2);
}

annotate Product with {
  @UI.chart: {
    type: #COLUMN,
    dimensions: [ { value: 'Year' } ],
    measures:   [ { value: 'SalesAmount' }, { value: 'ProfitAmount' } ]
  }
}
```

**STEP**: 5 — Overview Page (OVP) manifest card template (map annotation to card)

**DESCRIPTION**: Template for adding a Column Chart card to an Overview Page manifest. Use this to point the card to the relevant entity and annotation path. Replace service/entity names and annotationPath as required.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "columnChartCard": {
        "model": "mainService",
        "template": "sap.ovp.cards.charts",
        "settings": {
          "title": "Total Product Sales",
          "annotationPath": "Product/@UI.Chart",
          "chartType": "Column"
        }
      }
    }
  }
}
```

**STEP**: 6 — Validation checklist for code generation

**DESCRIPTION**: Quick checks to ensure generated annotations/config are valid for a Column Chart.

**LANGUAGE**: Plain

**CODE**:
```text
- Ensure annotation target points to the correct Entity or EntitySet.
- Ensure ChartType is set to "Column" (or equivalent enum/#COLUMN in CDS).
- Confirm at least one dimension is declared under Dimensions.
- Confirm at least one measure is declared under Measures.
- Remember: additional role properties on measures/dimensions do not change mapping — every measure => separate column; every dimension => x-axis.
- Preserve the image asset path for documentation: ../01_Whats-New/images/WhatsNew_138_OVP_ColumnChart_d3b0ca9.png
```
--------------------------------

**TITLE**: Column Micro Chart — UI.Chart and UI.DataPoint Annotations (XML, ABAP CDS, CAP CDS)

**INTRODUCTION**: This document provides concise, code-focused examples and rules to implement a Column Micro Chart in SAP Fiori Elements using UI.Chart and UI.DataPoint annotations. Use these examples when adding chart annotations in OData XML metadata, ABAP CDS views, or CAP CDS models. Includes required properties, semantic coloring behavior, and a validation checklist.

**TAGS**: fiori-elements-framework, UI.Chart, UI.DataPoint, ColumnMicroChart, CDS, XML, ABAP, CAP, annotations, semantic-coloring

**STEP**: Prerequisites and rules

**DESCRIPTION**: Key rules and constraints to follow when implementing a Column Micro Chart.
- Chart type must be Column: UI.Chart → ChartType = Column.
- Measures and Dimensions cannot come from the same entity; Dimensions must be from a 1:n navigation entity relative to the collection of Measures.
- UI.Chart must include Measures, Dimensions, and MeasureAttributes → DataPoint (annotation path).
- UI.DataPoint must include Value. For semantic coloring either Criticality or CriticalityCalculation may be used; Criticality (explicit value) overrides CriticalityCalculation.
- If using CriticalityCalculation, include ImprovementDirection.

**LANGUAGE**: Text

**CODE**:
```text
Rules:
- UI.Chart.ChartType = Column
- UI.Chart.Measures: at least one PropertyPath to a numeric property
- UI.Chart.Dimensions: PropertyPath to a dimension (from 1:n navigation entity)
- UI.Chart.MeasureAttributes: reference DataPoint using AnnotationPath (e.g. '@UI.DataPoint#Width')
- UI.DataPoint: must define Value (path to measure); can define Criticality or CriticalityCalculation
- Criticality overrides CriticalityCalculation. If using CriticalityCalculation, include ImprovementDirection.
```

**STEP**: UI.Chart — XML Annotation example (OData metadata XML)

**DESCRIPTION**: Add a UI.Chart annotation to the entity type in the OData service metadata XML. This example shows Title, Description, ChartType=Column, Measures, Dimensions, and MeasureAttributes referencing a DataPoint qualifier.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.Chart" Qualifier="SpecificationWidthColumnChart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Product Width Specification Column Chart"/>
        <PropertyValue Property="Description" String="Describe Column Chart"/>
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>Width</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>Day</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="Width"/>
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Width"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: UI.Chart — ABAP CDS Annotation example

**DESCRIPTION**: Annotate an ABAP CDS view with @UI.Chart. Use the qualifier to identify the chart and include measures, dimensions, and measureAttributes referencing the DataPoint (asDataPoint: true).

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Chart: [
  {
    title: 'Product Width Specification Column Chart',
    description: 'Describe Column Chart',
    chartType: #COLUMN,
    measures: [
      'WIDTH'
    ],
    dimensions: [
      'DAY'
    ],
    measureAttributes: [
      {
        measure: 'Width',
        role: #AXIS_1,
        asDataPoint: true
      }
    ],
    qualifier: 'SpecificationWidthColumnChart'
  }
]
annotate view STTA_C_MP_PRODUCT with { }
```

**STEP**: UI.Chart — CAP CDS Annotation example

**DESCRIPTION**: Use CAP CDS model annotations to define a UI.Chart with ChartType Column. Reference the DataPoint via DataPoint property in MeasureAttributes.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.Chart #SpecificationWidthColumnChart : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Product Width Specification Column Chart',
    Description : 'Describe Column Chart',
    ChartType : #Column,
    Measures : [
        Width
    ],
    Dimensions : [
        Day
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Width,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#Width'
        }
    ]
}
```

**STEP**: UI.DataPoint — XML Annotation example

**DESCRIPTION**: Define a UI.DataPoint annotation (qualifier "Width") referenced from UI.Chart.MeasureAttributes.DataPoint. Include Value and Criticality or CriticalityCalculation as needed.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Width">
    <Record>
        <PropertyValue Property="Value" Path="Width"/>
        <PropertyValue Property="Criticality" Path="criticalityValue"/>
    </Record>
</Annotation>
```

**STEP**: UI.DataPoint — ABAP CDS Annotation example

**DESCRIPTION**: ABAP CDS snippet to define a DataPoint on a field. Example shows targetValueElement and criticality mapping. Place next to the field definition in the CDS view.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.dataPoint: {
  targetValueElement: 'Weight',
  criticality: 'criticalityValue'
}
Width;
```

**STEP**: UI.DataPoint — CAP CDS Annotation example

**DESCRIPTION**: CAP CDS model for UI.DataPoint qualifier "Width". Use Value and Criticality or CriticalityCalculation properties.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.DataPoint #Width : {
    Value : Width,
    Criticality : criticalityValue
}
```

**STEP**: Validation checklist for code generation

**DESCRIPTION**: Use this checklist in code generation or validation routines to ensure annotations are correct and complete.
- UI.Chart.ChartType must equal Column.
- UI.Chart.MeasureAttributes must include DataPoint pointing to a UI.DataPoint qualifier.
- UI.DataPoint must include Value.
- If using CriticalityCalculation, ensure CriticalityCalculation and CriticalityCalculation/ImprovementDirection are present; remember explicit Criticality overrides CriticalityCalculation.
- Confirm Measures and Dimensions refer to properties on different entities (1:n navigation relation).
- Ensure the DataPoint qualifier referenced from MeasureAttributes exists in the same metadata namespace.

**LANGUAGE**: Text

**CODE**:
```text
Validation checklist:
1. ChartType == Column
2. Measures defined (PropertyPath list)
3. Dimensions defined (PropertyPath list from 1:n navigation entity)
4. MeasureAttributes contains DataPoint -> '@UI.DataPoint#Qualifier'
5. UI.DataPoint#Qualifier exists and defines Value
6. If using CriticalityCalculation, include ImprovementDirection
7. Explicit Criticality (if present) takes precedence over CriticalityCalculation
```
--------------------------------

**TITLE**: Combination Chart Card

**INTRODUCTION**: Provide a combination chart annotation for Fiori elements (OVP / cards) that combines column + line (or other combos) in a single chart. Use when you need to compare two or more measures across categories (e.g., sales vs. total sales by quarter). The first measure is rendered as columns, subsequent measures are rendered as lines.

**TAGS**: fiori-elements-framework, UI.Chart, combination, chart, OVP, annotation, CDS, ABAP, CAP, XML

**STEP**: 1 — Rules and requirements for Combination Chart
**DESCRIPTION**: Summary of required/recommended rules when authoring a combination chart annotation:
- ChartType must be Combination.
- At least two measures are required.
- The first measure is displayed as columns; subsequent measures are displayed as lines.
- All measures are assigned to the feed UID value axis.
- At least one Category dimension (role = Category) must be present.
- Series dimensions (role = Series) map to color (feed UID) and produce separate colored column+line combinations per series member.
- Recommended: use only one time-based dimension for the category axis.

**LANGUAGE**: XML
**CODE**:
```XML
<!-- Template showing the required properties for a Combination Chart -->
<Annotation Term="UI.Chart" Qualifier="YourQualifier">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Your Chart Title" />
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Combination"/>
    <!-- At least two MeasureAttributes required -->
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="firstMeasure" />
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
        </Record>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="secondMeasure" />
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
        </Record>
        <!-- additional measures allowed -->
      </Collection>
    </PropertyValue>
    <!-- At least one Category dimension required -->
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="categoryDimension" />
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
        </Record>
        <!-- optional Series dimension(s) -->
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 2 — XML Annotation Example (exact syntax for metadata annotations)
**DESCRIPTION**: Copy/paste this exact XML annotation into your annotation file (e.g., annotation XML referenced by your manifest or service metadata annotations). Replace property names (sales, totalsales, quarter_1) and qualifier as needed.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.Chart" Qualifier="Eval_by_Currency_Combination">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Sales and Total Sales" />
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Combination"/>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                        <PropertyValue Property="Measure" PropertyPath="sales" />
                        <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                </Record>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="totalsales" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="DimensionAttributes">
            <Collection>
                <Record Type="UI.ChartDimensionAttributeType">
                    <PropertyValue Property="Dimension" PropertyPath="quarter_1" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 3 — ABAP CDS Annotation Example
**DESCRIPTION**: Use this ABAP CDS-style annotation when annotating an ABAP CDS view. Replace VIEWNAME, field names and qualifier as required.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.Chart: [
  {
    title: 'Sales and Total Sales',
    chartType: #COMBINATION,
    measureAttributes: [
      {
        measure: 'sales',
        role: #AXIS_1
      },
      {
        measure: 'totalsales',
        role: #AXIS_1
      }
    ],
    dimensionAttributes: [
      {
        dimension: 'quarter_1',
        role: #CATEGORY
      }
    ],
    qualifier: 'Eval_by_Currency_Combination'
  }
]
annotate view VIEWNAME with { }
```

**STEP**: 4 — CAP CDS Annotation Example
**DESCRIPTION**: Use this CAP CDS syntax (annotation block) for Node.js CAP or SAP Cloud SDK projects. Replace entity/view names and properties as needed.
**LANGUAGE**: CDS
**CODE**:
```cds
UI.Chart #Eval_by_Currency_Combination : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Sales and Total Sales',
    ChartType : #Combination,
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : sales,
            Role : #Axis1
        },
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : totalsales,
            Role : #Axis1
        }
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : quarter_1,
            Role : #Category
        }
    ]
}
```
--------------------------------

**TITLE**: Comparison Micro Chart — Annotations for SAP Fiori elements (OData V4)

**INTRODUCTION**: This document provides concise, copy-pasteable annotation examples and actionable rules to implement a Comparison Micro Chart (single-measure vs. maximum) in SAP Fiori elements for OData V4. Includes XML, ABAP CDS, and CAP CDS examples for UI.Chart and UI.DataPoint annotations, plus mandatory annotation requirements and runtime behavior notes.

**TAGS**: fiori-elements-framework, ODataV4, UI.Chart, UI.DataPoint, ComparisonMicroChart, annotations, CDS, CAP

STEP: 1 — Requirements & behavior summary

DESCRIPTION: Summary of chart behavior, constraints, and mandatory annotations for implementing a Comparison Micro Chart. Use as a checklist before adding annotations.

LANGUAGE: TEXT

CODE:
```text
- Applicable: SAP Fiori elements for OData V4 only.
- Chart shows a single measure value vs. a maximum value. Only the first 3 values returned by the backend are displayed.
- Dimensions and Measures must NOT be from the same entity; they must come from a 1:n navigation entity.
- Unit of measure (UoM) must be consistent across all data points.
- Semantic coloring: only UI.DataPoint -> Criticality is supported.
- Value vs TextValue: If the measure property has @com.sap.vocabularies.Common.v1.Text, the text is used (TextValue). Otherwise the numeric Value is displayed.
- Mandatory annotations for Comparison Micro Chart:
  * UI.Chart (ChartType must be "Bar")
  * UI.Chart -> Dimensions
  * UI.Chart -> Measures
  * UI.Chart -> MeasureAttributes -> DataPoint (reference to UI.DataPoint)
  * UI.DataPoint -> Value
```

STEP: 2 — UI.Chart XML annotation (qualifier: ComparisonPath)

DESCRIPTION: Add this XML annotation (e.g., in your annotations.xml) to define the chart as a Bar chart, set title/description, set the dimension (SalesOrderItem), bind measure NetAmount and reference DataPoint via qualifier.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.Chart" Qualifier="ComparisonPath">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bar"/>
        <PropertyValue Property="Description" String="Testing Comparison Chart"/>
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>SalesOrderItem</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="NetAmount"/>
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#ComparisonPath"/>
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>NetAmount</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Title" String="Items Comparison Chart"/>
    </Record>
</Annotation>
```

STEP: 3 — UI.Chart ABAP CDS annotation (qualifier: ComparisonPath)

DESCRIPTION: Use this ABAP CDS UI.Chart annotation on your view or in annotate view block to define the comparison chart. Ensure qualifier matches DataPoint qualifier.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.Chart: [
  {
    chartType: #BAR,
    description: 'Testing Comparison Chart',
    dimensions: [ 'SALESORDERITEM' ],
    measureAttributes: [
      {
        measure: 'NetAmount',
        role: #AXIS_1,
        asDataPoint: true            "marks this measure as using a DataPoint (qualifier below)
      }
    ],
    measures: [ 'NETAMOUNT' ],
    title: 'Items Comparison Chart',
    qualifier: 'ComparisonPath'
  }
]
annotate view STTA_C_MP_PRODUCT with { }        "place in your CDS view/context"
```

STEP: 4 — UI.Chart CAP CDS annotation (qualifier: ComparisonPath)

DESCRIPTION: CAP CDS format for the same chart definition. DataPoint is referenced using the annotation path string for the DataPoint qualifier.

LANGUAGE: CDS

CODE:
```cds
UI.Chart #ComparisonPath : {
    $Type : 'UI.ChartDefinitionType',
    ChartType : #Bar,
    Description : 'Testing Comparison Chart',
    Dimensions : [ SalesOrderItem ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : NetAmount,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#ComparisonPath'
        }
    ],
    Measures : [ NetAmount ],
    Title : 'Items Comparison Chart'
}
```

STEP: 5 — UI.DataPoint XML annotation (qualifier: NetAmount)

DESCRIPTION: Define the DataPoint that supplies Value, Criticality, MinimumValue and MaximumValue for the comparison chart. Attach this annotation (e.g., in annotations.xml) and reference it from UI.Chart MeasureAttributes.DataPoint.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="NetAmount">
    <Record Type="UI.DataPointType">
        <PropertyValue Property="Value" Path="NetAmount"/>
        <PropertyValue Property="Criticality" Path="Criticality"/>
        <PropertyValue Property="MaximumValue" Decimal="100"/>
        <PropertyValue Property="MinimumValue" Decimal="0"/>
    </Record>
</Annotation>
```

STEP: 6 — UI.DataPoint ABAP CDS annotation (qualifier: NetAmount)

DESCRIPTION: ABAP CDS style: annotate the field or use a separate @UI.dataPoint annotation block to define criticality and min/max.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.dataPoint: {
  criticality: 'Criticality',
  maximumValue: 100,
  minimumValue: 0
}
NetAmount;
```

STEP: 7 — UI.DataPoint CAP CDS annotation (qualifier: NetAmount)

DESCRIPTION: CAP CDS format for declaring a DataPoint that will be referenced by UI.Chart measure attributes.

LANGUAGE: CDS

CODE:
```cds
UI.DataPoint #NetAmount : {
    Value       : NetAmount,
    Criticality : Criticality,
    MaximumValue: 100,
    MinimumValue: 0
}
```

STEP: 8 — Text vs Value behavior and tips for implementation

DESCRIPTION: Implementation notes to ensure runtime behavior matches expectations. Keep these rules next to your annotation edits.

LANGUAGE: TEXT

CODE:
```text
- If the measure property NetAmount has an associated @com.sap.vocabularies.Common.v1.Text (text property), the chart displays the text (TextValue). Otherwise it displays the numeric Value.
- Ensure MaximumValue and MinimumValue are appropriate for the measure scale and consistent with unit-of-measure.
- Only the first three backend values are displayed by the Comparison Micro Chart; ensure backend OData query ordering/filtering returns the intended top 3 items.
- Dimensions and Measures must come from a 1:n navigation path (e.g., SalesOrder -> SalesOrderItem). Do NOT use dimension and measure from the same single entity record.
- For semantic coloring, set the Criticality property (e.g., mapping to values 1/2/3 or enum) and reference it in UI.DataPoint -> Criticality.
```
--------------------------------

**TITLE**: Configure EntitySet Input Parameters with SelectionVariant (OData V2 / Fiori Elements)

**INTRODUCTION**: This document shows the exact code to configure an EntitySet that requires input parameters using the com.sap.vocabularies.UI.v1.SelectionVariant annotation (OData V2). It includes the OData metadata (EDMX) entity/association setup, the XML annotation for the SelectionVariant, the equivalent CAP CDS annotation, the manifest card configuration for SAP OVP, how to declare an optional parameter, and guidance for multiple cards using analytical parameters.

**TAGS**: fiori-elements-framework, odata-v2, selectionvariant, sap.ovp, annotations, cds, edmx

**STEP**: 1 — Add OData V2 metadata (EDMX): EntityTypes, parameters-type, association, and entity container

**DESCRIPTION**: Add the SalesShare aggregate entity, a parameters-type SalesShareParametersType (sap:semantics="parameters") with navigation to the SalesShare entity, and the EntityContainer entries (SalesShare and SalesShareParameters). SalesShareParameters is non-addressable (sap:addressable="false"). Use this XML as your service metadata (e.g., metadata.xml).

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<edmx:Edmx Version="1.0" xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx" xmlns:sap="http://www.sap.com/Protocols/SAPData">
    <edmx:DataServices xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" m:DataServiceVersion="2.0">
        <Schema Namespace="sap.smartbusinessdemo.services" xmlns:d="http://schemas.microsoft.com/ado/2007/08/dataservices" xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" xmlns="http://schemas.microsoft.com/ado/2008/09/edm">
            <EntityType Name="SalesShareType" sap:semantics="aggregate">
                <Key>
                    <PropertyRef Name="ID" />
                </Key>
                <Property Name="ID" Type="Edm.String" Nullable="false" MaxLength="2147483647" sap:filterable="false" />
                <Property Name="Country" Type="Edm.String" MaxLength="3" sap:label="Country" sap:aggregation-role="dimension" />
                <Property Name="Region" Type="Edm.String" MaxLength="4" sap:label="Region" sap:aggregation-role="dimension" />
                <Property Name="ProductID" Type="Edm.String" MaxLength="10" sap:label="Product ID" sap:aggregation-role="dimension" />
                <Property Name="Currency" Type="Edm.String" MaxLength="5" sap:label="Currency" sap:aggregation-role="dimension" />
                <Property Name="Product" Type="Edm.String" MaxLength="1024" sap:label="Product" sap:aggregation-role="dimension" />
                <Property Name="SupplierCompany" Type="Edm.String" MaxLength="80" sap:label="Supplier Company" sap:aggregation-role="dimension" />
                <Property Name="BuyerCompany" Type="Edm.String" MaxLength="80" sap:label="Buyer Company" sap:aggregation-role="dimension" />
                <Property Name="Year" Type="Edm.String" MaxLength="4" sap:label="Year" sap:aggregation-role="dimension" />
                <Property Name="Quarter" Type="Edm.String" MaxLength="2" sap:label="Quarter" sap:aggregation-role="dimension" />
                <Property Name="Month" Type="Edm.String" MaxLength="2" sap:label="Month" sap:aggregation-role="dimension" />
                <Property Name="TotalSales_CURRENCY" Type="Edm.String" MaxLength="5" sap:semantics="currency-code" />
                <Property Name="Sales_CURRENCY" Type="Edm.String" MaxLength="5" sap:semantics="currency-code" />
                <Property Name="TotalSales" Type="Edm.Decimal" Precision="15" Scale="2" sap:filterable="false" sap:label="Total Sales" sap:aggregation-role="measure" sap:unit="TotalSales_CURRENCY" />
                <Property Name="Sales" Type="Edm.Decimal" Precision="15" Scale="2" sap:filterable="false" sap:label="Sales" sap:aggregation-role="measure" sap:unit="Sales_CURRENCY" />
                <Property Name="SalesShare" Type="Edm.Decimal" Precision="12" Scale="5" sap:filterable="false" sap:label="Sales Share" sap:aggregation-role="measure" />
            </EntityType>

            <EntityType Name="SalesShareParametersType" sap:semantics="parameters">
                <Key>
                    <PropertyRef Name="P_Currency"/>
                    <PropertyRef Name="P_Country"/>
                </Key>
                <Property Name="P_Currency" Type="Edm.String" Nullable="false" MaxLength="5" sap:label="Currency" sap:parameter="mandatory"/>
                <Property Name="P_Country" Type="Edm.String" Nullable="false" DefaultValue="3" MaxLength="20" sap:label="CountryCode" sap:parameter="mandatory"/>
                <NavigationProperty Name="Results" Relationship="sap.smartbusinessdemo.services.SalesShareParameters_SalesShareType" FromRole="SalesShareParametersPrincipal" ToRole="SalesShareDependent"/>
            </EntityType>

            <Association Name="SalesShareParameters_SalesShareType">
                <End Type="sap.smartbusinessdemo.services.SalesShareParametersType" Role="SalesShareParametersPrincipal" Multiplicity="*"/>
                <End Type="sap.smartbusinessdemo.services.SalesShareType" Role="SalesShareDependent" Multiplicity="*"/>
            </Association>

            <EntityContainer Name="SalesShare" m:IsDefaultEntityContainer="true">
                <EntitySet Name="SalesShare" EntityType="sap.smartbusinessdemo.services.SalesShareType"/>
                <EntitySet Name="SalesShareParameters" EntityType="sap.smartbusinessdemo.services.SalesShareParametersType" sap:addressable="false"/>
                <AssociationSet Name="SalesShareParameters_SalesShare" Association="sap.smartbusinessdemo.services.SalesShareParameters_SalesShareType">
                    <End Role="SalesShareParametersPrincipal" EntitySet="SalesShareParameters"/>
                    <End Role="SalesShareDependent" EntitySet="SalesShare"/>
                </AssociationSet>
            </EntityContainer>
        </Schema>
    </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 2 — Add SelectionVariant Annotation (XML) to provide parameter values

**DESCRIPTION**: Create an annotation document that targets SalesShareType and defines a SelectionVariant qualifier (e.g., #params) with Parameters entries for the input parameters P_Currency and P_Country. This SelectionVariant will be referenced by the card (selectionAnnotationPath). Use this XML in your annotations file (e.g., annotations.xml).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="sap.smartbusinessdemo.services.SalesShareType">
    <Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant" Qualifier="params">
        <Record>
            <PropertyValue Property="SelectOptions">
                <Collection>
                    <!-- Add SelectOptions entries if you need ranges or complex filters -->
                </Collection>
            </PropertyValue>
            <PropertyValue Property="Parameters">
                <Collection>
                    <Record Type="com.sap.vocabularies.UI.v1.Parameter">
                        <PropertyValue Property="PropertyName" PropertyPath="P_Currency" />
                        <PropertyValue Property="PropertyValue" String="EUR" />
                    </Record>
                    <Record Type="com.sap.vocabularies.UI.v1.Parameter">
                        <PropertyValue Property="PropertyName" PropertyPath="P_Country" />
                        <PropertyValue Property="PropertyValue" String="IN" />
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
    <!-- ... other annotations ... -->
</Annotations>
```

**STEP**: 3 — CAP CDS equivalent annotation (srv or db cds file)

**DESCRIPTION**: If using CAP CDS, annotate the SalesShareType with UI.SelectionVariant using a qualifier #params and provide Parameters array containing UI.Parameter objects. Place this in your service CDS or annotation CDS file.

**LANGUAGE**: CDS

**CODE**:
```cds
annotate sap.smartbusinessdemo.services.SalesShareType @(
  UI.SelectionVariant #params : {
    SelectOptions : [
      // add select options if needed
    ],
    Parameters : [
      {
        $Type : 'UI.Parameter',
        PropertyName : P_Currency,
        PropertyValue : 'EUR'
      },
      {
        $Type : 'UI.Parameter',
        PropertyName : P_Country,
        PropertyValue : 'IN'
      }
    ]
  }
);
```

**STEP**: 4 — Configure OVP card in manifest.json to use SelectionVariant

**DESCRIPTION**: In your application manifest (manifest.json), configure the OVP card to point to the SelectionVariant qualifier via selectionAnnotationPath and set the entitySet to the aggregate entity. The card will use the annotation parameters to call the Service (OData V2) and display data.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card04": {
        "model": "salesShare",
        "template": "sap.ovp.cards.list",
        "settings": {
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#params",
          "entitySet": "SalesShare"
        }
      }
    }
  }
}
```

**STEP**: 5 — Declare optional input parameter in OData metadata

**DESCRIPTION**: If an input parameter is optional, mark it sap:parameter="optional" in the parameters-type. If the SelectionVariant does not provide a value for an optional parameter, the default used is an empty string (current support: only Edm.String optional parameters). Use the snippet below to add P_Optional.

**LANGUAGE**: XML

**CODE**:
```xml
<EntityType Name="SalesShareParametersType" sap:semantics="parameters">
    <Key>
        <PropertyRef Name="P_Currency"/>
        <PropertyRef Name="P_Country"/>
        <PropertyRef Name="P_Optional"/>
    </Key>
    <Property Name="P_Currency" Type="Edm.String" Nullable="false" MaxLength="5" sap:label="Currency" sap:parameter="mandatory"/>
    <Property Name="P_Country" Type="Edm.String" Nullable="false" DefaultValue="3" MaxLength="20" sap:label="CountryCode" sap:parameter="mandatory"/>
    <Property Name="P_Optional" Type="Edm.String" Nullable="false" MaxLength="5" sap:label="Optional" sap:parameter="optional"/>
    <NavigationProperty Name="Results" Relationship="sap.smartbusinessdemo.services.SalesShareParameters_SalesShareType" FromRole="SalesShareParametersPrincipal" ToRole="SalesShareDependent"/>
</EntityType>
```

Note: Optional parameter support is currently limited to type Edm.String. If SelectionVariant omits P_Optional, an empty string is passed by default.

**STEP**: 6 — Multiple OVP cards with analytical parameters

**DESCRIPTION**: When you have multiple cards that need to react to analytical (filter bar) parameters, create a SelectionVariant annotation per card (unique qualifier per card). When a filter parameter is applied at runtime, cards whose SelectionVariant/Parameters include that parameter name will receive the parameter value. Example shows two cards using distinct selectionAnnotationPath qualifiers.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "cardA": {
        "model": "salesShare",
        "template": "sap.ovp.cards.list",
        "settings": {
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#paramsCardA",
          "entitySet": "SalesShare"
        }
      },
      "cardB": {
        "model": "salesShare",
        "template": "sap.ovp.cards.list",
        "settings": {
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#paramsCardB",
          "entitySet": "SalesShare"
        }
      }
    }
  }
}
```

Additional notes:
- This guidance applies only to SAP Fiori elements for OData V2.
- Use SelectionVariant qualifiers (e.g., #params, #paramsCardA) to associate annotations with specific cards.
--------------------------------

**TITLE**: Analytical List Page (ALP) — Extension and Advanced Configuration Cookbook (OData V2)

**INTRODUCTION**: Short, actionable recipes for extending SAP Fiori elements Analytical List Page (ALP) apps (OData V2). Use these exact code fragments and file locations to add view fragments, controller extensions, custom actions, custom message strip, and a Component.js refreshBinding implementation. Each step is ready to paste into a Fiori elements project under /webapp.

**TAGS**: fiori-elements-framework, analytical-list-page, ALP, odata-v2, manifest.json, controller-extensions, view-extensions, fragment, Component.js, annotations, message-strip, smart-table, smart-chart

STEP: Precondition / Note
DESCRIPTION: Confirm project uses SAP Fiori elements for OData V2. The examples below target OData V2 ALP. File paths assume a UI5 app scaffold with root /webapp.
LANGUAGE: JSON, XML, JavaScript
CODE:
```json
// Precondition: manifest.json must reference OData V2 and the ALP component
// File: /webapp/manifest.json (top-level excerpt showing sap.ui.generic.app + component)
{
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "preload": true
      }
    },
    "extends": {
      "extensions": {
        // view/controller extensions and viewExtensions will be added below
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage"
        }
      }
    ]
  },
  "sap.app": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/MY_SERVICE_SRV/"
      }
    }
  }
}
```

STEP: Add a custom Message Strip above the table (view extension + fragment)
DESCRIPTION: Insert a custom XML fragment into the ALP before the main content using manifest viewExtensions. Place the fragment file under /webapp/fragment and reference it in manifest.json.
LANGUAGE: JSON, XML
CODE:
```json
// File: /webapp/manifest.json (add into "sap.ui5" -> "extends" -> "extensions")
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
            "BeforeMainContent": {
              "viewName": "my.namespace.fragment.MessageStrip",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

```xml
<!-- File: /webapp/fragment/MessageStrip.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
  <MessageStrip
    id="customMessageStrip"
    showIcon="true"
    showCloseButton="true"
    type="Information"
    text="This is a custom message strip added to the ALP." />
</core:FragmentDefinition>
```

STEP: Add a controller extension to implement event handlers and UI logic
DESCRIPTION: Register a controller extension for the ALP base controller in the manifest.json. Implement handler functions (onInit, custom action handlers) in the controller extension module. Use this extension to access SmartFilterBar, SmartChart, SmartTable via this.byId or view.byId. Place controller under /webapp/ext/controller.
LANGUAGE: JSON, JavaScript
CODE:
```json
// File: /webapp/manifest.json (add into "sap.ui5" -> "extends" -> "extensions")
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.controller.AnalyticalListPage": {
            "controllerName": "my.namespace.ext.controller.AnalyticalListPage"
          }
        }
      }
    }
  }
}
```

```javascript
// File: /webapp/ext/controller/AnalyticalListPage.controller.js
sap.ui.define([], function () {
  "use strict";
  return {
    onInit: function () {
      // Called once when the ALP base controller is initialized
      // Use this.getView() or this.byId() to access inserted fragments/controls
      var oView = this.getView();
      // Example: hide the custom message strip at init
      var oMsgStrip = oView.byId("customMessageStrip");
      if (oMsgStrip) {
        oMsgStrip.setVisible(true);
      }
    },

    // Example custom action handler bound to buttons or manifest-defined actions
    onCustomAction: function (oEvent) {
      var oView = this.getView();

      // Access SmartFilterBar by its ID (commonly "smartFilterBar" in ALP)
      var oSmartFilterBar = oView.byId("smartFilterBar");
      // Access SmartChart and SmartTable (IDs may vary by template)
      var oSmartChart = oView.byId("smartChart");
      var oSmartTable = oView.byId("ALPTable") || oView.byId("smartTable");

      // Example: trigger search on SmartFilterBar to refresh results
      if (oSmartFilterBar && oSmartFilterBar.search) {
        oSmartFilterBar.search();
      }

      // Example: get selected contexts from SmartTable
      if (oSmartTable && oSmartTable.getTable) {
        var oInnerTable = oSmartTable.getTable();
        var aSelectedContexts = oInnerTable.getSelectedContexts ? oInnerTable.getSelectedContexts() : [];
        // perform logic with selected contexts
      }
    }
  };
});
```

STEP: Implement a refreshBinding API in Component.js to refresh ALP areas (header/filter/content)
DESCRIPTION: Add a refreshBinding function to your Component.js. Use it from any extension/controller via this.getOwnerComponent().refreshBinding(). The sample below refreshes the SmartFilterBar (search) and the SmartTable binding.
LANGUAGE: JavaScript
CODE:
```javascript
// File: /webapp/Component.js
sap.ui.define([
  "sap/ui/core/UIComponent"
], function (UIComponent) {
  "use strict";
  return UIComponent.extend("my.namespace.Component", {
    metadata: {
      manifest: "json"
    },

    /**
     * Refresh header, filter, and content area elements of ALP.
     * Call from controllers: this.getOwnerComponent().refreshBinding();
     */
    refreshBinding: function () {
      var oView = this.getRootControl && this.getRootControl().getCurrentControl ? this.getRootControl().getCurrentControl() : this.getRootControl();
      // Try common IDs; adjust to actual IDs in your app
      if (!oView) {
        return;
      }

      // Refresh SmartFilterBar - trigger search to re-evaluate filters
      var oSmartFilterBar = oView.byId("smartFilterBar");
      if (oSmartFilterBar && typeof oSmartFilterBar.search === "function") {
        oSmartFilterBar.search();
      }

      // Refresh SmartTable's inner table binding (items or rows)
      var oSmartTable = oView.byId("ALPTable") || oView.byId("smartTable");
      if (oSmartTable && oSmartTable.getTable) {
        var oInnerTable = oSmartTable.getTable();
        if (oInnerTable) {
          var oBindingItems = oInnerTable.getBinding("items") || oInnerTable.getBinding("rows");
          if (oBindingItems && typeof oBindingItems.refresh === "function") {
            oBindingItems.refresh();
          }
        }
      }

      // For SmartChart: rebind or refresh chart if needed
      var oSmartChart = oView.byId("smartChart");
      if (oSmartChart && typeof oSmartChart.rebind === "function") {
        oSmartChart.rebind();
      }
    }
  });
});
```

STEP: Define custom actions via OData V2 annotations (UI.DataFieldForAction) and implement handler in controller extension
DESCRIPTION: For OData V2, define DataFieldForAction entries in annotation XML (or CDS annotation) to make custom actions appear in ALP (list, chart, header). Implement the action handler in your controller extension (example method name: onCustomAction). Place annotations under /webapp/annotations.
LANGUAGE: XML
CODE:
```xml
<!-- File: /webapp/annotations/annotations.xml -->
<Schema Namespace="MyServiceAnnotations" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotations Target="MyService.MyEntityType">
    <Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
      <Collection>
        <!-- DataFieldForAction makes actions available in list/toolbar -->
        <Record Type="UI.DataFieldForAction">
          <PropertyValue Property="Action" String="MyActionFunction" />
          <PropertyValue Property="Label" String="My Action" />
        </Record>
      </Collection>
    </Annotation>
    <!-- Add Action annotations for charts or other toolbars similarly -->
  </Annotations>
</Schema>
```

STEP: Implement action handler logic for OData actions / bound actions in controller extension
DESCRIPTION: Handle action invocation (call OData action/function imports or custom client logic) in the controller extension method referenced by your annotation or manifest action. Use the model to call function imports or action binding.
LANGUAGE: JavaScript
CODE:
```javascript
// Inside /webapp/ext/controller/AnalyticalListPage.controller.js (add method)
onMyActionExecute: function (oEvent) {
  // Example: call an OData action on a selected context
  var oView = this.getView();
  var oSmartTable = oView.byId("ALPTable") || oView.byId("smartTable");
  var oInnerTable = oSmartTable && oSmartTable.getTable && oSmartTable.getTable();
  var aContexts = oInnerTable && oInnerTable.getSelectedContexts ? oInnerTable.getSelectedContexts() : [];

  if (!aContexts || aContexts.length === 0) {
    sap.m.MessageToast.show("Select at least one entry");
    return;
  }

  var oContext = aContexts[0]; // example: operate on first selected
  var oModel = oContext.getModel();
  var sPath = oContext.getPath();

  // Example: call bound action 'MyAction' (adjust signature and payload as needed)
  oModel.callFunction(sPath + "/MyAction", {
    method: "POST",
    success: function () {
      sap.m.MessageToast.show("Action executed successfully");
      // refresh data
      this.getOwnerComponent().refreshBinding();
    }.bind(this),
    error: function (oError) {
      sap.m.MessageBox.error("Action failed");
    }
  });
}
```

STEP: Notes and mapping references developers must verify in their app
DESCRIPTION: IDs and controller/view names can vary by project/version. Verify the target view/controller names in your runtime (common targets used above):
- Target view for viewExtensions: "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage"
- Base controller for controllerExtensions: "sap.suite.ui.generic.template.AnalyticalListPage.controller.AnalyticalListPage"
- Common control IDs: "smartFilterBar", "smartChart", "ALPTable" or "smartTable"
LANGUAGE: Text
CODE:
```text
// Verify these in your project:
/webapp/manifest.json -> "sap.ui.generic.app" pages -> component.name
Check runtime control IDs in Chrome DevTools > Elements or UI5 Inspector
```

STEP: Related extension points and next steps
DESCRIPTION: Use the controller extension to wire up:
- Smart Table custom actions and table-level logic
- Smart Chart custom actions and drilldown handlers
- Custom filters or KPI tag handling (use SmartFilterBar APIs)
- Custom message strip and visibility control
LANGUAGE: Text
CODE:
```text
// Implementation checklist:
- Add view fragment under /webapp/fragment and reference via viewExtensions in manifest.json
- Register controller extension in manifest.json and implement event handlers under /webapp/ext/controller
- Implement Component.js.refreshBinding and call from controller extension to refresh ALP parts
- Define UI.DataFieldForAction annotations in /webapp/annotations for OData V2 actions
- Use SmartFilterBar.search(), SmartTable.getTable().getBinding(...).refresh(), and SmartChart.rebind() where applicable
```

--------------------------------

**TITLE**: Configuring Card Filters

**INTRODUCTION**: How to add filters to Fiori elements cards using the com.sap.vocabularies.UI.v1.SelectionVariant annotation (XML or CAP CDS) and by passing filter parameters in the URL. Includes examples for XML annotations and CAP CDS, usage constraints, and launchpad currency preference behavior.

**TAGS**: fiori-elements-framework, annotations, SelectionVariant, filters, XML, CAP, CDS, URL, DisplayCurrency

STEP: 1 — Add filters using XML annotation

DESCRIPTION: Add a SelectionVariant annotation to your annotation file (local XML annotation or OData service annotations) to apply filter(s) on card data. Use SelectOptions with PropertyName and Ranges. The example filters records where TotalSum is between 0 and 8000. You can provide multiple SelectOptions (multiple properties) and multiple Ranges per property.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant" Qualifier="bubble">
    <Record>
        <PropertyValue Property="SelectOptions">
            <Collection>
            <Record>
               <PropertyValue Property="PropertyName" PropertyPath="TotalSum" />
               <PropertyValue Property="Ranges">
                  <Collection>
                     <Record>
                        <PropertyValue Property="Sign"
                           EnumMember="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I" />
                        <PropertyValue Property="Option"
                           EnumMember="com.sap.vocabularies.UI.v1.SelectionRangeOptionType/BT" />
                        <PropertyValue Property="Low" String="0" />
                        <PropertyValue Property="High" String="8000" />
                     </Record>
                  </Collection>
               </PropertyValue>
            </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 2 — Add filters using CAP CDS annotation

DESCRIPTION: In CAP (CDS) use the UI.SelectionVariant annotation with a qualifier to define SelectOptions and Ranges. Use #I for Sign (Include) and #BT for Option (Between). Values must be strings for numeric ranges as shown.

LANGUAGE: CDS

CODE:
```cds
UI.SelectionVariant #bubble: {
    SelectOptions: [
        {
            PropertyName: TotalSum,
            Ranges: [
                {
                    Sign: #I,
                    Option: #BT,
                    Low: '0',
                    High: '8000'
                }
            ]
        }
    ]
}
```

STEP: 3 — Apply filters via URL parameters (Overview Page / Launchpad)

DESCRIPTION: Pass filter parameters in the URL when launching an overview page from SAP Fiori launchpad or another app. Only strings or integers can be passed. The filter is applied automatically if the filter property exists in the entityset. Multiple filters: add multiple query parameters. Example below and notes about DisplayCurrency.

LANGUAGE: TEXT

CODE:
```
Example URL (single filter):
http://abc#Equipment-overviewPage?EquipmentNumber=123456

Example URL (multiple filters):
http://abc#SomeOverviewPage?PropertyA=valA&PropertyB=42
```

STEP: 4 — ABAP CDS guidance

DESCRIPTION: No ABAP CDS annotation sample is provided. Use the local XML annotation (see Step 1) to configure SelectionVariant filters for cards when ABAP CDS examples are not available.

LANGUAGE: TEXT

CODE:
```
No ABAP CDS sample available. Use local XML annotation (SelectionVariant) as shown in STEP 1.
```

STEP: 5 — Notes and constraints

DESCRIPTION: Summarize operational details to apply when implementing filters.

LANGUAGE: TEXT

CODE:
```
- Multiple filters: Add additional SelectOptions entries (one per property) and/or multiple Range records per SelectOptions entry.
- Enum meanings:
  - Sign: I = Include
  - Option: BT = Between
- Data types: URL filters accept only strings or integers.
- Automatic apply: Filters via URL apply automatically if the property exists in the target entityset.
- Currency display: Currency type display preference is taken from the SAP Fiori Launchpad user settings (DisplayCurrency field of the application).
```
--------------------------------

**TITLE**: Configuring Card Navigation for SAP Fiori Overview Pages (OVP)

**INTRODUCTION**: Practical, code-focused reference for configuring card navigation in SAP Fiori Overview Pages (OVP). Covers intent-based and URL navigation via annotations, manifest configuration for identificationAnnotationPath and staticParameters, and implementing custom navigation via controller extension (doCustomNavigation). Use these snippets directly in manifest.json and a controller file.

**TAGS**: fiori-elements-framework, ovp, navigation, manifest.json, annotations, com.sap.vocabularies.UI.v1, sap.ui.controllerExtensions, DataFieldForIntentBasedNavigation, DataFieldWithUrl

**STEP**: 1 — Navigation annotation types and intent vs URL

**DESCRIPTION**: Use annotation vocabularies to provide navigation targets for cards. Prefer DataFieldForIntentBasedNavigation for intent-based navigation to other Fiori apps; use DataFieldWithUrl for external URLs or when a specific application URL must be constructed.

- Annotation terms:
  - com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation — intent-based navigation; requires semanticObject and action.
  - com.sap.vocabularies.UI.v1.DataFieldWithUrl — external URL navigation; requires url.
- Selection context:
  - Passing single-record context to the navigation target is supported only for list/table cards when navigation is defined in com.sap.vocabularies.UI.v1.LineItem.
- Multiple navigation entries:
  - If more than one navigation record exists in Identification or LineItem, the first is used. Sorting is by Importance (com.sap.vocabularies.UI.v1.ImportanceType) and by their entry order.

**LANGUAGE**: Text/Notes

**CODE**:
```text
Annotation terms:
- com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation  -> requires semanticObject, action
- com.sap.vocabularies.UI.v1.DataFieldWithUrl                 -> requires url

Notes:
- Single-record context only passed from list/table cards (LineItem).
- If multiple entries exist, the first entry (by ImportanceType and order) is used.
```

**STEP**: 2 — Configure identificationAnnotationPath in manifest.json for card identification

**DESCRIPTION**: Set identificationAnnotationPath in sap.ovp card settings to point to the Identification term (optionally with a qualifier). If omitted, the unqualified Identification term is used.

Place this in your application-level manifest.json under sap.ovp -> cards -> <cardId> -> settings.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card04": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.list",
        "settings": {
          "sortBy": "Price",
          "sortOrder": "descending",
          "listFlavor": "bar",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#bar",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#bar",
          "category": "{{card04_category}}",
          "entitySet": "Products"
        }
      }
    }
  }
}
```

**STEP**: 3 — Add staticParameters in manifest.json for IntentBasedNavigation

**DESCRIPTION**: Define staticParameters (key/value pairs) in the card settings to provide navigation parameters during IntentBasedNavigation. Add them under the card's settings in manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card04": {
        "settings": {
          "staticParameters": {
            "parameter1": "parameterValue1",
            "parameter2": "parameterValue2"
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Enable controller extension in manifest.json to support custom navigation

**DESCRIPTION**: Configure controller extension for the overview page so you can implement doCustomNavigation in a custom controller. Add sap.ui.controllerExtensions mapping under "extends" in manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.ovp.app.Main": {
          "controllerName": "my_app.ext.controller.OverViewPageExt"
        }
      }
    }
  }
}
```

**STEP**: 5 — Implement doCustomNavigation in a custom controller

**DESCRIPTION**: Implement doCustomNavigation(sCardId, oContext, oNavigationEntry) in the controller defined in the manifest extension. The function receives:
- sCardId (String): the card id as in manifest.json
- oContext (Context object): context for the clicked card item (has getProperty and sPath)
- oNavigationEntry (Object): the annotation-provided navigation entry (standard input)

Return value:
- An object similar to oNavigationEntry or null. If returning an object, supported string attributes:
  - type (mandatory): "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation" or "com.sap.vocabularies.UI.v1.DataFieldWithUrl"
  - semanticObject (required for DataFieldForIntentBasedNavigation)
  - action (required for DataFieldForIntentBasedNavigation)
  - url (required for DataFieldWithUrl)
  - label (optional)

Example: return a custom navigation entry when a specific card id and entity property match.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/controller/OverViewPageExt.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("my_app.ext.controller.OverViewPageExt", {
    /**
     * Custom navigation hook called by OVP framework
     * @param {string} sCardId - card id from manifest.json
     * @param {sap.ui.model.Context} oContext - binding context for clicked item
     * @param {Object} oNavigationEntry - default navigation entry from annotations
     * @returns {Object|null} custom navigation entry or null to use default
     */
    doCustomNavigation: function (sCardId, oContext, oNavigationEntry) {
      var oCustomNavigationEntry = null;
      var oEntity = oContext && oContext.getProperty ? oContext.getProperty(oContext.sPath) : null;

      // Example: override navigation for card001 when PurchaseOrder matches
      if (sCardId === "card001" && oEntity && oEntity.PurchaseOrder === "4500003575") {
        oCustomNavigationEntry = {
          type: "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation",
          semanticObject: "Action",
          action: "toappnavsample2",
          url: "",    // not required for DataFieldForIntentBasedNavigation, keep empty or omit
          label: "Open Purchase Order"
        };
      }

      // If you want multiple custom targets based on context, return the appropriate object here.
      // Return null to fall back to the annotation-provided oNavigationEntry.
      return oCustomNavigationEntry;
    }
  });
});
```

**STEP**: 6 — Example annotation shapes (reference)

**DESCRIPTION**: Example shapes of navigation entries provided by annotations or expected by doCustomNavigation. Use these to construct return objects.

**LANGUAGE**: JSON

**CODE**:
```json
// DataFieldForIntentBasedNavigation example (annotation shape)
{
  "type": "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation",
  "semanticObject": "PurchaseOrder",
  "action": "display",
  "label": "Open PO"
}

// DataFieldWithUrl example (annotation shape)
{
  "type": "com.sap.vocabularies.UI.v1.DataFieldWithUrl",
  "url": "https://example.com/details?id={ID}",
  "label": "Open Details"
}
```
--------------------------------

**TITLE**: Configuring Card Properties

**INTRODUCTION**: Define the mandatory configuration keys required for every overview-page card. Use these properties when declaring card instances so the framework can instantiate and bind a card to a model and an entity set with the selected card template and internal settings.

**TAGS**: fiori-elements-framework, cards, overview-page, configuration, card-properties, manifest

**STEP**: 1 — Mandatory card properties and types

**DESCRIPTION**: Ensure every card configuration object contains these four keys. Use the types and purpose below when authoring card JSON configuration.

- model (string): Name of the UI5 model instance that the card will use.
- template (string): Card component package / template identifier to instantiate (e.g., template/package name).
- settings (object): Internal card configuration passed to the card instance (card-specific settings such as title, annotationPath, presentation options). Provide an object even if empty.
- entitySet (string): OData entity set name that the card binds to.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "model": "string",         /* name of the model to provide to the card instance */
  "template": "string",      /* card type / component package to instantiate */
  "settings": {              /* internal card configuration for the card instance */
    /* card-specific settings (title, annotationPath, other options) */
  },
  "entitySet": "string"      /* target OData entitySet for the card */
}
```

**STEP**: 2 — Minimal valid card configuration (pasteable)

**DESCRIPTION**: Minimal concrete example that satisfies the mandatory properties. Replace placeholder values with your application-specific model name, card template, settings, and entity set.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "model": "mainModel",
  "template": "com.example.cards.list", 
  "settings": {},
  "entitySet": "SalesOrderSet"
}
```

**STEP**: 3 — Realistic card configuration with common settings

**DESCRIPTION**: Example showing how to populate the settings object with common card-level options (title, annotationPath, filters, navigation). These keys are card-specific — check the chosen template's documentation for supported settings. This example demonstrates a typical configuration to copy and adapt.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "model": "mainModel",
  "template": "com.example.cards.list",
  "settings": {
    "title": "Recent Sales Orders",
    "annotationPath": "@com.sap.vocabularies.UI.v1.LineItem",
    "presentationVariant": {
      "sortOrder": [{ "property": "CreatedAt", "descending": true }],
      "top": 5
    },
    "navigation": {
      "route": "SalesOrderDetail",
      "parameters": { "orderId": "{OrderID}" }
    },
    "filters": [
      { "path": "Status", "operator": "EQ", "value": "Open" }
    ]
  },
  "entitySet": "SalesOrderSet"
}
```
--------------------------------

**TITLE**: Configuring Charts (SAP Fiori Elements)

**INTRODUCTION**: Quick, code-focused guide to add and configure chart facets in Fiori Elements list reports and object pages. Includes annotation examples (XML, ABAP CDS, CAP) for UI.ReferenceFacet and UI.Chart, backend aggregation setup for OData V4, manifest.json client settings, and important restrictions.

**TAGS**: fiori-elements-framework, charts, UI.Chart, UI.ReferenceFacet, annotations, manifest.json, aggregation, ODataV4, ODataV2, CAP, ABAP_CDS, XML, JSON

STEP: 1 — Add a Chart Facet (UI.ReferenceFacet)

DESCRIPTION: Add a chart facet to a content section by pointing a reference facet at an entity/navigation path that exposes a UI.Chart annotation. Use XML annotations or CDS (ABAP/CAP) variants shown below.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType">
   <Annotation Term="UI.Facets">
      <Record Type="UI.ReferenceFacet">
         <PropertyValue Property="Label" String="{@i18n>@SalesData}"/>
         <PropertyValue Property="Target" AnnotationPath="to_ProductSalesData/@UI.Chart"/>
      </Record>
   </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.facet: [
 {
  label: '{@i18n>@SalesData}',
  type: #CHART_REFERENCE,
  purpose: #STANDARD,
  targetElement: '_productSalesData'
 }
]
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductType @(
  UI.Facets : {
    $Type : 'UI.ReferenceFacet',
    Label : '{@i18n>@SalesData}',
    Target : 'to_ProductSalesData/@UI.Chart'
  }
);
```

STEP: 2 — Define the Chart (UI.Chart)

DESCRIPTION: Define the chart title, type, dimensions and measures on the referenced entity/type. DO NOT use navigation properties within UI.Chart (unsupported).

LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType">
   <Annotation Term="UI.Chart">
      <Record>
         <PropertyValue Property="Title" String="Test Chart"/>
         <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
         <PropertyValue Property="Dimensions">
            <Collection>
               <PropertyPath>DeliveryMonth</PropertyPath>
            </Collection>
         </PropertyValue>
         <PropertyValue Property="Measures">
            <Collection>
               <PropertyPath>Revenue</PropertyPath>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Chart: [
  {
    title: 'Test Chart',
    chartType: #COLUMN,
    dimensions: [
      'DELIVERYMONTH'
    ],
    measures: [
      'REVENUE'
    ]
  }
]
annotate view STTA_C_MP_PRODUCTSALESDATA with {
}
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType @(
  UI.Chart : {
    Title : 'Test Chart',
    ChartType : #Column,
    Dimensions : [
        DeliveryMonth
    ],
    Measures : [
        Revenue
    ]
  }
);
```

STEP: 3 — Where to Place Chart Facets

DESCRIPTION: Use chart facets in:
- List Reports (single view or multiple views). See: Defining Multiple Views on a List Report Table.
- Object Pages: add chart facet to a section/subsection. See: Adding a Chart Facet.

(References: linking docs: defining-multiple-views-on-a-list-report-table-multiple-table-mode-37aeed7.md, adding-a-chart-facet-6495eab.md)

STEP: 4 — OData V2 / Draft Restriction

DESCRIPTION: For SAP Fiori Elements for OData V2, charts are supported only for entities/services that are NOT draft-enabled (or for read-only entities). Draft-enabled entities are restricted.

STEP: 5 — OData V4: Draft-Enabled Entities & ALP

DESCRIPTION: 
- You can annotate charts on draft-enabled entities; only active (non-draft) data is used for chart display.
- To include chart in an Analytical List Page (ALP) or list report content area, configure manifest.json (see next steps / manifest examples). See: Enabling the ALP in SAP Fiori Elements for OData V4.

STEP: 6 — Criticality Coloring (UI.ValueCriticality)

DESCRIPTION: Wrap criticality rules with UI.ValueCriticality to enable criticality coloring for chart measures/dimensions. Note: neutral values produce no color, and semantic coloring via UI.Criticality/UI.CriticalityCalculation is NOT supported in charts.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd_aggregate.SalesOrderManage/SalesOrderType">
    <Annotation Term="UI.ValueCriticality">
        <Collection>
            <Record Type="UI.ValueCriticalityType">
                <PropertyValue Property="Value" String="CCLN"/>
                <PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Negative"/>
            </Record>
            <Record Type="UI.ValueCriticalityType">
                <PropertyValue Property="Value" String="CR"/>
                <PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Critical"/>
            </Record>
            <Record Type="UI.ValueCriticalityType">
                <PropertyValue Property="Value" String="OR"/>
                <PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Positive"/>
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view C_SALESORDERMANAGE_SD_AGGREGATE.SALESORDERMANAGE with {

@UI.ValueCriticality: [
  {
    value: 'CCLN',
    criticality: #NEGATIVE
  },
  {
    value: 'CR',
    criticality: #CRITICAL
  },
  {
    value: 'OR',
    criticality: #POSITIVE
  }
]

salesordertype;
}
```

LANGUAGE: CAP CDS
CODE:
```cds
SalesOrderType @(
        UI.ValueCriticality   : [
        {
            Value       : 'CCLN',
            Criticality : #Negative
        },
        {
            Value       : 'CR',
            Criticality : #Critical
        },
       {
            Value       : 'OR',
            Criticality : #Positive
        }
        ]
    );
```

STEP: 7 — Time Axis Support

DESCRIPTION: Charts automatically enable a time axis when the dimension type is:
- Edm.Date
- Edm.DateTimeOffset
Or when a String dimension is annotated with one of:
- @Common.IsFiscalYear
- @Common.IsFiscalYearPeriod
- @Common.IsCalendarYearMonth
- @Common.IsCalendarYearQuarter
- @Common.IsCalendarYearWeek
- @Common.IsCalendarDate

STEP: 8 — Enable Aggregation in Back End (OData V4) — Groupable & Aggregatable Properties

DESCRIPTION: For charts to work, the entity set must support aggregation. Define GroupableProperties and AggregatableProperties at the entity set level (XML in metadata or CAP snippets). These replace the older property-level Aggregation.Groupable / Aggregation.Aggregatable usage.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="sap.fe.managepartners.ManagePartnersService.EntityContainer/BusinessPartners">
    <Annotation Term="Aggregation.ApplySupported">
        <Record Type="Aggregation.ApplySupportedType">
            <PropertyValue Property="AggregatableProperties">
                <Collection>
                    <Record Type="Aggregation.AggregatablePropertyType">
                        <PropertyValue Property="Property">
                            <PropertyPath>SalesAmount</PropertyPath>
                        </PropertyValue>
                    </Record>
                    <Record Type="Aggregation.AggregatablePropertyType">
                        <PropertyValue Property="Property">
                            <PropertyPath>SalesAmountLocalCurrency</PropertyPath>
                        </PropertyValue>
                    </Record>
                    ...
                </Collection>
            </PropertyValue>
            <PropertyValue Property="GroupableProperties">
                <Collection>
                    <PropertyPath>AccountResponsible</PropertyPath>
                    <PropertyPath>Country</PropertyPath>
                    ...
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
@Aggregation.ApplySupported : {
     GroupableProperties : [AccountResponsible, Country, .......],
     AggregatableProperties: [{
          Property: SalesAmount
          },{
          Property: SalesAmountLocalCurrency
          },
          ....
     ]
}
```

STEP: 9 — Transformation Aggregation: Standard Aggregation Methods (Analytics.AggregatedProperty)

DESCRIPTION: Expose standard aggregation measures in metadata using Analytics.AggregatedProperty. The client can request e.g., min/max on a property and receive aggregated values.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd_aggregate.SalesOrderManage">
    <Annotation Term="Aggregation.ApplySupported">
        …
    </Annotation>
    <Annotation Term="Analytics.AggregatedProperty">
        <Record Type="Analytics.AggregatedPropertyType">
            <PropertyValue Property="Name" String="minPrice"/>
            <PropertyValue Property="AggregationMethod" String="min"/>
            <PropertyValue Property="AggregatableProperty" PropertyPath="NetPricing"/>
            <Annotation Term="Common.Label" String="Minimum Net Price"/>
         </Record>
    </Annotation>
    <Annotation Term="Analytics.AggregatedProperty" Qualifier="max">
        <Record Type="Analytics.AggregatedPropertyType">
            <PropertyValue Property="Name" String="maximumPrice"/>
            <PropertyValue Property="AggregationMethod" String="max"/>
            <PropertyValue Property="AggregatableProperty" PropertyPath="NetPricing"/>
            <Annotation Term="Common.Label" String="Maximum Net Price"/>
         </Record>
    </Annotation>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate com.c_salesordermanage_sd_aggregate.SalesOrderManage with @(
  Aggregation.ApplySupported        : {
    AggregatableProperties   : [{Property : NetPricing}],
    CustomAggregationMethods : ['Custom.concat']
  },
  Analytics.AggregatedProperty      : {
    Name                 : 'minPrice',
    AggregationMethod    : 'min',
    AggregatableProperty : 'NetPricing',
    ![@Common.Label]     : 'Minimum Net Price'
  }
});
```

STEP: 10 — Use Transformation Aggregate-Based Measures in Chart via DynamicMeasures

DESCRIPTION: If a chart measure is a transformation aggregate (Analytics.AggregatedProperty), define it under DynamicMeasures (not Measures). Use MeasureAttributes to map DynamicMeasure entries to chart axes.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Chart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Sales Chart"/>
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>avgPricing</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="DynamicMeasures">
            <Collection>
                <AnnotationPath>@Analytics.AggregatedProperty#sum</AnnotationPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>SalesOrganization</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="avgPricing"/>
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                </Record>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="DynamicMeasure" AnnotationPath="@Analytics.AggregatedProperty#sum"/>
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="DimensionAttributes">
            <Collection>
                <Record Type="UI.ChartDimensionAttributeType">
                    <PropertyValue Property="Dimension" PropertyPath="SalesOrganization"/>
                    <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

LANGUAGE: CAP CDS
CODE:
```cds
Chart : {
      $Type               : 'UI.ChartDefinitionType',
      Title               : 'Sales Chart',
      ChartType           : #Column,
      Measures            : [avgPricing],
      DynamicMeasures     : ['@Analytics.AggregatedProperty#sum'],
      Dimensions          : [SalesOrganization],
      MeasureAttributes   : [
        {
          $Type   : 'UI.ChartMeasureAttributeType',
          Measure : avgPricing,
          Role    : #Axis1
        },
        {
          $Type          : 'UI.ChartMeasureAttributeType',
          DynamicMeasure : '@Analytics.AggregatedProperty#sum',
          Role           : #Axis1
        }
      ],
      DimensionAttributes : [{
        $Type     : 'UI.ChartDimensionAttributeType',
        Dimension : SalesOrganization,
        Role      : #Category
      }]
    }
```

STEP: 11 — Transformation Aggregation with Custom Aggregation Methods

DESCRIPTION: To use custom aggregation methods on measures, add Aggregation.CustomAggregate entries at entity set level and mark groupable dimensions. Unit properties can be annotated as custom aggregates but will not appear in chart measure lists.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="sap.fe.managepartners.ManagePartnersService.EntityContainer/BusinessPartners">
     <Annotation Term="Aggregation.CustomAggregate" Qualifier="RequestedQuantity">
        <String>Edm.Decimal</String>
     </Annotation>
     <Annotation Term="Aggregation.CustomAggregate" Qualifier="RequestedQuantityLocalUnit">
        <String>Edm.Decimal</String>
     </Annotation>
</Annotations>

<Annotations Target="sap.fe.managepartners.ManagePartnersService.BusinessPartners/Name">
     <Annotation Term="Aggregation.Groupable">
        <Bool>true</Bool>
     </Annotation>
     <Annotation Term="Common.Label">
        <String>Partner Name</String>
     </Annotation>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
@Aggregation.CustomAggregate #RequestedQuantity          : 'Edm.Decimal'
@Aggregation.CustomAggregate #RequestedQuantityLocalUnit : 'Edm.Decimal'

entity BusinessPartners {
               Name   : String @Common : { Label: 'Partner Name' }
               @Aggregation.Groupable: true;
}
```

STEP: 12 — Configure Chart Header and Visibility in manifest.json

DESCRIPTION: Use controlConfiguration entries in manifest.json to set chart header visibility and custom header text. These settings apply for list-report charts; object page chart titles are determined by section titles.

LANGUAGE: JSON
CODE:
```json
"BusinessPartnersList": {
   "type": "Component",
   "id": "BusinessPartnersList",
   "name": "sap.fe.templates.ListReport",
   "options": {
      "settings": {
         "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.Chart": {
               "chartSettings": {
                  "headerVisible": false,
                  "header": "My Custom chart title"
               }
            }
         }
      }
   }
}
```

STEP: 13 — Configure Chart Selection Mode in manifest.json

DESCRIPTION: Configure chart data point selection mode via manifest.json. Values: None / Single / Multiple (default Multiple).

LANGUAGE: JSON
CODE:
```json
"BusinessPartnersList": {
   "type": "Component",
   "id": "BusinessPartnersList",
   "name": "sap.fe.templates.ListReport",
   "options": {
      "settings": {
         "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.Chart": {
               "chartSettings": {
                  "selectionMode": "None" // "None" | "Single" | "Multiple"
               }
            }
         }
      }
   }
}
```

NOTE: Chart selection is not persisted in iAppState; selecting chart points is cleared on table refreshes and is not part of saved variants. Ensure back end supports transformation filters for aggregate controls.

STEP: 14 — Final Restrictions & Important Notes (Summary)

DESCRIPTION: Keep these restrictions in mind:
- UI.Chart cannot reference navigation properties.
- OData V2: charts unsupported for draft-enabled or transactionally writable entities.
- OData V4: draft-enabled entities allowed, but charts use active data only.
- Properties (measures/dimensions/text) from associated entity sets are not supported.
- Chart personalization and selections are not saved in iAppState.
- Semantic coloring via UI.Criticality/UI.CriticalityCalculation is not supported for charts.
- Aggregations on draft-enabled entities are not supported in ABAP CDS (SADL limitation).
- Unit properties annotated as custom aggregates will not appear in measure lists.

References (in-source links):
- Defining Multiple Views on a List Report Table: defining-multiple-views-on-a-list-report-table-multiple-table-mode-37aeed7.md
- Adding a Chart Facet: adding-a-chart-facet-6495eab.md
- Configuring the Manifest for the Analytical List Page: configuring-the-manifest-for-the-analytical-list-page-2a9df06.md
- Transformation Aggregation spec: http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs01/odata-data-aggregation-ext-v4.0-cs01.html
--------------------------------

**TITLE**: Configuring Charts for SAP Fiori Overview Pages (Annotations + manifest.json)

**INTRODUCTION**: This doc shows how to configure chart cards for Fiori Overview Pages using UI annotations (XML / ABAP CDS / CAP CDS) and manifest.json settings. It covers required annotations, formatting numeric values, enabling semantic pattern (actual vs forecast), chart role semantics, time-series rules, color palettes (including stable coloring for stacked column charts), and enabling data labels.

**TAGS**: fiori-elements-framework, annotations, UI.Chart, UI.DataPoint, manifest.json, colorPalette, semantic-pattern, CDS, CAP, XML, ABAP

---

STEP: Common Annotation Definitions (required/optional for chart cards)

DESCRIPTION: Use these annotations in your annotation file (XML/ABAP/CDS/CAP) when building chart cards. UI.Identification and UI.Chart are mandatory. Others adjust filters, sort, and limits. Use qualifiers to provide multiple chart views from the same annotation file.

LANGUAGE: Text

CODE:
```text
Annotations and purpose:
- UI.Identification
  - Mandatory: navigation targets and parameters when user clicks the card.
  - See: Configuring Card Navigation.

- UI.SelectionVariant.SelectOptions
  - Filter values applied when retrieving card data.

- UI.PresentationVariant.SortOrder
  - Sort order of fetched records.

- UI.PresentationVariant.MaxItems
  - Optional: limit max records fetched. Avoid for charts requiring full dataset (e.g., donut).

- UI.Chart
  - Mandatory: defines dimensions, measures, chartType, measure/dimension roles.

- UI.Chart.MeasureAttributes.Measure
  - Defines measures used in the chart.

- UI.Chart.MeasureAttributes.Role
  - Role (axis1/axis2/axis3) controls rendering semantics; meaning varies by chart type.

- UI.Chart.DimensionAttributes.Dimension
  - Defines dimensions used in chart.

- UI.Chart.DimensionAttributes.Role
  - Role (category/series); default is category.
```

---

STEP: Formatting Numeric Values in Charts (UI.DataPoint ValueFormat)

DESCRIPTION: Use UI.DataPoint.ValueFormat (ScaleFactor and NumberOfFractionalDigits) and link DataPoint to measures in UI.Chart to control fractional digits and scale in overview charts.

LANGUAGE: XML

CODE:
```xml
<!-- Place in your annotation XML file -->
<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Currency_TotalSales">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Value" Path="Sales"/>
    <PropertyValue Property="ValueFormat">
      <Record>
        <PropertyValue Property="ScaleFactor" Decimal="1000" />
        <PropertyValue Property="NumberOfFractionalDigits" Int="3" />
      </Record>
    </PropertyValue>
  </Record>
</Annotation>

<Annotation Term="UI.Chart" Qualifier="Eval_by_Currency">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="View1" />
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bubble"/>
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="TotalSales" />
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2" />
          <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Eval_by_Currency_TotalSales"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
/* In your ABAP CDS view annotations */
@UI.dataPoint: {
  valueFormat: { scaleFactor: 1000, numberOfFractionalDigits: 3 }
}
Sales as TotalSales;

@UI.Chart: [
  {
    title: 'View1',
    chartType: #BUBBLE,
    measureAttributes: [
      {
        measure: 'TotalSales',
        role: #AXIS_2,
        asDataPoint: true      /* ensure DataPoint link is considered */
      }
    ],
    qualifier: 'Eval_by_Currency'
  }
]
annotate view VIEWNAME with { }
```

LANGUAGE: CAP CDS

CODE:
```cds
/* In your CAP CDS annotation file */
UI.DataPoint #Eval_by_Currency_TotalSales : {
  $Type : 'UI.DataPointType',
  ValueFormat : {
    ScaleFactor : 1000,
    NumberOfFractionalDigits : 3
  }
};

UI.Chart #Eval_by_Currency : {
  $Type : 'UI.ChartDefinitionType',
  Title : 'View1',
  ChartType : #Bubble,
  MeasureAttributes : [
    {
      $Type : 'UI.ChartMeasureAttributeType',
      Measure : TotalSales,
      Role : #Axis2,
      DataPoint : '@UI.DataPoint#Eval_by_Currency_TotalSales'
    }
  ]
};
```

---

STEP: Semantic Pattern (Actual vs Forecast)

DESCRIPTION: Enable semantic pattern (compare actual vs forecast) by providing a DataPoint with ForecastValue pointing to a measure. Supported chart types: line, column, vertical bullet. Requirements:
- For line/column: 1 dimension + 1 measure (measure must reference DataPoint with ForecastValue)
- For vertical bullet: 1 dimension + 1-2 measures
- If conditions not met, chart shows actual (solid) and forecast (dashed/dotted) styles.

LANGUAGE: XML

CODE:
```xml
<!-- DataPoint with ForecastValue -->
<Annotation Term="UI.DataPoint" Qualifier="Column_Forecast">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Sales Performance"/>
    <PropertyValue Property="Value" Path="Sales"/>
    <PropertyValue Property="ValueFormat">
      <Record>
        <PropertyValue Property="ScaleFactor" Decimal="0"/>
        <PropertyValue Property="NumberOfFractionalDigits" Int="3"/>
      </Record>
    </PropertyValue>
    <PropertyValue Property="ForecastValue" Path="SalesShare"/>
  </Record>
</Annotation>

<!-- Chart linked to DataPoint -->
<Annotation Term="UI.Chart" Qualifier="Eval_by_Currency_Column">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Column chart for shape" />
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column" />
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="Sales" />
          <PropertyValue Property="DataPoint">
            <AnnotationPath>@UI.DataPoint#Column_Forecast</AnnotationPath>
          </PropertyValue>
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="SupplierCompany" />
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
/* ABAP CDS: DataPoint with forecast and chart config */
@UI.dataPoint: {
  title: 'Sales Performance',
  forecastValue: 'SalesShare',
  valueFormat: { scaleFactor: 0, numberOfFractionalDigits: 3 }
}
Sales;

@UI.Chart: [
  {
    title: 'Column chart for shape',
    chartType: #COLUMN,
    measureAttributes: [
      { measure: 'Sales', role: #AXIS_1, asDataPoint: true }
    ],
    dimensionAttributes: [
      { dimension: 'SupplierCompany', role: #CATEGORY }
    ],
    qualifier: 'Eval_by_Currency_Column'
  }
]
annotate view VIEWNAME with { }
```

LANGUAGE: CAP CDS

CODE:
```cds
/* CAP CDS: DataPoint + Chart using ForecastValue */
UI.DataPoint #Column_Forecast : {
  $Type : 'UI.DataPointType',
  Title : 'Sales Performance',
  Value : Sales,
  NumberFormat : {
    ScaleFactor : 0,
    NumberOfFractionalDigits : 3
  },
  ForecastValue : SalesShare
};

UI.Chart #Eval_by_Currency_Column : {
  $Type : 'UI.ChartDefinitionType',
  Title : 'Column chart for shape',
  ChartType : #Column,
  MeasureAttributes : [
    {
      $Type : 'UI.ChartMeasureAttributeType',
      Measure : Sales,
      DataPoint : '@UI.DataPoint#Column_Forecast',
      Role : #Axis1
    }
  ],
  DimensionAttributes : [
    {
      $Type : 'UI.ChartDimensionAttributeType',
      Dimension : SupplierCompany,
      Role : #Category
    }
  ]
};
```

---

STEP: Chart Types, Roles and Time Series Rules

DESCRIPTION: Roles assigned in annotations determine behavior:
- Dimension role: category (default) or series.
- Measure role: axis1 (default), axis2, axis3 — interpretation depends on chart type.
Time Series auto-enabled when:
- chartType is line, bubble, column, or combination
- exactly one dimension
- dimension type is edm.datetime OR edm.string with sap:semantics="yearmonthday"
- bubble charts: exactly 2 measures
- combination charts: at least 2 measures

LANGUAGE: Text

CODE:
```text
Chart types supported: line, donut, bubble, column, stacked column, vertical bullet, combination, scatter.

Dimension role values:
- category (default)
- series

Measure role values:
- axis1 (default)
- axis2
- axis3

Time series conditions (auto time axis):
- chartType in {line, bubble, column, combination}
- single dimension only
- dimension type = edm.datetime OR edm.string with sap:semantics="yearmonthday"
- bubble: exactly 2 measures
- combination: at least 2 measures
```

---

STEP: Color Palette (semantic coloring) in manifest.json

DESCRIPTION: Define colorPalette under your app manifest to customize semantic coloring for supported chart types (line, bubble, combination, stacked column). Provide 4 entries keyed 0..3 for criticality states. For stable color mapping per-dimension (column stack), set bEnableStableColors and define dimensionSettings.

LANGUAGE: JSON

CODE:
```json
/* manifest.json top-level property for charts (semantic colors) */
"colorPalette": {
  "0": {
    "color": "sapUiChartPaletteSemanticNeutral",
    "legendText": "{{OTHERS}}"
  },
  "1": {
    "color": "sapUiChartPaletteSemanticBadDark1",
    "legendText": "{{BAD}}"
  },
  "2": {
    "color": "sapUiChartPaletteSemanticCriticalDark2",
    "legendText": "{{CRITICAL}}"
  },
  "3": {
    "color": "sapUiChartPaletteSemanticCritical",
    "legendText": "{{GOOD}}"
  }
}
```

LANGUAGE: JSON

CODE:
```json
/* Example: stable colors + per-dimension color rules under card settings (manifest.json -> sap.ovp.cards) */
"sap.ovp": {
  "cards": {
    "<card_id>": {
      "model": "<model_name>",
      "template": "sap.ovp.cards.charts.analytical",
      "settings": {
        "title": "<Card title>",
        "entitySet": "<entitySet>",
        "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#Eval_by_Currency_ColumnStacked",
        "bEnableStableColors": true,
        "colorPalette": {
          "dimensionSettings": {
            "<dimensionAttribute>": {
              "<dimensionValue1>": {
                "color": "sapUiChartPaletteSemanticGood",
                "dimensionValue": "<dimensionValue1>",
                "index": 0
              },
              "<dimensionValue2>": {
                "color": "sapUiChartPaletteSemanticNeutral",
                "dimensionValue": "<dimensionValue2>",
                "index": 1
              },
              "<dimensionValue3>": {
                "color": "sapUiChartPaletteSemanticCriticalDark2",
                "dimensionValue": "<dimensionValue3>",
                "index": 2
              }
            }
          }
        }
      }
    }
  }
}
```

NOTE: All four top-level colorPalette objects (0..3) are mandatory when using the semantic colorPalette. Use only SAP Fiori semantic palette color tokens. To order legends without specifying colors, define dimensionValue and index only; default colors will be used.

---

STEP: Data Labels in Analytical Charts (showDataLabel)

DESCRIPTION: Enable data labels for analytical charts by setting chartSettings.showDataLabel to true under sap.ovp in manifest.json. Default is false.

LANGUAGE: JSON

CODE:
```json
/* manifest.json: enable data labels globally for OVP charts */
"sap.ovp": {
  "globalFilterModel": "salesOrder",
  "globalFilterEntityType": "GlobalFilters",
  "chartSettings": {
    "showDataLabel": true
  }
  /* ... other sap.ovp properties ... */
}
```

---

STEP: References / Where to apply annotations

DESCRIPTION: Place annotation XML in your service annotation file or use CDS (ABAP / CAP) annotations in the corresponding view/entity. In manifest.json, update project root manifest.json under your UI application's webapp/manifest.json. Use qualifiers to reuse annotation entries for different cards.

LANGUAGE: Text

CODE:
```text
File locations:
- Annotation XML: annotation XML file referenced from the service (e.g., annotations.xml).
- ABAP CDS: annotate view VIEWNAME with { } within the CDS file in ABAP repository.
- CAP CDS: annotation blocks in .cds file or annotation file delivered with the service.
- manifest.json: webapp/manifest.json (UI application root).
```
--------------------------------

**TITLE**: Configuring Custom Messages for Cards (getCustomMessage extension)

**INTRODUCTION**: Define getCustomMessage in your extension controller to supply custom UI messages and optional success icons for individual cards. Use this to provide custom text for success-with-no-data and error scenarios. The framework shows a default icon for errors; provide sIcon only for success/no-data cases.

**TAGS**: fiori-elements-framework, messages, extension, cards, error-handling, sapui5

**STEP**: 1 - Add getCustomMessage to your extension controller

**DESCRIPTION**: Implement getCustomMessage(oResponse, sCardId) inside your extension controller file. The method is called per card; return an object with sMessage (string) and optional sIcon (SAP icon URI) for success-with-no-data scenarios, or sMessage for error scenarios. Return null or undefined to fall back to defaults.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/extension/ExtensionController.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("my.app.extension.ExtensionController", {
    /**
     * Provide custom messages/icons per card.
     * @param {object} oResponse Response object from the framework (may provide getParameters())
     * @param {string} sCardId  ID of the card requesting a message
     * @returns {object|null}    { sMessage: string, sIcon?: string } or null to use defaults
     */
    getCustomMessage: function (oResponse, sCardId) {
      // Example: handle only card with id "card001"
      if (sCardId === "card001") {
        var params = oResponse && typeof oResponse.getParameters === "function"
          ? oResponse.getParameters()
          : null;

        // When the operation succeeded but there is no data, return message + optional icon
        if (params && params.success) {
          return {
            sMessage: "My Custom Message for No Data",         // message shown on success/no-data
            sIcon: "sap-icon://message-information"            // optional icon for success/no-data
          };
        } else {
          // Error scenario: return only sMessage. Framework will display a default error icon.
          return {
            sMessage: "My Custom Message for Error"
          };
        }
      }

      // For other cards, return null to use default messaging behavior
      return null;
    }
  });
});
```

**STEP**: 2 - Returned object properties and behavior

**DESCRIPTION**: Use the following properties in the returned object. The framework interprets them as described.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sMessage": "string - the message text displayed to the user (required when returning an object)",
  "sIcon": "string - optional SAP icon URI (e.g. 'sap-icon://message-information'); typically used for success/no-data"
}
```

**STEP**: 3 - Notes and best practices

**DESCRIPTION**: 
- The framework shows a default error icon for error scenarios; you do not need to provide sIcon for errors.
- Return null/undefined to allow the framework to apply built-in default messages.
- Scope the getCustomMessage logic by sCardId to customize messages per card.
--------------------------------

**TITLE**: Configuring Date Fields with a Valid Date Range (OData V4)

**INTRODUCTION**: Show how to restrict selectable dates for Date properties in SAP Fiori elements (OData V4) using Validation.Minimum and Validation.Maximum annotations. Includes both literal-date and path-based approaches for XML annotations and CAP CDS.

**TAGS**: fiori-elements-framework, odata-v4, annotations, validation, date, cds, xml, cap

**STEP**: Prerequisites and vocabulary reference

**DESCRIPTION**: Ensure your service uses OData V4 and include the Validation vocabulary reference in the annotation XML. This reference is required for the Validation.Minimum and Validation.Maximum terms.

**LANGUAGE**: text

**CODE**:
```text
Include this reference at the top of your local annotation XML file:

<edmx:Reference Uri="https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Validation.V1.xml">
  <edmx:Include Alias="Validation" Namespace="Org.OData.Validation.V1" />
</edmx:Reference>

Note: This topic is only applicable to SAP Fiori elements for OData V4.
```

**STEP**: Literal date range — XML annotation (fixed minimum and maximum)

**DESCRIPTION**: Add Validation.Minimum and Validation.Maximum with Date literal values to disable invalid dates in the date picker. Place this in your local annotation XML (for example: annotations.xml).

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="4.0" xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx">
  <edmx:Reference Uri="https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Validation.V1.xml">
    <edmx:Include Alias="Validation" Namespace="Org.OData.Validation.V1" />
  </edmx:Reference>

  <!-- Target: com.service.Entity/DateProperty -->
  <edmx:Annotations Target="com.service.Entity/DateProperty">
    <edmx:Annotation Term="Validation.Minimum" Date="2024-07-01" />
    <edmx:Annotation Term="Validation.Maximum" Date="2024-12-31" />
  </edmx:Annotations>
</edmx:Edmx>
```

**STEP**: Literal date range — CAP CDS annotation (fixed minimum and maximum)

**DESCRIPTION**: In CAP CDS, annotate the Date field using the Validation annotation with $edmJson Date literals. Put this in your .cds model (e.g., schema.cds).

**LANGUAGE**: CDS

**CODE**:
```cds
namespace com.service;

entity Entity {
  DateProperty : Date @(Validation: {
    Minimum: {$edmJson: {$Date: '2024-07-01'}},
    Maximum: {$edmJson: {$Date: '2024-12-31'}}
  });
}
```

**STEP**: Path-based date range — XML annotation (minimum/maximum from other properties)

**DESCRIPTION**: Reference existing Date properties (e.g., MinimumDate and MaximumDate) with Path values in the XML annotation so the valid range is driven by entity properties.

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="4.0" xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx">
  <edmx:Reference Uri="https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Validation.V1.xml">
    <edmx:Include Alias="Validation" Namespace="Org.OData.Validation.V1" />
  </edmx:Reference>

  <!-- The Path values refer to properties on the same entity: MinimumDate and MaximumDate -->
  <edmx:Annotations Target="com.service.Entity/DateProperty">
    <edmx:Annotation Term="Validation.Minimum" Path="MinimumDate" />
    <edmx:Annotation Term="Validation.Maximum" Path="MaximumDate" />
  </edmx:Annotations>
</edmx:Edmx>
```

**STEP**: Path-based date range — CAP CDS annotation (minimum/maximum from other properties)

**DESCRIPTION**: Define MinimumDate and MaximumDate properties in the same entity and reference them in the Validation annotation. This makes the valid date range dynamic and driven by entity data.

**LANGUAGE**: CDS

**CODE**:
```cds
namespace com.service;

entity Entity {
  MinimumDate : Date;
  MaximumDate : Date;
  DateProperty : Date @(Validation: {
    Minimum: MinimumDate,
    Maximum: MaximumDate
  });
}
```

**STEP**: Notes and limitations

**DESCRIPTION**: Important limitations and actionable guidance.

**LANGUAGE**: text

**CODE**:
```text
- This configuration is only supported for OData V4 (SAP Fiori elements for OData V4).
- Use the literal-date approach when the valid range is fixed.
- Use the path-based approach when the valid range is driven by entity properties.
- Date validation using Path (MinimumDate/MaximumDate) is not supported in ABAP CDS annotations. For ABAP-based services, use a local XML annotation file (annotations.xml) to apply Validation.Minimum and Validation.Maximum.
```
--------------------------------

**TITLE**: Configuring Default Filter Values for Fiori Elements

**INTRODUCTION**: How to set default filter values for Fiori Elements filter bars using UI.SelectionVariant (XML, ABAP CDS, CAP CDS) or Common.FilterDefaultValue (XML, ABAP CDS, CAP CDS). Includes where to place annotations, manifest notes, and priority rules when combining sources (navigation context, user variants, FLP).

**TAGS**: fiori-elements-framework, selectionvariant, FilterDefaultValue, annotations, CDS, CAP, XML, manifest

**STEP**: 1 — Use UI.SelectionVariant to set default filters (XML)

**DESCRIPTION**: Define a UI.SelectionVariant in a local annotation XML file (e.g., annotations.xml) or as part of UI.SelectionPresentationVariant. Map the SelectionVariant in the app manifest (see configuring-default-settings-visualizations-sort-order-filter-values-49a6ba5.md). Use Parameters for parameter fields and SelectOptions for filter ranges. Place the XML annotation in the service annotations file for the Fiori Elements app.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.SelectionVariant" Qualifier="Default">
    <Record>
        <PropertyValue Property="Parameters">
            <Collection>
                <Record Type="UI.Parameter">
                    <PropertyValue Property="PropertyName" PropertyPath="P_CompanyCode" />
                    <PropertyValue Property="PropertyValue" String="EASI" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="SelectOptions">
            <Collection>
                <Record Type="UI.SelectOptionType">
                    <PropertyValue Property="PropertyName" PropertyPath="Customer"/>
                    <PropertyValue Property="Ranges">
                        <Collection> 
                            <Record Type="UI.SelectionRangeType">
                                <PropertyValue EnumMember="UI.SelectionRangeSignType/I" Property="Sign"/>
                                <PropertyValue EnumMember="UI.SelectionRangeOptionType/EQ" Property="Option"/>
                                <PropertyValue Property="Low" String="ABC"/>
                            </Record>
                        </Collection>
                    </PropertyValue>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 2 — Use UI.SelectionVariant in ABAP CDS (notes & sample)

**DESCRIPTION**: For ABAP CDS views, you can reference a selectionVariant-like annotation. SelectionOption (ranges) is not supported in ABAP CDS; use local XML annotations for ranges/SelectOptions. Use the ABAP CDS annotation to set simple parameter default values.

**LANGUAGE**: ABAP CDS

**CODE**:
```
@UI.selectionVariant: [
  {
    qualifier: 'SVForQuantity',
    parameters: [{name: 'PropertyName', value: 'P_CompanyCurrency' },{ name: 'PropertyValue', value: 'EASI'}]
  }
]
```

**STEP**: 3 — Use UI.SelectionVariant in CAP CDS

**DESCRIPTION**: In CAP (CDS for Node.js) annotation files, declare UI.SelectionVariant with $Type, Parameters and SelectOptions (including Ranges). Place this in your .cds file where your service/entity annotations are declared. Map qualifier in manifest if needed.

**LANGUAGE**: CAP CDS

**CODE**:
```
UI.SelectionVariant #Default : {
    Parameters : [
        {
            $Type : 'UI.Parameter',
            PropertyName : P_CompanyCode,
            PropertyValue : 'EASI'
        }
    ],
    SelectOptions : [
        {
            $Type : 'UI.SelectOptionType',
            PropertyName : Customer,
            Ranges : [
                {
                    $Type : 'UI.SelectionRangeType',
                    Sign : #I,
                    Option : #EQ,
                    Low : 'ABC'
                }
            ]
        }
    ]
}
```

**STEP**: 4 — Use Common.FilterDefaultValue for single-value defaults (XML)

**DESCRIPTION**: Use Common.FilterDefaultValue when you need to apply a single default value to a filter field. This annotation does not support complex expressions or multiple values. Place in local annotation XML targeting the entity/field.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType/Supplier">
    <Annotation Term="Common.FilterDefaultValue" String="100000047"/>
</Annotations>
```

**STEP**: 5 — Use Common.FilterDefaultValue in ABAP CDS

**DESCRIPTION**: Annotate the field in ABAP CDS to provide a simple string default value.

**LANGUAGE**: ABAP CDS

**CODE**:
```
@Consumption.filter.defaultValue: '100000047'
Supplier;
```

**STEP**: 6 — Use Common.FilterDefaultValue in CAP CDS

**DESCRIPTION**: Annotate the entity field in CAP CDS to set a default value.

**LANGUAGE**: CAP CDS

**CODE**:
```
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with {
    @Common.FilterDefaultValue : '100000047'
    Supplier
};
```

**STEP**: 7 — Important notes and manifest flags to apply

**DESCRIPTION**: Consolidated actionable notes you must follow when implementing default filter values.

**LANGUAGE**: Text

**CODE**:
```
- Priority: If a SelectionVariant is provided it takes precedence over Common.FilterDefaultValue for all other filters.
- Annotations are applied only on application load and only when the app is launched with the standard variant.
- Annotation default values do not change filter field visibility.
- Annotation default values are overwritten entirely by an incoming navigation context.
- Use YYYY-MM-DD format for date default values.
- DisplayCurrency: default values can also come from SAP Fiori Launchpad (FLP). See navigation-to-an-app-inbound-navigation-c337d8b.md#HandlingDefault for FLP handling.
- For Analytical List Page (ALP) in Fiori elements OData V2, set manifest property:
    "sap.ui.generic.app": {
      "settings": {
        "filterDefaultsFromSelectionVariant": true
      }
    }
  to ensure SelectionVariant defaults are considered.
- ABAP CDS: SelectionOption (SelectOptions/Ranges) not supported — use local XML annotations for ranges.
```

**STEP**: 8 — Combining multiple sources of filter values (priority & merge rules)

**DESCRIPTION**: Apply sources in this priority order and merge rules when standard variant + FLP user defaults are present.

**LANGUAGE**: Text

**CODE**:
```
Priority (highest to lowest):
1. Navigation context (includes FLP tile target mapping/defaults) — overrides everything.
2. User-defined default variant (distinct from standard variant, no navigation context) — overrides FLP and annotations.
3. Standard variant (no navigation context) combined with annotations (UI.SelectionVariant or Common.FilterDefaultValue).

Merge rules when Standard variant + FLP user defaults exist:
- If only FLP user default values exist for a field, they are retained.
- If only annotation defaults exist for a field, annotation defaults are retained.
- If both FLP user defaults and annotation defaults exist for a field, only FLP user default values are used (annotation ignored).
Tip: FLP user defaults mark the standard variant as dirty (unlike annotation/manifest defaults).
```

**STEP**: 9 — Restriction for ALP on OData V4

**DESCRIPTION**: For Analytical List Page (ALP) applications built on OData V4, you cannot define default values for filter fields using UI.SelectionVariant. Use alternate approaches (manifest or filter default annotations where applicable).

**LANGUAGE**: Text

**CODE**:
```
Restriction: SelectionVariant-based default values are not supported for analytical list page-based apps on OData V4.
```

**STEP**: 10 — References and next steps

**DESCRIPTION**: Files and docs to consult when implementing.

**LANGUAGE**: Text

**CODE**:
```
- Manifest configuration for specifying SelectionVariant: configuring-default-settings-visualizations-sort-order-filter-values-49a6ba5.md
- Handling default values from FLP: navigation-to-an-app-inbound-navigation-c337d8b.md#HandlingDefault
- Adapting and visual filter bar docs:
  - adapting-the-filter-bar-609c39a.md
  - configuring-the-visual-filter-bar-33f3d80.md
```
--------------------------------

**TITLE**: Configure Default Visualizations, Sort Order, and Filter Defaults with UI.SelectionPresentationVariant

**INTRODUCTION**: This guide shows how to configure default visualizations (tables/charts), default sort order, default filter values, requested properties, and initial row counts for SAP Fiori elements apps using the UI.SelectionPresentationVariant, UI.SelectionVariant, UI.PresentationVariant, UI.LineItem, and UI.Chart annotations. Includes examples for XML (OData V2/V4), ABAP CDS, CAP CDS, and manifest.json settings for both OData V2 and V4.

**TAGS**: fiori-elements, annotations, SelectionPresentationVariant, PresentationVariant, SelectionVariant, LineItem, Chart, manifest.json, ODataV2, ODataV4, ABAP-CDS, CAP-CDS

STEP: Define UI.SelectionPresentationVariant (link SelectionVariant + PresentationVariant)

DESCRIPTION: Configure a named SelectionPresentationVariant that references a SelectionVariant qualifier and a PresentationVariant qualifier. This central annotation configures the default visualization and default filters when used as the default variant in the manifest or via fallback logic.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="self.BookingType">
    ...
    <Annotation Term="UI.SelectionPresentationVariant" Qualifier="BookingSPV">
        <Record>
            <PropertyValue Property="Text" String="Default"/>
            <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#BookingSV"/>
            <PropertyValue Property="PresentationVariant" Path="@UI.PresentationVariant#BookingPV"/>
        </Record>
    </Annotation>
    ...
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
//@Scope: [ENTITY] ("Booking")
@UI: {
    selectionPresentationVariant: [ {
        qualifier: 'BookingSPV',
        selectionVariantQualifier: 'BookingSV',
        presentationVariantQualifier: 'BookingPV'
    } ],
    ...
}
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate TravelService.Travel with @UI: {
    SelectionPresentationVariant #BookingSPV : {
        SelectionVariant : ![@UI.SelectionVariant#BookingSV],
        PresentationVariant : ![@UI.PresentationVariant#BookingPV]
    }
    ...
}
```

STEP: Define UI.SelectionVariant (default filter values)

DESCRIPTION: Define default filter values applied to the filter bar (SelectionVariant). Use SelectOptions and Ranges for equality or other range predicates.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="self.BookingType">
    ...
    <Annotation Term="UI.SelectionVariant" Qualifier="BookingSV">
        <Record>
            <PropertyValue Property="SelectOptions">
                <Collection>
                    <Record Type="UI.SelectOptionType">
                        <PropertyValue Property="PropertyName" PropertyPath="BookingStatus"/>
                        <PropertyValue Property="Ranges">
                            <Collection>
                                <Record Type="UI.SelectionRangeType">
                                    <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I"/>
                                    <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ"/>
                                    <PropertyValue Property="Low" String="N"/>
                                </Record>
                            </Collection>
                        </PropertyValue>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
    ...
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
//@Scope: [ENTITY] (e.g. "Booking")
@UI: {
    selectionVariant: [ { 
        qualifier: 'BookingSV',
        filter: 'BookingStatus EQ "N"'
    } ]
}
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate TravelService.Travel with @UI: {
    SelectionVariant #BookingSV: {
        SelectOptions: [ {
            $Type       : 'UI.SelectOptionType',
            PropertyName: BookingStatus,
            Ranges      : [ {
                $Type : 'UI.SelectionRangeType',
                Sign  : #I,
                Option: #EQ,
                Low   : 'N'
            } ]
        } ]
    },
    ...
}
```

STEP: Define UI.PresentationVariant (visualizations, sort order, max items)

DESCRIPTION: Configure which visualization to show (UI.LineItem or UI.Chart), default SortOrder, and MaxItems (initial row count). Provide a PresentationVariant qualifier and reference it from a SelectionPresentationVariant.

LANGUAGE: XML (OData V4 sample)
CODE:
```xml
<Annotations Target="self.BookingType">
    ...
    <Annotation Term="UI.PresentationVariant" Qualifier="BookingPV">
        <Record>
            <PropertyValue Property="Text" String="Default"/>
            <PropertyValue Property="SortOrder">
                <Collection>
                    <Record Type="Common.SortOrderType">
                        <PropertyValue Property="Property" PropertyPath="BookingID"/>
                        <PropertyValue Property="Descending" Bool="true"/>
                    </Record>
 
                </Collection>
            </PropertyValue>
            <PropertyValue Property="Visualizations">
                <Collection>
                    <AnnotationPath>@UI.LineItem</AnnotationPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
    ...
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
//@Scope: [ENTITY] ("Booking")
@UI: {
    presentationVariant: [ { 
        qualifier: 'BookingPV',
        sortOrder: [ {
            by: 'BookingID',
            direction: #DESC
        } ],
        visualizations: [ {
            type: #AS_LINEITEM
        } ]
   } ]
}
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate TravelService.Travel with @UI: {
    PresentationVariant #BookingPV: {
        SortOrder : [
            {
                $Type : 'Common.SortOrderType',
                Property : BookingID,
                Descending : true
            }
        ],
        Visualizations : [
            '@UI.LineItem'
        ]
    },
    ...
}
```

STEP: Define UI.Chart (chart visualization)

DESCRIPTION: Annotate a type with UI.Chart to define a chart visualization: title, chart type, dimensions, and measures. This can be used for ALP main chart or as table views.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType">
   <Annotation Term="UI.Chart">
      <Record>
         <PropertyValue Property="Title" String="Test Chart"/>
         <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
         <PropertyValue Property="Dimensions">
            <Collection>
               <PropertyPath>DeliveryMonth</PropertyPath>
            </Collection>
         </PropertyValue> 
         <PropertyValue Property="Measures">
            <Collection>
               <PropertyPath>Revenue</PropertyPath>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Chart: [
  {
    title: 'Test Chart',
    chartType: #COLUMN,
    dimensions: [
      'DELIVERYMONTH'
    ],
    measures: [
      'REVENUE'
    ]
  }
]
annotate view STTA_C_MP_PRODUCTSALESDATA with {
}
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType @(
  UI.Chart : {
    Title : 'Test Chart',
    ChartType : #Column,
    Dimensions : [
        DeliveryMonth
    ],
    Measures : [
        Revenue
    ]
  }
);
```

STEP: Define UI.LineItem (table columns and importance)

DESCRIPTION: Define the list of fields displayed in list report / table using UI.LineItem and configure position, importance, text arrangement, and criticality mappings.

LANGUAGE: XML
CODE:
```xml
<Annotations Target="self.Container/Booking">

    <Annotation Term="UI.LineItem">
        <Collection>
            <Record Type="UI.DataField">
                <PropertyValue Property="Value" Path="TravelID"/>
                <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            </Record>
            <Record Type="UI.DataField">
                <PropertyValue Property="Value" Path="BookingID"/>
                <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            </Record>
            <Record Type="UI.DataField">
                <PropertyValue Property="Value" Path="BookingDate"/>
                <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            </Record>
            <Record Type="UI.DataField">
                <PropertyValue Property="Value" Path="CustomerID"/>
                <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            </Record>
            <Record Type="UI.DataField">
                <PropertyValue Property="Value" Path="CarrierID"/>
                <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            </Record>
            <Record Type="UI.DataField">
                <PropertyValue Property="Value" Path="ConnectionID"/>
                <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            </Record>
            <Record Type="UI.DataField">
                <PropertyValue Property="Value" Path="FlightDate"/>
                <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            </Record>
            <Record Type="UI.DataField">
                <PropertyValue Property="Value" Path="FlightPrice"/>
                <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            </Record>
            <Record Type="UI.DataField">
                <PropertyValue Property="Criticality" Path="BookingStatusIndicator"/>
                <PropertyValue Property="Value" Path="BookingStatus"/>
                <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            </Record>
        </Collection>
    </Annotation>
    ...
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
//@Scope: [VIEW] ("BOOKING")
annotate view VIEWNAME with {
    @UI.lineItem: [ {
        position: 10 ,
        importance: #HIGH
    } ]
    TravelID;
    
    @UI.lineItem: [ {
        position: 20 ,
        importance: #HIGH
    } ]
    BookingID;
    
    @UI.lineItem: [ {
        position: 30 ,
        importance: #HIGH
    } ]
    BookingDate;
    
    @UI.lineItem: [ {
        position: 40 ,
        importance: #HIGH
    } ]
    @UI.textArrangement: #TEXT_FIRST
    CustomerID;
    
    @UI.lineItem: [ {
        position: 50 ,
        importance: #HIGH
    } ]
    CarrierID;
    
    @UI.lineItem: [ {
        position: 60 ,
        importance: #HIGH
    } ]
    ConnectionID;
    
    @UI.lineItem: [ {
        position: 70 ,
        importance: #HIGH
    } ]
    FlightDate;
    
    @UI.lineItem: [ {
        position: 80 ,
        importance: #HIGH
    } ]
    FlightPrice;
    
    @UI.lineItem:       [ {
        position: 90,
        criticality: 'BookingStatusIndicator',
        importance: #HIGH
    } ]
    BookingStatus;
}
```

LANGUAGE: CAP CDS
CODE:
```cds
UI.LineItem : [
    {
        $Type : 'UI.DataField',
        Value : TravelID,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataField',
        Value : BookingID,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataField',
        Value : BookingDate,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataField',
        Value : CustomerID,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataField',
        Value : CarrierID,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataField',
        Value : ConnectionID,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataField',
        Value : FlightDate,
        ![@UI.Importance] : #High
    },
    {
        $Type : 'UI.DataField',
        Value : FlightPrice,
        ![@UI.Importance] : #High
    },
    {
        $Type       : 'UI.DataField',
        Value       : BookingStatus,
        Criticality : BookingStatusIndicator,
        ![@UI.Importance] : #High
    }
]
```

STEP: Inline SelectionVariant / PresentationVariant inside SelectionPresentationVariant

DESCRIPTION: You can inline a SelectionVariant record inside your SelectionPresentationVariant. ABAP CDS does not support inline syntax—use XML or CAP where supported.

LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.SelectionPresentationVariant" Qualifier="OpenSPVWithPVPath">
   <Record>
    <PropertyValue Property="Text" String="Open">
    </PropertyValue>
    <PropertyValue Property="SelectionVariant">
        <Record Type="UI.SelectionVariantType">
            <PropertyValue Property="Text" String="Open">
            </PropertyValue>
            <PropertyValue Property="SelectOptions">
                <Collection>
                    <Record Type="UI.SelectOptionType">
                        <PropertyValue Property="PropertyName" PropertyPath="OverallSDProcessStatus" />
                        <PropertyValue Property="Ranges">
                            <Collection>
                               <Record Type="UI.SelectionRangeType">
                                   <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                                   <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                                   <PropertyValue Property="Low" String="A" />
                                </Record>
                            </Collection>
                        </PropertyValue>
                     </Record>
                </Collection>
            </PropertyValue>
        </Record>
     </PropertyValue>
     <PropertyValue Property="PresentationVariant" Path="@UI.PresentationVariant" />
   </Record>
</Annotation>

<Annotation Term="UI.PresentationVariant">
    <Record>
        <PropertyValue Property="MaxItems" Int="2" />
        <PropertyValue Property="SortOrder">
            <Collection>
                <Record Type="Common.SortOrderType">
                  <PropertyValue Property="Property" PropertyPath="ID" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Visualizations">
            <Collection>
                <AnnotationPath>@UI.LineItem</AnnotationPath>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```text
/* ABAP CDS does not support inline SelectionVariant syntax.
   Use local XML annotation for inline SelectionVariant in ABAP CDS scenarios. */
```

LANGUAGE: CAP CDS
CODE:
```cds
UI.SelectionPresentationVariant #OpenSPVWithPVPath           : {
        Text                : 'Open',
        SelectionVariant    : {
            Text          : 'Open',
            SelectOptions : [{
                PropertyName : OverallSDProcessStatus,
                Ranges       : [{
                      Sign : #I,
                    Option : #EQ,
                   Low    : 'A'
                }]
            }]
        },
        PresentationVariant : ![@UI.PresentationVariant]
    },

UI.PresentationVariant                             : {
        MaxItems       : 2,
        SortOrder      : [{Property : ID}],
        Visualizations : ['@UI.LineItem']
    }
```

STEP: Request additional properties (RequestAtLeast)

DESCRIPTION: Ensure the service returns properties not displayed in the table but required for client-side operations by using PresentationVariant.RequestAtLeast.

LANGUAGE: XML
CODE:
```xml
<Annotations xmlns=http://docs.oasis-open.org/odata/ns/edm Target="ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item">
    <Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant">
        <Record>
            <PropertyValue Property="Visualizations">
                <Collection>
                    <AnnotationPath>@UI.LineItem</AnnotationPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="RequestAtLeast">
                <Collection>
                    <PropertyPath>Customer</PropertyPath>
                    <PropertyPath>CompanyCode</PropertyPath>
               </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.PresentationVariant: [
  {
    requestAtLeast: [
      'CUSTOMER',
      'COMPANYCODE'
    ],
    visualizations: [{type: #AS_LINEITEM }]
  }
]
annotate view ITEM with {
 
}
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item @(
  com.sap.vocabularies.UI.v1.PresentationVariant : {
    Visualizations : [
        '@UI.LineItem'
    ],
    RequestAtLeast : [
        Customer,
        CompanyCode
    ]
  }
);
```

STEP: Configure default SortOrder (ascending/descending)

DESCRIPTION: Define SortOrder entries inside PresentationVariant (or separate PresentationVariant) to control default sorting of table columns. When sorting amounts with currency/UoM, the currency/UoM is sorted first, then the amount.

LANGUAGE: XML
CODE:
```xml
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item">
    <Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant">
        <Record>
            <PropertyValue Property="Visualizations">
                <Collection>
                    <AnnotationPath>@UI.LineItem</AnnotationPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="SortOrder">
                <Collection>
                    <Record>
                        <PropertyValue Property="Property" PropertyPath="CompanyCode"/>
                        <PropertyValue Property="Descending" Bool="true"/>
                    </Record>
                    <Record>
                        <PropertyValue Property="Property" PropertyPath="Customer"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.PresentationVariant: [
  {
    
    sortOrder: [
      {
        by: 'COMPANYCODE',
        direction: #DESC
      },
      {
        by: 'CUSTOMER'
      }
    ],
    visualizations: [{type: #AS_LINEITEM }]
  }
]
annotate view ITEM with {

}
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item @(
  com.sap.vocabularies.UI.v1.PresentationVariant : {
    Visualizations : [
        '@UI.LineItem'
    ],
    
    SortOrder : [
        {
            Property : CompanyCode,
            Descending : true
        },
        {
            Property : Customer
        }
    ]
  }
);
```

STEP: Configure MaxItems (number of rows initially loaded)

DESCRIPTION: Use PresentationVariant.MaxItems to set the initial number of rows the UI should request for the table.

LANGUAGE: XML
CODE:
```xml
<Annotations xmlns=http://docs.oasis-open.org/odata/ns/edm Target="ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item">
    <Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant">
        <Record>
            <PropertyValue Property="Visualizations">
                <Collection>
                    <AnnotationPath>@UI.LineItem</AnnotationPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="MaxItems" Int="50" />
        </Record>
    </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.PresentationVariant: [
  {
    maxItems : 50,
    visualizations: [{type: #AS_LINEITEM }]
  }
]
annotate view ITEM with {

}
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item @(
  com.sap.vocabularies.UI.v1.PresentationVariant : {
    Visualizations : [
        '@UI.LineItem'
    ],
    MaxItems : 50
  }
);
```

STEP: manifest.json configuration (OData V2): annotationPath in List Report

DESCRIPTION: In manifest.json for SAP Fiori elements OData V2 List Report use component.settings.annotationPath to point to an annotation (SelectionPresentationVariant#/PresentationVariant#/SelectionVariant#Qualifier). If pointing to PresentationVariant or SelectionVariant, behavior differs (see next step).

LANGUAGE: JSON
CODE:
```json
"component": {
     "name": "sap.suite.ui.generic.template.ListReport",
     "list": true,
     "settings": {
          "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#DefaultSPV" // This can also point to PresentationVariant/SelectionVariant instead of SelectionPresentationVariant
     }
}
```

STEP: manifest.json behaviors when annotationPath points to PV or SV (OData V2)

DESCRIPTION: Behavior when specifying presentation or selection variant paths in annotationPath:
- If annotationPath references a PresentationVariant: only presentation (visualization) is applied; SelectionVariant has no default filter values (no selection applied).
- If annotationPath references a SelectionVariant: only default filters are applied; visualization falls back to default unqualified PresentationVariant, or to UI.LineItem/UI.Chart.

LANGUAGE: JSON
CODE:
```text
/* Behavior summary (no code):
 - annotationPath => PresentationVariant: presentation applied; no default SelectionVariant applied.
 - annotationPath => SelectionVariant: default filters applied; visualization resolved from default unqualified PresentationVariant or fallback to UI.LineItem/UI.Chart.
*/
```

STEP: manifest.json configuration (OData V4): defaultTemplateAnnotationPath

DESCRIPTION: For OData V4 Fiori elements List Report (sap.fe.templates.ListReport) configure the target's options.settings.defaultTemplateAnnotationPath to reference a SelectionPresentationVariant only (it must reference a SelectionPresentationVariant, not PresentationVariant or SelectionVariant).

LANGUAGE: JSON
CODE:
```json
"targets": {
    "SalesOrderManageList": {
        "type": "Component",
        "id": "SalesOrderManageList",
        "name": "sap.fe.templates.ListReport",
        "options": {
            "settings": {
                "contextPath": "/SalesOrderManage",
                "defaultTemplateAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#SPVPath"
            }
        }
    }
}
```

STEP: Fallback order and error conditions

DESCRIPTION: Follow this processing order when no explicit manifest default is provided. Ensure correct annotation paths; if a SelectionPresentationVariant is defined but its PresentationVariant reference is missing or invalid, the app will raise an error and stop loading.

LANGUAGE: text
CODE:
```text
Fallback order used by SAP Fiori elements (when no manifest default is defined):
1) Use default unqualified UI.SelectionPresentationVariant (and its referenced SelectionVariant + PresentationVariant) if found.
2) Else, use default unqualified UI.SelectionVariant + default unqualified UI.PresentationVariant.
3) Else, use default UI.LineItem or UI.Chart for visualization.
4) Else, render empty table/chart (end users can personalize).

Important error conditions:
- If a UI.SelectionPresentationVariant is referenced (in manifest or as default) but the associated UI.PresentationVariant is missing or path is invalid, SAP Fiori elements raises an error and stops loading the application.
- If a UI.PresentationVariant is found but Visualizations is not defined, the system falls back to default unqualified UI.LineItem or UI.Chart. If none present, an empty control is rendered.
```

STEP: Applicability notes and references

DESCRIPTION: Practical notes:
- UI.Chart is applicable for ALP main chart and list report multiple views. For ALP manifest configuration in OData V4 see "Configuring the Manifest for the Analytical List Page".
- PresentationVariant.Visualizations must point to a valid visualization when defining PresentationVariant.
- For multiple views, PresentationVariant is only fetched if undefined in the multiple views logic (see multiple views docs).
- In OData V4 ALP flavor, PresentationVariant usage described here is not applicable; ALP uses dedicated configuration.
- For object page facets in OData V4, PresentationVariant/SelectionPresentationVariant can be used to render tables in facets.

LANGUAGE: text
CODE:
```text
Related docs (preserve for implementation guidance):
- Configuring the Manifest for the Analytical List Page
- Defining Multiple Views on a List Report Table - Multiple Table Mode
- Defining Multiple Views on a List Report with Different Entity Sets and Table Settings
- Defining and Adapting Sections (object page facets)
- Configuring Tables
- Configuring Charts
- Loading Behavior of Data on Initial Launch of the Application
- Initial Expansion Level for Tables in List Reports & Analytical List Pages
- Configuring Default Filter Values
```
--------------------------------

**TITLE**: Configure SAPUI5 Library Dependencies in webapp/manifest.json

**INTRODUCTION**: Instructions and code examples to declare SAPUI5 library dependencies (for example sap.ovp) in a Fiori Elements application's manifest.json to improve load performance and ensure required UI5 versions are loaded.

**TAGS**: fiori-elements, sapui5, manifest.json, sap.ovp, performance, dependencies

**STEP**: 1 — Locate or create the "sap.ui5" section in manifest.json

**DESCRIPTION**: Open your application manifest.json (typically at webapp/manifest.json). If the "sap.ui5" section does not exist, add a skeleton "dependencies" block. Set a project-wide minUI5Version and prepare the "libs" object for specific library entries.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "dependencies": {
      "minUI5Version": "1.32.0",
      "libs": {
      }
    }
  }
}
```

**STEP**: 2 — Add the sap.ovp library dependency

**DESCRIPTION**: Add an entry for the sap.ovp library under "sap.ui5" → "dependencies" → "libs". Use "minVersion" to pin the minimum required version of that library. Ensure "minUI5Version" is compatible with the library minimum.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "dependencies": {
      "minUI5Version": "1.32.0",
      "libs": {
        "sap.ovp": {
          "minVersion": "1.32.0"
        }
      }
    }
  }
}
```

**STEP**: 3 — Add multiple libraries (example)

**DESCRIPTION**: To predeclare additional UI5 libraries that your app requires (reduces runtime discovery/loading overhead), add them under "libs". Each library can specify a "minVersion". Example includes sap.ui.core and sap.m alongside sap.ovp.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "dependencies": {
      "minUI5Version": "1.60.0",
      "libs": {
        "sap.ui.core": {
          "minVersion": "1.60.0"
        },
        "sap.m": {
          "minVersion": "1.60.0"
        },
        "sap.ovp": {
          "minVersion": "1.60.0"
        }
      }
    }
  }
}
```

**STEP**: 4 — Save and verify build/runtime

**DESCRIPTION**: Save manifest.json and run your usual build/serve process (e.g., npm run build / ui5 serve). Verify in browser network tools that required UI5 library bundles are loaded as expected and that the application runs with the declared minimum versions.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "note": "No additional JSON changes required here. Run your build/serve and verify network/bundle loading in the browser."
}
```
--------------------------------

**TITLE**: Configuring External Navigation (Outbound and Inbound) for SAP Fiori Elements

**INTRODUCTION**: Quick, code-focused guide to configure intent-based (semantic object) outbound and inbound navigation for SAP Fiori apps. Covers manifest.json entries, calling outbound intents from controllers, and reading inbound startup parameters in Component/Controller.

**TAGS**: fiori-elements, sapui5, manifest.json, crossNavigation, outbound, inbound, sap.ushell, CrossApplicationNavigation, startupParameters

**STEP**: 1 — Configure outbound navigation in manifest.json

**DESCRIPTION**: Define outbound intents your app can trigger. Place this under webapp/manifest.json -> sap.app.crossNavigation.outbounds. Each outbound has semanticObject, action, optional signature, and resolutionResult describing the target (another app or URL).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "your.app.namespace",
    "crossNavigation": {
      "outbounds": {
        "toProductDisplay": {
          "semanticObject": "Product",
          "action": "display",
          "title": "Display Product App",
          "signature": {
            "parameters": {
              "ProductId": {}
            },
            "additionalParameters": "allowed"
          },
          "resolutionResult": {
            "applicationType": "URL",
            "url": "https://example.com/product?ProductId={ProductId}"
          }
        },
        "toSalesOrderApp": {
          "semanticObject": "SalesOrder",
          "action": "manage",
          "title": "Open Sales Order App",
          "signature": {
            "parameters": {
              "SalesOrderId": {}
            },
            "additionalParameters": "ignored"
          },
          "resolutionResult": {
            "applicationType": "SAPUI5",
            "additionalInformation": "SAPUI5.Component=target.app.namespace",
            "url": "/sap/bc/ui5_ui5/sap/target.app.namespace/"
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Trigger outbound navigation from a controller (intent-based)

**DESCRIPTION**: Use the CrossApplicationNavigation service to navigate to a semantic object/action with parameters. Typical file path: webapp/controller/MyController.controller.js

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/controller/MyController.controller.js (SAPUI5)
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("your.app.namespace.controller.MyController", {
    onGoToProduct: function () {
      var oCrossAppNavigator = sap.ushell.Container.getService("CrossApplicationNavigation");
      // To target the outbound defined in manifest: use semanticObject + action
      oCrossAppNavigator.toExternal({
        target: {
          semanticObject: "Product",
          action: "display"
        },
        params: {
          ProductId: ["12345"]
        }
      });
    }
  });
});
```

**STEP**: 3 — Configure inbound navigation in manifest.json

**DESCRIPTION**: Define inbound intents your app responds to. Place definitions under webapp/manifest.json -> sap.app.crossNavigation.inbounds. Each inbound has semanticObject, action, signature, title, and resolutionResult describing how the FLP should start your app (SAPUI5 component / URL).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "target.app.namespace",
    "crossNavigation": {
      "inbounds": {
        "Product-display": {
          "semanticObject": "Product",
          "action": "display",
          "title": "Product Display",
          "signature": {
            "parameters": {
              "ProductId": {
                "required": true
              }
            },
            "additionalParameters": "allowed"
          },
          "resolutionResult": {
            "applicationType": "SAPUI5",
            "additionalInformation": "SAPUI5.Component=target.app.namespace",
            "url": "/sap/bc/ui5_ui5/sap/target.app.namespace/"
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Read inbound startup parameters in Component.js (or controller)

**DESCRIPTION**: When launched via an inbound intent, startup parameters are available in component data. Typical file path: webapp/Component.js or in a controller via this.getOwnerComponent().getComponentData().

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/Component.js (inside init or in a controller onInit)
sap.ui.define([
  "sap/ui/core/UIComponent"
], function (UIComponent) {
  "use strict";

  return UIComponent.extend("target.app.namespace.Component", {
    init: function () {
      UIComponent.prototype.init.apply(this, arguments);

      // Component startup parameters from inbound navigation
      var oComponentData = this.getComponentData(); // available when launched by FLP intent
      var oStartupParams = oComponentData && oComponentData.startupParameters;

      // Example: read ProductId (array of values)
      var sProductId = (oStartupParams && oStartupParams.ProductId && oStartupParams.ProductId[0]) || null;

      if (sProductId) {
        // Use sProductId to initialize route / OData binding / view state
        // e.g., this.getRouter().navTo("detail", { ProductId: sProductId }, true);
      }
    }
  });
});
```

**STEP**: 5 — Examples: inbound additionalParameters and parameter mapping considerations

**DESCRIPTION**: How to control additional (unexpected) URL parameters and parameter shapes; how to map parameters to routing/startup logic.

**LANGUAGE**: JSON, JavaScript

**CODE**:
```json
// manifest.json snippet showing allowed/ignored additionalParameters
{
  "signature": {
    "parameters": {
      "A": {},
      "B": {}
    },
    "additionalParameters": "ignored" // or "allowed" or "mandatory"
  }
}
```

```javascript
// Handling multiple values and additional parameters in Component/controller
var oComponentData = this.getComponentData();
var oStartParams = oComponentData && oComponentData.startupParameters;

// Multiple values: ProductId: ["1","2"]
var aProductIds = oStartParams && oStartParams.ProductId;

// Additional parameters (allowed) can be read from oStartParams directly
var sExtra = oStartParams && oStartParams.SomeExtra && oStartParams.SomeExtra[0];
```

**STEP**: 6 — Navigation to external URL (non-FLP) from outbound

**DESCRIPTION**: If an outbound resolutionResult uses applicationType "URL", you can open those URLs via CrossApplicationNavigation.toExternal with shellHash or by window.open for direct URLs.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Using CrossApplicationNavigation to call an outbound that resolves to a URL
var oCrossAppNavigator = sap.ushell.Container.getService("CrossApplicationNavigation");
oCrossAppNavigator.toExternal({
  target: {
    semanticObject: "Product",
    action: "display"
  },
  params: {
    ProductId: ["123"]
  }
});

// Direct URL fallback (if not using FLP)
window.open("https://example.com/product?ProductId=123", "_blank");
```


--------------------------------

**TITLE**: Configuring Fields for SAP Fiori elements (OData V4)

**INTRODUCTION**: Action-oriented reference for configuring field display, placeholders, formatting, and validation in SAP Fiori elements (OData V4). Contains ready-to-use annotation and manifest/CDS snippets for common field scenarios: placeholder text, Date/Time formatting, currency and unit validation, and Edm.Guid validation.

**TAGS**: fiori-elements-framework, OData V4, annotations, UI.Placeholder, UI.DateTimeStyle, manifest.json, CDS, CAP, ABAP, isCurrency, isUnit, Edm.Guid

STEP: 1 — Scope / Applicability
DESCRIPTION: This guidance applies only to SAP Fiori elements for OData V4. Use the provided XML annotation snippets in your annotation files (e.g., annotations.xml), CDS snippets in ABAP CDS or CAP service definitions, and manifest.json modifications in the UI application.
LANGUAGE: text
CODE:
```
Note: Applicable only to SAP Fiori elements for OData V4.
```

STEP: 2 — Set Placeholder Text for Input Fields
DESCRIPTION: Add a UI.Placeholder annotation to show placeholder text in input controls (sap.m.Input, sap.m.ComboBox). Place this in your service annotation file (annotations.xml) targeting the property path: <EntitySet>/<PropertyName>.
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations.xml (or local annotation file referenced in manifest) -->
<Annotations Target="sap.fe.manageitems.TechnicalTestingService.LineItems/multiLineTextField">
    <Annotation Term="Common.Label" String="Test Multi Line Text Field"/>
    <Annotation Term="UI.MultiLineText" Bool="true"/>
    <Annotation Term="UI.Placeholder" String="Enter a multi line text"/>
</Annotations>
```

STEP: 3 — Format Date, Time, and DateTime Fields using DateTimeStyle
DESCRIPTION: Use the UI.DateTimeStyle annotation with values 'short', 'medium', 'long', or 'full' to control how Date, Time, and DateTime properties are displayed in edit and display modes. Include the UI vocabulary reference (edmx:Reference) if you add local XML annotations.
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations.xml (include UI vocabulary reference) -->
<edmx:Reference Uri="https://sap.github.io/odata-vocabularies/vocabularies/UI.xml">
    <edmx:Include Namespace="com.sap.vocabularies.UI.v1" Alias="UI"/>
</edmx:Reference>

<!-- Example: set DateTimeStyle to 'short' for CreatedAt -->
<Annotations Target="SAP__self.TravelType/CreatedAt">
    <Annotation Term="UI.DateTimeStyle" String="short"/>
</Annotations>
```

STEP: 4 — Format Date/Time with custom LDML pattern (manifest.json)
DESCRIPTION: For custom date/time display patterns, define an LDML pattern in the UI application's manifest.json. Use standard LDML pattern letters (e.g., yyyy-MM-dd). Place the pattern under the UI5 configuration section so the Fiori client picks it up.
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": { /* ... */ },
  "sap.ui5": {
    "config": {
      "formatSettings": {
        "pattern": {
          "date": "yyyy-MM-dd",
          "time": "HH:mm:ss",
          "dateTime": "yyyy-MM-dd'T'HH:mm:ss"
        }
      }
    }
  }
}
```

STEP: 5 — DateTimeStyle examples for CDS (CAP and ABAP)
DESCRIPTION: Examples showing how to set DateTimeStyle in CAP CDS and ABAP CDS (use local XML annotation for OData annotations in ABAP if needed).
LANGUAGE: CDS
CODE:
```cds
// File: service.cds (CAP)
DatePropertyWithStyle          : Date     @UI: { DateTimeStyle: 'short' };
TimePropertyWithStyle          : Time     @UI: { DateTimeStyle: 'short' };
DateTimePropertyWithStyle      : DateTime @UI: { DateTimeStyle: 'short' };
```

LANGUAGE: ABAP CDS
CODE:
```abap
" ABAP CDS (example annotation in CDS source)
@UI.DateTimeStyle: 'short'
key CreatedAt : abap.dats;
```

STEP: 6 — Validate Currency fields without a related value field
DESCRIPTION: Mark currency properties as currency semantics so the framework validates them even when there is no related numeric value property. Use Common.isCurrency (XML), @Semantics.currencyCode (ABAP CDS), or Common.IsCurrency (CAP CDS).
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations.xml -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/TransactionCurrency">
    <Annotation Term="Common.isCurrency" Bool="true"/>
    <!-- ... additional value help or property definition ... -->
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
" ABAP CDS
@Semantics.currencyCode: true
TransactionCurrency : abap.char(3);
```

LANGUAGE: CDS
CODE:
```cds
// File: service.cds (CAP)
TransactionCurrency @( Common : { IsCurrency : true } );
```

STEP: 7 — Validate Unit-of-Measure (UoM) fields without a related value field
DESCRIPTION: Mark UoM properties as unit semantics to have framework validation even without a related numeric value. Use Common.isUnit (XML), @Semantics.unitOfMeasure (ABAP CDS), or Common.IsUnit (CAP CDS).
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations.xml -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/DocumentUnit">
    <Annotation Term="Common.isUnit" Bool="true"/>
    <!-- ... additional value help or property definition ... -->
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
" ABAP CDS
@Semantics.unitOfMeasure: true
DocumentUnit : abap.char(3);
```

LANGUAGE: CDS
CODE:
```cds
// File: service.cds (CAP)
DocumentUnit @( Common : { IsUnit : true } );
```

STEP: 8 — Edm.Guid properties: automatic validation when value help exists
DESCRIPTION: Validation for properties of type Edm.Guid is automatically enabled by the framework when a value help (value list / value help) is associated with the property. No additional annotation is required for basic GUID format validation.
LANGUAGE: XML
CODE:
```xml
<!-- Guidance only: when a Guid property exposes a value help, Fiori enables validation automatically.
Example (conceptual) -->
<!-- <Annotations Target="MyService.Entity/GuidProperty">
     <Annotation Term="Common.???ValueHelpTerm" .../>  -->
<!-- Framework will validate Edm.Guid format if a value help is present. -->
```


--------------------------------

**TITLE**: Configuring Filter Bars for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: This reference contains action-oriented, copy-pasteable examples and manifest settings to configure filter bars in Fiori Elements list reports and analytical list pages. Includes annotation samples in XML, ABAP CDS and CAP CDS, manifest.json snippets, parameterized-entity patterns, live/go search modes, hiding the filter bar, mandatory/non-filterable fields, tooltips, and filter restrictions for parameterized entities.

**TAGS**: filter-bar, manifest.json, annotations, OData V2, OData V4, UI.SelectionFields, liveMode, hideFilterBar, parameterized-entities, FilterRestrictions, NonFilterableProperties

STEP: Prerequisites / Enable filter bar support
DESCRIPTION: Ensure the OData service supports filtering. For OData V2 use sap-filterable=true. For OData V4 use Capabilities.Filterable=true.
LANGUAGE: TEXT
CODE:
```text
OData V2:   sap-filterable="true"  (service metadata / model provider)
OData V4:   @Capabilities.Filterable: true  (annotation on entity set/service)
```

STEP: Define UI.SelectionFields (controls which fields appear in the filter bar)
DESCRIPTION: Add UI.SelectionFields to list the properties shown in the filter bar. For nested/contained properties use containment path (V2/V4) or element mapping in CDS.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation -->
<Annotation Term="UI.SelectionFields">
   <Collection>
     <PropertyPath>SalesOrder</PropertyPath>
     <PropertyPath>SoldToParty</PropertyPath>
     <PropertyPath>OverallSDProcessStatus</PropertyPath>
     <PropertyPath>SalesOrderDate</PropertyPath>
     <PropertyPath>_Item/Material</PropertyPath> <!-- containment path -->
   </Collection>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.SelectionField: [{ position: 10 }]
SALESORDER;

@UI.SelectionField: [{ position: 20 }]
SOLDTOPARTY;

@UI.SelectionField: [{ position: 30 }]
OVERALLSDPROCESSSTATUS;

@UI.SelectionField: [{ position: 40 }]
SALESORDERDATE;

@UI.SelectionField: [{ position: 50, element: '_Item.Material' }]
_Item;
```
LANGUAGE: CAP CDS
CODE:
```cds
annotate service.SalesOrderManage with @(
  UI.SelectionFields : [
     SalesOrder,
     SoldToParty,
     OverallSDProcessStatus,
     SalesOrderDate,
     Item.Material
]
);
```

STEP: Configure search behavior — Go button mode vs Live mode
DESCRIPTION: Choose Go mode (explicit user click required) or Live mode (automatic search on any filter change). Live mode can be enabled via manifest.json (or UI adaptation). Beware performance impact: live mode triggers initial load and refreshes on every filter change; test with realistic datasets.
LANGUAGE: JSON
CODE:
```json
// Enable live mode (V4 / V2 routing target example within manifest.json)
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "MyEntitiesList": {
          "type": "Component",
          "name": "sap.fe.templates.ListReport",
          "id": "MyEntitiesList",
          "options": {
            "settings": {
              "liveMode": true
            }
          }
        }
      }
    }
  }
}
```

STEP: Hide the filter bar (show table search only)
DESCRIPTION: Set hideFilterBar = true in the list report target settings in manifest.json. If mandatory filter fields or mandatory parameters exist, hideFilterBar is ignored and filter bar is shown.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "hideFilterBar": true
            }
          }
        }
      }
    }
  }
}
```

STEP: V2 — entitySet with input parameters shown automatically as filters
DESCRIPTION: If an entitySet exposes input parameters (sap:semantics="parameters"), those properties appear in the filter bar automatically. Mandatory parameter attributes must be provided to trigger queries. Optional parameters default to empty string (only Edm.String optional supported).
LANGUAGE: XML
CODE:
```xml
<!-- EntityType defined as parameters (OData V2) -->
<EntityType Name="SalesShareParametersType" sap:semantics="parameters">
    <Key>
        <PropertyRef Name="P_Currency"/>
        <PropertyRef Name="P_Country"/>
        <PropertyRef Name="P_Optional"/>
    </Key>
    <Property Name="P_Currency" Type="Edm.String" Nullable="false" MaxLength="5" sap:label="Currency" sap:parameter="mandatory"/>
    <Property Name="P_Country" Type="Edm.String" Nullable="false" DefaultValue="3" MaxLength="20" sap:label="CountryCode" sap:parameter="mandatory"/>
    <Property Name="P_Optional" Type="Edm.String" Nullable="false" MaxLength="5" sap:label="Optional" sap:parameter="optional"/>
    <NavigationProperty Name="Results" Relationship="...SalesShareParameters_SalesShareType" FromRole="SalesShareParametersPrincipal" ToRole="SalesShareDependent"/>
</EntityType>
```

STEP: V4 — Add filter fields using SAP Fiori Tools (Page Editor)
DESCRIPTION: Use SAP Fiori Tools Page Map > Page Editor to add/reorder filter fields via UI. Steps: open Page Map > Edit List Report page > expand Filter Fields > Add > choose fields > Add. Use drag & drop to reorder. Preview via Fiori Tools Preview.
LANGUAGE: TEXT
CODE:
```text
1) Open Page Map (right-click project > Show Page Map)
2) Edit List Report (click pencil icon next to List Report)
3) Expand "Filter Fields" in outline tree
4) Click Add (+), choose fields, click Add
5) Drag & drop to reorder. Preview with Fiori Tools "Preview" command.
```

STEP: Configure mandatory filter fields (Capabilities.RequiredProperties)
DESCRIPTION: Mark filter properties as required so the filter action is disabled until values are provided. Use Capabilities.FilterRestrictions.RequiredProperties (V4) or @Consumption.filter.mandatory (ABAP CDS).
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.Container/SalesOrder">
   <Annotation Term="SAP__capabilities.FilterRestrictions">
      <Record>
         <PropertyValue Property="RequiredProperties">
            <Collection>
               <PropertyPath>OrderType</PropertyPath>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@Consumption.filter.mandatory: true
OrderType;
```
LANGUAGE: CAP CDS
CODE:
```cds
annotate service.SalesOrder with @Capabilities : {
    FilterRestrictions : {
        $Type : 'Capabilities.FilterRestrictionsType',
        RequiredProperties : [
            OrderType
        ],
    },
};
```

STEP: Add tooltips to filter fields (Common.QuickInfo)
DESCRIPTION: Provide user help text for filter fields using Common.QuickInfo.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.Container/SalesOrder/OrderNumber">
   <Annotation Term="Common.QuickInfo" String="Unique identifier for the sales order"/>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@Common.QuickInfo: 'Unique identifier for the sales order'
OrderNumber;
```
LANGUAGE: CAP CDS
CODE:
```cds
entity SalesOrder {
   key ID : UUID;
   OrderNumber : String(20) @Common.QuickInfo: 'Unique identifier for the sales order';
   ...
}
```

STEP: Keep fields hidden from Filter Bar and Adapt Filters (NonFilterableProperties)
DESCRIPTION: Use Capabilities.FilterRestrictions.NonFilterableProperties (or ABAP @ObjectModel.filter.enabled: false) to prevent properties from appearing in the filter bar and Adapt Filters dialog. Note that UI.Hidden/UI.HiddenFilter also hides properties.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.Container/SalesOrder">
   <Annotation Term="SAP__capabilities.FilterRestrictions">
      <Record>
         <PropertyValue Property="NonFilterableProperties">
            <Collection>
               <PropertyPath>DeliveryChannel</PropertyPath>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@ObjectModel.filter.enabled: false
DeliveryChannel;
```
LANGUAGE: CAP CDS
CODE:
```cds
annotate service.SalesOrder with @Capabilities : {
    FilterRestrictions : {
        $Type : 'Capabilities.FilterRestrictionsType',
        NonFilterableProperties : [
            DeliveryChannel
        ],
    },
};
```

STEP: Parameterized entities — metadata pattern and manifest contextPath
DESCRIPTION: For parameterized main entities, the filter bar includes required parameters. Configure manifest target contextPath to point to the parameter container entity's Set (add "/Set" suffix). Use ResultContext annotation on parameter entity. Ensure client calls go through parameter entity set with parameter values.
LANGUAGE: XML
CODE:
```xml
<!-- Main parameterized entity -->
<EntityType Name="CustomerType">
    <Key>
        <PropertyRef Name="Customer"/>
        <PropertyRef Name="CompanyCode"/>
        ...
    </Key>
    <Property Name="Customer" Type="Edm.String" Nullable="false" MaxLength="10"/>
    <Property Name="CompanyCode" Type="Edm.String" Nullable="false" MaxLength="4"/>
    <NavigationProperty Name="Parameters" Type="...CustomerParameters" Nullable="false"/>
</EntityType>

<!-- Parameter entity annotated with ResultContext -->
<Annotations Target="SAP__self.CustomerParameters">
    <Annotation Term="SAP__common.ResultContext"/>
</Annotations>

<!-- Parameter entity type: contains parameters + Set navigation to main entity -->
<EntityType Name="CustomerParameters">
    <Key>
        <PropertyRef Name="P_DisplayCurrency"/>
    </Key>
    <Property Name="P_DisplayCurrency" Type="Edm.String" Nullable="false" MaxLength="3"/>
    <NavigationProperty Name="Set" Type="Collection(...CustomerType)" Partner="Parameters" ContainsTarget="true"/>
</EntityType>
```
LANGUAGE: JSON
CODE:
```json
// manifest.json: target contextPath must point to Customer/Set (the containment results)
{
  "targets": {
      "CustomerList": {
          "type": "Component",
          "id": "CustomerList",
          "name": "sap.fe.templates.ListReport",
          "options": {
              "settings": {
                  "contextPath": "/Customer/Set"
              }
          }
      }
  }
}
```
LANGUAGE: XML
CODE:
```xml
<!-- EntityContainer: Customer entity set corresponds to CustomerParameters -->
<EntityContainer Name="Container">
    <EntitySet Name="Customer" EntityType="...CustomerParameters">
        <NavigationPropertyBinding Path="Set/Parameters" Target="Customer"/>
    </EntitySet>
</EntityContainer>
```
LANGUAGE: TEXT
CODE:
```text
Example OData call to fetch results (pass parameter values through the parameter entity):
http://<host>/Customer(P_DisplayCurrency='JPY')/Set?$count=true
```
LANGUAGE: CAP CDS
CODE:
```cds
// CAP: annotate parameterized root element with ResultContext #$parameters
@Common.ResultContext #$parameters
entity RootElement(P_CurrencyUnit : String not null @(---));
```

STEP: Filter restrictions for parameterized entities — two approaches
DESCRIPTION: Two approaches to restrict filter behavior for parameterized main entity results: (A) define FilterExpressionRestrictions at the main entity using PropertyPath to the contained property (Set/Property), or (B) define NavigationRestrictions on the parameter entity (Customer) with FilterRestrictions for the navigation 'Set'. NavigationRestrictions take precedence over direct main-entity restrictions. Examples below use XML and CAP CDS.
LANGUAGE: XML
CODE:
```xml
<!-- A) FilterRestrictions at main entity (PropertyPath pointing into containment) -->
<Annotation Term="SAP__capabilities.FilterRestrictions">
    <Record>
        <PropertyValue Property="FilterExpressionRestrictions">
            <Collection>
                <Record>
                    <PropertyValue Property="Property" PropertyPath="Set/SalesOrganization" />
                    <PropertyValue Property="AllowedExpressions" String="MultiValue" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```
LANGUAGE: CAP CDS
CODE:
```cds
// A) CAP CDS: FilterRestrictions using Set/SalesOrganization
entity Customer @(
    Capabilities : {
        FilterRestrictions:{
            $Type: 'Capabilities.FilterRestrictionsType',
            FilterExpressionRestrictions: [{
                Property: 'Set/SalesOrganization',
                AllowedExpressions: 'MultiValue'
            }]
        }
    }
)
{}
```
LANGUAGE: XML
CODE:
```xml
<!-- B) NavigationRestrictions on the parameter entity using path 'Set' -->
<Annotations Target="SAP__self.Container/Customer">
   <Annotation Term="SAP__capabilities.NavigationRestrictions">
      <Record>
         <PropertyValue Property="RestrictedProperties">
            <Collection>
               <Record>
                  <PropertyValue Property="NavigationProperty" NavigationPropertyPath="Set" />
                     <PropertyValue Property="FilterRestrictions">
                        <Record>
                           <PropertyValue Property="FilterExpressionRestrictions">
                              <Collection>
                                 <Record>
                                    <PropertyValue Property="Property" PropertyPath="SalesOrganization" />
                                    <PropertyValue Property="AllowedExpressions" String="MultiValue" />
                                 </Record>
                              </Collection>
                           </PropertyValue>
                        </Record>
                     </PropertyValue>
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```
LANGUAGE: CAP CDS
CODE:
```cds
// B) CAP service-level NavigationRestrictions example
service MyService {
    @Capabilities.NavigationRestrictions.RestrictedProperties : [{
        $Type              : 'Capabilities.NavigationPropertyRestriction',
        NavigationProperty : 'Set',
        FilterRestrictions : {
            $Type                        : 'Capabilities.FilterRestrictionsType',
            FilterExpressionRestrictions : [{
                $Type              : 'Capabilities.FilterExpressionRestrictionType',
                Property           : 'Set.SalesOrganization',
                AllowedExpressions : 'MultiValue'
            }]
        }
    }]
    entity Customer {}
}
```

STEP: Notes & Restrictions (performance and functional limits)
DESCRIPTION: Important constraints to preserve in your design:
- Enabling liveMode forces an initial load and refreshes on each filter change — test for performance impact.
- Parameter support available only for read-only services; not available for editable services.
- Parameters are not supported in multiple view mode unless single-table mode with same base table.
- Navigation entity sets associated with the main entity cannot be parameterized.
- Sort restrictions not supported for first-level navigation entity sets under parameterized root.
- Filtering on measure properties is not supported.
LANGUAGE: TEXT
CODE:
```text
Performance caution: Live mode triggers query on each filter change; run end-to-end tests.
Functional restrictions: parameterized entities have read-only and navigation limitations (see above).
```

STEP: References (in-code links and files)
DESCRIPTION: Relevant doc targets and files to consult when implementing:
- Adapting the Filter Bar: adapting-the-filter-bar-609c39a.md
- Loading behavior: loading-behavior-of-data-on-initial-launch-of-the-application-9f4e119.md
- Adding custom fields: adding-custom-fields-to-the-filter-bar-5fb9f57.md
- SAP Fiori Tools: Filter Fields docs and Page Map UI
LANGUAGE: TEXT
CODE:
```text
Documentation links (internal):
- adapting-the-filter-bar-609c39a.md
- loading-behavior-of-data-on-initial-launch-of-the-application-9f4e119.md
- adding-custom-fields-to-the-filter-bar-5fb9f57.md
- SAP FIORI tools: https://help.sap.com/docs/SAP_FIORI_tools
```
--------------------------------

**TITLE**: Configuring Filter Fields (FilterRestrictions) for SAP Fiori Elements (OData V2 / V4, CAP, ABAP CDS)

**INTRODUCTION**: Practical, code-focused reference for configuring filter field behavior (single value, multi value, range/interval) using sap:filter-restriction (OData V2), Capabilities.FilterRestrictions (OData V4 XML), and CDS annotations (ABAP & CAP). Includes navigation/association/containment patterns, prioritization, strict UoM filtering manifest flag, and copy/paste considerations.

**TAGS**: fiori-elements-framework, filter-restrictions, FilterRestrictions, sap:filter-restriction, ODataV4, ODataV2, CAP, ABAP, CDS, manifest.json, visual-filter-bar

STEP: Copy and paste multiple values — behavior and restrictions

DESCRIPTION: End-user behavior and developer constraints when copying/pasting multiple values into filter fields (filter bar or value help). Note performance and custom filter implementation requirements.

LANGUAGE: PlainText

CODE:
```PlainText
- Supported copy/paste use cases:
  * Filter field -> Filter field (same data type)
  * Filter field -> Value help dialog (same data type, paste into "equal to" field)
  * Spreadsheet -> Filter field (same data type)

- Restrictions:
  * Copy/pasting a large number of values can cause performance issues.
  * For custom filters, the app developer must implement copy and paste event handling.
```

STEP: OData V2 — sap:filter-restriction (EDM Property)

DESCRIPTION: Configure single-valued filter behavior in the EDM property definition for OData V2 metadata.

LANGUAGE: XML

CODE:
```XML
<!-- In your EDMX (metadata.xml) or property definitions -->
<Property Name="StartDate" Type="Edm.DateTime"
          sap:display-format="Date"
          sap:aggregation-role="dimension"
          sap:label="Date"
          sap:filter-restriction="single-value" />

<Property Name="StartDateString" Type="Edm.String"
          sap:semantics="yearmonthday"
          sap:aggregation-role="dimension"
          sap:label="Date"
          sap:filter-restriction="single-value" />
```

STEP: OData V4 — FilterRestrictions (XML Annotation)

DESCRIPTION: XML annotation example for OData V4 service to restrict allowed filter expressions per property (SingleValue, SingleRange, etc.). Place in your service annotations file (Annotations element targeting the EntityContainer or EntityType as shown).

LANGUAGE: XML

CODE:
```XML
<!-- Annotations file (e.g., annotations.xml) -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/SalesOrderManage">
  <Annotation Term="Capabilities.FilterRestrictions">
    <Record Type="Capabilities.FilterRestrictionsType">
      <PropertyValue Property="FilterExpressionRestrictions">
        <Collection>
          <Record Type="Capabilities.FilterExpressionRestrictionType">
            <PropertyValue Property="Property" PropertyPath="SoldToParty" />
            <PropertyValue Property="AllowedExpressions" String="SingleValue" />
          </Record>
          <Record Type="Capabilities.FilterExpressionRestrictionType">
            <PropertyValue Property="Property" PropertyPath="SalesOrderDate" />
            <PropertyValue Property="AllowedExpressions" String="SingleRange" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: ABAP CDS — Equivalent AllowedExpressions mapping

DESCRIPTION: ABAP CDS annotation equivalents for AllowedExpressions values. Use these @Consumption annotations on fields (or in restriction records) to map to SingleValue/MultiValue/SingleRange/MultiRange.

LANGUAGE: ABAP CDS

CODE:
```ABAP CDS
/* Map AllowedExpressions = "SingleValue" */
@Consumption.filter.multipleSelections: false
@Consumption.filter.selectionType: #SINGLE
FilterExpressionRestriction.AllowedExpressions = "SingleValue"

/* Map AllowedExpressions = "MultiValue" */
@Consumption.filter.multipleSelections: true
@Consumption.filter.selectionType: #SINGLE
FilterExpressionRestriction.AllowedExpressions = "MultiValue"

/* Map AllowedExpressions = "SingleRange" */
@Consumption.filter.multipleSelections: false
@Consumption.filter.selectionType: #INTERVAL
FilterExpressionRestriction.AllowedExpressions = "SingleRange"

/* Map AllowedExpressions = "MultiRange" */
@Consumption.filter.multipleSelections: true
@Consumption.filter.selectionType: #INTERVAL
FilterExpressionRestriction.AllowedExpressions = "MultiRange"
```

STEP: CAP CDS — Define FilterRestrictions on entity (OData V4 via CAP)

DESCRIPTION: CAP CDS examples showing FilterRestrictions and RequiredProperties (make a filter field required). Place in your CDS model file (.cds).

LANGUAGE: CDS

CODE:
```CDS
entity SalesOrderManage @( 
  title : 'Manage Sales Order',
  Capabilities : {
    FilterRestrictions : {
      FilterExpressionRestrictions : [
        {
          Property : 'SoldToParty',
          AllowedExpressions : 'SingleValue'
        },
        {
          Property : 'SalesOrderDate',
          AllowedExpressions : 'SingleRange'
        }
      ]
    },
    /* Required properties example */
    FilterRestrictions : {
      $Type : 'Capabilities.FilterRestrictionsType',
      RequiredProperties : [ SalesOrderDate ]
    }
  }
) {
  key ID : UUID;
  SalesOrderDate : Date;
  SoldToParty : String;
}
```

STEP: Filter restrictions for navigation & association entities — approach: Filter Restrictions at Association Entity

DESCRIPTION: Annotate the association (navigation property) target (association entity) so filter restrictions apply to the navigation property. Use this for non-containment (association) scenarios. This approach has the highest priority.

LANGUAGE: XML

CODE:
```XML
<!-- XML annotation target: association navigation property -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/_Material">
  <Annotation Term="Capabilities.FilterRestrictions">
    <Record Type="Capabilities.FilterRestrictionsType">
      <PropertyValue Property="FilterExpressionRestrictions">
        <Collection>
          <Record Type="Capabilities.FilterExpressionRestrictionType">
            <PropertyValue Property="Property" PropertyPath="Material" />
            <PropertyValue Property="AllowedExpressions" String="SingleValue" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CDS

CODE:
```CDS
entity SalesOrderManage {
  ...
  _Material : Association to Material on _Material.Material = Material;
    @(Capabilities: {
      FilterRestrictions: {
        FilterExpressionRestrictions: [
          {
            Property: 'Material',
            AllowedExpressions: 'SingleRange'
          }
        ]
      }
    })
}
```

STEP: Filter restrictions for navigation & association entities — approach: NavigationRestrictions at parent entity

DESCRIPTION: Define NavigationRestrictions at the parent EntityContainer/Entity to restrict navigation properties and their filter expression restrictions.

LANGUAGE: XML

CODE:
```XML
<!-- XML annotation: NavigationRestrictions on the EntityContainer/Entity -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/SalesOrderManage">
  <Annotation Term="Capabilities.NavigationRestrictions">
    <Record>
      <PropertyValue Property="RestrictedProperties">
        <Collection>
          <Record>
            <PropertyValue Property="NavigationProperty" NavigationPropertyPath="_Material" />
            <PropertyValue Property="FilterRestrictions">
              <Record>
                <PropertyValue Property="FilterExpressionRestrictions">
                  <Collection>
                    <Record>
                      <PropertyValue Property="Property" PropertyPath="Material" />
                      <PropertyValue Property="AllowedExpressions" String="SingleValue" />
                    </Record>
                  </Collection>
                </PropertyValue>
              </Record>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CDS

CODE:
```CDS
entity SalesOrderManage @(
  title: 'Manage Sales Order',
  Capabilities: {
    NavigationRestrictions: {
      RestrictedProperties: [{
        NavigationProperty: _Material,
        FilterRestrictions: {
          FilterExpressionRestrictions: [{
            Property: 'Material',
            AllowedExpressions : 'SingleValue'
          }]
        }
      }]
    }
  }
) { ... }
```

STEP: Filter restrictions — approach: Parent entity with PropertyPath pointing to child

DESCRIPTION: Annotate the parent entity but use PropertyPath that references a child (navigation) property (e.g., _Material/Material). Not supported for containment scenarios.

LANGUAGE: XML

CODE:
```XML
<!-- Parent-level FilterRestrictions referencing child property by PropertyPath -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/SalesOrderManage">
  <Annotation Term="Capabilities.FilterRestrictions">
    <Record Type="Capabilities.FilterRestrictionsType">
      <PropertyValue Property="FilterExpressionRestrictions">
        <Collection>
          <Record Type="Capabilities.FilterExpressionRestrictionType">
            <PropertyValue Property="Property" PropertyPath="_Material/Material" />
            <PropertyValue Property="AllowedExpressions" String="SingleValue" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CDS

CODE:
```CDS
entity SalesOrderManage @(  
  Capabilities: {    
    FilterRestrictions: {
      FilterExpressionRestrictions: [
        {
          Property: _Material.Material,
          AllowedExpressions: 'SingleValue'
        }
      ]
    }
  }
) { ... }
```

STEP: Filter restrictions — approach: Annotate child entity directly

DESCRIPTION: Annotate the child (target) entity with its own FilterRestrictions. Use for both containment and non-containment child entities.

LANGUAGE: XML

CODE:
```XML
<!-- Annotate child entity type or entity container child target -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/MaterialEntity">
  <Annotation Term="Capabilities.FilterRestrictions">
    <Record Type="Capabilities.FilterRestrictionsType">
      <PropertyValue Property="FilterExpressionRestrictions">
        <Collection>
          <Record Type="Capabilities.FilterExpressionRestrictionType">
            <PropertyValue Property="Property" PropertyPath="Material" />
            <PropertyValue Property="AllowedExpressions" String="SingleValue" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CDS

CODE:
```CDS
entity MaterialEntity @( 
  title: 'Material',
  Capabilities: {
    FilterRestrictions: {
      FilterExpressionRestrictions: [{
        Property: 'Material',
        AllowedExpressions: 'SingleValue'
      }]
    }
  }
) { key Material : String; ... }
```

STEP: Containment scenario examples (XML + CAP CDS)

DESCRIPTION: XML and CAP CDS samples showing containment scenario annotation targets.

LANGUAGE: XML

CODE:
```XML
<!-- Containment: example /Customer/Set/_PartnerItems -->
<Annotations Target="sap.fe.test.MyService.MainEntityType/_ItemPartners">
  <Annotation Term="SAP__capabilities.FilterRestrictions">
    <Record>
      <PropertyValue Property="FilterExpressionRestrictions">
        <Collection>
          <Record>
            <PropertyValue Property="Property" PropertyPath="CityName" />
            <PropertyValue Property="AllowedExpressions" String="MultiValue" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CDS

CODE:
```CDS
/* Containment CAP CDS */
entity CustomerType {
  key ID : UUID;
  @(Capabilities.FilterRestrictions : {
    FilterExpressionRestrictions : [{
      $Type              : 'Capabilities.FilterExpressionRestrictionType',
      Property           : FullName,
      AllowedExpressions : 'MultiValue'
    }]
  })
  _PartnerItems : Composition of many PartnerType;
};
```

STEP: Prioritization — merging and override rules

DESCRIPTION: When multiple annotations exist for the same field via different approaches, SAP Fiori Elements merges them and higher-priority annotations override lower-priority ones. Priority order (highest to lowest):

LANGUAGE: PlainText

CODE:
```PlainText
Priority order (highest -> lowest):
1) Filter Restrictions at Association Entity (annotation target: /Entity/_NavProp)  <-- wins
2) NavigationRestrictions at Parent Entity
3) Filter Restrictions at Parent Entity with PropertyPath pointing to child (not for containment)
4) Filter Restrictions directly at Child Entity

Example:
- Child entity 'Partner' annotated CityName as 'SingleValue' (approach 4)
- A higher-priority annotation defines CityName as 'MultiValue'
Result:
- CityName becomes MultiValue (higher priority overrides)
- Other child fields without higher-priority annotations keep their lower-priority definitions
```

STEP: Strict filtering for Unit of Measure (UoM) fields — manifest.json flag

DESCRIPTION: Disable strict UoM filtering (default = enabled) globally via the sap.fe app manifest flag. Place inside manifest.json for the Fiori Elements app.

LANGUAGE: JSON

CODE:
```JSON
{
  "sap.fe": {
    "app": {
      "disableStrictUomFiltering": true
    }
  }
}
```

STEP: Visual Filter Bar and Field Help references

DESCRIPTION: Links to related topics. Use these when you need to configure visual filters or field help for filter fields.

LANGUAGE: PlainText

CODE:
```PlainText
- Configure visual filter bar: see file path/reference "configuring-the-visual-filter-bar-33f3d80.md"
- Configure field help for filter fields: see file path/reference "field-help-a5608ea.md"
```
--------------------------------

**TITLE**: Fiori Elements — Configure Shared Features: Status Colors and Navigation Annotations

**INTRODUCTION**: This document shows concise, copy-ready annotation examples that enable two common Fiori Elements features used by List Report and Object Page apps:
- Displaying status colors (criticality) for fields and KPIs
- Intent-based navigation from line items or identification fields

Use these annotations in your service annotation files (XML or JSON) and register them in your app (manifest.json) as standard OData annotations.

**TAGS**: fiori-elements, annotations, criticality, navigation, intent-based-navigation, UI, odata, manifest

STEP: 1 — Add status colors (criticality) using DataPoint
DESCRIPTION: Use the com.sap.vocabularies.UI.v1.DataPoint annotation to show a value with a colored status (criticality). You can set a static Criticality enum (Positive, Negative, Critical, Neutral) or point to a property containing criticality. Below are XML and JSON examples for both approaches. Place these in your service annotation file (e.g., annotations/annotations.xml or annotations/annotations.json).

LANGUAGE: XML
CODE:
```xml
<!-- File: annotations/annotations.xml -->
<edmx:Annotations Target="MyService.MyEntityType/TotalAmount" xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx">
  <Annotation Term="com.sap.vocabularies.UI.v1.DataPoint">
    <Record>
      <!-- Display the value -->
      <PropertyValue Property="Value">
        <Path>TotalAmount</Path>
      </PropertyValue>
      <PropertyValue Property="Title" String="Basket Total"/>
      <!-- Static criticality (color) -->
      <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Negative"/>
    </Record>
  </Annotation>
</edmx:Annotations>

<!-- Alternative: reference a property that contains the Criticality enum value -->
<edmx:Annotations Target="MyService.MyEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.DataPoint">
    <Record>
      <PropertyValue Property="Value">
        <Path>Score</Path>
      </PropertyValue>
      <!-- Use the property 'ScoreCriticality' whose value is an enum (Positive/Negative/...) -->
      <PropertyValue Property="Criticality">
        <Path>ScoreCriticality</Path>
      </PropertyValue>
    </Record>
  </Annotation>
</edmx:Annotations>
```

LANGUAGE: JSON
CODE:
```json
// File: annotations/annotations.json
{
  "MyService.MyEntityType/TotalAmount": {
    "com.sap.vocabularies.UI.v1.DataPoint": {
      "Value": { "Path": "TotalAmount" },
      "Title": { "String": "Basket Total" },
      "Criticality": { "EnumMember": "com.sap.vocabularies.UI.v1.CriticalityType/Negative" }
    }
  },
  "MyService.MyEntityType": {
    "com.sap.vocabularies.UI.v1.DataPoint": {
      "Value": { "Path": "Score" },
      "Criticality": { "Path": "ScoreCriticality" }
    }
  }
}
```

STEP: 2 — Enable intent-based navigation from LineItem or Identification
DESCRIPTION: Add com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation entries in the LineItem or Identification annotations to create semantic-navigation actions (semantic object + action). Below are XML and JSON examples to add navigation actions to line items. Place these in annotations/annotations.xml or annotations/annotations.json.

LANGUAGE: XML
CODE:
```xml
<!-- File: annotations/annotations.xml -->
<edmx:Annotations Target="MyService.MyEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
    <Collection>
      <!-- A standard text field in the line item -->
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Label" String="Name"/>
        <PropertyValue Property="Value">
          <Path>Name</Path>
        </PropertyValue>
      </Record>

      <!-- Intent-based navigation button/link -->
      <Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
        <PropertyValue Property="Label" String="Open Account"/>
        <PropertyValue Property="SemanticObject" String="Account"/>
        <PropertyValue Property="Action" String="display"/>
        <!-- Optionally pass parameters via LocalNavProperties -->
        <PropertyValue Property="LocalNavProperties" String="AccountID"/>
      </Record>
    </Collection>
  </Annotation>

  <!-- Navigation via Identification (Object Page header) -->
  <Annotation Term="com.sap.vocabularies.UI.v1.Identification">
    <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
        <PropertyValue Property="Label" String="Open Account"/>
        <PropertyValue Property="SemanticObject" String="Account"/>
        <PropertyValue Property="Action" String="display"/>
        <PropertyValue Property="Value">
          <Path>AccountID</Path>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</edmx:Annotations>
```

LANGUAGE: JSON
CODE:
```json
// File: annotations/annotations.json
{
  "MyService.MyEntityType": {
    "com.sap.vocabularies.UI.v1.LineItem": [
      {
        "RecordType": "com.sap.vocabularies.UI.v1.DataField",
        "Label": { "String": "Name" },
        "Value": { "Path": "Name" }
      },
      {
        "RecordType": "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation",
        "Label": { "String": "Open Account" },
        "SemanticObject": { "String": "Account" },
        "Action": { "String": "display" },
        "LocalNavProperties": { "String": "AccountID" }
      }
    ],
    "com.sap.vocabularies.UI.v1.Identification": [
      {
        "RecordType": "com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation",
        "Label": { "String": "Open Account" },
        "SemanticObject": { "String": "Account" },
        "Action": { "String": "display" },
        "Value": { "Path": "AccountID" }
      }
    ]
  }
}
```

STEP: 3 — Deployment notes and manifest wiring
DESCRIPTION: Where to put files and how to reference them in your Fiori Elements app.

LANGUAGE: JSON
CODE:
```json
// Example manifest.json snippet to register external annotation file
{
  "sap.app": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/MY_SERVICE_SRV/",
        "type": "OData",
        "settings": {
          "annotations": [
            {
              "type": "URL",
              "uri": "annotations/annotations.xml"
            }
          ]
        }
      }
    }
  }
}
```

Notes:
- File paths in examples: annotations/annotations.xml or annotations/annotations.json — adapt to your project layout.
- Use DataPoint.Criticality for KPI/status tiles and for contextual color indicators. Use DataFieldForIntentBasedNavigation to create semantic navigation from list items and header fields.
- When using property-based criticality, ensure the OData service exposes the criticality property (enum or integer mapped to Positive/Negative/Critical/Neutral).
--------------------------------

**TITLE**: Configuring Internal Navigation for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: Action-oriented reference for configuring internal navigation inside SAP Fiori elements apps (OData V2 and V4). Includes manifest.json fragments, routing/targets examples, annotation snippets (XML / ABAP CDS / CAP CDS), and settings to enable/disable navigation after actions or per-record availability. Use these snippets directly in manifest.json, annotations, or CDS sources.

**TAGS**: fiori-elements, navigation, manifest.json, routing, OData V2, OData V4, annotations, DataFieldForAction, DataFieldWithNavigationPath

STEP: 1 — Standard navigation (OData V2): enable or remove detail/subobject pages via manifest pages tree
DESCRIPTION: Keep the nested "pages" definition to enable navigation from a list report to an object page and further subobject pages. Remove the nested "pages" block (or individual subpage entries) to disable navigation to that level.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "MyListReport": {
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": {
          "MyObjectPageOnFirstLevel": {
            "entitySet": "MyEntitySet",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage"
            },
            "pages": {
              "MyFirstObjectPageOnSecondLevel": {
                "navigationProperty": "to_MyFirstEntitySet",
                "entitySet": "MyFirstEntitySet",
                "component": {
                  "name": "sap.suite.ui.generic.template.ObjectPage"
                }
              },
              "MySecondObjectPageOnSecondLevel": {
                "navigationProperty": "to_MySecondEntitySetNavigation",
                "entitySet": "MySecondEntitySet",
                "component": {
                  "name": "sap.suite.ui.generic.template.ObjectPage"
                }
              },
              "MyThirdObjectPageOnSecondLevel": {
                "navigationProperty": "to_MyThirdEntitySet",
                "entitySet": "MyThirdEntitySet",
                "component": {
                  "name": "sap.suite.ui.generic.template.ObjectPage"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 2 — Disable navigation after executing an action for object page table (OData V2)
DESCRIPTION: For DataFieldForAction annotations in object page tables, disable automatic navigation after successful action execution by setting navigateToInstance: false in the manifest under the targeted LineItem annotation scope.
LANGUAGE: JSON
CODE:
```json
{
  "to_Item::com.sap.vocabularies.UI.v1.LineItem": {
    "tableSettings": {
      "...": "..."
    },
    "annotatedActions": {
      "C_STTA_SalesOrderItem_WD_20Setopportunityid": {
        "afterExecution": {
          "navigateToInstance": false
        }
      }
    }
  }
}
```

STEP: 3 — Map child entity to List Report and create parent from List Report (OData V2)
DESCRIPTION: To show a child entity as a list report and enable Create to open the parent/main object, set creationEntitySet on the ListReport component settings to the parent entity set name.
LANGUAGE: JSON
CODE:
```json
{
  "component": {
    "name": "sap.suite.ui.generic.template.ListReport",
    "list": true,
    "settings": {
      "creationEntitySet": "C_MPPurchasingSource"
    }
  }
}
```

STEP: 4 — Standard navigation (OData V4): routing.targets navigation configuration (enable/disable)
DESCRIPTION: Define navigation per target under sap.ui5.routing.targets -> options.settings.navigation. Remove the navigation entry for a path to disable. Use navigation property paths (not navigation entity set names).
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": ":?query:",
          "name": "ArtistList",
          "target": "ArtistList"
        },
        {
          "pattern": "Artists({key}):?query:",
          "name": "ArtistDetail",
          "target": "ArtistObjectPage"
        }
      ],
      "targets": {
        "ArtistList": {
          "type": "Component",
          "id": "ArtistList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/Artists",
              "navigation": {
                "Artists": {
                  "detail": {
                    "route": "ArtistObjectPage"
                  }
                }
              }
            }
          }
        },
        "ArtistObjectPage": {
          "type": "Component",
          "id": "ArtistDetail",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "navigation": {
                "_Records": {
                  "detail": {
                    "route": "RecordSubObjectPage"
                  }
                },
                "_Publishers": {
                  "detail": {
                    "route": "PublisherSubObjectPage"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Disable navigation per-record using availability (OData V4)
DESCRIPTION: Use an availability expression or formatter on the navigation target to conditionally hide the chevron/navigation for a record.
LANGUAGE: JSON
CODE:
```json
{
  "Travel": {
    "detail": {
      "route": "objectPage",
      "availability": "{= ${TravelStatus_code} === 'O' }"
    }
  }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// Formatter-based availability (manifest reference to formatter function)
{
  "Travel": {
    "detail": {
      "route": "objectPage",
      "availability": "{path: 'TravelStatus_code', formatter: '.extension.sap.fe.core.fpmExplorer.customHeaderListReport.LRExtend.isNavigable'}"
    }
  }
}

// Implementation of the formatter (e.g., in the extension module referenced above)
isNavigable: function(travelStatus, context) {
  // Return true when navigation should be shown
  return travelStatus !== "O";
}
```

STEP: 6 — Determine navigation target via manifest parameters (OData V4): routing parameters from annotation Target
DESCRIPTION: Map the UI.DataFieldWithNavigationPath 'Target' to the manifest routing target, and resolve route parameters using relative binding paths.
LANGUAGE: JSON
CODE:
```json
{
  "routing": {
    "routes": [
      {
        "pattern": "SalesOrderManage({key}):?query:",
        "name": "SalesOrderManageObjectPage",
        "target": "SalesOrderManageObjectPage"
      }
    ],
    "targets": {
      "SalesOrderManageObjectPage": {
        "type": "Component",
        "id": "SalesOrderManageObjectPage",
        "name": "sap.fe.templates.ObjectPage",
        "options": {
          "settings": {
            "contextPath": "/SalesOrderManage",
            "navigation": {
              "to_SalesOrder": {
                "detail": {
                  "route": "SalesOrderManageObjectPage",
                  "parameters": {
                    "key": "{_ReferencedSalesOrder/ID}"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 7 — Link entities: UI.DataFieldWithNavigationPath annotation examples (XML, ABAP CDS, CAP CDS)
DESCRIPTION: Use UI.DataFieldWithNavigationPath with Target as the navigationPropertyPath to enable in-app links on object pages (object header, sections, tables).
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation -->
<Annotation Term="UI.FieldGroup" Qualifier="NavExample">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataFieldWithNavigationPath">
          <PropertyValue Property="Label" String="Ref. Sales Order" />
          <PropertyValue Property="Value" Path="RefSalesOrderID" />
          <PropertyValue Property="Target" NavigationPropertyPath="to_SalesOrder" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP
CODE:
```abap
" ABAP CDS Annotation
@UI.fieldGroup: [
  {
    targetelement: 'TO_SALESORDER',
    label: 'Ref. Sales Order',
    value: 'REFSALESORDERID',
    type: #WITH_NAVIGATION_PATH,
    position: 1,
    qualifier: 'NavExample'
  }
]
REFSALESORDERID;
```

LANGUAGE: CDS
CODE:
```cds
// CAP CDS Annotation
UI.FieldGroup #NavExample : {
  Data : [
    {
      $Type : 'UI.DataFieldWithNavigationPath',
      Label : 'Ref. Sales Order',
      Value : RefSalesOrderID,
      Target : to_SalesOrder
    }
  ]
}
```

STEP: 8 — Disable navigation after executing an action (OData V4): DataFieldForAction (annotation-based & inline actions)
DESCRIPTION: Disable navigation after action execution by configuring navigateToInstance: false. For annotation-based actions use actions scope; for inline actions use columns scope for the DataFieldForAction key starting with "DataFieldForAction::".
LANGUAGE: JSON
CODE:
```json
{
  "com.sap.vocabularies.UI.v1.LineItem": {
    "tableSettings": {
      "...": "..."
    },
    "actions": {
      "DataFieldForAction::com.c_salesordermanage_sd.AddRandomItem": {
        "afterExecution": {
          "navigateToInstance": false
        }
      },
      "DataFieldForAction::com.c_salesordermanage_sd.DummyBoundAction": {
        "afterExecution": {
          "navigateToInstance": false
        }
      }
    }
  }
}
```

LANGUAGE: JSON
CODE:
```json
{
  "com.sap.vocabularies.UI.v1.LineItem": {
    "tableSettings": {
      "...": "..."
    },
    "columns": {
      "DataFieldForAction::com.c_salesordermanage_sd.AddRandomItem": {
        "afterExecution": {
          "navigateToInstance": false
        }
      },
      "DataFieldForAction::com.c_salesordermanage_sd.DummyBoundAction": {
        "afterExecution": {
          "navigateToInstance": false
        }
      }
    }
  }
}
```

STEP: 9 — Rules: when navigation after action is triggered or not
DESCRIPTION: Quick rules summary to decide whether navigation is performed after an action.
LANGUAGE: text
CODE:
```
Navigation AFTER action (works when):
- Action returns a single instance different from the triggering context OR the returned context belongs to the same entity.
- Action executed successfully.
- Manifest has navigation defined for the returned context (routing target).
- Applies to: bound actions in table toolbar, inline actions, header/footer actions, form actions, annotation-based custom actions, navigation to next level (routing).

Navigation AFTER action (does NOT work when):
- Multiple contexts selected for table/chart toolbar actions (no navigation).
- Chart toolbar actions.
- Subobject pages (control is refreshed instead).
- Standard SAP Fiori elements actions (Save/Edit/Create).
- Manifest-based actions.
- External navigation.

Note: For non-draft apps, unsaved changes on an object page will prompt the user before navigation (changes may be lost).
```

STEP: 10 — In-page navigation (Header facets)
DESCRIPTION: Header facets support in-page navigation (navigate within an object page). Use UI annotations for header facets to enable fast navigation inside an object page. See navigation-from-header-facet-title documentation for examples and details.
LANGUAGE: text
CODE:
```
See: Navigation from Header Facet Title (navigation-from-header-facet-title-fa0ca22.md)
```
--------------------------------

**TITLE**: Configuring List Report Features (table type and filter bar)

**INTRODUCTION**: This guide shows how to configure List Report features in a Fiori Elements app by (1) setting the table type and smart template settings in the app manifest and (2) exposing table columns and filter fields through CDS/OData annotations. Use these snippets to generate a List Report with the desired table control and filter bar behavior.

**TAGS**: fiori-elements, list-report, manifest.json, CDS, annotations, table-type, filter-bar

**STEP**: 1 — Configure the List Report page and table type in the manifest

**DESCRIPTION**: Edit webapp/manifest.json to register a List Report page and set the table type and generic template options. The example below configures a List Report for the "Books" entity set and chooses a responsive table. Adjust the entitySet and settings for your app.

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (excerpt)
{
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "suppressMessages": false
        }
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Books",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            // Table type options: "ResponsiveTable", "GridTable", "AnalyticalTable", "TreeTable"
            "tableType": "ResponsiveTable",
            // Common smart template settings
            "smartVariantManagement": true,
            "enableAutoBinding": true
          }
        }
      }
    ]
  }
}
```

**STEP**: 2 — Add CDS annotations for table columns (LineItem) and filter fields (SelectionField)

**DESCRIPTION**: Annotate your entity properties to control which fields appear as table columns and which appear in the filter bar. The example uses SAP CAP CDS annotate syntax. Place annotations in the same CDS file or a separate .cds annotation file (e.g., srv/annotations.cds). The List Report will build the table and filter bar from these annotations.

**LANGUAGE**: CDS

**CODE**:
```cds
// File: srv/schema.cds (or srv/annotations.cds)
// Define the entity
entity Books {
  key ID         : UUID;
  Title          : String(100);
  Author         : String(100);
  Price          : Decimal(9,2);
  PublishedAt    : Date;
  Genre          : String(50);
}

// Annotations to control List Report columns and filter fields
annotate Books with {
  // Columns in the List Report table (LineItem)
  Title       @UI.lineItem: [{ position: 10, label: 'Title' }];
  Author      @UI.lineItem: [{ position: 20, label: 'Author' }];
  Price       @UI.lineItem: [{ position: 30, label: 'Price', text: 'Currency' }];
  PublishedAt @UI.lineItem: [{ position: 40, label: 'Published' }];

  // Fields shown in the Smart Filter Bar (SelectionField)
  Author      @UI.selectionField: [{ position: 10 }];
  Price       @UI.selectionField: [{ position: 20 }];
  PublishedAt @UI.selectionField: [{ position: 30, label: 'Published' }];
  Genre       @UI.selectionField: [{ position: 40 }];
}
```

**STEP**: 3 — (Optional) Enable default search and quick filters via annotations

**DESCRIPTION**: Use search annotations or selectionField qualifiers to enable the global search box to target a default field and to mark quick filters. In CAP/CDS, add a boolean search annotation or use dedicated selectionField metadata where supported.

**LANGUAGE**: CDS

**CODE**:
```cds
// File: srv/schema.cds (excerpt)
// Mark a default search element and an example quick filter (if supported by your annotations provider)
annotate Books with {
  Title @Search.defaultSearchElement: true;
  Genre @UI.selectionField: [{ position: 40, label: 'Genre', importance: #High }];
}
```

**STEP**: 4 — Verify and test in the running app

**DESCRIPTION**: After updating manifest and annotations:
- Rebuild / restart your app (e.g., for CAP: cds watch or deploy + run).
- Open the List Report page (route for entitySet "Books") and confirm:
  - The table uses the configured table type.
  - Columns match @UI.lineItem order/labels.
  - The Smart Filter Bar shows @UI.selectionField fields and default search behavior.

**LANGUAGE**: Notes

**CODE**:
```text
// Testing checklist (manual)
1. Start the app (cds watch or equivalent).
2. Navigate to the List Report page for entitySet "Books".
3. Confirm table control is ResponsiveTable (or configured type).
4. Confirm table columns: Title, Author, Price, Published.
5. Confirm filter bar contains Author, Price, PublishedAt, Genre.
6. Use the search box to verify default search target (if annotated).
```
--------------------------------

**TITLE**: Configuring Navigation for SAP Fiori elements apps (internal & external)

**INTRODUCTION**: Action-oriented guide to configure internal (in-app) and external (inbound/outbound) navigation for SAP Fiori elements and SAPUI5 apps. Includes manifest.json examples, UI5 routing, CrossApplicationNavigation calls, and how to read inbound startup parameters. Use these snippets in webapp/manifest.json, Component.js, or controllers.

**TAGS**: fiori, fiori-elements, ui5, navigation, manifest.json, routing, sap.ushell, CrossApplicationNavigation, inbound, outbound

STEP: 1 — Configure internal navigation with UI5 router (standard SAPUI5 apps)

DESCRIPTION: Define app routes and targets in webapp/manifest.json under sap.ui5->routing to enable in-app navigation using hash-based routes. Use route patterns with path parameters (e.g., {id}). Use these route names in code to navigate via sap.ui.core.UIComponent.getRouterFor(this).navTo("routeName", {id: "123"}).

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "rootView": {
      "viewName": "my.app.Main",
      "type": "XML",
      "id": "app"
    },
    "routing": {
      "config": {
        "routerClass": "sap.m.routing.Router",
        "viewType": "XML",
        "viewPath": "my.app.view",
        "controlId": "app",
        "controlAggregation": "pages",
        "clearTarget": false
      },
      "routes": [
        {
          "name": "master",
          "pattern": "",
          "target": "master"
        },
        {
          "name": "detail",
          "pattern": "detail/{productId}",
          "target": "detail"
        }
      ],
      "targets": {
        "master": {
          "viewName": "Master",
          "viewLevel": 1
        },
        "detail": {
          "viewName": "Detail",
          "viewLevel": 2
        }
      }
    }
  }
}
```

STEP: 2 — Navigate internally in code using router API

DESCRIPTION: Use the UI5 router to navigate to configured routes. Pass route parameters as an object.

LANGUAGE: JavaScript

CODE:
```javascript
// in a controller
var oRouter = sap.ui.core.UIComponent.getRouterFor(this);

// navigate to detail with route parameter productId = "123"
oRouter.navTo("detail", { productId: "123" });
```

STEP: 3 — Configure Fiori elements internal navigation (framework-managed pages)

DESCRIPTION: For Fiori elements apps (List Report / Object Page templates), the framework exposes a pages array in sap.ui.generic.app in manifest.json. Configure page entries and navigation mappings if you need to customize or declare entitySet relationships. The Fiori elements runtime handles standard navigation; add custom navigation only when needed.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "pageType": "ListReport",
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport"
        },
        "navigation": {
          // optional: custom mapping keys used by the framework
          "to_Product_Details": {
            "route": "ProductDetail"
          }
        }
      },
      {
        "pageType": "ObjectPage",
        "entitySet": "ProductDetails",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      }
    ]
  }
}
```

STEP: 4 — External outbound navigation: use a URL (simple redirect)

DESCRIPTION: Perform a straight URL redirect from the app (useful for external non-intent targets). Use absolute or relative URLs. This does not register an intent in the Fiori Launchpad.

LANGUAGE: JavaScript

CODE:
```javascript
// redirect to a target URL (outside of Launchpad intent handling)
window.location.href = "/sap/bc/ui5_ui5/sap/myOtherApp/index.html?sap-ui-app-id=myOtherApp#/";
```

STEP: 5 — External outbound navigation: intent-based (semantic object) via CrossApplicationNavigation

DESCRIPTION: Use the CrossApplicationNavigation service (sap.ushell.Container) to trigger intent-based navigation (semantic object + action) in Launchpad. Pass params as plain objects where each key value is an array of strings or a single string.

LANGUAGE: JavaScript

CODE:
```javascript
// get service (only available in Launchpad / shell environment)
var oCrossAppNav = sap.ushell && sap.ushell.Container && sap.ushell.Container.getService("CrossApplicationNavigation");

// navigate to semantic object "Product" action "display" with parameter ProductId=123
if (oCrossAppNav) {
  oCrossAppNav.toExternal({
    target: {
      semanticObject: "Product",
      action: "display"
    },
    params: {
      ProductId: ["123"],
      lang: ["en"]
    }
  });
}
```

STEP: 6 — Declare inbound intents in manifest.json (make app a target)

DESCRIPTION: To make your app invokable via a semantic object/action in the Launchpad, declare inbounds in webapp/manifest.json under sap.app->crossNavigation->inbounds. Define signature parameters for expected keys. The Launchpad manager uses this to register and resolve intents.

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "id": "my.app.id",
    "crossNavigation": {
      "inbounds": {
        "Product-display": {
          "semanticObject": "Product",
          "action": "display",
          "title": "Display Product",
          "signature": {
            "parameters": {
              "ProductId": {
                "required": true
              },
              "lang": {}
            }
          }
        }
      }
    }
  }
}
```

STEP: 7 — Handle inbound startup parameters in the app (read intent params)

DESCRIPTION: When the app is launched via an intent, read startup parameters in Component.js or controllers using Component.getComponentData().startupParameters. Use these parameters to drive navigation to the correct page/entity.

LANGUAGE: JavaScript

CODE:
```javascript
// in Component.js init or in a controller onInit
var oComponentData = this.getOwnerComponent().getComponentData && this.getOwnerComponent().getComponentData();
var mStartupParams = (oComponentData && oComponentData.startupParameters) || {};

// ProductId may be an array if passed via CrossApplicationNavigation
var sProductId = mStartupParams.ProductId && mStartupParams.ProductId[0];

// fallback: parse shell hash (if needed) using URLParsing service
if (!sProductId && sap.ushell && sap.ushell.Container) {
  var oURLParsing = sap.ushell.Container.getService("URLParsing");
  var oParsed = oURLParsing.parseShellHash(window.location.hash);
  if (oParsed && oParsed.params && oParsed.params.ProductId) {
    sProductId = oParsed.params.ProductId[0];
  }
}

// use sProductId to navigate/bind models
if (sProductId) {
  // example: navigate to object page route or bind context
  var oRouter = sap.ui.core.UIComponent.getRouterFor(this);
  oRouter.navTo("detail", { productId: sProductId });
}
```

STEP: 8 — Notes and references

DESCRIPTION: Quick pointers and file locations.

LANGUAGE: Text

CODE:
```text
- Manifest file path: webapp/manifest.json
- Component startup data: Component.getComponentData().startupParameters
- Cross app navigation API: sap.ushell.Container.getService("CrossApplicationNavigation")
- URL parsing API in Launchpad: sap.ushell.Container.getService("URLParsing")
- Fiori elements specific navigation pages: sap.ui.generic.app.pages in manifest.json
- For overview page card navigation see: configuring-card-navigation-530f9e6.md
- For internal navigation guidance in Fiori elements see: configuring-internal-navigation-2c65f07.md
- For external navigation guidance see: configuring-external-navigation-1d4a0f9.md
```
--------------------------------

**TITLE**: Configuring Fiori Elements Object Page: Header, Sections (Facets) and Actions via OData Annotations

**INTRODUCTION**: This document shows concrete, copy-paste-ready OData annotation examples and manifest configuration to:
- define object page header information (title, description, image),
- create object page sections (facets) that reference field groups,
- add section actions (DataFieldForAction),
and how to register the annotation file in the UI5 manifest. Use these when implementing or updating a Fiori Elements Object Page.

**TAGS**: fiori-elements-framework, object-page, annotations, OData, UI.v1, HeaderInfo, Facets, FieldGroup, DataFieldForAction, manifest.json, webapp

STEP: Create an OData annotation file for the entity (header + facets + field groups)

DESCRIPTION: Place an XML annotation file under webapp/annotations/ (or your chosen folder). Replace Namespace.EntityType and property names (Name, ShortDescription, ImageUrl) with your service entity type and properties. Actions used in DataFieldForAction must exist in the backend OData service.

LANGUAGE: XML

CODE:
```XML
<!-- File: webapp/annotations/annotations.xml -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="MyService.Namespace.EntityType">
  <!-- Header information: type name, title, description, image -->
  <Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeName" String="Product"/>
      <PropertyValue Property="Title" Path="Name"/>
      <PropertyValue Property="Description" Path="ShortDescription"/>
      <PropertyValue Property="Image" Path="ImageUrl"/>
    </Record>
  </Annotation>

  <!-- Object Page Facets: each ReferenceFacet maps to a FieldGroup qualifier -->
  <Annotation Term="com.sap.vocabularies.UI.v1.Facets">
    <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.ReferenceFacet">
        <PropertyValue Property="Label" String="General Information"/>
        <PropertyValue Property="Target">
          <AnnotationPath>com.sap.vocabularies.UI.v1.FieldGroup#General</AnnotationPath>
        </PropertyValue>
      </Record>
      <Record Type="com.sap.vocabularies.UI.v1.ReferenceFacet">
        <PropertyValue Property="Label" String="Sales Data"/>
        <PropertyValue Property="Target">
          <AnnotationPath>com.sap.vocabularies.UI.v1.FieldGroup#Sales</AnnotationPath>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>

<!-- FieldGroup definitions target the same entity and use Qualifiers referenced above -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="MyService.Namespace.EntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup" Qualifier="General">
    <Record>
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Label" String="Name"/>
            <PropertyValue Property="Value" Path="Name"/>
          </Record>
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Label" String="Description"/>
            <PropertyValue Property="Value" Path="ShortDescription"/>
          </Record>
          <!-- Example action exposed inside the section -->
          <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
            <PropertyValue Property="Action" String="MyService.UpdateProduct"/>
            <PropertyValue Property="Label" String="Edit"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup" Qualifier="Sales">
    <Record>
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Label" String="Sales Organization"/>
            <PropertyValue Property="Value" Path="SalesOrg"/>
          </Record>
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Label" String="Revenue"/>
            <PropertyValue Property="Value" Path="Revenue"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Register the annotation file in manifest.json so the Fiori Elements app loads it

DESCRIPTION: Add the annotation file URI to the model settings in webapp/manifest.json. Update the dataSource/model name according to your project (mainService is a common placeholder). Use a relative path into webapp (e.g., "annotations/annotations.xml").

LANGUAGE: JSON

CODE:
```JSON
/* File: webapp/manifest.json (snippet) */
{
  "sap.app": {
    "id": "my.app",
    "applicationVersion": { "version": "1.0.0" }
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "annotationURI": "annotations/annotations.xml"
        }
      }
    }
  },
  "sap.ui5": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/MY_SERVICE/",
        "type": "OData",
        "settings": { "odataVersion": "2.0" }
      }
    }
  }
}
```

STEP: Backend requirements and best practices

DESCRIPTION: Ensure the OData service exposes:
- the entity type referenced by Target (MyService.Namespace.EntityType),
- any action names used in DataFieldForAction (e.g., MyService.UpdateProduct),
- properties referenced in Path expressions (Name, ShortDescription, ImageUrl, etc.).
Use qualifiers for FieldGroup to keep facets modular and maintainable. Keep header-related properties lightweight for good performance.

LANGUAGE: Text

CODE:
```text
- Backend: Implement OData entity type and actions (UpdateProduct) in service metadata.
- Annotation file path: webapp/annotations/annotations.xml
- Manifest registration: manifest.json setting "annotationURI" -> "annotations/annotations.xml"
```

STEP: Related configuration — Prefilling fields (DefaultValuesFunction)

DESCRIPTION: If you need to prefill fields when creating a new entity or for action parameters, use the DefaultValuesFunction. See the related documentation for implementing DefaultValuesFunction in your backend/service annotations and how to reference it from actions.

LANGUAGE: Text

CODE:
```text
Related doc: Prefilling Fields Using the DefaultValuesFunction
File reference: prefilling-fields-using-the-defaultvaluesfunction-5ada91c.md
```
--------------------------------

**TITLE**: Configuring Overview Page App Extensions (cards + filter area)

**INTRODUCTION**:
This guide shows exactly how to add UI fragments, register them in the app manifest, and implement a controller extension to customize the Overview Page (OVP) card and filter area in a Fiori Elements app. Use these steps to place fragments, wire them into the standard OVP view using viewExtensions, and attach event handlers in a controller extension.

**TAGS**: fiori-elements, overview-page, ovp, sapui5, manifest.json, viewExtensions, controllerExtensions, fragments, cards, filters

STEP: 1 — Add UI fragments for filter area and card extension

DESCRIPTION:
Create XML fragments that contain your custom UI for the filter area and a small custom UI block for a card. Place both files under webapp/extension/fragments. Keep fragment IDs and control IDs relative (no global side effects). Fragments are inserted into the standard OVP view via manifest viewExtensions.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/extension/fragments/CustomFilter.fragment.xml -->
<core:FragmentDefinition
  xmlns:core="sap.ui.core"
  xmlns="sap.m">
  <HBox class="sapUiSmallMargin">
    <SearchField
      id="customSearch"
      placeholder="Search (custom)"
      width="80%"
      liveChange=".onCustomSearchLiveChange"/>
    <Button
      id="customFilterBtn"
      text="Apply"
      press=".onCustomFilterApply"/>
  </HBox>
</core:FragmentDefinition>
```

```xml
<!-- File: webapp/extension/fragments/CustomCard.fragment.xml -->
<core:FragmentDefinition
  xmlns:core="sap.ui.core"
  xmlns="sap.m">
  <VBox class="sapUiSmallMargin">
    <Title text="Custom Card Area"/>
    <Text id="customCardText" text="This area is added to the card region by a view extension."/>
    <Button text="Action" press=".onCustomCardAction"/>
  </VBox>
</core:FragmentDefinition>
```

STEP: 2 — Register fragments in manifest.json using viewExtensions

DESCRIPTION:
Add viewExtensions entries to manifest.json under sap.ui5.viewExtensions to insert the fragments into the OVP standard view. Replace placeholder view name (<OVP_VIEW_NAME>) and extension slot keys (e.g., "BeforeFilterArea", "AfterFilterArea", "BeforeCards") with the actual view and extension point names used in your Fiori Elements OVP implementation — consult the app's existing view names if unsure.

LANGUAGE: JSON

CODE:
```json
// File: webapp/manifest.json (excerpt)
{
  "sap.ui5": {
    "viewExtensions": {
      "<OVP_VIEW_NAME>": {
        "BeforeFilterArea": {
          "className": "sap.ui.core.Fragment",
          "fragment": "extension.fragments.CustomFilter"
        },
        "AfterCards": {
          "className": "sap.ui.core.Fragment",
          "fragment": "extension.fragments.CustomCard"
        }
      }
    }
  }
}
```

Notes:
- Replace "<OVP_VIEW_NAME>" with the full view name for your OVP view (for example: "sap.suite.ui.generic.template.Overview.view.OverviewPage" or the view name used by your app).
- The extension slot keys (BeforeFilterArea, AfterCards) are examples — use the extension points available for your view. If you don't know the slots, inspect the original OVP view or framework docs.

STEP: 3 — Implement a controller extension to handle fragment events

DESCRIPTION:
Create a controller extension to host handlers referenced by the fragments (onCustomSearchLiveChange, onCustomFilterApply, onCustomCardAction). Register this controller in manifest.json under sap.ui5.controllerExtensions mapping the original controller to your extension controller.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/extension/controllers/OverviewExt.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("my.app.extension.controllers.OverviewExt", {
    onInit: function () {
      // initialization code (optional)
    },

    onCustomSearchLiveChange: function (oEvent) {
      var sValue = oEvent.getParameter("newValue");
      // implement search/filter logic or trigger framework search
      // Example: publish to component event, set model filter, etc.
      console.log("Custom search value:", sValue);
    },

    onCustomFilterApply: function () {
      // collect filter values and apply to the OData model / cards
      console.log("Applying custom filters");
    },

    onCustomCardAction: function () {
      // handle custom card button press
      sap.m.MessageToast.show("Custom Card Action triggered");
    }
  });
});
```

```json
// File: webapp/manifest.json (excerpt) — controllerExtensions registration
{
  "sap.ui5": {
    "controllerExtensions": {
      "<ORIGINAL_OVP_CONTROLLER_NAME>": {
        "controllerName": "my.app.extension.controllers.OverviewExt"
      }
    }
  }
}
```

Notes:
- Replace "<ORIGINAL_OVP_CONTROLLER_NAME>" with the fully-qualified name of the OVP view controller you extend (inspect the deployed app or framework docs).
- The controller extension methods will be visible to fragments injected into the host view.

STEP: 4 — (Optional) Add or customize OVP cards in manifest (sap.ovp.cards)

DESCRIPTION:
If you need to add a new card or override a card configuration, add entries under the sap.ovp/cards section in the manifest. The card configuration will be loaded by the OVP runtime.

LANGUAGE: JSON

CODE:
```json
// File: webapp/manifest.json (excerpt)
{
  "sap.ovp": {
    "cards": {
      "CustomCard_1": {
        "template": "sap.ovp.cards.list",
        "settings": {
          "title": "My Custom Card",
          "entitySet": "MyEntitySet",
          "cardLayout": {
            "sizeX": 2,
            "sizeY": 1
          }
        }
      }
    }
  }
}
```

STEP: 5 — File locations summary & deployment tips

DESCRIPTION:
Place files exactly as listed. After changes:
- Rebuild and redeploy the app (or run the SAP UI5 tooling / Fiori Launchpad restart).
- Verify the correct view name and extension slot names; if fragments don’t appear, check console for manifest warnings and confirm the view name and slot keys.

LANGUAGE: TEXT

CODE:
```text
File locations:
- webapp/extension/fragments/CustomFilter.fragment.xml
- webapp/extension/fragments/CustomCard.fragment.xml
- webapp/extension/controllers/OverviewExt.controller.js
- webapp/manifest.json (add viewExtensions, controllerExtensions, and sap.ovp cards as needed)

Deployment tips:
1) Clear browser cache to ensure manifest changes are loaded.
2) Check browser console for manifest and viewExtension warnings if fragments do not render.
3) If unsure about the OVP view name and extension points, open the original view source in your framework/library or search for "viewExtensions" usage in your project templates.
```

--------------------------------

**TITLE**: Configuring Overview Pages Using Runtime Capabilities

**INTRODUCTION**: Short, actionable guidance for enabling end-user runtime personalization on Fiori overview pages: card rearrangement (drag & drop + keyboard), show/hide cards, card resizing and default sizing via manifest.json, and global filtering behavior that affects all relevant cards.

**TAGS**: fiori-elements-framework, overview-page, cards, manifest.json, runtime-capabilities, personalization, ui5, resizing, filters

**STEP**: 1 — Enable and use drag-and-drop (mouse and keyboard)

**DESCRIPTION**: Allow end users to rearrange overview page cards using mouse drag-and-drop or keyboard shortcuts. Provide optional OS-level ClickLock instructions to simulate drag without holding the mouse button. Note limitations: personalization only applies for cards with the same screen resolution/size; browser zoom must be 100%.

**LANGUAGE**: Instructions

**CODE**:
```Text
User actions:
- Drag & drop with mouse: click and drag a card to a new location.
- Keyboard: press Ctrl + Arrow keys to move the focused card.

Optional: Enable ClickLock to click once to start drag and click again to drop (Windows):
1. Open Settings -> Bluetooth and devices -> Touchpad.
2. Click "More touchpad settings" to open classic Mouse Properties.
3. Check "Turn on ClickLock".
4. Use single-click + move to enter drag mode; second click to commit.
Notes:
- Personalization applies only to cards with same resolution/size.
- Browser zoom must be 100%.
- When moving a card, the target location is saved only for moved cards; other cards are reflowed to best fit. To assign specific locations to all cards, move each card at least once.
```

**STEP**: 2 — Configure card resizing and default size in manifest.json

**DESCRIPTION**: To allow end users to resize cards (horizontal and vertical) and to preload cards with a default size, set containerLayout to "resizable" and provide defaultSpan values inside the application manifest.json. Resizing stack cards is not supported.

**LANGUAGE**: JSON

**CODE**:
```json
// File: manifest.json
{
  // Enable resizable container to permit user resizing of cards
  "containerLayout": "resizable",

  // Example default size for a card (rows = vertical span, cols = horizontal span)
  "defaultSpan": {
    "rows": 7,
    "cols": 2
  }

  // Note: place these properties as appropriate in your manifest structure.
  // The sample shows the exact property names required:
  // - containerLayout: "resizable"
  // - defaultSpan: { "rows": <number>, "cols": <number> }
}
```

**STEP**: 3 — Control card visibility at runtime (Manage Cards)

**DESCRIPTION**: End users can hide or show cards using the built-in "Manage Cards" dialog accessed from the overview page header.

**LANGUAGE**: Instructions

**CODE**:
```Text
User actions to hide/show cards:
1. In the overview page header, click/tap the Options icon and select "Manage Cards".
2. Use the checkbox next to each card to hide or show it.
3. Click "OK" to save changes.
4. To restore defaults, open Manage Cards and click "Reset".

Behavior notes:
- Hidden/shown state is persisted per user/per personalization scope.
```

**STEP**: 4 — Filtering behavior across cards

**DESCRIPTION**: Filters applied by end users affect all relevant cards on the overview page. Use runtime filters to define specific field values or ranges (for example: show only orders where supply date has passed). Ensure cards are configured to respect global filters.

**LANGUAGE**: Instructions

**CODE**:
```Text
Behavior notes for filters:
- When a user applies a filter on the overview page, the filter is propagated to all cards that are bound to the relevant field(s).
- Filters can be value-based or range-based (e.g., date ranges).
- Ensure card data bindings and queries support receiving and applying these runtime filters.
```

**STEP**: 5 — Limitations and best practices

**DESCRIPTION**: Consolidated list of constraints and recommendations to ensure reliable personalization and layout behavior.

**LANGUAGE**: Instructions

**CODE**:
```Text
Limitations & recommendations:
- Personalization applies only for cards with the same screen resolution and size.
- Set browser zoom to 100% to ensure correct drag & drop behavior.
- Resizing of stack cards is not supported.
- To consistently assign positions to all cards, move each card at least once (target location is saved only for moved cards).
- Test card resizing and defaultSpan behavior across supported devices and resolutions.
```
--------------------------------

**TITLE**: Configuring Sort Properties for Fiori Elements Cards

**INTRODUCTION**: This guide shows how to configure sorting for Fiori elements cards (list, table, stack) using either the app descriptor (manifest.json) or service/UI annotations (OData XML, ABAP CDS, CAP CDS). Use manifest.json for card-specific client-side defaults and PresentationVariant annotations to expose reusable sort logic server-side (and to share sort parameters across apps).

**TAGS**: fiori-elements-framework, sap-ovp, annotations, presentation-variant, sorting, manifest, CDS, OData

**STEP**: 1 — Configure sorting in manifest.json (card-level)
**DESCRIPTION**: Add sortBy and sortOrder under the card's settings in webapp/manifest.json to apply client-side sorting for a specific card. Replace card id and entitySet as required. sortOrder accepts "ascending" or "descending".
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card04": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.list",
        "settings": {
          "sortBy": "Price",
          "sortOrder": "descending",
          "listFlavor": "bar",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#bar",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#bar",
          "category": "{{card04_category}}",
          "entitySet": "Products"
        }
      }
    }
  }
}
```

**STEP**: 2 — Configure sort using OData annotation (XML PresentationVariant)
**DESCRIPTION**: Define a PresentationVariant annotation (com.sap.vocabularies.UI.v1.PresentationVariant) in your annotation file (e.g., annotations.xml) to provide server-side sort configuration. Use SortOrder collection to list one or more properties and set Descending to true when needed. Reference this PresentationVariant by qualifier from the card or other Fiori Elements apps.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant" Qualifier="Eval_by_Country">
  <Record>
    <PropertyValue Property="GroupBy">
      <Collection>
        <PropertyPath>Country</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record>
          <PropertyValue Property="Property" PropertyPath="Sales" />
          <PropertyValue Property="Descending" Boolean="true" />
        </Record>
        <!-- Add more <Record> entries here to sort by multiple properties -->
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
        <AnnotationPath>@UI.Chart#Eval_by_Country</AnnotationPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 3 — Configure sort using ABAP CDS annotation
**DESCRIPTION**: Use the @UI.PresentationVariant annotation on an ABAP CDS view to specify groupBy, sortOrder and visualizations. Use the qualifier to reference the presentation variant from the UI.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.PresentationVariant: [
  {
    groupBy: [
      'COUNTRY'
    ],
    sortOrder: [
      {
        by: 'SALES'
      }
    ],
    visualizations: [
      {
        type: #AS_CHART,
        qualifier: 'Eval_by_Country'
      }
    ],
    qualifier: 'Eval_by_Country'
  }
]
annotate view VIEWNAME with { 
  // Additional annotations can be added here
}
```

**STEP**: 4 — Configure sort using CAP CDS annotation
**DESCRIPTION**: In CAP (Core Data Services) model files, define UI.PresentationVariant with GroupBy, SortOrder and Visualizations. Set Descending true to reverse order. Reference the qualifier from the UI.
**LANGUAGE**: CDS
**CODE**:
```cds
UI.PresentationVariant #Eval_by_Country : {
  GroupBy : [
    Country
  ],
  SortOrder : [
    {
      Property : Sales,
      Descending : true
    }
  ],
  Visualizations : [
    '@UI.Chart#Eval_by_Country'
  ]
},
```

**STEP**: 5 — Share sort parameters across applications (Overview pages & external navigation)
**DESCRIPTION**: Overview pages can publish sort parameters from PresentationVariant annotations to target Fiori Elements applications via external navigation. Targets can consume these parameters to apply the same sorting behavior. For implementation details on configuring external navigation, consult your project's external navigation configuration (see configuring-external-navigation-1d4a0f9.md).
--------------------------------

**TITLE**: Configuring Tables (SAP Fiori Elements — OData V4 and V2)

**INTRODUCTION**: How to configure table columns, actions, importance and default visualization/sort order in SAP Fiori Elements using OData V4 annotations (UI.LineItem and UI.PresentationVariant). Also notes for OData V2 (SmartTable). Use these annotation XML snippets in your service annotations file (annotations.xml, CDS-annotated metadata or the service metadata) and configure any runtime behavior via manifest.json entries as required.

**TAGS**: fiori-elements, odata-v4, odata-v2, tables, annotations, UI.LineItem, UI.PresentationVariant, manifest.json

**STEP**: 1 — Control tables via annotations and manifest.json

**DESCRIPTION**: Use annotations to define table columns, actions, navigation, and importance. Place these annotations in your OData service annotations file (for OData V4: annotations.xml or service-level annotations). Use manifest.json entries to influence runtime control properties where applicable (for example, enabling smart table features or controlling default variants).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "note": "Place UI-related runtime configuration for Fiori Elements tables here as needed (smart table settings, default variant selection, etc.). Actual manifest.json keys depend on page type and Fiori Elements version."
}
```

**STEP**: 2 — Define table content with UI.LineItem (OData V4)

**DESCRIPTION**: Define the table columns, labels, importance, intent-based navigation, and actions inside the UI.LineItem annotation. Use Qualifier to reference this LineItem from a PresentationVariant or to provide multiple variants.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.LineItem" Qualifier="Default">
  <Collection>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="DeliveryCalendarYear"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="DeliveryCalendarMonth"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="SalesOrder"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>

    <!-- Intent-based navigation data field -->
    <Record Type="UI.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="Label" String="Manage Sales Order"/>
      <PropertyValue Property="SemanticObject" String="EPMSalesOrder"/>
      <PropertyValue Property="Action" String="manage_st"/>
      <PropertyValue Property="RequiresContext" Bool="false"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>

    <Record Type="UI.DataField">
      <PropertyValue Property="Label" String="Item"/>
      <PropertyValue Property="Value" Path="SalesOrderItem"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>

    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="Product"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>

    <!-- Action in a line item -->
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy"/>
      <PropertyValue Property="Action" String="CZ_EASILINEITEMS_SADL_CDS.CZ_EASILINEITEMS_SADLType/Copy"/>
      <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/Isolated"/>
      <PropertyValue Property="Determining" Bool="true"/>
    </Record>

    <Record Type="UI.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="Label" String="Manage Products (STTA)"/>
      <PropertyValue Property="SemanticObject" String="EPMProduct"/>
      <PropertyValue Property="Action" String="manage_st"/>
      <PropertyValue Property="Determining" Bool="true"/>
    </Record>
  </Collection>
</Annotation>
```

**STEP**: 3 — Package LineItem into UI.PresentationVariant to set default visualization and sorting

**DESCRIPTION**: Create a UI.PresentationVariant annotation that references the LineItem (via AnnotationPath) to control which LineItem qualifier is used for the default visualization and to define default SortOrder. Use PropertyValue/Text to name the variant and PropertyValue/Visualizations to reference the LineItem qualifier.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.PresentationVariant">
  <Record>
    <PropertyValue Property="Text" String="Default"/>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record Type="Common.SortOrderType">
          <PropertyValue Property="Property" PropertyPath="NetAmount"/>
          <PropertyValue Property="Descending" Bool="true"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
         <!-- Reference the LineItem qualifier -->
         <AnnotationPath>@UI.LineItem#Default</AnnotationPath>
      </Collection>
   </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 4 — OData V2: use SmartTable (sap.ui.comp.smarttable.SmartTable)

**DESCRIPTION**: For OData V2 apps, prefer sap.ui.comp.smarttable.SmartTable and the corresponding annotation/manifest.json configuration to control table behavior. Consult the SmartTable API for properties and available features. Choose the appropriate table control per app requirements (see "Tables: Which One Should I Choose?").

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: typical SmartTable usage is configured via XML view or manifest.json.
// Reference: sap.ui.comp.smarttable.SmartTable API for control-specific options.
```

**STEP**: 5 — Related resources and additional notes

**DESCRIPTION**: Links and file references for further customization (i18n texts, default column width, extension points).

**LANGUAGE**: Markdown

**CODE**:
```markdown
Related Information:
- Maintaining Standard Texts for Tables: maintaining-standard-texts-for-tables-aacfac5.md
- Maintaining Standard Texts for Charts: maintaining-standard-texts-for-charts-37cd601.md
- Setting the Default Column Width: setting-the-default-column-width-a765253.md
- Extension Points for Tables: extension-points-for-tables-d525522.md

API / further reading:
- SmartTable API: https://ui5.sap.com/#/api/sap.ui.comp.smarttable.SmartTable
- Choosing a table control: ../10_More_About_Controls/tables-which-one-should-i-choose-148892f.md
- Presentation variant behavior: configuring-default-settings-visualizations-sort-order-filter-values-49a6ba5.md
```
--------------------------------

**TITLE**: Configure Application Title (Fiori elements)

**INTRODUCTION**: This guide shows how to set the application title that appears in the shell bar/header of Fiori elements pages (List Report, Object Page, Overview Page, Analytical List Page). Primary method: change the UI.HeaderInfo.TypeName (and TypeNamePlural) annotation on the entity that backs the page. Examples provided for ABAP CDS annotations, OData annotation XML (V2), and manifest/i18n fallback.

**TAGS**: fiori-elements, annotations, UI.HeaderInfo, typeName, CDS, OData, manifest, i18n

STEP: 1 — Set title in ABAP CDS (recommended for S/4HANA / ABAP CDS-based services)

DESCRIPTION: Add or update the @UI.headerInfo annotation on the CDS entity/view that backs the page. Place this in the CDS source file where the entity/view is defined.

LANGUAGE: CDS
CODE:
```CDS
// File: <your_package>/views/ZI_SalesOrder.cds (example path in ABAP repo)
@AbapCatalog.sqlViewName: 'ZV_SALESORDER'
@EndUserText.label: 'Sales Order View'
@UI.headerInfo: {
  typeName: 'Sales Order',
  typeNamePlural: 'Sales Orders'
}
define view ZI_SalesOrder as select from sepm_sadl_saledoc {   // example
  key SalesOrderID,
  SalesOrderDate,
  CustomerName
}
```

STEP: 2 — Set title in OData annotation XML (V2 services)

DESCRIPTION: If you provide separate OData annotation XML files, update the UI.HeaderInfo annotation on the target EntityType (or EntitySet) used by the List Report / Object Page. Place the file under your annotations folder (e.g., webapp/annotations/annotations.xml) or in the service annotations delivered with the OData service.

LANGUAGE: XML
CODE:
```XML
<!-- File: webapp/annotations/annotations.xml -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:DataServices>
    <Annotations Target="MyService.SalesOrder">  <!-- use your EntityType or fully qualified target -->
      <Annotation Term="UI.HeaderInfo">
        <Record>
          <PropertyValue Property="TypeName" String="Sales Order"/>
          <PropertyValue Property="TypeNamePlural" String="Sales Orders"/>
        </Record>
      </Annotation>
    </Annotations>
  </edmx:DataServices>
</edmx:Edmx>
```

STEP: 3 — Fallback: manifest.json title using i18n (FLP tile / app title source)

DESCRIPTION: The FLP/app descriptor title can also influence displayed titles in some deployment scenarios. Keep i18n keys for app title and subtitle in manifest.json and webapp/i18n/i18n.properties. This is a fallback and does not replace UI.HeaderInfo for object type naming inside page headers.

LANGUAGE: JSON
CODE:
```JSON
// File: webapp/manifest.json (relevant snippet)
{
  "sap.app": {
    "id": "your.app.namespace",
    "title": "{{appTitle}}",
    "subTitle": "{{appSubTitle}}"
  }
}
```

LANGUAGE: properties
CODE:
```properties
# File: webapp/i18n/i18n.properties
appTitle = Sales Orders
appSubTitle = Manage your sales orders
```

STEP: 4 — Apply same annotation for Overview Page and Analytical List Page

DESCRIPTION: For Overview Pages and Analytical List Pages, change the same UI.HeaderInfo.TypeName on the entity/entity type that the page uses. The mechanism is identical: update CDS or OData annotations for the entity that provides the page-level context. Example snippets from Steps 1 and 2 apply.

LANGUAGE: XML
CODE:
```XML
<!-- Example target might be an overview entity -->
<Annotations Target="MyService.OverviewEntity">
  <Annotation Term="UI.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeName" String="Overview Application"/>
      <PropertyValue Property="TypeNamePlural" String="Overview Applications"/>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 5 — Notes and related items

DESCRIPTION: Use TypeName and TypeNamePlural to control singular/plural forms. If you need object page titles/subtitles or table headers, configure the specific annotations for those UI areas (see UI.LineItem, UI.FieldGroup, UI.Title annotation usage). For sample code and deeper examples, update the UI.HeaderInfo in the same annotation namespace used by your app (CDS or OData XML).
--------------------------------

**TITLE**: Configure Chart-Only View as the Default in SAP Fiori Elements Analytical List Page (ALP)

**INTRODUCTION**: This document shows the exact manifest and annotation changes required to make the chart-only view the default for an Analytical List Page (ALP). It includes actionable manifest.json updates for OData V2 and V4, annotation examples (XML / ABAP CDS / CAP CDS) for SelectionPresentationVariant, PresentationVariant and Chart, and manifest-level chart settings (data labels, stable colors, chartPresentationQualifier). Use these snippets directly in your project files.

**TAGS**: fiori-elements-framework, analytical-list-page, ALP, chart, manifest.json, annotations, OData V2, OData V4, ABAP CDS, CAP CDS, JSON, XML

STEP: 1 — Set ALP page entry in manifest.json (OData V2)
DESCRIPTION: Add an ALP page entry to manifest.json using the AnalyticalListPage component. Use the "qualifier" to reference SelectionPresentationVariant / PresentationVariant qualifiers. Place this under sap.ui.generic.app.pages in your manifest.json.
LANGUAGE: JSON
CODE:
```JSON
// manifest.json (snippet)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "qualifier": "DefaultVariant"
          }
        }
      }
    ]
  }
}
```

STEP: 2 — Set ALP view config in manifest.json (OData V4) to default to chart-only
DESCRIPTION: For OData V4, configure views.paths and set "defaultPath" to "primary" so the primary (chart) view loads by default.
LANGUAGE: JSON
CODE:
```JSON
// manifest.json (snippet for OData V4)
{
  "views": {
    "paths": [
      {
        "primary": [
          {
            "annotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant"
          }
        ],
        "secondary": [
          {
            "annotationPath": "com.sap.vocabularies.UI.v1.LineItem"
          }
        ],
        "defaultPath": "primary"
      }
    ]
  }
}
```

STEP: 3 — Define SelectionPresentationVariant annotation with qualifier "DefaultVariant"
DESCRIPTION: Create a SelectionPresentationVariant that links a SelectionVariant and a PresentationVariant. Use the qualifier "DefaultVariant" and reference the presentation qualifier used for charts.
LANGUAGE: XML
CODE:
```XML
<!-- UI.SelectionPresentationVariant with Qualifier="DefaultVariant" -->
<Annotation Term="UI.SelectionPresentationVariant" Qualifier="DefaultVariant">
  <Record>
    <PropertyValue Property="Text" String="Product Financial Analysis"/>
    <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#DefaultSelectionVariant"/>
    <PropertyValue Property="PresentationVariant" Path="@UI.PresentationVariant#DefaultPresentationVariant"/>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```ABAP CDS
@UI.SelectionPresentationVariant: [
  {
    text: 'Product Financial Analysis',
    selectionvariantqualifier: 'DefaultSelectionVariant',
    presentationvariantqualifier: 'DefaultPresentationVariant',
    qualifier: 'DefaultVariant'
  }
]
annotate view VIEWNAME with {
  // annotate fields or leave empty if annotations are in separate file
}
```

LANGUAGE: CDS
CODE:
```CDS
// CAP CDS
UI.SelectionPresentationVariant #DefaultVariant : {
    Text : 'Product Financial Analysis',
    SelectionVariant : ![@UI.SelectionVariant#DefaultSelectionVariant],
    PresentationVariant : ![@UI.PresentationVariant#DefaultPresentationVariant]
}
```

STEP: 4 — Define PresentationVariant annotation that uses the Chart visualization
DESCRIPTION: Create a PresentationVariant with qualifier DefaultPresentationVariant. Include SortOrder and Visualizations that reference a UI.Chart qualifier (e.g., @UI.Chart#Default) so the ALP renders the chart view.
LANGUAGE: XML
CODE:
```XML
<!-- UI.PresentationVariant with Qualifier="DefaultPresentationVariant" -->
<Annotation Term="UI.PresentationVariant" Qualifier="DefaultPresentationVariant">
  <Record>
    <PropertyValue Property="Text" String="Default"/>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record Type="Common.SortOrderType">
          <PropertyValue Property="Property" PropertyPath="NetAmount"/>
          <PropertyValue Property="Descending" Bool="true"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
         <AnnotationPath>@UI.Chart#Default</AnnotationPath>
      </Collection>
   </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```ABAP CDS
@UI.PresentationVariant: [
  {
    text: 'Default',
    sortOrder: [
      {
        by: 'NETAMOUNT',
        direction: #DESC
      }
    ],
    visualizations: [
      {
        type: #AS_CHART,
        qualifier: 'Default'
      }
    ],
    qualifier: 'DefaultPresentationVariant'
  }
]
annotate view VIEWNAME with {
  // annotate fields or leave empty if annotations are in separate file
}
```

LANGUAGE: CDS
CODE:
```CDS
// CAP CDS
UI.PresentationVariant #DefaultPresentationVariant : {
    Text : 'Default',
    SortOrder : [
        {
            $Type : 'Common.SortOrderType',
            Property : NetAmount,
            Descending : true
        }
    ],
    Visualizations : [
        '@UI.Chart#Default'
    ]
}
```

STEP: 5 — Define the Chart annotation (UI.Chart) with qualifier "Default"
DESCRIPTION: Add a chart definition (UI.Chart) that specifies title, chart type, dimensions, dimension roles, measures, and measure attributes. Use qualifier matching the PresentationVariant visualizations entry (e.g., Default).
LANGUAGE: XML
CODE:
```XML
<!-- UI.Chart Qualifier="Default" -->
<Annotation Term="UI.Chart" Qualifier="Default">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Revenue by Customer"/>
    <PropertyValue Property="Description" String="Net Revenue by Customer"/>
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
    <PropertyValue Property="Dimensions">
      <Collection>
        <PropertyPath>SoldToParty</PropertyPath>
        <PropertyPath>DeliveryCalendarYear</PropertyPath>
      </Collection>
     </PropertyValue>
     <PropertyValue Property="DimensionAttributes">
       <Collection>
          <Record Type="UI.ChartDimensionAttributeType">
             <PropertyValue Property="Dimension" PropertyPath="SoldToParty"/>
             <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category"/>
          </Record>
          <Record Type="UI.ChartDimensionAttributeType">
             <PropertyValue Property="Dimension" PropertyPath="DeliveryCalendarYear"/>
             <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Series"/>
          </Record>
       </Collection>
     </PropertyValue>
     <PropertyValue Property="Measures">
       <Collection>
         <PropertyPath>NetAmount</PropertyPath>
       </Collection>
     </PropertyValue>
     <PropertyValue Property="MeasureAttributes">
       <Collection>
          <Record Type="UI.ChartMeasureAttributeType">
             <PropertyValue Property="Measure" PropertyPath="NetAmount"/>
             <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
             <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#NetAmount"/>
          </Record>
       </Collection>
     </PropertyValue>
   </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```ABAP CDS
@UI.Chart: [
  {
    title: 'Revenue by Customer',
    description: 'Net Revenue by Customer',
    chartType: #COLUMN,
    dimensions: [
      'SOLDTOPARTY',
      'DELIVERYCALENDARYEAR'
    ],
    dimensionAttributes: [
      {
        dimension: 'SoldToParty',
        role: #CATEGORY
      },
      {
        dimension: 'DeliveryCalendarYear',
        role: #SERIES
      }
    ],
    measures: [
      'NETAMOUNT'
    ],
    measureAttributes: [
      {
        measure: 'NetAmount',
        role: #AXIS_1,
        asDataPoint: true
      }
    ],
    qualifier: 'Default'
  }
]
annotate view VIEWNAME with {
  // annotate fields or leave empty if annotations are in separate file
}
```

LANGUAGE: CDS
CODE:
```CDS
// CAP CDS
UI.Chart #Default : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Revenue by Customer',
    Description : 'Net Revenue by Customer',
    ChartType : #Column,
    Dimensions : [
        SoldToParty,
        DeliveryCalendarYear
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : SoldToParty,
            Role : #Category
        },
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : DeliveryCalendarYear,
            Role : #Series
        }
    ],
    Measures : [
        NetAmount
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : NetAmount,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#NetAmount'
        }
    ]
}
```

STEP: 6 — Reference PresentationVariant in manifest.json using chartPresentationQualifier
DESCRIPTION: Use chartPresentationQualifier in the ALP component settings to render the chart based on the specific PresentationVariant qualifier (value should match the PresentationVariant qualifier, e.g., "DefaultPresentationVariant").
LANGUAGE: JSON
CODE:
```JSON
// manifest.json (ALP settings)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "qualifier": "DefaultVariant",
            "chartPresentationQualifier": "DefaultPresentationVariant"
          }
        }
      }
    ]
  }
}
```

STEP: 7 — Enable chart data labels in manifest.json
DESCRIPTION: Turn on data labels in smart charts and KPI cards using chartSettings.showDataLabel = true (default is false). Place under the component settings for the page entry.
LANGUAGE: JSON
CODE:
```JSON
// manifest.json (enable data labels)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCubeALPResults",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "chartSettings": {
              "showDataLabel": true
            }
          }
        }
      }
    ]
  }
}
```

STEP: 8 — Enable stable colors and define dimension color mapping in manifest.json
DESCRIPTION: Configure stable colors so specific dimension values map to defined colors and legend order. Set chartSettings.enableStableColors = true and specify dimensionSettings with dimension names and value mappings.
LANGUAGE: JSON
CODE:
```JSON
// manifest.json (enableStableColors and dimensionSettings)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "chartSettings": {
              "showDataLabel": true,
              "enableStableColors": true,
              "dimensionSettings": {
                "CostElement": {
                  "400020": {
                    "color": "red",
                    "legendIndex": 0
                  },
                  "421000": {
                    "color": "sapUiChartPaletteSemanticNeutral",
                    "legendIndex": 1
                  },
                  "417900": {
                    "color": "blue",
                    "legendIndex": 2
                  }
                },
                "Customer": {
                  "C000013": {
                    "color": "red",
                    "legendIndex": 0
                  },
                  "C000085": {
                    "color": "blue",
                    "legendIndex": 1
                  }
                },
                "default": {
                  "color": "green"
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 9 — Add semantic object annotation to dimension properties for semantic navigation
DESCRIPTION: Annotate a dimension property with a semantic object so smart charts can resolve semantic navigation and construct navigation links for selected chart segments.
LANGUAGE: XML
CODE:
```XML
<!-- Example XML annotation for Cost_Center dimension -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="Emp_Line_Item.Item/Cost_Center">
  <Annotation Term="com.sap.vocabularies.Common.v1.SemanticObject" String="CostCenter"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```ABAP CDS
// ABAP CDS annotate property with semantic object
annotate view ITEM with {
  @Consumption.semanticObject: 'CostCenter'
  cost_center;
}
```

STEP: 10 — Summary actions to make chart-only default (quick checklist)
DESCRIPTION: Apply these exact steps in your project:
- Add SelectionPresentationVariant (Qualifier: DefaultVariant) linking a SelectionVariant and PresentationVariant.
- Add PresentationVariant (Qualifier: DefaultPresentationVariant) whose Visualizations include @UI.Chart#Default.
- Add UI.Chart (Qualifier: Default) defining dimensions/measures and roles.
- In manifest.json set chartPresentationQualifier to "DefaultPresentationVariant" (or the qualifier you used).
- For OData V4, ensure views.paths.defaultPath is "primary".
- Optionally enable chartSettings.showDataLabel and chartSettings.enableStableColors and provide dimensionSettings mapping.

LANGUAGE: JSON
CODE:
```JSON
// Minimal combined manifest.json settings summary (use appropriate entitySet and qualifiers)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "qualifier": "DefaultVariant",
            "chartPresentationQualifier": "DefaultPresentationVariant",
            "chartSettings": {
              "showDataLabel": true,
              "enableStableColors": true
            }
          }
        }
      }
    ]
  },
  "views": {
    "paths": [
      {
        "defaultPath": "primary"
      }
    ]
  }
}
```
--------------------------------

**TITLE**: Configuring the ALP Content Area (UI.Chart / UI.LineItem + manifest.json)

**INTRODUCTION**: Show how to enable and render the Analytical List Page (ALP) content area by adding the necessary OData annotations (UI.Chart and UI.LineItem) and the relevant manifest.json settings (contentTitle and enabling the content tile / FilterableKPI). Includes example annotation file and manifest.json snippets and explicit instructions on view-mode behavior and dynamic page header pinning.

**TAGS**: fiori-elements-framework, analytical-list-page, manifest.json, annotations, UI.Chart, UI.LineItem, FilterableKPI, dynamic-page-header

STEP: 1 — Add UI.Chart and UI.LineItem annotations (OData V2 / XML)

DESCRIPTION: Add annotations to your service annotation file to define chart visualization (measures/dimensions) and table columns (LineItem). Place this file in your annotation folder (example: webapp/annotations/ALPAnnotations.xml) and register it with your service/model as usual.

LANGUAGE: XML

CODE:
```XML
<?xml version="1.0" encoding="utf-8"?>
<!-- File: webapp/annotations/ALPAnnotations.xml -->
<edmx:Edmx Version="1.0" xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx">
  <edmx:DataServices>
    <Schema Namespace="MyService" xmlns="http://docs.oasis-open.org/odata/ns/edm" xmlns:UI="http://docs.oasis-open.org/odata/ns/annotation/ui">
      <!-- Target the entity type (replace with your service/EntityType) -->
      <Annotations Target="MyService.MainEntityType">
        <!-- Chart annotation: enables chart area (measures/dimensions) -->
        <Annotation Term="UI.Chart">
          <Record Type="UI.ChartType">
            <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
            <PropertyValue Property="Measures">
              <Collection>
                <PropertyPath>Revenue</PropertyPath>
              </Collection>
            </PropertyValue>
            <PropertyValue Property="Dimensions">
              <Collection>
                <PropertyPath>Region</PropertyPath>
              </Collection>
            </PropertyValue>
          </Record>
        </Annotation>

        <!-- LineItem annotation: enables table columns in the content area -->
        <Annotation Term="UI.LineItem">
          <Collection>
            <Record Type="UI.DataField">
              <PropertyValue Property="Value" Path="SalesOrderID"/>
            </Record>
            <Record Type="UI.DataField">
              <PropertyValue Property="Value" Path="Revenue"/>
            </Record>
            <Record Type="UI.DataField">
              <PropertyValue Property="Value" Path="CustomerName"/>
            </Record>
          </Collection>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

STEP: 2 — Configure contentTitle and enable content tile (manifest.json)

DESCRIPTION: Add ALP page configuration in webapp/manifest.json. Set contentTitle to add a title to the content area. Enable the content tile / FilterableKPI view by specifying the content tile setting in the page component settings. Replace entitySet and component name as required for your app.

LANGUAGE: JSON

CODE:
```JSON
// File: webapp/manifest.json (snippet)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "MainEntitySet",               // Replace with your main entitySet
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "contentTitle": "Sales Overview",      // Title shown above the content area
            "contentTile": {
              "enabled": true                      // When present/enabled, FilterableKPI view appears with segmented buttons
            }
          }
        }
      }
    ]
  }
}
```

STEP: 3 — How view modes are determined and how to enable each mode

DESCRIPTION: The displayed view mode is determined by the presence of annotations and manifest settings:
- Chart-only view: define a valid UI.Chart annotation and omit UI.LineItem (or configure manifest to default to chart-only as needed).
- Table-only view: define UI.LineItem without UI.Chart (or configure manifest to default to table-only).
- Hybrid (default ALP behavior): define both UI.Chart and UI.LineItem. The ALP shows segmented buttons (Hybrid / Chart / Table) allowing users to switch.

Actionable checklist:
- Ensure UI.Chart is present to enable chart rendering (measures + dimensions).
- Ensure UI.LineItem is present to enable table rendering (data fields).
- If you want the FilterableKPI tile to appear, enable contentTile in manifest.json (see Step 2).

LANGUAGE: Plain text

CODE:
```text
- If both UI.Chart and UI.LineItem exist -> hybrid view with segmented controls (Chart / Table / Hybrid).
- If only UI.Chart exists -> chart-only rendering.
- If only UI.LineItem exists -> table-only rendering.
- To surface the FilterableKPI tile and segmented buttons together, enable the content tile in manifest.json (see Step 2).
```

STEP: 4 — Dynamic Page Header (pinning behavior and device considerations)

DESCRIPTION: The dynamic page header supports a pin toggle only when the app uses a responsive table and only on desktop, hybrid, and 'M' size devices (tablets). The pin toggle keeps the header content expanded while scrolling. Notes:
- The pin button is NOT available for other table types (non-responsive tables).
- The pin button is NOT available for 'S' size devices (mobile phones), even though responsive tables are the default for ALP.

LANGUAGE: Plain text

CODE:
```text
- Requirement for pin toggle to appear:
  - Use a responsive table in the content area (desktop / hybrid / M devices).
- Not supported:
  - Non-responsive tables -> pin toggle not shown.
  - S-size (mobile) devices -> pin toggle not shown even if responsive table is used.
```

STEP: 5 — Files & registration checklist

DESCRIPTION: Quick mapping of files and registration steps you must complete.

LANGUAGE: Plain text

CODE:
```text
- Annotation XML file (example): webapp/annotations/ALPAnnotations.xml
  - Add UI.Chart and UI.LineItem as shown in Step 1.
- Manifest snippet (example): webapp/manifest.json
  - Add contentTitle and contentTile settings inside the ALP page component (see Step 2).
- Register your annotation file with the OData model / manifest (ensure the annotation file is loaded by the service).
- Verify in runtime:
  - Chart renders (measure/dimension mapping).
  - Table renders (LineItem fields).
  - Segmented buttons appear when both annotations exist.
  - FilterableKPI shown when contentTile.enabled = true.
  - Dynamic page header pin toggle behavior matches device/table type constraints.
```
--------------------------------

**TITLE**: Configuring Quick View Content (UI.QuickViewFacets) for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: This document explains how to configure the content area of Quick Views (UI.QuickViewFacets) in SAP Fiori Elements. It covers title/header configuration, field groups, contacts, DataPoints, footer navigation, and sample annotations in XML, ABAP CDS, and CAP CDS. Use these steps when implementing Quick View popovers for entity types in OData V2 and OData V4 apps.

**TAGS**: fiori-elements, quick-view, UI.QuickViewFacets, HeaderInfo, FieldGroup, DataPoint, Contact, annotations, ODataV2, ODataV4, ABAP, CAP, XML

**STEP**: 1 — Configure Title Area (header)
**DESCRIPTION**: Set up header image, title, and description shown in the Quick View. Note differences between OData V2 and V4.
**LANGUAGE**: Text
**CODE**:
```text
OData V2:
- Images:
  - Provide HeaderInfo.ImageUrl OR HeaderInfo.TypeImageUrl to display an image.
  - If both are present, ImageUrl is evaluated first, then TypeImageUrl.
  - The value (string/path) supports navigation properties (path evaluation applies).

- Title:
  - Title is composed according to the TextArrangement annotation (e.g., TextLast, TextOnly).
  - If a main navigation is defined, the title is displayed as a link.

- Description:
  - Description must follow TextArrangement.
  - If Description is empty, title size increases and description area is left empty (e.g., TextOnly).

OData V4:
- Images:
  - Provide one of HeaderInfo.ImageUrl, HeaderInfo.TypeImageUrl, or HeaderInfo.Initials to display image/initials.
  - If none provided, no image is shown.

- Title:
  - Title is taken from HeaderInfo.Title.
  - To render title as a link, define a primary action via the sap-tag parameter `primaryAction`.
  - Restriction: "Open link in new tab" in browser is not supported for title links (navigates to Fiori Launchpad instead).

- Description:
  - Description is taken from HeaderInfo.Description.
  - If not maintained, subtitle shows the label of the source property.
```

**STEP**: 2 — Configure Content Area: Field Groups
**DESCRIPTION**: Define ReferenceFacets that point to FieldGroup annotations. Field groups display property values and support common UI annotations. Position in the Quick View is the order of ReferenceFacet entries.
**LANGUAGE**: Text
**CODE**:
```text
- Add any number of field group reference facets or none.
- Each field group may have a label: declared inside the Record Type="UI.ReferenceFacet".
- Field paths can include navigation properties (path evaluation applies).
- Supported UI annotations on fields: IsEmailAddress, IsUrl, IsPhoneNumber.
  - Links that would open a popover from fields are ignored in Quick View.
- Field types:
  - Interpreted by SmartField: DataField (including criticality), DataFieldWithUrl
  - Interpreted by SAP Fiori elements: DataFieldWithIntentBasedNavigation
```

**STEP**: 3 — Configure Content Area: Contacts
**DESCRIPTION**: Add ReferenceFacet entries that point to com.sap.vocabularies.Communication.v1.Contact annotations to show contacts inside the Quick View.
**LANGUAGE**: Text
**CODE**:
```text
- You can place any number of contact facets; their display order equals their position in the UI.QuickViewFacets collection.
- Each contact reference facet must target a com.sap.vocabularies.Communication.v1.Contact annotation.
- If a contact's picture, title, and description match the Quick View title area, the contact title area is not shown.
- Label for the contact facet can be provided inside the Record Type="UI.ReferenceFacet".
```

**STEP**: 4 — Configure Content Area: DataPoints
**DESCRIPTION**: Add ReferenceFacet entries that point to UI.DataPoint annotations to display DataPoints in the Quick View.
**LANGUAGE**: Text
**CODE**:
```text
- You can place DataPoint facets anywhere; their display order equals their position in the UI.QuickViewFacets collection.
- Each DataPoint reference facet must target a UI.DataPoint annotation.
- A DataPoint can have a label declared inside the Record Type="UI.ReferenceFacet".
```

**STEP**: 5 — Sample Quick View Facet Annotations (XML, ABAP CDS, CAP CDS)
**DESCRIPTION**: Use these sample annotations to combine a field group, a contact, and a DataPoint in UI.QuickViewFacets. Apply to the target entity type in your metadata/annotation files or annotation provider.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType">
    <Annotation Term="UI.QuickViewFacets">
        <Collection>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SupplierQuickViewPOC_FieldGroup_1" />
            </Record>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Label" String="Main Contact Person" />
                <PropertyValue Property="Target" AnnotationPath="@Communication.Contact#KeyAccount"/>
            </Record>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Label" String="DataPoint in QV"/>
                <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Product"/>
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
annotate view STTA_C_MP_SUPPLIER with {
  @UI.Facet: [
    {
      targetQualifier: 'SupplierQuickViewPOC_FieldGroup_1',
      type: #FIELDGROUP_REFERENCE,
      purpose: #QUICK_VIEW
    },
    {
      label: 'Main Contact Person',
      targetQualifier: 'KeyAccount',
      type: #CONTACT_REFERENCE,
      purpose: #QUICK_VIEW
    },
    {
      label: 'DataPoint in QV',
      targetQualifier: 'Product',
      type: #DATAPOINT_REFERENCE,
      purpose: #QUICK_VIEW
    }
  ]
  supplier;
}
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
Annotate STTA_PROD_MAN.STTA_C_MP_SupplierType with
@(
    UI.QuickViewFacets : [
        {
            $Type : 'UI.ReferenceFacet',
            Target : '@UI.FieldGroup#SupplierQuickViewPOC_FieldGroup_1'
        },
        {
            $Type : 'UI.ReferenceFacet',
            Label : 'Main Contact Person',
            Target : '@Communication.Contact#KeyAccount'
        },
        {
            $Type : 'UI.ReferenceFacet',
            Label : 'DataPoint in QV',
            Target : '@UI.DataPoint#Product'
        }
    ]
);
```

**STEP**: 6 — Configure Footer Navigation (actions & links)
**DESCRIPTION**: Define semantic navigation and prioritize actions shown in the Quick View footer. Add sap-tag parameters to control display priority.
**LANGUAGE**: Text
**CODE**:
```text
- To enable navigation from a Quick View facet:
  - Define a SemanticObject for:
    - the source property (if ReferentialConstraints exist), OR
    - the navigation property (if the target property is defined via an association).
- Footer shows the most important navigation targets; a "More Links" popover lists all available actions.
- To mark actions as shown by default in the footer, add the sap-tag parameter: superiorAction.
- If no superiorAction is defined, the first three actions are shown by default.
- Users can personalize footer actions using the More Links popover.
```

**STEP**: 7 — Runtime Restrictions and Notes
**DESCRIPTION**: Important behavioral restrictions and runtime scenarios to code for or test.
**LANGUAGE**: Text
**CODE**:
```text
- IFrame restriction:
  - When the application runs inside an i-frame:
    - Browser "Open link in new tab" for action/title links is not supported.
    - IntentBasedNavigation extension point processing is NOT executed in this scenario.
    - See API: sap.fe.core.controllerextensions.IntentBasedNavigation for details.

- Title link restriction (OData V4):
  - Title link cannot be opened in a new browser tab via "Open link in new tab"; navigation goes to Fiori Launchpad.

- No QuickView annotations / unresolved targets:
  - If no QuickView annotations exist and no target resolves at runtime (for example, user lacks access),
    - The field still appears as a link and pressing it displays an error/message in the Quick View.
- Testing:
  - Verify HeaderInfo and UI.QuickViewFacets values in the annotation provider.
  - Test navigation actions and More Links behavior across runtime contexts (standalone, FLP, i-frame).
```

--------------------------------

**TITLE**: Configuring the Delete Dialog for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: This guide shows how to control the text shown in delete confirmation dialogs by configuring UI.HeaderInfo annotations (OData V2) and by overriding i18n keys (OData V4). It documents runtime differences between fullscreen and flexible column layout (FCL) modes and provides ready-to-use XML, ABAP CDS, and i18n examples to update in your app.

**TAGS**: fiori-elements, delete-dialog, UI.HeaderInfo, annotations, i18n, ODataV2, ODataV4, FCL

**STEP**: Behavior summary — what changes the delete dialog text

**DESCRIPTION**: Quick reference of how the delete dialog text is determined so you can select the correct approach (annotation vs i18n key) and where to apply changes.

**LANGUAGE**: Text

**CODE**:
```
OData V2:
- Fullscreen mode (List Report / Object Page / Subobject Page header):
  * If UI.HeaderInfo.Title and UI.HeaderInfo.Description are both defined -> Delete dialog shows the Title only.
  * If neither Title nor Description are defined -> Generic default delete confirmation is shown.
- Flexible Column Layout (FCL) mode (tables in list report, object page, subobject page):
  * Both Title and Description defined -> Delete dialog shows both Title and Description.
  * Only Title defined -> Shows Title only.
  * Neither defined -> Generic default delete confirmation is shown.

OData V4:
- Delete from List Report: UI.HeaderInfo is NOT considered -> use i18n key:
  C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR
- Delete from Object Page (header): UI.HeaderInfo.Title and UI.HeaderInfo.Description are considered -> use i18n key:
  C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO
- Delete from tables in Object/Subobject pages: use i18n key:
  C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR

Note: If you override an application-specific single-entry delete message, review UI.HeaderInfo configuration and i18n keys accordingly.
```

**STEP**: Define UI.HeaderInfo in OData V2 annotations (XML)

**DESCRIPTION**: Add or update the UI.HeaderInfo annotation on the entity set bound to the table so the delete dialog can use the Title and Description values. Use Path for dynamic fields (entity properties) or String for constant text.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Place in your annotation file and attach to the relevant EntitySet/EntityType -->
<Annotation Term="UI.HeaderInfo"> 
  <Record> 
    <!-- Type names (optional) -->
    <PropertyValue Property="TypeName" String="Sales Order" /> 
    <PropertyValue Property="TypeNamePlural" String="Sales Orders" /> 

    <!-- Title: use Path to show entity property in delete dialog -->
    <PropertyValue Property="Title"> 
      <Record Type="UI.DataField"> 
        <PropertyValue Property="Value" Path="so_id" /> 
      </Record> 
    </PropertyValue> 

    <!-- Description: constant or another property -->
    <PropertyValue Property="Description"> 
      <Record Type="UI.DataField"> 
        <PropertyValue Property="Value" String="Sales Order" /> 
      </Record>   
    </PropertyValue> 
  </Record> 
</Annotation>
```

**STEP**: Define UI.HeaderInfo in ABAP CDS (OData V2 or V4 models created via CDS)

**DESCRIPTION**: In a CDS view, annotate the view with @UI.headerInfo to provide Title and Description values. Set typeName/typeNamePlural and use value/type appropriately.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.headerInfo: {
  typeName: 'Sales Order',
  typeNamePlural: 'Sales Orders',
  title: {
    value: 'SO_ID',        // CDS field name or symbolic reference
    type: #STANDARD
  },
  description: {
    type: #STANDARD       // set as appropriate; include a value if constant
  }
}
annotate view SALESORDERMANAGE with {
  // additional annotations...
}
```

**STEP**: Override delete dialog text via i18n (OData V4 and generic overrides)

**DESCRIPTION**: To change the delete confirmation text at runtime, override the specific i18n keys in your app's i18n properties file (webapp/i18n/i18n.properties). Use the keys documented below for common delete scenarios in OData V4.

**LANGUAGE**: Properties

**CODE**:
```
# webapp/i18n/i18n.properties
# Delete from List Report (does not use UI.HeaderInfo in OData V4)
C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR=Are you sure you want to delete {0}?

# Delete from Object Page header (uses UI.HeaderInfo.Title and Description in OData V4)
C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO=Are you sure you want to delete {0} ({1})?

# Delete from tables in Object/Subobject pages (uses object title)
C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR=Are you sure you want to delete {0}?
```

**STEP**: Where to apply changes and verification

**DESCRIPTION**: Apply annotations to the entity set or CDS view used by the table. Put i18n changes in webapp/i18n/i18n.properties. Verify in both fullscreen and FCL modes to confirm behavior differences (V2 vs V4).

**LANGUAGE**: Text

**CODE**:
```
- Annotation file placement:
  * Annotations XML: annotations/<your_annotations>.xml or project annotation file attached to the service metadata.
  * CDS: annotate the CDS view that exposes the entity (in ABAP repo).

- i18n file placement:
  * webapp/i18n/i18n.properties (adjust for language variants e.g. i18n_de.properties)

- Verification steps:
  1. Start the app and navigate to the List Report and Object Page.
  2. In Fullscreen and FCL modes, delete a single item from:
     - List report table
     - Object page header
     - Object/subobject page table
  3. Confirm displayed delete dialog text matches configured UI.HeaderInfo and/or overridden i18n key.

- Note:
  * OData V2: Behavior differs between Fullscreen and FCL (see summary).
  * OData V4: Use the exact i18n keys listed above for consistent override.
```

--------------------------------

**TITLE**: Configure Delete Dialog Text and Context in List Reports (Fiori Elements)

**INTRODUCTION**: This guide shows how to (1) provide the contextual text shown in the Delete confirmation dialog by mapping the entity title via annotations, and (2) override the i18n keys used by the dialog for OData V2 and OData V4 (custom i18n file). Use these steps to control the displayed object identifier and the full localized message.

**TAGS**: fiori-elements-framework, OData V2, OData V4, i18n, annotations, UI.HeaderInfo, ABAP CDS, localization

**STEP**: 1 — Map Title shown in Delete Dialog (OData V2 annotation XML)

**DESCRIPTION**: The Delete dialog displays the context value taken from the UI.HeaderInfo Title. Add or update the UI.HeaderInfo annotation in your metadata (annotation XML) to map the Title to the property that should appear in the dialog (example: so_id). The dialog will use the value of that property for the object reference.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Add or update UI.HeaderInfo in your annotation XML (OData V2) -->
<Annotation Term="UI.HeaderInfo">
  <Record>
    <PropertyValue Property="TypeName" String="Sales Order"/>
    <PropertyValue Property="TypeNamePlural" String="Sales Orders"/>
    <PropertyValue Property="Title">
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="so_id"/>
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 2 — Map Title shown in Delete Dialog (ABAP CDS annotation)

**DESCRIPTION**: If you use ABAP CDS views, annotate the view with @UI.headerInfo so the Title value is provided to the List Report. The Delete dialog will use the Title value as the context string shown in the confirmation.

**LANGUAGE**: CDS

**CODE**:
```abap
@UI.headerInfo: {
  typeName: 'Sales Order',
  typeNamePlural: 'Sales Orders',
  title: {
    value: 'SO_ID',
    type: #STANDARD
  }
}
annotate view STTA_C_MP_PRODUCT with {
  // additional annotations if required
}
```

**STEP**: 3 — Override Delete Dialog Text (OData V2 — i18n key ST_GENERIC_DELETE_SELECTED)

**DESCRIPTION**: For OData V2 List Reports you can change the default Delete dialog message by adding or overriding the i18n key ST_GENERIC_DELETE_SELECTED in your app’s i18n properties file. Use a placeholder {0} where the Title/context value (mapped above) will be injected.

Place this file at: webapp/i18n/i18n.properties (or the equivalent path in your project).

**LANGUAGE**: Properties

**CODE**:
```properties
# webapp/i18n/i18n.properties
# Example: show the Title (first placeholder) in the message
ST_GENERIC_DELETE_SELECTED=Delete {0}?
```

**STEP**: 4 — Override Delete Dialog Text Keys (OData V4 — C_TRANSACTION_HELPER_CONFIRM_DELETE*)

**DESCRIPTION**: For OData V4 List Reports the framework uses keys that start with C_TRANSACTION_HELPER_CONFIRM_DELETE in the i18n file. Override those keys in your custom i18n properties file (webapp/i18n/i18n.properties). Use {0} as the placeholder for the Title/context value.

Provide one or more overrides depending on which exact keys your app/framework version uses (examples below).

**LANGUAGE**: Properties

**CODE**:
```properties
# webapp/i18n/i18n.properties
# Example overrides for OData V4 confirmation dialog keys
C_TRANSACTION_HELPER_CONFIRM_DELETE=Delete {0}?
C_TRANSACTION_HELPER_CONFIRM_DELETE_TITLE=Delete {0}?
# Add additional C_TRANSACTION_HELPER_CONFIRM_DELETE* keys as required by your Fiori Elements version
```

**STEP**: 5 — Behavior Notes and References

**DESCRIPTION**: Implementation notes:
- The placeholder {0} in the i18n message is replaced at runtime by the Title property value mapped in the UI.HeaderInfo (XML) or @UI.headerInfo (CDS).
- Ensure the Title mapping points to the property that uniquely identifies the record (e.g., so_id).
- For OData V4 check which C_TRANSACTION_HELPER_CONFIRM_DELETE* keys are present in your framework version and override them in your custom i18n file.
- For more about localization or exact key names, see the Localization of UI Texts documentation (localization-of-ui-texts-b8cb649.md) and Fiori Elements documentation on adapting delete dialog texts.

**LANGUAGE**: Text

**CODE**:
```text
Related docs:
- Adapting Texts in the Delete Dialog Using Extensions (List Report)
- Adapting Texts for Confirmation Dialog Box When Deleting Lines in a Table
- Configuring the Delete Dialog
- Localization of UI Texts: localization-of-ui-texts-b8cb649.md
```
--------------------------------

**TITLE**: Configuring the Dynamic Link List Card (sap.ovp.cards.linklist)

**INTRODUCTION**: Step-by-step, code-first reference to configure the Dynamic Link List Card (link list / carousel) in SAP Fiori Elements. Includes manifest settings, UI.HeaderInfo mappings (XML, ABAP CDS, CAP CDS), contact annotation for quick view, and navigation configuration options with sample annotation fragments.

**TAGS**: fiori-elements-framework, dynamic-link-list-card, linklist, manifest, annotations, UI.HeaderInfo, Communication.Contact, navigation

**STEP**: 1 — Configure the card in manifest.json

**DESCRIPTION**: Add a card entry in your application's manifest.json to declare the link list card, set title, list flavor (standard or carousel), entitySet, sorting, header annotation path and default span.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (fragment)
"card017": {
  "model": "salesOrder",
  "template": "sap.ovp.cards.linklist",
  "settings": {
    "title": "Standard Dynamic Linklist Card",
    "targetUri": "https://en.abc.org/wiki/xyz _2",
    "subTitle": "Smartlink Feature Test",
    "listFlavor": "standard",
    "entitySet": "ProductSet",
    "sortBy": "Name",
    "sortOrder": "ascending",
    "headerAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#header1",
    "defaultSpan": {
      "rows": 20,
      "cols": 2
    }
  }
}
```

**STEP**: 2 — Map list title, subtitle and list image/icon via UI.HeaderInfo

**DESCRIPTION**: Configure UI.HeaderInfo annotation (qualifier referenced by headerAnnotationPath) to supply:
- Title: display text (Title -> DataField -> Value Path)
- Description (subtitle): DataField -> Value Path
- TypeImageUrl / ImageUrl: image or icon used by list items or carousel

Provide the same mapping in XML, ABAP CDS and CAP CDS formats.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- UI.HeaderInfo (XML) -->
<Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo" Qualifier="header1">
  <Record Type="com.sap.vocabularies.UI.v1.HeaderInfoType">
    <PropertyValue Property="TypeName" String="Product" />
    <PropertyValue Property="TypeNamePlural" String="Products" />
    <PropertyValue Property="Title">
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Label" String="Product Name" />
        <PropertyValue Property="Value" Path="Name" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="Description">
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Label" String="Product Description" />
        <PropertyValue Property="Value" Path="Description" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="TypeImageUrl" Path="ImageUrl" />
  </Record>
</Annotation>
```

**LANGUAGE**: ABAP

**CODE**:
```abap
/* UI.HeaderInfo (ABAP CDS) */
@UI.headerInfo: {
  typeName: 'Product',
  typeNamePlural: 'Products',
  title: {
    label: 'Product Name',
    value: 'NAME',
    type: #STANDARD
  },
  description: {
    label: 'Product Description',
    value: 'DESCRIPTION',
    type: #STANDARD
  }
}
annotate view VIEWNAME with { 
  /* add TypeImageUrl mapping as needed, e.g. @UI: { typeImageUrl: 'IMAGEURL' } */
}
```

**LANGUAGE**: CDS

**CODE**:
```cds
// UI.HeaderInfo (CAP CDS)
UI.HeaderInfo #header1 : {
    $Type : 'UI.HeaderInfoType',
    TypeName : 'Product',
    TypeNamePlural : 'Products',
    Title : {
        $Type : 'UI.DataField',
        Label : 'Product Name',
        Value : Name
    },
    Description : {
        $Type : 'UI.DataField',
        Label : 'Product Description',
        Value : Description
    },
    TypeImageUrl : ImageUrl
},
```

**STEP**: 3 — Configure Communication.Contact for quick view (contact popover)

**DESCRIPTION**: Add a communication contact annotation so the card can display a contact popover (quick view). The card evaluates: fn (full name), photo, role, tel (phone/mobile based on types), email (work/pref types shown as E-Mail). Provide XML, ABAP CDS and CAP CDS variants.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Communication.Contact (XML) -->
<Annotation Term="com.sap.vocabularies.Communication.v1.Contact">
  <Record>
    <PropertyValue Property="fn" Path="FullName" />
    <PropertyValue Property="title" Path="Title" />
    <PropertyValue Property="org" Path="CompanyName" />
    <PropertyValue Property="role" Path="OrganizationRole" />
    <PropertyValue Property="tel">
      <Collection>
        <Record>
          <PropertyValue Property="type"
             EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/fax" />
          <PropertyValue Property="uri" Path="FaxNumber" />
        </Record>
        <Record>
          <PropertyValue Property="type"
             EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/work com.sap.vocabularies.Communication.v1.PhoneType/preferred" />
          <PropertyValue Property="uri" Path="PhoneNumber" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="email">
      <Collection>
        <Record>
          <PropertyValue Property="type"
             EnumMember="com.sap.vocabularies.Communication.v1.ContactInformationType/preferred com.sap.vocabularies.Communication.v1.ContactInformationType/work" />
          <PropertyValue Property="address" Path="EmailAddress" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**LANGUAGE**: ABAP

**CODE**:
```abap
/* Communication.Contact (ABAP CDS - sample fields and semantics) */
define view VIEWNAME
{
  @Semantics.name.fullName: true
  FullName,

  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK, #PREF]
  EmailAddress,

  @Semantics.telephone.type:  [ #FAX ] 
  FaxNumber,

  @Semantics.telephone.type:  [ #PREF , #WORK]
  PhoneNumber,

  @Semantics.name: { jobTitle: true }   
  Title,

  @Semantics.organization: { name: true }
  CompanyName,

  @Semantics.organization: { role: true, unit: true }
  OrganizationRole
}
```

**LANGUAGE**: CDS

**CODE**:
```cds
// Communication.Contact (CAP CDS)
Communication.Contact : {
    fn : FullName,
    title : Title,
    org : CompanyName,
    role : OrganizationRole,
    tel : [
        {
            type : #fax,
            uri : FaxNumber
        },
        {
            type : [ #work, #pref ],
            uri : PhoneNumber
        }
    ],
    email : [
        {
            type : [ #pref, #work ],
            address : EmailAddress
        }
    ]
}
```

**STEP**: 4 — Configure navigation types and behavior

**DESCRIPTION**: The link list card supports three navigation methods. Configure annotations to enable navigation from a list item and to allow quick view behavior.

- Intent-based navigation (semantic navigation): use UI.Identification with SemanticObject and Action.
- Function import / action invocation: use LineItem DataFieldForAction (Action).
- External URL navigation: use LineItem entry with Url (WITH_URL) that points to an entity field.

Below are minimal XML fragments showing how to enable each option. The card will use these annotations to provide navigation from line items. When a contact annotation is present together with navigation annotations, clicking the title also shows quick view (popover).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Intent-based navigation: UI.Identification -->
<Annotation Term="com.sap.vocabularies.UI.v1.Identification">
  <Record>
    <PropertyValue Property="SemanticObject" String="Product" />
    <PropertyValue Property="Action" String="display" />
  </Record>
</Annotation>

<!-- LineItem with action (DataFieldForAction) -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
      <PropertyValue Property="Label" String="Open Product" />
      <PropertyValue Property="Action" String="ActionName" />
    </Record>
  </Collection>
</Annotation>

<!-- LineItem with URL (external navigation) -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldWithUrl">
      <PropertyValue Property="Label" String="Open External" />
      <PropertyValue Property="Url" Path="ExternalUrlField" />
    </Record>
  </Collection>
</Annotation>
```

**STEP**: 5 — Navigation behavior summary (apply to card UX)

**DESCRIPTION**: Short, actionable mapping of annotation configurations to card behavior:

**LANGUAGE**: JSON

**CODE**:
```json
{
  "BehaviorRules": [
    {
      "Annotations": [
        "UI.Identification with Action",
        "com.sap.vocabularies.UI.v1.LineItem with Action",
        "com.sap.vocabularies.UI.v1.LineItem with Url"
      ],
      "Result": "Navigation available from the line item"
    },
    {
      "Annotations": [
        "Any of the above navigation annotations",
        "Default contact annotation present"
      ],
      "Result": "Navigation from line item AND quick view info available when clicking the title"
    },
    {
      "Annotations": [
        "Only default contact annotation"
      ],
      "Result": "Quick view information available when clicking the title"
    },
    {
      "Annotations": [
        "No navigation-based annotation and no contact annotation"
      ],
      "Result": "Only labels are displayed (no navigation / quick view)"
    }
  ]
}
```


--------------------------------

**TITLE**: Configuring the Global Filter for SAP Fiori OVP (manifest.json + annotations + custom date-range)

**INTRODUCTION**: This document provides minimal, copy-paste-ready manifest.json and annotation snippets and a reusable JS skeleton for configuring the global filter (SmartFilterBar) in SAP Fiori OVP apps. Covers: selecting the OData model/entity set for the global filter, enabling basic search, configuring semantic date ranges (dateSettings), and using UI.SelectionFields in OData annotations. Notes on deprecated properties and precedence rules are included.

**TAGS**: sap.ovp, global filter, SmartFilterBar, manifest.json, annotations, UI.SelectionFields, dateSettings, semantic date range, SAPUI5

STEP: 1 — Configure global filter model and entity set

DESCRIPTION: Set the OData model used for the global filter and the entity set that defines filterable properties. Use globalFilterEntitySet (SAPUI5 >= 1.54). globalFilterEntityType is deprecated (SAPUI5 < 1.54 compatibility only). Place these properties in the sap.ovp section of manifest.json.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "_version": "1.1.0",
    "globalFilterModel": "ZCD204_EPM_DEMO_SRV",
    "globalFilterEntityType": "SalesOrder",      /* deprecated since SAPUI5 1.54; kept only for older runtimes */
    "globalFilterEntitySet": "SalesOrders",      /* use this from SAPUI5 1.54 onwards */
    "cards": {
      /* card definitions */
    }
  }
}
```

STEP: 2 — Enable basic (global) search on the SmartFilterBar

DESCRIPTION: Enable the SmartFilterBar search field by setting showBasicSearch to true in sap.ovp. Ensure the target entity type properties support search in metadata (sap:searchable="true") and the entity set defines SearchRestrictions annotations. The search field will then search across searchable fields defined for the global filter entity set.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "showBasicSearch": true,
    "globalFilterModel": "ZCD204_EPM_DEMO_SRV",
    "globalFilterEntitySet": "SalesOrders"
  }
}
```

STEP: 3 — Configure semantic date ranges (dateSettings) for the SmartFilterBar

DESCRIPTION: Use sap.ovp.filterSettings.dateSettings to configure available semantic date ranges (preset ranges) globally and per-property. The dateSettings object supports:
- selectedValues: comma-separated standard date range tokens to include/exclude
- exclude (boolean): default true (means selectedValues are excluded)
- customDateRangeImplementation: a JS module reference (string) that implements custom range logic — this takes precedence over selectedValues/exclude
- useDateRange and useDateRangeType: precedence rules (see notes)

Important precedence rules:
- dateSettings.useDateRange (if present) takes precedence.
- If dateSettings.useDateRange is not defined and sap.ovp.useDateRangeType is defined, the latter is used.
- If both are defined, the app will stop loading and report an error.
- If useDateRange is false, other dateSettings entries are still considered when configuring date filters.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "filterSettings": {
      "dateSettings": {
        "selectedValues": "DAYS,WEEK,MONTH,DATERANGE,QUARTER,YEAR",
        "fields": {
          "DateProperty1": {
            "selectedValues": "TOMORROW,NEXT,LASTYEAR,LAST2WEEKS,LAST3WEEKS,LAST4WEEKS,LAST5WEEKS,YEARTODATE,QUARTER1,QUARTER2,QUARTER3,QUARTER4",
            "exclude": true
          },
          "DateProperty2": {
            "customDateRangeImplementation": "my.app.ext.controller.customDateRangeType",
            "selectedValues": "FROM,TO,DAYS,WEEK,MONTH,DATERANGE,TODAY,TOMORROW,YEAR,YESTERDAY",
            "exclude": true
          },
          "DateProperty3": {
            "selectedValues": "YESTERDAY",
            "exclude": false
          }
        }
      }
    }
  }
}
```

STEP: 4 — Example: UI.SelectionFields annotation to set default filter fields

DESCRIPTION: Define default filter fields for the SmartFilterBar via OData annotations (UI.SelectionFields). Place these annotations in your annotation file (e.g., annotations.xml) or service-specific annotation file referenced in manifest.json.

LANGUAGE: XML

CODE:
```xml
<Annotations Target="YourService.SalesOrders">
  <Annotation Term="UI.SelectionFields">
    <Collection>
      <PropertyPath>SalesOrderID</PropertyPath>
      <PropertyPath>CustomerName</PropertyPath>
      <PropertyPath>CreatedAt</PropertyPath>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: 5 — Custom date range implementation skeleton (JS module)

DESCRIPTION: When using customDateRangeImplementation (string reference in dateSettings), implement and export the module at the given path. The SmartFilterBar will call into your implementation to modify the date range list. The exact required API depends on the UI5 template/version; implement a module that returns functions to provide or transform date-range entries. This skeleton provides a starting point — adapt method names and parameters to your runtime's expected API.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/ext/controller/customDateRangeType.js
// Module path referenced as "ext.controller.customDateRangeType" or "my.app.ext.controller.customDateRangeType"
// Adjust the define/namespace to match your project/module naming.

sap.ui.define([], function () {
  "use strict";

  return {
    /**
     * Return an array of custom date-range definitions or modify the existing list.
     * Implementation detail: adapt to the SmartFilterBar API expected by your SAPUI5 version.
     *
     * Example returned format (illustrative):
     * [
     *   { key: "LAST_30_DAYS", label: "Last 30 Days", type: "RANGE", fromDays: -30, toDays: 0 },
     *   ...
     * ]
     */
    getCustomDateRanges: function (/* filterField */) {
      // TODO: implement transformation / provide custom ranges
      return [
        { key: "LAST_30_DAYS", label: "Last 30 Days" }
      ];
    },

    /**
     * (Optional) Example hook to transform the default list provided by the framework.
     * @param {Array} defaultList
     * @returns {Array} transformedList
     */
    transformDateRangeList: function (defaultList) {
      // TODO: modify defaultList as needed (remove/add/rename entries)
      return defaultList;
    }
  };
});
```
--------------------------------

**TITLE**: Configure List Area (LineItem) with DataField, DataFieldForAnnotation, and Navigation

**INTRODUCTION**: Quick, code-focused reference for configuring the list area (LineItem) in Fiori elements using UI annotations. Includes XML, ABAP CDS, and CAP CDS examples for DataField entries, DataFieldForAnnotation (DataPoint and Contact), and navigation (intent-based and URL-based).

**TAGS**: fiori-elements-framework, annotations, LineItem, DataField, DataPoint, Contact, navigation, ABAP CDS, CAP CDS, XML

STEP: 1 — Define DataField entries for list text values

DESCRIPTION: Add DataField records to the LineItem annotation (qualifier optional) to display textual values in the list. Include Label and Value/Path. Use position/qualifier in CDS when needed.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem" Qualifier="View4">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Order ID" />
      <PropertyValue Property="Value" Path="SalesOrderID" />
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Customer" />
      <PropertyValue Property="Value" Path="ToBusinessPartner/EmailAddress" />
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Customer" />
      <PropertyValue Property="Value" Path="CustomerName" />
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
      <PropertyValue Property="Label" String="TaxAmount" />
      <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.DataPoint#TaxAmount" />
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.lineItem: [
  { label: 'Order ID', position: 10, qualifier: 'View4' }
]
SALESORDERID;

@UI.lineItem: [
  { label: 'Customer', value: '_BUSINESSPARTNER.EMAILADDRESS', position: 20, qualifier: 'View4' }
]
TOBUSINESSPARTNER/EMAILADDRESS;

@UI.lineItem: [
  { label: 'Customer', position: 30, qualifier: 'View4' }
]
CUSTOMERNAME;

@UI.lineItem: [
  { label: 'TaxAmount', valueQualifier: 'TaxAmount', type: #AS_DATAPOINT, position: 40, qualifier: 'View4' }
]
PROPERT_NAME;
```

LANGUAGE: CAP CDS

CODE:
```cds
UI.LineItem #View4 : [
  {
    $Type : 'UI.DataField',
    Label : 'Order ID',
    Value : SalesOrderID
  },
  {
    $Type : 'UI.DataField',
    Label : 'Customer',
    Value : ToBusinessPartner.EmailAddress
  },
  {
    $Type : 'UI.DataField',
    Label : 'Customer',
    Value : CustomerName
  },
  {
    $Type : 'UI.DataFieldForAnnotation',
    Label : 'TaxAmount',
    Target : '@UI.DataPoint#TaxAmount'
  }
]
```

STEP: 2 — Add DataFieldForAnnotation: DataPoint (numeric) and Contact (quick view)

DESCRIPTION: Use DataFieldForAnnotation + referenced annotations to display numeric DataPoints and contact quick views inside the list. Define the annotation (DataPoint or Communication.Contact) with the qualifier used in the DataFieldForAnnotation Target.

LANGUAGE: XML (DataPoint)

CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="TaxAmount">
  <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
    <PropertyValue Property="Title" String="TaxAmount" />
    <PropertyValue Property="Value" Path="TaxAmount" />
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS (DataPoint)

CODE:
```abap
@UI.dataPoint: {
  title: 'TaxAmount'
}
TaxAmount;
```

LANGUAGE: CAP CDS (DataPoint)

CODE:
```cds
UI.DataPoint #TaxAmount : {
  $Type : 'UI.DataPointType',
  Title : 'TaxAmount',
  Value : TaxAmount
}
```

LANGUAGE: XML (Contact)

CODE:
```xml
<Annotation Term="com.sap.vocabularies.Communication.v1.Contact">
  <Record>
    <PropertyValue Property="tel">
      <Collection>
        <Record>
          <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/fax" />
          <PropertyValue Property="uri" Path="FaxNumber" />
        </Record>
        <Record>
          <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/work com.sap.vocabularies.Communication.v1.PhoneType/preferred" />
          <PropertyValue Property="uri" Path="PhoneNumber" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="email">
      <Collection>
        <Record>
          <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.ContactInformationType/preferred com.sap.vocabularies.Communication.v1.ContactInformationType/work" />
          <PropertyValue Property="address" Path="EmailAddress" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS (Contact)

CODE:
```abap
define view VIEWNAME {
  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK]
  EmailAddress,

  @Semantics.telephone.type:  [ #FAX ]
  FaxNumber,

  @Semantics.telephone.type:  [ #WORK]
  PhoneNumber
}
```

LANGUAGE: CAP CDS (Contact)

CODE:
```cds
Communication.Contact : {
  tel : [
    { type : #fax, uri : FaxNumber },
    { type : [ #work, #pref ], uri : PhoneNumber }
  ],
  email : [
    { type : [ #pref, #work ], address : EmailAddress }
  ]
}
```

STEP: 3 — Configure navigation for list items (intent-based and URL)

DESCRIPTION: Use DataFieldForIntentBasedNavigation for intent-based navigation to Fiori apps (recommended). Use DataFieldWithUrl to open external apps/sites or specific routes not configured in target mapping. Include Label and either SemanticObject/Action or Url.

LANGUAGE: XML (Intent-based)

CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem" Qualifier="View4">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="Label" String="Open Order" />
      <PropertyValue Property="SemanticObject" String="SalesOrder" />
      <PropertyValue Property="Action" String="display" />
      <!-- Optionally pass context via Parameters -->
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: XML (URL-based)

CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem" Qualifier="View4">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldWithUrl">
      <PropertyValue Property="Label" String="Open Site" />
      <PropertyValue Property="Url" String="https://example.com/app?order={SalesOrderID}" />
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS (Intent-based)

CODE:
```abap
@UI.lineItem: [
  {
    label: 'Open Order',
    type: #FOR_INTENT_BASED_NAV,
    semanticObject: 'SalesOrder',
    action: 'display',
    qualifier: 'View4'
  }
]
SALESORDERID;
```

LANGUAGE: CAP CDS (Intent-based)

CODE:
```cds
UI.LineItem #View4 : [
  {
    $Type : 'UI.DataFieldForIntentBasedNavigation',
    Label : 'Open Order',
    SemanticObject : 'SalesOrder',
    Action : 'display'
  }
]
```

STEP: 4 — Notes and best practices (apply when coding)

DESCRIPTION: Implementation tips to use while writing/automating annotation updates:
- Prefer DataFieldForIntentBasedNavigation for navigation to registered Fiori targets (keeps overview page behavior consistent).
- Use DataFieldWithUrl only for external URLs or specific routes not in target mapping.
- Use qualifiers on LineItem and DataPoint to reference annotated DataPoint entries from DataFieldForAnnotation.
- Always include Label and explicit Value/Path in DataField entries for predictable rendering.

LANGUAGE: JSON

CODE:
```json
{
  "summary": "Use DataField for textual values; DataFieldForAnnotation -> DataPoint/Contact for numeric/contact quick view; DataFieldForIntentBasedNavigation for intent navigation; DataFieldWithUrl for direct URLs."
}
```
--------------------------------

**TITLE**: Configuring the List Card Header Area (sap.ovp list card)

**INTRODUCTION**: Reference and actionable code samples for configuring list card header properties in sap.ovp: title/subtitle, KPI values (KPI, PresentationVariant, SelectionVariant, DataPoint), view switch (tabs), header navigation note, and header counter (defaultCountMode). Use these snippets in manifest.json and annotation files (XML, ABAP CDS, CAP CDS).

**TAGS**: sap.ovp, list card, header, manifest.json, KPI, DataPoint, PresentationVariant, SelectionVariant, tabs, defaultCountMode, annotations

STEP: Configure Card Title and Subtitle

DESCRIPTION: Add title and subTitle for a list card in manifest.json under sap.ovp → cards → <cardId> → settings. Replace model, template, entitySet, and cardId as needed.

LANGUAGE: JSON

CODE:
```JSON
// manifest.json (sap.ovp card title/subtitle)
{
  "sap.ovp": {
    "cards": {
      "sap.ovp.test_card.card002": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.list",
        "settings": {
          "title": "Purchase History",
          "subTitle": "SubTitle",
          "entitySet": "SalesOrderSet"
          // other settings...
        }
      }
    }
  }
}
```

STEP: Reference KPI Annotation in Manifest

DESCRIPTION: Point the card to a KPI annotation using kpiAnnotationPath in sap.ovp. Use the fully qualified annotation path including qualifier.

LANGUAGE: JSON

CODE:
```JSON
// manifest.json (sap.ovp KPI reference)
{
  "sap.ovp": {
    // ...
    "kpiAnnotationPath": "com.sap.vocabularies.UI.v1.KPI#AllActualCosts"
    // ...
  }
}
```

STEP: KPI Annotation (XML)

DESCRIPTION: Define a KPI annotation in XML with Qualifier AllActualCosts. Include Detail, SelectionVariant, DataPoint, and ID properties. This annotation is referenced by the manifest kpiAnnotationPath.

LANGUAGE: XML

CODE:
```XML
<!-- KPI annotation (XML) -->
<Annotation Term="UI.KPI" Qualifier="AllActualCosts">
  <Record Type="UI.KPIType">
    <PropertyValue Property="Detail">
      <Record Type="UI.KPIDetailType">
        <PropertyValue Property="DefaultPresentationVariant" Path="@UI.PresentationVariant#Eval_by_Currency1" />
        <PropertyValue Property="AlternativePresentationVariants">
          <Collection>
            <Path>@UI.PresentationVariant#Eval_by_Currency_Column</Path>
          </Collection>
        </PropertyValue>
        <PropertyValue Property="SemanticObject" String="Action" />
        <PropertyValue Property="Action" String="toappnavsample" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#Eval_by_Currency_1" />
    <PropertyValue Property="DataPoint" Path="@UI.DataPoint#Eval_by_Country_Generic" />
    <PropertyValue Property="ID" String="String for KPI Annotation" />
  </Record>
</Annotation>
```

STEP: KPI Annotation (ABAP CDS)

DESCRIPTION: Equivalent KPI annotation in ABAP CDS. Use qualifier AllActualCosts and reference presentation/selection/dataPoint qualifiers.

LANGUAGE: ABAP CDS

CODE:
```ABAP CDS
@UI.KPI: [
  {
    detail: {
      defaultPresentationVariantQualifier: 'Eval_by_Currency1',
      alternativePresentationVariantQualifiers: [
        'Eval_by_Currency_Column'
      ],
      semanticObject: 'Action',
      semanticObjectAction: 'toappnavsample'
    },
    selectionVariantQualifier: 'Eval_by_Currency_1',
    id: 'String for KPI Annotation',
    qualifier: 'AllActualCosts'
  }
]
Eval_by_Country-Generic;
```

STEP: KPI Annotation (CAP CDS)

DESCRIPTION: CAP CDS KPI definition referencing presentation/selection/dataPoint annotations. Use qualifier AllActualCosts.

LANGUAGE: CAP CDS

CODE:
```CAP CDS
UI.KPI #AllActualCosts : {
    $Type : 'UI.KPIType',
    Detail : {
        $Type : 'UI.KPIDetailType',
        DefaultPresentationVariant : ![@UI.PresentationVariant#Eval_by_Currency1],
        AlternativePresentationVariants : [
            ![@UI.PresentationVariant#Eval_by_Currency_Column]
        ],
        SemanticObject : 'Action',
        Action : 'toappnavsample'
    },
    SelectionVariant : ![@UI.SelectionVariant#Eval_by_Currency_1],
    DataPoint : ![@UI.DataPoint#Eval_by_Country-Generic],
    ID : 'String for KPI Annotation'
},
```

STEP: Presentation Variant Annotation (XML)

DESCRIPTION: Define presentation rules (MaxItems, GroupBy, SortOrder, Visualizations) used by the KPI Detail DefaultPresentationVariant qualifier Eval_by_Currency1.

LANGUAGE: XML

CODE:
```XML
<!-- PresentationVariant (XML) qualifier Eval_by_Currency1 -->
<Annotation Term="UI.PresentationVariant" Qualifier="Eval_by_Currency1">
  <Record>
    <PropertyValue Property="MaxItems" Int="5" />
    <PropertyValue Property="GroupBy">
      <Collection>
        <PropertyPath>Country</PropertyPath>
        <PropertyPath>Currency</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record>
          <PropertyValue Property="Property" PropertyPath="TotalSales" />
          <PropertyValue Property="Descending" Bool="true" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
        <AnnotationPath>@UI.Chart#Eval_by_Currency_Donut</AnnotationPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: Presentation Variant Annotation (ABAP CDS)

DESCRIPTION: Equivalent presentation variant in ABAP CDS using qualifier Eval_by_Currency1.

LANGUAGE: ABAP CDS

CODE:
```ABAP CDS
@UI.PresentationVariant: [
  {
    maxItems: 5,
    groupBy: [
      'COUNTRY',
      'CURRENCY'
    ],
    sortOrder: [
      {
        by: 'TOTALSALES'
      }
    ],
    visualizations: [
      {
        type: #AS_CHART,
        qualifier: 'Eval_by_Currency_Donut'
      }
    ],
    qualifier: 'Eval_by_Currency1'
  }
]
annotate view VIEWNAME with { }
```

STEP: Presentation Variant Annotation (CAP CDS)

DESCRIPTION: CAP CDS presentation variant (Eval_by_Currency1) equivalent.

LANGUAGE: CAP CDS

CODE:
```CAP CDS
UI.PresentationVariant #Eval_by_Currency1 : {
    MaxItems : 5,
    GroupBy : [
        Country,
        Currency
    ],
    SortOrder : [
        {
            Property : TotalSales,
            Descending : true
        }
    ],
    Visualizations : [
        '@UI.Chart#Eval_by_Currency_Donut'
    ]
},
```

STEP: Selection Variant Annotation (XML)

DESCRIPTION: Define selection filters and parameters for qualifier Eval_by_Currency_1 referenced by KPI Detail SelectionVariant.

LANGUAGE: XML

CODE:
```XML
<!-- SelectionVariant (XML) qualifier Eval_by_Currency_1 -->
<Annotation Term="UI.SelectionVariant" Qualifier="Eval_by_Currency_1">
  <Record>
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record>
          <PropertyValue Property="PropertyName" PropertyPath="Country" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record>
                <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                <PropertyValue Property="Low" String="IN" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Parameters">
      <Collection>
        <Record Type="UI.Parameter">
          <PropertyValue Property="PropertyName" PropertyPath="Currency_Target" />
          <PropertyValue Property="PropertyValue" String="EUR" />
        </Record>
        <Record Type="UI.Parameter">
          <PropertyValue Property="PropertyName" PropertyPath="UoM_Target" />
          <PropertyValue Property="PropertyValue" String="KGM" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: Selection Variant Annotation (ABAP CDS)

DESCRIPTION: ABAP CDS selection variant for qualifier Eval_by_Currency_1.

LANGUAGE: ABAP CDS

CODE:
```ABAP CDS
@UI.SelectionVariant: [
  {
    qualifier: 'Eval_by_Currency_1',
    parameters: [
      { name: 'PropertyName', value: 'CompanyCurrency' },
      { name: 'PropertyValue', value: 'EUR'}
    ]
  }
]
annotate view VIEWNAME with { }
```

STEP: Selection Variant Annotation (CAP CDS)

DESCRIPTION: CAP CDS selection variant equivalent.

LANGUAGE: CAP CDS

CODE:
```CAP CDS
UI.SelectionVariant #Eval_by_Currency_1 : {
    SelectOptions : [
        {
            PropertyName : Country,
            Ranges : [
                {
                    Sign : #I,
                    Option : #EQ,
                    Low : 'IN'
                }
            ]
        }
    ],
    Parameters : [
        {
            $Type : 'UI.Parameter',
            PropertyName : Currency_Target,
            PropertyValue : 'EUR'
        },
        {
            $Type : 'UI.Parameter',
            PropertyName : UoM_Target,
            PropertyValue : 'KGM'
        }
    ]
},
```

STEP: DataPoint Annotation — properties and criticality rules

DESCRIPTION: Define UI.DataPoint annotation to display KPI header values. Mandatory/commonly used properties:
- Title: displayed as KPI title on header
- Value: path or expression for KPI measure
- ValueFormat: number format (ScaleFactor, NumberOfFractionalDigits)
- Criticality: highlight color — can be enum or path returning numeric code
  - Enum values:
    - com.sap.vocabularies.UI.v1.CriticalityType/Neutral (default neutral)
    - com.sap.vocabularies.UI.v1.CriticalityType/Negative (Red)
    - com.sap.vocabularies.UI.v1.CriticalityType/Critical (Orange)
    - com.sap.vocabularies.UI.v1.CriticalityType/Positive (Green)
  - Path-based numeric values (0..3):
    - 0 = Neutral (default)
    - 1 = Negative (Red)
    - 2 = Critical (Orange)
    - 3 = Positive (Green)
Include optional CriticalityCalculation, TargetValue, TrendCalculation as needed.

LANGUAGE: XML

CODE:
```XML
<!-- DataPoint annotation (XML) Qualifier Eval_by_Country_Generic -->
<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Country_Generic">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Sales India - Generic Card" />
    <PropertyValue Property="Value" Path="Sales" />
    <PropertyValue Property="ValueFormat">
      <Record>
        <PropertyValue Property="ScaleFactor" Decimal="2" />
        <PropertyValue Property="NumberOfFractionalDigits" Int="1" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="CriticalityCalculation">
      <Record>
        <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Minimize" />
        <PropertyValue Property="DeviationRangeHighValue" String="7300" />
        <PropertyValue Property="ToleranceRangeHighValue" String="7200" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="TargetValue" String="2.000 " />
    <PropertyValue Property="TrendCalculation">
      <Record>
        <PropertyValue Property="ReferenceValue" String="5201680" />
        <PropertyValue Property="DownDifference" Decimal="10000000.0" />
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: DataPoint Annotation (ABAP CDS)

DESCRIPTION: ABAP CDS dataPoint example matching the XML DataPoint above.

LANGUAGE: ABAP CDS

CODE:
```ABAP CDS
@UI.dataPoint: { 
  title: 'Sales India - Generic Card',
  valueFormat: { scaleFactor: 2, numberOfFractionalDigits: 1 },
  criticalityCalculation: { 
    improvementDirection: #MINIMIZE,
    deviationRangeHighValue: 7300,
    toleranceRangeHighValue: 7200
  },
  targetValue: 2.000,
  trendCalculation: { referenceValue: 'refValElement', downDifference: 10000000.0 }
}
Sales;
```

STEP: DataPoint Annotation (CAP CDS)

DESCRIPTION: CAP CDS DataPoint equivalent.

LANGUAGE: CAP CDS

CODE:
```CAP CDS
UI.DataPoint #Eval_by_Country-Generic : {
    $Type : 'UI.DataPointType',
    Title : 'Sales India - Generic Card',
    Value : Sales,
    ValueFormat : {
        ScaleFactor : 2,
        NumberOfFractionalDigits : 1
    },
    CriticalityCalculation : {
        ImprovementDirection : #Minimizing,
        DeviationRangeHighValue : '7300',
        ToleranceRangeHighValue : '7200'
    },
    TargetValue : '2.000 ',
    TrendCalculation : {
        ReferenceValue : '5201680',
        DownDifference : 10000000.0
    }
},
```

STEP: Configure View Switch (tabs) per card

DESCRIPTION: Configure card-level view switch tabs in the manifest under sap.ovp → cards → <cardId> → settings → tabs. Each tab references annotation paths for lineItem/presentation/selection/identification/dataPoint and provides a display value or i18n key.

LANGUAGE: JSON

CODE:
```JSON
// manifest.json (sap.ovp card tabs)
{
  "sap.ovp": {
    "cards": {
      "card00": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.list",
        "settings": {
          "category": "Sales Orders With Analytical Header",
          "listFlavor": "bar",
          "listType": "extended",
          "entitySet": "SalesOrderSet",
          "tabs": [
            {
              "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
              "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
              "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line",
              "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
              "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
              "value": "{{dropdown_value1}}"
            },
            {
              "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View2",
              "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#customer",
              "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#SP2",
              "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#item2",
              "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
              "value": "{{dropdown_value2}}"
            }
          ]
        }
      }
    }
  }
}
```

STEP: List Header Navigation (identification vs LineItem precedence)

DESCRIPTION: Use identification annotation to configure navigation from header and content area. Note: when both are present, LineItem-level navigation configured in the LineItem annotation takes precedence over identification-based navigation for list area navigation.

LANGUAGE: JSON

CODE:
```JSON
// Note (no code change required): LineItem navigation takes precedence over Identification navigation for list area navigation.
{
  "note": "If LineItem navigation is configured, it takes precedence over Identification annotation navigation for list area navigation."
}
```

STEP: Configure Header Counter (defaultCountMode)

DESCRIPTION: Set defaultCountMode per card in manifest.json settings. Supported only in SAP Fiori elements for OData V2. Use values e.g., "None" or others per runtime.

LANGUAGE: JSON

CODE:
```JSON
// manifest.json (card header counter)
{
  "sap.ovp": {
    "cards": {
      "Card_Model_Name": {
        "settings": {
          "defaultCountMode": "None"
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Configuring manifest.json for the Analytical List Page (ALP) — Fiori Elements (OData V2 & V4)

**INTRODUCTION**: This document gives exact manifest.json snippets and actionable field descriptions to enable and configure the Analytical List Page (ALP) in SAP Fiori Elements for OData V2 and to configure the ALP "flavor" of a List Report in OData V4. Use the JSON snippets directly in your application's manifest.json. Keep KPIs, table settings and navigation entries aligned with your annotations and data sources.

**TAGS**: fiori-elements-framework, analytical-list-page, ALP, manifest.json, ODataV2, ODataV4, views, KeyPerformanceIndicators

**STEP**: 1 — Configure ALP in manifest.json (OData V2)

**DESCRIPTION**: Add a top-level entry under "sap.ui.generic.app" with a page whose component name is "sap.suite.ui.generic.template.AnalyticalListPage". Set the main entitySet, table settings, defaults, KPI definitions and any inner navigation pages. Place this snippet in the root manifest.json of your UI5 app.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.2.0",
    "settings": {
      "flexibleColumnLayout": {
        "defaultTwoColumnLayoutType": "TwoColumnsBeginExpanded"
      }
    },
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "tableSettings": {
              "type": "AnalyticalTable",
              "multiSelect": true,
              "selectAll": true,
              "selectionLimit": 20
            },
            "qualifier": "DefaultPresentationVariant",
            "condensedTableLayout": true,
            "smartVariantManagement": true,
            "defaultContentView": "charttable",
            "defaultFilterMode": "visual",
            "showGoButtonOnFilterBar": false,
            "contentTitle": "{{contentAreaTitle}}",
            "autoHide": false,
            "filterDefaultsFromSelectionVariant": false,
            "allFiltersAsInParameters": true,
            "keyPerformanceIndicators": {
              "KPIRevenue": {
                "model": "kpi",
                "entitySet": "SEPMRA_C_ALP_TotalSalesKPI",
                "qualifier": "KPIRevenue",
                "detailNavigation": "OverviewPage",
                "groupId": "mainKpiGroup"
              }
            }
          }
        },
        "pages": [
          {
            "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage"
            },
            "navigation": {
              "display": {
                "path": "sap.apps.crossNavigation.outbounds",
                "target": "NavigateToCTRItem"
              }
            }
          }
        ]
      }
    ]
  }
}
```

**STEP**: 2 — Annotated ALP manifest fragment for OData V2 (explain fields)

**DESCRIPTION**: Reference example with inline explanations (JSONC-style comments for readability). Use these comments as guidance when editing the valid JSON above. Do not leave comments in production JSON files.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.2.0",
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube", // main entity set for ALP content area (use result entity set for parameterized sets)
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage", // required
          "list": true,
          "settings": {
            "tableSettings": {
              "type": "AnalyticalTable",     // "AnalyticalTable" | "GridTable" | "ResponsiveTable"
              "multiSelect": true,           // true => range/multi selection (if actions exist)
              "selectAll": true,             // true => backend select-all with one batch call
              "selectionLimit": 20           // maximum rows selectable in a range (default 200 if omitted)
            },
            "qualifier": "DefaultPresentationVariant", // selection/presentation qualifier to look for in annotations
            "condensedTableLayout": true,              // false = compact style
            "smartVariantManagement": true,            // true = page level variant mgmt
            "defaultContentView": "charttable",        // "chart", "table", or "charttable"
            "defaultFilterMode": "visual",             // "visual" or "compact"
            "showGoButtonOnFilterBar": false,
            "contentTitle": "{{contentAreaTitle}}",    // match key in i18n.properties
            "autoHide": false,
            "filterDefaultsFromSelectionVariant": false,
            "allFiltersAsInParameters": true,
            "keyPerformanceIndicators": {
              "KPIRevenue": {
                "model": "kpi",                       // links to models section (must not be empty)
                "entitySet": "SEPMRA_C_ALP_TotalSalesKPI",
                "qualifier": "KPIRevenue",            // UI.KPI annotation qualifier
                "detailNavigation": "OverviewPage",   // outbound navigation key under crossNavigation.outbounds
                "groupId": "mainKpiGroup"             // KPIs with same groupId can be batched together
              }
            }
          }
        },
        "pages": [
          {
            "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage"
            },
            "navigation": {
              "display": {
                "path": "sap.apps.crossNavigation.outbounds",
                "target": "NavigateToCTRItem" // optional external navigation target
              }
            }
          }
        ]
      }
    ]
  }
}
```

**STEP**: 3 — Configure ALP as a List Report "flavor" (OData V4)

**DESCRIPTION**: For OData V4, ALP is a List Report flavor. Set the target template to "sap.fe.templates.ListReport" and add "views" configuration under the target's options.settings. Define primary and secondary annotation paths (UI.Chart, UI.PresentationVariant, UI.SelectionPresentationVariant for primary; UI.LineItem, UI.PresentationVariant, UI.SelectionPresentationVariant for secondary). Use "defaultPath" = "primary" | "secondary" | "both". IMPORTANT: If a specified primary or secondary annotationPath is not found, the app fails to load (no fallback). Prefer object-style paths (avoid arrays) when authoring the manifest to ensure compatibility.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "your.app.id"
  },
  "sap.ui5": {
    "routing": {
      "targets": {
        "BusinessPartnersList": {
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/BusinessPartners",
              "views": {
                "paths": {
                  "primary": {
                    "annotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#ProductSalesPV"
                  },
                  "secondary": {
                    "annotationPath": "com.sap.vocabularies.UI.v1.LineItem"
                  },
                  "defaultPath": "both"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

- Primary annotationPath accepted types: UI.Chart, UI.PresentationVariant, UI.SelectionPresentationVariant. If a PresentationVariant is used, Fiori elements picks the first chart; if that PV has no chart, it falls back to the default Ui.Chart (no qualifier). If no chart found, a blank chart is rendered.
- Secondary annotationPath accepted types: UI.LineItem, UI.PresentationVariant, UI.SelectionPresentationVariant. If a PV has no LineItem, Fiori elements checks the default UI.LineItem (no qualifier). If not found, a blank table is rendered.
- defaultPath values: "primary" => chart-only, "secondary" => table-only, "both" => hybrid (chart + table).

**RELATED PATHS & NOTES**:
- File to edit: manifest.json (root of UI5 app)
- OData V2: use "sap.ui.generic.app" top-level configuration and component name "sap.suite.ui.generic.template.AnalyticalListPage".
- OData V4: use the ListReport template target under routing/targets and the "views.paths" configuration.
- Ensure i18n keys referenced (e.g., contentAreaTitle) exist in i18n.properties.
--------------------------------

**TITLE**: Manifest Configuration for SAP Fiori Overview Page (OVP)

**INTRODUCTION**: Configure the overview page by adding an sap.ovp section to your app's manifest.json. This controls global filter behavior, card models/templates/settings, container layout, data-load and refresh behavior, lazy rendering, annotation paths for analytics/cards, and other OVP-specific behavior.

**TAGS**: fiori-elements-framework, ovp, manifest.json, sapui5, cards, layout, lazy-loading, global-filter, smart-variant

**STEP**: 1 — Add the sap.ovp section to manifest.json

**DESCRIPTION**: Add an sap.ovp object to manifest.json (root-level) containing configuration for global filters, data loading, card rendering and card definitions. Use this sample as a copy-paste starter and adapt model names, entity sets and annotation paths to your app.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "globalFilterModel": "ZModelName",
    "globalFilterEntityType": "ZFilterEntityType",
    "globalFilterEntitySet": "ZFilterEntitySet",
    "containerLayout": "resizable",
    "smartVariantRequired": true,
    "showDateInRelativeFormat": false,
    "enableLiveFilter": false,
    "dataLoadSettings": {
      "loadDataOnAppLaunch": "ifAnyFilterExist"
    },
    "imageSupported": true,
    "considerAnalyticalParameters": true,
    "refreshIntervalInMinutes": 2,
    "useDateRangeType": true,
    "enableLazyRendering": true,
    "cards": {
      "card01": {
        "model": "ZCard1Model",
        "template": "sap.ovp.cards.list",
        "settings": {
          "title": "card title",
          "subTitle": "sub title",
          "entitySet": "zCard1EntitySet",
          "valueSelectionInfo": "text for KPI Header",
          "listFlavor": "Standard",
          "listType": "Extended",
          "sortBy": "zPropertyForSort",
          "sortOrder": "Ascending",
          "showRefresh": false,
          "staticContent": {},
          "annotationPath": "",
          "kpiAnnotationPath": "com.sap.vocabularies.UI.v1.KPI#AllActualCosts",
          "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#SalesShareBubble",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#SalesShareBubble",
          "dataPointAnnotationPath": "",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#Eval_by_Currency_Scatter",
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Eval_by_Currency_ColumnStacked",
          "dynamicSubtitleAnnotationPath": "dynamicSubtitle",
          "requireAppAuthorization": "",
          "navigation": "noHeaderNav"
        }
      }
    }
  }
}
```

**STEP**: 2 — Key properties and allowed values

**DESCRIPTION**: Use these short descriptions when programmatically generating or validating the sap.ovp section. Replace placeholder values (ZModelName, entity sets, annotation targets) with your app-specific names.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "globalFilterModel": "String (OData model name used for global filters)",
  "globalFilterEntityType": "String (deprecated since SAPUI5 1.54; entity type for global filters)",
  "globalFilterEntitySet": "String (use from SAPUI5 1.54; entity set for global filters)",
  "containerLayout": "String ('fixed' | 'resizable')",
  "smartVariantRequired": "Boolean (default true)",
  "showDateInRelativeFormat": "Boolean",
  "enableLiveFilter": "Boolean (true = live updates; false = Go button required)",
  "dataLoadSettings": {
    "loadDataOnAppLaunch": "String ('ifAnyFilterExist' | 'always' | 'never')"
  },
  "imageSupported": "Boolean (true = show images/icons in condensed list card)",
  "considerAnalyticalParameters": "Boolean (enable analytical parameter support)",
  "refreshIntervalInMinutes": "Number (minutes between auto refreshes)",
  "useDateRangeType": "Boolean (enable semantic date range control)",
  "enableLazyRendering": "Boolean (true = render visible cards, render others on scroll)"
}
```

**STEP**: 3 — Card definition details

**DESCRIPTION**: Each card is an object under sap.ovp.cards keyed by a card id. The settings object contains title/subtitle, entitySet, annotation paths, UI flavors and navigation behavior. Provide model, template and all annotation paths required by your card type.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "cards": {
    "cardId": {
      "model": "<ODataModelName>",
      "template": "<sap.ovp.cards.* component path>",
      "settings": {
        "title": "<string>",
        "subTitle": "<string>",
        "entitySet": "<EntitySetName>",
        "valueSelectionInfo": "<string>",
        "listFlavor": "'Standard' | 'Bar'",
        "listType": "'Extended' | 'Condensed'",
        "sortBy": "<propertyName>",
        "sortOrder": "'Ascending' | 'Descending'",
        "showRefresh": true,
        "staticContent": {},
        "annotationPath": "<annotationPath>",
        "kpiAnnotationPath": "<KPI annotation path>",
        "chartAnnotationPath": "<Chart annotation path>",
        "presentationAnnotationPath": "<PresentationVariant annotation path>",
        "dataPointAnnotationPath": "<DataPoint annotation path>",
        "identificationAnnotationPath": "<Identification annotation path>",
        "selectionAnnotationPath": "<SelectionVariant annotation path>",
        "dynamicSubtitleAnnotationPath": "<dynamic subtitle annotation>",
        "requireAppAuthorization": "<authorization key>",
        "navigation": "'noHeaderNav' | undefined"
      }
    }
  }
}
```

**STEP**: 4 — Configure overview page layout (containerLayout)

**DESCRIPTION**: Choose the card layout model. Examples below show setting either fixed or resizable. Note fixed layout is deprecated in SAPUI5 1.142.

**LANGUAGE**: JSON

**CODE**:
```json
// Resizable layout (recommended)
{
  "sap.ovp": {
    "containerLayout": "resizable"
  }
}

// Fixed layout (deprecated as of SAPUI5 1.142)
{
  "sap.ovp": {
    "containerLayout": "fixed"
  }
}
```

**STEP**: 5 — Behavior when switching from fixed to resizable

**DESCRIPTION**: When you switch from fixed -> resizable layout, the following user/ key-user changes are NOT retained:
- Card arrangements changed by end users via drag-and-drop
- Card order changes made by key users via cut-and-paste

Keep this in mind when migrating apps or toggling layout programmatically.

**LANGUAGE**: JSON

**CODE**:
```json
// No code required; retain only as migration note
{}
```

**STEP**: 6 — Enable lazy rendering and URL test parameter

**DESCRIPTION**: Two ways to enable lazy rendering of cards:
- Manifest flag: set "enableLazyRendering": true (recommended for production)
- Runtime test URL parameter: append ?sap-fe-xx-lazyloadingtest=true to the app URL (mimics enableLazyRendering:true for testing)

**LANGUAGE**: JSON / URL

**CODE**:
```json
// Manifest flag
{
  "sap.ovp": {
    "enableLazyRendering": true
  }
}
```

```text
// URL test parameter (use in browser during testing)
https://<host>/<appPath>/index.html?sap-fe-xx-lazyloadingtest=true
```

**STEP**: 7 — Performance and data-load tuning

**DESCRIPTION**: Use dataLoadSettings.loadDataOnAppLaunch to control automatic data fetching on app start:
- "always" — auto load regardless of filters
- "ifAnyFilterExist" — auto load only if a filter exists
- "never" — do not auto load

Also set refreshIntervalInMinutes to enable periodic card model refresh.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "dataLoadSettings": {
      "loadDataOnAppLaunch": "ifAnyFilterExist"
    },
    "refreshIntervalInMinutes": 2
  }
}
```
--------------------------------

**TITLE**: Configure Object Page Header Title and Description (UI.HeaderInfo)

**INTRODUCTION**: Use OData/UI annotations to set the Object Page header Title and Description in SAP Fiori elements. This document provides three implementation examples (OData XML annotations, ABAP CDS annotations, and CAP CDS annotations) and concise instructions for where and how to apply them. Use the example matching your backend technology to display an entity's descriptive text and an additional property in the object page header.

**TAGS**: fiori-elements-framework, annotations, UI.HeaderInfo, object-page, title, description, OData, CDS, CAP, ABAP

STEP: 1 — Overview / Mapping
DESCRIPTION: The UI.HeaderInfo annotation defines the object page header. Set the Title and Description using UI.DataField entries. Title/Description Value can be a path to a navigation property or a scalar property depending on the entity model. Apply the annotation in the appropriate file/type for your stack: OData XML annotation file, ABAP CDS view annotations, or CAP CDS annotation file.
LANGUAGE: JSON
CODE:
```JSON
{
  "Annotation": "UI.HeaderInfo",
  "Properties": {
    "Title": "UI.DataField -> Value (Path or constant)",
    "Description": "UI.DataField -> Value (Path or constant)"
  }
}
```

STEP: 2 — OData XML Annotation (annotation file)
DESCRIPTION: Add the following XML annotation to your service annotation file (e.g., annotations.xml) and target your entity type. This example targets STTA_PROD_MAN.STTA_C_MP_ProductType. Title uses a navigation path to to_ProductTextInOriginalLang/Name; Description uses ProductForEdit.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType">
    <Annotation Term="UI.HeaderInfo">
        <Record>
            <PropertyValue Property="Title">
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="to_ProductTextInOriginalLang/Name"/>
                </Record>
            </PropertyValue>
            <PropertyValue Property="Description">
                <Record Type="UI.DataField">
                     <PropertyValue Property="Value" Path="ProductForEdit"/>
                </Record>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: 3 — ABAP CDS Annotation (on a CDS view)
DESCRIPTION: Annotate the ABAP CDS view that represents the entity. Use @UI.headerInfo and set title and description values. In this example the title references a UI value identifier for the navigation property label and the description uses a field name PRODUCTFOREDIT. Apply this annotation in your CDS source (annotate view STTA_C_MP_PRODUCT).
LANGUAGE: ABAP CDS
CODE:
```ABAP CDS
@UI.headerInfo: {
  title: {
    value: '_PRODUCTTEXTINORIGINALLANG.NAME',
    type: #STANDARD
  },
  description: {
    value: 'PRODUCTFOREDIT',
    type: #STANDARD
  }
}
annotate view STTA_C_MP_PRODUCT with {

}
```

STEP: 4 — CAP CDS Annotation (Node.js / CAP model)
DESCRIPTION: For CAP-based services, add UI annotations to the service or entity file (e.g., in srv or db model annotations). This CAP CDS example annotates STTA_PROD_MAN.STTA_C_MP_ProductType. Title and Description are defined as UI.DataField entries referencing the navigation path and property.
LANGUAGE: CAP CDS
CODE:
```CDS
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with @(
  UI.HeaderInfo : {
    Title : {
        $Type : 'UI.DataField',
        Value : to_ProductTextInOriginalLang.Name
    },
    Description : {
        $Type : 'UI.DataField',
        Value : ProductForEdit
    }
  }
);
```

STEP: 5 — Validation and Behavior Notes
DESCRIPTION: Verify at runtime that:
- The Title path resolves (navigation property exists and is included in the service metadata).
- The Description property exists on the entity.
- Annotation files are included in metadata document(s) and the Fiori elements app consumes the annotations.
LANGUAGE: JSON
CODE:
```JSON
{
  "validationChecks": [
    "Metadata exposes the annotated entity type",
    "Navigation property to_ProductTextInOriginalLang is present and includes Name",
    "Property ProductForEdit exists on the entity",
    "Annotations are deployed and visible via $metadata"
  ]
}
```

Related Information: Changing Default Titles of New and Unnamed Objects — see application guidance to replace default object titles for new/unnamed items.
--------------------------------

**TITLE**: Configure table row selection (single/multiple) and Select All/Clear All in Fiori Elements

**INTRODUCTION**: This document shows how to configure row selection behavior for tables in SAP Fiori Elements (OData V2 and V4) via manifest.json. It includes examples for List Report and Object Page pages, global vs per-table settings, selectAll/clearAll settings, and selectionLimit for non-responsive tables. Use these snippets directly in your app's manifest.json.

**TAGS**: fiori-elements-framework, manifest.json, selection, table, multiSelect, selectionMode, selectAll, selectionLimit, ODataV2, ODataV4

**STEP**: OData V2 — Enable multiple selection in a List Report
**DESCRIPTION**: In a List Report manifest.json, set multiSelect true under sap.ui.generic.app > pages > <PageId> > component > settings > tableSettings to switch from single to multiple selection for the table.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "pages": {
      "ListReport|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "tableSettings": {
              "multiSelect": true
            }
          }
        }
      }
    }
  }
}
```

**STEP**: OData V2 — Enable multiple selection globally on an Object Page
**DESCRIPTION**: To enable multiple selection for all tables on an Object Page, set tableSettings.multiSelect at the page-level settings in manifest.json.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "pages": {
    "ObjectPage|STTA_C_MP_Product": {
      "entitySet": "STTA_C_MP_Product",
      "name": "sap.suite.ui.generic.template.ObjectPage",
      "settings": {
        "showRelatedApps": true,
        "editableHeaderContent": true,
        "tableSettings": {
          "multiSelect": true
        },
        "sections": {
          "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
            "navigationProperty": "to_ProductText",
            "entitySet": "STTA_C_MP_ProductText",
            "createMode": "inline"
          }
        }
      }
    }
  }
}
```

**STEP**: OData V2 — Enable multiple selection per-table on an Object Page
**DESCRIPTION**: To enable multiple selection only for a specific table section on an Object Page, set tableSettings.multiSelect for that section in manifest.json.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "pages": {
    "ObjectPage|STTA_C_MP_Product": {
      "entitySet": "STTA_C_MP_Product",
      "name": "sap.suite.ui.generic.template.ObjectPage",
      "settings": {
        "showRelatedApps": true,
        "editableHeaderContent": true,
        "sections": {
          "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
            "navigationProperty": "to_ProductText",
            "entitySet": "STTA_C_MP_ProductText",
            "createMode": "inline",
            "tableSettings": {
              "multiSelect": true
            }
          }
        }
      }
    }
  }
}
```

**STEP**: OData V2 — Configure Select All / Clear All and selectionLimit
**DESCRIPTION**: Configure selectAll (true/false) and selectionLimit (for Grid/Analytical/Tree tables) inside tableSettings. For responsive tables: selectAll controls whether the Select All checkbox appears. For grid/analytical/tree: selectAll:true will load all backend data in multiple requests; selectionLimit restricts selection when selectAll:false. Default selectionLimit is 200 if not set.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|STTA_C_MP_Product": {
        "component": {
          "settings": {
            "tableSettings": {
              "multiSelect": true,
              "selectAll": false,
              "selectionLimit": 150
            }
          }
        }
      }
    }
  }
}
```

**STEP**: OData V4 — selectionMode values and behavior (summary)
**DESCRIPTION**: Use selectionMode in manifest.json to control selection in OData V4:
- "Multi" (default): multiple selection allowed when toolbar actions requiring context exist (display mode) or Delete is available (edit mode).  
- "Single": single selection allowed under similar conditions.  
- "None": no selection in display mode; selection allowed in edit mode if Delete is available.  
- "Auto": deprecated.  
When bound actions are unavailable, selectionMode is treated as "None". To override, use "ForceMulti" or "ForceSingle".
**LANGUAGE**: JSON
**CODE**:
```json
// No code block needed for summary; use sample manifest entries below to apply values.
```

**STEP**: OData V4 — Enable Multi selection in a List Report (component/options/settings)
**DESCRIPTION**: Set selectionMode = "Multi" under the controlConfiguration for the line item (table) to enable multiple selection in a List Report for OData V4.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "SalesOrderManageList": {
    "type": "Component",
    "id": "SalesOrderManageList",
    "name": "sap.fe.templates.ListReport",
    "options": {
      "settings": {
        "contextPath": "/SalesOrderManage",
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "type": "ResponsiveTable",
              "selectionMode": "Multi"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: OData V4 — Enable Multi selection in an Object Page (per-table)
**DESCRIPTION**: Set selectionMode = "Multi" in controlConfiguration for the specific @com.sap.vocabularies.UI.v1.LineItem to enable multiple selection for that table on an Object Page.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "contextPath": "/SalesOrderManage",
        "sectionLayout": "Tabs",
        "controlConfiguration": {
          "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "type": "GridTable",
              "selectionMode": "Multi"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: OData V4 — Toggle Select All behavior per table
**DESCRIPTION**: Control whether the Select All checkbox is shown by setting selectAll true/false in tableSettings. For Object Page, the default differs by page layout (tab bar = Clear All by default; anchor bar = Select All by default). For non-responsive tables, selectAll:true will trigger loading all backend data in multiple requests—use with care.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "controlConfiguration": {
    "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "type": "GridTable",
        "selectionMode": "Multi",
        "selectAll": true
      }
    }
  }
}
```

**STEP**: OData V4 — Limit number of selectable rows (selectionLimit)
**DESCRIPTION**: For Grid/Analytical/Tree tables, set selectionLimit (integer) to cap the number of rows selected at once. If not set, default is 200. Add selectionLimit under tableSettings for the relevant controlConfiguration entry in manifest.json.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "contextPath": "/SalesOrderManage",
        "sectionLayout": "Tabs",
        "controlConfiguration": {
          "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "type": "GridTable",
              "selectionMode": "Multi",
              "selectionLimit": 50
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Important implementation notes (apply when coding)
**DESCRIPTION**: Use these rules when implementing:
- For OData V2 use multiSelect (boolean). For OData V4 use selectionMode with values such as "Multi", "Single", "None", or override with "ForceMulti"/"ForceSingle".
- selectAll:true on grid/analytical/tree triggers backend streaming requests—consider performance.
- For responsive tables selectAll:true selects only loaded rows and displays a toast with the count.
- If bound actions are disabled for the user, OData V4 may treat selectionMode as "None" regardless of manifest; use ForceMulti/ForceSingle to override.
--------------------------------

**TITLE**: Configuring the Static Link List Card (OVP linklist)

**INTRODUCTION**: Quick reference for implementing a static link list card (sap.ovp.cards.linklist) that displays static links, images and icons as list items. Includes minimal card-level settings, staticContent item properties, and two complete examples showing URL-based and intent-based navigation. Insert these card definitions into your OVP cards configuration (for example, the manifest.json or equivalent OVP card config).

**TAGS**: fiori-elements-framework, ovp, linklist, static-content, navigation, intent-based, url-based, manifest, card

STEP: 1 — Card top-level settings

DESCRIPTION: Set the card metadata and display flavor. The listFlavor controls presentation: "standard" (vertical list) or "carousel" (horizontal carousel). Include optional layout properties like defaultSpan.

LANGUAGE: JSON

CODE:
```json
{
  "cardId": {
    "model": "<modelName>",
    "template": "sap.ovp.cards.linklist",
    "settings": {
      "title": "Card Title",
      "subTitle": "Card Subtitle",
      "listFlavor": "standard"  /* "standard" or "carousel" */
      /* optional layout */
      /* "defaultSpan": { "rows": 15, "cols": 1 } */
    }
  }
}
```

STEP: 2 — Static content item properties

DESCRIPTION: Each item in staticContent can include title, subTitle, imageUri (img path or sap-icon://), imageAltText, and navigation properties (see Steps 3 & 4). Use imageUri to reference local images (e.g. "img/JD.png") or icon URIs (e.g. "sap-icon://Fiori6/F0865"). Use imageAltText for accessibility.

LANGUAGE: JSON

CODE:
```json
{
  "staticContent": [
    {
      "title": "Item Title",
      "subTitle": "Item Subtitle",
      "imageUri": "img/example.png",
      "imageAltText": "Example image alt text"
      /* navigation fields follow (targetUri OR semanticObject+action) */
    }
  ]
}
```

STEP: 3 — URL-based navigation example

DESCRIPTION: Example card using targetUri and openInNewWindow for each static item. Place this object inside your OVP cards configuration (e.g., manifest json under your card id). Each item will open the provided URL; set openInNewWindow to true to open in a new browser window/tab.

LANGUAGE: JSON

CODE:
```json
{
  "card010_QuickLinks": {
    "model": "salesOrder",
    "template": "sap.ovp.cards.linklist",
    "settings": {
      "title": "Quick Links",
      "subTitle": "Standard Link List With Static Data",
      "listFlavor": "standard",
      "staticContent": [
        {
          "title": "Jim Smith",
          "subTitle": "Sales",
          "imageUri": "img/JD.png",
          "imageAltText": "Jim Smith",
          "targetUri": "https://abc.com",
          "openInNewWindow": true
        },
        {
          "title": "Alice Wilson",
          "subTitle": "Sales",
          "imageUri": "img/AW.png",
          "imageAltText": "Alice Wilson",
          "targetUri": "https://abc.com",
          "openInNewWindow": true
        }
      ]
    }
  }
}
```

STEP: 4 — Intent-based navigation example

DESCRIPTION: Example card using semanticObject and action for Fiori intent-based navigation. Use semanticObject + action to launch target app. Optional properties: disableInCard (true to disable navigation for the item), defaultSpan for card layout, and icon URIs for imageUri.

LANGUAGE: JSON

CODE:
```json
{
  "card010_QuickLinks": {
    "model": "salesOrder",
    "template": "sap.ovp.cards.linklist",
    "settings": {
      "title": "Quick Links",
      "subTitle": "Standard Link List With Static Data",
      "listFlavor": "standard",
      "defaultSpan": {
        "rows": 15,
        "cols": 1
      },
      "staticContent": [
        {
          "title": "Create Purchase Order",
          "imageUri": "sap-icon://Fiori6/F0865",
          "imageAltText": "{{card30_icon_prod_man}}",
          "semanticObject": "Action",
          "action": "toappnavsample",
          "disableInCard": true
        },
        {
          "title": "Create Supplier",
          "imageUri": "sap-icon://Fiori2/F0246",
          "imageAltText": "{{card30_icon_so_man}}",
          "semanticObject": "Action",
          "action": "toappnavsample"
        },
        {
          "title": "Create Contact",
          "imageUri": "sap-icon://Fiori6/F0866",
          "imageAltText": "{{card30_icon_so_man}}",
          "semanticObject": "Action",
          "action": "toappnavsample"
        }
      ]
    }
  }
}
```
--------------------------------

**TITLE**: Configuring the Table Area (UI.LineItem) for Fiori Elements

**INTRODUCTION**: Quick reference for configuring a Fiori Elements table using the UI.LineItem annotation. Includes XML, ABAP CDS, and CAP CDS examples for DataField entries (labels and values), DataFieldForAnnotation (DataPoint and Contact), and navigation entries (intent-based and URL navigation). Use these snippets to implement table column definitions and quick-view/numeric formatting and navigation in OData metadata or CDS models.

**TAGS**: fiori-elements-framework, odata-annotations, UI.LineItem, LineItem, DataField, DataPoint, Communication.Contact, navigation, DataFieldForIntentBasedNavigation, DataFieldWithUrl, ABAP CDS, CAP CDS, XML

STEP: 1 — Define LineItem columns with DataField (labels and values)

DESCRIPTION: Add UI.LineItem (LineItem) entries that define table columns. Each column is a DataField (text/value) or DataFieldForAnnotation. Include label (Label) and the property path (Value/Path) or qualifier. Examples provided for XML annotations (OData EDMX), ABAP CDS, and CAP CDS.

LANGUAGE: XML

CODE:
```xml
<!-- Place in OData EDMX annotations file -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem" Qualifier="View4">
   <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
         <PropertyValue Property="Label" String="Order ID" />
         <PropertyValue Property="Value" Path="SalesOrderID" />
      </Record>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
         <PropertyValue Property="Label" String="Customer" />
         <PropertyValue Property="Value" Path="ToBusinessPartner/EmailAddress" />
      </Record>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
         <PropertyValue Property="Label" String="Customer" />
         <PropertyValue Property="Value" Path="CustomerName" />
      </Record>
      <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
         <PropertyValue Property="Label" String="TaxAmount" />
         <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.DataPoint#TaxAmount" />
      </Record>
   </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
/* ABAP CDS example: attach @UI.lineItem annotations to fields/elements */
@UI.lineItem: [
  {
    label: 'Order ID',
    position: 10 ,
    qualifier: 'View4'
  }
]
SALESORDERID;

@UI.lineItem: [
  {
    label: 'Customer',
    value: '_BUSINESSPARTNER.EMAILADDRESS',
    position: 20 ,
    qualifier: 'View4'
  }
]
_BUSINESSPARTNER;

@UI.lineItem: [
  {
    label: 'Customer',
    position: 30,
    qualifier: 'View4'
  }
]
CUSTOMERNAME;

@UI.lineItem: [
  {
    label: 'TaxAmount',
    valueQualifier: 'TaxAmount',
    type: #AS_DATAPOINT,
    position: 40,
    qualifier: 'View4'
  }
]
PROPERT_NAME;
```

LANGUAGE: CAP CDS

CODE:
```cds
// CAP CDS example: UI.LineItem with qualifier #View4
UI.LineItem #View4 : [
    {
        $Type : 'UI.DataField',
        Label : 'Order ID',
        Value : SalesOrderID
    },
    {
        $Type : 'UI.DataField',
        Label : 'Customer',
        Value : ToBusinessPartner.EmailAddress
    },
    {
        $Type : 'UI.DataField',
        Label : 'Customer',
        Value : CustomerName
    },
    {
        $Type : 'UI.DataFieldForAnnotation',
        Label : 'TaxAmount',
        Target : '@UI.DataPoint#TaxAmount'
    }
]
```

STEP: 2 — Add DataFieldForAnnotation: DataPoint (numeric) and Contact (quick view)

DESCRIPTION: Use DataFieldForAnnotation to reference other annotations that format numeric values (DataPoint) or provide contact quick-view info (Communication.Contact). Examples show how to define the referenced annotations (DataPoint and Contact) in XML, ABAP CDS, and CAP CDS.

LANGUAGE: XML

CODE:
```xml
<!-- DataPoint annotation for numeric display, qualifier = TaxAmount -->
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="TaxAmount">
   <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
      <PropertyValue Property="Title" String="TaxAmount" />
      <PropertyValue Property="Value" Path="TaxAmount" />
   </Record>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
/* ABAP CDS DataPoint example */
@UI.dataPoint: {
  title: 'TaxAmount'
}
TaxAmount;
```

LANGUAGE: CAP CDS

CODE:
```cds
// CAP CDS DataPoint example (qualifier #TaxAmount)
UI.DataPoint #TaxAmount : {
    $Type : 'UI.DataPointType',
    Title : 'TaxAmount',
    Value : TaxAmount
}
```

LANGUAGE: XML

CODE:
```xml
<!-- Communication.Contact annotation in OData EDMX for quick-view contact info -->
<Annotation Term="com.sap.vocabularies.Communication.v1.Contact">
   <Record>
      <PropertyValue Property="tel">
         <Collection>
            <Record>
               <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/fax" />
               <PropertyValue Property="uri" Path="FaxNumber" />
            </Record>
            <Record>
               <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/work com.sap.vocabularies.Communication.v1.PhoneType/preferred"/>
               <PropertyValue Property="uri" Path="PhoneNumber" />
            </Record>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="email">
         <Collection>
            <Record>
               <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.ContactInformationType/preferred com.sap.vocabularies.Communication.v1.ContactInformationType/work" />
               <PropertyValue Property="address" Path="EmailAddress" />
            </Record>
         </Collection>
      </PropertyValue>
   </Record>
</Annotation>
```

LANGUAGE: CAP CDS

CODE:
```cds
// CAP CDS Communication.Contact example for quick-view contact
Communication.Contact : {
    tel : [
        {
            type : #fax,
            uri : FaxNumber
        },
        {
            type : [ #work, #pref ],
            uri : PhoneNumber
        }
    ],
    email : [
        {
            type : [ #pref, #work ],
            address : EmailAddress
        }
    ]
}
```

STEP: 3 — Configure navigation properties for table rows

DESCRIPTION: Define navigation actions on table columns to open other Fiori apps (intent-based) or external/internal URLs. Preferred approach: DataFieldForIntentBasedNavigation for intent-based navigation. Use DataFieldWithUrl if you need to navigate to a specific application route not configured in the target mapping. Examples show XML and CAP/ABAP styles.

LANGUAGE: XML

CODE:
```xml
<!-- Intent-based navigation (DataFieldForIntentBasedNavigation) -->
<Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
   <PropertyValue Property="Label" String="Open Sales Order" />
   <PropertyValue Property="SemanticObject" String="SalesOrder" />
   <PropertyValue Property="Action" String="display" />
   <PropertyValue Property="Value" Path="SalesOrderID" />
</Record>

<!-- URL navigation (DataFieldWithUrl) -->
<Record Type="com.sap.vocabularies.UI.v1.DataFieldWithUrl">
   <PropertyValue Property="Label" String="Open External Site" />
   <PropertyValue Property="Url" String="https://example.com/orders/{SalesOrderID}" />
</Record>
```

LANGUAGE: ABAP CDS

CODE:
```abap
/* ABAP CDS: Intent-based navigation using @UI.lineItem element with type */
@UI.lineItem: [
  {
    label: 'Open Sales Order',
    type: #AS_INTENT_BASED_NAV,
    semanticObject: 'SalesOrder',
    action: 'display',
    position: 50
  }
]
SALESORDERID;

/* ABAP CDS: DataFieldWithUrl (navigate to specific route) */
@UI.lineItem: [
  {
    label: 'Open External Site',
    type: #AS_URL,
    url: 'https://example.com/orders/{SalesOrderID}',
    position: 60
  }
]
SALESORDERID;
```

LANGUAGE: CAP CDS

CODE:
```cds
// CAP CDS: Intent-based navigation
{ $Type: 'UI.DataFieldForIntentBasedNavigation', Label: 'Open Sales Order', SemanticObject: 'SalesOrder', Action: 'display', Value: SalesOrderID }

// CAP CDS: DataFieldWithUrl
{ $Type: 'UI.DataFieldWithUrl', Label: 'Open External Site', Url: 'https://example.com/orders/{SalesOrderID}' }
```

STEP: 4 — Recommendation and behavior

DESCRIPTION: Use DataFieldForIntentBasedNavigation for intent-based navigation to other Fiori apps (recommended). Use DataFieldWithUrl when you must navigate to a specific application route not present in the target mapping; the overview page will still treat this as navigation and open the app in the same tab with the relevant context.

LANGUAGE: JSON

CODE:
```json
{
  "note": "Preferred: DataFieldForIntentBasedNavigation for intent-based navigation. Use DataFieldWithUrl only for direct routes not configured as targets."
}
```
--------------------------------

**TITLE**: Configuring the Table Card Header Area (title, KPI, view switch, navigation)

**INTRODUCTION**: Concise, code-first reference for configuring a Table Card header in an SAP Fiori Elements (OVP) app. Shows required manifest.json settings for title/subtitle, KPI annotation path, view-switch (tabs) configuration, and examples for the UI.DataPoint annotation in XML, ABAP CDS, and CAP CDS. Includes criticality options and navigation note.

**TAGS**: fiori-elements-framework, ovp, sap.ovp, manifest.json, DataPoint, KPI, annotation, table-card, header, view-switch, navigation

**STEP**: 1 — Add card title, subtitle and KPI annotation path to manifest.json

**DESCRIPTION**: In the application descriptor (manifest.json) add/modify the sap.ovp section. Set card title, subTitle, entitySet and (optional) top-level KPI path kpiAnnotationPath. Place this under the "sap.ovp" key and the specific card id under "cards".

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters",
    "globalFilterEntitySet": "GlobalFilters",
    "kpiAnnotationPath": "com.sap.vocabularies.UI.v1.KPI#AllActualCosts",  // KPI annotation path (optional)
    "cards": {
      "card014": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.table",
        "settings": {
          "title": "Sales Forecast",
          "subTitle": "per Supplier",
          "entitySet": "SalesShare"
        }
      }
    }
  }
}
```

**STEP**: 2 — Define the KPI DataPoint annotation (XML OData metadata)

**DESCRIPTION**: Add a UI.DataPoint annotation in the service metadata (XML) to define KPI Title, Value, ValueFormat, CriticalityCalculation, TargetValue and TrendCalculation. Use a Qualifier to reference this DataPoint from manifest kpiAnnotationPath or card tab dataPointAnnotationPath.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Country_Generic">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Sales India - Generic Card" />
    <PropertyValue Property="Value" Path="Sales" />
    <PropertyValue Property="ValueFormat">
      <Record>
        <PropertyValue Property="ScaleFactor" Decimal="2" />
        <PropertyValue Property="NumberOfFractionalDigits" Int="1" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="CriticalityCalculation">
      <Record>
        <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Minimize" />
        <PropertyValue Property="DeviationRangeHighValue" String="7300" />
        <PropertyValue Property="ToleranceRangeHighValue" String="7200" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="TargetValue" String="2.000" />
    <PropertyValue Property="TrendCalculation">
      <Record>
        <PropertyValue Property="ReferenceValue" String="5201680" />
        <PropertyValue Property="DownDifference" Decimal="10000000.0" />
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 3 — Define the KPI DataPoint annotation (ABAP CDS)

**DESCRIPTION**: ABAP CDS annotation example that declares a DataPoint for the Sales measure. Use @UI.dataPoint with properties for title, valueFormat, criticalityCalculation, targetValue and trendCalculation. Reference the DataPoint qualifier in the manifest.

**LANGUAGE**: ABAP

**CODE**:
```ABAP
@UI.dataPoint: {
  title: 'Sales India - Generic Card',
  valueFormat: { scaleFactor: 2, numberOfFractionalDigits: 1 },
  criticalityCalculation: {
    improvementDirection: #MINIMIZE,
    deviationRangeHighValue: 7300,
    toleranceRangeHighValue: 7200
  },
  targetValue: 2.000,
  trendCalculation: { referenceValue: 'refValElement', downDifference: 10000000.0 }
}
Sales;
```

**STEP**: 4 — Define the KPI DataPoint annotation (CAP CDS)

**DESCRIPTION**: CAP CDS example using UI.DataPoint with a qualifier. Use this when implementing service definitions in CAP.

**LANGUAGE**: CDS

**CODE**:
```CDS
UI.DataPoint #Eval_by_Country-Generic : {
  $Type : 'UI.DataPointType',
  Title : 'Sales India - Generic Card',
  Value : Sales,
  ValueFormat : {
    ScaleFactor : 2,
    NumberOfFractionalDigits : 1
  },
  CriticalityCalculation : {
    ImprovementDirection : #Minimizing,
    DeviationRangeHighValue : '7300',
    ToleranceRangeHighValue : '7200'
  },
  TargetValue : '2.000',
  TrendCalculation : {
    ReferenceValue : '5201680',
    DownDifference : 10000000.0
  }
}
```

**STEP**: 5 — Configure view switch (tabs) for table card in manifest.json

**DESCRIPTION**: Define a "tabs" array inside the card settings to provide a dropdown at the card header for switching views/filters. For each tab provide annotationPath, selectionAnnotationPath, presentationAnnotationPath, identification/dataPoint paths and a "value" (label binding or literal). The card will use these annotation paths to filter and present different views.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntitySet": "GlobalFilters",
    "showDateInRelativeFormat": false,
    "disableTableCardFlexibility": false,
    "considerAnalyticalParameters": true,
    "useDateRangeType": false,
    "cards": {
      "card014": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.table",
        "settings": {
          "title": "Sales Forecast",
          "subTitle": "per Supplier",
          "valueSelectionInfo": "Value Selection Info",
          "entitySet": "SalesShare",
          "tabs": [
            {
              "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
              "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
              "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
              "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line",
              "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
              "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
              "value": "{{dropdown_value2}}"   // binding to a text key or literal label
            },
            {
              "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
              "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View4",
              "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#item2",
              "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
              "value": "{{dropdown_value4}}"
            }
          ]
        }
      }
    }
  }
}
```

**STEP**: 6 — DataPoint annotation properties and criticality options

**DESCRIPTION**: Use these properties when authoring UI.DataPoint annotations. Criticality can be an enum URI or a path returning numeric values 0..3.

- Title: string shown in KPI header and as table column name.
- Value: Path to the KPI measure.
- ValueFormat: Number formatting (ScaleFactor, NumberOfFractionalDigits).
- Criticality/ CriticalityCalculation: highlight KPI using enum or path.
  - Enum members:
    - com.sap.vocabularies.UI.v1.CriticalityType/Neutral (0 — neutral)
    - com.sap.vocabularies.UI.v1.CriticalityType/Negative (1 — red)
    - com.sap.vocabularies.UI.v1.CriticalityType/Critical (2 — orange)
    - com.sap.vocabularies.UI.v1.CriticalityType/Positive (3 — green)
  - Or provide a path that returns:
    - 0 = Neutral
    - 1 = Negative (Red)
    - 2 = Critical (Orange)
    - 3 = Positive (Green)

**LANGUAGE**: JSON

**CODE**:
```JSON
// Example: Criticality as enum (in XML/annotation this is EnumMember)
"Criticality": "com.sap.vocabularies.UI.v1.CriticalityType/Positive"

// Example: Criticality as path (returns 0..3)
"Criticality": { "Path": "CriticalityValue" }
```

**STEP**: 7 — Configure header/table navigation (identification annotation) — optional

**DESCRIPTION**: Use the Identification annotation (UI.Identification) to configure navigation targets from the header or table area. Note: navigation settings in LineItem (table area) take precedence over Identification navigation when both are present.

**LANGUAGE**: XML

**CODE**:
```XML
<!-- Example: Identification with Navigation -->
<Annotation Term="UI.Identification">
  <Record>
    <PropertyValue Property="Label" String="Sales Order"/>
    <PropertyValue Property="Value" Path="SalesOrderID"/>
    <PropertyValue Property="Target" >
      <Record Type="UI.NavigationType">
        <PropertyValue Property="SemanticObject" String="SalesOrder"/>
        <PropertyValue Property="Action" String="display"/>
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```
--------------------------------

**TITLE**: Configure Table-Only View as Default for Analytical List Page (ALP)

**INTRODUCTION**: Instructions and manifest code snippets to load the ALP in table-only view by default, for both OData V2 and OData V4. Also covers column width control via metadata and a note on determining actions deprecation. Use these manifest entries and metadata adjustments when generating or modifying application manifest.json files.

**TAGS**: fiori-elements, analytical-list-page, ALP, table-only, manifest.json, OData V2, OData V4, tableSettings, MaxLength, Precision, determining-actions

STEP: Configure Table-Only View (OData V2)

DESCRIPTION: Add a page entry in manifest.json to render the Analytical List Page as a list (table) only. Set the table type via tableSettings.type to one of the supported table implementations: "GridTable", "AnalyticalTable", or "ResponsiveTable". Place this under sap.ui.generic.app -> pages -> component -> settings -> tableSettings.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "tableSettings": {
              "type": "GridTable or AnalyticalTable or ResponsiveTable"
            }
          }
        }
      }
    ]
  }
}
```

STEP: Manifest file path and placement

DESCRIPTION: Ensure the JSON snippet above is merged into your application's manifest.json under the root. Typical file: <project-root>/webapp/manifest.json. The "entitySet" must match your main entity set for the ALP.

LANGUAGE: JSON

CODE:
```json
// Example location: webapp/manifest.json
{
  // ... other manifest entries ...
  "sap.ui.generic.app": {
    "pages": [ /* insert page entry from previous step here */ ]
  }
}
```

STEP: Control column width via service metadata

DESCRIPTION: Adjust table column widths by modifying OData metadata annotations for the corresponding entity properties:
- For text/string properties, set MaxLength in metadata to restrict column display width.
- For decimal/numeric properties, set Precision to control displayed width/format.

LANGUAGE: JSON

CODE:
```json
// Example (conceptual) OData property annotations in EDMX or annotation files:
// For strings:
<Property Name="ProductName" Type="Edm.String" MaxLength="40" />
// For decimals:
<Property Name="Amount" Type="Edm.Decimal" Precision="10" Scale="2" />
```

STEP: Table display mode (condensed vs compact)

DESCRIPTION: ALP displays tables in condensed mode by default. If you require compact mode, modify the appropriate manifest setting for UI density in your application (application-level UI density or component settings). The exact key depends on your app setup; ensure you apply UI density/compact settings consistently across the app.

LANGUAGE: JSON

CODE:
```json
// Example: set application UI density via component or index.html (implementation-specific).
// No single manifest key is enforced here; modify the app's UI density settings as required.
```

STEP: Determining actions (deprecated)

DESCRIPTION: The "Determining Actions" feature is deprecated and maintained for compatibility only. Avoid using determining buttons when designing new applications. If present, review related list report documentation and plan migration away from this feature.

LANGUAGE: TEXT

CODE:
```text
Recommendation: Do not add determining buttons in new apps. See "Defining Determining Actions in List Reports" for existing compatibility behaviors.
```

STEP: Configure Table-Only View (OData V4 / ALP) — set defaultPath to "secondary"

DESCRIPTION: For OData V4 ALP, set the view path default to "secondary" to load the table-only view by default. Add the views.paths.defaultPath entry in manifest.json.

LANGUAGE: JSON

CODE:
```json
{
  "views": {
    "paths": [
      {
        "defaultPath": "secondary"
      }
    ]
  }
}
```

STEP: References and related manifest options

DESCRIPTION: For additional manifest options (annotation paths, content area configuration, and table type control), consult:
- Configuring the Manifest for the Analytical List Page
- Configuring the Content Area
- Setting the Table Type

LANGUAGE: TEXT

CODE:
```text
Related topics:
- Configuring the Manifest for the Analytical List Page
- Configuring the Content Area
- Setting the Table Type
```
--------------------------------

**TITLE**: Configuring KPI Cards in the Analytical List Page (ALP) Title Area

**INTRODUCTION**: This document shows how to configure KPI cards in the ALP title area for SAP Fiori elements (OData V2). It covers the manifest.json mapping for a KPI qualifier and a sample OData annotation (UI.KPI) that enables KPI rendering and navigation. Also documents fallback behavior and the navigation parameter (EvaluationId) passed to target apps.

**TAGS**: fiori-elements, OData V2, UI.KPI, KPI, manifest.json, annotations, AnalyticalListPage

**STEP**: 1 — Add KPI qualifier mapping in manifest.json

**DESCRIPTION**: Add a KPI mapping entry in your application's manifest.json that maps a qualifier name to the KPI model/entitySet used by the ALP. The qualifier value here is used to connect the manifest entry to the UI.KPI annotation with the same qualifier. Place this fragment in the appropriate part of your manifest for the Analytical List Page (for example under sap.ui.generic.app pages/component/settings or the ALP component settings used in your project structure).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCubeALPResults",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "kpi": {
              "KPIQuantity": {
                "model": "kpi",
                "entitySet": "SEPMRA_C_ALP_SlsOrdItemCubeALPResults",
                "qualifier": "KPIQuantity"
              }
            }
          }
        }
      }
    ]
  }
}
```

**STEP**: 2 — Define UI.KPI annotation (annotations.xml)

**DESCRIPTION**: Define the UI.KPI annotation in your OData annotation file (annotations.xml) using the same qualifier configured in the manifest.json. Ensure the annotation includes a KPI identifier (KpiId or similar), and the semantic object and action for navigation. When a KPI card is clicked, the KPI ID is passed as the EvaluationId to the target application (URL fragment: #SemanticObject-action?EvaluationId=KPI_ID). Replace property names and paths with your actual service/entity properties.

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<edmx:Edmx Version="1.0" xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx">
  <edmx:DataServices>
    <!-- Annotations target: the KPI-related entity or an annotation file section -->
    <Annotations Target="SEPMRA_C_ALP_SlsOrdItemCubeALPResults">
      <!-- UI.KPI annotation with qualifier KPIQuantity -->
      <Annotation Term="UI.KPI" Qualifier="KPIQuantity">
        <Record>
          <!-- Display title -->
          <PropertyValue Property="Title" String="Quantity KPI" />
          <!-- KPI value measure (replace 'Quantity' with your measure property path) -->
          <PropertyValue Property="Value" Path="Quantity" />
          <!-- Navigation: semantic object and action for the target app -->
          <PropertyValue Property="SemanticObject" String="SalesOrder" />
          <PropertyValue Property="Action" String="display" />
          <!-- KPI identifier — this will be provided to the target as EvaluationId -->
          <PropertyValue Property="KpiId" String="KPI_Quantity_01" />
        </Record>
      </Annotation>
    </Annotations>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 3 — Example: navigation URL that receives KPI EvaluationId

**DESCRIPTION**: When the KPI card is activated, the ALP navigates to the target semantic action and includes the KPI ID as EvaluationId. Use this pattern in the target application to read the KPI context.

**LANGUAGE**: URL / Example

**CODE**:
```text
#SalesOrder-display?EvaluationId=KPI_Quantity_01
```

**STEP**: 4 — Fallback behavior: SelectionPresentationVariant

**DESCRIPTION**: If UI.KPI is not configured for a qualifier, the framework falls back to the UI.SelectionPresentationVariant annotation that has the same qualifier. Provide a SelectionPresentationVariant with the same qualifier if you want a fallback display/behavior.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="SEPMRA_C_ALP_SlsOrdItemCubeALPResults">
  <Annotation Term="UI.SelectionPresentationVariant" Qualifier="KPIQuantity">
    <Record>
      <!-- Example: reference a PresentationVariant and SelectionVariant here -->
      <PropertyValue Property="PresentationVariant" Path="MyPresentationVariant" />
      <PropertyValue Property="SelectionVariant" Path="MySelectionVariant" />
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 5 — Best practice / recommendation

**DESCRIPTION**: Use a single SAP-wide KPI gallery (for example, KPI definitions from SAP Smart Business) and reference those KPIs via qualifiers. This centralizes KPI creation and ensures consistent KPI IDs and navigation semantics across applications.

**LANGUAGE**: Text

**CODE**:
```text
Recommendation: Maintain a centralized KPI catalog (SAP Smart Business or similar). Use consistent qualifier names and KPI IDs (EvaluationId) across manifest mappings and UI.KPI annotations so ALP KPI cards and navigation remain stable.
```
--------------------------------

**TITLE**: Configuring the Visual Filter Bar (Fiori Elements)

**INTRODUCTION**: Configure and enable the Visual Filter Bar in SAP Fiori elements (OData V4). This document shows the manifest settings, required value-list/annotation prerequisites, aggregation placement rules, availability options, and draft-enabled entity restrictions you must apply to make visual filters render and function correctly.

**TAGS**: fiori-elements-framework, visual-filter-bar, visual-filters, manifest.json, ODataV4, valueList, aggregation, draft

**STEP**: 1 — Define visual filters via ValueList annotations

**DESCRIPTION**: Visual filters are driven by value list annotations for the filter fields. Create or enhance ValueList annotations that map the main entity filter field to a value-help entity with the measure(s) used for the visual representation (chart/donut/bars). Visual filters only apply to single- or multi-value filter fields (not range-based). Semantic dates are not supported. Filter values are synchronized with the regular filter bar.

Refer to: enhancing-valuelist-annotations-for-visual-filters-16d43eb.md for exact annotation syntax and examples.

**LANGUAGE**: Text

**CODE**:
```text
See: enhancing-valuelist-annotations-for-visual-filters-16d43eb.md
Create a ValueList annotation that:
- maps the main entity filter field to the value-help entity set
- exposes the measure(s) and dimension(s) used by the visual filter
- supports aggregation (see Step 4)
Note: use only single/multi-value fields; semantic dates are not supported.
```

**STEP**: 2 — Enhance manifest.json (OData V4) to enable and configure visual filters

**DESCRIPTION**: Add per-filter settings under settings.controlConfiguration["@com.sap.vocabularies.UI.v1.SelectionFields"]. Define layout, initialLayout, and filterFields. For each visual filter field include availability and visualFilter.valueList that points to the value-list annotation (path to the value list entity/annotation).

Place this snippet into the application's manifest.json "settings" node (file: manifest.json).

**LANGUAGE**: JSON

**CODE**:
```json
"settings" : {
   "contextPath" : "/SalesOrderManage",
   "controlConfiguration" : {
      "@com.sap.vocabularies.UI.v1.SelectionFields" : {
         "layout": "CompactVisual", // Possible values: "Compact" (only compact filter) and "CompactVisual" (both compact and visual)
         "initialLayout": "Visual", // Default filter mode on initial load. Possible values: "Visual" and "Compact"
         "filterFields": {
            "ItemRating": {                    // Filter field name
               "availability": "Default",      // "Default" | "Adaptation" | "Hidden"
               "visualFilter": {               // Only if a visual filter is configured for this field
                  "valueList": "<pathToValueList>" // Path to the value list annotation / value help entity for the visual representation
               }
            }
         }
      }
   }
}
```

**STEP**: 3 — availability property: possible values and behavior

**DESCRIPTION**: Configure how the filter field appears in the filter bar / Adapt Filters dialog using the "availability" property. Default is "Default".

**LANGUAGE**: JSON (examples)

**CODE**:
```json
// "availability" possible values:
{
  "Default": "Filter field is shown in the filter bar by default (and its visual filter, if defined).",
  "Adaptation": "Filter field is initially not shown in the filter bar, available under Adapt Filters only.",
  "Hidden": "Filter field is not visible in the filter bar nor in the Adapt Filters dialog."
}
```

**STEP**: 4 — Ensure aggregation is enabled for the valueList entity

**DESCRIPTION**: The valueList entity referenced by visualFilter.valueList must be enabled for aggregation in the back end. Aggregation annotations must be defined in the correct place depending on whether the valueList entity is parameterized.

- If the valueList entity is NON-parameterized: define aggregation at the entity set level for visual filters.
- If the valueList entity is PARAMETERIZED: define aggregation at the EntityType level.

See: configuring-charts-653ed0f.md#loio653ed0f4f0d743dbb33ace4f68886c4e__enabling_aggregation_subsection for details.

**LANGUAGE**: Text

**CODE**:
```text
Aggregation placement rules:
- Non-parameterized valueList entity: add aggregation annotations against the EntitySet (value-help entity set).
- Parameterized valueList entity: add aggregation annotations against the EntityType.

Reference: configuring-charts-653ed0f.md#loio653ed0f4f0d743dbb33ace4f68886c4e__enabling_aggregation_subsection
```

**STEP**: 5 — Draft-enabled entities: behavior and restrictions

**DESCRIPTION**: You can use draft-enabled entities for visual filters/charts, but only active data is used. Several technical restrictions and known issues apply — follow these when designing visual filters on draft entities.

**LANGUAGE**: Text

**CODE**:
```text
Draft-enabled entities notes and restrictions:
- Only active (non-draft) data is used for chart/visual filter displays.
- Sorting on virtual properties and measures can fail with CAP Node.js prior to @sap/cds 6.0.0.
- ABAP CDS: aggregation on draft-enabled entities is not supported (SADL limitation on $apply for draft/transactional entities).
Restrictions:
- Donut charts are not supported for draft-enabled visual filters.
- Properties from "associated entity sets" (value-help entity set associations) are not supported.
- Use only Edm.Date, Edm.Time, or Edm.DateTime for line charts; string-based time/date fields are not supported.
- Selection of values outside the chart is enabled only for value help-based fields; not enabled for drop-downs or date/time fields.
- Visual filters inside the Adapt Filters dialog are not supported.
- Visual Filters do not support correct formatting for fiscal periods or string-based dimensions annotated as time-based.
- Path-based UI.Criticality and CriticalityCalculation-based semantic coloring are not supported.
- You cannot configure a visual filter for a field that already has a custom filter defined.
```

**STEP**: 6 — Quick checklist before deploying visual filters

**DESCRIPTION**: Ensure all prerequisites and settings are in place.

**LANGUAGE**: Text

**CODE**:
```text
Checklist:
- ValueList annotations exist and map filter field -> value-help entity with measure/dimension.
- manifest.json contains settings.controlConfiguration["@com.sap.vocabularies.UI.v1.SelectionFields"] with layout, initialLayout, and filterFields entries.
- visualFilter.valueList points to correct annotation/entity.
- Aggregation annotations are defined in the right location (EntitySet vs EntityType) for the valueList entity.
- Filter field accepts single or multiple values (not range).
- Semantic dates are not used.
- Verify draft-related restrictions if using draft-enabled entities.
```
--------------------------------

**TITLE**: Configuring View Switch for OVPCards (Fiori Elements)

**INTRODUCTION**: Configure a drop-down view switch for an OVPCard to let users switch/filter card data. Use either a single entitySet with multiple tabs or multiple entitySets per tab. Place configuration inside the card settings (e.g., manifest.json under sap.ovp/cards/<cardId>/settings).

**TAGS**: fiori-elements-framework, ovp, view-switch, card-configuration, manifest.json, annotations

**STEP**: 1 — Rules and placement

**DESCRIPTION**: Where to place the configuration and the high-level options. You can define a view switch in two ways:
- Single entitySet (top-level entitySet in settings) with tabs that reference different annotation paths or filters.
- Multiple entitySets (each tab defines its own entitySet).

Place the JSON under your card settings in the app manifest (example path: "sap.ovp": { "cards": { "<cardId>": { "model": "...", "template": "...", "settings": { ... } } } }).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "<cardId>": {
        "model": "yourModel",
        "template": "sap.ovp.cards.list",
        "settings": {
          /* view-switch configuration goes here */
        }
      }
    }
  }
}
```

**STEP**: 2 — Single entitySet: minimal structure

**DESCRIPTION**: Use a top-level "entitySet" in settings when all tabs use the same backend entity set. Tabs then reference different annotation paths (LineItem, SelectionVariant, PresentationVariant, etc.).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "settings": {
    "entitySet": "SalesOrderSet",
    "tabs": [
      {
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
        "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
        "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line",
        "value": "{{dropdown_value2}}"
      },
      {
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View3",
        "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#SP3",
        "value": "{{dropdown_value3}}"
      }
    ]
  }
}
```

**STEP**: 3 — Multiple entitySets: per-tab entitySet

**DESCRIPTION**: Define entitySet per tab when each tab displays data from a different backend entity set. Each tab may include annotationPath, presentationAnnotationPath, identificationAnnotationPath, dataPointAnnotationPath, selectionAnnotationPath, dynamicSubtitleAnnotationPath, and a value label for the dropdown.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "settings": {
    "tabs": [
      {
        "entitySet": "SalesOrderSet",
        "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
        "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
        "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line",
        "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
        "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
        "value": "{{dropdown_value2}}"
      },
      {
        "entitySet": "SalesOrderSet",
        "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View3",
        "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#SP3",
        "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
        "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
        "value": "{{dropdown_value3}}"
      },
      {
        "entitySet": "ProductSet",
        "annotationPath": "com.sap.vocabularies.UI.v1.LineItem",
        "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#identify1",
        "value": "{{dropdown_value1}}"
      }
    ]
  }
}
```

**STEP**: 4 — Full card example (complete context)

**DESCRIPTION**: Example of a complete card configuration (card ID: card009). Copy this structure into your manifest (sap.ovp.cards.card009) and adjust annotation paths, entitySets, and value labels to match your OData and annotation model.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "card009": {
    "model": "salesOrder",
    "template": "sap.ovp.cards.list",
    "settings": {
      "title": "Contract Monitoring",
      "subTitle": "Per Supplier",
      "valueSelectionInfo": "Total contract volume",
      "listFlavor": "bar",
      "listType": "extended",
      "showLineItemDetail": true,
      "tabs": [
        {
          "entitySet": "SalesOrderSet",
          "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
          "value": "{{dropdown_value2}}"
        },
        {
          "entitySet": "SalesOrderSet",
          "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View3",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#SP3",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
          "value": "{{dropdown_value3}}"
        },
        {
          "entitySet": "ProductSet",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#identify1",
          "value": "{{dropdown_value1}}"
        }
      ]
    }
  }
}
```

**STEP**: 5 — Extending behavior and custom reactions

**DESCRIPTION**: To react to filter conditions or implement custom behavior when the dropdown changes, extend the view switch as needed. See the extension guide for examples and implementation details.

**LANGUAGE**: Markdown

**CODE**:
```markdown
See: Extending Custom View Switch — extending-custom-view-switch-ecd9f10.md
```
--------------------------------

**TITLE**: Confirmation Popups — Configuration and 412 Handling for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: This document gives concise, developer-focused configuration and code examples to:
- Enable/disable draft-discard confirmation popups,
- Configure and disable 412 (Precondition Failed) confirmation flows,
- Suppress repeated backend warning messages after confirmation,
- Provide i18n keys to customize dialog titles.
Examples cover manifest.json settings (v2 and v4), annotation-level action settings, runtime invocation, and the client-server request flow (Prefer header).

**TAGS**: fiori-elements, manifest.json, 412, draft, confirmation, sap.fe, OData, ODataV2, ODataV4, i18n, JavaScript, annotations

STEP: 1 — 412 Confirmation Flow (client + server pattern)

DESCRIPTION: When an action is executed with strict handling, the client sends the request with the header Prefer: handling=strict. If the backend responds HTTP 412 with a warning message, the UI shows a confirmation dialog with that message. If the user confirms, the client resends the same request without the Prefer header. If the user cancels, the operation is aborted.

LANGUAGE: JavaScript

CODE:
```JavaScript
// Example client request pattern for actions that may return 412 warnings
// 1) Initial request: include Prefer: handling=strict to ask backend to block and return warnings
fetch("/odata/service/EntitySet(key)/$action", {
  method: "POST",
  headers: {
    "Content-Type": "application/json",
    "Prefer": "handling=strict" // ask backend to return 412 if warnings exist
  },
  body: JSON.stringify({ /* action payload */ })
})
.then(async response => {
  if (response.status === 412) {
    // Parse backend message and display confirmation popup to user
    const message = await response.json(); // backend OData error payload
    // Show dialog to user with message; if user confirms:
    // 2) Resend request WITHOUT the Prefer header to force execution despite warnings
    return fetch("/odata/service/EntitySet(key)/$action", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
        // Prefer header removed here on confirmation
      },
      body: JSON.stringify({ /* same action payload */ })
    });
  }
  return response;
})
.then(finalResponse => {
  // Handle success or failure normally
})
.catch(err => {
  // Handle network / unexpected errors
});
```

STEP: 2 — Turn off Draft Activation Confirmation for External Navigation (OData V2)

DESCRIPTION: For SAP Fiori elements OData V2 (sap.ui.generic.app), configure draftDiscardConfirmationSettings to limit or disable the draft-discard confirmation popup shown on external navigation.

LANGUAGE: JSON

CODE:
```JSON
// manifest.json (OData V2 - sap.ui.generic.app)
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "draftDiscardConfirmationSettings": {
        "enabled": "restricted" // values: true | false | "restricted"
      }
    }
  }
}
```

STEP: 3 — Legacy: Show Confirmation on Draft Activate (Object Page)

DESCRIPTION: Legacy configuration: enable a UI confirmation popup before draft activation when frontend warnings exist. This is not recommended—prefer 412-based flow.

LANGUAGE: JSON

CODE:
```JSON
// manifest.json - legacy object page setting to show confirmation before activation
{
  "sap.ui5": {
    "models": { /* ... */ }
  },
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "showRelatedApps": true,
            "tableType": "ResponsiveTable",
            "editableHeaderContent": true,
            "showConfirmationOnDraftActivate": true,
            "sections": {
              "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
                "navigationProperty": "to_ProductText",
                "entitySet": "STTA_C_MP_ProductText",
                "multiSelect": true,
                "createMode": "inline",
                "tableType": "ResponsiveTable"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — Turn off Draft Activation Confirmation on External Navigation (OData V4)

DESCRIPTION: For SAP Fiori elements OData V4 (sap.fe), set silentlyKeepDraftOnForwardNavigation to true to skip the draft-discard confirmation during external forward navigation.

LANGUAGE: JSON

CODE:
```JSON
// manifest.json (OData V4 - sap.fe)
{
  "sap.fe": {
    "app": {
      "silentlyKeepDraftOnForwardNavigation": true
    }
  }
}
```

STEP: 5 — Disable 412 Confirmation Popups (Disable Strict Handling) — Global and Action-level

DESCRIPTION: To disable the strict handling behavior that triggers 412 confirmation popups, either disable it globally or per action.

LANGUAGE: JSON

CODE:
```JSON
// 1) Global disable strict handling (OData V4 + sap.fe)
{
  "sap.fe": {
    "app": {
      "disableStrictHandling": true
    }
  }
}

// 2) Disable strict handling for a specific action in a table (annotation section)
{
  "@com.sap.vocabularies.UI.v1.LineItem": {
    "actions": {
      "DataFieldForAction::YourActionWith412Handling": {
        "disableStrictHandling": true
      }
    }
  }
}

// 3) Disable strict handling for a header action on an object page
{
  "content": {
    "header": {
      "actions": {
        "DataFieldForAction::YourActionWith412Handling": {
          "disableStrictHandling": true
        }
      }
    }
  }
}
```

STEP: 6 — Disable Strict Handling via Runtime API (invokeAction)

DESCRIPTION: You can disable strict handling per invocation at runtime by passing disableStrictHandling: true to the editFlow.invokeAction API.

LANGUAGE: JavaScript

CODE:
```JavaScript
// Example: invoking an action and disabling strict handling programmatically
this.base.editFlow.invokeAction("com.c_salesordermanage_sd.EntityContainer/message412", {
  contexts: context,                   // binding contexts to target
  model: this.base.getView().getModel(),
  disableStrictHandling: true         // do not use Prefer: handling=strict for this call
})
.then(result => {
  // handle result
})
.catch(err => {
  // handle error
});
```

STEP: 7 — Suppression Criteria for Repeated Backend Messages (OData V2 and V4)

DESCRIPTION: After a user confirms a 412 warning, subsequent identical messages are suppressed in the UI. The comparison attributes differ between OData V2 and V4.

LANGUAGE: JSON

CODE:
```JSON
// OData V2: messages are considered equal if all these match:
{
  "equalityAttributes_V2": [
    "code",
    "message",
    "severity",
    "target",          // equal if resolves to same model element
    "transition"       // absent => considered true
  ]
}

// OData V4: messages are considered equal if all these match:
{
  "equalityAttributes_V4": [
    "code",
    "message",
    "numericSeverity",
    "longtextUrl",     // equal if both null or absent; URL may contain variables not in message
    "target",          // and additionalTargets: equal if resolve to same model elements
    "additionalTargets",
    "transition"       // absent => considered true
  ]
}
```

STEP: 8 — Backend Requirements & Restrictions for 412 Handling

DESCRIPTION: Server must return HTTP 412 with appropriate message(s) when warnings block processing. Use transition messages for save/delete/function-import actions (see restrictions). Known restrictions listed.

LANGUAGE: PlainText

CODE:
```
// Backend rules and restrictions (summary):
// - Return HTTP 412 "Precondition Failed" with messages to trigger confirmation popup.
// - For activation: 412 can be a state message or transition message (V2 note).
// - For save, delete, function imports: must return 412 as transition messages (not state).
// - Deletion behavior: 412 confirmation handling is NOT applied when a record is deleted (V4).
// - Restriction for CAP backends: 412 handling can fail if actions are executed with
//   InvocationGrouping = UI.OperationGroupingType/Isolated (changeset grouping may prevent per-context handling).
// - UI restriction (V2): You cannot configure 412 confirmation popups for a deletion triggered from a table on an object page.
// - Multi-selection: If some selected items produce warnings, the bulk action fails and the user must act on individual items.
```

STEP: 9 — i18n Keys to Override Confirmation Titles and Buttons

DESCRIPTION: Override the dialog title text for create/edit draft confirmation and for primary button text via i18n properties.

LANGUAGE: properties

CODE:
```properties
# i18n.properties - override title and button texts
ST_KEEP_DRAFT_MESSAGE_CREATE = Your custom title for Create mode dialog
ST_KEEP_DRAFT_MESSAGE_EDIT = Your custom title for Edit mode dialog

# Primary button labels
CREATE = MyCreateLabel
SAVE = MySaveLabel
```


--------------------------------

**TITLE**: Contact Facet (Communication.Contact) — Fiori Elements OData V2 & V4 Examples

**INTRODUCTION**: Provide ready-to-use annotation examples to enable a quick-view contact in a header form facet using the Communication.Contact annotation. Includes OData V2 and V4 XML annotations, ABAP CDS examples, and CAP CDS examples. Use UI.DataFieldForAnnotation pointing to an entity navigation property that references an entity annotated with Communication.Contact. Label is taken from the DataFieldForAnnotation and the displayed value from the contact's fn property.

**TAGS**: Communication.Contact, Contact Facet, UI.DataFieldForAnnotation, Fiori Elements, OData V2, OData V4, ABAP CDS, CAP CDS, XML

STEP: 1 — Minimal mapping concept (XML)
DESCRIPTION: Map a header facet field to a contact annotation on a related entity using UI.DataFieldForAnnotation. Label comes from the DataFieldForAnnotation and the displayed value from the contact's fn.
LANGUAGE: XML
CODE:
```xml
<Record Type="UI.DataFieldForAnnotation">
    <PropertyValue Property="Label" String="Supplier [ContactQV]"/>
    <PropertyValue Property="Target" AnnotationPath="to_Supplier/@Communication.Contact"/>
    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
</Record>
```

STEP: 2 — OData V2: Contact link (ABAP CDS)
DESCRIPTION: ABAP CDS field group example that declares an element as a contact in the header using type #AS_CONTACT and label/value mapping.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [
  {
    importance: #HIGH,
    label: 'Supplier [ContactQV]',
    value: '_SUPPLIER',
    type: #AS_CONTACT,
    position: 40 ,
    qualifier: 'GeneralInformationForHeader'
  }
]
MANAGER;
```

STEP: 3 — OData V2: Popover (XML Communication.Contact)
DESCRIPTION: Define the Contact popover details (fn, email, phone) for the related entity using Communication.Contact; include types and paths to fields in the entity.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="Communication.Contact">
  <Record>
    <PropertyValue Property="fn" Path="CompanyName"/>
    <PropertyValue Property="email">
      <Collection>
        <Record>
          <PropertyValue Property="type" EnumMember="Communication.ContactInformationType/work"/>
          <PropertyValue Property="address" Path="EmailAddress"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="tel">
      <Collection>
        <Record>
          <PropertyValue Property="type" EnumMember="Communication.PhoneType/preferred Communication.PhoneType/work"/>
          <PropertyValue Property="uri" Path="PhoneNumber"/>
        </Record>
        <Record>
          <PropertyValue Property="type" EnumMember="Communication.PhoneType/fax"/>
          <PropertyValue Property="uri" Path="FaxNumber"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 4 — OData V2: Popover (ABAP CDS)
DESCRIPTION: ABAP CDS field definitions annotated for semantics used by Communication.Contact (name, email, phone).
LANGUAGE: ABAP CDS
CODE:
```abap
define view VIEWNAME
{
  @Semantics.name.fullName: true
  CompanyName,

  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK]
  EmailAddress,

  @Semantics.telephone.type:  [ #CELL ] 
  PhoneNumber,

  @Semantics.telephone.type: [ #FAX ]
  FaxNumber,
}
```

STEP: 5 — OData V4: FieldGroup with DataFieldForAnnotation (XML)
DESCRIPTION: Example UI.FieldGroup that includes a DataFieldForAnnotation targeting a contact annotation on a related entity for the header facet.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="OrderData">
  <Record Type="UI.FieldGroupType">
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataFieldWithNavigationPath">
          <PropertyValue Property="Label" String="Referenced Sales Order"/>
          <PropertyValue Property="Value" Path="_ReferencedSalesOrder/SalesOrder"/>
          <PropertyValue Property="Target" NavigationPropertyPath="SalesOrderManage"/>
        </Record>
        <Record Type="UI.DataFieldForAnnotation">
          <PropertyValue Property="Target" AnnotationPath="_SoldToParty/@Communication.Contact"/>
          <PropertyValue Property="Label" String="Sold-To-Party"/>
        </Record>
        <!-- Additional DataField records omitted for brevity -->
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 6 — OData V4: FieldGroup (ABAP CDS)
DESCRIPTION: ABAP CDS equivalent using @UI.fieldGroup entries: declare the contact element with type #AS_CONTACT and qualifier for the header field group.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [
  {
    value: '_SOLDTOPARTY',
    label: 'Sold-To-Party',
    type: #AS_CONTACT,
    position: 20 ,
    qualifier: 'OrderData'
  }
]
_SOLDTOPARTY;
```

STEP: 7 — OData V4: FieldGroup (CAP CDS)
DESCRIPTION: CAP CDS UI.FieldGroup equivalent that includes a DataFieldForAnnotation-style entry targeting Communication.Contact.
LANGUAGE: CDS
CODE:
```cds
UI.FieldGroup #OrderData : {
  $Type : 'UI.FieldGroupType',
  Data : [
    {
      $Type : 'UI.DataFieldWithNavigationPath',
      Label : 'Referenced Sales Order',
      Value : _ReferencedSalesOrder.SalesOrder,
      Target : SalesOrderManage
    },
    {
      $Type : 'UI.DataFieldForAnnotation',
      Target : '_SoldToParty/@Communication.Contact',
      Label : 'Sold-To-Party'
    },
    {
      $Type : 'UI.DataField',
      Value : PurchaseOrderByCustomer,
      ![@UI.Importance] : #High
    }
    /* Additional entries omitted */
  ]
}
```

STEP: 8 — OData V4: Popover (XML Communication.Contact)
DESCRIPTION: Define the contact popover structure for OData V4 including address (adr), email, fn, tel, and photo; use record types for Communication.ContactType and subtypes.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="Communication.Contact">
  <Record Type="Communication.ContactType">
    <PropertyValue Property="adr">
      <Collection>
        <Record Type="Communication.AddressType">
          <PropertyValue Property="type" EnumMember="Communication.ContactInformationType/work"/>
          <PropertyValue Property="uri" Path="InternationalPhoneNumber"/>
          <PropertyValue Property="code" Path="PostalCode"/>
          <PropertyValue Property="country" Path="Country"/>
          <PropertyValue Property="locality" Path="CityName"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="email">
      <Collection>
        <Record Type="Communication.EmailAddressType">
          <PropertyValue Property="type" EnumMember="Communication.ContactInformationType/work"/>
          <PropertyValue Property="address" Path="EmailAddress"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="fn" Path="CustomerName"/>
    <PropertyValue Property="tel">
      <Collection>
        <Record Type="Communication.PhoneNumberType">
          <PropertyValue Property="type" EnumMember="Communication.PhoneType/fax"/>
          <PropertyValue Property="uri" Path="InternationalPhoneNumber"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="photo" Path="CustomerImg"/>
  </Record>
</Annotation>
```

STEP: 9 — OData V4: Popover (ABAP CDS)
DESCRIPTION: ABAP CDS view fields annotated for semantics used by Communication.Contact: full name, email, phone, address parts, and contact photo.
LANGUAGE: ABAP CDS
CODE:
```abap
define view VIEWNAME
{
  @Semantics.name.fullName: true
  CustomerName,

  @Semantics.eMail.address: true
  @Semantics.eMail.type:  [#WORK]
  EmailAddress,

  @Semantics.telephone.type:  [ #FAX ] 
  InternationalPhoneNumber,

  @Semantics.address : { zipCode: true } 
  PostalCode,

  @Semantics.address : { country: true } 
  Country,

  @Semantics.address : { city: true }  
  CityName,

  @Semantics.contact.photo: true
  CustomerImg
}
```

STEP: 10 — OData V4: Popover (CAP CDS)
DESCRIPTION: CAP CDS representation of Communication.Contact with adr, email, fn, tel, and photo referencing entity fields.
LANGUAGE: CDS
CODE:
```cds
Communication.Contact : {
  $Type : 'Communication.ContactType',
  adr : [
    {
      $Type : 'Communication.AddressType',
      type : #work,
      uri : InternationalPhoneNumber,
      code : PostalCode,
      country : Country,
      locality : CityName
    }
  ],
  email : [
    {
      $Type : 'Communication.EmailAddressType',
      type : #work,
      address : EmailAddress
    }
  ],
  fn : CustomerName,
  tel : [
    {
      $Type : 'Communication.PhoneNumberType',
      type : #fax,
      uri : InternationalPhoneNumber
    }
  ],
  photo : CustomerImg
},
```

STEP: 11 — Related Link
DESCRIPTION: Reference documentation for further details on Adding a Contact Facet.
LANGUAGE: Text
CODE:
```
Adding a Contact Facet: adding-a-contact-facet-a6a8c0c.md
```
--------------------------------

**TITLE**: Controlling Editability of Child-Entity Sections (OData V4)

**INTRODUCTION**: Configure whether fields that originate from a child entity (displayed in tables, object pages, or subobject pages) are editable. Applies to SAP Fiori elements for OData V4 only. Use UpdateRestrictions and NavigationRestrictions annotations (Boolean or path-based) to control editability. Prefer path-based Updatable for draft/active scenarios.

**TAGS**: fiori-elements, odata-v4, annotations, UpdateRestrictions, NavigationRestrictions, CAP, XML, CDS

STEP: Prerequisites and overview
DESCRIPTION: Ensure your app is OData V4. UpdateRestrictions on the child entity controls whether fields from that entity can be edited. UpdateRestrictions on the main/list entity is ignored for fields originating from that main entity. NavigationRestrictions on the parent entity can block child record edits. Use path-based Updatable when you need different behavior for draft vs. active records.
LANGUAGE: Text
CODE:
```text
Applicable context:
- SAP Fiori elements (OData V4)
- Annotations can be provided in local XML annotation files (e.g., annotations.xml) or CAP CDS files (model.cds).
Note:
- No ABAP CDS samples are provided here; use XML or CAP CDS annotations where ABAP CDS is not available.
```

STEP: Make all fields of a child entity editable (static Boolean)
DESCRIPTION: Add Capabilities.UpdateRestrictions with Updatable = true for the target entity. Place this in your local annotation file (e.g., annotations.xml) or annotate the CAP CDS entity.
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations.xml (local annotations) -->
<Annotations Target="com.c_salesordermanage_sd.MaterialCategory">
     <Annotation Term="Capabilities.UpdateRestrictions">
          <Record Type="Capabilities.UpdateRestrictionsType">
               <PropertyValue Property="Updatable" Bool="true"/>
          </Record>
     </Annotation>
</Annotations>
```

LANGUAGE: CDS
CODE:
```c
-- File: model.cds (CAP CDS)
annotate c_salesordermanage_sd.MaterialCategory with @Capabilities : {
    UpdateRestrictions : { Updatable : true }
};
```

STEP: Prevent edits to child navigation property via parent NavigationRestrictions
DESCRIPTION: On the parent entity set, set NavigationRestrictions.RestrictedProperties for the navigation property and set an UpdateRestrictions.Updatable = false. This prevents editing of child records even if the child's UpdateRestrictions implies editable.
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations.xml (local annotations) -->
<Annotation Term="Capabilities.NavigationRestrictions">
     <Record Type="Capabilities.NavigationRestrictionsType">
          <PropertyValue Property="RestrictedProperties">
               <Collection>
                    <Record Type="Capabilities.NavigationPropertyRestriction">
                         <PropertyValue Property="NavigationProperty" NavigationPropertyPath="_MaterialDetails"/>
                         <PropertyValue Property="UpdateRestrictions">
                              <Record Type="Capabilities.UpdateRestrictionsType">
                                   <PropertyValue Property="Updatable" Bool="false"/>
                              </Record>
                         </PropertyValue>
                    </Record>
               </Collection>
          </PropertyValue>
     </Record>
</Annotation>
```

LANGUAGE: CDS
CODE:
```c
// File: model.cds (CAP CDS)
entity SalesOrderItem @(
    Capabilities : {
        NavigationRestrictions : {
            RestrictedProperties : [{
                NavigationProperty : _MaterialDetails,
                UpdateRestrictions     : { Updatable : false }
            }]
        }
    }
);
```

STEP: Use a path-based Updatable (recommended for draft vs active behavior)
DESCRIPTION: Use a boolean property path (e.g., isUpdatable) instead of a static Bool to allow conditional editability (e.g., true for draft records, false for activated records). Provide the path in UpdateRestrictions.Updatable. This ensures newly created drafts remain editable while preventing edits after activation.
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations.xml (local annotations) -->
<Annotations Target="com.c_salesordermanage_sd_aggregate.MaterialDetails">
     <Annotation Term="Capabilities.UpdateRestrictions">
          <Record Type="Capabilities.UpdateRestrictionsType">
               <PropertyValue Property="Updatable" Path="isUpdatable"/>
          </Record>
     </Annotation>
</Annotations>
```

LANGUAGE: CDS
CODE:
```c
// File: model.cds (CAP CDS)
annotate MaterialDetails with @(
    Capabilities.UpdateRestrictions : {
        Updatable : isUpdatable
    }
);
```

STEP: Important behavior notes and recommendations
DESCRIPTION: Preserve these rules when implementing:
- UpdateRestrictions on the main entity set is ignored for fields originating from that main entity (use other mechanisms for main entity editability).
- If a parent entity's NavigationRestrictions.Updatable = false, child records cannot be edited regardless of child's UpdateRestrictions.
- If NavigationRestrictions has Updatable = true or a path, child editability depends on the child's UpdateRestrictions.
- Static Updatable = false blocks updates for both draft and active records. To allow editing of draft copies created but not yet activated, use a path-based Updatable (e.g., isUpdatable) that evaluates true for drafts and false after activation.
- Field editability also depends on the UI edit state and property FieldControl; if the list report entity set is not updatable, fields cannot be edited even if child UpdateRestrictions evaluates true.
LANGUAGE: Text
CODE:
```text
Images illustrating behavior (reference only):
- images/UpdateRestrictions1_9616035.png  (Warranty Expiration remains read-only)
- images/UpdateRestrictions2_b3a0021.png  (Material Reviews fields read-only)

No ABAP CDS samples provided — use XML local annotations or CAP CDS annotations shown above.
```
--------------------------------

**TITLE**: Copying and Pasting from External Applications into Editable Fiori Elements Tables

**INTRODUCTION**: This reference describes end-user actions, supported scenarios, limitations, and the exact manifest.json configuration for enabling or disabling copy/paste in SAP Fiori elements editable tables (OData V2/V4). Use this as a developer and agent-oriented checklist to implement or control paste behavior and to generate example data (spreadsheet) for pasting.

**TAGS**: fiori-elements, paste, copy, table, manifest.json, ODataV2, ODataV4, smart-table, grid-table, responsive-table, inline-creation

STEP: 1 — Supported paste scenarios (summary)
DESCRIPTION: Quick reference for which paste scenarios are supported and the required conditions.
LANGUAGE: Text
CODE:
```text
- Table-level paste:
  - Action: Paste creates new row(s) from clipboard data.
  - Requirements:
    - App must be draft-enabled (for new row creation).
    - Table creation mode must be "inline" or "creationRows".
    - Trigger: focus anywhere on the table, select an empty row, press CTRL+V (Win) or CMD+V (macOS), or click the Paste icon.
  - Behavior:
    - New rows are created only in draft-enabled apps and supported creation modes.
    - All new rows created during the paste are sent in a single POST batch call.

- Cell-level paste:
  - Action: Paste replaces or fills values in one or more selected cells (or creates new rows if an empty row is included).
  - Requirements:
    - Supported only for GridTable and ResponsiveTable.
    - Select a single cell or a contiguous group of cells before pasting.
  - Behavior:
    - Active/draft rows are updated in place.
    - Empty rows in selection will receive pasted rows.
```

STEP: 2 — End-user interactions and controls
DESCRIPTION: How end users perform copy/paste and what UI elements appear.
LANGUAGE: Text
CODE:
```text
- Copy button: shown in table toolbar by default (Export/Copy controls available).
- Paste icon: displayed only when the table supports paste.
- Keyboard shortcuts:
  - Windows: CTRL + V
  - macOS: CMD + V
- Export to Spreadsheet:
  - Use Export to Spreadsheet to generate a sample spreadsheet with split cells (recommended for preparing data for paste).
  - Export availability: On object page, Export to Spreadsheet is available by default only if copy/paste is enabled.
```

STEP: 3 — Behavioral details and limitations (developer & UX notes)
DESCRIPTION: Important functional constraints and backend considerations to capture in code, tests, and documentation.
LANGUAGE: Text
CODE:
```text
- Supported field types: only simple data fields. NOT supported: links, images, connected fields, multi-input, field groups, navigation properties.
- ID + text fields: pasting updates the property value immediately; the text description is updated only after save.
- Validation: client-side paste checks basic type alignment only (OData V4 front end verifies type). Validation errors are shown in a dialog; backend must implement strict validation.
- POST batching: all new rows created by a paste are included in a single POST batch; POST duration increases with row count.
- Row order: order of pasted rows may differ from original source order after insertion — this behavior is not controlled by Fiori elements.
- Not supported: paste in custom tables.
- Read-only columns: ignored during paste but are included when exporting to spreadsheet (to preserve format for pasting).
- Inline-action columns: ignored by paste operation — omit them from the source spreadsheet when copying (OData V2 + V4).
- Navigation properties: cannot paste content into a cell bound to a navigation property.
```

STEP: 4 — Additional notes for OData V2
DESCRIPTION: Differences to consider when using OData V2 smart tables.
LANGUAGE: Text
CODE:
```text
- Smart table with inline actions:
  - Paste ignores columns that contain inline actions — these columns must be omitted in the spreadsheet source.
- Read-only columns are exported but ignored by the paste operation.
- Use exported spreadsheet with split cells to prepare input where columns representing inline actions are left out or kept empty.
```

STEP: 5 — Additional notes for OData V4
DESCRIPTION: Differences and recommended actions for Object Page and table configuration in OData V4.
LANGUAGE: Text
CODE:
```text
- Default behavior:
  - On the Object Page, paste is enabled by default if creation mode is set to "inline" or "emptyRow".
- textArrangement annotation:
  - Properties annotated with com.sap.vocabularies.UI.v1.TextArrangement = "TextOnly" cannot be pasted.
- Backend validation:
  - Front end verifies type alignment only. It does not enforce editability rules or fixed-value list validation — these checks must be implemented server-side.
- To create a sample spreadsheet for paste format:
  - Export the table using "split cell mode" to see the expected per-column layout. Keep placeholders for inline-action columns (they can be empty).
```

STEP: 6 — Developer configuration: enable/disable paste in manifest.json
DESCRIPTION: Exact manifest.json snippet to disable or explicitly enable paste for a specific table control configuration. Place this in webapp/manifest.json under the Component options -> settings -> controlConfiguration key (target key depends on the LineItem annotation path or control id you configure).
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "componentUsages": {},
    "models": {},
    "routing": {},
    "resources": {},
    "rootView": {},
    "config": {},
    "dependencies": {}
  },
  "sap.fe": {
    "applications": {}
  },
  "sap.app": {},
  "options": {
    "settings": {
      "controlConfiguration": {
        "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
          "tableSettings": {
            "type": "GridTable",
            "enablePaste": false,
            "condensedTableLayout": true,
            "personalization": {
              "column": true,
              "sort": false
            },
            "creationMode": {
              "name": "Inline"
            }
          }
        }
      }
    }
  }
}
```

STEP: 7 — Quick checklist before enabling paste in an app
DESCRIPTION: Practical tasks to validate when enabling/publishing paste functionality.
LANGUAGE: Text
CODE:
```text
- Confirm the table type: GridTable or ResponsiveTable for cell-level paste.
- Confirm draft-enabled behavior for table-level paste (OData draft).
- Set creationMode to "Inline" or "EmptyRow" where new rows should be created by paste.
- Ensure backend validation endpoints can validate and return clear validation errors for pasted rows.
- Test exporting to spreadsheet (split cell mode) and test pasting back the exported file contents.
- Omit inline-action columns from spreadsheet when copying from Excel (V2/V4).
- Document in UI/help that only simple fields are supported and navigation properties cannot be pasted into.
```

STEP: 8 — Links and related files
DESCRIPTION: Reference to related docs and file paths you may need while implementing/testing.
LANGUAGE: Text
CODE:
```text
- Example manifest location: webapp/manifest.json (component configuration under "options" -> "settings" -> "controlConfiguration").
- Related docs:
  - Using the Export Button: using-the-export-button-4bab6f2.md
  - Tables and range/copy behavior: tables-c0f6592.md#loioc0f6592a592e47f9bb6d09900de47412__section_pth_3mb_dzb
  - Enabling Inline Creation Mode or Empty Row Mode for Table Entries (OData V4): enabling-inline-creation-mode-or-empty-row-mode-for-table-entries-cfb04f0.md
```
--------------------------------

**TITLE**: Configure Create Mode to Launch an External Fiori Launchpad App (OData V4)

**INTRODUCTION**: Configure the Create button in a SAP Fiori elements table/list report so it launches an external SAP Fiori launchpad target application. This is applicable only to SAP Fiori elements for OData V4. The approach uses the creationMode "External" in the control configuration and an outbound definition in the app manifest to specify semantic object, action, and optional parameters.

**TAGS**: fiori-elements, odata-v4, manifest.json, crossNavigation, external-navigation, create-mode, sap.app

**STEP**: 1 — Enable Create as External and reference an outbound

**DESCRIPTION**: In your manifest.json, set the table control's creationMode to External and set the outbound name. The outbound value is a key that must match an outbound entry under "sap.app" → "crossNavigation" → "outbounds". This snippet shows the controlConfiguration fragment that adds the External creation behavior for the LineItem table control.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (fragment)
"controlConfiguration": {
    "/@com.sap.vocabularies.UI.v1.LineItem": {
        "tableSettings": {
            "creationMode": {
                "name": "External",
                "outbound": "MyExternalApp"
            }
        }
    }
}
```

**STEP**: 2 — Define the outbound target with mandatory semanticObject and action; add optional parameters

**DESCRIPTION**: Add an outbound entry under "sap.app" → "crossNavigation" → "outbounds" with the same key used in the creationMode outbound (here "MyExternalApp"). The outbound must include "semanticObject" and "action" (mandatory). Add any additional parameters to be passed to the target app. The example below defines an outbound with one extra parameter "MyParam" (value "myValue" formatted as plain). The navigation will include the source context automatically when triggered.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (fragment)
"sap.app": {
    "id": "DraftsManage",
    "type": "application",
    ...
    "crossNavigation": {
        "outbounds": {
            "MyExternalApp": {
                "semanticObject": "mySemanticObject",
                "action": "myAction",
                "parameters": {
                    "MyParam": {
                        "value": {
                            "value": "myValue",
                            "format": "plain"
                        }
                    }
                }
            }
        }
    }
}
```

**STEP**: 3 — Key requirements and behavior

**DESCRIPTION**: Summary of rules to enforce when generating or editing manifest configuration:
- Applicable only for SAP Fiori elements OData V4.
- The creationMode "External" must reference an outbound key that exists under "sap.app" → "crossNavigation" → "outbounds".
- Each outbound must include "semanticObject" and "action" (mandatory) to ensure correct FLP navigation.
- Any additional parameters defined in the outbound are forwarded to the target application.
- The source application’s context is provided automatically during navigation; do not attempt to re-encode context as a parameter unless required by the target.

**LANGUAGE**: JSON

**CODE**:
```json
// Validation checklist (manifest.json)
{
  "controlConfiguration": {
    "/@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "creationMode": { "name": "External", "outbound": "<outboundKey>" }
      }
    }
  },
  "sap.app": {
    "crossNavigation": {
      "outbounds": {
        "<outboundKey>": {
          "semanticObject": "<semanticObject>", // required
          "action": "<action>",               // required
          "parameters": { /* optional params */ }
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Configure Create Mode on the Object Page (Fiori elements)

**INTRODUCTION**: Short actionable guide showing where and how to configure the Object Page create modes (Inline, InlineCreationRows, Create page, Create dialog, External). Includes manifest.json snippets and notes about OData V4 requirements. Use these snippets as drop-in examples—replace entitySet names, URLs and values with your app specifics.

**TAGS**: fiori-elements-framework, object-page, create-mode, inline-creation, dialog, external-app, odata-v4, manifest.json

STEP: Overview — Create mode options and where to configure them
DESCRIPTION: The Object Page supports multiple creation flows. Configure the desired flow in the app descriptor (manifest.json) for the Object Page / List Report page definition or in the table/list settings that are part of the page configuration. Common create mode values: Inline, InlineCreationRows, Page (default when navigation is available), Dialog (OData V4 only), External.
LANGUAGE: JSON
CODE:
```JSON
{
  // Example location: manifest.json -> "sap.ui.generic.app" -> "pages" (or the page definition for your entity)
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "YourEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        },
        "settings": {
          // configure the createMode for this page or its table using one of:
          // "Inline" | "InlineCreationRows" | "Page" | "Dialog" | "External"
          "createMode": "Page"
        }
      }
    ]
  }
}
```

STEP: Inline / InlineCreationRows — enable inline table creation on the Object Page
DESCRIPTION: Use Inline or InlineCreationRows to allow users to add new rows directly in the table on the object page without navigation. Configure the table settings in the page settings (manifest.json). If your list is defined by a separate tableSettings object, set the creation mode there. Replace "YourEntitySet" and paths with your app structure.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "YourEntitySet",
        "component": { "name": "sap.suite.ui.generic.template.ObjectPage" },
        "settings": {
          // Inline insertion for table rows
          "tableSettings": {
            "creationMode": "Inline"                  // or "InlineCreationRows"
          }
        }
      }
    ]
  }
}
```

STEP: Create Page — navigate to an Object Page for creation (default when navigation available)
DESCRIPTION: The Create Page flow navigates from the list or object page to an object-creation page. This is typically the default when navigation from the table is available. Configure create navigation targets or set createMode to Page in the page settings. Ensure the target page component is the Object Page configured for create use.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "YourEntitySet",
        "component": { "name": "sap.suite.ui.generic.template.ObjectPage" },
        "settings": {
          "createMode": "Page",
          // If your app uses a separate create target, ensure navigation is configured:
          "navigation": {
            "create": {
              "target": "YourCreateObjectPage"   // example target page id
            }
          }
        }
      }
    ]
  }
}
```

STEP: Create Dialog — open a dialog for object creation (OData V4 only)
DESCRIPTION: The Create Dialog opens a dialog for entering values and creating a new object. This mode is supported only by SAP Fiori elements for OData V4. Configure the createMode to "Dialog" in your page settings. Verify your service and annotations are OData V4 compatible.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "YourEntitySet",
        "component": { "name": "sap.suite.ui.generic.template.ObjectPage" },
        "settings": {
          "createMode": "Dialog"    // Dialog creation: OData V4 only
        }
      }
    ]
  }
}
```

STEP: External — delegate creation to an external app (launchpad-based)
DESCRIPTION: Use External when clicking Create should navigate to an external SAP Fiori launchpad-based application that handles object creation. Provide the external URL or semanticObject/action and set createMode to External. Adjust KVPs/semantic object navigation according to your Fiori launchpad configuration.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "YourEntitySet",
        "component": { "name": "sap.suite.ui.generic.template.ObjectPage" },
        "settings": {
          "createMode": "External",
          "externalCreation": {
            // Example options:
            "url": "https://your-launchpad-app-url.example/path",
            // or semantic object navigation:
            "semanticObject": "YourSemanticObject",
            "action": "display"
          }
        }
      }
    ]
  }
}
```

STEP: Notes, validation and references
DESCRIPTION: 
- The Create Dialog mode is supported only for OData V4 in SAP Fiori elements — do not set Dialog for OData V2 services.
- Depending on your Fiori elements version, exact manifest property names/locations may vary. The code blocks above show common locations under "sap.ui.generic.app" -> "pages" -> <page settings>. Adjust to your app descriptor structure.
- For more implementation details and full examples, refer to:
  - Enabling Inline Creation Mode or Empty Row Mode for Table Entries (enabling-inline-creation-mode-or-empty-row-mode-for-table-entries-cfb04f0.md)
  - Enabling Object Creation Using the Dialog on the Object Page (enabling-object-creation-using-the-dialog-on-the-object-page-7fee938.md)
  - Create Mode as an External App (create-mode-as-an-external-app-5c2bc2e.md)
LANGUAGE: Text
CODE:
```Text
- Dialog creation: OData V4 only.
- Replace placeholder values (YourEntitySet, YourCreateObjectPage, URLs, semanticObject/action) with your app specifics.
- Confirm your Fiori elements version and adjust manifest keys accordingly.
```
--------------------------------

**TITLE**: Create or Convert a propertyBindingChange for SAP Fiori elements (OData V2)

**INTRODUCTION**: This document shows how to create a property binding change (propertyBindingChange) for SAP Fiori elements (OData V2) by editing an existing change file or creating a new one. Use property binding when the value must be evaluated at runtime (data model, expression, or i18n). It includes required JSON fields, exact replacements, examples for expression binding and i18n, and constraints.

**TAGS**: fiori-elements-framework, SAP Fiori elements, OData V2, propertyBindingChange, change-file, UI adaptation, Page Editor, JSON

STEP: 1 — Applicability and constraints

DESCRIPTION:
- Applicable only for SAP Fiori elements for OData V2.
- Relevant for use cases such as:
  - Object page: Show header content in edit mode
  - Object page: Show content parts in the header according to a mode
  - Object page: Control visibility of a section
- Constraint: If binding to an OData property, the OData property must belong to the same node or the root node.

LANGUAGE: Text

CODE:
```text
Applicable: SAP Fiori elements (OData V2). Ensure the model property referenced by the binding is already available on the page (retrieved by the model) and belongs to the same node or root node.
```

STEP: 2 — Convert existing propertyChange to propertyBindingChange

DESCRIPTION:
- If you already have a change file of type "propertyChange", replace the changeType and replace "newValue" with "newBinding" in "content".
- "newBinding" must be the binding expression string (e.g., "{myProperty}" or expression binding "{= !${myProperty}}").
- Example below shows the original propertyChange JSON followed by the converted propertyBindingChange JSON.

LANGUAGE: JSON

CODE:
```json
// Original propertyChange (example)
{
  "fileName": "id_1460988346969_256_propertyChange",
  "fileType": "change",
  "changeType": "propertyChange",
  "reference": "STTA_MP.Component",
  "packageName": "$TMP",
  "content": {
    "property": "visible",
    "oldValue": true,
    "newValue": false
  },
  "selector": {
    "id": "STTA_MP::sap.suite.ui.generic.template.ObjectPage.view.Details::STTA_C_MP_Product--action::STTA_PROD_MAN.STTA_PROD_MAN_Entities::STTA_C_MP_ProductCopywithparams",
    "type": "sap.uxap.ObjectPageHeaderActionButton"
  },
  "layer": "CUSTOMER_BASE",
  "texts": {},
  "namespace": "apps/STTA_MP/changes/",
  "creation": "2016-04-18T14:05:47.149Z",
  "originalLanguage": "EN",
  "conditions": {},
  "context": "",
  "support": {
    "generator": "Change.createInitialFileContent",
    "service": "",
    "user": ""
  }
}

// Converted propertyBindingChange (replace changeType and newValue => newBinding)
{
  "fileName": "id_1460988346969_256_propertyChange",
  "fileType": "change",
  "changeType": "propertyBindingChange",
  "reference": "STTA_MP.Component",
  "packageName": "$TMP",
  "content": {
    "property": "visible",
    "oldValue": true,
    "newBinding": "{myProperty}"
  },
  "selector": {
    "id": "STTA_MP::sap.suite.ui.generic.template.ObjectPage.view.Details::STTA_C_MP_Product--action::STTA_PROD_MAN.STTA_PROD_MAN_Entities::STTA_C_MP_ProductCopywithparams",
    "type": "sap.uxap.ObjectPageHeaderActionButton"
  },
  "layer": "CUSTOMER_BASE",
  "texts": {},
  "namespace": "apps/STTA_MP/changes/",
  "creation": "2016-04-18T14:05:47.149Z",
  "originalLanguage": "EN",
  "conditions": {},
  "context": "",
  "support": {
    "generator": "Change.createInitialFileContent",
    "service": "",
    "user": ""
  }
}
```

STEP: 3 — Example binding expressions and use cases

DESCRIPTION:
- Use simple bindings, model-specific bindings, expression bindings, or i18n bindings.
- Examples below show common expressions used on Object Page properties like visible, enabled, and mode.

LANGUAGE: JSON

CODE:
```json
// Simple property binding (boolean property 'myProperty' on default model)
{
  "content": {
    "property": "visible",
    "newBinding": "{myProperty}"
  }
}

// Expression binding: inverse of a boolean property
{
  "content": {
    "property": "visible",
    "newBinding": "{= !${myProperty}}"
  }
}

// Model-specific bindings (UI model flags)
{
  "content": {
    "property": "visible",
    "newBinding": "{ui>/editable}"
  }
}
{
  "content": {
    "property": "visible",
    "newBinding": "{= !${ui>/editable}}"
  }
}
{
  "content": {
    "property": "visible",
    "newBinding": "{ui>/createMode}"
  }
}
{
  "content": {
    "property": "enabled",
    "newBinding": "{ui>/enabled}"
  }
}

// i18n text binding example (use model prefix i18n>)
{
  "content": {
    "property": "text",
    "newBinding": "{i18n>xtol.MoveDown}"
  }
}
```

STEP: 4 — Create a new propertyBindingChange file from scratch

DESCRIPTION:
- If no change file exists, create a new change JSON with required fields.
- Ensure selector identifies the control (id and type). Set namespace/path where change files are stored (example: apps/STTA_MP/changes/).
- Use accurate reference and layer values per your app.

LANGUAGE: JSON

CODE:
```json
{
  "fileName": "id_<unique>_propertyBindingChange",
  "fileType": "change",
  "changeType": "propertyBindingChange",
  "reference": "<YourApp>.Component",
  "packageName": "$TMP",
  "content": {
    "property": "<controlProperty>",   // e.g., "visible", "enabled", "text"
    "oldValue": <oldValue>,            // optional but recommended, e.g., true or ""
    "newBinding": "{<modelOrPropertyBinding>}" // e.g., "{myProperty}" or "{= !${myProperty}}"
  },
  "selector": {
    "id": "<fullyQualifiedControlId>",
    "type": "<sap.ui.control.Type>"    // e.g., "sap.uxap.ObjectPageSection" or "sap.m.Button"
  },
  "layer": "CUSTOMER_BASE",
  "texts": {},
  "namespace": "apps/<your_app>/changes/",
  "creation": "<ISO-8601 timestamp>",
  "originalLanguage": "EN",
  "conditions": {},
  "context": "",
  "support": {
    "generator": "Change.createInitialFileContent",
    "service": "",
    "user": "<user>"
  }
}
```

STEP: 5 — Testing and validation

DESCRIPTION:
- Deploy or load changes via the Page Editor or your adaptation pipeline.
- Verify the model property is available at runtime and the binding resolves correctly.
- For expression bindings, validate expression syntax (e.g., {= !${myProperty}}).
- If binding to i18n, the i18n model key must exist.

LANGUAGE: Text

CODE:
```text
After saving the change file, reload the app/page to confirm the control property is evaluated by the binding. Check console/logs for binding errors and ensure the referenced model/property exists on the same node or root.
```
--------------------------------

**TITLE**: Create a List Report without Variant Management (SAP Fiori elements)

**INTRODUCTION**: Steps and exact code snippets to disable variant management on List Report apps for SAP Fiori elements (OData V2 and V4) and to provide an app-specific title when variant management is hidden. Edit the manifest.json and i18n files in your webapp folder.

**TAGS**: fiori-elements, manifest.json, variant-management, list-report, i18n, ODataV2, ODataV4

**STEP**: OData V2 — Disable variant management in the List Report
**DESCRIPTION**: Edit webapp/manifest.json. Under "sap.ui.generic.app" -> pages[] -> component -> settings set smartVariantManagement = true and variantManagementHidden = true. smartVariantManagement must be true when you want to hide both page and control variants; if variantManagementHidden is used alone it hides only the filter bar variant. When variantManagementHidden = true the standard variant management UI is not available and the app title is shown instead.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "XXXXXX_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "gridTable": false,
            "smartVariantManagement": true,
            "variantManagementHidden": true
          }
        }
      }
    ]
  }
}
```

**STEP**: OData V2 — Provide an app-specific subtitle when variant management is hidden (i18n)
**DESCRIPTION**: Add the key subTitleIfVariantMgmtHidden to your i18n properties file (webapp/i18n/i18n.properties) with the desired text. This key will be referenced from the manifest to display a custom subtitle when variant management is hidden.
**LANGUAGE**: properties
**CODE**:
```properties
#XTIT,40
subTitleIfVariantMgmtHidden = List Report Custom Title
```

**STEP**: OData V2 — Bind the i18n subtitle key into the manifest
**DESCRIPTION**: In webapp/manifest.json, inside the same List Report component settings add the subTitleIfVariantMgmtHidden binding so the subtitle displays when variant management is hidden.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "XXXXXX_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "gridTable": false,
            "smartVariantManagement": true,
            "variantManagementHidden": true,
            "subTitleIfVariantMgmtHidden": "{{subTitleIfVariantMgmtHidden}}"
          }
        }
      }
    ]
  }
}
```

**STEP**: OData V4 — Disable variant management in the List Report target
**DESCRIPTION**: Edit webapp/manifest.json. Under "sap.ui5" -> routing -> targets -> <Your_List_Target> -> options -> settings set "variantManagement": "None". Valid values: "None" (no standard variant management), "Page", "Control". If missing, default behavior applies (Page/Control available).
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "XXXXXX_List": {
          "type": "Component",
          "id": "XXXXXX_List",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/XXXXXX",
              "variantManagement": "None"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: OData V4 — Add an app-specific subtitle in i18n
**DESCRIPTION**: Add a subtitle key (example: appSubTitle) to webapp/i18n/i18n.properties with the desired text to use as the app subTitle when you hide variant management.
**LANGUAGE**: properties
**CODE**:
```properties
#XTIT, 40
appSubTitle = List Report Custom Title
```

**STEP**: OData V4 — Bind the i18n subtitle key into sap.app
**DESCRIPTION**: Edit webapp/manifest.json and set sap.app.subTitle to the i18n binding {{appSubTitle}} so the app displays the custom subtitle.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.app": {
    "id": "XXXXXX",
    "type": "application",
    "i18n": "i18n/i18n.properties",
    "title": "{{title}}",
    "subTitle": "{{appSubTitle}}",
    "description": "{{description}}"
  }
}
```

**NOTE**: For OData V2 use variantManagementHidden together with smartVariantManagement = true to hide both page and control variants. If variantManagementHidden is set alone it hides only the filter bar variant. In OData V4 use "variantManagement": "None" on the target to fully disable standard variant management.
--------------------------------

**TITLE**: Creating a SAP Fiori Elements Project with SAP Fiori Tools

**INTRODUCTION**: Step-by-step, code-focused guidance to create a SAP Fiori elements application using SAP Fiori tools in Visual Studio Code or SAP Business Application Studio. Includes prerequisite checks, extension setup, generator workflow, and the minimal local-run commands and file locations you will use after generation.

**TAGS**: fiori-elements-framework, sap-fiori, sap-fiori-tools, sap-business-application-studio, vscode, generator, odata, manifest.json, webapp

**STEP**: Prerequisites and Environment Setup

**DESCRIPTION**: Ensure your environment meets the baseline requirements. Install Node.js and npm, have Visual Studio Code or SAP Business Application Studio available, and access the SAP Fiori tools extension pack. Verify you have credentials and connectivity to the OData service you will use (if generating a data-connected Fiori elements app).

**LANGUAGE**: Shell / Checklist

**CODE**:
```text
Prerequisites checklist:
- Node.js and npm installed (https://nodejs.org/)
- Visual Studio Code installed OR use SAP Business Application Studio
  - Visual Studio Code: https://code.visualstudio.com/
  - SAP Business Application Studio: https://help.sap.com/docs/SAP_BAS
- SAP Fiori tools (Extension Pack) installed in VS Code OR available in BAS
  - SAP Fiori tools docs: https://help.sap.com/docs/SAP_FIORI_tools
- Access to your backend OData service (URL, credentials, and metadata)
- Optional: Yeoman and generator for CLI-based generation (see official docs)
```

**STEP**: Install SAP Fiori Tools (Visual Studio Code)

**DESCRIPTION**: Install the SAP Fiori tools extension pack in Visual Studio Code to enable the Application Generator wizard. If you use SAP Business Application Studio, ensure the Fiori tools are available in the environment.

**LANGUAGE**: Shell / VS Code UI

**CODE**:
```text
VS Code (UI):
1. Open Extensions view (Ctrl+Shift+X).
2. Search for "SAP Fiori tools" or "SAP Fiori tools - Extension Pack".
3. Install the extension pack and reload VS Code.

VS Code (CLI - example):
# Open VS Code and install from UI, or use:
# code --install-extension <extension-identifier>
# (Use the extension identifier from the marketplace or official docs)
```

**STEP**: Generate a New Fiori Elements App (Application Generator)

**DESCRIPTION**: Launch the SAP Fiori Application Generator from the command palette (VS Code) or the BAS template wizard. Follow the interactive prompts to select template type (Fiori elements), OData service, entity, view type (List, Object Page, etc.), navigation, and project metadata. This step creates the project skeleton (webapp folder, manifest.json, annotations, etc.).

**LANGUAGE**: UI steps / Terminal

**CODE**:
```text
VS Code:
1. Open Command Palette (Ctrl+Shift+P).
2. Type "Fiori" and select "Fiori: Open Application Generator" (or "Open Application Generator") from SAP Fiori tools.
3. Follow prompts:
   - Template type: SAP Fiori elements
   - Project name / namespace / description
   - OData service URL (provide metadata / authentication)
   - Main entity set / entity
   - Floorplan (List Report + Object Page, Overview Page, etc.)
   - Additional options (annotations, navigation, smart controls)

SAP Business Application Studio:
1. Use "Start from template" or the Application Generator tile.
2. Follow the same prompts as listed above.

Result:
- Project folder created with structure:
  <project-root>/
    ├─ webapp/
    │   ├─ manifest.json
    │   ├─ Component.js
    │   └─ ... (views, controller stubs)
    ├─ annotations/ (if generated)
    ├─ package.json
    └─ ui5-local-config or .che/other BAS metadata (depending on environment)
```

**STEP**: Inspect and Edit Project Files

**DESCRIPTION**: After generation, inspect key files to customize the app: manifest.json for routing and data sources, webapp/ Component and view/controller stubs, annotation files, and package.json for scripts and dependencies.

**LANGUAGE**: JSON / File paths

**CODE**:
```text
Key files to edit:
- webapp/manifest.json          -> app descriptor, dataSources, routing, models
- webapp/Component.js           -> component bootstrap
- webapp/localService/ or annotations/ -> OData mock or annotation files
- package.json                  -> dependencies and scripts (npm run start, etc.)
```

**STEP**: Install Dependencies and Run Locally

**DESCRIPTION**: Install npm dependencies created by the generator and start the local dev server. The exact start script may vary depending on the template; commonly use npm install followed by npm start (or ui5 tooling-specific commands).

**LANGUAGE**: Shell

**CODE**:
```bash
# From project root
npm install

# Start local development server (common patterns - check package.json scripts)
npm start          # typical; runs local server and opens preview
# or, if using ui5 tooling directly:
npx ui5 serve --config=ui5-local-config.yaml --open index.html
```

**STEP**: Connect to Real OData Service and Test

**DESCRIPTION**: If you generated the app with a mock OData service or local annotations, switch to your real backend by updating manifest.json dataSources -> uri and configuring authentication (destination in BAS or SAP Cloud SDK / destination service). Test list and object pages for correct entity set binding.

**LANGUAGE**: JSON / Text

**CODE**:
```json
// webapp/manifest.json (example snippet)
{
  "sap.app": {
    "id": "my.namespace.project",
    "title": "My Fiori Elements App"
  },
  "sap.ui5": {
    "models": {},
    "dataSources": {
      "mainService": {
        "uri": "/path/to/odata/service/",   // update to your service URL or destination
        "type": "OData",
        "settings": { "odataVersion": "2.0" }
      }
    }
  }
}
```

**STEP**: Useful File Locations and Next Steps

**DESCRIPTION**: Where to customize after generation and recommended next tasks: add custom controllers, extend templates, add annotation files, or integrate with backend authentication and deployment pipelines.

**LANGUAGE**: Text / File paths

**CODE**:
```text
Common edits after generation:
- Add or modify annotations: <project>/annotations/*.xml or annotations/ folder
- Add custom controller logic: webapp/controller/*.js
- Customize views: webapp/view/*.xml (if applicable)
- Update styles: webapp/style/*.css or use theming parameters

Next tasks:
- Configure destination or authentication for backend OData
- Add tests and linting (eslint)
- Prepare deployment artifacts per your Cloud/On-Premise target
```

**REFERENCES**: Official SAP Fiori tools documentation and generator guide:
- SAP Fiori tools overview & installation: https://help.sap.com/docs/SAP_FIORI_tools
- Generate an application (detailed generator workflow): https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/db44d45051794d778f1dd50def0fa267.html
- Prerequisites for SAP Fiori elements: prerequisites-for-using-sap-fiori-elements-f2344b5.md
--------------------------------

**TITLE**: Create an Extension to Modify Navigation Context Properties (adaptNavigationParameterExtension / adaptNavigationContext)

**INTRODUCTION**: This guide shows how to register and implement SAP Fiori elements controller extensions that modify the navigation context (add/remove/change properties) immediately before outbound navigation is triggered. It covers both OData V2 (adaptNavigationParameterExtension) and OData V4 (adaptNavigationContext). Use these extensions only when manifest settings or annotations cannot achieve the required behavior.

**TAGS**: fiori-elements-framework, extension, navigation, SelectionVariant, manifest.json, adaptNavigationParameterExtension, adaptNavigationContext, OData V2, OData V4, controllerExtensions, extensionAPI

**STEP**: 1 — Safety & Integration Notes

**DESCRIPTION**: Important constraints and recommendations before implementing any extension:
- Use app extensions with caution; prefer manifest settings or annotations when possible.
- Integrate only via the SAP Fiori elements extensionAPI. Do not access or manipulate internal controls, models, bindings, or framework internals.
- You cannot remove every property from a navigation link; the semanticObject property (for semantic links) is required.
- adaptNavigationContext (V4) is called only once per click even if multiple navigation links open; it is not invoked for second-level navigation links.
- oSelectionVariant contains properties passed to the target app (sensitive info already excluded and object mappings applied).
- oTargetInfo (V4) contains semanticObject and action.
- See SelectionVariant API for available methods: https://ui5.sap.com/#/api/sap.ui.generic.app.navigation.service.SelectionVariant/overview

**LANGUAGE**: Text

**CODE**:
```text
Files referenced:
- manifest.json  (root of app)
- Controller extension files (example controllerName strings shown below)
- Example image: images/Controller_Extension_4303c97.png
```

**STEP**: 2 — Register Controller Extensions in manifest.json (OData V2)

**DESCRIPTION**: Add controller extension registrations for List Report and Object Page controllers in manifest.json. Replace controllerName values with your app's extension controllers.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "controllerName": "MY_APP.ext.controller.ListReportExtension"
        },
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "controllerName": "MY_APP.ext.controller.DetailsExtension"
        }
      }
    }
  }
}
```

**STEP**: 3 — Create Controller Extension Files (OData V2)

**DESCRIPTION**: Create the JavaScript controller extension files referenced above. The image below shows a recommended file layout (preserve your own naming conventions and folder structure as used in manifest registration).

**LANGUAGE**: Text

**CODE**:
```text
Example referenced image path:
images/Controller_Extension_4303c97.png

Example controllerName values (must match your file locations):
"MY_APP.ext.controller.ListReportExtension"
"MY_APP.ext.controller.DetailsExtension"
```

**STEP**: 4 — Implement adaptNavigationParameterExtension in Controller (OData V2)

**DESCRIPTION**: Implement adaptNavigationParameterExtension in your controller extension to modify the SelectionVariant before outbound navigation. Use SelectionVariant methods: removeParameter, removeSelectOption, getSelectOptionsPropertyNames, etc. This example demonstrates removing a parameter, removing a selectOption, and removing all selectOptions whose property name starts with 'D'.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// In your ListReportExtension.controller.js or DetailsExtension.controller.js
adaptNavigationParameterExtension: function(oSelectionVariant, oObjectInfo) {
  // Example actions on the SelectionVariant:
  // - remove a parameter named "Currency"
  // - remove a selectOption for property "Price"
  // - remove all selectOptions whose property name starts with "D"

  // Remove parameter
  oSelectionVariant.removeParameter("Currency");

  // Remove a specific selectOption
  oSelectionVariant.removeSelectOption("Price");

  // Remove all selectOptions with names starting with 'D'
  oSelectionVariant.getSelectOptionsPropertyNames().forEach(function(sSelectOptionName) {
    if (sSelectOptionName.startsWith('D')) {
      oSelectionVariant.removeSelectOption(sSelectOptionName);
    }
  });

  // Note: Do not remove required properties (for example, semantic object).
  // This is an example — implement your own logic.
}
```

**STEP**: 5 — Register Controller Extensions in manifest.json (OData V4 / Fiori elements V4)

**DESCRIPTION**: For OData V4 / SAP Fiori elements (sap.fe), register your ListReport and ObjectPage controller extensions under sap.ui5 -> extends. Replace controllerName values with your extension controllers.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ListReport.ListReportController": {
            "controllerName": "SalesOrder.ext.LRExtend"
          },
          "sap.fe.templates.ObjectPage.ObjectPageController": {
            "controllerName": "SalesOrder.ext.OPExtend"
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — Implement adaptNavigationContext in Controller (OData V4)

**DESCRIPTION**: Implement adaptNavigationContext inside the controller override intentBasedNavigation block. This method receives oSelectionVariant and oTargetInfo; use it to remove or alter select options or parameters. Example logs semanticObject/action from oTargetInfo and removes a selectOption named "HasDraftEntity".

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// In your extension controller (e.g., SalesOrder.ext.OPExtend.controller.js)
override: {
  intentBasedNavigation: {
    adaptNavigationContext: function(oSelectionVariant, oTargetInfo) {
      // Log semantic object and action
      Log.info("adaptNavigationContext called with semanticObject: "
        + oTargetInfo.semanticObject + " and action: " + oTargetInfo.action);

      // Example: remove a selectOption named "HasDraftEntity"
      oSelectionVariant.removeSelectOption("HasDraftEntity");

      // Additional modifications:
      // - use oSelectionVariant.removeParameter(name)
      // - use oSelectionVariant.addParameter(name, value)
      // - use oSelectionVariant.addSelectOption(name, selectOption)
      // Follow SelectionVariant API: https://ui5.sap.com/#/api/sap.ui.generic.app.navigation.service.SelectionVariant/overview
    }
  }
}
```

**STEP**: 7 — Restrictions and Behavior Summary

**DESCRIPTION**: Summary of runtime behaviors to consider when implementing your extension:
- adaptNavigationParameterExtension / adaptNavigationContext is invoked only once per user click (even if multiple navigation links open).
- You cannot invoke the extension for navigation links at the second level (the method is not called again).
- Do not remove mandatory properties required by the navigation target (for example, semanticObject for semantic links).
- oSelectionVariant passed to these methods already excludes sensitive properties and respects object mappings.

**LANGUAGE**: Text

**CODE**:
```text
References:
- SelectionVariant API: https://ui5.sap.com/#/api/sap.ui.generic.app.navigation.service.SelectionVariant/overview
- Security considerations: see Security Configuration documentation
- Use only extensionAPI functions from SAP Fiori elements
```
--------------------------------

**TITLE**: Creating Cards for the Insights Cards Section of My Home in SAP S/4HANA Cloud Public Edition and My Home in SAP S/4HANA

**INTRODUCTION**: Enable end users to create "Insights" cards from list report tables and analytical list page charts. Administrators must enable My Home in the system; application developers can hide the "Add Card to Insights" option by updating manifest.json. Use the snippets below to control visibility for OData V2 and OData V4 Fiori Elements apps.

**TAGS**: fiori-elements-framework, sap-ui5, manifest.json, insights, cards, list-report, analytical-list-page, odata-v2, odata-v4

**STEP**: Prerequisites and behavior

**DESCRIPTION**: Ensure My Home is enabled by the administrator. Once enabled, the "Add Card to Insights" option appears automatically in:
- the overflow toolbar of the table in list report applications, and
- the overflow toolbar of the chart in analytical list page applications.

UI references (illustrations):
- images/Add_Cards_to_Insights_New_fe526c6.png
- images/Add_Cards_to_Insights_ALP_401e0b0.png

The manifest.json file in the application root is the file to update to hide the feature (samples below).

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "manifest.json": "update properties shown in the following steps under your app's manifest.json"
}
```

**STEP**: Hide "Add Card to Insights" in SAP Fiori Elements for OData V2 — List Report (table toolbar)

**DESCRIPTION**: For OData V2 List Report apps, set addCardtoInsightsHidden inside tableSettings to true in the sap.ui.generic.app pages → component → settings path to hide the toolbar option.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Zfarvd_Bs_Hd_Bo",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "tableSettings": {
              "addCardtoInsightsHidden": "true" // default value false in sample (string shown as in original sample)
            }
          }
        }
      }
    ]
  }
}
```

**STEP**: Hide "Add Card to Insights" in SAP Fiori Elements for OData V2 — Analytical List Page (chart toolbar)

**DESCRIPTION**: For OData V2 Analytical List Page apps, set addCardtoInsightsHidden inside chartSettings to true in the sap.ui.generic.app pages → component → settings path to hide the chart toolbar option.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Zfarvd_Bs_Hd_Bo",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "chartSettings": {
              "addCardtoInsightsHidden": "true" // default value false in sample (string shown as in original sample)
            }
          }
        }
      }
    ]
  }
}
```

**STEP**: Hide "Add Card to Insights" in SAP Fiori Elements for OData V4 — Table (list report responsive table)

**DESCRIPTION**: For OData V4 apps, add controlConfiguration settings in manifest.json to disable the Add Card action for the table control. This is applicable to single view and single-entity multi-view scenarios with responsive tables.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ui5": {
    "controlConfiguration": {
      "@com.sap.vocabularies.UI.v1.LineItem": {
        "tableSettings": {
          "type": "ResponsiveTable",
          "enableAddCardToInsights": false
        }
      }
    }
  }
}
```

**STEP**: Hide "Add Card to Insights" in SAP Fiori Elements for OData V4 — Chart (analytical list page)

**DESCRIPTION**: For OData V4 apps, add controlConfiguration settings in manifest.json to disable the Add Card action for the chart control.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ui5": {
    "controlConfiguration": {
      "@com.sap.vocabularies.UI.v1.Chart": {
        "enableAddCardToInsights": false
      }
    }
  }
}
```

**STEP**: Supported and unsupported columns for card creation

**DESCRIPTION**: The card creation dialog only shows columns supported by cards. Use this as a checklist when designing LineItem annotations or table/column types.

**LANGUAGE**: TEXT

**CODE**:
```
Supported column types for cards:
- Single-valued DataField-based columns
- Columns displayed as links: DataFieldWithUrl, semantic links
- DataField with QuickViewFacets
- (OData V4 additional) DataFieldWithIntentBasedNavigation
- (OData V4 additional) DataFieldWithNavigationPath

Unsupported column types for cards:
- Image columns
- Multi-valued based columns
- FieldGroup-based columns
- Columns with inline action
- Columns with navigation button
- DataFieldForAnnotation-based columns (e.g., contact or address fields)
- Custom columns
```

**STEP**: Restrictions and behavior notes

**DESCRIPTION**: Known limitations to consider when users create integration cards from list report tables.

**LANGUAGE**: TEXT

**CODE**:
```
Restrictions:
- Creating an integration card from a list report table does NOT retain these changes when navigating back from the card:
  - Removed filter fields or removed table columns
  - Changes in the position of filter fields or table columns
- Cards may not use the same unit-of-measure formatting as the source list report table.
- OData V4: Card creation supports single-view scenarios and single-entity multi-view scenarios only (responsive tables).
```

**STEP**: References

**DESCRIPTION**: Links to official My Home documentation for Cloud and On-Premise S/4HANA.

**LANGUAGE**: TEXT

**CODE**:
```
Related Information:
- My Home in SAP S/4HANA Cloud Public Edition:
  https://help.sap.com/docs/SAP_S4HANA_CLOUD/4fc8d03390c342da8a60f8ee387bca1a/8a60279e8d2041b5ad8d3455fab0f3ef.html

- My Home in SAP S/4HANA:
  https://help.sap.com/docs/ABAP_PLATFORM_NEW/a7b390faab1140c087b8926571e942b7/8a60279e8d2041b5ad8d3455fab0f3ef.html
```
--------------------------------

**TITLE**: Creating Custom Cards for Overview Pages (SAP Fiori Elements / UI5)

**INTRODUCTION**: Step-by-step, code-focused guide to implement a custom card for an overview page in a Fiori Elements / UI5 application. Includes folder/file layout, a Component implementation, fragment view, optional header fragment, controller with refresh and filter-extension hooks, and how to register the card in manifest.json.

**TAGS**: fiori-elements-framework, sap.ovp, UI5, custom-card, overview-page, manifest, extension-api

**STEP**: 1 — Create folder for the custom card

**DESCRIPTION**: Create the extension folder under the webapp/ext path. Use a consistent namespace folder name for the card implementation.

**LANGUAGE**: none

**CODE**:
```text
Create folder:
webapp/ext/myCustomCard
```

**STEP**: 2 — Create required files

**DESCRIPTION**: Add the following files to webapp/ext/myCustomCard. The header fragment is optional and only required if you customize the card header.

**LANGUAGE**: none

**CODE**:
```text
Files to create:
webapp/ext/myCustomCard/Component.js
webapp/ext/myCustomCard/MyCustomCard.fragment.xml
webapp/ext/myCustomCard/MyCustomCard.controller.js
webapp/ext/myCustomCard/MyCustomCardHeader.fragment.xml  (optional)
```

**STEP**: 3 — Implement the custom Card Component

**DESCRIPTION**: Implement Component.js to extend the standard OVP custom card component. Define metadata properties, default fragments, dependencies, and controller extension binding.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/myCustomCard/Component.js
sap.ui.define(["sap/ovp/cards/custom/Component"],
    function (CustomCardComponent) {
        "use strict";
        return CustomCardComponent.extend("test.testovp.ext.myCustomCard.Component", {
            metadata: {
                properties: {
                    contentFragment: {
                        type: "string",
                        defaultValue: "test.testovp.ext.myCustomCard.MyCustomCard"
                    },
                    annotationPath: {
                        type: "string",
                        defaultValue: "com.sap.vocabularies.UI.v1.LineItem"
                    },
                    countHeaderFragment: {
                        type: "string",
                        defaultValue: "sap.ovp.cards.generic.CountHeader"
                    },
                    headerExtensionFragment: {
                        type: "string",
                        defaultValue: "sap.ovp.cards.generic.KPIHeader"
                    }
                },
                customizing: {
                    "sap.ui.controllerExtensions": {
                        "sap.ovp.cards.generic.Card": {
                            controllerName: "test.testovp.ext.myCustomCard.MyCustomCard"
                        }
                    }
                },
                version: "${version}",
                library: "sap.ovp",
                includes: [],
                dependencies: {
                    libs: ["sap.suite.ui.microchart"],
                    components: []
                },
                config: {}
            }
        });
    }
);
```

**STEP**: 4 — Define the card content fragment (view)

**DESCRIPTION**: Implement the fragment that defines the card content area. Bind to the card's entity set or model. Replace the sample content with your UI controls bound to the model.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/myCustomCard/MyCustomCard.fragment.xml -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:ovp="sap.ovp.ui"
    xmlns:template="http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1">
    <!-- Example content: simple list bound to card items -->
    <List id="cardView" items="{path: ''}">
        <StandardListItem title="{Name}" description="{Description}" />
    </List>
</core:FragmentDefinition>
```

**STEP**: 5 — (Optional) Define a header fragment

**DESCRIPTION**: Implement an optional header fragment if you want to customize header layout or show a different title/indicator.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/myCustomCard/MyCustomCardHeader.fragment.xml -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core">
    <Title text="My Custom Card Header" />
</core:FragmentDefinition>
```

**STEP**: 6 — Implement controller with lifecycle hooks, refresh and filter extensions

**DESCRIPTION**: Controller code supports onInit, onAfterRendering, onRefresh (to allow user-triggered refresh action), and setRelevantFilters (extension API used by overview page to pass relevant filters to the card). The controller is provided as a controller extension object.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/myCustomCard/MyCustomCard.controller.js
(function () {
    "use strict";
    /* global sap, jQuery */
    sap.ui.define([], function () {
        return {
            onInit: function () {
                // Initialization logic for the card (called once)
                // e.g., access models: this.getView().getModel()
            },

            onAfterRendering: function () {
                // Post-render logic for the card
            },

            /**
             * Called when user triggers a refresh action on the card.
             * Implement data refresh logic here.
             * Example: refresh the model or rebind the list.
             */
            onRefresh: function () {
                var oView = this.getView().byId("cardView"); // card content root
                if (oView) {
                    // Example: rebind / refresh the binding
                    var oBinding = oView.getBinding("items");
                    if (oBinding && oBinding.refresh) {
                        oBinding.refresh();
                    } else if (this.getView().getModel()) {
                        // fallback: refresh model data if supported
                        try {
                            this.getView().getModel().refresh(true);
                        } catch (e) {
                            // handle refresh errors
                        }
                    }
                }
            },

            /**
             * Extension function to receive card-relevant filters from the overview page.
             * @param {sap.ui.model.Filter[]} oFilters - Relevant filters
             */
            setRelevantFilters: function (oFilters) {
                var oView = this.getView().byId("cardView");
                if (!oView) {
                    return;
                }
                // If filters exist, apply them to the items binding; otherwise clear filters
                if (oFilters && oFilters.length && oFilters[0].aFilters && oFilters[0].aFilters.length > 0) {
                    oView.getBinding("items").filter(oFilters);
                } else {
                    oView.getBinding("items").filter([]);
                }
            }
        };
    });
})();
```

**STEP**: 7 — Register the custom card in manifest.json

**DESCRIPTION**: Configure the overview page card entry in webapp/manifest.json so the overview page loads your custom card component. Place the card object under the sap.ovp.cards section.

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (excerpt)
{
  "sap.ovp": {
    "cards": {
      "card008_HereIsMyCustomCard": {
        "model": "myModel",
        "template": "test.testovp.ext.myCustomCard", 
        "settings": {
          "title": "Custom Card Title",
          "entitySet": "MyEntity"
          /* other settings (e.g., actions, header settings) */
        }
      }
    }
  }
}
```

**STEP**: 8 — Notes and best practices

**DESCRIPTION**: Implementation notes to follow during development and testing.

**LANGUAGE**: none

**CODE**:
```text
- Place all extension files under webapp/ext/<folderName> and ensure namespace matches manifest template value.
- Component template string in manifest ("template") must match the Component's declared namespace (e.g., test.testovp.ext.myCustomCard).
- The controller functions (onRefresh and setRelevantFilters) are extension hooks used by the overview page framework:
  - onRefresh enables the card action to refresh data.
  - setRelevantFilters receives an array of sap.ui.model.Filter objects; apply them to your card bindings.
- Card templates beginning with "sap.ovp.cards" are standard OVP templates. Custom templates are registered via the component name.
- When binding items in the fragment, ensure the binding context corresponds to the card model/entitySet (as configured in manifest).
```
--------------------------------

**TITLE**: Creating Custom Filters for Analytical List Page (OData V2)

**INTRODUCTION**: This guide shows how to add custom compact filters, visual-filter customizations, and KPI-tag filter modifications in SAP Fiori elements Analytical List Page (ALP) for OData V2. It includes manifest configuration, fragment XML, and a fully implemented controller extension (JS) with all relevant extension hooks.

**TAGS**: fiori-elements-framework, sapui5, ODataV2, AnalyticalListPage, SmartFilterBar, VisualFilter, KPI, extension, manifest

**STEP**: 1 — Add manifest.json extensions (view + controller)
**DESCRIPTION**: Extend the ALP view by registering a view fragment (SmartFilterBar custom control) and a controller extension in the application manifest (sap.ui5 -> extends). Replace fragmentName/controllerName and keys to match your app namespace, entity set, and filter key.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "_version": "1.1.0",
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
            "controllerName": "my_app.ext.controller.AnalyticalListPageExt"
          }
        },
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
            "SmartFilterBarControlConfigurationExtension|CZ_EASILINEITEMS_SADL": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "analytics2.alr.ext.fragments.CustomFilters",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Create the custom filter fragment XML
**DESCRIPTION**: Place this fragment at analytics2/alr/ext/fragments/CustomFilters.fragment.xml (fragmentName above). It defines a custom ComboBox control inside a SmartFilterBar ControlConfiguration with key "CustomFilters". Adjust key, id, label, and items as needed.
**LANGUAGE**: XML
**CODE**:
```xml
<core:FragmentDefinition xmlns="sap.m"
                         xmlns:smartfilterbar="sap.ui.comp.smartfilterbar"
                         xmlns:core="sap.ui.core">
  <smartfilterbar:ControlConfiguration
      key="CustomFilters"
      index="99"
      visibleInAdvancedArea="true"
      label="Custom Filter"
      groupId="_BASIC">
    <smartfilterbar:customControl>
      <ComboBox id="CustomFilters-combobox">
        <core:Item key="0" text="Item1"/>
        <core:Item key="1" text="Item2"/>
        <core:Item key="2" text="Item3"/>
      </ComboBox>
    </smartfilterbar:customControl>
  </smartfilterbar:ControlConfiguration>
</core:FragmentDefinition>
```

**STEP**: 3 — Implement the controller extension
**DESCRIPTION**: Create the controller extension file specified in the manifest (my_app/ext/controller/AnalyticalListPageExt.controller.js). This module implements all extension hooks for compact filters, binding updates, app-state persistence, clear handling, visual filter customization, and KPI tag filter modification. Update IDs, entity names, KPI IDs, and business logic as required.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// File: my_app/ext/controller/AnalyticalListPageExt.controller.js
sap.ui.define([
  "sap/base/Log",
  "sap/ui/model/Filter"
], function(Log, Filter) {
  "use strict";

  return {
    /**
     * Called during SmartFilterBar initialization.
     * Use this to bind event handlers to custom controls.
     * oEvent.getSource() -> SmartFilterBar instance
     */
    onInitSmartFilterBarExtension: function(oEvent) {
      var oSmartFilterBar = oEvent.getSource();
      var oCustomControl = oSmartFilterBar.getControlByKey("CustomFilters");
      if (oCustomControl && oCustomControl.attachSelectionChange) {
        oCustomControl.attachSelectionChange(function(oChangeEvent) {
          // Custom selection change handler
          Log.info("CustomFilters selection changed");
          // Example: trigger something or update a model
        }, this);
      }
      Log.info("onInitSmartFilterBarExtension initialized");
    },

    /**
     * Modify the table binding before it is rebound.
     * oEvent.getParameter("bindingParams") can be used to add filters/parameters.
     */
    onBeforeRebindTableExtension: function(oEvent) {
      var oBindingParams = oEvent.getParameter && oEvent.getParameter("bindingParams");
      var oComboBox = this.byId("CustomFilters-combobox");
      if (oComboBox && oComboBox.getSelectedKey && oComboBox.getSelectedKey()) {
        var sKey = oComboBox.getSelectedKey();
        // Example: add a filter to the binding based on custom filter value
        if (oBindingParams && Array.isArray(oBindingParams.filters)) {
          oBindingParams.filters.push(new Filter("CustomField", "EQ", sKey));
        }
      }
    },

    /**
     * Modify the chart binding before it is rebound.
     */
    onBeforeRebindChartExtension: function(oEvent) {
      // Same pattern as table rebind; update chart binding parameters/filters
      var oBindingParams = oEvent.getParameter && oEvent.getParameter("bindingParams");
      var oComboBox = this.byId("CustomFilters-combobox");
      if (oComboBox && oComboBox.getSelectedKey && oComboBox.getSelectedKey()) {
        var sKey = oComboBox.getSelectedKey();
        if (oBindingParams && Array.isArray(oBindingParams.filters)) {
          oBindingParams.filters.push(new Filter("CustomField", "EQ", sKey));
        }
      }
    },

    /**
     * Store custom control state in the app state (called by Fiori elements).
     * oCustomData is the object to populate with custom state.
     */
    getCustomAppStateDataExtension: function(oCustomData) {
      var oComboBox = this.byId("CustomFilters-combobox");
      if (oComboBox) {
        oCustomData.CustomPriceFilter = oComboBox.getSelectedKey();
      }
    },

    /**
     * Restore custom control state from the app state (called by Fiori elements).
     * oCustomData contains previously stored properties.
     */
    restoreCustomAppStateDataExtension: function(oCustomData) {
      if (oCustomData && oCustomData.CustomPriceFilter !== undefined) {
        var oComboBox = this.byId("CustomFilters-combobox");
        if (oComboBox) {
          oComboBox.setSelectedKey(oCustomData.CustomPriceFilter);
        }
      }
    },

    /**
     * Handle Clear action from ALP. Clear logic for all custom filters must be implemented here.
     */
    onClearFilterExtension: function(oEvent) {
      if (this.byId("CustomFilters-combobox")) {
        this.byId("CustomFilters-combobox").setSelectedKey(null);
      }
      Log.info("Custom filters cleared");
    },

    /**
     * Customize visual filters before they are rebound (called for each visual filter).
     * sEntityType, sDimension, sMeasure, oContext (has filters, queryParameters, sorters, entityParameters).
     */
    onBeforeRebindVisualFilterExtension: function(sEntityType, sDimension, sMeasure, oContext) {
      // Access incoming navigation context via extensionAPI
      var oNavigationContext = this.extensionAPI && this.extensionAPI.getNavigationContext && this.extensionAPI.getNavigationContext();

      // Example customization: when dimension is "CostCenter" add query parameter and an extra filter
      if (sDimension === "CostCenter") {
        // Add a custom query parameter -> will be included in the visual filter service call as ?Type=Cost
        oContext.queryParameters = oContext.queryParameters || {};
        oContext.queryParameters.Type = "Cost";

        // Influence applied parameters/filters based on entity parameters
        if (oContext.entityParameters && oContext.entityParameters.P_DisplayCurrency === "USD") {
          oContext.queryParameters.Country = "USA";
          oContext.filters = oContext.filters || [];
          oContext.filters.push(new Filter("Product", "EQ", "HT-1000"));
        }
      }
    },

    /**
     * Modify filters/parameters applied to KPI tags before they are called.
     * oSelectionVariant is a SelectionVariant-like object (has addSelectOption).
     */
    onBeforeRebindFilterableKPIExtension: function(oSelectionVariant, sEntityType, sKPIId) {
      // Example: add a select option when a specific KPI ID is being bound
      if (sKPIId === "alp.tech.app::sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage::SEPMRA_C_ALP_SlsOrdItemCubeALPResults--template::KPITag::kpi::KPINetProductPriceByCategory") {
        // Add select option for Product = 'HT-1502'
        if (oSelectionVariant && typeof oSelectionVariant.addSelectOption === "function") {
          oSelectionVariant.addSelectOption("Product", "I", "EQ", "HT-1502", null);
        }
      }
      Log.info("onBeforeRebindFilterableKPIExtension called!");
    }
  };
});
```

**STEP**: 4 — Date/time format rules for filter values
**DESCRIPTION**: Use these formats when adding date or datetime selection values (SelectionVariant) in custom code or query parameters.
**LANGUAGE**: Text
**CODE**:
```
Date only (UTC start of day):         YYYY-MM-DDT00:00:00Z
Example:                             2018-10-15T00:00:00Z

SelectionVariant date/time formats:
- UTC with milliseconds:             YYYY-MM-DDT00:00:00.000Z
  Example:                           2018-09-03T12:46:00.000Z

- Local time with offset:            YYYY-MM-DDTHH:MM:SS.fff-HH:MM
  Example:                           2018-09-03T12:46:12.123-07:00
```

**STEP**: 5 — Important behavior reminders (implementation notes)
**DESCRIPTION**: Implementation notes to keep in mind when using custom filters:
- Custom filters (added via SmartFilterBar control configuration) do not appear in Visual Filters.
- If you add logic in onBeforeRebindChartExtension or onBeforeRebindTableExtension to read custom-filter values, those values are refreshed when the table or chart is refreshed. This keeps custom filters synchronized when filter mode changes.
- The Clear action triggers onClearFilterExtension; ensure your extension clears all custom controls (for example, reset ComboBox selected key to null).


--------------------------------

**TITLE**: Creating Key Performance Indicator (KPI) Tags for Analytical List Page (ALP)

**INTRODUCTION**: This reference shows how to configure and annotate Key Performance Indicators (KPIs) for SAP Fiori elements Analytical List Page (ALP). It covers manifest settings (OData V2 and V4), UI.KPI annotation and related annotations (DataPoint, SelectionVariant, PresentationVariant, Chart), KPI title abbreviation rules, value/criticality logic, number formatting, units of measure, filterable KPIs and semantic coloring. Applicable only to analytical services. Note: KPIs in analytical services with parametrized entity sets are not supported in OData V4.

**TAGS**: KPI, ALP, AnalyticalListPage, UI.KPI, DataPoint, SelectionVariant, PresentationVariant, Chart, manifest.json, ODataV2, ODataV4, CDS, CAP

STEP: 1 — Manifest: SAP Fiori elements for OData V2 (enable KPIs)
DESCRIPTION: Add keyPerformanceIndicators to the ALP page definition in manifest.json. Map the KPI entry to the KPI entitySet, qualifier, model and optional detailNavigation and filterable flags.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "keyPerformanceIndicators": {
              "KPIRevenue": {
                "model": "kpi",
                "entitySet": "SEPMRA_C_ALP_TotalSalesKPI",
                "qualifier": "KPIQuantity",
                "detailNavigation": "EPMProduct"
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 2 — Manifest: SAP Fiori elements for OData V4 (enable KPIs)
DESCRIPTION: For OData V4 / Fiori Elements (FE) routing targets, configure keyPerformanceIndicators under the target options.settings. Define entitySet, qualifier, and optional detailNavigation.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "BusinessPartnersALP": {
          "type": "Component",
          "id": "BusinessPartnersList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "keyPerformanceIndicators": {
                "KPIRevenue": {
                  "entitySet": "BusinessPartners",
                  "qualifier": "KPIQuantity"
                },
                "KPIVolume": {
                  "entitySet": "BusinessPartners",
                  "qualifier": "Volume",
                  "detailNavigation": "PartnerSales"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — UI.KPI annotation (XML) — basic KPI with qualifier
DESCRIPTION: Define UI.KPI with a qualifier that references DataPoint and SelectionVariant qualifiers, includes an ID and Detail (KPIDetailType). The KPI ID is passed as EvaluationId to target apps.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.KPI" Qualifier="KPIQuantity">
  <Record>
    <PropertyValue Property="DataPoint" Path="@UI.DataPoint#DPForQuantity" />
    <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#SVForQuantity" />
    <PropertyValue Property="ID" String="ActualCostByGLAccountNameKPI" />
    <PropertyValue Property="Detail">
      <Record Type="UI.KPIDetailType">
        <PropertyValue Property="SemanticObject" String="EPMProduct" />
        <PropertyValue Property="Action" String="manage_stta" />
        <PropertyValue Property="DefaultPresentationVariant" Path="@UI.PresentationVariant#PVForQuantity" />
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 4 — UI.KPI annotation (ABAP CDS)
DESCRIPTION: Inline ABAP CDS example mapping UI.KPI properties including selectionVariantQualifier, id, dataPoint, detail with semanticObject/action and qualifier.
LANGUAGE: abap
CODE:
```abap
@UI.KPI: [
  {
    selectionVariantQualifier: 'SVForQuantity',
    id: 'ActualCostByGLAccountNameKPI',
    dataPoint.title: 'Define datapoint inline',
    datapoint.minimumValue: 2,
    detail: {
      semanticObject: 'EPMProduct',
      semanticObjectAction: 'manage_stta',
      defaultPresentationVariantQualifier: 'PVForQuantity'
    },
    qualifier: 'KPIQuantity'
  }
]
DPForQuantity;
```

STEP: 5 — UI.KPI annotation (CAP CDS)
DESCRIPTION: CAP CDS syntax for UI.KPI referencing DataPoint, SelectionVariant and KPIDetailType.
LANGUAGE: cds
CODE:
```cds
UI.KPI #KPIQuantity : {
  DataPoint : ![@UI.DataPoint#DPForQuantity],
  SelectionVariant : ![@UI.SelectionVariant#SVForQuantity],
  ID : 'ActualCostByGLAccountNameKPI',
  Detail : {
    $Type : 'UI.KPIDetailType',
    SemanticObject : 'EPMProduct',
    Action : 'manage_stta',
    DefaultPresentationVariant : ![@UI.PresentationVariant#PVForQuantity]
  }
},
```

STEP: 6 — KPIDetailType (XML)
DESCRIPTION: KPIDetailType defines SemanticObject, Action and DefaultPresentationVariant used to enable KPI card navigation.
LANGUAGE: XML
CODE:
```xml
<PropertyValue Property="Detail">
  <Record Type="UI.KPIDetailType">
    <PropertyValue Property="SemanticObject" String="EPMProduct" />
    <PropertyValue Property="Action" String="manage_stta" />
    <PropertyValue Property="DefaultPresentationVariant" Path="@UI.PresentationVariant#PVForQuantity" />
  </Record>
</PropertyValue>
```

STEP: 7 — DataPoint annotation (XML)
DESCRIPTION: Define DataPoint qualifier that provides Title, Description, Value path and Criticality. First DataPoint visualization in PresentationVariant drives KPI value and color. Percent values include % automatically.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="DPForQuantity">
  <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
    <PropertyValue Property="Title" String="Quantity by Customer Company Name" />
    <PropertyValue Property="Description" String="About NumberOfSalesOrders" />
    <PropertyValue Property="Value" Path="Quantity" />
    <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Neutral" />
  </Record>
</Annotation>
```

STEP: 8 — SelectionVariant annotation (XML)
DESCRIPTION: Configure default filter parameters and select options for the KPI entity set. SelectionVariant overrides default filter values and provides Parameters and SelectOptions used by the KPI.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.SelectionVariant" Qualifier="SVForQuantity">
  <Record>
    <PropertyValue Property="Parameters">
      <Collection>
        <Record Type="UI.Parameter">
          <PropertyValue Property="PropertyName" PropertyPath="CompanyCurrency" />
          <PropertyValue Property="PropertyValue" String="EUR" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record Type="UI.SelectOptionType">
          <PropertyValue Property="PropertyName" PropertyPath="MainProductCategory" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record Type="UI.SelectionRangeType">
                <PropertyValue EnumMember="UI.SelectionRangeSignType/I" Property="Sign" />
                <PropertyValue EnumMember="UI.SelectionRangeOptionType/EQ" Property="Option" />
                <PropertyValue Property="Low" String="Computer Systems" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 9 — SelectionVariant annotation (ABAP CDS)
DESCRIPTION: ABAP CDS selectionVariant qualifier example.
LANGUAGE: abap
CODE:
```abap
@UI.selectionVariant: [
  {
    qualifier: 'SVForQuantity',
    parameters: [{name: 'PropertyName', value: 'CompanyCurrency' },{ name: 'PropertyValue', value: 'EUR'}]
  }
]
```

STEP: 10 — SelectionVariant annotation (CAP CDS)
DESCRIPTION: CAP CDS SelectionVariant qualifier with Parameters and SelectOptions.
LANGUAGE: cds
CODE:
```cds
UI.SelectionVariant #SVForQuantity : {
  Parameters : [
    {
      $Type : 'UI.Parameter',
      PropertyName : CompanyCurrency,
      PropertyValue : 'EUR'
    }
  ],
  SelectOptions : [
    {
      $Type : 'UI.SelectOptionType',
      PropertyName : MainProductCategory,
      Ranges : [
        {
          $Type : 'UI.SelectionRangeType',
          Sign : #I,
          Option : #EQ,
          Low : 'Computer Systems'
        }
      ]
    }
  ]
}
```

STEP: 11 — PresentationVariant annotation (XML)
DESCRIPTION: PresentationVariant qualifier defines SortOrder and Visualizations. The first visualization renders the KPI value. Use qualifier referenced in UI.KPI.Detail.DefaultPresentationVariant.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant" Qualifier="PVForQuantity">
  <Record>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record Type="Common.SortOrderType">
          <PropertyValue Property="Property" PropertyPath="Quantity" />
          <PropertyValue Property="Descending" Bool="true" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
        <AnnotationPath>@com.sap.vocabularies.UI.v1.Chart#QuantityChart</AnnotationPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 12 — PresentationVariant annotation (ABAP CDS)
DESCRIPTION: ABAP CDS PresentationVariant with sortOrder and visualizations.
LANGUAGE: abap
CODE:
```abap
@UI.PresentationVariant: [
  {
    sortOrder: [
      {
        by: 'QUANTITY',
        direction: #DESC
      }
    ],
    visualizations: [
      {
        type: #AS_CHART,
        qualifier: 'QuantityChart'
      }
    ],
    qualifier: 'PVForQuantity'
  }
]
annotate view VIEWNAME with { }
```

STEP: 13 — PresentationVariant annotation (CAP CDS)
DESCRIPTION: CAP CDS PresentationVariant qualifier.
LANGUAGE: cds
CODE:
```cds
UI.PresentationVariant #PVForQuantity : {
  SortOrder : [
    {
      $Type : 'Common.SortOrderType',
      Property : Quantity,
      Descending : true
    }
  ],
  Visualizations : [
    '@UI.Chart#QuantityChart'
  ]
}
```

STEP: 14 — Chart annotation (XML) — QuantityChart
DESCRIPTION: Chart qualifier used in PresentationVariant visualizations. Defines Title, MeasureAttributes, DimensionAttributes, ChartType and Description. Note V4 restriction on supported chart types and that only SortOrder and MaxItems from PresentationVariant are considered.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.Chart" Qualifier="QuantityChart">
  <Record>
    <PropertyValue Property="Title" String="NumberOfSalesOrders" />
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="Quantity" />
          <PropertyValue Property="Role" EnumMember="com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis1" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="SoldToPartyCompanyName" />
          <PropertyValue Property="Role" EnumMember="com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Category" />
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bar" />
    <PropertyValue Property="Description" String="NumberOfSalesOrders by Customer Company Name" />
  </Record>
</Annotation>
```

STEP: 15 — Chart annotation (ABAP CDS)
DESCRIPTION: ABAP CDS Chart qualifier example.
LANGUAGE: abap
CODE:
```abap
@UI.Chart: [
  {
    title: 'NumberOfSalesOrders',
    measureAttributes: [
      {
        measure: 'Quantity',
        role: #AXIS_1
      }
    ],
    dimensionAttributes: [
      {
        dimension: 'SoldToPartyCompanyName',
        role: #CATEGORY
      }
    ],
    chartType: #BAR,
    description: 'NumberOfSalesOrders by Customer Company Name',
    qualifier: 'QuantityChart'
  }
]
annotate view VIEWNAME with { }
```

STEP: 16 — Chart annotation (CAP CDS)
DESCRIPTION: CAP CDS Chart qualifier example.
LANGUAGE: cds
CODE:
```cds
UI.Chart #QuantityChart : {
  Title : 'NumberOfSalesOrders',
  MeasureAttributes : [
    {
      $Type : 'UI.ChartMeasureAttributeType',
      Measure : Quantity,
      Role : #Axis1
    }
  ],
  DimensionAttributes : [
    {
      $Type : 'UI.ChartDimensionAttributeType',
      Dimension : SoldToPartyCompanyName,
      Role : #Category
    }
  ],
  ChartType : #Bar,
  Description : 'NumberOfSalesOrders by Customer Company Name'
}
```

STEP: 17 — KPI Title abbreviation rules
DESCRIPTION: Abbreviate KPI title from DataPoint.Title using:
- One word: first three letters (e.g., TargetMargin -> TAR)
- Two words: first letter of each word (e.g., Actual Cost -> AC)
- Three+ words: first letter of first three words (e.g., Actual Margin Relative -> AMR)
The KPI name is taken from DataPoint.Title.
LANGUAGE: Text
CODE:
```text
Rules:
- 1 word: use first 3 letters (TAR)
- 2 words: use 1st letter of each word (AC)
- 3+ words: use 1st letter of first 3 words (AMR)
Source: DataPoint.Title
```

STEP: 18 — KPI value, color and criticality logic (actionable)
DESCRIPTION: The KPI value and color are determined by:
- The first DataPoint visualization in PresentationVariant renders value and color.
- Use DataPoint properties:
  - CriticalityCalculation: hard-coded or path-based threshold inputs.
  - Criticality: backend-provided complex logic (overrides CriticalityCalculation if both present).
- ImprovementDirection defines measure type (Maximizing, Minimizing, Target/Range) and affects color thresholds.
- If threshold values are incomplete, ALP chooses the closest color match.
LANGUAGE: Text
CODE:
```text
- First DataPoint visualization drives KPI value+color.
- Use CriticalityCalculation (static or path) or Criticality (backend); Criticality wins if both present.
- Set ImprovementDirection for measure type (Max/Min/Target) to drive threshold logic.
- Percent-based KPI shows % automatically.
```

STEP: 19 — Number formatting and decimal precision
DESCRIPTION: Use DataPoint.ValueFormat.NumberOfFractionalDigits to control decimals. Defaults: no decimals. You can specify 1 or 2 digits; values >2 are treated as additional to 2. Value from DataPoint overrides OData metadata NumberOfFractionalDigits.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="Price">
  <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
    <PropertyValue Property="Value" Path="Price"/>
    <PropertyValue Property="ValueFormat">
      <Record Type="com.sap.vocabularies.UI.v1.NumberFormat">
        <PropertyValue Property="NumberOfFractionalDigits" Int="1"/>
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 20 — Number formatting (ABAP CDS)
DESCRIPTION: ABAP CDS snippet to override fractional digits for a field.
LANGUAGE: abap
CODE:
```abap
@UI.dataPoint: { 
  valueFormat.numberOfFractionalDigits: 1  
}
price;
```

STEP: 21 — Number formatting (CAP CDS)
DESCRIPTION: CAP CDS DataPoint ValueFormat example.
LANGUAGE: cds
CODE:
```cds
UI.DataPoint #Price : {
  $Type : 'UI.DataPointType',
  Value : Price,
  ValueFormat : {
    $Type : 'UI.NumberFormat',
    NumberOfFractionalDigits : 1
  }
}
```

STEP: 22 — Units of Measure (XML)
DESCRIPTION: Attach Org.OData.Measures annotations to properties to display currency or unit strings/path values. You can override backend UoM by providing Org.OData.Measures.V1.Unit or ISOCurrency with String or Path.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="CZ_PROJECTKPIS_CDS.CZ_PROJECTKPISType/ActualCost">
  <Annotation Term="Org.OData.Measures.V1.ISOCurrency" Path="CompanyCodeCurrency"/>
</Annotations>
<Annotations Target="CZ_PROJECTKPIS_CDS.CZ_PROJECTKPISType/TargetMargin">
  <Annotation Term="Org.OData.Measures.V1.ISOCurrency" String="EUR"/> 
</Annotations>
<Annotations Target="CZ_PROJECTKPIS_CDS.CZ_PROJECTKPISType/ActualMarginRelative">
  <Annotation Term="Org.OData.Measures.V1.Unit" String="%"/>
</Annotations>
<Annotations Target="CZ_PROJECTKPIS_CDS.CZ_PROJECTKPISType/NetWeight">
  <Annotation Term="Org.OData.Measures.V1.Unit" Path="WeightUnit"/>
</Annotations>
```

STEP: 23 — Units of Measure (CAP CDS)
DESCRIPTION: CAP CDS example to map currency UoM to a property.
LANGUAGE: cds
CODE:
```cds
annotate CZ_PROJECTKPIS_CDS.CZ_PROJECTKPISType with {
  @Measures.ISOCurrency : CompanyCodeCurrency
  ActualCost
};
```

STEP: 24 — Override unit of measure (XML)
DESCRIPTION: Example to override backend unit of measure to percentage.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="CZ_PROJECTKPIS_CDS.CZ_PROJECTKPISType/ActualCost">
  <Annotation Term="Org.OData.Measures.V1.Unit" String="%"/>
</Annotations>
```

STEP: 25 — Filterable KPIs (manifest + notes)
DESCRIPTION: Filterable KPIs react to filter bar when technical names match between KPI entity set and filter fields. Only available in OData V2. To enable set "filterable": true in manifest KPI entry. If showGoButtonOnFilterBar is true, KPIs hide until Go is pressed.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_ALP_SlsOrdItemCube",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "list": true,
          "settings": {
            "keyPerformanceIndicators": {
              "KPIRevenue": {
                "model": "kpi",
                "entitySet": "SEPMRA_C_ALP_TotalSalesKPI",
                "qualifier": "KPIRevenue",
                "filterable": true,
                "detailNavigation": "OverviewPage"
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 26 — Semantic coloring for filterable KPIs (actionable)
DESCRIPTION: For filterable KPIs, use DataPoint.CriticalityCalculation with paths so KPI criticality and colors update when filters/parameters change. Only path-based criticality is supported for filterable KPIs.
LANGUAGE: Text
CODE:
```text
- Use DataPoint.CriticalityCalculation with PropertyPath values for dynamic color updates.
- Only path-based criticality is supported for filterable KPIs.
- Filter bar changes that match KPI entity fields update KPI values and criticality.
```

STEP: 27 — Restrictions and important notes (concise)
DESCRIPTION: Preserve these constraints when implementing:
- Topic applies to analytical services only.
- KPIs in analytical services with parametrized entity sets are not supported in OData V4.
- Filterable KPIs are only supported in OData V2.
- In OData V4, supported chart types: line, column, bar, stacked bar, stacked column, vertical_bullet, scatter, combination, donut, bubble. PresentationVariant: only SortOrder and MaxItems are considered.
- KPI navigation requires Detail.SemanticObject, Detail.Action and UI.KPI.ID (EvaluationId passed).
LANGUAGE: Text
CODE:
```text
- Analytical services only.
- Parametrized entity sets: not supported in OData V4.
- Filterable KPIs: only OData V2.
- OData V4 chart types supported: line, column, bar, stacked bar, stacked column, vertical_bullet, scatter, combination, donut, bubble.
- PresentationVariant in V4: only SortOrder and MaxItems considered.
- KPI navigation: set Detail.SemanticObject, Detail.Action, and UI.KPI.ID.
```
--------------------------------

**TITLE**: Manifest-based Key Performance Indicators (KPI) for SAP Fiori elements (OData V4)

**INTRODUCTION**: This guide shows how to add manifest-based KPI tags in SAP Fiori elements (OData V4) using the keyPerformanceIndicators section in manifest.json, how to create the KPI fragment using the sap.fe.macros.KPITag building block, and how to wire a press handler. Use this when you need KPI tags without an analytical service.

**TAGS**: fiori-elements-framework, odata-v4, manifest.json, kpi, sap.fe.macros, UI5, fragment

**STEP**: 1 — Add KPI definitions to manifest.json

**DESCRIPTION**: Add a keyPerformanceIndicators section under the target's options.settings in webapp/manifest.json. Each KPI entry uses a unique name and a template reference that points to the fragment (module name). This example registers two KPI tags: one simple and one with a press handler.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "my.app"
  },
  "sap.ui5": {
    "routing": {
      "targets": {
        "mainPage": {
          "type": "Component",
          "id": "Default",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/RootEntity",
              "variantManagement": "None",
              "initialLoad": true,
              "keyPerformanceIndicators": {
                "myKPITag": {
                  "template": "sap.fe.core.fpmExplorer.customKPIContent.CustomKPITag"
                },
                "myKPIWithPress": {
                  "template": "sap.fe.core.fpmExplorer.customKPIContent.CustomKPITagWithPress"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Create KPI fragment using sap.fe.macros.KPITag

**DESCRIPTION**: Implement the fragment referenced by the manifest template value. Use the KPITag macro to match the KPI look-and-feel used by analytical services. Put the fragment file at the module path matching the template (e.g., sap/fe/core/fpmExplorer/customKPIContent/CustomKPITag.fragment.xml). Configure number, unit, status, and optional press handler target. The press attribute can reference an extension/controller method using the dot-prefixed path pattern (see step 3).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/fragment/CustomKPITag.fragment.xml
     Module name: sap/fe/core/fpmExplorer/customKPIContent/CustomKPITag.fragment.xml
-->
<core:FragmentDefinition 
  xmlns="sap.m" 
  xmlns:core="sap.ui.core" 
  xmlns:macros="sap.fe.macros">
  
  <macros:KPITag
    number="{path: 'SomeProperty'}"     <!-- bind to model property or use static value like number="42" -->
    unit="Days"
    status="Error"                       <!-- semantic color: Error, Warning, Success, Neutral -->
    showIcon="true"
    press=".extension.sap.fe.core.fpmExplorer.customKPIContent.LRExtend.onKPIPressed" />
  
</core:FragmentDefinition>
```

**STEP**: 3 — Implement press handler in an extension controller

**DESCRIPTION**: If your KPI fragment uses a press handler, implement the referenced method. The manifest example uses a dot-prefixed extension path. Provide an extension controller (or hook) that exposes the handler name matching the press attribute. Below is a simple example that logs the KPI press and can navigate or open a dialog.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/extension/LRExtend.controller.js
// Module name: sap/fe/core/fpmExplorer/customKPIContent/LRExtend.js
sap.ui.define([], function () {
  "use strict";
  return {
    onKPIPressed: function (oEvent) {
      // oEvent.getSource() is the KPITag control
      var oKPITag = oEvent.getSource();
      // Example: log and show a simple message (replace with navigation or custom logic)
      /* eslint-disable no-console */
      console.log("KPI pressed:", oKPITag);
      /* eslint-enable no-console */

      // Example: navigate, open dialog, or trigger an action
      // var oRouter = this.getOwnerComponent().getRouter();
      // oRouter.navTo("TargetRoute", { id: ... });

      // If using MessageToast:
      // sap.m.MessageToast.show("KPI pressed");
    }
  };
});
```

**STEP**: 4 — Mapping fragment module name to file path and usage notes

**DESCRIPTION**: Ensure the template string in manifest.json equals the fragment module name using "/" => "." style for namespaces:
- template "sap.fe.core.fpmExplorer.customKPIContent.CustomKPITag" maps to file path: sap/fe/core/fpmExplorer/customKPIContent/CustomKPITag.fragment.xml (under webapp).
- The fragment must declare the sap.fe.macros namespace to use KPITag.

Use the KPITag macro to keep the same design as analytical KPIs. For annotation-based KPIs (analytical service) use OData annotations instead of manifest-based config.

References:
- KPITag macro API: https://ui5.sap.com/#/api/sap.fe.macros.KPITag
- Live examples: Standard Floorplans - Custom KPI Tag demo (UI5 test resources)
--------------------------------

**TITLE**: Custom State Handling for Extended Apps (Fiori Elements)

**INTRODUCTION**: Patterns and code examples to implement custom app-state handling for extended SAP Fiori Elements apps. Covers OData V2 object page extension methods (provide/apply state + extensionAPI signaling), lifecycle flag definitions, reuse-component state API, and the ViewState controller extension for OData V4 (control handlers, controller extension, manifest registration). Includes explicit code examples you can copy into controllers and manifest.json.

**TAGS**: sap.fiori, fiori-elements, app-state, view-state, extensionAPI, object-page, controller-extension, lifecycle, manifest

STEP: 1 — OData V2: Object Page — implement custom state lifecycle and signaling

DESCRIPTION: Override the object page controller extension methods to provide and apply persistable custom state. Call extensionAPI.onCustomStateChange() whenever a persistable UI state changes. Use the structure: oState.<key> = { data: <serializable object>, lifecycle: { session?, permanent?, page?, pagination? } }.

LANGUAGE: JavaScript

CODE:
```javascript
// File: ObjectPage.controller.js (controller extension for an Object Page)
// Methods to override in your object page controller extension:

// 1) Provide current custom state into the provided empty oState object:
provideCustomStateExtension: function(oState) {
  // Example: save a custom selectedTab and an opened panel state
  oState.myCustomSelection = {
    data: {
      selectedTab: this.getView().byId("myTabs").getSelectedKey(),
      panelOpen: this.getView().byId("myPanel").getExpanded()
    },
    lifecycle: {
      session: true,       // survives cross-app navigation within FLP session
      page: false,
      permanent: false,
      pagination: false
    }
  };
},

// 2) Apply incoming state (oState contains keys added above; values are the serialized 'data'):
applyCustomStateExtension: function(oState, bIsSameAsLast) {
  if (bIsSameAsLast) {
    // same instance visited; usually no UI adaptation necessary
    return;
  }
  if (oState && oState.myCustomSelection) {
    var data = oState.myCustomSelection; // already deserialized
    var oTabs = this.getView().byId("myTabs");
    var oPanel = this.getView().byId("myPanel");
    if (data.selectedTab) {
      oTabs.setSelectedKey(data.selectedTab);
    }
    if (typeof data.panelOpen === "boolean") {
      oPanel.setExpanded(data.panelOpen);
    }
  }
},

// 3) When your custom UI changes and you want the app state updated, call:
onCustomControlChange: function() {
  // inform framework that persistable state changed and should be captured
  this.extensionAPI.onCustomStateChange();
}
```

STEP: 2 — OData V2: onCustomStateChange vs extensionAPI.updateAppState

DESCRIPTION: Use extensionAPI.onCustomStateChange() to notify the framework that your custom persistable state changed. For OData V4/ViewState scenarios (see later), use extensionAPI.updateAppState() to trigger state recomputation. Both functions are provided by the ExtensionAPI available to controller extensions.

LANGUAGE: JavaScript

CODE:
```javascript
// Example usage within event handlers:
onSomeUserAction: function(oEvent) {
  // update your control state
  // ...
  // signal Fiori Elements to capture a new app state
  if (this.extensionAPI && typeof this.extensionAPI.onCustomStateChange === "function") {
    this.extensionAPI.onCustomStateChange();
  }
  // For V4 / ViewState scenarios, you may use:
  // this.extensionAPI.updateAppState();
}
```

STEP: 3 — Lifecycle flags: definitions and recommended use

DESCRIPTION: Lifecycle object for each state property must be an object with boolean flags. Use these to control how long the state should be recoverable and when it is applied.

LANGUAGE: JSON

CODE:
```json
{
  "lifecycle": {
    "session": true,     // survives cross-app navigation in the same FLP session (hash stored in URL)
    "permanent": false,  // survives sessions (requires server-side mapping + config); hash in URL persists
    "page": false,       // apply when user navigates to same page for different instance (use with care)
    "pagination": false  // like page but only when instances change via pagination (immediate replacement)
  }
}
```

STEP: 4 — Reuse Components: API to provide and apply state

DESCRIPTION: Reuse components cannot override controller extension methods. Implement the two functions below inside your custom control/component to participate in app-state handling. stGetCurrentState returns an object whose properties follow { data: <serializable>, lifecycle: { ... } } structure. stApplyState receives the state.data object and boolean bIsSameAsLast.

LANGUAGE: JavaScript

CODE:
```javascript
// Example: inside your reuse component's prototype or control implementation
stGetCurrentState: function() {
  return {
    myComponentState: {
      data: {
        // serializable control-specific state
        currentIndex: this._currentIndex,
        isExpanded: this._isExpanded
      },
      lifecycle: {
        session: true,
        page: false,
        permanent: false,
        pagination: false
      }
    }
  };
},

stApplyState: function(oState, bIsSameAsLast) {
  if (bIsSameAsLast) {
    return;
  }
  if (oState && oState.myComponentState) {
    var data = oState.myComponentState;
    this.setIndex(data.currentIndex);
    this.setExpanded(data.isExpanded);
  }
}
```

STEP: 5 — OData V4: ViewState controller extension — control handlers

DESCRIPTION: For OData V4, implement and register a ViewState controller extension to collect control states for app-state creation and to apply them. Provide control-specific handlers with retrieve(apply) functions and override adaptStateControls to register controls. The control handler signatures are: retrieve(oControl) => serializable; apply(oControl, oControlState, oNavParameters).

LANGUAGE: JavaScript

CODE:
```javascript
// Control state handler example for sap.uxap.ObjectPageLayout
var ObjectPageLayoutHandler = {
  retrieve: function(oOPLayout) {
    return {
      selectedSection: oOPLayout.getSelectedSection()
    };
  },
  apply: function(oOPLayout, oControlState, oNavParameters) {
    if (oControlState && "selectedSection" in oControlState) {
      oOPLayout.setSelectedSection(oControlState.selectedSection);
    }
  }
};
```

STEP: 6 — OData V4: Extend default ViewState controller extension (full example)

DESCRIPTION: Create a controller extension that overrides viewState functions: adaptControlStateHandler, adaptStateControls, retrieveAdditionalStates, applyAdditionalStates, and optional before/after hooks. Register this controller extension in manifest.json under sap.ui.controllerExtensions for the relevant template controller.

LANGUAGE: JavaScript

CODE:
```javascript
// File: Custom.LRControllerExtension.js
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension",
  "sap/m/MessageToast"
], function(ControllerExtension, MessageToast) {
  "use strict";

  return ControllerExtension.extend("Custom.LRControllerExtension", {
    override: {
      viewState: {
        adaptControlStateHandler: function(oControl, aControlHandlers) {
          if (oControl.isA("sap.f.DynamicPage")) {
            aControlHandlers.push({
              retrieve: function(oControl) {
                return { headerExpanded: oControl.getHeaderExpanded() };
              },
              apply: function(oControl, mControlState) {
                if (mControlState && ("headerExpanded" in mControlState)) {
                  oControl.setHeaderExpanded(mControlState.headerExpanded);
                }
              }
            });
          }
        },
        adaptStateControls: function(aControls) {
          // Add any view controls that should be part of view-state handling
          aControls.push(this.getView().byId("My::DynamicePage::Control"));
        },
        retrieveAdditionalStates: function(mAdditionalStates) {
          mAdditionalStates.lastVisit = new Date().toString();
        },
        applyAdditionalStates: function(mAdditionalStates) {
          if (mAdditionalStates && mAdditionalStates.lastVisit) {
            MessageToast.show("Applying view state from " + mAdditionalStates.lastVisit);
          }
        },
        // Optional hooks for async pre/post processing while applying state
        onBeforeStateApplied: function(aPromises) {
          // e.g. suspend events, push promises that must resolve before apply
        },
        onAfterStateApplied: function(aPromises) {
          // e.g. resume events once promises resolved
        }
      }
    }
  });
});
```

LANGUAGE: JSON

CODE:
```json
// File: manifest.json (fragment showing registration)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ListReport.ListReportController": {
            "controllerName": "Custom.LRControllerExtension"
          }
        }
      }
    }
  }
}
```

STEP: 7 — Trigger update of app-state for ViewState / V4

DESCRIPTION: When your custom view/control state changes in V4 scenarios, call extensionAPI.updateAppState() to request a new app-state capture. This is required when you implement custom view state handling so the overall app state includes your changes.

LANGUAGE: JavaScript

CODE:
```javascript
// Example: call this when a control's state changes (e.g., user toggles a header)
onCustomViewStateChange: function() {
  if (this.extensionAPI && typeof this.extensionAPI.updateAppState === "function") {
    // request the framework to recompute and store the app state (async)
    this.extensionAPI.updateAppState();
  }
}
```

STEP: 8 — Notes and best practices

DESCRIPTION: Quick actionable rules:
- Always ensure data objects in state are JSON-serializable and restorable via JSON.parse(JSON.stringify(...)).
- The lifecycle property is not passed to applyCustomStateExtension; it only controls which states are included in the saved state.
- Respect bIsSameAsLast: if true, typically avoid reapplying UI state.
- Use permanent lifecycle only for state relevant across sessions and users and ensure server-side mapping/config is in place.
- For reuse components implement stGetCurrentState and stApplyState (signatures shown above).
--------------------------------

**TITLE**: Customizing List Card

**INTRODUCTION**: Actions and annotation examples to customize Fiori Elements list cards: add smart links (semantic objects), control text arrangement displayed in lists, apply filters, and set default sorting/grouping. Use these annotated snippets directly in annotation files, ABAP CDS views, CAP model files, or the application descriptor (manifest.json).

**TAGS**: fiori-elements-framework, list-card, annotations, semantic-object, text-arrangement, selection-variant, filtering, sorting, CDS, CAP, XML, manifest.json

**STEP**: 1 — Add Smart Links (semantic object)
**DESCRIPTION**: Define a semantic object on the entity property so list items become smart-linked. Place XML annotations in your OData annotation file (referenced by the service). For ABAP CDS and CAP, add the corresponding annotations in the view/model file. The annotation target must point to EntitySet/Property.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: annotations.xml (example) -->
<Annotations Target="GWSAMPLE_BASIC.SalesOrder/SalesOrderID">
  <Annotation Term="com.sap.vocabularies.Common.v1.SemanticObject" String="OVP" />
</Annotations>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
// File: SALESORDER.view (ABAP CDS)
annotate view SALESORDER with {
  @Consumption.semanticObject: 'OVP'
  salesorderid;
}
```

**LANGUAGE**: CAP CDS
**CODE**:
```cql
// File: srv/cat-service.cds or model.cds (CAP)
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.SemanticObject : 'OVP'
  SalesOrderID;
};
```

**STEP**: 2 — Configure Text Arrangement in List Area
**DESCRIPTION**: Use the Text and TextArrangement annotations to control how a primary property and its descriptive text are displayed in a list. Add the XML annotation to your OData annotation file or apply equivalent annotations in CDS/CAP. TextArrangement types change how the property and description are combined:
- TextLast -> Property (Text)    e.g., ContractID (Customer)
- TextFirst -> Text (Property)   e.g., Customer (ContractID)
- TextOnly -> Text only          e.g., Customer
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: annotations.xml -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="GWSAMPLE_BASIC.SalesOrder/CustomerID">
  <Annotation Term="com.sap.vocabularies.Common.v1.Text" Path="Supplier_Name"/>
  <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast" />
</Annotations>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
// File: SALESORDER.view (ABAP CDS)
annotate view SALESORDER with {
  @UI.TextArrangement: #TEXT_LAST
  customerid;
}
```

**LANGUAGE**: CAP CDS
**CODE**:
```cql
// File: srv/cat-service.cds or model.cds (CAP)
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.Text : Supplier_Name
  @UI.TextArrangement : #TextLast
  CustomerID;
};
```

**STEP**: 3 — Add Filters to the List Card
**DESCRIPTION**: Add filters using the SelectionVariant annotation or by passing OData $filter via the card URL. Use SelectionVariant annotations in the OData annotation file to define reusable filter variants. Alternatively, append standard OData $filter query parameters to the card data URL.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: annotations.xml — SelectionVariant (minimal example) -->
<Annotations Target="GWSAMPLE_BASIC.SalesOrder">
  <Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant">
    <Record Type="com.sap.vocabularies.UI.v1.SelectionVariant">
      <PropertyValue Property="SelectOption" >
        <!-- Define SelectOption/Parameters per your service metadata -->
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: HTTP
**CODE**:
```http
# Example: pass a filter to the card's OData service URL (encode $ as %24 if needed)
https://host/path/to/odata/GWSAMPLE_BASIC.SalesOrder?$filter=CustomerID eq 'ALFKI'
```

**STEP**: 4 — Configure Sorting or Grouping in Application Descriptor
**DESCRIPTION**: Set default sort or group properties for the list card via the application descriptor (manifest.json). Add sortBy and sortOrder under the card content or settings section that defines the list card. The exact location depends on how your card is defined (sap.card or component configuration).
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.card": {
    "type": "List",
    "content": {
      "data": {
        "request": {
          "url": "/sap/opu/odata/sap/GWSAMPLE_BASIC/SalesOrder"
        }
      },
      "settings": {
        "sortBy": "SalesOrderID",
        "sortOrder": "Descending"
      }
    }
  }
}
```
--------------------------------

**TITLE**: Customizing Table Card — Smart Links, Text Arrangement, Filtering, Sorting

**INTRODUCTION**: Examples and actionable snippets to customize the table area of an SAP Fiori Elements/OVP table card: add semantic smart links, control text arrangement, apply filters via annotations or URL, and configure sorting in manifest.json. Use the language-specific examples (XML OData annotations, ABAP CDS, CAP CDS, manifest.json) directly in your metadata or app descriptor.

**TAGS**: fiori-elements-framework, OVP, table-card, annotations, smart-links, text-arrangement, selection-variant, sorting, manifest.json

STEP: 1 — Add Smart Links (semantic object on property)
DESCRIPTION: Define a semantic object for an entity property so the table card shows smart links. Apply the annotation to the property target in OData XML or annotate the CDS view (ABAP or CAP).
LANGUAGE: XML
CODE:
```xml
<!-- OData XML Annotation: Attach a semantic object to SalesOrderID -->
<Annotations Target="GWSAMPLE_BASIC.SalesOrder/SalesOrderID"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="com.sap.vocabularies.Common.v1.SemanticObject" String="OVP" />
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
/* ABAP CDS: annotate the salesorderid property with a semantic object */
annotate view SALESORDER with {
  @Consumption.semanticObject: 'OVP'
  salesorderid;
}
```

LANGUAGE: CDS
CODE:
```sql
-- CAP CDS: annotate the entity property with Common.SemanticObject
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.SemanticObject : 'OVP'
  SalesOrderID;
};
```

STEP: 2 — Text Arrangement in Table Area (Text binding + arrangement)
DESCRIPTION: Bind a text property and set a TextArrangement to control whether the label appears before/after/only. Use OData XML annotations or CDS annotations for ABAP/CAP.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation: bind Text and set TextArrangement to TextLast -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm"
             Target="GWSAMPLE_BASIC.SalesOrder/CustomerID">
  <Annotation Term="com.sap.vocabularies.Common.v1.Text" Path="Supplier_Name" />
  <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement"
              EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast" />
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
/* ABAP CDS: set text arrangement for customerid */
annotate view SALESORDER with {
  @UI.TextArrangement: #TEXT_LAST
  customerid;
}
```

LANGUAGE: CDS
CODE:
```sql
-- CAP CDS: bind text property and set UI.TextArrangement
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.Text : Supplier_Name,
  @UI.TextArrangement : #TextLast,
  CustomerID
};
```

DESCRIPTION: TextArrangement display mapping (behavior)
LANGUAGE: plain
CODE:
```text
TextLast  => ContractID (Customer)
TextFirst => Customer (ContractID)
TextOnly  => Customer
```

STEP: 3 — Filtering the Table Card (SelectionVariant or URL filter)
DESCRIPTION: Add a SelectionVariant annotation to apply default filters on the card, or pass an OData $filter in the card data URL. Use the SelectionVariant record to set select options.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation: SelectionVariant to filter by CustomerID -->
<Annotations Target="GWSAMPLE_BASIC.SalesOrder"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="com.sap.vocabularies.UI.v1.SelectionVariant">
    <Record Type="com.sap.vocabularies.UI.v1.SelectionVariant">
      <PropertyValue PropertyName="SelectOptions">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.SelectOption">
            <PropertyValue PropertyName="PropertyName" String="CustomerID" />
            <PropertyValue PropertyName="Sign" EnumMember="com.sap.vocabularies.UI.v1.SignType/I" />
            <PropertyValue PropertyName="Option" EnumMember="com.sap.vocabularies.UI.v1.OptionType/EQ" />
            <PropertyValue PropertyName="Low" String="COMPANY_A" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: plain
CODE:
```text
// Alternative: apply an OData filter in the card data URL (example)
.../GWSAMPLE_BASIC.SalesOrder?$filter=CustomerID eq 'COMPANY_A'
```

STEP: 4 — Sorting or Grouping via manifest.json
DESCRIPTION: Configure card sorting (sortBy and sortOrder) in the app descriptor (manifest.json). Place these properties under the card content configuration for the specific card.
LANGUAGE: JSON
CODE:
```json
{
  "sap.card": {
    "type": "List",
    "content": {
      "data": {
        "json": []
      },
      "sortBy": "CreationDate",
      "sortOrder": "Descending"
    }
  }
}
```

DESCRIPTION: Notes and references
LANGUAGE: plain
CODE:
```text
- Use the exact annotation target (EntitySet/Property) for XML annotations.
- For CDS, place annotations in the same file or separate annotation files according to project conventions.
- See "Configuring Card Filters" and "Configuring Sort Properties" for extended scenarios and UI-specific settings.
```
--------------------------------

**TITLE**: Data Points — Annotations for Header DataPoints and Number Formatting

**INTRODUCTION**: Use UI.DataPoint and UI.ReferenceFacet annotations to display single data points (numeric or textual) in the object page header (e.g., Price, Availability). This guide shows actionable annotation samples in XML, ABAP CDS, and CAP CDS and explains how to override decimal formatting using NumberOfFractionalDigits (UI.NumberFormat).

**TAGS**: fiori-elements, annotations, UI.DataPoint, UI.ReferenceFacet, NumberFormat, header, CDS, CAP, ABAP

**STEP**: 1 — Add data points to header using UI.ReferenceFacet

**DESCRIPTION**: Add UI.ReferenceFacet entries to the entity's header facets so the UI renders the referenced UI.DataPoint annotations (by qualifier) in the object page header. Place XML annotations in your annotations XML file for the entity, ABAP CDS annotations in the CDS view/structure, or CAP CDS annotations in your .cds or annotation file.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.HeaderFacets">
    <Collection>
        ...
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Price" />
        </Record>
        ...
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Target" AnnotationPath="to_StockAvailability/@UI.DataPoint#StockAvailability" />
        </Record>
        ...
    </Collection>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Facet: [
  {
    label: '{@i18n>@TechnicalData}',
    targetQualifier: 'TechnicalData',
    type: #FIELDGROUP_REFERENCE,
    purpose: #HEADER
  },
  {
    targetQualifier: 'Price',
    type: #DATAPOINT_REFERENCE,
    purpose: #HEADER
  },
  {
    targetQualifier: 'ProductCategory',
    type: #DATAPOINT_REFERENCE,
    purpose: #HEADER
  },
  {
    label: 'Employee',
    targetElement: 'TO_SUPPLIER',
    type: #CONTACT_REFERENCE,
    purpose: #HEADER
  }
]
product;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.HeaderFacets : [
    {
        $Type : 'UI.ReferenceFacet',
        Label : '{@i18n>@TechnicalData}',
        Target : '@UI.FieldGroup#TechnicalData'
    },
    {
        $Type : 'UI.ReferenceFacet',
        Target : '@UI.DataPoint#Price'
    },
    {
        $Type : 'UI.ReferenceFacet',
        Target : '@UI.DataPoint#ProductCategory'
    },
    {
        $Type : 'UI.ReferenceFacet',
        Label : 'Employee',
        Target : 'to_Supplier/@Communication.Contact'
    }
]
```

**STEP**: 2 — Define UI.DataPoint annotations (qualifier required)

**DESCRIPTION**: Each UI.DataPoint must use a qualifier. Specify Value (Path), Title (String), and optional properties like Criticality. Place these annotations in the annotations XML, ABAP CDS, or CAP CDS annotation area for the entity or complex type.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Price">
    <Record>
        <PropertyValue Property="Value" Path="Price" />
        <PropertyValue Property="Title" String="Price" />
    </Record>
</Annotation>

<Annotations Target="STTA_PROD_MAN.STTA_C_MP_StockAvailabilityType">
    <Annotation Term="UI.DataPoint" Qualifier="StockAvailability">
        <Record>
            <PropertyValue Property="Value" Path="StockAvailability" />
            <PropertyValue Property="Title" String="Availability" />
            <PropertyValue Property="Criticality" Path="StockAvailability" />
        </Record>
    </Annotation>
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.dataPoint: {
  title: 'Price'
}
Price;

@UI.dataPoint: {
  title: 'Category'
}
ProductCategory;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.DataPoint #Price : {
    Value : Price,
    Title : 'Price'
},
UI.DataPoint #ProductCategory : {
    Value : ProductCategory,
    Title : 'Category'
}
```

**STEP**: 3 — Numerical DataPoints: override decimals with NumberFormat.NumberOfFractionalDigits

**DESCRIPTION**: For numeric data points you can override metadata scale/precision and set displayed decimal places using NumberOfFractionalDigits in UI.NumberFormat (ValueFormat). Behavior summary:
- If NumberOfFractionalDigits is undefined → use metadata scale.
- If NumberOfFractionalDigits <= available precision → show requested decimals.
- If NumberOfFractionalDigits > available precision → show maximum allowed by precision (not more than metadata precision).
- A value of 0 still respects metadata scale if the metadata scale is greater than 0 (see examples below).

Examples below show the same numeric metadata (scale=3, precision=15) with varying NumberOfFractionalDigits and resulting decimal places displayed:
- NumberOfFractionalDigits undefined → 3 decimals
- NumberOfFractionalDigits = 5 → 5 decimals
- NumberOfFractionalDigits = 1 → 1 decimal
- NumberOfFractionalDigits = 20 → 14 decimals (capped by precision)
- NumberOfFractionalDigits = 0 → 3 decimals (falls back to scale)

Implement ValueFormat with NumberOfFractionalDigits inside the UI.DataPoint.ValueFormat (UI.NumberFormat).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Weight">
    <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
        <PropertyValue Property="Value" Path="Weight" />
        <PropertyValue Property="Title" String="Weight" />
        <PropertyValue Property="ValueFormat">
            <Record Type="com.sap.vocabularies.UI.v1.NumberFormat">
                <PropertyValue Property="NumberOfFractionalDigits" Int="5"/>
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.dataPoint: {
  title: 'Weight',
  valueFormat: {
    numberOfFractionalDigits: 5
  }
}
Weight;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.DataPoint #Weight : {
    $Type : 'UI.DataPointType',
    Value : Weight,
    Title : 'Weight',
    ValueFormat : {
        $Type : 'UI.NumberFormat',
        NumberOfFractionalDigits : 5
    }
}
```
--------------------------------

**TITLE**: Defining Actions in UI.Chart (Chart Toolbar) for SAP Fiori Elements

**INTRODUCTION**: This document shows how to add action buttons to a chart toolbar by defining the Actions collection inside the UI.Chart annotation. It includes XML, ABAP CDS and CAP CDS samples and actionable rules for visibility and enablement (OData V2 and V4). Use these examples inside your CDS or annotation XML files to expose toolbar buttons for charts.

**TAGS**: fiori-elements, UI.Chart, chart, actions, UI.DataFieldForAction, UI.DataFieldForIntentBasedNavigation, OData V2, OData V4, CDS, ABAP, CAP, XML

STEP: 1 — Core rules for chart toolbar actions

DESCRIPTION: Requirements and behavior summary (apply before adding annotations)
- The UI.Chart Actions property must be a collection containing UI.DataFieldForAction and/or UI.DataFieldForIntentBasedNavigation records.
- For an action button to be visible in the chart toolbar, for both UI.DataFieldForAction and UI.DataFieldForIntentBasedNavigation the properties Determining and Inline must be either false or not defined.
- UI.DataFieldForAction toolbar actions do NOT support passing context (no binding of selected chart context).
- For navigation actions, use RequiresContext (default true). If true, user must select a chart item for the action to be enabled; set to false to always enable the button.
- If you control visibility via a path-based setting (applicable-path for V2 or OperationAvailable for V4), the referenced property must belong to the parent entity set — it must NOT reference a property in the chart entity set.

LANGUAGE: text

CODE:
```text
Core constraints:
- Actions collection element types allowed:
  - UI.DataFieldForAction
  - UI.DataFieldForIntentBasedNavigation

- Visibility rule:
  - Determining: false or undefined
  - Inline: false or undefined

- Context / enablement:
  - UI.DataFieldForAction: no context passing
  - UI.DataFieldForIntentBasedNavigation: set RequiresContext = true|false
    - true (default): requires chart selection
    - false: always enabled

- Path-based rules:
  - applicable-path (V2) / OperationAvailable (V4) must reference a property on the parent entity set.
```

STEP: 2 — XML Annotation sample for UI.Chart (add two toolbar actions: simple action and intent-based nav)

DESCRIPTION: Add the Actions collection to your UI.Chart XML annotation. Include Label and Action for DataFieldForAction; use SemanticObject + Action for DataFieldForIntentBasedNavigation. Set InvocationGrouping for grouping behavior.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.Chart">
    <Record>
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>product</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>sales</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Actions">
            <Collection>
                <!-- Action: UI.DataFieldForAction -->
                <Record Type="UI.DataFieldForAction">
                    <PropertyValue Property="Label" String="provide_label"/>
                    <PropertyValue Property="Action" String="provide_action_name"/>
                    <!-- InvocationGrouping: UI.OperationGroupingType/Isolated | Default grouping options -->
                    <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/Isolated"/>
                    <!-- Determining and Inline must be false or not present for toolbar visibility -->
                </Record>

                <!-- Intent-based navigation: UI.DataFieldForIntentBasedNavigation -->
                <Record Type="UI.DataFieldForIntentBasedNavigation">
                    <PropertyValue Property="Label" String="provide_label"/>
                    <PropertyValue Property="SemanticObject" String="provide_semantic_object"/>
                    <PropertyValue Property="Action" String="provide_action_name"/>
                    <!-- Optionally: RequiresContext (true/false) -->
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 3 — ABAP CDS Annotation sample (UI.Chart) — add actions in CDS view annotation

DESCRIPTION: Use the @UI.Chart annotation array in ABAP CDS to define measures, dimensions and actions. For DataFieldForAction, set dataAction and invocationGrouping. For intent-based navigation set semanticObjectAction. Ensure type values reflect FOR_ACTION / FOR_INTENT_BASED_NAVIGATION.

LANGUAGE: CDS

CODE:
```abap
@UI.Chart: [
  {
    chartType: #COLUMN,
    dimensions: [
      'PRODUCT'
    ],
    measures: [
      'SALES'
    ],
    actions: [
      {
        label: 'provide_label',
        dataAction: 'PUSHDOWN:provide_action_name',    " use appropriate action binding (e.g. PUSHDOWN:)
        invocationGrouping: #ISOLATED,                 " #ISOLATED corresponds to isolated grouping
        type: #FOR_ACTION                               " UI.DataFieldForAction equivalent
      },
      {
        label: 'provide_label',
        semanticObjectAction: 'provide_action_name',
        type: #FOR_INTENT_BASED_NAVIGATION              " UI.DataFieldForIntentBasedNavigation equivalent
      }
    ]
  }
]
annotate view STTA_C_MP_PRODUCTSALESDATA with {
}
```

STEP: 4 — CAP CDS Annotation sample (UI.Chart object) 

DESCRIPTION: In service or model CDS for CAP, define UI.Chart with $Type entries for DataFieldForAction and DataFieldForIntentBasedNavigation. Use Action and InvocationGrouping and SemanticObject fields like in XML.

LANGUAGE: CDS

CODE:
```cds
UI.Chart : {
    ChartType : #Column,
    Dimensions : [
        product
    ],
    Measures : [
        sales
    ],
    Actions : [
        {
            $Type : 'UI.DataFieldForAction',
            Label : 'provide_label',
            Action : 'provide_action_name',
            InvocationGrouping : #Isolated
            -- Determining and Inline should be false or omitted
        },
        {
            $Type : 'UI.DataFieldForIntentBasedNavigation',
            Label : 'provide_label',
            SemanticObject : 'provide_semantic_object',
            Action : 'provide_action_name'
            -- You can add RequiresContext : false to always enable
        }
    ]
}
```

STEP: 5 — Control enablement: OData V2 (chart toolbar)

DESCRIPTION: For UI.DataFieldForAction enablement, use the Action Control mechanism described in "Using Action Control for Context-Dependent Actions". For UI.DataFieldForIntentBasedNavigation use RequiresContext property:
- RequiresContext = true (default) → requires selection in chart to be enabled
- RequiresContext = false → always enabled
Note: If using applicable-path to control visibility, the referenced property must belong to the parent entity set (not the chart entity set).

LANGUAGE: text

CODE:
```text
OData V2 enablement rules:
- UI.DataFieldForAction: use Action Control (see Using Action Control for Context-Dependent Actions).
- UI.DataFieldForIntentBasedNavigation:
    - RequiresContext: true | false
      - true (default): requires selection to enable button
      - false: button always enabled
- Path-based visibility (applicable-path): must reference property on parent entity set.
```

STEP: 6 — Control enablement: OData V4 (chart toolbar)

DESCRIPTION: Use the same enablement pattern as tables for V4: control enable/disable using the OperationAvailable/OperationApplicable settings (see "Adding Actions to Tables" — Enablement of Operations). If using OperationAvailable, it must reference a property from the parent entity set (not the chart entity set).

LANGUAGE: text

CODE:
```text
OData V4 enablement rules:
- Use OperationAvailable / OperationApplicable (as in "Adding Actions to Tables" -> Enablement of Operations) to enable/disable actions based on selection/context.
- Path-based OperationAvailable must reference a property on the parent entity set (not the chart entity set).
```

STEP: 7 — Helpful UI artifacts and images (for documentation/UX reference)

DESCRIPTION: Reference image file names used in documentation if you need to include UI screenshots in docs or tests.

LANGUAGE: text

CODE:
```text
Referenced images:
- images/Actions_in_Smart_Chart_Toolbar_067d5d8.png
- images/ChartActions_NavProps_9111386.png
```
--------------------------------

**TITLE**: Defining and Adapting Object Page Sections (UI.Facets) — Actionable Annotation & Manifest Samples

**INTRODUCTION**: This document gives concise, actionable examples and rules to define sections and subsections on the Object Page using UI.Facets annotations (XML, ABAP CDS, CAP CDS). It also shows how to render lists/tables in sections, control visibility, set stable IDs, and configure manifest settings for layout and tabs. Use these exact snippets in your annotation files or manifest to implement or adapt object page sections.

**TAGS**: fiori-elements-framework, object-page, facets, collectionfacet, referencefacet, UI.Facets, annotations, manifest, CDS, CAP, ABAP, XML, table, layout

STEP: 1 — Define top-level facets (ReferenceFacet and CollectionFacet)

DESCRIPTION: Add top-level facets under the UI.Facets annotation. Reference facets point to field groups, line items, charts, or identification sections. Collection facets group multiple reference facets (create subsections). Use these examples in your entity annotations file.

LANGUAGE: XML

CODE:
```xml
<!-- Place in an annotations XML file for your entity -->
<Annotation Term="UI.Facets">
  <Collection>
    <!-- ReferenceFacet pointing to a field group -->
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="{@i18n>@GeneralInfoFacetLabel}"/>
      <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#GeneralInformation" />
    </Record>

    <!-- CollectionFacet (top-level section) with nested facets -->
    <Record Type="UI.CollectionFacet">
      <PropertyValue Property="ID" String="FurtherData"/>
      <PropertyValue Property="Label" String="{@i18n>@FurtherData}"/>
      <PropertyValue Property="Facets">
        <Collection>
          <!-- Subsection: second-level collection facet or reference facets go here -->
          <Record Type="UI.CollectionFacet">
            <!-- add nested ReferenceFacet records inside this Collection to create subsections -->
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.Facet: [
  {
    label: '{@i18n>@GeneralInfoFacetLabel}',
    targetQualifier: 'GeneralInformation',
    type: #FIELDGROUP_REFERENCE,
    purpose: #STANDARD
  },
  {
    id: 'FurtherData',
    label: '{@i18n>@FurtherData}',
    type: #COLLECTION,
    purpose: #STANDARD
  },
  {
    parentId: 'FurtherData',
    purpose: #STANDARD
  }
]
entity: product;
```

LANGUAGE: CAP CDS

CODE:
```cds
// Place in your .cds file for the entity
annotate product with @(
  UI.Facets: [
    {
      $Type: 'UI.ReferenceFacet',
      Label : '{@i18n>@GeneralInfoFacetLabel}',
      Target : '@UI.FieldGroup#GeneralInformation'
    },
    {
      $Type : 'UI.CollectionFacet',
      ID : 'FurtherData',
      Label : '{@i18n>@FurtherData}',
      Facets : [
        {
          $Type : 'UI.CollectionFacet'
          // add nested reference facets here
        }
      ]
    }
  ]
);
```

STEP: 2 — Create a subsection (second-level collection facet) and arrange reference facets side-by-side

DESCRIPTION: To create subsections, add a CollectionFacet under a top-level CollectionFacet and then add ReferenceFacet entries within it. Reference facets that are children of the second-level collection facet are arranged horizontally (side-by-side).

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.Facets">
  <Collection>
    <Record Type="UI.CollectionFacet">
      <PropertyValue Property="ID" String="FacetIdentifier1"/>
      <PropertyValue Property="Label" String="Section 1"/>
      <PropertyValue Property="Facets">
        <Collection>
          <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="ID" String="FacetIdentifier2"/>
            <PropertyValue Property="Target" AnnotationPath="_Child/@UI.LineItem"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>

    <!-- second top-level CollectionFacet with nested reference facet to a SelectionPresentationVariant -->
    <Record Type="UI.CollectionFacet">
      <PropertyValue Property="ID" String="FacetIdentifier2"/>
      <PropertyValue Property="Label" String="Section 2"/>
      <PropertyValue Property="Facets">
        <Collection>
          <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="ID" String="FacetIdentifier2"/>
            <PropertyValue Property="Target" AnnotationPath="_Child/@UI.SelectionPresentationVariant#mySPV"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Collection>
</Annotation>
```

STEP: 3 — Make a facet conditionally visible (hide/display based on a property)

DESCRIPTION: Use UI.Hidden with a Path to a boolean property to hide/show a facet at runtime. Use the example in your XML annotations or CAP/ABAP CDS.

LANGUAGE: XML

CODE:
```xml
<Record Type="UI.ReferenceFacet">
  <Annotation Term="UI.Hidden" Path="IsActiveEntity"/>
  <PropertyValue Property="Label" String="{@i18n>@SalesData}" />
  <PropertyValue Property="Target" AnnotationPath="to_ProductSalesData/@UI.Chart" />
</Record>
```

LANGUAGE: CAP CDS

CODE:
```cds
// CAP-style UI.Facets with UI.Hidden
UI.Facets : {
  $Type : 'UI.ReferenceFacet',
  Label : '{@i18n>@SalesData}',
  Target : 'to_ProductSalesData/@UI.Chart',
  ![@UI.Hidden] : IsActiveEntity
}
```

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.facet: [
 {
  label: '{@i18n>@SalesData}',
  type:         #DATAPOINT_REFERENCE,
  targetElement: '_PRODUCTSALESDATA',
  purpose: #STANDARD
 }
]
entity: product;
```

STEP: 4 — Render a table (list) inside a section

DESCRIPTION: To render a table in a section, ensure the referenced annotation is UI.LineItem, UI.PresentationVariant, or (OData V4) UI.SelectionPresentationVariant which includes a PresentationVariant whose first visualization is UI.LineItem. Reference that annotation from a ReferenceFacet. To enable a Create button, set Org.OData.Capabilities.V1.InsertRestrictions/Insertable/Bool = true on the entity set.

LANGUAGE: XML

CODE:
```xml
<!-- Reference to a LineItem visualization inside a CollectionFacet -->
<Annotation Term="UI.Facets">
  <Collection>
    <Record Type="UI.CollectionFacet">
      <PropertyValue Property="ID" String="FacetIdentifier1"/>
      <PropertyValue Property="Label" String="Section 1"/>
      <PropertyValue Property="Facets">
        <Collection>
          <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="ID" String="FacetIdentifier2"/>
            <PropertyValue Property="Target" AnnotationPath="_Child/@UI.LineItem"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: CAP CDS

CODE:
```cds
// CAP sample facets referencing a LineItem and a SelectionPresentationVariant
UI.Facets : [
  {
    $Type : 'UI.CollectionFacet',
    ID    : 'FacetIdentifier1',
    Label : 'Section 1',
    Facets: [{
      $Type : 'UI.ReferenceFacet',
      ID    : 'FacetIdentifier2',
      Target: '_Child/@UI.LineItem'
    }]
  },
  {
    $Type : 'UI.CollectionFacet',
    ID    : 'FacetIdentifier2',
    Label : 'Section 2',
    Facets: [{
      $Type : 'UI.ReferenceFacet',
      ID    : 'FacetIdentifier2',
      Target: '_Child/@UI.SelectionPresentationVariant#mySPV'
    }]
  }
]
```

NOTE (no code): Ensure InsertRestrictions/Insertable = true on the entity set for the create button:
- Path: Org.OData.Capabilities.V1.InsertRestrictions/Insertable/Bool = true (set in service/metadata annotations for the entity set).

STEP: 5 — Define stable IDs for collection facets (mandatory for collection facets)

DESCRIPTION: To support extensions, personalization, and tests, set an explicit ID for collection facets. Use camelCase, unique within the entity, no spaces. Do not add or change IDs after app delivery because controls' stable IDs are derived from these facet IDs.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.Facets">
  <Collection>
    <Record Type="UI.CollectionFacet">
      <PropertyValue Property="ID" String="GeneralInformation"/>
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.Facet: [
  {
    id: 'GeneralInformation',
    type: #COLLECTION,
    purpose: #STANDARD
  }
]
entity: product;
```

LANGUAGE: CAP CDS

CODE:
```cds
UI.Facets : [
  {
    $Type : 'UI.CollectionFacet',
    ID : 'GeneralInformation'
  }
]
```

NOTE (no code): If no ID is provided for a reference facet, the runtime derives it from the annotation path by replacing "/@" with "::", e.g.:
- Derived ID example: to_ProductText::com.sap.vocabularies.UI.v1.LineItem

STEP: 6 — Configure SmartForm column layout and switch to responsive grid

DESCRIPTION: Change the SmartForm default column count or switch SmartForm layout to the responsive grid via manifest.json settings under sap.ui.generic.app -> settings.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "settings": {
      "objectPageColumns": {
        "screenSizeXL": 4
      }
    }
  }
}
```

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "useColumnLayoutForSmartForm": false
    }
  }
}
```

STEP: 7 — Choose Tab representation for sections via manifest (sectionLayout: "Tabs")

DESCRIPTION: To present top-level sections as tabs rather than anchors, set sectionLayout: "Tabs" in the object page component entry in the manifest under options.settings. Use this when you prefer separate tabbed sections (recommended for grid/UI.Table usage).

LANGUAGE: JSON

CODE:
```json
{
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "contextPath": "/SalesOrderManage",
        "navigation": {
          "_Item": {
            "detail": {
              "route": "SalesOrderItemObjectPage"
            }
          },
          "SalesOrderManage": {
            "detail": {
              "route": "SalesOrderManageObjectPage",
              "parameters": {
                "key": "{_ReferencedSalesOrder/ID}"
              }
            }
          }
        },
        "sectionLayout": "Tabs"
      }
    }
  }
}
```

STEP: 8 — Important behavioral rules & recommendations (V2 vs V4, nesting, titles, tables)

DESCRIPTION: Quick action-oriented rules to avoid runtime/rendering issues and to meet accessibility and layout expectations.

LANGUAGE: text

CODE:
```
- In OData V2: reference facets outside a second-level collection facet are ignored. If no second-level collection facet exists, all reference facets are considered.
- In OData V4: reference facets outside a second-level collection facet are shown as separate subsections.
- Do not use UI.CollectionFacet at third level or deeper — only up to second-level collection facets are supported.
- Avoid placing a UI.CollectionFacet under UI.Facets if it contains only one UI.ReferenceFacet; use UI.ReferenceFacet directly to prevent rendering issues.
- Do not use commas in section/subsection titles (commas are treated as delimiters for backend message grouping).
- Icon tab bar: section title is hidden in the content area. Anchor bar: the first section's title is hidden in content area.
- Page layout mode: if a section/subsection contains only a table or chart, the section title is hidden and the control title is replaced by the section title (Tabs mode: applies only to subsections; OData V2 has additional runtime conditions).
- Increased height behavior: if the page contains only one section with one table or uses icon tab bar and a section has only one table:
    - ui.table expands to use full page height (more rows)
    - sap.m.Table expands to show 20 rows
- For tables with many entries, configure selection mode and consider MultiSelectionPlugin (see selection docs).
- When a UI.FieldGroup contains only one UI.MultiLineText property, the TextArea label is hidden; ensure the TextArea has a meaningful label for screen readers.
- Responsive column layout: default is 6 columns (XL); it adapts automatically by screen size.
- If a ReferenceFacet uses a chart or table, make sure it is the only content in that ReferenceFacet (no peer ReferenceFacet), otherwise rendering issues can occur.
```

--------------------------------

**TITLE**: Defining Custom Actions

**INTRODUCTION**: This guide shows how to add custom actions to quick view cards in stack card object streams (buttons in the quick view footer) and how to add custom global actions to the smart filter bar. It provides the required controller/fragment files and the manifest.json entries to wire those custom actions into an SAPUI5 / Fiori Elements OVP app.

**TAGS**: fiori-elements-framework, sap.ovp, ui5, manifest.json, custom-actions, quick-view, smart-filter-bar

**STEP**: 1 — Create a custom controller with press handlers and the onCustomActionPress hook

**DESCRIPTION**: Create a JS controller that exposes:
- press handler functions that implement the action behavior.
- an onCustomActionPress(sCustomAction) hook that returns the handler function by name. The stack card passes the press property (string) and the hook must return the function reference.

Place this file in your extension/controller folder and reference it from the manifest (next step).

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// File: webapp/ext/controller/customConfiguration.controller.js
sap.ui.define([], function () {
    "use strict";
    return {
        /**
         * Hook: returns a handler function reference based on the press name provided in manifest.json
         * @param {string} sCustomAction - name of the press handler as declared in manifest customActions.press
         * @returns {function} - function reference to be executed on press
         */
        onCustomActionPress: function (sCustomAction) {
            if (sCustomAction === "press1") {
                return this.press1;
            } else if (sCustomAction === "press2") {
                return this.press2;
            }
            // return undefined if not found
        },

        /**
         * Press handler 1
         * @param {sap.ui.base.Event} oEvent
         */
        press1: function (oEvent) {
            window.open("https://www.google.co.in");
        },

        /**
         * Press handler 2
         * @param {sap.ui.base.Event} oEvent
         */
        press2: function (oEvent) {
            window.open("http://www.sap.com/index.html");
        }
    };
});
```

**STEP**: 2 — Register controller extension in manifest.json

**DESCRIPTION**: Add your controller extension under sap.ui5 -> extends -> extensions -> sap.ui.controllerExtensions, mapping the OVP app main controller to your custom controller. Use the fully-qualified controller name matching the file path (dot-separated).

**LANGUAGE**: JSON

**CODE**:
```JSON
// manifest.json (partial)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.ovp.app.Main": {
            "controllerName": "my_app.ext.controller.customConfiguration"
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Add customActions to a stack card's objectStreamCardsSettings

**DESCRIPTION**: Under the relevant card entry in manifest.json, add objectStreamCardsSettings.customActions (array). Each action must include:
- text: string shown in the quick view footer
- press: name of the handler (string) that onCustomActionPress will map to a function
- position: numeric ordering value for placement in the footer

The example below shows a stack card configuration with multiple custom actions.

**LANGUAGE**: JSON

**CODE**:
```JSON
// manifest.json (card snippet)
{
  "sap.ovp": {
    "cards": {
      "card007_ProductsOutOfStock": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.stack",
        "settings": {
          "itemText": "{{stackCard_itemText}}",
          "title": "Products Out of Stock",
          "subTitle": "SalesOrderSet Stack Card",
          "requireAppAuthorization": "#Action-toappnavsample",
          "entitySet": "SalesOrderSet",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification,com.sap.vocabularies.UI.v1.Identification#item2",
          "objectStreamCardsSettings": {
            "showFirstActionInFooter": false,
            "customActions": [
              { "text": "text1", "press": "press1", "position": 1 },
              { "text": "text2", "press": "press2", "position": 10 },
              { "text": "text3", "press": "press1", "position": 3 },
              { "text": "text4", "press": "press2", "position": 8 },
              { "text": "text5", "press": "press1", "position": 5 },
              { "text": "text6", "press": "press2", "position": 6 }
            ]
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Add custom global action to Smart Filter Bar (manifest entries)

**DESCRIPTION**: To add global actions on the smart filter bar, register both:
- controller extension (controller handling events)
- view extensions (fragment definitions) for SmartFilterBarControlConfigurationExtension and SmartFilterBarGlobalActionExtension

Below is a manifest snippet registering the controller extension and view fragment extensions. Update the controllerName and fragmentName values to match file locations.

**LANGUAGE**: JSON

**CODE**:
```JSON
// manifest.json (sap.ui5 partial)
{
  "sap.ui5": {
    "_version": "1.1.0",
    "dependencies": {
      "libs": {
        "sap.ovp": {}
      }
    },
    "models": {
      "i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "uri": "i18n/i18n.properties"
      },
      "salesOrder": {
        "dataSource": "salesOrder",
        "settings": {}
      }
    },
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.ovp.app.Main": {
            "controllerName": "sap.ovp.demo.ext.customFilter"
          }
        },
        "sap.ui.viewExtensions": {
          "sap.ovp.app.Main": {
            "SmartFilterBarControlConfigurationExtension|GlobalFilters": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "sap.ovp.demo.ext.customFilter",
              "type": "XML"
            },
            "SmartFilterBarGlobalActionExtension": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "sap.ovp.demo.ext.customAction",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Create the fragment for the global action button

**DESCRIPTION**: Define an XML fragment containing the button(s) you want on the smart filter bar. The fragment press handler name must match a function in the controller extension.

**LANGUAGE**: XML

**CODE**:
```XML
<!-- File: webapp/ext/fragment/customAction.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m"
                         xmlns:smartfilterbar="sap.ui.comp.smartfilterbar"
                         xmlns:core="sap.ui.core">
    <Button text="Action" press="handleCustomAction" type="Transparent" />
</core:FragmentDefinition>
```

**STEP**: 6 — Create the controller for the smart filter bar global action

**DESCRIPTION**: Implement the handler referenced by the fragment (handleCustomAction). Register this controller under manifest (controllerName used above). The handler can interact with models, filters, or show messages.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// File: webapp/ext/controller/customFilter.controller.js
sap.ui.define([
    "sap/ui/model/Filter",
    "sap/m/MessageToast"
], function (Filter, MessageToast) {
    "use strict";

    return {
        /**
         * Handler for the custom global action button defined in the fragment
         */
        handleCustomAction: function () {
            var msg = "Custom Global Action clicked";
            MessageToast.show(msg);
        }
    };
});
```
--------------------------------

**TITLE**: Defining Custom Actions for Analytical List Page (ALP) — manifest.json + Controller Extensions

**INTRODUCTION**: This document shows how to define custom actions for SAP Fiori elements Analytical List Page (OData V2) by extending manifest.json and implementing controller handlers. It covers keyboard shortcuts (sap.ui.commands), action positioning (global / table / chart), selection handling with extensionAPI.getSelectedContexts(), and invoking backend actions with extensionAPI.invokeActions. Use only the extensionAPI from SAP Fiori elements in your extension code.

**TAGS**: analytical-list-page, manifest.json, controllerExtensions, extensionAPI, getSelectedContexts, invokeActions, sap.ui.commands, OData V2, ALP

STEP: 1 — Define keyboard shortcuts (sap.ui.commands) in manifest.json
DESCRIPTION: Add a command entry under sap.ui.commands for the ALP view instance to map a keyboard shortcut to a command id. This command id can be referenced from action definitions via the "command" property.
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (snippet)
{
  "sap.ui5": {
    "_version": "1.1.0",
    "extends": {
      "extensions": {
        "sap.ui.commands": {
          // Key is the ALP view instance (viewId#component::EntitySet)
          "sap.suite.generic.template.AnalyticalListPage#sap.suite.generic.template.AnalyticalListPage::ZCostCenterCostQuery0020": {
            "GlobalActionCommand": {
              "shortcut": "Ctrl+B"
            }
          }
        }
      }
    }
  }
}
```

STEP: 2 — Define controller extension and custom actions in manifest.json
DESCRIPTION: Under sap.ui.controllerExtensions, extend the ALP controller and define Actions for a specific EntitySet. Include properties: id, text (i18n binding), press (handler name in your custom controller), filter (chart/table), global, requiresSelection, determining, and command (reference to sap.ui.commands id).
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (extended snippet)
{
  "sap.ui5": {
    "_version": "1.1.0",
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
            "controllerName": "my_app.ext.controller.AnalyticalListPageExt",
            "sap.ui.generic.app": {
              "ZCostCenterCostQuery0020": {
                "EntitySet": "ZCostCenterCostQuery0020",
                "Actions": {
                  "Action A": {
                    "id": "ActionA",
                    "text": "{{Action A}}",
                    "press": "onClickActionA",
                    "global": true,
                    "command": "GlobalActionCommand"
                  },
                  "Action B": {
                    "id": "ActionB_requiresSelection",
                    "text": "{{Action B}}",
                    "press": "onClickActionB",
                    "filter": "table",
                    "requiresSelection": true
                  },
                  "Action C": {
                    "id": "ActionC_requiresSelection",
                    "text": "{{Action C}}",
                    "press": "onClickActionC",
                    "filter": "chart",
                    "requiresSelection": true
                  },
                  "Action D": {
                    "id": "ActionD",
                    "text": "{{Action D}}",
                    "press": "onClickActionD",
                    "filter": "table"
                  },
                  "Action E": {
                    "id": "ActionE",
                    "text": "{{Action E}}",
                    "press": "onClickActionE",
                    "filter": "chart"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — Implement controller extension handlers and selection handling
DESCRIPTION: Implement the controller extension referenced by manifest (controllerName). Use this.extensionAPI.getSelectedContexts() synchronously to obtain selected contexts. If calling a confirmation dialog or asynchronous UI, cache the selected contexts in a local variable before the async call. For chart toolbar actions, call getSelectedContexts(oEvent.ID) — ensure the handler receives the oEvent parameter.
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/ext/controller/AnalyticalListPageExt.js
sap.ui.define([
  "sap/m/MessageBox"
], function (MessageBox) {
  "use strict";

  return {
    // Rebind extension hooks (optional)
    onBeforeRebindTableExtension: function (oEvent) {
      // Example hook: called before table rebind
      // Use oEvent.getParameter("bindingParams") to adjust filters, etc.
      console.log("onBeforeRebindTableExtension called!");
    },

    onBeforeRebindChartExtension: function (oEvent) {
      console.log("onBeforeRebindChartExtension called!");
    },

    // Global action handler (keyboard shortcut mapping example)
    onClickActionA: function (oEvent) {
      console.log("Global Action Shortcut Key triggers");
      // Example: show alert or custom logic
      alert("Action A triggered (global)");
    },

    // Table toolbar action that requires selection
    onClickActionB: function (oEvent) {
      // IMPORTANT: getSelectedContexts() must be called synchronously and cached
      var aContexts = this.extensionAPI.getSelectedContexts(); // sync call
      // Use a confirmation dialog; pass cached contexts to callback
      MessageBox.confirm("Would you like to perform the action?", {
        title: "Confirm",
        actions: [MessageBox.Action.OK, MessageBox.Action.CANCEL],
        emphasizedAction: MessageBox.Action.OK,
        onClose: this.onActionConfirm.bind(this, aContexts)
      });
    },

    // Confirmation handler receives cached contexts first, then action result
    onActionConfirm: function (aContexts, sAction) {
      if (sAction === sap.m.MessageBox.Action.OK) {
        // Invoke backend action mapped to action binding path e.g. "/ActionB"
        // invokeActions(path, contextsArray, mParameters)
        this.extensionAPI.invokeActions("/ActionB", aContexts).then(function () {
          // post-invocation logic
          console.log("ActionB invoked on backend for selected contexts");
        }).catch(function (oError) {
          console.error("invokeActions error", oError);
        });
      }
    },

    // Chart toolbar action: pass event ID to getSelectedContexts to get chart selection
    onClickActionC: function (oEvent) {
      // oEvent is required here; pass oEvent.ID to getSelectedContexts
      var aChartContexts = this.extensionAPI.getSelectedContexts(oEvent.ID);
      // Example: process chart selection
      alert("Action C triggered for selected chart contexts: " + (aChartContexts ? aChartContexts.length : 0));
    },

    onClickActionD: function (oEvent) {
      alert("Action D (table-only) clicked!");
    },

    onClickActionE: function (oEvent) {
      alert("Action E (chart-only) clicked!");
    }
  };
});
```

STEP: 4 — Invoke backend actions directly via extensionAPI
DESCRIPTION: Use this.extensionAPI.invokeActions(pathToAction, aContexts, mParameters) to invoke a backend action (OData action/function). Provide example showing parameters and promise handling.
LANGUAGE: JavaScript
CODE:
```javascript
// Example: invoking a backend action from a handler
onClickInvokeOrderAction: function (oEvent) {
  var oApi = this.extensionAPI;
  var mParameters = {
    "SalesOrderID": "500000052"
  };
  // First param: full service/action path or entity-bound action path
  // Second param: array of contexts (can be empty)
  // Third param: parameters for the action
  oApi.invokeActions(
    "STTA_SALES_ORDER_ND_SRV_01/AFF8CCF97ACESave_stta_i_so_salesorder_nd",
    [],
    mParameters
  ).then(function (oResult) {
    console.log("Action completed", oResult);
  }).catch(function (oError) {
    console.error("Action failed", oError);
  });
}
```

STEP: 5 — Action property reference and behavioral notes
DESCRIPTION: Quick reference for action properties and behavior when defining Actions in manifest.json.
LANGUAGE: JSON
CODE:
```json
/*
Property Reference:
- EntitySet:           (string) EntitySet displayed on ALP. Define Actions only for the main entity set if multiple views exist.
- id:                  (string) ID used for the action button.
- text:                (string) Button text (usually i18n binding, e.g. "{{MY_BUTTON_TEXT}}").
- press:               (string) Handler function name in the controller extension.
- filter:              (string) "table" | "chart" | "global" — where the action appears.
- global:              (boolean) true if global action (default false). If "determining" is set, global takes precedence.
- requiresSelection:   (boolean) Only relevant for table actions. Default true.
- determining:         (boolean) If true, renders action in page footer (ALP). Default false.
- command:             (string) Maps to a sap.ui.commands entry for keyboard shortcut configuration.

Notes:
- This is applicable to SAP Fiori elements for OData V2 ALP.
- Use only the extensionAPI in your controller extension.
- getSelectedContexts() must be called synchronously; cache results when showing async UI (dialogs).
- For chart toolbar buttons, call getSelectedContexts(oEvent.ID) and ensure handler receives oEvent.
*/
```
--------------------------------

**TITLE**: Defining Custom Navigation Parameters for Intent-Based Navigation (OVP / Fiori Elements)

**INTRODUCTION**: This guide shows how to implement custom navigation parameters for intent-based navigation in SAPUI5 / OVP cards by:
- Adding an onCustomParams dispatcher in a controller extension
- Implementing functions that return selection-variant style parameter objects or mutate navigation params
- Wiring the custom function name into the card definition via manifest.json

Use case: add, remove, or modify URL/navigation parameters when navigating from an OVP card to a target application.

**TAGS**: fiori-elements-framework, sapui5, ovp, intent-navigation, controller-extension, manifest.json, selection-variant, custom-params

**STEP**: 1 — Implement onCustomParams and parameter functions in controller extension

**DESCRIPTION**: Add an onCustomParams dispatcher method to your controller extension. This method receives a key (string) and should return either:
- a function reference (that will be called to produce navigation parameters), or
- a direct parameter object/array as required.

Implement parameter functions with one of these patterns:
- Return an array of selection-variant objects (each with path, operator, value1, value2, sign).
- Return an object with aSelectionVariant (or deprecated selectionVariant) and bIgnoreEmptyString (or deprecated ignoreEmptyString).
- Mutate the provided oNavigateParams object and return it.

Configuration properties for selection-variant objects:
- path: property name (string)
- operator: one of EQ, NE, LE, GE, LT, GT, BT, CP
- value1: first operator value
- value2: second operator value (use null when not applicable; used e.g. for BT)
- sign: "I" to include or "E" to exclude the selection

Use recommended names (as of SAPUI5 1.54+):
- aSelectionVariant instead of selectionVariant
- bIgnoreEmptyString instead of ignoreEmptyString

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// Controller extension file: my_app/ext/controller/OverViewPageExt.controller.js
// Example: dispatcher that maps incoming key to local functions
onCustomParams: function(sCustomParams) {
    if (sCustomParams === "getParameters") {
        return this.getParameters;
    } else if (sCustomParams === "param2") {
        return this.param2;
    }
},

// Example 1: Return an array of selection-variant objects
getParameters: function(oNavigateParams) {
    var aCustomSelectionVariant = [];
    var oCustomSelectionVariant = {
        path: "TaxTarifCode",
        operator: "EQ",
        value1: 5,
        value2: null,
        sign: "I"
    };
    aCustomSelectionVariant.push(oCustomSelectionVariant);
    return aCustomSelectionVariant;
},

// Example 2: Mutate oNavigateParams and return it
param2: function(oNavigateParams) {
    oNavigateParams.TaxTarifCode = '3';
    return oNavigateParams;
},

// Example 3: Advanced — adding/removing filters using the incoming SelectionVariant helper
// Note: This example uses oSelectionVariantParams APIs: getSelectOptionsPropertyNames() and getSelectOption(name)
getParameters: function(oNavigateParams, oSelectionVariantParams) {

    // to get the select option property names
    var aSelectOptionNames = oSelectionVariantParams.getSelectOptionsPropertyNames();

    var oFilter1 = oSelectionVariantParams.getSelectOption("Filter1");
    var oFilter2 = oSelectionVariantParams.getSelectOption("Filter2");

    // Your logic to extract values from oFilter1 and oFilter2
    /// ...

    // Create objects with empty value1 to remove Filter1 and Filter2 when ignoreEmptyString is true
    var Filter1 = {
        path: "Filter1",
        operator: "EQ",
        value1: "",
        value2: null,
        sign: "I"
    };

    var Filter2 = {
        path: "Filter2",
        operator: "EQ",
        value1: "",
        value2: null,
        sign: "I"
    };

    // Add a new filter and then existing ones (order as needed)
    var aCustomSelectionVariant = [];
    var oFilter3 = {
        path: "Filter3PropertyName",
        operator: "EQ",
        value1: "<Value you want to include>",
        value2: null,
        sign: "I"
    };
    aCustomSelectionVariant.push(oFilter3);
    aCustomSelectionVariant.push(oFilter2);
    aCustomSelectionVariant.push(oFilter1);

    // Return with recommended property names (SAPUI5 >= 1.54):
    return {
        aSelectionVariant: aCustomSelectionVariant,
        bIgnoreEmptyString: true
    };

    // Legacy (deprecated) form:
    // return {
    //   selectionVariant: aCustomSelectionVariant,
    //   ignoreEmptyString: true
    // };
},
```

**STEP**: 2 — Register controller extension in manifest.json

**DESCRIPTION**: In your app's manifest.json, add a controller extension entry that points to your custom controller. If a controller extension already exists in the manifest, add this entry in the same extensions block.

File: manifest.json

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.ovp.app.Main": {
            "controllerName": "my_app.ext.controller.OverViewPageExt"
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Reference the custom parameter function in the card definition

**DESCRIPTION**: In the OVP card definition (where you define card settings in manifest.json or cards configuration), set the customParams property to the name of the custom function key handled by onCustomParams. The key string must match the one expected by onCustomParams (e.g., "getParameters" or "param2").

Example location: card configuration entry (within the manifest or card JSON).

**LANGUAGE**: JSON

**CODE**:
```JSON
"card002_ReorderSoon": {
  "model": "purchaseOrder",
  "template": "sap.ovp.cards.list",
  "settings": {
    "title": "Reorder Soon",
    "subTitle": "Less than 10 in stock",
    "listType": "condensed",
    "entitySet": "PurchaseSet",
    "customParams": "getParameters"
    // ... other card settings ...
  }
}
```

**NOTE**:
- As of SAPUI5 1.54, ignoreEmptyString and selectionVariant are deprecated. Use bIgnoreEmptyString and aSelectionVariant respectively.
- Controller extension file path example: my_app/ext/controller/OverViewPageExt.controller.js
- Ensure the function names you use in customParams are implemented and exported by your controller extension as shown in Step 1.
--------------------------------

**TITLE**: Defining Determining Actions for Object Page Footer (Fiori Elements)

**INTRODUCTION**: This document shows how to declare determining actions (DataFieldForAction) so action buttons appear in the object page footer (edit mode only). Includes XML, ABAP CDS, and CAP CDS examples. Also describes how to hide footer actions in display mode using a path-based UI.Hidden value.

**TAGS**: fiori-elements-framework, object-page, annotations, DataFieldForAction, determining-action, footer, UI.Identification, ABAP, CAP, XML, CDS

**STEP**: 1 — Overview / Rules
**DESCRIPTION**: Summary of rules to follow when defining determining actions:
- Use UI.Identification to list actions for the object page.
- Use DataFieldForAction to define an action; set Determining = true to place it in the footer.
- Determining actions must only appear in edit mode; add a path-based UI.Hidden annotation to prevent visibility in display mode.
- If Determining is absent or false, the action appears in the header (not footer).
**LANGUAGE**: TEXT
**CODE**:
```text
Rules:
- Annotation term: UI.Identification
- Element type: UI.DataFieldForAction
- Footer placement: Property Determining = true
- Hide in display mode: add UI.Hidden with an appropriate Path expression
```

**STEP**: 2 — XML Annotation Example (Object Page)
**DESCRIPTION**: XML sample that defines two DataFieldForAction entries under UI.Identification. The second action has Determining=true so it will be shown in the footer (edit mode).
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.Identification">
  <Collection>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="CWP"/>
      <PropertyValue Property="Action"
        String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopywithparams"/>
    </Record>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy"/>
      <PropertyValue Property="Action"
        String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy"/>
      <PropertyValue Property="Determining" Bool="true"/>
    </Record>
  </Collection>
</Annotation>
```

**STEP**: 3 — ABAP CDS Annotation Example
**DESCRIPTION**: ABAP CDS snippet for UI.identification with two actions. The second entry uses determining = true to place the action in the footer.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.identification: [
  {
    label: 'CWP',
    dataAction: 'PUSHDOWN: STTA_C_MP_ProductCopywithparams ',
    type: #FOR_ACTION,
    position: 1
  },
  {
    label: 'Copy',
    dataAction: 'PUSHDOWN: STTA_C_MP_ProductCopy',
    type: #FOR_ACTION,
    determining: true,
    position: 2
  }
]
product;
```

**STEP**: 4 — CAP CDS Annotation Example
**DESCRIPTION**: CAP CDS example declaring UI.Identification with two DataFieldForAction objects. The Determining property on the second object is set to true so it appears in the footer.
**LANGUAGE**: CDS (CAP)
**CODE**:
```cds
UI.Identification : [
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'CWP',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopywithparams'
  },
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'Copy',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy',
    Determining : true
  }
]
```

**STEP**: 5 — Hide Footer Action in Display Mode (Pattern)
**DESCRIPTION**: Footer actions must not be visible in display mode. Add a path-based UI.Hidden annotation on the action definition. Replace PATH_EXPRESSION with your service/entity-specific path expression that evaluates true in display mode and false in edit mode.
**LANGUAGE**: XML / CDS pattern
**CODE**:
```xml
<!-- XML pattern: add PropertyValue for Hidden with a Path -->
<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="Label" String="Copy"/>
  <PropertyValue Property="Action" String=".../STTA_C_MP_ProductCopy"/>
  <PropertyValue Property="Determining" Bool="true"/>
  <!-- Replace PATH_EXPRESSION with your path expression (e.g. IsActiveEntity or draft flag) -->
  <PropertyValue Property="Hidden">
    <Path>PATH_EXPRESSION</Path>
  </PropertyValue>
</Record>
```

```cds
// CAP CDS pattern: add UI.Hidden with a path expression (replace PATH_EXPRESSION)
{
  $Type: 'UI.DataFieldForAction',
  Label: 'Copy',
  Action: '.../STTA_C_MP_ProductCopy',
  Determining: true,
  UI.Hidden: [{ $Path: 'PATH_EXPRESSION' }]
}
```

**STEP**: 6 — Behavior Notes
**DESCRIPTION**: Quick behavioral reminders for implementers:
- Determining = true -> button appears in object page footer (edit mode).
- Determining absent/false -> button appears in header.
- Always add UI.Hidden with a path expression to prevent footer actions from showing in display mode.
--------------------------------

**TITLE**: Defining Determining Actions in List Reports (Fiori elements, OData V2)

**INTRODUCTION**: How to add determining action buttons for list report smart tables so actions appear in the footer (applicable only for SAP Fiori elements for OData V2). Includes XML annotation examples for DataFieldForAction and DataFieldForIntentBasedNavigation. Note: feature is deprecated and supported only for compatibility.

**TAGS**: fiori-elements-framework, annotations, UI.LineItem, DataFieldForAction, DataFieldForIntentBasedNavigation, OData V2, determining-actions, deprecated

**STEP**: 1 — Applicability and recommendation

**DESCRIPTION**: Use determining actions only in OData V2 list reports. This feature is deprecated; avoid new designs relying on it. Determining actions are rendered in the smart table footer when the Determining property is set to true on UI.LineItem entries.

**LANGUAGE**: Text

**CODE**:
```text
Applicability: SAP Fiori elements for OData V2 only.
Recommendation: Deprecated — use for compatibility only; plan alternatives.
```

**STEP**: 2 — Action types and where to place annotations

**DESCRIPTION**: Two kinds of determining actions can be defined in UI.LineItem:
- Backend-call actions: UI.DataFieldForAction (OData Function / FunctionImport / Action / ActionImport)
- Intent-based navigation: UI.DataFieldForIntentBasedNavigation

Place these records inside the UI.LineItem annotation collection for the entity in your annotation file (e.g., annotations.xml or other annotation source consumed by the app).

**LANGUAGE**: Text

**CODE**:
```text
Annotation term: UI.LineItem
Behavior:
 - If Record property Determining Bool="true" -> action appears in the list report footer.
 - If Determining is absent or false -> action appears in the smart table toolbar.
```

**STEP**: 3 — Full XML sample: DataFieldForAction (with and without Determining) and DataFieldForIntentBasedNavigation (determining)

**DESCRIPTION**: Example UI.LineItem annotation showing:
- A DataFieldForAction without Determining (renders in toolbar).
- A DataFieldForAction with Determining="true" (renders in footer).
- A DataFieldForIntentBasedNavigation with Determining="true" (renders in footer).
Includes InvocationGrouping set to UI.OperationGroupingType/Isolated.

Replace the Action strings and SemanticObject/Action values with your service/entity values as needed.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.LineItem">
  <Collection>
    <!-- Backend action without Determining -> appears in smart table toolbar -->
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy with new Supplier"/>
      <PropertyValue Property="Action"
                     String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopywithparams"/>
      <PropertyValue Property="InvocationGrouping"
                     EnumMember="UI.OperationGroupingType/Isolated"/>
    </Record>

    <!-- Backend action with Determining -> appears in list report footer -->
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy"/>
      <PropertyValue Property="Action"
                     String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy"/>
      <PropertyValue Property="Determining" Bool="true"/>
      <PropertyValue Property="InvocationGrouping"
                     EnumMember="UI.OperationGroupingType/Isolated"/>
    </Record>

    <!-- Intent-based navigation with Determining -> appears in list report footer -->
    <Record Type="UI.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="Label" String="Manage Products (ST)"/>
      <PropertyValue Property="SemanticObject" String="EPMProduct"/>
      <PropertyValue Property="Action" String="manage_st"/>
      <PropertyValue Property="Determining" Bool="true"/>
    </Record>
  </Collection>
</Annotation>
```

**STEP**: 4 — Minimal snippet: DataFieldForAction that stays in toolbar (no Determining)

**DESCRIPTION**: Minimal example for a DataFieldForAction that will appear in the smart table toolbar (Determining omitted).

**LANGUAGE**: XML

**CODE**:
```xml
<Record Type="UI.DataFieldForAction">
  <PropertyValue Property="Label" String="Export"/>
  <PropertyValue Property="Action" String="MyService.MyEntity/ExportAction"/>
  <!-- No Determining property -> appears in toolbar -->
</Record>
```

**STEP**: 5 — Behavior summary for implementers

**DESCRIPTION**: Implementation checklist and behavior summary to use when generating annotations programmatically:
- Place action records in UI.LineItem collection for the entity.
- Set PropertyValue Property="Determining" Bool="true" on DataFieldForAction or DataFieldForIntentBasedNavigation to move the action to the list report footer.
- Use InvocationGrouping (EnumMember="UI.OperationGroupingType/Isolated") when the action should run isolated.
- If Determining is absent or false, the action appears in the smart table toolbar.
- Ensure you are targeting Fiori elements OData V2 apps and consider migration away from Determining actions due to deprecation.

**LANGUAGE**: Text

**CODE**:
```text
Checklist:
- Annotation file consumed by app (e.g., annotations.xml) contains UI.LineItem for the entity.
- Actions requiring footer placement: include Determining Bool="true".
- Confirm InvocationGrouping for execution behavior.
- Test UI: footer buttons rendered for determining actions; toolbar for non-determining.
```
--------------------------------

**TITLE**: Defining Filter Facets (UI.FilterFacets) for Fiori elements filter bars

**INTRODUCTION**: Use UI.FilterFacets annotations to declare filter groups (ReferenceFacet) shown in the filter bar or in the Adapt Filters dialog. Place the annotation on the target entity type. Only UI.SelectionFields and mandatory filters are visible by default; other fields appear in Adapt Filters and are grouped (Basic, FieldGroup, EntityTypeName groups).

**TAGS**: fiori-elements-framework, UI.FilterFacets, UI.FieldGroup, UI.ReferenceFacet, filter-bar, annotations, OData V2, CDS, ABAP, CAP, XML

STEP: Add UI.FilterFacets (XML)
DESCRIPTION: Add a UI.FilterFacets annotation to an entity type to reference a field group qualifier (ReferenceFacet -> Target points to a UI.FieldGroup qualifier). Place this XML in your service metadata or annotation file that targets the entity type.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType">
   <Annotation Term="UI.FilterFacets">
      <Collection>
            <Record Type="UI.ReferenceFacet">
                <!-- Reference a field group defined as @UI.FieldGroup#MyFilterGroup -->
                <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#MyFilterGroup"/>
            </Record>
      </Collection>
   </Annotation>
</Annotations>
```

STEP: Add UI.FilterFacets (ABAP CDS)
DESCRIPTION: In ABAP CDS, annotate the view for the entity type with a UI.Facet entry that references a field-group qualifier (targetQualifier) and set type to #FIELDGROUP_REFERENCE and purpose to #FILTER.
LANGUAGE: ABAP CDS
CODE:
```ABAP
annotate view STTA_C_MP_SUPPLIERTYPE with {
  @UI.Facet: [
    {
      targetQualifier: 'MyFilterGroup',
      type: #FIELDGROUP_REFERENCE,
      purpose: #FILTER
    }
  ]
  Supplier;
}
```

STEP: Add UI.FilterFacets (CAP CDS)
DESCRIPTION: In CAP CDS (service/annotations), declare UI.FilterFacets as a collection and use UI.ReferenceFacet with a Target that points to an entity property and a UI.FieldGroup qualifier (example uses path with qualifier).
LANGUAGE: CDS
CODE:
```CDS
@UI.FilterFacets : [
    {
        $Type  : 'UI.ReferenceFacet',   
        Target : '_SoldToParty/@UI.FieldGroup#MyFilterGroup'
    }
]
```

STEP: Grouping behavior and rules
DESCRIPTION: Implementation behavior and grouping logic to follow when you define filter facets:
- Default visibility: only fields defined in UI.SelectionFields and mandatory filters appear directly on the filter bar. All other filter fields appear in the Adapt Filters dialog.
- Basic Group: All UI.SelectionFields plus any UI.FieldGroup annotated with qualifier "_BASIC" under the UI.FilterFacets structure are placed in the Basic group.
- Field Group: Fields listed under a UI.FieldGroup (qualifier other than "_BASIC") but not in UI.SelectionFields appear in their defined group.
- Entity Type Name Group: Fields not in UI.SelectionFields or any UI.FieldGroup are grouped into a group named by the entity type (e.g., <EntityTypeName>). Multiple entity types produce multiple such groups.
- Restriction: This feature is available only in SAP Fiori elements for OData V2.

LANGUAGE: text
CODE:
```text
Behavior summary:
- Visible by default: UI.SelectionFields + mandatory filters
- Adapt Filters dialog grouping:
  * Basic Group: UI.SelectionFields + UI.FieldGroup#_BASIC
  * Field Group: UI.FieldGroup#<Qualifier> (fields not in UI.SelectionFields)
  * Entity Type Name Group: remaining fields grouped by entity type name
Restriction: Only available for Fiori elements with OData V2
```

STEP: Define a UI.FieldGroup (XML)
DESCRIPTION: Define a UI.FieldGroup with Data entries (UI.DataField) and a Label. Use Qualifier to reference it from a ReferenceFacet (UI.FilterFacets -> Target).
LANGUAGE: XML
CODE:
```XML
<Annotation Term="UI.FieldGroup" Qualifier="Group_Name">
    <Record>
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="Name"/>
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Label" String="Group Name"/>
    </Record>
</Annotation>
```

STEP: Define a UI.FieldGroup (ABAP CDS)
DESCRIPTION: ABAP CDS syntax to declare a named field group (qualifier) that groups properties for use in facets.
LANGUAGE: ABAP CDS
CODE:
```ABAP
@UI.fieldGroup: [{ qualifier: 'Group Name', groupLabel: 'Group Name' }]
PROPERTY_NAME;
```

STEP: Define a UI.FieldGroup (CAP CDS)
DESCRIPTION: CAP CDS equivalent to declare UI.FieldGroup with Data array and Label.
LANGUAGE: CDS
CODE:
```CDS
UI.FieldGroup #GroupName : {
    Data : [
        {
            $Type : 'UI.DataField',
            Value : PropertyName
        }
    ],
    Label : 'Group Name'
}
```
--------------------------------

**TITLE**: Defining Line Items (UI.LineItem) for Fiori Elements Tables

**INTRODUCTION**: This document shows the exact annotation patterns to define table/list report columns (line items) for Fiori Elements using UI.LineItem. Includes copy-pasteable examples for OData XML annotations, ABAP CDS annotations, and CAP CDS annotations. Use these snippets to control which properties appear as table columns, their importance, and ordering.

**TAGS**: fiori-elements, UI.LineItem, lineitem, annotations, table, list-report, CDS, ABAP, CAP, XML

**STEP**: 1 — Define Line Items using OData XML annotations

**DESCRIPTION**: Add a UI.LineItem annotation on the entity or entity set. Provide a Collection of UI.DataField records. For each column, set PropertyValue Property="Value" Path="PropertyName" and optionally annotate importance using UI.Importance. Order of columns is the sequence of the Collection.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Place this under the target EntityType/EntitySet annotations in your EDMX -->
<Annotation Term="UI.LineItem">
  <Collection>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="Product"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="ProductCategory"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="Supplier"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
  </Collection>
</Annotation>
```

**STEP**: 2 — Define Line Items in ABAP CDS

**DESCRIPTION**: Use @UI.lineItem annotations in ABAP CDS to declare each column. Include importance, value (property name), type (e.g., #STANDARD), and position to control ordering. Place the annotation directly above the corresponding element in the CDS view projection (or define as a list on top depending on your CDS style).

**LANGUAGE**: ABAP

**CODE**:
```abap
@UI.lineItem: [
  {
    importance: #HIGH,
    value: 'PRODUCT',
    type: #STANDARD,
    position: 1 
  }
]
PRODUCT;

@UI.lineItem: [
  {
    importance: #HIGH,
    value: 'PRODUCTCATEGORY',
    type: #STANDARD,
    position: 2 
  }
]
PRODUCTCATEGORY;

@UI.lineItem: [
  {
    importance: #HIGH,
    value: 'SUPPLIER',
    type: #STANDARD,
    position: 3 
  }
]
SUPPLIER;
```

**STEP**: 3 — Define Line Items in CAP CDS

**DESCRIPTION**: In CAP CDS, declare UI.LineItem as an array of UI.DataField objects. Assign Value to the field name and attach UI.Importance. Use this in your .cds file under the entity definition or a separate annotation file.

**LANGUAGE**: CDS

**CODE**:
```cds
annotate MyService.MyEntity with {
  UI.LineItem : [
    {
      $Type : 'UI.DataField',
      Value : Product,
      ![@UI.Importance] : #High
    },
    {
      $Type : 'UI.DataField',
      Value : ProductCategory,
      ![@UI.Importance] : #High
    },
    {
      $Type : 'UI.DataField',
      Value : Supplier,
      ![@UI.Importance] : #High
    }
  ]
};
```

**STEP**: 4 — Rendering notes and resources

**DESCRIPTION**: The UI.LineItem annotation controls the table columns shown in List Report / Object Page tables. Column labels come from the property's label annotations or metadata. The example rendering is available at images/ListReport_LineItem_69a7c44.png (project-relative path). For additional behaviors, see the related docs.

**LANGUAGE**: text

**CODE**:
```text
Image (example rendering): images/ListReport_LineItem_69a7c44.png

Related docs:
- Adding Actions to Tables: adding-actions-to-tables-b623e0b.md
- Responsiveness Options: responsiveness-options-example-69efbe7.md
```
--------------------------------

**TITLE**: Defining Multiple Chart Configurations (UI.Chart with Qualifiers)

**INTRODUCTION**: Show how to define multiple chart configurations for the same entity (same dataset) by using UI.Chart annotations with qualifiers. Use qualifiers to expose different chart visualizations in different views (List Report, Object Page facets/sections) while reusing the same data model.

**TAGS**: fiori-elements-framework, annotations, UI.Chart, qualifier, charts, CDS, XML

**STEP**: 1 — Create annotated XML with multiple UI.Chart definitions (qualifiers)

**DESCRIPTION**: Add an annotation XML file that defines multiple UI.Chart annotations for the same entity. Each UI.Chart annotation uses the Qualifier attribute to define a separate chart configuration (e.g., ByRegion, ByProduct). Include Measures and Dimensions and a Title and ChartType. Example file path: annotations/Annotations.xml (or <project-root>/app/annotations/YourService.annotations.xml).

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <!-- Target: Replace with your service namespace + entity type -->
  <Annotation Term="UI.Chart" Qualifier="ByRegion" Target="MyService.Sales">
    <Record Type="UI.ChartType">
      <PropertyValue Property="Title" String="Sales by Region"/>
      <!-- ChartType as EnumMember; update enum path if needed in your environment -->
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Donut"/>
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>Revenue</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>Region</PropertyPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <Annotation Term="UI.Chart" Qualifier="ByProduct" Target="MyService.Sales">
    <Record Type="UI.ChartType">
      <PropertyValue Property="Title" String="Sales by Product"/>
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>Revenue</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>ProductName</PropertyPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 2 — Reference a specific chart qualifier in Object Page facets (use different charts in different sections)

**DESCRIPTION**: Use UI.Facets (ReferenceFacet) with an AnnotationPath that points to a qualified chart using the @ UI.Chart#Qualifier syntax. This places the chosen chart configuration into the Object Page section/facet.

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="MyService.Sales">
  <Annotation Term="UI.Facets">
    <Collection>
      <!-- Reference facet that inserts the chart defined by qualifier "ByRegion" -->
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Sales by Region"/>
        <PropertyValue Property="Target">
          <Record Type="UI.Target">
            <!-- AnnotationPath references the qualified chart -->
            <PropertyValue Property="AnnotationPath" String="@UI.Chart#ByRegion"/>
          </Record>
        </PropertyValue>
      </Record>

      <!-- Another facet referencing the "ByProduct" chart -->
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Sales by Product"/>
        <PropertyValue Property="Target">
          <Record Type="UI.Target">
            <PropertyValue Property="AnnotationPath" String="@UI.Chart#ByProduct"/>
          </Record>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 3 — Define multiple charts with qualifiers in CDS (CAP) annotations

**DESCRIPTION**: In a CAP/CDS project you can place UI annotations directly in the .cds model. Define multiple @UI.Chart annotations with qualifiers on the same entity. Update property names and types to match your model.

**LANGUAGE**: CDS

**CODE**:
```cds
namespace MyService;

using { UI } from '@sap/cds/common';  // optional import for clarity in examples

entity Sales {
  key ID     : UUID;
  Region     : String;
  ProductName: String;
  Revenue    : Decimal(13,2);
}

/*
  Add two UI.Chart annotations with qualifiers.
  - qualifier: 'ByRegion' -> Donut chart by Region
  - qualifier: 'ByProduct' -> Column chart by ProductName
*/
annotate Sales with {
  @UI.Chart: {
    qualifier: 'ByRegion',
    title: 'Sales by Region',
    chartType: #Donut,
    measures: [ { $PropertyPath: 'Revenue' } ],
    dimensions: [ { $PropertyPath: 'Region' } ]
  };

  @UI.Chart: {
    qualifier: 'ByProduct',
    title: 'Sales by Product',
    chartType: #Column,
    measures: [ { $PropertyPath: 'Revenue' } ],
    dimensions: [ { $PropertyPath: 'ProductName' } ]
  };
}
```

**STEP**: 4 — How to consume specific chart qualifiers in UI configuration

**DESCRIPTION**: Use the qualified annotation path (UI.Chart#Qualifier) wherever the UI expects an AnnotationPath (for example, Object Page facets). For List Reports or other building blocks, the Fiori Elements runtime automatically picks up UI.Chart qualifiers declared on the entity; to display a specific qualifier in a particular view, reference the qualifier in the corresponding facet/annotation or use view-specific annotations.

**LANGUAGE**: JSON (example pattern showing AnnotationPath usage in a facet-like structure)

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Sales",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "chart": {
              /* Some templates allow specifying a chart qualifier - pattern varies by template/version.
                 Replace with the appropriate manifest settings if you need to force a qualifier in a particular page. */
              "annotationPath": "@UI.Chart#ByRegion"
            }
          }
        }
      }
    ]
  }
}
```

Notes:
- Replace namespace, entity names, and property names to match your service/schema.
- Qualifiers are case-sensitive. Use the exact qualifier string when referencing via "@UI.Chart#Qualifier".
- Use either CDS annotations (CAP) or EDMX/annotation XML files depending on your project setup.
- For live examples and additional syntax details consult the SAP Fiori documentation: Building Blocks - Chart - Usage with Qualifier.
--------------------------------

**TITLE**: Define Multiple Table Views for Analytical List Page (Single Table Mode)

**INTRODUCTION**: This guide shows how to define multiple pre-filtered views for a table in an Analytical List Page (ALP) using OData V2 SelectionVariant annotations and how to expose them in single table mode via manifest.json quickVariantSelection. Includes enabling counts per view and UI behavior (segmented button vs drop-down).

**TAGS**: fiori-elements, analytical-list-page, selectionvariant, annotations, manifest.json, quickVariantSelection, ODataV2

**STEP**: 1 — Add SelectionVariant annotations (XML)

**DESCRIPTION**: Create or extend an annotations file (e.g., annotations/SelectionVariants.xml) with UI.SelectionVariant annotations. Each SelectionVariant uses a Qualifier and Text and defines SelectOptions (property + ranges). The Qualifier value becomes the fragment referenced by annotationPath in manifest.json (com.sap.vocabularies.UI.v1.SelectionVariant#<Qualifier>).

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm"
             Target="SEPMRA_ALP_SO_ANA_SRV.SEPMRA_C_ALP_SlsOrdItemCubeALPResult">
   <!-- Qualifier: Expensive -->
   <Annotation Term="UI.SelectionVariant" Qualifier="Expensive">
      <Record>
         <PropertyValue Property="Text" String="Expensive" />
         <PropertyValue Property="SelectOptions">
            <Collection>
               <Record Type="UI.SelectOptionType">
                  <PropertyValue Property="PropertyName" PropertyPath="Product" />
                  <PropertyValue Property="Ranges">
                     <Collection>
                        <Record Type="UI.SelectionRangeType">
                           <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                           <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                           <PropertyValue Property="Low" String="HT-1000" />
                        </Record>
                     </Collection>
                  </PropertyValue>
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>

   <!-- Qualifier: Cheap -->
   <Annotation Term="UI.SelectionVariant" Qualifier="Cheap">
      <Record>
         <PropertyValue Property="Text" String="Cheap" />
         <PropertyValue Property="SelectOptions">
            <Collection>
               <Record Type="UI.SelectOptionType">
                  <PropertyValue Property="PropertyName" PropertyPath="Product" />
                  <PropertyValue Property="Ranges">
                     <Collection>
                        <Record Type="UI.SelectionRangeType">
                           <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                           <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                           <PropertyValue Property="Low" String="HT-1050" />
                        </Record>
                     </Collection>
                  </PropertyValue>
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>

   <!-- Qualifier: Economic -->
   <Annotation Term="UI.SelectionVariant" Qualifier="Economic">
      <Record>
         <PropertyValue Property="Text" String="Economic" />
         <PropertyValue Property="SelectOptions">
            <Collection>
               <Record Type="UI.SelectOptionType">
                  <PropertyValue Property="PropertyName" PropertyPath="Product" />
                  <PropertyValue Property="Ranges">
                     <Collection>
                        <Record Type="UI.SelectionRangeType">
                           <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                           <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                           <PropertyValue Property="Low" String="HT-1002" />
                        </Record>
                     </Collection>
                  </PropertyValue>
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>

   <!-- Qualifier: Budget -->
   <Annotation Term="UI.SelectionVariant" Qualifier="Budget">
      <Record>
         <PropertyValue Property="Text" String="Budget" />
         <PropertyValue Property="SelectOptions">
            <Collection>
               <Record Type="UI.SelectOptionType">
                  <PropertyValue Property="PropertyName" PropertyPath="Product" />
                  <PropertyValue Property="Ranges">
                     <Collection>
                        <Record Type="UI.SelectionRangeType">
                           <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I" />
                           <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                           <PropertyValue Property="Low" String="HT-1022" />
                        </Record>
                     </Collection>
                  </PropertyValue>
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```

**STEP**: 2 — Add quickVariantSelection in manifest.json (basic)

**DESCRIPTION**: Add quickVariantSelection under the Analytical List Page settings in manifest.json so the ALP renders the SelectionVariant qualifiers as multiple views. Place quickVariantSelection inside the ALP page settings: sap.ui.generic.app -> pages -> <EntitySet or route> -> component -> settings. Use annotationPath "com.sap.vocabularies.UI.v1.SelectionVariant#<Qualifier>". Keys are identifiers for the individual views.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "SEPMRA_C_ALP_SlsOrdItemCubeALPResult|": {
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "quickVariantSelection": {
              "variants": {
                "0": {
                  "key": "_tab1",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive"
                },
                "1": {
                  "key": "_tab2",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Cheap"
                },
                "2": {
                  "key": "_tab3",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Economic"
                },
                "3": {
                  "key": "_tab4",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Budget"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Enable counts for each view

**DESCRIPTION**: To display the number of entries per view next to each variant, set showCounts to true within quickVariantSelection. This makes the UI show counts in the drop-down or segmented button.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "SEPMRA_C_ALP_SlsOrdItemCubeALPResult|": {
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "quickVariantSelection": {
              "showCounts": true,
              "variants": {
                "0": {
                  "key": "_tab1",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive"
                },
                "1": {
                  "key": "_tab2",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Cheap"
                },
                "2": {
                  "key": "_tab3",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Economic"
                },
                "3": {
                  "key": "_tab4",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Budget"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — UI behavior and constraints

**DESCRIPTION**: Notes to implementers:
- When you configure quickVariantSelection as above, ALP shows the variants as a drop-down by default.
- If the number of variants is less than or equal to 3, the ALP displays them as a segmented button automatically.
- The annotationPath must match the SelectionVariant Qualifier in your annotations file (use the fragment identifier #Qualifier).
- Keys (e.g., "_tab1") identify views internally and can be any unique string.

**LANGUAGE**: JSON

**CODE**:
```json
// Behavior summary (pseudo-JSON for quick reference, not for manifest)
{
  "quickVariantSelection": {
    "variantsCount <= 3": "segmented button",
    "variantsCount > 3": "drop-down",
    "annotationPath format": "com.sap.vocabularies.UI.v1.SelectionVariant#<Qualifier>"
  }
}
```

**STEP**: 5 — OData V4 and further reading

**DESCRIPTION**: For OData V4 or the List Report single table mode equivalent, refer to the Fiori Elements documentation: Defining Multiple Views on a List Report Table - Single Table Mode.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "reference": "See: Defining Multiple Views on a List Report Table - Single Table Mode (OData V4 documentation)"
}
```
--------------------------------

**TITLE**: Defining Multiple Views on a List Report Table (Multiple Table Mode)

**INTRODUCTION**: This document shows how to define multiple table views (tabs) on a Fiori Elements List Report using SelectionVariant / SelectionPresentationVariant annotations and how to enable multiple table mode in the manifest. It covers using charts as visualizations, chart actions/navigation, manifest configuration for OData V2 (sap.ui.generic.app.quickVariantSelectionX) and OData V4 (views.paths), controlConfiguration, and relevant limitations.

**TAGS**: fiori-elements-framework, annotations, SelectionVariant, SelectionPresentationVariant, UI.Chart, manifest.json, quickVariantSelectionX, multiple-table-mode, charts

**STEP**: 1 — Define a UI.Chart annotation (qualifier)
**DESCRIPTION**: Create a UI.Chart annotation with a qualifier. This chart can later be referenced from a SelectionPresentationVariant (PresentationVariant.Visualizations). Examples for XML, ABAP CDS and CAP CDS (OData V4).
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.Chart" Qualifier="Chart1">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Revenue by Customer"/>
    <PropertyValue Property="Description" String="Net Revenue by Customer"/>
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
    <PropertyValue Property="Dimensions">
      <Collection>
        <PropertyPath>ProductCategory</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Measures">
      <Collection>
        <PropertyPath>NetAmount</PropertyPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.Chart: [
  {
    title: 'Revenue by Customer',
    description: 'Net Revenue by Customer',
    chartType: #COLUMN,
    dimensions: [ 'PRODUCTCATEGORY' ],
    measures: [ 'NETAMOUNT' ],
    qualifier: 'Chart1'
  }
]
annotate view SALESORDERMANAGE with { }
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
UI.Chart #Chart1 : {
  $Type : 'UI.ChartDefinitionType',
  Title : 'Revenue by Customer',
  Description : 'Net Revenue by Customer',
  ChartType : #Column,
  Dimensions : [ ProductCategory ],
  Measures : [ NetAmount ]
}
```

**STEP**: 2 — Reference UI.Chart in a SelectionPresentationVariant
**DESCRIPTION**: Reference the chart via AnnotationPath in the PresentationVariant.Visualizations of a SelectionPresentationVariant. This ties filters + presentation (including a chart) to a view/tab.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.SelectionPresentationVariant" Qualifier="Chart1">
  <Record>
    <PropertyValue Property="Text" String="Chart1"/>
    <PropertyValue Property="SelectionVariant">
      <Record>
        <!-- add SelectOptions here -->
      </Record>
    </PropertyValue>
    <PropertyValue Property="PresentationVariant">
      <Record>
        <PropertyValue Property="Visualizations">
          <Collection>
            <AnnotationPath>@UI.Chart#Chart1</AnnotationPath>
          </Collection>
        </PropertyValue>
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.selectionPresentationVariant: [{
  text: 'Chart1',
  selectionVariantQualifier: '',
  presentationVariantQualifier: 'Default',
  qualifier: 'Chart1'
}]

@UI.presentationVariant: [
  {
    qualifier: 'Default',
    visualizations: [{ type: #AS_CHART, qualifier: 'Chart1' }]
  }
]
annotate view SALESORDERMANAGE with { }
```

**LANGUAGE**: CAP CDS
**CODE**:
```cds
UI.SelectionPresentationVariant #Chart1 : {
  Text : 'Chart1',
  SelectionVariant : { /* ... */ },
  PresentationVariant : {
    Visualizations : [ '@UI.Chart#Chart1' ]
  }
}
```

**STEP**: 3 — Add SelectionVariant or SelectionPresentationVariant annotations for each view/tab
**DESCRIPTION**: Create SelectionVariant (filters only) or SelectionPresentationVariant (filters + presentation) annotations per tab. Use qualifiers to identify them. Supported SelectionRangeOptionTypes: EQ, BT, LE, GE, NE, GT, LT. The SelectionVariant.FilterExpression is not supported.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- SelectionVariant qualifier "Expensive" (GrossAmount >= 5000) -->
<Annotations Target="STTA_SALES_ORDER_ITEM_AGGR_SRV.STTA_C_SO_ItemAggrType">
  <Annotation Term="UI.SelectionVariant" Qualifier="Expensive">
    <Record>
      <PropertyValue Property="Text" String="Expensive" />
      <PropertyValue Property="SelectOptions">
        <Collection>
          <Record Type="UI.SelectOptionType">
            <PropertyValue Property="PropertyName" PropertyPath="GrossAmount" />
            <PropertyValue Property="Ranges">
              <Collection>
                <Record Type="UI.SelectionRangeType">
                  <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/E" />
                  <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/GE" />
                  <PropertyValue Property="Low" String="5000"/>
                </Record>
              </Collection>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <!-- SelectionPresentationVariant qualifier "Cheap" (GrossAmount < 5000) -->
  <Annotation Term="UI.SelectionPresentationVariant" Qualifier="Cheap">
    <Record>
      <PropertyValue Property="Text" String="Cheap"/>
      <PropertyValue Property="SelectionVariant">
        <Record>
          <PropertyValue Property="SelectOptions">
            <Collection>
              <Record Type="UI.SelectOptionType">
                <PropertyValue Property="PropertyName" PropertyPath="GrossAmount" />
                <PropertyValue Property="Ranges">
                  <Collection>
                    <Record Type="UI.SelectionRangeType">
                      <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/LT" />
                      <PropertyValue Property="Low" String="5000" />
                    </Record>
                  </Collection>
                </PropertyValue>
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </PropertyValue>
      <PropertyValue Property="PresentationVariant">
        <Record>
          <PropertyValue Property="SortOrder">
            <Collection>
              <Record>
                <PropertyValue Property="Property" PropertyPath="GrossAmount" />
                <PropertyValue Property="Descending" Bool="false" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.SelectionVariant: [{ text: 'Expensive', qualifier: 'Expensive' }]
@UI.selectionPresentationVariant: [{
  text: 'Cheap',
  selectionVariantQualifier: 'Default',
  presentationVariantQualifier: 'Default',
  qualifier: 'Cheap'
}]
@UI.selectionVariant: [{ text: 'Cheap', qualifier: 'Default' }]
@UI.presentationVariant: [{ qualifier: 'Default', sortOrder: [{ by: 'GrossAmount', direction: #ASC }] }]
annotate view SALESORDERMANAGE with { }
```

**STEP**: 4 — Enable multiple table mode in manifest.json (OData V2)
**DESCRIPTION**: In sap.ui.generic.app.pages settings, enable quickVariantSelectionX and add variants mapping to annotation paths. Each variant must include a stable "key" (alphanumeric + underscores, not starting with a digit). The key is appended to table-specific IDs as suffix "-<key>".
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "C_STTA_SalesOrder_WD_20",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "quickVariantSelectionX": {
              "variants": {
                "Expensive": {
                  "key": "Expensive",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive"
                },
                "Cheap": {
                  "key": "Cheap",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#Cheap"
                }
              }
            }
            /* ... */
          }
        }
      }
    ]
  }
}
```

**STEP**: 5 — Enable chart navigation and configure chart actions
**DESCRIPTION**: For charts used as a view, annotate UI.Chart actions (UI.DataFieldForAction/Intent-based nav). To enable navigation from chart selection, set showItemNavigationOnChart: true on that variant in the manifest and configure an internal navigation target as needed. Ensure the chart service/entity is not draft-enabled or read-only.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.Chart" Qualifier="Chart4">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
    <PropertyValue Property="Dimensions">
      <Collection>
        <PropertyPath>CompanyCode</PropertyPath>
        <PropertyPath>Customer</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Measures">
      <Collection>
        <PropertyPath>AmountInTransactionCurrency</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Actions">
      <Collection>
        <Record Type="UI.DataFieldForAction">
          <PropertyValue Property="Action" String="ZFAR_CUSTOMER_LINE_ITEMS2_SRV.ZFAR_CUSTOMER_LINE_ITEMS2_SRV_Entities/Create"/>
          <PropertyValue Property="Label" String="Action 1"/>
        </Record>
        <Record Type="UI.DataFieldForIntentBasedNavigation">
          <PropertyValue Property="SemanticObject" String="Customer"/>
          <PropertyValue Property="Action" String="postPayment2"/>
          <PropertyValue Property="Label" String="SO Navigation (M)"/>
          <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/Medium"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.Chart: [
  {
    chartType: #COLUMN,
    dimensions: [ 'COMPANYCODE', 'CUSTOMER' ],
    measures: [ 'AMOUNTINTRANSACTIONCURRENCY' ],
    actions: [
      { dataAction: 'PUSHDOWN:Create', label: 'Action 1', type: #FOR_ACTION },
      { semanticObjectAction: 'postPayment2', label: 'SO Navigation (M)', type: #FOR_INTENT_BASED_NAVIGATION }
    ],
    qualifier: 'Chart4'
  }
]
annotate view SALESORDERMANAGE with { }
```

**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "component": {
          "settings": {
            "quickVariantSelectionX": {
              "variants": {
                "SalesOrderTable": {
                  "key": "SalesOrderTable",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#VAR1"
                },
                "Amount_CustomerChart": {
                  "key": "Amount_CustomerChart",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#VAR4",
                  "showItemNavigationOnChart": true
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

**STEP**: 6 — OData V4: Enable multiple table mode in manifest (views.paths)
**DESCRIPTION**: For Fiori Elements V4 templates, configure views under routing.targets -> options.settings.views.paths. Each path entry requires key + annotationPath. You can also use showCounts and keepPreviousPersonalization per path.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "routing": {
    "targets": {
      "SalesOrderManageList": {
        "type": "Component",
        "id": "SalesOrderManageList",
        "name": "sap.fe.templates.ListReport",
        "options": {
          "settings": {
            "contextPath": "/SalesOrderManage",
            "views": {
              "paths": [
                { "key": "tab1", "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Good" },
                { "key": "tab2", "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#UncompletePV" },
                { "key": "tab3", "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#PVandSV" }
              ],
              "showCounts": false
            },
            "controlConfiguration": {
              /* control configuration entries per annotation-qualified LineItem / Chart */
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 7 — Configure controlConfiguration per view (table/chart settings)
**DESCRIPTION**: Customize table type and other settings for each annotated LineItem or Chart by using the controlConfiguration key that matches the annotation (e.g., @com.sap.vocabularies.UI.v1.LineItem#withPrice). This is where you set table type (ResponsiveTable, AnalyticalTable, etc.), export options, and other UI settings.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem#withPrice": {
      "tableSettings": {
        "type": "ResponsiveTable",
        "enableExport": false
        /* additional table settings */
      }
    }
  }
}
```

**STEP**: 8 — Example: SelectionVariant / SelectionPresentationVariant without qualifier
**DESCRIPTION**: If a SelectionVariant or SelectionPresentationVariant has no qualifier, reference without qualifier in manifest annotationPath. Examples: XML annotation and manifest mapping.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- SelectionVariant without qualifier -->
<Annotation Term="UI.SelectionVariant">
  <Record>
    <PropertyValue Property="Text" String="Expensive" />
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record Type="UI.SelectOptionType">
          <PropertyValue Property="PropertyName" PropertyPath="GrossAmount" />
          <PropertyValue Property="Ranges">
            <Collection>
              <Record Type="UI.SelectionRangeType">
                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/GE" />
                <PropertyValue Property="Low" String="5000" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**LANGUAGE**: JSON
**CODE**:
```json
{
  "settings": {
    "quickVariantSelectionX": {
      "variants": {
        "ExpensiveOrdersTable": {
          "key": "ExpensiveOrdersTable",
          "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant"
        }
      }
    }
  }
}
```

**LANGUAGE**: XML
**CODE**:
```xml
<!-- SelectionPresentationVariant without qualifier -->
<Annotation Term="UI.SelectionPresentationVariant">
  <Record>
    <PropertyValue Property="Text" String="Cheap"/>
    <PropertyValue Property="SelectionVariant">
      <Record>
        <PropertyValue Property="Text" String="Cheap"/>
        <PropertyValue Property="SelectOptions">
          <Collection>
            <Record Type="UI.SelectOptionType">
              <PropertyValue Property="PropertyName" PropertyPath="GrossAmount" />
              <PropertyValue Property="Ranges">
                <Collection>
                  <Record Type="UI.SelectionRangeType">
                    <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/LT" />
                    <PropertyValue Property="Low" String="5000" />
                  </Record>
                </Collection>
              </PropertyValue>
            </Record>
          </Collection>
        </PropertyValue>
      </Record>
    </PropertyValue>
    <PropertyValue Property="PresentationVariant">
      <Record>
        <PropertyValue Property="Visualizations">
          <Collection>
            <AnnotationPath>@UI.LineItem#Reduced</AnnotationPath>
          </Collection>
        </PropertyValue>
        <PropertyValue Property="SortOrder">
          <Collection>
            <Record>
              <PropertyValue Property="Property" PropertyPath="GrossAmount" />
              <PropertyValue Property="Descending" Bool="false" />
            </Record>
          </Collection>
        </PropertyValue>
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

**LANGUAGE**: JSON
**CODE**:
```json
{
  "settings": {
    "quickVariantSelectionX": {
      "variants": {
        "ExpensiveOrdersTable": {
          "key": "ExpensiveOrdersTable",
          "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant"
        },
        "CheapOrdersTable": {
          "key": "CheapOrdersTable",
          "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant"
        }
      }
    }
  }
}
```

**STEP**: 9 — Constraints, supported features and best practices
**DESCRIPTION**: Concise actionable rules to follow.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "notes": [
    "SelectionVariant.FilterExpression is not supported.",
    "Supported SelectionRangeOptionTypes (no wildcards): EQ, BT, LE, GE, NE, GT, LT.",
    "PresentationVariant must include Visualizations to be applied; otherwise default LineItem is used.",
    "Variant 'key' must be alphanumeric/underscore, not starting with a digit (used to suffix IDs: tableId-<key>).",
    "Stable IDs: separate table instances per tab get suffix '-<key>' to avoid duplicate IDs.",
    "Chart navigation: set showItemNavigationOnChart=true in the variant manifest entry and configure internal navigation target. Chart service/entity must not be draft-enabled or read-only.",
    "If switching from single table to multiple tables and you want to keep previous personalization for one tab, use 'keepPreviousPersonalization' at that path level (only one tab allowed).",
    "Refreshing the count for a tab via global side effects only works for a view that has been opened.",
    "If table title equals view name, the table title is omitted to avoid duplication."
  ]
}
```
--------------------------------

**TITLE**: Define Multiple Table Views (Single Table Mode) for Fiori Elements List Report

**INTRODUCTION**: Show how to define SelectionVariant(s) and SelectionPresentationVariant(s) and enable segmented-button switching in single table mode. Includes XML annotations, ABAP CDS, CAP CDS examples, and manifest.json configuration for both OData V2 (sap.suite.ui.generic.template.ListReport) and OData V4 (sap.fe.templates.ListReport). Actionable, copy-paste examples for code generation.

**TAGS**: fiori-elements-framework, annotations, selectionvariant, selectionpresentationvariant, manifest.json, sap.ui.generic.app, sap.fe, quickVariantSelection, segmented-button, ODataV2, ODataV4

STEP: 1 — Add SelectionVariant annotations (XML) for OData V2
DESCRIPTION: Add SelectionVariant annotations (qualifier or no qualifier) to your annotations file. Use these qualifiers in manifest.json quickVariantSelection annotationPath entries. The example filters GrossAmount >= 5000 (Expensive) and a SelectionPresentationVariant (Cheap) that references a SelectionVariant.
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations.xml (or equivalent annotations file) -->
<!-- SelectionVariant with Qualifier "Expensive" -->
<Annotation Term="UI.SelectionVariant" Qualifier="Expensive">
  <Record>
    <PropertyValue Property="Text" String="Expensive"/>
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record Type="UI.SelectOptionType">
          <PropertyValue Property="PropertyName" PropertyPath="GrossAmount"/>
          <PropertyValue Property="Ranges">
            <Collection>
              <Record Type="UI.SelectionRangeType">
                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/GE"/>
                <PropertyValue Property="Low" String="5000"/>
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>

<!-- SelectionPresentationVariant that contains a SelectionVariant and PresentationVariant -->
<Annotation Term="UI.SelectionPresentationVariant" Qualifier="Cheap">
  <Record>
    <PropertyValue Property="Text" String="Cheap"/>
    <PropertyValue Property="SelectionVariant">
      <Record>
        <PropertyValue Property="Text" String="Cheap"/>
        <PropertyValue Property="SelectOptions">
          <Collection>
            <Record Type="UI.SelectOptionType">
              <PropertyValue Property="PropertyName" PropertyPath="GrossAmount"/>
              <PropertyValue Property="Ranges">
                <Collection>
                  <Record Type="UI.SelectionRangeType">
                    <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/LT"/>
                    <PropertyValue Property="Low" String="5000"/>
                  </Record>
                </Collection>
              </PropertyValue>
            </Record>
          </Collection>
        </PropertyValue>
      </Record>
    </PropertyValue>
    <PropertyValue Property="PresentationVariant">
      <Record>
        <PropertyValue Property="Visualizations">
          <Collection>
            <AnnotationPath>@UI.LineItem#Reduced</AnnotationPath>
          </Collection>
        </PropertyValue>
        <PropertyValue Property="SortOrder">
          <Collection>
            <Record>
              <PropertyValue Property="Property" PropertyPath="GrossAmount"/>
              <PropertyValue Property="Descending" Bool="false"/>
            </Record>
          </Collection>
        </PropertyValue>
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 2 — Add SelectionVariant annotations (ABAP CDS) for OData V2
DESCRIPTION: ABAP CDS annotation example with qualifier. Use annotate view ... with {} block in your CDS source.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.selectionVariant: [
  { text: 'Expensive', qualifier: 'Expensive' }
]
annotate view STTA_C_MP_Product with {
  // Add further annotation mappings if needed
}
```

STEP: 3 — Add SelectionVariant annotations (CAP CDS) for OData V2/V4
DESCRIPTION: CAP CDS syntax for named selection variants (#Qualifier). Use in your .cds file or annotations artifact.
LANGUAGE: CAP CDS
CODE:
```cds
annotate com.c_salesordermanage_sd.SalesOrderManage with @(
  UI.SelectionVariant #Completed : {
    $Type : 'UI.SelectionVariantType',
    SelectOptions : [
      {
        $Type : 'UI.SelectOptionType',
        PropertyName : OverallSDProcessStatus,
        Ranges : [
          { $Type : 'UI.SelectionRangeType', Option : #BT, Low : 'A', High : 'D' },
          { $Type : 'UI.SelectionRangeType', Option : #BT, Low : 'B', High : 'C' }
        ]
      }
    ],
    Text : 'completed (2 Ranges)'
  },
  UI.SelectionVariant #InProcess : {
    $Type : 'UI.SelectionVariantType',
    SelectOptions : [
      {
        $Type : 'UI.SelectOptionType',
        PropertyName : OverallSDProcessStatus,
        Ranges : [
          { $Type : 'UI.SelectionRangeType', Option : #EQ, Low : 'B' }
        ]
      }
    ],
    Text : 'In Process'
  }
);
```

STEP: 4 — Supported SelectionRangeOptionTypes and restrictions
DESCRIPTION: Use these option types only (no wildcards). FilterExpression is NOT supported. PresentationVariant supports SortOrders.
LANGUAGE: JSON
CODE:
```json
{
  "supportedSelectionRangeOptionTypes": [
    "EQ", "BT", "LE", "GE", "NE", "GT", "LT"
  ],
  "notes": [
    "FilterExpression of SelectionVariantType is not supported.",
    "PresentationVariant: SortOrders are supported.",
    "Do not use wildcard patterns (*, ?, ...) in selection ranges."
  ]
}
```

STEP: 5 — Configure manifest.json for OData V2 (sap.ui.generic.app) single table mode
DESCRIPTION: Extend manifest.json under sap.ui.generic.app > pages > component > settings > quickVariantSelection. Provide a variants map where each entry has a mandatory "key" (used as segmented-button key) and "annotationPath" referencing the annotation (with optional qualifier via #Qualifier). You can set showCounts (affects performance). Example shows two variants.
LANGUAGE: JSON
CODE:
```json
// File: manifest.json (fragment)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "C_STTA_SalesOrder_WD_20",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "quickVariantSelection": {
              "variants": {
                "0": {
                  "key": "_tab1",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive"
                },
                "1": {
                  "key": "_tab2",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#Cheap"
                }
              },
              "showCounts": true
            }
            // ... other settings
          }
        }
      }
    ]
  }
}
```

STEP: 6 — Important notes for OData V2 manifest configuration
DESCRIPTION: Actionable points for implementing quickVariantSelection in V2.
LANGUAGE: JSON
CODE:
```json
{
  "notes": [
    "Each 'variants' entry requires a 'key' (used to initialize the SegmentedButton item).",
    "annotationPath must reference annotation namespace + term and optional qualifier (e.g. com.sap.vocabularies.UI.v1.SelectionVariant#Expensive).",
    "SelectionPresentationVariant: only SelectionVariant inside is used to obtain filters; PresentationVariant part is not considered for filtering here."
  ]
}
```

STEP: 7 — Configure manifest.json for OData V4 (sap.fe.templates.ListReport) single table mode
DESCRIPTION: For OData V4 and FE, configure the ListReport target component under routing > targets > <TargetName> > options > settings > controlConfiguration > @LineItem > tableSettings > quickVariantSelection. Use "paths" array where each path has annotationPath. Optional settings: hideTableTitle (true to hide title and display only segmented buttons) and showCounts (enables count requests; may impact performance).
LANGUAGE: JSON
CODE:
```json
// File: manifest.json (fragment for OData V4 ListReport target)
{
  "routing": {
    "targets": {
      "SalesOrderManageList": {
        "type": "Component",
        "id": "SalesOrderManageList",
        "name": "sap.fe.templates.ListReport",
        "options": {
          "settings": {
            "contextPath": "/SalesOrderManage",
            "controlConfiguration": {
              "@com.sap.vocabularies.UI.v1.LineItem": {
                "tableSettings": {
                  "type": "ResponsiveTable",
                  "quickVariantSelection": {
                    "paths": [
                      { "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Open" },
                      { "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Completed" },
                      { "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#NotRelevant" },
                      { "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#InProcess" }
                    ],
                    "hideTableTitle": true,
                    "showCounts": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 8 — Notes for OData V4 configuration and behavior
DESCRIPTION: Clarify segmented button counts and title behavior.
LANGUAGE: JSON
CODE:
```json
{
  "notes": [
    "showCounts: true -> segmented buttons request counts ($count) and show counts next to the label; table title will not show a count.",
    "showCounts: false -> no counts next to segmented buttons; table title may show counts if implemented elsewhere.",
    "hideTableTitle: true -> removes the table title leaving only segmented buttons. Use only if selection variant titles are explicit."
  ]
}
```

STEP: 9 — Quick checklist for implementation
DESCRIPTION: Copy-paste checklist to validate implementation.
LANGUAGE: JSON
CODE:
```json
{
  "checklist": [
    "Define SelectionVariant or SelectionPresentationVariant annotations (XML/ABAP/CDS) with qualifiers if needed.",
    "For V2: add quickVariantSelection under sap.ui.generic.app > pages > component > settings and provide 'variants' entries with key + annotationPath.",
    "For V4: add quickVariantSelection under routing > targets > ... > controlConfiguration > @LineItem > tableSettings and provide 'paths' with annotationPath.",
    "Decide whether to enable showCounts (performance impact).",
    "Decide whether to hideTableTitle (ensure labels are clear).",
    "Verify supported SelectionRangeOptionTypes and avoid FilterExpression usage."
  ]
}
```
--------------------------------

**TITLE**: Configuring Multiple List Report Views with Different Entity Sets and Table Settings (SAP Fiori Elements V2 & V4)

**INTRODUCTION**: This guide shows how to configure a List Report to display multiple tabs (views) that use different entity sets and table settings. It covers:
- manifest.json configuration for OData V2 (quickVariantSelectionX + tableSettings + controlConfiguration personalization per entity set)
- XML and CDS annotation examples and manifest targets for OData V4
- System behavior for filters and counts and important cautions.

**TAGS**: fiori-elements-framework, list-report, manifest.json, quickVariantSelectionX, tableSettings, controlConfiguration, odata-v2, odata-v4, selectionvariant, selectionpresentationvariant, annotations

STEP: 1 — Prerequisites and global cautions

DESCRIPTION:
- Prerequisite: implement multiple-table-mode per "Defining Multiple Views on a List Report Table - Multiple Table Mode".
- Key cautions (apply to V2 and V4):
  - Do not mix draft and non-draft entity sets.
  - Do not mix responsive and non-responsive table types (no mixing responsive with grid/tree/analytical).
  - Use only for similar business objects sharing a subset of fields; otherwise usability and performance degrade.
  - Actions (custom extension points) are supported only for the main entity set.
  - Charts must not use draft-enabled or read-only services/entities.
- For multiple entity sets: counts in the icon tab bar are shown by default and update when filters change. Filters originate from the main entity set filter bar and are applied to each table only when the property exists in the table's entity type; otherwise ignored.

LANGUAGE: JSON

CODE:
```json
{
  "note": "Set the leading entitySet under sap.ui.generic.app/pages to define the filter bar and footer. Each view/variant can override entitySet and annotationPath."
}
```

STEP: 2 — OData V2: Define multiple variants with different entity sets and table settings (quickVariantSelectionX)

DESCRIPTION:
- Under "sap.ui.generic.app" -> "pages" define the leading entitySet (used for filter bar).
- Under settings.quickVariantSelectionX.variants define each variant with:
  - key: variant key (string)
  - entitySet: entity set to render for this variant (if omitted, the leading entitySet is used)
  - annotationPath: annotation qualifier that applies to that entity set (must reference an annotation that belongs to that entity set)
  - tableSettings: configure table type (GridTable, TreeTable, AnalyticalTable, ResponsiveTable). Do not mix responsive and non-responsive table types across the app.
- Example below shows three variants (two grid tables, one tree table + a chart variant).

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "C_RequirementTrackingPurReq",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "condensedTableLayout": true,
            "smartVariantManagement": false,
            "quickVariantSelectionX": {
              "variants": {
                "1": {
                  "key": "1",
                  "entitySet": "C_RequirementTrackingPurReq",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#VAR1",
                  "tableSettings": {
                    "type": "GridTable"
                  }
                },
                "2": {
                  "key": "2",
                  "entitySet": "C_RequirementTrackingPurOrd",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#VAR5",
                  "tableSettings": {
                    "type": "GridTable"
                  }
                },
                "3": {
                  "key": "3",
                  "entitySet": "C_RequirementTrackingPurReq",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#VAR6",
                  "showItemNavigationOnChart": true,
                  "tableSettings": {
                    "type": "TreeTable"
                  }
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 3 — OData V2: controlConfiguration — define different personalization per entity set

DESCRIPTION:
- Use controlConfiguration to apply different table/personalization settings per table. Prefix the annotation path with the entity set name to scope configuration to that entity (e.g., "/EntityB/@com.sap.vocabularies.UI.v1.LineItem").
- Example: disable personalization for the main entity, enable column + filter personalization for EntityB.

LANGUAGE: JSON

CODE:
```json
{
  "targets": {
    "DraftList": {
      "type": "Component",
      "id": "DraftList",
      "name": "sap.fe.templates.ListReport",
      "options": {
        "settings": {
          "contextPath": "/EntityA",
          "views": {
            "paths": [
              {
                "key": "tab1",
                "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant"
              },
              {
                "key": "tab2",
                "entitySet": "EntityB",
                "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant"
              }
            ]
          },
          "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.LineItem": {
              "tableSettings": {
                "personalization": false
              }
            },
            "/EntityB/@com.sap.vocabularies.UI.v1.LineItem": {
              "tableSettings": {
                "personalization": {
                  "column": true,
                  "sort": false,
                  "filter": true,
                  "group": false
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — System behavior for filters and counts (summary and examples)

DESCRIPTION:
- Filters visible in the filter bar are defined by the leading entity set only.
- When a filter property exists in multiple entity types, it is applied to each table; when it doesn't exist for a given entity type, it is ignored for that table.
- Counts per tab update based on applicable filters. If a filter is not relevant to a tab's entity type, counts for that tab remain unchanged; the UI displays a message when filters are not relevant to the active tab.
- Example behavior (no code change required): adding Property S3 (only present in entity of tab1) will change tab1 count, not tab2 count, and prompt a message when switching to tab2.

LANGUAGE: JSON

CODE:
```json
{
  "behaviorSummary": [
    "Filter bar fields = main (leading) entitySet only",
    "Filters are applied to each table only if property exists in that table's entity type",
    "Counts shown in icon tab bar update only when filters are relevant to each tab"
  ]
}
```

STEP: 5 — OData V4: Define SelectionVariant (SV) and SelectionPresentationVariant (SPV) annotations

DESCRIPTION:
- Define SV/SPV annotations per entity (XML or CDS) and reference them from views in manifest targets.
- The SV applies filters; the SPV can contain SelectionVariant + PresentationVariant (sorting, MaxItems).
- Ensure the annotation qualifiers referenced in the manifest belong to the corresponding entity.

LANGUAGE: XML

CODE:
```xml
<!-- XML Annotation: SelectionVariant for myService.entityB -->
<Annotations Target="myService.entityB">
  <Annotation Term="UI.SelectionVariant" Qualifier="One">
    <Record Type="UI.SelectionVariantType">
      <PropertyValue Property="SelectOptions">
        <Collection>
          <Record Type="UI.SelectOptionType">
            <PropertyValue Property="PropertyName" PropertyPath="propertyInteger" />
            <PropertyValue Property="Ranges">
              <Collection>
                <Record Type="UI.SelectionRangeType">
                  <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                  <PropertyValue Property="Low" String="1" />
                </Record>
              </Collection>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Text" String="entityA with one follower" />
    </Record>
  </Annotation>
</Annotations>

<!-- XML Annotation: SelectionPresentationVariant for myService.entityA -->
<Annotations Target="myService.entityA">
  <Annotation Term="UI.SelectionPresentationVariant" Qualifier="trueSPV">
    <Record Type="UI.SelectionPresentationVariantType">
      <PropertyValue Property="Text" String="entityB with true value" />
      <PropertyValue Property="SelectionVariant">
        <Record Type="UI.SelectionVariantType">
          <PropertyValue Property="SelectOptions">
            <Collection>
              <Record Type="UI.SelectOptionType">
                <PropertyValue Property="PropertyName" PropertyPath="propertyBoolean" />
                <PropertyValue Property="Ranges">
                  <Collection>
                    <Record Type="UI.SelectionRangeType">
                      <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ" />
                      <PropertyValue Property="Low" String="true" />
                    </Record>
                  </Collection>
                </PropertyValue>
              </Record>
            </Collection>
          </PropertyValue>
          <PropertyValue Property="Text" String="Medium Rating" />
        </Record>
      </PropertyValue>
      <PropertyValue Property="PresentationVariant">
        <Record Type="UI.PresentationVariantType">
          <PropertyValue Property="MaxItems" Int="3" />
          <PropertyValue Property="SortOrder">
            <Collection>
              <Record Type="Common.SortOrderType">
                <PropertyValue Property="Property" PropertyPath="propertyInteger" />
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 6 — OData V4: CDS annotation sample (SelectionVariant + SelectionPresentationVariant)

DESCRIPTION:
- CDS-style annotations for CAP or CDS-based services. Use qualifiers to reference annotations in the manifest.

LANGUAGE: CDS

CODE:
```cds
annotate entityB with @(
  UI.SelectionVariant#One : {
    Text: 'entityA with one follower',
    SelectOptions: [
      {
        $Type : 'UI.SelectOptionType',
        PropertyName : propertyInteger,
        Ranges: [
          {
            $Type: 'UI.SelectionRangeType',
            Option: #EQ,
            Low: '1'
          }
        ]
      }
    ]
  }
);

annotate entityA with @(
  UI.SelectionPresentationVariant#trueSPV : {
    Text: 'entityB with true value',
    SelectionVariant: {
      SelectOptions: [
        {
          $Type : 'UI.SelectOptionType',
          PropertyName : propertyBoolean,
          Ranges: [
            {
              $Type: 'UI.SelectionRangeType',
              Option: #EQ,
              Low: 'true'
            }
          ]
        }
      ]
    },
    PresentationVariant: {
      MaxItems: 3,
      SortOrder: [{ Property : 'ID' }]
    }
  }
);
```

STEP: 7 — OData V4: manifest configuration for multiple views (targets -> views.paths)

DESCRIPTION:
- For SAP Fiori elements V4 use "targets" -> component "options" -> "settings" -> "views" -> "paths". Each entry:
  - key: tab key
  - annotationPath: SV/SPV qualifier referenced (fully qualified term)
  - entitySet: optional; required if the annotationPath refers to an annotation on a different entity than the main contextPath
- The main contextPath defines the leading entity set used by the filter bar.

LANGUAGE: JSON

CODE:
```json
{
  "targets": {
    "DraftList": {
      "type": "Component",
      "id": "DraftList",
      "name": "sap.fe.templates.ListReport",
      "options": {
        "settings": {
          "contextPath": "/entityA",
          "views": {
            "paths": [
              {
                "key": "tab1",
                "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#trueSPV"
              },
              {
                "key": "tab2",
                "entitySet": "entityB",
                "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#One"
              }
            ]
          }
        }
      }
    }
  }
}
```

STEP: 8 — Additional V4 controlConfiguration example (per-entity table personalization)

DESCRIPTION:
- Prefix annotation key with the entity set name to scope controlConfiguration to that entity:
  - "/EntityB/@com.sap.vocabularies.UI.v1.LineItem" -> config applies only for EntityB table
- Example below demonstrates no personalization for EntityA and specific personalization for EntityB.

LANGUAGE: JSON

CODE:
```json
{
  "targets": {
    "DraftList": {
      "type": "Component",
      "id": "DraftList",
      "name": "sap.fe.templates.ListReport",
      "options": {
        "settings": {
          "contextPath": "/EntityA",
          "views": {
            "paths": [
              {
                "key": "tab1",
                "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant"
              },
              {
                "key": "tab2",
                "entitySet": "EntityB",
                "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant"
              }
            ]
          },
          "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.LineItem": {
              "tableSettings": {
                "personalization": false
              }
            },
            "/EntityB/@com.sap.vocabularies.UI.v1.LineItem": {
              "tableSettings": {
                "personalization": {
                  "column": true,
                  "sort": false,
                  "filter": true,
                  "group": false
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 9 — Quick checklist before deployment

DESCRIPTION:
- Verify:
  - Each annotationPath qualifier exists and is declared on the correct entity (annotation target).
  - entitySet in variant/view is set when annotation belongs to a non-leading entity.
  - You are not mixing responsive and non-responsive table types across views.
  - No draft/non-draft mix in the same list report.
  - Charts are not bound to draft-enabled/read-only entities when used in SelectionPresentationVariant.
- Test filter behavior: add filters only available to main entity and verify counts and UI messages on tabs.

LANGUAGE: JSON

CODE:
```json
{
  "deploymentChecklist": [
    "annotation qualifiers exist and match entity targets",
    "entitySet specified for non-leading entity annotations",
    "table types consistent across responsive vs non-responsive",
    "no draft + non-draft mix",
    "charts not draft-enabled/read-only"
  ]
}
```
--------------------------------

**TITLE**: Defining Loading Behavior for Object Page (OData V4) — Request Groups & Lazy Loading

**INTRODUCTION**: This document explains how to control request grouping for Object Page header elements (DataPoint, MicroChart) in SAP Fiori elements (OData V4) by configuring controlConfiguration in manifest.json, and summarizes the built-in lazy-loading behavior for Object Page sections. Use these instructions to group header KPI/chart requests into batches and to understand how and when section data is requested.

**TAGS**: fiori-elements-framework, OData V4, object-page, request-groups, lazy-loading, manifest.json, controlConfiguration, DataPoint, MicroChart

**STEP**: 1 — Request groups overview

**DESCRIPTION**: SAP Fiori elements supports four named request groups to bundle requests into batch requests. Use these group names when assigning requestGroupId for header DataPoint and MicroChart controls.

- Heroes
  - Requests for all fields coming directly from the main entity set
  - All 1:1 (multiplicity) fields from header forms or KPIs (data points and micro charts) and visible section forms
- Workers
  - All tables
- Decoration
  - All 1-n (multiplicity) micro charts in the header
- LongRunners
  - For slower KPIs (complex analytical services). Note: Not used internally by Fiori elements by default; applications can use it to separate slow KPI requests into a dedicated batch.

Use the above names to group DataPoint and MicroChart requests from the header by setting requestGroupId in controlConfiguration (annotation path is the key).

**LANGUAGE**: text

**CODE**:
```text
Use group names exactly: "Heroes", "Workers", "Decoration", "LongRunners".
Assign requestGroupId per annotation path in manifest.json controlConfiguration.
```

**STEP**: 2 — Configure header elements into request groups in manifest.json

**DESCRIPTION**: Add controlConfiguration entries under the Object Page component in your manifest. Use the annotation path (annotation qualifier + annotation type) as the key and set "requestGroupId" to one of the supported group names. This instructs Fiori elements to include that DataPoint/MicroChart request in the specified batch group.

- Key format examples:
  - DataPoint with qualifier: "@com.sap.vocabularies.UI.v1.DataPoint#NetValue"
  - MicroChart on a navigation property: "_CreditLimitDetails/@com.sap.vocabularies.UI.v1.Chart#CreditLimitChart"

Place these settings under the component that uses the Object Page template (options.settings.controlConfiguration).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "components": {
      "SalesOrderManageObjectPage": {
        "type": "Component",
        "id": "SalesOrderManageObjectPage",
        "name": "sap.fe.templates.ObjectPage",
        "options": {
          "settings": {
            "contextPath": "/SalesOrderManage",
            "controlConfiguration": {
              "@com.sap.vocabularies.UI.v1.DataPoint#NetValue": {
                "requestGroupId": "Workers"
              },
              "_CreditLimitDetails/@com.sap.vocabularies.UI.v1.Chart#CreditLimitChart": {
                "requestGroupId": "LongRunners"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Behavior and limitations when grouping requests

**DESCRIPTION**: Important operational notes and recommended practices for request grouping:

- Fiori elements fires batch groups in parallel, but cannot fully control the underlying OData model behavior — requests may be staggered with slight delays.
- Fiori elements recommends grouping all requests for the same logical group into a single batch using requestGroupId, but the model might start some requests from the same group earlier than others (e.g., a DataPoint may be fired before a table even when both are in the same group).
- Recommendation: Place LongRunners KPIs at the right-most end of the header so that left-side (visible) header information loads first using Heroes/Workers/Decoration groups.
- If you need to ensure strict ordering beyond what Fiori elements manages, coordinate with your OData model/service or implement custom logic in the backend/model.

**LANGUAGE**: text

**CODE**:
```text
Notes:
- Fiori elements groups -> parallel batch requests with slight delays.
- requestGroupId groups requests but cannot guarantee atomic grouping if model prepares some requests earlier.
- Recommendation: move LongRunners KPIs to the right side of header.
```

**STEP**: 4 — Lazy loading behavior of Object Page sections (default, cannot be disabled)

**DESCRIPTION**: Lazy loading delays data calls for Object Page sections that are not visible. Fiori elements (OData V4) enables this by default and applications cannot disable it. The runtime behavior:

- Simple scenario (header has no micro charts AND no form section contains a table):
  - Two batch requests are sent:
    1. Header request (main entity + visible header fields)
    2. Section data request that includes:
       - For desktop: the first three subsections
       - For touch devices (tablet/mobile): only the currently visible subsections
- Complex scenario (header has one or more micro charts OR any form section contains a table):
  - Two additional parallel batch calls are added:
    - Table request(s) in a separate batch (parallel)
    - All micro charts in a separate batch (parallel)
- Scrolling behavior:
  - When the user scrolls and a section becomes visible, a separate batch request for that subsection is sent.
- Error handling:
  - If backend error messages exist for fields in not-yet-visible sections, lazy loading is switched off to load those sections (so validation messages can link to the offending fields).
- Subsequent navigations:
  - On subsequent loads of the Object Page (for example, navigate back to list report and then open another object), header + visible subsections are requested in a single batch as a single GET.

**LANGUAGE**: text

**CODE**:
```text
Lazy loading summary:
- Default ON (cannot disable).
- Simple: header + visible subsections (desktop: first 3 subsections) -> 2 batch requests.
- Complex: add separate batch for tables and separate batch for micro charts (parallel).
- Scrolling: loads additional subsections via separate batch requests on demand.
- Errors for hidden fields: lazy loading disabled to surface relevant sections for messages.
- Subsequent open of object page: header + visible subsections combined into a single GET batch.
```
--------------------------------

**TITLE**: Configure Object Page Subsection Loading Behavior (Fiori elements, OData V2)

**INTRODUCTION**: Configure when a subsection on an Object Page activates its binding and loads data by setting loadingBehavior in the app manifest. This is applicable only to SAP Fiori elements for OData V2. Use these settings to defer binding until header data is available or until the subsection enters the viewport (lazy loading).

**TAGS**: fiori-elements-framework, OData V2, manifest.json, object-page, subsections, loadingBehavior, performance

**STEP**: 1 — Minimal loadingBehavior definition

**DESCRIPTION**: Add loadingBehavior to a subsection entry to control activation of its binding. Two boolean properties are available:
- waitForHeaderData: if true, subsection waits for header data to be loaded before activating binding (useful for adding header-based filters in onBeforeRebindTableExtension).
- waitForViewportEnter: if true, subsection waits until it enters the viewport (lazy-load) before activating binding.

Place the loadingBehavior under the relevant ObjectPage or SubObjectPage section entry in manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "loadingBehavior": {
    "waitForHeaderData": true,
    "waitForViewportEnter": false
  }
}
```

**STEP**: 2 — Default behavior and partial-definition rule

**DESCRIPTION**: If loadingBehavior is not defined for a subsection, the default is:
- waitForHeaderData: false
- waitForViewportEnter: true

If you define only one property explicitly, any property you omit is considered false (e.g., defining waitForHeaderData: true without waitForViewportEnter means waitForViewportEnter is false).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "loadingBehavior": {
    "waitForHeaderData": false,
    "waitForViewportEnter": true
  }
}
```

**STEP**: 3 — Full manifest fragment showing placement (sap.ui.generic.app pages -> ObjectPage)

**DESCRIPTION**: Example manifest.json fragment illustrating where to add loadingBehavior for subsections. Insert under manifest.json -> "sap.ui.generic.app" -> "pages" -> "<ObjectPage ID>" -> "component" -> "settings" -> "sections" -> "<Subsection ID>".

- SalesOrderItemsID: waits for header data, does not wait for viewport (use when you need header filters applied before table/chart rebinding).
- ContactsID: configured to load immediately (does not wait for header nor viewport).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|C_STTA_SalesOrder_WD_20": {
        "entitySet": "C_STTA_SalesOrder_WD_20",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "sections": {
              "SalesOrderItemsID": {
                "navigationProperty": "to_Item",
                "entitySet": "C_STTA_SalesOrderItem_WD_20",
                "createMode": "inline",
                "tableSettings": {
                  "inlineDelete": true
                },
                "loadingBehavior": {
                  "waitForHeaderData": true,
                  "waitForViewportEnter": false
                }
              },
              "ContactsID": {
                "loadingBehavior": {
                  "waitForHeaderData": false,
                  "waitForViewportEnter": false
                }
              }
            }
          }
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Deploy an SAP Fiori Application (Business Application Studio / VS Code)

**INTRODUCTION**: Practical, code-focused steps to deploy SAP Fiori (UI5 / Fiori elements) applications from SAP Business Application Studio (BAS) or Visual Studio Code (VS Code). Includes local build commands, packaging for MTA, and how to invoke the SAP Fiori tools deploy wizards for SAP BTP (Cloud Foundry/Neo) and ABAP targets.

**TAGS**: fiori-elements-framework, sap-fiori-tools, ui5, ui5-cli, mbt, mta, sap-btp, cloud-foundry, abap, business-application-studio, visual-studio-code, deploy

**STEP**: Prerequisites
**DESCRIPTION**: Ensure required tools and extensions are installed and the project contains standard UI5/Fiori files (webapp folder, manifest.json). Optional but recommended when deploying to SAP BTP multi-target applications: mta.yaml in project root.
**LANGUAGE**: Shell / Notes
**CODE**:
```bash
# Required (install in local environment or ensure available in BAS/VS Code terminal)
npm install --save-dev @ui5/cli      # UI5 build tool
# Optional (for multi-target applications)
npm install -g mbt                   # MTA builder for creating .mtar archives
# Recommended extensions (VS Code / BAS):
# - SAP Fiori tools - Application Modeler
# - SAP Fiori tools - Application Generator
# - SAP Fiori tools - Extension Pack / deploy-related extensions
```

**STEP**: Local build (UI5 production build)
**DESCRIPTION**: Produce the distributable UI5 application under ./dist. Use ui5-cli for reproducible builds. Add these scripts to package.json for CI/automation.
**LANGUAGE**: JSON / Shell
**CODE**:
```json
// package.json (scripts section)
{
  "scripts": {
    "build": "ui5 build --include-dependencies --dest dist",
    "build:clean": "rm -rf dist && npm run build"
  }
}
```
```bash
# Run the build
npm install
npm run build
# Result: dist/ (contains index.html, resources, Component-preload.js, etc.)
```

**STEP**: Package a static app (ZIP)
**DESCRIPTION**: Create a ZIP of the dist folder if you need to upload a ZIP to a platform or include static app in an mtar.
**LANGUAGE**: Shell
**CODE**:
```bash
# From project root
cd dist
zip -r ../app.zip .
# app.zip will contain the built app
```

**STEP**: Build an MTA archive (.mtar) for SAP BTP (if applicable)
**DESCRIPTION**: Use mbt to package an mta-enabled project to an .mtar which is deployable to SAP BTP (Cloud Foundry / Neo depending on mta configuration).
**LANGUAGE**: Shell
**CODE**:
```bash
# Ensure mta.yaml exists at project root
mbt build
# Output path: mta_archives/<project-name>_<version>.mtar
ls mta_archives/*.mtar
```

**STEP**: Deploy using SAP Fiori tools (recommended, wizard-driven)
**DESCRIPTION**: From BAS or VS Code, invoke the SAP Fiori tools deployment wizard. The wizard performs build/packaging (if needed) and pushes to the selected target (SAP BTP or ABAP). Follow prompts to provide connection and transport details.
**LANGUAGE**: Instructions
**CODE**:
```text
# In BAS / VS Code:
# 1. Open Command Palette (F1 or Ctrl/Cmd+Shift+P)
# 2. Run: "Fiori: Deploy Application"  (or "Fiori: Deploy to ABAP" for ABAP target)
# 3. Select target: SAP BTP (Cloud Foundry / Neo) or ABAP
# 4. Provide connection details (API endpoint, org/space or ABAP system, user credentials)
# 5. Confirm build/packaging options and deploy
```

**STEP**: Manual deploy to SAP BTP (Cloud Foundry) — platform guidance
**DESCRIPTION**: Upload the .mtar using SAP BTP cockpit or use the platform CLI tools. The exact method depends on your environment (Cloud Foundry vs Neo). Use SAP BTP cockpit for a UI upload or platform CLIs for automation.
**LANGUAGE**: Shell / Notes
**CODE**:
```bash
# Example steps (Cloud Foundry)
# 1) Log in to Cloud Foundry (use your environment's API)
cf login -a https://api.cf.<region>.hana.ondemand.com -u <user> -p <password> -o <org> -s <space>

# 2) Upload the mtar via SAP BTP cockpit (Subaccount -> Spaces -> Upload MTA)
# OR use the SAP deployment method your landscape requires (CI/CD or cockpit UI).

# Notes:
# - If using CI/CD: upload mta_archives/*.mtar as artifact and deploy from your pipeline.
# - For Neo: use Neo deployment mechanisms (SAP cockpit upload or neo-cli specific commands).
```

**STEP**: Deploy to ABAP (BSP repository) manually or via Fiori tools
**DESCRIPTION**: For on-premise or ABAP-based deployment, use the "Deploy to ABAP" wizard in SAP Fiori tools or import the built UI5 app into ABAP using ABAP Development Tools (ADT) / BSP application. Provide transport request / package details during deployment.
**LANGUAGE**: Instructions / Shell
**CODE**:
```text
# Using SAP Fiori tools:
# 1. Open Command Palette (F1 or Ctrl/Cmd+Shift+P)
# 2. Run: "Fiori: Deploy to ABAP"
# 3. Select built folder (dist/) or let the tool build, then follow prompts:
#    - ABAP system host / client
#    - User credentials
#    - Package / Transport request
# 4. Confirm and run deploy

# Manual (ADT) flow:
# 1. Build project -> dist/
# 2. In Eclipse ADT: Create BSP application or deploy files to existing BSP package
# 3. Upload files (index.html, Component-preload.js, resources) to the BSP application
# 4. Save and release transport request
```

**STEP**: Verify deployment and common troubleshooting
**DESCRIPTION**: Confirm app is reachable and correct versions are deployed. Common checks: browser renders index.html, console shows no missing resource errors, application manifest and Component-preload.js are present on target.
**LANGUAGE**: Shell / Notes
**CODE**:
```bash
# Verify files exist on the deployed target (example local check for dist)
ls -la dist
# Expected: index.html, Component-preload.js, manifest.json, resources/, i18n/

# Post-deploy checks:
# - Open application URL in browser (BTP app route or ABAP BSP URL)
# - Check browser console/network for 404/500 errors
# - If authentication/authorization issues: verify role assignment / OAuth configuration (BTP) or ICF/authorization checks (ABAP)
```

**STEP**: Example package.json full snippet (build + package + deploy script placeholder)
**DESCRIPTION**: Minimal script set to standardize build and package steps. Replace deploy script with your CI/CD or platform-specific command.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "name": "my-fiori-app",
  "version": "1.0.0",
  "scripts": {
    "build": "ui5 build --include-dependencies --dest dist",
    "package": "cd dist && zip -r ../app.zip .",
    "mtabuild": "mbt build",
    "deploy:placeholder": "echo 'Replace with platform-specific deploy command or CI/CD step'"
  },
  "devDependencies": {
    "@ui5/cli": "^3.1.0"
  }
}
```
--------------------------------

**TITLE**: Extension Functions Reference and Code Examples for Adapting Delivered SAP Fiori elements (OData V2)

**INTRODUCTION**: Quick, code-focused reference for all adaptation-extension hook functions available for SAP Fiori elements (OData V2). Each step shows the supported floorplans, a concise description, and a minimal JavaScript example demonstrating how to call the provided framework callbacks (fn* functions) from a controller extension.

**TAGS**: fiori-elements-framework, adaptation-extensions, odata-v2, sapui5, extension-hooks, list-report, object-page, overview-page

**STEP**: onInitSmartFilterBar

**DESCRIPTION**: Hook invoked when the SmartFilterBar has been initialized. Use this to access the filter bar instance and attach logic (e.g., additional event handlers).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// In your controller extension
onInitSmartFilterBar: function(oEvent) {
  // oEvent.getSource() === SmartFilterBar instance
  var oSmartFilterBar = oEvent.getSource();
  // Example: attach a custom event handler
  oSmartFilterBar.attachSearch(function() {
    // custom search logic
  });
}
```

**STEP**: provideExtensionAppStateData

**DESCRIPTION**: Store extension-specific state in the app state (List Report, Analytical List Page, Overview Page). Use fnSetAppStateData(oControllerExtension, oAppState). oControllerExtension is typically the controller-extension instance (this). Call is ignored if oAppState is faulty.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Called by framework with fnSetAppStateData available in scope
provideExtensionAppStateData: function(fnSetAppStateData) {
  // Build a simple app-state object to persist
  var oAppState = {
    myExtension: {
      lastSelectedKey: "ABC",
      collapsedPanel: true
    }
  };
  // Persist the extension state for this controller extension
  fnSetAppStateData(this, oAppState);
}
```

**STEP**: restoreExtensionAppStateData

**DESCRIPTION**: Restore extension state from the current app state. Use fnGetAppStateData(oControllerExtension) to retrieve it. Returns undefined if nothing valid was stored.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
restoreExtensionAppStateData: function(fnGetAppStateData) {
  var oStored = fnGetAppStateData(this);
  if (oStored && oStored.myExtension) {
    var sKey = oStored.myExtension.lastSelectedKey;
    var bCollapsed = oStored.myExtension.collapsedPanel;
    // apply restored values to view/model
  } else {
    // fallback/default behavior
  }
}
```

**STEP**: ensureFieldsForSelect

**DESCRIPTION**: Ensure specific fields are included in the $select for the table binding (List Report, Analytical List Page, Object Page). Call fnEnsureSelectionProperty(oControllerExtension, sFieldname) for each required field. sFieldname can be an entity property or a relative path via a 1:1 navigation property.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
ensureFieldsForSelect: function(sControlId, fnEnsureSelectionProperty) {
  // Ensure base entity fields are included
  fnEnsureSelectionProperty(this, "CustomerID");
  fnEnsureSelectionProperty(this, "OrderDate");
  // Ensure a field via 1:1 navigation property (relative path)
  fnEnsureSelectionProperty(this, "To_SalesOrder/OrderID");
}
```

**STEP**: addFilters

**DESCRIPTION**: Add filters that will be combined with other filters using AND (List Report, Analytical List Page, Object Page, Overview Page). Call fnAddFilter(oControllerExtension, oFilter) with an instance of sap.ui.model.Filter.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
addFilters: function(fnAddFilter) {
  // Example: add a status filter (sap.ui.model.FilterOperator must be referenced)
  var Filter = sap.ui.model.Filter;
  var FilterOperator = sap.ui.model.FilterOperator;
  var oFilter = new Filter("Status", FilterOperator.EQ, "Open");
  fnAddFilter(this, oFilter);

  // Compound example: multiple filters applied by calling fnAddFilter multiple times
  var oDateFilter = new Filter("CreatedDate", FilterOperator.GE, "2025-01-01");
  fnAddFilter(this, oDateFilter);
}
```

**STEP**: provideExtensionStateData

**DESCRIPTION**: For Object Page only — store extension-specific state using fnSetExtensionStateData(oControllerExtension, oExtensionState). oExtensionState is the object to persist; lifecycle keys (Page, Permanent, etc.) should be provided as needed. Faulty oExtensionState will be ignored.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
provideExtensionStateData: function(fnSetExtensionStateData) {
  var oExtensionState = {
    Page: {
      sectionVisibility: {
        contactInfo: false,
        notes: true
      }
    },
    Permanent: {
      lastViewedTab: "details"
    }
  };
  fnSetExtensionStateData(this, oExtensionState);
}
```

**STEP**: restoreExtensionStateData

**DESCRIPTION**: For Object Page only — restore extension state stored via provideExtensionStateData. Use fnGetExtensionStateData(oControllerExtension) to read the stored state. A boolean bIsSameAsLast indicates whether the state is identical to the last saved state (true = cannot be adapted).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
restoreExtensionStateData: function(fnGetExtensionStateData, bIsSameAsLast) {
  var oState = fnGetExtensionStateData(this);
  if (oState && oState.Page) {
    var oVisibility = oState.Page.sectionVisibility || {};
    // apply visibility settings
  }
  if (bIsSameAsLast) {
    // optional: skip expensive UI changes if state unchanged
  }
}
```

**STEP**: provideStartupExtension

**DESCRIPTION**: Overview Page only — modify the selection variant (filter selection) that will be applied to the filter bar at startup. The parameter is a reference to the custom selection variant object expected by the overview page; return or mutate it as required.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
provideStartupExtension: function(oSelectionVariant) {
  // oSelectionVariant is the selection variant object used by the overview card
  // Example: pre-set a filter value
  oSelectionVariant.SelectOptions = oSelectionVariant.SelectOptions || [];
  oSelectionVariant.SelectOptions.push({
    PropertyName: "Priority",
    Ranges: [{
      Sign: "I",
      Option: "EQ",
      Low: "High"
    }]
  });
  return oSelectionVariant;
}
```

**STEP**: provideExtensionNavigation

**DESCRIPTION**: Overview Page only — supply a new or modified custom navigation entry. Framework calls this with the standard navigation entry details for a card and context; return the navigation entry object the core will use to perform navigation.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
provideExtensionNavigation: function(oNavigationEntry /* standard navigation entry object */) {
  // Modify target URL or add custom parameters
  var oCustomNav = Object.assign({}, oNavigationEntry);
  oCustomNav.target = {
    semanticObject: "CustomObject",
    action: "display"
  };
  oCustomNav.parameters = oCustomNav.parameters || {};
  oCustomNav.parameters.customParam = "value";
  return oCustomNav;
}
```

**STEP**: provideCustomActionPress

**DESCRIPTION**: Overview Page only — capture custom action press events and return the event handler to be executed by the core. The provided method should be defined in the controller extension and returned here.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Define the action handler in your controller extension
onCustomActionPress: function(oEvent, oContext) {
  // oEvent: press event, oContext: card/context info from framework
  // perform custom action
  MessageToast.show("Custom action executed");
},

// Provide it to the framework
provideCustomActionPress: function() {
  // Return the function reference that should handle the press
  return this.onCustomActionPress.bind(this);
}
```

**STEP**: provideCustomParameter

**DESCRIPTION**: Overview Page only — return a function (by name/key) that resolves custom parameters required by a card or navigation. The returned method should be defined in the extension controller and should return either an object or a Promise resolving to an object.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Define a parameter provider in extension controller
getCustomParameters: function(sKey, oContext) {
  // return params or a Promise that resolves to params
  return {
    userId: "USER123",
    locale: sap.ui.getCore().getConfiguration().getLanguage()
  };
},

// Provide the function to the framework
provideCustomParameter: function(sMethodName) {
  if (sMethodName === "getCustomParameters") {
    return this.getCustomParameters.bind(this);
  }
  // fallback: return undefined if no matching method
  return undefined;
}
```

**RELATED INFORMATION**:
- Extending Delivered Apps Using Adaptation Extensions: extending-delivered-apps-using-adaptation-extensions-52fc48b.md
--------------------------------

**TITLE**: Developing Apps with SAP Fiori Elements

**INTRODUCTION**: Minimal, practical example showing how to build a metadata-driven SAP Fiori Elements app using a CAP (CDS) OData service and UI annotations. Includes CDS model and service, optional external annotation XML, manifest.json setup for a Fiori Elements List Report + Object Page app, Component.js, and run scripts. Use this as a reproducible skeleton to generate a Fiori Elements app without custom UI coding.

**TAGS**: fiori-elements-framework, sap-fiori, odata, annotations, ui5, cap, cds, sapui5

STEP: 1 — Create CDS data model
DESCRIPTION: Define the domain model and UI annotations in CDS. You can include UI annotations inline in CDS (recommended for CAP) or provide them separately as XML files. Save model in db/ and service in srv/.
LANGUAGE: CDS
CODE:
```cds
// File: db/data-model.cds
namespace my.bookshop;

using { cuid } from '@sap/cds/common';

entity Books : cuid {
  title    : String(111);
  author   : String(111);
  genre    : String(40);
  price    : Decimal(9,2);
  createdAt: Timestamp;
}

// Optional: add CDS UI annotations inline (works with CAP OData service)
annotate my.bookshop.Books with {
  @UI: {
    headerInfo: {
      typeName: 'Book',
      typeNamePlural: 'Books',
      title: { $(title) : title }
    },
    lineItem: [
      { $Type: 'UI.DataField', Value: title },
      { $Type: 'UI.DataField', Value: author },
      { $Type: 'UI.DataField', Value: genre },
      { $Type: 'UI.DataField', Value: price }
    ],
    selectionFields: [ title, author, genre ]
  }
}
```

STEP: 2 — Expose OData service from CAP
DESCRIPTION: Create a simple service that exposes the Books entity as an OData service. Place service definition under srv/.
LANGUAGE: CDS
CODE:
```cds
// File: srv/book-service.cds
using { my.bookshop as db } from '../db/data-model';

service CatalogService @(path:'/catalog') {
  entity Books as projection on db.Books;
}
```

STEP: 3 — (Optional) External OData annotations XML
DESCRIPTION: If you prefer separate annotation files (e.g., for non-CAP backends), create an annotations XML and reference it from manifest.json. Example below is a minimal UI annotation for LineItem.
LANGUAGE: XML
CODE:
```xml
<!-- File: webapp/annotations/BooksAnnotations.xml -->
<edm:Edmx xmlns:edm="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edm:Reference Uri="http://docs.oasis-open.org/odata/metadata/v4">
    <edm:Include Namespace="Org.OData.Core.V1" Alias="Core"/>
  </edm:Reference>

  <edm:DataServices>
    <Schema Namespace="Annotations" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <Annotations Target="my.bookshop.Books">
        <Annotation Term="UI.LineItem">
          <Collection>
            <Record Type="UI.DataField"><PropertyValue Property="Value" Path="title"/></Record>
            <Record Type="UI.DataField"><PropertyValue Property="Value" Path="author"/></Record>
            <Record Type="UI.DataField"><PropertyValue Property="Value" Path="genre"/></Record>
            <Record Type="UI.DataField"><PropertyValue Property="Value" Path="price"/></Record>
          </Collection>
        </Annotation>
      </Annotations>
    </Schema>
  </edm:DataServices>
</edm:Edmx>
```

STEP: 4 — Configure Fiori Elements app manifest
DESCRIPTION: Configure webapp/manifest.json for a Fiori Elements List Report + Object Page. Include dataSources for the OData endpoint and (if used) external annotation files. Adjust the "sap.ui.generic.app" descriptor to point to your entity set.
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json
{
  "sap.app": {
    "id": "my.bookshop.app",
    "type": "application",
    "i18n": "i18n/i18n.properties",
    "title": "{{appTitle}}"
  },
  "sap.ui": {
    "technology": "UI5"
  },
  "sap.ui5": {
    "rootView": {
      "viewName": "sap.ui.generic.app.AppComponent",
      "type": "JS",
      "id": "App"
    },
    "dependencies": {
      "minUI5Version": "1.88.0",
      "libs": {
        "sap.m": {},
        "sap.ui.core": {},
        "sap.fe.core": {},
        "sap.ui.generic.app": {}
      }
    },
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "synchronizationMode": "None"
        }
      }
    },
    "resources": {
      "css": []
    }
  },
  "sap.platform.hcp": {},
  "sap.ui.generic.app": {
    "settings": {
      "entitySets": {
        "Books": {
          "entitySet": "Books"
        }
      }
    },
    "pages": [
      {
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "entitySet": "Books"
          }
        }
      }
    ]
  },
  "sap.app/ach": {},
  "dataSources": {
    "mainService": {
      "uri": "/catalog/",
      "type": "OData",
      "settings": {
        "odataVersion": "4.0"
      }
    },
    "annotations": {
      "uri": "annotations/BooksAnnotations.xml",
      "type": "ODataAnnotation"
    }
  }
}
```

STEP: 5 — Minimal Component.js to bootstrap Fiori Elements app
DESCRIPTION: Minimal Component.js to bootstrap the SAPUI5 application. Save under webapp/.
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/Component.js
sap.ui.define(["sap/ui/core/UIComponent"], function (UIComponent) {
  "use strict";
  return UIComponent.extend("my.bookshop.Component", {
    metadata: {
      manifest: "json"
    }
  });
});
```

STEP: 6 — Package.json and run scripts
DESCRIPTION: Provide npm scripts to run the CAP backend and serve the UI. Use cds watch to run both CAP service and UI (assumes project root contains db/, srv/, webapp/).
LANGUAGE: JSON
CODE:
```json
// File: package.json (relevant parts)
{
  "name": "bookshop-fiori-elements",
  "version": "1.0.0",
  "private": true,
  "scripts": {
    "start": "cds watch",
    "build": "cds build/all"
  },
  "dependencies": {
    "@sap/cds": "^6",
    "@sap/cds-odata-v4": "^2",
    "express": "^4"
  }
}
```

STEP: 7 — Run and test
DESCRIPTION: Commands to start the app locally. cds watch will serve the OData v4 endpoint at /catalog and static UI from webapp/.
LANGUAGE: Shell
CODE:
```bash
# From project root
npm install
npm start
# Open in browser:
#   http://localhost:4004/webapp/index.html  (or the URL shown by cds watch)
# OData service metadata (check):
#   http://localhost:4004/catalog/$metadata
```

STEP: 8 — Notes & tips for generation/codegen
DESCRIPTION: Practical pointers for code generation and automation:
- Use CDS annotations for easiest integration; external XML annotations are useful if annotations must be maintained separately.
- Ensure manifest.json dataSources.uri matches runtime path of the OData service (e.g., "/catalog/").
- For Fiori Elements templates, set sap.ui.generic.app.pages[].component.name to the template you need (ListReport/ObjectPage v2 templates use sap.suite.ui.generic.template...).
- To generate a fully working app, populate demo data via db/data or use SQLite/HANA with cds deploy.
LANGUAGE: Text
CODE:
```text
File layout summary:
- db/data-model.cds
- srv/book-service.cds
- webapp/Component.js
- webapp/manifest.json
- webapp/annotations/BooksAnnotations.xml (optional)
- package.json

Common templates:
- List Report: sap.suite.ui.generic.template.ListReport
- Object Page: sap.suite.ui.generic.template.ObjectPage

Testing:
- Verify OData metadata and annotations are accessible:
  http://localhost:4004/catalog/$metadata
  http://localhost:4004/catalog/$metadata?sap-language=EN
```

--------------------------------

**TITLE**: Developing Reuse Components for SAP Fiori Elements (object page sections)

**INTRODUCTION**: Practical, code-focused guidelines and ready-to-use examples for implementing SAPUI5 reuse components that are embedded as sections in SAP Fiori elements object pages. Covers component metadata, property handling, model propagation, lifecycle hooks (stStart / stRefresh), lazy loading, subpage definition and navigation, and embedding manifest snippets.

**TAGS**: fiori-elements-framework, reuse-component, sapui5, UIComponent, ReuseComponentSupport, OData, object-page, extension-api, manifest.json

**STEP**: 1 — Project layout & stable IDs

**DESCRIPTION**: Decide whether the reuse component is a reusable library (shared across apps) or a one-off component (ship inside the same app). Ensure stable IDs for inner controls by defining the hosting view declaratively and specifying it in the reuse component's manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
// reuse-component/manifest.json (example snippet)
{
  "sap.ui5": {
    "rootView": {
      "viewName": "my.lib.view.Main",    // declarative view: ensures stable view ID
      "type": "XML",
      "id": "ReuseComponentView"
    },
    "dependencies": { /* ... */ }
  },
  "metadata": {
    "name": "my.lib.MyReuseComponent"
  }
}
```

**STEP**: 2 — Implement the reuse component (combine properties, mixIn, component model, and lifecycle hooks)

**DESCRIPTION**: Implement a UIComponent subclass. Declare all properties (including framework-reserved st* props) in metadata. Call ReuseComponentSupport.mixInto(this, sComponentModelName, bTwoWaySync) in init(). Use the returned Promise to access the extension API and component model safely. Override setters or bind the component model to react to property changes. Implement stStart and stRefresh to react to binding-context changes.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// reuse-component/Component.js
sap.ui.define([
  "sap/ui/core/UIComponent",
  "sap/suite/ui/generic/template/extensionAPI/ReuseComponentSupport"
], function(UIComponent, ReuseComponentSupport) {
  "use strict";

  return UIComponent.extend("my.lib.MyReuseComponent", {
    metadata: {
      manifest: "json",
      library: "my.lib",
      properties: {
        // Framework-reserved properties: must be declared if used
        uiMode: { type: "string", group: "standard" },          // Create | Display | Edit
        semanticObject: { type: "string", group: "standard" },
        stIsAreaVisible: { type: "boolean", group: "standard" },

        // Component-specific properties
        documentNumber: { type: "string", group: "specific", defaultValue: "" },

        // Name for navigation property (passed via settings in embedding manifest)
        theNavigationPropertyName: { type: "string", group: "specific", defaultValue: "" }
      }
    },

    init: function() {
      // Call super init defensively
      (UIComponent.prototype.init || jQuery.noop).apply(this, arguments);

      var that = this;

      // Transform this component into a reuse component for Fiori Elements.
      // 2nd param: name of the JSON component model exposed by Fiori Elements
      // 3rd param (boolean): optional two-way sync of model -> property (use with care)
      ReuseComponentSupport.mixInto(this, "myPropertiesModelName", false).then(function(oExtensionAPI) {
        // Promise resolves with the extension API instance attached to this reuse component
        that.oExtensionAPI = oExtensionAPI;

        // Now the component model is available via getComponentModel()
        that._attachToComponentModel();
      }).catch(function(err){
        // handle initialization errors
        jQuery.sap.log.error("ReuseComponentSupport.mixInto failed", err);
      });
    },

    /********** Property handling techniques **********/

    // Technique A: Override predefined setter for visibility and trigger refresh
    setStIsAreaVisible: function(bIsAreaVisible){
      if (bIsAreaVisible !== this.getStIsAreaVisible()){
        this.setProperty("stIsAreaVisible", bIsAreaVisible); // update property
        this.refreshImpl(); // custom refresh implementation (lazy)
      }
    },

    // Technique B: Consume component model bindings (recommended for other props)
    _attachToComponentModel: function(){
      var oModel = this.getComponentModel();
      if (!oModel) {
        return;
      }
      // Declarative two-way sync is optional; attach change handlers for properties
      // Example: documentNumber
      var oBinding = oModel.bindProperty("/documentNumber");
      oBinding.attachChange(function(){
        var sDocumentNumber = oModel.getProperty("/documentNumber");
        // Programmatic reaction to documentNumber change
        that._onDocumentNumberChange && that._onDocumentNumberChange(sDocumentNumber);
      });

      // Example: read other properties e.g. uiMode for initialization
      this._uiMode = oModel.getProperty("/uiMode");
    },

    /********** Lifecycle hooks: stStart / stRefresh **********/

    // Called once (first time page binding appears). Same signature as stRefresh.
    stStart: function(oModel, oBindingContext, oExtensionAPI) {
      // Save references and perform first-time initialization
      this.oModel = oModel;
      this.oBindingContext = oBindingContext;
      this.oExtensionAPI = oExtensionAPI;
      this.refreshImpl();
    },

    // Called on subsequent context changes or forced refreshes.
    stRefresh: function(oModel, oBindingContext, oExtensionAPI) {
      this.oModel = oModel;
      this.oBindingContext = oBindingContext;
      this.oExtensionAPI = oExtensionAPI;
      this.refreshImpl();
    },

    /********** Data loading and lazy behavior **********/

    refreshImpl: function(){
      // Only load data when (a) there is a valid binding context and (b) the section is visible
      if (this.oBindingContext && this.getStIsAreaVisible()){
        // Example: load/refresh data bound to this.oBindingContext using this.oModel
        // Implement the actual data loading logic here, e.g. read related entities:
        // var sPath = this.oBindingContext.getPath() + "/MyNavProperty";
        // this.oModel.read(sPath, { success: ..., error: ... });
        // After loading, optionally clear the stored binding context to prevent duplicate loads:
        this.oBindingContext = null;
      }
    }

  });
});
```

**STEP**: 3 — Use component model properties declaratively in views

**DESCRIPTION**: Use the component JSON model (the name provided to mixInto) for declarative bindings in XML views. This allows binding UI control properties to reuse-component properties.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- reuse-component/view/Main.view.xml -->
<mvc:View controllerName="my.lib.controller.Main" xmlns:mvc="sap.ui.core.mvc" xmlns:sfo="sap.ui.comp.smartform">
  <!-- Use component model name 'myPropertiesModelName' (as passed into mixInto) -->
  <sfo:SmartForm editable="{= ${myPropertiesModelName>/uiMode} !== 'Display' }">
    <!-- form content -->
  </sfo:SmartForm>
</mvc:View>
```

**STEP**: 4 — Embedding manifest: add embeddedComponents and pages (subpages)

**DESCRIPTION**: The embedding application adds a snippet to its app manifest to declare the reuse component instance, pass settings, and define available subpages for the reuse component. Use "settings" to pass property values (bindings) such as documentNumber and theNavigationPropertyName.

**LANGUAGE**: JSON

**CODE**:
```json
// app/manifest.json (snippet inside sap.ui5 or component configuration)
{
  "embeddedComponents": {
    "myComponentEmbedding": {
      "id": "myComponentEmbedding",
      "componentName": "my.lib.MyReuseComponent",
      "title": "{{I18N_KEY_FOR_REUSE_COMPONENT_TITLE}}",
      "settings": {
        "documentNumber": "{documentNumber}",            // binding from host page
        "theNavigationPropertyName": "myNavigationProperty"
      },
      "pages": {
        // Define subpages that can be navigated to from the reuse component
        "ObjectPage|myNavigationProperty": {
          "navigationProperty": "myNavigationProperty",
          "entitySet": "myDependingEntitySet",
          "component": {
            "name": "sap.suite.ui.generic.template.ObjectPage"
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Trigger internal navigation to a subpage (from reuse component)

**DESCRIPTION**: To navigate to a subpage declared in the embedding manifest, use the navigation controller available on the extension API. Pass a binding context and navigationData with navigationProperty.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example event handler inside reuse component controller or component code
function navigateToSubpage(oEvent) {
  var oBindingContext = oEvent.getSource().getBindingContext();  // target binding context
  var oNavigationController = this.oExtensionAPI.getNavigationController(); // injected extension API
  var sNavigationProperty = this.getMetadata().getProperty("theNavigationPropertyName") || this.getTheNavigationPropertyName();
  var oNavigationData = {
    navigationProperty: sNavigationProperty
  };
  // navigateInternal accepts (oBindingContext, oNavigationData)
  oNavigationController.navigateInternal(oBindingContext, oNavigationData);
}
```

**STEP**: 6 — Reserved names, instance isolation, and model propagation rules

**DESCRIPTION**: Follow these rules when coding reuse components:
- Do not store instance-level state in singletons; state must be instance-specific.
- The OData unnamed model (default model) and a JSON model named "ui" from the application are propagated into the reuse component.
- Additional app-internal JSON models may also be propagated; do not access non-documented propagated models.
- Framework-reserved property names start with "st". Declare them in metadata if used. Do not create your own methods starting with "st" or "_st" except for documented methods (stStart / stRefresh).
- The method name getComponentModel is reserved by SAP Fiori elements for the component-model API; do not override it.
- ReuseComponentSupport.mixInto(this, sComponentModelName, bTwoWaySync) — the sComponentModelName string makes the component model available via getComponentModel(); bTwoWaySync enables optional two-way sync (use carefully).

**LANGUAGE**: JSON

**CODE**:
```json
// Notes for implementers (not a runnable file):
{
  "rules": [
    "Do not define methods starting with 'st' or '_st' except documented lifecycle hooks.",
    "Do not override getComponentModel(); it is added by the framework.",
    "Propagated models: unnamed OData model (default) + JSON model 'ui'. Avoid non-documented propagated models."
  ]
}
```

**STEP**: 7 — Combine lazy loading with stRefresh (example pattern)

**DESCRIPTION**: Example pattern where visibility changes trigger a refresh and stRefresh provides binding context and model to be used for lazy loading.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Key methods extracted as pattern (inside the reuse component)
setStIsAreaVisible: function(bIsAreaVisible){
  if (bIsAreaVisible !== this.getStIsAreaVisible()){
    this.setProperty("stIsAreaVisible", bIsAreaVisible);
    this.refreshImpl();
  }
},

stRefresh: function(oModel, oBindingContext, oExtensionAPI) {
  this.oModel = oModel;
  this.oBindingContext = oBindingContext;
  this.oExtensionAPI = oExtensionAPI;
  this.refreshImpl();
},

refreshImpl: function(){
  if (this.oBindingContext && this.getStIsAreaVisible()){
    // load data for this.oBindingContext using this.oModel
    // clear binding context to avoid reloading until next stRefresh:
    this.oBindingContext = null;
  }
}
```

**STEP**: 8 — Reuse component subpages: best practice

**DESCRIPTION**: Prefer using standard object pages as subpages. The embedding manifest must declare the subpage under the reuse component's "pages" property. Pass the navigation property name via the reuse component's settings so the component triggers navigation without hard-coded service details.

**LANGUAGE**: JSON

**CODE**:
```json
// Example subpage declaration (see STEP 4)
"pages": {
  "ObjectPage|myNavigationProperty": {
    "navigationProperty": "myNavigationProperty",
    "entitySet": "myDependingEntitySet",
    "component": {
      "name": "sap.suite.ui.generic.template.ObjectPage"
    }
  }
}
```

**STEP**: 9 — OData V4 specific notes

**DESCRIPTION**: When targeting SAP Fiori elements OData V4:
- There is no eventing API in the framework to support draft handling for reuse components (create/save draft).
- If a reuse component needs its own OData model, implement and name an internal model to avoid conflicts with the propagated unnamed OData model. You may implement a reuse component based on an OData V2 model inside an OData V4 host — give the internal model a distinct name.

**LANGUAGE**: JSON

**CODE**:
```json
// Best practices reminder (not executable)
{
  "ODataV4": {
    "draftSupport": "not provided by Fiori elements reuse API",
    "recommendation": "Use a named internal OData model if component needs an independent OData service (avoid unnamed model collisions)."
  }
}
```
--------------------------------

**TITLE**: Different Representations of a Field (SAP Fiori elements for OData V4)

**INTRODUCTION**: This reference lists annotation and metadata patterns you can use to control how a single OData property (a "field") is rendered in SAP Fiori elements (OData V4). Each step contains the actionable annotation snippets for XML, ABAP CDS, and CAP CDS when available, plus manifest.json samples for control configuration. Use these snippets directly in your annotation files or CDS models.

**TAGS**: fiori-elements-framework, OData V4, annotations, UI.FieldGroup, UI.DataField, UI.DataPoint, UI.MultiLineText, UI.InputMask, Common.Masked, Measures.ISOCurrency, Measures.Unit, manifest.json

STEP: Simple Plain Text Facet
DESCRIPTION: Display a property as a plain text key-value facet. Wrap UI.DataField inside UI.FieldGroup. If the Path has a sap:label(), the label is shown followed by the value.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="PlainText">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="description" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [{
  value: 'DESCRIPTION',
  type: #STANDARD,
  qualifier: 'PlainText'
}];
```
LANGUAGE: CAP CDS
CODE:
```cds
UI.FieldGroup #PlainText: {
  Data : [{
    $Type : 'UI.DataField',
    Value : description
  }]
}
```

STEP: Amount with Currency or Unit of Measure
DESCRIPTION: Display numeric fields with currency or unit-of-measure. Use Measures.ISOCurrency and Measures.Unit annotations on the relevant properties. See the UI5 building block "Number with Currency or Unit of Measure" for examples.
LANGUAGE: (annotation usage)
CODE:
```xml
<!-- Example: annotate Amount and Currency properties -->
<Annotations Target="Namespace.Entity/Amount">
  <Annotation Term="Org.OData.Measures.V1.ISOCurrency" Path="CurrencyCode"/>
</Annotations>
<Annotations Target="Namespace.Entity/Quantity">
  <Annotation Term="Org.OData.Measures.V1.Unit" Path="UnitCode"/>
</Annotations>
```

STEP: Group Fields into a Form (FieldGroup)
DESCRIPTION: Group multiple fields into a form on the object page using UI.FieldGroup (for form-based rendering). See "Grouping of Fields" for detailed annotation locations.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="GeneralInformation">
  <Record>
    <PropertyValue Property="Label" String="General Information"/>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField" >
          <PropertyValue Property="Value" Path="FirstProperty"/>
        </Record>
        <Record Type="UI.DataField" >
          <PropertyValue Property="Value" Path="SecondProperty"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: Key Value Facet / KPI via UI.DataPoint
DESCRIPTION: Use UI.DataPoint to render key-value facets and KPIs (value, title, criticality). If used in header, appears as KPI. Adding a semantic object on the value makes it a link but removes criticality rendering.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Availability">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Availability" />
    <PropertyValue Property="Value" Path="stock/availability" />
    <PropertyValue Property="Criticality" Path="stock/availability"/>
  </Record>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  title: 'Availability',
  criticality: 'availability'
}
availability;
```
LANGUAGE: CAP CDS
CODE:
```cds
UI.DataPoint #Availability : {
  Value       : stock.availability,
  Title       : 'Availability',
  Criticality : stock.availability
}
```
LANGUAGE: XML (DataField with criticality → object status)
CODE:
```xml
<Record Type="SAP__UI.DataField">
  <PropertyValue Property="Criticality" Path="OvrlDeliveryStatusCriticality"/>
  <PropertyValue Property="CriticalityRepresentation" EnumMember="SAP__UI.CriticalityRepresentationType/WithoutIcon"/>
  <PropertyValue Property="Value" Path="OverallDeliveryStatus"/>
  <Annotation Term="SAP__UI.Importance" EnumMember="SAP__UI.ImportanceType/High"/>
</Record>
```
LANGUAGE: ABAP CDS (DataField criticality)
CODE:
```abap
@UI.dataPoint: {
  criticality: 'OvrlDeliveryStatusCriticality',
  criticalityRepresentation: #WITHOUT_ICON
}
OverallDeliveryStatus;
```
LANGUAGE: CAP CDS (DataField criticality)
CODE:
```cds
{
  $Type : 'UI.DataField',
  Value : OverallDeliveryStatus,
  Criticality : OvrlDeliveryStatusCriticality,
  ![@UI.CriticalityRepresentation] : #WithoutIcon
}
```

STEP: Rating Indicator via UI.DataPoint Visualization=Rating
DESCRIPTION: Render a rating indicator using UI.DataPoint with Visualization = Rating and TargetValue specifying max stars.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="averageRating">
  <Record>
    <PropertyValue Property="Value" Path="averageRating" />
    <PropertyValue Property="TargetValue" Decimal="5" />
    <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Rating" />
  </Record>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  targetValue: 5,
  visualization: #RATING
}
averageRating;
```
LANGUAGE: CAP CDS
CODE:
```cds
DataPoint #averageRating : {
  Value         : averageRating,
  TargetValue   : 5.0,
  Visualization : #Rating
}
```
DESCRIPTION: Tip — when used in a table the rating indicator is shown without a label.

STEP: Progress Indicator via UI.DataPoint Visualization=Progress
DESCRIPTION: Render a progress bar using UI.DataPoint with Visualization = Progress and TargetValue as the maximum.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="quantity">
  <Record>
    <PropertyValue Property="Value" Path="stock/quantity" />
    <PropertyValue Property="TargetValue" Decimal="100" />
    <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Progress" />
  </Record>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  targetValue: 100,
  visualization: #PROGRESS
}
quantity;
```
LANGUAGE: CAP CDS
CODE:
```cds
DataPoint #quantity : {
  Value         : stock.quantity,
  TargetValue   : 100.0,
  Visualization : #Progress
}
```
DESCRIPTION: Tip — when used in a table the progress indicator is shown without a label.

STEP: Representation as a Link — Semantic Link
DESCRIPTION: Annotate a property with Common.SemanticObject to render it as an intent-based link. If the semantic object is valid in the Fiori Launchpad, click shows all configured actions; if only one target exists the user is navigated directly.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="clouds.products.CatalogService.Products/SoldToParty">
  <Annotation Term="Common.SemanticObject" String="supplier"/>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
annotate view PRODUCTS.CATALOGSERVICE.PRODUCTS with {
  @Consumption.semanticObject: 'supplier'
  soldtoparty;
}
```
LANGUAGE: CAP CDS
CODE:
```cds
SoldToParty : String(10) @(Common : {
  SemanticObject : 'supplier'
});
```

STEP: Representation as a Link — Quick View Card
DESCRIPTION: Add quick view annotations to provide additional details in a popover when the link is clicked. See "Enabling Quick Views for Link Navigation" for how to reference Communication.Contact in annotations (example in Contact Card step).

STEP: Representation as a Link — Contact Card (Contact Facet)
DESCRIPTION: Use UI.DataFieldForAnnotation with Target pointing to supplier/@Communication.Contact (or use @Semantics for email/phone). Example: add a contact-style line item, and annotate phone/email with Communication.IsPhoneNumber / Communication.IsEmailAddress.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="clouds.products.CatalogService.Products">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataFieldForAnnotation">
        <PropertyValue Property="Label" String="Supplier"/>
        <PropertyValue Property="Target" AnnotationPath="supplier/@Communication.Contact"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>

<Annotations Target="sap.fe.manageitems.TechnicalTestingService.Supplier/phoneNumber">
  <Annotation Term="Common.Label" String="Mobile"/>
  <Annotation Term="Communication.IsPhoneNumber" Bool="true"/>
</Annotations>

<Annotations Target="sap.fe.manageitems.TechnicalTestingService.Supplier/emailAddress">
  <Annotation Term="Common.Label" String="Email"/>
  <Annotation Term="Communication.IsEmailAddress" Bool="true"/>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
annotate view PRODUCTS.CATALOGSERVICE.PRODUCTS with {
  @UI.lineItem: [
    {
      label: 'Supplier',
      value: 'SUPPLIER',
      type: #AS_CONTACT,
      position: 1
    }
  ]
  SupplierID;
}

annotate view FE.MANAGEITEMS.TECHNICALTESTINGSERVICE.SUPPLIER with {
  @Semantics.eMail.address: true
  @EndUserText.label: 'EMail'
  emailAddress;
  @Semantics.telephone.type: [ #CELL ]
  @EndUserText.label: 'Mobile'
  phoneNumber;
}
```
LANGUAGE: CAP CDS
CODE:
```cds
UI.LineItem : [
  {
    $Type  : 'UI.DataFieldForAnnotation',
    Target : 'supplier/@Communication.Contact',
    Label  : 'Supplier'
  }
]

phoneNumber : String(15) @(title: 'Mobile', Communication.IsPhoneNumber);
emailAddress : String(241) @(title: 'Email', Communication.IsEmailAddress);
```

STEP: Representation as Contact Links (tel: / mailto:)
DESCRIPTION: Use Communication.IsPhoneNumber and Communication.IsEmailAddress on properties to render clickable tel: and mailto: links.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="sap.fe.manageitems.TechnicalTestingService.LineItems/phoneNumber">
  <Annotation Term="Common.Label" String="Mobile"/>
  <Annotation Term="Communication.IsPhoneNumber" Bool="true"/>
</Annotations>

<Annotations Target="sap.fe.manageitems.TechnicalTestingService.LineItems/emailAddress">
  <Annotation Term="Common.Label" String="Email"/>
  <Annotation Term="Communication.IsEmailAddress" Bool="true"/>
</Annotations>
```

STEP: Representation as Basic Links (DataFieldWithUrl)
DESCRIPTION: Use UI.DataFieldWithUrl inside UI.FieldGroup to show a link with optional icon or image.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="DataFieldUrl">
  <Record Type="UI.FieldGroupType">
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataFieldWithUrl">
          <PropertyValue Property="Url" String="www.sap.com"/>
          <PropertyValue Property="Value" String="This is an URL"/>
          <PropertyValue Property="IconUrl" String="sap-icon://arrow-right"/>
        </Record>
        <Record Type="UI.DataFieldWithUrl">
          <PropertyValue Property="Url" String="www.sap.com"/>
          <PropertyValue Property="Value" String=""/>
          <PropertyValue Property="IconUrl" Path="oneIcon"/>
        </Record>
        <Record Type="UI.DataFieldWithUrl">
          <PropertyValue Property="Url" Path="oneUrl"/>
          <PropertyValue Property="Value" String="This is an URL three"/>
          <PropertyValue Property="IconUrl" String="sap-icon://arrow-right"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [
  {
    iconUrl: 'sap-icon://arrow-right',
    type: #WITH_URL,
    position: 1,
    qualifier: 'DataFieldUrl'
  },
  {
    url: 'ONEURL',
    value: 'ONEURL',
    type: #WITH_URL,
    position: 2,
    qualifier: 'DataFieldUrl'
  }
]
```
LANGUAGE: CAP CDS
CODE:
```cds
UI.FieldGroup #DataFieldUrl: {
  Data : [
    {
      $Type : 'UI.DataFieldWithUrl',
      Url   : 'www.sap.com',
      Value : 'This is an URL',
      IconUrl: 'sap-icon://arrow-right'
    },
    {
      $Type  : 'UI.DataFieldWithUrl',
      Url    : oneDisplay,
      Value  : oneUrl,
      IconUrl: oneIcon
    }
  ]
}
```

STEP: TextArea / ExpandableText via UI.MultiLineText
DESCRIPTION: Annotate a property with UI.MultiLineText to render a TextArea in edit mode and ExpandableText in display mode. Default edit lines = 4. Display mode truncates at 100 characters by default and shows a "More" link. You can configure text lines, max characters, expand behavior and max length via controlConfiguration in manifest.json (formatOptions).
LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage">
  <Annotation Term="Common.Label" String="Customer Reference"/>
  <Annotation Term="UI.MultiLineText" Bool="true"/>
</Annotations>
```
LANGUAGE: JSON (manifest.json controlConfiguration)
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.FieldGroup#myQualifier": {
                  "fields": {
                    "DataField::myFormTextField": {
                      "formatOptions": {
                        "textLinesEdit": "6",
                        "textMaxCharactersDisplay": "Infinity"
                      }
                    }
                  }
                },
                "myEntity/@com.sap.vocabularies.UI.v1.LineItem": {
                  "columns": {
                    "DataField::myTableTextField": {
                      "formatOptions": {
                        "textLinesEdit": "3",
                        "textMaxLines": "5",
                        "textMaxCharactersDisplay": "400",
                        "textExpandBehaviorDisplay": "Popover"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```
DESCRIPTION: Allowed formatOptions parameters (values are string or integer):
- textLinesEdit: min number of lines visible in edit mode before scrollbar.
- textMaxLines: maximum lines allowed to grow to in edit mode.
- textMaxCharactersDisplay: number of characters displayed before truncation; "Infinity" shows all.
- textExpandBehaviorDisplay: "InPlace" or "Popover".
- textMaxLength: max characters user may enter (client-side enforcement/notification).
NOTE: UI.MultiLineText not supported in grid, tree, or analytical tables.

STEP: Micro Chart Facet
DESCRIPTION: Render fields as micro charts to show compact visual summaries (critical measures/criticality). Use Micro Chart facet annotations. See "Micro Chart Facet" and "Adding a Micro Chart to a Table" for specific annotation patterns.

STEP: File Upload / Download (Edm.Stream)
DESCRIPTION: Add Edm.Stream properties to enable file upload/download on object pages. See "Enabling Stream Support" for required service and annotations. (Use Edm.Stream typed property in your metadata and relevant UI annotations to expose upload/download.)

STEP: Boolean Properties — Checkbox and Radio Buttons
DESCRIPTION: Default boolean rendering is a checkbox. To render as immediate-action radio buttons (Yes/No), set formatOptions useRadioButtonsForBoolean=true in XML view macro or manifest controlConfiguration.
LANGUAGE: XML (view)
CODE:
```xml
<macros:Field metaPath="BooleanProperty">
  <macros:formatOptions>
    <macrosF:FieldFormatOptions useRadioButtonsForBoolean="true"/>
  </macros:formatOptions>
</macros:Field>
```
LANGUAGE: JSON (manifest.json)
CODE:
```json
"controlConfiguration": {
  "@com.sap.vocabularies.UI.v1.FieldGroup#GeneralInformation": {
    "fields": {
      "DataField::booleanField": {
        "formatOptions": {
          "useRadioButtonsForBoolean": true
        }
      }
    }
  }
}
```

STEP: Timestamp with Timezone (@Common.IsTimezone)
DESCRIPTION: Annotate the timezone-code property with @Common.IsTimezone to display timezone text together with the timestamp in display mode.
LANGUAGE: CAP CDS / Annotation usage
CODE:
```cds
// Example: indicate timezone property
TimeZoneCode : String @(Common.IsTimezone: true);
```

STEP: Masked Input via UI.InputMask
DESCRIPTION: Use UI.InputMask to render a masked input in edit mode that enforces input format, placeholder symbol, and per-symbol regex rules. Masked characters can be made immutable using caret ^ before a rule character. Ensure placeholder symbols do not match mask symbols.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="sap.fe.core.MaskInputMassEdit.MainEntity/MaskedInputPhone">
  <Annotation Term="UI.InputMask">
    <Record>
      <PropertyValue Property="Mask" String="(***) *** ******"/>
      <PropertyValue Property="PlaceholderSymbol" String="_"/>
    </Record>
  </Annotation>
  <Annotation Term="UI.Placeholder" String="Enter twelve-digit number"/>
</Annotations>

<Annotations Target="sap.fe.core.MaskInputMassEdit.MainEntity/MaskedInputRegistration">
  <Annotation Term="UI.InputMask">
    <Record>
      <PropertyValue Property="Mask" String="I____-__"/>
      <PropertyValue Property="PlaceholderSymbol" String="_"/>
      <PropertyValue Property="Rules">
        <Collection>
          <Record>
            <PropertyValue Property="MaskSymbol" String="_"/>
            <PropertyValue Property="RegExp" String="[0-9]"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```
LANGUAGE: CAP CDS
CODE:
```cds
MaskedInputPhone : String @(UI.InputMask: {
  Mask: '(***) *** ******',
  PlaceholderSymbol: '_'
}, UI.Placeholder: 'Enter twelve-digit number');

MaskedInputRegistration : String @(UI.InputMask: {
  Mask: 'I****-**',
  PlaceholderSymbol: '_',
  Rules: [{ MaskSymbol: '*', RegExp: '[0-9]' }]
}, UI.Placeholder: 'Enter digits registration number');

MaskedInputSAP : String @(UI.InputMask: {
  Mask: 'S^AP-AA-999',
  PlaceholderSymbol: '_',
  Rules: [
    { MaskSymbol: '9', RegExp: '[0-9]' },
    { MaskSymbol: 'A', RegExp: '[A-Z]' }
  ]
}, UI.Placeholder: 'Starts with SAP followed by two uppercase letter and three digits');
```
NOTE: Mask characters normally map one-to-one to rules. Use caret ^ before a rule character to make it immutable.

STEP: Masked Display (Common.Masked)
DESCRIPTION: Use Common.Masked to visually mask sensitive fields: dots in edit mode, asterisks in display mode. This is only visual protection; do not use as sole data protection. Also mask sensitive values server-side.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="sap.fe.core.FieldDisplayStyles.RootEntity/MaskedField">
  <Annotation Term="Common.Masked" Bool="true"/>
</Annotations>
```
LANGUAGE: CAP CDS
CODE:
```cds
MaskedField : String @Common : { Masked: true };
```
NOTE: This feature masks presentation only; data is still transferred to the client in plain text unless you implement server-side masking/encryption. See "Security Configuration" for back-end security guidance.

Related resources:
- Field with Currency/Unit examples: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/fieldNumberWithUnitOrCurrencyAligned
- Multi-Line Text examples: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/fieldMultiLineText
- Input Mask examples: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/fieldInputMask
--------------------------------

**TITLE**: Disable Editing Status Filter (Draft-enabled Fiori Elements List Report)

**INTRODUCTION**: This guide shows how to disable the built-in "Editing Status" filter on list report pages of draft-enabled SAP Fiori Elements applications by adding an annotation. Includes XML and CAP CDS examples. Use the XML approach for ABAP-stack applications (no ABAP CDS sample provided).

**TAGS**: fiori-elements-framework, annotation, editing-status, filter, draft, CDS, CAP, XML

**STEP**: 1 — Add XML annotation to disable the Editing Status filter

**DESCRIPTION**: Add the following annotation to your annotation file (e.g., annotations.xml in your app or central annotation repository). The annotation targets the entity (TravelService.EntityContainer/Travel) and sets the Filterable property for the DraftAdministrativeData navigation property to false. This removes the Editing Status filter from the list report.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="TravelService.EntityContainer/Travel">
   <Annotation Term="Capabilities.NavigationRestrictions">
      <Record Type="Capabilities.NavigationRestrictionsType">
         <PropertyValue Property="RestrictedProperties">
            <Collection>
               <Record Type="Capabilities.NavigationPropertyRestriction">
                  <PropertyValue Property="NavigationProperty" NavigationPropertyPath="DraftAdministrativeData"/>
                  <PropertyValue Property="FilterRestrictions">
                     <Record Type="Capabilities.FilterRestrictionsType">
                        <PropertyValue Property="Filterable" Bool="false"/>
                     </Record>
                  </PropertyValue>
               </Record>
           </Collection>
        </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```

**STEP**: 2 — Add CAP CDS annotation to disable the Editing Status filter (CAP application)

**DESCRIPTION**: For CAP-based services, add the following annotate block to a CDS file where you extend the TravelService (e.g., srv/travel-service.cds). This sets the same NavigationRestrictions and makes DraftAdministrativeData non-filterable.

**LANGUAGE**: CDS

**CODE**:
```cds
annotate TravelService.Travel with @(
Capabilities: {
   NavigationRestrictions : {
       $Type : 'Capabilities.NavigationRestrictionsType',
       RestrictedProperties : [
           {
               $Type : 'Capabilities.NavigationPropertyRestriction',
               NavigationProperty : DraftAdministrativeData,
               FilterRestrictions : {
                   $Type : 'Capabilities.FilterRestrictionsType',
                   Filterable : false,
               },
           },
       ],
   },
});
```

**STEP**: 3 — ABAP CDS note

**DESCRIPTION**: No ABAP CDS sample is available. For ABAP-stack projects, use the local XML annotation approach (Step 1).

**LANGUAGE**: N/A

**CODE**:
```text
No ABAP CDS annotation sample is provided. Use the XML annotation (Step 1) in your annotation repository.
```

**STEP**: 4 — Effect of disabling the Editing Status filter

**DESCRIPTION**: When you set DraftAdministrativeData.Filterable = false using the annotation above, the Editing Status filter is removed from the list report UI. End users will no longer be able to filter objects by editing/draft status.
--------------------------------

**TITLE**: Displaying and Ordering Actions on the Object Page (Fiori Elements)

**INTRODUCTION**: This guide summarizes the rules for displaying actions on the Object Page in SAP Fiori elements, shows how to control placement with manifest settings, and demonstrates how to add criticality and semantic behavior via OData V4 annotations. Use the code examples to implement manifest-based custom actions and annotation-based action metadata.

**TAGS**: fiori-elements, object-page, actions, manifest, annotations, ODataV4, criticality, semantic-actions

**STEP**: 1 — Default display order (reference)
**DESCRIPTION**: Default order of actions in the Object Page header (top to bottom / left to right priority). Use this as the baseline when adding or reordering actions.
**LANGUAGE**: Text
**CODE**:
```text
Default display order in the Object Page header:
1. Generic actions (e.g., Save, Edit)
2. Application-specific actions (order from metadata)
3. Manifest-based custom actions
4. Related Apps button
5. Other generic actions (e.g., Share)
```

**STEP**: 2 — Display behavior based on mode
**DESCRIPTION**: Actions are shown in different UI locations depending on runtime mode. Implementers must place or expose actions accordingly:
- Display mode: actions appear in the header toolbar.
- Edit/Create mode: primary actions appear in the footer bar (e.g., Save/Cancel in Edit, Create/Cancel in Create).
Use annotation/manifest settings to ensure actions are available in the correct mode.
**LANGUAGE**: Text
**CODE**:
```text
- Display mode -> Header toolbar
- Edit / Create mode -> Footer bar (primary lifecycle actions)
```

**STEP**: 3 — Add a manifest-based custom action (object page)
**DESCRIPTION**: Add custom actions for a specific Object Page in manifest.json under sap.ui.generic.app -> pages -> component -> settings -> actions. Use "id", "text", "press" and "position" to control placement. Position can reference header vs footer or be relative (Before/After other action IDs). Example below shows:
- a header action
- a footer action
- a header action placed relative to another action via position
Modify entitySet and action handlers to match your app.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrder",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage.view.Details",
          "settings": {
            "actions": [
              {
                "id": "SalesOrder.MarkAsShipped",
                "text": "Mark as Shipped",
                "press": "onMarkAsShipped",    // controller hook name
                "position": "Header"           // places the button in the header toolbar
              },
              {
                "id": "SalesOrder.CancelOrder",
                "text": "Cancel",
                "press": "onCancelOrder",
                "position": "Footer"           // places the button in the footer bar (Edit/Create mode)
              },
              {
                "id": "SalesOrder.CustomAfterSave",
                "text": "Custom After Save",
                "press": "onCustomAfterSave",
                "position": "After:Save"       // example: place after built-in Save action (use valid reference id)
              }
            ]
          }
        }
      }
    ]
  }
}
```

**STEP**: 4 — Set action criticality with OData V4 annotations
**DESCRIPTION**: Add criticality metadata to action buttons using OData annotations (UI.DataFieldForAction). Criticality values allow the framework to style buttons (e.g., critical, negative, positive). The snippet below shows an XML annotation example. Adjust Target, Action name and where you attach the annotation (Header, Facet, etc.) based on your service metadata.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="YourService.YourEntityType">
  <!-- Add an action as a semantic action and set criticality -->
  <Annotation Term="com.sap.vocabularies.UI.v1.DataFieldForAction">
    <Record>
      <PropertyValue Property="Action" String="MarkAsShipped" />
      <PropertyValue Property="Label" String="Mark as Shipped" />
      <!-- Mark as semantic action so Fiori elements understands its intent -->
      <PropertyValue Property="IsSemanticAction" Bool="true" />
      <!-- Set criticality: enum values typically include Positive / Negative / Critical / Neutral -->
      <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Critical" />
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 5 — Semantic actions ordering in OData V4
**DESCRIPTION**: For Fiori elements on OData V4, semantic actions (actions marked via annotations as semantic) are automatically placed before generic actions (e.g., Save, Edit). When semantic actions exist, generic actions are not automatically emphasized. No manifest change required; use annotation (IsSemanticAction or equivalent) on the action definition.
**LANGUAGE**: Text
**CODE**:
```text
Behavior:
- If an action has IsSemanticAction (semantic action) defined via OData V4 annotations,
  the framework places it before generic actions in the header.
- Generic actions may lose automatic emphasis when semantic actions are present.
```

**STEP**: 6 — Change order of actions using "position"
**DESCRIPTION**: Use the manifest "position" property to reorder both manifest-based and annotation-based actions. Position can place an action in Header or Footer, or use relative placement (Before:<ActionId> / After:<ActionId>) as supported by your Fiori Elements version. If you need more advanced placement, use documented extension points.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "actions": [
    {
      "id": "Action.A",
      "text": "A",
      "position": "Header"
    },
    {
      "id": "Action.B",
      "text": "B",
      "position": "After:Action.A"
    },
    {
      "id": "Action.C",
      "text": "C",
      "position": "Before:Action.B"
    }
  ]
}
```

**STEP**: 7 — Additional references and related features (files/links)
**DESCRIPTION**: Use these docs to extend or refine action behavior:
- Enabling Actions in the Object Page Header — enabling-actions-in-the-object-page-header-5fe4396.md
- Adding Custom Actions Using Extension Points — adding-custom-actions-using-extension-points-7619517.md (see "position" usage)
- Adding Action Buttons to Forms in Sections — adding-action-buttons-to-forms-in-sections-e64efda.md
- Defining Determining Actions — defining-determining-actions-1743323.md
- Setting the Criticality for Actions — setting-the-criticality-for-actions-12f2ba2.md
- Generic Action Buttons in Tables on the Object Page: Additional Considerations — generic-action-buttons-in-tables-on-the-object-page-additional-considerations-d27ae99.md
**LANGUAGE**: Text
**CODE**:
```text
Refer to the above files for extended usage patterns, exact annotation term names, and extension point examples.
```
--------------------------------

**TITLE**: Displaying Amounts with Currency or Unit of Measure (Fiori elements, OData V4)

**INTRODUCTION**: Configure manifest.json to control decimal alignment and display for amounts with currency or unit of measure in SAP Fiori elements (OData V4). Use these keys to (1) set decimal padding for alignment in tables, (2) preserve backend-decimal precision for currency, and (3) limit decimals to unit definition.

**TAGS**: fiori-elements-framework, sap.fe, manifest.json, currency, unit-of-measure, decimal, alignment, OData V4

STEP: 1 — Alignment behavior and defaults

DESCRIPTION: In table (display mode) cells containing an amount plus currency or UoM:
- The numeric amount aligns on the decimal separator.
- The currency or unit-of-measure is right-aligned.
Default decimal padding used for alignment:
- currency: 5
- unitOfMeasure: 3

LANGUAGE: text

CODE:
```
Defaults:
- sap.fe.macros.table.currency.decimalPadding = 5
- sap.fe.macros.table.unitOfMeasure.decimalPadding = 3
Behavior:
- Amount aligned on decimal separator
- Currency/UoM right-aligned
File: manifest.json (project root)
```

STEP: 2 — Change decimal padding for currency and unit of measure

DESCRIPTION: Override default decimal padding used for alignment by adding the keys under sap.fe.macros.table in manifest.json. Set decimalPadding to an integer (number of decimal places to reserve for alignment).

LANGUAGE: JSON

CODE:
```json
{
  "sap.fe": {
    "macros": {
      "table": {
        "currency": {
          "decimalPadding": 5
        },
        "unitOfMeasure": {
          "decimalPadding": 3
        }
      }
    }
  }
}
```

STEP: 3 — Preserve exact backend decimals for currency values

DESCRIPTION: Preserve the exact number of decimal places returned by the backend for currency values (do not apply rounding or padding beyond backend precision). Add preserveDecimalsForCurrency under sap.fe.app.

LANGUAGE: JSON

CODE:
```json
{
  "sap.fe": {
    "app": {
      "preserveDecimalsForCurrency": true
    }
  }
}
```

STEP: 4 — Limit decimals to the unit-defined decimals

DESCRIPTION: When you want to restrict displayed decimals to the number of decimals defined for the unit (UoM), enable showOnlyUnitDecimals under sap.fe.app.

LANGUAGE: JSON

CODE:
```json
{
  "sap.fe": {
    "app": {
      "showOnlyUnitDecimals": true
    }
  }
}
```

STEP: 5 — Combined example (all keys in one manifest.json snippet)

DESCRIPTION: Single manifest.json fragment showing both table decimal-padding overrides and app-level flags. Merge into your project manifest.json at the root.

LANGUAGE: JSON

CODE:
```json
{
  "sap.fe": {
    "macros": {
      "table": {
        "currency": {
          "decimalPadding": 5
        },
        "unitOfMeasure": {
          "decimalPadding": 3
        }
      }
    },
    "app": {
      "preserveDecimalsForCurrency": true,
      "showOnlyUnitDecimals": true
    }
  }
}
```

--------------------------------

**TITLE**: Display an Illustrated Message or Text When a Table Has No Data (Fiori Elements, OData V4)

**INTRODUCTION**: How to show and customize illustrated "no data" messages for tables in SAP Fiori elements (list report and object page). Includes default texts, overriding via i18n, switching to plain text, and adding custom actions using the beforeRebindTable extension point with a ControllerExtension that calls table.setNoData(...).

**TAGS**: fiori-elements, odata-v4, no-data, illustrated-message, i18n, manifest, extension, beforeRebindTable, sap.m

STEP: Default illustrated-message behavior and default texts

DESCRIPTION: Reference of default illustrated-message titles and descriptions shown by Fiori elements depending on context (list report / object page / filters / search / multi-view). Use these keys as a baseline before overriding.

LANGUAGE: JSON

CODE:
```json
{
  "defaultNoDataMessages": {
    "listReport_openWithoutAutoload": {
      "title": "Let’s get some results",
      "description": "Start by providing your search or filter criteria."
    },
    "listReport_noFilters_noData": {
      "title": "No results found",
      "description": "Start by providing your search or filter criteria."
    },
    "listReport_filtersOrSearch_noData": {
      "title": "No results found",
      "description": "Try changing your filter criteria."
    },
    "listReport_multiView_noData": {
      "title": "No results found",
      "description": "Try changing the view or filter criteria."
    },
    "objectPage_noFilters_noData": {
      "title": "No items available",
      "description": "When there are, you'll find them here."
    }
  }
}
```

STEP: Override standard illustrated-message texts via i18n

DESCRIPTION: Add/override the keys shown above in the page-specific i18n file to change titles/descriptions. Place keys in the list report or object page i18n file referenced by the page (enhanceI18n if used). See Localization of UI Texts for the complete list of key names used by Fiori elements.

LANGUAGE: properties

CODE:
```properties
# file: webapp/i18n/ListReport.properties or i18n/SalesOrderObjectPage.properties
# Examples of overridden messages:
NO_DATA_LISTREPORT_OPEN="Let's get results for Sales Orders"
NO_DATA_LISTREPORT_NO_FILTERS="No Sales Orders found. Try different criteria."
NO_DATA_LISTREPORT_WITH_FILTERS="No Sales Orders match your filters. Please adjust filters."
NO_DATA_OBJECTPAGE_NO_ITEMS="No Sales Orders available."
```

STEP: Switch object page to plain text instead of illustrated message

DESCRIPTION: Use the manifest setting useTextForNoDataMessages = true in the page/component configuration to display plain textual messages for no-data instead of illustrated messages. This setting applies to all tables on the page. When enabled, you must provide i18n overrides for the default text keys.

LANGUAGE: JSON

CODE:
```json
// file: manifest.json (fragment)
{
  "sap.ui5": {
    "routing": { /* ... */ },
    "targets": {
      "SalesOrderManageObjectPage": {
        "type": "Component",
        "id": "SalesOrderManageObjectPage",
        "name": "sap.fe.templates.ObjectPage",
        "options": {
          "settings": {
            "contextPath": "/SalesOrderManage",
            "enhanceI18n": "i18n/SalesOrderObjectPage.properties",
            "variantManagement": "Control",
            "showRelatedApps": true,
            "sectionLayout": "Tabs",
            "useTextForNoDataMessages": true,
            "controlConfiguration": {
              /* ... */
            }
          }
        }
      }
    }
  }
}
```

STEP: Add actions to illustrated messages using beforeRebindTable

DESCRIPTION: Map the table's tableSettings.beforeRebindTable to a ControllerExtension callback in manifest.json controlConfiguration. The callback receives the collectionBindingInfo API (event parameter) and can build a sap.m.IllustratedMessage, add Buttons (additional content), and call table.setNoData(illustratedMessage). This allows custom actions (e.g., "Create New Item") to show in the no-data UI.

LANGUAGE: JSON

CODE:
```json
// file: manifest.json (fragment mapping the extension)
{
  "sap.ui5": {
    "routing": { /* ... */ },
    "targets": {
      "sample": {
        "type": "Component",
        "id": "Default",
        "name": "sap.fe.templates.ObjectPage",
        "level": 1,
        "options": {
          "settings": {
            "contextPath": "/RootEntity",
            "editableHeaderContent": false,
            "variantManagement": "Control",
            "controlConfiguration": {
              "_Child/@com.sap.vocabularies.UI.v1.LineItem": {
                "tableSettings": {
                  "beforeRebindTable": ".extension.sap.fe.core.fpmExplorer.OPExtend.onTableRefresh"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: ControllerExtension implementation to set IllustratedMessage with actions

DESCRIPTION: Full controller extension code. The extension inspects collectionBindingInfo (filters and $search), builds an sap.m.IllustratedMessage with title, description, IllustratedMessageType and size, adds Buttons via addAdditionalContent, and assigns it to the table control with table.setNoData(...). Update the table ID as required by your page (example ID used is "fe::table::_Child::LineItem::Table").

LANGUAGE: JavaScript

CODE:
```javascript
// file: webapp/extension/OPExtend.controller.js
sap.ui.define(
    [
        "sap/ui/core/mvc/ControllerExtension",
        "sap/ui/model/Filter",
        "sap/ui/model/FilterOperator",
        "sap/m/IllustratedMessage",
        "sap/m/IllustratedMessageType",
        "sap/m/Button",
        "sap/m/MessageToast",
        "sap/m/IllustratedMessageSize"
    ],
    function (
        ControllerExtension,
        Filter,
        FilterOperator,
        IllustratedMessage,
        IllustratedMessageType,
        Button,
        MessageToast,
        IllustratedMessageSize
    ) {
        "use strict";

        return ControllerExtension.extend("sap.fe.core.fpmExplorer.OPExtend", {
            onTableRefresh: function (event) {
                var collectionBindingInfoAPI = event.getParameter("collectionBindingInfo");
                // Adjust this id to match your table control id in the view
                var table = this.getView().byId("fe::table::_Child::LineItem::Table");
                var illustratedMessage = new IllustratedMessage();

                var showDialogNoData = function () {
                    return MessageToast.show("Action when No Data in edit mode");
                };
                var showDialogFilterSearch = function () {
                    return MessageToast.show("Action when No Data with filter or search");
                };

                // Filters or Search applied?
                var hasFilters =
                    collectionBindingInfoAPI.getFilters &&
                    collectionBindingInfoAPI.getFilters().aFilters &&
                    collectionBindingInfoAPI.getFilters().aFilters.length > 0;
                var hasSearch = collectionBindingInfoAPI.collectionBindingInfo &&
                                collectionBindingInfoAPI.collectionBindingInfo.parameters &&
                                collectionBindingInfoAPI.collectionBindingInfo.parameters.$search;

                if (hasFilters || hasSearch) {
                    illustratedMessage.setTitle("No Data");
                    illustratedMessage.setDescription("Change Search or filter criteria.");
                    illustratedMessage.setIllustrationType(IllustratedMessageType.NoSearchResults);
                    illustratedMessage.setIllustrationSize(IllustratedMessageSize.Dot);
                    illustratedMessage.addAdditionalContent(new Button({ text: "My Action", press: showDialogFilterSearch }));
                    table.setNoData(illustratedMessage);
                } else {
                    // No filter or search and table in edit mode
                    illustratedMessage.setTitle("No Item found");
                    illustratedMessage.setDescription("Please create some.");
                    illustratedMessage.setIllustrationType(IllustratedMessageType.NoSearchResults);
                    illustratedMessage.setIllustrationSize(IllustratedMessageSize.Dot);
                    illustratedMessage.addAdditionalContent(
                        new Button({ text: "Create New Item", visible: "{ui>/isEditable}", press: showDialogNoData })
                    );
                    table.setNoData(illustratedMessage);
                }
            }
        });
    }
);
```

STEP: Notes and references

DESCRIPTION: Implementation notes:
- The manifest option useTextForNoDataMessages switches object-page tables to text-only messages; ensure you override i18n keys when you enable it.
- The beforeRebindTable extension is set per table via controlConfiguration tableSettings mapping.
- For list-report/object-page specific i18n keys and the full key list, consult "Localization of UI Texts".
- Live examples and Table APIs: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/tableNoData

LANGUAGE: Text

CODE:
```text
- Ensure the table ID used in the ControllerExtension matches your rendered table control id.
- IllustratedMessage provides setTitle(), setDescription(), setIllustrationType(), setIllustrationSize(), addAdditionalContent().
- table.setNoData(controlOrString) applies the custom no-data control to the table.
```
--------------------------------

**TITLE**: Displaying Fields in Smartforms on Small Devices (UI.Importance for SAP Fiori elements V2)

**INTRODUCTION**: Use the UI.Importance annotation to control whether individual data fields inside SmartForms are shown on small screens (mobile/tablet/desktop). This is applicable only to SAP Fiori elements for OData V2. Set importance per data field (High, Medium, Low) to influence visibility by device size. If UI.Importance is omitted, default = None (treated as Medium).

**TAGS**: fiori-elements-framework, UI.Importance, annotations, OData V2, smartform, CDS, CAP, ABAP, XML

STEP: 1 — Applicability and default behavior

DESCRIPTION: Apply UI.Importance only for SAP Fiori elements (OData V2). When not specified, UI.Importance defaults to None (= Medium). Always set importance on each data field in a FieldGroup — you cannot hide the entire FieldGroup via a single UI.Importance setting.

LANGUAGE: text

CODE:
```text
Applicable to: SAP Fiori elements (OData V2) only.
Default behavior: If UI.Importance is not specified, default = None (treated as Medium).
Rule: UI.Importance must be set per data field to control visibility; cannot hide entire FieldGroup via one annotation.
```

STEP: 2 — Importance values and device visibility mapping

DESCRIPTION: Use these EnumMembers to determine on which devices a field is visible. Set UI.Importance on each UI.DataField or field-specific CDS annotation.

LANGUAGE: text

CODE:
```text
UI.ImportanceType/High   -> Visible on Desktop, Tablet, Mobile (all devices)
UI.ImportanceType/Medium -> Visible on Desktop and Tablet
UI.ImportanceType/Low    -> Visible on Desktop and Tablet

Note: None (unset) = Medium behavior.
```

STEP: 3 — XML Annotation example (add to your annotation XML for the entity/UI.FieldGroup)

DESCRIPTION: Add UI.FieldGroup with UI.DataField entries and UI.Importance annotations. Use this structure in your annotations XML (e.g., annotations.xml associated with the service/entity set).

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="GeneralInformation">
    <Record>
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SalesOrder"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Label" String="Business Partner ID"/>
                    <PropertyValue Property="Value" Path="BusinessPartnerID"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Low"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Label" String="Opportunity ID"/>
                    <PropertyValue Property="Value" Path="OpportunityID"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Medium"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Label" String="Enabled"/>
                    <PropertyValue Property="Value" Path="EnabledStatus"/>
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Label" String="General Information"/>
    </Record>
</Annotation>
```

STEP: 4 — ABAP CDS example (annotate each CDS field with @UI.fieldGroup importance)

DESCRIPTION: Use @UI.fieldGroup in ABAP CDS next to the field declaration to assign importance. Place these annotations in the CDS view that defines your entity fields.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.fieldGroup: [
  {
    importance: #HIGH,
    position: 10,
    qualifier: 'GeneralInformation',
    groupLabel: 'General Information'
  }
]
SALESORDER;

@UI.fieldGroup: [
  {
    importance: #LOW,
    label: 'Business Partner ID',
    position: 20,
    qualifier: 'GeneralInformation'
  }
]
BUSINESSPARTNERID;

@UI.fieldGroup: [
  {
    importance: #MEDIUM,
    label: 'Opportunity ID',
    position: 30,
    qualifier: 'GeneralInformation'
  }
]
OPPORTUNITYID;

@UI.fieldGroup: [
  {
    label: 'Enabled',
    position: 40,
    qualifier: 'GeneralInformation'
  }
]
ENABLEDSTATUS;
```

STEP: 5 — CAP CDS example (use UI.FieldGroup and ![@UI.Importance])

DESCRIPTION: In CAP CDS (CSN/annotations syntax), declare UI.FieldGroup and set ![@UI.Importance] per UI.DataField entry.

LANGUAGE: CAP CDS

CODE:
```cap
UI.FieldGroup #GeneralInformation : {
    Data : [
        {
            $Type : 'UI.DataField',
            Value : SalesOrder,
            ![@UI.Importance] : #High
        },
        {
            $Type : 'UI.DataField',
            Label : 'Business Partner ID',
            Value : BusinessPartnerID,
            ![@UI.Importance] : #Low
        },
        {
            $Type : 'UI.DataField',
            Label : 'Opportunity ID',
            Value : OpportunityID,
            ![@UI.Importance] : #Medium
        },
        {
            $Type : 'UI.DataField',
            Label : 'Enabled',
            Value : EnabledStatus
        }
    ],
    Label : 'General Information'
}
```

STEP: 6 — Implementation notes and constraints

DESCRIPTION: Practical rules to follow when implementing UI.Importance:

LANGUAGE: text

CODE:
```text
- UI.Importance controls visibility of individual data fields in SmartForms across devices.
- You must annotate each data field individually; you cannot use UI.Importance to hide an entire FieldGroup or the Identification area on small screens.
- Data fields rendered inside the SmartForm are impacted by their UI.Importance settings at runtime.
- Use High for always-visible fields, Medium/Low for progressively less important fields to hide them on small devices.
```
--------------------------------

**TITLE**: Displaying Images in Tables (Fiori Elements annotations for image URLs and media properties)

**INTRODUCTION**: Instructions and ready-to-use annotation snippets to display images inside table line items in SAP Fiori Elements. Shows how to: add a DataField to the line item pointing to an image URL, mark a property as an image URL (for accessibility), and annotate media properties for OData V4 stream or binary media. Use these snippets in your local annotation files (XML or CDS/CAP) or in ABAP CDS.

**TAGS**: fiori-elements, annotations, images, table, odata-v4, CDS, CAP, ABAP, XML, Core.MediaType, UI.IsImageUrl, Common.Text

**STEP**: 1 — Add a DataField to the LineItem (table) pointing to the image property

**DESCRIPTION**: Add a UI.DataField to the line item annotation so the image property (ProductPictureURL) is rendered in the table. Set importance if desired.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Add inside the LineItem annotation file (e.g., annotations.xml) -->
<Record Type="UI.DataField">
    <PropertyValue Property="Value" Path="ProductPictureURL"/>
    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
</Record>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.lineItem: [{ importance: #HIGH }]
PRODUCTPICTUREURL;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
{
    $Type : 'UI.DataField',
    Value : ProductPictureURL,
    ![@UI.Importance] : #High
}
```

**STEP**: 2 — Annotate the property as an image URL and add accessible text (alt)

**DESCRIPTION**: Annotate the property so Fiori Elements treats its value as an image URL. Optionally add Common.Text (used as alt text/read by screen readers). Use UI.IsImageUrl (XML/CAP) or @Semantics.imageUrl / @UI.textArrangement (ABAP CDS).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Local annotation file: target the entity property -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType/ProductPictureURL">
    <!-- Marks this property as containing an image URL -->
    <Annotation Term="UI.IsImageUrl" />
    <!-- Optional: textual alternative (assigned to sap.m.Image@alt) -->
    <Annotation Term="Common.Text" String="{Product}" />
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@Semantics.imageUrl: true
@UI.textArrangement: #TEXT_ONLY
PRODUCTPICTUREURL;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with {
  @UI.IsImageUrl : true
  @Common.Text : '{Product}'
  ProductPictureURL
};
```

**STEP**: 3 — OData V4: Annotate stream properties (image via URL)

**DESCRIPTION**: For OData V4 properties of type stream (media resource returned via URL), annotate Core.IsURL=true and Core.MediaType with the image content type (e.g., image/jpg). Stream media properties are read-only (URL is only used for reading).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType/ProductPictureURL">
   <Annotation Term="Common.Text" String="{Product}" /> 
   <Annotation Term="Core.IsURL" Bool="true"/>
   <Annotation Term="Core.MediaType" String="image/jpg"/>
</Annotations>
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with {
  @Common.Text : '{Product}'
  @Core.IsURL : true
  @Core.MediaType : 'image/jpg'
  ProductPictureURL
};
```

**STEP**: 4 — Binary media properties: annotate MediaType only

**DESCRIPTION**: For binary media properties (embedded binary), annotate Core.MediaType with the correct image MIME type (e.g., image/png). No Core.IsURL needed for binary; UI will render image using the media property and its media type.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType/ProductPictureURL">
   <Annotation Term="Common.Text" String="{Product}" /> 
   <Annotation Term="Core.MediaType" String="image/png"/>
</Annotations>
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductType with {
  @Common.Text : '{Product}'
  @Core.MediaType : 'image/png'
  ProductPictureURL
};
```

**STEP**: 5 — Accessibility and behavior notes

**DESCRIPTION**: Use Common.Text to supply accessible alt text (assigned to sap.m.Image@alt). Stream properties are read-only: the UI reads the image from the URL but does not allow editing the URL. For OData V4 stream details refer to the OData JSON format spec for stream properties.

**LANGUAGE**: (reference)

**CODE**:
```text
Reference: Stream properties (OData v4) - https://docs.oasis-open.org/odata/odata-json-format/v4.0/os/odata-json-format-v4.0-os.html#_Toc372793075
```
--------------------------------

**TITLE**: Display Text and ID for Value Help Input Fields (Object Page, OData V2 & V4)

**INTRODUCTION**: Configure Fiori Elements object pages to display both descriptive text and the key/ID for value-help fields in Edit and Display modes. Covers annotations at entity and property levels, client-side validation via ValueListForValidation, OData V2 modeling with sap:text, and behavior rules and exceptions.

**TAGS**: fiori-elements, value-help, textArrangement, ValueListForValidation, sap.text, ODataV2, ODataV4, ABAP-CDS, CAP, annotations, SmartField

**STEP**: 1 — Define Text Arrangement at Entity Level

**DESCRIPTION**: Set the default text arrangement for all properties of an entity type. Property-level textArrangement overrides this. Use one of the TextArrangementType values (TextLast, TextFirst, TextOnly, TextSeparate).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- XML Annotation -->
<Annotations Target="STTA_SALES_ORDER_ND_SRV_01.STTA_C_SO_SalesOrder_NDType"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement"
                EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"/>
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
" ABAP CDS Annotation (entity-level)
@UI.TextArrangement: #TEXT_LAST
annotate view STTA_C_SO_SALESORDER_ND with {
  // entity-level annotation - annotate block can be empty if only annotation is needed
}
```

**LANGUAGE**: CAP CDS

**CODE**:
```cql
// CAP CDS Annotation (entity-level)
annotate STTA_SALES_ORDER_ND_SRV_01.STTA_C_SO_SalesOrder_NDType @(
  UI.TextArrangement : #TextLast
);
```

**STEP**: 2 — Define Text Arrangement at Property/Field Level

**DESCRIPTION**: Apply TextArrangement to a specific property to override the entity-level setting. Use TextOnly/TextLast/TextFirst/TextSeparate as needed.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- XML Annotation (property-level) -->
<Annotations Target="STTA_SALES_ORDER_ND_SRV_01.STTA_C_SO_SalesOrder_NDType/BusinessPartnerID"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement"
                EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"/>
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
" ABAP CDS Annotation (property-level)
annotate view STTA_C_SO_SALESORDER_ND with {
  @UI.TextArrangement: #TEXT_ONLY
  businesspartnerid;
}
```

**LANGUAGE**: CAP CDS

**CODE**:
```cql
// CAP CDS Annotation (property-level)
annotate STTA_SALES_ORDER_ND_SRV_01.STTA_C_SO_SalesOrder_NDType {
  @UI.TextArrangement : #TextOnly
  BusinessPartnerID
};
```

**STEP**: 3 — Configure Client-Side Validation with ValueListForValidation

**DESCRIPTION**: Enable client-side validation of free-text entry against the value-help entity using Common.ValueListForValidation under the property annotation. Note: ValueListForValidation only works when qualifier is empty (String="") and rejects values not present in the value help (not persisted to backend, including drafts).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- ValueListForValidation (property-level annotations) -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType/Supplier"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="Common.ValueListForValidation" String=""/>
    <Annotation Term="Common.ValueList">
        <!-- Definition of ValueList (value help) goes here -->
    </Annotation>
</Annotations>
```

**STEP**: 4 — OData V2 — Edit Mode: TextInEditModeSource and Default Behavior

**DESCRIPTION**: By default in object page forms, free-text entry is allowed and TextInEditModeSource = ValueListNoValidation ensures entering values not present in value help. If you want the SmartField to fetch and display both text and ID in edit mode using value help descriptions, ensure all conditions are met for sap.ui.comp.smartfield.TextInEditModeSource.ValueList.

Conditions required:
- SmartField value binding is to an EDM property of type Edm.String or Edm.Guid.
- com.sap.vocabularies.UI.v1.TextArrangement annotation exists for the bound property or the entity type in metadata/annotations.
- SmartField value binding uses two-way binding mode.
- The field that provides the description is filterable in the value-help entity.

If any condition is not met, only the ID is shown in edit mode.

**LANGUAGE**: (none)

**CODE**:
```text
No code. Configure metadata/annotations and SmartField bindings per conditions above.
```

**STEP**: 5 — OData V2 — Display Mode: Use sap:text Navigation Path

**DESCRIPTION**: To display both text and ID in display (read-only) mode, model sap:text on the property to point to the navigation property/description in the value-help. Also set TextArrangement to control ordering (TextFirst/TextLast/TextOnly).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Property with sap:text navigation path and value-list -->
<Property Name="BusinessPartnerID"
          Type="Edm.String"
          Nullable="false"
          MaxLength="10"
          sap:display-format="UpperCase"
          sap:text="to_BusinessPartner/CompanyName"
          sap:label="Business Partner ID"
          sap:value-list="standard"/>

<!-- Entity-level TextArrangement -->
<Annotations Target="STTA_SALES_ORDER_ND_SRV_01.STTA_C_SO_SalesOrder_NDType"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement"
                EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"/>
</Annotations>
```

**STEP**: 6 — OData V2 — Display Mode: Provide Description in Value-Help Entity

**DESCRIPTION**: If sap:text navigation is not modeled on the main entity, provide a descriptive property in the value-help entity and mark it with sap:text on the key property. Add TextArrangement on the value-help entity to control display order.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Value Help EntityType with sap:text property -->
<EntityType Name="C_CostCenterVHType"
            sap:label="Cost Center Value Help"
            sap:value-list="true"
            sap:content-version="1">
    <Key>
        <PropertyRef Name="CostCenter" />
    </Key>
    <Property Name="CostCenter"
              Type="Edm.String"
              Nullable="false"
              MaxLength="10"
              sap:display-format="UpperCase"
              sap:text="CostCenter_Text"
              sap:label="Cost Center" />
    <Property Name="CostCenter_Text"
              Type="Edm.String"
              MaxLength="20"
              sap:label="Cost Center Name"
              sap:creatable="false"
              sap:updatable="false" />
</EntityType>

<!-- TextArrangement on the value-help entity -->
<Annotations Target="COST_CENTERS_SRV.C_CostCenterVHType"
             xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement"
                EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast" />
</Annotations>
```

**STEP**: 7 — Field Rendering Behavior, Scope and Exceptions (OData V2 & V4)

**DESCRIPTION**: Default behavior and exceptions for value-help fields across UI elements:

- DataField (rendered as SmartLink via SemanticObject/quick view): shows descriptive text and ID by default.
- DataFieldWithNavigationPath (bound to value-help): shows descriptive text and ID by default.
- Applies to: tables, object page headers, object page form sections.
- Use TextArrangement (TextFirst / TextLast / TextOnly) to change ordering or hide ID/text.
- Not supported for: DataFieldWithIntentBasedNavigation, Communication.Contact.
- If TextArrangement is TextSeparate, only the ID is shown.
- For OData V2 tables, TextInEditModeSource.ValueList is supported only under the earlier-listed conditions.

**LANGUAGE**: (none)

**CODE**:
```text
Behavior notes only. No code.
```

**STEP**: 8 — OData V4 — Display Mode Behavior

**DESCRIPTION**: For OData V4 the display-mode behavior mirrors V2 for DataField and DataFieldWithNavigationPath when bound to value help: descriptive text and ID shown by default in tables, object page headers, and form sections. Use TextArrangement to control ordering. See "Further Features of the Field" for additional options.

**LANGUAGE**: (none)

**CODE**:
```text
Behavior notes only. No code.
```

**STEP**: 9 — Reference Images (UI Examples)

**DESCRIPTION**: Example images showing UI results (preserve file paths if used in docs or tests).

**LANGUAGE**: (none)

**CODE**:
```text
images/Value_Help_Object_Page_Text_amp_ID_4aa1f0d.png
images/Object_Page_Value_Help_Text_amp_ID_Display_c9ae198.png
```
--------------------------------

**TITLE**: Donut Chart Card — Implementation and Configuration Guide

**INTRODUCTION**: Practical, code-focused guide for implementing an SAP Fiori donut chart card. Covers data requirements (measures/dimensions), showing percentages, enabling stable coloring (color mapping + descriptor config), required chart annotations (Category role + com.sap.vocabularies.Common.v1.Text), disabling navigation, and constructing "Others" navigation filters.

**TAGS**: fiori-elements-framework, donut-chart, sapui5, sap-fiori, cards, charts, stable-colors, colorPalette, annotations, OData

**STEP**: 1 — Donut chart data rules and stacking behavior

**DESCRIPTION**: Donut charts require exactly one measure. You may provide one or more dimensions. When multiple dimensions are provided they are stacked: each unique combination of dimension values becomes a separate colored section. Ensure the OData metadata exposes the measure and dimension properties used by the chart.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "card": {
    "type": "Analytical",
    "content": {
      "chart": {
        "type": "donut",
        "data": {
          "measures": ["SalesAmount"],      /* exactly one measure */
          "dimensions": ["Year", "Country"] /* multiple dimensions stack combinations */
        }
      }
    }
  }
}
```

**STEP**: 2 — Show percentages inside donut sections (data label type = percentage)

**DESCRIPTION**: Configure chart plotArea.dataLabel.type to "percentage" to display section values as percentages. Use the ChartProperties object of the card/chart configuration.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "ChartProperties": {
    "plotArea": {
      "dataLabel": {
        "type": "percentage"
      }
    }
  }
}
```

**STEP**: 3 — Disable navigation from the chart (optional)

**DESCRIPTION**: If you want to disable navigation triggered from chart sections, set the card/chart settings to turn navigation off. The exact property name depends on the card renderer; this example shows a typical card-level setting.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.card": {
    "type": "Analytical",
    "settings": {
      "enableNavigation": false
    }
  }
}
```

**STEP**: 4 — Enable stable coloring (map specific dimension values to colors)

**DESCRIPTION**: To assign fixed colors per dimension value:
- Add a color map (key-value pairs: dimensionValue -> color) to the descriptor’s colorPalette.
- Enable stable coloring by setting bEnableStableColors to true in card settings.
- Ensure the chart’s dimension is annotated with Role = Category (see next step).
- Ensure a com.sap.vocabularies.Common.v1.Text annotation exists for the dimension property (used as label and for legend).

Provide a descriptor colorPalette example and card settings that enable stable colors.

**LANGUAGE**: JSON

**CODE**:
```json
/* Descriptor: map dimension values to colors */
{
  "descriptor": {
    "colorPalette": {
      "Country": {
        "Germany": "#0A6ED1",
        "France": "#8A1F6A",
        "USA": "#1A9A1A",
        "Others": "#CCCCCC"
      }
    }
  }
}

/* Card settings: enable stable colors */
{
  "sap.card": {
    "type": "Analytical",
    "settings": {
      "bEnableStableColors": true
    }
  }
}
```

**STEP**: 5 — Chart annotation requirements: Role = Category and Text annotation for dimension

**DESCRIPTION**: The chart dimension must use Role = Category. Also add the Common.Text annotation to the entity property that provides a textual label for the dimension values. Examples shown in EDMX-style OData annotation snippets.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Chart annotation: set dimension Role to Category -->
<Annotations Target="MyService.MyEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.Chart">
    <Record>
      <Collection Property="Dimensions">
        <Record>
          <PropertyValue Property="PropertyPath" String="Country"/>
          <PropertyValue Property="Role" String="Category"/>
        </Record>
      </Collection>
      <Collection Property="Measures">
        <Record>
          <PropertyValue Property="PropertyPath" String="SalesAmount"/>
        </Record>
      </Collection>
    </Record>
  </Annotation>
</Annotations>

<!-- Common.Text annotation for Country dimension (maps Country -> CountryName property) -->
<Annotations Target="MyService.MyEntityType/Country">
  <Annotation Term="com.sap.vocabularies.Common.v1.Text">
    <PropertyValue Path="CountryName"/>
  </Annotation>
</Annotations>
```

**STEP**: 6 — "Others" sector: navigation filter that excludes shown dimensions

**DESCRIPTION**: When the donut chart groups small slices into an "Others" sector, navigation from that sector should pass a filter which excludes the shown dimension values (A, B, C) so the target app receives the complementary set. Example constructs an OData $filter expression that excludes a list of values.

**LANGUAGE**: HTTP / OData / JavaScript

**CODE**:
```http
# Example OData $filter (exclude A, B, C)
$filter=not (Dimension eq 'A' or Dimension eq 'B' or Dimension eq 'C')
```

```javascript
// UI5: build a "not in" filter for navigation (programmatic example)
const excluded = ['A','B','C'];
const orFilters = excluded.map(v => new sap.ui.model.Filter("Dimension", sap.ui.model.FilterOperator.EQ, v));
const excludeFilter = new sap.ui.model.Filter(orFilters, false); // false -> OR combination
const notInFilter = new sap.ui.model.Filter(excludeFilter, sap.ui.model.FilterOperator.NE); // not (A or B or C)
// For navigation, translate to $filter string: not (Dimension eq 'A' or Dimension eq 'B' or Dimension eq 'C')
```

**STEP**: 7 — Visual and legend text behavior

**DESCRIPTION**: The label text used in the donut legend and tooltip comes from the property referenced by com.sap.vocabularies.Common.v1.Text. Ensure the Text annotation points to a property with the user-friendly label for each dimension value.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: Text annotation points to a localized label property -->
<Annotations Target="MyService.MyEntityType/Country">
  <Annotation Term="com.sap.vocabularies.Common.v1.Text">
    <PropertyValue Path="CountryLabel"/>
  </Annotation>
</Annotations>
```
--------------------------------

**TITLE**: Draft Handling (SAP Fiori elements — OData V2 & V4)

**INTRODUCTION**: Short, actionable reference for implementing and configuring draft handling in SAP Fiori elements apps. Covers core behaviors (apply/save/discard), validation/PreparationAction, handling inconsistent input, OData V2/V4 specifics, and manifest.json configuration snippets for draft timing and UI hiding. Use this as a quick coding guide for manifest adjustments and expected runtime behaviors to implement or customize draft handling.

**TAGS**: fiori-elements-framework, draft, draft-handling, manifest.json, odata-v2, odata-v4, draftSettings, hideDraft, PreparationAction, editFlow, collaborative-draft

STEP: Draft concept and primary use cases
DESCRIPTION: Summarize what a draft is and why to use draft handling in apps. Use this to document requirements and to decide which draft features to enable.
LANGUAGE: Text
CODE:
```text
- Draft = interim version of a business entity (not active).
- Use cases:
  - Preserve unsaved changes across interrupted editing sessions.
  - Prevent data loss on unexpected app termination.
  - Provide locking / indicate concurrent edits.
- Draft lifecycle highlights:
  - A draft is created when a user starts create/edit.
  - Fields can be validated and side effects executed while editing.
  - Drafts can be saved implicitly (background save) or explicitly via Save.
  - Apply on subobject pages applies changes to draft and navigates up.
```

STEP: Apply button flow (subobject pages)
DESCRIPTION: Implement or test the Apply button sequence for subobject pages. Use this to verify navigation and draft update behavior in create/edit modes.
LANGUAGE: Text
CODE:
```text
Apply button sequence (object edited -> subobject detail -> Apply):
1. User selects Edit on an object page -> system creates a draft.
2. User modifies the draft and navigates to a subobject detail page.
3. User selects Apply -> changes are applied to the draft and app navigates one step up.
4. User selects Save -> changes are saved to the active version.

Note: When deleting a draft:
- If DraftRoot annotation defines DiscardAction -> that action is called.
- Else -> standard Delete call is triggered.
```

STEP: Handle inconsistent input before saving / applying
DESCRIPTION: Ensure UI and stored draft contents are consistent. When UI input is technically inconsistent (type/length errors), show messages and block Save/Apply until resolved.
LANGUAGE: Text
CODE:
```text
Behavior:
- If UI contains invalid values (e.g., non-numeric in numeric field or overflow):
  - UI differs from stored draft values.
  - System displays message prompting user to fix technical inconsistencies.
  - Save/Apply cannot proceed until these errors are fixed.
- These messages only cover technical inconsistencies; business/logical errors (e.g., missing business partner) are shown as state messages on Save.
```

STEP: OData V2 — auto-save frequency and immediate saves for side effects/actions
DESCRIPTION: Configure dataSaveFrequency to control background draft saves and understand when drafts are saved immediately.
LANGUAGE: JSON
CODE:
```json
// manifest.json — Enable immediate draft merge (turn off delayed merges)
{
  "sap.ui.generic.app": {
    "settings": {
      "draftSettings": {
        "dataSaveFrequency": "immediate"
      }
    }
  }
}
```
```text
Behavior summary (OData V2):
- Default background save interval: ~20 seconds (auto-save while editing).
- If a UI field has side effects, draft is saved immediately after leaving that virtual field group.
- Draft saved immediately when an action is executed (so pending changes are persisted).
- You can disable the delay (see JSON above) for exceptional cases.
```

STEP: Trigger PreparationAction (Validate) and Enter key behavior
DESCRIPTION: Validate drafts (PreparationAction) when user presses Enter, triggers, or explicit Validate button. Be aware of side-effect/TriggerAction overrides.
LANGUAGE: Text
CODE:
```text
PreparationAction and Enter key:
- On draft pages pressing Enter in input fields triggers:
  - PreparationAction on DraftRoot (server-side validation) by default.
  - Side effects (if configured) are also executed.
- Before PreparationAction, any pending draft changes are saved.
- If a global side effect with TriggerAction is annotated for the entity:
  - TriggerAction is called instead of PreparationAction.
  - If side effects have source properties + TriggerAction, PreparationAction is unaffected.
- The PreparationAction call is executed even when Enter is pressed in object page tables or subobject pages.
```

STEP: Switching between draft and saved versions (dynamic header)
DESCRIPTION: UI toggles: dynamic header (dropdown) or static/classic header (toggle) let users switch between draft and saved values. Use to implement UX controls for toggling.
LANGUAGE: Text
CODE:
```text
- Dynamic header: uses a dropdown in the header to switch between Draft and Saved values.
- Static/Classic header: uses a toggle button to switch.
- When toggling away from draft, any pending draft changes are auto-saved and become visible in the active version.
```

STEP: OData V4 — draft kinds, auto-save, and Enter behavior
DESCRIPTION: OData V4 specifics: exclusive vs collaborative drafts, auto-save behavior, and Enter-key handling differences (global side effects vs PreparationAction).
LANGUAGE: Text
CODE:
```text
OData V4 draft variants:
- Exclusive draft: single-user draft; others cannot see changes until save.
- Collaborative draft: multiple users can access/change same draft (requires service support).

Behavior:
- Drafts auto-save in background when users edit the entity.
- Pressing Enter:
  - If global side effects without SourceProperties/SourceEntities are defined for the entity -> execute those side effects.
  - Else, if PreparationAction is defined on DraftRoot and annotated for messages -> trigger PreparationAction and request messages.
- Filtering draft-related data:
  - Enabled by default with filters: Draft Created By, Draft Created On, Draft Last Changed By, Draft Last Changed On.
  - Semantic operators used for time filters (past values).
  - Note: Not available with CAP service.
```

STEP: Collaborative draft — runtime behavior, locking, and restrictions
DESCRIPTION: Implement collaborative drafts only when backend supports it. Note locking heuristics, WebSocket sync, and UI affordances (avatars, invite).
LANGUAGE: Text
CODE:
```text
Collaborative draft behavior:
- If service supports collaborative draft (ShareAction annotation), drafts are shared to users with access.
- Runtime behaviors:
  - Avatars show users currently accessing the draft in the object page header.
  - Field locks: when a user focuses or types in a field it is locked for others; a field-level indicator shows who is editing.
  - Changes (field edits, create/delete subitems, actions) are immediately visible to other participants.
  - Invite button lists current and previous editors; adding users invites them to the collaborative draft (does not change authorization).
  - Draft appears in "Own Draft" list of invited users.
- Caution: uses WebSocket and extends browser session timeout until participants leave the draft.
- Restrictions:
  - Supported only with ABAP RAP services.
  - Native Fiori elements building blocks implement locking; for freestyle extensions use sap.fe.macros.CollaborativeDraftHandler (API reference).
  - Mass edit on object pages is not supported when collaborative draft is enabled.
```

STEP: Hide draft-related UI while keeping backend draft functionality (hideDraft)
DESCRIPTION: For apps with few editable fields, hide draft UI elements but keep draft functionality. Configure in manifest.json.
LANGUAGE: JSON
CODE:
```json
// manifest.json — basic hideDraft
{
  "sap.fe": {
    "app": {
      "hideDraft": {
        "enabled": true
      }
    }
  }
}
```
```json
// manifest.json — hideDraft and stay-on-page options
{
  "sap.fe": {
    "app": {
      "hideDraft": {
        "enabled": true,
        "stayOnCurrentPageAfterSave": true,
        "stayOnCurrentPageAfterCancel": true
      }
    }
  }
}
```
```json
// manifest.json — hide Create Next button
{
  "sap.fe": {
    "app": {
      "hideDraft": {
        "enabled": true,
        "hideCreateNext": true
      }
    }
  }
}
```
```text
UI impacts when hideDraft.enabled = true:
- List Report: Editing Status filter hidden.
- Object Page:
  - Create mode: no activation confirmation popup on navigation; only Save and Cancel actions shown.
  - Edit mode: no "Draft updated" footer message after field modification.
  - Default navigation after Save/Cancel goes to root object page; change behavior with stayOnCurrentPageAfterSave/Cancel flags.
- Subobject pages: Apply button is hidden.
- Tip: set stayOnCurrentPageAfterSave and stayOnCurrentPageAfterCancel to the same value for consistent UX.
```

STEP: editFlow API (OData V4) — extension points and usage pointers
DESCRIPTION: Use editFlow to add custom logic to standard draft actions or to implement draft handling on custom pages. Reference the API and provide links to examples.
LANGUAGE: Text
CODE:
```text
- editFlow is the main controller extension for draft handling (create, delete, edit, save, discard) in SAP Fiori elements for OData V4.
- Use cases:
  - Add custom logic to standard draft actions.
  - Implement draft handling on custom pages.
- Reference and examples:
  - API Reference: https://ui5.sap.com/#/api/sap.fe.core.controllerextensions.EditFlow
  - Live examples:
    - Global Patterns - Draft Handling: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/controllerExtensions/editFlow
    - Custom Page - Draft Handling: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/controllerExtensions/customEditFlow
- Collaborative Draft handler (freestyle extensions):
  - API: sap.fe.macros.CollaborativeDraftHandler
  - API Reference: https://ui5.sap.com/#/api/sap.fe.macros.CollaborativeDraftHandler%23overview
```

STEP: Related resources and links
DESCRIPTION: Quick list of documentation and live examples to consult while implementing draft handling.
LANGUAGE: Text
CODE:
```text
- Fiori design guideline: https://experience.sap.com/fiori-design-web/draft-handling/
- SAP help (ABAP): https://help.sap.com/docs/SAP_NETWEAVER_AS_ABAP_752/cc0c305d2fab47bd808adcad3ca7ee9d/d36820f082c84085b6634be4576e351a.html
- Confirmation Popups (app behavior): confirmation-popups-9a53662.md
- Using Global Side Effects: using-global-side-effects-955ae31.md
- Toggling Between Draft and Saved Values: toggling-between-draft-and-saved-values-fd3950a.md
- Live examples:
  - Draft Validation / Global Patterns: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/advancedFeatures/guidance/draftValidation
```

--------------------------------

**TITLE**: Dual Combination Chart Card (UI.Chart CombinationDual) Annotation

**INTRODUCTION**: This document shows the exact OData annotation XML to add a Dual Combination Chart (CombinationDual) in an SAP Fiori Elements app. Use it to display two value axes (columns + lines) for multiple measures, with a category axis driven by one or more dimensions. Place the annotation in your local annotations file and ensure the referenced properties exist in your OData service.

**TAGS**: fiori-elements-framework, UI.Chart, CombinationDual, annotations, OData, XML, chart, measures, dimensions

**STEP**: 1 — Create / update annotations file and add chart annotation

**DESCRIPTION**: Create or edit your annotations file (e.g., webapp/annotations/annotations.xml or annotations/localAnnotations.xml) and add a Chart annotation inside an <Annotations Target="..."> block. Replace the Target value with the fully qualified entity type from your OData service. This sample is ready to drop in and adjust property names (Sales, SalesShare, TotalSales, Product, Quarter) to match your model.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="YourServiceNamespace.YourEntityType">
    <Annotation Term="UI.Chart" Qualifier="Eval_by_CtryCurr_Dual_Combo">
        <Record Type="UI.ChartDefinitionType">
            <PropertyValue Property="Title" String="Dual Combination Chart" />
            <PropertyValue Property="ChartType" EnumMember="UI.ChartType/CombinationDual"/>
            <PropertyValue Property="Measures">
                <Collection>
                    <PropertyPath>Sales</PropertyPath>
                    <PropertyPath>SalesShare</PropertyPath>
                    <PropertyPath>TotalSales</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="Dimensions">
                <Collection>
                    <PropertyPath>Product</PropertyPath>
                    <PropertyPath>Quarter</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="MeasureAttributes">
                <Collection>
                    <Record Type="UI.ChartMeasureAttributeType">
                        <PropertyValue Property="Measure" PropertyPath="Sales"/>
                        <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                    </Record>
                    <Record Type="UI.ChartMeasureAttributeType">
                        <PropertyValue Property="Measure" PropertyPath="TotalSales" />
                        <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                    </Record>
                    <Record Type="UI.ChartMeasureAttributeType">
                        <PropertyValue Property="Measure" PropertyPath="SalesShare" />
                        <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2"/>
                    </Record>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="DimensionAttributes">
                <Collection>
                    <Record Type="UI.ChartDimensionAttributeType">
                        <PropertyValue Property="Dimension" PropertyPath="Product" />
                        <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 2 — Key configuration rules and actionable checks

**DESCRIPTION**: Follow these rules when editing the annotation and before deploying:
- ChartType must be UI.ChartType/CombinationDual to enable dual-axis combination behavior.
- Configure at least two measures under the Measures collection.
- The first measure (in the Measures collection) is rendered as a column; subsequent measures render as lines by default.
- Assign measure roles via MeasureAttributes using UI.ChartMeasureRoleType/Axis1 and UI.ChartMeasureRoleType/Axis2 to place measures on appropriate axes.
- Assign at least one dimension with Role = UI.ChartDimensionRoleType/Category. All dimensions with the Category role are placed on the category axis.
- Prefer a single time-based dimension for the category axis when using time-series data.

**LANGUAGE**: plain

**CODE**:
```text
Checks before run:
- Ensure Sales, SalesShare, TotalSales, Product, Quarter exist as properties in the referenced entity.
- Ensure at least two measures are listed in <PropertyValue Property="Measures">.
- Ensure measures assigned to Axis1/Axis2 via MeasureAttributes.
- Ensure one or more dimensions have Role=Category via DimensionAttributes.
```

**STEP**: 3 — Example minimal MeasureAttributes-only snippet (for quick edits)

**DESCRIPTION**: Use this smaller snippet to quickly add or edit measure-to-axis assignments without touching the rest of the chart record.

**LANGUAGE**: XML

**CODE**:
```xml
<PropertyValue Property="MeasureAttributes">
    <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
            <PropertyValue Property="Measure" PropertyPath="Sales"/>
            <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
        </Record>
        <Record Type="UI.ChartMeasureAttributeType">
            <PropertyValue Property="Measure" PropertyPath="SalesShare" />
            <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2"/>
        </Record>
    </Collection>
</PropertyValue>
```

**STEP**: 4 — Example minimal DimensionAttributes-only snippet

**DESCRIPTION**: Quick snippet to assign a single category dimension.

**LANGUAGE**: XML

**CODE**:
```xml
<PropertyValue Property="DimensionAttributes">
    <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
            <PropertyValue Property="Dimension" PropertyPath="Product" />
            <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category"/>
        </Record>
    </Collection>
</PropertyValue>
```

**STEP**: 5 — Deployment reminders

**DESCRIPTION**: After updating annotations:
- Ensure your Fiori Elements app loads the annotations file (check manifest or annotation configuration in project).
- Refresh metadata/annotations in your app runtime or rebuild the app if annotations are bundled.
- Validate chart rendering and axis mapping in the running app; adjust measure order or roles if visuals are not as expected.

**LANGUAGE**: plain

**CODE**:
```text
Deployment reminders:
- Reference the annotations file in your app configuration (manifest or app descriptor).
- Rebuild/refresh the app to apply annotation changes.
- Validate that the first measure displays as column and other measures as lines; adjust MeasureAttributes if needed.
```
--------------------------------

**TITLE**: Editing Status (DraftAdministrativeData) — List Report / Table Behavior and Configuration

**INTRODUCTION**: This document explains how the editing status (draft state) of list report items is retrieved, displayed, filtered, and optionally disabled in SAP Fiori elements list reports. It describes where the editing status is shown depending on table type, how to read the required draft administrative fields from the back end, the default editing-status filter values, and an example manifest.json snippet to disable the editing-status filter after app generation.

**TAGS**: fiori-elements-framework, draft, DraftAdministrativeData, list-report, editing-status, manifest, filter

**STEP**: 1 — Where the editing status is displayed in list report tables

**DESCRIPTION**: UI placement rules for the editing status in list report tables (affects rendering and CSS placement). Use these rules when implementing or customizing the list report template.

**LANGUAGE**: Text

**CODE**:
```text
- Responsive Table (mobile/responsive): 
  - Editing status is shown inside the key column (the first column that displays the semantic key).

- Grid Table / Tree Table / Analytical Table:
  - Editing status is shown in a separate, unlabeled column placed in the second column position.
```

**STEP**: 2 — Retrieve DraftAdministrativeData from the OData service

**DESCRIPTION**: Query the backend OData service to obtain draft administrative data for list items so the UI can render status, the user who last changed the draft, and the last change timestamp. Replace <SERVICE>, <EntitySet>, and property names with your service specifics.

**LANGUAGE**: HTTP

**CODE**:
```http
GET /sap/opu/odata/sap/<SERVICE>/<EntitySet>?$expand=DraftAdministrativeData&$select=KeyProperty,OtherProps,DraftAdministrativeData/CreatedByUser,DraftAdministrativeData/LastChangeByUser,DraftAdministrativeData/LastChangeDateTime,DraftAdministrativeData/InProcessByUser
Host: <backend-host>
Accept: application/json
```

Notes:
- Common DraftAdministrativeData navigation properties used by UI:
  - CreatedByUser (or CreatedBy)
  - LastChangeByUser (or LastChangedBy)
  - LastChangeDateTime (or LastChangedAt)
  - InProcessByUser (user holding a lock/in process)
- Adapt select/expand names to match your service metadata.

**STEP**: 3 — Show user name and change time in list item and popover

**DESCRIPTION**: For statuses Own Draft, Unsaved Changes by Another User, and Locked by Another User, the list report shows the last-changed username in the line item and exposes a popover with the user and timestamp. If full name is not available in backend master data, the technical username is shown; otherwise a generic "another user" message is used when no username is available.

**LANGUAGE**: Text

**CODE**:
```text
UI behavior:
- Inline display: show DraftAdministrativeData.LastChangeByUser or DraftAdministrativeData.InProcessByUser in the line item.
- Popover: on click/tap of the inline name, open a popover showing:
  - User (full name or technical user name fallback)
  - Change time (DraftAdministrativeData.LastChangeDateTime)
- Fallback: if no user info is present, display "another user".
```

**STEP**: 4 — Editing Status Filter: default values and behavior

**DESCRIPTION**: The editing-status filter is a static filter attribute added by default to the list report filter bar for draft-enabled apps. The default selection is All (even if a user clears the filter value). Use these exact dropdown values when mapping filter states to backend queries.

**LANGUAGE**: Text

**CODE**:
```text
Default dropdown values (mapping semantics):
- All
  - Shows all entities (no additional draft filter).
- Own Draft
  - Shows only entities where DraftAdministrativeData.CreatedByUser == currentUser (or equivalent).
- Locked by Another User
  - Shows entities with DraftAdministrativeData.InProcessByUser != currentUser (lock held by someone else).
- Unsaved Changes by Another User
  - Shows entities where lock expired or a draft exists created by another user (DraftAdministrativeData exists and not owned by currentUser).
- Unchanged
  - Shows entities that have no draft (DraftAdministrativeData not present).
Notes:
- Default selection: All (applies even after clearing filter).
```

**STEP**: 5 — Disable the editing-status filter after app generation (manifest.json example)

**DESCRIPTION**: If you need to remove the editing-status filter from the generated list report filter bar, toggle the corresponding page setting in manifest.json. Replace placeholders with your application/page context and confirm path/name for your Fiori elements version.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "<EntitySetName>",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "enableEditingStatusFilter": false
          }
        }
      }
    ]
  }
}
```
Notes:
- Adapt the "entitySet" to the target list report entity.
- Confirm the exact property name for your Fiori elements version; if not available, see the project-specific doc: disabling-the-editing-status-filter-8eb695a.md

**STEP**: 6 — References and images used for rendering guidance

**DESCRIPTION**: Preserve visuals and related topic links to help implementers match UI behavior.

**LANGUAGE**: Text

**CODE**:
```text
Images referenced in original doc (place under webapp/images or content folder):
- images/Draft_Administrative_Data_Visualization_in_List_Report_Page_with_Responsive_Table_f66fced.png
- images/Draft_Administrative_Data_Visualization_in_List_Report_Page_with_Grid_Table_4b053c1.png

Related docs:
- disabling-the-editing-status-filter-8eb695a.md
- handling-semantic-key-fields-aa2793c.md
- settings-for-list-report-tables-4c2d17a.md
```
--------------------------------

**TITLE**: Enablement and Visibility of App-Extension Actions in SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: Practical, code-focused guidance to control enablement and visibility of custom actions added via extension points in SAP Fiori elements. Covers manifest.json properties (requiresSelection, applicablePath, enabled), binding expressions, and handler implementations for OData V2 and OData V4, including draft-aware visibility and custom logic handlers.

**TAGS**: fiori-elements-framework, sapui5, manifest.json, odata-v2, odata-v4, extension, actions, applicablePath, requiresSelection, enabled

STEP: 1 — OData V2: Enable actions in List Report (actions in table header)

DESCRIPTION: Use requiresSelection and applicablePath in the manifest extension for a List Report controller to require a user selection and to use a back-end property to evaluate action applicability. If requiresSelection = true, the button is enabled only after selection(s). If applicablePath is used, the framework checks the back-end property for selected rows and enables the action if any selected row has applicablePath = true.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "my_app.ext.controller.ListReportExtension",
            "sap.ui.generic.app": {
              "<EntitySetName>": {
                "EntitySet": "<entity set>",
                "Actions": {
                  "<Action1>": {
                    "id": "<id>",
                    "text": "<button text>",
                    "press": "<handler function>",
                    "requiresSelection": true,
                    "applicablePath": "<entity type property>"
                  },
                  "<Action2>": {
                    "id": "<id>",
                    "text": "<button text>",
                    "press": "<handler function>",
                    "requiresSelection": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 2 — OData V2: Enable actions in Object Page header or in a section table

DESCRIPTION: For object page header actions, applicablePath is evaluated against the object (object page is considered the selection). If applicablePath evaluates to false for the object, the action is hidden (not visible). For table actions within a section, requiresSelection and applicablePath behave like the list report table actions.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details#my_app::sap.suite.ui.generic.template.ObjectPage.view.Details::<EntitySetName>": {
            "controllerName": "my_app.ext.controller.DetailsExtension",
            "sap.ui.generic.app": {
              "<EntitySetName>": {
                "EntitySet": "<entity set>",
                "Header": {
                  "Actions": {
                    "<HeaderAction>": {
                      "id": "<id>",
                      "text": "<button text>",
                      "press": "<handler function>",
                      "applicablePath": "<entity type property>"
                    }
                  }
                },
                "Sections": {
                  "<EntityTypeAssociation>::com.sap.vocabularies.UI.v1.LineItem": {
                    "id": "<SmartTable Facet ID>",
                    "Actions": {
                      "<SectionTableAction>": {
                        "id": "<id>",
                        "text": "<button text>",
                        "press": "<handler function>",
                        "requiresSelection": true,
                        "applicablePath": "<entity type property>"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — OData V2: Draft-aware action visibility (object page edit mode example)

DESCRIPTION: For draft-enabled object pages, bind the action control to DraftAdministrativeData and bind the visible property to DraftIsCreatedByMe (or other draft properties) in a controller extension to display/hide a custom action depending on draft state (e.g., only in edit mode).

LANGUAGE: JavaScript

CODE:
```javascript
// Controller extension (my_app.ext.controller.DetailsExtension)
// Example: bind a button in the object page to DraftAdministrativeData and use DraftIsCreatedByMe
onInit: function() {
  // Use this.byId if the view defines the button id; otherwise adjust lookup accordingly
  var sButtonId = "STTA_MP::sap.suite.ui.generic.template.ObjectPage.view.Details::STTA_C_MP_Product--action::ObjectPageCustomAction";
  var oButton = this.byId(sButtonId);
  if (oButton) {
    // Bind navigation to DraftAdministrativeData to get draft-related properties as the binding context
    oButton.bindElement("DraftAdministrativeData");
    // Bind visibility to the 'DraftIsCreatedByMe' property available under DraftAdministrativeData
    oButton.bindProperty("visible", {
      path: "DraftIsCreatedByMe"
    });
  }
}
```

STEP: 4 — OData V4: Enable action using a function handler in manifest (selection-based)

DESCRIPTION: For OData V4, set enabled to a function reference in the manifest. Framework calls the handler with the current binding context and selected contexts (for list/table actions). Implement the handler to return boolean or a Promise<boolean>.

LANGUAGE: JSON

CODE:
```json
{
  "enabled": "SalesOrder.ext.CustomActions.enabledForCompletedOnly"
}
```

LANGUAGE: JavaScript

CODE:
```javascript
// Custom handler file: webapp/ext/CustomActions.js (example)
// signature: function(oBindingContext, aSelectedContexts) { ... }
enabledForCompletedOnly: function(oBindingContext, aSelectedContexts) {
  // Example: only enable when exactly one row is selected
  if (aSelectedContexts && aSelectedContexts.length === 1) {
    return true;
  }
  return false;
}
```

STEP: 5 — OData V4: Manifest structure examples for List Report and Object Page actions (enabled/visible/press)

DESCRIPTION: Use the target->options->settings->content->header->actions path inside routing targets to declare action properties including press handler, visible and enabled handlers (boolean, expression, or function reference).

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "<ListReportTargetName>": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  "actions": {
                    "<ActionName>": {
                      "press": "<ApplicationId.FolderName.ScriptFilename.methodName>",
                      "visible": true,
                      "enabled": "SalesOrder.ext.CustomActions.enabledForCompletedOnly",
                      "text": "{i18n>key}"
                    }
                  }
                }
              }
            }
          }
        },
        "<ObjectPageTargetName>": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  "actions": {
                    "<ObjectActionName>": {
                      "press": "<ApplicationId.FolderName.ScriptFilename.methodName>",
                      "visible": true,
                      "enabled": true,
                      "text": "{i18n>key}"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 6 — OData V4: Enable action based on ui model binding expression (edit mode)

DESCRIPTION: Use a binding expression against the ui model (ui>/editMode) to enable/disable actions depending on edit mode. This is pure manifest configuration; no extension handler required.

LANGUAGE: JSON

CODE:
```json
{
  "enabled": "{= ${ui>/editMode} === 'Editable' }"
}
```

STEP: 7 — OData V4: Control visibility with custom logic (annotation-based action example)

DESCRIPTION: Attach a custom visibility handler for an annotation-based action by referencing a function in manifest. The handler can request server-side properties through oBindingContext.requestObject(...) and return boolean or Promise<boolean>.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "<ObjectPageTargetName>": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  "actions": {
                    "<ActionName>": {
                      "DataFieldForAction::com.c_salesordermanage_sd.ArchiveSalesOrder": {
                        "visible": "SalesOrder.ext.CustomActions.visibleForCompletedOnly"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

LANGUAGE: JavaScript

CODE:
```javascript
// CustomActions.js
visibleForCompletedOnly: function (oBindingContext) {
  if (oBindingContext) {
    // requestObject returns a Promise; resolve to a boolean
    return oBindingContext.requestObject("OverallSDProcessStatus").then(function (sStatus) {
      return sStatus === "C"; // visible only if status equals "C"
    });
  } else {
    return false;
  }
}
```

STEP: 8 — Implementation notes and best practices

DESCRIPTION: Action enablement/visibility behavior summary and cautions for implementation:
- OData V2: use requiresSelection (client-side selection requirement) and applicablePath (back-end property evaluated per selected row or object page context).
- OData V4: use enabled property (boolean, binding expression, or function reference) and visible as needed.
- For object page header actions, the object itself is considered the selection; when applicablePath evaluates false, action is hidden.
- Custom handlers may return boolean or Promise<boolean>.
- Use app extensions only when necessary and always integrate via SAP Fiori elements extensionAPI. Do not manipulate internal framework controls, properties, or models directly.

LANGUAGE: N/A

CODE:
```text
- Use requiresSelection = true to require selection(s) before enabling actions on tables.
- Use applicablePath pointing to an entity type property to let the back-end decide applicability.
- For draft scenarios, bind to DraftAdministrativeData and draft properties (e.g., DraftIsCreatedByMe) to show/hide actions based on draft state.
- Handlers referenced from manifest must be reachable by module path and return boolean or Promise<boolean>.
- Prefer binding expressions for simple UI-model-based enablement to avoid custom code.
```
--------------------------------

**TITLE**: Enabling Header Actions on the Fiori Object Page (XML / ABAP CDS / CAP CDS)

**INTRODUCTION**: Quick-reference, action-focused guide showing how to expose generic and custom header actions on the Fiori Object Page using UI.Identification annotations. Includes XML, ABAP CDS and CAP CDS examples for: generic actions (Edit/Delete), Copy (isCopyAction), custom global actions, updatable/deletable control, updateHidden (OData V4), and OperationAvailable enablement.

**TAGS**: fiori-elements-framework, object-page, annotations, UI.DataFieldForAction, UI.Identification, ODataV2, ODataV4, ABAP, CAP, XML, CDS, UpdateRestrictions, OperationAvailable

STEP: 1 — Add generic header actions (DataFieldForAction) in UI.Identification
DESCRIPTION: Define header actions (Edit, Delete, Copy, custom actions) by adding com.sap.vocabularies.UI.v1.DataFieldForAction records into the unqualified UI.Identification collection. The system renders each DataFieldForAction as a header button with the label text.
LANGUAGE: XML
CODE:
```xml
<!-- Example: UI.Identification with a custom "Copy with new supplier" action (XML annotation) -->
<Annotation Term="UI.Identification">
  <Collection>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy with new supplier"/>
      <PropertyValue Property="Action"
         String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy_new_supplier"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <!-- add additional DataFieldForAction / DataFieldForIntentBasedNavigation records here -->
  </Collection>
</Annotation>
```

STEP: 2 — Add same header action in ABAP CDS (DataFieldForAction equivalent)
DESCRIPTION: Use @UI.identification in ABAP CDS to declare DataFieldForAction with type #FOR_ACTION and a dataAction (pushdown prefix when needed). Use importance/position as required.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.identification: [
  {
    importance: #HIGH,
    label: 'Copy with new supplier',
    dataAction: 'PUSHDOWN:STTA_C_MP_ProductCopy_new_supplier',
    type: #FOR_ACTION,
    position: 1
  }
]
entity product { ... }
```

STEP: 3 — Add same header action in CAP CDS (DataFieldForAction)
DESCRIPTION: CAP CDS UI annotations use UI.Identification with $Type 'UI.DataFieldForAction'. Use Action string and optional UI.Importance.
LANGUAGE: CAP CDS
CODE:
```cs
// CAP CDS annotation fragment
UI.Identification : [
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'Copy with new supplier',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy_new_supplier',
    ![@UI.Importance] : #High
  }
]
```

STEP: 4 — Define a Copy action button (isCopyAction)
DESCRIPTION: Make an action behave as the built-in Copy button by marking it as UI.IsCopyAction = true. Copy button is shown after Delete and is available only on the object page (not subobject pages). If no Label is provided, the default text is "Copy".
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Identification">
  <Collection>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Copy"/>
      <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy"/>
      <Annotation Term="UI.IsCopyAction" Bool="true"/>
    </Record>
  </Collection>
</Annotation>
```
LANGUAGE: CAP CDS
CODE:
```cs
UI.Identification : [
  {
    $Type : 'UI.DataFieldForAction',
    Label : 'Copy',
    Action : 'STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductCopy',
    ![@UI.IsCopyAction] : true
  }
]
```

STEP: 5 — Context passing rules (OData V2 vs V4)
DESCRIPTION: Runtime behavior for passing the object-page context to actions:
- OData V2: object page context is always passed when a header action is invoked.
- OData V4: object page context is passed only for bound header actions (or DataFieldForIBN configured to require context). Unbound actions receive no context.

STEP: 6 — Edit and Delete button display conditions (OData V2)
DESCRIPTION: For OData V2 endpoints, Edit and Delete buttons are auto-controlled by OData metadata attributes:
- Show Edit if sap:updatable != "false"
- Show Delete if sap:deletable != "false"
If you need conditional visibility, use path-based annotations (see next step) and do NOT hard-set sap:updatable/deletable to false.

STEP: 7 — Show/hide Edit using UpdateRestrictions/updatable-path (XML)
DESCRIPTION: Use Org.OData.Capabilities.V1.UpdateRestrictions with Updatable set to a Path to show/hide Edit based on a boolean property (true => visible). Example: check property Updatable_mc.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_Product">
  <Annotation Term="Org.OData.Capabilities.V1.UpdateRestrictions">
    <Record>
      <PropertyValue Property="Updatable" Path="Updatable_mc"/>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 8 — OData V4: updateHidden (hide edit) — XML / ABAP CDS / CAP CDS
DESCRIPTION: In OData V4, use UI.UpdateHidden to statically hide edit or to point to a path property to evaluate per-instance whether update is hidden.
LANGUAGE: XML
CODE:
```xml
<!-- Static hide edit for the entity set -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/HeaderPartner">
  <Annotation Term="UI.UpdateHidden" Bool="true"/>
</Annotations>

<!-- Path-based hide edit -->
<Annotations Target="com.c_salesordermanage_sd.EntityContainer/SalesOrderManage">
  <Annotation Term="UI.UpdateHidden" Path="isUpdateHidden"/>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.updateHidden:true
entity HeaderPartner { ... }

OR

@UI.updateHidden: #('isUpdateHidden')
entity SalesOrderManage { ... }
```
LANGUAGE: CAP CDS
CODE:
```cs
annotate com.c_salesordermanage_sd.SalesOrderManage with @( UI.UpdateHidden: true);

OR

annotate com.c_salesordermanage_sd.SalesOrderManage with @( UI.UpdateHidden: isUpdateHidden);
```

STEP: 9 — Edit enablement rules with Draft/EditAction and OperationAvailable (OData V4)
DESCRIPTION: For draft-enabled apps that define a DraftRoot/EditAction, UpdateRestrictions are ignored and enablement is governed by OperationAvailable:
- If OperationAvailable == true (static) OR not defined => Edit visible (unless updateHidden hides it) and enabled.
- If OperationAvailable == false (static) => Edit not visible.
- If OperationAvailable == <path> => runtime evaluation: true => enabled; false => not visible; null => visible but disabled.
Refer to "OperationAvailable" usage for DataFieldForAction enablement.

STEP: 10 — Define custom global actions (bound/unbound/IBN)
DESCRIPTION: Define additional global header actions by adding DataFieldForAction or DataFieldForIntentBasedNavigation to UI.Identification. Rules:
- Actions not flagged as determining=true are rendered as global actions next to standard actions.
- For bound actions or DataFieldForIBN configured to require context, object page context is passed. For unbound actions, no context is passed.
- Control visibility with UI.Hidden (static true or path). Control enablement with OperationAvailable. IBN (intent-based navigation) enablement uses NavigationAvailable.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Identification">
  <Collection>
    <!-- Custom bound/unbound action -->
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Break Up"/>
      <PropertyValue Property="Action" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.BREAK_UP"/>
    </Record>

    <!-- Intent-based navigation button (IBN) for header -->
    <Record Type="UI.DataFieldForIntentBasedNavigation">
      <PropertyValue Property="Label" String="SampleIBN"/>
      <PropertyValue Property="SemanticObject" String="MySemanticObject"/>
      <PropertyValue Property="Action" String="manage"/>
      <!-- For header IBN buttons, RequiresContext should be false or omitted -->
      <PropertyValue Property="RequiresContext" Bool="false"/>
    </Record>
  </Collection>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.identification: [
  {
    label: 'Break Up',
    dataAction: 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.BREAK_UP',
    type: #FOR_ACTION,
    position: 1
  },
  {
    label: 'SampleIBN',
    semanticObjectAction: 'manage',
    type: #FOR_INTENT_BASED_NAVIGATION,
    position: 2
  }
]
TEST;  // entity name
@Consumption.semanticObject: 'MySemanticObject'
%ENTITY;
```
LANGUAGE: CAP CDS
CODE:
```cs
UI : {
  Identification: [
    {
      $Type : 'UI.DataFieldForAction',
      Label : 'Break Up',
      Action : 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.BREAK_UP'
    },
    {
      $Type : 'UI.DataFieldForIntentBasedNavigation',
      Label : 'SampleIBN',
      SemanticObject : 'MySemanticObject',
      Action : 'manage',
      RequiresContext : false
    }
  ]
}
```

STEP: 11 — Visibility and enablement controls summary
DESCRIPTION: Use these annotations to control header action behavior:
- UI.Hidden (static or path) => hides the action when true.
- OperationAvailable (static true/false or path) => controls enablement/visibility for DataFieldForAction (same semantics as for Edit).
- NavigationAvailable / RequiresContext => controls IBN button enablement and context requirement.
- UI.IsCopyAction => marks DataFieldForAction as the standard Copy button (placed after Delete).

STEP: 12 — Subobject page: Edit button behavior and rules
DESCRIPTION: On subobject (navigation) pages:
- Edit button is displayed on the subobject page only if it is visible on the object page AND the subobject entity is not annotated to hide it.
- Edit button is enabled on the subobject page only if it is enabled on the object page AND the subobject entity is not annotated to disable it.
- Note: Selecting Edit on a subobject page enables edit mode for the entire object page (not only the subobject).

RELATED: See pages "Displaying Actions on the Object Page" and "Actions" for deeper guidance on bound/unbound actions, OperationAvailable detail, and action criticality.
--------------------------------

**TITLE**: Enabling an App for Key User Adaptation (SAP Fiori elements, OData V4)

**INTRODUCTION**: This guide shows the concrete code changes and annotation patterns required to enable SAP Fiori elements apps for key user adaptation (UI flexibility). It covers: enabling flexibility in manifest.json, preparing header facet annotations, referencing/stashing/restricting header facets via manifest settings, and enabling form-level adaptations (DataFieldDefault). Applicable only to SAP Fiori elements for OData V4.

**TAGS**: fiori-elements-framework, sapui5, ui-adaptation, flexibility, manifest.json, annotations, header-facets, forms, ODataV4

**STEP**: 1 — Enable UI flexibility in the app manifest

**DESCRIPTION**: Set the sap.ui5 flexEnabled flag to true in your app’s manifest.json to enable SAPUI5 flexibility and allow key user adaptation features.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "flexEnabled": true
  }
}
```

**STEP**: 2 — What key users can adapt (summary)

**DESCRIPTION**: High-level list of adaptation capabilities available to key users once flexibility is enabled. Use this to decide which controls/annotations to prepare and which to restrict.

**LANGUAGE**: text

**CODE**:
```
- Create and manage variants of List Report (filters, column sorting, selected tabs)
- Define visible fields in Mass Edit dialogs (all except static read-only fields)
- Move/rename/remove/add toolbar and table buttons (header, table on List Report; header, section, subsection, table, footer on Object Page)
  - Restriction: Some standard actions (edit, save, delete) are excluded. Actions with dynamic visibility cannot be added/removed.
- Split/combine table actions on Object Page and List Report
- Move/rename/remove/reveal sections and subsections on Object Page
- Edit Object Page header facets (see STEP 3–6)
- Move/rename/add/remove form parts and fields (see STEP 7)
- Embed/update/move/remove iFrame content on object page headers and sections
  - Caution: You cannot embed another SAP Fiori elements app via iFrame into an existing SAP Fiori elements app.
- Note: Fields added via key user adaptation receive a stable ID from SAPUI5 flexibility (different from Fiori elements generated stable ID).
```

**STEP**: 3 — Prepare ReferenceFacet annotations for Object Page header

**DESCRIPTION**: Add UI.HeaderFacets annotations to provide predefined header facets that can later be added by key users to the object page header. Use Record Type="UI.ReferenceFacet", specify Label, ID (recommended), and Target (AnnotationPath). Importance is optional.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.HeaderFacets">
  <Collection>
    ...
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="Column MicroChart"/>
      <PropertyValue Property="ID" String="ColumnMicroChart"/>
      <PropertyValue Property="Target" AnnotationPath="_Item/@UI.Chart#ColumnMaxPath"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="Progress Indicator"/>
      <PropertyValue Property="ID" String="ProgressIndicator"/>
      <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Progress"/>
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
    ...
  </Collection>
</Annotation>
```

**STEP**: 4 — Reference header facets in manifest.json to stash or restrict them

**DESCRIPTION**: Use the component manifest (manifest.json) controlConfiguration entry to reference header facets by ID and configure stashed status or flexSettings (designtime). If no ID exists in the annotation, generated IDs use the AnnotationPath term part and qualifier (example: DataPoint::Rating).

Place these entries under the component options -> settings -> controlConfiguration of the ObjectPage component (example component id below).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "editableHeaderContent": false,
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.HeaderFacets": {
            "facets": {
              "ColumnMicroChart": {
                "stashed": true
              },
              "ProgressIndicator": {
                "stashed": false,
                "flexSettings": {
                  "designtime": "not-adaptable-visibility"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — How header facet IDs are resolved / generated

**DESCRIPTION**: Reference header facets in manifest.json by:
- The explicit ID from the annotation (PropertyValue Property="ID"), or
- If no ID is provided, an ID generated from the AnnotationPath term part and qualifier (example: AnnotationPath="@UI.DataPoint#Rating" → generated ID "DataPoint::Rating").

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Explicit ID defined -->
<Record Type="UI.ReferenceFacet">
  <PropertyValue Property="Label" String="Progress Indicator"/>
  <PropertyValue Property="ID" String="ProgressIndicator"/>
  <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Progress"/>
</Record>

<!-- No ID defined → generated ID from AnnotationPath (DataPoint::Rating) -->
<Record Type="UI.ReferenceFacet">
  <PropertyValue Property="Label" String="Rating Indicator"/>
  <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Rating"/>
</Record>
```

**STEP**: 6 — Stashing behavior and loading implications

**DESCRIPTION**: When a facet is marked "stashed": true in manifest.json, it is not visible and not loaded at app start. Key users can add stashed facets later via key user adaptation. If no manifest entry exists for a facet, it is rendered with default behavior: not stashed and fully adaptable.

**LANGUAGE**: text

**CODE**:
```
- stashed: true  → facet not visible at runtime and not loaded on app start; can be added by key users.
- No manifest entry → default: not stashed; full adaptability (unless control-specific restrictions apply).
```

**STEP**: 7 — Restrict adaptability using flexSettings / designtime

**DESCRIPTION**: Use controlConfiguration -> flexSettings -> designtime to restrict available actions for a facet/control. Example: "not-adaptable-visibility" disables visibility actions (add/remove) but still allows move.

For further patterns and values, see: Enabling UI Adaptation: Other Things to Consider -> Restrict Adaptation for Certain Controls
(relative path): ../05_Developing_Apps/enabling-ui-adaptation-other-things-to-consider-de9fd55.md#loiode9fd55c69af4b46863f5d26b5d796c4__section_restrictadaptation

**LANGUAGE**: JSON

**CODE**:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.HeaderFacets": {
      "facets": {
        "ProgressIndicator": {
          "stashed": false,
          "flexSettings": {
            "designtime": "not-adaptable-visibility"
          }
        }
      }
    }
  }
}
```

**STEP**: 8 — Enable key user adaptation for Forms (FormContainers and fields)

**DESCRIPTION**: Allow moving fields inside a FormContainer or between FormContainers that belong to the same entity. Prepare properties with DataFieldDefault annotation so they appear in the personalization Add dialog. Key behaviors:
- Rename labels
- Remove/add fields
- Move/add/remove FormContainers (within same entity)
- Add simple properties from the model once per form (property must not already be visible)
- Use DataFieldDefault as a wrapper for DataField or DataFieldWithUrl to make properties available for personalization
- Unsupported in forms for adding buttons: DataFieldForAction, DataFieldForIntentBasedNavigation, DataFieldWithAction, DataFieldWithIntentBasedNavigation

**LANGUAGE**: CDS

**CODE**:
```cds
OrganizationDivision : String(2) @(
  Common : { Label : 'Division' },
  UI : {
    DataFieldDefault : {
      $Type: 'UI.DataField',
      Value: OrganizationDivision,
      Label: 'Default Division'
    }
  }
);
```

**STEP**: 9 — Important restrictions and notes

**DESCRIPTION**: Consolidated list of restrictions and important behavior to preserve in implementation and tests.

**LANGUAGE**: text

**CODE**:
```
- Applicable only to SAP Fiori elements for OData V4.
- Some standard actions (e.g., edit, save, delete) are excluded from key user adaptation.
- Actions with dynamic visibility cannot be added or removed.
- You cannot embed another SAP Fiori elements app into an existing Fiori elements app via iFrame.
- Fields added by key user adaptation receive a stable ID from SAPUI5 flexibility that differs from the Fiori elements generated stable ID.
- If you do not declare header facet entries in manifest.json, the facet renders with default behavior: not stashed and fully adaptable.
```
--------------------------------

**TITLE**: Enabling Chart Personalization

**INTRODUCTION**: Configure chart personalization in SAP Fiori elements apps (OData V4). This documents how to enable/disable personalization globally or per-feature via the manifest, how variant management affects the Filter option visibility, and which fields are excluded from chart Filter personalization.

**TAGS**: fiori-elements-framework, chart, personalization, manifest.json, OData V4, variant-management, controlConfiguration, filter

**STEP**: Summary & defaults

**DESCRIPTION**: Quick reference of default behavior and valid values for the chart personalization setting.

- Default personalization: true (all settings enabled).
- personalization can be:
  - boolean true: enable all personalization features.
  - boolean false: disable all personalization features.
  - object: explicitly enable/disable each feature. If a property is omitted it is treated as false (prevents apps from automatically getting new features in future releases).
- Variant management affects Filter visibility:
  - "Control" variant: Item, Sort, Type, Filter
  - "Page" variant: Item, Sort, Type (Filter not available)
  - "None": Item, Sort, Type (Filter not available)
- Filter default state (summary):
  - Disabled in page-level variant or when variant management is not enabled.
  - Enabled in control-level variant.

**LANGUAGE**: Plain text

**CODE**:
```text
Valid values for chartSettings.personalization:
- true  -> enable all features
- false -> disable all features
- object -> { "column": bool, "sort": bool, "filter": bool, "type": bool }
  Note: Omitted properties are treated as false.
Variant management effect:
- "Control" -> Item, Sort, Type, Filter
- "Page" or "None" -> Item, Sort, Type
```

**STEP**: Switch off chart personalization globally (manifest.json)

**DESCRIPTION**: Set chart personalization to false to disable all chart personalization options. Add or update the controlConfiguration entry for your chart component in the app manifest (manifest.json). The snippet below matches a ListReport component entry; adapt the path to your component ID and contextPath.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "BusinessPartnersList": {
    "type": "Component",
    "id": "BusinessPartnersList",
    "name": "sap.fe.templates.ListReport",
    "options": {
      "settings": {
        "contextPath": "/BusinessPartners",
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.Chart": {
            "chartSettings": {
              "personalization": false
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Fine-grained personalization control (manifest.json)

**DESCRIPTION**: Use an object to enable/disable individual personalization features (column/item selection, sort, filter, type). When using the object form, explicitly include each feature to avoid implicit enabling of future features. Example below disables Sort while enabling Column, Filter and Type.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "BusinessPartnersList": {
    "type": "Component",
    "id": "BusinessPartnersList",
    "name": "sap.fe.templates.ListReport",
    "options": {
      "settings": {
        "contextPath": "/BusinessPartners",
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.Chart": {
            "chartSettings": {
              "personalization": {
                "column": true,
                "sort": false,
                "filter": true,
                "type": true
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Where to place the manifest entries

**DESCRIPTION**: Add the controlConfiguration entry within your component entry (the example uses a ListReport component). In a typical Fiori elements app this is inside the component declaration in the root manifest.json. Ensure the key for the chart matches the chart annotation term: "@com.sap.vocabularies.UI.v1.Chart".

**LANGUAGE**: Plain text

**CODE**:
```text
Place the chartSettings.personalization JSON under:
manifest.json -> [your component entry] -> options -> settings -> controlConfiguration -> "@com.sap.vocabularies.UI.v1.Chart" -> chartSettings

Example path (in manifest.json):
/[componentId]/options/settings/controlConfiguration/@com.sap.vocabularies.UI.v1.Chart/chartSettings/personalization
```

**STEP**: Filter option exclusions

**DESCRIPTION**: The following fields are excluded from the Chart "Filter" personalization option. These fields will not appear in chart filter configuration regardless of personalization settings.

- Fields annotated with @com.sap.vocabularies.UI.v1.HiddenFilter
- Fields coming from navigation entity sets
- Properties annotated as measures (e.g., Analytics.AggregatedProperty) or marked with Aggregation.CustomAggregate

Refer to the documentation "Configuring Charts" for additional chart-specific annotation guidance.

**LANGUAGE**: Plain text

**CODE**:
```text
Excluded from chart Filter option:
- @com.sap.vocabularies.UI.v1.HiddenFilter
- navigation entity set properties
- measure properties (Analytics.AggregatedProperty) or Aggregation.CustomAggregate

See: Configuring Charts (configuring-charts-653ed0f.md)
```
--------------------------------

**TITLE**: Enable State Preservation Mode (Discovery vs Persistence) for SAP Fiori Elements Object Pages

**INTRODUCTION**: Configure how object-page UI state (filters, visible columns, tab selection, anchor/section selection, etc.) is stored and restored by setting the statePreservationMode property in the app manifest. Use this to control whether personalization changes apply only to the current object (discovery) or persist across objects at the same navigation level (persistence).

**TAGS**: fiori-elements-framework, state-preservation, iAppState, manifest.json, sap.ui.generic.app, ODataV2, ODataV4, persistence, discovery, flexible-column-layout

**STEP**: 1 — Modes summary (behavior)
**DESCRIPTION**: Quick reference: what each mode means and default behavior depending on Flexible Column Layout (FCL).
**LANGUAGE**: Text
**CODE**:
```Text
Discovery Mode (default when NOT using FCL):
- Changes apply only to the current object instance.
- Navigating to a different object resets to the control's default (annotation or manifest).
- Use cases: Filter on one object does not affect the next object; tab selection resets to first tab on new objects.

Persistence Mode (default when using FCL):
- Changes apply to the current object and to objects at the same navigation level when navigating (e.g., paginator).
- Use cases: Filter applied on one object affects the next object; tab selection persists across objects.

Implementation note:
- The framework uses iAppState underneath; statePreservationMode toggles how iAppState is applied.
```

**STEP**: 2 — Set statePreservationMode in manifest (OData V2)
**DESCRIPTION**: Add or update the statePreservationMode under sap.ui.generic.app.settings in webapp/manifest.json. Choose "persistence" or "discovery". This examples show minimal context: place inside your app's manifest.json file at the path /sap.ui.generic.app/settings.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "objectPageDynamicHeaderTitleWithVM": true,
      "statePreservationMode": "persistence"
    },
    "pages": {
      "ListReport|C_STTA_SalesOrder_WD_20": {
        // page configuration...
      }
    }
  }
}
```

Alternative (set discovery mode):
```json
{
  "sap.ui.generic.app": {
    "settings": {
      "statePreservationMode": "discovery"
    }
  }
}
```

File path: webapp/manifest.json — ensure changes are under the correct sap.ui.generic.app node for the Fiori Elements app.

**STEP**: 3 — OData V4 restriction
**DESCRIPTION**: Discovery mode is not applicable to SAP Fiori elements for OData V4. For V4 apps, do not set statePreservationMode to "discovery" — the framework ignores it.
**LANGUAGE**: Text
**CODE**:
```Text
Restriction:
- OData V4 apps: "discovery" mode is not supported. Use "persistence" or rely on framework defaults for V4.
```

**STEP**: 4 — Important behavior notes and edge cases
**DESCRIPTION**: Preserve the following runtime behaviors and caveats in your implementation and tests.
**LANGUAGE**: Text
**CODE**:
```Text
- Section selection persists only when user selects a section via the anchor navigation area. Scrolling to a section does NOT persist selection.
- Changes made to object pages at any given level DO NOT persist after the object page at that level is closed; they reset to defaults (annotation/manifest).
  Example: in persistence mode, changes in a subobject persist while that subobject is open. Once closed, they reset.
- Exception: the last opened object (most recently opened) can keep its changes even after that subobject page is closed.
- The statePreservationMode setting is consumed by the framework/iAppState implementation; do not attempt to re-implement state storage unless you explicitly extend or override iAppState behavior.
- Validate behavior in scenarios with paginator/navigation and Flexible Column Layout — defaults differ by FCL usage.
```

**STEP**: 5 — Verification checklist (quick tests)
**DESCRIPTION**: Actions to verify the configured mode behaves as expected in runtime.
**LANGUAGE**: Text
**CODE**:
```Text
- Configure statePreservationMode to "persistence" in manifest.json and run the app.
  Test: apply a filter or change visible columns on object A, navigate (paginator) to object B at same level — changes should persist.
- Configure statePreservationMode to "discovery" (V2 only) and run the app.
  Test: apply a filter on object A, navigate to object B — object B should show defaults (no persistence).
- Test anchor navigation: click an anchor entry to change section -> verify selection persists per mode. Scroll to a section -> verify selection does NOT persist.
- Test subobject behavior: open a subobject, change state, close subobject -> verify state resets, except for the latest opened object where changes may persist.
```
--------------------------------

**TITLE**: Enabling Mass Edit (Dialog) in SAP Fiori Elements — manifest.json Configuration and Rules

**INTRODUCTION**: Quick, code-focused guide for enabling and configuring the Mass Edit dialog (mass edit) in SAP Fiori Elements (OData V4 and notes for V2). Includes manifest.json examples for boolean enablement, visibleFields, ignoredFields, operation grouping, and concise runtime/behavior restrictions to apply in code and design decisions.

**TAGS**: fiori-elements, mass-edit, manifest.json, enableMassEdit, visibleFields, ignoredFields, operationGroupingMode, ODataV4, ODataV2

STEP: 1 — Prerequisites and quick behavior summary

DESCRIPTION: Ensure these prerequisites before enabling or coding for mass edit. Use this as a checklist in your app initialization and developer docs.

LANGUAGE: text

CODE:
```text
Prerequisites & behavior:
- Add enableMassEdit configuration in manifest.json (examples below).
- End users must select at least one record to open the mass edit dialog.
- On object pages, mass edit is available only in edit mode.
- For OData V2: mass edit dialog is available only in the list report.
- For OData V4: mass edit can be used in object pages (edit mode) and list reports.
- Note: Read-only fields are automatically excluded from the dialog; only editable fields are updated.
- Performance tip: prefer visibleFields to limit server data requests when opening dialog.
```

STEP: 2 — Enable mass edit (simple boolean)

DESCRIPTION: Quick boolean activation in manifest.json. Place under controlConfiguration for the table/line item control that represents the table (typically the UI LineItem annotation path for the table entity).

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "controlConfiguration": {
      "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
        "tableSettings": {
          "enableMassEdit": true
        }
      }
    }
  }
}
```

STEP: 3 — Enable mass edit using visibleFields (recommended for performance)

DESCRIPTION: Use visibleFields to specify the exact fields shown and loaded in the mass edit dialog. visibleFields can be:
- An annotation reference to a FieldGroup: "@com.sap.vocabularies.UI.v1.FieldGroup#MyFieldGroup"
- A comma-separated list of property names: "PropertyA,PropertyB"

Note: If visibleFields is set, ignoredFields is ignored. Only one (visibleFields OR ignoredFields) may be used.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "controlConfiguration": {
      "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
        "tableSettings": {
          "enableMassEdit": {
            "visibleFields": "@com.sap.vocabularies.UI.v1.FieldGroup#FieldsForMassEdit"
          }
        }
      }
    }
  }
}
```

Alternative using a comma-separated list of properties:
```json
{
  "sap.ui5": {
    "controlConfiguration": {
      "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
        "tableSettings": {
          "enableMassEdit": {
            "visibleFields": "PropertyA,PropertyB,PropertyC"
          }
        }
      }
    }
  }
}
```

STEP: 4 — Enable mass edit using ignoredFields

DESCRIPTION: Use ignoredFields to hide specific fields from the mass edit dialog while keeping other table fields visible. ignoredFields is a comma-separated list of property names. ignoredFields is ignored if visibleFields is present.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "controlConfiguration": {
      "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
        "tableSettings": {
          "enableMassEdit": {
            "ignoredFields": "PropertyToHide1,PropertyToHide2"
          }
        }
      }
    }
  }
}
```

STEP: 5 — Configure operation grouping mode (ChangeSet vs Isolated)

DESCRIPTION: Control how updates are grouped when saving mass edits:
- "ChangeSet" = grouped for all objects within the same request
- "Isolated" = each object is updated separately (individual OData change sets in the same request)

Default: object page = "ChangeSet", list report = "Isolated". Use operationGroupingMode in enableMassEdit.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "controlConfiguration": {
      "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
        "tableSettings": {
          "enableMassEdit": {
            "operationGroupingMode": "Isolated"
          }
        }
      }
    }
  }
}
```

Combine with visibleFields:
```json
{
  "sap.ui5": {
    "controlConfiguration": {
      "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
        "tableSettings": {
          "enableMassEdit": {
            "visibleFields": "@com.sap.vocabularies.UI.v1.FieldGroup#FieldsForMassEdit",
            "operationGroupingMode": "ChangeSet"
          }
        }
      }
    }
  }
}
```

STEP: 6 — Runtime details, limits and important restrictions (developer checklist)

DESCRIPTION: Implement and test these runtime behaviors and restrictions. Use them when validating design and when writing server-side handlers or CAP features.

LANGUAGE: text

CODE:
```text
Runtime rules & restrictions:
- Editability: When user opens dialog, each field's editability is evaluated; read-only fields are excluded.
- Suggestion values: prepopulated suggestions are proposed only from the first 30 selected lines. If >30 selected, dialog opens immediately and editability is computed in background for save.
- Selection behavior: If selectionMode is unspecified or "Multi", users can select multiple records.
- Fields NOT supported in mass edit dialog:
  - Image fields
  - DataFieldForAnnotation-based fields (microcharts, contact fields, field-group-based table fields)
  - Multi-input fields
  - Fields from navigation entities
  - Custom fields
  - Fields with context-dependent value help
  - Value help fields with fixed-value lists (@Common.ValueListWithFixedValues: true)
- Server validation: No server-side validation happens until user clicks Save; client collects changes and sends updates on Save.
- Concurrency/locking: Do NOT enable mass edit if backend locks entire object while updating a child object.
- ETag: For object pages with mass edit, if service is ETag-enabled, ensure "etag master" semantics (child entity ETag must not depend on parent).
- Collaborative draft: Mass edit is NOT supported on object pages when collaborative draft is enabled.
- CAP Node.js: For CAP-based backends, a feature flag may be required. See: https://cap.cloud.sap/docs/releases/dec23#sapui5-mass-edit
```

STEP: 7 — UX and visibility notes (controls and restrictions)

DESCRIPTION: Use these rules to control visibility and enablement of the Edit button and mass edit availability.

LANGUAGE: text

CODE:
```text
Visibility & enablement:
- The Edit button is not visible if the table entity has update restriction set to static false.
- Visibility can be controlled with UI.UpdateHidden (path-based only to the parent path for object/subobject pages or to a singleton in list report).
- The Edit button is disabled if update restriction points to a path and that path evaluates to false.
- Mass edit does NOT change draft/active status of objects.
- If parent entity has a navigation restriction to the table entity set, it takes precedence over the table entity's update restriction.
```


--------------------------------

**TITLE**: Enabling Mass Edit (Dialog) in a List Report (SAP Fiori elements, OData V2)

**INTRODUCTION**: This guide shows how to enable and configure the mass edit dialog (multiEdit) in a List Report app built with SAP Fiori elements (OData V2). It includes manifest.json settings, optional FieldGroup annotation usage for faster performance, how to exclude fields from the dialog, and how to override the dialog title.

**TAGS**: fiori-elements-framework, OData V2, list report, mass edit, multiEdit, manifest.json, annotations, FieldGroup, i18n

STEP: 1 — Enable MultiEdit in manifest.json

DESCRIPTION: Turn on multiEdit for the table in the List Report by adding the multiEdit property under tableSettings in webapp/manifest.json. By default, the mass edit dialog shows editable fields that correspond to the currently displayed table columns (affected by table personalization).

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "STTA_C_SO_SalesOrder_ND",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "tableSettings": {
              "multiEdit": {
                "enabled": true
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 2 — Provide a FieldGroup annotation for MultiEdit fields (recommended for performance)

DESCRIPTION: Instead of allowing the dialog to derive fields from visible table columns, explicitly provide a FieldGroup annotation with a qualifier (for example #MultiEdit). Reference that annotation via annotationPath in manifest.json to limit and control which fields appear in the mass edit dialog — improves runtime performance.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "STTA_C_SO_SalesOrder_ND",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "tableSettings": {
              "multiEdit": {
                "enabled": true,
                "annotationPath": "com.sap.vocabularies.UI.v1.FieldGroup#MultiEdit"
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: 3 — Example FieldGroup annotation (annotations XML file)

DESCRIPTION: Create an annotation record specifying the DataField entries that will be displayed in the mass edit dialog. Place this XML in your OData annotation file (e.g., webapp/annotations/FieldGroups.xml or the service annotations file referenced by the app).

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="MultiEdit">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="NetAmount"/>
        </Record>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="TaxAmount"/>
        </Record>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="LifecycleStatus"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 4 — Ignore specific fields from the mass edit dialog (key user adaptation)

DESCRIPTION: Prevent certain fields from appearing in the mass edit dialog by listing them in the ignoredFields string (comma-separated) under multiEdit in manifest.json. This is applied for key user adaptation scenarios.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "STTA_C_SO_SalesOrder_ND",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "tableSettings": {
              "multiEdit": {
                "enabled": true,
                "annotationPath": "com.sap.vocabularies.UI.v1.FieldGroup#MultiEdit",
                "ignoredFields": "NetAmount,TaxAmount"
              }
            }
          }
        }
      }
    ]
  }
}
```
Note: The value for ignoredFields must be a single string of comma-separated property names.

STEP: 5 — Override the default title of the MultiEdit dialog (i18n)

DESCRIPTION: Replace the default title "Edit(X)" by adding a MULTI_EDIT_DIALOG_TITLE entry to the app i18n properties file (webapp/i18n/i18n.properties). Use {0} if you want to dynamically display the selected item count.

LANGUAGE: Properties

CODE:
```properties
# webapp/i18n/i18n.properties
MULTI_EDIT_DIALOG_TITLE=Edit ({0})
# Example custom text:
# MULTI_EDIT_DIALOG_TITLE=Update {0} selected items
```

STEP: 6 — Behavior notes and constraints

DESCRIPTION: Important behavioral details and limitations to apply in implementation and testing.

LANGUAGE: PlainText

CODE:
```
- The multiEdit dialog option appears in the table toolbar when enabled.
- Supported table types: Responsive Table and Grid Table only.
- Not supported for: smart multi-input fields, custom columns, and DataFieldForAnnotations.
- Only properties of the entity set are supported for mass edit (no navigation property edits).
- Each selected instance is updated in a separate request changeset within a single batch. Errors for one or more instances do not prevent other instances from being processed.
- Default dialog fields: the dialog shows editable fields for columns currently displayed in the table (table personalization affects this). Use FieldGroup annotation to explicitly control fields and improve performance.
```

STEP: 7 — References / Related features to review

DESCRIPTION: Additional capabilities you may want to combine with multiEdit.

LANGUAGE: PlainText

CODE:
```
- Replacing the standard save functionality in the mass edit dialog (custom save handler)
- Adding custom input fields to the mass edit dialog via view extensions (manifest-driven)
- Localization of UI texts (i18n replacement)
```
--------------------------------

**TITLE**: Enabling Inline Creation Mode and Empty Row Mode for Object Page Tables (OData V2 & V4)

**INTRODUCTION**: Quick, code-focused guide to configure inline creation (inline rows) and empty-row modes for object page tables in SAP Fiori Elements. Includes manifest.json settings (app / object page / section / controlConfiguration), OData/annotation examples for RequiredProperties, DefaultValuesFunction and SideEffects, i18n key pattern for custom required-field messages, and toggles such as disableDefaultInlineCreateSort and createAtEnd.

**TAGS**: Fiori Elements, manifest.json, OData, annotations, DefaultValuesFunction, InsertRestrictions, RequiredProperties, SideEffects, inline creation, empty row, object page

**STEP**: 1 — Choose creation mode (app / object page / section) for OData V2 apps
**DESCRIPTION**: Configure default creation mode at app level, override at object page and per-section (table) level. Valid values shown: "creationRows", "creationRowsHiddenInEditMode", "inline", "newPage". Place this JSON in your web app manifest.json under "sap.ui.generic.app".
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "tableSettings": {
        "createMode": "creationRows"  // app-level default for all object page tables
      }
    },
    "pages": {
      "ListReport|C_STTA_SalesOrder_WD_20": {
        "entitySet": "C_STTA_SalesOrder_WD_20",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": {
          "ObjectPage|C_STTA_SalesOrder_WD_20": {
            "entitySet": "C_STTA_SalesOrder_WD_20",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "createMode": "inline", // object page override
                "sections": {
                  "to_Item::com.sap.vocabularies.UI.v1.LineItem": {
                    "navigationProperty": "to_Item",
                    "entitySet": "C_STTA_SalesOrderItem_WD_20",
                    "createMode": "newPage", // section/table override
                    "tableSettings": {
                      "inlineDelete": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Disable default inline-create sort (object page section)
**DESCRIPTION**: When "createMode":"inline" is used, new inline rows are placed at top by default. To keep server sort/personalized sort, set disableDefaultInlineCreateSort = true at the section/table level.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "ObjectPage|STTA_C_MP_Product": {
    "entitySet": "STTA_C_MP_Product",
    "component": {
      "name": "sap.suite.ui.generic.template.ObjectPage",
      "settings": {
        "tableType": "ResponsiveTable",
        "sections": {
          "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
            "navigationProperty": "to_ProductText",
            "entitySet": "STTA_C_MP_ProductText",
            "multiSelect": true,
            "createMode": "inline",
            "disableDefaultInlineCreateSort": true,
            "tableType": "ResponsiveTable"
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Declare RequiredProperties to support empty-row draft creation (OData annotation XML)
**DESCRIPTION**: Use Capabilities.InsertRestrictions.RequiredProperties so framework treats specified fields as required for converting empty rows to draft. Add annotation target to the navigation target (table entity) or LineItem.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- annotations.xml (or your service annotation file) -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/_Item"
             xmlns="http://docs.oasis-open.org/odata/ns/edm"
             xmlns:Capabilities="http://docs.oasis-open.org/odata/ns/metadata">
  <Annotation Term="Capabilities.InsertRestrictions">
    <Record Type="Capabilities.InsertRestrictionsType">
      <PropertyValue Property="RequiredProperties">
        <Collection>
          <PropertyPath>RequestedQuantity</PropertyPath>
          <PropertyPath>Material</PropertyPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 4 — Provide default values using DefaultValuesFunction (entity and navigation-property create)
**DESCRIPTION**: Expose a FunctionImport that returns the default payload and annotate the entity set (or navigation) with com.sap.vocabularies.Common.v1.DefaultValuesFunction to prefill empty rows. Example shows entity-level and navigation-property-level uses.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Service metadata or edmx snippet: FunctionImport for root-level create defaults -->
<FunctionImport Name="GetDefaultsForRoot"
                ReturnType="cds_zrc_dv_defaultvalues.ZRC_DV_A_Create"
                m:HttpMethod="GET" xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" />

<!-- Annotation for entity set to point to function -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm"
             Target="cds_zrc_dv_defaultvalues.cds_zrc_dv_defaultvalues_Entities/Root">
  <Annotation Term="com.sap.vocabularies.Common.v1.DefaultValuesFunction" String="GetDefaultsForRoot"/>
</Annotations>

<!-- FunctionImport for navigation property (item) defaults -->
<FunctionImport Name="GetDefaultsForItem"
                ReturnType="cds_zrc_dv_defaultvalues.ZRC_DV_A_Create"
                m:HttpMethod="GET"
                sap:action-for="cds_zrc_dv_defaultvalues.RootType"
                xmlns:sap="http://www.sap.com/Protocols/SAPData"
                xmlns:m="http://schemas.microsoft.com/ado/2007/08/dataservices/metadata" >
  <Parameter Name="UUID" Type="Edm.Guid" Mode="In"/>
</FunctionImport>

<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm"
             Target="cds_zrc_dv_defaultvalues.RootType/to_Item">
  <Annotation Term="com.sap.vocabularies.Common.v1.DefaultValuesFunction" String="GetDefaultsForItem"/>
</Annotations>
```

**STEP**: 5 — Recalculate default values when dependent properties change (SideEffects)
**DESCRIPTION**: If default values depend on other properties (e.g., CustomerNumber), declare a SideEffects annotation so the empty row is refreshed when those source properties change. Use the nav property representing the table as TargetEntities.
**LANGUAGE**: JSON-like (pseudocode) and XML
**CODE**:
```text
// SideEffects (conceptual)
// When CustomerNumber changes, refresh the _Item target (the table)
SideEffects #TableIsRefreshed: {
    SourceProperties: [CustomerNumber],
    TargetEntities  : [_Item]
}
```
```xml
<!-- XML annotation form -->
<Annotation Term="Common.SideEffects" Qualifier="TableIsRefreshed"
            xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Record Type="Common.SideEffectsType">
    <PropertyValue Property="SourceProperties">
      <Collection><PropertyPath>CustomerNumber</PropertyPath></Collection>
    </PropertyValue>
    <PropertyValue Property="TargetEntities">
      <Collection><NavigationPropertyPath>_Item</NavigationPropertyPath></Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 6 — Custom i18n key for RequiredProperties error message
**DESCRIPTION**: Override default "Enter a value" message for missing RequiredProperties in i18n. Use the key format below and place the entry in the app i18n resource bundle.
**LANGUAGE**: TEXT (i18n key)
**CODE**:
```text
// i18n.properties (example)
REQUIRED_PROP_ERROR|<EntitySet>|<navigationProperty>|com.sap.vocabularies.UI.v1.LineItem|<Required Property Name>=Your custom message

// Concrete example
REQUIRED_PROP_ERROR|C_STTA_SalesOrder_WD_20|to_Item|com.sap.vocabularies.UI.v1.LineItem|so_item_pos=Enter an item position
```

**STEP**: 7 — OData V4: Enable Inline and InlineCreationRows via controlConfiguration
**DESCRIPTION**: For OData V4 apps using sap.fe templates, set creationMode in controlConfiguration for a LineItem (table). Options: "Inline" (inline creation), "InlineCreationRows" (empty row mode). Use inlineCreationRowsHiddenInEditMode: true to hide empty row during edit mode until Create is pressed.
**LANGUAGE**: JSON
**CODE**:
```json
// manifest.json: controlConfiguration for a table in OData V4 (object page component)
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "controlConfiguration": {
        "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
          "tableSettings": {
            "creationMode": {
              "name": "Inline" // Inline creation (default)
            }
          }
        }
      }
    }
  }
}
```
```json
// InlineCreationRows with hidden-in-edit option
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "controlConfiguration": {
        "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
          "tableSettings": {
            "creationMode": {
              "name": "InlineCreationRows",
              "inlineCreationRowsHiddenInEditMode": true
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 8 — Define default creation mode globally for V4 macros
**DESCRIPTION**: Set defaultCreationMode under sap.fe.macros.table so all tables default to InlineCreationRows unless overridden in controlConfiguration.
**LANGUAGE**: JSON
**CODE**:
```json
// manifest.json (sap.fe section)
"sap.fe": {
  "macros": {
    "table": {
      "defaultCreationMode": "InlineCreationRows"
    }
  }
}
```

**STEP**: 9 — Display newly created grid-table rows at bottom (createAtEnd)
**DESCRIPTION**: For grid tables, newly created rows are shown at top by default. To append new grid-table rows at the end, set creationMode.createAtEnd = true in controlConfiguration tableSettings.
**LANGUAGE**: JSON
**CODE**:
```json
"controlConfiguration": {
  "@com.sap.vocabularies.UI.v1.LineItem": {
    "tableSettings": {
      "type": "GridTable",
      "personalization": { "column": true, "sort": false },
      "creationMode": {
        "name": "Inline",
        "createAtEnd": true
      }
    }
  }
}
```

**STEP**: 10 — Behavior notes & best practices (concise)
**DESCRIPTION**: Summary of behaviors to consider when implementing:
- Use inline/empty-row modes only for tables with few columns; for complex tables prefer create page.
- Empty row features: hidden row actions, no sorting/grouping for empty rows, responsive tables show empty row at top, grid tables show it at bottom.
- Responsive table hides Create button in empty-row mode; grid table shows Create button (press scrolls to empty row and focuses first editable field).
- Draft conversion timing (V2 creationRows): empty row converts to draft after ~20s unless structural side effect defined or user presses Enter — define SideEffects to force immediate conversion.
- RequiredProperties must be populated before empty row becomes draft; show asterisk if UI.Importance/FieldControl mandates.
- For legacy SAP NetWeaver <=7.51 SP00: inline creation with draft may not apply filters correctly — test on those back ends.
--------------------------------

**TITLE**: Enable lazy loading for custom Object Page sections (Fiori elements, OData V2)

**INTRODUCTION**: This shows how to enable lazy loading for sections you add via view extension points on an SAP Fiori elements Object Page. Applicable only to SAP Fiori elements for OData V2. Add the enableLazyLoading flag to the extension entry in manifest.json so the fragment is loaded lazily.

**TAGS**: sapui5, fiori-elements, object-page, lazy-loading, manifest.json, OData V2, viewExtensions

**STEP**: 1 — Add enableLazyLoading to your fragment extension in manifest.json

**DESCRIPTION**: Edit your application's manifest.json and locate the view extension entry for the Object Page ("sap.suite.ui.generic.template.ObjectPage.view.Details"). Add the sap.ui.generic.app.enableLazyLoading property set to true inside that extension object. Place this entry under sap.ui5 -> extends -> extensions -> sap.ui.viewExtensions. The example below is a minimal, valid context showing where to add the setting.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "AfterFacet|STTA_C_MP_Producttext|ProductTextCollectionFacetID": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "STTA_MP.ext.fragments.ApplicationLogBreakout",
              "type": "XML",
              "sap.ui.generic.app": {
                "title": "{{xtit.applicationLog}}",
                "enableLazyLoading": true
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Validate and follow constraints

**DESCRIPTION**: 
- Only use enableLazyLoading for extensions that can be loaded independently (they must not affect other sections or the object page header).
- This setting applies only to SAP Fiori elements for OData V2.
- Test the page to ensure the fragment loads on demand and that no header data or other sections depend on it.

**LANGUAGE**: Plain text

**CODE**:
```text
Constraints:
- Applicable only to SAP Fiori elements (OData V2).
- Do not enable for sections that impact other sections or the Object Page header.
- Verify fragmentName path and fragment XML are correct and accessible.

References:
- Fiori Design Guidelines: https://experience.sap.com/fiori-design-web/object-page/#structure
- ObjectPageLayout API: https://ui5.sap.com/#/api/sap.uxap.ObjectPageLayout
```

**STEP**: 3 — Example: multiple custom facets

**DESCRIPTION**: If you add multiple AfterFacet entries, add "sap.ui.generic.app.enableLazyLoading": true to each extension entry you want to load lazily.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "AfterFacet|Entity|FacetA": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "my.app.fragments.FacetA",
              "type": "XML",
              "sap.ui.generic.app": { "enableLazyLoading": true }
            },
            "AfterFacet|Entity|FacetB": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "my.app.fragments.FacetB",
              "type": "XML",
              "sap.ui.generic.app": { "enableLazyLoading": true }
            }
          }
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Enable Create-with-Dialog for List Report (SAP Fiori Elements OData V2 and V4)

**INTRODUCTION**: This document shows how to enable creating new entities via a modal dialog on List Report pages. It contains actionable manifest.json snippets for OData V2 and OData V4, multi-view examples, customization keys for dialog title/buttons, and important constraints to include when implementing.

**TAGS**: fiori-elements-framework, manifest.json, list-report, create-dialog, ODataV2, ODataV4, i18n, configuration

STEP: 1 — Enable create dialog for OData V2 (single view list report)

DESCRIPTION: Add a createWithParameterDialog section under the list report page tableSettings in manifest.json. Define up to 8 fields (field name -> path). Place this config under "sap.ui.generic.app" -> "pages" -> "<ViewKey>" -> "component" -> "settings" -> "tableSettings". File: manifest.json.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "pages": {
      "ListReport|STTA_C_SO_SalesOrder_ND": {
        "entitySet": "STTA_C_SO_SalesOrder_ND",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "multiSelect": true,
            "isWorklist": true,
            "tableSettings": {
              "createWithParameterDialog": {
                "fields": {
                  "BusinessPartnerID": { "path": "BusinessPartnerID" },
                  "CurrencyCode":      { "path": "CurrencyCode" },
                  "BillingStatus":     { "path": "BillingStatus" },
                  "DeliveryStatus":    { "path": "DeliveryStatus" },
                  "OpportunityID":     { "path": "OpportunityID" }
                }
              }
            }
          }
        },
        "pages": {
          "...": "..."
        }
      }
    }
  }
}
```

STEP: 2 — Enable create dialog for OData V2 in multi-view (quickVariantSelectionX)

DESCRIPTION: For multi-view list reports, place createWithParameterDialog inside the tableSettings of the specific view (variant) under quickVariantSelectionX. File: manifest.json.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|STTA_C_SO_SalesOrder_ND": {
        "entitySet": "C_STTA_SalesOrder_WD_20",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "quickVariantSelectionX": {
              "showCounts": true,
              "variants": {
                "0": {
                  "key": "_tab1",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Expensive"
                },
                "1": {
                  "key": "_tab2",
                  "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#Cheap",
                  "tableSettings": {
                    "createWithParameterDialog": {
                      "fields": {
                        "bp_id":          { "path": "bp_id" },
                        "currency_code":  { "path": "currency_code" },
                        "op_id":          { "path": "op_id" }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — Important constraints & behavior for OData V2 create dialog

DESCRIPTION: Enforce these rules when configuring the dialog:
- Maximum of 8 data fields in the dialog.
- Properties must exist on the entity (use correct property names/paths).
- Include all mandatory entity fields in the create dialog.
- When dialog creation is enabled, navigation to an object page in create mode is not available; you can navigate to object page in display mode to edit.
- Draft state is NOT maintained for objects created via dialog.
- Prefill dialog fields from filter values is supported (use extension described in Prefilling Fields docs).
- Back-end state messages displayed on Create must include targets for field-level messages; message will be shown on the target field with a red outline.

LANGUAGE: PlainText

CODE:
```text
Constraints:
- Maximum 8 fields in createWithParameterDialog.
- Fields must reference entity properties (use correct "path").
- Include all mandatory entity properties in the dialog.
- No navigation to object page in create mode when dialog is used.
- Draft state not maintained for dialog-created objects.
- Support for prefilling fields from filter values exists (see Prefilling Fields docs).
- Back-end state messages must include targets for field-level errors after Create.
```

STEP: 4 — Customize dialog title and buttons (OData V2)

DESCRIPTION: Default dialog title key: CREATE_DIALOG_TITLE in the page i18n file. Default button labels: "Create" and "Cancel". Change title by redefining CREATE_DIALOG_TITLE in i18n or use the Adaptation Editor. Buttons can be changed in the Adaptation Editor.

LANGUAGE: PlainText

CODE:
```text
i18n key to override:
- CREATE_DIALOG_TITLE = "Your custom dialog title"

Buttons:
- Default labels: Create, Cancel (modify via Adaptation Editor)
```

STEP: 5 — Enable creation dialog for OData V4 (sap.fe ListReport) using creationMode

DESCRIPTION: For SAP Fiori Elements OData V4, use the creationMode setting under the target component options settings -> controlConfiguration -> LineItem -> tableSettings. creationMode.name must be "CreationDialog". creationFields can be a FieldGroup annotation reference or a comma-separated list of property names. Immutable properties are auto-added. File: manifest.json (targets -> <ListTarget> -> options -> settings).

LANGUAGE: JSON

CODE:
```json
{
  "targets": {
    "ProductsList": {
      "type": "Component",
      "name": "sap.fe.templates.ListReport",
      "id": "ProductsList",
      "options": {
        "settings": {
          "contextPath": "/Products",
          "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.LineItem": {
              "tableSettings": {
                "creationMode": {
                  "name": "CreationDialog",
                  "creationFields": "com.sap.vocabularies.UI.v1.FieldGroup#CreationParameters"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 6 — OData V4 multi-view (per-view creation settings)

DESCRIPTION: For multi-view modes in OData V4, supply creationMode parameters in the TableSettings configuration for each line item/view separately, analogous to the single-view example above. Use field group annotation references or comma-separated properties.

LANGUAGE: JSON

CODE:
```json
{
  "targets": {
    "ProductsList": {
      "options": {
        "settings": {
          "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.LineItem#View1": {
              "tableSettings": {
                "creationMode": {
                  "name": "CreationDialog",
                  "creationFields": "PropertyA,PropertyB,PropertyC"
                }
              }
            },
            "@com.sap.vocabularies.UI.v1.LineItem#View2": {
              "tableSettings": {
                "creationMode": {
                  "name": "CreationDialog",
                  "creationFields": "com.sap.vocabularies.UI.v1.FieldGroup#OtherCreationParameters"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 7 — Important constraints & behavior for OData V4 create dialog

DESCRIPTION: Enforce these rules when configuring the OData V4 creation dialog:
- Draft state is NOT maintained when an object is created via the dialog.
- Navigation to object page in create mode is not supported; object page in display mode can be used to edit after creation.
- Navigation properties are not supported as creation fields.
- Mandatory creation parameters are marked with a red asterisk.
- Prefilling fields from filter values is supported (see Prefilling Fields When Creating a New Entity).
- For tree tables and custom create modes, see the Tree Tables documentation (Create Mode and Custom Create Mode section).

LANGUAGE: PlainText

CODE:
```text
Constraints (OData V4):
- Draft state not maintained for dialog-created objects.
- No object-page create-mode navigation when dialog is active.
- Navigation properties are NOT supported in creationFields.
- Mandatory fields get a red asterisk in the UI.
- Support for prefilling values from filters exists.
```

STEP: 8 — Customize dialog title (OData V4)

DESCRIPTION: Use the i18n key C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE in the page i18n file to override the default dialog title "New Object".

LANGUAGE: PlainText

CODE:
```text
i18n key to override (OData V4):
- C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE = "Your custom dialog title"
```
--------------------------------

**TITLE**: Enable Create Dialog on Object Page (OData V4)

**INTRODUCTION**: This guide shows how to enable object creation via a dialog on an Object Page in SAP Fiori elements (OData V4). It includes the exact manifest.json target configuration, examples for creationFields (FieldGroup or comma-separated properties), and how to change the dialog title via i18n.

**TAGS**: fiori-elements-framework, OData V4, manifest.json, create-dialog, object-page, creationMode, i18n

STEP: 1 — Applicability
DESCRIPTION: Confirm that this feature is available only for SAP Fiori elements for OData V4.
LANGUAGE: Text
CODE:
```text
This feature applies only to SAP Fiori elements for OData V4.
```

STEP: 2 — Add creationMode to the Object Page target (FieldGroup example)
DESCRIPTION: Add the creationMode property under the Object Page target in your manifest.json. Set "name" to "CreationDialog" and point creationFields to a FieldGroup annotation (format: <Term>#<FieldGroupId>). Place this snippet in the manifest.json target configuration that defines your Object Page (targets -> <YourObjectPageTarget>).
LANGUAGE: JSON
CODE:
```json
{
  "targets": {
    "ProductsList": {
      "type": "Component",
      "name": "sap.fe.templates.ObjectPage",
      "id": "ProductsObjectPage",
      "options": {
        "settings": {
          "contextPath": "/Products",
          "controlConfiguration": {
            "_suppliers/@com.sap.vocabularies.UI.v1.LineItem": {
              "tableSettings": {
                "creationMode": {
                  "name": "CreationDialog",
                  "creationFields": "com.sap.vocabularies.UI.v1.FieldGroup#CreationParametersSupplier"
                }
              }
            }
          }
          /* ...other settings... */
        }
      }
    }
  }
}
```

STEP: 3 — Use comma-separated properties for creationFields
DESCRIPTION: Instead of a FieldGroup annotation, creationFields can be a comma-separated list of entity properties. Immutable properties are auto-added by the framework and do not need to be listed.
LANGUAGE: JSON
CODE:
```json
{
  "targets": {
    "ProductsList": {
      "options": {
        "settings": {
          "controlConfiguration": {
            "_suppliers/@com.sap.vocabularies.UI.v1.LineItem": {
              "tableSettings": {
                "creationMode": {
                  "name": "CreationDialog",
                  "creationFields": "SupplierID,Name,Country,Email"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — Customize the dialog title via i18n
DESCRIPTION: Override the default dialog title ("New Object") by adding the C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE key to the page i18n file (i18n.properties). The i18n file belongs to the page/component where the Object Page target is defined.
LANGUAGE: properties
CODE:
```properties
# i18n.properties (page-level)
C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE=Create Supplier
```

STEP: 5 — Behavior notes and limitations (implementation considerations)
DESCRIPTION: Key behavior and limitations to implement/testing:
- Users cannot navigate directly to the Object Page in create mode; creation is only available via the dialog.
- Users can navigate to the Object Page in display mode and then edit existing objects.
- Prefilling fields via filter values is supported; see "Prefilling Fields When Creating a New Entity".
- Mandatory properties are indicated with a red asterisk in the create dialog.
- Navigation properties are not supported for the create dialog.
- For related scenarios see:
  - Enabling create dialog in List Report: "Enabling Object Creation Using the Dialog in the List Report"
  - Custom create dialog on Tree Table: "Create Mode and Custom Create Mode with a Menu Button" in Tree Tables
LANGUAGE: Text
CODE:
```text
- No direct navigation to Object Page in create mode; creation via dialog only.
- Display mode navigation remains for object modification.
- Prefilling via filter values supported (see: Prefilling Fields When Creating a New Entity).
- Mandatory fields show a red asterisk.
- Navigation properties are NOT supported in the create dialog.
- Related docs:
  - Enabling Object Creation Using the Dialog in the List Report
  - Tree Tables: Create Mode and Custom Create Mode with a Menu Button
```
--------------------------------

**TITLE**: Enabling Quick Views for Link Navigation (OData V2 & V4)

**INTRODUCTION**: This guide lists the exact annotation and metadata checks required to enable Quick Views (popover content) for link navigation in SAP Fiori Elements apps. Includes OData V2 and V4 examples in XML, ABAP CDS and CAP CDS. Use these annotations to show extra fields (field groups) from the navigation target inside the source entity popover.

**TAGS**: fiori-elements-framework, quick-view, ui.quickviewfacets, annotations, odata-v2, odata-v4, abap-cds, cap-cds, xml

STEP: 1 — Identify the source property annotated as a semantic object
DESCRIPTION: Find the property on the source entity that is annotated with Common.SemanticObject (this property will be rendered as a link / smart link). Use these example annotations to add or verify the semantic object.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation: semantic object by string -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType/Supplier">
   <Annotation Term="Common.SemanticObject" String="EPMProduct"/>
</Annotations>

<!-- XML Annotation (V4 example by string) -->
<Annotations Target="com.c_salesordermanage_sd.ProductSupplier/Supplier">
   <Annotation Term="Common.SemanticObject" String="EPMSupplier"/>
</Annotations>

<!-- XML Annotation (V4 example by path) -->
<Annotations Target="com.c_salesordermanage_sd.ProductSupplier/Supplier">
   <Annotation Term="Common.SemanticObject" Path="SupplierSemanticObject"/>
</Annotations>

<!-- XML Annotation (V4 example using EdmJson expression / If) -->
<Annotations Target="com.c_salesordermanage_sd.ProductSupplier/Supplier">
   <Annotation Term="Common.SemanticObject">
       <If>
          <Eq>
              <Path>SupplierType</Path>
              <Int>2</Int>
          </Eq>
          <String>EPMSupplier</String>
          <String>ERPSupplier</String>
       </If>
    </Annotation>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
/* ABAP CDS: semantic object on a projection/view property */
annotate view STTA_C_MP_PRODUCT with {
  @Consumption.semanticObject: 'EPMProduct'
  supplier;
}

/* ABAP CDS (V4 example) */
annotate view ProductSupplier with {
  @Consumption.semanticObject: 'EPMSupplier'
  Supplier;
}
```
LANGUAGE: CAP CDS
CODE:
```cap
/* CAP CDS (V4 example) */
annotate ProductSupplier with {
  Supplier @Common.SemanticObject: 'EPMSupplier';
}
```

STEP: 2 — Locate the association and referential constraint in service metadata
DESCRIPTION: In the service EDMX/metadata, find the navigation property or Association that references the target entity and has a ReferentialConstraint pointing to the source property (Dependent). This identifies the association end (target entity) where QuickViewFacets must be annotated.
LANGUAGE: XML
CODE:
```xml
<!-- OData V2 Association with ReferentialConstraint (example shows Supplier as Dependent) -->
<Association Name="assoc_2CCAF987BA334B3BD1DF2404F50BC9C5" sap:content-version="1">
    <End Type="STTA_PROD_MAN.STTA_C_MP_ProductType" Multiplicity="1" Role="FromRole_assoc_2CCAF987BA334B3BD1DF2404F50BC9C5"/>
    <End Type="STTA_PROD_MAN.STTA_C_MP_SupplierType" Multiplicity="0..1" Role="ToRole_assoc_2CCAF987BA334B3BD1DF2404F50BC9C5"/>
    <ReferentialConstraint>
        <Principal Role="ToRole_assoc_2CCAF987BA334B3BD1DF2404F50BC9C5">
            <PropertyRef Name="Supplier"/>
        </Principal>
        <Dependent Role="FromRole_assoc_2CCAF987BA334B3BD1DF2404F50BC9C5">
            <PropertyRef Name="Supplier"/>
        </Dependent>
    </ReferentialConstraint>
</Association>

<!-- OData V4: NavigationProperty with inline ReferentialConstraint -->
<NavigationProperty Name="_Supplier" Type="com.c_salesordermanage_sd.I_Supplier">
    <ReferentialConstraint Property="Supplier" ReferencedProperty="Supplier"/>
</NavigationProperty>

<!-- OData V4: Alternative Common.ReferentialConstraint annotation for the navigation property -->
<Annotations Target="com.c_salesordermanage_sd.ProductSupplier/_Supplier">
    <Annotation Term="Common.ReferentialConstraint">
        <Collection>
            <Record>
                <PropertyValue Property="Property" PropertyPath="Supplier"/>
                <PropertyValue Property="ReferencedProperty" PropertyPath="_Supplier/Supplier"/>
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```

STEP: 3 — Annotate UI.QuickViewFacets on the association end (OData V2 example)
DESCRIPTION: On the target entity type (association end type) annotate UI.QuickViewFacets and a UI.FieldGroup qualifier with UI.DataField entries. This creates the quick view content shown in the popover for the link.
LANGUAGE: XML
CODE:
```xml
<!-- QuickViewFacets annotation for Supplier (OData V2 XML) -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType">
    <Annotation Term="UI.QuickViewFacets">
        <Collection>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SupplierQuickViewPOC_FieldGroup_1" />
            </Record>
        </Collection>
    </Annotation>
    <Annotation Term="UI.FieldGroup" Qualifier="SupplierQuickViewPOC_FieldGroup_1">
        <Record>
            <PropertyValue Property="Data">
                <Collection>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Company Name" />
                        <PropertyValue Property="Value" Path="CompanyName"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Supplier" />
                        <PropertyValue Property="Value" Path="Supplier"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Email Address" />
                        <PropertyValue Property="Value" Path="EmailAddress"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
/* ABAP CDS: Quick view field group on supplier view */
annotate view STTA_C_MP_SUPPLIER with {
  @UI.Facet: [
    {
      targetQualifier: 'SupplierQuickViewPOC_FieldGroup_1',
      type: #FIELDGROUP_REFERENCE,
      purpose: #QUICK_VIEW
    }
  ]
  @UI.fieldGroup: [
    {
      label: 'Company Name',
      value: 'COMPANYNAME',
      type: #STANDARD,
      position: 1,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_1'
    }
  ]
  companyname;

  @UI.fieldGroup: [
    {
      label: 'Supplier',
      value: 'SUPPLIER',
      type: #STANDARD,
      position: 2,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_1'
    }
  ]
  supplier;

  @UI.fieldGroup: [
    {
      label: 'Email Address',
      value: 'EMAILADDRESS',
      type: #STANDARD,
      position: 3,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_1'
    }
  ]
  emailaddress;
}
```

STEP: 4 — Define semantic object variants (OData V4) and UI building-blocks notes
DESCRIPTION: You can define Common.SemanticObject as a string, via a path, or using an expression (EdmJson/If). When using UI building blocks (Field), formatters or binding expressions can supply single or multiple semantic objects. Reference the UI macros docs for Field Link with Quick View examples.
LANGUAGE: XML
CODE:
```xml
<!-- String example -->
<Annotations Target="com.c_salesordermanage_sd.ProductSupplier/Supplier">
   <Annotation Term="Common.SemanticObject" String="EPMSupplier"/>
</Annotations>

<!-- Path example -->
<Annotations Target="com.c_salesordermanage_sd.ProductSupplier/Supplier">
   <Annotation Term="Common.SemanticObject" Path="SupplierSemanticObject"/>
</Annotations>

<!-- If/EdmJson expression example -->
<Annotations Target="com.c_salesordermanage_sd.ProductSupplier/Supplier">
   <Annotation Term="Common.SemanticObject">
      <If>
         <Eq>
            <Path>SupplierType</Path>
            <Int>2</Int>
         </Eq>
         <String>EPMSupplier</String>
         <String>ERPSupplier</String>
      </If>
   </Annotation>
</Annotations>
```
DESCRIPTION (additional note): For Field building block behavior and macros see: https://ui5.sap.com/#/api/sap.fe.macros.Field and the test explorer example "Link with Quick View".

STEP: 5 — Define association and foreign-key association (ABAP CDS example)
DESCRIPTION: Create an association to the target entity and mark the foreign key association. This is required so the metadata contains the ReferentialConstraint used for Quick View resolution.
LANGUAGE: ABAP CDS
CODE:
```abap
/* ABAP CDS: define association and foreign-key.association on the source view */
association [1..1] to I_Supplier as _Supplier on $projection.Supplier = _Supplier.Supplier
...
@ObjectModel.foreignKey.association: '_Supplier'
Supplier,
```
LANGUAGE: XML
CODE:
```xml
<!-- Metadata side: NavigationProperty with ReferentialConstraint (V4) -->
<NavigationProperty Name="_Supplier" Type="com.c_salesordermanage_sd.I_Supplier">
    <ReferentialConstraint Property="Supplier" ReferencedProperty="Supplier"/>
</NavigationProperty>
```

STEP: 6 — Annotate UI.QuickViewFacets on the association end type (OData V4 examples)
DESCRIPTION: On the target entity annotate UI.QuickViewFacets and a UI.FieldGroup qualifier. Examples for XML, ABAP CDS and CAP CDS supplied below. Use the FieldGroup qualifier referenced by UI.ReferenceFacet.Target.
LANGUAGE: XML
CODE:
```xml
<!-- V4 XML: QuickViewFacets + FieldGroup -->
<Annotations Target="com.c_salesordermanage_sd.I_Supplier">
  <Annotation Term="UI.QuickViewFacets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Address"/>
        <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SupplierQuickView"/>
      </Record>
    </Collection>
  </Annotation>
  <Annotation Term="UI.FieldGroup" Qualifier="SupplierQuickView">
    <Record Type="UI.FieldGroupType">
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="PostalCode"/>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="CityName"/>
          </Record>
          <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="Country"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
/* V4 ABAP CDS: QuickView facet + field group on I_Supplier */
annotate view I_Supplier with {
  @UI.Facet: [
    {
      label: 'Address',
      targetQualifier: 'SupplierQuickView',
      type: #FIELDGROUP_REFERENCE,
      purpose: #QUICK_VIEW
    }
  ]
  @UI.fieldGroup: [
    { value: 'PostalCode', type: #STANDARD, position: 1, qualifier: 'SupplierQuickView' }
  ]
  PostalCode;

  @UI.fieldGroup: [
    { value: 'CityName', type: #STANDARD, position: 2, qualifier: 'SupplierQuickView' }
  ]
  CityName;

  @UI.fieldGroup: [
    { value: 'Country', type: #STANDARD, position: 3, qualifier: 'SupplierQuickView' }
  ]
  Country;
}
```
LANGUAGE: CAP CDS
CODE:
```cap
/* V4 CAP CDS: QuickViewFacets and FieldGroup (I_Supplier) */
annotate schema.I_Supplier with @(UI : {
  QuickViewFacets : [
    {
      $Type  : 'UI.ReferenceFacet',
      Label  : 'Address',
      Target : '@UI.FieldGroup#SupplierQuickView'
    }
  ],
  FieldGroup #SupplierQuickView: { Data : [
    { $Type : 'UI.DataField', Value : PostalCode },
    { $Type : 'UI.DataField', Value : CityName },
    { $Type : 'UI.DataField', Value : Country }
  ]}
})
```

STEP: 7 — Quick View when target property is a semantic key or entity key (V4 semantic key flow)
DESCRIPTION: For source properties where the target property is a semantic key or an entity key, define an association on the source that references the target key/semantic key, annotate the target with QuickViewFacets, and add a DataField referencing the navigation property in UI.LineItem/FieldGroup/Identification.
LANGUAGE: CAP CDS
CODE:
```cap
/* 1) Source entity: association with SemanticObject on the navigation property */
entity ProductSupplier {
  CustomerReference: String;
  _NavigationProperty: Association to Customer
      on _NavigationProperty.Customer = CustomerReference @(Common : {
           SemanticObject : 'Customer'
      });
}

/* 2) Target entity: declare semantic key or entity key and fields */
annotate Customer with @(Common : {
  SemanticKey : [CustomerName]
}) {
  key Customer: String;
  CustomerName: String;
}

/* 3) Target entity: QuickViewFacets and FieldGroup for SoldToQuickView */
annotate schema.Customer with @(UI : {
  QuickViewFacets : [
    {
      $Type  : 'UI.ReferenceFacet',
      Label  : 'Address',
      Target : '@UI.FieldGroup#SoldToQuickView'
    }
  ],
  FieldGroup #SoldToQuickView: { Data : [
    { $Type : 'UI.DataField', Value : PostalCode },
    { $Type : 'UI.DataField', Value : CityName },
    { $Type : 'UI.DataField', Value : Country }
  ]}
})
```
LANGUAGE: XML
CODE:
```xml
<!-- V4 XML: QuickView facets on Customer (example) -->
<Annotations Target="com.c_salesordermanage_sd.Customer">
  <Annotation Term="UI.QuickViewFacets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="Address"/>
        <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SoldToQuickView"/>
      </Record>
    </Collection>
  </Annotation>
  <Annotation Term="UI.FieldGroup" Qualifier="SoldToQuickView">
    <Record Type="UI.FieldGroupType">
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="UI.DataField"><PropertyValue Property="Value" Path="PostalCode"/></Record>
          <Record Type="UI.DataField"><PropertyValue Property="Value" Path="CityName"/></Record>
          <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Country"/></Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```
LANGUAGE: ABAP CDS
CODE:
```abap
/* V4 ABAP CDS: annotate CUSTOMER view for SoldToQuickView */
annotate view CUSTOMER with {
  @UI.Facet: [
    {
      label: 'Address',
      targetQualifier: 'SoldToQuickView',
      type: #FIELDGROUP_REFERENCE,
      purpose: #QUICK_VIEW
    }
  ]
  @UI.fieldGroup: [{ value: 'POSTALCODE', type: #STANDARD, position: 1, qualifier: 'SoldToQuickView' }]
  postalcode;

  @UI.fieldGroup: [{ value: 'CITYNAME', type: #STANDARD, position: 2, qualifier: 'SoldToQuickView' }]
  cityname;

  @UI.fieldGroup: [{ value: 'COUNTRY', type: #STANDARD, position: 3, qualifier: 'SoldToQuickView' }]
  country;
}

/* 4) UI: Add a DataField that references the navigation property in UI.LineItem / UI.FieldGroup / UI.Identification */
<!-- Example XML snippet used inside UI.LineItem or UI.FieldGroup -->
<Record Type="UI.DataField">
    <PropertyValue Property="Value" Path="_NavigationProperty/Customer" />
</Record>
```

STEP: 8 — Results, constraints and references
DESCRIPTION: After annotation:
- The quick view popover will include the title area and the annotated field group content from the target entity.  
- V2 constraint: QuickViewFacets can only be annotated for entity types that are in the same service (referential constraints only exist for same-service entity types).  
- If navigation to the target application is not allowed for the user, no link will be displayed.  
- Example output images referenced in original docs: images/Quick_View_3c33cc2.png and images/Quick_View_for_Smart_Link_Navigation_c61cade.png
LANGUAGE: None
CODE:
```text
For more configuration details and system behavior see:
- Configuring the Content of Quick Views: configuring-the-content-of-quick-views-c245ad7.md
- UI Field macro docs and examples: https://ui5.sap.com/#/api/sap.fe.macros.Field
- Test explorer example: Building Blocks - Field - Links - Link with Quick View
```

--------------------------------

**TITLE**: Enabling Semantic Date Operators in the Filter Bar (Fiori Elements V2 & V4)

**INTRODUCTION**: This guide shows how to enable and configure semantic date operators (for example: TODAY, LASTWEEK, THISMONTH) in the Filter Bar of Fiori Elements List Report and Analytical List Page apps. It covers OData V2 (useDateRange + dateSettings) and OData V4 (FilterRestrictions + operatorConfiguration / defaultValues) configurations in metadata, manifest.json, and CDS/CAP annotations. Use these examples to programmatically enable, restrict, customize, or set defaults for semantic date filters.

**TAGS**: fiori-elements, filter-bar, semantic-dates, manifest.json, odata-v2, odata-v4, CDS, CAP, annotations

STEP: OData V2 — Ensure metadata allows interval filtering
DESCRIPTION: Add sap:filter-restriction="interval" to the EDMX property so the field can be rendered as a semantic date range (instead of a plain date picker).
LANGUAGE: XML
CODE:
```XML
<!-- EDMX property enabling interval/semantic date ranges -->
<Property Name="DeliveryDate" Type="Edm.DateTime" sap:label="Delivery Date" Precision="0" sap:display-format="Date" sap:filter-restriction="interval" />
```

STEP: OData V2 — (CDS) Mark property as interval in ABAP CDS
DESCRIPTION: In ABAP CDS, mark a field as interval-selection so it is eligible for semantic date ranges.
LANGUAGE: CDS
CODE:
```CDS
@Consumption.filter.selectionType: #INTERVAL
entity MyEntity {
  DeliveryDate : Date;
  ...
}
```

STEP: OData V2 — Enable semantic date ranges globally (manifest.json)
DESCRIPTION: Enable the semantic date range control for all date fields by setting useDateRange: true. Default is false (date picker).
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|SEPMRA_C_PD_Product": {
        "component": {
          "settings": {
            "filterSettings": {
              "dateSettings": {
                "useDateRange": true
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Override date range options per field (selectedValues / exclude)
DESCRIPTION: Configure which semantic date types to include or exclude per field using selectedValues (comma-separated keys). exclude defaults to true (values listed are excluded). Field-level settings override dateSettings defaults.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|YourEntitySet": {
        "component": {
          "settings": {
            "filterSettings": {
              "dateSettings": {
                "useDateRange": true,
                "fields": {
                  "DateProperty1": {
                    "selectedValues": "TOMORROW,NEXT,LASTYEAR,LAST2WEEKS,LAST3WEEKS,LAST4WEEKS,YEARTODATE,QUARTER1,QUARTER2,QUARTER3,QUARTER4",
                    "exclude": true
                  },
                  "DateProperty2": {
                    "customDateRangeImplementation": "SomeNamespace.ext.controller.customDateRangeType",
                    "selectedValues": "FROM,TO,DAYS,WEEK,MONTH,DATERANGE,TODAY,TOMORROW,YEAR,YESTERDAY",
                    "exclude": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Default-level dateSettings and fallback behavior
DESCRIPTION: Use top-level dateSettings.selectedValues to define defaults for all date fields. If a property has no dateSettings or selectedValues and useDateRange is not set, the date picker is used instead of semantic ranges.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|YourEntitySet": {
        "component": {
          "settings": {
            "filterSettings": {
              "dateSettings": {
                "selectedValues": "DAYS,WEEK,MONTH,DATERANGE",
                "fields": {
                  "DateProperty3": {
                    "selectedValues": "YESTERDAY",
                    "exclude": false
                  },
                  "DateTimeProperty1": {
                    "selectedValues": "MONTH",
                    "exclude": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Use customDateRangeImplementation to control the list of operators
DESCRIPTION: Set customDateRangeImplementation to reference a JavaScript class that can remove or add date range values dynamically. This setting takes precedence over selectedValues/exclude.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|YourEntitySet": {
        "component": {
          "settings": {
            "filterSettings": {
              "dateSettings": {
                "fields": {
                  "DateProperty2": {
                    "customDateRangeImplementation": "SomeNamespace.ext.controller.customDateRangeType"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Exclude specific date keys using filter config (per-field)
DESCRIPTION: Use filter entries (path/equals/exclude) to include/exclude specific keys, or to apply complex conditions. This configuration is passed directly to the SmartFilterBar.
LANGUAGE: JSON
CODE:
```JSON
{
  "filterSettings": {
    "dateSettings": {
      "useDateRange": true,
      "fields": {
        "PostingDate": {
          "filter": [
            {
              "path": "key",
              "equals": "TODAY",
              "exclude": true
            }
          ]
        }
      }
    }
  }
}
```

STEP: OData V2 — Exclude all keys in a category (category-based filter)
DESCRIPTION: Use filter.path = "category" with contains and exclude to remove all keys in a category (e.g., FIXED or DYNAMIC).
LANGUAGE: JSON
CODE:
```JSON
{
  "filterSettings": {
    "dateSettings": {
      "fields": {
        "AnyDateField": {
          "filter": [
            {
              "path": "category",
              "contains": "FIXED",
              "exclude": true
            }
          ]
        }
      }
    }
  }
}
```

STEP: OData V2 — Set default semantic date value per field
DESCRIPTION: Define defaultValue.operation for a semantic date field under filterSettings.dateSettings.fields. The operator must be present in the allowed list for that field (do not use excluded operators as default).
LANGUAGE: JSON
CODE:
```JSON
{
  "filterSettings": {
    "dateSettings": {
      "fields": {
        "CreatedDate": {
          "defaultValue": {
            "operation": "TOMORROW"
          }
        },
        "DeliveryDate": {
          "defaultValue": {
            "operation": "TOMORROW"
          },
          "filter": [
            {
              "path": "key",
              "equals": "TODAY",
              "exclude": true
            }
          ]
        }
      }
    }
  }
}
```

STEP: OData V4 — Semantic operators enabled by default (requirements)
DESCRIPTION: Semantic operators are enabled automatically for:
- Edm.Date fields with FilterRestrictions.AllowedExpressions = SingleRange or SingleValue.
- Edm.DateTimeOffset fields with FilterRestrictions.AllowedExpressions = SingleRange.
If not set, add FilterRestrictions.FilterExpressionRestrictions for the property.
LANGUAGE: XML
CODE:
```XML
<!-- XML annotation: set AllowedExpressions = SingleRange for property "myDate" -->
<edmx:Reference Uri="https://oasis-tcs.github.io/odata-vocabularies/vocabularies/Org.OData.Capabilities.V1.xml">
  <edmx:Include Namespace="Org.OData.Capabilities.V1" Alias="Capabilities" />
</edmx:Reference>

<Annotations Target="com.c_salesordermanage_sd.EntityContainer/SalesOrderManage">
  <Annotation Term="Capabilities.FilterRestrictions">
    <Record Type="Capabilities.FilterRestrictionsType">
      <PropertyValue Property="FilterExpressionRestrictions">
        <Collection>
          <Record Type="Capabilities.FilterExpressionRestrictionType">
            <PropertyValue Property="Property" PropertyPath="myDate" />
            <PropertyValue Property="AllowedExpressions" String="SingleRange" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: OData V4 — CAP CDS sample to set SingleRange FilterRestrictions
DESCRIPTION: For CAP-based services, annotate the CDS model to set AllowedExpressions = 'SingleRange'.
LANGUAGE: CDS
CODE:
```CDS
@Capabilities: {
  FilterRestrictions: {
    FilterExpressionRestrictions: [
      {
        Property: 'myDate',
        AllowedExpressions: 'SingleRange'
      }
    ]
  }
}
entity MyEntity {
  myDate : Date;
}
```

STEP: OData V4 — Set manifest defaultValues for a semantic date filter
DESCRIPTION: Use controlConfiguration -> @com.sap.vocabularies.UI.v1.SelectionFields -> filterFields -> <field> -> settings.defaultValues to set manifest-based default operators (these override SelectionVariant defaults). Use "operator" or "operator" + "values" for parameterized operators.
LANGUAGE: JSON
CODE:
```JSON
{
  "settings": {
    "controlConfiguration": {
      "@com.sap.vocabularies.UI.v1.SelectionFields": {
        "filterFields": {
          "SalesOrderDate": {
            "settings": {
              "defaultValues": [
                { "operator": "YESTERDAY" }
              ]
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V4 — Parameterized defaultValues (operators requiring values)
DESCRIPTION: Examples for manifest defaultValues for operators that require values. Date format for DATE/FROM/TO/DATERANGE is YYYY-MM-DD. TODAYFROMTO values are [daysBefore, daysAfter]. SPECIFICMONTH uses zero-based month (January = 0).
LANGUAGE: JSON
CODE:
```JSON
{
  "@com.sap.vocabularies.UI.v1.SelectionFields": {
    "filterFields": {
      "SalesOrderDate_DATE": {
        "settings": {
          "defaultValues": [
            { "operator": "DATE", "values": ["2018-12-28"] }
          ]
        }
      },
      "SalesOrderDate_FROM": {
        "settings": {
          "defaultValues": [
            { "operator": "FROM", "values": ["2018-11-28"] }
          ]
        }
      },
      "SalesOrderDate_TO": {
        "settings": {
          "defaultValues": [
            { "operator": "TO", "values": ["2019-11-02"] }
          ]
        }
      },
      "SalesOrderDate_DATERANGE": {
        "settings": {
          "defaultValues": [
            { "operator": "DATERANGE", "values": ["2019-11-02", "2022-01-01"] }
          ]
        }
      },
      "SalesOrderDate_TODAYFROMTO": {
        "settings": {
          "defaultValues": [
            { "operator": "TODAYFROMTO", "values": [5, 6] }
          ]
        }
      },
      "SalesOrderDate_LASTDAYS": {
        "settings": {
          "defaultValues": [
            { "operator": "LASTDAYS", "values": [6] }
          ]
        }
      },
      "SalesOrderDate_SPECIFICMONTH": {
        "settings": {
          "defaultValues": [
            { "operator": "SPECIFICMONTH", "values": [0] } /* January = 0 */
          ]
        }
      }
    }
  }
}
```

STEP: OData V4 — Use navigation property field names in manifest defaults
DESCRIPTION: If the semantic filter field is from a navigation entity set, use "<navigationProperty>::<filterField>" as the key in filterFields.
LANGUAGE: JSON
CODE:
```JSON
{
  "@com.sap.vocabularies.UI.v1.SelectionFields": {
    "filterFields": {
      "_Item::SalesOrderDate": {
        "settings": {
          "defaultValues": [
            { "operator": "SPECIFICMONTH", "values": [1] }
          ]
        }
      }
    }
  }
}
```

STEP: OData V4 — Exclude specific operators (operatorConfiguration)
DESCRIPTION: Use operatorConfiguration (path/equals/exclude) in filterFields.<field>.settings to include/exclude specific operator keys. customDateRangeImplementation (if present) has highest priority, then operatorConfiguration, then selectedValues.
LANGUAGE: JSON
CODE:
```JSON
{
  "filterFields": {
    "SalesOrderDate": {
      "settings": {
        "operatorConfiguration": [
          { "path": "key", "equals": "TODAY", "exclude": true }
        ]
      }
    }
  }
}
```

STEP: OData V4 — Include TODAY and exclude TODAYFROMTO (operatorConfiguration example)
DESCRIPTION: Example that explicitly includes TODAY (exclude=false) but excludes the TODAYFROMTO variant.
LANGUAGE: JSON
CODE:
```JSON
{
  "filterFields": {
    "SalesOrderDate": {
      "settings": {
        "operatorConfiguration": [
          { "path": "key", "equals": "TODAY", "exclude": false },
          { "path": "key", "equals": "TODAYFROMTO", "exclude": true }
        ]
      }
    }
  }
}
```

STEP: OData V4 — Supported operator names for exclusion/inclusion
DESCRIPTION: Use these keys inside operatorConfiguration/filter/selectedValues. Excluding is allowed only for SingleRange-based Date fields.
LANGUAGE: JSON
CODE:
```JSON
/* Example list (use exact keys in operatorConfiguration or selectedValues):
"DATE","FROM","TO","DATERANGE","TODAY","YESTERDAY","TOMORROW","TODAYFROMTO",
"LASTDAYS","NEXTDAYS","THISWEEK","LASTWEEK","LASTWEEKS","NEXTWEEK","NEXTWEEKS",
"SPECIFICMONTH","THISMONTH","LASTMONTH","LASTMONTHS","NEXTMONTH","NEXTMONTHS",
"THISQUARTER","LASTQUARTER","LASTQUARTERS","NEXTQUARTER","NEXTQUARTERS",
"QUARTER1","QUARTER2","QUARTER3","QUARTER4","THISYEAR","LASTYEAR","LASTYEARS",
"NEXTYEAR","NEXTYEARS","YEARTODATE","DATETOYEAR","Empty"
*/
```

STEP: OData V4 — Enable additional FROM/TO combined operators (not enabled by default)
DESCRIPTION: To enable additional operators (FROMTODAY, TOTODAY, etc.), add operatorConfiguration entries with exclude: false (they are excluded by default).
LANGUAGE: JSON
CODE:
```JSON
{
  "targets": {
    "SalesOrderManageList": {
      "options": {
        "settings": {
          "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.SelectionFields": {
              "filterFields": {
                "SalesOrderDate": {
                  "settings": {
                    "operatorConfiguration": [
                      { "path": "key", "equals": "FROMTODAY", "exclude": false },
                      { "path": "key", "equals": "TOYESTERDAY", "exclude": false }
                    ]
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Notes, constraints and best practices
DESCRIPTION: Key points to observe when implementing:
- customDateRangeImplementation > operatorConfiguration/filter/selectedValues precedence.
- exclude defaults to true (V2/V4 behavior differs by configuration surface).
- Default values defined in manifest override SelectionVariant defaults for semantic date fields (V4). Manifest defaults are ignored if an app state, URL, or navigation context provides a value.
- Do not provide numeric literal ranges as defaultValues (e.g., don't use FROM(val1) / TO(val2) numeric syntax); use operator + values as shown above.
- For navigation fields, always use "<navigationProperty>::<propertyName>".
- Semantic date operators are not available for Filter Bar building block in some cases, nor as filters inside table/chart on object pages.
LANGUAGE: JSON
CODE:
```JSON
/* Constraints summary (no code):
- customDateRangeImplementation has highest precedence.
- For Edm.DateTime (not Date/DateTimeOffset), some default/operator features are not available.
- When excluding operators for navigation-based fields, use "<navProp>::<propName>" as key.
*/
```

STEP: More information / related files
DESCRIPTION: Reference pages and related docs (use when implementing or extending):
LANGUAGE: text
CODE:
```text
- Adapting the Filter Bar: adapting-the-filter-bar-609c39a.md
- Adding Custom Fields to the Filter Bar: adding-custom-fields-to-the-filter-bar-5fb9f57.md
- Extending Bookmark Function for Launchpad Tiles: extending-the-bookmark-function-to-save-static-tiles-to-the-sap-fiori-launchpad-7e34ea9.md
```
--------------------------------

**TITLE**: Enabling Simple Header Facets in manifest.json for SAP Fiori elements (OData V2)

**INTRODUCTION**: This guide shows where and how to enable the simple header facet on an Object Page in a SAP Fiori elements app (OData V2) by adding the simpleHeaderFacets flag to webapp/manifest.json. Includes a ready-to-use manifest snippet and notes about limitations and post-change steps.

**TAGS**: fiori-elements-framework, OData-V2, manifest.json, ObjectPage, header, simpleHeaderFacets

STEP: 1 — Confirm applicability and file location

DESCRIPTION: Verify this change is applicable (SAP Fiori elements using OData V2) and open the application's manifest.json (typically at webapp/manifest.json) before editing.

LANGUAGE: JSON

CODE:
```JSON
{
  "manifestPath": "webapp/manifest.json",
  "appType": "SAP Fiori elements",
  "odataVersion": "V2"
}
```

STEP: 2 — Add simpleHeaderFacets:true to the ObjectPage component settings

DESCRIPTION: Edit webapp/manifest.json and add "simpleHeaderFacets": true under the target ObjectPage component's settings. The example below is a complete sap.ui.generic.app section showing a ListReport -> ObjectPage structure with simpleHeaderFacets enabled. Use this snippet to replace or merge into your existing sap.ui.generic.app/pages structure. Ensure JSON validity (no trailing commas).

LANGUAGE: JSON

CODE:
```JSON
{
  "sap.ui.generic.app": {
    "_version": "1.2.0",
    "pages": [
      {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "gridTable": false,
            "multiSelect": true,
            "smartVariantManagement": true
          }
        },
        "pages": [
          {
            "entitySet": "STTA_C_MP_Product",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "showRelatedApps": true,
                "gridTable": false,
                "editableHeaderContent": true,
                "simpleHeaderFacets": true
              }
            },
            "pages": [
              {
                "navigationProperty": "to_ProductText",
                "entitySet": "STTA_C_MP_ProductText",
                "component": {
                  "name": "sap.suite.ui.generic.template.ObjectPage"
                }
              }
            ]
          }
        ]
      }
    ]
  }
}
```

STEP: 3 — Limitations and post-change steps

DESCRIPTION: Understand limitations (what is not supported) and follow the recommended steps after editing manifest.json to apply changes.

LANGUAGE: JSON

CODE:
```JSON
{
  "limitations": [
    "Applicable only to SAP Fiori elements for OData V2.",
    "simpleHeaderFacets does NOT support complex DataField annotations or DataFieldForAnnotation (e.g., ratings, progress indicators, charts)."
  ],
  "postChangeActions": [
    "Save webapp/manifest.json",
    "Rebuild and redeploy the application",
    "Clear browser cache and perform a hard reload to see the updated header facets"
  ]
}
```
--------------------------------

**TITLE**: Enable Standard and Object List Items (SAP Fiori elements for OData V2)

**INTRODUCTION**: Configure UI.LineItem annotations and manifest.json to render StandardList and ObjectList items in a List Report (SAP Fiori elements, OData V2). Includes sample XML annotations (DataField / DataFieldForAnnotation + DataPoint) and the required manifest.json page configuration. Use these snippets directly in your service annotations and app manifest. Note: UI.LineItem must contain only UI.DataField and UI.DataFieldForAnnotation elements.

**TAGS**: fiori-elements-framework, ODataV2, UI.LineItem, DataField, DataFieldForAnnotation, DataPoint, manifest.json, StandardList, ObjectList

**STEP**: 1 — Standard List Item: UI.LineItem annotation (XML)

**DESCRIPTION**: Add a UI.LineItem annotation to the entity type or entity set annotations. Use UI.DataField for left-side content (title, description, image) and UI.DataFieldForAnnotation with AnnotationPath targeting a UI.DataPoint for right-side content (info + color). Example shows a Price DataPoint with Criticality.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotation Term="UI.LineItem">
  <Collection>
    <!-- Title: high importance -->
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="ProductForEdit" />
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
    </Record>

    <!-- Description: medium importance -->
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="ProductCategory" />
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Medium" />
    </Record>

    <!-- Image (marked with UI.IsImageURL on the property in the CDS/metadata) -->
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="ProductPictureURL" />
      <!-- UI.IsImageURL should be defined on the property in the OData metadata/annotations -->
    </Record>

    <!-- Right-side info uses a DataPoint (Price) -->
    <Record Type="UI.DataFieldForAnnotation">
      <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Price" />
    </Record>
  </Collection>
</Annotation>

<!-- DataPoint definition referenced above -->
<Annotation Term="UI.DataPoint" Qualifier="Price">
  <Record>
    <PropertyValue Property="Value" Path="Price" />
    <PropertyValue Property="Criticality" Path="PriceCriticality" />
  </Record>
</Annotation>
```

**STEP**: 2 — Standard List Item: manifest.json page configuration

**DESCRIPTION**: In your app's webapp/manifest.json, configure the List Report page for the entity set to use the StandardList tableSettings.type. Update the page ID and entitySet to match your app.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ui5": {
    "models": { /* ... */ }
  },
  "sap.app": { /* ... */ },
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "settings": {
            "isWorklist": true,
            "tableSettings": {
              "type": "StandardList"
            },
            "smartVariantManagement": false
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Standard List Item: field → UI mapping rules

**DESCRIPTION**: Use these rules to map UI.LineItem entries to the StandardList UI positions. Implement DataField and DataPoint entries accordingly.

**LANGUAGE**: PlainText

**CODE**:
```PlainText
Standard List Item mapping:
- title: First data field of UI.LineItem -> Top left
- description: Second data field of UI.LineItem -> Bottom left
- info: First data point (UI.DataPoint) -> Top right
  - If no data point exists, the third data field is used instead.
- infoState (color): First data point's Criticality or a CriticalityCalculation -> Color; default None if absent
- icon: First data field annotated with UI.IsImageURL (order not important)
Notes:
- Data fields are ordered by importance; default importance is Medium if not set.
- Data points are used irrespective of importance if present.
- UI.LineItem must contain only UI.DataField and UI.DataFieldForAnnotation elements.
```

**STEP**: 4 — Object List Item: UI.LineItem annotation (XML)

**DESCRIPTION**: Add a UI.LineItem annotation to render an ObjectList item. Use UI.DataField for attributes and UI.DataFieldForAnnotation targeting UI.DataPoint qualifiers for number and status fields. Example includes NetAmount/GrossAmount/TaxAmount DataPoints with Criticality.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotation Term="UI.LineItem">
  <Collection>
    <!-- Title (high importance) -->
    <Record Type="UI.DataField">
      <PropertyValue Property="Label" String="Sales Order ID" />
      <PropertyValue Property="Value" Path="SalesOrderID" />
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
    </Record>

    <!-- First ObjectAttribute (middle left) -->
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="BusinessPartnerID" />
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Medium" />
    </Record>

    <!-- Third data field (bottom left) -->
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="CurrencyCode" />
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Low" />
    </Record>

    <!-- Number (top right) -> DataPoint NetAmount -->
    <Record Type="UI.DataFieldForAnnotation">
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
      <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#NetAmount" />
    </Record>

    <!-- Second number/status (middle right) -> DataPoint GrossAmount -->
    <Record Type="UI.DataFieldForAnnotation">
      <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#GrossAmount" />
    </Record>

    <!-- Third status (bottom right) -> DataPoint TaxAmount -->
    <Record Type="UI.DataFieldForAnnotation">
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Low" />
      <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#TaxAmount" />
    </Record>
  </Collection>
</Annotation>

<!-- DataPoints referenced above -->
<Annotation Term="UI.DataPoint" Qualifier="NetAmount">
  <Record>
    <PropertyValue Property="Value" Path="NetAmount" />
    <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Positive" />
  </Record>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="GrossAmount">
  <Record>
    <PropertyValue Property="Value" Path="GrossAmount" />
    <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Negative" />
  </Record>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="TaxAmount">
  <Record>
    <PropertyValue Property="Value" Path="TaxAmount" />
    <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.CriticalityType/Critical" />
  </Record>
</Annotation>
```

**STEP**: 5 — Object List Item: manifest.json page configuration

**DESCRIPTION**: In webapp/manifest.json, set the List Report page tableSettings.type to "ObjectList" for the target entity set.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "settings": {
            "isWorklist": true,
            "tableSettings": {
              "type": "ObjectList"
            },
            "smartVariantManagement": false
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — Object List Item: field → UI mapping rules

**DESCRIPTION**: Use these rules to map UI.LineItem entries to the ObjectList UI positions. Implement DataField and DataPoint entries accordingly.

**LANGUAGE**: PlainText

**CODE**:
```PlainText
Object List Item mapping:
- title: First data field of UI.LineItem -> Top left
- first ObjectAttribute (attributes aggregation): Second data field -> Middle left
- number: First data point -> Top right
  - If no data point exists, the next data field (third) is used.
- numberState (color): First data point's Criticality or CriticalityCalculation -> Color; default None if absent
- firstStatus: Second data point -> Middle right
  - If absent, next available data field is used (third or fourth depending on provided data)
- second ObjectAttribute: Third data field -> Bottom left
  - If third data field already used, next available data field is used (4th or 5th)
- secondStatus: Third data point -> Bottom right
  - If absent, next available data field is used (4th/5th/6th depending on provided data)
Notes:
- Data points take precedence over data fields for right-side slots.
- Default importance: Medium when UI.Importance not defined.
- UI.LineItem must contain only UI.DataField and UI.DataFieldForAnnotation elements.
```
--------------------------------

**TITLE**: Enabling Stream Support (SAP Fiori elements — OData V2 & V4)

**INTRODUCTION**: This document provides actionable, code-focused instructions and complete annotation examples to enable stream (file/image) upload, download, and delete support in SAP Fiori elements applications for OData V2 and OData V4. It summarizes required annotations, UI wiring, media-type restrictions, file-size limits, and examples for using streams as action parameters (XML annotations, CAP CDS, ABAP CDS).

**TAGS**: fiori-elements, odata-v2, odata-v4, stream, edm.stream, media, Core.MediaType, Core.AcceptableMediaTypes, Core.ContentDisposition, UI.IsImage, CAP, ABAP

**STEP**: Security prerequisites and general notes

**DESCRIPTION**: Apply these security and functional prerequisites before enabling stream support. Ensure back-end validation, virus scanning, size limits, and MIME-type restrictions. Security guidance reference included.

**LANGUAGE**: Text

**CODE**:
```
Security checklist (must be implemented):
- Annotate allowed file types: @Core.AcceptableMediaTypes (annotation).
- Define media type mapping: @Core.MediaType (annotation or service response).
- Define content-disposition filename: @Core.ContentDisposition.Filename (annotation).
- Enforce max file size: MaxLength attribute on stream property (bytes).
- Back-end must perform virus scanning, MIME validation, and sanitization.
- Note: odata.mediaEditLink is NOT supported.

Reference: Security Configuration -> security-configuration-ba0484b.md
```

**STEP**: OData V2 — Entity prerequisite (HasStream)

**DESCRIPTION**: For OData V2, the EDM entity must be stream-enabled (m:HasStream="true"). Provide entity definition sample with HasStream and keys (include IsActiveEntity for draft scenarios if required).

**LANGUAGE**: XML

**CODE**:
```xml
<EntityType Name="MyStreamType" m:HasStream="true" sap:label="Stream Test" sap:content-version="1">
  <Key>
    <PropertyRef Name="Streamuuid" />
    <PropertyRef Name="IsActiveEntity" />
  </Key>
  <Property Name="Edit_ac" Type="Edm.Boolean" sap:label="Dyn. Action Control"
            sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false" />
  <!-- Add other properties -->
</EntityType>
```

**STEP**: OData V2 — UI wiring and mandatory annotations

**DESCRIPTION**: Annotate UI.FieldGroup or UI.Identification with a DataField whose Value path is "$value" to render uploader/link. On the entity level, set MediaType, optional UI.IsImage and ContentDisposition for filename display. Restrict allowed types via Core.AcceptableMediaTypes.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- In UI.FieldGroup or UI.Identification -->
<Record Type="UI.DataField">
  <PropertyValue Property="Value" Path="$value"/>
</Record>

<!-- Mandatory: MediaType annotation on the entity (Path or String) -->
<Annotation Term="Org.OData.Core.V1.MediaType" Path="ThisMimeType"></Annotation>

<!-- Optional: render as image (thumbnails) -->
<Annotation Term="UI.IsImage"/>

<!-- Optional: ContentDisposition -> Filename (shows file name in link instead of 'Open File') -->
<Annotation Term="SAP__core.ContentDisposition">
  <Record>
    <PropertyValue Property="Filename" Path="ThisFileName" />
  </Record>
</Annotation>

<!-- Restrict acceptable types for upload -->
<Annotation Term="Core.AcceptableMediaTypes">
  <Collection>
    <String>text/plain</String>
    <!-- Add other allowed MIME types -->
  </Collection>
</Annotation>
```

**STEP**: OData V2 — Behavioral notes

**DESCRIPTION**: Behavior rules for V2 apps regarding edit/display mode, file replacement, and placeholder usage.

**LANGUAGE**: Text

**CODE**:
```
Behavior notes:
- Draft apps: upload/delete only when UI is editable.
- Non-draft apps: upload/delete supported only in display mode.
- Only one file per record; uploading another file replaces the existing one.
- If no file exists, a placeholder is displayed.
- Uploaded file name appears in list/object pages but cannot be edited in table cells.
```

**STEP**: OData V4 — Step 1: Add Edm.Stream properties + media annotations

**DESCRIPTION**: Define Edm.Stream properties on the entity. Add related properties for media type and file name. Use Core.MediaType (Path or String), Core.IsMediaType on the media-type property, MaxLength on stream property to restrict file size, and Core.AcceptableMediaTypes to restrict uploadable MIME types.

**LANGUAGE**: XML

**CODE**:
```xml
<EntityType Name="MainEntities">
  ...
  <Property Name="myStreamProperty" Type="Edm.Stream" />
  <Property Name="myStreamPropertyType" Type="Edm.String" />
  <Property Name="myRestrictedStreamProperty" Type="Edm.Stream" MaxLength="100000"/>
  ...
</EntityType>

<!-- Link media type via Core.MediaType -->
<Annotations Target="sap.fe.stream.StreamsService.MainEntities/myStreamProperty">
  <Annotation Term="Core.MediaType" Path="myStreamPropertyType" />
</Annotations>

<!-- Mark the type property as a media type -->
<Annotations Target="sap.fe.stream.StreamsService.MainEntities/myStreamPropertyType">
  <Annotation Term="Core.IsMediaType" Bool="true" />
</Annotations>

<!-- Restrict media type and acceptable media types on a specific stream property -->
<Annotations Target="sap.fe.stream.StreamsService.MainEntities/myRestrictedStreamProperty">
  <Annotation Term="Core.MediaType" String="text/plain"/>
  <Annotation Term="Core.AcceptableMediaTypes">
    <Collection>
      <String>text/plain</String>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: OData V4 — Step 2: Annotate UI field as DataField for forms/tables

**DESCRIPTION**: Add a UI.FieldGroup containing a UI.DataField that references the stream property (Value Path = stream property). This adds the upload/download UI element in forms (object page) or table cells.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="sap.fe.stream.StreamsService.MainEntities">
  <Annotation Term="UI.FieldGroup" Qualifier="streams">
    <Record Type="UI.FieldGroupType">
      <PropertyValue Property="Label" String="Streams" />
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="UI.DataField">
            <PropertyValue Property="Label" String="Stream" />
            <PropertyValue Property="Value" Path="myStreamProperty" />
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: OData V4 — UI representation rules (icons, link text, avatar)

**DESCRIPTION**: Rules to determine document icon, link text, and avatar rendering. Use these rules to validate service responses and annotations.

**LANGUAGE**: Text

**CODE**:
```
Rendering rules:
- Document icon:
  - If backend returns odata.mediaContentType for the stream property (non-null), Fiori renders a content-type specific icon.
  - If not returned or not mappable, a generic document icon is used.

- Document link text (three cases):
  1) File name shown:
     - Core.ContentDisposition/Filename annotation points to non-empty filename.
     - Stream is not empty (odata.mediaContentType returned != null OR not returned).
  2) Link text "Open File":
     - No Core.ContentDisposition/Filename OR filename empty.
     - Stream is not empty (odata.mediaContentType returned != null OR not returned).
  3) Empty indicator (no link):
     - Stream is empty (odata.mediaContentType returned = null).

- Avatar:
  - Render avatar (image) if UI.IsImage is set OR Core.MediaType starts with 'image/'.
  - To render circular image/person avatar, set Common.IsNaturalPerson at entity or for the UI.IsImage annotation.

- Edit mode:
  - Upload and Delete buttons are available.
  - After upload, if backend returns new odata.mediaContentType, icon/link updates accordingly.
```

**STEP**: OData V4 — XML example: stream property with media type and filename (UI + annotations)

**DESCRIPTION**: Concrete XML annotation example showing Core.MediaType, Core.ContentDisposition (Filename) and label for a stream property with dynamic media type and name.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="sap.fe.streams.StreamsService.MainEntities/streamWithFilename_content">
  <Annotation Term="Core.MediaType" Path="streamWithFilename_type"/>
  <Annotation Term="Core.ContentDisposition">
    <Record Type="Core.ContentDispositionType">
      <PropertyValue Property="Filename" Path="streamWithFilename_name"/>
    </Record>
  </Annotation>
  <Annotation Term="Common.Label" String="Stream, dynamic media type, with name"/>
</Annotations>
```

**STEP**: Action parameters with file upload — XML Annotation example

**DESCRIPTION**: Define an Action that accepts a ComplexType parameter that groups Stream, MimeType, and FileName. Annotate the ComplexType stream property with Core.ContentDisposition.Filename (Path), Core.MediaType (Path/String), and Core.AcceptableMediaTypes. Use MaxLength on stream property to restrict size.

**LANGUAGE**: XML

**CODE**:
```xml
<Action Name="ActionParameterTypeName" IsBound="true">
  <Parameter Name="_it" Type="service.namespace.EntityTypeName" Nullable="false"/>
  <Parameter Name="_StreamProperties" Type="service.namespace.FileStreamTypeName" Nullable="false"/>
</Action>

<ComplexType Name="FileStreamTypeName">
  <Property Name="StreamProperty" Type="Edm.Stream" Nullable="false" MaxLength="128" />
  <Property Name="MimeType" Type="Edm.String" Nullable="false" />
  <Property Name="FileName" Type="Edm.String" Nullable="false" />
</ComplexType>

<Annotations Target="service.namespace.FileStreamTypeName/StreamProperty">
  <Annotation Term="Common.Label" String="Label for File Upload" />
  <Annotation Term="Core.ContentDisposition">
    <Record>
      <PropertyValue Property="Filename" Path="FileName" />
    </Record>
  </Annotation>
  <Annotation Term="Core.MediaType" Path="MimeType" />
  <Annotation Term="Core.AcceptableMediaTypes">
    <Collection>
      <String>image/png</String>
    </Collection>
  </Annotation>
</Annotations>

<Annotations Target="service.namespace.FileStreamTypeName/MimeType">
  <Annotation Term="Core.IsMediaType" />
</Annotations>
```

**STEP**: Action parameters — CAP CDS example

**DESCRIPTION**: CAP CDS type and action declaration for file-upload action parameter with media annotations (@Core.MediaType, @Core.ContentDisposition.Filename, @Core.IsMediaType).

**LANGUAGE**: CDS

**CODE**:
```sql
action ActionParameterTypeName(
  _StreamProperties : service.namespace.FileStreamTypeName not null
) returns EntityTypeName;

type FileStreamTypeName {
  StreamProperty       : LargeBinary @Core.MediaType: MimeType @Core.ContentDisposition.Filename: FileName;
  MimeType             : String @Core.IsMediaType;
  FileName             : String;
};
```

**STEP**: Action parameters — ABAP CDS example

**DESCRIPTION**: ABAP CDS pattern to model a file-stream complex type and an action parameter that links to it. Includes large object semantics annotations for mimeType and fileName.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
// ==== FILE_STREAM_TYPE_NAME ==== //
// == CDS View for FILE_STREAM_TYPE_NAME
define root abstract entity FILE_STREAM_TYPE_NAME
{
  @Semantics.largeObject.mimeType: 'mimetype'
  @Semantics.largeObject.fileName: 'filename'
  @Semantics.largeObject.contentDispositionPreference: #INLINE
  streamproperty : abap.rawstring(0);

  @UI.hidden: true
  mimetype : abap.char(128);

  @UI.hidden: true
  filename : abap.char(128);
}

// == Behavior Definitions for FILE_STREAM_TYPE_NAME
abstract;
strict;
with hierarchy;
define behavior for FILE_STREAM_TYPE_NAME {}

// ==== ACTION_PARAMETER_TYPE_NAME ==== //
// == CDS View for ACTION_PARAMETER_TYPE_NAME
define root abstract entity ACTION_PARAMETER_TYPE_NAME
{
  _StreamProperties : association [1] to FILE_STREAM_TYPE_NAME on 1 = 1;
}

// == Behavior Definitions for ACTION_PARAMETER_TYPE_NAME
abstract;
strict;
with hierarchy;
define behavior for ACTION_PARAMETER_TYPE_NAME
{
  association _StreamProperties with hierarchy;
}
```

**STEP**: Additional references and notes

**DESCRIPTION**: Useful notes and external reference for CAP guidance on media elements.

**LANGUAGE**: Text

**CODE**:
```
Notes:
- To restrict file size use MaxLength on the Edm.Stream property (value in bytes).
- Use Core.AcceptableMediaTypes to limit uploadable MIME types.
- The backend must set odata.mediaContentType appropriately (nullable) to indicate empty/non-empty streams.
- The odata.mediaEditLink annotation is not supported.

Related guidance:
- CAP media elements: https://cap.cloud.sap/docs/guides/providing-services#annotating-media-elements
- Actions documentation: Actions (actions-cbf16c5.md)
```
--------------------------------

**TITLE**: Enable sub-object creation through a dialog on a non-draft Object Page (OData V2)

**INTRODUCTION**: This guide shows how to enable creation of related (sub-) objects via a dialog on a non-draft Object Page in SAP Fiori elements (OData V2). It includes actionable manifest.json configuration to add the create dialog for a related entity set (maximum 8 fields) and how to override the default dialog title and toast message via i18n.

**TAGS**: fiori-elements-framework, OData V2, manifest.json, object-page, create-dialog, non-draft, i18n

**STEP**: 1 — Add createWithParameterDialog to the Object Page related section in manifest.json

**DESCRIPTION**: Add the createWithParameterDialog property to the related section (table) settings of the Object Page in webapp/manifest.json. Map up to 8 fields from the related entity by specifying field keys and their paths. Ensure:
- Application is non-draft (this feature applies only to non-draft apps).
- The related property names match the related entity properties.
- All mandatory fields for creating the related entity are included in the dialog fields list.

Place this snippet in webapp/manifest.json where your pages / object page configuration exists (adapt entitySet names, navigationProperty, and field paths to your metadata).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "pages": [
    {
      "entitySet": "STTA_C_SO_SalesOrder_ND",
      "component": {
        "name": "sap.suite.ui.generic.template.ObjectPage",
        "settings": {
          "showRelatedApps": true,
          "gridTable": false,
          "sections": {
            "to_Item::com.sap.vocabularies.UI.v1.LineItem": {
              "navigationProperty": "to_Item",
              "entitySet": "STTA_C_SO_SalesOrderItem_ND",
              "tableSettings": {
                "createWithParameterDialog": {
                  "fields": {
                    "SalesOrderItemID": { "path": "SalesOrderItemID" },
                    "ProductID": { "path": "ProductID" },
                    "Quantity": { "path": "Quantity" }
                  }
                }
              }
            }
          }
        }
      }
    }
  ]
}
```

**STEP**: 2 — i18n: Customize dialog title and success toast

**DESCRIPTION**: The default dialog title and toast text are provided by i18n keys CREATE_DIALOG_TITLE (default "New Item") and ITEM_CREATED (default "Item Created"). Override these keys in webapp/i18n/i18n.properties to provide custom text for the dialog title and the success toast shown after creation.

**LANGUAGE**: properties

**CODE**:
```properties
# webapp/i18n/i18n.properties
CREATE_DIALOG_TITLE=Create Sales Order Item
ITEM_CREATED=Sales order item created successfully
```

**STEP**: 3 — Implementation notes and constraints

**DESCRIPTION**: Important constraints and checks to perform:
- This feature is supported only for SAP Fiori elements with OData V2 and non-draft object pages.
- Maximum of 8 data fields can be displayed in the create dialog — include the most important and the entity's mandatory fields.
- Verify that each "path" value references an existing property of the related entity (entitySet specified in the section).
- Test the create flow to confirm that required backend validations are satisfied and the toast message appears on success.

**LANGUAGE**: Text

**CODE**:
```text
- File locations:
  - Manifest: webapp/manifest.json (add createWithParameterDialog under the relevant page/section)
  - i18n: webapp/i18n/i18n.properties (override CREATE_DIALOG_TITLE and ITEM_CREATED)

- Feature applicability:
  - Only for non-draft Object Pages
  - Only for OData V2 in Fiori elements

- Example mapping:
  "fields": {
    "<FieldKey>": { "path": "<PropertyNameInEntity>" }
  }
```
--------------------------------

**TITLE**: Enabling Table Personalization (SAP Fiori Elements — Manifest and Annotations)

**INTRODUCTION**: Action-oriented guidance for enabling and configuring table personalization (columns, filter, sort, group) in SAP Fiori Elements apps (OData V2 and V4). Includes manifest.json examples, annotation samples (XML, ABAP CDS, CAP CDS), and rules for properties with TextArrangement.

**TAGS**: fiori-elements, table-personalization, manifest.json, annotations, OData-V2, OData-V4, SortRestrictions, TextArrangement

**STEP**: Default behavior summary

**DESCRIPTION**: Quick reference of default personalization behavior for list report tables and differences between page-level and control-level variant management.

**LANGUAGE**: PlainText

**CODE**:
```PlainText
Defaults:
- OData V4: Table personalization (columns, sorting, filtering, grouping) is enabled by default for all tables.
- List Report / Variant management:
  - Page-level variant (page variant): filtering in table personalization is disabled by default.
  - Control-level variant (control variant): filtering in table personalization is enabled by default.
Notes:
- If smartVariantManagement is false, table filtering is enabled by default.
- Filtering of navigation properties is only available if the property is present in the LineItem.
- Restriction: cannot sort/group 1:n (multi-input) fields.
Image references (in original docs):
- images/Excluding_Columns_from_Filtering_3ee5c40.png
- images/Table_Personalization_Sorting_f63c073.png
- images/View_Settings_Enabling_Table_Personalization_69cdb2c.png
```

**STEP**: Enable table filters (OData V2 specific)

**DESCRIPTION**: For harmonized variant management in OData V2, end users cannot set a table filter by default. To allow end users to include table filters in page-level variants, set enableTableFilterInPageVariant to true in the page component settings. Note: if smartVariantManagement is false, table filter is enabled by default.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "forceGlobalRefresh": true
    },
    "pages": {
      "ListReport|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "smartVariantManagement": true,
            "enableTableFilterInPageVariant": true
          }
        }
      }
    }
  }
}
```

**STEP**: Configure table personalization (manifest.json — available options)

**DESCRIPTION**: Use the "personalization" object at the table settings level to enable/disable specific personalization options. Values:
- true (default): all personalization options enabled
- false: all options disabled
- object: specify keys "column", "sort", "filter" (and "group" for analytical tables). Omitted keys are treated as false.

Place under component options -> settings -> controlConfiguration -> @com.sap.vocabularies.UI.v1.LineItem -> tableSettings -> personalization

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "BusinessPartnersList": {
    "type": "Component",
    "id": "BusinessPartnersList",
    "name": "sap.fe.templates.ListReport",
    "options": {
      "settings": {
        "contextPath": "/BusinessPartners",
        "variantManagement": "Control",
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "type": "AnalyticalTable",
              "personalization": {
                "column": true,
                "sort": false,
                "filter": true,
                "group": true
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Enable table filtering for list report tables with page-level variant (OData V4)

**DESCRIPTION**: When using page-level variant management in OData V4, filtering in the table personalization dialog is not available by default. Enable filtering explicitly by setting "filter": true in the personalization object for the table in manifest.json (same location shown above).

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|MyEntitySet": {
        "component": {
          "name": "sap.fe.templates.ListReport",
          "settings": {
            "variantManagement": "Page",
            "controlConfiguration": {
              "@com.sap.vocabularies.UI.v1.LineItem": {
                "tableSettings": {
                  "personalization": {
                    "filter": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Define SortRestrictions via annotations (XML)

**DESCRIPTION**: Use Capabilities.NavigationRestrictions + Capabilities.SortRestrictions to restrict sorting for navigation properties or disable sorting for specific properties. Example XML annotation for NavigationRestrictions with SortRestrictions and NonSortableProperties.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotation Term="Capabilities.NavigationRestrictions">
    <Record Type="Capabilities.NavigationRestrictionsType">
        <PropertyValue Property="RestrictedProperties">
            <Collection>
                <Record Type="Capabilities.NavigationPropertyRestriction">
                    <PropertyValue Property="NavigationProperty" NavigationPropertyPath="_OverallSDProcessStatus"/>
                    <PropertyValue Property="SortRestrictions">
                        <Record Type="Capabilities.SortRestrictionsType">
                            <PropertyValue Property="NonSortableProperties">
                                <Collection>
                                    <PropertyPath>_OverallSDProcessStatus/OverallSDProcessStatus_Text</PropertyPath>
                                </Collection>
                            </PropertyValue>
                        </Record>
                    </PropertyValue>
                </Record>
                <Record Type="Capabilities.NavigationPropertyRestriction">
                    <PropertyValue Property="NavigationProperty" NavigationPropertyPath="_SalesOrderType"/>
                    <PropertyValue Property="SortRestrictions">
                        <Record Type="Capabilities.SortRestrictionsType">
                            <PropertyValue Property="NonSortableProperties">
                                <PropertyValue Property="Sortable" Bool="false"/>
                            </PropertyValue>
                        </Record>
                    </PropertyValue>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: Define SortRestrictions via ABAP CDS

**DESCRIPTION**: Disable sorting at the CDS level for an entity or property using ABAP CDS annotations.

**LANGUAGE**: ABAP

**CODE**:
```ABAP
@ObjectModel.sort.enabled: false
entity MyEntity {
  ...
}
```

**STEP**: Define SortRestrictions via CAP CDS (Node)

**DESCRIPTION**: CAP model syntax to define NavigationRestrictions and SortRestrictions (NonSortableProperties or disable Sortable completely). Prefix navigation property paths for navigation-property restrictions.

**LANGUAGE**: CDS

**CODE**:
```CDS
NavigationRestrictions : {
  RestrictedProperties : [
    {
      NavigationProperty: _OverallSDProcessStatus,
      SortRestrictions: { NonSortableProperties: [_OverallSDProcessStatus.OverallSDProcessStatus_Text] }
    },
    {
      NavigationProperty: _SalesOrderType,
      SortRestrictions: { Sortable: false }
    }
  ]
}
```

**STEP**: Important behavior notes and cautions

**DESCRIPTION**: Key behavioral rules to preserve when coding and configuring personalization.

**LANGUAGE**: PlainText

**CODE**:
```PlainText
- Sorting of columns with currency or UoM: sort first by currency/UoM then by amount to ensure consistent amounts across currencies/units.
- Filtering:
  - Navigation-property filtering is only available for properties included in the LineItem annotation.
  - In V4 with page-level variant management, enable via "personalization": {"filter": true}.
- TextArrangement behavior:
  - For TextFirst: sorting/grouping available for either property or its text.
  - For TextOnly: sorting/grouping applies to the text; filtering applies to the property itself (filtering on text is possible only if no restriction on the text property exists).
  - If TextOnly text property is annotated UI.Hidden = true, this is ignored for personalization: the text remains available for sorting/grouping.
  - If a presentationVariant sets sortOrder on a TextOnly property, sorting applies to the property (not the text), and the sort indicator may not appear in the visible column header.
  - If the TextArrangement target is a navigation property and the target is not present in LineItem or a custom column, the target property will not appear in the Columns tab of the personalization dialog.
- Restrictions/Cautions:
  - Cannot sort/group 1:n (multi-input) fields.
  - Sorting on navigation properties may cause issues in CAP NodeJS when using SQLite.
```
--------------------------------

**TITLE**: Enabling the Flexible Column Layout (FCL) in SAP Fiori Elements

**INTRODUCTION**: This document provides concise, code-focused instructions and manifest.json examples to enable and configure the Flexible Column Layout (FCL) for SAP Fiori Elements applications (OData V2 and V4). It covers global settings, per-page defaults, routing/targets for 2- and 3-column scenarios, and important notes/restrictions.

**TAGS**: fiori-elements-framework, flexible-column-layout, FCL, manifest.json, sap.fe, routing, sap.f, ODataV2, ODataV4

**STEP**: Overview — FCL options and behavior

**DESCRIPTION**: Use global flexibleColumnLayout settings to define default behavior for 2- and 3-column layouts. End users can resize, expand/collapse, and set full-screen per column. The main configuration keys:
- defaultTwoColumnLayoutType: e.g., TwoColumnsBeginExpanded, TwoColumnsMidExpanded
- defaultThreeColumnLayoutType: e.g., ThreeColumnsMidExpanded, ThreeColumnsEndExpanded

Supported end-user interactions: expand/collapse column, set full-screen, resize columns (persisted per app/device).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "flexibleColumnLayout": {
    "defaultTwoColumnLayoutType": "TwoColumnsMidExpanded",
    "defaultThreeColumnLayoutType": "ThreeColumnsEndExpanded"
  }
}
```

**STEP**: Enable FCL in SAP Fiori Tools (Business Application Studio / VS Code)

**DESCRIPTION**: Use Page Map to toggle Flexible Column Layout and choose the 2- or 3-column default. Preview the layout using the Fiori Tools preview. Note: FCL not available for the Overview Page floorplan.

**LANGUAGE**: text

**CODE**:
```text
1. Open the Page Map (right-click project folder → Show Page Map).
2. In the Property Panel, enable "Flexible Column Layout".
3. Select the desired 2- or 3-column layout option.
4. (Optional) Edit manifest.json for advanced settings.
5. Preview the app (Fiori Tools → Preview).
```

**STEP**: SAP Fiori Elements (OData V2) — Global manifest.json settings

**DESCRIPTION**: Add flexibleColumnLayout under sap.ui.generic.app settings in manifest.json to enable FCL in OData V2-based apps.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (OData V2)
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "settings": {
      "flexibleColumnLayout": {
        "defaultTwoColumnLayoutType": "TwoColumnsMidExpanded",
        "defaultThreeColumnLayoutType": "ThreeColumnsEndExpanded"
      }
    },
    "pages": [
      ...
    ]
  }
}
```

**STEP**: Define a default layout per page (override global defaults)

**DESCRIPTION**: Use defaultLayoutType on a page entry (in the pages array) to override global flexibleColumnLayout for that page. Example: set an object page to OneColumn to force it into the first column (useful to open that page full-screen or to change the column mapping).

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (page-level default layout)
{
  "sap.ui.generic.app": {
    "settings": {
      "flexibleColumnLayout": {
        "defaultTwoColumnLayoutType": "TwoColumnsMidExpanded",
        "defaultThreeColumnLayoutType": "ThreeColumnsEndExpanded"
      }
    },
    "pages": [
      {
        "entitySet": "SalesOrderManage",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": { ... }
        },
        "pages": [
          {
            "entitySet": "SalesOrderManage",
            "defaultLayoutType": "OneColumn",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": { ... }
            }
          }
        ]
      }
    ]
  }
}
```

**STEP**: SAP Fiori Elements (OData V4) — rootView + routing.config for FCL

**DESCRIPTION**: For OData V4 apps, explicitly set the rootView to the FCL root and configure routing to use sap.f.routing.Router. Also ensure the sap.f library is declared as a dependency under sap.ui5.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (sap.ui5 rootView + sap.f dependency)
{
  "sap.ui5": {
    "dependencies": {
      "libs": {
        "sap.f": {}
      }
    },
    "rootView": {
      "viewName": "sap.fe.core.rootView.Fcl",
      "type": "XML",
      "async": true,
      "id": "appRootView"
    }
  }
}
```

**CODE**:
```json
// manifest.json (routing config for OData V4)
{
  "sap.ui5": {
    "routing": {
      "config": {
        "routerClass": "sap.f.routing.Router",
        "flexibleColumnLayout": {
          "defaultTwoColumnLayoutType": "TwoColumnsMidExpanded",
          "defaultThreeColumnLayoutType": "ThreeColumnsMidExpanded"
        }
      },
      "routes": [
        ...
      ],
      "targets": {
        ...
      }
    }
  }
}
```

**STEP**: Routing — route pattern and target arrays for FCL

**DESCRIPTION**: For FCL, the route target is an array (specifying begin/mid/end targets). The route pattern should end with an optional :?query:. Use name, pattern, and target array. Below are full examples for common scenarios. Place these under sap.ui5.routing in manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json — 3-column layout starting with ListReport
{
  "routes": [
    {
      "pattern": ":?query:",
      "name": "SalesOrderManageList",
      "target": ["SalesOrderManageList"]
    },
    {
      "pattern": "SalesOrderManage({key}):?query:",
      "name": "SalesOrderManageObjectPage",
      "target": ["SalesOrderManageList", "SalesOrderManageObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2}):?query:",
      "name": "SalesOrderItemObjectPage",
      "target": ["SalesOrderManageList", "SalesOrderManageObjectPage", "SalesOrderItemObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3}):?query:",
      "name": "MaterialDetailsObjectPage",
      "target": ["MaterialDetailsObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3})/_MaterialRatings({key4}):?query:",
      "name": "MaterialRatingsObjectPage",
      "target": ["MaterialRatingsObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3})/_MaterialRatings({key4})/_MaterialRatingsDetails({key5}):?query:",
      "name": "MaterialRatingsDetailsObjectPage",
      "target": ["MaterialRatingsDetailsObjectPage"]
    }
  ]
}
```

**CODE**:
```json
// manifest.json — 2-column layout starting with ObjectPage
{
  "routes": [
    {
      "pattern": ":?query:",
      "name": "SalesOrderManageList",
      "target": ["SalesOrderManageList"]
    },
    {
      "pattern": "SalesOrderManage({key}):?query:",
      "name": "SalesOrderManageObjectPage",
      "target": ["SalesOrderManageObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2}):?query:",
      "name": "SalesOrderItemObjectPage",
      "target": ["SalesOrderManageObjectPage", "SalesOrderItemObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3}):?query:",
      "name": "MaterialDetailsObjectPage",
      "target": ["MaterialDetailsObjectPage"]
    }
  ]
}
```

**CODE**:
```json
// manifest.json — 3-column layout starting with ObjectPage
{
  "routes": [
    {
      "pattern": ":?query:",
      "name": "SalesOrderManageList",
      "target": "SalesOrderManageList"
    },
    {
      "pattern": "SalesOrderManage({key}):?query:",
      "name": "SalesOrderManageObjectPage",
      "target": ["SalesOrderManageObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2}):?query:",
      "name": "SalesOrderItemObjectPage",
      "target": ["SalesOrderItemObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3}):?query:",
      "name": "MaterialDetailsObjectPage",
      "target": ["SalesOrderItemObjectPage", "MaterialDetailsObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3})/_MaterialRatings({key4}):?query:",
      "name": "MaterialRatingsObjectPage",
      "target": ["SalesOrderItemObjectPage", "MaterialDetailsObjectPage", "MaterialRatingsObjectPage"]
    },
    {
      "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3})/_MaterialRatings({key4})/_MaterialRatingsDetails({key5}):?query:",
      "name": "MaterialRatingsDetailsObjectPage",
      "target": ["MaterialRatingsDetailsObjectPage"]
    }
  ]
}
```

**STEP**: Targets — controlAggregation mapping and required keys

**DESCRIPTION**: Each target must include type, id, name, controlAggregation, and contextPattern. Use templates: ListReport for the first-level view and ObjectPage for subsequent levels. controlAggregation must map to FCL columns:
- beginColumnPages — first column (initial view or pre-FCL)
- midColumnPages — second column
- endColumnPages — third column

Place targets under sap.ui5.routing.targets in manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json — targets (sample)
{
  "targets": {
    "SalesOrderManageList": {
      "type": "Component",
      "id": "SalesOrderManageList",
      "name": "sap.fe.templates.ListReport",
      "controlAggregation": "beginColumnPages",
      "contextPattern": "",
      "options": { ... }
    },
    "SalesOrderManageObjectPage": {
      "type": "Component",
      "id": "SalesOrderManageObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "midColumnPages",
      "contextPattern": "/SalesOrderManage({key})",
      "options": { ... }
    },
    "SalesOrderItemObjectPage": {
      "type": "Component",
      "id": "SalesOrderItemObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "controlAggregation": "endColumnPages",
      "contextPattern": "/SalesOrderManage({key})/_Item({key2})",
      "options": { ... }
    }
  }
}
```

**STEP**: Persistence — saving column resize information

**DESCRIPTION**: Column resize state is saved per application and per device type (desktop, tablet, phone) in the personalization settings. No additional manifest keys required; this is built into FCL behavior.

**LANGUAGE**: text

**CODE**:
```text
Resize information is automatically persisted per application and device type (desktop/tablet/phone) in personalization settings.
```

**STEP**: Notes and restrictions (must-read)

**DESCRIPTION**: Important constraints and behavior to account for when designing FCL apps.

**LANGUAGE**: text

**CODE**:
```text
- FCL is not relevant/available for the Overview Page floorplan.
- Analytical List Page supports only "TwoColumnsBeginExpanded".
- FCL works in both draft and non-draft apps.
- In non-draft CRUD apps, only the last column shows Edit/Delete buttons.
- PopinLayout values for better readability: "Block", "GridLarge", or "GridSmall".
- Restrictions:
  - In edit mode on an object page, subobject pages close automatically when adding/removing columns from a table.
  - If multiple tables on a page use the same entity, only the first table syncs with its subobject page.
  - After updating a multi-input field on an object page, refresh the parent page to see changes.
  - Tree tables and analytical tables cannot be displayed in the List Report for draft-enabled services in FCL.
```

**STEP**: Quick checklist — manifest.json keys to verify

**DESCRIPTION**: Before running the app, verify these manifest.json entries.

**LANGUAGE**: text

**CODE**:
```text
- For OData V2: "sap.ui.generic.app".settings.flexibleColumnLayout present.
- For OData V4: "sap.ui5".rootView set to "sap.fe.core.rootView.Fcl".
- For OData V4 routing: "sap.ui5".routing.config.routerClass == "sap.f.routing.Router".
- Ensure "sap.f" is added under "sap.ui5".dependencies.libs.
- Routes use arrays for "target" when multiple columns are shown.
- Targets have correct controlAggregation: beginColumnPages / midColumnPages / endColumnPages.
```
--------------------------------

**TITLE**: Enable Full-Screen Mode for Tables (SAP Fiori elements, OData V4)

**INTRODUCTION**: Configure a table to show a full-screen toggle button in the table toolbar by adding a flag to the page settings in manifest.json. Applicable to SAP Fiori elements for OData V4 only. The configuration targets the LineItem annotation control configuration and enables the full-screen UI affordance.

**TAGS**: fiori-elements-framework, manifest.json, OData V4, table, fullscreen, controlConfiguration

**STEP**: 1 — Add enableFullScreen to the page settings in manifest.json

**DESCRIPTION**: Insert the controlConfiguration entry for the page (the page ID used by your app; example: "SalesOrderManageObjectPage"). Place this block under the page object in manifest.json. This sets enableFullScreen = true for the LineItem table control.

- JSON path (conceptual): <pageId>.options.settings.controlConfiguration._Item/@com.sap.vocabularies.UI.v1.LineItem.tableSettings.enableFullScreen
- Replace <pageId> with your actual page key (e.g., "SalesOrderManageObjectPage").

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "options": {
      "settings": {
        "controlConfiguration": {
          "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "enableFullScreen": true
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Validation rules and platform behavior

**DESCRIPTION**: Check these constraints and expected UI behavior after enabling the setting.

- Only applicable to SAP Fiori elements for OData V4. Do not use for other frameworks/versions.
- Not available for the List Report: if configured for a list report page, the setting will be ignored during templating.
- On mobile phones, full-screen mode is enabled by default; the manifest setting is not required for phones.
- UI behavior: a full-screen button is added to the table toolbar to the left of the personalization button. Clicking toggles table full-screen mode; the icon switches to allow exiting full-screen. A Close button is shown at the bottom of the full-screen dialog.

**LANGUAGE**: text

**CODE**:
```
Constraints and behavior:
- Framework: SAP Fiori elements (OData V4) only
- List Report: setting is ignored if applied to a list report
- Mobile phones: full-screen mode enabled by default
- Toolbar placement: full-screen button appears left of the personalization button
- Interaction: click toggles full-screen; icon changes; a "Close" button is displayed at the bottom of the full-screen dialog
```
--------------------------------

**TITLE**: Enable/Disable Input History for Recently Entered Values (SAP Fiori elements)

**INTRODUCTION**: Configure whether SAP Fiori elements stores and shows the history of recently entered values for input fields. Covers prerequisites, security considerations, and manifest.json configuration for OData V2 and OData V4 applications. Use these manifest snippets to enable/disable history per field or globally.

**TAGS**: fiori-elements, manifest.json, input-history, historySettings, historyEnabled, ODataV2, ODataV4, security, PersonalData, INPUTFIELD_HISTORY

**STEP**: Prerequisites and security considerations

**DESCRIPTION**: Before enabling input history:
- Ensure the SAP Fiori launchpad parameter INPUTFIELD_HISTORY is enabled. See Manage Launchpad Settings.
- If a property or any ValueList parameter is annotated with com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive, SAP Fiori elements will not store that field's values in history (applies to both main entity property and ValueList parameters).
- End users can delete stored input history (see Input History docs).

**LANGUAGE**: Text

**CODE**:
```text
Prerequisite:
- Enable launchpad parameter: INPUTFIELD_HISTORY
  (See: Manage Launchpad Settings: https://help.sap.com/docs/SAP_S4HANA_CLOUD/4fc8d03390c342da8a60f8ee387bca1a/22d573aead754b80abca18ec71872fb7.html)

Security:
- If property or any ValueList parameter is annotated with:
  com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive
  then input history is NOT stored for that field.

User deletion:
- End users may delete history entries. See Input History documentation:
  ../10_More_About_Controls/input-history-152f84f.md
```

**STEP**: Configure input history in manifest.json (OData V2) — per-field control

**DESCRIPTION**: To explicitly enable or disable history for specific filter fields in an OData V2 List Report, add historySettings.fields at the page component settings path in manifest.json. Use value "enabled", "disabled", or "auto" per field. "auto" is the default and defers to the control type.

Place under: sap.ui.generic.app -> pages -> "<PageId>" -> component -> settings -> filterSettings -> historySettings -> fields

Example uses page id "ListReport|RootEntity" and a field named "CustomerName".

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|RootEntity": {
        "component": {
          "settings": {
            "filterSettings": {
              "historySettings": {
                "fields": {
                  "CustomerName": {
                    "historyEnabled": "enabled"
                  },
                  "CountryCode": {
                    "historyEnabled": "disabled"
                  },
                  "SearchTerm": {
                    "historyEnabled": "auto"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Configure input history in manifest.json (OData V2) — global/default setting

**DESCRIPTION**: To set a default behavior for all fields (including those not explicitly listed), place historyEnabled directly under historySettings. Valid values: "enabled", "disabled", "auto" (default).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|RootEntity": {
        "component": {
          "settings": {
            "filterSettings": {
              "historySettings": {
                "historyEnabled": "disabled"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Configure input history in manifest.json (OData V4)

**DESCRIPTION**: For SAP Fiori elements OData V4 applications, history is enabled by default. To disable history for specific properties, use the sap.fe -> historySettings -> fields -> "<propertyPath>" -> historyEnabled boolean (false to disable). <propertyPath> refers to the property path in the OData service.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.fe": {
    "historySettings": {
      "fields": {
        "CustomerName": {
          "historyEnabled": false
        },
        "CountryCode": {
          "historyEnabled": true
        }
      }
    }
  }
}
```

**STEP**: Notes and behavior summary

**DESCRIPTION**: Summary of behavior to use when writing code/config:
- OData V2: historyEnabled values are strings: "enabled" | "disabled" | "auto". Default is "auto".
- OData V4: historyEnabled is a boolean per field; default behavior is enabled unless explicitly set to false.
- Sensitive-data annotation (com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive) on the main entity property or any ValueList parameter prevents storage of history regardless of manifest settings.
- Ensure launchpad-level INPUTFIELD_HISTORY parameter is enabled for history to function.

**LANGUAGE**: Text

**CODE**:
```text
Behavior summary:
- OData V2 per-field: "historyEnabled": "enabled" | "disabled" | "auto" (default "auto")
- OData V2 global/default: "historyEnabled": "enabled" | "disabled" | "auto"
- OData V4 per-field: "historyEnabled": true | false (default true)
- Annotation (com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive) on property or ValueList parameter prevents history storage
- Launchpad parameter INPUTFIELD_HISTORY must be enabled
```
--------------------------------

**TITLE**: Enable Situation Handling Icon in Fiori Elements (OData V4)

**INTRODUCTION**: Enable the Situation Handling icon in SAP Fiori elements list reports and object pages by adding the required OData V4 annotation. The UI automatically shows the icon when exactly one navigation property exists whose target entity type is annotated with com.sap.vocabularies.Common.v1.SAPObjectNodeType Name="BusinessSituation".

**TAGS**: fiori-elements-framework, OData V4, annotations, Situation Handling, SAPObjectNodeType

**STEP**: 1 — Confirm applicability

**DESCRIPTION**: Situation-handling icon support is only available for SAP Fiori elements using OData V4. Verify your service is OData V4 before applying the annotation.

**LANGUAGE**: Plain

**CODE**:
```text
Check your service metadata endpoint (example):
GET https://<host>:<port>/sap/opu/odata4/<ServiceName>/v1/$metadata

Ensure the metadata document declares OData Version 4 constructs and namespaces.
```

**STEP**: 2 — Add SAPObjectNodeType annotation to the target entity type (CSDL inline)

**DESCRIPTION**: Annotate the target entity type (the entity representing business situations) with the SAPObjectNodeType annotation. You can add the annotation inline in the entity type definition in the service CSDL.

- Keep the exact structure and property name: com.sap.vocabularies.Common.v1.SAPObjectNodeType with a Record containing PropertyValue Name="BusinessSituation".
- The annotation must be on the target entity type that describes the business situation.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Inline annotation inside the target entity type definition -->
<EntityType Name="BusinessSituation">
  <Annotation Term="com.sap.vocabularies.Common.v1.SAPObjectNodeType">
    <Record>
      <PropertyValue Property="Name" String="BusinessSituation" />
    </Record>
  </Annotation>

  <!-- Define keys and properties of the BusinessSituation entity as needed -->
  <Key>
    <PropertyRef Name="SituationID" />
  </Key>
  <Property Name="SituationID" Type="Edm.String" Nullable="false" />
  <!-- ... other properties ... -->
</EntityType>
```

**STEP**: 3 — Alternatively: Add SAPObjectNodeType as an external annotations element

**DESCRIPTION**: If you keep annotations in a separate annotations file, target the entity type with an <Annotations> element and the same inner annotation Record.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- External annotations file (annotations.xml) -->
<Annotations Target="YourServiceNamespace.BusinessSituation">
  <Annotation Term="com.sap.vocabularies.Common.v1.SAPObjectNodeType">
    <Record>
      <PropertyValue Property="Name" String="BusinessSituation" />
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 4 — Ensure exactly one navigation property points to the annotated target entity

**DESCRIPTION**: The Fiori Elements runtime requires exactly one navigation property on the primary entity (the Business Object shown in the list or object page) that targets the annotated BusinessSituation entity. Confirm there is only one such navigation property (remove duplicates or additional navigation properties that target the same annotated entity).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: primary entity has a single navigation property to the BusinessSituation entity -->
<EntityType Name="MainBusinessEntity">
  <Key>
    <PropertyRef Name="ID" />
  </Key>
  <Property Name="ID" Type="Edm.String" Nullable="false" />
  <!-- Single navigation property to the annotated business-situation entity -->
  <NavigationProperty Name="BusinessSituationNav" Type="YourServiceNamespace.BusinessSituation" />
  <!-- ... other properties ... -->
</EntityType>
```

**STEP**: 5 — Validate the annotation and navigation property in the service metadata

**DESCRIPTION**: Verify both the annotation on the target entity and the single navigation property exist in the published $metadata (merged metadata + annotations). Use the service $metadata or the combined annotations document to confirm.

**LANGUAGE**: HTTP / XML

**CODE**:
```text
1) Retrieve $metadata and/or annotation file:
GET https://<host>/sap/opu/odata4/<ServiceName>/v1/$metadata
GET https://<host>/sap/opu/odata4/<ServiceName>/v1/annotations

2) Confirm:
- The target entity (YourServiceNamespace.BusinessSituation) contains the SAPObjectNodeType annotation:
  com.sap.vocabularies.Common.v1.SAPObjectNodeType -> Record -> PropertyValue Name="BusinessSituation"
- The primary entity contains exactly one NavigationProperty whose Type targets YourServiceNamespace.BusinessSituation
```

**STEP**: 6 — Verify UI behavior in Fiori Elements apps

**DESCRIPTION**: After deployment, Fiori elements list reports and object pages will automatically display the Situation Handling icon:
- In responsive tables: icon is shown next to the first semantic key.
- In other table types: icon appears in a separate column.

Use the list report and object page for the entity that contains the navigation property to confirm the icon renders as expected.
--------------------------------

**TITLE**: Enable List-Detail Mode (Flexible Column Layout) in SAP Fiori Elements

**INTRODUCTION**: This document shows the exact manifest.json changes to enable a two-column "list-detail" layout for Fiori Elements apps. Includes examples for OData V2 and OData V4 and explains the relevant parameters, allowed values, and runtime behavior (how a third view is handled and how deletion affects columns).

**TAGS**: fiori-elements-framework, flexible-column-layout, list-detail, manifest.json, OData V2, OData V4, sap.ui.routing, sap.ui.generic.app

**STEP**: 1 — Edit manifest.json for OData V2 apps

**DESCRIPTION**: Add or update the flexibleColumnLayout settings under "sap.ui.generic.app" → "settings" in manifest.json. This enables starting with two columns and limits the maximum columns. Place this snippet in the root manifest.json of your Fiori Elements app.

- File: manifest.json
- Allowed values:
  - initialColumnsCount: 1 or 2
  - maxColumnsCount: 2 or 3
  - displayNextObjectAfterDelete: true or false
- Behavior:
  - initialColumnsCount = 2 starts the app in two-column layout.
  - If maxColumnsCount = 2 and the app has three views, the third view opens full-screen.
  - displayNextObjectAfterDelete: when true, after deleting a list/main object the next object is shown in the same column; when false the column closes.
  - Note: displayNextObjectAfterDelete does NOT apply to deleting sub-objects inside an object page.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "settings": {
      "flexibleColumnLayout": {
        "defaultTwoColumnLayoutType": "TwoColumnsMidExpanded",
        "defaultThreeColumnLayoutType": "ThreeColumnsMidExpanded",
        "initialColumnsCount": 2,
        "maxColumnsCount": 2,
        "displayNextObjectAfterDelete": true
      }
    }
  }
}
```

**STEP**: 2 — Edit manifest.json for OData V4 apps (router config)

**DESCRIPTION**: For OData V4 apps that use sap.f routing, configure flexible column layout under "routing" → "config" → "flexibleColumnLayout" in manifest.json. Use limitFCLToTwoColumns to restrict to two columns.

- File: manifest.json
- Allowed value:
  - limitFCLToTwoColumns: true or false
- Behavior:
  - limitFCLToTwoColumns = true limits the flexible column layout to two columns; if the app has three views, the third opens full-screen.
  - Keep defaultTwoColumnLayoutType and defaultThreeColumnLayoutType to control initial expand/collapse states.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "config": {
        "routerClass": "sap.f.routing.Router",
        "flexibleColumnLayout": {
          "defaultTwoColumnLayoutType": "TwoColumnsMidExpanded",
          "defaultThreeColumnLayoutType": "ThreeColumnsMidExpanded",
          "limitFCLToTwoColumns": true
        }
      }
    }
  }
}
```

**STEP**: 3 — Quick reference for parameter effects and typical combinations

**DESCRIPTION**: Use these patterns depending on desired UX:

- Start app with two columns and limit to two columns (OData V2):
  - initialColumnsCount: 2
  - maxColumnsCount: 2
  - displayNextObjectAfterDelete: true (optional)
- Keep three-column capability but start in two-column state (OData V2):
  - initialColumnsCount: 2
  - maxColumnsCount: 3
- Restrict FCL to two columns (OData V4):
  - limitFCLToTwoColumns: true

**LANGUAGE**: JSON

**CODE**:
```json
{
  "exampleV2_twoColumnOnly": {
    "sap.ui.generic.app": {
      "settings": {
        "flexibleColumnLayout": {
          "initialColumnsCount": 2,
          "maxColumnsCount": 2,
          "displayNextObjectAfterDelete": true
        }
      }
    }
  },
  "exampleV2_threeAllowed_but_startTwo": {
    "sap.ui.generic.app": {
      "settings": {
        "flexibleColumnLayout": {
          "initialColumnsCount": 2,
          "maxColumnsCount": 3
        }
      }
    }
  },
  "exampleV4_limitTwo": {
    "sap.ui5": {
      "routing": {
        "config": {
          "flexibleColumnLayout": {
            "limitFCLToTwoColumns": true
          }
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Enable and Configure the Related Apps Button (Object Page)

**INTRODUCTION**: Steps and code snippets to enable the Related Apps button on object pages, hide/allow specific semantic-object actions, add additional semantic objects and mappings, and override settings at runtime. Includes examples for OData V2 and V4, XML annotations, ABAP CDS, and CAP CDS.

**TAGS**: sap-fiori, fiori-elements, related-apps, manifest.json, semantic-object, semantic-mapping, annotations, ODataV2, ODataV4

STEP: 1 — Enable Related Apps in manifest.json (OData V2)
DESCRIPTION: Add showRelatedApps: true to the ObjectPage component settings in manifest.json to display the Related Apps button.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_PD_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": [
          {
            "entitySet": "SEPMRA_C_PD_Product",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "showRelatedApps": true
              }
            },
            "pages": [
              {
                "navigationProperty": "to_ProductText",
                "entitySet": "SEPMRA_C_PD_ProductText",
                "component": {
                  "name": "sap.suite.ui.generic.template.ObjectPage"
                }
              }
            ]
          }
        ]
      }
    ]
  }
}
```

STEP: 2 — Hide Actions for a Semantic Object (XML Annotation)
DESCRIPTION: Use Common.SemanticObjectUnavailableActions to exclude specific actions (e.g., displayFactSheet) for a semantic object in the app context.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SalesOrderService.SalesOrderManage"> 
     ...
     <Annotation Term="Common.SemanticObjectUnavailableActions"> 
          <Collection> 
               <String>displayFactSheet</String> 
          </Collection> 
     </Annotation>
     <Annotation Term="Common.SemanticObject" String="SalesOrder"/>
     ...
</Annotations>
```

STEP: 3 — Hide Actions for a Semantic Object (CAP CDS)
DESCRIPTION: CAP CDS syntax to exclude actions (example shows SemanticObjectUnavailableActions equivalent).
LANGUAGE: CDS
CODE:
```cds
entity SalesOrderManage
@(
  Common: {
    SemanticObjectUnavailableActions: ['displayFactSheet']
  }
)
```

STEP: 4 — Add Additional Semantic Objects (OData V2: relatedAppsSettings)
DESCRIPTION: Configure relatedAppsSettings under the ObjectPage component in manifest.json to include extra semantic objects shown under the Related Apps button. Keys in relatedAppsSettings must match the object key you choose and set semanticObject values accordingly.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_PD_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": [
          {
            "entitySet": "SEPMRA_C_PD_Product",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "showRelatedApps": true,
                "relatedAppsSettings": {
                  "0": {
                    "semanticObject": "EPMProduct"
                  }
                }
              }
            },
            "pages": [
              {
                "navigationProperty": "to_ProductText",
                "entitySet": "SEPMRA_C_PD_ProductText",
                "component": {
                  "name": "sap.suite.ui.generic.template.ObjectPage"
                }
              }
            ]
          }
        ]
      }
    ]
  }
}
```

STEP: 5 — Provide semanticObjectAction list and behavior (OData V2)
DESCRIPTION: Define explicit actions per semantic object in relatedAppsSettings. Rules:
- If semanticObjectAction is omitted: show all actions except those excluded via SemanticObjectUnavailableActions annotation.
- If semanticObjectAction is defined: only actions listed are shown (annotation is ignored).
- If semanticObjectAction is an empty object: no actions are shown for that semantic object.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_PD_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport"
        },
        "pages": [
          {
            "entitySet": "SEPMRA_C_PD_Product",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "relatedAppsSettings": {
                "EPMProduct": {
                  "semanticObject": "EPMProduct"
                },
                "STTA_WD20": {
                  "semanticObject": "STTA_WD20",
                  "semanticObjectAction": {
                    "0": { "action": "Multi_View" },
                    "1": { "action": "Tree_Table" }
                  }
                }
              }
            }
          }
        ]
      }
    ]
  }
}
```

STEP: 6 — Override Related App Settings at Runtime (Extension API)
DESCRIPTION: Use modifyRelatedAppsSettings extension function in manifest.json to programmatically alter related app configuration based on deployed semantic object or entity type.
LANGUAGE: JavaScript
CODE:
```javascript
modifyRelatedAppsSettings: function (oRelatedAppSetting, sCurrentSemanticObject, sEntityTypeName) {
    if (sCurrentSemanticObject === "EPMProduct") {
        oRelatedAppSetting = {
            ...oRelatedAppSetting,
            // add additional semantic object and action
            "EPMSalesOrder": {
                semanticObject: "EPMSalesOrder",
                semanticObjectAction: {
                    0: { action: "display" }
                }
            }
        };
    }
    return oRelatedAppSetting;
}
```

STEP: 7 — Enable Related Apps in OData V4 manifest (Component options)
DESCRIPTION: For OData V4 (sap.fe.templates.ObjectPage), set showRelatedApps: true under the component options settings in manifest.json.
LANGUAGE: JSON
CODE:
```json
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "showRelatedApps": true
    }
  }
}
```

STEP: 8 — Note: GetLinks and semantic/technical keys behavior
DESCRIPTION: When calling the Fiori launchpad GetLinks API, Fiori elements passes all semantic keys if available; otherwise, it passes technical keys. Ensure semantic keys are exposed in annotations or manifest mapping to get correct target link context.
LANGUAGE: JSON
CODE:
```json
// Behavior note (no code required)
// If semantic keys are available => passed to GetLinks.
// If not => technical keys are passed.
```

STEP: 9 — Map Default Links Between Different Field Names (Annotations)
DESCRIPTION: Use Common.SemanticObject and Common.SemanticObjectMapping to map local property names to semantic object property names so context is passed when source/target field names differ.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage">
    <Annotation Term="Common.SemanticObject" String="SalesOrder"/>
    <Annotation Term="Common.SemanticObjectMapping">
        <Collection>
            <Record Type="Common.SemanticObjectMappingType">
                <PropertyValue Property="LocalProperty" PropertyPath="SoldToParty"/>
                <PropertyValue Property="SemanticObjectProperty" String="Customer"/>
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```

STEP: 10 — Map Default Links (ABAP CDS)
DESCRIPTION: ABAP CDS annotate view example for semantic object mapping.
LANGUAGE: ABAP CDS
CODE:
```abap
annotate view SalesOrderManage with {
   @Consumption.semanticObject: 'SalesOrder'
   @Consumption.semanticObjectMapping.additionalBinding: [{element: 'Customer', localElement: 'SoldToParty'}]
   Customer
}
```

STEP: 11 — Map Default Links (CAP CDS)
DESCRIPTION: CAP CDS example mapping SoldToParty -> Customer for SemanticObject.
LANGUAGE: CDS
CODE:
```cds
entity SalesOrderManage
@(
  Common: {
    SemanticObject: 'SalesOrder',
    SemanticObjectMapping: [
      {
        LocalProperty: SoldToParty,
        SemanticObjectProperty: 'Customer'
      }
    ]
  }
)
```

STEP: 12 — Add Additional Links via additionalSemanticObjects (OData V4)
DESCRIPTION: Under the ObjectPage component options.settings add additionalSemanticObjects to include external semantic objects with mapping and unavailableActions or allowedActions. Use mapping to translate local field names to target app field names.
LANGUAGE: JSON
CODE:
```json
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "contextPath": "/SalesOrderManage",
      "showRelatedApps": true,
      "additionalSemanticObjects": {
        "ProductCollection": {
          "unavailableActions": ["displayFactSheet", "reorderProduct"],
          "mapping": {
            "SoldToParty": "Client"
          }
        },
        "Customer": {
          "unavailableActions": ["manage"],
          "mapping": {
            "SoldToParty": "Customer"
          }
        }
      }
    }
  }
}
```

STEP: 13 — Use allowedActions to explicitly list links
DESCRIPTION: Use allowedActions per additional semantic object to explicitly include only listed actions. Note: allowedActions disables unavailableActions. If allowedActions is empty or absent (and no other entries), no links appear for that semantic object.
LANGUAGE: JSON
CODE:
```json
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "contextPath": "/SalesOrderManage",
      "showRelatedApps": true,
      "additionalSemanticObjects": {
        "SalesOrder": {
          "allowedActions": ["create", "managev2"]
        },
        "ProductCollection": {
          "allowedActions": ["displayFactSheet"],
          "mapping": { "SoldToParty": "Client" }
        }
      }
    }
  }
}
```

STEP: 14 — Important Rules and Notes (Summary)
DESCRIPTION: Actionable rules to follow when configuring Related Apps:
- Always set showRelatedApps: true to enable the button.
- Use Common.SemanticObjectUnavailableActions annotation to hide actions unless semanticObjectAction is explicitly defined in manifest (then annotation is ignored).
- If semanticObjectAction is defined and is empty, no actions are shown.
- additionalSemanticObjects.mapping must be used to map object page fields to additional semantic objects (do not use annotation mapping for additionalSemanticObjects).
- allowedActions overrides unavailableActions; if allowedActions lists nothing, no links will be shown for that semantic object.
LANGUAGE: JSON
CODE:
```json
// Summary (no code) - follow the above rules while editing manifest.json and annotations.
```
--------------------------------

**TITLE**: Enable or Disable List Report Search (SAP Fiori Elements)

**INTRODUCTION**:
Action-oriented instructions to enable the Search field in Fiori Elements list reports for OData V2 and OData V4 services, including code examples for service metadata (OData V2), XML annotations (OData V4), ABAP CDS and CAP CDS annotations (OData V4). Includes restrictions and backend behavior details needed when implementing search.

**TAGS**: fiori-elements-framework, odata-v2, odata-v4, search, annotations, metadata.xml, CDS, CAP, RAP, $search

**STEP**: 1 — Overview & Constraints

**DESCRIPTION**:
Key functional constraints and behavior to keep in mind before implementing search:
- Search input is limited to 1000 characters.
- In OData V4, the search string is passed to the backend using the $search query parameter.
- The following characters must be avoided (they cause errors in RAP and CAP back ends): ", (, ), ;
- For analytical tables, search enablement/disablement can be configured separately (see Setting the Table Type).
- Refer to the filter bar configuration if you need to adapt search integration with filters.

**LANGUAGE**: Plain Text

**CODE**:
```
Constraints:
- Max search length: 1000 characters
- Backend transport (OData V4): uses $search parameter
- Special characters that must be ignored:  "   (   )   ;
References:
- Analytical table search config: setting-the-table-type-7f844f1.md
- Filter bar config: adapting-the-filter-bar-609c39a.md
```

**STEP**: 2 — Enable Search for OData V2 (service metadata)

**DESCRIPTION**:
Enable the Search field for a list report by setting sap:searchable="true" on the root EntitySet in the service metadata (metadata XML). Update the service metadata file (metadata.xml) exposed by your OData V2 service.

- Target file: service metadata document (e.g., metadata.xml exposed by your OData V2 service).
- Place the attribute on the root EntitySet representing the list report's entity set.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: Add sap:searchable="true" to the root EntitySet in metadata.xml -->
<EntitySet
  Name="SEPMRA_C_PD_Product"
  EntityType="SEPMRA_PROD_MAN.SEPMRA_C_PD_ProductType"
  sap:searchable="true"
  sap:content-version="1" />
```

**STEP**: 3 — Disable Search for OData V4 (XML Annotation)

**DESCRIPTION**:
In OData V4, search is enabled by default. To disable search for a specific entity, add a SearchRestrictions annotation setting Searchable to false. Place this annotation in your service annotation file or metadata annotations document.

- Example target: SAP__self.Container/SalesOrder (replace with your service/container path and entity name).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- XML annotation to disable search for the SalesOrder entity -->
<Annotations Target="SAP__self.Container/SalesOrder">
  <Annotation Term="SAP__capabilities.SearchRestrictions">
    <Record>
      <PropertyValue Property="Searchable" Bool="false" />
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 4 — Disable Search using ABAP CDS Annotation

**DESCRIPTION**:
Disable search by annotating an ABAP CDS view. Add the @Search.searchable: false annotation in the CDS source that represents the entity exposed by your OData V4 service.

- Place this in the CDS view source or an appropriate CDS annotation include.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@Search.searchable: false
annotate view ZC_SalesOrder with { };
```

**STEP**: 5 — Disable Search using CAP CDS Annotation

**DESCRIPTION**:
For CAP-based services, disable search by adding the Capabilities SearchRestrictions annotation to the entity in your CDS model.

- Place this in the CDS model file that defines the SalesOrder entity.

**LANGUAGE**: CDS

**CODE**:
```cds
annotate SalesOrder with @Capabilities: { SearchRestrictions: { Searchable: false } };
```

**STEP**: 6 — Backend Behavior & Implementation Notes

**DESCRIPTION**:
Implementation notes for backend and UI integration:
- OData V4: user-entered search string is sent to backend via $search. Ensure backend supports $search semantics or disable search if unsupported.
- Special characters that must be ignored in incoming search strings (cause errors in RAP/CAP): ", (, ), ;
- If using analytical tables, adjust table-type-specific search configuration (see setting-the-table-type-7f844f1.md).
- UI image reference for List Report Search (for documentation/UX): images/ListReport_Search_8f1dc18.png

**LANGUAGE**: Plain Text

**CODE**:
```
Backend and UI notes:
- OData V4 search uses $search query parameter. Ensure backend handles $search.
- Ignore these characters in search input to avoid backend errors:  "   (   )   ;
- Max length: 1000 characters
- Analytical table search config: setting-the-table-type-7f844f1.md
- Filter bar adaptation: adapting-the-filter-bar-609c39a.md
- Image (documentation): images/ListReport_Search_8f1dc18.png
```
--------------------------------

**TITLE**: Enable File Uploads for Fiori Elements Table (OData V4)

**INTRODUCTION**: This document shows the minimal, actionable steps and code examples to enable file upload/download/delete in a SAP Fiori elements Table (OData V4). It covers prerequisites, required XML annotation snippets (entity metadata and annotation files), how to restrict file types, and pointers for CAP and backend security requirements. Use these snippets directly in your service metadata/annotation files.

**TAGS**: fiori-elements, odata-v4, upload, stream, UI.LineItem, UI.MediaResource, Core.AcceptableMediaTypes, annotations, CAP

**STEP**: 1 - Prerequisites (what the model must provide)

**DESCRIPTION**: Ensure the OData entity is configured as a media entity and that the table column and media resource annotations reference the stream property. Requirements:
- The entity must expose a stream (media) property (OData media entity / Edm.Stream).
- UI.LineItem annotation must reference the stream property (so the table shows a file column).
- UI.MediaResource annotation must reference the stream property.

**LANGUAGE**: text

**CODE**:
```text
Prerequisite checklist:
- EntityType has HasStream="true" (media entity) and a stream property (commonly referenced as 'file' or similar).
- UI.LineItem contains a DataField that references the stream property (Path).
- UI.MediaResource annotation for the EntityType points to the same stream property using PropertyValue Stream -> <streamProperty>.
- This applies only to SAP Fiori elements with OData V4.
```

**STEP**: 2 - CSDL EntityType example (media entity)

**DESCRIPTION**: Add/verify the CSDL (EDMX) entity type is a media entity. Use HasStream="true" and include the key and non-stream properties. This is the metadata (service) side.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example CSDL (edmx:DataServices / Schema) snippet -->
<EntityType Name="Document" HasStream="true">
  <Key>
    <PropertyRef Name="ID"/>
  </Key>
  <Property Name="ID" Type="Edm.String" Nullable="false"/>
  <Property Name="Title" Type="Edm.String" Nullable="true"/>
  <!-- Stream content is stored as the entity's media stream (no explicit Edm.Stream property required in CSDL body)
       Some service implementations expose an additional property name to reference (e.g., 'file') via annotations. -->
</EntityType>
```

**STEP**: 3 - XML annotation: show file column (UI.LineItem) and UI.MediaResource

**DESCRIPTION**: Add annotations that:
- Define a table column that references the stream (so files are shown as download links).
- Declare the entity as a media resource and point Stream to the stream property name used by your service.

Use the Target value matching your service namespace and entity type.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Annotations file (Annotations.xml). Replace Namespace.Document with your target. -->
<Annotations Target="Namespace.Document">
    <!-- Show the uploaded file in the table as a DataField (value references the stream property/path) -->
    <Annotation Term="UI.LineItem">
        <Collection>
            <Record Type="UI.DataField">
                <PropertyValue Property="Value" Path="file"/>  <!-- Path must match your service's stream property or navigation used -->
                <PropertyValue Property="Label" String="File"/>
            </Record>
            <!-- Add other DataField records as needed -->
        </Collection>
    </Annotation>

    <!-- Declare media resource mapping: Stream should reference the stream property name -->
    <Annotation Term="UI.MediaResource">
        <Record Type="UI.MediaResourceType">
            <PropertyValue Property="Stream" Path="file"/> <!-- 'file' is the stream property name referenced above -->
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 4 - Restrict allowed file types (Core.AcceptableMediaTypes) and limit size

**DESCRIPTION**: Restrict client-visible allowed MIME types using the AcceptableMediaTypes annotation on the stream property. Enforce file-size and virus scanning on the backend. The example below shows how to annotate acceptable MIME types. Adjust MIME types and maximum size per your security policy.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Apply acceptable media types to the stream property target.
     Replace Namespace.Document/file with your entity/property target. -->
<Annotations Target="Namespace.Document/file">
  <Annotation Term="Org.OData.Core.V1.AcceptableMediaTypes">
    <Collection>
      <Record>
        <PropertyValue Property="ContentType" String="application/pdf"/>
      </Record>
      <Record>
        <PropertyValue Property="ContentType" String="image/png"/>
      </Record>
      <!-- Add additional allowed types (image/jpeg, text/csv, etc.) -->
    </Collection>
  </Annotation>

  <!-- Illustrative: also specify a maximum allowed size (value and exact annotation term may depend on your backend and metadata conventions).
       Ensure your backend enforces size limits and performs virus scanning / MIME-type validation. -->
  <Annotation Term="Org.OData.Core.V1.MaxLength">
    <Int>10485760</Int> <!-- Example: 10 MB in bytes -->
  </Annotation>
</Annotations>
```

**STEP**: 5 - CAP (Cloud Application Programming) setup

**DESCRIPTION**: If you use SAP CAP, use the Attachments plugin to expose attachments/streams in the service and produce the required metadata/annotations automatically. Link provided for plugin details.

**LANGUAGE**: URL

**CODE**:
```text
CAP Attachments plugin:
https://cap.cloud.sap/docs/plugins/#attachments

Notes:
- Use the Attachments plugin to create/serve media entities.
- Ensure generated service metadata includes the UI.LineItem/UI.MediaResource annotations or provide local XML annotations if needed.
```

**STEP**: 6 - Security checklist (backend responsibilities)

**DESCRIPTION**: Implement server-side security and validation for all uploads. The UI-side annotations restrict client selection, but backend MUST validate and sanitize content.

**LANGUAGE**: text

**CODE**:
```text
Backend security checklist:
- Implement virus scanning for uploaded files.
- Enforce maximum file size limit and reject oversized uploads.
- Validate MIME type and content (do not rely only on client-provided MIME type).
- Perform input sanitization and any business-rule validation.
- Log upload events and errors for audit.
- Ensure appropriate authorization: uploading/deleting only in edit mode and only by authorized users.
```

**STEP**: 7 - UI customization and adding columns/actions

**DESCRIPTION**: To add extra columns or actions in the table, extend UI.LineItem or add custom columns/actions via your Fiori elements manifest.json. The Upload button behaves like the Create action: control its visibility/enablement the same way you would for Create (use annotations or action configuration rules). For details, follow the "Defining Line Items" and "Adding Actions to Tables" documentation.

**LANGUAGE**: text

**CODE**:
```text
Customization summary:
- Add additional <Record Type="UI.DataField"> entries to UI.LineItem to show more columns.
- Add action annotations or configure actions in manifest.json to add custom actions (the Upload action is semantically a Create).
- Control visibility and enablement of the Upload button using the same techniques as for the Create action (annotation-driven or manifest/action-based visibility rules).
References:
- Defining Line Items (Fiori elements docs)
- Adding Actions to Tables (Fiori elements docs)
```

**STEP**: 8 - Live example and reference links

**DESCRIPTION**: Use the SAP Fiori development portal and provided references for live examples and further details.

**LANGUAGE**: URL

**CODE**:
```text
Live example: Building Blocks - Table - Upload Table
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/tableUpload

Security configuration reference:
security-configuration-ba0484b.md

Enable stream support and annotation guidance:
enabling-stream-support-b236d32.md
```
--------------------------------

**TITLE**: Enable or Disable Variant Management on the Object Page (Fiori Elements)

**INTRODUCTION**: Quick, code-focused instructions for enabling or disabling variant management for tables and charts on the Object Page in SAP Fiori elements (OData V2 and V4). Includes manifest.json snippets for global and per-section settings, plus V4 controlConfiguration for per-table personalization.

**TAGS**: fiori-elements-framework, variant-management, object-page, manifest.json, SAPUI5, ODataV2, ODataV4, personalization

**STEP**: 1 — Disable variant management globally for OData V2 (Object Page)
**DESCRIPTION**: Set component-level settings in manifest.json to disable variant management for all tables and charts on the Object Page (OData V2).
**LANGUAGE**: JSON
**CODE**:
```json
{
  "component": {
    "name": "sap.suite.ui.generic.template.ObjectPage",
    "settings": {
      "tableSettings": {
        "variantManagement": false
      },
      "chartSettings": {
        "variantManagement": false
      }
    }
  }
}
```

**STEP**: 2 — Disable variant management for a specific table on the Object Page (OData V2)
**DESCRIPTION**: Disable variant management only for a specific section/table by adding the tableSettings.variantManagement switch under the section id in component settings. Replace the section ID with your section identifier.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "component": {
    "name": "sap.suite.ui.generic.template.ObjectPage",
    "settings": {
      "sections": {
        "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
          "tableSettings": {
            "variantManagement": false
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Disable variant management for a specific chart on the Object Page (OData V2)
**DESCRIPTION**: Disable variant management only for a specific chart by adding the chartSettings.variantManagement switch under the section id in component settings. Replace the section ID with your chart identifier.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "component": {
    "name": "sap.suite.ui.generic.template.ObjectPage",
    "settings": {
      "sections": {
        "to_ProductSalesData::com.sap.vocabularies.UI.v1.Chart": {
          "chartSettings": {
            "variantManagement": false
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Enable variant management on the Object Page for OData V4
**DESCRIPTION**: In Fiori Elements for OData V4, variant management is disabled by default. Enable it on the object page by setting "variantManagement": "Control" in the object page options/settings. Use controlConfiguration to configure per-table personalization (personalization keys such as column/sort).
**LANGUAGE**: JSON
**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "options": {
      "settings": {
        "variantManagement": "Control",
        "controlConfiguration": {
          "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "personalization": {
                "column": true,
                "sort": false
              }
            }
          },
          "_Partner/@com.sap.vocabularies.UI.v1.LineItem": {
            "tableSettings": {
              "personalization": {
                "column": true,
                "sort": false
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Disable variant management for OData V4
**DESCRIPTION**: Turn off variant management on the object page by setting "variantManagement" to "None".
**LANGUAGE**: JSON
**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "options": {
      "settings": {
        "variantManagement": "None"
      }
    }
  }
}
```

**STEP**: 6 — Behavioral notes and best practices (apply when editing manifest.json)
**DESCRIPTION**: Key behavioral details to follow when applying the settings:
- For SAPUI5 >= 1.108 (OData V2): variant management is enabled by default. Do NOT set "variantManagement": true explicitly to enable it; only set false to disable.
- For OData V4: variant management is disabled by default; enable it by setting "variantManagement": "Control".
- Personalization (column, sort, etc.) is independent of variant management, but variant management requires personalization to be available for the table. You cannot enable variant management if personalization is turned off for that table.
- When variant management is enabled, the selected variant is stored in the inner app state and restored per object (switching objects restores the default variant for that object).
- Do NOT change variant management settings after delivering the application — modifying these settings post-delivery can cause end users to lose personalization data.

**LANGUAGE**: JSON
**CODE**:
```json
{
  "notes": {
    "sapui5_1_108_behavior": "Variant management enabled by default for OData V2; do not set variantManagement:true.",
    "odata_v4_default": "Variant management disabled by default; set variantManagement:'Control' to enable.",
    "personalization_dependency": "Personalization must be enabled on a table to use variant management.",
    "persistence": "Selected variant is stored in inner app state and restored per object.",
    "delivery_warning": "Changing variant management after delivery may cause users to lose personalization."
  }
}
```
--------------------------------

**TITLE**: Add PresentationVariantQualifier to ValueList Annotations to Enable Visual Filters

**INTRODUCTION**: This guide shows exactly how to annotate ValueList (value help) definitions so a filter field is available as a visual filter. You will (1) add PresentationVariantQualifier to the ValueList annotation, (2) define a UI.PresentationVariant that contains a UI.Chart in the value-help entity, and (3) understand runtime behavior and rules for visual-filter refresh and parameter passing.

**TAGS**: fiori-elements-framework, annotations, ValueList, visual-filters, UI.PresentationVariant, UI.Chart, OData V4, ABAP CDS, CAP

STEP: 1 — XML ValueList: Add PresentationVariantQualifier
DESCRIPTION: Add PresentationVariantQualifier to the ValueList annotation of the filter property on the main entity type. The string value must match a UI.PresentationVariant qualifier that is defined on the value-help (CollectionPath) entity type. This links the ValueList to a PresentationVariant containing a UI.Chart used by the Visual Filter Bar.
LANGUAGE: XML
CODE:
```XML
<!-- ValueList on the main entity type / property -->
<Annotations Target="Z0020_CDS.Z0020Type/CountryID">
  <Annotation Term="Common.ValueList" Qualifier="0020_Country">
    <Record>
      <PropertyValue Property="Label" String="Country"/>
      <PropertyValue Property="CollectionPath" String="Z0022"/>                 <!-- value-help entity set -->
      <PropertyValue Bool="false" Property="SearchSupported"/>
      <PropertyValue Property="Parameters">
        <Collection>
          <!-- OUT mapping (ValueList -> main entity) -->
          <Record Type="Common.ValueListParameterOut">
            <PropertyValue Property="LocalDataProperty" PropertyPath="CountryID"/>
            <PropertyValue Property="ValueListProperty" String="CountryIdentifier"/>
          </Record>
          <!-- IN mapping (main entity -> ValueList) -->
          <Record Type="Common.ValueListParameterIn">
            <PropertyValue Property="LocalDataProperty" PropertyPath="RegionID"/>
            <PropertyValue Property="ValueListProperty" String="RegionIdentifier"/>
          </Record>
        </Collection>
      </PropertyValue>
      <!-- This qualifier must point to a UI.PresentationVariant defined on the value-help entity set -->
      <PropertyValue Property="PresentationVariantQualifier" String="Country_Chart"/>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 2 — Define UI.PresentationVariant and UI.Chart on the value-help entity (XML)
DESCRIPTION: Define a UI.PresentationVariant with qualifier Country_Chart on the value-help entity type Z0022 (the CollectionPath). Inside the PresentationVariant reference the UI.Chart (same qualifier). The UI.Chart defines chart type, dimensions, measures and Top to drive the visual-filter visualization.
LANGUAGE: XML
CODE:
```XML
<!-- PresentationVariant and Chart on the value-help entity (Z0022) -->
<Annotations Target="Z0022_CDS.Z0022Type">
  <!-- Chart definition -->
  <Annotation Term="UI.Chart" Qualifier="Country_Chart">
    <Record>
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Column"/>
      <PropertyValue Property="Dimensions">
        <Collection>
          <PropertyPath>CountryIdentifier</PropertyPath>   <!-- each bar = CountryIdentifier -->
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Measures">
        <Collection>
          <PropertyPath>SalesAmount</PropertyPath>         <!-- replace with actual measure -->
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Top" Int="3"/>               <!-- top 3 countries -->
    </Record>
  </Annotation>

  <!-- PresentationVariant references the Chart -->
  <Annotation Term="UI.PresentationVariant" Qualifier="Country_Chart">
    <Record>
      <PropertyValue Property="Visualizations">
        <Collection>
          <AnnotationPath>UI.Chart#Country_Chart</AnnotationPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 3 — ABAP CDS: valueHelpDefinition with presentationVariantQualifier
DESCRIPTION: For ABAP CDS, set presentationVariantQualifier in @Consumption.valueHelpDefinition for the element. Note: ABAP CDS does not support separate Common.ValueListParameterIn and Common.ValueListParameterOut — use inout semantics (the framework handles in/out). Also ensure a UI.PresentationVariant with the matching qualifier is defined for the value-help entity (see XML example).
LANGUAGE: ABAP CDS
CODE:
```ABAP CDS
@Consumption.valueHelpDefinition : [
  {
    entity = {
      name    = 'Z0022',             // CollectionPath (value-help entity set)
      element = 'CountryIdentifier'  // value list property exposed as bar label
    },
    label = 'Country',
    qualifier = '0020_Country',      // ValueList qualifier
    presentationVariantQualifier = 'Country_Chart'   // MUST match UI.PresentationVariant qualifier on Z0022
  }
]
CountryID  : abap.char(10);
```

STEP: 4 — CAP CDS: ValueList annotation with PresentationVariantQualifier
DESCRIPTION: In CAP CDS, add Common.ValueList (qualified) on the element and include PresentationVariantQualifier. Use correct $Type values for parameters. The PresentationVariantQualifier value must match a PresentationVariant/UI.Chart defined on the value-help entity.
LANGUAGE: CAP CDS
CODE:
```CAP CDS
// Inside an entity definition
entity MainEntity {
  CountryID : String @(
    Common : {
      ValueList #0020_Country : {
        Label : 'Country',
        CollectionPath : 'Z0022',
        SearchSupported : false,
        Parameters : [
          {
            $Type             : 'Common.ValueListParameterOut',
            LocalDataProperty : CountryID,
            ValueListProperty : 'CountryIdentifier'
          },
          {
            $Type             : 'Common.ValueListParameterIn',
            LocalDataProperty : RegionID,
            ValueListProperty : 'RegionIdentifier'
          }
        ],
        PresentationVariantQualifier : 'Country_Chart'
      }
    }
  );
}
```

STEP: 5 — Visual-filter runtime behavior (scenarios)
DESCRIPTION: Use these concise rules to predict what updates when a visual-filter bar selection is made.
LANGUAGE: TEXT
CODE:
```
Scenario A — Select a Region bar:
- The Region chart sends RegionID=<value from RegionCode of Z0021> to the main entity filter query.
- ALP refreshes the main content and other charts whose ValueList annotations have RegionID as an IN parameter (e.g., CountryID and PlantID).
- Those charts show top 3 values filtered by the chosen Region.

Scenario B — Select Region then Country:
- Country chart sends CountryID=<value from CountryIdentifier of Z0022> to the main entity filter query.
- ALP refreshes main content and any charts that take CountryID as an IN parameter (e.g., PlantID), combining Region+Country filters.

Scenario C — Select Plant:
- PlantID is an IN parameter only for RegionID in this example.
- Selecting PlantID refreshes main content and the Region chart (showing top 3 regions for the chosen Plant).
```

STEP: 6 — Rules, constraints, and actionable notes
DESCRIPTION: Important actionable rules you must follow when implementing ValueList + PresentationVariant for visual filters.
LANGUAGE: TEXT
CODE:
```
1. PresentationVariantQualifier must point to a UI.PresentationVariant defined on the VALUE-HELP entity (the CollectionPath target), NOT the main entity.

2. The referenced UI.PresentationVariant must include Visualizations that reference a UI.Chart qualifier; the UI.Chart defines Dimensions, Measures, ChartType and Top (e.g., Top=3).

3. ABAP CDS limitation: you cannot model Common.ValueListParameterIn and Common.ValueListParameterOut separately; use the supported in/out semantics (see Step 3).

4. OData V4: the ValueList.CollectionPath must point to the result entity set (the value-help result set) as required for parameterized entities. See "Supporting Parameterized Entities" in Configuring Filter Bars.

5. IN mapping precedence:
   - If a field has a ValueList annotation, any IN mapping defined elsewhere for the same field is ignored for visual-filter queries (the valueList mapping controls what is passed to the value-help).
   - The ignored mapping value is still applied to the main filter query and appears in the visual filter "Selected" button.

6. Mandatory filters:
   - Mandatory filter values are passed automatically to a visual filter only if the value-help entity is the same as the main entity.
   - Otherwise, explicitly define IN mapping in the ValueList.Parameters to ensure mandatory values are applied.

7. UI.Hidden:
   - If the IN mapping points to a field in the value-help entity that is annotated UI.Hidden, ALP IGNOREs the incoming value for the visual filter (it will not be applied).
```

STEP: 7 — Useful links and further configuration (references)
DESCRIPTION: Refer to these docs for related configuration details and filter behavior.
LANGUAGE: TEXT
CODE:
```
- Configuring the Visual Filter Bar: configuring-the-visual-filter-bar-33f3d80.md
- Configuring Filter Bars (Parameterized Entities section): configuring-filter-bars-4bd7590.md#loio4bd7590569c74c61a0124c6e370030f6__suppprting_parameterized_entities_subsection
- In/Out Mappings in the ValueList Annotation: in-out-mappings-in-the-valuelist-annotation-4de40b3.md
- Choosing Filter Modes: choosing-filter-modes-00c19e1.md
```
--------------------------------

**TITLE**: Event-Driven Side Effects (SAP Fiori elements, OData V4)

**INTRODUCTION**: Configure server-triggered side effects in SAP Fiori elements (OData V4). Use annotations to declare events (SourceEvents) emitted by the server via WebSocket, and map them to properties or entities to refresh on the client. Configure WebSocket endpoints and the user interaction type for refresh behavior in manifest.json.

**TAGS**: sap, fiori-elements, odata-v4, side-effects, annotations, websocket, manifest

**STEP**: 1 — Add SideEffects annotation for event-driven property refresh

**DESCRIPTION**: Declare a SideEffects annotation on the EntityType. Use SourceEvents to name events emitted by the server and TargetProperties to list properties that must be refreshed when the event is received. Place this annotation in your annotation XML file (e.g., annotations.xml used by your app or CDS/annotation files consumed by the runtime).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- annotations.xml -->
<Annotations Target="MyService.MyEntityType"> 
    <Annotation Term="com.sap.vocabularies.UI.v1.SideEffects"> 
        <Record Type="SAP__common.SideEffectsType"> 
            <PropertyValue Property="SourceEvents"> 
                <Collection> 
                    <String>MyEventName</String> 
                </Collection> 
            </PropertyValue> 
            <PropertyValue Property="TargetProperties"> 
                <Collection> 
                    <String>Property1</String> 
                    <String>Property2</String> 
                </Collection> 
            </PropertyValue> 
        </Record> 
    </Annotation> 
</Annotations>
```

**STEP**: 2 — Refresh entire list/table: use absolute TargetEntities path

**DESCRIPTION**: For list-report scenarios where the whole table must be refreshed when an event occurs, use an absolute path inside TargetEntities. This instructs the client to refresh the entity set (table) associated with the entity container/EntitySet.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- annotations.xml -->
<Annotations Target="MyService.MyEntityType">
    <Annotation Term="com.sap.vocabularies.UI.v1.SideEffects">
        <Record Type="Common.SideEffectsType">
            <PropertyValue Property="SourceEvents">
                <Collection>
                    <String>MyEventName</String>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetEntities">
                <Collection>
                    <!-- Absolute NavigationPropertyPath to the EntitySet to refresh -->
                    <NavigationPropertyPath>/MyService.EntityContainer/MyEntity</NavigationPropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 3 — Provide WebSocketBaseURL and WebSocketChannel (connect client to server events)

**DESCRIPTION**: Configure the WebSocket connection via annotations on SAP__self.Container. WebSocketBaseURL provides the endpoint base URL; WebSocketChannel (optionally qualified) defines the channel name used for side effects. Add these annotations to your annotation file or backend-provided service annotations consumed by the client.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- annotations.xml -->
<Annotations Target="SAP__self.Container"> 
    <!-- Base URL for the WebSocket connection (string value) -->
    <Annotation Term="SAP__common.WebSocketBaseURL" String="testEndpoint" /> 

    <!-- Channel qualifier "sideEffects" with channel name "cinema" -->
    <Annotation Term="SAP__common.WebSocketChannel" Qualifier="sideEffects" String="cinema" /> 
</Annotations>
```

**STEP**: 4 — Interaction type configuration (global or per-event) in manifest.json

**DESCRIPTION**: Define how the UI reacts when a side-effect event triggers a refresh. Options:
- "Notification": auto-refresh + show notification (default).
- "Confirmation": show confirmation dialog; user decides to refresh.
- "None": auto-refresh without UI interaction.

Configure a single global interaction type or specify a default plus per-event overrides in the application's manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json — global single interaction type
{
    "sap.fe": {
        "app": {
            "sideEffectsEventsInteractionType": "Confirmation"
        }
    }
}
```

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json — default + per-event interaction types
{
    "sap.fe": {
        "app": {
            "sideEffectsEventsInteractionType": {
                "default": "None",
                "events": {
                    "myEventName": "Confirmation",
                    "myOtherEventName": "Notification"
                }
            }
        }
    }
}
```

**STEP**: 5 — Server behavior and client handling (implementation notes)

**DESCRIPTION**: The server must send WebSocket messages containing:
- the event name (matching SourceEvents)
- the entity key (identifies which entity instance to refresh)

On receiving the message, the client:
- checks whether the corresponding entity instance is currently displayed,
- issues an OData read for the entity,
- updates the bound properties (TargetProperties) or refreshes the target EntitySet (TargetEntities) per the annotation.

(No code snippet for server payload is provided here — ensure your server emits messages matching the WebSocket channel and event names configured above.)
--------------------------------

**TITLE**: Add custom columns to a Grid Table in a List Report (SAP Fiori elements, OData V2)

**INTRODUCTION**: This guide shows exactly how to add custom columns to a Grid Table in an SAP Fiori elements List Report (OData V2) using a view fragment and manifest.json view extensions. It includes the fragment XML, required CustomData entries (p13nData), and manifest registration examples including QuickVariantSelectionX per-tab variants.

**TAGS**: fiori-elements-framework, OData V2, List Report, grid table, extension, fragment, manifest, XML, JSON, SAP

STEP: 1 — Create an XML fragment for the Grid Table columns

DESCRIPTION: Create an XML fragment that defines the custom columns. Place the fragment file at webapp/ext/fragments/ListReportGridTableColumns.fragment.xml (or another path you choose and reference in manifest). Use table:customData with key "p13nData" to set columnKey, optional leadingProperty (required if column template binds to a property, e.g., {Price}), and columnIndex to control insertion order. Use core:FragmentDefinition as root and include required xmlns declarations.

LANGUAGE: XML

CODE:
```XML
<!-- File: webapp/ext/fragments/ListReportGridTableColumns.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core"
                         xmlns:table="sap.ui.table"
                         xmlns="sap.m"
                         xmlns:ui5="sap.ui.core">
    <!-- Example: Rating column with a RatingIndicator bound to a property -->
    <table:Column>
        <Label text="Rating" />
        <table:customData>
            <!-- Use single quotes for XML attribute and double quotes inside JSON -->
            <core:CustomData key="p13nData" value='{"columnKey":"Rating","leadingProperty":"Price","columnIndex":"100"}' />
        </table:customData>
        <table:template>
            <!-- Expression binding example using Price property -->
            <RatingIndicator value="{= ${Price} > 500 ? 5 : 1 }" />
        </table:template>
    </table:Column>

    <!-- Example: Test column with a localized Text -->
    <table:Column>
        <Label text="Test" />
        <table:customData>
            <core:CustomData key="p13nData" value='{"columnKey":"Test","columnIndex":"101"}' />
        </table:customData>
        <table:template>
            <Text text="{i18n>xfld.BreakoutColumnContent}" />
        </table:template>
    </table:Column>
</core:FragmentDefinition>
```

STEP: 2 — Register the fragment in manifest.json (single view)

DESCRIPTION: Register the fragment as a view extension under the List Report view. Example shows the minimal "extends" block to attach the fragment to the ListReport view. Replace "STTA_C_MP_Product" and fragmentName with your EntitySet and fragment path (dot notation for module path).

LANGUAGE: JSON

CODE:
```JSON
// snippet inside manifest.json (trim to relevant section)
{
  "extends": {
    "component": "sap.suite.ui.generic.template.ListReport",
    "minVersion": "1.1.0",
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "GridTableColumnsExtension|STTA_C_MP_Product": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportGridTableColumns",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

STEP: 3 — Register fragments per QuickVariantSelectionX tab (multiple table mode)

DESCRIPTION: When using QuickVariantSelectionX (multiple table mode), register a fragment per tab; the extension point name must include the tab key: GridTableColumnsExtension|<EntitySet>|<tabKey>. Use the tab key you defined in QuickVariantSelectionX. If you omit the tab key, the feature still works for compatibility but you cannot provide stable IDs for columns/cells.

LANGUAGE: JSON

CODE:
```JSON
// snippet inside manifest.json for QuickVariantSelectionX per-tab fragments
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "GridTableColumnsExtension|STTA_C_MP_Product|Expensive": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportGridTableColumnsExpensive",
            "type": "XML"
          },
          "GridTableColumnsExtension|STTA_C_MP_Product|Cheap": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportGridTableColumnsCheap",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

STEP: 4 — Important rules and cautions

DESCRIPTION: Follow these rules when implementing the extension:
- Applicable only to SAP Fiori elements for OData V2.
- Use app extensions only when manifest settings or annotations cannot produce the behavior.
- Integrate with SAP Fiori elements only via the official extensionAPI; do not directly manipulate internal controls, models, or properties created by the framework.
- If your column template binds to a property (e.g., {Price}), include "leadingProperty" in the p13nData JSON to allow correct personalization and sorting behavior.
- Use "columnIndex" in p13nData to control the insertion order of extension columns. Higher/lower numeric values determine placement.
--------------------------------

**TITLE**: Example: Adding Columns to a Grid Table in the Object Page

**INTRODUCTION**: This recipe shows how to add custom columns to a grid table in an Object Page (SAP Fiori elements, OData V2). It includes the XML fragment that defines the columns (one text column, one button column), a minimal controller extension placeholder for the button press handler, and the manifest.json registration required to attach the fragment to the Object Page view. Follow safe extension practice: use the SAP Fiori elements extensionAPI and avoid manipulating internal framework controls or models directly.

**TAGS**: fiori-elements-framework, odata-v2, extension, grid-table, object-page, sapui5, view-extension

**STEP**: Context and Caution

**DESCRIPTION**: Applicable only to SAP Fiori elements for OData V2. Use app extensions only when manifest settings or annotations cannot achieve the required behavior. Integrate extension code using the official extensionAPI. Do not access or manipulate internal framework controls, properties, or models directly.

**LANGUAGE**: Text

**CODE**:
```text
Note: Applicable to SAP Fiori elements for OData V2.
Caution: Use extensionAPI only. After creating an app extension, display and runtime behavior are the application's responsibility.
```

**STEP**: 1 — Create the XML fragment that defines custom Grid Table columns

**DESCRIPTION**: Add an XML fragment to define additional columns for the grid table. Place this file in webapp/ext/fragments/ProductTextGridTableColumns.fragment.xml. The fragment adds two columns: a text column and a button column. Keep the xmlns declarations and use sap.ui.table:Column with a table:template child.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/fragments/ProductTextGridTableColumns.fragment.xml -->
<core:FragmentDefinition 
    xmlns:core="sap.ui.core" 
    xmlns:table="sap.ui.table" 
    xmlns="sap.m" 
    xmlns:sfi="sap.ui.comp.smartfield">

    <table:Column width="150px">
        <Label text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumn}" />
        <table:template>
            <Text text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumnContent}" />
        </table:template>
    </table:Column>

    <table:Column width="160px">
        <Label text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumn}" />
        <table:template>
            <Button text="GridTab.Button" press="onGridTableBreakoutButtonPress" />
        </table:template>
    </table:Column>

</core:FragmentDefinition>
```

**STEP**: 2 — Implement the controller extension method for the button press

**DESCRIPTION**: Implement a controller extension that contains the press handler referenced by the fragment (onGridTableBreakoutButtonPress). Place this file under webapp/ext/controller/Extension.controller.js. Use the extensionAPI within this handler to interact with the app; do not access internal framework internals directly. The following is a minimal controller extension skeleton — replace the body with the real behavior, using extensionAPI calls as needed.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/controller/Extension.controller.js
sap.ui.define([
    "sap/ui/core/mvc/Controller"
], function(Controller) {
    "use strict";

    return Controller.extend("STTA_MP.ext.controller.Extension", {
        /**
         * Press handler referenced from the fragment button (press="onGridTableBreakoutButtonPress").
         * Implement actual logic here. Use the SAP Fiori elements extensionAPI where required.
         * @param {sap.ui.base.Event} oEvent
         */
        onGridTableBreakoutButtonPress: function(oEvent) {
            // Example: minimal placeholder implementation
            // Replace with calls to extensionAPI to access contexts, navigation, dialogs, etc.
            console.log("Grid table breakout button pressed", oEvent);

            // Example usage pattern (implement using the actual extensionAPI available in your context):
            // var oExtensionAPI = this.extensionAPI; // available if provided by the host app
            // oExtensionAPI.navigate(...);
        }
    });
});
```

**STEP**: 3 — Register the fragment (and controller extension) in manifest.json

**DESCRIPTION**: Register the fragment as a view extension for the Object Page Details view in manifest.json. Also register the controller extension so the onGridTableBreakoutButtonPress handler is available. Update the paths and names to match your app namespace if different. Place the manifest at the project root (webapp/manifest.json).

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (partial - add under the root)
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        // Register controller extension so the handler function is available
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "STTA_C_MP_Product": "STTA_MP.ext.controller.Extension"
        }
      },
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          // Register the fragment as a GridTableColumnsExtension for the specific facet/line item
          "GridTableColumnsExtension|STTA_C_MP_ProductText|to_ProductTextNavigation::com.sap.vocabularies.UI.v1.LineItem": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ProductTextGridTableColumns",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Notes for integration and validation

**DESCRIPTION**: After adding the fragment and registering it:
- Ensure file paths and fragmentName match the namespace and folder structure (e.g., STTA_MP.ext.fragments.ProductTextGridTableColumns maps to webapp/ext/fragments/ProductTextGridTableColumns.fragment.xml).
- Ensure the controller extension namespace matches the manifest entry.
- Test in the Object Page that the grid table displays the new columns and that the button press triggers your handler.
- Adhere to the caution: use only extensionAPI; do not manipulate internal controls or models created by the SAP Fiori elements framework.
--------------------------------

**TITLE**: Adding Custom Columns to a Responsive Table in a List Report (Fiori Elements)

**INTRODUCTION**: This guide shows how to add custom columns to a responsive table in a SAP Fiori elements List Report by implementing two view fragments (column definitions and cell content) and registering them in manifest.json. Use these steps when manifest settings/annotations cannot produce the required UI. Follow the extensionAPI rules and avoid manipulating internal framework controls or models.

**TAGS**: fiori-elements-framework, extension, responsive-table, list-report, fragments, manifest, sapui5, odata-v2, odata-v4, extensionAPI

STEP: 1 — Create fragment for column definitions

DESCRIPTION: Define the custom columns (header labels and p13n metadata). Save this XML as webapp/ext/fragments/ListReportResponsiveTableColumns.fragment.xml. Use the customData p13nData JSON to set columnKey, optional leadingProperty (if cell content binds to an entity property), and columnIndex to control ordering. Use single quotes for the attribute value so the JSON can use double quotes.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/ext/fragments/ListReportResponsiveTableColumns.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
  <Column>
    <Text text="{i18n|sap.suite.ui.generic.template.ListReport|STTA_C_MP_Product>xfld.Rating}" />
    <customData>
      <core:CustomData key="p13nData"
        value='{"columnKey":"Rating","leadingProperty":"Price","columnIndex":"100"}' />
    </customData>
  </Column>

  <Column>
    <Text text="{i18n|sap.suite.ui.generic.template.ListReport|STTA_C_MP_Product>xfld.BreakoutColumn}" />
    <customData>
      <core:CustomData key="p13nData"
        value='{"columnKey":"Test","columnIndex":"101"}' />
    </customData>
  </Column>
</core:FragmentDefinition>
```

STEP: 2 — Create fragment for cell content

DESCRIPTION: Define the cell controls that correspond to the custom columns. Save this XML as webapp/ext/fragments/ListReportResponsiveTableCells.fragment.xml. Bind values to properties (e.g., Price) and use expression binding as needed.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/ext/fragments/ListReportResponsiveTableCells.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
  <!-- Custom cell for "Rating" column; example: show a RatingIndicator based on Price -->
  <RatingIndicator value="{= ${Price} > 500 ? 1 : 5 }" />

  <!-- Custom cell for "Test"/BreakoutColumn -->
  <Text text="{i18n|sap.suite.ui.generic.template.ListReport|STTA_C_MP_Product>xfld.BreakoutColumnContent}" />
</core:FragmentDefinition>
```

STEP: 3 — Register fragments in manifest.json (basic, single-view)

DESCRIPTION: Register both fragments using the sap.ui.viewExtensions extension point for the List Report view. Replace STTA_C_MP_Product and fragmentName values with your entity set and fragment names. Add these entries under "extends" → "extensions" → "sap.ui.viewExtensions".

LANGUAGE: JSON

CODE:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "ResponsiveTableColumnsExtension|STTA_C_MP_Product": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableColumns",
            "type": "XML"
          },
          "ResponsiveTableCellsExtension|STTA_C_MP_Product": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableCells",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

STEP: 4 — Register fragments per QuickVariantSelectionX tab (multiple table mode)

DESCRIPTION: If QuickVariantSelectionX is used, register extensions per tab by appending |<tabKey> to the extension names (ResponsiveTableColumnsExtension|<EntitySet>|<tabKey> and ResponsiveTableCellsExtension|<EntitySet>|<tabKey>). This enables separate column sets per tab. If you reuse the same fragment for multiple tabs, set an "id" property on each extension entry to guarantee unique control IDs.

LANGUAGE: JSON

CODE:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "ResponsiveTableColumnsExtension|STTA_C_MP_Product|Expensive": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableColumns",
            "type": "XML",
            "id": "Expensive"
          },
          "ResponsiveTableCellsExtension|STTA_C_MP_Product|Expensive": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableCells",
            "type": "XML",
            "id": "Expensive"
          },
          "ResponsiveTableColumnsExtension|STTA_C_MP_Product|Cheap": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableColumns",
            "type": "XML",
            "id": "Cheap"
          },
          "ResponsiveTableCellsExtension|STTA_C_MP_Product|Cheap": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportResponsiveTableCells",
            "type": "XML",
            "id": "Cheap"
          }
        }
      }
    }
  }
}
```

STEP: 5 — Implementation notes and rules

DESCRIPTION:
- Use extensionAPI only; do not access or manipulate internal controls, properties, or models created by Fiori elements.
- If a custom column's cell binds to an entity property (e.g., {Price}), include that property as "leadingProperty" in the column's p13nData so personalization and sorting/filtering mechanisms recognize it.
- Use "columnIndex" in p13nData to control column ordering.
- If you omit the |<tabKey> suffix for QuickVariantSelectionX, the feature still works for compatibility, but you cannot provide stable IDs for columns and cells.
- For OData V4 and more advanced scenarios, consult the "Extension Points for Tables" topic and the extensionAPI docs.
--------------------------------

**TITLE**: Add Custom Columns to a Responsive Table on the Object Page (Fiori Elements)

**INTRODUCTION**: This guide shows the minimal code changes required to add a custom column and its cell content to a responsive table on an Object Page in a SAP Fiori elements app. Implement two view extensions: one fragment that defines the Column element (header and p13n data) and one fragment that defines the cell content. Register both fragments in webapp/manifest.json under the appropriate view extension keys.

**TAGS**: fiori-elements-framework, sapui5, responsive-table, object-page, manifest, fragments, extension-points, ODataV2, ODataV4, extensionAPI

**STEP**: 1 — Create fragment for custom Column (header + p13nData)

**DESCRIPTION**: Add an XML fragment that defines the new Column element including a localized header text and p13nData custom data that Fiori Elements uses for personalization (columnKey and columnIndex). Save under webapp/ext/fragments/ProductTextResponsiveTableColumns.fragment.xml.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/fragments/ProductTextResponsiveTableColumns.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
    <Column>
        <Text text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumn}" />
        <customData>
            <!-- p13nData must be a JSON string; using single quotes around the attribute to allow JSON double quotes -->
            <core:CustomData key="p13nData" value='{"columnKey": "Test", "columnIndex" : "101"}' />
        </customData>
    </Column>
</core:FragmentDefinition>
```

**STEP**: 2 — Create fragment for custom cell content

**DESCRIPTION**: Define the cell content fragment that will be inserted for each row in the custom column. Save under webapp/ext/fragments/ProductTextResponsiveTableCells.fragment.xml.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/fragments/ProductTextResponsiveTableCells.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
    <Text text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumnContent}" />
</core:FragmentDefinition>
```

**STEP**: 3 — Register fragments in manifest.json (view extensions)

**DESCRIPTION**: Register both fragments as viewExtensions for the Object Page Details view. Add the entries under "extends" → "extensions" → "sap.ui.viewExtensions" in webapp/manifest.json. Use the exact extension keys for responsive table columns and cells. Replace the fragmentName values with the namespace/path used in your project (example uses STTA_MP.ext.fragments.*).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "component": "sap.suite.ui.generic.template.ListReport",
    "minVersion": "1.1.0",
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "ResponsiveTableColumnsExtension|STTA_C_MP_ProductText|to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ProductTextResponsiveTableColumns",
            "type": "XML"
          },
          "ResponsiveTableCellsExtension|STTA_C_MP_ProductText|to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ProductTextResponsiveTableCells",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Important integration notes (use extensionAPI and app responsibility)

**DESCRIPTION**: Only use app extensions when manifest settings or annotations cannot achieve the behavior. When implementing extensions:
- Use only the SAP Fiori elements extensionAPI to interact with framework features.
- The app code is responsible for display and behaviour of the extension (control placement, binding, busy handling, models). Do not rely on or manipulate internal framework controls, properties, or models.
- For naming patterns and other table extension examples, consult the Extension Points for Tables reference (use this naming convention: ResponsiveTableColumnsExtension|<EntitySetKey>|<navigation>::<LineItemAnnotation> and ResponsiveTableCellsExtension|...).

**LANGUAGE**: text

**CODE**:
```text
Place fragments in: webapp/ext/fragments/
Register changes in: webapp/manifest.json (under "extends" -> "extensions" -> "sap.ui.viewExtensions")
Follow naming: ResponsiveTableColumnsExtension|<EntitySetKey>|<navigation>::com.sap.vocabularies.UI.v1.LineItem
and ResponsiveTableCellsExtension|<EntitySetKey>|<navigation>::com.sap.vocabularies.UI.v1.LineItem
```
--------------------------------

**TITLE**: Add Custom Columns to a Tree Table in a List Report (SAP Fiori elements, OData V2)

**INTRODUCTION**: This guide shows how to add custom columns to a Tree Table in a SAP Fiori elements List Report (OData V2) using a view fragment and registering it in the app manifest. It includes the fragment XML, manifest.json extension registration, and required metadata (columnIndex, leadingProperty) so the framework integrates the custom columns correctly.

**TAGS**: fiori-elements-framework, OData V2, list report, tree table, UI5, extension, fragment, manifest, QuickVariantSelectionX

**STEP**: 1 — Create fragment with custom columns

**DESCRIPTION**: Create an XML fragment that defines one or more sap.ui.table:Column elements and their templates. Place the fragment under the application path (example): webapp/ext/fragments/ListReportTreeTableColumns.fragment.xml. Use core:CustomData with key "p13nData" to provide:
- columnKey: unique column key
- columnIndex: numeric ordering to position the custom column among framework-managed columns
- leadingProperty: (required) when the column template binds to an entity property (e.g., {Price}), include the leadingProperty so the framework knows the underlying OData property for personalization, sorting, etc.

Example fragment: two columns (Rating and Test). The first column uses a RatingIndicator bound to {Price} via expression binding. Column ordering is controlled via columnIndex values.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/ext/fragments/ListReportTreeTableColumns.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core"
                         xmlns:table="sap.ui.table"
                         xmlns="sap.m">
    <!-- Column 1: Rating (uses property Price -> include leadingProperty) -->
    <table:Column>
        <Label text="Rating" />
        <table:customData>
            <!-- p13nData JSON must be provided as attribute value -->
            <core:CustomData key="p13nData"
                             value='{"columnKey":"Rating","leadingProperty":"Price","columnIndex":"100"}' />
        </table:customData>
        <table:template>
            <!-- Example: expression binding based on Price -->
            <RatingIndicator value="{= ${Price} > 500 ? 1 : 5 }" />
        </table:template>
    </table:Column>

    <!-- Column 2: Test (static or i18n text) -->
    <table:Column>
        <Label text="Test" />
        <table:customData>
            <core:CustomData key="p13nData"
                             value='{"columnKey":"Test","columnIndex":"101"}' />
        </table:customData>
        <table:template>
            <Text text="{i18n>sap.suite.ui.generic.template.ListReport>STTA_C_MP_Product>xfld.BreakoutColumnContent}" />
        </table:template>
    </table:Column>
</core:FragmentDefinition>
```

**STEP**: 2 — Register the fragment in manifest.json (single-view / default)

**DESCRIPTION**: Register the fragment under the List Report view extension point in the application's manifest.json. The extension point name for tree table columns is TreeTableColumnsExtension|<EntitySet>. Replace <EntitySet> with your entity set name (example STTA_C_MP_Product). Use "sap.ui.core.Fragment" for className, provide the fragmentName (namespace + file path without .xml) and type "XML". Place this entry under "extends" -> "extensions" -> "sap.ui.viewExtensions" for the ListReport view.

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (snippet)
{
  "extends": {
    "component": "sap.suite.ui.generic.template.ListReport",
    "minVersion": "1.1.0",
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "TreeTableColumnsExtension|STTA_C_MP_Product": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportTreeTableColumns",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Register fragments per QuickVariantSelectionX tab (multiple table mode)

**DESCRIPTION**: If your List Report uses QuickVariantSelectionX (multiple table/tab mode), you must register the fragment per tab. Use the extension name: TreeTableColumnsExtension|<EntitySet>|<tabKey>, where <tabKey> is the key you defined in QuickVariantSelectionX. Providing tabKey enables stable IDs for columns and cells. For backward compatibility omitting the tabKey still works but you will not get stable IDs.

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (snippet for QuickVariantSelectionX tabs)
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "TreeTableColumnsExtension|STTA_C_MP_Product|Expensive": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportTreeTableColumnsExpensive",
            "type": "XML"
          },
          "TreeTableColumnsExtension|STTA_C_MP_Product|Cheap": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.ListReportTreeTableColumnsCheap",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Implementation rules and cautions

**DESCRIPTION**: Follow these rules when implementing extensions:
- Only use SAP Fiori elements' official extensionAPI for interactions: do not access or manipulate internal framework controls, properties, models, or bindings directly.
- After adding a fragment extension, your extension code is responsible for the display and behavior of the controls you add (layout, busy handling, model usage).
- Always include "leadingProperty" in p13nData when the column template binds to an entity property (e.g., {Price}) so personalization, sort, filter work correctly.
- Use columnIndex in p13nData to place your custom column at the required position relative to framework-managed columns.

**LANGUAGE**: plain text

**CODE**:
```text
- Fragment file location example: webapp/ext/fragments/ListReportTreeTableColumns.fragment.xml
- manifest.json registration location: webapp/manifest.json under extends.extensions.sap.ui.viewExtensions
- p13nData keys: columnKey (string), columnIndex (string or number), leadingProperty (string, required if binding to a property)
- Extension naming for single table: "TreeTableColumnsExtension|<EntitySet>"
- Extension naming for multiple-table (QuickVariantSelectionX): "TreeTableColumnsExtension|<EntitySet>|<tabKey>"
```
--------------------------------

**TITLE**: Add Custom Columns to an Analytical Table on the Object Page (OData V2, SAP Fiori elements)

**INTRODUCTION**: This guide shows how to add custom columns (text + action button) to an AnalyticalTable on the Object Page using a view fragment and registering it via manifest.json. Applicable to SAP Fiori elements for OData V2. Use app extensions only when manifest settings or annotations cannot achieve the required behavior. Implement runtime behavior only via the Fiori elements extensionAPI.

**TAGS**: sapui5, fiori-elements, analytical-table, object-page, view-extension, fragment, manifest, odata-v2

**STEP**: 1 — Create the XML fragment that defines the additional AnalyticalTable columns

**DESCRIPTION**: Create a fragment file under webapp/ext/fragments and add two AnalyticalColumn definitions: one text column and one action button column. Add personalization metadata (p13nData) for each column using core:CustomData with a unique columnKey. Keep the press handler name consistent if you implement it in a controller extension.

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="UTF-8"?>
<!-- File: webapp/ext/fragments/ProductSalesDataAnalyticalTableColumns.fragment.xml -->
<core:FragmentDefinition
    xmlns:core="sap.ui.core"
    xmlns:table="sap.ui.table"
    xmlns="sap.m"
    xmlns:sfi="sap.ui.comp.smartfield">

    <!-- Text column -->
    <table:AnalyticalColumn width="150px">
        <Label text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumn}" />
        <table:template>
            <Text text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumnContent}" />
        </table:template>
        <table:customData>
            <!-- p13nData JSON must be a string; use a unique columnKey -->
            <core:CustomData key="p13nData" value='{"columnKey":"breakoutTextColumn"}' />
        </table:customData>
    </table:AnalyticalColumn>

    <!-- Action button column -->
    <table:AnalyticalColumn width="170px">
        <Label text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.BreakoutColumn}" />
        <table:template>
            <Button
                text="{i18n|sap.suite.ui.generic.template.ObjectPage|STTA_C_MP_Product>xfld.AnalyticalTableButton}"
                press="onAnalyticalTableBreakoutButtonPress" />
        </table:template>
        <table:customData>
            <core:CustomData key="p13nData" value='{"columnKey":"breakoutActionColumn"}' />
        </table:customData>
    </table:AnalyticalColumn>

</core:FragmentDefinition>
```

**STEP**: 2 — Register the fragment as a view extension in manifest.json

**DESCRIPTION**: Register the fragment under sap.ui.viewExtensions for the Object Page Details view. Use the exact fragmentName (adjust prefix/namespace to match your app). Place this inside your webapp/manifest.json under the sap.ui5 root.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "AnalyticalTableColumnsExtension|STTA_C_MP_ProductSalesData|to_ProductSalesData::com.sap.vocabularies.UI.v1.LineItem": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "STTA_MP.ext.fragments.ProductSalesDataAnalyticalTableColumns",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Implement the action handler in a controller extension (optional but required for the button)

**DESCRIPTION**: Implement the handler referenced in the fragment (onAnalyticalTableBreakoutButtonPress) inside a controller extension module. Place the file under webapp/ext/controllers and implement your logic using extensionAPI only. Adjust the controller module name/namespace to match your project and register the controller extension according to your app setup (see Using the extensionAPI).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/controllers/ObjectPageExt.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/m/MessageToast"
], function (Controller, MessageToast) {
  "use strict";

  return Controller.extend("your.app.namespace.ext.controllers.ObjectPageExt", {
    /**
     * Press handler for the breakout button in the analytical table.
     * Use only extensionAPI and approved Fiori elements integration points.
     */
    onAnalyticalTableBreakoutButtonPress: function (oEvent) {
      var oButton = oEvent.getSource();
      var oContext = oButton.getBindingContext();
      // Example: show a toast, replace with real breakout logic
      MessageToast.show("Breakout action triggered for item: " + (oContext ? oContext.getProperty("ProductID") : "<no context>"));

      // TODO: implement detailed behavior using extensionAPI only
    }
  });
});
```

**STEP**: 4 — Recommendations and notes

**DESCRIPTION**: 
- This example is for OData V2 and SAP Fiori elements only.
- Do not manipulate internal framework controls or models directly; use extensionAPI methods.
- Ensure the fragmentName and controller module names match your app namespace and the registration entries in manifest.json.
- Provide unique columnKey values in p13nData for personalization support.
--------------------------------

**TITLE**: Add Custom Filter Fields to Object Page Table Toolbar (OData V2)

**INTRODUCTION**: This guide shows how to add custom filter controls (Select, ComboBox, DatePicker, Text) into the table toolbar of an Object Page table in SAP Fiori elements (OData V2). It covers the manifest extension registration, XML fragment for toolbar controls, and controller extension methods to apply the filter to the table binding using onBeforeRebindTableExtension and to trigger rebind after selection.

**TAGS**: fiori-elements-framework, OData V2, UI5, object-page, table-toolbar, fragment, manifest, extension, OverflowToolbarLayoutData

**STEP**: 1 — Register table toolbar fragment in manifest.json

**DESCRIPTION**: Add a view extension entry under the manifest key "sap.ui.viewExtensions" inside "extends.extensions". The manifest key format is:
TableToolBarExtension|<EntitySet>|<facetId>
Use the fragmentName to point to the XML fragment (namespace based) and set type "XML" and className "sap.ui.core.Fragment".

Place this snippet into your webapp/manifest.json under the "extends" root (example shows only the relevant section).

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (insert under "extends")
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "TableToolBarExtension|STTA_C_MP_Product|to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "STTA_MP.ext.fragments.OPCustomFilter",
            "type": "XML"
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Create XML fragment with toolbar controls

**DESCRIPTION**: Create the fragment referenced by fragmentName. Example path for namespace STTA_MP.ext.fragments.OPCustomFilter:
webapp/ext/fragments/OPCustomFilter.fragment.xml

Use OverflowToolbarLayoutData with priority="NeverOverflow" on controls and labels to prevent overflow in the table toolbar (applies to overflow toolbar only).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/ext/fragments/OPCustomFilter.fragment.xml -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:layout="sap.m"
    >
    <!-- Label with NeverOverflow to prevent toolbar overflow -->
    <Label 
        text="{i18n>ST_GENERIC_LANGUAGE_FILTER}" 
        labelFor="filterId">
        <layoutData>
            <OverflowToolbarLayoutData priority="NeverOverflow"/>
        </layoutData>
    </Label>

    <!-- Select control with NeverOverflow and change handler -->
    <Select id="filterId" change="onCustomFilterChange">
        <items>
            <core:Item key="0" text="{i18n>ST_GENERIC_ENGLISH_LANGUAGE_FILTER}"/>
            <core:Item key="1" text="{i18n>ST_GENERIC_MANDARIN_LANGUAGE_FILTER}"/>
        </items>
        <layoutData>
            <OverflowToolbarLayoutData priority="NeverOverflow"/>
        </layoutData>
    </Select>
</core:FragmentDefinition>
```

**STEP**: 3 — Implement controller extension methods

**DESCRIPTION**: Add two functions in your controller extension:
- onCustomFilterChange: called when the custom control value changes. It finds the SmartTable and calls rebindTable() to trigger onBeforeRebindTableExtension.
- onBeforeRebindTableExtension: called before the table rebinding; inspect bindingParams and append a Filter based on the selected key.

Import sap/ui/core/Element and sap/ui/model/Filter in the controller module. Adjust the SmartTable ID and filter control ID to match your app's generated IDs (example IDs are the full generated IDs in this app). If you use a different namespace/IDs, replace them accordingly.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example controller extension file (e.g., webapp/ext/controller/CustomFilter.controller.js)
sap.ui.define([
  "sap/ui/core/Element",
  "sap/ui/model/Filter"
], function (Element, Filter) {
  "use strict";

  return {
    /**
     * Called from fragment Select change event.
     * Triggers SmartTable rebind so onBeforeRebindTableExtension is executed.
     */
    onCustomFilterChange: function (oEvent) {
      // Replace the long ID below with your SmartTable's ID if different
      var smartTable = Element.getElementById(
        "STTA_MP::sap.suite.ui.generic.template.ObjectPage.view.Details::STTA_C_MP_Product--to_ProductText::com.sap.vocabularies.UI.v1.LineItem::Table"
      );
      if (smartTable && typeof smartTable.rebindTable === "function") {
        smartTable.rebindTable();
      }
    },

    /**
     * Extension hook called by the table before rebind.
     * Adds filters to bindingParams based on the selected key in the custom control.
     */
    onBeforeRebindTableExtension: function (oEvent) {
      var oBindingParams = oEvent.getParameter("bindingParams") || {};
      oBindingParams.parameters = oBindingParams.parameters || {};

      // Replace with the ID of the Select in your fragment if different
      var customFilter = Element.getElementById(
        "STTA_MP::sap.suite.ui.generic.template.ObjectPage.view.Details::STTA_C_MP_Product--filterId"
      );
      var key = customFilter && customFilter.getSelectedKey && customFilter.getSelectedKey();

      switch (key) {
        case "0":
          oBindingParams.filters = oBindingParams.filters || [];
          oBindingParams.filters.push(new Filter("Language", "EQ", "EN"));
          break;

        case "1":
          oBindingParams.filters = oBindingParams.filters || [];
          oBindingParams.filters.push(new Filter("Language", "EQ", "ZH"));
          break;

        default:
          // no custom filter applied
          return;
      }
    }
  };
});
```

**STEP**: 4 — Notes & troubleshooting

**DESCRIPTION**: Important integration notes:
- This example applies to SAP Fiori elements for OData V2 only.
- Ensure manifest key matches your entitySet and facetId exactly.
- OverflowToolbarLayoutData priority="NeverOverflow" applies to the overflow toolbar of the toolbar controls only.
- If generated IDs differ in your project, use UI5 control lookup strategies (Element.byId / sap.ui.getCore().byId or view.byId) that are appropriate to your extension context.

**LANGUAGE**: Plain text

**CODE**:
```text
Related: Generic Action Buttons in Tables on the Object Page — use annotations for generic table actions if needed.
```
--------------------------------

**TITLE**: Apply Custom Logic When a Table Is Loaded or Refreshed (onBeforeRebindTableExtension)

**INTRODUCTION**: This document shows how to register a controller extension for an Object Page and implement onBeforeRebindTableExtension to run custom logic when a table is loaded or refreshed. Applicable only to SAP Fiori elements for OData V2. Use only the official extensionAPI; do not access internal framework controls, models, or properties directly.

**TAGS**: fiori-elements-framework, odata-v2, sapui5, extension, controller-extension, manifest, onBeforeRebindTableExtension, object-page, table

**STEP**: 1 — Register the controller extension in manifest.json

**DESCRIPTION**: Add a controller extension entry under sap.ui5 -> extends -> extensions -> sap.ui.controllerExtensions. Use the framework view name ("sap.suite.ui.generic.template.ObjectPage.view.Details") as the key and set controllerName to your extension module ID. The module ID maps to a file path: e.g., "STTA_MP.ext.controller.DetailsExtension" -> webapp/ext/controller/DetailsExtension.controller.js (or similar project structure).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "controllerName": "STTA_MP.ext.controller.DetailsExtension"
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Implement the controller extension (onBeforeRebindTableExtension)

**DESCRIPTION**: Create the controller module referenced in manifest.json. Implement onBeforeRebindTableExtension(oEvent). Use oEvent.getSource().getId() to determine which table triggered the rebinding. For pages with multiple tables, compare the source id to the specific tableId (an example full id is provided). Place your custom binding/filter/presentation logic inside the matching case. Return or exit for non-target tables. Follow SAP Fiori elements guidance: use only the extensionAPI and avoid manipulating internal framework objects.

Map module name to file path example:
- Module: "STTA_MP.ext.controller.DetailsExtension"
- File path: webapp/ext/controller/DetailsExtension.controller.js

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/controller/DetailsExtension.controller.js
sap.ui.define([], function() {
    "use strict";
    return {
        /**
         * Called by the framework before a table is rebound (loaded/refreshed).
         * @param {sap.ui.base.Event} oEvent - Event passed by the framework
         */
        onBeforeRebindTableExtension: function(oEvent) {
            // ID of the control that triggered the event
            var oID = oEvent.getSource().getId();

            // Example: full tableId for a specific line item table in the Object Page
            var tableId = "STTA_MP::sap.suite.ui.generic.template.ObjectPage.view.Details::STTA_C_MP_Product--to_ProductText::com.sap.vocabularies.UI.v1.LineItem::Table";

            // Selectively apply logic only for the intended table
            switch (oID) {
                case tableId:
                    // Implement your custom logic for this specific table.
                    // Examples (implement via extensionAPI / binding params):
                    // - Modify binding parameters: oEvent.getParameter("bindingParams").filters.push(...)
                    // - Add custom filters, sorters, or default selections
                    // - Set custom request parameters via bindingParams
                    // Replace the following with concrete code:
                    // var oBindingParams = oEvent.getParameter("bindingParams");
                    // oBindingParams.filters.push(/* your sap.ui.model.Filter instance */);
                    break;

                default:
                    // Default logic for other tables (optional).
                    // If you don't need to handle other tables, simply return.
                    return;
            }
        }

        // Add other extension functions if needed
    };
});
```
--------------------------------

**TITLE**: Custom State Handling for Fiori Elements (OData V2) — Map Example

**INTRODUCTION**: Shows how to implement inner app state handling for custom UI elements in SAP Fiori elements (OData V2). Example covers two custom state items (zoomFactor and selectedCity), how to report them to the framework, and how to restore them. Use in a custom controller for a UI extension (map component).

**TAGS**: fiori-elements, odata-v2, custom-ui, app-state, extensionAPI, bookmarks, pagination, session, javascript

**STEP**: 1 — Controller properties and initialization

**DESCRIPTION**: Define controller-level properties used to store custom UI state and a guard flag isAdoptingState to avoid reacting to state application as if it were user input.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Controller skeleton (place into your custom controller)
var MyMapController = {
    // Stored custom state
    zoomFactor: 50,        // number in range 1..100
    country: null,
    city: null,

    // Guard to avoid feedback loops when applying state
    isAdoptingState: false
};
```

**STEP**: 2 — Report user-driven changes (change handlers)

**DESCRIPTION**: Implement handlers that the map UI should call when the user changes zoom or selects a city. When these handlers run for real user actions (not while applying state), inform the framework about the changed custom state via the extension API. Use onCustomStateChange for the state that should be shared across instances/pagination/session, and onCustomAppStateChange for state tied only to the current app instance (bookmarkable/permanent).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Called when the user changes zoom on the map
MyMapController.onZoomFactorChange = function(iZoomFactor) {
    if (!this.isAdoptingState) { // ignore changes that come from applying state
        this.zoomFactor = iZoomFactor;
        // Tell framework that the custom UI area state (shared/pagination/session) changed
        this.extensionAPI.onCustomStateChange();
    }
};

// Called when the user selects a city on the map
MyMapController.onSelectedCityChange = function(sCountry, sCity) {
    if (!this.isAdoptingState) { // ignore changes that come from applying state
        this.country = sCountry;
        this.city = sCity;
        // Tell framework that the custom app state (bookmarkable for this instance) changed
        this.extensionAPI.onCustomAppStateChange();
    }
};
```

**STEP**: 3 — Provide the custom state (framework request)

**DESCRIPTION**: Implement provideCustomStateExtension(oState) to supply the framework with the current custom state when it requests it. For each custom state key, provide an object with data and a lifecycle descriptor. Use lifecycle.session and lifecycle.pagination for state that should persist for the session and be carried to other pages; use lifecycle.permanent for bookmarkable state stored on the frontend server.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
MyMapController.provideCustomStateExtension = function(oState) {
    // zoomFactor: share across pagination and retain for the session
    oState.zoomFactor = {
        data: this.zoomFactor,
        lifecycle: {
            session: true,
            pagination: true
        }
    };

    // selectedCity: do not pass to other instances, but make bookmarkable (frontend storage)
    oState.selectedCity = {
        data: {
            country: this.country,
            city: this.city
        },
        lifecycle: {
            permanent: true
        }
    };
};
```

**STEP**: 4 — Apply a given custom state (framework delivers stored state)

**DESCRIPTION**: Implement applyCustomStateExtension(oState, bIsSameAsLast) to restore state supplied by the framework. If bIsSameAsLast is true, skip restoring. Otherwise set isAdoptingState=true during the restoration to avoid triggering change handlers and feedback loops. Use helper setters to update your UI.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
MyMapController.applyCustomStateExtension = function(oState, bIsSameAsLast) {
    if (bIsSameAsLast) {
        return; // nothing to do
    }

    this.isAdoptingState = true;

    // Apply zoomFactor if present
    if (oState && oState.zoomFactor && oState.zoomFactor.data !== undefined) {
        this.setZoomFactor(oState.zoomFactor.data);
    }

    // Apply selectedCity if present
    if (oState && oState.selectedCity && oState.selectedCity.data) {
        var cityData = oState.selectedCity.data;
        this.setSelectedCity(cityData.country, cityData.city);
    }

    this.isAdoptingState = false;
};
```

**STEP**: 5 — Helper setters that update the UI

**DESCRIPTION**: Implement setters that update internal values and perform the UI changes (map zoom, city selection). These functions may trigger UI events — rely on isAdoptingState to prevent invoking the change handlers while applying state.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
MyMapController.setZoomFactor = function(iZoomFactor) {
    this.zoomFactor = iZoomFactor;
    // TODO: custom code to set the map zoom level, e.g.:
    // this.map.setZoom(iZoomFactor);
};

MyMapController.setSelectedCity = function(sCountry, sCity) {
    this.country = sCountry;
    this.city = sCity;
    // TODO: custom code to highlight or focus the selected city on the map, e.g.:
    // this.map.selectCity({ country: sCountry, city: sCity });
};
```

**STEP**: 6 — Implementation notes and recommendations

**DESCRIPTION**: Practical tips to avoid issues when applying/restoring state.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Notes (keep as comments or documentation within your controller):
// - This approach is only applicable for SAP Fiori elements for OData V2.
// - Keep the controller property isAdoptingState and set it to true while applying state
//   to prevent setZoomFactor/setSelectedCity from firing onZoomFactorChange/onSelectedCityChange.
// - Use the lifecycle flags exactly as required:
//     - session: true and pagination: true for state that must remain valid for the session and
//       be passed on pagination (e.g., zoomFactor).
//     - permanent: true for state that should be bookmarkable/persisted for the current instance
//       on the frontend server (e.g., selectedCity).
```
--------------------------------

**TITLE**: Enable Conditional Internal Navigation to a Different Detail Page (OData V2 & V4)

**INTRODUCTION**: This guide shows how to enable conditional internal navigation from a list report to different detail/object pages depending on row data. It covers:
- OData V2: implement onListNavigationExtension (list report) and onChildOpenedExtension (visual selection sync) and manifest pages for multiple object pages.
- OData V4: define routes in manifest and implement routing.onBeforeNavigation in ControllerExtension for list and object page extensions.

**TAGS**: fiori-elements, navigation, internal-navigation, odata-v2, odata-v4, controller-extension, manifest

STEP: OData V2 — Implement onListNavigationExtension in the List Report controller extension

DESCRIPTION: Add an onListNavigationExtension function in your list report controller extension. Inspect the selected row's binding context and decide a navigation target navigation property. Use the extensionAPI to perform an internal navigation via navigateInternal. Return true if you handled navigation (to prevent default), otherwise return false.

LANGUAGE: JavaScript

CODE:
```JavaScript
// Example: inside your List Report controller extension (e.g. ListReportExtension.controller.js)
onListNavigationExtension: function(oEvent) {
    // oEvent - navigation event from the list/table row
    var oBindingContext = oEvent.getSource().getBindingContext();
    var oObject = oBindingContext.getObject();
    var sNavigationProperty;

    // decide navigation property based on a column value
    switch (oObject.Column3) {
        case "100":
            sNavigationProperty = "NavigationProperty1";
            break;
        case "200":
            sNavigationProperty = "NavigationProperty2";
            break;
    }

    if (sNavigationProperty) {
        var oExtensionAPI = this.extensionAPI;
        var fnNavigate = function() {
            return new Promise(function(fnResolve, fnReject) {
                var oModel = oBindingContext.getModel();
                // create a binding context for the navigation property target
                oModel.createBindingContext(sNavigationProperty, oBindingContext, {}, function(oTarget) {
                    // navigate internally to the target context
                    var oNavigationController = oExtensionAPI.getNavigationController();
                    oNavigationController.navigateInternal(oTarget);
                    fnResolve();
                });
            });
        };

        // execute navigation in a securedExecution block
        oExtensionAPI.securedExecution(fnNavigate, {
            busy: { check: false },
            dataloss: { popup: false }
        });

        // return true to indicate custom navigation handled the event
        return true;
    }

    // return false to allow default navigation to the app's default detail page
    return false;
}
```

STEP: OData V2 — Manifest changes: register multiple ObjectPage entries

DESCRIPTION: If you navigate to different entity sets/object pages, register multiple pages in the manifest so each ObjectPage is available as a target. Place this under "sap.ui.generic.app" -> "pages" in manifest.json.

LANGUAGE: JSON

CODE:
```JSON
// manifest.json (sap.ui.generic.app.pages)
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|EntitySet1": {
        "entitySet": "EntitySet1",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      },
      "ObjectPage|EntitySet2": {
        "entitySet": "EntitySet2",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      },
      "ObjectPage|EntitySet3": {
        "entitySet": "EntitySet3",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      }
    }
  }
}
```

STEP: OData V2 — Visual indication: implement onChildOpenedExtension

DESCRIPTION: If you need the list table row highlight/selection to match the opened child page when navigation used an alternate detail, implement onChildOpenedExtension. Call fnSetPath with the binding path of the corresponding list item.

LANGUAGE: JavaScript

CODE:
```JavaScript
// Example: inside the List Report or Object Page controller extension
onChildOpenedExtension: function(oSelectionInfo, fnSetPath) {
    // oSelectionInfo.path - path of currently opened child page instance
    // oSelectionInfo.keys - array of keys used for last opened child page
    // fnSetPath - function to set the path used for visual indication (row selection/highlight)

    var oModel = this.getView().getModel();
    // create binding context to the actual navigation property path and pass it to fnSetPath
    oModel.createBindingContext(oSelectionInfo.path + "NavigationProperty", null, null, function(oContext) {
        fnSetPath(oContext.getPath());
    });
}
```

STEP: OData V4 — Define a custom route in manifest (sap.ui5 routing)

DESCRIPTION: For OData V4, define a route that maps the URL pattern to your custom detail target. Put the route definition under "sap.ui5" -> "routing" -> "routes" in manifest.json.

LANGUAGE: JSON

CODE:
```JSON
// manifest.json (sap.ui5.routing.routes)
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": "SalesOrderManage({key})/_Item({key2})/_MaterialDetails({key3}):?query:",
          "name": "CustomMaterialDetailsPage",
          "target": "CustomMaterialDetailsPage"
        }
      ]
    }
  }
}
```

STEP: OData V4 — List report extension: override routing.onBeforeNavigation to call a route conditionally

DESCRIPTION: In a ControllerExtension for the list report, override routing.onBeforeNavigation. Inspect the sourceBindingContext (oContextInfo.sourceBindingContext). If your condition matches, call routing.navigateToRoute with the route name and route parameters (key/key2/key3). Return true to prevent default navigation; return false to allow default internal navigation.

LANGUAGE: JavaScript

CODE:
```JavaScript
// List report ControllerExtension (e.g. SalesOrder.ext.LRExtend.js)
sap.ui.define([
    "sap/ui/core/mvc/ControllerExtension",
    "sap/m/MessageToast",
    "sap/base/Log"
], function(ControllerExtension, MessageToast, Log) {
    "use strict";
    return ControllerExtension.extend("SalesOrder.ext.LRExtend", {
        override: {
            routing: {
                onBeforeNavigation: function(oContextInfo) {
                    var oLineContextData = oContextInfo.sourceBindingContext,
                        oRouting = this.base.getExtensionAPI().routing;

                    // Example condition: for SalesOrder 2919431 navigate to CustomMaterialDetailsPage
                    if (oLineContextData.SalesOrder === "2919431") {
                        oRouting.navigateToRoute("CustomMaterialDetailsPage", {
                            "key": "ID=11111138-aaaa-bbbb-cccc-ddddeeeeffff,IsActiveEntity=true",
                            "key2": "ID=11111142-aaaa-bbbb-cccc-ddddeeeeffff,IsActiveEntity=true",
                            "key3": "ID=21111142-aaaa-bbbb-cccc-ddddeeeeffff,IsActiveEntity=true"
                        });
                        // return true to prevent default navigation
                        return true;
                    } else {
                        // return false to trigger the default internal navigation
                        return false;
                    }
                }
            }
        }
    });
});
```

STEP: OData V4 — Object page extension: override routing.onBeforeNavigation to route to a different object page

DESCRIPTION: In a ControllerExtension for the object page, inspect oContextInfo.sourceBindingContext to decide routing. Use oExtensionAPI.routing.navigateToRoute to navigate to a different object page route. Return true if navigation handled, false to allow default.

LANGUAGE: JavaScript

CODE:
```JavaScript
// Object Page ControllerExtension (e.g. SalesOrder.ext.OPExtend.js)
sap.ui.define([
    "sap/ui/core/mvc/ControllerExtension",
    "sap/m/Dialog",
    "sap/m/DialogType",
    "sap/m/Text",
    "sap/m/Button",
    "sap/m/ButtonType",
    "sap/m/MessageToast",
    "sap/base/Log"
], function(ControllerExtension, Dialog, DialogType, Text, Button, ButtonType, MessageToast, Log) {
    "use strict";
    return ControllerExtension.extend("SalesOrder.ext.OPExtend", {
        override: {
            routing: {
                onBeforeNavigation: function(oContextInfo) {
                    var oLineContextData = oContextInfo.sourceBindingContext,
                        oExtensionAPI = this.base.getExtensionAPI(),
                        oRouting = oExtensionAPI.routing;

                    // Example: for salesOrder 2916499 and item 40 navigate to PartnerObjectPage
                    if (
                        oLineContextData.SalesOrder &&
                        oLineContextData.SalesOrder === "2916499" &&
                        oLineContextData.SalesOrderItem &&
                        oLineContextData.SalesOrderItem === 40
                    ) {
                        oRouting.navigateToRoute("PartnerObjectPage", {
                            "key": "ID=" + oLineContextData.ID + ",IsActiveEntity=" + oLineContextData.IsActiveEntity,
                            "key2": "ID=" + oLineContextData.ID + ",IsActiveEntity=" + oLineContextData.IsActiveEntity
                        });
                        // return true to prevent default navigation
                        return true;
                    } else {
                        // return false to trigger the default internal navigation
                        return false;
                    }
                }
            }
        }
    });
});
```
--------------------------------

**TITLE**: Replace default chevron navigation in a List Report responsive table (OData V2 & V4)

**INTRODUCTION**: Provide step-by-step manifest changes and controller-extension code to replace the standard chevron navigation from a List Report responsive table with custom internal or external navigation. Contains separate, actionable examples for OData V2 and OData V4 scenarios. Use only SAP Fiori elements extension APIs shown; do not manipulate framework internals.

**TAGS**: fiori-elements-framework, app-extension, navigation, list-report, responsive-table, odata-v2, odata-v4, manifest.json, controller-extension

**STEP**: Context / Caution
**DESCRIPTION**: When writing extensions, use only the official SAP Fiori elements extensionAPI. App extension code is responsible for display and behavior. Do not access or manipulate internal controls, properties, models, or other internals created by SAP Fiori elements.
**LANGUAGE**: text
**CODE**:
```text
Use only the extensionAPI (e.g., this.extensionAPI for v2, this.base.getExtensionAPI() for v4).
After creating the extension, your code is responsible for layout, bindings, and busy handling.
```

**STEP**: (OData V2) Add outbound navigation to manifest.json
**DESCRIPTION**: Add an outbound navigation entry under sap.app -> crossNavigation -> outbounds in manifest.json. This example shows an outbound outboundKey "EPMProductManageSt" that points to semantic object "EPMProduct" and action "manage". Keep the outbound key; it is used by navigateExternal().
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "sap.app": {
    ...
    "crossNavigation": {
      "inbounds": {},
      "outbounds": {
        "EPMProductManageSt": {
          "semanticObject": "EPMProduct",
          "action": "manage",
          "parameters": {
            "preferredMode": {
              "value": {
                "value": "display"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: (OData V2) Register the List Report controller extension in manifest.json
**DESCRIPTION**: Register your controller extension under sap.ui5 -> extends -> extensions -> sap.ui.controllerExtensions. The framework will instantiate your controller instead of the default for the List Report view.
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "STTA_MP.ext.controller.ListReportExtension"
          }
        }
      }
    }
  }
}
```

**STEP**: (OData V2) Implement the onListNavigationExtension controller method
**DESCRIPTION**: Implement onListNavigationExtension in your controller extension. Use this.extensionAPI.getNavigationController() and navigateExternal(outboundKey) to trigger the configured outbound. Return true to prevent default navigation, return false to allow default internal navigation.
Include the controller module skeleton and the required function implementation.
**LANGUAGE**: JavaScript
**CODE**:
```JavaScript
// File suggestion: webapp/ext/controller/ListReportExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("STTA_MP.ext.controller.ListReportExtension", {
    /**
     * Called by the List Report when chevron navigation is triggered for a row.
     * @param {sap.ui.base.Event} oEvent
     * @returns {boolean} true to suppress default internal navigation, false to allow it
     */
    onListNavigationExtension: function (oEvent) {
      var oNavigationController = this.extensionAPI.getNavigationController();
      var oBindingContext = oEvent.getSource().getBindingContext();
      var oObject = oBindingContext.getObject();

      // For items in ProductCategory "Notebooks" trigger external navigation,
      // for all others allow default internal navigation
      if (oObject.ProductCategory === "Notebooks") {
        // outbound key defined in manifest.json
        oNavigationController.navigateExternal("EPMProductManageSt");
        // prevent default internal navigation
        return true;
      } else {
        // allow default internal navigation to object page
        return false;
      }
    }
  });
});
```

**STEP**: (OData V2) Ensure object page exists or explicitly disable object-page navigation
**DESCRIPTION**: The list report must have an object page defined if you still want users to navigate to one. If you want to prevent object page navigation entirely, follow the project-specific procedure to enable external-only navigation (see your project's documentation for "Enable External Navigation").
**LANGUAGE**: text
**CODE**:
```text
Ensure an object page is defined in your app if you want default internal navigation to work.
If not required, disable or reconfigure object page navigation per your project guidance.
```

**STEP**: (OData V4) Add outbound navigation to manifest.json
**DESCRIPTION**: Define an outbound entry in sap.app -> crossNavigation -> outbounds for the target application. Use a stable outbound key (example: "FreestyleNav1") and any parameter defaults required.
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "sap.app": {
    ...
    "crossNavigation": {
      "inbounds": {},
      "outbounds": {
        "FreestyleNav1": {
          "semanticObject": "v4Freestyle",
          "action": "Inbound",
          "parameters": {
            "SoldToParty": {
              "value": {
                "value": "7P100001",
                "format": "plain"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: (OData V4) Register controller extensions for ListReport and ObjectPage in manifest.json
**DESCRIPTION**: Map SAP Fiori elements controllers to your custom controller implementations using sap.ui5 -> extends -> extensions -> sap.ui.controllerExtensions. Provide a controller for the ListReport to implement onBeforeNavigation and optionally for the ObjectPage.
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ListReport.ListReportController": {
            "controllerName": "SalesOrder.ext.LRExtend"
          },
          "sap.fe.templates.ObjectPage.ObjectPageController": {
            "controllerName": "SalesOrder.ext.OPExtend"
          }
        }
      }
    }
  }
}
```

**STEP**: (OData V4) Implement onBeforeNavigation in the ListReport controller extension
**DESCRIPTION**: Implement the onBeforeNavigation override inside your controller extension. Use this.base.getExtensionAPI().intentBasedNavigation.navigateOutbound(outboundKey, parameters) to trigger outbound navigation. Return true to cancel default navigation, return false to let default navigation continue.
**LANGUAGE**: JavaScript
**CODE**:
```JavaScript
// File suggestion: webapp/ext/LRExtend.controller.js
sap.ui.define([], function () {
  "use strict";

  return {
    override: {
      routing: {
        /**
         * Called before navigation is performed for a line item.
         * @param {object} oContextInfo - includes bindingContext (line item context)
         * @returns {boolean} true to prevent default navigation, false to allow it
         */
        onBeforeNavigation: function (oContextInfo) {
          var oLineContext = oContextInfo.bindingContext;
          var oNav = this.base.getExtensionAPI().intentBasedNavigation;

          // Example: for SalesOrder "6437" navigate to external Freestyle app
          if (oLineContext && oLineContext.SalesOrder === "6437") {
            // outbound key defined in manifest.json
            // pass any parameters required by the target (example: Customer)
            oNav.navigateOutbound("FreestyleNav1", { "Customer": "10001" });
            // prevent default internal navigation
            return true;
          } else {
            // allow default internal navigation
            return false;
          }
        }
      }
    }
  };
});
```

**STEP**: (OData V4) Notes on oContextInfo and parameters
**DESCRIPTION**: oContextInfo contains the binding context used for navigation (the lineItem context from the table). When calling navigateOutbound, provide any required parameter values expected by the target app. Ensure outbound key names match manifest.json.
**LANGUAGE**: text
**CODE**:
```text
oContextInfo.bindingContext is the lineItem context passed to the target application.
Use outbound keys exactly as declared under sap.app.crossNavigation.outbounds.
Provide parameter object matching target parameter names.
```
--------------------------------

**TITLE**: Replace standard chevron navigation with custom external/internal navigation in Object Page responsive tables

**INTRODUCTION**: This guide shows how to replace the default row/chevron navigation from a responsive table on an Object Page with your own navigation (internal or external). Includes manifest.json entries (outbound and controllerExtensions) and controller extension implementations for OData V2 and OData V4. Also shows how to implement determineContextNavigationType to keep paginator behavior correct when navigation is changed.

**TAGS**: fiori-elements-framework, extensionAPI, manifest.json, controller-extension, navigation, odata-v2, odata-v4, paginator

STEP: Caution / Integration rule
DESCRIPTION: Use app extensions only when manifest settings/annotations cannot provide the required behavior. Integrate only via the SAP Fiori elements extensionAPI — do not access framework internals (controls, models, bindings).
LANGUAGE: text
CODE:
```text
Caution: Use app extensions with care. Use only the official extensionAPI of SAP Fiori elements.
Reference: Using the extensionAPI (see Fiori elements docs).
```

STEP: Add outbound navigation (OData V2 sample)
DESCRIPTION: Add an outbound (external) navigation entry under sap.app.crossNavigation.outbounds in webapp/manifest.json. This example creates an outbound named "EPMProductManageSt" with semanticObject "EPMProduct" and action "manage".
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "id": "your.app.id",
    "applicationVersion": {
      "version": "1.0.0"
    },
    "crossNavigation": {
      "inbounds": {},
      "outbounds": {
        "EPMProductManageSt": {
          "semanticObject": "EPMProduct",
          "action": "manage",
          "parameters": {
            "preferredMode": {
              "value": {
                "value": "display"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Register controller extension for Object Page (OData V2)
DESCRIPTION: Register the controller extension that will implement onListNavigationExtension. Add this under sap.ui5.extends.extensions.sap.ui.controllerExtensions in webapp/manifest.json.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "controllerName": "STTA_MP.ext.controller.DetailsExtension"
          }
        }
      }
    }
  }
}
```

STEP: Implement onListNavigationExtension (OData V2)
DESCRIPTION: Create the controller file for STTA_MP.ext.controller.DetailsExtension and implement onListNavigationExtension. Use extensionAPI.getNavigationController() to trigger external navigation (navigateExternal) or return false to keep default internal navigation. Return true when you have handled navigation to suppress default behavior.
LANGUAGE: JavaScript
CODE:
```javascript
// webapp/ext/controller/DetailsExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function(Controller) {
  "use strict";

  return Controller.extend("STTA_MP.ext.controller.DetailsExtension", {
    /**
     * Handler called when a user triggers chevron/row navigation from a responsive table.
     * Use extensionAPI to obtain the navigation controller.
     * - return true  -> prevents default navigation (you handled it)
     * - return false -> allows default internal navigation
     */
    onListNavigationExtension: function(oEvent) {
      // this.extensionAPI is provided by Fiori elements within the extension controller
      var oNavigationController = this.extensionAPI.getNavigationController();
      var oBindingContext = oEvent.getSource().getBindingContext();
      var oObject = oBindingContext && oBindingContext.getObject();

      if (!oObject) {
        // fallback: allow default navigation
        return false;
      }

      // Example logic: external navigation for Notebooks, internal for others
      if (oObject.ProductCategory === "Notebooks") {
        // navigateExternal expects the outbound name defined in manifest.sap.app.crossNavigation.outbounds
        oNavigationController.navigateExternal("EPMProductManageSt");
        // prevent default internal navigation
        return true;
      } else {
        // allow default internal navigation
        return false;
      }
    }
  });
});
```

STEP: Add outbound navigation (OData V4 sample)
DESCRIPTION: Add an outbound named "FreestyleNav1" under sap.app.crossNavigation.outbounds in webapp/manifest.json; include parameters as required by the target app.
LANGUAGE: JSON
CODE:
```json
{
  "sap.app": {
    "id": "your.app.v4.id",
    "crossNavigation": {
      "inbounds": {},
      "outbounds": {
        "FreestyleNav1": {
          "semanticObject": "v4Freestyle",
          "action": "Inbound",
          "parameters": {
            "SoldToParty": {
              "value": {
                "value": "7P100001",
                "format": "plain"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Register controller extensions for ListReport and ObjectPage (OData V4)
DESCRIPTION: Add controller extension registrations under sap.ui5.extends.extensions.sap.ui.controllerExtensions in webapp/manifest.json.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ListReport.ListReportController": {
            "controllerName": "SalesOrder.ext.LRExtend"
          },
          "sap.fe.templates.ObjectPage.ObjectPageController": {
            "controllerName": "SalesOrder.ext.OPExtend"
          }
        }
      }
    }
  }
}
```

STEP: Implement onBeforeNavigation (OData V4)
DESCRIPTION: In your Object Page extension controller (SalesOrder.ext.OPExtend), implement the override routing.onBeforeNavigation extension method. Use the extension API's intentBasedNavigation (this.base.getExtensionAPI().intentBasedNavigation) to call navigateOutbound. Return true if you handled navigation and want to suppress default behavior, return false to allow default internal navigation.
LANGUAGE: JavaScript
CODE:
```javascript
// webapp/ext/OPExtend.controller.js
sap.ui.define([], function() {
  "use strict";

  return {
    override: {
      routing: {
        /**
         * oContextInfo: merged context (lineItem + ObjectPage)
         * - return true  -> prevents default navigation (you handled it)
         * - return false -> allows default internal navigation
         */
        onBeforeNavigation: function(oContextInfo) {
          // oContextInfo.bindingContext is the row context clicked
          var oLineContext = oContextInfo && oContextInfo.bindingContext && oContextInfo.bindingContext.getObject();
          // get intentBasedNavigation service from extensionAPI
          var oNav = this.base && this.base.getExtensionAPI && this.base.getExtensionAPI().intentBasedNavigation;

          if (!oLineContext || !oNav) {
            // allow default navigation if context or navigation service is unavailable
            return false;
          }

          // Example: for SalesOrder "6437" call outbound navigation "FreestyleNav1"
          if (oLineContext.SalesOrder === "6437") {
            // navigateOutbound(outboundName, paramsObject)
            oNav.navigateOutbound("FreestyleNav1", { "Customer": "10001" });
            // prevent default internal navigation
            return true;
          } else {
            // allow default internal navigation
            return false;
          }
        }
      }
    }
  };
});
```

STEP: Implement determineContextNavigationType for paginator behavior (required when you alter navigation)
DESCRIPTION: To keep paginator buttons functioning correctly when you change navigation for certain records, implement determineContextNavigationType to return ContextNavigationType.External or ContextNavigationType.None for contexts you override. Contexts flagged External/None are skipped by paginator. Reference API: https://ui5.sap.com/#/api/sap.fe.core.controllerextensions.Paginator%23methods/determineContextNavigationType
LANGUAGE: JavaScript
CODE:
```javascript
// Example addition to the same extension controller (OPExtend)
// Implement determineContextNavigationType to signal paginator about special navigation
// Place this function alongside override.routing in the controller extension object
// The enum ContextNavigationType is provided by the framework; adapt access if required.

determineContextNavigationType: function(oLineContext) {
  // oLineContext is the row context object (e.g., bindingContext.getObject())
  // If the line should navigate externally, return ContextNavigationType.External
  // If the line should be skipped by paginator, return ContextNavigationType.None
  // Otherwise return ContextNavigationType.Default or omit to let framework treat it as internal.

  var oNavTypes = this.base && this.base.getExtensionAPI && this.base.getExtensionAPI().ContextNavigationType;
  // Fallback to string values if the enum is not accessible directly; prefer the enum when available
  if (oLineContext && oLineContext.SalesOrder === "6437") {
    // Mark as external navigation
    return oNavTypes ? oNavTypes.External : "External";
  }
  if (oLineContext && oLineContext.ProductCategory === "Notebooks") {
    // Another example: external navigation for notebooks
    return oNavTypes ? oNavTypes.External : "External";
  }
  // Default: let framework handle internal navigation/pagination
  return oNavTypes ? oNavTypes.Default : "Default";
}
```

STEP: Notes and reference
DESCRIPTION: Remember:
- Return true from your navigation handler to suppress default navigation; return false to allow it.
- Implement determineContextNavigationType when you alter navigation so paginators skip External/None contexts.
- Consult the official API reference for the exact ContextNavigationType enum location and other extensionAPI functions.
LANGUAGE: text
CODE:
```text
API reference (Paginator.determineContextNavigationType):
https://ui5.sap.com/#/api/sap.fe.core.controllerextensions.Paginator%23methods/determineContextNavigationType
```
--------------------------------

**TITLE**: Add and Navigate to a Canvas Page in SAP Fiori Elements (OData V2)

**INTRODUCTION**: This guide shows the exact manifest and code changes required to embed a Canvas page (sap.suite.ui.generic.template.Canvas) in an SAP Fiori elements (OData V2) app, request standard controls (footer / flexible column actions), and navigate to the canvas page from its parent page using the Extension API. Includes how to pass a single string key (or empty key), evaluate it in the implementing component (stStart / stRefresh), and perform absolute navigation.

**TAGS**: fiori-elements-framework, sapui5, canvas, manifest.json, routing, extensionAPI, ODataV2, implementingComponent

**STEP**: 1 — Add a Canvas page entry to manifest.json

**DESCRIPTION**: Add a canvas page under "sap.ui.generic.app" -> "pages". Provide the canvas component and the implementing component. You can use componentName or componentUsage (predefined in manifest) to reference the implementing component.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "thePageName": {
        "component": {
          "name": "sap.suite.ui.generic.template.Canvas",
          "settings": {
            /* canvas-specific settings (see next steps) */
          }
        },
        "implementingComponent": {
          "componentName": "theImplementingComponentQualifiedName",
          "settings": {
            /* property bindings between embedding component and implementing component */
          }
        }
      }
    }
  }
}
```

Alternative using componentUsage (defined elsewhere in manifest):
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "thePageName": {
        "component": {
          "name": "sap.suite.ui.generic.template.Canvas",
          "settings": { }
        },
        "implementingComponent": {
          "componentUsage": "myReuseComponentUsage", /* instead of componentName */
          "settings": { }
        }
      }
    }
  }
}
```

Place this in your app's manifest.json at the root level under "sap.ui.generic.app".

**STEP**: 2 — Request standard controls from the Canvas (footer / flexible column actions)

**DESCRIPTION**: Request controls that the canvas can later add via the Canvas extension API (for example addFooterBarToPage or getFlexibleColumnLayoutActionButtons). Set requiredControls.footerBar and/or requiredControls.flexibleColumnLayoutActions to true under the canvas "settings".

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "thePageName": {
        "component": {
          "name": "sap.suite.ui.generic.template.Canvas",
          "settings": {
            "requiredControls": {
              "footerBar": true,
              "flexibleColumnLayoutActions": true
            }
          }
        },
        "implementingComponent": {
          "componentName": "theImplementingComponentQualifiedName",
          "settings": { }
        }
      }
    }
  }
}
```

Note: You can request either or both controls. The implementing component can later call Canvas extension API methods such as addFooterBarToPage or getFlexibleColumnLayoutActionButtons.

**STEP**: 3 — Enable routing to the Canvas page (routingSpec)

**DESCRIPTION**: Add a routingSpec to the canvas page entry to enable navigation targets. Set routeName (must be unique within the app), noOData:true, and noKey true/false depending on whether you want to pass a single key string to the canvas page.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "thePageName": {
        "component": {
          "name": "sap.suite.ui.generic.template.Canvas",
          "settings": { }
        },
        "implementingComponent": {
          "componentName": "theImplementingComponentQualifiedName",
          "settings": { }
        },
        "routingSpec": {
          "noOData": true,
          "noKey": true,            /* set false if you want to pass a key string */
          "routeName": "theRouteName"
        }
      }
    }
  }
}
```

Rules for routeName:
- Must be unique inside the app (cannot be used twice).
- Must not equal an entity set or navigation property name in the OData service, unless you intentionally replace the standard object page (see next step for that scenario).

**STEP**: 4 — Add Canvas page as child of a parent page (context forwarded)

**DESCRIPTION**: Typical placement is as a child of an object page. When nested, the parent page context (entity set / key) is passed to the canvas page; stStart and stRefresh lifecycle methods receive that context. Only the extension API instance from the parent page may be used to navigate to this child canvas page.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "theParentPageName": {
        "entitySet": "theMainEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": { }
        },
        "pages": {
          "thePageName": {
            "component": {
              "name": "sap.suite.ui.generic.template.Canvas",
              "settings": { }
            },
            "implementingComponent": {
              "componentName": "theImplementingComponentQualifiedName",
              "settings": { }
            },
            "routingSpec": {
              "noOData": true,
              "noKey": false,
              "routeName": "theRouteName"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Trigger navigation to the Canvas page from a controller extension (no key)

**DESCRIPTION**: In an event handler in the parent page's controller extension (e.g., button press), call navigateInternal on the NavigationController obtained from the parent page's extensionAPI. For noKey scenario, pass an empty string as the first argument.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// in controller extension of the parent page (e.g., ObjectPage controller extension)
var oApi = this.extensionAPI; // must be extensionAPI of the parent page
var oNavigationController = oApi.getNavigationController();
oNavigationController.navigateInternal("", { routeName: "theRouteName" });
```

Place this code in an appropriate event handler (press handler, onListNavigationExtension callback, etc.)

**STEP**: 6 — Trigger navigation to the Canvas page with a key (noKey: false)

**DESCRIPTION**: To pass a single string representing the user's choice or key, set routingSpec.noKey to false. Pass the string as the first parameter to navigateInternal. The canvas page receives this single string; encode complex data into a single string if needed.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
var oApi = this.extensionAPI; // extensionAPI of the parent page
var oNavigationController = oApi.getNavigationController();
var sUsersChoice = "SOME_KEY_OR_ENCODED_INFO"; // determine/encode the value
oNavigationController.navigateInternal(sUsersChoice, { routeName: "theRouteName" });
```

Note: Only one string can be passed. If multiple values are required, encode them into the string (e.g., JSON + encodeURIComponent).

**STEP**: 7 — Read the navigation key(s) in the implementing component (stRefresh)

**DESCRIPTION**: In the implementing component, use the oExtensionAPI passed to lifecycle hooks to get the current navigation keys. The last key typically represents the value passed from navigateInternal.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// in implementing component (component.js)
stRefresh: function(oModel, oBindingContext, oExtensionAPI) {
  var oNavigationController = oExtensionAPI.getNavigationController();
  var aKeys = oNavigationController.getCurrentKeys();
  var sUserChoice = aKeys[aKeys.length - 1]; // the passed string
  var oComponentModel = this.getComponentModel();
  oComponentModel.setProperty("/UsersChoice", sUserChoice);
}
```

This stRefresh is invoked with the parent context (if the canvas is a child of a parent page). Use sUserChoice to update your component model or data binding.

**STEP**: 8 — Bind component view by path in stStart (example binding to OData entity)

**DESCRIPTION**: In some scenarios you want to bind the canvas view to a specific OData entity path derived from the navigation keys. Use getCurrentKeys() and construct the binding path in stStart.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// in implementing component (component.js)
stStart: function(oModel, oBindingContext, oExtensionAPI) {
  var oComponentModel = this.getComponentModel();
  var sPath = oExtensionAPI.getNavigationController().getCurrentKeys()[1];
  // Example: build a binding for entity C_STTA_SalesOrder_WD_20 using the key
  var sBindingPath = "/C_STTA_SalesOrder_WD_20(" + sPath + ")";
  var oPathSpec = {
    path: sBindingPath
  };
  var oCanvasView = oComponentModel.getProperty("/View");
  oCanvasView.bindElement(oPathSpec);
}
```

Adjust entity set and path construction to match your OData service and key format.

**STEP**: 9 — Absolute navigation to a Canvas page (isAbsolute: true)

**DESCRIPTION**: To navigate to a canvas page that is not a child of the current canvas page (or to target a child of any ancestor), set isAbsolute: true in the navigateInternal options.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
var oApi = this.extensionAPI;
var oNavigationController = oApi.getNavigationController();
var sUsersChoice = "SOME_KEY";
oNavigationController.navigateInternal(sUsersChoice, {
  routeName: "theRouteName",
  isAbsolute: true
});
```

This allows navigating to pages outside the current branch of the app hierarchy.

**STEP**: 10 — Notes and best practices

**DESCRIPTION**: Short checklist to avoid common pitfalls.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "notes": [
    "This guide applies to SAP Fiori elements for OData V2 only.",
    "routeName must be unique within the app and should not equal an entity set or navigation property name unless intentionally replacing the standard object page.",
    "When the Canvas page is nested under a parent page, only the extensionAPI of the parent page may be used to navigate to the Canvas page.",
    "When passing complex navigation data, encode it into a single string (e.g., JSON + encodeURIComponent).",
    "You can use componentUsage instead of componentName for the implementingComponent entry if configured elsewhere in the manifest."
  ]
}
```

Related files:
- manifest.json: add canvas page entries under "sap.ui.generic.app" -> "pages"
- component.js (implementing component): implement stStart / stRefresh lifecycle methods shown above

Related documentation: Developing Reuse Components (for building implementing components to embed).
--------------------------------

**TITLE**: Extending Custom View Switch for OVP Cards (UI5 Controller Extension)

**INTRODUCTION**: Provide a UI5 controller extension that sets the active tab index for OVP cards dynamically based on filter values (selection variant) or custom logic. Use the onBeforeRebindPageExtension(aCards, oSelectionVariant) hook to compute a mapping of card IDs to tab indices and call this.setTabIndex(oTabIndexList).

**TAGS**: fiori-elements-framework, ui5, ovp, view-switch, controller-extension, manifest, javascript

**STEP**: 1 — Create controller extension file

**DESCRIPTION**: Create a UI5 controller extension file (example path: webapp/ext/customViewswitch.controller.js). Implement onBeforeRebindPageExtension(aCards, oSelectionVariant) to build a map of card IDs to desired tab indices and call this.setTabIndex(oTabIndexList). Include a helper _getFilterList to extract simple key->value pairs from the selection variant.

Notes:
- onBeforeRebindPageExtension input parameters:
  - aCards: Array of visible card descriptors (each has an id property).
  - oSelectionVariant: Object with Parameters[] and/or SelectOptions[] containing applied filters.
- TabIndex values start at 1 and must not exceed the number of tabs for the target card.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/ext/customViewswitch.controller.js
sap.ui.define([
    "sap/ui/core/mvc/Controller"
], function (Controller) {
    "use strict";

    return Controller.extend("sap.ovp.demo.ext.customController", {
        /**
         * Hook called before OVP page rebind. Compute and set tab indices per card.
         * @param {Array} aCards - list of visible cards (each card has an id property)
         * @param {Object} oSelectionVariant - filters: { Parameters: [...], SelectOptions: [...] }
         */
        onBeforeRebindPageExtension: function (aCards, oSelectionVariant) {
            // Build map { "<cardId>": <tabIndex> }
            var oTabIndexList = {};
            var oFilterList = this._getFilterList(oSelectionVariant); // helper below

            if (aCards && aCards.length > 0) {
                for (var i = 0; i < aCards.length; i++) {
                    var sCardId = aCards[i].id;

                    // Example logic for card "card012" — adjust to your card IDs and filters
                    if (sCardId === "card012") {
                        if (oFilterList && oFilterList.hasOwnProperty("SupplierName")) {
                            if (oFilterList.SupplierName === "SAP") {
                                oTabIndexList["card012"] = 1;
                            } else if (oFilterList.SupplierName === "Talpa") {
                                oTabIndexList["card012"] = 2;
                            }
                        }
                    }

                    // Add additional card-specific logic here...
                }
            }

            // Pass the computed mapping to OVP runtime
            this.setTabIndex(oTabIndexList);
        },

        /**
         * Extracts simple key:value pairs from aSelectionVariant
         * Supports Parameters (PropertyName/PropertyValue) and SelectOptions (EQ Ranges)
         * @param {Object} oSelectionVariant
         * @returns {Object} oFilterList - map of property->value
         */
        _getFilterList: function (oSelectionVariant) {
            var oFilterList = {};

            if (oSelectionVariant && oSelectionVariant.Parameters && oSelectionVariant.Parameters.length > 0) {
                for (var i = 0; i < oSelectionVariant.Parameters.length; i++) {
                    var oParam = oSelectionVariant.Parameters[i];
                    oFilterList[oParam.PropertyName] = oParam.PropertyValue;
                }
            }

            if (oSelectionVariant && oSelectionVariant.SelectOptions && oSelectionVariant.SelectOptions.length > 0) {
                for (var j = 0; j < oSelectionVariant.SelectOptions.length; j++) {
                    var oSelect = oSelectionVariant.SelectOptions[j];
                    var aRanges = oSelect.Ranges || [];
                    for (var k = 0; k < aRanges.length; k++) {
                        var oRange = aRanges[k];
                        if (oRange.Option === "EQ" && oRange.Low !== "") {
                            oFilterList[oSelect.PropertyName] = oRange.Low;
                        }
                    }
                }
            }

            return oFilterList;
        }
    });
});
```

**STEP**: 2 — Verify TabIndex values and mapping

**DESCRIPTION**: Ensure your oTabIndexList contains only integer values >= 1 and <= number of tabs for each target card. Example mapping:
- var oTabIndexList = { "card1": 2, "card2": 1 };

Use this.setTabIndex(oTabIndexList) to apply.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example mapping to pass to this.setTabIndex(...)
var oTabIndexList = {
    "card1": 2,
    "card2": 1
};
// Call inside controller:
this.setTabIndex(oTabIndexList);
```

**STEP**: 3 — Register controller extension in manifest.json

**DESCRIPTION**: Add a controller extension entry under "extends" → "extensions" → "sap.ui.controllerExtensions" for the OVP main controller (sap.ovp.app.Main). Ensure the controllerName matches the module ID used in sap.ui.define (e.g. "sap.ovp.demo.ext.customController").

Place this fragment in your application's manifest.json (root).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.controllerExtensions": {
        "sap.ovp.app.Main": {
          "controllerName": "sap.ovp.demo.ext.customController"
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Extending Delivered SAP Fiori Elements Apps Using Adaptation Extensions

**INTRODUCTION**: Action-oriented guide for implementing UI adaptation extensions (controller extensions and template-based extension hooks) in SAP Fiori elements delivered apps using the Adaptation Editor in SAP Business Application Studio. Includes supported page types, available extension hooks, and ready-to-use controller extension examples (JavaScript) for overriding template-based extension functions such as addFilters and state persistence functions.

**TAGS**: fiori-elements, adaptation-editor, controller-extension, UI5, Business-Application-Studio, list-report, object-page, overview-page, analytical-list-page

STEP: 1 — Supported pages and limitations

DESCRIPTION: Verify that the target app can be extended with the Adaptation Editor. Supported floorplans and the one explicit limitation.

LANGUAGE: Text

CODE:
```Text
Supported page types (Adaptation Editor):
- List Report (including Analytical List Page)
- Object Page
- Overview Page

Not supported:
- Flexible Column Layout (FCL) is not supported by the Adaptation Editor.
```

STEP: 2 — Where to create the adaptation project

DESCRIPTION: Create an adaptation project on top of the delivered/base app using the Adaptation Editor in SAP Business Application Studio (BAS). The adaptation project references the delivered app as the parent/base application.

LANGUAGE: Text

CODE:
```Text
Action:
1. Open SAP Business Application Studio.
2. Use the Adaptation Editor wizard to create an adaptation project referencing the delivered app (base application).
3. From the Adaptation Editor you can add controller extensions, UI changes (fields, columns, cards), toolbar actions, sections, etc.
Reference/guide: 
- Extending an SAP Fiori Application: https://help.sap.com/docs/bas/developing-sap-fiori-app-in-sap-business-application-studio/extending-sap-fiori-application
```

STEP: 3 — How extension functions are consumed

DESCRIPTION: Extension functions are consumed as part of a ControllerExtension module by overriding template-based extension points. Use the override object in a UI5 module and provide the templateBaseExtension/templateBasedExtension functions (the adaptation API may refer to either spelling; use the one returned by your environment).

LANGUAGE: Text

CODE:
```Text
Key concept:
- Provide a ControllerExtension module (JavaScript UI5 module) inside the adaptation project.
- The module must return an object with an "override" property that contains the template-based extension functions (e.g., templateBaseExtension or templateBasedExtension).
- The adaptation editor registers/links the controller extension to the delivered app automatically when you add the extension in the editor.
```

STEP: 4 — Example: Overriding addFilters, ensureFieldsForSelect, and state functions (JavaScript)

DESCRIPTION: Minimal ControllerExtension JS module. Demonstrates:
- addFilters(fnAddFilter, sControlId): create and add a filter via fnAddFilter.
- ensureFieldsForSelect(aFields): ensure required fields are selected in the OData $select.
- provideExtensionAppStateData() and restoreExtensionAppStateData(mExtensionState): persist/restore custom state during navigation/app-state handling.

Place this file inside your adaptation project (for example: webapp/extension/CustomControllerExtension.js) and register it in the Adaptation Editor.

LANGUAGE: JavaScript

CODE:
```JavaScript
sap.ui.define([
  "sap/ui/model/Filter"
], function(Filter) {
  "use strict";

  return {
    override: {
      // NOTE: Some environments use "templateBaseExtension", others "templateBasedExtension".
      // Use the identifier your adaptation editor expects. Example uses templateBaseExtension.
      templateBaseExtension: {
        /**
         * Called to allow adding filters to the ListReport/ALP/Overview smart filter bar or to a specific control.
         * fnAddFilter: function(oFilter, sControlId) -> call to add your created filter
         */
        addFilters: function(fnAddFilter, sControlId) {
          // Example: add a filter where property "Status" equals "Active"
          var oFilter = new Filter("Status", "EQ", "Active");
          fnAddFilter(oFilter, sControlId);
        },

        /**
         * Ensure additional fields are included in $select (so they are available client-side).
         * aFields: array of field names to ensure
         */
        ensureFieldsForSelect: function(aFields) {
          if (!aFields.includes("Status")) {
            aFields.push("Status");
          }
          return aFields;
        },

        /**
         * Provide extension-specific state to be stored with the app state (for navigation/bookmarking).
         * Return any serializable object.
         */
        provideExtensionAppStateData: function() {
          // Example: return a simple custom state value stored on this controller
          return {
            myCustomState: this._myCustomValue || null
          };
        },

        /**
         * Restore extension-specific state from mExtensionState when the app state is restored.
         */
        restoreExtensionAppStateData: function(mExtensionState) {
          if (mExtensionState && mExtensionState.myCustomState !== undefined) {
            this._myCustomValue = mExtensionState.myCustomState;
          }
        }
      }
    }
  };
});
```

STEP: 5 — Typical extension points per page type (use these function names when implementing controller extensions)

DESCRIPTION: List of extension hooks you can override in adaptation projects for each supported page type. Implement them inside templateBaseExtension / templateBasedExtension in your ControllerExtension module.

LANGUAGE: Text

CODE:
```Text
List Report / Analytical List Page:
- UI additions: add filter fields to Smart Filter Bar, add columns to tables, add table toolbar buttons + logic
- Overridable extension functions (examples):
  - onInitSmartFilterBar
  - provideExtensionAppStateData
  - restoreExtensionAppStateData
  - ensureFieldsForSelect
  - addFilters

Object Page:
- UI additions: toolbar actions, add sections, add header facet fields, add fields/field groups to forms
- Overridable extension functions (examples):
  - provideExtensionStateData
  - restoreExtensionStateData
  - ensureFieldsForSelect
  - addFilters

Overview Page:
- UI additions: add fields to Smart Filter Bar, add global filter bar actions, add/clone/edit cards, add extension controller logic
- Overridable extension functions (examples):
  - provideExtensionAppStateData
  - restoreExtensionAppStateData
  - addFilters
  - provideStartupExtension
  - provideExtensionNavigation
  - provideCustomActionPress
  - provideCustomParameter

Notes:
- These extension functions are consumed by the framework as part of ControllerExtension overriding template-based extension points.
- API reference and live examples:
  - sap.fe.core.controllerextensions API: https://ui5.sap.com/#/api/sap.fe.core.controllerextensions
  - Fiori dev portal (controllerExtensions examples): https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/controllerExtensions/guidanceControllerExtensions
```

STEP: 6 — Additional guidance & references

DESCRIPTION: Helpful links and notes for safe-mode adaptation and further details on extension functions.

LANGUAGE: Text

CODE:
```Text
- Adaptation Editor guide: https://help.sap.com/docs/bas/developing-sap-fiori-app-in-sap-business-application-studio/extending-sap-fiori-application
- Details of extension functions used for extending delivered apps: (internal doc reference in product docs)
- SAPUI5 Flexibility (Safe Mode + adapting UIs):
  - SAPUI5 Flexibility: Adapting UIs Made Easy: ../04_Essentials/sapui5-flexibility-adapting-uis-made-easy-a8e55aa.md
  - Enable your app for UI adaptation: ../05_Developing_Apps/sapui5-flexibility-enable-your-app-for-ui-adaptation-f1430c0.md
Notes:
- The extension points listed in some UI5 API references (e.g., sap.suite.ui.generic.template.ListReport.controllerFrameworkExtensions) cannot necessarily be consumed via the Adaptation Editor — prefer the adaptation-specific template-based extension points described above.
```
--------------------------------

**TITLE**: Extending Generated SAP Fiori Elements Apps Using App Extensions

**INTRODUCTION**: Practical, code-focused guide for adding application extensions to generated SAP Fiori elements apps. Covers prerequisites, manifest registration, extension controller implementation examples (JavaScript and TypeScript), recommended usage of the ExtensionAPI, and links for SAP Fiori Tools and API reference. Use this for implementing UI5/SAP Fiori elements extension points while keeping framework compatibility.

**TAGS**: fiori-elements-framework, app-extension, extensionAPI, SAPUI5, manifest.json, OData V2, OData V4, SAP Fiori tools, controller-extension

**STEP**: 1 - Read prerequisites and caution

**DESCRIPTION**: Before creating extensions, read the preparatory documentation and follow the caution. Extension code must use only the official ExtensionAPI of SAP Fiori elements. Avoid directly manipulating framework-internal controls, properties, models, or busy handling. Preferred alternatives to extensions are manifest settings or annotations.

**LANGUAGE**: Text/Links

**CODE**:
```text
Required reading:
- Read Before Extending a Generated App: read-before-extending-a-generated-app-d9c146a.md

Caution:
- Use app extensions only when manifest settings or annotations cannot deliver the required behavior.
- Use only the official extensionAPI of SAP Fiori elements to interact with the framework.
```

**STEP**: 2 - Create extension scaffolding with SAP Fiori Tools

**DESCRIPTION**: Use SAP Fiori tools (VS Code or Business Application Studio extensions) to scaffold and add extension points. The "Configure Page Elements" wizard or the app extension commands can generate manifest changes and extension controller files.

**LANGUAGE**: Text/Links

**CODE**:
```text
SAP Fiori Tools resources:
- SAP Fiori tools overview: https://help.sap.com/viewer/product/SAP_FIORI_tools/Latest/en-US
- Configure Page Elements: https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/047507c86afa4e96bb3d284adb9f4726.html
- Extending List Reports and Object Pages: extending-list-reports-and-object-pages-using-app-extensions-a892eb8.md
- Other extension guides: see section links in your project docs
```

**STEP**: 3 - Register a controller extension in the manifest (webapp/manifest.json)

**DESCRIPTION**: Add an entry under webapp/manifest.json to register your extension controller using the UI5 controller extensions mechanism. Use the appropriate template controller name for the target floorplan (List Report, Object Page, ALP, Overview Page). The example below shows the manifest fragment pattern — replace TemplateControllerFullName and my.namespace.Extension with real names.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "TemplateControllerFullName": {
            "controllerName": "my.namespace.Extension"
          }
        }
      }
    }
  }
}
```

- File path: webapp/manifest.json
- Replace TemplateControllerFullName with the full name of the framework template controller you are extending (for example, a List Report or Object Page template controller name provided by the Fiori elements floorplan).
- Replace my.namespace.Extension with the full name of your extension controller (the file you will implement).

**STEP**: 4 - Implement an extension controller (JavaScript example)

**DESCRIPTION**: Implement the controller referenced in the manifest. Obtain the ExtensionAPI from the owner component and use only the methods exposed by the ExtensionAPI. Do not directly access or change framework internals.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File path: webapp/controller/Extension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("my.namespace.Extension", {
    onInit: function () {
      // Acquire the official ExtensionAPI from the component
      this.extensionAPI = this.getOwnerComponent().getExtensionAPI();

      // Example placeholder: call an ExtensionAPI method (pseudo-method shown)
      // Use only methods documented on sap.fe.core.ExtensionAPI
      // this.extensionAPI.doSomething && this.extensionAPI.doSomething();
    }

    // Implement extension hook methods or event handlers here
  });
});
```

**STEP**: 5 - Implement an extension controller (TypeScript example)

**DESCRIPTION**: TypeScript example demonstrating typed access to the ExtensionAPI. Adjust imports to your project build configuration and UI5 TS typings.

**LANGUAGE**: TypeScript

**CODE**:
```typescript
// File path: webapp/controller/Extension.controller.ts
import Controller from "sap/ui/core/mvc/Controller";
import ExtensionAPI from "sap/fe/core/ExtensionAPI";

export default class ExtensionController extends Controller {
  private extensionAPI?: ExtensionAPI;

  public onInit(): void {
    // Acquire the official ExtensionAPI provided by the owner component
    // (ensure your component exposes getExtensionAPI() in your project setup)
    // @ts-ignore - depending on your typing setup, you may need to assert types
    this.extensionAPI = (this.getOwnerComponent() as any).getExtensionAPI();

    // Example placeholder using the API (replace with documented calls)
    // this.extensionAPI?.someMethod();
  }
}
```

**STEP**: 6 - Follow OData-specific and API references

**DESCRIPTION**: For OData V2 and V4-specific extension capabilities and the official ExtensionAPI reference, consult the linked resources. Use them to discover available ExtensionAPI methods and floorplan-specific extension points.

**LANGUAGE**: Text/Links

**CODE**:
```text
References:
- Additional features and app extension guides for OData V2: see SAP Fiori tools pages and floorplan-specific docs
  - Extending List Reports and Object Pages: extending-list-reports-and-object-pages-using-app-extensions-a892eb8.md
  - Configuring Analytical List Page App Extensions: configuring-analytical-list-page-app-extensions-9504fb4.md
  - Configuring Overview Page App Extensions: configuring-overview-page-app-extensions-b240f61.md
  - Extending Apps (general SAPUI5): ../08_Extending_SAPUI5_Applications/extending-apps-a264a9a.md

- ExtensionAPI (OData V4 and general API reference):
  - API Reference: https://ui5.sap.com/#/api/sap.fe.core.ExtensionAPI
```

**STEP**: 7 - Best practices and constraints

**DESCRIPTION**: Summary checklist for maintaining compatibility with SAP Fiori elements framework.

**LANGUAGE**: Text

**CODE**:
```text
Best practices:
- Prefer manifest settings or annotations over code extensions when possible.
- Use only methods exposed by sap.fe.core.ExtensionAPI for interacting with the framework.
- Avoid touching framework-internal controls, models, or properties.
- Keep UI changes (placement, layout) and system behavior (models, busy handling) within your extension code responsibility.
- Test extensions against the specific floorplan (List Report, Object Page, ALP, Overview Page) and OData version (V2 or V4).
```
--------------------------------

**TITLE**: Extending List Reports and Object Pages with App Extensions (Fiori elements)

**INTRODUCTION**: Short, code-focused guide showing how to create app extensions for List Reports and Object Pages in SAP Fiori elements. Includes manifest snippets to register controller and view extensions, example controller code, an XML fragment for a custom header action, and i18n resource entries. Use these examples as templates—replace namespace and IDs with your project values. Always use the Fiori elements extensionAPI and avoid manipulating internal framework controls.

**TAGS**: fiori-elements-framework, app-extensions, list-report, object-page, controller-extension, view-extensions, manifest, fragments, i18n

STEP: 1 — Register controller extensions in manifest.json

DESCRIPTION: Add controller extension registrations for the List Report and Object Page base controllers in webapp/manifest.json. Replace my.namespace.extension.* with your controller namespace.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "my.namespace.extension.ListReportExtension"
          },
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "controllerName": "my.namespace.extension.ObjectPageExtension"
          }
        },
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "BeforeSearchArea": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "my.namespace.extension.fragments.ListReportCustomHeader",
              "type": "XML"
            }
          },
          "sap.suite.ui.generic.template.ObjectPage.view.Details": {
            "SectionActions": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "my.namespace.extension.fragments.ObjectPageCustomSection",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

STEP: 2 — Create the controller extension file

DESCRIPTION: Implement the extension controller(s) under webapp/extension/. The controller provides handlers used by fragments and can call supported APIs and models. Use only supported extensionAPI functions where required. Example shows a simple button handler that shows a toast using i18n text.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/extension/ListReportExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/m/MessageToast"
], function (Controller, MessageToast) {
  "use strict";

  return Controller.extend("my.namespace.extension.ListReportExtension", {
    onInit: function () {
      // The Fiori elements extensionAPI may be available on the controller by the framework.
      // If needed, obtain the component extension API (pattern depends on Fiori elements version).
      // this.extensionAPI = this.extensionAPI || this.getOwnerComponent && this.getOwnerComponent().getExtensionAPI && this.getOwnerComponent().getExtensionAPI();
    },

    onCustomActionPress: function (oEvent) {
      // Access models and resources via the view (safe operations)
      var oView = this.getView();
      var oBundle = oView.getModel("i18n").getResourceBundle();
      MessageToast.show(oBundle.getText("customActionExecuted"));

      // Example: call an OData function import or update model data using standard model APIs:
      // var oModel = oView.getModel();
      // oModel.callFunction("/MyFunctionImport", { method: "POST", urlParameters: {...}, success: ..., error: ...});
    }
  });
});
```

STEP: 3 — Add the XML fragment for the view extension

DESCRIPTION: Define a fragment that adds a button to the List Report header (or Section actions on Object Page). The fragment should be placed under webapp/extension/fragments and referenced by manifest viewExtensions. Use press=".onCustomActionPress" to bind to the controller extension method.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/extension/fragments/ListReportCustomHeader.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
  <Button
    id="btnCustomAction"
    text="{i18n>customAction}"
    press=".onCustomActionPress"
    type="Emphasized" />
</core:FragmentDefinition>
```

STEP: 4 — Add i18n entries

DESCRIPTION: Add localized texts for the custom action labels/messages to webapp/i18n/i18n.properties (and localized variants).

LANGUAGE: Properties

CODE:
```properties
# File: webapp/i18n/i18n.properties
customAction=Execute custom action
customActionExecuted=Custom action executed
```

STEP: 5 — Notes and recommended workflow

DESCRIPTION: Best-practice and deployment notes:
- Prefer manifest and annotations over extensions when possible. Use extensions only when manifest/annotations cannot achieve required behavior.
- Use only the Fiori elements extensionAPI for framework-integrated actions. Avoid manipulating internal controls or models created by the framework.
- To scaffold extension skeletons, use SAP Fiori tools (Visual Studio Code or Business Application Studio) or create files manually under webapp/extension and webapp/extension/fragments.
- After changes, rebuild and deploy your app as usual (npm/mbt/build or SAP CAP/Cloud build pipelines depending on your project).

LANGUAGE: Text

CODE:
```text
Paths referenced in examples:
- webapp/manifest.json
- webapp/extension/ListReportExtension.controller.js
- webapp/extension/ObjectPageExtension.controller.js (optional)
- webapp/extension/fragments/ListReportCustomHeader.fragment.xml
- webapp/extension/fragments/ObjectPageCustomSection.fragment.xml (optional)
- webapp/i18n/i18n.properties
```
--------------------------------

**TITLE**: Extending SAP Fiori Elements Apps — Manifest-Based Controller Extensions (OData V2 & V4)

**INTRODUCTION**: Short, actionable guide showing how to register custom controller extensions for SAP Fiori elements apps by adding manifest entries. Includes OData V2 and OData V4 examples, specificity rules, sample mapping for object pages, routing example for V4, and a note about adaptation extensions and supported floorplans.

**TAGS**: fiori-elements-framework, sapui5, manifest.json, odata-v2, odata-v4, object-page, controller-extension, routing, adaptation-extensions

STEP: 1 — Where to add controller extension entries
DESCRIPTION: Add controller mapping entries to your application descriptor (webapp/manifest.json). These mappings tell the Fiori elements framework which extension controller to load for a view. Entries are placed within the manifest file where controller/view overrides are declared (see your project manifest structure). Use the following patterns (examples in steps 2–4).
LANGUAGE: JSON
CODE:
```json
// Add controller mapping entries to webapp/manifest.json (within the manifest structure where controller/view overrides are defined)
{
  // ... your manifest content ...
  // Insert the controller mapping entries shown in the following steps
}
```

STEP: 2 — OData V2: Generic examples (simple)
DESCRIPTION: Register a generic and a page-specific controller for OData V2 object page views. The mapping uses the view ID as the key; a more specific key that includes the view ID plus the page ID (after a hash) overrides the generic mapping.
LANGUAGE: JSON
CODE:
```json
// Example manifest entries for SAP Fiori elements OData V2
// Place these entries in webapp/manifest.json (where controller/view overrides are declared)

"sap.suite.ui.generic.template.ObjectPage.view.Details": {
  "controllerName": "SalesOrder.ext.controller.DetailsExtension"
},
"sap.suite.ui.generic.template.ObjectPage.view.Details#SalesOrder::sap.suite.ui.generic.template.ObjectPage.view.Details::SalesOrder_WD": {
  "controllerName": "SalesOrder.ext.controller.SalesOrderExtension"
}
```
DESCRIPTION (behavior): For SalesOrder_WD page the SalesOrderExtension controller is loaded; for all other views matching the base view ID the DetailsExtension controller is loaded. The part after the hash (#) is the full view/page ID.

STEP: 3 — OData V2: Detailed mapping example with entity set contexts
DESCRIPTION: Show full mapping where the manifest includes controller registrations per view and entity set. Preserve application name (prefix), view ID, and entity set keys. Use this pattern to register different controllers for object pages and object page sub-entities.
LANGUAGE: JSON
CODE:
```json
// Detailed OData V2 example (webapp/manifest.json)
// STTASOWD20 = application name prefix
// sap.suite.ui.generic.template.ObjectPage.view.Details = view ID
// C_STTA_SalesOrder_WD_20, C_STTA_SalesOrderItem_WD_20 = entity sets

"sap.suite.ui.generic.template.ObjectPage.view.Details": {
  "controllerName": "STTASOWD20.ext.controller.DetailsExtension",
  "sap.ui.generic.app": {
    "C_STTA_SalesOrder_WD_20": {
      "EntitySet": "C_STTA_SalesOrder_WD_20"
    }
  }
},
"sap.suite.ui.generic.template.ObjectPage.view.Details#STTASOWD20::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20": {
  "controllerName": "STTASOWD20.ext.controller.SalesOrderExtension",
  "sap.ui.generic.app": {
    "C_STTA_SalesOrder_WD_20": {
      "EntitySet": "C_STTA_SalesOrder_WD_20"
    }
  }
},
"sap.suite.ui.generic.template.ObjectPage.view.Details#STTASOWD20::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrderItem_WD_20": {
  "controllerName": "STTASOWD20.ext.controller.SalesOrderItemExtension",
  "sap.ui.generic.app": {
    "C_STTA_SalesOrderItem_WD_20": {
      "EntitySet": "C_STTA_SalesOrderItem_WD_20"
    }
  }
}
```
DESCRIPTION (mapping semantics): STTASOWD20 = application prefix; view ID is sap.suite.ui.generic.template.ObjectPage.view.Details; entity set key identifies the target object page. Use this pattern to target controllers per entity set/page.

STEP: 4 — OData V4: Controller mapping and routing (object page)
DESCRIPTION: OData V4 Fiori elements typically use the sap.fe.templates.ObjectPage controller name. Register a generic and a page-specific controller in the manifest. Also show a minimal routing example where the page ID becomes MyApplicationID::MainEntityObjectPage (used to form the specific key).
LANGUAGE: JSON
CODE:
```json
// Controller registration examples (OData V4) - add to webapp/manifest.json
"sap.fe.templates.ObjectPage.ObjectPageController": {
  "controllerName": "SalesOrder.ext.OPExtend"
},
"sap.fe.templates.ObjectPage.ObjectPageController#SalesOrder::SalesOrderManageObjectPage": {
  "controllerName": "SalesOrder.ext.SalesOrderOPExtend"
}
```
LANGUAGE: JSON
CODE:
```json
// Minimal manifest routing example (OData V4) - full snippet for context
{
  "sap.app": {
    "id": "MyApplicationID",
    "type": "application"
  },
  "sap.ui5": {
    "routing": {
      "config": {
        "async": true
      },
      "routes": [
        {
          "pattern": "MainEntity({key}):?query:",
          "name": "MainEntityObjectPage",
          "target": "MainEntityObjectPageTarget"
        }
      ],
      "targets": {
        "MainEntityObjectPageTarget": {
          "type": "Component",
          "id": "MainEntityObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "contextPath": "/MainEntity"
            }
          }
        }
      }
    }
  }
}
```
DESCRIPTION (page ID): With this routing the page ID is formed as MyApplicationID::MainEntityObjectPage — use this ID after the hash when creating a page-specific controller mapping key.

STEP: 5 — Specificity rule and examples summary
DESCRIPTION: Key points to apply when adding mappings:
- Use the view ID (e.g., sap.suite.ui.generic.template.ObjectPage.view.Details or sap.fe.templates.ObjectPage.ObjectPageController) as the base key.
- Append a hash (#) followed by the full page ID to target a specific page instance. The manifest can then map this to a different controllerName.
- The most specific mapping (the entry with the hash and full page ID) wins over the generic base view mapping.
LANGUAGE: JSON
CODE:
```json
// Generic -> Specific precedence (conceptual)
// Generic entry:
"<viewId>": { "controllerName": "<GenericController>" }

// Specific entry (overrides generic for this page):
"<viewId>#<ApplicationPrefix>::<ViewId>::<PageOrEntityId>": { "controllerName": "<SpecificController>" }
```

STEP: 6 — Additional features & constraints (OData V2 adaptation extensions)
DESCRIPTION: App extensions can be delivered as adaptation (adaptation-project) style changes for customers/partners in an upgrade-safe way. This approach works only for supported floorplans: List Report, Object Page, Overview Page, and Analytical List Page.
LANGUAGE: JSON
CODE:
```json
// Note:
// - Use adaptation extensions for adaptation projects; see "Extending Delivered Apps Using Adaptation Extensions".
// - Supported floorplans for adaptation extensions: List Report, Object Page, Overview Page, Analytical List Page.
```

STEP: 7 — Implementation checklist for developers
DESCRIPTION: Practical checklist to implement a controller extension:
- Identify the target view ID and page ID (from routing or app metadata).
- Add controllerName entries to webapp/manifest.json using the patterns above.
- Implement the extension controller file (e.g., webapp/ext/controller/SalesOrderExtension.controller.js) and ensure module path matches controllerName.
- Test: Navigate to the page; verify the correct controller is loaded (generic vs specific).
LANGUAGE: JSON
CODE:
```json
// Example file path mapping (must match manifest controllerName):
// manifest entry: "controllerName": "SalesOrder.ext.controller.SalesOrderExtension"
// Controller file: webapp/ext/controller/SalesOrderExtension.controller.js
```
--------------------------------

**TITLE**: Forcing Static Tiles from the Bookmark (Save as Tile) Function in SAP Fiori Elements (OData V2)

**INTRODUCTION**: This guide shows how to extend the List Report or Analytical List Page controller to force creation of a static tile (instead of a dynamic tile) when users use the Share > Save as Tile (bookmark) function. Applicable only for SAP Fiori elements with OData V2 and only affects tiles added via the bookmark function.

**TAGS**: fiori-elements-framework, ODataV2, bookmark, save-as-tile, static-tile, launchpad, extension-point, controller-extension

**STEP**: 1 — Prerequisite: Register a controller extension in manifest.json

**DESCRIPTION**: Ensure your app registers a controller extension for the relevant template (List Report or Analytical List Page) in webapp/manifest.json. The extension registration tells the framework which custom controller module to load and use for extension points such as onSaveAsTileExtension.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.controller.ListReport": {
            "controllerName": "my.namespace.ext.controller.ListReport"
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Implement onSaveAsTileExtension to force a static tile

**DESCRIPTION**: Create the controller extension module and implement the onSaveAsTileExtension(oShareInfo) function. Set oShareInfo.serviceUrl to an empty string ("") to enforce a static tile. You can also set a specific URL string if you want the tile to reference a particular service URL (but an empty string forces a static tile).

Place this file at the path referenced by the manifest controllerName (for example: webapp/extension/ListReport.controller.js).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File path example: webapp/extension/ListReport.controller.js
sap.ui.define([], function () {
   "use strict";
   return {
      /**
       * Extension point called when user chooses Save as Tile (bookmark).
       * @param {object} oShareInfo - object that contains tile metadata including serviceUrl
       */
      onSaveAsTileExtension: function(oShareInfo) {
         // Force static tile by clearing serviceUrl
         oShareInfo.serviceUrl = "";

         // OR set a custom service URL if you want the tile to be dynamic
         // oShareInfo.serviceUrl = "https://my.service.url/odata/";
      }
   };
});
```

**STEP**: 3 — Key behavior notes and scope

**DESCRIPTION**: Use these rules when coding and testing:
- This extension point applies only to tiles added via the Share (bookmark) function.
- The approach is valid only for SAP Fiori elements using OData V2.
- Default behavior:
  - List Report and Analytical List Page normally create dynamic tiles.
  - If semantic date range fields are configured and currently filled by the user, a static tile will be created by default.
  - Object Page bookmarks create static tiles by default.
- Overriding oShareInfo.serviceUrl = "" enforces a static tile regardless of default behavior. Setting it to a non-empty URL enforces that URL for dynamic tile data retrieval.
--------------------------------

**TITLE**: Extending a Delivered Fiori Elements App Manifest via an Adaptation Project

**INTRODUCTION**: This document gives concise, code-focused instructions and ready-to-use change objects to extend SAP-delivered Fiori elements list-report and object-page apps using an adaptation project. Use these change objects in the manifest.appdescr_variant file (adaptation project) to add pages, modify page and application settings, include annotations, and embed reuse components. Preserve backend metadata (navigation properties/entity sets) before applying changes.

**TAGS**: fiori-elements, adaptation-project, manifest, manifest.appdescr_variant, annotations, appdescr_variant, OData, ObjectPage, ListReport, reuse-component, neo-app.json

**STEP**: Prerequisites and Compatibility

**DESCRIPTION**: Environment and manifest format requirements; table-modification caution.

**LANGUAGE**: Text

**CODE**:
```Text
- SAPUI5 >= 1.108 (ABAP platform 2021 or higher). Array format for pages supported from SAPUI5 1.133.
- Ensure backend adds the new node and OData service metadata exposes the node navigationProperty and entitySet.
- Adaptation project changes are applied in manifest.appdescr_variant (content[]).
- Table-type modifications via adaptation projects may not be compatible across all applications / OData versions. Test thoroughly.
- manifest.json: pages/subpages must be in object format (or array format if SAPUI5 >=1.133).
```

**STEP**: Add a New Subobject Page (manifest.appdescr_variant change entry)

**DESCRIPTION**: Add a child object page under a parent object page by creating an appdescr change. Set "changeType" and supply parentPage (component & entitySet) and childPage (id & definition). Prefix childPage.id with target layer name if required (e.g., "customer." for customer/customer_base layers).

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_ui_generic_app_addNewObjectPage",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ObjectPage",
      "entitySet": "C_STTA_SalesOrder_WD_20"
    },
    "childPage": {
      "id": "customer.ObjectPage|to_extendedNode",
      "definition": {
        "navigationProperty": "to_extendedNode",
        "entitySet": "C_STTA_ExtendedNode"
      }
    }
  }
}
```

**STEP**: Set Node Configuration (createMode, tableSettings)

**DESCRIPTION**: Upsert specific properties for a section (facet) of an object page. Use propertyPath to target "component/settings/sections/<facetId>" or similar.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ObjectPage",
      "entitySet": "C_STTA_SalesOrder_WD_20"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings/sections/extendedFacetId",
      "operation": "UPSERT",
      "propertyValue": {
        "createMode": "inline",
        "tableSettings": {
          "tableType": "GridTable"
        }
      }
    }
  }
}
```

**STEP**: App-level Settings — createMode and flexibleColumnLayout

**DESCRIPTION**: Add or update application-level settings under the sap.suite.ui.generic.template component.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template"
    },
    "entityPropertyChange": {
      "propertyPath": "settings",
      "operation": "UPSERT",
      "propertyValue": {
        "tableSettings": {
          "createMode": "creationRows"
        },
        "flexibleColumnLayout": {
          "defaultTwoColumnLayoutType": "TwoColumnsMidExpanded",
          "defaultThreeColumnLayoutType": "ThreeColumnsEndExpanded"
        }
      }
    }
  }
}
```

**STEP**: App-level Settings — externalNavigationSettings and inboundParameters

**DESCRIPTION**: Configure outbound navigation refresh strategy and inbound parameters (useForCreate example).

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template"
    },
    "entityPropertyChange": {
      "propertyPath": "settings",
      "operation": "UPSERT",
      "propertyValue": {
        "externalNavigationSettings": {
          "defaultOutboundSettings": {
            "refreshStrategyOnAppRestore": {
              "entitySets": {
                "STTA_C_MP_Product": "self"
              }
            }
          }
        },
        "inboundParameters": {
          "Supplier": {
            "useForCreate": true
          }
        }
      }
    }
  }
}
```

**STEP**: List Report — filterSettings with historySettings and dateSettings

**DESCRIPTION**: Upsert filter settings including history and date-range behavior for a List Report page.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "entitySet": "STTA_C_MP_Product"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings",
      "operation": "UPSERT",
      "propertyValue": {
        "filterSettings": {
          "historySettings": {
            "historyEnabled": "enabled"
          },
          "dateSettings": {
            "useDateRange": false,
            "selectedValues": "DAYS,WEEK,MONTH,DATERANGE",
            "fields": {
              "SemanticDate1": {
                "selectedValues": "TOMORROW",
                "exclude": true
              },
              "SemanticDate2": {
                "defaultValue": {
                  "operation": "LASTYEAR"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: List Report — enableTableFilterInPageVariant, dataLoadSettings, condensedTableLayout

**DESCRIPTION**: Toggle table filter in page variants, data loading on launch, and condensed layout.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "entitySet": "STTA_C_MP_Product"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings",
      "operation": "UPSERT",
      "propertyValue": {
        "enableTableFilterInPageVariant": true,
        "dataLoadSettings": {
          "loadDataOnAppLaunch": "never"
        },
        "condensedTableLayout": true
      }
    }
  }
}
```

**STEP**: Table Settings (type, multiSelect, selectAll, multiEdit)

**DESCRIPTION**: Configure table behavior for a List Report page (GridTable example).

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "entitySet": "STTA_C_MP_Product"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings/tableSettings",
      "operation": "UPSERT",
      "propertyValue": {
        "type": "GridTable",
        "multiSelect": true,
        "selectAll": false,
        "multiEdit": {
          "enabled": true
        }
      }
    }
  }
}
```

**STEP**: Add Fields to createWithParameterDialog (createWithParameterDialog/fields)

**DESCRIPTION**: Add fields to the Create-With-Dialog parameters for a List Report entitySet.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "entitySet": "STTA_C_SO_SalesOrder_ND"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings/tableSettings/createWithParameterDialog/fields",
      "operation": "UPSERT",
      "propertyValue": {
        "CurrencyCode": {
          "path": "CurrencyCode"
        }
      }
    }
  }
}
```

**STEP**: Object Page — editableHeaderContent and showRelatedApps

**DESCRIPTION**: Toggle editable header and related apps behavior for an Object Page.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ObjectPage",
      "entitySet": "STTA_C_MP_Product"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings",
      "operation": "UPSERT",
      "propertyValue": {
        "editableHeaderContent": false,
        "showRelatedApps": false
      }
    }
  }
}
```

**STEP**: Object Page — createMode and table multiSelect for Object Page tableSettings

**DESCRIPTION**: Set createMode and multi-select behavior for Object Page tableSettings.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ObjectPage",
      "entitySet": "STTA_C_SO_SalesOrder_ND"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings/tableSettings",
      "operation": "UPSERT",
      "propertyValue": {
        "createMode": "creationRows",
        "multiSelect": true,
        "selectAll": false
      }
    }
  }
}
```

**STEP**: Selection Presentation Variant — set annotationPath and add annotation file

**DESCRIPTION**: Point List Report to a SelectionPresentationVariant qualifier via annotationPath, create local annotation file (annotations.xml) in the adaptation project, and register the annotation in manifest.appdescr_variant.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ListReport",
      "entitySet": "STTA_C_MP_Product"
    },
    "entityPropertyChange": {
      "propertyPath": "component/settings",
      "operation": "UPSERT",
      "propertyValue": {
        "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#DefaultSPV"
      }
    }
  }
}
```

**STEP**: Annotation File Example (annotations.xml) — SelectionPresentationVariant, PresentationVariant, LineItem, SelectionVariant

**DESCRIPTION**: Use this EDXML annotation file in your adaptation project (e.g., changes/annotations/annotations.xml). Adjust Target, Paths, and Qualifiers to match your model.

**LANGUAGE**: XML

**CODE**:
```XML
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="/sap/opu/odata/sap/STTA_PROD_MAN/$metadata">
    <edmx:Include Alias="STTA_PROD_MAN" Namespace="STTA_PROD_MAN"/>
  </edmx:Reference>
  <edmx:DataServices>
    <Schema xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductType">
        <Annotation Term="com.sap.vocabularies.UI.v1.SelectionPresentationVariant" Qualifier="DefaultSPV">
          <Record>
            <PropertyValue Property="ID" String=""/>
            <PropertyValue Property="Text" String="Default SPV"/>
            <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#FilterDefaults"/>
            <PropertyValue Property="PresentationVariant" Path="@UI.PresentationVariant#ManageProducts"/>
          </Record>
        </Annotation>
        <Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant" Qualifier="ManageProducts">
          <Record>
            <PropertyValue Property="SortOrder">
              <Collection>
                <Record Type="com.sap.vocabularies.Common.v1.SortOrderType">
                  <PropertyValue Property="Property" PropertyPath="Price"/>
                  <PropertyValue Property="Descending" Bool="false"/>
                </Record>
              </Collection>
            </PropertyValue>
            <PropertyValue Property="Visualizations">
              <Collection>
                <AnnotationPath>@com.sap.vocabularies.UI.v1.LineItem#ManageProducts</AnnotationPath>
              </Collection>
            </PropertyValue>
          </Record>
        </Annotation>
        <Annotation Term="UI.LineItem" Qualifier="ManageProducts">
          <Collection>
            <Record Type="UI.DataField">
              <PropertyValue Property="Value" Path="Price"/>
              <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
            </Record>
            <Record Type="UI.DataFieldForAction">
              <PropertyValue Property="Label" String="New Activate Button"/> 
              <PropertyValue Property="Action" String="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductActivation"/> 
              <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/ChangeSet"/> 
            </Record>
            <!-- additional LineItem records -->
          </Collection>
        </Annotation>
        <Annotation Term="UI.SelectionVariant" Qualifier="FilterDefaults">
          <Record>
            <PropertyValue Property="Parameters">
              <Collection/>
            </PropertyValue>
            <PropertyValue Property="SelectOptions">
              <Collection>
                <Record Type="UI.SelectOptionType">
                  <PropertyValue Property="PropertyName" PropertyPath="Width"/>
                  <PropertyValue Property="Ranges">
                    <Collection>
                      <Record>
                        <PropertyValue Property="Sign" EnumMember="com.sap.vocabularies.UI.v1.SelectionRangeSignType/I"/>
                        <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/BT"/>
                        <PropertyValue Property="Low" String="1.0"/>
                        <PropertyValue Property="High" String="20.00"/>
                      </Record>
                    </Collection>
                  </PropertyValue>
                </Record>
              </Collection>
            </PropertyValue>
          </Record>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: Register Local Annotation File in manifest.appdescr_variant

**DESCRIPTION**: Add annotations to the mainService datasource via appdescr_app_addAnnotationsToOData change. "annotations" lists the key(s) and "dataSource" maps the key to the local file path.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_app_addAnnotationsToOData",
  "content": {
    "dataSourceId": "mainService",
    "annotations": ["customer.localAnnotationsNew"],
    "annotationsInsertPosition": "END",
    "dataSource": {
      "customer.localAnnotationsNew": {
        "uri": "changes/annotations/annotations.xml",
        "type": "ODataAnnotation"
      }
    }
  }
}
```

**STEP**: Include a Reuse Component (component usages, libraries, embedded components)

**DESCRIPTION**: Add componentUsages and libraries into manifest.appdescr_variant and embed the reuse component into ObjectPage via embeddedComponents entry. Ensure the reuse component library exists in the backend and is cloned where required. Also add required headers to neo-app.json (headerWhiteList) if component needs them.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "changeType": "appdescr_ui5_addComponentUsages",
  "content": {
    "componentUsages": {
      "attachmentReuseComponent": {
        "name": "sap.se.mi.plm.lib.attachmentservice.attachment.components.stcomponent",
        "settings": {}
      }
    }
  }
},
{
  "changeType": "appdescr_ui5_addLibraries",
  "content": {
    "libraries": {
      "sap.se.mi.plm.lib.attachmentservice": {
        "minVersion": "Active",
        "lazy": true
      }
    }
  }
},
{
  "changeType": "appdescr_ui_generic_app_changePageConfiguration",
  "content": {
    "parentPage": {
      "component": "sap.suite.ui.generic.template.ObjectPage",
      "entitySet": "C_PaymentRunPlanTP"
    },
    "entityPropertyChange": {
      "propertyPath": "embeddedComponents",
      "operation": "UPSERT",
      "propertyValue": {
        "simple::Attachments": {
          "id": "simple::Attachments",
          "componentUsage": "attachmentReuseComponent",
          "title": "Attachment",
          "settings": {
            "mode": "C",
            "objectType": "SCASE",
            "objectKey": "{PaymentRunPlanName}",
            "isGuid": true
          }
        }
      }
    }
  }
}
```

**STEP**: neo-app.json — headerWhiteList entries required by reuse components

**DESCRIPTION**: If a reuse component requires HTTP headers to be whitelisted, add them to the consuming application's neo-app.json "headerWhiteList" array.

**LANGUAGE**: JSON

**CODE**:
```JSON
"headerWhiteList": [
  "objecttype",
  "objectkey",
  "slug",
  "MarkForDeletion",
  "documentType",
  "documentNumber",
  "documentVersion",
  "documentPart",
  "semanticobjecttype"
]
```

**STEP**: Implementation Notes — changeType, propertyPath, and unsupported items

**DESCRIPTION**: Required keys for mergers and important rules.

**LANGUAGE**: Text

**CODE**:
```Text
- For merger execution include: changeType, parentPage, and entityPropertyChange (with propertyPath, operation: "UPSERT", propertyValue).
- Common changeType values used in examples:
  - "appdescr_ui_generic_app_changePageConfiguration"
  - "appdescr_ui_generic_app_addNewObjectPage"
  - "appdescr_app_addAnnotationsToOData"
  - "appdescr_ui5_addComponentUsages"
  - "appdescr_ui5_addLibraries"
- propertyPath examples:
  - "settings"
  - "component/settings"
  - "component/settings/sections/<facetId>"
  - "component/settings/tableSettings"
  - "component/settings/tableSettings/createWithParameterDialog/fields"
  - "embeddedComponents"
- Unsupported via adaptation: filterSettings -> adding/modifying filter[] per field and customDateRangeImplementation is not supported.
- Prefix childPage.id with the target layer name for customer or customer_base layers (e.g., "customer.ObjectPage|to_extendedNode"); vendor layer typically does not require a prefix.
```

**STEP**: OData V4 Guidance

**DESCRIPTION**: For extending delivered apps manifest in OData V4 projects, follow the Fiori tools User Guide Creating the Project section.

**LANGUAGE**: Text

**CODE**:
```Text
See: Creating the Project (User Guide for SAP Fiori tools)
https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/072f566ed1d845b6aa41cb01057700d5.html
```
--------------------------------

**TITLE**: List Report Header Extension Point — configure custom expanded and collapsed header fragments

**INTRODUCTION**: This guide shows how to add custom UI5 XML fragments to the List Report header (above the filter bar) using the fiori-elements manifest configuration. It includes the manifest configuration, exact file paths and sample XML fragment implementations, plus an optional controller example for button actions.

**TAGS**: fiori-elements-framework, list-report, extension-point, header, manifest, ui5, fragments, xml

**STEP**: 1 — Configure manifest.json to reference header fragments

**DESCRIPTION**: Add the customHeader configuration inside the List Report target in webapp/manifest.json. Use the fully-qualified module names for the fragments (dot-separated). These names map to fragment files placed under webapp/sap/fe/core/fpmExplorer/customListReportHeaderContent/.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": { },
  "sap.ui5": {
    "targets": {
      "sample": {
        "type": "Component",
        "id": "Default",
        "name": "sap.fe.templates.ListReport",
        "options": {
          "settings": {
            "contextPath": "/RootEntity",
            "variantManagement": "Page",
            "initialLoad": true,
            "liveMode": true,
            "content": {
              "header": {
                "customHeader": {
                  "expandedHeaderFragment": "sap.fe.core.fpmExplorer.customListReportHeaderContent.CustomExpandedHeader",
                  "collapsedHeaderFragment": "sap.fe.core.fpmExplorer.customListReportHeaderContent.CustomCollapsedHeader"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Create the expanded header fragment file

**DESCRIPTION**: Create an XML fragment for the expanded header. Place the file at the path that corresponds to the module name used in the manifest:
webapp/sap/fe/core/fpmExplorer/customListReportHeaderContent/CustomExpandedHeader.fragment.xml. Use standard UI5 controls. Keep layout compact and accessible.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/sap/fe/core/fpmExplorer/customListReportHeaderContent/CustomExpandedHeader.fragment.xml -->
<core:FragmentDefinition
  xmlns:core="sap.ui.core"
  xmlns="sap.m"
  xmlns:layout="sap.ui.layout">
  <!-- Example: HBox with title text and an action button -->
  <HBox alignItems="Center" justifyContent="SpaceBetween" width="100%">
    <VBox>
      <Title text="Custom Expanded Header" level="H2" />
      <Text text="Additional descriptive text for the expanded header." />
    </VBox>
    <Button text="Custom Action" press=".onCustomAction" type="Emphasized" />
  </HBox>
</core:FragmentDefinition>
```

**STEP**: 3 — Create the collapsed header fragment file

**DESCRIPTION**: Create an XML fragment for the collapsed header (compact layout). Place this file at:
webapp/sap/fe/core/fpmExplorer/customListReportHeaderContent/CustomCollapsedHeader.fragment.xml.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/sap/fe/core/fpmExplorer/customListReportHeaderContent/CustomCollapsedHeader.fragment.xml -->
<core:FragmentDefinition
  xmlns:core="sap.ui.core"
  xmlns="sap.m">
  <!-- Example: Single bar with a short label and action button -->
  <Bar design="Header">
    <contentLeft>
      <Text text="Custom Collapsed Header" />
    </contentLeft>
    <contentRight>
      <Button icon="sap-icon://action" press=".onCustomAction" tooltip="Custom Action"/>
    </contentRight>
  </Bar>
</core:FragmentDefinition>
```

**STEP**: 4 — (Optional) Add controller methods used by the fragments

**DESCRIPTION**: If your fragments call event handlers (e.g., .onCustomAction), implement them in a controller that will be available to the fragment at runtime. Place the controller module in a path consistent with your app naming. Example below shows a simple controller module you can adapt and register with your extension mechanism.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File (example): webapp/sap/fe/core/fpmExplorer/customListReportHeaderContent/CustomHeader.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/m/MessageToast"
], function (Controller, MessageToast) {
  "use strict";

  return Controller.extend("sap.fe.core.fpmExplorer.customListReportHeaderContent.CustomHeader", {
    onCustomAction: function (oEvent) {
      // Implement the logic you need when the fragment button is pressed
      MessageToast.show("Custom header action triggered");
      // Example: access model, binding context, or navigate using router
      // var oView = this.getView();
      // var oModel = oView.getModel();
    }
  });
});
```

**STEP**: 5 — File location and module name mapping

**DESCRIPTION**: Ensure the module name in manifest (dots) maps to the fragment file path with slashes and .fragment.xml extension:
- manifest entry: "sap.fe.core.fpmExplorer.customListReportHeaderContent.CustomExpandedHeader"
- file path: webapp/sap/fe/core/fpmExplorer/customListReportHeaderContent/CustomExpandedHeader.fragment.xml

Same mapping applies to the collapsed fragment and any controller modules.

**STEP**: 6 — Notes and behavior

**DESCRIPTION**:
- Extensions added via these fragments are rendered above the filter bar in the List Report header.
- Provide both expanded and collapsed fragments to control presentation for both states of the header.
- For dynamic content or event handlers, implement functions in a controller that is available to the fragment (see optional controller step).
- For live examples and further reference, consult: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/topic/floorplanListReport/customHeaderListReport


--------------------------------

**TITLE**: Extension Point — react to back-end property updates (OData V4)

**INTRODUCTION**: Use the ControllerExtension API watchProperty to register a callback that runs when a specific OData V4 property is updated from the back end. Common uses: show/hide messages, refresh UI parts, or trigger other client-side logic when a server-side property changes.

**TAGS**: fiori-elements-framework, OData V4, extension, watchProperty, ControllerExtension, JavaScript, messages

**STEP**: 1 — Overview and constraints

**DESCRIPTION**: Understand callback parameters and current limitations before implementing watchProperty in your controller extension.

- Applicable only to SAP Fiori elements for OData V4.
- 1:n navigation properties are not supported.
- Callback parameters:
  - newValue: the new value of the property
  - oldValue: the previous value of the property
  - isInitial: boolean, true if property is retrieved from the back end for the first time
  - context: the page context object (useful to get binding path or additional data)

**LANGUAGE**: Text

**CODE**:
```text
Callback signature:
watchProperty(propertyName: string, callback: (newValue, oldValue, isInitial, context) => void): void
```

**STEP**: 2 — Implement watchProperty in a ControllerExtension (example)

**DESCRIPTION**: Add watchProperty inside the controller extension onInit override. This example displays an information message when the property isHotCountry becomes true, and hides the message otherwise. Use this.base.getExtensionAPI() to access extension APIs: watchProperty, showMessages, hideMessage.

Place this code in your controller extension module (AMD sap.ui.define style) and adapt property name and message logic as needed.

**LANGUAGE**: JavaScript

**CODE**:
```js
sap.ui.define(
    ["sap/ui/core/mvc/ControllerExtension", "sap/ui/core/message/Message", "sap/ui/core/message/MessageType"],
    function (ControllerExtension, Message, MessageType) {
        "use strict";

        return ControllerExtension.extend("watchProperties-basic.ext.OPExtend", {
            override: {
                onInit: function () {
                    // Watch backend updates for the 'isHotCountry' property
                    this.base.getExtensionAPI().watchProperty("isHotCountry", (newValue, oldValue, isInitial, context) => {
                        if (newValue === true) {
                            const messages = [
                                new Message({
                                    message: "Employee is in a hot country",
                                    type: MessageType.Information
                                })
                            ];
                            // Show messages via extension API
                            this.base.getExtensionAPI().showMessages(messages);
                        } else {
                            // Hide messages shown via extension API
                            this.base.getExtensionAPI().hideMessage();
                        }
                    });
                }
            }
        });
    }
);
```

**STEP**: 3 — Using callback parameters (examples)

**DESCRIPTION**: Examples showing common checks you may perform inside the callback using the provided parameters.

**LANGUAGE**: JavaScript

**CODE**:
```js
// 1) Check initial retrieval vs subsequent updates
this.base.getExtensionAPI().watchProperty("someProp", (newValue, oldValue, isInitial) => {
    if (isInitial) {
        // handle first-time retrieval differently (e.g., suppress UI notifications)
    } else {
        // handle updates
    }
});

// 2) Use context to get binding path or metadata (context API depends on framework version)
this.base.getExtensionAPI().watchProperty("someProp", (newValue, oldValue, isInitial, context) => {
    // Example: get the binding path if supported
    // const path = context && context.getPath && context.getPath();
    // Use path to identify the entity instance or perform targeted updates
});
```
--------------------------------

**TITLE**: Extension Points for Forms on the Object Page (Fiori Elements — OData V2 & V4)

**INTRODUCTION**: This document shows how to extend forms on the Object Page in SAP Fiori elements using:
- SmartFormExtension (OData V2)
- Custom form elements and controlConfiguration (OData V4)

It contains manifest and fragment examples, required property definitions, placement/anchor usage, UI model binding, and metadata-binding examples. Use only the official extensionAPI and avoid manipulating internal framework controls.

**TAGS**: fiori-elements-framework, object-page, extensions, custom-fields, manifest, smartform, odata-v2, odata-v4, xmlfragment

STEP: 1 — Caution and Best Practices

DESCRIPTION: Use app extensions only when manifest settings or annotations cannot achieve the required behavior. Use only SAP Fiori elements extensionAPI functions. Do not access or mutate internal controls, properties, models, or framework internals created by SAP Fiori elements.

LANGUAGE: text

CODE:
```text
// Use only the official SAP Fiori elements extensionAPI.
// Do not access/manipulate controls, properties, models, or other internal framework objects.
```

STEP: 2 — OData V2: Add fields to existing SmartForm FieldGroup via manifest

DESCRIPTION: Use the manifest key "SmartFormExtension|<Entity>|<FieldGroupAnnotation>" to inject an XML fragment as an extension into a SmartForm field group (example: GeneralInformation). The fragment is loaded using sap.ui.core.Fragment; className must be "sap.ui.core.Fragment".

LANGUAGE: JSON

CODE:
```json
{
  "sap.suite.ui.generic.template.ObjectPage.view.Details": {
    "SmartFormExtension|STTA_C_MP_Product|com.sap.vocabularies.UI.v1.FieldGroup::GeneralInformation": {
      "className": "sap.ui.core.Fragment",
      "fragmentName": "STTA_MP.ext.fragments.SmartFormGroupElement",
      "type": "XML"
    }
  }
}
```

STEP: 3 — OData V2: Restriction for SmartFormExtension className

DESCRIPTION: SmartFormExtension supports only sap.ui.core.Fragment for className; ensure fragmentName points to an XML fragment file available in the app.

LANGUAGE: text

CODE:
```text
// className must be exactly "sap.ui.core.Fragment"
// Example fragmentName: "STTA_MP.ext.fragments.SmartFormGroupElement"
// Corresponding file: webapp/ext/fragments/SmartFormGroupElement.fragment.xml
```

STEP: 4 — OData V4: Define the XML fragment for the custom field (fragment content)

DESCRIPTION: Implement the fragment that defines the control(s) for the custom form element. Use appropriate XML namespace declarations (core and control libraries). Bind properties to entity properties or models.

LANGUAGE: XML

CODE:
```xml
<!-- file: webapp/ext/fragments/CustomFormElement.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
    <!-- Example: display SoldToParty value -->
    <Text id="customFieldFormSoldToPartyInputField" text="{SoldToParty}" />
</core:FragmentDefinition>
```

STEP: 5 — OData V4: Register custom fields in manifest.json (controlConfiguration)

DESCRIPTION: Register custom form fields under the route target options.settings.controlConfiguration using the FieldGroup annotation key. For each custom field:
- key: unique identifier used for anchors/ordering
- template: component/fragment reference (e.g., ObjectPageStructure.ext.CustomField)
- label: i18n or metadata binding
- position: placement (After/Before) and anchor (key of existing field or previously defined key)

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.FieldGroup": {
                  "fields": {
                    "customFormElementAnchor": {
                      "template": "ObjectPageStructure.ext.CustomField",
                      "label": "{i18n>myFieldLabel1}",
                      "position": {
                        "placement": "After",
                        "anchor": "DataField::SalesOrder"
                      }
                    },
                    "customFormElementAnchor2": {
                      "template": "ObjectPageStructure.ext.CustomField",
                      "label": "{i18n>myFieldLabel2}",
                      "position": {
                        "placement": "After",
                        "anchor": "customFormElementAnchor"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 6 — Properties of a Custom Field in a Form (definitions & constraints)

DESCRIPTION: Use these property names when defining custom fields in controlConfiguration. Keys must be unique identifiers and can be used as anchors for positioning.

LANGUAGE: text

CODE:
```text
Property: key
  Supported values: [A-Z, a-z, 0-9, :, _, -]
  Description: Unique identifier for the custom field; used by other fields as anchors.

Property: label
  Supported values: any Unicode string
  Description: Text label shown for the field. Use i18n or metaModel binding.

Property: position
  Description: Defines placement relative to another field.

Sub-property: position.placement
  Supported values: "After" | "Before"
  Description: Placement relative to anchor.

Sub-property: position.anchor
  Supported values: "<key_of_column>"
  Description: Key of another field to be used as the placement anchor.

Property: template
  Description: Fragment/module path for the custom field. Follows Fragment.load syntax, e.g., "ObjectPageStructure.ext.CustomField".
```

STEP: 7 — Use the UI model inside the fragment (react to editMode)

DESCRIPTION: Bind fragment control properties to the UI model to react to edit mode changes. Example shows enabling a control when editMode equals 'Editable'.

LANGUAGE: XML

CODE:
```xml
<!-- Example attribute inside fragment control -->
<!-- enabled is bound to the UI model editMode -->
<Input id="myInput" enabled="{= ${ui>/editMode} === 'Editable'}" value="{SoldToParty}" />
```

STEP: 8 — Metadata binding for label (alternative to i18n)

DESCRIPTION: Use the metaModel to bind the label from OData metadata instead of i18n. This is supported in the manifest controlConfiguration label property.

LANGUAGE: JSON

CODE:
```json
{
  "customFormElementAnchor3": {
    "template": "ObjectPageStructure.ext.CustomField",
    "label": "{metaModel>/SalesOrderManage/SoldToParty@com.sap.vocabularies.Common.v1.Label}",
    "position": {
      "placement": "After",
      "anchor": "customFormElementAnchor"
    }
  }
}
```

STEP: 9 — Live examples and references

DESCRIPTION: Explore live examples for form extensions and form custom fields on the SAP Fiori development portal. Use the examples to validate fragment structure, bindings, and manifest registration.

LANGUAGE: text

CODE:
```text
Live example: UI5 FPM Explorer - Building Blocks - Form - Form Extensions
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/form/formCustom
```


--------------------------------

**TITLE**: Extension Points and Custom Header Facets for Object Page (OData V2 & V4)

**INTRODUCTION**: Action-oriented reference for adding and customizing Object Page header facets in SAP Fiori elements. Includes manifest patterns for OData V2 extension points, setCustomMessage usage, and OData V4 content- and annotation-based custom header facets and fields. Use these snippets directly when implementing fragments, controllers, and manifest entries.

**TAGS**: fiori-elements-framework, object-page, header-facets, extension-points, manifest.json, xmlfragment, odata-v2, odata-v4, extensionAPI

STEP: 1 — OData V2: Add a header facet extension in manifest.json (Before / Replace / After)
DESCRIPTION: Use a view fragment as an extension for header facets in OData V2. The manifest key format is: "<Scenario>|<EntitySet>|headerEditable::<Annotation_Path>". Provide className, viewName, type and optional bVisibleOnEdit. Use only the extensionAPI in your fragment controller and do not manipulate Fiori elements internals.
LANGUAGE: JSON
CODE:
```JSON
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "BeforeHeaderFacet|STTA_C_MP_Product|headerEditable::com.sap.vocabularies.UI.v1.Chart::SpecificationWidthBulletChart": {
            "className": "sap.ui.core.mvc.View",
            "viewName": "STTA_MP.ext.fragments.HeaderExtensionFacet",
            "type": "XML",
            "bVisibleOnEdit": true
          }
        }
      }
    }
  }
}
```

STEP: 2 — OData V2: Supported extension key patterns (list)
DESCRIPTION: Manifest keys you can use to insert/replace header facets (standard, simple, data point, no-image, image placement, or replace entire header).
LANGUAGE: TEXT
CODE:
```text
Standard object header facets:
- "BeforeHeaderFacet|<EntitySet Name>|headerEditable::<Annotation information>"
- "ReplaceHeaderFacet|<EntitySet Name>|headerEditable::<Annotation information>"
- "AfterHeaderFacet|<EntitySet Name>|headerEditable::<Annotation information>"

Simple object header facets:
- "BeforeSimpleHeaderFacet|<EntitySet Name>|headerEditable::<Annotation information>"
- "ReplaceSimpleHeaderFacet|<EntitySet Name>|headerEditable::<Annotation information>"
- "AfterSimpleHeaderFacet|<EntitySet Name>|headerEditable::<Annotation information>"

Replace entire header (use if there is no UI.HeaderFacet annotation):
- "ReplaceHeaderExtensionFacet|<EntitySet Name>"

Image-related placements (standard header):
- "NoImageExtensionFacet|<EntitySet Name>"   (only if HeaderInfo.ImageUrl/TypeImageUrl is empty)
- "AfterImageExtensionFacet|<EntitySet Name>"

Header DataPoint-only header:
- "BeforeHeaderDataPoint|<EntitySet Name>|<Annotation Information>"
- "ReplaceHeaderDataPoint|<EntitySet Name>|<Annotation Information>"
- "AfterHeaderDataPoint|<EntitySet Name>|<Annotation Information>"
```

STEP: 3 — OData V2: show caution + visibility flag details
DESCRIPTION: Implementation reminders for V2 extensions.
LANGUAGE: TEXT
CODE:
```text
- Use app extensions only when manifest settings or annotations cannot implement the behavior.
- Integrate using only the SAP Fiori elements extensionAPI (do not access internal controls/models).
- bVisibleOnEdit (optional): set to false only if the entire header extension should be hidden in edit mode.
```

STEP: 4 — OData V2: Display custom status message on object header with extensionAPI.setCustomMessage
DESCRIPTION: Attach to page data loaded event and call extensionAPI.setCustomMessage with message and type. The code belongs in your extension controller (sap.ui.define module).
LANGUAGE: JavaScript
CODE:
```javascript
sap.ui.define([], function () {
    return {
        onInit: function () {
            // hook into page data loaded lifecycle
            this.extensionAPI.attachPageDataLoaded(this.onPageDataLoaded.bind(this));
        },
        onPageDataLoaded: function(oEvent) {
            // oEvent.context is the binding context for the current page entity
            var quantity = oEvent.context.getObject().quantity;
            var oMsg = {
                message: quantity === 0 ? "Product Not Available!" : "Product Available!",
                type: quantity === 0 ? sap.ui.core.MessageType.Error : sap.ui.core.MessageType.Success
            };
            // show message strip on object page header
            this.extensionAPI.setCustomMessage(oMsg);
        }
        // ...
    };
});
```

STEP: 5 — OData V4: Add custom header facets (content-based configuration)
DESCRIPTION: Use content configuration inside target route options -> settings to add custom header facets. Keys under "settings.content.header.facets" define template fragment, optional templateEdit, title/subTitle, visibility, stashed, position and flexSettings. Content-based configuration has higher priority than annotation-based config.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  "facets": {
                    "CustomHeaderFacet1": {
                      "template": "SalesOrder.ext.CustomHeaderFacetColumnChart",
                      "stashed": false,
                      "visible": "{= %{OverallSDProcessStatus} === 'C'}",
                      "position": {
                        "placement": "After",
                        "anchor": "NetValueDataHeader"
                      },
                      "flexSettings": {
                        "designtime": "not-adaptable-visibility"
                      }
                    },
                    "CustomHeaderFacet2": {
                      "template": "SalesOrder.ext.CustomHeaderFacetDataPoint",
                      "templateEdit": "SalesOrder.ext.CustomHeaderFacetDataPointEdit",
                      "title": "{i18n>customHeaderFacet2-CustomDataPoint}",
                      "subTitle": "{i18n>customHeaderFacet2-CarRental}",
                      "requestGroupId": "LongRunners",
                      "stashed": false,
                      "position": {
                        "placement": "After",
                        "anchor": "CustomHeaderFacet1"
                      }
                    }
                  }
                }
              },
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.HeaderFacets": {
                  // annotation-based mapping can go here
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 6 — OData V4: Annotation-based override for custom header facets (lower priority)
DESCRIPTION: Provide fallback or annotation-based facet definitions under controlConfiguration/@com.sap.vocabularies.UI.v1.HeaderFacets.facets. Note: keys also used in content configuration will be ignored if content-based has same key.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "header": {
                  /* ...same as content-based... */
                }
              },
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.HeaderFacets": {
                  "facets": {
                    "CustomHeaderFacet2": {
                      "template": "SalesOrder.ext.CustomHeaderFacetOverwritten",
                      "title": "Custom Error",
                      "subTitle": "Should never appear!",
                      "stashed": false,
                      "position": {
                        "placement": "After",
                        "anchor": "CustomHeaderFacet1"
                      }
                    },
                    "CustomHeaderFacet3": {
                      "template": "SalesOrder.ext.CustomHeaderFacetHarveyBall",
                      "templateEdit": "SalesOrder.ext.CustomHeaderFacetHarveyBallEdit",
                      "title": "{i18n>customHeaderFacet2-CustomProgress}",
                      "stashed": false,
                      "position": {
                        "placement": "After",
                        "anchor": "CustomHeaderFacet2"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 7 — OData V4: Custom header facet properties reference
DESCRIPTION: Properties you can set for each custom header facet. Use these in content or controlConfiguration.
LANGUAGE: TEXT
CODE:
```text
Properties:
- template: Module path of XMLFragment (required)
- templateEdit: Module path of editable XMLFragment (optional)
- title: Text or binding expression (optional)
- subTitle: Text or binding expression (optional)
- stashed: boolean (default false) (optional)
- visible: boolean or binding expression (default true) (optional)
- position:
    - placement: "Before" | "After" (default "After") (optional)
    - anchor: facet key to position relative to (optional)
- requestGroupId: "Heroes" | "Decoration" | "Workers" | "LongRunners" (optional) — groups backend requests for loading optimization
- flexSettings:
    - designtime: "Default" | "not-adaptable-visibility" | "not-adaptable" | "not-adaptable-tree" | "not-removable" (optional)
Priority: content-based settings overwrite annotation-based settings for identical keys.
```

STEP: 8 — OData V4: Example custom header XML fragment — Harvey Ball Micro Chart (read-only)
DESCRIPTION: Implement an XML fragment that binds values for a HarveyBallMicroChart. Place this fragment at module path referenced by "template".
LANGUAGE: XML
CODE:
```XML
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:mc="sap.suite.ui.microchart">
  <VBox id="CustomHeaderFacetHarveyBall" displayInline="true">
    <mc:HarveyBallMicroChart size="S" total="100" totalScale="%" press="press">
      <mc:items>
        <mc:HarveyBallMicroChartItem
          fraction="{= ((100 > 0) ? ((${Progress} > 100) ? 100 : ((${Progress} &lt; 0) ? 0 : (${Progress} / 100 * 100))) : 0) }"
          color="Good"
          fractionScale="%"
        />
      </mc:items>
    </mc:HarveyBallMicroChart>
  </VBox>
</core:FragmentDefinition>
```

STEP: 9 — OData V4: Editable header facet fragment (FormElements with macro:Field)
DESCRIPTION: For edit mode, implement an XML fragment using FormElement and macro:Field. Reference via templateEdit.
LANGUAGE: XML
CODE:
```XML
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:f="sap.ui.layout.form" xmlns:macro="sap.fe.macros">
  <f:FormElement label="Number of Items">
    <f:fields>
      <macro:Field id="NumberItems" metaPath="fieldControlType_item" />
    </f:fields>
  </f:FormElement>
  <f:FormElement label="Classification">
    <f:fields>
      <macro:Field id="IncotermsClassification" metaPath="IncotermsClassification" />
    </f:fields>
  </f:FormElement>
</core:FragmentDefinition>
```

STEP: 10 — OData V4: Add custom header fields (annotation-based controlConfiguration)
DESCRIPTION: Define custom read-only header fields inside controlConfiguration using the FieldGroup annotation path (qualifier) and reference an XML fragment as "template". Use position.placement and position.anchor to locate before/after an existing field.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "LineItemsObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.FieldGroup#ObjectPageHeaderData": {
                  "fields": {
                    "CustomField1": {
                      "label": "{i18n>ObjectPageHeaderFacetFieldLabel1}",
                      "template": "ManageItems.ext.CustomHeaderFacetFieldGroupForm",
                      "position": {
                        "placement": "Before",
                        "anchor": "DataField::headerDate"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 11 — OData V4: Metadata example — FieldGroup qualifier
DESCRIPTION: Example snippet from service metadata/annotation showing how the FieldGroup qualifier maps to the controlConfiguration key.
LANGUAGE: XML
CODE:
```XML
<Schema>
  <Annotations Target="<PageName>">
    <Annotation Term="UI.FieldGroup" Qualifier="ObjectPageHeaderData">
      <!-- records -->
    </Annotation>
  </Annotations>
</Schema>
```

STEP: 12 — OData V4: Anchor key selection guidance
DESCRIPTION: To position custom facets/fields use the anchor facet key. Anchor keys for facets are the FacetKey from UI.Facet annotations. For fields in a field group, use the property name referenced in the field group. See finding-the-right-key-for-the-anchor documentation if uncertain.
LANGUAGE: TEXT
CODE:
```text
- Use FacetKey for header facets defined by UI.Facet annotations as anchor.
- Use property name or DataField reference for header fields inside a FieldGroup as anchor.
```

STEP: 13 — References and best practices
DESCRIPTION: Short list of best practices for implementers.
LANGUAGE: TEXT
CODE:
```text
- Prefer manifest settings and annotations over extensions where possible.
- If you extend, stick to extensionAPI functions only and avoid touching internal Fiori elements controls or models.
- Use requestGroupId to optimize loading: separate long-running requests from fast ones.
- Use flexSettings.designtime to control key-user adaptation options.
```
--------------------------------

**TITLE**: Custom Pages and Extension Points for SAP Fiori elements (OData V4)

**INTRODUCTION**: Step-by-step instructions and ready-to-use code samples to add custom pages (component targets) to a SAP Fiori elements app using the flexible programming model (FPM). Includes manifest routing configuration, XML view examples (GenericTile and Table building block), controller navigation using the routing controller extension, and target property requirements. Applicable only to SAP Fiori elements for OData V4.

**TAGS**: fiori-elements-framework, sapui5, odata-v4, custom-page, routing, fpm, building-blocks, xml-view, controller-extension, manifest.json

STEP: 1 — Add routing targets to webapp/manifest.json

DESCRIPTION: Add routes and targets to manifest.json to register custom pages as Component targets using name "sap.fe.core.fpm". Use options.settings.viewName to point to your custom XML view (prefix with sap.app.id + path under app/webapp). Define contextPath (entity set) and navigation mapping between targets (route names). Put this snippet under the "sap.ui5" -> "routing" node.

LANGUAGE: JSON

CODE:
```json
{
   "sap.ui5": {
        "routing": {
            "routes": [
                {
                    "pattern": ":?query:",
                    "name": "customPage",
                    "target": "customPage"
                },
                {
                    "pattern": "/RootEntity({key}):?query:",
                    "name": "objectPage",
                    "target": "objectPage"
                },
                {
                    "pattern": "/RootEntity({key})/items({key2}):?query:",
                    "name": "customDetailPage",
                    "target": "customDetailPage"
                }
            ],
            "targets": {
                "customPage": {
                    "type": "Component",
                    "id": "customPage",
                    "name": "sap.fe.core.fpm",
                    "options": {
                        "settings": {
                            "viewName": "sap.fe.core.fpmExplorer.customPageContent.CustomPage",
                            "contextPath": "/RootEntity",
                            "navigation": {
                                "RootEntity": {
                                    "detail": {
                                        "route": "objectPage"
                                    }
                                }
                            }
                        }
                    }
                },
                "objectPage": {
                    "type": "Component",
                    "id": "objectPage",
                    "name": "sap.fe.templates.ObjectPage",
                    "options": {
                        "settings": {
                            "contextPath": "/RootEntity",
                            "editableHeaderContent": false,
                            "navigation": {
                                "items": {
                                    "detail": {
                                        "route": "customDetailPage"
                                    }
                                }
                            }
                        }
                    }
                },
                "customDetailPage": {
                    "type": "Component",
                    "id": "customDetailPage",
                    "name": "sap.fe.core.fpm",
                    "options": {
                        "settings": {
                            "viewName": "sap.fe.core.fpmExplorer.customPageContent.CustomDetailPage",
                            "contextPath": "/ChildEntity",
                            "navigation": {}
                        }
                    }
                }
            }
        }
   }
}
```

STEP: 2 — Custom page target properties (requirements and semantics)

DESCRIPTION: Use these properties for each Component target under "targets" in manifest.json. Ensure viewName uses the app id prefix and the path under webapp. contextPath should be the entity set path (e.g., "/RootEntity"). Use "sap.fe.core.fpm" as name to enable FPM features. Example template:

LANGUAGE: JSON

CODE:
```json
{
  "type": "Component",                // must be "Component"
  "id": "<unique_page_id>",          // unique page identifier
  "name": "sap.fe.core.fpm",         // use FPM component to enable building blocks & draft flow
  "options": {
    "settings": {
      "viewName": "<sap.app.id>.<path>.CustomPage", // XML view name (prefix with sap.app.id)
      "contextPath": "/RootEntity",                 // entity set path (or entity)
      "navigation": { /* mapping to other routes */ }
    }
  }
}
```

STEP: 3 — Create custom XML view (GenericTile example using binding context)

DESCRIPTION: Create an XML view file for the custom page. The OData binding context is available in the view and controller. Example view uses a HorizontalLayout with GenericTile bound to /RootEntity. Put file under webapp matching the viewName path (example path used below).

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/sap/fe/core/fpmExplorer/customPageContent/CustomPage.view.xml -->
<mvc:View
    id="application-product"
    height="100%"
    controllerName="sap.fe.core.fpmExplorer.customPageContent.CustomPage"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:l="sap.ui.layout"
    xmlns:macros="sap.fe.macros"
>
    <Page>
        <content>
            <l:HorizontalLayout id="TileContainerExpanded" allowWrapping="true" content="{/RootEntity}" class="sapUiTinyMarginTopBottom">
                <GenericTile header="{TitleProperty}" subheader="{DescriptionProperty}" press="onPressed" class="sapUiTinyMarginEnd">
                    <TileContent unit="{unit}" footer="{footer}">
                        <NumericContent withMargin="false" value="{kpivalue}" valueColor="{color}" indicator="{trend}" scale="{scale}" />
                    </TileContent>
                </GenericTile>
            </l:HorizontalLayout>
        </content>
    </Page>
</mvc:View>
```

STEP: 4 — Create custom XML view using Table building block

DESCRIPTION: Use the FPM building block macro Table to automatically get standard UI behavior (annotations-driven columns, routing/navigation) inside your custom page. Put file under webapp matching viewName path.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/sap/fe/core/fpmExplorer/customPageContent/CustomPageWithTable.view.xml -->
<mvc:View
    id="application-product"
    height="100%"
    controllerName="sap.fe.core.fpmExplorer.customPageContent.CustomPage"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:l="sap.ui.layout"
    xmlns:macros="sap.fe.macros"
>
    <Page>
        <content>
            <macros:Table contextPath="/RootEntity" metaPath="@com.sap.vocabularies.UI.v1.LineItem" id="macroTable" />
        </content>
    </Page>
</mvc:View>
```

STEP: 5 — Implement controller and use routing controller extension for context-based navigation

DESCRIPTION: Controller extends PageController. Use the event source binding context and call this.routing.navigate(oContext) to navigate to the target route defined in manifest navigation mapping. Place controller under the path matching controllerName.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/sap/fe/core/fpmExplorer/customPageContent/CustomPage.controller.js
sap.ui.define(["sap/fe/core/PageController", "sap/ui/core/UIComponent"], function(PageController, UIComponent) {
    "use strict";

    return PageController.extend("sap.fe.core.fpmExplorer.customPageContent.CustomPage", {
        onPressed: function(oEvent) {
            var oContext = oEvent.getSource().getBindingContext();
            // routing extension resolves route mapping defined in manifest.targets.<id>.options.settings.navigation
            this.routing.navigate(oContext);
        }
    });
});
```

STEP: 6 — Notes, behavior, and links

DESCRIPTION: Key reminders for implementation:
- Applicable only for SAP Fiori elements OData V4.
- viewName must include sap.app.id prefix and the path under app/webapp.
- Use name "sap.fe.core.fpm" for FPM features and building blocks support.
- Building block macros (e.g., macros:Table) automatically integrate with standard routing and draft flows; no manual press handlers required for table row navigation.
- Live example and reference: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/topic/customPage
--------------------------------

**TITLE**: Extension Points and Custom Sections for Object Page (SAP Fiori elements — OData V2 & V4)

**INTRODUCTION**: Practical, code-focused guide showing how to add custom sections (facets) to the Object Page for SAP Fiori elements applications. Covers:
- OData V2: use view extensions with facet extension keys (BeforeFacet / ReplaceFacet / AfterFacet).
- OData V4: define custom sections in the routing target settings (content.body.sections).
Includes manifest snippets, fragment skeleton, UI model binding, form alignment class, and property definitions for custom sections.

**TAGS**: fiori-elements, manifest.json, extension, object-page, custom-section, facet, ODataV2, ODataV4, xmlfragment, sap.ui5

STEP: 1 — Caution and integration rules

DESCRIPTION: Follow these rules when implementing app extensions for SAP Fiori elements:
- Use only the SAP Fiori elements extensionAPI. Do not access or manipulate internal controls/models created by the framework.
- Use app extensions only when manifest settings or annotations cannot provide the required behavior.
- After you add an extension, display/layout and system behavior (bindings, busy handling) are the application's responsibility.
- For OData V2 the term "facet" is used; for OData V4 the term "section" is used in manifest.json.

LANGUAGE: text

CODE:
```
Caution:
- Use only the SAP Fiori elements extensionAPI.
- Avoid accessing/manipulating internal framework controls or models.
- Prefer manifest/annotation configuration; use extensions only when necessary.
```

STEP: 2 — OData V2: Add extension points (BeforeFacet / ReplaceFacet / AfterFacet) in manifest.json

DESCRIPTION: Add view extension entries under extends.extensions.sap.ui.viewExtensions. Each extension key has the pattern:
  <Placement>|<EntitySet>|<AnnotationPath> [|<optional index>]
Supported placements: BeforeFacet, ReplaceFacet, AfterFacet.
Always specify entitySet because the same annotation path can exist for multiple entity sets.
You can reference either a fragment or a view. Example below shows XML fragments.

LANGUAGE: JSON

CODE:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.viewExtensions": {
        "sap.suite.ui.generic.template.ObjectPage.view.Details": {
          "BeforeFacet|SEPMRA_C_PD_Product|to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "nw.epm.refapps.st.prod.manage.ext.BeforeFacetTest",
            "type": "XML",
            "sap.ui.generic.app": {
              "title": "Facet Breakout before Product Text LineItem"
            }
          },
          "BeforeFacet|SEPMRA_C_PD_Product|to_ProductText::com.sap.vocabularies.UI.v1.LineItem|1": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "nw.epm.refapps.st.prod.manage.ext.BeforeFacetTestNew",
            "type": "XML",
            "sap.ui.generic.app": {
              "title": "Facet Breakout before Product Text LineItem",
              "key": "1"
            }
          },
          "AfterFacet|SEPMRA_C_PD_Product|to_Supplier::com.sap.vocabularies.UI.v1.Identification": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "nw.epm.refapps.st.prod.manage.ext.AfterFacetTest",
            "type": "XML",
            "sap.ui.generic.app": {
              "title": "Facet Breakout after Supplier Identification"
            }
          },
          "AfterFacet|SEPMRA_C_PD_Product|to_Supplier::com.sap.vocabularies.UI.v1.Identification|1": {
            "className": "sap.ui.core.Fragment",
            "fragmentName": "nw.epm.refapps.st.prod.manage.ext.AfterFacetTest",
            "type": "XML",
            "sap.ui.generic.app": {
              "title": "Facet Breakout after Supplier Identification",
              "key": 1
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — OData V4: Define custom sections in manifest routing target settings

DESCRIPTION: For OData V4, extend the object page target settings (sap.ui5.routing.targets.<Target>.options.settings.content.body.sections). Each section key is a custom id you reference for positioning. Properties: template (fragment module path), title (text or binding), position {placement, anchor}, visible, actions, subSections (optional). Use i18n binding for titles when needed.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "customSection": {
                      "template": "SalesOrder.ext.CustomSection",
                      "title": "{i18n>customSection}",
                      "position": {
                        "placement": "Before",
                        "anchor": "SalesOrderItems"
                      }
                    },
                    "anotherCustomSection": {
                      "title": "Multiple Subsections",
                      "subSections": {
                        "firstSubSectionKey": {
                          "title": "First Subsection",
                          "template": "SalesOrder.ext.CustomFieldForm"
                        },
                        "secondSubSectionKey": {
                          "title": "Second Subsection",
                          "template": "SalesOrder.ext.CustomFieldForm2",
                          "position": {
                            "placement": "After",
                            "anchor": "firstSubSectionKey"
                          }
                        }
                      },
                      "position": {
                        "placement": "After",
                        "anchor": "customSection"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — Custom section properties (reference)

DESCRIPTION: Use these properties for each custom section or subSection. Title and position.anchor are mandatory where indicated.

LANGUAGE: text

CODE:
```
Properties:
- template: "<module_path_to_a_fragment>"          // Fragment.load syntax
- title*: "<text_or_binding_expression>"           // e.g. "{i18n>customSection}"
- position: {placement, anchor}                    // placement: "Before" | "After" (default After)
- position.placement: "Before" | "After"
- position.anchor*: key of another section or FacetId (for facets defined via annotations)
- visible: Boolean | binding expression              // default true
- actions: ActionsObject (same format as custom actions via extension points)
- subSections: object of subsection keys -> {title, template, position, visible, actions}
(* = recommended/required depending on usage)
```

STEP: 5 — XML fragment skeleton (fragmentName / module path and required class for forms)

DESCRIPTION: Minimal XML fragment to be referenced via template / fragmentName. If using a Form control inside a custom section, add class="sapUxAPObjectPageSubSectionAlignContent" to align correctly within the Object Page subsection.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/ext/CustomSection.fragment.xml
     Module path: SalesOrder.ext.CustomSection (example reference used in manifest)
-->
<core:FragmentDefinition
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:uxap="sap.uxap"
  xmlns:form="sap.ui.layout.form">
  <!-- Example: a simple vertical box with a form -->
  <VBox>
    <Title text="{i18n>customSectionHeader}" />
    <!-- If using a form, apply the class for alignment -->
    <form:Form class="sapUxAPObjectPageSubSectionAlignContent">
      <form:layout>
        <form:GridLayout/>
      </form:layout>
      <form:formContainers>
        <form:FormContainer>
          <form:formElements>
            <form:FormElement>
              <form:label>
                <Label text="Custom Field"/>
              </form:label>
              <form:fields>
                <Input value="{path: 'myModel>/MyProperty'}" />
              </form:fields>
            </form:FormElement>
          </form:formElements>
        </form:FormContainer>
      </form:formContainers>
    </form:Form>
  </VBox>
</core:FragmentDefinition>
```

STEP: 6 — Using the UI model in fragments (binding example)

DESCRIPTION: Use the UI model to react to editMode or other UI states. Example binding expression to enable a control only in Editable editMode.

LANGUAGE: XML

CODE:
```xml
<!-- Example attribute binding inside a fragment -->
<Button
  text="{i18n>save}"
  enabled="{= ${ui>/editMode} === 'Editable'}" />
```

STEP: 7 — Positioning and anchors (how to reference facets and sections)

DESCRIPTION:
- Use position.anchor to specify the target section key or a FacetId from annotations.
- placement can be "Before" or "After" (default is After).
- For OData V2 facets, use the annotation path in the extension key and the entitySet name to disambiguate.
- For OData V4, use the custom section key or the FacetId of a facet defined by annotations.

LANGUAGE: text

CODE:
```
Examples:
- OData V2 extension key: "BeforeFacet|<EntitySet>|<AnnotationPath>" or with index: "...|1"
- OData V4 position:
  "position": { "placement": "Before", "anchor": "SalesOrderItems" }
- anchor can be an annotation-based FacetId or another custom section key.
```

STEP: 8 — Additional notes and checklist

DESCRIPTION: Final practical notes to ensure custom section works correctly.

LANGUAGE: text

CODE:
```
Checklist:
- Ensure fragment module paths and fragment file names match the manifest entries.
- Add translations for title bindings (i18n files).
- For examples using a LineItem service, ensure the service (e.g., service.cds) is present.
- Apply class="sapUxAPObjectPageSubSectionAlignContent" to forms to align them properly inside subsections.
- Use extensionAPI where custom controller logic is required.
- Do not manipulate internal SAP Fiori elements framework controls/models.
- For step-by-step examples, see: Adding a Custom Section to an Object Page (adding-a-custom-section-to-an-object-page-a357047.md)
- For general extension points: ../08_Extending_SAPUI5_Applications/extension-points-403c050.md
- For extensionAPI usage: using-the-extensionapi-bd2994b.md
```
--------------------------------

**TITLE**: Object Page — Adding Custom Subsections (Extension Points) for OData V2 and V4

**INTRODUCTION**: Practical, code-focused guidance for adding additional subsections to an Object Page in SAP Fiori elements using extension points. Includes corrected, ready-to-use manifest snippets for OData V2 (viewExtensions) and OData V4 (content block), minimal example view/fragment files, and actionable notes about annotation path keys, entity set requirement, lazy loading, and best practices.

**TAGS**: fiori-elements, object-page, extension-points, subsections, facets, sections, manifest.json, ODataV2, ODataV4, xmlfragment, viewExtensions

STEP: 1 — Important cautions and best practices

DESCRIPTION: Follow these rules before implementing extensions: use extensionAPI only, avoid manipulating internal framework controls/models, prefer manifest/annotations over app extensions where possible.

LANGUAGE: Text

CODE:
```text
- Use only the SAP Fiori elements extensionAPI for custom logic.
- Avoid accessing or manipulating internal controls, properties, or models created by the framework.
- Prefer manifest settings and annotations rather than app extensions when possible.
- For OData V2 the manifest term is "facet" and for OData V4 it is "section".
- Always specify the entitySet and the annotation path when targeting an annotation-defined subsection (annotation path may exist for multiple entity sets).
```

STEP: 2 — OData V2: Add/Replace/Position a custom subsection using sap.ui.viewExtensions

DESCRIPTION: Add a custom view or fragment into an existing facet subsection using the viewExtensions block in webapp/manifest.json. Keys follow the pattern: "<Placement>|<EntitySet>|<AnnotationPath>" where Placement is BeforeSubSection, AfterSubSection, or ReplaceSubSection. Enable lazy loading per extension if desired.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "viewExtensions": {
      "sap.suite.ui.generic.template.ObjectPage.view.Details": {
        "BeforeSubSection|STTA_C_MP_Product|to_ProductSalesData::com.sap.vocabularies.UI.v1.Chart": {
          "className": "sap.ui.core.mvc.View",
          "viewName": "STTA_MP.ext.view.ProductSalesPrice",
          "type": "XML",
          "sap.ui.generic.app": {
            "title": "Target Sales Prices",
            "enableLazyLoading": true
          }
        },
        "AfterSubSection|STTA_C_MP_Product|to_ProductSalesData::com.sap.vocabularies.UI.v1.LineItem": {
          "className": "sap.ui.core.mvc.View",
          "viewName": "STTA_MP.ext.view.ProductSalesPrice",
          "type": "XML",
          "sap.ui.generic.app": {
            "title": "Target Sales Prices",
            "enableLazyLoading": true
          }
        },
        "ReplaceSubSection|STTA_C_MP_Product|to_ProductTextType::com.sap.vocabularies.UI.v1.LineItem": {
          "className": "sap.ui.core.mvc.View",
          "viewName": "STTA_MP.ext.view.ProductSalesPrice",
          "type": "XML",
          "sap.ui.generic.app": {
            "title": "Target Sales Prices",
            "enableLazyLoading": true
          }
        }
      }
    }
  }
}
```

STEP: 3 — OData V2: Example XML view file for a custom subsection (view variant)

DESCRIPTION: Put this view under webapp/ext/view/ProductSalesPrice.view.xml and reference it in the manifest viewName above.

LANGUAGE: XML

CODE:
```xml
<mvc:View controllerName="STTA_MP.ext.controller.ProductSalesPrice"
          xmlns:mvc="sap.ui.core.mvc"
          xmlns="sap.m">
  <VBox>
    <Text text="Custom subsection content - sales price" />
    <!-- Add controls, bindings, or fragments here. Keep busy handling and model usage consistent with the framework. -->
  </VBox>
</mvc:View>
```

STEP: 4 — OData V2: Example XML fragment alternative (fragment variant)

DESCRIPTION: If you prefer a fragment instead of a view, reference the fragment name from the manifest entry and place this file at webapp/ext/fragment/ProductSalesPrice.fragment.xml.

LANGUAGE: XML

CODE:
```xml
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
  <VBox>
    <Text text="{i18n>customSubSectionText}" />
  </VBox>
</core:FragmentDefinition>
```

STEP: 5 — OData V4: Define a custom subsection via the content block in manifest routing target

DESCRIPTION: For OData V4, extend the routing target options.settings.content.body.sections.<customKey>.subSections.<subKey>. Use type "XMLFragment" or "View", set "name" to the fragment/view path, optionally localize the title, and set position. Place this under webapp/manifest.json -> sap.ui5.routing.targets.<YourTarget>.options.settings.content.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "myObjectPageSection": {
                      "subSections": {
                        "customSubSection": {
                          "type": "XMLFragment",
                          "name": "SalesOrder.ext.CustomSubSection",
                          "title": "{i18n>customSubSection}",
                          "position": {
                            "placement": "After",
                            "anchor": "someSubSection"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 6 — OData V4: Example fragment file for custom subsection

DESCRIPTION: Save this fragment at webapp/ext/fragment/CustomSubSection.fragment.xml and reference it with "SalesOrder.ext.CustomSubSection" (namespace + fragment name).

LANGUAGE: XML

CODE:
```xml
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
  <VBox>
    <Text text="{i18n>customSubSectionText}" />
    <!-- Use supported UI5 controls and bindings; do not manipulate internal framework controls. -->
  </VBox>
</core:FragmentDefinition>
```

STEP: 7 — Notes: placement keys, annotation path format, lazy loading, and UI5 tags

DESCRIPTION: Quick actionable reminders to avoid common mistakes.

LANGUAGE: Text

CODE:
```text
- Annotation path key format (OData V2 extension keys):
  "<Placement>|<EntitySet>|<AnnotationPath>"
  Example: "AfterSubSection|STTA_C_MP_Product|to_ProductSalesData::com.sap.vocabularies.UI.v1.LineItem"

- EntitySet is mandatory: multiple entity sets may reference the same annotation path.

- You can provide either a View or an XML fragment. Do NOT add ObjectPageSection / subSections / ObjectPageSubSection tags manually — the template handles these.

- Enable lazy loading per extension using "sap.ui.generic.app": { "enableLazyLoading": true } in the extension entry.

- Keep all custom behaviors within the extension API and application code; do not access framework internals.
```

STEP: 8 — Live example and prerequisites

DESCRIPTION: Link to the live explorer example and required service artifact.

LANGUAGE: Text

CODE:
```text
- Live example: UI5 Fiori elements explorer -> Standard Floorplans - Extensions - Extensions for Object Pages - Custom Subsection
  URL: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/topic/floorplanObjectPage/customSubSection

- Prerequisite for the live example: ensure a LineItem service exists (e.g. service.cds in the example).
```
--------------------------------

**TITLE**: Adding Custom Columns to Tables in SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: Practical, code-focused steps to add custom columns to Fiori Elements tables (List Report and Object Page) by defining fragments, manifest entries, and controller extensions. Includes allowed keys, ID patterns, properties used for sorting/filtering/export, and important constraints.

**TAGS**: fiori-elements, extension-points, custom-column, manifest.json, fragment, controller-extension, ODataV2, ODataV4

**STEP**: 1 — Extension point names by table type (OData V2)
**DESCRIPTION**: Choose the correct extension point name based on table type and floorplan. Use these exact identifiers in your extension registration or controller-extension implementation.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "All": {
    "ObjectPage": "onBeforeRebindTableExtension"
  },
  "ResponsiveTable": {
    "ListReport": "ResponsiveTableColumnsExtension|<EntitySet>",
    "ObjectPage": "ResponsiveTableColumnsExtension|<TableEntitySet>|<FacetID/AnnotationPath>",
    "Cells": {
      "ListReport": "ResponsiveTableCellsExtension|<EntitySet>",
      "ObjectPage": "ResponsiveTableCellsExtension|<TableEntitySet>|<FacetID/AnnotationPath>"
    }
  },
  "GridTable": {
    "ListReport": "GridTableColumnsExtension|<EntitySet>",
    "ObjectPage": "GridTableColumnsExtension|<TableEntitySet>|<FacetID/AnnotationPath>"
  },
  "AnalyticalTable": {
    "ListReport": "AnalyticalTableColumnsExtension|<EntitySet>",
    "ObjectPage": "GridTableColumnsExtension|AnalyticalTableColumnsExtension|<TableEntitySet>|<FacetID/AnnotationPath>"
  },
  "TreeTable": {
    "ListReport": "TreeTableColumnsExtension|<EntitySet>"
  }
}
```

**STEP**: 2 — Create an XML fragment that defines the custom column template
**DESCRIPTION**: Define a fragment file that will be referenced by the manifest "template" property. Keep the fragment path consistent with the template value in manifest (e.g., SalesOrder.ext.fragment.CustomColumnLRButton).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: webapp/ext/fragment/CustomColumnLRButton.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m" xmlns:l="sap.ui.layout">
    <l:VerticalLayout id="myVL">
        <Button id="myButtonId" text="Custom Button" press="SalesOrder.ext.controller.LRExtend.buttonPressed" />
    </l:VerticalLayout>
</core:FragmentDefinition>
```

**STEP**: 3 — Add controller extensions in manifest.json to register controllers
**DESCRIPTION**: Register controller-extensions for ListReport and ObjectPage so your handlers are available to fragments. Place this under "sap.ui5.extends.extensions.sap.ui.controllerExtensions".
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ListReport.ListReportController": {
            "controllerName": "SalesOrder.ext.controller.LRExtend"
          },
          "sap.fe.templates.ListReport.ObjectPageController": {
            "controllerName": "SalesOrder.ext.controller.OPExtend"
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Define custom columns in manifest.json (List Report / Object Page)
**DESCRIPTION**: Add a "controlConfiguration" entry in the target "options.settings" and declare your custom column(s). Use "template" to point to the fragment (module path without extension). Use "properties" to enable sorting/filtering/export linkage. Set "position" with "anchor" referencing a column key (FieldId for annotated columns).
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "columns": {
                    "CustomColumnRating": {
                      "header": "{i18n>LR.Custom_Column|Button}",
                      "width": "10em",
                      "importance": "High",
                      "horizontalAlign": "Center",
                      "position": {
                        "placement": "After",
                        "anchor": "DataFieldForAnnotation::FieldGroup::multipleActionFields"
                      },
                      "template": "SalesOrder.ext.fragment.CustomColumnLRButton",
                      "availability": "Default",
                      "properties": [
                        "ID",
                        "TotalNetAmount",
                        "_CustomerPaymentTerms/CustomerPaymentTerms",
                        "_ShipToParty/BusinessPartner"
                      ]
                    },
                    "CustomColumnWithHeaderFromMetaData": {
                      "header": "{metaModel>/SalesOrderManage/SoldToParty@com.sap.vocabularies.Common.v1.Label}",
                      "template": "SalesOrder.custom.CustomColumnButton",
                      "availability": "Default",
                      "position": {
                        "placement": "After",
                        "anchor": "DataFieldForAnnotation::FieldGroup::multipleActionFields"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                  "columns": {
                    "CustomColumnOnObjectPage": {
                      "header": "AnotherColumnLabel",
                      "template": "SalesOrder.ext.fragment.CustomColumnOPButton",
                      "availability": "Adaptation"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Implement controller extension (handler & lifecycle overrides)
**DESCRIPTION**: Implement the button press handler and optional lifecycle overrides in the controller extension. Export the ControllerExtension using sap.ui.define. Use MessageBox or other UI5 APIs as needed.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// File: webapp/ext/controller/LRExtend.controller.js
sap.ui.define([
    "sap/ui/core/mvc/ControllerExtension",
    "sap/m/MessageBox"
], function (ControllerExtension, MessageBox) {
    "use strict";
    return ControllerExtension.extend("SalesOrder.ext.controller.LRExtend", {
        buttonPressed: function () {
            MessageBox.show("Button pressed!");
        },

        // Optional: override lifecycle/public methods of base controller
        override: {
            routing: {
                onBeforeNavigation: function (oContextInfo) {
                    // Custom code
                }
            },
            editFlow: {
                onBeforeDelete: function (oParameters) {
                    // Custom code
                }
            }
        }
    });
});
```

**STEP**: 6 — Allowed keys, ID patterns and custom column ID generation (OData V4)
**DESCRIPTION**: Use only allowed characters for custom column keys and follow the ID patterns generated by the framework so anchors and references match.
**LANGUAGE**: Text
**CODE**:
```
Allowed characters for custom column key: A-Z a-z 0-9  :  _  -  

ID patterns:
- UI.DataField columns: ...::C::<AnnotationType>::<Property>
  Example ID fragment: SalesOrder::SalesOrderManageList--fe::table::SalesOrderManage::LineItem::C::FieldGroup::multipleActionFields-innerColumnHeader

- Custom columns: ...C::CustomColumn::<key>
  Example template key: CustomColumnRating
```

**STEP**: 7 — Configure properties array for sorting/filtering/export/message mapping
**DESCRIPTION**: Provide properties (string or array of strings) in the column config so the framework enables sorting, filtering, message linking, and export behavior. Navigation properties cannot be sorted by backend.
**LANGUAGE**: JSON
**CODE**:
```json
"properties": [
  "TotalNetAmount",
  "_CustomerPaymentTerms/CustomerPaymentTerms"
]
```

**STEP**: 8 — Bind UI model values inside fragment (example for edit mode)
**DESCRIPTION**: Use the UI model binding inside fragment controls to react to app state, e.g., enable/disable based on editMode.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- binding example used inside fragment control attributes -->
<Button enabled="{= ${ui>/editMode} === 'Editable'}" text="Action" />
```

**STEP**: 9 — Positioning: find anchor keys and use position.anchor/placement
**DESCRIPTION**: To position a custom column relative to another column use position.anchor (key of referenced column) and position.placement ("After"|"Before"). For annotated columns, reference their FieldId. See "Finding the Right Key for the Anchor" for how to determine the anchor key.
**LANGUAGE**: JSON
**CODE**:
```json
"position": {
  "placement": "After",
  "anchor": "DataFieldForAnnotation::FieldGroup::multipleActionFields"
}
```

**STEP**: 10 — Important constraints and quick notes
**DESCRIPTION**: Keep these rules and limitations in mind during implementation.
**LANGUAGE**: Text
**CODE**:
```
- Use extensionAPI only; do not access Fiori Elements internals (controls, internal models) directly.
- availability: "Default" | "Adaptation" | "Hidden"
  - Default: shown in table
  - Adaptation: initially hidden; available in key user adaptation (Add/Remove Columns)
  - Hidden: not available at all
- width: "auto" | "<length>" | "<percent>" | "inherit"
- importance: "High" | "Medium" | "Low" controls responsive pop-in order
- When using the Table building block, defining custom columns in manifest.json is NOT supported.
- For replacing default navigation, use ListReportExtension (list report) or DetailsExtension (object page).
- For OData V2 use the extension point names provided in step 1.
```
--------------------------------

**TITLE**: Defining and Handling Custom Views (Tabs) in Fiori Elements List Report (OData V4)

**INTRODUCTION**: Actionable guide for adding custom view tabs to a Fiori elements List Report (OData V4). Covers manifest configuration, fragment XML for UI, optional fragment handlers, controller extension registration, and implementing onViewNeedsRefresh / onPendingFilters to apply filterConditions from the filter bar.

**TAGS**: fiori-elements, list-report, custom-view, manifest, fragment, controller-extension, ODataV4, filterConditions

STEP: Prerequisites and restrictions
DESCRIPTION: Requirements and restrictions for custom views in a List Report.
LANGUAGE: text
CODE:
```text
- SAP Fiori elements for OData V4 only.
- To use custom views (custom tabs), you must have at least one annotation view defined.
- Custom view template names must include your sap.app.id as prefix, followed by path in webapp and view name.
  Example template name: "<sap.app.id>.ext.CustomViewTable"
```

STEP: Add custom view entries in manifest.json
DESCRIPTION: Declare custom tabs in the List Report component settings. Provide a unique key, a label (plain or i18n binding), and a template property referencing the fragment view name (prefixed by sap.app.id).
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (snippet inside your ListReport component configuration)
"BusinessPartnersList": {
    "type": "Component",
    "id": "BusinessPartnersList",
    "name": "sap.fe.templates.ListReport",
    "options": {
        "settings": {
            "contextPath": "/BusinessPartners",
            "views": {
                "paths": [
                    {
                        "key": "tab1",
                        "annotationPath": "com.sap.vocabularies.UI.v1.SelectionPresentationVariant#All"
                    },
                    {
                        "key": "tab2",
                        "label": "Custom View with Table",
                        "template": "BusinessPartners.ext.CustomViewTable"
                    },
                    {
                        "key": "tab3",
                        "label": "{i18n>LRCustomViewWithButton}",
                        "template": "BusinessPartners.ext.CustomViewWithButton"
                    }
                ],
                "showCounts": true
            }
        }
    }
}
```

STEP: Custom view properties (key, label, template)
DESCRIPTION: Use these properties per view entry in manifest:
- key: unique_tab_id (string)
- label: tab title (string or i18n binding)
- template: fully-qualified view name (must include sap.app.id prefix and match fragment location in webapp)
LANGUAGE: text
CODE:
```text
Properties:
- key: "<unique_tab_id>"
- label: "<tab_title>" or "{i18n>key}"
- template: "<sap.app.id>.<path>.<FragmentOrViewName>"

Naming convention:
If sap.app.id = "BusinessPartners", template "BusinessPartners.ext.CustomViewTable"
should map to file: webapp/ext/CustomViewTable.fragment.xml (or appropriate folder and file name)
```

STEP: Create a fragment with a sap.m.Table for the custom tab
DESCRIPTION: Add UI content in a fragment. Use core:FragmentDefinition. The fragment below binds items to /BusinessPartners and defines columns and cells. Save as an XML fragment file and reference it via template in manifest.
LANGUAGE: XML
CODE:
```xml
<!-- File: webapp/ext/CustomViewTable.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core" xmlns:u="sap.ui.unified">
    <Table id="customViewWithTable" items="{
        path: '/BusinessPartners',
        sorter: { path: 'Name' }
    }">
        <headerToolbar>
            <OverflowToolbar>
                <content>
                    <Title text="Business partners" level="H2" />
                    <ToolbarSpacer />
                </content>
            </OverflowToolbar>
        </headerToolbar>
        <infoToolbar>
            <OverflowToolbar>
                <Label text="List of business partners" />
            </OverflowToolbar>
        </infoToolbar>
        <columns>
            <Column width="15em">
                <Text text="Partner Name" />
            </Column>
            <Column minScreenWidth="Tablet" demandPopin="true">
                <Text text="Country" />
            </Column>
            <Column minScreenWidth="Desktop" demandPopin="true" hAlign="End">
                <Text text="Region" />
            </Column>
            <Column minScreenWidth="Desktop" demandPopin="true" hAlign="Center">
                <Text text="Segment" />
            </Column>
            <Column minScreenWidth="Desktop" demandPopin="true" hAlign="Center">
                <Text text="Sales Amount" />
            </Column>
            <Column minScreenWidth="Desktop" demandPopin="true" hAlign="Center">
                <Text text="Sales Amount (local currency)" />
            </Column>
        </columns>
        <items>
            <ColumnListItem type="Active">
                <cells>
                    <ObjectIdentifier text="{Name}" />
                    <Text text="{Country}" />
                    <Text text="{Region}" />
                    <Text text="{Segment}" />
                    <u:Currency value="{SalesAmount}" currency="{Currency}" />
                    <u:Currency value="{SalesAmountLocalCurrency}" currency="{LocalCurrency}" />
                </cells>
            </ColumnListItem>
        </items>
    </Table>
</core:FragmentDefinition>
```

STEP: Create a fragment with a Button and require a handler
DESCRIPTION: If you need a custom handler, use core:require in the fragment. The handler module path must match the required module (example: BusinessPartners/ext/CustomButton). Save fragment and handler accordingly.
LANGUAGE: XML
CODE:
```xml
<!-- File: webapp/ext/CustomViewWithButton.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
    <Panel
        headerText="Business Partners"
        class="sapUiResponsiveMargin"
        width="auto"
        core:require="{handler: 'BusinessPartners/ext/CustomButton'}"
    >
        <content>
            <Button text="IBN" id="customButton1" class="sapUiSmallMarginEnd" press="handler.onPress" />
        </content>
    </Panel>
</core:FragmentDefinition>
```

STEP: Implement the fragment handler (custom action module)
DESCRIPTION: Example module exposing handlers referenced by core:require. Save as a JS module and use standard AMD sap.ui.define. Import any required SAPUI5 modules (MessageBox shown as example).
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/ext/CustomButton.js (module "BusinessPartners/ext/CustomButton")
sap.ui.define(["sap/m/MessageBox"], function(MessageBox) {
    "use strict";
    return {
        someHandler: function(oEvent) {
            // Custom logic
        },
        onPress: function(oEvent) {
            // Example action: show message box
            MessageBox.show("You pressed the custom action");
        }
    };
});
```

STEP: Register a controller extension for the List Report in manifest.json
DESCRIPTION: Register your controller extension to extend the List Report controller (sap.fe.templates.ListReport.ListReportController). Use the controllerName pointing to your extension module.
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (snippet)
"sap.ui5": {
    "extends": {
        "extensions": {
            "sap.ui.controllerExtensions": {
                "sap.fe.templates.ListReport.ListReportController": {
                    "controllerName": "SalesOrder.ext.LRExtend"
                }
            }
        }
    }
}
```

STEP: Implement controller extension to handle filterConditions (onViewNeedsRefresh / onPendingFilters)
DESCRIPTION: Override onViewNeedsRefresh to apply filterConditions to your custom tab content when search is triggered or tab is selected. Override onPendingFilters to show a pending (grayed out) state while filters are not validated. Use base.getExtensionAPI().createFiltersFromFilterConditions to convert filter conditions into OData filters and $search. Adjust table ID to your runtime control ID (example shown).
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/ext/LRExtend.js (module "BusinessPartners.ext.LRExtend")
sap.ui.define(["sap/ui/core/mvc/ControllerExtension", "sap/ui/model/Filter"], function(ControllerExtension, Filter) {
    "use strict";
    return ControllerExtension.extend("BusinessPartners.ext.LRExtend", {
        override: {
            onViewNeedsRefresh: function(mParameters) {
                var oFilterInfo = mParameters.filterConditions;
                if (oFilterInfo) {
                    // Clone filter info to modify before creating filters
                    var duplicateFilterInfo = Object.assign({}, oFilterInfo);
                    // Example: remove Region filter if it contains "Bavaria"
                    if (
                        duplicateFilterInfo.Region &&
                        duplicateFilterInfo.Region.map(item => item.values).findIndex(i => i.includes("Bavaria")) !== -1
                    ) {
                        delete duplicateFilterInfo.Region;
                    }
                    // Find table by its generated ID in the List Report custom tab
                    var oTable = this.getView().byId("BusinessPartners::BusinessPartnersList--fe::CustomTab::tab2--customViewWithTable"),
                        oBinding = oTable.getBinding("items"),
                        oConvertedFilter = this.base.getExtensionAPI().createFiltersFromFilterConditions(duplicateFilterInfo);
                    // Remove overlay if previously shown
                    oTable.setShowOverlay(false);
                    // Create composite filter (AND of filters)
                    var oFilter = new Filter({ filters: oConvertedFilter.filters, and: true });
                    // Apply filter and $search
                    oBinding.filter(oFilter);
                    oBinding.changeParameters({ $search: oConvertedFilter.search });
                }
            },
            onPendingFilters: function() {
                // Show overlay to indicate pending filter changes
                var oTable = this.getView().byId("BusinessPartners::BusinessPartnersList--fe::CustomTab::tab2--customViewWithTable");
                if (oTable) {
                    oTable.setShowOverlay(true);
                }
            }
        }
    });
});
```

STEP: Notes on control IDs and runtime paths
DESCRIPTION: When obtaining controls inside the List Report view from your controller extension, use the runtime ID that combines component/view prefixes. The example ID:
BusinessPartners::BusinessPartnersList--fe::CustomTab::tab2--customViewWithTable
may vary in your application. Use the browser inspector or getView().byId(...) patterns to locate the correct ID.
LANGUAGE: text
CODE:
```text
- Verify runtime control IDs; adapt selectors in controller extension accordingly.
- Ensure template names and module paths match file locations under webapp (e.g., webapp/ext/CustomViewTable.fragment.xml -> template "BusinessPartners.ext.CustomViewTable").
- Always test filter behavior: onPendingFilters should gray the UI; onViewNeedsRefresh should apply filters and remove overlay.
```
--------------------------------

**TITLE**: SAP Fiori elements FAQs — Actionable Code Snippets for Projects and Annotations

**INTRODUCTION**: Quick, code-focused reference with actionable examples for common SAP Fiori elements FAQ items: how to declare required FE libraries in manifest.json, correct value-help text annotations (common pitfall), and examples to control visibility/enablement of UI elements via annotations. Use these snippets directly in your app manifest or annotation XML files.

**TAGS**: fiori-elements, annotations, manifest.json, sap.fe, value-help, UI.Hidden, OperationAvailable, ODataV4

**STEP**: 1 — Declare required SAP Fiori elements libraries in manifest.json for different app types

**DESCRIPTION**: Add the minimal set of SAP Fiori elements libraries to manifest.json to ensure correct runtime behavior and efficient loading. Use sap.fe.templates for standard floorplans (List Report, Object Page). For custom apps using flexible programming model/building blocks include sap.fe.core and sap.fe.macros.

**LANGUAGE**: JSON

**CODE**:
```JSON
// Example A: manifest.json for an app using a Fiori elements floorplan (List Report / Object Page)
{
  "sap.ui5": {
    "dependencies": {
      "libs": {
        "sap.fe.templates": {}
      }
    }
  }
}

// Example B: manifest.json for a custom app (flexible programming model / building blocks)
// Minimum: sap.fe.core. If you use building blocks, add sap.fe.macros.
{
  "sap.ui5": {
    "dependencies": {
      "libs": {
        "sap.fe.core": {},
        "sap.fe.macros": {}
      }
    }
  }
}
```

**STEP**: 2 — Value-help text annotation: common mistake and correct usage (XML annotations file)

**DESCRIPTION**: When configuring text for a property that uses a value help, ensure the Text annotation in the value help entity points to a property that contains descriptive text (not to the same key property). Below are the exact wrong vs correct examples (place in your annotations XML file, e.g., annotations.xml).

**LANGUAGE**: XML

**CODE**:
```XML
<!-- Wrong Sample Code -->
<Annotations Target="TestService.CategoryType/CatergoryId">
  <Annotation Term="Common.Text" Path="CategoryId"/>
</Annotations>

<!-- Correct Sample Code -->
<Annotations Target="TestService.CategoryType/CatergoryId">
  <Annotation Term="Common.Text" Path="CategoryDescription"/>
</Annotations>
```

**STEP**: 3 — Hide or disable UI elements using UI.Hidden and control standard action visibility

**DESCRIPTION**: Use the UI.Hidden annotation to hide controls and the CreateHidden/UpdateHidden/DeleteHidden annotations to hide standard CRUD buttons. Use OperationAvailable to control enablement of action buttons. Replace Target and Path placeholders with your entity and property names. Put these annotations in your annotation XML file.

**LANGUAGE**: XML

**CODE**:
```XML
<!-- Hide a specific property/control in the UI -->
<Annotations Target="YourService.YourEntity/YourProperty">
  <Annotation Term="UI.Hidden" Bool="true"/>
</Annotations>

<!-- Hide standard Create/Edit/Delete buttons for an entity (example targets at entity or entity set level) -->
<Annotations Target="YourService.YourEntityType">
  <!-- Hide Create button -->
  <Annotation Term="UI.CreateHidden" Bool="true"/>
  <!-- Hide Update/Edit -->
  <Annotation Term="UI.UpdateHidden" Bool="true"/>
  <!-- Hide Delete -->
  <Annotation Term="UI.DeleteHidden" Bool="true"/>
</Annotations>

<!-- Control enablement of a custom or standard action using OperationAvailable -->
<Annotations Target="YourService.YourEntityType/YourAction">
  <!-- OperationAvailable typically references a boolean property or expression evaluated in the backend -->
  <Annotation Term="Common.OperationAvailable">
    <Path>IsActionAllowed</Path>
  </Annotation>
</Annotations>

<!-- Example: OperationAvailable for a bound action at the entity set level -->
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="Common.OperationAvailable">
    <!-- Path points to a boolean property of the entity indicating availability -->
    <Path>CanExecuteAction</Path>
  </Annotation>
</Annotations>
```

**STEP**: 4 — Value-help validation triggers: summary of when validation is enforced

**DESCRIPTION**: Use these rules to decide when entered values are validated against the value help. Validation (against the value help) is enforced automatically when one of these conditions is true for the property:

- Property type is Edm.Guid
- The property is annotated with Common.IsUnit
- The property is annotated with Common.IsCurrency
- The property is annotated with Common.ValueHelpWithFixedValues
- The property is annotated with Common.ValueListForValidation

**LANGUAGE**: JSON

**CODE**:
```JSON
// Summary (not a config file): ensure one of these annotation cases is applied on the property
{
  "validationTriggers": [
    "Edm.Guid",
    "Common.IsUnit",
    "Common.IsCurrency",
    "Common.ValueHelpWithFixedValues",
    "Common.ValueListForValidation"
  ]
}
```

**STEP**: 5 — Quick reference: where to go next (topic mapping)

**DESCRIPTION**: Use these topics for deeper behavior/configuration when implementing the above snippets:
- Draft handling and edit scenarios: Draft Handling topic
- Side effects that refresh UI fields: Side Effects topic
- Keyboard shortcuts and Share menu behaviors: Keyboard Shortcuts / The Share Functionality
- Advanced navigation and semantic object mapping: Navigation from an App (Outbound Navigation)

**LANGUAGE**: JSON

**CODE**:
```JSON
// Map of referenced topics (use these identifiers/links in your project docs)
{
  "topics": {
    "DraftHandling": "draft-handling-ed9aa41.md",
    "SideEffects": "side-effects-18b17bd.md",
    "KeyboardShortcuts": "keyboard-shortcuts-0cd318c.md",
    "ShareFunctionality": "the-share-functionality-022bf0d.md",
    "NavigationOutbound": "navigation-from-an-app-outbound-navigation-d782acf.md"
  }
}
```
--------------------------------

**TITLE**: Feature Showcase Apps and Samples — SAP Fiori elements for OData V4 (CAP & RAP)

**INTRODUCTION**: Quick, actionable guide for developers to fetch, inspect, and run the SAP Fiori elements feature showcase repositories and sample apps (CAP and RAP SFLIGHT). Includes exact git URLs, minimal local run instructions for Node/CAP-based projects, and ABAP/RAP notes. Use this as a checklist for automated scripts or IDE-based workflows.

**TAGS**: fiori-elements-framework, SAP, OData V4, CAP, RAP, sflight, feature-showcase, samples, fiori, front-end

STEP: 1 — Clone Feature Showcase and Sample Repositories

DESCRIPTION: Clone all relevant repositories locally so you can inspect README files and run the samples. The following commands produce local copies of the feature showcase repos and the SFLIGHT sample apps.

LANGUAGE: Shell

CODE:
```bash
# Feature showcase repos
git clone https://github.com/SAP-samples/fiori-elements-feature-showcase.git
git clone https://github.com/SAP-samples/abap-platform-fiori-feature-showcase.git

# SFLIGHT sample apps
git clone https://github.com/SAP-samples/cap-sflight.git
git clone https://github.com/SAP-samples/abap-platform-refscen-flight.git
```

STEP: 2 — Inspect README and prerequisites (required before running)

DESCRIPTION: Open each repository README to learn specific prerequisites and environment setup. Common prerequisites for CAP-based samples: Node.js (LTS), @sap/cds, and an npm client. Common prerequisites for RAP/ABAP samples: an ABAP development environment or SAP BTP ABAP environment.

LANGUAGE: Shell

CODE:
```bash
# Example: open the README for each cloned repo (macOS/Linux)
less fiori-elements-feature-showcase/README.md
less abap-platform-fiori-feature-showcase/README.md
less cap-sflight/README.md
less abap-platform-refscen-flight/README.md
```

STEP: 3 — Run CAP-based feature showcase or CAP SFLIGHT locally (Node + CDS)

DESCRIPTION: Typical CAP-based flow: install dependencies, run the backend with cds, and start any front-end UI5 app if provided. Always follow the repository README for exact commands, but common commands are shown here.

LANGUAGE: Shell

CODE:
```bash
# Example: enter the CAP project (replace path with actual repo folder)
cd fiori-elements-feature-showcase   # or cap-sflight

# Install node dependencies (npm or yarn/pnpm depending on repo)
npm install

# If the repo uses SAP CDS and exposes a local OData V4 service:
# Start the CAP server (hot-reload)
npx cds watch

# If there's a UI5/Fiori front-end, open the UI entry folder and start the UI:
# cd app/webapp (or path specified in README)
# npm install
# npm start  # or follow the repo-specific command to run the UI server
```

STEP: 4 — Notes for RAP / ABAP feature showcase and RAP SFLIGHT

DESCRIPTION: RAP (ABAP RESTful Application Programming) based repositories require an ABAP system or SAP BTP ABAP environment. You cannot run these purely locally like Node/CAP apps. Follow the repo README for transport, Git branch mapping, and deployment steps to an ABAP backend. Use abapGit or CTS as described in the repository.

LANGUAGE: Shell / Plain Text

CODE:
```text
# Example next steps (read the repo README for ABAP deployment instructions)
# - Open abap-platform-fiori-feature-showcase/README.md for RAP deployment steps.
# - abap-platform-refscen-flight is an ABAP reference scenario; follow the README for 
#   system prerequisites (ABAP Platform version), transport setup, and sample data load.
# - Typical actions: upload to ABAP system via abapGit, activate business config, and 
#   register OData services in the ABAP gateway / SAP Fiori launchpad configuration.
```

STEP: 5 — Explore live examples in SAP Fiori Development Portal

DESCRIPTION: Use the SAP Fiori development portal to view live examples and documentation for Fiori elements. This is useful for testing and comparison without local setup.

LANGUAGE: URL

CODE:
```text
# Open the portal in a browser:
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/topic/introduction/portal
```

STEP: 6 — Automating checks or CI validation (suggested commands)

DESCRIPTION: Minimal scripts for CI to verify repository health: linting, dependency installation, and attempt to start CAP server (non-blocking). Useful for automated validation pipelines before attempting ABAP deployments.

LANGUAGE: Shell

CODE:
```bash
# Example CI snippet (adapt per repo)
cd cap-sflight
npm ci
npm run lint || true    # non-fatal in CI
npx cds build           # build cds artifacts
# Optionally run smoke-server in background (only for Node-cap projects)
npx cds run &           # run server for quick smoke tests (ensure proper test teardown in CI)
```

STEP: 7 — Where to look for implementation examples in the repos

DESCRIPTION: Search the cloned repositories for concrete implementation samples: CDS models, annotations, manifest.json, and front-end Fiori elements XML views. These are the files an AI/code generator should inspect and reuse when generating or modifying code.

LANGUAGE: Shell

CODE:
```bash
# Useful file searches for code generation contexts
# - CDS OData model files
find . -type f -name "*.cds"

# - Annotations and metadata for Fiori elements (annotations.xml / annotations.cds)
find . -type f -iname "*annotation*"

# - UI5/Fiori front-end descriptors
find . -type f -name "manifest.json"
find . -type f -name "*.xml" -path "*/webapp/*"

# - Look for README / docs for routes and service endpoints
grep -R "OData" -n README.md || true
```

Step: 8 — References (repository URLs to include in generated code or docs)

DESCRIPTION: Preserve exact source URLs for linking back to the authoritative examples and READMEs.

LANGUAGE: Plain Text

CODE:
```text
Feature showcase (CAP):  https://github.com/SAP-samples/fiori-elements-feature-showcase#readme
Feature showcase (RAP):  https://github.com/SAP-samples/abap-platform-fiori-feature-showcase#readme
CAP SFLIGHT sample:      https://github.com/SAP-samples/cap-sflight#readme
RAP SFLIGHT sample:      https://github.com/SAP-samples/abap-platform-refscen-flight
SAP Fiori dev portal:    https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/topic/introduction/portal
```
--------------------------------

**TITLE**: Field Help for SAP Fiori elements (OData V4) — Code Samples and Configuration

**INTRODUCTION**: Practical, code-focused reference for enabling and configuring field help in SAP Fiori elements (OData V4). Includes value help, dropdowns, date and datetime pickers, timezone annotations, history of recently entered values, and type-ahead settings. Use these snippets directly in metadata (XML), CAP CDS, or ABAP CDS as applicable.

**TAGS**: fiori-elements, field-help, value-help, dropdown, date-picker, datetime, timezone, CAP, ABAP-CDS, XML, annotations, type-ahead, history

**STEP**: 1 — Value Help (overview)
**DESCRIPTION**: Enable value help for a field so users can (a) open a value help dialog to select a value from a related entity, or (b) define a condition to retrieve a suitable value. Ensure backend OData metadata exposes the navigation/value help entity and that the UI metadata references it. Use this step as the conceptual reference prior to wiring specific annotations.
**LANGUAGE**: N/A
**CODE**:
```text
Concept:
- Value Help lets users pick values from a value help entity or define conditions.
- Requires OData V4 metadata linking the property to a value help entity.
- Type-ahead suggestions use $search on the backend.
See: value-help-fccb255.md for dialog configuration and mapping.
```

**STEP**: 2 — Dropdown-Based Fields (fixed values)
**DESCRIPTION**: Use a dropdown list for fields with a fixed set of values. Represent fixed-value lists in metadata (e.g., enum or value list) so the Fiori elements runtime renders a dropdown.
**LANGUAGE**: N/A
**CODE**:
```text
Concept:
- Dropdowns must be used for fields with fixed values.
- Configure the value help as a dropdown in the value help metadata (see value-help-as-a-dropdown-list-2a0a630.md).
```

**STEP**: 3 — Date Picker (Edm.Date) — XML annotation sample
**DESCRIPTION**: Define an Edm.Date property to render a date picker outside filter context. Within filter bars, behavior depends on filter restrictions.
**LANGUAGE**: XML
**CODE**:
```xml
<EntityType Name="SalesOrderManage">
   <Property Name="SalesOrderDate" Type="Edm.Date"/>
</EntityType>
```

**STEP**: 4 — Date Picker (CAP CDS) — CAP CDS sample
**DESCRIPTION**: CAP CDS declaration for a date property. Use when developing with SAP CAP; the generated metadata will include Edm.Date.
**LANGUAGE**: CDS
**CODE**:
```sd
entity SalesOrderManage {
     SalesOrderDate : Date;
}
```

**STEP**: 5 — Date/Time Picker (Edm.DateTimeOffset) — XML annotation sample
**DESCRIPTION**: Define an Edm.DateTimeOffset property to render a date/time picker outside a filter context. In filter context, the field help depends on filter restrictions and may be a date/time picker, value help, or dynamic semantic date options.
**LANGUAGE**: XML
**CODE**:
```xml
<EntityType Name="SalesOrderManage">
    <Property Name="LastChangedDateTime" Type="Edm.DateTimeOffset"/>
</EntityType>
```

**STEP**: 6 — Date/Time Picker (CAP CDS) — CAP CDS sample
**DESCRIPTION**: CAP CDS declaration for a DateTime property that maps to Edm.DateTimeOffset in metadata. Use in CAP CDS models to generate correct metadata for Fiori elements.
**LANGUAGE**: CDS
**CODE**:
```sd
entity SalesOrderManage {
       SalesOrderDate : DateTime;
}
```

**STEP**: 7 — DateTimeOffset Display / Timezone Behavior (concept)
**DESCRIPTION**: When an end user selects date/time via picker, the DateTimeOffset field is converted and displayed in the UI timezone determined by SAPUI5. If no timezone is specified, UI shows values converted to the UI's timezone (may be default). To display and persist timezone information, annotate the field with Common.Timezone.
**LANGUAGE**: N/A
**CODE**:
```text
Notes:
- DateTimeOffset values are rendered in the UI timezone (SAPUI5 conversion).
- To show a timezone in edit and display modes, annotate with @Common.Timezone.
- Images in original doc: images/Input_Field_Without_a_Timezone_Dialog_b07bbe3.png,
  images/Input_Field_with_No_Timezone_or_the_Default_Timezone_a2f5fc8.png,
  images/Input_Field_with_Specified_Timezone_b3b7f08.png
```

**STEP**: 8 — Timezone: Fixed Timezone (XML annotation sample)
**DESCRIPTION**: Set a fixed timezone for a DateTimeOffset property using @Common.Timezone = "IANA-name". This displays the timezone in UI edit and display modes.
**LANGUAGE**: XML
**CODE**:
```xml
<EntityType Name="SalesOrderManage">
    ...
    <Property Name="testTimeFixed" Type="Edm.DateTimeOffset"/>
    ...
</EntityType>

<Annotations Target="com.c_salesordermanage_sd.SalesOrderManagerManage/testTimeFixed">
    <Annotation Term="Common.Timezone" String="Asia/Riyadh"/>
    <Annotation Term="Common.Label" String="Timestamp with fixed timezone"/>
</Annotations>
```

**STEP**: 9 — Timezone: Fixed Timezone (CAP CDS sample)
**DESCRIPTION**: CAP CDS syntax to set a fixed timezone on a DateTime property using @Common.Timezone in the CDS model.
**LANGUAGE**: CDS
**CODE**:
```sd
entity SalesOrderManage {
  ...
  testTimeFixed : DateTime @Common : { Timezone : 'Asia/Riyadh' };
  ...
}
```

**STEP**: 10 — Timezone: Timezone Based on Another Property — XML annotation sample
**DESCRIPTION**: Use Path-based Common.Timezone annotation to have the timezone value taken from another property in the entity. Annotate both the datetime property and the timezone property label.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/testTime">
   <Annotation Term="Common.Timezone" Path="testTimezone"/>
   <Annotation Term="Common.Label" String="Datetime Stamp with Timezone based on Property"/>
</Annotations>

<Annotations Target="com.c_salesordermanage_sd.SalesOrderManager/testTimezone">
   <Annotation Term="Common.Label" String="Timezone Property"/>
</Annotations>
```

**STEP**: 11 — Timezone: Timezone Based on Another Property — ABAP CDS sample
**DESCRIPTION**: ABAP CDS semantics to declare a timezone reference property and the timezone property itself. Use @Semantics.timeZoneReference and @Semantics.timeZone.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@Semantics.timeZoneReference: 'MySAPTimezone'
MyDateTime,

@Semantics.timeZone
MySAPTimezone,
```

**STEP**: 12 — Timezone: Timezone Based on Another Property — CAP CDS sample
**DESCRIPTION**: CAP CDS sample showing property-based timezone binding via @Common.Timezone referencing another property name.
**LANGUAGE**: CDS
**CODE**:
```sd
entity SalesOrderManage {
    testTime : DateTime @Common : { Timezone : testTimezone };
    testTimezone : String; // the timezone value (IANA string) or code depending on implementation
}
```

**STEP**: 13 — History of Recently Entered Values (enable)
**DESCRIPTION**: Enable local history of entered values for input fields so that on focus, recent values are shown and filtered while typing. This feature is disabled for value helps that are based on fixed values.
Action: Set SAP Fiori launchpad parameter INPUTFIELD_HISTORY to enable the feature.
**LANGUAGE**: JSON / FLP config
**CODE**:
```json
// Example FLP parameter setting (implementation depends on FLP configuration tooling)
{
  "params": {
    "INPUTFIELD_HISTORY": {
      "value": true
    }
  }
}
```

**STEP**: 14 — Type-Ahead Support (backend and annotation control)
**DESCRIPTION**: Type-ahead suggestions for fields with value help are fetched from the backend using $search. Control which columns appear in type-ahead results by annotating columns with UI.Importance = #High. If UI.Importance is not defined, type-ahead uses the same columns as the value help dialog. Type-ahead is unavailable if the value help entity is configured as non-searchable.
**LANGUAGE**: XML / Annotation example
**CODE**:
```xml
<!-- Example: annotate properties for importance (XML annotations target syntax) -->
<Annotations Target="MyService.MyEntity/MyProperty">
  <!-- other annotations -->
</Annotations>

<Annotations Target="MyService.MyValueHelpEntity/ColumnA">
  <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
</Annotations>
<Annotations Target="MyService.MyValueHelpEntity/ColumnB">
  <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Low"/>
</Annotations>

Notes:
- Backend must support $search for type-ahead suggestions.
- If value help entity is non-searchable, type-ahead is disabled. See "Enabling the Search Function".
```

**STEP**: 15 — Implementation Checklist (practical actions)
**DESCRIPTION**: Quick checklist for implementing field help in a Fiori elements OData V4 app.
**LANGUAGE**: N/A
**CODE**:
```text
Checklist:
1. Ensure OData V4 metadata defines properties as Edm.Date or Edm.DateTimeOffset where appropriate.
2. For CAP: use Date and DateTime types in CDS to generate correct metadata.
3. Add Common.Timezone annotation (fixed string or Path to property) for timezone display.
4. Configure value help entities and navigation in service metadata for value help dialogs.
5. For fixed-value lists, model a value list to render a dropdown.
6. Enable INPUTFIELD_HISTORY in FLP to allow recently entered values (not supported for fixed-value-based value help).
7. Annotate value help columns with UI.Importance = High to control type-ahead display.
8. Ensure backend search ($search) is enabled on the value help entity for type-ahead suggestions.
```
--------------------------------

**TITLE**: Finding the Right Anchor Key for Custom Elements in SAP Fiori Elements (OData V4)

**INTRODUCTION**: Quick, code-focused reference to locate DOM and metadata anchor keys for placing custom elements (header facets, header fields, table columns, sections/subsections) in SAP Fiori elements apps. Use browser DevTools and $metadata to determine the exact `position.anchor` values.

**TAGS**: fiori-elements-framework, OData V4, anchors, devtools, header-facet, table-column, manifest.json, object-page

**STEP**: 1 — Open Browser Developer Tools

**DESCRIPTION**: Open DevTools to inspect DOM and Network responses (use $metadata filter to find metadata). Shortcuts shown for common OS.

**LANGUAGE**: Text

**CODE**:
```text
Windows:    CTRL + SHIFT + I
macOS:      CMD + OPT + I

In DevTools:
- Elements panel: inspect DOM node strings.
- Network panel: filter by "$metadata" to open service metadata XML.
```

**STEP**: 2 — Find Anchor Key for a Header Facet

**DESCRIPTION**: Search the DOM (Elements inspector) for the token `fe::HeaderFacetContainer` (standard facet) or `fe::HeaderFacetCustomContainer` (custom facet). The text/ID segment immediately after this token is the facet key to use for `position.anchor`.

**LANGUAGE**: Text

**CODE**:
```text
Search tokens:
- fe::HeaderFacetContainer
- fe::HeaderFacetCustomContainer

DOM example:
AppName::AppNameObjectPage--fe::HeaderFacetContainer::AnchorHeaderFacetName

Anchor to use:
position.anchor = "AnchorHeaderFacetName"
```

**STEP**: 3 — Find Anchor Key for a Header Facet Field

**DESCRIPTION**: To place a custom header field inside a header facet, search the DOM for `fe::HeaderFacet::Form`. Field element IDs follow the pattern `<Type>::<PropertyName>`. Use `DataFieldAbstractType::PropertyName` as `position.anchor`. Most common: `DataField::PropertyName`.

**LANGUAGE**: Text

**CODE**:
```text
Search token:
- fe::HeaderFacet::Form

DOM example:
AppName::AppNameObjectPage--fe::HeaderFacet::Form::HeaderFacetName::DataField::PropertyName::Field

Anchor to use:
position.anchor = "DataField::PropertyName"
Notes:
- Key = <RecordType>::<PropertyName>
- Common case: DataField::PropertyName
```

**STEP**: 4 — Find Anchor Key for a Table Column (DOM & Metadata)

**DESCRIPTION**: Two-part process:
1) Find the column's DOM ID prefix to get the column name.
2) Inspect $metadata UI.LineItem annotation to determine the record type (DataField / DataFieldForAction / DataFieldForAnnotation / etc.). Combine record type and column/property name to form `DataFieldAbstractType::ColumnName` for `position.anchor`.

**LANGUAGE**: Text + XML

**CODE**:
```text
Part 1: DOM search
Search token (replace AppName):
fe::table::AppName::LineItem::C::

DOM examples:
fe::table::AppName::LineItem::C::PersonName
fe::table::AppName::LineItem::C::FieldGroup::multipleFields

Extracted column names:
- PersonName
- FieldGroup::multipleFields   (multi-segment when annotation target uses FieldGroup#id)

Part 2: $metadata -> UI.LineItem
Open Network panel, filter by "$metadata", open XML response, search for:
<Annotation Term="UI.LineItem"> ... </Annotation>

Sample UI.LineItem snippet:
```xml
<Annotation Term="UI.LineItem">
    <Collection>
        <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="PersonName"/>
        </Record>
        <Record Type="UI.DataFieldForAction">
            <PropertyValue Property="Action" String="ChangePresence"/>
        </Record>
        <Record Type="UI.DataFieldForAnnotation">
            <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#multipleFields"/>
        </Record>
        ...
    </Collection>
</Annotation>
```

Form final anchor keys by combining record Type and ColumnName:
- DataField::PersonName
- DataFieldForAction::ChangePresence
- DataFieldForAnnotation::FieldGroup::multipleFields
```

**STEP**: 5 — Use a Custom Column Key from manifest.json

**DESCRIPTION**: If the column is custom and you declared a custom column key in the `columns` collection of your manifest.json, use that exact key as the anchor.

**LANGUAGE**: JSON

**CODE**:
```json
// manifest.json (excerpt) - example of using a custom column key
{
  "sap.ui5": {
    "models": { /* ... */ }
  },
  "sap.app": { /* ... */ },
  "fiori": { /* ... */ },
  "settings": {
    "columns": [
      {
        "key": "MyCustomColumnKey",
        "label": "My Column"
      }
    ]
  }
}

// Use in extension position:
{
  "position": {
    "anchor": "MyCustomColumnKey"
  }
}
```

**STEP**: 6 — Find Anchor Key for a Section or Subsection

**DESCRIPTION**: Search the DOM for `fe::FacetSection` (section) or `fe::FacetSubSection` (subsection). The fragment after the token is the facet key; use it as `position.anchor`.

**LANGUAGE**: Text

**CODE**:
```text
Search tokens:
- fe::FacetSection
- fe::FacetSubSection

DOM example:
AppName::AppNameObjectPage--fe::FacetSection::AnchorSectionFacetName

Anchor to use:
position.anchor = "AnchorSectionFacetName"
```

**STEP**: 7 — Quick Reference Patterns

**DESCRIPTION**: Summary of anchor key patterns to use directly in `position.anchor`.

**LANGUAGE**: Text

**CODE**:
```text
Header facet:
- fe::HeaderFacetContainer::AnchorName  =>  position.anchor = "AnchorName"

Header facet field:
- ...::DataField::PropertyName::Field  =>  position.anchor = "DataField::PropertyName"

Table column:
- fe::table::AppName::LineItem::C::ColumnName
  + Use metadata record type:
    Record Type "UI.DataField"                => DataField::ColumnName
    Record Type "UI.DataFieldForAction"       => DataFieldForAction::ActionName
    Record Type "UI.DataFieldForAnnotation"   => DataFieldForAnnotation::AnnotationTarget::id

Section/Subsection:
- fe::FacetSection::AnchorName  =>  position.anchor = "AnchorName"
- fe::FacetSubSection::AnchorName  =>  position.anchor = "AnchorName"

Notes:
- Applicable only for SAP Fiori elements using OData V4.
- Always verify DOM token and metadata record type before composing the final anchor.
```
--------------------------------

**TITLE**: Flexible Programming Model — actionable extension patterns for SAP Fiori elements (OData V4)

**INTRODUCTION**: Short, concrete examples showing how to extend SAP Fiori elements (OData V4) applications using the flexible programming model: controller extensions, view (fragment) injection via viewExtensions, and adding a custom page. Use these snippets as copy/paste-ready templates. Keep file paths and manifest keys exact so code-generation agents can create/modify files automatically.

**TAGS**: fiori-elements, sapui5, odata-v4, extensions, controller-extensions, view-extensions, fragments, custom-page, manifest.json

STEP: Project layout (recommended)
DESCRIPTION: Create a minimal folder layout and placement for the examples below. Use these exact paths when generating files.
LANGUAGE: text
CODE:
```text
webapp/
  ├─ manifest.json
  ├─ extension/
  │   ├─ ObjectPageExtension.controller.js
  │   ├─ fragments/
  │   │   └─ CustomInfo.fragment.xml
  │   ├─ CustomPage.view.xml
  │   └─ CustomPage.controller.js
  └─ i18n/
```

STEP: Add a controller extension (map your controller to a Fiori elements template controller)
DESCRIPTION: Map a custom controller to a template controller so your JS runs in the lifecycle of the template. This pattern is used to add handlers, lifecycle logic, or call the extensionAPI. Add the mapping under sap.ui5.controllerExtensions in manifest.json and create the controller module under webapp/extension/.
LANGUAGE: JSON
CODE:
```json
// webapp/manifest.json (snippet)
{
  "sap.ui5": {
    "controllerExtensions": {
      "sap.fe.templates.ObjectPage.ObjectPageController": {
        "controllerName": "my.app.extension.ObjectPageExtension"
      }
    }
  }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// webapp/extension/ObjectPageExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("my.app.extension.ObjectPageExtension", {
    onInit: function () {
      // Example: log and access the extension API if available
      // In Fiori elements, template controller exposes extensionAPI via this.extensionAPI
      // Use safe guards when generating calling code
      if (this.extensionAPI) {
        console.log("ObjectPage extension initialized, extensionAPI available");
      } else {
        console.log("ObjectPage extension initialized");
      }
    },

    // Example custom action handler exposed to view (if you add a button in viewExtensions)
    onMyCustomAction: function (oEvent) {
      console.log("Custom action clicked", oEvent);
      // Use extensionAPI for navigation, messaging, or other supported operations:
      if (this.extensionAPI && this.extensionAPI.navigate) {
        // safe-check API methods before calling
        // this.extensionAPI.navigate("SomeRoute", { /* params */ });
      }
    }
  });
});
```

STEP: Inject an XML fragment into a template view using viewExtensions
DESCRIPTION: Use sap.ui.viewExtensions in the manifest to inject a fragment into a specific aggregation of a Fiori elements template view. The target key ("sap.fe.templates.ObjectPage.view.Details") and aggregation name ("BeforeMainContent") are examples; choose the correct template view and aggregation for your template/page type. Provide the fragment in webapp/extension/fragments/CustomInfo.fragment.xml.
LANGUAGE: JSON
CODE:
```json
// webapp/manifest.json (snippet to inject a fragment)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.fe.templates.ObjectPage.view.Details": {
            "BeforeMainContent": {
              "className": "sap.ui.core.mvc.Fragment",
              "fragmentName": "my.app.extension.fragments.CustomInfo"
            }
          }
        }
      }
    }
  }
}
```

LANGUAGE: XML
CODE:
```xml
<!-- webapp/extension/fragments/CustomInfo.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m"
                         xmlns:core="sap.ui.core"
                         xmlns:layout="sap.ui.layout">
  <VBox class="sapUiSmallMargin">
    <Text text="This is an injected fragment (CustomInfo)" />
    <Button text="Custom Action" press=".onMyCustomAction" />
  </VBox>
</core:FragmentDefinition>
```

STEP: Add a custom page (treated as a fully custom page by the FE framework)
DESCRIPTION: Add a route target/ view target entry in the manifest routing config that points to an XML view under webapp/extension/CustomPage.view.xml. This makes the route render a view you fully control. Use a simple XML view and controller as a starting point.
LANGUAGE: JSON
CODE:
```json
// webapp/manifest.json (routing snippet)
{
  "sap.ui5": {
    "routing": {
      "config": {
        "routerClass": "sap.m.routing.Router",
        "viewType": "XML",
        "viewPath": "my.app.extension",
        "controlId": "app",
        "controlAggregation": "pages"
      },
      "routes": [
        {
          "name": "CustomPageRoute",
          "pattern": "CustomPage",
          "target": "CustomPage"
        }
      ],
      "targets": {
        "CustomPage": {
          "viewName": "CustomPage",
          "viewLevel": 1
        }
      }
    }
  }
}
```

LANGUAGE: XML
CODE:
```xml
<!-- webapp/extension/CustomPage.view.xml -->
<mvc:View controllerName="my.app.extension.CustomPage"
          xmlns:mvc="sap.ui.core.mvc"
          xmlns="sap.m">
  <Page title="Custom Page (Fiori elements)">
    <content>
      <VBox class="sapUiSmallMargin">
        <Text text="This page is a custom page (full freedom to use SAPUI5 controls)" />
        <Button text="Custom Page Action" press=".onCustomPageAction" />
      </VBox>
    </content>
  </Page>
</mvc:View>
```

LANGUAGE: JavaScript
CODE:
```javascript
// webapp/extension/CustomPage.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("my.app.extension.CustomPage", {
    onInit: function () {
      console.log("CustomPage controller initialized");
    },

    onCustomPageAction: function () {
      sap.m.MessageToast.show("Custom page action executed");
    }
  });
});
```

STEP: References and related building block usage
DESCRIPTION: Use SAP Fiori building blocks when you want pre-built composable UI macros. For additional examples, consult the Fiori development portal and the building blocks documentation. Use the building blocks macros (for example sap.fe.macros) in XML views when appropriate.
LANGUAGE: text
CODE:
```text
Reference:
- Live examples and introduction: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/topic/introduction
- Related doc: Building Blocks (see building-blocks-24c1304.md)
```

STEP: Practical tips for code generators and CI automation
DESCRIPTION: Ensure generated controllers use safe guards when calling extensionAPI or template-specific functions. Place all custom files under webapp/extension/ to limit collisions with generated artifacts. Update manifest.json only within explicit keys: sap.ui5.controllerExtensions, sap.ui.viewExtensions, and sap.ui5.routing.targets/routes to keep merges predictable.
LANGUAGE: text
CODE:
```text
Best practices:
- Place all custom modules under webapp/extension/.
- Use manifest keys:
  - sap.ui5.controllerExtensions
  - sap.ui5.extends.extensions.sap.ui.viewExtensions
  - sap.ui5.routing.targets and sap.ui5.routing.routes
- Always null-check extensionAPI or template-specific global objects before use.
- For fragment injection use className: "sap.ui.core.mvc.Fragment" and fragmentName full module path.
```
--------------------------------

**TITLE**: Form Entry Object Page — Setup, Create-on-Start, and singleDraftForCreate Options

**INTRODUCTION**: This guide shows how to configure a Form Entry Object Page (Object Page variation without header/navigation) for SAP Fiori elements OData V4. It includes: manifest target settings for the page, starting the app in creation mode, enabling single-draft-for-create globally via manifest, and invoking singleDraftForCreate via an EditFlow extension. Use these code snippets directly in your project files.

**TAGS**: fiori-elements-framework, ODataV4, manifest.json, Component.js, editFlow, singleDraftForCreate, object-page, routing, extension

STEP: 1 — Add Form Entry Object Page target in manifest (routing.targets)

DESCRIPTION: Add a routing target that uses the Object Page template and disables header and anchor bar visibility. Place this under sap.ui5.routing.targets in your manifest.json.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "FormRootObjectPage": {
          "type": "Component",
          "id": "FormRootObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "contextPath": "/FormRoot",
              "editableHeaderContent": false,
              "content": {
                "header": {
                  "visible": false,
                  "anchorBarVisible": false
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 2 — Start application in creation mode (Component.js)

DESCRIPTION: Make the application start in creation mode by returning preferredMode: ["create"] from getStartupParameters in your App Component (Component.js). This causes the app to open the page in create mode automatically.

LANGUAGE: JavaScript

CODE:
```javascript
// webapp/Component.js
sap.ui.define(["sap/fe/core/AppComponent"], function(AppComponent) {
  "use strict";

  return AppComponent.extend("FormTemplate.Component", {
    metadata: {
      manifest: "json"
    },

    getStartupParameters: function() {
      // Return startup parameters to prefer create mode at app start
      return Promise.resolve({
        preferredMode: ["create"]
      });
    }
  });
});
```

STEP: 3 — Enable singleDraftForCreate globally in manifest

DESCRIPTION: Enable the singleDraftForCreate behavior globally so the application allows creating a new entity only if no unsaved draft exists. Add this property under sap.fe.app in manifest.json.

LANGUAGE: JSON

CODE:
```json
{
  "sap.fe": {
    "app": {
      "singleDraftForCreate": true
    }
  }
}
```

STEP: 4 — Use EditFlow.createDocument with singleDraftForCreate in an extension

DESCRIPTION: If you need to trigger create behavior programmatically from an extension and enforce single-draft-for-create, call editFlow.createDocument(ListBinding, { singleDraftForCreate: true }). The example shows a minimal extension controller method that retrieves a list binding and invokes createDocument with the option.

LANGUAGE: JavaScript

CODE:
```javascript
// Example extension controller method (e.g. webapp/extension/Controller.extension.js)
createDocumentUsingEditFlow: function() {
  // Get the list control and its binding (adjust the control id to your UI)
  var oList = this.byId("myList"); // replace "myList" with the control id in your view
  if (!oList) {
    return Promise.reject(new Error("List control not found"));
  }
  var oListBinding = oList.getBinding("items");
  if (!oListBinding) {
    return Promise.reject(new Error("List binding not found"));
  }

  // Obtain the editFlow instance from the component (API access may vary in your setup)
  var oOwnerComponent = this.getOwnerComponent && this.getOwnerComponent();
  var oEditFlow = oOwnerComponent && oOwnerComponent.getEditFlow && oOwnerComponent.getEditFlow();

  if (!oEditFlow) {
    return Promise.reject(new Error("editFlow is not available on the component"));
  }

  // Call createDocument with the singleDraftForCreate option
  return oEditFlow.createDocument(oListBinding, { singleDraftForCreate: true })
    .then(function(oCreatedContext) {
      // The editFlow will open the newly created entity in edit mode
      return oCreatedContext;
    })
    .catch(function(err) {
      // handle error
      throw err;
    });
}
```
--------------------------------

**TITLE**: Form Facet for Object Page Header (Field Group)

**INTRODUCTION**: Add a form-like facet to the Fiori Elements object page header by adding a UI.ReferenceFacet to UI.HeaderFacets that points to a UI.FieldGroup or UI.Identification annotation. The optional Label on UI.ReferenceFacet becomes the form title. This document provides ready-to-use XML, ABAP CDS, and CAP CDS annotation examples to implement a "Sales Area" header section containing Sales Organization, Distribution Channel, and Division fields.

**TAGS**: fiori-elements-framework, UI.ReferenceFacet, UI.FieldGroup, UI.HeaderFacets, annotations, XML, CDS, ABAP, CAP

STEP: 1 — XML: Add ReferenceFacet to UI.HeaderFacets and Define FieldGroup
DESCRIPTION: Add a UI.ReferenceFacet entry in the UI.HeaderFacets collection that targets a UI.FieldGroup qualifier (OrgData). Define the UI.FieldGroup with Data containing UI.DataField entries. Use AnnotationPath "@UI.FieldGroup#OrgData" in Target. Use UI.Importance and UI.Hidden where needed.
LANGUAGE: XML
CODE:
```xml
<!-- Add this to your annotations XML file -->
<Annotation Term="UI.HeaderFacets">
    <Collection>
        <!-- Reference facet in the header that points to the FieldGroup qualifier OrgData -->
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Sales Area" />
            <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#OrgData" />
        </Record>
        <!-- other facets ... -->
    </Collection>
</Annotation>

<!-- Define the FieldGroup with qualifier OrgData -->
<Annotation Term="UI.FieldGroup" Qualifier="OrgData">
    <Record Type="UI.FieldGroupType">
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SalesOrganization"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="DistributionChannel"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                    <!-- Example of hiding based on another property -->
                    <Annotation Term="UI.Hidden" Path="Delivered"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="OrganizationDivision"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 2 — ABAP CDS: Define Header Facet and FieldGroup Annotations
DESCRIPTION: Use ABAP CDS annotations on the entity/view to create a header reference facet that targets a field group qualifier (OrgData). Annotate each field with @UI.fieldGroup including importance, position, hidden, and qualifier.
LANGUAGE: ABAP
CODE:
```abap
@UI.Facet: [
  {
    label: '{@i18n>@SalesArea}',
    targetQualifier: 'OrgData',
    type: #FIELDGROUP_REFERENCE,
    purpose: #HEADER
  }
  /* , ... other facets ... */
]
entity Product {  "or your CDS entity/view name"
  key productId   : abap.char(10);
  ...
}

@UI.fieldGroup: [
  {
    importance: #HIGH,
    position: 10,
    qualifier: 'OrgData'
  }
]
SALESORGANIZATION;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    hidden: true,
    position: 20,
    qualifier: 'OrgData'
  }
]
DISTRIBUTIONCHANNEL;

@UI.fieldGroup: [
  {
    importance: #HIGH,
    position: 30,
    qualifier: 'OrgData'
  }
]
ORGANIZATIONDIVISION;
```

STEP: 3 — CAP CDS: Annotate Service with UI.HeaderFacets and UI.FieldGroup
DESCRIPTION: In CAP (Core Data Services) annotate the service or entity using the UI vocabulary. Use a UI.ReferenceFacet in UI.HeaderFacets pointing to @UI.FieldGroup#OrgData and define UI.FieldGroup #OrgData with UI.DataField entries. Use annotation syntax for importance and hidden.
LANGUAGE: CDS
CODE:
```cds
annotate service.Products with @(
  UI.HeaderFacets : [
    {
        $Type : 'UI.ReferenceFacet',
        Label : '{@i18n>@SalesArea}',
        Target : '@UI.FieldGroup#OrgData'
    }
    /* , ... other facets ... */
  ],
  UI.FieldGroup #OrgData : {
    $Type : 'UI.FieldGroupType',
    Data : [
        {
            $Type : 'UI.DataField',
            Value : SalesOrganization,
            ![@UI.Importance] : #High
        },
        {
            $Type : 'UI.DataField',
            Value : DistributionChannel,
            ![@UI.Importance] : #High,
            ![@UI.Hidden] : Delivered
        },
        {
            $Type : 'UI.DataField',
            Value : OrganizationDivision,
            ![@UI.Importance] : #High
        }
    ]
  }
);
```

STEP: 4 — Notes and Best Practices
DESCRIPTION: Implementation tips to ensure correct behavior:
- The ReferenceFacet Target must match the FieldGroup qualifier (e.g., "@UI.FieldGroup#OrgData").
- Label on ReferenceFacet becomes the facet title in the header.
- Use UI.Importance (High/Medium/Low) to control prominence; use UI.Hidden to conditionally hide fields.
- FieldGroup is appropriate for header-purpose facets (purpose: #HEADER in CDS/ABAP).
--------------------------------

**TITLE**: Configure numeric value formatting for Fiori elements overview pages

**INTRODUCTION**: Show how to control decimal places and display format of numeric properties in Fiori elements overview pages. Options:
- Set Scale in the OData metadata (EntityType Property)
- Provide formatting via UI annotations (XML annotation, ABAP CDS, or CAP CDS) using com.sap.vocabularies.UI.v1.DataPoint ValueFormat (UI.NumberFormat)
At runtime SAPUI5 uses sap.ui.core.format.NumberFormat (short format) to render values according to these settings.

**TAGS**: fiori-elements-framework, sapui5, odata, annotations, cds, abap, cap, number-format

STEP: 1 — Set precision/scale in OData metadata (EntityType Property)
DESCRIPTION: Define Precision and Scale on Edm.Decimal properties in the OData metadata so the UI renders the property with the configured number of fractional digits. Optionally specify sap:unit for unit display and sap:label for UI label.
LANGUAGE: XML
CODE:
```xml
<EntityType Name="Product" sap:content-version="1">
    ...
    <Property Name="Price" Type="Edm.Decimal" Precision="16" Scale="3" sap:unit="CurrencyCode" sap:label="Unit Price"/>
    <Property Name="Width" Type="Edm.Decimal" Precision="13" Scale="3" sap:unit="DimUnit" sap:label="Dimensions"/>
    <Property Name="Depth" Type="Edm.Decimal" Precision="13" Scale="3" sap:unit="DimUnit" sap:label="Dimensions"/>
    <Property Name="Height" Type="Edm.Decimal" Precision="13" Scale="3" sap:unit="DimUnit" sap:label="Dimensions"/>
    ...
</EntityType>
```

STEP: 2 — Provide number format via XML annotation (UI.DataPoint ValueFormat)
DESCRIPTION: Use com.sap.vocabularies.UI.v1.DataPoint and set ValueFormat to a com.sap.vocabularies.UI.v1.NumberFormat record. Use NumberOfFractionalDigits (Int) to control decimal places and ScaleFactor (Decimal) when scaling is required.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="Price">
    <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
        <PropertyValue Property="Title" String="Unit Price"/>
        <PropertyValue Property="Description" Path="Name"/>
        <PropertyValue Property="Value" Path="Price"/>
        <PropertyValue Property="ValueFormat">
            <Record Type="com.sap.vocabularies.UI.v1.NumberFormat">
                <PropertyValue Property="ScaleFactor" Decimal="1000"/>
                <PropertyValue Property="NumberOfFractionalDigits" Int="1"/>
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 3 — Provide number format via ABAP CDS annotation (@UI.dataPoint)
DESCRIPTION: In ABAP CDS, annotate the element with @UI.dataPoint and set valueFormat with scaleFactor and numberOfFractionalDigits. This maps to the same UI.NumberFormat behavior.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  title: 'Unit Price',
  description: 'Name',
  valueFormat: {
    scaleFactor: 1000,
    numberOfFractionalDigits: 1
  }
}
Price;
```

STEP: 4 — Provide number format via CAP CDS annotation (UI.DataPoint)
DESCRIPTION: In CAP model (CDS for CAP), use UI.DataPoint with ValueFormat of type UI.NumberFormat. Set ScaleFactor and NumberOfFractionalDigits properties to control displayed decimals and scaling.
LANGUAGE: CAP CDS
CODE:
```cap
UI.DataPoint #Price : {
    $Type : 'UI.DataPointType',
    Title : 'Unit Price',
    Description : Name,
    Value : Price,
    ValueFormat : {
        $Type : 'UI.NumberFormat',
        ScaleFactor : 1000,
        NumberOfFractionalDigits : 1
    }
}
```

STEP: 5 — Runtime behavior and notes
DESCRIPTION: At runtime SAPUI5 uses sap.ui.core.format.NumberFormat (short format) to render numeric values according to:
- OData metadata Scale (Edm.Decimal Scale)
- Annotation ValueFormat.NumberOfFractionalDigits and ScaleFactor
If both metadata Scale and annotations are present, annotation-based ValueFormat typically overrides presentation formatting. Ensure property types are Edm.Decimal (or appropriate numeric type) and that annotation qualifiers or target match the UI consumer.
--------------------------------

**TITLE**: Field Features for SAP Fiori elements (OData V4) — Code-focused Annotation Guide

**INTRODUCTION**: Quick, code-centric reference for controlling field text, text arrangement, readable GUIDs, fiscal date patterns, visibility/enablement (UI.Hidden, FieldControl), editability, data point tooltips, and disabling UoM decimal-scale validation in SAP Fiori elements for OData V4. Use these annotations in XML metadata extensions, ABAP CDS views, or CAP CDS models.

**TAGS**: fiori-elements-framework, annotations, ODataV4, UI.TextArrangement, Common.Text, Common.ExternalID, fiscal, UI.Hidden, FieldControl, Core.Computed, Core.Immutable, dataPoint, DoNotCheckScaleOfMeasuredQuantity

STEP: Text annotation and text arrangement (property and entity-level)
DESCRIPTION: Link an ID property to a textual description with Common.Text and control rendering order with UI.TextArrangement. Property-level TextArrangement takes precedence over entity-set (fallback) level. TextArrangement options: TextFirst (default: "Text (ID)"), TextLast ("ID (Text)"), TextOnly ("Text"), TextSeparate ("ID").
LANGUAGE: XML
CODE:
```xml
<!-- Property-level: Common.Text + UI.TextArrangement -->
<Annotations Target="com.c_salesordermanage_sd/SalesOrganization">
  <Annotation Term="Common.Text" Path="SalesOrganization_Text">
    <Annotation Term="UI.TextArrangement" EnumMember="UI.TextArrangementType/TextOnly"/>
  </Annotation>
</Annotations>

<!-- Entity-set fallback TextArrangement (used only when not defined per-property) -->
<Annotations Target="SalesOrder">
  <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@ObjectModel.text.element: ['SalesOrganization_Text']
@UI.textArrangement: #TEXT_ONLY
SalesOrganization
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate com.c_salesordermanage_sd with {
  SalesOrganization @(Common: { Text: SalesOrganization_Text, TextArrangement: #TextOnly });
};
```

STEP: Display readable IDs for Edm.Guid using Common.ExternalID
DESCRIPTION: For Edm.Guid properties, point Common.ExternalID to a readable ID property. UI displays the readable property while the GUID remains the technical key (used in value helps). Common.Text and UI.TextArrangement are evaluated on the readable ID property.
LANGUAGE: XML
CODE:
```xml
<!-- Point the GUID property to the readable externalId property -->
<Annotations Target="ExternalIdService.Entities/myGuidProperty">
  <Annotation Term="Common.ExternalID" Path="externalId"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate ExternalIdService.Entities : myGuidProperty with @(Common: { ExternalID: externalId });
```

STEP: Fiscal date annotations (string patterns)
DESCRIPTION: Annotate Edm.String fiscal date fields to indicate fiscal patterns. Use these annotations in CAP CDS or ABAP CDS (Semantics.*) as shown. Patterns: IsFiscalYearPeriod (YYYYPPP), IsDayOfFiscalYear (d), IsFiscalPeriod (PPP), IsFiscalQuarter (Q), IsFiscalWeek (WW), IsFiscalYear (YYYY), IsFiscalYearQuarter (YYYYQ), IsFiscalYearWeek (YYYYWW).
LANGUAGE: XML
CODE:
```xml
<!-- XML metadata extension examples for LineItems entity -->
<Annotations Target="sap.fe.manageitems.TechnicalTestingService.LineItems/fiscalYearPeriod">
  <Annotation Term="Common.IsFiscalYearPeriod" Bool="true"/>
  <Annotation Term="Common.Label" String="Fiscal Year Period"/>
</Annotations>
<Annotations Target="sap.fe.manageitems.TechnicalTestingService.LineItems/fiscalDayOfYear">
  <Annotation Term="Common.IsDayOfFiscalYear" Bool="true"/>
  <Annotation Term="Common.Label" String="Fiscal Day Of Year"/>
</Annotations>
<!-- ... repeat for fiscalPeriod, fiscalQuarter, fiscalWeek, fiscalYear, fiscalYearQuarter, fiscalWeekYear -->
```

LANGUAGE: ABAP CDS
CODE:
```abap
DEFINE VIEW SalesOrderItemHistoryOvw AS SELECT FROM ...
{
  @Semantics.fiscal.yearPeriod: true
  fiscalYearPeriod,

  @Semantics.fiscal.period: true
  fiscalPeriod,

  @Semantics.fiscal.year: true
  fiscalYear,
  ...
}
```

LANGUAGE: CAP CDS
CODE:
```cds
fiscalYearPeriod  : String  @title: 'Fiscal Year Period'    @Common.IsFiscalYearPeriod : true;
fiscalDayOfYear   : String  @title: 'Fiscal Day Of Year'    @Common.IsDayOfFiscalYear  : true;
fiscalPeriod      : String  @title: 'Fiscal Period'         @Common.IsFiscalPeriod     : true;
fiscalQuarter     : String(1) @title: 'Fiscal Quarter'      @Common.IsFiscalQuarter    : true;
fiscalWeek        : String  @title: 'Fiscal Week'           @Common.IsFiscalWeek       : true;
fiscalYear        : String  @title: 'Fiscal Year'           @Common.IsFiscalYear       : true;
fiscalYearQuarter : String(5) @title: 'Fiscal Year Quarter' @Common.IsFiscalYearQuarter: true @Common.IsDigitSequence: true;
fiscalWeekYear    : String  @title: 'Fiscal Week Year'     @Common.IsFiscalYearWeek   : true;
```

STEP: Hide field using UI.Hidden (DataField and Property)
DESCRIPTION: Use UI.Hidden at UI.DataField level or property level to hide fields. ABAP CDS may not support some core vocabulary annotations; use local XML metadata extensions when needed.
LANGUAGE: XML
CODE:
```xml
<!-- UI.Hidden within a DataField usage -->
<Record Type="UI.DataField">
  <PropertyValue Property="Value" Path="TotalNetAmount" />
  <Annotation Term="UI.Hidden" Bool="false" />
</Record>

<!-- UI.Hidden as property-targeted annotation -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/TotalNetAmount">
  <Annotation Term="Common.Label" String="Net Amount"/>
  <Annotation Term="Measures.ISOCurrency" Path="TransactionCurrency"/>
  <Annotation Term="UI.Hidden" Bool="true" />
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate com.c_salesordermanage_sd.SalesOrderManage with {
  TotalNetAmount
    @UI.Hidden
    @Common.Label : 'Net Amount'
    @Measures.ISOCurrency : TransactionCurrency;
};
```

LANGUAGE: ABAP CDS
CODE:
```abap
{
  value: 'TOTALNETAMOUNT',
  type: #STANDARD
}
@UI.hidden: true
TOTALNETAMOUNT;
```

STEP: Always hidden property example (ProductsType/ID)
DESCRIPTION: The ID property of ProductsType is always hidden; set UI.Hidden accordingly.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.ProductsType/ID">
  <Annotation Term="SAP__UI.Hidden"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate ProductsType with {
  ID @UI.Hidden;
};
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view PRODUCTSTYPE with {
  @UI.hidden: true
  id;
}
```

STEP: Path-based UI.Hidden (contextual hiding)
DESCRIPTION: Use UI.Hidden with Path expression to hide a property only within a specific FieldGroup (qualifier). For example, hide ModifiedAt inside AdministrativeData FieldGroup when HasDraftEntity is true. ABAP CDS does not support path-based UI.hidden — use XML extension.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.ProductsType">
  <Annotation Term="SAP__UI.FieldGroup" Qualifier="AdministrativeData">
    <Record>
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="SAP__UI.DataField">
            <Annotation Term="SAP__UI.Hidden" Path="HasDraftEntity"/>
            <PropertyValue Property="Label" String="Modified at"/>
            <PropertyValue Property="Value" Path="ModifiedAt"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>

<!-- Always hidden when using a path as the annotation target -->
<Annotations Target="SAP__self.ProductsType/ModifiedAt">
  <Annotation Term="SAP__UI.Hidden" Path="HasDraftEntity"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
entity ProductsType : {
  ModifiedAt : {
    ![@UI.Hidden] : HasDraftEntity
  }
}

-- FieldGroup qualifier example
entity ProductsType : {
  UI.FieldGroup #AdministrativeData : {
    Data : [
      {
        $Type : 'UI.DataField',
        Label : 'Modified at',
        Value : ModifiedAt,
        ![@UI.Hidden] : HasDraftEntity
      }
    ]
  }
}
```

STEP: FieldControl metadata (static and dynamic)
DESCRIPTION: Use Common.FieldControl to control enablement/read-only/mandatory/inapplicable states. Can be static (EnumMember) or path-based (pointing to an Edm.Byte property). ABAP CDS exposes only @ObjectModel.mandatory (no @ObjectModel.readOnly or path-based). When FieldControl=Mandatory, header/column marked mandatory in edit mode; Inapplicable renders disabled (dynamic inapplicable supported).
LANGUAGE: XML
CODE:
```xml
<!-- Static FieldControl on property -->
<Annotations Target="SAP__self.ArtistsType/Name">
  <Annotation Term="SAP__common.FieldControl" EnumMember="SAP__common.FieldControlType/Mandatory"/>
</Annotations>

<!-- FieldControl within DataField (making it read-only in this usage) -->
<Record Type="UI.DataField">
  <PropertyValue Property="Value" Path="TotalNetAmount" />
  <Annotation Term="SAP__common.FieldControl" EnumMember="SAP__common.FieldControlType/ReadOnly"/>
</Record>
```

LANGUAGE: CAP CDS
CODE:
```cds
entity Artist : {
  Name : {
    FieldControl : #Mandatory
  }
}

-- DataField-level FieldControl
{
  $Type : 'UI.DataField',
  Value : TotalNetAmount,
  ![@Common.FieldControl] : #ReadOnly
}
```

STEP: FieldControl enum values and behaviors
DESCRIPTION: Use these EnumMembers for Common.FieldControl or SAP__common.FieldControlType:
- Mandatory -> SAP__common.FieldControlType/Mandatory: back-end must enforce non-null on save/update; marked mandatory in headers/columns.
- Optional -> SAP__common.FieldControlType/Optional: can be null.
- ReadOnly -> SAP__common.FieldControlType/ReadOnly: cannot be edited.
- Inapplicable -> SAP__common.FieldControlType/Inapplicable: rendered disabled; static Inapplicable ignored by Fiori elements (service should omit such fields).
LANGUAGE: JSON
CODE:
```json
{
  "FieldControlValues": [
    { "Value": "Mandatory", "EnumMember": "SAP__common.FieldControlType/Mandatory", "Behavior": "Non-null required by backend; marked mandatory in UI" },
    { "Value": "Optional", "EnumMember": "SAP__common.FieldControlType/Optional", "Behavior": "May be null" },
    { "Value": "ReadOnly", "EnumMember": "SAP__common.FieldControlType/ReadOnly", "Behavior": "Not editable in UI" },
    { "Value": "Inapplicable", "EnumMember": "SAP__common.FieldControlType/Inapplicable", "Behavior": "Rendered disabled when dynamic; static ignored" }
  ],
  "Note": "Path-based FieldControl must point to an Edm.Byte property."
}
```

STEP: Editability: Core.Computed, Core.Immutable, Common.FieldControl (read-only)
DESCRIPTION: Use Core.Computed true => always non-editable; Core.Immutable => non-editable in edit mode but editable in create mode; Common.FieldControl with #ReadOnly or path-based enumeration => dynamic read-only behavior. ABAP CDS supports @ObjectModel.mandatory only (no path-based or readOnly via metadata extension).
LANGUAGE: XML
CODE:
```xml
<!-- Core.Computed: always read-only -->
<Annotations Target="SAP__self.ProductsType/CreatedAt">
  <Annotation Term="SAP__Core.Computed"/>
</Annotations>

<!-- Common.FieldControl static read-only on a property -->
<Annotations Target="SAP__self.ProductsType/SupplierName">
  <Annotation Term="SAP__Common.FieldControl" EnumMember="com.sap.vocabularies.Common.v1.FieldControl/ReadOnly"/>
</Annotations>

<!-- Common.FieldControl dynamic (path) -->
<Annotations Target="SAP__self.ReviewsType/AvailabilityCode">
  <Annotation Term="SAP__Common.FieldControl" Path="__FieldControl/AvailabilityCode_FC"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```cds
entity ProductsType : {
  CreatedAt : {
    Core.Computed: true
  }
}

entity ProductsType : {
  SupplierName : {
    Common.FieldControl : #ReadOnly
  }
}

-- Dynamic FieldControl example
entity ReviewsType : {
  Common.FieldControl : __FieldControl.AvailabilityCode_FC
}
```

STEP: Tooltip for a DataPoint (Common.QuickInfo)
DESCRIPTION: Add tooltip to UI.DataPoint using Common.QuickInfo. In ABAP CDS, Common.QuickInfo for dataPoint is not supported — qualifier auto-generated.
LANGUAGE: XML
CODE:
```xml
<!-- DataPoint with tooltip -->
<Annotation Term="UI.DataPoint" Qualifier="Rating">
  <Record Type="UI.DataPointType">
    <Annotation Term="Common.QuickInfo" String="Rating Indicator"/>
    <PropertyValue Property="TargetValue" Int="5"/>
    <PropertyValue Property="Title" String="Rating"/>
    <PropertyValue Property="Value" Path="Rating"/>
    <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Rating"/>
  </Record>
</Annotation>
```

LANGUAGE: CAP CDS
CODE:
```cds
UI.DataPoint #Rating : {
  $Type : 'UI.DataPointType',
  TargetValue : 5,
  Title : 'Rating',
  Value : Rating,
  Visualization : #Rating,
  ![@Common.QuickInfo] : 'Rating Indicator'
}
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  title: 'Rating',
  visualization: #RATING,
  targetValue: 5
}
Rating;
-- Note: Common.QuickInfo is not supported for dataPoint in ABAP CDS; qualifier auto-generated.
```

STEP: Disable standard UoM decimal-scale validation
DESCRIPTION: Use com.sap.vocabularies.UI.v1.DoNotCheckScaleOfMeasuredQuantity (Bool) to skip central validation that enforces max decimals based on unit code lists. false => validate against UoM scale; true => skip central validation (field-level decimal limits still apply).
LANGUAGE: XML
CODE:
```xml
<!-- Disable central UoM scale check for a measured quantity property -->
<Annotations Target="YourService.YourEntity/MeasuredQuantity">
  <Annotation Term="com.sap.vocabularies.UI.v1.DoNotCheckScaleOfMeasuredQuantity" Bool="true"/>
</Annotations>
```

DESCRIPTION: Additional resources
LANGUAGE: TEXT
CODE:
```text
- Value Help Dialog / Text Handling: value-help-dialog-3faed83.md#loio3faed838512648b099e14dfec458d847__table
- Currency and Unit Customizing (decimal places): ../04_Essentials/currency-and-unit-customizing-in-odata-v4-4d1b9d4.md
- ABAP semantics annotations reference: https://help.sap.com/docs/abap-cloud/abap-rap/semantics-annotations
```

--------------------------------

**TITLE**: Further Post-Generation Steps for SAP Fiori elements Apps

**INTRODUCTION**: After generating a SAP Fiori elements app, you can enable or modify default features by editing the app descriptor (manifest.json) and adjusting annotations. You can also extend the generated app using SAP Fiori tools or manually. This document lists concise, code-focused post-generation actions and pointers to the floorplan-specific extension guides.

**TAGS**: fiori-elements-framework, post-generation, manifest.json, annotations, extension, SAP Fiori tools

**STEP**: 1 — Edit the app descriptor (manifest.json)

**DESCRIPTION**: Open and edit webapp/manifest.json to enable or change default framework features (routing, OData model settings, component settings, pages). Apply targeted changes to property groups such as "sap.app", "sap.ui5", "sap.flp", "sap.ui", and "sap.ui5": "models" / "routing". Save and test the app in the local dev server or deploy target.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "your.app.namespace",
    "type": "application",
    "i18n": "i18n/i18n.properties"
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "preload": true
      }
    },
    "routing": {
      "config": {
        "routerClass": "sap.m.routing.Router",
        "viewType": "XML",
        "viewPath": "your.app.namespace.view",
        "controlId": "app",
        "controlAggregation": "pages"
      },
      "routes": [
        {
          "pattern": "",
          "name": "main",
          "target": "main"
        }
      ],
      "targets": {
        "main": {
          "viewName": "Main",
          "viewLevel": 1
        }
      }
    }
  },
  "sap.ui": {
    "technology": "UI5",
    "deviceTypes": {
      "desktop": true,
      "tablet": true,
      "phone": true
    }
  }
}
```

**STEP**: 2 — Adapt annotations used by the app

**DESCRIPTION**: Locate and edit annotation files (commonly under webapp/annotations or referenced by manifest.json as dataSources). Modify or add OData V4 or CDS annotations that control UI semantics (field groups, line items, facets). After editing annotations, reload the app or restart the dev server to validate UI changes.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example placeholder file: webapp/annotations/annotations.xml -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="https://.../Org.OData.Core.V1.xml" />
  <edmx:DataServices>
    <!-- Add UI.Annotations here, for example: -->
    <!-- <Annotations Target="YourService.YourType">
         <Annotation Term="UI.HeaderInfo"> ... </Annotation>
       </Annotations> -->
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 3 — Extend the generated app with SAP Fiori tools

**DESCRIPTION**: Use SAP Fiori tools (Business Application Studio or VS Code extension pack) to extend the app (configure page elements, create new fragments/controllers, add custom controls). See the official guide for step-by-step extension options.

**LANGUAGE**: URL / Shell

**CODE**:
```text
Open the project in SAP Business Application Studio or VS Code with SAP Fiori tools.
See: https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/047507c86afa4e96bb3d284adb9f4726.html
```

**STEP**: 4 — Manually extend SAP Fiori elements-based apps

**DESCRIPTION**: For manual extension patterns and examples (controller extensions, custom controls, manifest.json extension points), follow the manual extension guide.

**LANGUAGE**: URL / Markdown

**CODE**:
```text
Manual extension guide:
extending-sap-fiori-elements-based-apps-358cf25.md
```

**STEP**: 5 — Consult floorplan-specific configuration and extension guides

**DESCRIPTION**: Depending on your app floorplan, follow the corresponding post-generation configuration and extension guide. Use these guides to find concrete examples, property names, and files to change for each floorplan.

**LANGUAGE**: Markdown / URLs

**CODE**:
```text
List Report and Object Page:
list-report-and-object-page-c0eec49.md

Worklist:
worklist-d1d588f.md

Analytical List Page:
analytical-list-page-3d33684.md

Overview Pages:
overview-pages-c64ef8c.md
```
--------------------------------

**TITLE**: General Concepts — SAP Fiori Elements Framework (Developer-Focused Guide)

**INTRODUCTION**:
This document provides concise, actionable general concepts and minimal code examples for building and extending SAP Fiori Elements applications. Use these steps to set up project layout, configure manifest and OData/annotations, define CDS entities, and create common extension artifacts (controller, fragments). Copy and adapt the snippets into your project file paths indicated.

**TAGS**: fiori-elements, sap, ui5, manifest.json, annotations, odata, cds, typescript, xml, json, routing, controllerExtensions

STEP: 1 — Key components and responsibilities

DESCRIPTION:
Quick reference of the primary components of a Fiori Elements application and their responsibilities. Use this as a checklist when generating or scaffolding code.

LANGUAGE: JSON

CODE:
```json
{
  "components": {
    "manifest.json": "App descriptor — routing, models, component configuration",
    "Annotations.xml": "OData V2/V4 annotations used by Fiori Elements (UI.v1, Common, etc.)",
    "CDS (srv/*.cds)": "Domain model and service definitions (if using CAP)",
    "webapp/view": "UI fragments and view extensions (XML)",
    "webapp/controller": "Controller extensions (JS/TS) for custom logic",
    "webapp/fragment": "Re-usable UI fragments (XML)",
    "xs-app.json/npm scripts": "Serve/build/debug commands"
  }
}
```

STEP: 2 — Recommended project layout

DESCRIPTION:
Standard folder layout for a UI5-based Fiori Elements project and where to place manifest, annotations, CDS, and extensions.

LANGUAGE: text

CODE:
```
/project-root
├─ /app
│  ├─ /annotations
│  │  └─ Annotations.xml
├─ /srv
│  └─ cat-service.cds
├─ /webapp
│  ├─ manifest.json
│  ├─ index.html
│  ├─ /view
│  ├─ /controller
│  ├─ /fragment
│  └─ /ext
│     ├─ /controller
│     │  └─ CustomController.ts
│     └─ /fragment
│        └─ CustomAction.fragment.xml
├─ package.json
└─ xs-security.json (optional)
```

STEP: 3 — Minimal manifest.json essential sections

DESCRIPTION:
Paste this minimal manifest.json skeleton into /webapp/manifest.json. It shows key sections: sap.app, sap.ui5, dataSources, models, and routing used by Fiori Elements.

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "id": "com.example.app",
    "type": "application",
    "i18n": "i18n/i18n.properties",
    "applicationVersion": { "version": "1.0.0" }
  },
  "sap.ui5": {
    "dependencies": { "minUI5Version": "1.84.0", "libs": { "sap.fe.templates": {}, "sap.ui.core": {} } },
    "models": {
      "": {
        "dataSource": "mainService",
        "preload": true,
        "settings": { "synchronizationMode": "None" }
      },
      "i18n": { "type": "sap.ui.model.resource.ResourceModel", "uri": "i18n/i18n.properties" }
    },
    "resources": {},
    "rootView": {
      "viewName": "sap.fe.templates.ListReport",
      "type": "XML",
      "id": "App"
    },
    "routing": {
      "config": {
        "routerClass": "sap.m.routing.Router",
        "viewType": "XML",
        "controlAggregation": "pages"
      },
      "routes": [
        { "name": "list", "pattern": "", "target": "list" }
      ],
      "targets": {
        "list": { "viewName": "ListReport", "viewLevel": 1 }
      }
    },
    "controllerExtensions": {
      "sap.fe.templates.ListReport": {
        "controllerName": "com.example.app.ext.controller.CustomController"
      }
    }
  },
  "sap.app/": {}
}
```

STEP: 4 — DataSource and OData model configuration (manifest.json snippet)

DESCRIPTION:
Configure the OData V4 or V2 data source in manifest.json. Point to local CAP service (srv) or remote backend. Place this under top-level "sap.app" or "sap.ui5" depending on tooling; shown here under top-level "dataSources" and "models".

LANGUAGE: JSON

CODE:
```json
{
  "dataSources": {
    "mainService": {
      "uri": "/sap/opu/odata/sap/MY_SERVICE_SRV/",
      "type": "OData",
      "settings": { "odataVersion": "2.0" }
    }
  },
  "models": {
    "": {
      "dataSource": "mainService",
      "settings": { "synchronizationMode": "None" }
    }
  }
}
```

STEP: 5 — Annotations XML (UI.LineItem example)

DESCRIPTION:
Place annotation files in /app/annotations/Annotations.xml or under /webapp/annotations. Fiori Elements consumes OData annotations to render UI. Example shows LineItem for ListReport cards or table columns.

LANGUAGE: XML

CODE:
```xml
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="4.0"
  xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx">
  <edmx:Reference Uri="http://docs.oasis-open.org/odata/odata/v4.0/cs02/vocabularies/Org.OData.Core.V1.xml">
    <edmx:Include Namespace="Org.OData.Core.V1" Alias="Core"/>
  </edmx:Reference>
  <edmx:DataServices>
    <Schema Namespace="MyApp.Annotations" xmlns="http://docs.oasis-open.org/odata/ns/edm">
      <Annotations Target="MyService.CatalogEntity">
        <Annotation Term="UI.LineItem">
          <Collection>
            <Record Type="UI.DataField">
              <PropertyValue Property="Label" String="ID"/>
              <PropertyValue Property="Value"><PropertyPath>ID</PropertyPath></PropertyValue>
            </Record>
            <Record Type="UI.DataField">
              <PropertyValue Property="Label" String="Name"/>
              <PropertyValue Property="Value"><PropertyPath>Name</PropertyPath></PropertyValue>
            </Record>
          </Collection>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

STEP: 6 — CDS model (CAP) example

DESCRIPTION:
If using SAP CAP, define entities and service in srv/*.cds. Put file at /srv/cat-service.cds and deploy to generate OData endpoints consumed by manifest dataSource.

LANGUAGE: CDS

CODE:
```cds
namespace my.app;

using { cuid, managed } from '@sap/cds/common';

entity Books : managed {
  ID      : UUID @title : 'ID' = cuid();
  title   : String(255);
  author  : String(255);
  price   : Decimal(9,2);
}

service CatalogService {
  entity Books as projection on my.app.Books;
}
```

STEP: 7 — Controller extension (TypeScript) for ListReport

DESCRIPTION:
Implement controller extension to add custom logic (button handlers, lifecycle hooks). Place under /webapp/ext/controller/CustomController.ts and reference in manifest controllerExtensions. Use JS/TS compatible UI5 module format.

LANGUAGE: TypeScript

CODE:
```typescript
import BaseController from "sap/ui/core/mvc/Controller";
import JSONModel from "sap/ui/model/json/JSONModel";

export default BaseController.extend("com.example.app.ext.controller.CustomController", {
  onInit() {
    // Example: add a local model for UI state
    const oViewModel = new JSONModel({ busy: false });
    this.getView().setModel(oViewModel, "view");
  },

  onCustomAction(oEvent: any) {
    // Custom action handler for a fragment or button
    const oContext = oEvent.getSource().getBindingContext();
    // implement custom logic here
    console.log("Custom action triggered for", oContext && oContext.getObject());
  }
});
```

STEP: 8 — XML fragment for a custom action

DESCRIPTION:
Create an XML fragment to add a custom button or dialog. Place at /webapp/ext/fragment/CustomAction.fragment.xml and reference from annotations or manifest extensions.

LANGUAGE: XML

CODE:
```xml
<core:FragmentDefinition
  xmlns="sap.m"
  xmlns:core="sap.ui.core">
  <Button text="Custom Action" type="Emphasized" press=".onCustomAction"/>
</core:FragmentDefinition>
```

STEP: 9 — Adding annotation files into manifest (annotation configuration)

DESCRIPTION:
Reference local annotation files in manifest.json so Fiori Elements picks them up. Add annotationFiles under sap.ui5 models or as "sap.app/annotations".

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "annotations": [
            {
              "uri": "app/annotations/Annotations.xml"
            }
          ]
        }
      }
    }
  }
}
```

STEP: 10 — Build, run and debug (npm / UI5 tooling)

DESCRIPTION:
Common commands for local development using @ui5/cli or local CAP server. Adjust scripts in package.json accordingly.

LANGUAGE: Shell

CODE:
```sh
# Install deps
npm install

# Run CAP backend (if using CAP)
cd srv
npm start

# Run UI5 app with ui5-server
npx ui5 serve --config=ui5.yaml --open index.html

# Or use local Fiori sandbox
npm run start
```
--------------------------------

**TITLE**: General Concepts and Configuration — SAP Fiori elements (practical snippets)

**INTRODUCTION**: Quick, copy-pasteable configuration and annotation snippets for common SAP Fiori elements concepts. Use these templates when authoring manifest.json, annotation XML files, or OData annotations. Replace placeholders (e.g., Namespace, EntitySet, PropertyName) with your app-specific values.

**TAGS**: fiori-elements, manifest.json, annotations, PresentationVariant, Importance, flexible-column-layout, variant-management, value-help, images, actions

STEP: Configure application title and i18n model
DESCRIPTION: Add the application title and a resource model (i18n) to manifest.json so the app title can be localized and displayed in the Fiori launchpad.
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (fragment)
{
  "sap.app": {
    "id": "com.mycompany.myapp",
    "title": "{{appTitle}}",
    "description": "My Fiori elements app"
  },
  "sap.ui5": {
    "models": {
      "i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "settings": {
          "bundleName": "i18n.i18n"
        }
      }
    }
  }
}
```

STEP: Enable Flexible Column Layout (FCL) in routing
DESCRIPTION: Configure the router to use sap.f.routing.Router and add routing targets for FCL. Place this under sap.ui5.routing in manifest.json. Replace view names, control IDs, and target patterns with your app structure.
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (fragment)
{
  "sap.ui5": {
    "routing": {
      "config": {
        "routerClass": "sap.f.routing.Router",
        "viewType": "XML",
        "viewPath": "com.mycompany.myapp.view",
        "controlId": "fcl",                // ID of the FlexibleColumnLayout control in index.html/view
        "controlAggregation": "beginColumnPages"
      },
      "routes": [
        {
          "pattern": "",
          "name": "list",
          "target": ["master"]
        }
      ],
      "targets": {
        "master": {
          "viewName": "Master",
          "controlAggregation": "beginColumnPages"
        },
        "detail": {
          "viewName": "Detail",
          "controlAggregation": "midColumnPages"
        },
        "detailSecond": {
          "viewName": "DetailSecond",
          "controlAggregation": "endColumnPages"
        }
      }
    }
  }
}
```

STEP: Enable variant management for List Report / FilterBar
DESCRIPTION: Turn on variant management in the List Report by adding the setting in sap.ui.generic.app pages configuration in manifest.json. This example uses Page-level variant management.
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (fragment)
{
  "sap.ui.generic.app": {
    "pages": {
      "EntitySet": {                           // Replace with your entity set name (or key "ListReport|<EntitySet>" for FE templates)
        "entitySet": "MyEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "variantManagement": "Page"        // Options: "Page", "Control", "None"
          }
        }
      }
    }
  }
}
```

STEP: Mark fields for responsiveness using Importance annotation
DESCRIPTION: Use the UI.v1.Importance annotation to help Fiori evaluate which fields to show in toolbars and compact layouts. Provide both XML annotation and a CDS (if using CAP/CDS) variant.
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations/Annotations.xml (OData Vocab XML) -->
<Annotations Target="Namespace.MyEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
    <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Value" Path="CustomerName"/>
        <!-- Mark as high importance -->
        <Annotation Term="com.sap.vocabularies.UI.v1.Importance">
          <EnumMember>com.sap.vocabularies.UI.v1.ImportanceType/High</EnumMember>
        </Annotation>
      </Record>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Value" Path="LongDescription"/>
        <!-- Lower importance -->
        <Annotation Term="com.sap.vocabularies.UI.v1.Importance">
          <EnumMember>com.sap.vocabularies.UI.v1.ImportanceType/Low</EnumMember>
        </Annotation>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: Define initial expansion level for tables (PresentationVariant)
DESCRIPTION: Use PresentationVariant annotation to set initialExpansionLevel for hierarchical tables. This controls the number of expanded levels on initial render.
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations/Annotations.xml (OData Vocab XML) -->
<Annotations Target="Namespace.MyEntitySet">
  <Annotation Term="com.sap.vocabularies.UI.v1.PresentationVariant">
    <Record>
      <!-- Number of expanded hierarchy levels on initial render -->
      <PropertyValue Property="InitialExpansionLevel" Int="2"/>
      <!-- Optional: default sort or visualizations -->
      <PropertyValue Property="SortOrder">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.SortOrder">
            <PropertyValue Property="Property" String="CreatedAt"/>
            <PropertyValue Property="Descending" Bool="true"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Provide fixed value help as dropdown (ValueList with collection path)
DESCRIPTION: If a property has a small fixed set of values, point the ValueList annotation at a collection that contains the allowed values so the UI renders a dropdown.
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations/Annotations.xml (OData Vocab XML) -->
<Annotations Target="Namespace.MyEntityType/Status">
  <Annotation Term="Common.ValueList">
    <Record>
      <PropertyValue Property="CollectionPath" String="StatusValueSet"/>  <!-- OData entity set with fixed values -->
      <PropertyValue Property="SearchSupported" Bool="false"/>
      <PropertyValue Property="Parameters">
        <Collection>
          <Record>
            <PropertyValue Property="LocalDataProperty" String="Status"/>
            <PropertyValue Property="ValueListProperty" String="Value"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: Display images, initials, or icons for a property
DESCRIPTION: Mark a property as an image to have Fiori elements render it as an avatar/image. Use UI.IsImage or reference an ImageUrl property.
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations/Annotations.xml (OData Vocab XML) -->
<Annotations Target="Namespace.MyEntityType">
  <!-- Mark Photo as an image -->
  <Annotation Term="com.sap.vocabularies.UI.v1.IsImage">
    <PropertyPath>Photo</PropertyPath>
  </Annotation>

  <!-- Example: in LineItem, show Photo and Name -->
  <Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
    <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Value" Path="Photo"/>
      </Record>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="Value" Path="Name"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: Add generic actions to the UI (LineItem/Actions)
DESCRIPTION: Define UI actions via annotations that render action buttons in list items or object pages. Implement the corresponding OData action or navigation handler in the backend/frontend.
LANGUAGE: XML
CODE:
```xml
<!-- File: annotations/Annotations.xml (OData Vocab XML) -->
<Annotations Target="Namespace.MyEntityType">
  <!-- Add actions to the LineItem toolbar or row -->
  <Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
    <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
        <PropertyValue Property="Action" String="Namespace.MyAction"/>   <!-- Bound action name or identifier -->
        <PropertyValue Property="Label" String="Execute"/>
      </Record>
      <!-- Intent-based navigation example -->
      <Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
        <PropertyValue Property="SemanticObject" String="Customer"/>
        <PropertyValue Property="Action" String="manage"/>
        <PropertyValue Property="Label" String="Open Customer"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: Where to place annotation files and manifest fragments
DESCRIPTION: Recommended file locations and loading:
- manifest.json: webapp/manifest.json
- OData annotation XML: webapp/annotations/Annotations.xml
- Register annotation file in manifest (sap.ui5 -> models -> add annotationURI if not using annotation discovery)
LANGUAGE: JSON
CODE:
```json
// File: webapp/manifest.json (annotation model registration fragment)
{
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"  // default OData service
      },
      "annotationModel": {
        "type": "sap.ui.model.odata.v2.ODataModel",
        "settings": {
          "annotationURI": "annotations/Annotations.xml" // local annotation file
        }
      }
    },
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/MY_ODATA_SERVICE/",
        "type": "OData",
        "settings": {
          "odataVersion": "2.0"
        }
      }
    }
  }
}
```


--------------------------------

**TITLE**: Generative AI Features in SAP Fiori elements (AI-Assisted Easy Filter & Smart Summarization)

**INTRODUCTION**: Short reference for developers and integrators to enable and use SAP Fiori elements generative AI features: AI-Assisted Easy Filter (list reports) and AI-Assisted Smart Summarization (object pages). Includes quick usage examples, verification checklist, image asset paths, and authoritative links for implementation and admin follow-up.

**TAGS**: fiori-elements-framework, sap-s4hana-cloud, generative-ai, ai-assisted, easy-filter, smart-summarization, list-report, object-page

STEP: 1 — Prerequisites and verification checklist

DESCRIPTION: Verify entitlement, authorization, and product edition prerequisites required to use generative AI features in SAP S/4HANA Cloud Public Edition. Confirm with cloud administrator before attempting to use or test features.

LANGUAGE: Text

CODE:
```Text
Prerequisite checklist:
- Product: SAP S/4HANA Cloud Public Edition (confirm edition).
- Entitlement: Generative AI features may require additional entitlement. Verify via SAP Cloud Contract/Entitlements.
- Authorization: Ensure user role/role collection includes required business catalog and PFCG roles for AI features (check with security admin).
- Network & Privacy: Confirm data privacy and allowed outbound connections for cloud AI services (security/compliance).
- Admin check: Contact your SAP Cloud admin to confirm the feature is enabled for your tenant.

Reference: Official help pages (see STEP 5 links).
```

STEP: 2 — Use AI-Assisted Easy Filter (List Report)

DESCRIPTION: How to use the AI-Assisted Easy Filter on a Fiori elements list report. This feature accepts natural-language-like filter queries to produce a matching filter set. Provide example queries to guide test automation or UI test scripts.

LANGUAGE: Text

CODE:
```Text
Usage:
- Navigate to the List Report page in the Fiori app.
- Locate the Easy Filter input area (the list report filter bar / quick filter area).
- Enter a natural-language-style query and submit (press Enter or click the AI icon if present).

Example natural language queries (for test cases / automation):
- "Open sales orders last 30 days with overdue items"
- "Customers in Germany with revenue > 100000 in 2025"
- "Products with stock below 50 and supplier region Asia"

Expected behavior:
- The system translates the query into concrete filter selections and applies them to the list.
- UI shows corresponding filter chips/fields with values populated.
- If ambiguous, the system may present clarification options.

Image asset (UI reference):
- images/AI-Assisted_Easy_Filter_6254f19.png
```

STEP: 3 — Use AI-Assisted Smart Summarization (Object Page)

DESCRIPTION: How to invoke and use AI-Assisted Smart Summarization on an object page to generate concise business summaries suitable for sharing externally. Includes example prompts and expected output formats for integration/testing.

LANGUAGE: Text

CODE:
```Text
Usage:
- Open an Object Page for the business object (e.g., purchase order, sales order, customer).
- Locate the "Smart Summarization" action/button (may be in the header or action menu).
- Activate the feature; the AI generates a concise summary of the object's key business information.
- Copy, download, or share the generated summary to external tools as allowed by your tenant.

Example prompts / expected outputs (for validation):
- Input context: object page data (header, status, key dates, amounts, open actions)
- Output example: "PO 12345 (Open) — Total EUR 45,000 — Delivery due 2026-02-10 — 2 items delayed by supplier X — Action: Contact supplier X and confirm partial delivery by 2026-02-05."

Image asset (UI reference):
- images/AI-Assisted_Smart_Summarization_e3ea9c8.png
```

STEP: 4 — Logging, troubleshooting and testing guidance

DESCRIPTION: Recommended checks for troubleshooting and for building automated tests around the AI features.

LANGUAGE: Text

CODE:
```Text
Troubleshooting checklist:
- If filtering/summarization fails, verify entitlement and that the feature is enabled for your tenant.
- Check browser console/network logs for client-side errors.
- Confirm backend OData services return expected payloads (the AI summarizer and easy filter rely on object data).
- Validate role-based access: test with a user who has full app access.

Test scenarios for automation:
- Positive: Submit a set of natural language queries and assert resulting filter chips and list result counts.
- Negative: Submit ambiguous or malformed queries and assert graceful handling (help text, clarification prompts).
- Summarization: Trigger summarization and validate presence of key fields (IDs, statuses, totals, dates) in generated text.

Privacy note:
- Ensure any automated capture of AI output complies with data privacy requirements.
```

STEP: 5 — Official documentation and reference links

DESCRIPTION: Store authoritative URLs and image file paths for integration and further reading.

LANGUAGE: JSON

CODE:
```JSON
{
  "AI-Assisted Easy Filter doc": "https://help.sap.com/docs/SAP_S4HANA_CLOUD/4fc8d03390c342da8a60f8ee387bca1a/804ed39a7dd34720912483ddfb847087.html",
  "AI-Assisted Smart Summarization doc": "https://help.sap.com/docs/SAP_S4HANA_CLOUD/4fc8d03390c342da8a60f8ee387bca1a/6c1bc21f01c840cba336404fb249cf95.html",
  "Image assets": [
    "images/AI-Assisted_Easy_Filter_6254f19.png",
    "images/AI-Assisted_Smart_Summarization_e3ea9c8.png"
  ]
}
```
--------------------------------

**TITLE**: Configure Generic Action Buttons (Create / Delete) in Object Page Tables

**INTRODUCTION**: Use OData annotations to enable or conditionally show the generic Create and Delete toolbar buttons for tables on the Object Page in SAP Fiori Elements. This contains concise, copy-pasteable annotation examples for OData V2, OData V4, and CAP CDS. Includes behavior notes required for correct implementation.

**TAGS**: fiori-elements-framework, annotations, OData V2, OData V4, CAP, CDS, create, delete, object-page, table, creatable-path, deletable-path

**STEP**: Create button — behavior and requirement

**DESCRIPTION**: The Create button is displayed in the table toolbar only when the Object Page is in Edit mode. To conditionally show/hide the Create button, the annotation must reference a Boolean property of the root entity (entity instance). If that property value is true, the Create button is shown; if false, it is hidden. The creatable-path must point to a property of the root entity (not of the navigation target).

**LANGUAGE**: text

**CODE**:
```text
Notes:
- Create button visible only in Edit mode.
- creatable-path MUST point to a boolean property on the root entity.
- Example image path: images/CreatablePath_ObPTable_1d6a9b1.png (illustration only).
```

**STEP**: Create button — OData V2 annotation (navigation property)

**DESCRIPTION**: Add sap:creatable-path on the NavigationProperty in the service metadata (or in annotations XML) to reference a Boolean property on the root entity. The NavigationProperty points to the table target on the Object Page.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: add sap:creatable-path to the NavigationProperty that represents the table -->
<NavigationProperty Name="to_ProductText" sap:creatable-path="CanCreateProductText" .../>
```

**STEP**: Create button — OData V4 annotation (InsertRestrictions / NonInsertableNavigationProperties)

**DESCRIPTION**: For OData V4, use Capabilities.InsertRestrictions and configure NonInsertableNavigationProperties with an If/Not/Path expression that references the root-entity boolean property. This example marks the navigation property non-insertable when CanCreateProductText is false.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_Product">
    <Annotation Term="Capabilities.InsertRestrictions">
        <Record>
            <PropertyValue Property="NonInsertableNavigationProperties">
                <Collection>
                    <If>
                        <Not>
                            <Path>CanCreateProductText</Path>
                        </Not>
                        <NavigationPropertyPath>to_ProductText</NavigationPropertyPath>
                    </If>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: Delete button — behavior and requirement

**DESCRIPTION**: Set deletable-path (V2) or DeleteRestrictions/Deletable (V4/CAP) to a Boolean property on the entity type or entity set. The Delete toolbar button is enabled for a selected row if the selected item's property value is true. For tables with multi-selection, the Delete button is enabled if at least one selected item is deletable.

**LANGUAGE**: text

**CODE**:
```text
Behavior summary:
- deletable-path / Deletable points to a boolean property on the entity (e.g., Delete_mc).
- Single selection: Delete enabled if selected item's property == true.
- Multi selection: Delete enabled if at least one selected item has property == true.
```

**STEP**: Delete button — OData V2 annotation (EntitySet)

**DESCRIPTION**: Add sap:deletable-path to the EntitySet definition. This directs the runtime to read the boolean property on each entity instance to determine deletability.

**LANGUAGE**: XML

**CODE**:
```xml
<EntitySet Name="STTA_C_MP_ProductText"
           EntityType="STTA_PROD_MAN.STTA_C_MP_ProductTextType"
           sap:deletable-path="Delete_mc"
           sap:content-version="1"/>
```

**STEP**: Delete button — OData V4 annotation (DeleteRestrictions)

**DESCRIPTION**: For OData V4, annotate the entity set with Org.OData.Capabilities.V1.DeleteRestrictions and set PropertyValue Deletable with a Path to the boolean property.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_PROD_MAN_Entities/STTA_C_MP_ProductText">
   <Annotation Term="Org.OData.Capabilities.V1.DeleteRestrictions">
        <Record>
            <PropertyValue Property="Deletable" Path="Delete_mc"/>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: Delete button — CAP CDS annotation

**DESCRIPTION**: In CAP CDS, use annotate ... with Capabilities.DeleteRestrictions to map Deletable to the boolean field (e.g., Delete_mc).

**LANGUAGE**: CDS

**CODE**:
```sql
annotate STTA_PROD_MAN.STTA_C_MP_ProductText with @(
  Capabilities.DeleteRestrictions : {
    Deletable : Delete_mc
  }
);
```

**STEP**: Related resources

**DESCRIPTION**: Reference additional examples and related topics (file paths preserved from original documentation).

**LANGUAGE**: text

**CODE**:
```text
- Main guide: adding-actions-to-tables-b623e0b.md
- Example: example-adding-custom-filter-fields-in-table-toolbar-e34f78f.md
- Illustration: images/CreatablePath_ObPTable_1d6a9b1.png
```
--------------------------------

**TITLE**: Grouping Fields with UI.FieldGroup and UI.ConnectedFields (Fiori Elements)

**INTRODUCTION**: This document provides actionable annotations and manifest snippets to group related fields in SAP Fiori Elements (Object Page and Table), covering UI.FieldGroup, UI.Facets referencing, LineItem (table) usage, semantically connected fields (ConnectedFields), manifest-based table and TextArea settings, and checkbox groups. Use the copy-paste ready code samples for XML OData annotations, ABAP CDS metadata extensions, and CAP CDS annotations.

**TAGS**: fiori-elements-framework, annotations, UI.FieldGroup, UI.ConnectedFields, manifest.json, CDS, CAP, ABAP, OData, LineItem, FieldGroup, ConnectedFields

STEP: Define a UI.FieldGroup in an Object Page (form-style grouping)
DESCRIPTION: Create a FieldGroup qualifier that lists DataField items to display together in a form-like block on the object page. If all grouped fields are hidden the group container is hidden.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="Dimensions">
   <Record>
      <PropertyValue Property="Label" String="Dimensions"/>
      <PropertyValue Property="Data">
         <Collection>
            <Record Type="UI.DataField">
               <PropertyValue Property="Value" Path="BaseUnit"/>
            </Record>
            <Record Type="UI.DataField">
               <PropertyValue Property="Value" Path="Height"/>
            </Record>
            <Record Type="UI.DataField">
               <PropertyValue Property="Value" Path="Width"/>
            </Record>
            <Record Type="UI.DataField">
               <PropertyValue Property="Value" Path="Depth"/>
            </Record>
            <Record Type="UI.DataField">
               <PropertyValue Property="Value" Path="Weight"/>
            </Record>
         </Collection>
      </PropertyValue>
   </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [
  {
    type: #STANDARD,
    position: 1 ,
    qualifier: 'Dimensions',
    groupLabel: 'Dimensions'
  }
]
BaseUnit;

@UI.fieldGroup: [
  {
    type: #STANDARD,
    position: 2 ,
    qualifier: 'Dimensions'
  }
]
Height;

@UI.fieldGroup: [
  {
    type: #STANDARD,
    position: 3 ,
    qualifier: 'Dimensions'
  }
]
Width;

@UI.fieldGroup: [
  {
    type: #STANDARD,
    position: 4 ,
    qualifier: 'Dimensions'
  }
]
Depth;

@UI.fieldGroup: [
  {
    type: #STANDARD,
    position: 5 ,
    qualifier: 'Dimensions'
  }
]
Weight;
```

LANGUAGE: CAP CDS
CODE:
```cql
UI.FieldGroup #Dimensions : {
    $Type : 'UI.FieldGroupType',
    Label : 'Dimensions',
    Data : [
        {
            $Type : 'UI.DataField',
            Value : BaseUnit
        },
        {
            $Type : 'UI.DataField',
            Value : Height
        },
        {
            $Type : 'UI.DataField',
            Value : Width
        },
        {
            $Type : 'UI.DataField',
            Value : Depth
        },
        {
            $Type : 'UI.DataField',
            Value : Weight
        }
    ]
}
```

STEP: Reference the FieldGroup from UI.Facets (object page section)
DESCRIPTION: Create a ReferenceFacet in UI.Facets to surface the FieldGroup as a form subsection on the object page. Use the FieldGroup qualifier as Target.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Facets">
   <Collection>
      <Record Type="UI.ReferenceFacet">
         <PropertyValue Property="Label" String="Dimensions" />
         <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#Dimensions"/>
      </Record>
   </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Facet: [
  {
    label: 'Dimensions',
    targetQualifier: 'Dimensions',
    type: #FIELDGROUP_REFERENCE,
    purpose: #STANDARD
  }
]
```

LANGUAGE: CAP CDS
CODE:
```cql
UI.Facets : [
    {
        $Type : 'UI.ReferenceFacet',
        Label : 'Dimensions',
        Target : '@UI.FieldGroup#Dimensions'
    }
]
```

STEP: Use UI.FieldGroup inside UI.LineItem (table cell grouping)
DESCRIPTION: To render multiple fields stacked inside a table cell, add a UI.DataFieldForAnnotation into UI.LineItem that targets a UI.FieldGroup qualifier. Supported inner types: DataField, DataFieldForAction, DataFieldForAnnotation.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.LineItem">
    <Collection>
        <!-- other line item records -->
        <Record Type="UI.DataFieldForAnnotation">
            <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#FieldGroup1" />
            <PropertyValue Property="Label" String="Type Information"/>
        </Record>
        <!-- other line item records -->
    </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [
  {
    label: 'Type Information',
    type: #AS_FIELDGROUP,
    valueQualifier: 'FieldGroup1'
  }
]
producttype;
```

LANGUAGE: CAP CDS
CODE:
```cql
UI.LineItem : [
    {
        $Type : 'UI.DataFieldForAnnotation',
        Target : '@UI.FieldGroup#FieldGroup1',
        Label : 'Type Information'
    }
]
```

STEP: Define a FieldGroup for LineItem (DataField and action button example)
DESCRIPTION: Example FieldGroup that holds a DataField and a DataFieldForAction (dummy button). Use this qualifier in the LineItem Target above.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="FieldGroup1">
    <Record>
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="ContractType"/>
                </Record>
                <Record Type="UI.DataFieldForAction">
                    <PropertyValue Property="Label" String="Dummy Button"/>
                    <PropertyValue Property="Action" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [
  {
    type: #STANDARD,
    position: 1 ,
    qualifier: 'FieldGroup1'
  }
]
ContractType;

@UI.fieldGroup: [
  {
    label: 'Dummy Button',
    dataAction: 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2',
    type: #FOR_ACTION,
    position: 2 ,
    qualifier: 'FieldGroup1'
  }
]
contractName;
```

LANGUAGE: CAP CDS
CODE:
```cql
UI.FieldGroup #FieldGroup1 : {
    Data : [
        {
            $Type : 'UI.DataField',
            Value : ContractType
        },
        {
            $Type : 'UI.DataFieldForAction',
            Label : 'Dummy Button',
            Action : 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2'
        }
    ]
}
```

STEP: Table implementation rules and restrictions
DESCRIPTION: Actionable rules when using FieldGroup inside tables:
- Add DataFieldForAnnotation to UI.LineItem referencing a UI.FieldGroup qualifier.
- Supported inner types: DataField, DataFieldForAction, DataFieldForAnnotation (contact cards, rating/progress).
- If multiple DataFieldForAction buttons are used, avoid showing a column header: do not provide a Label for the LineItem DataFieldForAnnotation holding the FieldGroup.
- UI.FieldGroup is NOT supported in GridTable, TreeTable, AnalyticalTable.
- Table personalization (filter/sort/group) works only based on individual properties inside the FieldGroup (same entity type).
LANGUAGE: JSON
CODE:
```json
{
  "note": "No code required; follow the rules above when defining LineItem and FieldGroup annotations."
}
```

STEP: Semantically Connected Fields (UI.ConnectedFields) — OData V2 example (Connected date/time)
DESCRIPTION: Configure connected fields that render side-by-side under a single label and template. Reference these connected fields inside a FieldGroup using DataFieldForAnnotation to show the combined representation.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.ConnectedFields" Qualifier="ConnectedDateTime">
    <Record>
        <PropertyValue Property="Data">
            <Record>
                <PropertyValue Property="SalesOrderDate">
                    <Record Type="com.sap.vocabularies.UI.v1.DataField">
                        <PropertyValue Property="Value" Path="SalesOrderDate"/>
                    </Record>
                </PropertyValue>
                <PropertyValue Property="SalesOrderTime">
                    <Record Type="com.sap.vocabularies.UI.v1.DataField">
                        <PropertyValue Property="Value" Path="TrialTOD"/>
                    </Record>
                </PropertyValue>
            </Record>
        </PropertyValue>
        <PropertyValue Property="Label" String="Connected DateTime"/>
        <PropertyValue Property="Template" String="{SalesOrderDate} / {SalesOrderTime}"/>
    </Record>
</Annotation>

<!-- Use the ConnectedFields in a FieldGroup -->
<Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup" Qualifier="OrderData">
    <Record>
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
                    <PropertyValue Property="Target" AnnotationPath="@UI.ConnectedFields#ConnectedDateTime"/>
                    <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
                </Record>
                <!-- other connected fields -->
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: Semantically Connected Fields — OData V4 example and ABAP/CAP mapping
DESCRIPTION: Use SAP__UI.ConnectedFields (V4) and reference via UI.DataFieldForAnnotation in a FieldGroup. ConnectedFields must be used in form sections (not header).
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="OrderData">
    <Record Type="UI.FieldGroupType">
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataFieldForAnnotation">
                    <PropertyValue Property="Target" AnnotationPath="@UI.ConnectedFields#ConnectedOrderDates"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>

<Annotation Term="SAP__UI.ConnectedFields" Qualifier="ConnectedOrderDates">
<Record>
    <PropertyValue Property="Label" String="Order / Delivery"/>
    <PropertyValue Property="Template" String="{OrderDate}/{DeliveryDate}"/>
    <PropertyValue Property="Data">
        <Record Type="Core.Dictionary">
            <PropertyValue Property="OrderDate">
                <Record Type="SAP__UI.DataField">
                    <PropertyValue Property="Value" Path="OrderDate"/>
                </Record>
            </PropertyValue>
            <PropertyValue Property="DeliveryDate">
                <Record Type="SAP__UI.DataField">
                    <PropertyValue Property="Value" Path="DeliveryDate"/>
                </Record>
            </PropertyValue>
        </Record>
    </PropertyValue>
</Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view SALESORDER with {
  @UI: {
    identification: [
      { type: #AS_CONNECTED_FIELDS, valueQualifier: 'ConnectedOrderDates' }
    ],
    connectedFields: [
      {
        name: 'OrderDate',
        qualifier: 'ConnectedOrderDates',
        template: '{OrderDate}/{DeliveryDate}',
        groupLabel: 'Order / Delivery'
      }
    ]
  }
  OrderDate;

  @UI: {
    connectedFields: [
      { name: 'DeliveryDate', qualifier: 'ConnectedOrderDates' }
    ]
  }
  DeliveryDate;
}
```

LANGUAGE: CAP CDS
CODE:
```cql
annotate SalesOrderService.SalesOrder with @UI : {

  FieldGroup #OrderData : {
    Data : [
      { $Type : 'UI.DataFieldForAnnotation', Target: '@UI.ConnectedFields#ConnectedOrderDates' }
    ]
  },

  ConnectedFields #ConnectedOrderDates: {
    $Type   : 'UI.ConnectedFieldsType',
    Label   : 'Order / Delivery',
    Template: '{OrderDate}/{DeliveryDate}',
    Data    : {
      $Type        : 'Core.Dictionary',
      OrderDate    : { $Type : 'UI.DataField', Value : OrderDate },
      DeliveryDate : { $Type : 'UI.DataField', Value : DeliveryDate }
    }
  }
}
```

STEP: Navigation for Semantically Connected Fields
DESCRIPTION: To enable navigation from a connected field, define navigation on the individual data fields forming the ConnectedFields. Allowed navigation types: DataFieldWithURL, SemanticObject on the data field, DataFieldWithIntentBasedNavigation, DataFieldWithNavigationPath. See outbound navigation docs when implementing.
LANGUAGE: JSON
CODE:
```json
{
  "note": "Define navigation annotations on the underlying DataField(s) inside the ConnectedFields declaration (e.g., DataFieldWithIntentBasedNavigation). No single-line code; follow target navigation annotation patterns."
}
```

STEP: Show field labels inside FieldGroup cells (OData V4 - manifest setting)
DESCRIPTION: Enable labels for data fields rendered inside a FieldGroup cell by adding controlConfiguration column settings in manifest.json. The key format: "DataFieldForAnnotation::FieldGroup::<qualifier>".
LANGUAGE: JSON
CODE:
```json
"controlConfiguration": {
   "@com.sap.vocabularies.UI.v1.LineItem": {
      "columns": {
         "DataFieldForAnnotation::FieldGroup::myFieldGroup": {
            "showDataFieldsLabel": true
         }
      }
   }
}
```

STEP: Merge single TextArea label with section title (manifest setting)
DESCRIPTION: When a FieldGroup contains only one MultiLineText property, hide the TextArea label and use the section/subsection title instead. Add useSingleTextAreaFieldAsNotes = true at section level under the target route/options in manifest.json. Ensure accessibility: TextArea must have a meaningful label (screen readers).
LANGUAGE: JSON
CODE:
```json
"sap.ui5": {
  "routing": {
    "targets": {
      "SalesOrderManageObjectPage": {
        "options": {
          "settings": {
            "content": {
              "body": {
                "sections": {
                  "ReferenceFacet1": {
                    "useSingleTextAreaFieldAsNotes": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Create checkbox groups inside a FieldGroup (nested FieldGroup)
DESCRIPTION: Group Boolean properties under a shared label by creating a nested FieldGroup (FieldGroup includes DataFieldForAnnotation that targets CheckBoxGroup). Only Boolean properties allowed inside the checkbox group; header forms, filter bars, and tables are not supported. FieldControl must be provided (ABAP Behavior or CAP Common.FieldControl).
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="GeneralInformation">
    <Record Type="UI.FieldGroupType">
        <PropertyValue Property="Label" String="Line item data"/>
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataFieldForAnnotation">
                    <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#CheckBoxGroup"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>

<Annotation Term="UI.FieldGroup" Qualifier="CheckBoxGroup">
    <Record Type="UI.FieldGroupType">
        <PropertyValue Property="Label" String="Standard CheckBoxGroup"/>
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="Boolean1"/>
                    <PropertyValue Property="Label" String="Checkbox One"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="Boolean2"/>
                    <PropertyValue Property="Label" String="Checkbox Two"/>
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="Boolean3"/>
                    <PropertyValue Property="Label" String="Checkbox Three"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>

<Annotations Target="sap.fe.core.FieldGroup.Products/Boolean1">
    <Annotation Term="Common.FieldControl" Int="7"/>
</Annotations>

<Annotations Target="sap.fe.core.FieldGroup.Products/Boolean3">
    <Annotation Term="Common.FieldControl">
        <If>
                <Path>Boolean2</Path>
                <Int>0</Int>
                <Int>3</Int>
        </If>
    </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
" In metadata extension for the entity containing Boolean fields:
@UI: {
    fieldGroup: [
        { qualifier: 'GeneralInformation', type: #AS_FIELDGROUP, valueQualifier: 'CheckBoxGroup', position: 10, label: 'CheckBox Group Label' },
        { qualifier: 'CheckBoxGroup', position: 10, label: 'Checkbox One' }
    ]
}
Boolean1;

@UI: {
    fieldGroup: [
        { qualifier: 'CheckBoxGroup', position: 20, label: 'Checkbox Two'  }
    ]
}
Boolean2;

@UI: {
    fieldGroup: [
        { qualifier: 'CheckBoxGroup', position: 30, label: 'Checkbox Three'  }
    ]
}
Boolean3;
```

LANGUAGE: CAP CDS
CODE:
```cql
Boolean1            : Boolean @Common.FieldControl: #Mandatory;
Boolean2            : Boolean;
Boolean3            : Boolean @Common.FieldControl: (Boolean2 ? 0 : 3);

FieldGroup #CheckBoxGroup: {
    $Type: 'UI.FieldGroupType',
    Label: 'CheckBox Group Label',
    Data : [
        {
            $Type: 'UI.DataField',
            Value: Boolean1,
            Label: 'Checkbox One'
        },
        {
            $Type: 'UI.DataField',
            Value: Boolean2,
            Label: 'Checkbox Two'
        },
        {
            $Type: 'UI.DataField',
            Value: Boolean3, 
            Label: 'Checkbox Three'
        }
    ]
},

FieldGroup #GeneralInformation: {
    Label: 'Line item data',
    Data : [
    {
        $Type : 'UI.DataFieldForAnnotation',
        Target: '@UI.FieldGroup#CheckBoxGroup'
    }
    ]
}
```

STEP: Horizontal layout for checkbox group (manifest)
DESCRIPTION: To align checkbox boxes horizontally, set horizontalLayout = true on the subsection entry in manifest.json under the section definition for the FieldGroup qualifier.
LANGUAGE: JSON
CODE:
```json
"options": {
  "settings": {
    "entitySet": "Products",
    "content": {
      "body": {
        "sections": {
          "@com.sap.vocabularies.UI.v1.FieldGroup#CheckBoxGroups": {
            "subSections": {
              "@com.sap.vocabularies.UI.v1.FieldGroup#CheckBoxGroupH1": {
                "horizontalLayout": true
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Final restrictions and best practices (quick checklist)
DESCRIPTION: Keep these actionable restrictions in mind:
- UI.FieldGroup is not supported in GridTable, TreeTable, and AnalyticalTable.
- ConnectedFields can only be configured in sections that belong to a form (not header sections).
- If no HeaderFacet or HeaderInfo images exist, expand/collapse and pin buttons are hidden in the object page header.
- If a subsection contains a single group and the subsection title equals the group title, the group title is hidden.
- For multiple DataFieldForAction buttons inside a FieldGroup in a table, omit a column label to avoid rendering a column header.
LANGUAGE: JSON
CODE:
```json
{
  "bestPractices": [
    "Use FieldGroup qualifiers consistently across UI.Facets and UI.LineItem",
    "Provide FieldControl for Boolean fields (ABAP behavior or @Common.FieldControl in CAP)",
    "Test FieldGroup behavior in object page and responsive table variants",
    "Ensure accessible labels when hiding TextArea labels (useSingleTextAreaFieldAsNotes)"
  ]
}
```
--------------------------------

**TITLE**: Grouping Fields with UI.FieldGroup and UI.ConnectedFields (Fiori Elements)

**INTRODUCTION**: This document gives concise, actionable annotation and manifest examples to group fields in SAP Fiori Elements apps. It covers: UI.FieldGroup for forms and tables, linking FieldGroups in facets and line items, semantically connected fields (ConnectedFields) for OData V2/V4, manifest.json settings for field-group table behavior and TextArea label merging, and checkbox-group configuration. Use these code snippets directly in annotation files, CDS definitions, or manifest.json.

**TAGS**: fiori-elements-framework, UI.FieldGroup, ConnectedFields, UI.Facets, LineItem, DataFieldForAnnotation, OData V2, OData V4, ABAP CDS, CAP CDS, XML, manifest.json

STEP: 1 — Define a FieldGroup (Object Page / Form)
DESCRIPTION: Create a UI.FieldGroup qualifier (example: "Dimensions") that collects multiple DataFields. Use these definitions in XML annotation files, ABAP CDS metadata extensions, or CAP CDS service annotations.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation: UI.FieldGroup Qualifier "Dimensions" -->
<Annotation Term="UI.FieldGroup" Qualifier="Dimensions">
  <Record>
    <PropertyValue Property="Label" String="Dimensions"/>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="BaseUnit"/></Record>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Height"/></Record>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Width"/></Record>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Depth"/></Record>
        <Record Type="UI.DataField"><PropertyValue Property="Value" Path="Weight"/></Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
" ABAP CDS: annotate fields to belong to fieldGroup qualifier 'Dimensions'
@UI.fieldGroup: [
  { type: #STANDARD, position: 1, qualifier: 'Dimensions', groupLabel: 'Dimensions' }
]
BaseUnit;

@UI.fieldGroup: [ { type: #STANDARD, position: 2, qualifier: 'Dimensions' } ]
Height;

@UI.fieldGroup: [ { type: #STANDARD, position: 3, qualifier: 'Dimensions' } ]
Width;

@UI.fieldGroup: [ { type: #STANDARD, position: 4, qualifier: 'Dimensions' } ]
Depth;

@UI.fieldGroup: [ { type: #STANDARD, position: 5, qualifier: 'Dimensions' } ]
Weight;
```

LANGUAGE: CAP CDS
CODE:
```cds
// CAP CDS: UI.FieldGroup #Dimensions
UI.FieldGroup #Dimensions : {
  $Type : 'UI.FieldGroupType',
  Label : 'Dimensions',
  Data : [
    { $Type : 'UI.DataField', Value : BaseUnit },
    { $Type : 'UI.DataField', Value : Height },
    { $Type : 'UI.DataField', Value : Width },
    { $Type : 'UI.DataField', Value : Depth },
    { $Type : 'UI.DataField', Value : Weight }
  ]
}
```

STEP: 2 — Reference FieldGroup in UI.Facets (Object Page form section)
DESCRIPTION: Create a ReferenceFacet under UI.Facets that targets the FieldGroup qualifier to render the grouped fields as a form/subsection on the object page.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation: UI.Facets with ReferenceFacet pointing to UI.FieldGroup#Dimensions -->
<Annotation Term="UI.Facets">
  <Collection>
    <Record Type="UI.ReferenceFacet">
      <PropertyValue Property="Label" String="Dimensions" />
      <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#Dimensions"/>
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.Facet: [
  {
    label: 'Dimensions',
    targetQualifier: 'Dimensions',
    type: #FIELDGROUP_REFERENCE,
    purpose: #STANDARD
  }
]
" Attach to the entity or metadata extension where relevant
```

LANGUAGE: CAP CDS
CODE:
```cds
// CAP CDS: Reference facet pointing to FieldGroup #Dimensions
UI.Facets : [
  {
    $Type : 'UI.ReferenceFacet',
    Label : 'Dimensions',
    Target : '@UI.FieldGroup#Dimensions'
  }
]
```

STEP: 3 — Use FieldGroup inside a Table LineItem (DataFieldForAnnotation)
DESCRIPTION: Add a UI.DataFieldForAnnotation inside UI.LineItem that targets a UI.FieldGroup qualifier. This renders multiple fields stacked inside a single table cell. Ensure you omit a Label on the DataFieldForAnnotation if you want no column header (useful when including action buttons).
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation: LineItem linking to UI.FieldGroup#FieldGroup1 -->
<Annotation Term="UI.LineItem">
  <Collection>
    ...
    <Record Type="UI.DataFieldForAnnotation">
      <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#FieldGroup1" />
      <PropertyValue Property="Label" String="Type Information"/>
    </Record>
    ...
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [
  {
    label: 'Type Information',
    type: #AS_FIELDGROUP,
    valueQualifier: 'FieldGroup1'
  }
]
producttype;
```

LANGUAGE: CAP CDS
CODE:
```cds
// CAP CDS: LineItem Points to FieldGroup
UI.LineItem : [
  {
    $Type : 'UI.DataFieldForAnnotation',
    Target : '@UI.FieldGroup#FieldGroup1',
    Label : 'Type Information'
  }
]
```

STEP: 4 — Define FieldGroup used in a Table (with action)
DESCRIPTION: Define a FieldGroup with a DataField and a DataFieldForAction (example shows a dummy action). Use the same qualifier referenced by LineItem.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation: UI.FieldGroup qualifier FieldGroup1 containing a DataField and a DataFieldForAction -->
<Annotation Term="UI.FieldGroup" Qualifier="FieldGroup1">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="ContractType"/>
        </Record>
        <Record Type="UI.DataFieldForAction">
          <PropertyValue Property="Label" String="Dummy Button"/>
          <PropertyValue Property="Action" String="com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.fieldGroup: [ { type: #STANDARD, position: 1, qualifier: 'FieldGroup1' } ]
ContractType;

@UI.fieldGroup: [
  {
    label: 'Dummy Button',
    dataAction: 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2',
    type: #FOR_ACTION,
    position: 2,
    qualifier: 'FieldGroup1'
  }
]
contractName;
```

LANGUAGE: CAP CDS
CODE:
```cds
// CAP CDS: FieldGroup #FieldGroup1 with action
UI.FieldGroup #FieldGroup1 : {
  Data : [
    { $Type: 'UI.DataField', Value: ContractType },
    {
      $Type: 'UI.DataFieldForAction',
      Label: 'Dummy Button',
      Action: 'com.sap.gateway.srvd.sadl_gw_appmusicdr_definition.v0001.SOME_ACTION_2'
    }
  ]
}
```

STEP: 5 — Semantically Connected Fields (ConnectedFields) — OData V2 example
DESCRIPTION: Use com.sap.vocabularies.UI.v1.ConnectedFields (qualifier) to show multiple properties as a single display (template). Then reference that ConnectedFields annotation using DataFieldForAnnotation inside a FieldGroup.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation (OData V2): ConnectedFields example with template -->
<Annotation Term="com.sap.vocabularies.UI.v1.ConnectedFields" Qualifier="ConnectedDateTime">
  <Record>
    <PropertyValue Property="Data">
      <Record>
        <PropertyValue Property="SalesOrderDate">
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Value" Path="SalesOrderDate"/>
          </Record>
        </PropertyValue>
        <PropertyValue Property="SalesOrderTime">
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Value" Path="TrialTOD"/>
          </Record>
        </PropertyValue>
      </Record>
    </PropertyValue>
    <PropertyValue Property="Label" String="Connected DateTime"/>
    <PropertyValue Property="Template" String="{SalesOrderDate} / {SalesOrderTime}"/>
  </Record>
</Annotation>

<!-- Then include the ConnectedFields inside a FieldGroup via DataFieldForAnnotation -->
<Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup" Qualifier="OrderData">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
          <PropertyValue Property="Target" AnnotationPath="@UI.ConnectedFields#ConnectedDateTime"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 6 — Semantically Connected Fields (OData V4) — XML/ABAP/CAP examples
DESCRIPTION: For OData V4, use SAP__UI.ConnectedFields (or UI.ConnectedFieldsType) with Template and Data dictionary entries. Reference via UI.DataFieldForAnnotation inside UI.FieldGroup.
LANGUAGE: XML
CODE:
```xml
<!-- OData V4: FieldGroup referencing ConnectedFields -->
<Annotation Term="UI.FieldGroup" Qualifier="OrderData">
  <Record Type="UI.FieldGroupType">
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataFieldForAnnotation">
          <PropertyValue Property="Target" AnnotationPath="@UI.ConnectedFields#ConnectedOrderDates"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>

<Annotation Term="SAP__UI.ConnectedFields" Qualifier="ConnectedOrderDates">
  <Record>
    <PropertyValue Property="Label" String="Order / Delivery"/>
    <PropertyValue Property="Template" String="{OrderDate}/{DeliveryDate}"/>
    <PropertyValue Property="Data">
      <Record Type="Core.Dictionary">
        <PropertyValue Property="OrderDate">
          <Record Type="SAP__UI.DataField"><PropertyValue Property="Value" Path="OrderDate"/></Record>
        </PropertyValue>
        <PropertyValue Property="DeliveryDate">
          <Record Type="SAP__UI.DataField"><PropertyValue Property="Value" Path="DeliveryDate"/></Record>
        </PropertyValue>
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
" ABAP CDS: annotate connected fields with qualifier ConnectedOrderDates
annotate view SALESORDER with {
  @UI: {
    identification: [ { type: #AS_CONNECTED_FIELDS, valueQualifier: 'ConnectedOrderDates' } ],
    connectedFields: [
      { name: 'OrderDate', qualifier: 'ConnectedOrderDates', template: '{OrderDate}/{DeliveryDate}', groupLabel: 'Order / Delivery' }
    ]
  }
  OrderDate;

  @UI: { connectedFields: [ { name: 'DeliveryDate', qualifier: 'ConnectedOrderDates' } ] }
  DeliveryDate;
}
```

LANGUAGE: CAP CDS
CODE:
```cds
// CAP CDS: ConnectedFields and FieldGroup referencing it
annotate SalesOrderService.SalesOrder with @UI : {
  FieldGroup #OrderData : {
    Data : [ { $Type : 'UI.DataFieldForAnnotation', Target: '@UI.ConnectedFields#ConnectedOrderDates' } ]
  },
  ConnectedFields #ConnectedOrderDates: {
    $Type   : 'UI.ConnectedFieldsType',
    Label   : 'Order / Delivery',
    Template: '{OrderDate}/{DeliveryDate}',
    Data    : {
      $Type        : 'Core.Dictionary',
      OrderDate    : { $Type : 'UI.DataField', Value : OrderDate },
      DeliveryDate : { $Type : 'UI.DataField', Value : DeliveryDate }
    }
  }
}
```

STEP: 7 — OData V4: Show labels of fields inside FieldGroup in table column (manifest)
DESCRIPTION: To show the labels of each field inside a FieldGroup rendered within a table column, set controlConfiguration for the specific LineItem column key. Replace the example key with the computed column key found for the LineItem (see app-specific anchor keys).
LANGUAGE: JSON
CODE:
```json
// manifest.json: enable showing data field labels within a FieldGroup column (OData V4)
{
  "sap.ui5": {
    "controlConfiguration": {
      "@com.sap.vocabularies.UI.v1.LineItem": {
        "columns": {
          "DataFieldForAnnotation::FieldGroup::myFieldGroup": {
            "showDataFieldsLabel": true
          }
        }
      }
    }
  }
}
```

STEP: 8 — Merge TextArea label with Section/Subsection title (manifest)
DESCRIPTION: Hide the TextArea label when a FieldGroup has a single UI.MultiLineText-only control by configuring useSingleTextAreaFieldAsNotes at the section level in manifest.json. This setting applies section-wide.
LANGUAGE: JSON
CODE:
```json
// manifest.json: set useSingleTextAreaFieldAsNotes for a specific reference facet/section
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "ReferenceFacet1": {
                      "useSingleTextAreaFieldAsNotes": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 9 — Checkbox Groups inside a FieldGroup (XML, ABAP CDS, CAP CDS)
DESCRIPTION: Configure nested FieldGroup(s) to render a group of Boolean fields as a checkbox group. Only Boolean properties allowed. Not supported in header forms, filter bars, or tables. Define FieldControl behavior for dynamic visibility/mandatory behavior.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation: Parent FieldGroup includes an inner FieldGroup (CheckBoxGroup) -->
<Annotation Term="UI.FieldGroup" Qualifier="GeneralInformation">
  <Record Type="UI.FieldGroupType">
    <PropertyValue Property="Label" String="Line item data"/>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataFieldForAnnotation">
          <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#CheckBoxGroup"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>

<Annotation Term="UI.FieldGroup" Qualifier="CheckBoxGroup">
  <Record Type="UI.FieldGroupType">
    <PropertyValue Property="Label" String="Standard CheckBoxGroup"/>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="Boolean1"/><PropertyValue Property="Label" String="Checkbox One"/>
        </Record>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="Boolean2"/><PropertyValue Property="Label" String="Checkbox Two"/>
        </Record>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="Boolean3"/><PropertyValue Property="Label" String="Checkbox Three"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>

<!-- Optional: FieldControl annotations for dynamic behavior -->
<Annotations Target="sap.fe.core.FieldGroup.Products/Boolean1">
  <Annotation Term="Common.FieldControl" Int="7"/>
</Annotations>
<Annotations Target="sap.fe.core.FieldGroup.Products/Boolean3">
  <Annotation Term="Common.FieldControl">
    <If>
      <Path>Boolean2</Path>
      <Int>0</Int>
      <Int>3</Int>
    </If>
  </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
" ABAP CDS: metadata extension for Boolean checkboxes grouped in qualifier CheckBoxGroup
@UI: {
  fieldGroup: [
    { qualifier: 'GeneralInformation', type: #AS_FIELDGROUP, valueQualifier: 'CheckBoxGroup', position: 10, label: 'CheckBox Group Label' },
    { qualifier: 'CheckBoxGroup', position: 10, label: 'Checkbox One' }
  ]
}
Boolean1;

@UI: { fieldGroup: [ { qualifier: 'CheckBoxGroup', position: 20, label: 'Checkbox Two' } ] }
Boolean2;

@UI: { fieldGroup: [ { qualifier: 'CheckBoxGroup', position: 30, label: 'Checkbox Three' } ] }
Boolean3;
```

LANGUAGE: CAP CDS
CODE:
```cds
// CAP CDS: Boolean fields with FieldControl and FieldGroup definitions
Boolean1 : Boolean @Common.FieldControl: #Mandatory;
Boolean2 : Boolean;
Boolean3 : Boolean @Common.FieldControl: (Boolean2 ? 0 : 3);

FieldGroup #CheckBoxGroup: {
  $Type: 'UI.FieldGroupType',
  Label: 'CheckBox Group Label',
  Data : [
    { $Type: 'UI.DataField', Value: Boolean1, Label: 'Checkbox One' },
    { $Type: 'UI.DataField', Value: Boolean2, Label: 'Checkbox Two' },
    { $Type: 'UI.DataField', Value: Boolean3, Label: 'Checkbox Three' }
  ]
},

FieldGroup #GeneralInformation: {
  Label: 'Line item data',
  Data : [
    { $Type : 'UI.DataFieldForAnnotation', Target: '@UI.FieldGroup#CheckBoxGroup' }
  ]
}
```

STEP: 10 — Checkbox Group Horizontal Layout (manifest)
DESCRIPTION: To align checkboxes horizontally, enable horizontalLayout at the subsection level in manifest.json (provide the correct section/subSection id that matches your FieldGroup).
LANGUAGE: JSON
CODE:
```json
// manifest.json: enable horizontal layout for a checkbox group subsection
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "@com.sap.vocabularies.UI.v1.FieldGroup#CheckBoxGroups": {
                      "subSections": {
                        "@com.sap.vocabularies.UI.v1.FieldGroup#CheckBoxGroupH1": {
                          "horizontalLayout": true
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 11 — Important Notes & Restrictions (Actionable)
DESCRIPTION: Keep these constraints in mind when implementing:
- UI.FieldGroup is not supported in grid tables, tree tables, and analytical tables — use only in responsive/simple tables or object page forms.
- If all grouped fields are hidden, the FieldGroup container is hidden automatically.
- If a subsection contains exactly one group and the subsection title equals the group title, the group title is hidden.
- If no HeaderFacet and HeaderInfo has no images, expand/collapse and pin buttons are hidden from object page header.
- For multiple DataFieldForAction buttons inside a FieldGroup rendered in a table, avoid specifying Label on the DataFieldForAnnotation to prevent column header rendering.
- ConnectedFields can only be used inside form sections (not header sections).
- Checkbox groups: only Boolean properties allowed; not supported in header forms/filter bars/tables; dynamic instantiation not supported. For mandatory "at least one selected" behavior use MultiComboBox instead.

Use the code blocks above directly in your annotation files, CDS metadata extensions, or manifest.json.
--------------------------------

**TITLE**: Handling Inconsistent Input in SAP Fiori Elements Apps (Draft and Non-Draft)

**INTRODUCTION**: Practical, code-focused guidance to detect and block saves/activations when the UI contains technical inconsistencies (parse/format errors or length violations). Includes minimal XML control examples and controller code patterns to detect value-state errors, show a blocking message, and prevent Save/Activate/Apply operations. Covers both draft-enabled apps and non-draft apps (OData V2 behavior).

**TAGS**: sapui5, fiori-elements, validation, draft, save, activate, ODataV2, message

STEP: 1 — Identify technical inconsistencies on the UI
DESCRIPTION: Technical inconsistencies are UI-level parse/format/length errors (controls in error value state). Implement a reusable check that inspects a defined set of inputs (or all known editable controls) and gathers controls whose valueState === "Error" (use getValueState() and getValueStateText()).
LANGUAGE: JavaScript
CODE:
```javascript
// Controller: minimal helper to detect technical inconsistencies
// Maintain a list of input control IDs that must be validated before save/apply.
const TECHNICAL_FIELDS = [
  "inputNumber",    // e.g., sap.m.Input bound to a numeric property
  "inputShortText", // e.g., sap.m.Input with maxLength
  "inputDate"       // etc.
];

function getTechnicalErrors(oController) {
  const errors = [];
  TECHNICAL_FIELDS.forEach((sId) => {
    const oControl = oController.byId(sId);
    if (!oControl || typeof oControl.getValueState !== "function") {
      return;
    }
    const sState = oControl.getValueState && oControl.getValueState();
    if (sState === "Error") {
      const sText = oControl.getValueStateText ? oControl.getValueStateText() : "";
      errors.push({
        id: sId,
        control: oControl,
        message: sText || `Technical format/length error in ${sId}`
      });
    }
  });
  return errors; // array of {id, control, message}
}
```

STEP: 2 — Block Save / Activate in draft-enabled apps
DESCRIPTION: Before activating a draft (or saving the draft), call the technical-error checker. If errors exist, show a blocking message (explicitly referencing technical inconsistencies), list the field errors, and prevent the activation/save flow. This is required both for general Save/Activate and when the user clicks Apply in subobject pages.
LANGUAGE: JavaScript
CODE:
```javascript
// Example onSaveAttempt handler in the controller
onSaveAttempt: function () {
  const aErrors = getTechnicalErrors(this);
  if (aErrors.length > 0) {
    // Build a succinct blocking message listing technical errors
    const sDetail = aErrors.map(e => `- ${e.message}`).join("\n");
    sap.m.MessageBox.error(
      "Resolve the technical input errors before saving or activating the draft.\n\n" + sDetail,
      {
        title: "Technical Input Errors",
        actions: [sap.m.MessageBox.Action.CLOSE]
      }
    );
    // Prevent save/activate - return or reject promise depending on flow
    return Promise.reject(new Error("Blocked due to technical input errors"));
  }
  // Proceed with draft activation/save
  return this._proceedWithSaveOrActivate();
}
```

STEP: 3 — Block Apply on subobject pages (draft-enabled)
DESCRIPTION: The Apply action must ensure UI and draft contents are identical; reuse the same technical-error check. If there are technical inconsistencies, block Apply and show the same message.
LANGUAGE: JavaScript
CODE:
```javascript
// Example onApply handler in subobject page
onApply: function () {
  const aErrors = getTechnicalErrors(this);
  if (aErrors.length > 0) {
    const sDetail = aErrors.map(e => `- ${e.message}`).join("\n");
    sap.m.MessageBox.error(
      "Resolve the technical input errors before applying changes.\n\n" + sDetail,
      { title: "Technical Input Errors" }
    );
    return;
  }
  // Proceed with Apply logic
  this._applyChanges();
}
```

STEP: 4 — Non-draft apps (SAP Fiori Elements for OData V2)
DESCRIPTION: For non-draft apps, the same blocking behavior applies before saving the object. Detect technical inconsistencies and block the save until all are resolved.
LANGUAGE: JavaScript
CODE:
```javascript
// onSave handler for non-draft apps
onSaveObject: function () {
  const aErrors = getTechnicalErrors(this);
  if (aErrors.length > 0) {
    const sDetail = aErrors.map(e => `- ${e.message}`).join("\n");
    sap.m.MessageBox.error(
      "Resolve the technical input errors before saving the object.\n\n" + sDetail,
      { title: "Technical Input Errors" }
    );
    return;
  }
  // No technical errors -> proceed to persist the object via OData
  this._saveToBackend();
}
```

STEP: 5 — Example XML input controls that can cause technical inconsistencies
DESCRIPTION: Example Fiori Elements view fragments / control definitions with typical constraints (number type, maxLength). Use standard sap.m.Input properties so controls can present valueState errors.
LANGUAGE: XML
CODE:
```xml
<!-- Example XML fragment: inputs that can produce technical errors -->
<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns="sap.m">
  <Page>
    <content>
      <VBox>
        <!-- Numeric input: entering non-numeric chars -> parser error / value state -->
        <Input id="inputNumber" type="Number" value="{/SomeNumber}" placeholder="Enter number" />

        <!-- Max length: entering more characters than allowed -->
        <Input id="inputShortText" value="{/ShortText}" maxLength="10" placeholder="Max 10 chars" />

        <!-- Date input (example) -->
        <DatePicker id="inputDate" value="{/DateProperty}" displayFormat="yyyy-MM-dd" />
      </VBox>
    </content>
  </Page>
</mvc:View>
```

STEP: 6 — Message semantics and developer notes
DESCRIPTION: Important behavioral details to preserve in UI/UX and backend integration:
- The system message shown for blocking save/activate/apply must list only technical inconsistencies (parse/format/length). Do not include logical/business validation errors (e.g., non-existent business partner).  
- Logical/business validation errors are handled downstream and displayed as state messages when saving the object (not in the technical blocking message).  
- Ensure the list of controls checked includes all editable controls that can produce technical parse/format/length errors. Maintain TECHNICAL_FIELDS consistent with the view/controller.
LANGUAGE: JSON
CODE:
```json
{
  "notes": [
    "Technical inconsistencies = UI parse/format/length errors (valueState = Error).",
    "Logical/business errors are displayed as state messages when saving/persisting.",
    "Block Save/Activate/Apply when technical inconsistencies exist; show a clear message."
  ]
}
```

STEP: 7 — Integration tips for RAG/code-generation agents
DESCRIPTION: When generating code:
- Use the pattern above: maintain a list of control IDs (TECHNICAL_FIELDS) or derive them from the view metadata.  
- Reuse getTechnicalErrors() in all save/activate/apply entry points.  
- Return an explicit rejection or prevent the save flow when technical errors exist so higher-level activation/persistence logic is not executed.
LANGUAGE: JavaScript
CODE:
```javascript
// Example reuse pattern
onAnySaveEntryPoint: function () {
  return this.onSaveAttempt()
    .then(() => {
      // success path: proceed to backend save/activation
    })
    .catch(err => {
      // blocked due to technical input errors; err message can be logged or surfaced
      console.warn(err && err.message);
    });
}
```
--------------------------------

**TITLE**: preferredMode startup parameter — configure Object Page launch modes (create / edit / display / callUnboundAction)

**INTRODUCTION**: This document provides concise, code-focused recipes for using the preferredMode startup/URL parameter in SAP Fiori Elements apps (OData V2 and V4). It collects example URLs, manifest.json fragments, Component.js startup configuration, and OData metadata (FunctionImport) snippets you need to enable:
- launching the object page in create/edit/display modes
- pre-filling create dialogs via inboundParameters.useForCreate
- invoking unbound actions on navigation (callUnboundAction)
- using createWith / autoCreateWith on OData V4

Use these snippets directly in your manifest.json, Component.js and metadata.xml and replicate the example URLs when testing.

**TAGS**: preferredMode, manifest.json, inboundParameters, useForCreate, callUnboundAction, NewAction, createWith, autoCreateWith, ODataV2, ODataV4, Component.js, URL

STEP: 1 — preferredMode values and quick behavior mapping

DESCRIPTION: Reference mapping of accepted preferredMode parameter values and their resulting behavior. Use this mapping to choose the correct value in URL/startup parameters and to decide which manifest/metadata changes are required.

LANGUAGE: JSON

CODE:
```json
{
  "preferredModeMappings": {
    "display": "Open object page in display mode unless user already has a draft -> then open draft in edit mode.",
    "edit": "Open object page in edit mode (creates a draft if none exists). If another user's draft exists and is outdated, user may replace it; otherwise page opens read-only.",
    "create": "Open Create Object Page. For draft-enabled apps default is POST-based draft creation; URL parameters can prefill fields only if declared with inboundParameters.useForCreate. For NewAction-based create, use action parameter dialog (useForCreate ignored).",
    "callUnboundAction": "Trigger a specified unbound action at app start. The source app passes myActionName and inbound parameter values in the URL. Target app must expose action mappings in manifest and define FunctionImport(s) in service metadata."
  }
}
```

STEP: 2 — preferredMode=create using URL (POST / draft-based create) and manifest inboundParameters.useForCreate

DESCRIPTION: To start the object page in create mode from an external link, append preferredMode=create to the launch URL. To pass values into the POST-based create call, declare each accepted parameter in the target app's manifest.json under sap.ui.generic.app.settings.inboundParameters with useForCreate: true. Only declared parameters are forwarded to the backend for POST-based create.

LANGUAGE: JSON

CODE:
```json
// Example external URL (launches create mode and passes DefectCategory=01)
"#Defect-displayWorklist?preferredMode=create&DefectCategory=01"

// manifest.json fragment (target application) - enable DefectCategory for use in create POST
{
  "sap.ui.generic.app": {
    "_version": "1.2.0",
    "settings": {
      "inboundParameters": {
        "DefectCategory": {
          "useForCreate": true
        }
      }
    }
  }
}
```

STEP: 3 — preferredMode=create for NewAction-based create (OData V2/V4): URL behavior and differences

DESCRIPTION: When the target app uses a NewAction function import (NewAction-based create), incoming navigation context values are applied to action parameters shown in the action parameter dialog. The manifest useForCreate setting is ignored for NewAction-based create. Hidden fields configured in the action dialog still receive values from the navigation context.

LANGUAGE: JSON

CODE:
```json
// Example external URL for NewAction-based create
"#SalesOrder-manage?preferredMode=create&SalesOrderType=OR&Supplier=ABC"

// Note: For NewAction-based create, SalesOrderType and Supplier values are passed into the action parameter dialog
// only if the action parameters have matching technical names. useForCreate in manifest.json is NOT used here.
```

STEP: 4 — callUnboundAction (OData V2): manifest mapping, metadata FunctionImport, and example URL

DESCRIPTION: Configure the target app to resolve logical action names to FunctionImport names via sap.ui.generic.app.settings.inboundParameters and useForActionResolution. Define the corresponding FunctionImport(s) in the service metadata (metadata.xml). The source app launches the target with preferredMode=callUnboundAction and passes myActionName plus inbound parameters in the URL.

LANGUAGE: JSON

CODE:
```json
// manifest.json fragment (target application) - map a logical action name to function import(s)
{
  "sap.ui.generic.app": {
    "_version": "1.2.0",
    "settings": {
      "inboundParameters": {
        "myActionName": {
          "useForActionResolution": {
            "myCreateWithNameAndStreet": "myCreate1",
            "myCreateWithoutNameAndStreet": "myCreate3"
          }
        }
      }
    }
  }
}
```

LANGUAGE: XML

CODE:
```xml
<!-- metadata.xml fragment: define FunctionImport(s) that perform create behavior -->
<FunctionImport Name="myCreate1" ReturnType="cds_zvd_drafts_customer_sd.CustomerType" EntitySet="Customer" m:HttpMethod="POST">
  <Parameter Name="ResultIsActiveEntity" Type="Edm.Boolean" Mode="In" Nullable="true" sap:label="Result is active"/>
  <Parameter Name="Name" Type="Edm.String" Mode="In" MaxLength="40" Nullable="true" sap:label="Customer Name"/>
  <Parameter Name="Street" Type="Edm.String" Mode="In" MaxLength="40" Nullable="true" sap:label="Customer Street"/>
</FunctionImport>

<FunctionImport Name="myCreate3" ReturnType="cds_zvd_drafts_customer_sd.CustomerType" EntitySet="Customer" m:HttpMethod="POST">
  <Parameter Name="ResultIsActiveEntity" Type="Edm.Boolean" Mode="In" Nullable="true" sap:label="Result is active"/>
</FunctionImport>
```

LANGUAGE: TEXT

CODE:
```text
// Source app example URL that triggers callUnboundAction and passes inbound parameters
#NewActionTest-NewActionTest?preferredMode=callUnboundAction&myActionName=myCreate1&ResultIsActiveEntity=true&Name=myName
```

STEP: 5 — OData V4: createWith and autoCreateWith preferredMode values (manifest defaultValue)

DESCRIPTION: For OData V4, you can set preferredMode to call a specific action when opening in create mode:
- "createWith:FULL_ACTION_NAME" — triggers the action and shows action parameter dialog if parameters exist.
- "autoCreateWith:FULL_ACTION_NAME" — triggers the action and skips the dialog when all action parameters can be filled from navigation context; otherwise shows the dialog.

LANGUAGE: JSON

CODE:
```json
// manifest.json fragment (where you configure the default preferredMode value)
// Place this fragment under appropriate configuration scope in the app manifest (preserve your app structure).
{
  "preferredMode": {
    "defaultValue": {
      "value": "createWith:com.c_salesordermanage_sd.CreateWithSalesOrderType",
      "format": "value"
    }
  }
}

// For autoCreateWith:
{
  "preferredMode": {
    "defaultValue": {
      "value": "autoCreateWith:com.c_salesordermanage_sd.CreateWithSalesOrderType",
      "format": "value"
    }
  }
}
```

STEP: 6 — preferredMode=edit: startup parameter (Component.js) and URL usage

DESCRIPTION: Use preferredMode=edit (startup parameters or URL) to open a specific object page directly in edit mode (draft created if missing). You can configure as a startup parameter in Component.js or pass it in the URL with the key of the object.

LANGUAGE: JavaScript

CODE:
```javascript
// Component.js: return startup parameters programmatically (example)
sap.ui.define(["sap/fe/core/AppComponent"], function(AppComponent) {
  "use strict";

  return AppComponent.extend("FormTemplate.Component", {
    metadata: {
      manifest: "json"
    },
    getStartupParameters: function() {
      return Promise.resolve({
        preferredMode: ["edit"],
        ID: "1" // technical key (use the key name expected by the target object page)
      });
    }
  });
});
```

LANGUAGE: TEXT

CODE:
```text
// URL example: open item with ID=1 directly in edit mode
#Manage-items?preferredMode=edit&ID=1
```

STEP: 7 — manifest inboundParameters for object page routing context (example with SalesOrderType)

DESCRIPTION: Example manifest.json fragment under "options.settings" (some apps use this path) to show how inboundParameters are declared for object pages. Adjust to your app manifest structure (sap.ui.generic.app.settings or options.settings depending on your template and version).

LANGUAGE: JSON

CODE:
```json
// manifest.json fragment (example location: options.settings)
{
  "options": {
    "settings": {
      "contextPath": "/SalesOrderManage",
      "inboundParameters": {
        "SalesOrderType": {
          "useForCreate": true
        }
      }
    }
  }
}

// Example incoming URL:
// #SalesOrder-manage?preferredMode=create&SalesOrderType=OR&Supplier=ABC
// Result: Only SalesOrderType=OR is forwarded in POST create call; Supplier is ignored.
```

STEP: 8 — Important runtime notes and constraints (concise)

DESCRIPTION: Key operational notes to keep in mind when implementing preferredMode behavior.

LANGUAGE: TEXT

CODE:
```text
- No double navigation: if target app has no object page defined or internal navigation is overridden, the list report is shown instead.
- For POST-based create: only inboundParameters declared with "useForCreate": true in manifest are sent in the create call.
- For NewAction/NewAction-based create: action parameter dialog receives navigation context values matching technical parameter names; manifest.useForCreate is ignored.
- For createWith/autoCreateWith (V4): dialogs are skipped only when all parameters can be filled from the navigation context (autoCreateWith).
- If an app uses a custom view instead of the standard object page template, preferredMode=create via startup or URL may not open the object page as described; in that case the list report may be launched.
```


--------------------------------

**TITLE**: Handling Semantic Key Fields in Fiori Elements List Reports

**INTRODUCTION**: This guide explains how to declare semantic key fields for entities and how Fiori Elements renders them in list report tables (responsive and non-responsive). Includes annotation examples for XML OData annotations, ABAP CDS, and CAP CDS. Use these patterns when you want an ID/text pair to be treated as a semantic key in tables, object pages, and subobject pages.

**TAGS**: fiori-elements-framework, semantic-key, annotations, odata-v2, odata-v4, responsive-table, objectidentifier, cds, abap, cap

**STEP**: 1 — Add SemanticKey annotation to the entity

**DESCRIPTION**: Add the Common.SemanticKey annotation to the target entity. Provide the semantic key as a collection of PropertyPath elements (XML) or as a list in CDS/annotation syntax. This is supported for the default DataField in list report tables.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Place in your service annotation file. Replace Target with your entity. -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm"
             Target="STTA_PROD_MAN.STTA_C_MP_ProductType">
    <Annotation Term="Common.SemanticKey">
        <Collection>
            <PropertyPath>ProductForEdit</PropertyPath>
        </Collection>
    </Annotation>
</Annotations>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@ObjectModel: {
  semanticKey: [ 'ProductForEdit' ]   " declare semantic key in ABAP CDS
}
define view C_MP_PRODUCT {
  // view fields...
}
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductType @(
  Common.SemanticKey : [ ProductForEdit ]
);
```

**STEP**: 2 — Constraint: default DataField only

**DESCRIPTION**: The semantic key annotation is effective for the default DataField only. Ensure the field is exposed as the DataField used in the list report table column.

**LANGUAGE**: TEXT

**CODE**:
```
Note: SemanticKey applies only to the default DataField configuration for a column.
```

**STEP**: 3 — Rendering in responsive tables (ObjectIdentifier behavior)

**DESCRIPTION**: In responsive tables, Fiori Elements renders semantic keys using sap.m.ObjectIdentifier as follows:
- If both text and ID are available: first line shows the text (bold), second line shows the ID (regular).
- If only ID is available: the ID is shown in bold on the first line (no second line).
- If a semantic object link is attached to the field, ObjectIdentifier is NOT used; the ID is rendered as a link instead.

Include screenshots if needed: images/Semantic_Key_Fields_in_a_Table_Text_and_ID_d58b9d9.png

**LANGUAGE**: TEXT

**CODE**:
```
Responsive table rendering rules:
- text + id -> Line1: <text> (bold), Line2: <id>
- only id -> Line1: <id> (bold), no Line2
- if semantic object link present -> no ObjectIdentifier; ID rendered as a link
```

**STEP**: 4 — Rendering in other tables (grid/table) and TextArrangement differences

**DESCRIPTION**: In non-responsive tables (e.g., GridTable), Fiori Elements renders the semantic key as a label and displays the entire content in bold. It also reads and combines associated text according to the TextArrangement configuration. Default behaviors when no TextArrangement is configured:
- OData V2: display ID with text in parenthesis if text exists (ID (text)). If no text, display ID only.
- OData V4: display text only if text exists. If no text, display ID only.

Example: TextFirst arrangement will show text first then ID according to the configured TextArrangement.

Include screenshot reference: images/Semantic_Key_Fields_in_a_Table_TextFirst_40b9a46.png

**LANGUAGE**: TEXT

**CODE**:
```
Non-responsive table rendering rules:
- Entire content rendered bold (label style)
- If TextArrangement configured -> combine ID and text per arrangement
- If no TextArrangement:
  - OData V2 -> "ID (text)" when text exists; else "ID"
  - OData V4 -> "text" when text exists; else "ID"
```

**STEP**: 5 — Linking behavior differences

**DESCRIPTION**: When a semantic object/action is associated with the semantic key field:
- Responsive tables: ObjectIdentifier is not used; the ID is displayed as a link.
- Non-responsive tables: the entire content (ID and text) is displayed as a single link with no wrapping.

**LANGUAGE**: TEXT

**CODE**:
```
Linking behavior:
- Responsive: ID becomes a link (no ObjectIdentifier)
- Other tables: combined content (ID + text) becomes a single link (no wrapping)
```

**STEP**: 6 — Scope: object pages and subobject pages

**DESCRIPTION**: The semantic key rendering logic described above also applies to object pages and subobject pages in Fiori Elements for OData V4.

**LANGUAGE**: TEXT

**CODE**:
```
Scope: Applies to List Reports, Object Pages, and Subobject Pages (OData V4 behavior matches table rules).
```

**STEP**: 7 — Related resources

**DESCRIPTION**: See related documentation for configuring list report table behavior and manifest/annotation options.

**LANGUAGE**: TEXT

**CODE**:
```
Related: settings-for-list-report-tables-4c2d17a.md
Images referenced:
- images/Semantic_Key_Fields_in_a_Table_Text_and_ID_d58b9d9.png
- images/Semantic_Key_Fields_in_a_Table_TextFirst_40b9a46.png
```
--------------------------------

**TITLE**: Harvey Ball Micro Chart (HarveyBallMicroChart) — Annotation Examples for Fiori Elements

**INTRODUCTION**: Use the Harvey Ball Micro Chart to display a single measure value against a maximum value in Fiori Elements. This document contains minimal, explicit annotation examples (XML, ABAP CDS, CAP CDS) and a short checklist of required annotations for correct rendering and optional semantic coloring via Criticality.

**TAGS**: fiori-elements-framework, sapui5, harvey-ball, microchart, annotations, UI.Chart, UI.DataPoint, CDS, XML, ABAP, CAP

**STEP**: 1 — UI.Chart annotation (set chart metadata, measures, and reference DataPoint)
**DESCRIPTION**: Add a UI.Chart annotation with ChartType set to Pie, Title/Description for header and subtitle, Measures listing the measure property, and MeasureAttributes containing a DataPoint annotation reference. The DataPoint reference must be provided via AnnotationPath (e.g., "@UI.DataPoint"). This example uses the default (non-qualified) UI.DataPoint annotation.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.Chart" Qualifier="SpecificationWidthHarveyChart">
    <Record>
        <!-- Required: ChartType must be Pie -->
        <PropertyValue EnumMember="UI.ChartType/Pie" Property="ChartType" />

        <!-- Optional: Title / Subtitle -->
        <PropertyValue Property="Title" String="Sold to Produced Harvey Chart" />
        <PropertyValue Property="Description" String="Harvey Chart" />

        <!-- Required: Measures list (single measure for Harvey chart) -->
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>Sold</PropertyPath>
            </Collection>
        </PropertyValue>

        <!-- Required: MeasureAttributes must point to the UI.DataPoint -->
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <!-- Reference the UI.DataPoint annotation (default) -->
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.Chart: [
  {
    title: 'Sold to Produced Harvey Chart',
    description: 'Harvey Chart',
    chartType: #PIE,                " Required: #PIE (Harvey chart uses a single measure)
    measures: [
      'Sold'
    ],
    measureAttributes: [
      {
        measure: 'Sold',
        role: #AXIS_1,
        asDataPoint: true            " mark that this measure has a DataPoint
      }
    ],
    qualifier: 'SpecificationWidthHarveyChart'
  }
]
annotate view STTA_C_MP_PRODUCT with {
  "Note: UI.DataPoint annotation must be present for the Sold measure (see DataPoint step)"
}
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.Chart #SpecificationWidthHarveyChart : {
    ChartType : #Pie,                 // Required: #Pie
    Title : 'Sold to Produced Harvey Chart',
    Description : 'Harvey Chart',
    Measures : [
        Sold
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            DataPoint : '@UI.DataPoint' // Reference the UI.DataPoint annotation
        }
    ]
}
```

**STEP**: 2 — UI.DataPoint annotation (map Value, MaximumValue, optional Criticality)
**DESCRIPTION**: Define UI.DataPoint for the measure. Provide Value (the measure), MaximumValue (the scale/maximum), and optionally Criticality for semantic coloring. Criticality is the only supported semantic coloring property for HarveyBallMicroChart.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.DataPoint">
    <Record>
        <!-- Value = measure shown -->
        <PropertyValue Path="Sold" Property="Value" />

        <!-- MaximumValue = measure used as maximum / scale -->
        <PropertyValue Path="Produced" Property="MaximumValue" />

        <!-- Optional: use Criticality for semantic coloring -->
        <PropertyValue Path="criticalityValue" Property="Criticality" />
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS
**CODE**:
```abap
" Example: attach DataPoint definitions to the Sold element (inline example)
@UI.dataPoint: {
  criticality: 'criticalityValue',    " optional: semantic coloring
  maximumValue: 20                     " or specify numeric constant or path
}
Sold;
```

**LANGUAGE**: CAP CDS
**CODE**:
```cap
UI.DataPoint : {
    Value : Sold,                        // required: measure value
    MaximumValue : Produced,             // required: maximum value (path or constant)
    Criticality : criticalityValue       // optional: semantic coloring
}
```

**STEP**: 3 — Combined minimal XML example (Chart + DataPoint together)
**DESCRIPTION**: Complete minimal XML example showing both UI.Chart referencing UI.DataPoint and the UI.DataPoint annotation. Use this as a single-file example for metadata.xml.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- metadata.xml -->
<Annotations Target="YourService.YourEntityType">
    <!-- UI.DataPoint definition (default) -->
    <Annotation Term="UI.DataPoint">
        <Record>
            <PropertyValue Path="Sold" Property="Value" />
            <PropertyValue Path="Produced" Property="MaximumValue" />
            <PropertyValue Path="criticalityValue" Property="Criticality" />
        </Record>
    </Annotation>

    <!-- UI.Chart referencing the UI.DataPoint -->
    <Annotation Term="UI.Chart" Qualifier="SpecificationWidthHarveyChart">
        <Record>
            <PropertyValue EnumMember="UI.ChartType/Pie" Property="ChartType" />
            <PropertyValue Property="Title" String="Sold to Produced Harvey Chart" />
            <PropertyValue Property="Description" String="Harvey Chart" />
            <PropertyValue Property="Measures">
                <Collection>
                    <PropertyPath>Sold</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="MeasureAttributes">
                <Collection>
                    <Record Type="UI.ChartMeasureAttributeType">
                        <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint" />
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 4 — Mandatory checklist & rules
**DESCRIPTION**: Verify these required items for the Harvey Ball Micro Chart to render correctly:
**LANGUAGE**: JSON
**CODE**:
```json
{
  "required": [
    "UI.Chart -> ChartType must be Pie (UI.ChartType/Pie)",
    "UI.Chart -> Measures (single measure property)",
    "UI.Chart -> MeasureAttributes -> DataPoint (AnnotationPath to UI.DataPoint)",
    "UI.DataPoint -> MaximumValue (path or numeric)",
    "Optional: UI.DataPoint -> Criticality for semantic coloring (only Criticality supported)"
  ]
}
```


--------------------------------

**TITLE**: Header Facets in SAP Fiori Elements (Object Page)

**INTRODUCTION**: How to define and control header facets (UI.HeaderFacets / UI.ReferenceFacet) for Object Page headers in SAP Fiori Elements, including annotation examples (XML, ABAP CDS, CAP CDS), runtime behavior on desktop vs mobile, enabling carousel on desktop via manifest.json, and brief note about stashing for UI adaptation.

**TAGS**: fiori-elements-framework, object-page, header-facets, UI.HeaderFacets, UI.ReferenceFacet, annotations, manifest.json, carousel, stashing, ODataV2, ODataV4, ABAP, CDS, CAP

**STEP**: 1 — Define header facets using annotations

**DESCRIPTION**: Add UI.HeaderFacets which contains UI.ReferenceFacet records to define header elements shown in the object page header. Provide the annotation in your metadata/CDS/CAP model depending on your stack. Each ReferenceFacet references a DataPoint (or other target) via Target / AnnotationPath / targetQualifier / targetElement.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- XML Annotation -->
<Annotation Term="UI.HeaderFacets">
    <Collection>
        ...
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Price" />
        </Record>
        ...
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Target" AnnotationPath="to_StockAvailability/@UI.DataPoint#StockAvailability" />
        </Record>
        ...
    </Collection>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Facet: [
    {
        targetQualifier: 'Price',
        type: #DATAPOINT_REFERENCE,
        purpose: #HEADER
    },
    {
        targetQualifier: 'StockAvailability',
        targetElement: 'TO_STOCKAVAILABILITY',
        type: #DATAPOINT_REFERENCE,
        purpose: #HEADER
    }
]Test;
```

**LANGUAGE**: CAP CDS (Annotation block for service/entity)

**CODE**:
```javascript
Annotate c_salesordermanage_sd.SalesOrderManage with @(
    UI : {
        HeaderFacets : [
            {
                $Type  : 'UI.ReferenceFacet',
                Label  : 'Price',
                ID     : 'Price',
                Target : '@UI.DataPoint#Price'
            },
            {
                $Type  : 'UI.ReferenceFacet',
                Label  : 'Stock Availability',
                ID     : 'StockAvailability',
                Target : 'to_StockAvailability@UI.DataPoint#StockAvailability'
            }
        ]
    }
)
```

**STEP**: 2 — Understand runtime behavior (desktop vs mobile) and enable carousel on desktop

**DESCRIPTION**: By default:
- Desktop: dynamic or static header is used with the responsive layout.
- Mobile: header facets render inside a horizontal scroll container (horizontal layout) to enable scrolling through facets.

To enable a carousel-style header on desktop, set "showHeaderAsCarouselOnDesktop": true in the Object Page component settings in manifest.json. This setting must be specified at every relevant component level in manifest.json (each component entry in pages and nested pages).

**LANGUAGE**: JSON

**CODE**:
```json
/* manifest.json - enable carousel header on desktop (set at each component level) */
{
  "sap.ui.generic.app": {
    ...
    "pages": [
      {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "showHeaderAsCarouselOnDesktop": true,
            ...
          }
        },
        "pages": [
          {
            "navigationProperty": "to_ProductText",
            "entitySet": "STTA_C_MP_ProductText",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "showHeaderAsCarouselOnDesktop": true,
                ...
              }
            }
          }
        ]
      }
    ]
  }
}
```

**STEP**: 3 — Stashing header facets (SAP Fiori Elements for OData V4)

**DESCRIPTION**: You can mark header facets as stashed in your manifest.json so they are initially not visible and not loaded at application start. Key users can add stashed header facets at runtime through key user adaptation, making them visible for end users. Use your UI adaptation tool to define which header facets are stashed. For implementation details and runtime adaptation workflow, see the Adapting the UI documentation: adapting-the-ui-59bfd31.md

**LANGUAGE**: JSON (conceptual guidance)

**CODE**:
```json
/* Concept: declare header facets as "stashed" in manifest.json or via your adaptation tool
   Exact format depends on your adaptation/flexibility provider and framework version.
   These stashed facets will not be loaded at startup and can be made visible by key users. */
{
  /* Example placeholder - actual syntax varies by tooling/version */
  "sap.ui.generic.app": {
    ...
    "stashedHeaderFacets": [
      /* define references or IDs of header facets that should be stashed */
    ]
  }
}
```
--------------------------------

**TITLE**: Hiding UI Features with the UI.Hidden Annotation (Fiori Elements)

**INTRODUCTION**: Practical, code-focused reference for using the UI.Hidden annotation to hide or show UI pieces (facets, field groups, data fields, quick views, table columns, actions) in SAP Fiori elements apps. Includes XML, ABAP CDS, and CAP CDS examples and constraints for conditional/hard-coded hiding.

**TAGS**: fiori-elements-framework, UI.Hidden, annotations, OData V4, ABAP CDS, CAP CDS, XML, edmJSON

**STEP**: 1 — UI.Hidden basic forms and conditional expressions

**DESCRIPTION**: Use UI.Hidden with no value (defaults to true), Bool="false"/"true", or Path for boolean properties. For conditionals in OData V4, use edmJSON (If/Or/Eq) within the annotation. Path must point to a Boolean property; SAPUI5 expression binding is not supported.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Default: UI.Hidden with no value => hidden (true) -->
<Annotation Term="UI.Hidden"/>

<!-- Explicit static values -->
<Annotation Term="UI.Hidden" Bool="false"/> <!-- shown -->
<Annotation Term="UI.Hidden" Bool="true"/>  <!-- hidden -->

<!-- Path-based: hide when 'edit_mode' is true -->
<Annotation Term="UI.Hidden" Path="edit_mode"/>

<!-- OData V4: edmJSON conditional (If/Or/Eq) - hide when displayCriteria == value_A or value_B -->
<Annotation Term="UI.Hidden">
    <If>
        <Or>
            <Eq>
                <Path>displayCriteria</Path>
                <String>value_A</String>
            </Eq>
            <Eq>
                <Path>displayCriteria</Path>
                <String>value_B</String>
            </Eq>
        </Or>
    </If>
</Annotation>
```

**STEP**: 2 — Hide header facets on the Object Page (XML / ABAP CDS / CAP CDS)

**DESCRIPTION**: Hide individual header ReferenceFacet records via UI.Hidden. Use Bool static values or Path-based booleans to control visibility.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.HeaderFacets">
    <Collection>
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Net Amount" />
            <PropertyValue Property="ID" String="NetValueDataHeader" />
            <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#NetValue" />
            <Annotation Term="UI.Hidden" Bool="true" />
        </Record>
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Contact Info" />
            <PropertyValue Property="ID" String="ContactHeader" />
            <PropertyValue Property="Target" AnnotationPath="_SoldToParty/@Communication.Contact" />
            <Annotation Term="UI.Hidden" /> <!-- defaults to true -->
        </Record>
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Credit Limit Consumption" />
            <PropertyValue Property="ID" String="CreditLimitChartHeader" />
            <PropertyValue Property="Target" AnnotationPath="_CreditLimitDetails/@UI.Chart#CreditLimitChart" />
            <Annotation Term="UI.Hidden" Path="editActionIsEnabled" />
        </Record>
    </Collection>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Facet: [
  {
    hidden: true,
    label: 'Net Amount',
    id: 'NetValueDataHeader',
    targetQualifier: 'NetValue',
    type: #DATAPOINT_REFERENCE,
    purpose: #HEADER
  },
  {
    hidden: true,
    label: 'Contact Info',
    id: 'ContactHeader',
    targetElement: '_SOLDTOPARTY',
    type: #CONTACT_REFERENCE,
    purpose: #HEADER
  },
  {
    hidden: #('editActionIsEnabled'),
    label: 'Credit Limit Consumption',
    id: 'CreditLimitChartHeader',
    targetQualifier: 'CreditLimitChart',
    targetElement: '_CREDITLIMITDETAILS',
    type: #CHART_REFERENCE,
    purpose: #HEADER
  }
]
Test;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
HeaderFacets : [
  {
    $Type : 'UI.ReferenceFacet',
    Label : 'Net Amount',
    ID    : 'NetValueDataHeader',
    Target: '@UI.DataPoint#NetValue',
    ![@UI.Hidden]: true
  },
  {
    $Type : 'UI.ReferenceFacet',
    Label : 'Contact Info',
    ID    : 'ContactHeader',
    Target: '_SoldToParty/@Communication.Contact',
    ![@UI.Hidden]: true
  },
  {
    $Type : 'UI.ReferenceFacet',
    Label : 'Credit Limit Consumption',
    ID    : 'CreditLimitChartHeader',
    Target: '_CreditLimitDetails/@UI.Chart#CreditLimitChart',
    ![@UI.Hidden]: editActionIsEnabled
  }
]
```

**STEP**: 3 — Hide sections and subsections on the Object Page

**DESCRIPTION**: Apply UI.Hidden on CollectionFacet records to hide entire sections/subsections. To hide a subsection, annotate the subsection (or its content) with UI.Hidden.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.Facets">
    <Collection>
        <Record Type="UI.CollectionFacet">
            <PropertyValue Property="Label" String="Header" />
            <PropertyValue Property="ID" String="HeaderInfo" />
            <PropertyValue Property="Facets">
                <Collection>
                    <Record Type="UI.CollectionFacet">
                        <PropertyValue Property="ID" String="GeneralInfo" />
                        <PropertyValue Property="Label" String="General Information" />
                        <PropertyValue Property="Facets">
                            <Collection>
                                <!-- nested facets / details -->
                            </Collection>
                        </PropertyValue>
                        <Annotation Term="UI.Hidden" Bool="true" />
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Collection>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Facet: [
  {
    label: 'Header',
    id: 'HeaderInfo',
    type: #COLLECTION,
    purpose: #STANDARD
  },
  {
    hidden: true,
    id: 'GeneralInfo',
    label: 'General Information',
    parentId: 'HeaderInfo',
    purpose: #STANDARD
  }
]
Test;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
Facets : [
  {
    $Type : 'UI.CollectionFacet',
    Label : 'Header',
    ID    : 'HeaderInfo',
    Facets: [
      {
        $Type         : 'UI.CollectionFacet',
        ID            : 'GeneralInfo',
        Label         : 'General Information',
        Facets        : [
          /* nested facets */
        ],
        ![@UI.Hidden] : true
      }
    ]
  }
]
```

**STEP**: 4 — Hide content in Quick Views

**DESCRIPTION**: Annotate ReferenceFacet entries inside UI.QuickViewFacets (or their targeted FieldGroups) to hide quick view content. Use Bool or Path-based boolean.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.QuickViewFacets">
    <Collection>
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Material" />
            <PropertyValue Property="Target" AnnotationPath="@Communication.Contact" />
            <Annotation Term="UI.Hidden" Bool="true" />
        </Record>
        <Record Type="UI.ReferenceFacet">
            <PropertyValue Property="Label" String="Address" />
            <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SoldToQuickView" />
            <Annotation Term="UI.Hidden" Path="edit_Ac" />
        </Record>
    </Collection>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Facet: [
  {
    hidden: true,
    label: 'Material',
    type: #CONTACT_REFERENCE,
    purpose: #QUICK_VIEW
  },
  {
    hidden: #('edit_Ac'),
    label: 'Address',
    targetQualifier: 'SoldToQuickView',
    type: #FIELDGROUP_REFERENCE,
    purpose: #QUICK_VIEW
  }
]
Test;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
UI.QuickViewFacets : [
  {
    $Type : 'UI.ReferenceFacet',
    Label : 'Material',
    Target: '@Communication.Contact',
    ![@UI.Hidden] : true
  },
  {
    $Type : 'UI.ReferenceFacet',
    Label : 'Address',
    Target: '@UI.FieldGroup#SoldToQuickView',
    ![@UI.Hidden] : edit_Ac
  }
]
```

**STEP**: 5 — Hide DataField records in Header Facets

**DESCRIPTION**: Apply UI.Hidden on UI.DataField items inside UI.FieldGroup to hide specific values. Use Bool for static hiding or Path-based boolean.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="OrgData">
    <Record Type="UI.FieldGroupType">
        <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SalesOrganization" />
                    <Annotation Term="UI.Hidden" Bool="true" />
                </Record>
               <Record Type="UI.DataField">
                   <PropertyValue Property="Value" Path="DistributionChannel" />
                   <Annotation Term="UI.Hidden" Path="Delivered" />
               </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.fieldGroup: [
  {
    hidden: true,
    value: 'SALESORGANIZATION',
    type: #STANDARD,
    qualifier: 'OrgData'
  }
]
SALESORGANIZATION;

@UI.fieldGroup: [
  {
    hidden: #('Delivered'),
    value: 'DISTRIBUTIONCHANNEL',
    type: #STANDARD,
    qualifier: 'OrgData'
  }
]
DISTRIBUTIONCHANNEL;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
FieldGroup #OrgData : [
  {
    $Type : 'UI.DataField',
    Value : SalesOrganization,
    ![@UI.Hidden] : true
  },
  {
    $Type : 'UI.DataField',
    Value : DistributionChannel,
    ![@UI.Hidden] : Delivered
  }
]
```

**STEP**: 6 — Hide DataField records in general Facets

**DESCRIPTION**: Hide DataField entries within UI.FieldGroup inside facets. To hide an entire FieldGroup or Identification, either hide all contained DataField records OR hide the wrapper (ReferenceFacet or DataFieldForAnnotation). For OData V4 the wrapper hide is supported.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="OrderData">
     <Record Type="UI.FieldGroupType">
         <PropertyValue Property="Data">
            <Collection>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SoldToParty" />
                    <Annotation Term="UI.Hidden" Bool="true" />
                </Record>
                <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="ImageUrl" />
                    <Annotation Term="UI.Hidden" Path="edit_Ac" />
                </Record>
                <!-- more DataField records -->
            </Collection>
         </PropertyValue>
     </Record>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.fieldGroup: [
  {
    hidden: true,
    value: 'SOLDTOPARTY',
    type: #STANDARD,
    qualifier: 'OrderData'
  }
]
SOLDTOPARTY;

@UI.fieldGroup: [
  {
    hidden: #('edit_Ac'),
    value: 'IMAGEURL',
    type: #STANDARD,
    qualifier: 'OrderData'
  }
]
IMAGEURL;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
FieldGroup #OrderData : { Data : [
  {
    $Type : 'UI.DataField',
    Value : SoldToParty,
    ![@UI.Hidden] : true
  },
  {
    $Type : 'UI.DataField',
    Value : ImageUrl,
    ![@UI.Hidden] : edit_Ac
  }
  /* ... */
]}
```

**STEP**: 7 — Hide DataField records / actions in Line Items (tables)

**DESCRIPTION**: Table columns are not rendered when UI.Hidden is statically true on the DataFieldFor* entry. Use Bool static hiding for columns or actions.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.LineItem">
    <Collection>
        <Record Type="UI.DataFieldForAction">
            <PropertyValue Property="Label" String="Bound Action with params" />
            <PropertyValue Property="Action" String="com.c_salesordermanage_sd_aggregate.CreateWithSalesOrderType" />
            <Annotation Term="UI.Hidden" Bool="true" />
        </Record>
    </Collection>
</Annotation>
```

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.lineItem: [
  {
    hidden: true,
    label: 'Bound Action with params',
    dataAction: 'com.c_salesordermanage_sd_aggregate.CreateWithSalesOrderType',
    type: #FOR_ACTION
  }
]
TEST;
```

**LANGUAGE**: CAP CDS

**CODE**:
```cds
LineItem : {
  $value : [
    {
      $Type  : 'UI.DataFieldForAction',
      Label  : 'Bound Action with params',
      Action : 'com.c_salesordermanage_sd.CreateWithSalesOrderType',
      ![@UI.Hidden] : true
    }
  ]
}
```

**STEP**: 8 — Important constraints and runtime notes

**DESCRIPTION**: Key rules to follow when using UI.Hidden.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "rules": [
    "Default behavior: <Annotation Term=\"UI.Hidden\"/> implies true (hidden).",
    "Path must reference a Boolean property. SAPUI5 expression binding is not supported for UI.Hidden path.",
    "Use edmJSON (If/Or/Eq) for conditional logic in OData V4 only.",
    "You cannot hide an entire UI.FieldGroup or UI.Identification by annotating the group directly (behavior varies): hide all contained DataField records or hide the wrapper (ReferenceFacet or DataFieldForAnnotation) instead.",
    "Hiding all determining actions in a footer does not remove the footer if the UI must display backend bound messages; the footer can still appear."
  ]
}
```
--------------------------------

**TITLE**: Highlight Line Items by Criticality (UI.LineItem.UI.Criticality)

**INTRODUCTION**: Add semantic highlighting to table line items by annotating the entity type's LineItem with a property that carries the Criticality value. Use one of the examples below depending on your metadata/annotation source (Annotations XML, ABAP CDS, or CAP CDS).

**TAGS**: fiori-elements-framework, UI.LineItem, UI.Criticality, criticality, annotations, XML, CDS, CAP

**STEP**: 1 - Criticality value mapping

**DESCRIPTION**: The property referenced by UI.Criticality must return an integer matching the CriticalityType values below. Use these mapped values to determine row highlighting colors/icons.

- 0 — Neutral
- 1 — Negative (red)
- 2 — Critical (orange)
- 3 — Positive (green)
- 5 — New Item (blue) — highlights items created outside the app that need attention

Also note:
- By default, Fiori elements assumes CriticalityRepresentationType/WithIcon and sets an ObjectStatus icon (for example, com.sap.vocabularies.UI.v1.CriticalityType/Negative → sap-icon://status-negative).
- If the field is marked with CriticalityRepresentationType/WithoutIcon it is rendered without an icon.
- For OData V2 analytical tables the criticality-returning field must be a property (not a dimension).

**LANGUAGE**: None

**CODE**:
```text
CriticalityType mapping:
0 = Neutral
1 = Negative (red)
2 = Critical (orange)
3 = Positive (green)
5 = New Item (blue)

Representation behavior:
- WithIcon (default): UI sets corresponding ObjectStatus icon (e.g., status-negative)
- WithoutIcon: no icon rendered

OData V2 analytical tables:
- criticality field must be a property (not a dimension)
```

**STEP**: 2 - XML Annotations (annotations.xml)

**DESCRIPTION**: Add the UI.LineItem annotation for the entity type and include UI.Criticality pointing to the property that supplies the criticality. Place this in your annotations XML file used by the app (e.g., annotations.xml).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- annotations.xml -->
<Annotation Term="UI.LineItem">
  <!-- Supply the path to the property that carries the criticality value -->
  <Annotation Term="UI.Criticality" Path="Element_transporting_criticality_of_complete_LineItem" />
  <Collection>
    <Record Type="UI.DataField">
      <!-- Example column definition: replace with actual DataField properties -->
      <PropertyValue Property="Value">
        <Path>SalesOrderID</Path>
      </PropertyValue>
      <PropertyValue Property="Label">
        <String>Sales Order</String>
      </PropertyValue>
    </Record>
    <!-- add other DataField Records as needed -->
  </Collection>
</Annotation>
```

**STEP**: 3 - ABAP CDS Annotation (ABAP CDS)

**DESCRIPTION**: In ABAP CDS, annotate the view's UI.lineItem with the criticality property. Use the view name and the property that returns the criticality.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.lineItem: [{ criticality: 'Element_transporting_criticality_of_complete_LineItem' }]
annotate view VIEWNAME with {
  // define or reference line item fields here if required
}
```

**STEP**: 4 - CAP CDS Annotation (CDS)

**DESCRIPTION**: In CAP (Core Data Services) CDS annotations, add UI.LineItem and attach the UI.Criticality annotation to the LineItem definition. Use the property name (no quotes for property reference in CAP CDS annotation syntax shown).

**LANGUAGE**: CDS

**CODE**:
```cds
// In your .cds annotation file or entity definition
annotate MyService.MyEntity with {
  UI.LineItem : {
    $value : [
      { $Type : 'UI.DataField', Value : { Path : 'SalesOrderID' } },
      // add other UI.DataField entries as needed
    ],
    ![@UI.Criticality] : Element_transporting_criticality_of_complete_LineItem
  }
}
```

**STEP**: 5 - Implementation checklist for code generation

**DESCRIPTION**: Implementers should ensure:
- The referenced property Element_transporting_criticality_of_complete_LineItem exists on the same entity type and returns numeric CriticalityType values (0,1,2,3,5).
- The annotations are deployed and referenced by the Fiori elements app (annotations.xml or service metadata/manifest configured).
- For OData V2 analytical tables confirm the criticality field is a property (not a dimension).
- If you require no icon, mark the field with CriticalityRepresentationType/WithoutIcon in addition to UI.Criticality. If using default icon behavior, no additional steps are required.

**LANGUAGE**: None

**CODE**:
```text
Checklist:
- Property exists on entity and returns 0/1/2/3/5
- Annotations file applied to app (annotations.xml or CDS annotations deployed)
- OData V2 analytical table: criticality must be a property
- For no icon: add CriticalityRepresentationType/WithoutIcon to field annotation
```
--------------------------------

**TITLE**: Highlight Numeric Values with DataPoint Criticality (Fiori Elements)

**INTRODUCTION**: Show numeric values with color/importance by supplying Criticality or CriticalityCalculation on the com.sap.vocabularies.UI.v1.DataPoint annotation. Use one of:
- a fixed Criticality constant,
- a CriticalityPath to a backend-provided property, or
- a CriticalityCalculation (client-side thresholding when supported). Backend-computed criticality is recommended for complex rules.

Reference: annotations-used-in-overview-pages-65731e6.md (com.sap.vocabularies.UI.v1.DataPoint)

**TAGS**: fiori-elements-framework, annotations, DataPoint, Criticality, CriticalityCalculation, UI, OData, metadata

STEP: 1 — DataPoint with fixed Criticality (XML)
DESCRIPTION: Set a static criticality value inside the DataPoint annotation. This forces the displayed numeric value to the specified criticality (color/semantic).
LANGUAGE: XML
CODE:
```XML
<!-- File: annotations/YourAnnotations.xml (OData metadata annotation section) -->
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.DataPoint">
    <Record>
      <PropertyValue Property="Value">
        <Path>Amount</Path>
      </PropertyValue>
      <!-- Set a fixed criticality -->
      <PropertyValue Property="Criticality" String="com.sap.vocabularies.UI.v1.CriticalityType/Positive" />
      <PropertyValue Property="Title" String="Total Amount" />
    </Record>
  </Annotation>
</Annotations>
```

STEP: 2 — DataPoint using CriticalityPath (XML)
DESCRIPTION: Reference a backend-calculated property that stores the criticality. Preferred when backend determines status. The UI will use that property's enum value to render color semantics.
LANGUAGE: XML
CODE:
```XML
<!-- File: annotations/YourAnnotations.xml -->
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.DataPoint">
    <Record>
      <PropertyValue Property="Value">
        <Path>Revenue</Path>
      </PropertyValue>
      <!-- Use a property on the entity that contains the criticality enum -->
      <PropertyValue Property="CriticalityPath" Path="RevenueCriticality" />
      <PropertyValue Property="Title" String="Revenue" />
    </Record>
  </Annotation>
</Annotations>

<!-- On the entity, RevenueCriticality should be provided by the service and return values from:
     com.sap.vocabularies.UI.v1.CriticalityType (Positive / Negative / Critical / Neutral) -->
```

STEP: 3 — DataPoint with JSON-style annotation (fixed criticality)
DESCRIPTION: Example of the same fixed-criticality DataPoint using JSON/annotation structure (useful for inline annotation artifacts or annotation JSON files).
LANGUAGE: JSON
CODE:
```JSON
{
  "MyService.MyEntityType": {
    "com.sap.vocabularies.UI.v1.DataPoint": {
      "Value": { "Path": "Amount" },
      "Criticality": "com.sap.vocabularies.UI.v1.CriticalityType/Negative",
      "Title": "Overdue Amount"
    }
  }
}
```

STEP: 4 — DataPoint with backend-calculated criticality (CSDL / EDMX snippet)
DESCRIPTION: When the service returns a property that already contains the criticality, reference it with CriticalityPath in EDMX/CSDL metadata.
LANGUAGE: XML
CODE:
```XML
<!-- Inside your EntityType definition in the service metadata (EDMX) -->
<Property Name="SalesAmount" Type="Edm.Decimal" Nullable="false" />
<Property Name="SalesAmountCriticality" Type="Edm.String" Nullable="true" />

<!-- Annotation that points to the backend-provided criticality property -->
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Target="YourService.YourEntityType/SalesAmount">
  <Record>
    <PropertyValue Property="Value">
      <Path>SalesAmount</Path>
    </PropertyValue>
    <PropertyValue Property="CriticalityPath">
      <Path>SalesAmountCriticality</Path>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 5 — DataPoint with CriticalityCalculation (conceptual JSON structure)
DESCRIPTION: Client-side thresholding can be modeled with CriticalityCalculation. Many projects compute criticality on the backend; if performed in annotations, define ImprovementDirection and threshold rules. The exact annotation structure depends on your annotation format (XML/JSON). Use backend-calculation for complex or business-critical rules.
LANGUAGE: JSON
CODE:
```JSON
{
  "MyService.MyEntityType": {
    "com.sap.vocabularies.UI.v1.DataPoint": {
      "Value": { "Path": "Score" },
      "CriticalityCalculation": {
        "ImprovementDirection": "com.sap.vocabularies.UI.v1.ImprovementDirection/Maximize",
        "Thresholds": [
          { "Criticality": "com.sap.vocabularies.UI.v1.CriticalityType/Positive", "Value": 90 },
          { "Criticality": "com.sap.vocabularies.UI.v1.CriticalityType/Critical", "Value": 70 },
          { "Criticality": "com.sap.vocabularies.UI.v1.CriticalityType/Negative", "Value": 0 }
        ]
      },
      "Title": "Quality Score"
    }
  }
}
```

STEP: 6 — Notes and recommendations
DESCRIPTION: Implementation best practices and mapping details.
LANGUAGE: Text
CODE:
```text
- Preferred approach: compute and expose a Criticality property from the backend and use CriticalityPath. This centralizes business logic and avoids client-side inconsistencies.
- Allowed criticality values come from com.sap.vocabularies.UI.v1.CriticalityType: Positive, Negative, Critical, Neutral.
- Use DataPoint.Value to point to the numeric property to display.
- For full vocabulary reference and additional DataPoint properties, see: annotations-used-in-overview-pages-65731e6.md (com.sap.vocabularies.UI.v1.DataPoint).
```
--------------------------------

**TITLE**: Create and Extend an SAP Fiori Elements App (OData + Annotations + Extensions)

**INTRODUCTION**: This guide shows the minimal, actionable artifacts and code snippets needed to build an SAP Fiori elements app: configure OData in manifest.json, provide UI annotations, scaffold the generic app pages, and extend behavior using controller extensions. Use these snippets as copy-paste starters in webapp/ of your UI5/Fiori Elements project.

**TAGS**: fiori-elements-framework, sap-fiori, odata, annotations, ui5, manifest, extension

**STEP**: 1 — Prerequisites: configure OData service in manifest.json

**DESCRIPTION**: Define the backend OData service as a dataSource and register its metadata endpoint (and optional local annotations file). Replace service URLs, local paths, and names with your project values.

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (partial)
{
  "sap.app": {
    "id": "com.example.myfioriapp",
    "applicationVersion": { "version": "1.0.0" }
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "synchronizationMode": "None",
          "operationMode": "Server"
        }
      }
    }
  },
  "sap.cloud": {},
  "sap.app": {},
  "dataSources": {
    "mainService": {
      "uri": "/sap/opu/odata/sap/Z_MY_SERVICE_SRV/",
      "type": "OData",
      "settings": {
        "odataVersion": "2.0",
        "localUri": "localService/metadata.xml" 
      }
    }
  }
}
```

Notes:
- uri can point to the real backend (replace with your system) or be proxied during local development.
- localUri is optional and useful for offline development (metadata file exported from backend).

**STEP**: 2 — Prepare UI annotations (external annotation XML)

**DESCRIPTION**: Provide UI annotations that drive Fiori elements behavior. Common artifacts: @UI.LineItem, @UI.FieldGroup, @UI.Facets. Place external annotation files under webapp/annotations/ and reference them from manifest.json.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/annotations/annotations.xml -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="http://docs.oasis-open.org/odata/odata/v4/odata.csdl.xml" />
  <edmx:DataServices>
    <Schema xmlns="http://docs.oasis-open.org/odata/ns/edm" Namespace="Z_MY_ANNOTATIONS">
      <Annotations Target="Z_MY_SERVICE_SRV.ProductType">
        <Annotation Term="UI.LineItem">
          <Collection>
            <Record Type="UI.DataField">
              <PropertyValue Property="Label" String="ID"/>
              <PropertyValue Property="Value">
                <Path>ProductID</Path>
              </PropertyValue>
            </Record>
            <Record Type="UI.DataField">
              <PropertyValue Property="Label" String="Name"/>
              <PropertyValue Property="Value">
                <Path>ProductName</Path>
              </PropertyValue>
            </Record>
          </Collection>
        </Annotation>

        <Annotation Term="UI.HeaderInfo">
          <Record>
            <PropertyValue Property="TypeName" String="Product"/>
            <PropertyValue Property="Title">
              <Path>ProductName</Path>
            </PropertyValue>
          </Record>
        </Annotation>
      </Annotations>
    </Schema>
  </edmx:DataServices>
</edmx:Edmx>
```

Register this annotation file in manifest.json data source settings (example below).

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (add to sap.ui5/model or dataSources)
{
  "sap.ui5": {
    "models": {
      "annotations": {
        "dataSource": "annotations",
        "settings": {}
      }
    }
  },
  "dataSources": {
    "annotations": {
      "uri": "annotations/annotations.xml",
      "type": "ODataAnnotation",
      "settings": { "localUri": "annotations/annotations.xml" }
    }
  }
}
```

**STEP**: 3 — Build the UI5 Fiori elements app (generic app configuration)

**DESCRIPTION**: Configure sap.ui.generic.app to describe pages (e.g., ListReport and ObjectPage) referencing entity sets. This manifest fragment tells the Fiori elements runtime how to render pages based on OData + annotations.

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (sap.ui.generic.app minimal)
{
  "sap.ui5": {
    "componentUsages": {},
    "dependencies": {},
    "models": {}
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "entitySet": "Products",
        "annotationPath": "com.example.annotations/Products"
      },
      {
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "list": false
        },
        "entitySet": "Products",
        "navigation": {}
      }
    ]
  }
}
```

Notes:
- entitySet must match the OData service entity set name.
- Fiori elements runtime resolves annotations (UI/Model) to generate the UI.

**STEP**: 4 — Extend Fiori elements behavior (controller extension)

**DESCRIPTION**: Use controller extensions to inject custom logic when annotations and manifest cannot achieve the desired behavior. Map the extension in manifest.json and implement the controller in webapp/ext/controller/<Name>.controller.js.

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (controller extension mapping)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.ListReport.view.ListReport": {
            "controllerName": "com.example.myfioriapp.ext.controller.ListReport"
          }
        }
      }
    }
  }
}
```

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/ext/controller/ListReport.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";
  return Controller.extend("com.example.myfioriapp.ext.controller.ListReport", {
    // Called by the framework when the ListReport is initialized
    onInit: function () {
      // custom initialization logic
      // e.g., attach to events, modify smart filter bar or smart table before rendering
      // this.getView().byId("listReportTable").attachEvent(...);
    },

    // Example custom action handler invoked from a UI button extension
    onCustomAction: function (oEvent) {
      var oContext = oEvent.getSource().getBindingContext();
      // implement custom behavior
    }
  });
});
```

File locations referenced in this document:
- Manifest: webapp/manifest.json
- Local metadata (optional): webapp/localService/metadata.xml
- Annotations: webapp/annotations/annotations.xml
- Controller extensions: webapp/ext/controller/*.controller.js

Related reference docs (preserve original links/file names):
- Prerequisites for Using SAP Fiori Elements: prerequisites-for-using-sap-fiori-elements-f2344b5.md
- Working With OData Annotations: working-with-odata-annotations-83c89cc.md
- Extending SAP Fiori Elements-Based Apps: extending-sap-fiori-elements-based-apps-358cf25.md
- SAP Fiori tools: https://help.sap.com/viewer/product/SAP_FIORI_tools/Latest/en-US
- SAP Business Application Studio: https://help.sap.com/viewer/product/SAP%20Business%20Application%20Studio/Cloud/en-US
--------------------------------

**TITLE**: Hybrid View (Analytical List Page) — Enable and Configure Chart+Table Hybrid Mode

**INTRODUCTION**: Enable the hybrid view to display analytical (chart) and transactional (table) data together in the ALP content area. This document shows the manifest/settings changes for OData V2 and V4 apps, explains user interaction expectations, and lists device/responsiveness constraints and best practices for accurate highlighting and filtering between chart and table.

**TAGS**: fiori-elements-framework, analytical-list-page, hybrid-view, manifest, OData-v2, OData-v4, chart, table, configuration, ALP

**STEP**: 1 — Hybrid view behavior and interaction

**DESCRIPTION**: Summary of how hybrid view behaves and how chart selections affect the table. Use this to implement UI and tests that validate selection/filter/highlight behavior.

**LANGUAGE**: Text

**CODE**:
```Text
- Hybrid view displays chart (analytical) and table (transactional) together.
- Chart selection filters and highlights matching records in the table:
  - If a chart selection is made (e.g., Country=ABC), the table is filtered/highlighted to show records associated with that selection.
  - When "auto-hide" is OFF: table shows all records; matched records are highlighted.
  - When "auto-hide" is ON: table shows only records matched by chart selection (chart selection acts as an additional filter).
- Ensure chart context dimensions are present as visible columns in the table for accurate highlighting and selection mapping.
```

**STEP**: 2 — Enable Hybrid View for OData V2 (manifest setting)

**DESCRIPTION**: Add the default content view setting in the app manifest to load hybrid (chart + table) view by default in OData V2 Fiori Elements apps. Add this to your application manifest (manifest.json) in the appropriate generic app settings section.

**LANGUAGE**: JSON

**CODE**:
```JSON
// Add to manifest.json (sap.ui.generic.app / generic settings section)
"settings": {
  "defaultContentView": "charttable"
}
```

**STEP**: 3 — Enable Hybrid View for OData V4 (manifest setting)

**DESCRIPTION**: Configure the views path in the manifest to set the default path to both chart and table for OData V4. Place this entry in your manifest.json under the views configuration used by the app.

**LANGUAGE**: JSON

**CODE**:
```JSON
// Add to manifest.json under your views configuration
"views": {
  "paths": [
    {
      // existing path entries...
      "defaultPath": "both"
    }
  ]
}
```

**STEP**: 4 — Device, layout and table-type constraints (implementation notes)

**DESCRIPTION**: Implement checks and responsive behavior according to device and table type constraints. Use these rules for feature gating and responsive tests.

**LANGUAGE**: Text

**CODE**:
```Text
- Hybrid mode is not available on tablets or smartphones.
- Hybrid view is available on laptops with screen height > 900px.
- Hybrid view is disabled for Analytical and Grid table types when:
  - The app is in cozy mode AND
  - Resolution (screen height) is less than 900px.
- Responsive tables: the above cozy-mode + resolution restriction does NOT apply (responsive tables can use hybrid view).
- Implement UI gating to hide/disable the hybrid control when constraints are not met.
```

**STEP**: 5 — Best practices and testing checklist

**DESCRIPTION**: Practical steps to ensure correct behavior, accurate highlights, and reliable UX.

**LANGUAGE**: Text

**CODE**:
```Text
- Verify chart context dimensions are included as visible columns in the list/table view.
- Test both states of auto-hide:
  - OFF: ensure all table records remain visible and matched records are highlighted.
  - ON: ensure only matched records are shown and chart selection acts like an additional filter.
- Test across devices and screen heights: laptop >900px, tablet, smartphone.
- Test different table types: Analytical, Grid, Responsive to validate hybrid availability per rules.
- Validate manifest changes are loaded and that the default view is "charttable" (V2) or defaultPath "both" (V4).
```

**Related Information**: Configuring the Content Area — see configuring-the-content-area-fc7d73c.md for mapping UI.Chart / UI.LineItem annotations and further manifest configuration details.
--------------------------------

**TITLE**: ValueList In/Out Mappings for Value Helps (Z0020 example)

**INTRODUCTION**: Provide concrete, copy-paste-ready examples of how to define ValueList annotations with IN/OUT parameter mappings to link properties between a main entity (Z0020) and value-help entities (Z0021..Z0023). Includes XML, ABAP CDS, and CAP CDS variants. Use these snippets to implement value helps that filter by related fields and return values into main-entity properties.

**TAGS**: fiori-elements-framework, valuehelp, ValueList, Common.ValueList, Common.ValueListParameterIn, Common.ValueListParameterOut, OData, CDS, CAP, XML, ABAP

**STEP**: 1 — Notes & constraints
**DESCRIPTION**: Important constraints and practical notes to apply before editing annotations.
**LANGUAGE**: Text
**CODE**:
```
- OData V2: IN/OUT mappings are supported only for Analytical List Page.
- When using a value help in the filter bar, OUT parameters are applied only if the LocalDataProperty (target property) is visible in the filter bar.
- LocalDataProperty: property in the main entity (where the field is defined).
- ValueListProperty: property in the value-help entity (used for filter or result).
- ValueListParameterOut: maps value-help result -> main entity LocalDataProperty.
- ValueListParameterIn: maps main entity LocalDataProperty -> value-help filter property.
- ValueListParameterInOut: supports both directions (combine In and Out).
```

**STEP**: 2 — Define SelectionFields (examples: XML, ABAP CDS, CAP CDS)
**DESCRIPTION**: Ensure the main entity Z0020 exposes RegionID, CountryID, PlantID in UI.SelectionFields. Add one of these examples to your metadata/source.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: annotations.xml (or embedded UI annotations) -->
<Annotation Term="UI.SelectionFields">
  <Collection>
    <PropertyPath>RegionID</PropertyPath>
    <PropertyPath>CountryID</PropertyPath>
    <PropertyPath>PlantID</PropertyPath>
  </Collection>
</Annotation>
```

**LANGUAGE**: CDS
**CODE**:
```c
// ABAP CDS: place in the CDS view definition for Z0020
@UI.selectionField: [{ position: 1, element: 'REGIONID' }]
REGIONID;

@UI.selectionField: [{ position: 2, element: 'COUNTRYID' }]
COUNTRYID;

@UI.selectionField: [{ position: 3, element: 'PLANTID' }]
PLANTID;
```

**LANGUAGE**: CDS
**CODE**:
```c
// CAP CDS: in your .cds file where the entity Z0020 is defined
UI.SelectionFields : [
  RegionID,
  CountryID,
  PlantID
];
```

**STEP**: 3 — Reference mapping scenario (entity / property mapping overview)
**DESCRIPTION**: Example business-object mapping across entity sets. Use this to map properties explicitly when names differ.
**LANGUAGE**: Text
**CODE**:
```
Business object properties mapping:

Main entity: Z0020
  - Region -> RegionID
  - Country -> CountryID
  - Plant   -> PlantID

Value-help entity Z0022 (Country):
  - RegionIdentifier
  - CountryIdentifier
  - (other properties)

Value-help entity Z0023 (Plant):
  - RegionNumber
  - CountryNumber
  - PlantNumber
```

**STEP**: 4 — XML: ValueList for CountryID with IN and OUT mappings (full annotation)
**DESCRIPTION**: Copy this XML annotation and attach to target "Z0020_CDS.Z0020Type/CountryID". It configures the value help to fetch from collection Z0022, return CountryIdentifier into CountryID (OUT), and filter by RegionIdentifier using RegionID (IN).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: annotations.xml -->
<Annotations Target="Z0020_CDS.Z0020Type/CountryID">
  <Annotation Term="Common.ValueList" Qualifier="0020_Country">
    <Record>
      <PropertyValue Property="Label" String="Country"/>
      <PropertyValue Property="CollectionPath" String="Z0022"/>
      <PropertyValue Property="SearchSupported" Bool="false"/>
      <PropertyValue Property="Parameters">
        <Collection>
          <!-- OUT: when a user selects a CountryIdentifier, set Z0020.CountryID -->
          <Record Type="Common.ValueListParameterOut">
            <PropertyValue Property="LocalDataProperty" PropertyPath="CountryID"/>
            <PropertyValue Property="ValueListProperty" String="CountryIdentifier"/>
          </Record>
          <!-- IN: filter the value-help by RegionIdentifier using Z0020.RegionID -->
          <Record Type="Common.ValueListParameterIn">
            <PropertyValue Property="LocalDataProperty" PropertyPath="RegionID"/>
            <PropertyValue Property="ValueListProperty" String="RegionIdentifier"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 5 — ABAP CDS: valueHelpDefinition for CountryID (equivalent)
**DESCRIPTION**: Add this consumption/valueHelpDefinition to the CountryID element in the ABAP CDS view for Z0020. It mirrors the XML mapping: result (OUT) and filter (IN).
**LANGUAGE**: CDS
**CODE**:
```c
// In ABAP CDS for Z0020
@Consumption.valueHelpDefinition:
  [{
    entity : { name : 'Z0022' },
    label  : 'Country',
    additionalBinding: [
      {
        localElement: 'CountryID',
        element: 'CountryIdentifier',
        usage: #RESULT            // Common.ValueListParameterOut
      },
      {
        localElement: 'RegionID',
        element: 'RegionIdentifier',
        usage: #FILTER            // Common.ValueListParameterIn
      }
    ]
  }]
CountryID;
```

**STEP**: 6 — CAP CDS: ValueList for CountryID (equivalent)
**DESCRIPTION**: CAP CDS example to attach Common.ValueList with Parameters array. Use this inside the entity definition for the CountryID field.
**LANGUAGE**: CDS
**CODE**:
```c
// In CAP CDS (e.g., schema.cds)
CountryID : UUID @( 
  Common : {
    ValueList #0020_Country : {
      Label : 'Country',
      CollectionPath : 'Z0022',
      Parameters : [
        {
          $Type : 'Common.ValueListParameterOut',
          LocalDataProperty : CountryID,
          ValueListProperty : 'CountryIdentifier'
        },
        {
          $Type : 'Common.ValueListParameterIn',
          LocalDataProperty : RegionID,
          ValueListProperty : 'RegionIdentifier'
        }
      ]
    }
  }
);
```

**STEP**: 7 — XML: ValueList for PlantID with multiple IN parameters
**DESCRIPTION**: Configure PlantID value help (target Z0020_CDS.Z0020Type/PlantID) to return PlantNumber (OUT) and filter by RegionNumber and CountryNumber (IN parameters).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: annotations.xml -->
<Annotations Target="Z0020_CDS.Z0020Type/PlantID">
  <Annotation Term="Common.ValueList" Qualifier="0020_Plant">
    <Record>
      <PropertyValue Property="Label" String="Plant"/>
      <PropertyValue Property="CollectionPath" String="Z0023"/>
      <PropertyValue Property="SearchSupported" Bool="false"/>
      <PropertyValue Property="Parameters">
        <Collection>
          <!-- OUT -->
          <Record Type="Common.ValueListParameterOut">
            <PropertyValue Property="LocalDataProperty" PropertyPath="PlantID"/>
            <PropertyValue Property="ValueListProperty" String="PlantNumber"/>
          </Record>
          <!-- IN: Region -> RegionNumber -->
          <Record Type="Common.ValueListParameterIn">
            <PropertyValue Property="LocalDataProperty" PropertyPath="RegionID"/>
            <PropertyValue Property="ValueListProperty" String="RegionNumber"/>
          </Record>
          <!-- IN: Country -> CountryNumber -->
          <Record Type="Common.ValueListParameterIn">
            <PropertyValue Property="LocalDataProperty" PropertyPath="CountryID"/>
            <PropertyValue Property="ValueListProperty" String="CountryNumber"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 8 — Semantics: expected runtime behavior and example filter queries
**DESCRIPTION**: How the UI runtime uses IN and OUT mappings; expected filter queries and target updates.
**LANGUAGE**: Text
**CODE**:
```
Behavior notes:
- OUT mapping: when the user selects a row in the value help, ValueListProperty is read from the selected row and written into LocalDataProperty of the main entity.
  Example: selecting CountryIdentifier='001' updates Z0020.CountryID = '001'
  Example filter produced by list/report runtime (if used in filter context):
    $filter=CountryID eq '001'
  (The filter uses LocalDataProperty, not ValueListProperty.)

- IN mapping: when LocalDataProperty (main entity) already has a value, that value is applied as a filter against the value-help collection's ValueListProperty to restrict the value-help results.
  Example: Z0020.RegionID = 'ABC' + IN mapping (RegionID -> RegionIdentifier) results in the value-help request:
    /Z0022?$filter=RegionIdentifier eq 'ABC'
  So the Country value-help shows only countries in Region 'ABC'.

- Multiple INs: if both RegionID and CountryID are present and mapped as INs for PlantID, the Plant value help is filtered by both RegionNumber and CountryNumber:
    /Z0023?$filter=RegionNumber eq 'ABC' and CountryNumber eq '001'
```

**STEP**: 9 — Quick checklist before deploying
**DESCRIPTION**: Verify these items to avoid runtime surprises.
**LANGUAGE**: Text
**CODE**:
```
- Ensure CollectionPath (entity name) exists and is accessible by the UI runtime.
- Confirm property names are correct in both main and value-help entities (case-sensitive as defined in metadata).
- Make sure LocalDataProperty is visible in filter bar if you expect OUT updates in filter contexts.
- For OData V2 + Analytical List Page: confirm app type supports IN/OUT mappings.
- Test value help dialogs with pre-filled Region/Country to verify IN filtering and OUT result mapping.
```
--------------------------------

**TITLE**: Embedding Reuse Components in an Object Page (SAP Fiori elements)

**INTRODUCTION**: Practical, code-focused guidance to add reuse components as sections on an Object Page in SAP Fiori elements apps (OData V2 and V4). Includes manifest.json examples, binding and settings patterns, visibility control, and dependency declarations needed for code generation.

**TAGS**: fiori-elements-framework, reuse-component, object-page, manifest.json, sapui5, odata-v2, odata-v4, binding, visibility

STEP: 1 — Embed reuse components on Object Page (OData V2)

DESCRIPTION: Use the "sap.ui.generic.app" -> pages -> embeddedComponents section in your app manifest to add reuse components to an Object Page. Two addressing options: componentUsage (named usage from a manifest section) or direct componentName. The key (property name) under embeddedComponents must equal the id value inside the definition. Use title for translatable labels and settings for component properties (supporting binding and expression binding). Use binding to change the reuse component binding context relative to the page context.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|myRootEntity": {
        "entitySet": "myRootEntity",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": {
          "ObjectPage|myRootEntity": {
            "entitySet": "myRootEntity",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage"
            },
            "embeddedComponents": {
              "myFirstComponentEmbedding": {
                "id": "myFirstComponentEmbedding",
                "componentUsage": "myUsage",
                "title": "{{I18N_KEY_FOR_FIRST_REUSE_COMPONENT_TITLE}}",
                "settings": {
                  "documentNumber": "{documentNumber}"
                }
              },
              "mySecondComponentEmbedding": {
                "id": "mySecondComponentEmbedding",
                "componentName": "theOtherReuseComponentQualifiedName",
                "title": "{{I18N_KEY_FOR_SECOND_REUSE_COMPONENT_TITLE}}",
                "binding": "myNavProperty"
              }
            },
            "pages": {
              // list of sub-pages of the root object page
            }
          }
        }
      }
    }
  }
}
```

STEP: 2 — Settings and binding patterns (OData V2)

DESCRIPTION: Pass data into reuse components via settings (string binding or expression binding). The reuse component also inherits the page-level binding context unless you override it with the embedding's "binding" property (a path relative to current page context).

LANGUAGE: JSON

CODE:
```json
// settings supports basic binding or expression binding examples
"settings": {
  "documentNumber": "{documentNumber}",
  "fallbackDocument": "{= ${documentNumber} || ${documentId} }"
}

// override reuse component binding context (relative to object page binding)
"binding": "myNavProperty"
```

STEP: 3 — Default visibility and runtime show/hide (OData V2 and V4)

DESCRIPTION: Set default visibility for most cases using hiddenByDefault in the embedding definition. To dynamically show/hide a reuse component at runtime (per entity instance), the reuse component implementation must call the hosting extensionAPI method setSectionHidden(false|true). Use hiddenByDefault: true to keep the section hidden initially; the reuse component can unhide itself.

LANGUAGE: JSON and JavaScript

CODE:
```json
// manifest: hide by default (placed alongside id, title, settings)
"myFirstComponentEmbedding": {
  "id": "myFirstComponentEmbedding",
  "title": "{{I18N_KEY_FOR_FIRST_REUSE_COMPONENT_TITLE}}",
  "hiddenByDefault": true,
  "settings": { "documentNumber": "{documentNumber}" }
}
```

```javascript
// reuse component: call extensionAPI.setSectionHidden at runtime
// (The hosting Fiori elements app provides extensionAPI to the reuse component)
if (extensionAPI) {
  // unhide the section for this object instance
  extensionAPI.setSectionHidden(false);
  // hide the section
  // extensionAPI.setSectionHidden(true);
}
```

STEP: 4 — Declare dependencies for reuse component OData service

DESCRIPTION: If the reuse component requires its own OData service or libraries, declare them in manifest under sap.ui5 -> dependencies -> libs and sap.ui5 -> dependencies -> component.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "dependencies": {
      "libs": {
        "sap.m": {},
        "sap.ui.core": {}
        // add other libs required by reuse component
      },
      "components": {
        "path.to.reuseComponent": {}
        // add the reuse component as a dependency if it has its own component
      }
    }
  }
}
```

STEP: 5 — Placement and order of reuse component sections

DESCRIPTION: Reuse component instances are rendered as sections (with a sub-section containing the component) and are appended in manifest order. Reorder or move sections using the Adaptation Editor or the placement settings (OData V4). For V2 use the Adaptation Editor; for V4 use "position" placement options.

LANGUAGE: Text

CODE:
```json
// Example OData V4 position (see next step for full V4 example)
"position": {
  "placement": "After",
  "anchor": "SomeSectionId"
}
```

STEP: 6 — Embed reuse components on Object Page (OData V4, recommended simple approach)

DESCRIPTION: For OData V4 apps prefer the routing targets options settings -> content -> body -> sections -> <sectionId> -> embeddedComponent syntax. Provide translatable title and pass settings bindings. Use position to anchor/placement relative to other sections.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": "myEntitySet({key}):?query:",
          "name": "myObjectPage",
          "target": "myObjectPage"
        }
      ],
      "targets": {
        "myObjectPage": {
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "customSectionReuse": {
                      "title": "{i18n>customSectionReuse}",
                      "embeddedComponent": {
                        "name": "path.to.reuseComponent",
                        "settings": {
                          "exampleSettings": "{somePropertyName}"
                        }
                      },
                      "position": {
                        "placement": "After",
                        "anchor": "someOtherSection"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 7 — Embed reuse components on Object Page (OData V4, alternative using separate target)

DESCRIPTION: Alternatively, create a target entry for the reuse component and attach it to the Object Page using controlId/controlAggregation. Use clearControlAggregation to replace existing aggregation if required.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": "myEntitySet({key}):?query:",
          "name": "myObjectPage",
          "target": ["myObjectPage", "ReuseComponent"]
        }
      ],
      "targets": {
        "myObjectPage": {
          "type": "Component",
          "id": "myObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "ReuseComponentContainer": {
                      "position": {
                        "placement": "Before",
                        "anchor": "GeneralInfo"
                      },
                      "title": "Reuse Container",
                      "subSections": {
                        "ReuseContainer": {
                          "id": "ReuseComponentContainer"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "ReuseComponent": {
          "type": "Component",
          "id": "Reuse",
          "name": "path.to.reuseComponent",
          "options": {
            "settings": {
              "exampleSettings": "{somePropertyName}"
            }
          },
          "parent": "myObjectPage",
          "controlId": "ReuseComponentContainer",
          "controlAggregation": "blocks",
          "clearControlAggregation": true
        }
      }
    }
  }
}
```

STEP: 8 — Visibility binding example (OData V4)

DESCRIPTION: Use SAPUI5 binding expressions to show the reuse component only when entity data exists, for example for SalesOrder presence.

LANGUAGE: JSON

CODE:
```json
// use visible expression binding in the reuse component settings or section
"visible": "{= !!${SalesOrder} }"
```

STEP: 9 — Compatibility notes and recommendations

DESCRIPTION: Compatibility and recommended practices to guide reuse component authors:
- Fiori elements OData V2 reuse components are not usable in freestyle SAPUI5 apps; to support both, provide two components (shared code allowed).
- Fiori elements OData V4 supports freestyle SAPUI5 reuse components but is incompatible with OData V2 reuse components.
- Factor shared logic into common libraries to reduce duplication across reuse components.

LANGUAGE: Text

CODE:
```text
// Compatibility summary (no code)
- OData V2 reuse components: compatible with Fiori elements (V2) only, not freestyle.
- OData V4 reuse components: compatible with Fiori elements (V4) and freestyle UI5 components, but not with V2 reuse components.
```

--------------------------------

**TITLE**: Dynamically Influence Table Requests with beforeRebindTable (OData V4, SAP Fiori elements)

**INTRODUCTION**: Use the beforeRebindTable controller extension to read and modify a table's binding before the request is executed. You can inspect/add filters, sorters, and select properties, and attach to dataReceived/refresh events to get the loaded row count.

**TAGS**: sap.fiori, fiori-elements, beforeRebindTable, CollectionBindingInfo, table, ODataV4, controller-extension, manifest.json

**STEP**: 1 — Add beforeRebindTable hook to manifest.json (controlConfiguration)
**DESCRIPTION**: Register a beforeRebindTable handler for the table via controlConfiguration. The value is the controller extension method reference in the form ".extension.<controllerName>.<methodName>".
**LANGUAGE**: JSON
**CODE**:
```json
{
  "controlConfiguration": {
    "_Child/@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "beforeRebindTable": ".extension.sap.fe.core.fpmExplorer.OPExtend.onTableRefresh"
      }
    }
  }
}
```

**STEP**: 2 — Register the controller extension in manifest.json (sap.ui5 extends)
**DESCRIPTION**: Declare the controller extension that implements the beforeRebindTable handler.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ObjectPage.ObjectPageController": {
            "controllerName": "sap.fe.core.fpmExplorer.OPExtend"
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Implement the controller extension: add filters, sorters, selects
**DESCRIPTION**: Create a ControllerExtension module that implements the beforeRebindTable handler. Use event.getParameter("collectionBindingInfo") to obtain the CollectionBindingInfo API. Call addFilter, addSorter, and addSelect to modify the request.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// File: webapp/extension/sap/fe/core/fpmExplorer/OPExtend.js
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension",
  "sap/ui/model/Filter",
  "sap/ui/model/FilterOperator",
  "sap/ui/model/Sorter"
], function (ControllerExtension, Filter, FilterOperator, Sorter) {
  "use strict";

  return ControllerExtension.extend("sap.fe.core.fpmExplorer.OPExtend", {
    /**
     * beforeRebindTable handler invoked before the table binding is (re)created.
     * @param {sap.ui.base.Event} event
     */
    onTableRefresh: function (event) {
      // Get the CollectionBindingInfo API
      var collectionBindingInfoAPI = event.getParameter("collectionBindingInfo");

      // Add a filter: BooleanProperty EQ false
      var filter = new Filter({
        path: "BooleanProperty",
        operator: FilterOperator.EQ,
        value1: false
      });
      collectionBindingInfoAPI.addFilter(filter);

      // Add a sorter on ID descending (true = descending)
      var sorter = new Sorter("ID", true);
      collectionBindingInfoAPI.addSorter(sorter);

      // Request an additional property in $select
      collectionBindingInfoAPI.addSelect(["TagStatus"]);
    }
  });
});
```

**STEP**: 4 — Retrieve row count after data is loaded (attach to dataReceived and refresh)
**DESCRIPTION**: To display the number of rows loaded in the table (e.g., in a tile or data field), attach handlers to collectionBindingInfo events "dataReceived" and "refresh", then call getCount() on the table control and update your UI control.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// Add this function inside your controller extension (same module as above)
beforeRebindTableLR: function (event) {
  // Obtain CollectionBindingInfo API
  let collectionBindingInfoAPI = event.getParameter("collectionBindingInfo");

  // Handler to read table count and set a numeric control's value
  const updateTableCount = () => {
    // Replace these IDs with the actual view control IDs in your app
    const table = this.getView().byId("sap.fe.core.fpmExplorer.customListReportHeaderContent::Default--fe::table::RootEntity::LineItem::Table");
    const numericControl = this.getView().byId("sap.fe.core.fpmExplorer.customListReportHeaderContent::Default--numericId");

    if (table && typeof table.getCount === "function" && numericControl && typeof numericControl.setValue === "function") {
      const tableCount = table.getCount();
      numericControl.setValue(tableCount);
    }
  };

  // Attach to dataReceived and refresh to update count after data changes
  collectionBindingInfoAPI.attachEvent("dataReceived", updateTableCount, this);
  collectionBindingInfoAPI.attachEvent("refresh", updateTableCount, this);
}
```

**STEP**: 5 — Example manifest.json entry for the row count handler
**DESCRIPTION**: Example showing how to reference the beforeRebindTableLR method from controlConfiguration.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "beforeRebindTable": ".extension.sap.fe.core.fpmExplorer.customListReportHeaderContent.LRExtend.beforeRebindTableLR"
      }
    }
  }
}
```

**STEP**: 6 — References for live examples
**DESCRIPTION**: Use these building block examples to explore UI behavior and test extensions locally.
**LANGUAGE**: TEXT
**CODE**:
- Building Blocks - Table - Extensions - Custom Column: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/customColumn
- Building Blocks - Table - Extensions - Custom Action: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/customTableAction
- Note: The beforeRebindTable extension is also available for the Table building block (see The Table Building Block).
--------------------------------

**TITLE**: Initial Expansion Level for Tables in List Reports & Analytical List Pages

**INTRODUCTION**: Configure the number of expanded group levels for table visualizations in SAP Fiori elements (OData V2) by using the InitialExpansionLevel property on the UI.PresentationVariant annotation. This guide shows expected runtime behavior by table type, required annotation placement and qualifiers, and concrete XML / ABAP CDS / CAP CDS code examples you can copy into your annotation artifacts.

**TAGS**: fiori-elements-framework, OData V2, annotations, PresentationVariant, SelectionPresentationVariant, initialExpansionLevel, tables, ListReport, AnalyticalListPage, CDS, XML, ABAP

**STEP**: 1 — Applicability & quick constraints

**DESCRIPTION**: Apply initialExpansionLevel only for SAP Fiori elements for OData V2. Ensure initialExpansionLevel never exceeds the number of grouped columns for the target table.

**LANGUAGE**: Text

**CODE**:
```text
- Applicable: SAP Fiori elements for OData V2 only.
- Constraint: initialExpansionLevel must NOT exceed the number of GroupBy properties (grouped columns).
```

**STEP**: 2 — Expected runtime behavior per table type

**DESCRIPTION**: Understand how different table types interpret initialExpansionLevel so you set the correct value or avoid setting it.

**LANGUAGE**: Text

**CODE**:
```text
Analytical Table:
  - Default initialExpansionLevel = 0 (if not explicitly set).

Responsive Table:
  - Ignores initialExpansionLevel; always expands to one level.
  - Groups are always expanded; grouping controlled via table settings.

Tree Table:
  - List Reports: first level is automatically expanded (UI expands level 1 by default).
  - Analytical List Pages: default initialExpansionLevel = 0 (unless overridden).
```

**STEP**: 3 — Requirement: Where PresentationVariant must be defined

**DESCRIPTION**: initialExpansionLevel is honored only when a PresentationVariant annotation exists for the content area (ALP/ List Report) or for each tab in a List Report. If the app uses SelectionPresentationVariant that references a PresentationVariant, the PresentationVariant must be referenced via path (not inline). When tabs are not used, the default (no qualifier) PresentationVariant is considered.

**LANGUAGE**: Text

**CODE**:
```text
- For ALP/List Report content area or List Report tabs, ensure UI.PresentationVariant exists (qualified or default).
- If using UI.SelectionPresentationVariant:
    - Do NOT inline the PresentationVariant inside SelectionPresentationVariant.
    - Refer to PresentationVariant by path (e.g., Path="@UI.PresentationVariant#Default").
- If tabs are not defined in manifest:
    - The default PresentationVariant (no qualifier) is used.
- Manifest qualifier rules:
    - If manifest defines a qualifier and there is a PresentationVariant matching that qualifier, it is used.
    - If manifest does not define a qualifier and a default PresentationVariant exists, it is used.
```

**STEP**: 4 — PresentationVariant (XML annotation example)

**DESCRIPTION**: Add a PresentationVariant annotation with GroupBy and InitialExpansionLevel. Use Qualifier values that match the manifest or tab annotation paths.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.PresentationVariant" Qualifier="Default">
  <Record>
    <PropertyValue Property="Visualizations">
      <Collection>
        <AnnotationPath>@UI.LineItem#DefaultLineItem</AnnotationPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="GroupBy">
      <Collection>
        <PropertyPath>ProductId</PropertyPath>
      </Collection>
    </PropertyValue>
    <!-- Set initial expansion level to 1 -->
    <PropertyValue Property="InitialExpansionLevel" Int="1" />
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record>
          <PropertyValue Property="Property" PropertyPath="ProductCategory" />
          <PropertyValue Property="Descending" Bool="false" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 5 — PresentationVariant (ABAP CDS annotation example)

**DESCRIPTION**: Use @UI.presentationVariant in ABAP CDS with groupBy and initialExpansionLevel. Match qualifier to manifest/tab.

**LANGUAGE**: ABAP

**CODE**:
```abap
@UI.presentationVariant: [
  {
    visualizations: [
      {
        type: #AS_LINEITEM,
        qualifier: 'DefaultLineItem'
      }
    ],
    groupBy: [
      'PRODUCTID'
    ],
    initialExpansionLevel: 1,
    sortOrder: [
      {
        by: 'PRODUCTCATEGORY',
        direction: #ASC
      }
    ],
    qualifier: 'Default'
  }
]
annotate view STTA_C_MP_Product with {
  // Additional annotations or field-level annotations go here
}
```

**STEP**: 6 — PresentationVariant (CAP CDS annotation example)

**DESCRIPTION**: CAP CDS syntax for UI.PresentationVariant with GroupBy and InitialExpansionLevel. Use the same qualifier as referenced by the manifest/tab.

**LANGUAGE**: CDS

**CODE**:
```cds
UI.PresentationVariant #Default : {
    Visualizations : [
        '@UI.LineItem#DefaultLineItem',
    ],
    GroupBy : [
        ProductId
    ],
    InitialExpansionLevel : 1,
    SortOrder : [
        {
            Property : ProductCategory,
            Descending : false
        }
    ]
}
```

**STEP**: 7 — SelectionPresentationVariant (XML example referencing PresentationVariant by path)

**DESCRIPTION**: When using SelectionPresentationVariant for content area or tabs, reference PresentationVariant by path (Path="@UI.PresentationVariant#Qualifier"). Do not inline the PresentationVariant record.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.SelectionPresentationVariant" Qualifier="MainContent">
  <Record>
    <PropertyValue Property="ID" String=""/>
    <PropertyValue Property="Text" String=""/>
    <PropertyValue Property="SelectionVariant" Path="@UI.SelectionVariant#Default"/>
    <!-- Reference PresentationVariant by path, not inline -->
    <PropertyValue Property="PresentationVariant" Path="@UI.PresentationVariant#Default"/>
  </Record>
</Annotation>
```

**STEP**: 8 — SelectionPresentationVariant (ABAP CDS example)

**DESCRIPTION**: ABAP CDS selectionPresentationVariant that references qualifiers for selectionVariant and presentationVariant.

**LANGUAGE**: ABAP

**CODE**:
```abap
@UI.selectionPresentationVariant: [{
  id: '',
  text: '',
  selectionVariantQualifier: 'Default',
  presentationVariantQualifier: 'Default',
  qualifier: 'MainContent'
}]
```

**STEP**: 9 — SelectionPresentationVariant (CAP CDS example)

**DESCRIPTION**: CAP CDS notation to reference SelectionVariant and PresentationVariant by qualifier (using ![] to dereference).

**LANGUAGE**: CDS

**CODE**:
```cds
UI.SelectionPresentationVariant #MainContent : {
    ID : '',
    Text : '',
    SelectionVariant : ![@UI.SelectionVariant#Default],
    PresentationVariant : ![@UI.PresentationVariant#Default]
}
```

**STEP**: 10 — Implementation checklist before deployment

**DESCRIPTION**: Quick actionable checklist to validate your setting works at runtime.

**LANGUAGE**: Text

**CODE**:
```text
- Confirm app is SAP Fiori elements for OData V2.
- Confirm the target table type and expected behavior (Analytical, Responsive, Tree).
- Ensure UI.PresentationVariant exists (qualified or default) for the ALP/List Report content area or each tab.
- If using UI.SelectionPresentationVariant, reference the PresentationVariant by path (do not inline).
- Ensure initialExpansionLevel <= number of GroupBy properties.
- Match PresentationVariant qualifier names with manifest/tab annotation paths.
- Test runtime: verify group expansion level and table behavior in the actual List Report / Analytical List Page.
```

**STEP**: 11 — Related links (reference)

**DESCRIPTION**: Links to related configuration topics (useful when adjusting table behavior or default view).

**LANGUAGE**: Text

**CODE**:
```text
- Configuring Tables: configuring-tables-f4eb70f.md
- Configuring the Table-Only View as the Default Option: configuring-the-table-only-view-as-the-default-option-d074e26.md
- Configuring Default Settings (Visualizations, Sort Order, Filter Values): configuring-default-settings-visualizations-sort-order-filter-values-49a6ba5.md
```
--------------------------------

**TITLE**: Inline Edit Configuration and Behavior for SAP Fiori elements (OData V4)

**INTRODUCTION**: This document explains how to enable and configure inline edit for SAP Fiori elements (OData V4) ListReport and ObjectPage templates. It includes manifest.json examples, parameter references, UI interaction rules, restrictions, error-handling behavior, navigation interactions, and backend considerations for ABAP and CAP. Use these steps to update your app manifest and to implement expected runtime behavior for inline editing.

**TAGS**: sapui5, fiori-elements, inline-edit, manifest.json, ODataV4, ListReport, ObjectPage, FieldGroup, connectedFields, enabledFields, disabledFields

STEP: 1 — Include SAP icon stylesheet (optional)
DESCRIPTION: Ensure SAP icons are available in the app shell or pages where inline edit icons are used. Reference the local stylesheet (path shown as example).
LANGUAGE: HTML
CODE:
```html
<link rel="stylesheet" type="text/css" href="../css/sap-icons.css"/>
```

STEP: 2 — Enable inline edit for all fields on a List Report (manifest.json)
DESCRIPTION: Add an inlineEdit configuration under the page component settings. To enable inline edit for all fields, set disabledFields to an empty array. Include other page settings (contextPath, initialLoad, navigation) as required.
LANGUAGE: JSON
CODE:
```json
{
  "TravelList": {
    "type": "Component",
    "name": "sap.fe.templates.ListReport",
    "id": "TravelList",
    "options": {
      "settings": {
        "inlineEdit": {
          "disabledFields": []
        },
        "contextPath": "/Travel",
        "initialLoad": "Enabled",
        "navigation": {
          "Travel": {
            "detail": {
              "route": "TravelObjectPage"
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — Enable a defined set of fields and a connected field group (manifest.json)
DESCRIPTION: Enable inline edit only for specific properties and define connectedFields so groups of properties are edited together (single request). Use property names for both enabledFields and connectedFields arrays.
LANGUAGE: JSON
CODE:
```json
{
  "TravelList": {
    "type": "Component",
    "name": "sap.fe.templates.ListReport",
    "id": "TravelList",
    "options": {
      "settings": {
        "inlineEdit": {
          "enabledFields": [
            "to_Customer_CustomerID",
            "BeginDate",
            "EndDate",
            "BookingFee"
          ],
          "connectedFields": [
            [
              "BeginDate",
              "EndDate"
            ]
          ]
        },
        "contextPath": "/Travel",
        "initialLoad": "Enabled",
        "navigation": {
          "Travel": {
            "detail": {
              "route": "TravelObjectPage"
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — Use FieldGroup annotations and mixed connectedFields (manifest.json)
DESCRIPTION: Use UI FieldGroup annotations (OData vocabulary) to enable fields by group ID and to define connectedFields with a mixture of property arrays and FieldGroup annotation references. Example shows enabling a FieldGroup for a table within an ObjectPage and connecting fields using both arrays and annotation-qualified references.
LANGUAGE: JSON
CODE:
```json
{
  "TravelObjectPage": {
    "type": "Component",
    "id": "TravelObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "entitySet": "Travel",
        "inlineEdit": {
          "enabledFields": [
            "@com.sap.vocabularies.UI.v1.FieldGroup#TripData",
            "to_Booking/@com.sap.vocabularies.UI.v1.FieldGroup#Flight"
          ],
          "connectedFields": [
            [
              "BeginDate",
              "EndDate"
            ],
            "to_Booking/@com.sap.vocabularies.UI.v1.FieldGroup#Flight"
          ]
        }
      }
    }
  }
}
```

STEP: 5 — inlineEdit parameter reference and tip
DESCRIPTION: Use these parameters under the page settings inlineEdit object:
- enabledFields: array of property names and/or FieldGroup annotation references to explicitly allow inline editing.
- disabledFields: array of property names and/or FieldGroup annotation references to disable inline editing. If empty array, inline edit is enabled for all fields.
- connectedFields: array of arrays (property name groups) and/or FieldGroup annotation references to define groups that must be edited together (single request).
Tip: Immediate side effects within a connectedFields group are NOT triggered when both source and target properties are in the same group.

LANGUAGE: JSON
CODE:
```json
{
  "inlineEdit": {
    "enabledFields": ["PropertyA", "@com.sap.vocabularies.UI.v1.FieldGroup#GroupId"],
    "disabledFields": ["PropertyB"],
    "connectedFields": [["Prop1","Prop2"], "to_Entity/@com.sap.vocabularies.UI.v1.FieldGroup#GroupX"]
  }
}
```

STEP: 6 — UI interaction rules and shortcuts
DESCRIPTION: Inline-editable fields show an underline on hover and display an Edit (pencil) icon. Users can:
- Click the :pencil2: (Edit) icon or double-click the field to edit (double-click is NOT supported for responsive tables).
- Press Enter when the field has focus to start editing.
- After editing, press Enter or click Save (heavy_check_mark) to validate (commits directly to active object, no draft).
- Press Esc or click Cancel (x) to discard inline edits.
Behavior: If a field belongs to a connected group, all fields in that group enter edit mode together and are submitted in one request. If the object already has a draft, inline edit is not available.

LANGUAGE: Text
CODE:
```text
- Start edit: Click pencil icon | double-click (not on responsive tables) | Enter (focus)
- Save: Enter | click Save icon -> patch updates active object (no draft)
- Cancel: Esc | click Cancel icon
- Group behavior: connectedFields edited together, single request
```

STEP: 7 — Restrictions (unsupported scenarios)
DESCRIPTION: Inline edit is not supported in these cases. Do not enable inline edit or expect runtime support where:
- Collaborative draft is enabled for the application.
- The application uses Flexible Column Layout (FCL).
- The field is a stream property (binary / media) or a multi-input field.
- The object already has an existing draft (inline edit unavailable).
- If an error references a field not present on the page, the user must switch to full edit mode to fix it.

LANGUAGE: Text
CODE:
```text
Unsupported:
- Collaborative draft enabled
- Flexible Column Layout (FCL) usage
- Stream property fields
- Multi-input fields
- Existing object draft present
```

STEP: 8 — Error management behavior
DESCRIPTION: When a server-side error occurs on submit of an inline edit:
- A message button appears in the page footer.
- Fields related to the error remain/are shown in edit mode so the user can correct them.
- If a related field is in a connectedFields group, the entire group is opened in edit mode.
- If the error references a field not shown on the page, inline edit cannot fix it; user must switch to full edit mode.
Image references (for docs/screenshots): images/Error_Caused_by_Inline_Editing_43ead48.png

LANGUAGE: Text
CODE:
```text
Error flow:
1. Submit inline change -> server returns error
2. Message button shown in footer
3. Highlight and open related field(s) in edit mode (expand group if necessary)
4. User corrects and re-submits
```

STEP: 9 — Action execution, navigation, and unsaved inline changes
DESCRIPTION: When the user triggers an action or navigation from a table while inline edits are in progress, show a prompt to Save or Discard ongoing inline changes. After the choice, execute the action or navigate. Caution: navigations triggered by the browser back/forward buttons, SAP Fiori Launchpad (FLP) header, or intent-based navigation may bypass the prompt and will discard current inline changes.
Image references: images/Prompt_to_Save_or_Discard_Changes_Navigation_a6b0edd.png

LANGUAGE: Text
CODE:
```text
Navigation behavior:
- In-app action/navigation triggers modal: Save | Discard
- Browser/FLP/intent navigation may proceed and discard inline edits (no prompt)
```

STEP: 10 — Back-end considerations (ABAP and CAP)
DESCRIPTION: Inline edit patches the active version directly (no draft). Ensure backend logic accepts direct patches and implements required business rules.
- ABAP: Follow ABAP RESTful Application Programming Model (RAP) recommendations for business objects and direct updates.
  Link: https://help.sap.com/docs/abap-cloud/abap-rap/abap-restful-application-programming-model
- CAP Node.js / Java: Ensure bypassing of draft flow is configured correctly for direct active-version updates.
  Node.js Fiori bypass docs: https://cap.cloud.sap/docs/node.js/fiori#bypassing-the-sap-fiori-draft-flow
  Java Fiori drafts bypass docs: https://cap.cloud.sap/docs/java/fiori-drafts#bypassing-draft-flow

LANGUAGE: Text
CODE:
```text
Backend must accept PATCH updates to active entities:
- ABAP: implement RAP logic for non-draft updates
- CAP: configure bypass-draft option for Node.js / Java apps
```
--------------------------------

**TITLE**: Input Assistance (Recommendations) for SAP Fiori elements — OData V4

**INTRODUCTION**: This guide shows how to enable, model, consume, and optionally disable input-assistance recommendations for object-page fields in SAP Fiori elements (OData V4). It covers backend metadata annotations (UI.Recommendations + complex types), side-effect triggers, front-end feature toggle, the onBeforeAcceptRecommendations hook to filter recommendations before accept, and runtime behaviors (placeholders, unaccepted recommendations dialog).

**TAGS**: fiori-elements-framework, OData V4, input assistance, recommendations, UI.Recommendations, Common.SideEffects, AppComponent, ControllerExtension, metadata

STEP: 1 — Model UI.Recommendations at the entity level
DESCRIPTION: Add the UI.Recommendations annotation referencing a complex property on the entity. This tells the Fiori elements runtime where recommendation payloads will be delivered in the entity instance.
LANGUAGE: XML
CODE:
```xml
<!-- Add UI.Recommendations at entity level -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage">
    <Annotation Term="UI.Recommendations" Path="SAP_Recommendations" />
</Annotations>

<!-- Entity property that holds the recommendations complex type -->
<EntityType Name="SalesOrderManage">
    <Key>
        <PropertyRef Name="ID"/>
    </Key>
    <Property Name="ID" Type="Edm.Guid" Nullable="false"/>
    <Property Name="ShippingCondition" Type="Edm.String" MaxLength="2"/>
    <NavigationProperty Name="_ShipToParty" Type="com.c_salesordermanage_sd.HeaderShipToParty" />
    <!-- This property points to the complex type that groups per-field recommendation collections -->
    <Property Name="SAP_Recommendations" Type="com.c_salesordermanage_sd.c_salesordermanage_sd_SalesOrderRecommendations"/>
</EntityType>
```

STEP: 2 — Define the complex type that groups recommendation-relevant properties
DESCRIPTION: Create a complex type whose properties map one-to-one to entity properties that can have recommendations. Each property is typically a Collection of a recommendation item complex type for that field.
LANGUAGE: XML
CODE:
```xml
<!-- Complex type that lists recommendation-enabled properties -->
<ComplexType Name="c_salesordermanage_sd_SalesOrderRecommendations">
    <!-- Each property here corresponds to an entity property that may have recommendations -->
    <Property Name="ShippingCondition" Type="Collection(com.c_salesordermanage_sd.c_salesordermanage_sd_ShippingConditionRecommendationType)" Nullable="false"/>
    <Property Name="ShipToParty" Type="Collection(com.c_salesordermanage_sd.c_salesordermanage_sd_ShipToPartyRecommendationType)" Nullable="false"/>
    <!-- Add more properties for other recommendation-enabled fields -->
</ComplexType>
```

STEP: 3 — Define per-field recommendation item complex types
DESCRIPTION: For each recommendation-enabled field, define a complex type that models the recommendation items returned by the backend. Preserve these properties exactly to match the runtime expectations.
LANGUAGE: XML
CODE:
```xml
<!-- Recommendation item structure for ShippingCondition -->
<ComplexType Name="c_salesordermanage_sd_ShippingConditionRecommendationType">
    <Property Name="RecommendedFieldValue" Type="Edm.String" MaxLength="2"/>
    <Property Name="RecommendedFieldDescription" Type="Edm.String" MaxLength="20"/>
    <Property Name="RecommendedFieldScoreValue" Type="Edm.Decimal" Scale="variable"/>
    <Property Name="RecommendedFieldIsSuggestion" Type="Edm.Boolean"/>
</ComplexType>

<!-- Recommendation item structure for ShipToParty -->
<ComplexType Name="c_salesordermanage_sd_ShipToPartyRecommendationType">
    <Property Name="RecommendedFieldValue" Type="Edm.String" MaxLength="10"/>
    <Property Name="RecommendedFieldDescription" Type="Edm.String" MaxLength="90"/>
    <Property Name="RecommendedFieldScoreValue" Type="Edm.Decimal" Scale="variable"/>
    <Property Name="RecommendedFieldIsSuggestion" Type="Edm.Boolean"/>
</ComplexType>
```

STEP: 4 — Recommendation item property meanings (use exactly)
DESCRIPTION: Use these property meanings when producing recommendation payloads. Note: RecommendedFieldIsSuggestion=true is used by the client to style the placeholder; Score is not used client-side.
LANGUAGE: JSON
CODE:
```json
{
  "RecommendedFieldValue": "string - recommended value",
  "RecommendedFieldDescription": "string - description (used for suggestions)",
  "RecommendedFieldScoreValue": "decimal - confidence score (backend use)",
  "RecommendedFieldIsSuggestion": "boolean - if true, appears as placeholder visually"
}
```

STEP: 5 — Ensure field labels match to appear correctly in Unaccepted Recommendations dialog
DESCRIPTION: The Unaccepted Recommendations dialog shows field labels from the property-level label. If the UI uses UI.DataField (e.g., in a DataField wrapper), ensure the property-level label equals the UI.DataField label to avoid inconsistent names in the dialog. Also the dialog groups by entity using UI.HeaderInfo.TypeName.
LANGUAGE: XML
CODE:
```xml
<!-- Example: ensure property-level label equals UI.DataField label -->
<Property Name="ShippingCondition" Type="Edm.String" sap:label="Shipping Condition"/>
<!-- If referenced via UI.DataField, use the same label -->
<Annotations Target="SomeEntity/ShippingCondition">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataField">
        <PropertyValue Property="Label" String="Shipping Condition"/>
        <PropertyValue Property="Value" Path="ShippingCondition"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: 6 — Trigger recommendations using Common.SideEffects
DESCRIPTION: Use side-effect annotations to request the SAP_Recommendations complex property be refreshed when source properties change. Include "SAP_Recommendations" in TargetProperties or a wildcard for nested properties to fetch recommendations for those fields.
LANGUAGE: XML
CODE:
```xml
<!-- Side-effect annotation example: when SoldToParty changes, fetch recommendations -->
<Annotation Term="Common.SideEffects" Qualifier="SoldToChangeSalesAreaShipTo">
    <Record Type="Common.SideEffectsType">
        <PropertyValue Property="SourceProperties">
            <Collection>
                <PropertyPath>SoldToParty</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="TargetProperties">
            <Collection>
                <String>DistributionChannel</String>
                <String>OrganizationDivision</String>
                <String>TotalNetAmount</String>
                <!-- Include the SAP_Recommendations complex property to pull recommendations -->
                <String>SAP_Recommendations</String>
                <!-- Example of fetching nested navigation properties too -->
                <String>_ShipToParty/*</String>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 7 — Runtime triggers that fetch new recommendations
DESCRIPTION: The client automatically requests recommendations on these events:
- New context creation (Create row or inline table creation)
- Draft load or Edit activation
- App state restoration / back navigation / page refresh (when draft visible)
- Section/tab scroll or table scrolling that brings new records into view
- Value change of a field configured to update recommendations (side-effect)
LANGUAGE: JSON
CODE:
```json
{
  "triggers": [
    "Create/new context loaded",
    "Draft object loaded (Edit)",
    "App state restore/back navigation/page refresh",
    "Scroll into new section/tab content",
    "Table scroll to new records",
    "Field value change configured for recommendation update (side-effect)"
  ]
}
```

STEP: 8 — Disable input assistance centrally from the front end
DESCRIPTION: If the backend metadata contains recommendation annotations but you want to disable recommendation behavior at runtime, toggle the feature in the AppComponent using initializeFeatureToggles() and changePageConfiguration(). The code below disables recommendations for an app route/manifest ID.
LANGUAGE: JavaScript
CODE:
```javascript
// Component.js (sap.ui.define)
sap.ui.define(["sap/fe/core/AppComponent"], function (AppComponent) {
    "use strict";
    return AppComponent.extend("recommendation-disableInputAssistance.Component", {
        // ...
        initializeFeatureToggles: function () {
            // Parameters: namespace, pageConfigurationId (manifest route or app id), boolean
            this.changePageConfiguration("sap.fe", "app/disableInputAssistance", true);
        }
    });
});
```

STEP: 9 — Implement onBeforeAcceptRecommendations hook to filter recommendations before accept
DESCRIPTION: Use the recommendations.onBeforeAcceptRecommendations controller extension hook to inspect and modify the recommendationData passed when users attempt to accept (or before showing the Unaccepted Recommendations dialog). Application must remove any recommendations for fields that already have non-empty values in the backend (server-side persisted values) before returning the recommendationData.
LANGUAGE: JavaScript / TypeScript
CODE:
```javascript
// Controller extension implementation (AMD style)
sap.ui.define(["sap/ui/core/mvc/ControllerExtension"], function (ControllerExtension) {
    "use strict";

    return ControllerExtension.extend("recommendation-basic.ext.OPExtend", {
        override: {
            recommendations: {
                // Hook called with params.recommendationData (array of RecommendationData objects)
                onBeforeAcceptRecommendations: async function (params) {
                    // params.recommendationData: array of RecommendationData objects
                    // Application must remove entries for fields which already have a non-empty value in the back end.

                    // Example: filter out items based on a backend validation call (pseudo)
                    const filtered = [];
                    for (const rec of params.recommendationData) {
                        // rec.contextIdentifier can be used to identify the entity instance
                        // rec.propertyPath is the field path (e.g., "ShippingCondition")
                        // Call your backend OData to verify whether the field already has a persisted value
                        const hasValue = await checkFieldHasValueInBackend(rec.contextIdentifier, rec.propertyPath);
                        if (!hasValue) {
                            filtered.push(rec);
                        }
                    }
                    params.recommendationData = filtered;
                    return;
                }
            }
        }
    });
});

// Example TypeScript type for RecommendationData
export type RecommendationData = {
    context?: any;                  // OData V4 context object
    contextIdentifier?: string[];   // keys identifying the context (entity)
    contextIdentifierText?: string[]; // textual keys for display
    propertyPath?: string;          // property path of the recommended field
    value?: string;                 // recommended value
    text?: string;                  // recommended text/description
}
```

STEP: 10 — Example helper snippet: filter recommendations by backend value existence
DESCRIPTION: Minimal reusable function pattern: check backend field value existence and filter recommendation array before accept.
LANGUAGE: TypeScript
CODE:
```typescript
// Pseudo-implementation: check if a field already has a non-empty value in backend
async function checkFieldHasValueInBackend(contextIdentifier: string[] | undefined, propertyPath: string): Promise<boolean> {
    // Implement OData read by key (contextIdentifier) and check propertyPath value
    // Return true if backend value is non-empty (recommendation should be suppressed)
    // Example: call /EntitySet(key)/propertyPath
    return false; // replace with actual backend call
}

async function filterRecommendationData(recommendationData: RecommendationData[]): Promise<RecommendationData[]> {
    const result: RecommendationData[] = [];
    for (const rec of recommendationData) {
        const hasValue = await checkFieldHasValueInBackend(rec.contextIdentifier, rec.propertyPath || "");
        if (!hasValue) {
            result.push(rec);
        }
    }
    return result;
}
```

STEP: 11 — Runtime nuances and restrictions (implementation checklist)
DESCRIPTION: Use this checklist when implementing recommendations:
- Placeholder for a recommended value is NOT shown when the field has a ValueState (back-end messages). Back-end messages take precedence.
- Recommendations are NOT supported for:
  - Fields without value help (except drop-down list fields)
  - Fields with business-defined values (side-effects)
  - Fields with multiple values (multi-value)
  - Custom fields
  - Fields whose value-help entity has more than one key field (e.g., Plant with PlantID + RegionID)
- Avoid marking empty as a recommended value when empty is a valid field value.
- Prefer not to hide recommendation fields or their containers in UI adaptation mode.
LANGUAGE: JSON
CODE:
```json
{
  "restrictions": [
    "No value help (except dropdown) -> no recommendations",
    "Business-defined values / side-effects -> no recommendations",
    "Multiple-value fields -> no recommendations",
    "Custom fields -> no recommendations",
    "Value help entity with >1 key field -> exclude from recommendations"
  ],
  "notes": [
    "If field has ValueState due to backend messages, do not show recommendation placeholder.",
    "Do not recommend empty if empty is a valid value."
  ]
}
```

STEP: 12 — Behavior for fields not in current view and unaccepted recommendations dialog
DESCRIPTION: Recommendations are fetched for fields not currently visible (hidden via personalization, not yet loaded sections). Unaccepted recommendations will be shown in the Unaccepted Recommendations dialog when the user tries to save/apply changes or activate a draft. The dialog groups recommendations by entity using UI.HeaderInfo.TypeName. Rejected recommendations are not shown again in the same editing session unless a context-changing action occurs.
LANGUAGE: JSON
CODE:
```json
{
  "behavior": {
    "hiddenFields": "recommendations fetched and included in Unaccepted Recommendations dialog",
    "saveAttempt": "if unaccepted recommendations exist -> show dialog listing recommended fields and values",
    "userActions": [
      "Accept all",
      "Reject all",
      "Return to edit mode to accept/reject individually"
    ],
    "rejectedRecommendations": "not displayed again in same editing session unless context changes"
  }
}
```
--------------------------------

**TITLE**: Interacting with a Fiori Elements Table (Table API control) — How to locate and use the control

**INTRODUCTION**: This guide shows how to find the Table API control id for SAP Fiori elements (OData V4) table building blocks, how to construct the id, and how to retrieve and interact with the control from the browser console or a controller extension. Use this to call Table API properties, aggregations, or public methods.

**TAGS**: fiori-elements-framework, ui5, table, TableAPI, ODataV4, manifest.json, controller-extension

**STEP**: 1 — Find ApplicationId in manifest.json

**DESCRIPTION**: Locate your application's id used as ApplicationId in the Table control id pattern. Open your project's manifest.json and read sap.app/id.

**LANGUAGE**: JSON

**CODE**:
```json
// Manifest excerpt: <project_root>/webapp/manifest.json
{
  "sap.app": {
    "id": "com.example.myApp", // <-- ApplicationId used in the Table control id
    "applicationVersion": { "version": "1.0.0" }
  },
  ...
}
```

**STEP**: 2 — Construct the full TableAPI control id string

**DESCRIPTION**: Use the following pattern to construct the control id you will search for in DevTools or pass to sap.ui.getCore().byId(). Replace ApplicationId, PageId and Entity/Navigation property as appropriate.
- Full pattern used in the browser: "<ApplicationId>::<PageId>–fe::table::<Entity or navigation property>::LineItem::Table"
- Short form usable inside controller extensions: "fe::table::<Entity or navigation property>::LineItem::Table"

Example variations:
- List report: "com.example.myApp::MainPage–fe::table::Products::LineItem::Table"
- Object page or custom page: "com.example.myApp::ObjectPage–fe::table::ToItems::LineItem::Table"

**LANGUAGE**: text

**CODE**:
```text
// Full id pattern (browser / global)
<ApplicationId>::<PageId>–fe::table::<Entity or navigation property>::LineItem::Table

// Short id (controller extension)
fe::table::<Entity or navigation property>::LineItem::Table

// Examples:
com.example.myApp::MainPage–fe::table::Products::LineItem::Table
fe::table::Products::LineItem::Table
```

**STEP**: 3 — Find and retrieve the TableAPI control from the browser console

**DESCRIPTION**: Use the browser DevTools to search for the id string. Then retrieve the control with sap.ui.getCore().byId() and inspect or invoke its properties, aggregations, models or methods. Use generic UI5 accessors (getAggregation, getModel, setProperty, etc.) to avoid relying on unlisted internal APIs.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// 1) Search the DOM (DevTools Elements or console) for the control id string constructed in STEP 2
// 2) Retrieve the control by id
var sId = "com.example.myApp::MainPage–fe::table::Products::LineItem::Table";
var oTable = sap.ui.getCore().byId(sId);

if (!oTable) {
  console.warn("Table control not found: ", sId);
} else {
  // 3) Inspect the control
  console.log(oTable);

  // Examples of safe interactions (use existing properties/aggregations/methods on the control)
  var oModel = oTable.getModel();                 // get bound model
  var aItems = oTable.getAggregation("items");    // access aggregation
  oTable.setBusy(true);                           // set standard property (if supported)
  // Call public API methods (if available on the control)
  // e.g., oTable.somePublicMethod(...);
}
```

**STEP**: 4 — Retrieve and use the TableAPI control inside a controller extension

**DESCRIPTION**: Inside a controller extension you can use the shorter id form and sap.ui.getCore().byId() to access the Table API. This example shows retrieving the control and performing safe interactions (aggregations/models/properties) in an extension method.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// In your controller extension (e.g., Controller.extend or in an extension hook)
// Short id form for controller extensions:
var sShortId = "fe::table::Products::LineItem::Table";
var oTable = sap.ui.getCore().byId(sShortId);

if (!oTable) {
  // Fallback: attempt full id if you know PageId & ApplicationId
  // var sFullId = "com.example.myApp::MainPage–fe::table::Products::LineItem::Table";
  // oTable = sap.ui.getCore().byId(sFullId);
  console.warn("Table API control not found using short id:", sShortId);
} else {
  // Example interactions:
  var oModel = oTable.getModel();
  var aColumns = oTable.getAggregation("columns");
  // Update a property if supported
  oTable.setProperty("busy", true);
  // After modification, clear busy
  oTable.setProperty("busy", false);
  // Call other public methods if present on the Table API
  // oTable.somePublicMethod(...);
}
```

**STEP**: 5 — References

**DESCRIPTION**: External references for Table API and live examples.

**LANGUAGE**: text

**CODE**:
```text
API Reference (Table building block): https://ui5.sap.com/#/api/sap.fe.macros.Table
Live examples / Building Blocks - Table: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/tableDefault
```
--------------------------------

**TITLE**: Key User Capabilities — Fiori Elements UI Adaptation (Overview Page)

**INTRODUCTION**: This document describes how key users enable and use the Adapt UI mode on Fiori elements Overview Page applications. It lists prerequisites, supported UI adaptation features, and actionable annotation examples to improve readability in the Adapt UI editor (PresentationVariant, SelectionVariant, DataPoint, IdentificationAnnotation, ChartAnnotation). Use the code examples to add labels/text that appear in the Adapt UI tooling.

**TAGS**: fiori-elements-framework, sapui5-flexibility, key-user, ui-adaptation, annotations, odata, cds

**STEP**: 1 — Prerequisites (Roles)
**DESCRIPTION**: Ensure the user has the required key-user role to open Adapt UI. Assign the appropriate role depending on deployment.
**LANGUAGE**: text
**CODE**:
```text
SAP Business Technology Platform (cloud):
  - Role required: FlexKeyUser

On-premise SAP:
  - Role required: SAP_UI_FLEX_KEY_USER

Action:
  - Verify role assignment in your platform (BTP cockpit or on-premise user/role management).
  - After role assignment, the user menu will show "Adapt UI".
```

**STEP**: 2 — Enable Adaptation Mode
**DESCRIPTION**: How to open the UI adaptation editor in the running app.
**LANGUAGE**: text
**CODE**:
```text
1. Open the Fiori Overview Page application in the browser.
2. Open the user menu (top-right).
3. Choose "Adapt UI".
4. Use the editor to hide/add/edit cards, modify card sizes, manage views, adapt filters and variants, and perform basic operations (cut, copy, paste, save, cancel, reset, publish).
```

**STEP**: 3 — UI Adaptation Features (quick reference)
**DESCRIPTION**: Machine-friendly list of supported UI adaptation features and their high-level behaviors for automation or documentation ingestion.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "features": [
    {
      "id": "hideCard",
      "title": "Hide Card",
      "description": "Hide cards during initial load. Hidden cards remain available under Manage Cards."
    },
    {
      "id": "addCard",
      "title": "Add Card",
      "description": "Add cards from the list of available (hidden) cards."
    },
    {
      "id": "editCard",
      "title": "Edit Card",
      "description": "Modify title, subtitle, KPI header/value/description, chart type, sorting, navigation, and (for column charts) threshold-based semantic coloring. Optionally disable adding cards to Insights."
    },
    {
      "id": "addDeleteViews",
      "title": "Add/Delete Views",
      "description": "Add or remove view switch fields for cards."
    },
    {
      "id": "modifyCardSize",
      "title": "Modify Card Size",
      "description": "Resize cards, change number of rows and columns."
    },
    {
      "id": "createCard",
      "title": "Create Card",
      "description": "Create new cards (static link list card and KPI card supported)."
    },
    {
      "id": "basicOperations",
      "title": "Basic Operations",
      "description": "Cut, copy, paste, save, cancel, reset, and publish changes."
    },
    {
      "id": "adaptFilters",
      "title": "Adapt Filters",
      "description": "Add/remove filters and set values. Save changes to variants."
    },
    {
      "id": "adaptVariants",
      "title": "Adapt Variants",
      "description": "Rename, save, save-as, and manage view variants."
    }
  ]
}
```

**STEP**: 4 — Best Practices (annotation labels for Adapt UI tooling)
**DESCRIPTION**: Adapt UI editor shows annotation labels/text. Maintain descriptive label/text properties for the following annotations to improve the editing UX. The examples below use OData V4/XML annotation syntax. For other formats (CDS or JSON), map the shown properties to equivalent annotation keys (Text, Title, Label, Description).
**LANGUAGE**: text
**CODE**:
```text
Mapping summary (what to populate so Adapt UI shows clear names):
  - PresentationVariant  -> Text
  - SelectionVariant     -> Text
  - DataPoint            -> Title
  - IdentificationAnnotation -> set Label on DataFieldForIntentBasedNavigation / DataFieldWithURL (priority affects display)
  - ChartAnnotation      -> Description
```

**STEP**: 5 — PresentationVariant example (OData V4 XML)
**DESCRIPTION**: Add a human-readable Text to a PresentationVariant so it appears in Adapt UI editor.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- PresentationVariant with Text label -->
<Annotations Target="Namespace.EntityType">
  <Annotation Term="UI.PresentationVariant">
    <Record>
      <PropertyValue Property="Text" String="Top Customers by Revenue"/>
      <!-- additional PresentationVariant config (SortOrder, Visualizations) -->
      <PropertyValue Property="SortOrder">
        <Collection>
          <Record>
            <PropertyValue Property="Property" PropertyPath="Revenue"/>
            <PropertyValue Property="Descending" Bool="true"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 6 — SelectionVariant example (OData V4 XML)
**DESCRIPTION**: Provide Text for SelectionVariant to label filter sets in the Adapt UI.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- SelectionVariant with Text label -->
<Annotations Target="Namespace.EntityType">
  <Annotation Term="UI.SelectionVariant">
    <Record>
      <PropertyValue Property="Text" String="Filters: Country + Status"/>
      <!-- SelectionFields or Parameters can be defined here -->
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 7 — DataPoint example (OData V4 XML)
**DESCRIPTION**: Set Title for DataPoint annotations (KPI cards) so the Adapt UI and card editor display meaningful names.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- DataPoint with Title and Value -->
<Annotations Target="Namespace.EntityType">
  <Annotation Term="UI.DataPoint" Qualifier="TopRevenue">
    <Record>
      <PropertyValue Property="Title" String="Total Revenue"/>
      <PropertyValue Property="Value" Path="RevenueAmount"/>
      <PropertyValue Property="Unit" Path="Currency"/>
      <PropertyValue Property="TargetValue" Path="RevenueTarget"/>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 8 — IdentificationAnnotation / DataFieldForIntentBasedNavigation example (OData V4 XML)
**DESCRIPTION**: Provide Label on DataFieldForIntentBasedNavigation (or DataFieldWithUrl) so identification lists and navigation fields show clear labels in the Adapt UI. The editor chooses the label based on configured priority.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- IdentificationAnnotation with DataFieldForIntentBasedNavigation containing a Label -->
<Annotations Target="Namespace.EntityType">
  <Annotation Term="UI.Identification">
    <Collection>
      <Record Type="UI.DataFieldForIntentBasedNavigation">
        <PropertyValue Property="Label" String="Customer ID"/>
        <PropertyValue Property="Value" Path="CustomerID"/>
        <PropertyValue Property="SemanticObject" String="Customer"/>
        <PropertyValue Property="Action" String="displayCustomer"/>
      </Record>
      <Record Type="UI.DataFieldWithUrl">
        <PropertyValue Property="Label" String="Website"/>
        <PropertyValue Property="Url" Path="WebsiteUrl"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 9 — Chart annotation example (OData V4 XML)
**DESCRIPTION**: Add Description to chart annotations so chart cards are labeled and searchable in the Adapt UI.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Chart annotation with Description -->
<Annotations Target="Namespace.EntityType/ChartEntitySet">
  <Annotation Term="UI.Chart" Qualifier="SalesByRegion">
    <Record>
      <PropertyValue Property="Description" String="Sales by Region - Quarterly"/>
      <!-- Define Measures, Dimensions, and other chart properties -->
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 10 — Implementation notes for CDS / Other annotation formats
**DESCRIPTION**: If you use ABAP CDS or a different annotation mechanism, set the equivalent annotation properties (Text, Title, Label, Description) in your CDS annotations or annotation JSON. The goal is to populate the same metadata keys so the Adapt UI editor surface displays meaningful names.
**LANGUAGE**: text
**CODE**:
```text
- ABAP CDS: use corresponding @UI.* annotations to provide Title/Text/Label/Description.
- OData annotation files: use UI.PresentationVariant, UI.SelectionVariant, UI.DataPoint, UI.Identification, UI.Chart and set Text/Title/Label/Description as shown.
- Verify in the running application: open Adapt UI and confirm labels show as expected.
```
--------------------------------

**TITLE**: Key Value Facet (UI.DataPoint)

**INTRODUCTION**: Use UI.DataPoint annotations to render title and value pairs (key-value facet) in Fiori Elements. These annotations can be defined in XML, ABAP CDS, or CAP CDS. You can also bind Criticality to color the value. When a UI.ReferenceFacet points to a UI.DataPoint (by qualifier), the DataPoint title and value are shown in the Key Value Facet.

**TAGS**: fiori-elements-framework, UI.DataPoint, KeyValueFacet, annotations, CDS, CAP, ABAP, XML, criticality, navigation

**STEP**: Basic UI.DataPoint (XML)
**DESCRIPTION**: Define a UI.DataPoint annotation in XML. Use the Qualifier to reference this DataPoint from a UI.ReferenceFacet elsewhere.
**LANGUAGE**: XML
**CODE**:
```XML
<Annotation Term="UI.DataPoint" Qualifier="ProductCategory">
  <Record>
    <PropertyValue Property="Value" Path="ProductCategory"/>
    <PropertyValue Property="Title" String="{@i18n>ProductCategory}"/>
  </Record>
</Annotation>
```

**STEP**: Basic UI.DataPoint (ABAP CDS)
**DESCRIPTION**: Equivalent ABAP CDS snippet to expose a DataPoint with a localized title. Place this in the relevant CDS view (annotate the element).
**LANGUAGE**: ABAP CDS
**CODE**:
```ABAP
@UI.dataPoint: {
  title: '{@i18n>@ProductCategory}'
}
ProductCategory;
```

**STEP**: Basic UI.DataPoint (CAP CDS)
**DESCRIPTION**: Equivalent CAP CDS annotation (service model). Use the qualifier to reference the DataPoint from a UI.ReferenceFacet.
**LANGUAGE**: CDS
**CODE**:
```CDS
UI.DataPoint #ProductCategory : {
    Value : ProductCategory,
    Title : '{@i18n>@ProductCategory}'
}
```

**STEP**: DataPoint with Criticality (XML)
**DESCRIPTION**: Bind the Criticality property to a service property/path to render the DataPoint with color based on criticality values.
**LANGUAGE**: XML
**CODE**:
```XML
<Annotation Term="UI.DataPoint" Qualifier="StockAvailability">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Availability" />
    <PropertyValue Property="Value" Path="stock/availability" />
    <PropertyValue Property="Criticality" Path="stock/availability"/>
  </Record>
</Annotation>
```

**STEP**: DataPoint with Criticality (ABAP CDS)
**DESCRIPTION**: ABAP CDS example binding criticality to a data element or path. Place with the field definition or view element.
**LANGUAGE**: ABAP CDS
**CODE**:
```ABAP
@UI.dataPoint: {
  title: 'Availability',
  criticality: 'stock/availability'
}
stock/availability;
```

**STEP**: DataPoint with Criticality (CAP CDS)
**DESCRIPTION**: CAP CDS example for DataPoint with criticality and explicit Title and Value mappings.
**LANGUAGE**: CDS
**CODE**:
```CDS
UI.DataPoint #StockAvailability : {
    Value : stock/availability,
    Title : Availability,
    Criticality : stock/availability
}
```

**STEP**: Semantic Object Tip (behavior note)
**DESCRIPTION**: If you add a semantic object annotation to the DataPoint value, the value is rendered as a navigation link but will not display criticality styling. For guidance on adding semantic object annotations and outbound navigation, see:
- Navigation from an App (Outbound Navigation): navigation-from-an-app-outbound-navigation-d782acf.md

**STEP**: Enable Navigation from DataPoint Title (additional feature)
**DESCRIPTION**: Fiori Elements (OData V4) supports enabling in-page and external navigation from a DataPoint title. For setup details see:
- Navigation from Header Facet Title: navigation-from-header-facet-title-fa0ca22.md
--------------------------------

**TITLE**: Keyboard Shortcuts — SAP Fiori elements (OData V2 & V4)

**INTRODUCTION**: This document summarizes available standard keyboard shortcuts and provides precise, copy-pasteable examples for:
- Redirecting standard shortcuts to custom action handlers (OData V2).
- Adding custom keyboard shortcuts for custom actions and navigation (OData V2 & V4).
- Mapping annotation-based actions to commands and commands to shortcuts (OData V4).
Use these snippets to update manifest.json, annotations, and controller extensions.

**TAGS**: keyboard-shortcuts, manifest.json, sap.ui.commands, DataFieldForAction, DataFieldForIntentBasedNavigation, OData V2, OData V4, ListReport, ObjectPage

STEP: 1 — Standard keyboard shortcuts (machine-friendly list)

DESCRIPTION: Use this JSON structure as a canonical reference in code generators or docs to determine platform-specific keys, prerequisites, applicable floorplans and result descriptions.

LANGUAGE: JSON

CODE:
```json
{
  "shortcuts": [
    {
      "action": "Cancel/Discard Draft",
      "windows": "Esc",
      "mac": "Esc",
      "prerequisite": "Focus anywhere on the object page in edit mode",
      "floorplans": ["Object page"],
      "result": "Same as clicking Cancel (non-draft) or Discard Draft (draft apps)"
    },
    {
      "action": "Create",
      "windows": "Ctrl+Enter",
      "mac": "Cmd+Enter",
      "prerequisite": "Focus set on the table",
      "floorplans": ["List report","Object page"],
      "result": "Same as choosing Create"
    },
    {
      "action": "CreateWithFilters",
      "note": "Not applicable to SAP Fiori elements for OData V4",
      "windows": "Shift+Ctrl+Enter",
      "mac": "Shift+Cmd+Enter",
      "prerequisite": "Focus on the table",
      "floorplans": ["List report"],
      "result": "Same as choosing Create With Filters"
    },
    {
      "action": "Delete (page level)",
      "windows": "Ctrl+Delete",
      "mac": "Cmd+Fn+Delete (use ← if no delete key)",
      "prerequisite": "Focus anywhere on the object page in display mode",
      "floorplans": ["Object page"],
      "result": "Same as choosing Delete on the object page"
    },
    {
      "action": "Delete (table entry)",
      "windows": "Ctrl+D",
      "mac": "Cmd+D",
      "prerequisite": "Focus on the table; selection required for multi-delete or focus on an item for single delete",
      "floorplans": ["List report","Object page"],
      "result": "Same as choosing Delete in a table; only works on read-only/display-only content"
    },
    {
      "action": "Edit (page level)",
      "windows": "Ctrl+E",
      "mac": "Cmd+E",
      "prerequisite": "Focus anywhere on the object page",
      "floorplans": ["Object page"],
      "result": "Same as choosing Edit on the object page"
    },
    {
      "action": "Export As",
      "windows": "Shift+Ctrl+E",
      "mac": "Shift+Cmd+E",
      "prerequisite": "Focus set on the table",
      "floorplans": ["Analytical list page","List report","Object page"],
      "result": "Same as choosing Export to Excel > Export As"
    },
    {
      "action": "Go (SmartFilterBar)",
      "windows": "Enter/Return",
      "mac": "Enter/Return",
      "prerequisite": "Focus in SmartFilterBar input field",
      "floorplans": ["Analytical list page","List report","Object page"],
      "result": "Triggers search in the SmartFilterBar"
    },
    {
      "action": "Open Error List",
      "windows": "Ctrl+Shift+M",
      "mac": "Cmd+Shift+M",
      "prerequisite": "Focus anywhere on the object page in edit mode",
      "floorplans": ["Object page"],
      "result": "Same as choosing the Error button"
    },
    {
      "action": "Save (page level)",
      "windows": "Ctrl+S",
      "mac": "Cmd+S",
      "prerequisite": "Page in edit mode; focus anywhere on object page",
      "floorplans": ["Object page"],
      "result": "Same as choosing Save on the object page"
    },
    {
      "action": "Select row in analytical or grid tables",
      "windows": "Shift+Space",
      "mac": "Shift+Space",
      "prerequisite": "Focus on a table cell",
      "floorplans": ["Analytical list page","List report","Object page"],
      "result": "Selects entire row when focus is on a cell"
    },
    {
      "action": "Share",
      "note": "Not applicable to SAP Fiori elements for OData V4",
      "windows": "Shift+Ctrl+S",
      "mac": "Shift+Cmd+S",
      "prerequisite": "Focus anywhere on list report or object page",
      "floorplans": ["Analytical list page","List report","Object page"],
      "result": "Opens share ActionSheet (if focus is on filter bar, opens near Share button)"
    },
    {
      "action": "Table settings",
      "windows": "Ctrl+,",
      "mac": "Ctrl+,",
      "prerequisite": "Focus on the table",
      "floorplans": ["Analytical list page","List report","Object page"],
      "result": "Same as choosing Table Settings button"
    }
  ]
}
```

STEP: 2 — Redirect standard shortcuts to custom actions (OData V2)

DESCRIPTION: To have a custom action handle a standard keyboard shortcut (Create/Delete/Edit/Save), add the logicalAction property in the manifest action definition. The custom action must satisfy the same rendering conditions as the standard action (e.g. Create must be renderable).

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.controllerExtensions": {
    "sap.suite.ui.generic.template.ListReport.view.ListReport": {
      "controllerName": "STTA_SO_ND.ext.controller.ListReportExtension",
      "sap.ui.generic.app": {
        "STTA_C_SO_SalesOrder_ND": {
          "EntitySet": "STTA_C_SO_SalesOrder_ND",
          "Actions": {
            "CreateExt": {
              "id": "CreateExt",
              "text": "Create (Ext)",
              "press": "onCreateWithParameters",
              "logicalAction": "Create"
            }
          }
        }
      }
    }
  }
}
```

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.controllerExtensions": {
    "sap.suite.ui.generic.template.ObjectPage.view.Details": {
      "controllerName": "STTA_SO_ND.ext.controller.DetailsExtension",
      "sap.ui.generic.app": {
        "STTA_C_SO_SalesOrder_ND": {
          "EntitySet": "STTA_C_SO_SalesOrder_ND",
          "Header": {
            "Actions": {
              "MySmartTableDelete": {
                "id": "customdelete",
                "text": "Custom Delete",
                "press": "fnCustomDelete",
                "logicalAction": "Delete"
              }
            }
          },
          "Sections": {
            "to_Item::com.sap.vocabularies.UI.v1.LineItem": {
              "id": "to_Item::com.sap.vocabularies.UI.v1.LineItem",
              "Actions": {
                "MySmartTableCreate": {
                  "id": "customcreate",
                  "text": "CustomCreate",
                  "press": "fnCustomCreate",
                  "logicalAction": "Create"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — Redirectable shortcuts list (OData V2) — supported logicalAction values

DESCRIPTION: These are the standard shortcuts that can be redirected by adding logicalAction in manifest actions.

LANGUAGE: JSON

CODE:
```json
{
  "redirectableShortcuts": {
    "ListReport": ["Create (Ctrl+Enter)", "CreateWithFilters (Shift+Ctrl+Enter)", "Delete (Ctrl+D)"],
    "ObjectPage": {
      "Header": ["Save (Ctrl+S)", "Edit (Ctrl+E)", "Delete (Ctrl+Delete)"],
      "Sections": ["Create (Ctrl+Enter)", "Delete (Ctrl+D)"]
    }
  }
}
```

STEP: 4 — Define new keyboard shortcuts for custom actions (manifest.json) — example (OData V2)

DESCRIPTION: Define a sap.ui.commands entry under "extends" and connect the command to the action via the action's "command" property. The description appears in the keyboard shortcuts popup; if missing, the action id is used.

LANGUAGE: JSON

CODE:
```json
{
  "extends": {
    "extensions": {
      "sap.ui.commands": {
        "sap.suite.ui.generic.template.ListReport#sap.suite.ui.generic.template.ListReport::STTA_C_MP_Product": {
          "ChangePriceCommand": {
            "shortcut": "Ctrl+G",
            "description": "Change Price"
          }
        }
      },
      "sap.ui.controllerExtensions": {
        "sap.suite.ui.generic.template.ListReport.view.ListReport": {
          "controllerName": "STTA_MP.ext.controller.ListReportExtension",
          "sap.ui.generic.app": {
            "STTA_C_MP_Product": {
              "EntitySet": "STTA_C_MP_Product",
              "Actions": {
                "ChangePrice": {
                  "id": "ChangePrice",
                  "text": "Change price",
                  "press": "onChangePrice",
                  "command": "ChangePriceCommand"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Define keyboard shortcut for DataFieldForAction (annotation + manifest) (OData V2 / V4)

DESCRIPTION: For an action defined as UI.DataFieldForAction, add the annotation (XML example) and map it to a command in manifest.json using the page/component settings. Then add the command to sap.ui.commands with the desired shortcut.

LANGUAGE: XML

CODE:
```xml
<!-- Annotation: DataFieldForAction pointing to a FunctionImport -->
<Record Type="UI.DataFieldForAction">
    ...
    <PropertyValue Property="Action" String="<Schema Namespace>.<EntityContainer Name>/<FunctionImport Name>" />
</Record>
```

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.commands": {
          "<Component Name>#<Component ID without app ID prefix>": {
            "<Command Name>": {
              "shortcut": "Ctrl+B"
            }
          }
        }
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|<Entity Set Name>": {
        "component": {
          "settings": {
            "annotatedActions": {
              "<FunctionImport Name>": {
                "command": "<Command Name>"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 6 — Define keyboard shortcut for DataFieldForIntentBasedNavigation (annotation + manifest) (OData V2 / V4)

DESCRIPTION: For navigation actions based on UI.DataFieldForIntentBasedNavigation, ensure a corresponding outbound exists (same semanticObject & action), then map the outbound to a command and define the command shortcut in sap.ui.commands.

LANGUAGE: XML

CODE:
```xml
<!-- Annotation: DataFieldForIntentBasedNavigation -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
    <PropertyValue Property="SemanticObject" String="<Semantic Object>" />
    <PropertyValue Property="Action" String="<Action>" />
</Record>
```

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "crossNavigation": {
      "inbounds": {},
      "outbounds": {
        "<Outbound Navigation Name>": {
          "semanticObject": "<Semantic Object>",
          "action": "<Action>"
        }
      }
    }
  },
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.commands": {
          "<Component Name>#<Component ID without app ID prefix>": {
            "<Command Name>": {
              "shortcut": "Ctrl+B"
            }
          }
        }
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|<Entity Set Name>": {
        "component": {
          "settings": {
            "outbounds": {
              "<Outbound Navigation Name>": {
                "command": "<Command Name>"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 7 — Triggering default positive action with standard shortcut (OData V4)

DESCRIPTION: In ListReport/ObjectPage/SubobjectPage, Ctrl+Enter (Windows) or Cmd+Return (Mac) triggers the default positive action unless focus is on a control that uses the same keys. Default positive actions:
- List report: Go button on the filter bar
- Object page: positive semantic action (or Edit in display mode / Save in edit mode if none defined)
- Subobject page: application-defined positive semantic action (or Apply if none)

LANGUAGE: JSON

CODE:
```json
{
  "defaultPositiveActions": {
    "ListReport": "FilterBar.Go",
    "ObjectPage": "positive semantic action defined by app (fallback: Edit or Save)",
    "SubobjectPage": "application defined (fallback: Apply)",
    "note": "Shortcut respects nearest control: table-level create may take precedence when focus is on a table"
  }
}
```

STEP: 8 — OData V4: mapping annotation action -> command -> shortcut (two-step process)

DESCRIPTION: For OData V4 add a "command" mapping for the annotated action and then define the command in sap.ui.commands. Use object page instance ID with '#' to scope to a specific page instance when necessary.

LANGUAGE: JSON

CODE:
```json
{
  "@com.sap.vocabularies.UI.v1.LineItem": {
    "actions": {
      "DataFieldForAction::com.c_salesordermanage_sd.CreateWithSalesOrderType": {
        "command": "BOUND"
      }
    }
  }
}
```

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.commands": {
          "sap.fe.templates.ListReport": {
            "BOUND": {
              "shortcut": "Ctrl+B"
            }
          },
          "sap.fe.templates.ObjectPage": {
            "IBNI": {
              "shortcut": "Ctrl+K"
            }
          },
          "sap.fe.templates.ObjectPage#SalesOrderManageObjectPage": {
            "IBNI": {
              "shortcut": "Ctrl+I"
            }
          }
        }
      }
    }
  }
}
```

STEP: 9 — Important notes, restrictions and best practices (concise)

DESCRIPTION: Keep these rules in code and generator logic:
- Do not reuse standard shortcut keys for custom shortcuts (avoid conflicts).
- A shortcut triggers only within the control that holds the button, except header/footer global buttons which trigger irrespective of focus unless overridden by a nearer control.
- Inline table actions (inline primary or inline navigation) do NOT support custom keyboard shortcuts.
- When overriding a standard action with logicalAction, the application must satisfy all rendering conditions for the standard action to be renderable.
- For object page commands, append page ID using "#" to target specific object page instances.

LANGUAGE: JSON

CODE:
```json
{
  "notes": [
    "Avoid assigning custom shortcuts that conflict with standard shortcuts",
    "Header/footer buttons are global; toolbar/table actions are local to focus",
    "Inline table actions are not supported for custom shortcuts",
    "logicalAction replacement requires same rendering conditions as standard action",
    "Use Component#ObjectPageID to scope commands to a specific object page instance"
  ]
}
```
--------------------------------

**TITLE**: Line Chart Card (Fiori Elements)

**INTRODUCTION**: Quick, code-focused reference for implementing a Line Chart card in a Fiori Elements application. Shows how to declare the chart using OData/UI annotations (XML or CDS) and how to register the annotation file in the app manifest. Includes guidance for mapping dimension/series/category roles, multiple measures (multiple lines), and enabling semantic coloring via DataPoint annotations.

**TAGS**: fiori-elements-framework, line-chart, annotations, com.sap.vocabularies.UI.v1.Chart, manifest, CDS, OData, semantic-coloring

STEP: 1 — Add OData UI Chart annotations (XML)

DESCRIPTION: Create an OData annotation file that declares a Line chart (com.sap.vocabularies.UI.v1.Chart). Specify chart type = Line, list measures and dimensions. The first dimension with role "category" is the x-axis; dimensions with role "series" create separate lines/colors. If no explicit role property is available in your toolchain, the first dimension is treated as category; add a time-based dimension for the category axis when possible.

LANGUAGE: XML

CODE:
```xml
<!-- File: app/annotations/LineChart.annotations.xml -->
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:DataServices>
    <Annotations Target="MyService.SalesEntity">
      <!-- Line chart declaration -->
      <Annotation Term="com.sap.vocabularies.UI.v1.Chart">
        <Record>
          <!-- Title shown in the chart card -->
          <PropertyValue Property="Title" String="Sales Over Time" />
          <!-- Chart type: Line -->
          <PropertyValue Property="ChartType" EnumMember="com.sap.vocabularies.UI.v1.ChartType/Line" />
          <!-- Measures = y-axis values (one or more measures -> multiple lines) -->
          <PropertyValue Property="Measures">
            <Collection>
              <PropertyPath>SalesAmount</PropertyPath>
              <!-- Add additional measures here; each measure will become a separate colored line -->
            </Collection>
          </PropertyValue>
          <!-- Dimensions = x-axis (category) and series. Order matters if your tooling uses the first dimension as category -->
          <PropertyValue Property="Dimensions">
            <Collection>
              <!-- Recommended: use a time-based dimension for the category (x) axis -->
              <PropertyPath>SalesYear</PropertyPath>   <!-- treated as category (x-axis) -->
              <!-- Series dimension: splits lines by distinct values and assigns colors -->
              <PropertyPath>Region</PropertyPath>      <!-- treated as series -->
            </Collection>
          </PropertyValue>
        </Record>
      </Annotation>

      <!-- OPTIONAL: Semantic coloring - define a DataPoint for the measure to enable criticality/semantic colors -->
      <Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="SalesAmountDP">
        <Record>
          <!-- Bind the DataPoint to the measure value -->
          <PropertyValue Property="Value" Path="SalesAmount" />
          <!-- Example: set static criticality or implement a CriticalityCalculation expression -->
          <PropertyValue Property="Criticality" EnumMember="com.sap.vocabularies.UI.v1.Criticality/Neutral" />
        </Record>
      </Annotation>

      <!-- If your toolchain supports referencing DataPoint from the Chart measure, declare that relation (tool-specific). -->
    </Annotations>
  </edmx:DataServices>
</edmx:Edmx>
```

STEP: 2 — Add CDS-style annotations (CAP / CDS source)

DESCRIPTION: If you author metadata in CDS (CAP), annotate the entity using UI chart annotations. This example shows an equivalent CDS-based annotation for a Line chart. Use a time-based dimension for category (x-axis) and a separate dimension for series (different lines). Add DataPoint annotation on a measure to enable semantic coloring if desired.

LANGUAGE: CDS

CODE:
```cds
// File: srv/schema.cds
using { cuid } from '@sap/cds/common';

entity Sales {
  key ID        : UUID;
  SalesYear     : Integer;
  Region        : String(50);
  SalesAmount   : Decimal(15,2);
}

// UI annotations (CDS flavor). Many toolchains accept @com.sap.vocabularies.UI.v1.Chart or @UI.chart
annotate Sales with {
  @com.sap.vocabularies.UI.v1.Chart: {
    Title: 'Sales Over Time',
    ChartType: #Line,
    Measures: [ SalesAmount ],
    Dimensions: [ SalesYear, Region ] /* SalesYear -> category (x-axis); Region -> series (lines) */
  };

  /* Optional DataPoint to enable semantic coloring on the measure */
  @com.sap.vocabularies.UI.v1.DataPoint: {
    Value: { Path: 'SalesAmount' },
    Criticality: #Neutral
  } on SalesAmount;
}
```

STEP: 3 — Register annotation file in manifest (Fiori Elements app)

DESCRIPTION: Reference the annotation file from the app manifest so the Fiori Elements runtime reads your chart annotations. Place the annotation file under webapp/annotations or app/annotations and point the model settings.annotations entry to it.

LANGUAGE: JSON

CODE:
```json
// File: webapp/manifest.json (snippet)
{
  "sap.app": {
    "id": "com.example.sales"
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "annotations": [
            "annotations/LineChart.annotations.xml"
          ]
        }
      }
    }
  },
  "sap.ui": {
    "technology": "UI5"
  },
  "sap.app": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/ZSALES_SRV/",
        "type": "OData",
        "settings": {
          "odataVersion": "4.0"
        }
      }
    }
  }
}
```

STEP: 4 — Mapping guidance & best practices

DESCRIPTION: Quick actionable rules to follow when implementing line charts.

LANGUAGE: Plain text (follow in code)

CODE:
```text
- Category axis (x-axis): Use a time-based dimension where possible (day, date, quarter, year).
- Series: Use a separate dimension for series to get multiple colored lines by dimension value.
- Measures: Each measure becomes a separate line on the y-axis (value axis) when multiple measures are declared.
- If no explicit "category" role is available, the first declared dimension is treated as the category axis.
- Semantic coloring: Provide a DataPoint annotation (Criticality/CriticalityCalculation) for the measure(s) to enable semantic colors in the chart.
- Color palette: Use the platform's default color palette for series; many runtimes accept custom palettes via visualization configuration (tool-specific).
```

STEP: 5 — Quick example: Minimal end-to-end file layout

DESCRIPTION: Minimal file layout and which files contain which code fragments for a Fiori Elements app with a Line Chart.

LANGUAGE: Plain text (file layout)

CODE:
```text
app/
  annotations/
    LineChart.annotations.xml   <-- OData UI Chart annotation (see Step 1)
  webapp/
    manifest.json                <-- references annotation file (see Step 3)
srv/
  schema.cds                     <-- CDS model + annotations alternative (see Step 2)
```


--------------------------------

**TITLE**: Line Micro Chart — Annotations and Examples for Fiori Elements (OData V4)

**INTRODUCTION**: This reference shows the required annotations and concrete examples (XML, ABAP CDS, CAP CDS) to implement a Line Micro Chart in SAP Fiori Elements (OData V4). Use these snippets to annotate your service/view fields so the framework renders a Line Micro Chart (UI.Chart with ChartType = Line). Includes UI.Chart, UI.DataPoint, mandatory rules, and support for string-based calendar dimensions.

**TAGS**: fiori-elements-framework, UI.Chart, UI.DataPoint, LineMicroChart, annotations, ODataV4, CDS, CAP, ABAP, XML

STEP: UI.Chart — XML Annotation
DESCRIPTION: Add a UI.Chart annotation with ChartType = Line. Define Title, Description, Measures, Dimensions, and MeasureAttributes. Ensure each measure that should be plotted has a corresponding MeasureAttribute with a DataPoint annotation path.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Chart" Qualifier="SpecificationWidthLineChart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Product Width Specification Line Chart"/>
        <PropertyValue Property="Description" String="Describe Line Chart"/>
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Line"/>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>Width</PropertyPath>
                <PropertyPath>Depth</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="Dimensions">
            <Collection>
                <PropertyPath>Day</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
             <Collection>
                  <Record Type="UI.ChartMeasureAttributeType">
                       <PropertyValue Property="Measure" PropertyPath="Width"/>
                       <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2"/>
                       <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Width"/>
                  </Record>
                  <Record Type="UI.ChartMeasureAttributeType">
                      <PropertyValue Property="Measure" PropertyPath="Depth"/>
                      <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2"/>
                      <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Depth"/>
                  </Record>
              </Collection>
         </PropertyValue>
    </Record>
</Annotation>
```

STEP: UI.Chart — ABAP CDS Annotation
DESCRIPTION: Annotate an ABAP CDS view with @UI.Chart metadata. Set chartType to #LINE, list measures and dimensions, and set measureAttributes with role and asDataPoint if DataPoint is used.
LANGUAGE: ABAP CDS
CODE:
```
@UI.Chart: [
  {
    title: 'Product Width Specification Line Chart',
    description: 'Describe Line Chart',
    chartType: #LINE,
    measures: [
      'WIDTH',
      'DEPTH'
    ],
    dimensions: [
      'DAY',
      'DAY'
    ],
    measureAttributes: [
      {
        measure: 'Width',
        role: #AXIS_2,
        asDataPoint: true
      },
      {
        measure: 'Depth',
        role: #AXIS_2,
        asDataPoint: true
      }
    ],
    qualifier: 'SpecificationWidthtLineChart'
  }
]
annotate view STTA_C_MP_PRODUCT with {

}
```

STEP: UI.Chart — CAP CDS Annotation
DESCRIPTION: Use CAP CDS UI.Chart definition with $Type UI.ChartDefinitionType. Provide Measures, Dimensions, and MeasureAttributes using DataPoint annotation references.
LANGUAGE: CDS (CAP)
CODE:
```
UI.Chart #SpecificationWidthLineChart : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Product Width Specification Line Chart',
    Description : 'Describe Line Chart',
    ChartType : #Line,
    Measures : [
        Width,
        Depth
    ],
    Dimensions : [
        Day,
        Day
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Width,
            Role : #Axis2,
            DataPoint : '@UI.DataPoint#Width'
        },
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Depth,
            Role : #Axis2,
            DataPoint : '@UI.DataPoint#Depth'
        }
    ]
}
```

STEP: UI.DataPoint — XML Annotation
DESCRIPTION: Define UI.DataPoint annotations referenced by MeasureAttributes.DataPoint. Include Value path and Criticality to enable semantic coloring. Use qualifiers that match the DataPoint reference in MeasureAttributes (e.g., #Width, #Depth).
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Width">
    <Record>
        <PropertyValue Property="Value" Path="Width"/>
        <PropertyValue Property="Criticality" Path="criticalityValue"/>
    </Record>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="Depth">
    <Record>
        <PropertyValue Property="Value" Path="Depth"/>
        <PropertyValue Property="Criticality" Path="criticalityValue"/>
    </Record>
</Annotation>
```

STEP: UI.DataPoint — ABAP CDS Annotation
DESCRIPTION: Example ABAP CDS data point annotations. Attach @UI.dataPoint to the element or element declaration to mark value and criticality.
LANGUAGE: ABAP CDS
CODE:
```
@UI.dataPoint: {
  targetValueElement: 'Weight',
  criticality: 'criticalityValue'
}
Width;

@UI.dataPoint: {
  criticality: 'criticalityValue'
}
Depth;
```

STEP: UI.DataPoint — CAP CDS Annotation
DESCRIPTION: CAP CDS data point definitions as reusable annotation objects. Use qualifiers (#Width, #Depth) and reference them in MeasureAttributes.DataPoint.
LANGUAGE: CDS (CAP)
CODE:
```
UI.DataPoint #Width : {
    Value : Width,
    Criticality : criticalityValue
},

UI.DataPoint #Depth : {
    Value : Depth,
    Criticality : criticalityValue
}
```

STEP: Mandatory Annotations and Rules (implementation checklist)
DESCRIPTION: Required annotations and behavioral rules to ensure the Line Micro Chart renders correctly. Follow these rules when authoring annotations.
LANGUAGE: PlainText
CODE:
```
- Mandatory annotations:
  - UI.Chart → ChartType must be "Line"
  - UI.Chart → Dimensions
  - UI.Chart → Measures
  - UI.Chart → MeasureAttributes → DataPoint (AnnotationPath or DataPoint ref)
  - UI.DataPoint → Value

- Measure/DataPoint rule:
  - The first measure MUST have a Measure entry and a corresponding MeasureAttribute with a DataPoint.
    - If missing for the first measure, the chart will not display.
    - If missing for subsequent measures, those measures will not be plotted.
  - For multiple measures, include DataPoint on measures you want visualized.

- Data type & entity relationships:
  - Dimensions and measures must not be from the same entity; dimensions must come from a 1:n navigation entity relative to the measures.
  - Dimension values must be numeric (float) or castable to float OR be string-based but annotated as calendar values (see calendar annotations).
  - Ensure unit-of-measure consistency across all data points.

- Semantic coloring:
  - UI.DataPoint → Criticality is supported for semantic coloring.
  - If Criticality resolves to a constant Enum value, the entire line is colored accordingly (e.g., Criticality.Negative = Red).
  - If Criticality is a path, the color is determined by the last data point's criticality.

- Recommended limits:
  - Prefer 1 measure; up to 3 measures is recommended for readability.
  - The chart shows smallest measure value at first dimension (top-left) and largest measure value at last dimension (top-right) when multiple measures are plotted.
```

STEP: String-Based Dimension Fields Annotated as Calendar Values — Rules & Examples
DESCRIPTION: Line micro charts support string-based dimension fields when annotated as calendar values. Use these Common.IsCalendar* annotations and ensure input format matches the required pattern. Examples show XML, ABAP CDS, and CAP CDS usage.
LANGUAGE: PlainText
CODE:
```
Supported Common.IsCalendar* annotations and expected value formats / validation:

- Common.IsCalendarYear: format "yyyy" (4-digit year)
- Common.IsCalendarQuarter: format "Q" (1-4, regex: [1-4])
- Common.IsCalendarMonth: format "MM" (01-12, regex: 0[1-9]|1[0-2])
- Common.IsCalendarWeek: format "ww" (01-53, regex: 0[1-9]|[1-4][0-9]|5[0-3])
- Common.IsCalendarYearMonth: format "yyyyMM" (valid year and month)
- Common.IsCalendarDate: format "yyyyMMdd" (valid date)

XML example (add to your annotations file):
<Annotations Target="com.c_salesordermanage_sd_aggregate.SalesOrderItem/OrderYear"> 
    <Annotation Term="Common.IsCalendarYear" Bool="true" /> 
</Annotations>

ABAP CDS example:
annotate view C_SALESORDERMANAGE_SD_AGGREGATE.SALESORDERITEM with { 
  @Semantics.calendar.year: true 
  OrderYear 
}

CAP CDS example:
OrderYear : String(4) @(Common.IsCalendarYear : true);
```

STEP: Implementation tips & validation checklist
DESCRIPTION: Quick actionable tips to validate and debug chart behavior during development.
LANGUAGE: PlainText
CODE:
```
- Verify MeasureAttributes.DataPoint AnnotationPath matches a defined UI.DataPoint qualifier.
- Confirm the dimension field is supplied via a 1:n navigation property and values are numeric or properly annotated as calendar strings.
- Ensure DataPoint.Value paths and measure element names match case and naming in metadata/service.
- Test semantic coloring by returning a fixed Criticality enum and by returning per-data-point criticality values to validate both behaviors.
- Limit measures to <=3 for clarity; check first/last dimension labels when multiple measures are present.
- Use UI annotation inspectors or UI5 sample sandbox (e.g., https://ui5.sap.com) to preview the LineMicroChart behavior.
```
--------------------------------

**TITLE**: Link List Cards — manifest.json configuration for OVP (static and dynamic)

**INTRODUCTION**: This guide shows how to configure Link List Cards (sap.ovp.cards.linklist) in the manifest.json for SAP Fiori Overview Page (OVP). It includes examples for: card skeleton, title/subtitle/header link, staticContent list items, dynamic cards with standard and carousel layouts, and the OData V4 template change. Use these JSON snippets directly in your application manifest.json under the "sap.ovp" section.

**TAGS**: fiori-elements-framework, sap.ovp, linklist, manifest.json, OData, static-content, carousel, card-configuration

**STEP**: 1 — Add a Link List Card skeleton to manifest.json

**DESCRIPTION**: Add a new card entry under "sap.ovp" with the required properties: model, template, and settings.entitySet. Keep optional globalFilter settings if needed. This is the minimal skeleton to register a link list card.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters", // Deprecated since SAPUI5 1.54.
    "globalFilterEntitySet": "GlobalFilters",  // Available from SAPUI5 1.54.
    "cards": {
      "card005_RecentContacts": {
        "model": "purchaseOrder",
        "template": "sap.ovp.cards.linklist",
        "settings": {
          "title": "Recent Contacts",
          "entitySet": "SalesShare"
        }
      }
    }
  }
}
```

**STEP**: 2 — Configure card title, subtitle and header link

**DESCRIPTION**: Use "title" to display a header on top of the card. Use "subTitle" to display a subtitle under the title. Use "targetUri" to make the header clickable (external URL or cross-app intent).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card005_RecentContacts": {
        "model": "purchaseOrder",
        "template": "sap.ovp.cards.linklist",
        "settings": {
          "title": "Recent Contacts",
          "targetUri": "https://en.wikipedia.org/wiki/Mangalyaan_2",
          "subTitle": "by Importance of Interaction",
          "entitySet": "SalesShare"
        }
      }
    }
  }
}
```

**STEP**: 3 — Configure staticContent (static link list card)

**DESCRIPTION**: For static link list cards, declare the list items in settings.staticContent as an array. Each item can include title, subTitle, imageUri, imageAltText, targetUri and openInNewWindow. You can also configure card sizing via defaultSpan and other visual settings like listFlavor and sorting.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card005_RecentContacts": {
        "model": "purchaseOrder",
        "template": "sap.ovp.cards.linklist",
        "settings": {
          "title": "Recent Contacts",
          "targetUri": "https://en.wikipedia.org/wiki/Mangalyaan_2",
          "subTitle": "by Importance of Interaction",
          "listFlavor": "standard",
          "sortBy": "Employee",
          "entitySet": "Zme_Overdue",
          "sortOrder": "ascending",
          "defaultSpan": {
            "rows": 24,
            "cols": 2,
            "showOnlyHeader": true
          },
          "staticContent": [
            {
              "title": "Jim Smith",
              "subTitle": "Sales",
              "imageUri": "img/JD.png",
              "imageAltText": "Jim Smith",
              "targetUri": "https://google.com",
              "openInNewWindow": true
            },
            {
              "title": "Alice Wilson",
              "subTitle": "Sales",
              "imageUri": "img/AW.png",
              "imageAltText": "Alice Wilson",
              "targetUri": "https://google.com",
              "openInNewWindow": true
            },
            {
              "title": "Daniel Quote",
              "subTitle": "Production",
              "imageUri": "img/DQ.png",
              "imageAltText": "Daniel Quote",
              "targetUri": "https://google.com",
              "openInNewWindow": true
            },
            {
              "title": "Kate Holly",
              "subTitle": "Sales",
              "imageUri": "img/Kate.png",
              "imageAltText": "Kate Holly",
              "targetUri": "https://google.com",
              "openInNewWindow": true
            },
            {
              "title": "Aurora Smith",
              "subTitle": "HR",
              "imageUri": "img/KJ.png",
              "imageAltText": "Aurora Smith",
              "targetUri": "https://google.com",
              "openInNewWindow": true
            },
            {
              "title": "Wong Lee",
              "subTitle": "Management",
              "imageUri": "img/YM.png",
              "imageAltText": "Wong Lee",
              "targetUri": "https://google.com",
              "openInNewWindow": true
            }
          ]
        }
      }
    }
  }
}
```

**STEP**: 4 — Configure a dynamic Link List Card (standard layout)

**DESCRIPTION**: For dynamic cards, data is read from the back end using entitySet. Use settings.listFlavor = "standard" for an ordered list. Use sortBy and sortOrder for client-side sorting. Optionally include annotation paths such as headerAnnotationPath and identificationAnnotationPath to display header info and identification fields.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card20": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.linklist",
        "settings": {
          "title": "Dynamic Linklist Card",
          "targetUri": "https://en.abc.org/wiki/A_2",
          "subtitle": "NEW CARD",
          "listFlavor": "standard",
          "sortBy": "Name",
          "entitySet": "ProductSet",
          "sortOrder": "ascending",
          "headerAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#header1",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#identify1"
        }
      }
    }
  }
}
```

**STEP**: 5 — Configure a dynamic Link List Card (carousel layout)

**DESCRIPTION**: Use settings.listFlavor = "carousel" to prioritize images and present items in a carousel. Carousel cards still use the same settings keys (title, entitySet, sortBy, sortOrder). In OData V4 use the V4 template name (see next step).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card_20": {
        "model": "HEPM_OVP_TECH_VAL",
        "template": "sap.ovp.cards.linklist",
        "settings": {
          "title": "{{card20_title}}",
          "entitySet": "Hepmra_C_OFT_Employee",
          "listFlavor": "carousel",
          "sortBy": "Employee",
          "sortOrder": "ascending"
        }
      }
    }
  }
}
```

**STEP**: 6 — Supported navigation types (examples)

**DESCRIPTION**: Link List Cards support:
- Quick view: show contact annotation details (configured via annotations on the entity/identification).
- Cross-app navigation: intent-based navigation via targetUri or annotation-driven semantic object.
- External URL: set targetUri to an absolute URL and openInNewWindow true to open externally.

Use the staticContent entries (example below) to create external links; for Quick view and SmartLink enable semantic annotations on the backend and reference them via annotation paths.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "exampleNav": {
        "template": "sap.ovp.cards.linklist",
        "settings": {
          "title": "Navigation examples",
          "staticContent": [
            {
              "title": "External Link",
              "targetUri": "https://example.com",
              "openInNewWindow": true
            },
            {
              "title": "Internal/Cross-App Intent",
              "targetUri": "#SemanticObject-action?param=value"
            }
          ]
        }
      }
    }
  }
}
```

**STEP**: 7 — SAP Fiori elements for OData V4: use the V4 template

**DESCRIPTION**: If your app uses OData V4, change the template name from "sap.ovp.cards.linklist" to "sap.ovp.cards.v4.linklist". All other settings remain compatible.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card20": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.v4.linklist",
        "settings": {
          "title": "Dynamic Linklist Card (OData V4)",
          "entitySet": "ProductSet",
          "listFlavor": "standard",
          "sortBy": "Name",
          "sortOrder": "ascending"
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: List Cards — manifest and annotation configuration for SAP Fiori elements (OVP)

**INTRODUCTION**: This reference shows how to configure List Cards (sap.ovp.cards.list for OData V2 and sap.ovp.cards.v4.list for OData V4) in the application manifest and how to provide the UI LineItem annotations (XML, ABAP CDS, CAP CDS). It includes exact manifest keys, annotationPath qualifier usage, layout rules for condensed/extended and standard/bar flavors, DataField/DataPoint placement, importance/ordering rules, and image/icon support.

**TAGS**: sap.fiori, ovp, list-card, LineItem, annotationPath, DataField, DataPoint, manifest, ODataV4, CDS, ABAP

**STEP**: 1 - Basic manifest card configuration (OData V2)
**DESCRIPTION**: Configure a list card in the manifest.json for OData V2. Key properties: model, template, settings.{entitySet,annotationPath,listFlavor,sortBy,sortOrder,category,imageSupported}. Use annotationPath to point to a specific com.sap.vocabularies.UI.v1.LineItem qualifier (e.g. #bar).
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card04": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.list",
        "settings": {
          "entitySet": "Products",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#bar",
          "listFlavor": "bar",               // "standard" or "bar"
          "sortBy": "Price",
          "sortOrder": "descending",
          "category": "{{card04_category}}",
          "imageSupported": true             // optional: enable images/icons for condensed lists
        }
      }
    }
  }
}
```

**STEP**: 2 - Manifest change for OData V4
**DESCRIPTION**: For OData V4, use the v4-specific template name. All other settings remain the same.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "card04": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.v4.list",   // V4 template
        "settings": {
          "entitySet": "Products",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#bar",
          "listFlavor": "bar",
          "sortBy": "Price",
          "sortOrder": "descending",
          "imageSupported": true
        }
      }
    }
  }
}
```

**STEP**: 3 - Using multiple LineItem annotations and qualifiers
**DESCRIPTION**: If you want different field collections for multiple cards using the same entitySet, create different LineItem annotations with qualifiers and reference them via annotationPath. If annotationPath is omitted, the unqualified com.sap.vocabularies.UI.v1.LineItem is used.
**LANGUAGE**: JSON
**CODE**:
```json
// Example settings using a qualifier
"settings": {
  "entitySet": "Products",
  "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#Qualifier1"
}
```

**STEP**: 4 - Ordering and importance rules
**DESCRIPTION**: DataField/DataFieldForAnnotation entries within a LineItem are processed in this order:
- Sort by com.sap.vocabularies.UI.v1.ImportanceType if provided (Higher importance first)
- Then by order of entry in the annotation
At runtime, DataFields and DataPoints are placed according to the list type/flavor rules (see next steps). If a DataFieldForAnnotation targets a DataPoint, that DataPoint may be shown and highlighted according to its criticality.

**LANGUAGE**: Text
**CODE**:
```text
Ordering rule:
1) Sort by Importance annotation (if present)
2) Preserve annotation entry order for items with equal importance
```

**STEP**: 5 - Condensed list type — Standard flavor (layout rules)
**DESCRIPTION**: Use when you need compact lists. Each list item displays up to 3 fields:
- Top-left: first DataField
- Bottom-left: second DataField
- Top-right: If a DataFieldForAnnotation with DataPoint target exists, show the DataPoint value (with criticality highlighting). Otherwise show the next DataField.
- Max items shown: up to 3
**LANGUAGE**: Text
**CODE**:
```text
Condensed Standard mapping per item:
- left top    -> DataField(1)
- left bottom -> DataField(2)
- right top   -> DataFieldForAnnotation(DataPoint) OR DataField(3)
Items displayed: up to 3
```

**STEP**: 6 - Extended list type — Standard flavor (layout rules)
**DESCRIPTION**: Use when more fields are required. Each list item displays up to 6 fields:
- Left side: DataField records (in order)
- Right side: DataPoint records (up to 3). If fewer DataPoints are defined, fill remaining right-side slots with DataField records instead.
- Max items shown: up to 6
**LANGUAGE**: Text
**CODE**:
```text
Extended Standard mapping per item:
- left side  -> DataField(1..N)
- right side -> DataPoint(1..3)  (if <3 DataPoints, use additional DataField entries)
Items displayed: up to 6
```

**STEP**: 7 - Condensed list type — Bar flavor (layout rules)
**DESCRIPTION**: Use only when displaying a DataPoint (bar). Each item displays up to 3 fields:
- Top-left: first DataField (title)
- Beneath title: DataPoint bar (first DataPoint)
- Right of bar: numeric value for first DataPoint
- Optionally: additional DataPoint to the right of first DataPoint
- Bar can represent percentage or numeric value
- Max items shown: up to 3
**LANGUAGE**: Text
**CODE**:
```text
Condensed Bar mapping per item:
- top-left    -> DataField(1)  (title)
- below title -> DataPoint(1)  (bar + numeric value at right)
- right       -> DataPoint(2)  (optional)
Items displayed: up to 3
```

**STEP**: 8 - Extended list type — Bar flavor (layout rules)
**DESCRIPTION**: Larger bar layout with up to 5 fields per item:
- Top-left: first DataField (title)
- Beneath title: optional second DataField
- Bottom area: DataPoint(1) as bar with numeric value to the right
- Right side (vertical): up to two additional DataPoints stacked
- Criticality highlighting: if multiple DataPoints have criticality, only one is highlighted (the first in display order)
- Max items shown: up to 5
**LANGUAGE**: Text
**CODE**:
```text
Extended Bar mapping per item:
- top-left    -> DataField(1) (title)
- below title -> DataField(2) (optional)
- bottom-left -> DataPoint(1) (bar + numeric at right)
- right side  -> DataPoint(2) (top), DataPoint(3) (bottom) (optional)
Highlighting: only the first displayed DataPoint with criticality is highlighted.
Items displayed: up to 5
```

**STEP**: 9 - Example LineItem annotation (XML)
**DESCRIPTION**: Example of an XML LineItem annotation containing a DataField with IconUrl and Value. Use qualifiers when needed.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="Namespace.EntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
    <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.DataField">
        <PropertyValue Property="IconUrl" Path="web_address"/>
        <PropertyValue Property="Value" Path="MaterialName"/>
      </Record>
      <!-- Add more DataField or DataFieldForAnnotation records here -->
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 10 - Example ABAP CDS LineItem snippet
**DESCRIPTION**: ABAP CDS example mapping a simple UI.lineItem entry. Use @UI.lineItem with value property names.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.lineItem: [{ value: 'MATERIALNAME' }]
MATERIALNAME;
```

**STEP**: 11 - Example CAP CDS (CDS for Node.js) LineItem snippet
**DESCRIPTION**: CAP CDS example using UI.LineItem with DataField type, IconUrl and Value properties.
**LANGUAGE**: CDS
**CODE**:
```cds
entity Products {
  key ID : UUID;
  MaterialName : String;
  web_address  : String;
  // other properties...
}

annotate Products with {
  @UI.LineItem : [
    {
      $Type : 'com.sap.vocabularies.UI.v1.DataField',
      IconUrl : web_address,
      Value : MaterialName
    }
  ]
};
```

**STEP**: 12 - Enabling images/icons in condensed lists
**DESCRIPTION**: To render images or icons in condensed lists set "imageSupported": true in the manifest card settings and include IconUrl (or image path) in the corresponding DataField(s) of the LineItem annotation.
**LANGUAGE**: JSON / XML
**CODE**:
```json
// manifest.json (card settings)
"settings": {
  "entitySet": "Products",
  "annotationPath": "com.sap.vocabularies.UI.v1.LineItem",
  "listFlavor": "standard",
  "imageSupported": true
}
```
```xml
<!-- LineItem DataField with IconUrl -->
<Record Type="com.sap.vocabularies.UI.v1.DataField">
  <PropertyValue Property="IconUrl" Path="web_address"/>
  <PropertyValue Property="Value" Path="MaterialName"/>
</Record>
```

**STEP**: 13 - Quick checklist for implementation
**DESCRIPTION**: Checklist to validate card behavior at runtime.
**LANGUAGE**: Text
**CODE**:
```text
- Confirm template: "sap.ovp.cards.list" (V2) or "sap.ovp.cards.v4.list" (V4)
- Ensure settings.entitySet matches service metadata
- Use annotationPath to reference qualified LineItem if needed
- Verify LineItem contains DataField / DataFieldForAnnotation / DataPoint entries
- Validate Importance annotations if ordering is required
- Set imageSupported:true and provide IconUrl for images/icons in condensed lists
- For bar flavors, ensure DataPoint targets are numeric (percentage or value)
- Test criticality highlighting: only the first displayed DataPoint with criticality is highlighted
```
--------------------------------

**TITLE**: List Report + Object Page (SAP Fiori elements, OData V2) — configuration and annotations

**INTRODUCTION**: Practical, code-focused examples to configure a List Report and an Object Page in a SAP Fiori elements (OData V2) application. Shows manifest.json entries and minimal OData annotation XML for ListReport line items, ObjectPage header & facets. Use these snippets to wire a list-to-detail flow without custom UI code. The List Report lets users filter and pick items; the Object Page lets users view/edit a single item.

**TAGS**: fiori-elements-framework, OData V2, list-report, object-page, manifest.json, annotations, sap.suite.ui.generic.template

**STEP**: 1 — Declare pages in manifest.json

**DESCRIPTION**: Add sap.ui.generic.app.pages entries for ListReport and ObjectPage. Use the same entitySet name for both pages to enable automatic list-to-detail navigation provided by Fiori elements. Place this snippet in your project's manifest.json (root of UI5 app).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "pageType": "ListReport",
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport"
        },
        "label": "Products List"
      },
      {
        "pageType": "ObjectPage",
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        },
        "label": "Product Details"
      }
    ]
  }
}
```

**STEP**: 2 — Minimal UI.LineItem annotation for the List Report

**DESCRIPTION**: Provide OData V2 UI annotations that define the columns shown in the List Report table. Put the following in your annotations XML file (e.g., annotations.xml) or equivalent annotation source.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="MyService.Product">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="ProductID"/>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Name"/>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Category"/>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Price"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 3 — Basic Object Page annotations (HeaderInfo + Facets)

**DESCRIPTION**: Define header information and page facets (sections) for the Object Page. Place this in the same annotations XML file used by the service or annotation provider.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="MyService.Product">
  <!-- Header (title/description) shown in Object Page header -->
  <Annotation Term="UI.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeName" String="Product"/>
      <PropertyValue Property="Title" Path="Name"/>
      <PropertyValue Property="Description" Path="ShortDescription"/>
    </Record>
  </Annotation>

  <!-- Facets: defines sections and fields on the Object Page -->
  <Annotation Term="UI.Facets">
    <Collection>
      <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Label" String="General Information"/>
        <PropertyValue Property="Target">
          <Record Type="UI.CollectionFacet">
            <PropertyValue Property="Label" String="General"/>
            <PropertyValue Property="Value">
              <Collection>
                <Record Type="UI.DataField">
                  <PropertyValue Property="Value" Path="Price"/>
                </Record>
                <Record Type="UI.DataField">
                  <PropertyValue Property="Value" Path="Availability"/>
                </Record>
                <Record Type="UI.DataField">
                  <PropertyValue Property="Value" Path="Manufacturer"/>
                </Record>
              </Collection>
            </PropertyValue>
          </Record>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 4 — How navigation from List Report to Object Page is resolved

**DESCRIPTION**: No additional UI code is required for row-to-detail navigation when both pages are declared with the same entitySet in sap.ui.generic.app.pages. Fiori elements resolves navigation automatically:
- ListReport displays the entity collection (Products).
- Selecting a row opens the ObjectPage for that entity instance.
If you need custom navigation (different entity, navigation property), supply proper NavigationProperty bindings in your OData metadata or configure explicit navigation targets in the annotations/manifest per SAP Fiori elements documentation.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "pageType": "ListReport",
        "entitySet": "Products",
        "component": { "name": "sap.suite.ui.generic.template.ListReport" }
      },
      {
        "pageType": "ObjectPage",
        "entitySet": "Products",
        "component": { "name": "sap.suite.ui.generic.template.ObjectPage" }
      }
    ]
  }
}
```

**STEP**: 5 — Analytical List Page compatibility (optional)

**DESCRIPTION**: The Object Page can also be used with the Analytical List Page (ALP). If you use an ALP instead of the ListReport, declare the ALP pageType and keep the ObjectPage entitySet matching the ALP selection target so the list-to-detail flow remains supported. See ALP-specific annotations for charts/filters.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "pageType": "AnalyticalListPage",
        "entitySet": "Products",
        "component": { "name": "sap.suite.ui.generic.template.AnalyticalListPage" }
      },
      {
        "pageType": "ObjectPage",
        "entitySet": "Products",
        "component": { "name": "sap.suite.ui.generic.template.ObjectPage" }
      }
    ]
  }
}
```
--------------------------------

**TITLE**: Fiori Elements List Report — configuration snippets and UI extension examples

**INTRODUCTION**: Quick, code-focused reference for implementing a Fiori Elements List Report page. Includes manifest.json page registration, SmartTable and SmartChart content examples, header toolbar "Share" actions and a small controller example for share actions. Use these snippets inside webapp/ of an SAPUI5/Fiori Elements project and adapt placeholders (EntitySet, model names, IDs) to your app.

**TAGS**: fiori-elements-framework, list-report, sapui5, manifest.json, smarttable, smartchart, variant-management, header-toolbar, share

STEP: 1 — Register a List Report page in manifest.json

DESCRIPTION: Add a List Report page to webapp/manifest.json under sap.ui.generic.app.pages. Replace EntitySet, navigation target, and component name as required. This is the primary registration for a List Report (smart template).

LANGUAGE: JSON

CODE:
```json
// File: webapp/manifest.json (partial)
{
  "sap.app": {
    "id": "your.app.id",
    "title": "Your App Title"
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "preload": true
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "YourEntitySet",          // <-- replace with your OData entity set
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport" // standard List Report template
        },
        "settings": {
          "navigation": {},
          "chart": {
            "visible": true                    // enable chart area (set to false to hide)
          },
          "table": {
            "type": "ResponsiveTable"          // or "AnalyticalTable" / "GridTable"
          },
          "variantManagement": {
            "enabled": true                    // enable variant management for filters/views
          },
          "header": {
            "toolbar": {
              "shareActions": [
                "SendEmail",
                "ShareInSAPJam",
                "SaveAsTile",
                "ShareInMicrosoftTeams",
                "ShareInCollaborationManager"
              ]
            }
          }
        }
      }
    ]
  },
  "sap.ui5": {
    "resources": {
      "css": []
    }
  }
}
```

STEP: 2 — SmartTable + SmartChart content area (XML view fragment)

DESCRIPTION: Place a SmartTable and a SmartChart in the content area. This fragment can be used as a page content or extension fragment for the List Report. Ensure the ODataModel and annotations are configured so Smart controls can bind to the EntitySet.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/ext/fragment/ListReportContent.fragment.xml -->
<!-- Imports required namespaces: smartTable and smartChart -->
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:smartTable="sap.ui.comp.smarttable"
  xmlns:smartChart="sap.ui.comp.smartchart"
  displayBlock="true">

  <Page id="ListReportPage" title="{i18n>listReportTitle}">
    <content>
      <!-- SmartChart: show/hide by manifest "settings.chart.visible" -->
      <smartChart:SmartChart
        id="smartChart"
        entitySet="YourEntitySet"                <!-- replace -->
        persistencyKey="SmartChartKey"
        chartType="column"
        header="Chart"
        showSelectedData="true" />

      <!-- SmartTable (List) -->
      <smartTable:SmartTable
        id="smartTable"
        entitySet="YourEntitySet"                <!-- replace -->
        tableType="ResponsiveTable"
        header="List"
        enableAutoBinding="true"
        useExportToExcel="true"
        persistencyKey="SmartTableKey"
        showRowCount="true">
        <!-- The actual inner table is created automatically from annotations -->
      </smartTable:SmartTable>
    </content>
  </Page>
</mvc:View>
```

STEP: 3 — Header toolbar extension fragment (Share menu) for customization

DESCRIPTION: Use an extension fragment to extend the header toolbar. The example adds a Share overflow button with specific actions wired to controller methods. Register this fragment in the List Report extension points or via manifest extensions.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/ext/fragment/HeaderToolbar.fragment.xml -->
<mvc:FragmentDefinition
  xmlns="sap.m"
  xmlns:mvc="sap.ui.core.mvc">
  <OverflowToolbar>
    <OverflowToolbarButton
      id="shareOverflowBtn"
      text="Share"
      press=".onOpenShareMenu">
      <menu>
        <Menu id="shareMenu">
          <MenuItem text="Send Email" press=".onSendEmail" />
          <MenuItem text="Share in SAP Jam" press=".onShareInSAPJam" />
          <MenuItem text="Save as Tile" press=".onSaveAsTile" />
          <MenuItem text="Share: Microsoft Teams" press=".onShareTeams" />
          <MenuItem text="Share: Collaboration Manager" press=".onShareCollabManager" />
        </Menu>
      </menu>
    </OverflowToolbarButton>
  </OverflowToolbar>
</mvc:FragmentDefinition>
```

STEP: 4 — Controller actions for Share menu (simple handlers)

DESCRIPTION: Implement simple handlers for Share menu actions. These examples use sap.m.URLHelper for email and include placeholders for integration points (SAP Jam, Teams, Collaboration Manager). Adapt to your integration libraries/APIs.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/ext/controller/HeaderToolbar.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/m/MessageToast",
  "sap/m/URLHelper"
], function (Controller, MessageToast, URLHelper) {
  "use strict";

  return Controller.extend("your.app.ext.controller.HeaderToolbar", {
    onOpenShareMenu: function (oEvent) {
      // menu opens automatically via <menu> aggregation, keep method if needed
    },

    onSendEmail: function () {
      // Example: open default mail client with subject/body
      var sSubject = "Shared from List Report";
      var sBody = "Link to the current list report: <enter app URL>";
      URLHelper.triggerEmail(null, sSubject, sBody);
    },

    onShareInSAPJam: function () {
      // Placeholder - call your SAP Jam integration here
      MessageToast.show("Share in SAP Jam (implement integration)");
    },

    onSaveAsTile: function () {
      // Placeholder - call tile creation service or runtime API
      MessageToast.show("Save as Tile (implement create tile)");
    },

    onShareTeams: function () {
      // Placeholder - implement Microsoft Teams share integration
      MessageToast.show("Share to Microsoft Teams (implement integration)");
    },

    onShareCollabManager: function () {
      // Placeholder - implement Collaboration Manager integration
      MessageToast.show("Share to Collaboration Manager (implement integration)");
    }
  });
});
```

STEP: 5 — Smart Variant Management (usage notes)

DESCRIPTION: Variant management is handled by the SmartTemplate and SmartFilterBar/SmartTable controls. Enable it via manifest settings (see STEP 1). If you need programmatic access, use sap.ui.comp.smartvariants.SmartVariantManagement and methods like addVariant, saveCurrentVariant. Example usage: get the SmartVariantManagement by ID from the filter bar or table and call API methods.

LANGUAGE: JavaScript

CODE:
```javascript
// Example: get SmartVariantManagement from a SmartFilterBar or SmartTable
var oSmartFilterBar = this.byId("smartFilterBarId"); // replace with actual id
var oVariantMgmt = oSmartFilterBar && oSmartFilterBar.getVariantManagement();
if (oVariantMgmt) {
  // read current variant or save programmatically
  var sCurrentVariant = oVariantMgmt.getCurrentVariantId();
  // oVariantMgmt.saveVariant({/* variant data */});
}
```

STEP: 6 — Image and related docs references

DESCRIPTION: Reference to illustration and further configuration documents. Keep these file paths and links for developer documentation or help pages.

LANGUAGE: TEXT

CODE:
```text
Image: images/List_Report_ac7876b.png

Related docs (local docs or repo filenames):
- configuring-list-report-features-3af1d03.md
- configuring-further-common-features-a4d3c46.md
- loading-behavior-of-data-on-initial-launch-of-the-application-9f4e119.md
```

Notes:
- Replace placeholders (YourEntitySet, IDs, controller names) with actual app values.
- SmartTable/SmartChart require properly configured OData annotations (UI.LineItem, Chart) and an ODataModel in manifest.
- Use extension fragments and controllers according to Fiori Elements extension points (manifest "extends" or template-specific extension configuration).
--------------------------------

**TITLE**: Configure Initial Data Loading on App Launch (SAP Fiori Elements V2 & V4)

**INTRODUCTION**: This document shows how to control whether data is loaded automatically when a Fiori Elements app launches (initial launch). It covers behaviors for navigation contexts, variants, and manifest-level settings for OData V2 (List Report) and OData V4 (FE Analytical/List Page). Use these manifest changes to implement "always", "never", or conditional initial data loads and to understand how end-user "Apply Automatically" (Manage Views) and mandatory filters interact.

**TAGS**: fiori-elements, manifest.json, loadDataOnAppLaunch, initialLoad, ListReport, AnalyticalListPage, ODataV2, ODataV4, quickVariantSelectionX, ApplyAutomatically

**STEP**: Behavior summary and rules to implement in code

**DESCRIPTION**: Summary of how initial data loading is determined at launch. Implement checks or manifest settings based on these rules.

- If the app is launched with a navigation context (context passed in URL or from launchpad target mapping), data is loaded on initial launch.
- If launched from a tile with no navigation context:
  - If a default variant is configured, that variant is launched. Initial data load depends on the variant's "Apply Automatically" setting.
  - If no default variant is configured, the Standard variant is used. Initial data load depends on manifest configuration (V2: loadDataOnAppLaunch; V4: initialLoad).
- If any mandatory filter is missing, initial data load is not triggered; in this case the Apply Automatically checkbox is deselected.
- Recommendation: provide default filter values to avoid empty charts/tables on initial launch.

**LANGUAGE**: Plain

**CODE**:
```text
File(s): manifest.json (app root)
Rules to implement:
- For apps launched with URL/context -> initial data load occurs automatically.
- For Standard/default variant -> use manifest setting to control initial load.
- If mandatory filter missing -> do NOT trigger load; ensure Apply Automatically is deselected.
```

**STEP**: Configure initial load for OData V2 (List Report) via manifest.json

**DESCRIPTION**: Use the "dataLoadSettings.loadDataOnAppLaunch" property under the List Report page definition. Valid values:
- "always" — always load standard-variant data automatically.
- "never" — never load automatically; user must click Go.
- "ifAnyFilterExist" or undefined — load only if default filter values exist (default behavior for new apps).

End users can override with Manage Views -> Apply Automatically.

Place this under "sap.ui5" -> "routing" -> "targets" -> "pages" or according to your app's routing structure. Keep the ListReport target name in the form "ListReport|<EntitySet>".

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "ListReport|<EntitySet>": {
          "type": "Component",
          "id": "ListReport",
          "name": "sap.suite.ui.generic.template.ListReport",
          "options": {
            "settings": {
              "entitySet": "<EntitySet>",
              "list": true,
              "dataLoadSettings": {
                "loadDataOnAppLaunch": "always" 
                /* or "never" or "ifAnyFilterExist" (default) */
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Alternative multi-view setting (V2) — quickVariantSelectionX.enableAutoBinding

**DESCRIPTION**: For multi-view apps you may alternatively control autobinding per variant using quickVariantSelectionX.enableAutoBinding. SAP recommends using loadDataOnAppLaunch, but you can use this setting if needed.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "ListReport|<EntitySet>": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "options": {
            "settings": {
              "quickVariantSelectionX": {
                "enableAutoBinding": false
                /* set true or false; using loadDataOnAppLaunch is recommended */
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Configure initial load for OData V4 (FE Analytical/List Page) via manifest.json

**DESCRIPTION**: Use the "initialLoad" option under the page component settings. Valid values:
- "Auto" (default) — load only if predefined filter values are available.
- "Disabled" — no automatic load; user must click Go.
- "Enabled" — always load automatically.

These apply when the Standard variant is active; end users can override via Apply Automatically in Manage Views.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "componentUsages": {
      "SalesOrderManageList": {
        "type": "Component",
        "id": "SalesOrderManageList",
        "name": "sap.fe.templates.AnalyticalListPage",
        "options": {
          "settings": {
            "contextPath": "/SalesOrderManage",
            "initialLoad": "Enabled"
            /* or "Auto" (default) or "Disabled" */
          }
        }
      }
    }
  }
}
```

**STEP**: Implementation checklist to avoid empty content on initial launch

**DESCRIPTION**: Ensure these items are reviewed in code/config:
- Provide default filter values (admin or app) if you want data visible on initial launch when using "Auto" or "ifAnyFilterExist".
- Implement or verify manifest values in manifest.json per app type (V2 vs V4).
- Confirm Manage Views default (Apply Automatically) behavior matches product UX expectations.
- Ensure navigation target mappings include context in the target URL if you require automatic loads from launchpad tiles.

**LANGUAGE**: Plain

**CODE**:
```text
Checklist:
- Set loadDataOnAppLaunch (V2) or initialLoad (V4) in manifest.json as required.
- For multi-view apps, prefer loadDataOnAppLaunch; consider quickVariantSelectionX.enableAutoBinding only if necessary.
- Verify mandatory filter behavior: missing mandatory filter -> no auto-load; Apply Automatically deselected.
- Add default filter values to prevent empty charts/tables at first launch.
- If launching from FLP tile with context, ensure target mapping adds context to target URL to trigger load.
```
--------------------------------

**TITLE**: Localization (i18n) — Overriding SAP Fiori elements UI Texts

**INTRODUCTION**: Practical, code-focused guide to locate/create i18n resource files, reference i18n keys from annotations, and override standard Fiori elements texts (OData V2 and OData V4). Shows manifest/model declarations, annotation examples (XML / ABAP CDS / CAP CDS), custom key formatting rules, and sample property entries. Use these steps to implement application-specific text replacements and to wire custom resource bundles into your app.

**TAGS**: i18n, localization, sapui5, fiori-elements, manifest.json, annotations, CDS, CAP, ODataV2, ODataV4

STEP: 1 — Create / Locate i18n resource files and folder layout

DESCRIPTION: Create the application resource bundle(s) and required folder structure under webapp/i18n. Use a top-level i18n/i18n.properties and optional template- or entity-specific files:
- i18n/i18n.properties
- i18n/ListReport/<EntitySet>/i18n.properties
- i18n/ObjectPage/<EntitySet>/i18n.properties
- i18n/ObjectPage/<SubEntitySet>/i18n.properties

LANGUAGE: Text

CODE:
```text
Root folder:
<root-folder>/
  webapp/
    i18n/
      i18n.properties
      ListReport/
        POHeaders/
          i18n.properties
      ObjectPage/
        POHeaders/
          i18n.properties
        POItems/
          i18n.properties
```

STEP: 2 — Declare resource models in manifest.json for global and template-specific bundles

DESCRIPTION: Declare resource models under "sap.ui5.models". For top-level i18n use model name "i18n". For template-specific files use the naming convention:
i18n|<template-component>|<EntitySetName>
The "uri" value must point to the correct i18n file path.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "models": {
      "i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "uri": "i18n/i18n.properties"
      },
      "i18n|sap.suite.ui.generic.template.ListReport|POHeaders": {
        "type": "sap.ui.model.resource.ResourceModel",
        "uri": "i18n/ListReport/POHeaders/i18n.properties"
      },
      "i18n|sap.suite.ui.generic.template.ObjectPage|POHeaders": {
        "type": "sap.ui.model.resource.ResourceModel",
        "uri": "i18n/ObjectPage/POHeaders/i18n.properties"
      },
      "i18n|sap.suite.ui.generic.template.ObjectPage|POItems": {
        "type": "sap.ui.model.resource.ResourceModel",
        "uri": "i18n/ObjectPage/POItems/i18n.properties"
      }
    }
  }
}
```

STEP: 3 — Reference i18n keys in annotations (XML / ABAP CDS / CAP CDS) and add keys to your i18n file

DESCRIPTION: In annotation files use the i18n binding expression {@i18n>KEY}. Add the KEY=Your text to your application i18n file. Also ensure the @i18n model is defined in manifest.json when annotations/references expect it.

LANGUAGE: XML

CODE:
```xml
<!-- XML Annotation example -->
<Annotation Term="UI.LineItem">
  <Collection>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="Add random item"/>
      <PropertyValue Property="Action" String="com.c_salesordermanage_sd.AddRandomItem"/>
    </Record>
    <Record Type="UI.DataFieldForAction">
      <PropertyValue Property="Label" String="{@i18n>CopyActionText}"/>
      <PropertyValue Property="Action" String="com.c_salesordermanage_sd.CopyItem"/>
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.lineItem: [
  {
    label: 'Add random item',
    dataAction: 'PUSHDOWN:com.c_salesordermanage_sd.AddRandomItem',
    type: #FOR_ACTION,
    position: 1
  },
  {
    label: '{@i18n>CopyActionText}',
    dataAction: 'PUSHDOWN:com.c_salesordermanage_sd.CopyItem',
    type: #FOR_ACTION,
    position: 2
  }
];
```

LANGUAGE: CAP CDS (JSON-like)

CODE:
```json
LineItem: [
  {
    $Type: "UI.DataFieldForAction",
    Label: "Add random item",
    Action: "com.c_salesordermanage_sd.AddRandomItem"
  },
  {
    $Type: "UI.DataFieldForAction",
    Label: "{@i18n>CopyActionText}",   // i18n key referred here
    Action: "com.c_salesordermanage_sd.CopyItem"
  }
]
```

LANGUAGE: JSON

CODE:
```json
// manifest.json: register @i18n model used by annotations
{
  "sap.ui5": {
    "models": {
      "@i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "uri": "i18n/i18n.properties"
      }
    }
  }
}
```

LANGUAGE: Properties

CODE:
```properties
# webapp/i18n/i18n.properties
CopyActionText=Copy Selected Item
```

STEP: 4 — Override standard template texts (OData V2) — use template-specific i18n and enhanceI18n

DESCRIPTION: For OData V2-based apps, standard UI texts originate from template components (e.g., sap.suite.ui.generic.template.ListReport and ..lib). You can override keys by providing a custom resource bundle and linking it via:
- model entries (see STEP 2) for template-specific i18n OR
- enhanceI18n property in the target options (recommended when customizing a ListReport/ObjectPage target).

LANGUAGE: JSON

CODE:
```json
// Example manifest.json target: enabling enhanceI18n for a target component
{
  "targets": {
    "SalesOrderManageList": {
      "type": "Component",
      "id": "SalesOrderManageList",
      "name": "sap.fe.templates.ListReport",
      "options": {
        "settings": {
          "contextPath": "/SalesOrderManage",
          "enhanceI18n": "i18n/customSalesOrderLR.properties"
        }
      }
    }
  }
}
```

STEP: 5 — Format custom keys: shared keys vs entity/action-specific keys

DESCRIPTION: Use exact keys from Fiori elements when you want to replace default wording. Rules:
- Shared replacements (global): use the original key only.
- Entity- or navigation-specific overrides: append pipe-separated suffixes:
  - |<EntityName> (main entity)
  - |<EntityName>|<ActionName> (action specific)
  - |_<NavigationProperty> (use navigation property name for navigation entity set)
Examples show exact formatting.

LANGUAGE: Properties

CODE:
```properties
# Replace shared OK globally
C_COMMON_DIALOG_OK=Okie?

# Replace a confirmation text only for SalesOrderManage.ReturnInProcess action
C_OPERATIONS_ACTION_CONFIRM_MESSAGE|SalesOrderManage|ReturnInProcess=Confirm the returns?

# Replace delete confirmation for SalesOrderManage list (entity-specific)
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_PLURAL|SalesOrderManage=Delete the selected Sales Orders?

# Replace navigation-entity-specific text (use navigation property name _Items)
C_TRANSACTION_HELPER_OBJECT_PAGE_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR|_Items=Delete this Sales Order Item?
```

STEP: 6 — Example: Override an action label from annotation to custom i18n and ensure the key is available in the correct resource bundle

DESCRIPTION: Combine annotation, manifest model, and i18n entry. If annotation uses {@i18n>CopyActionText}, add the key in the i18n file referenced by the @i18n model in manifest.json (see STEP 3). For template-level keys referenced by the framework, add keys to the template-specific i18n file and register the corresponding resource model (see STEP 2).

LANGUAGE: XML / JSON / Properties

CODE:
```xml
<!-- XML annotation -->
<PropertyValue Property="Label" String="{@i18n>CopyActionText}"/>
```

```json
// manifest.json: ensure @i18n model
{
  "sap.ui5": {
    "models": {
      "@i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "uri": "i18n/i18n.properties"
      }
    }
  }
}
```

```properties
# i18n/i18n.properties
CopyActionText=Copy Selected Item
```

STEP: 7 — Deprecated no-data keys → illustrated message keys mapping (UI5 >= 1.142)

DESCRIPTION: When upgrading, replace deprecated no-data keys with illustrated message title/description keys. Use the new keys in your i18n files.

LANGUAGE: Text

CODE:
```text
Deprecated -> New keys:
NOITEMS_LR_SMARTTABLE ->
  NOITEMS_LR_SMARTTABLE_ILLUSTRATION_TITLE
  NOITEMS_LR_SMARTTABLE_ILLUSTRATION_DESCRIPTION

NOITEMS_LR_SMARTTABLE_WITH_FILTER ->
  NOITEMS_LR_SMARTTABLE_WITH_FILTER_ILLUSTRATION_TITLE
  NOITEMS_LR_SMARTABLE_WITH_FILTE_ILLUSTRATION_DESCRIPTION

NOITEMS_MULTIVIEW_LR_SMARTTABLE_WITH_FILTER ->
  NOITEMS_MULTIVIEW_LR_SMARTTABLE_WITH_FILTER_ILLUSTRATION_TITLE
  NOITEMS_MULTIVIEW_LR_SMARTTABLE_WITH_FILTER_ILLUSTRATION_DESCRIPTION

NOITEMS_SMARTTABLE ->
  NOITEMS_SMARTTABLE_ILLUSTRATION_TITLE
  NOITEMS_SMARTTABLE_ILLUSTRATION_DESCRIPTION

NOITEMS_SMARTTABLE_WITH_FILTER ->
  NOITEMS_SMARTTABLE_WITH_FILTER_ILLUSTRATION_TITLE
  NOITEMS_SMARTTABLE_WITH_FILTER_ILLUSTRATION_DESCRIPTION

NOITEMS_SMARTTABLE_WITH_FILTER_FOR_SEGMENTEDBUTTON ->
  NOITEMS_SMARTTABLE_WITH_FILTER_FOR_SEGMENTEDBUTTON_ILLUSTRATION_TITLE
  NOITEMS_SMARTTABLE_WITH_FILTER_FOR_SEGMENTEDBUTTON_ILLUSTRATION_DESCRIPTION
```

STEP: 8 — Best practices and message formatting notes

DESCRIPTION: Practical rules to avoid translation overhead and formatting pitfalls:
- Copy & override only required keys to minimize translation cost.
- For keys containing single quotes and {placeholders}, follow UI5 formatMessage escaping: use double single-quotes around curly braces when needed.
- Prefer entity- or action-specific keys for precise UX text; fallback is framework default.
- Use concise and context-specific wording (replace generic "Object" or "Item" with concrete entity names).

LANGUAGE: Text

CODE:
```text
Examples:
# Avoid copying entire bundles—override only the keys you need.
# Formatting note: when using '{0}' inside text with single quotes, escape properly:
EXAMPLE_KEY=You''ve made changes to this object: {0}
# Message with placeholders:
DELETE_WITH_OBJECTINFO=Delete this object ({0} {1})?
```
--------------------------------

**TITLE**: Maintain and Override Standard Chart UI Texts (Fiori elements)

**INTRODUCTION**: Instructions and ready-to-use examples to override default "no data / illustrated message" UI texts for charts used in SAP Fiori elements (OData V2 and V4). Includes file locations, exact i18n keys for V2, and a pattern for overriding V4 illustrated messages.

**TAGS**: fiori-elements, i18n, charts, smartchart, localization, ODataV2, ODataV4

**STEP**: 1 — Locate the i18n resource file

**DESCRIPTION**: Find the app's i18n resource file where UI texts are defined. Common location: webapp/i18n/i18n.properties (or localized variants like i18n_en.properties).

**LANGUAGE**: File path

**CODE**:
```text
# Typical path in a Fiori elements app:
webapp/i18n/i18n.properties
# or per-language:
webapp/i18n/i18n_en.properties
```

**STEP**: 2 — Override SAP Fiori elements for OData V2 standard texts

**DESCRIPTION**: For OData V2 charts (object page and list report charts), you can override the built-in messages by adding the listed i18n keys to your i18n file. Below are the keys provided by the framework and sample values matching the default messages. Replace the right-hand values with your custom copy.

- Keys supported (V2):
  - NOITEMS_SMARTCHART
  - NOITEMS_SMARTCHART_WITH_FILTER
  - NOITEMS_LR_SMARTCHART

Mapping (example):
- NOITEMS_SMARTCHART -> object page chart when no filters and no data
- NOITEMS_SMARTCHART_WITH_FILTER -> object page chart when filters applied and no results
- NOITEMS_LR_SMARTCHART -> list report chart (no filters / starter message)

**LANGUAGE**: properties

**CODE**:
```properties
# webapp/i18n/i18n.properties
# OData V2 - override standard chart texts

# Object page chart: no filters applied & no data
NOITEMS_SMARTCHART=No data found.

# Object page chart: filters applied & no results
NOITEMS_SMARTCHART_WITH_FILTER=No data found. Try adjusting the search or filter parameters.

# List report chart: starter message when no filters and no autoload
NOITEMS_LR_SMARTCHART=To start, set the relevant filters and choose "Go".
```

**STEP**: 3 — Override SAP Fiori elements for OData V4 illustrated messages

**DESCRIPTION**: For OData V4, chart messages are rendered as illustrated messages. The exact i18n keys vary by page and message type; a complete list is available in the "Localization of UI Texts" reference. Use the keys from that reference and add them to your i18n file with your custom strings.

Pattern to follow: add <framework-provided-key>=<your text> to webapp/i18n/i18n.properties

Below are sample placeholder entries illustrating how to override title/description for common scenarios. Replace the placeholder keys with the exact keys from your project's Localization of UI Texts list if they differ.

**LANGUAGE**: properties

**CODE**:
```properties
# webapp/i18n/i18n.properties
# OData V4 - example placeholder keys (replace keys with the exact keys from "Localization of UI Texts")

# List report without autoload
CHART_ILLUSTRATED_TITLE_GET_RESULTS=Let’s get some results
CHART_ILLUSTRATED_DESC_GET_RESULTS=Start by providing your search or filter criteria.

# List report: no filters & no data
CHART_ILLUSTRATED_TITLE_NO_RESULTS=No results found
CHART_ILLUSTRATED_DESC_NO_RESULTS=Start by providing your search or filter criteria.

# List report: filters applied & no results
CHART_ILLUSTRATED_DESC_FILTERS=Try changing your filter criteria.

# Chart in multi-view mode: no data
CHART_ILLUSTRATED_TITLE_MULTI_VIEW=No results found
CHART_ILLUSTRATED_DESC_MULTI_VIEW=Try changing the view or filter criteria.

# Object page: no search/filters and no data
CHART_ILLUSTRATED_TITLE_NO_ITEMS=No items available
CHART_ILLUSTRATED_DESC_NO_ITEMS=When there are, you'll find them here.
```

**STEP**: 4 — Multi-language and testing

**DESCRIPTION**: For additional languages, add the same keys to localized files (e.g., i18n_de.properties, i18n_fr.properties). After editing i18n files, rebuild / reload the app and navigate to the relevant list report or object page chart views to verify the new texts appear under both "no data" and "no results" conditions.

**LANGUAGE**: File path / instructions

**CODE**:
```text
# Add entries to localized i18n files:
webapp/i18n/i18n_de.properties
webapp/i18n/i18n_fr.properties

# Example test steps:
# 1. Deploy and open the app.
# 2. Navigate to the list report and object page charts.
# 3. Trigger scenarios:
#    - No filters + no data
#    - Filters applied + no results
#    - List report without autoload
#    - Multi-view chart with no data
# 4. Confirm overridden messages appear as defined in i18n files.
```

**STEP**: 5 — Reference links

**DESCRIPTION**: Use these references when you need the authoritative key names (especially for OData V4 illustrated messages) or to find related configuration guidance.

**LANGUAGE**: Links

**CODE**:
```text
# Key reference for OData V4 illustrated messages:
# Localization of UI Texts: localization-of-ui-texts-b8cb649.md

# Related configuration:
# Configuring Tables: configuring-tables-f4eb70f.md
```
--------------------------------

**TITLE**: Overriding Standard Table Texts (List Report & Object Page)

**INTRODUCTION**: This guide shows how to override standard message texts (for example, empty/illustrated messages shown when a table has no data) by adding keys to i18n property files used by a Fiori Elements List Report or Object Page. Use this when you need custom titles, descriptions, or actions shown in table empty states.

**TAGS**: fiori-elements-framework, i18n, localization, list-report, object-page, tables, no-data, empty-state

**STEP**: 1 — Locate the correct standard keys to override

**DESCRIPTION**: Identify the exact UI text keys used by Fiori Elements for the table messages you want to change. Refer to:
- "Displaying An Illustrated Message When No Data Is Found" (for illustrated/no-data message patterns)
- "Localization of UI Texts" (complete list of available standard keys)

Use these docs to get the canonical key names to override. Keys may be global (component-level) or page-specific.

**LANGUAGE**: Documentation / Investigation

**CODE**:
```text
Action:
- Open the Fiori Elements docs:
  - Displaying An Illustrated Message When No Data Is Found
  - Localization of UI Texts
- Search for keys used by "no data", "empty state", "illustrated message", "table"
- Note the exact key names (e.g., (example) tableNoDataTitle, tableNoDataDescription, tableNoDataAction)
```

**STEP**: 2 — Add/override keys in the i18n properties file (global/component-level)

**DESCRIPTION**: Add the standard keys you identified to your app's global i18n property file. Typical path: webapp/i18n/i18n.properties. If your app uses bundleName e.g. my.app.i18n.i18n, add keys there so Fiori Elements picks them up for list reports and object pages.

**LANGUAGE**: Properties (i18n)

**CODE**:
```properties
# webapp/i18n/i18n.properties
# Override standard table / empty-state messages
tableNoDataTitle=No items found
tableNoDataDescription=There are no records to display for the current filter selection.
tableNoDataAction=Create new item
```

**STEP**: 3 — Add page-level i18n file (optional) for page-specific overrides

**DESCRIPTION**: If you need overrides only for a specific page (List Report or Object Page), place an i18n file under that page folder (or configure a page-specific resource model). Example path: webapp/pages/<PageName>/i18n/i18n.properties. Ensure this file is registered/loaded by the page (manifest or page configuration).

**LANGUAGE**: Properties (i18n) and JSON (manifest snippet)

**CODE**:
```properties
# webapp/pages/ListReport/i18n/i18n.properties
tableNoDataTitle=No results for this List Report
tableNoDataDescription=Try clearing filters or creating a new entry.
tableNoDataAction=Add entry
```

```json
// manifest.json (add/confirm resource model if page requires its own bundle)
"models": {
  "i18n": {
    "type": "sap.ui.model.resource.ResourceModel",
    "settings": {
      "bundleName": "my.app.i18n.i18n"
    }
  },
  "i18nListReport": {
    "type": "sap.ui.model.resource.ResourceModel",
    "settings": {
      "bundleName": "my.app.pages.ListReport.i18n.i18n"
    }
  }
}
```

**STEP**: 4 — Add locale-specific translations

**DESCRIPTION**: Provide translations by creating locale-specific property files alongside the base i18n file (for example i18n_de.properties, i18n_fr.properties). Keep the same keys and provide translated values.

**LANGUAGE**: Properties (i18n)

**CODE**:
```properties
# webapp/i18n/i18n_de.properties
tableNoDataTitle=Keine Einträge gefunden
tableNoDataDescription=Für die aktuelle Filterauswahl sind keine Datensätze vorhanden.
tableNoDataAction=Neuen Eintrag erstellen
```

**STEP**: 5 — Deploy and verify

**DESCRIPTION**: After adding keys:
- Clear browser cache or do a hard reload.
- Open the List Report or Object Page where the table displays no data.
- Verify the text changes appear in the empty/illustrated state.
- If not visible, confirm you used the exact standard key names (re-check docs), and that the i18n bundle is correctly registered in manifest.json or the page component.

**LANGUAGE**: Commands / Checklist

**CODE**:
```text
Checklist:
- Confirm keys match names from "Localization of UI Texts"
- Confirm i18n file path and bundleName in manifest.json
- Clear cache / hard reload application
- Reproduce the empty-table scenario in the UI and verify texts
```

**STEP**: 6 — Troubleshooting

**DESCRIPTION**: If your overrides do not appear:
- Make sure you edited the bundle file actually referenced by the running app (manifest bundleName).
- Check the console for resource loading errors (404 for .properties files).
- Ensure there are no spelling/casing mismatches in the key names.
- Confirm if the page uses a different control/template that expects different keys (consult the "Localization of UI Texts" doc).

**LANGUAGE**: Troubleshooting notes

**CODE**:
```text
Common fixes:
- Fix bundleName path in manifest.json if 404 occurs for i18n file
- Normalize key casing: keys are case-sensitive
- Add missing locale files for language testing
- Inspect network tab to ensure .properties files are loaded
```
--------------------------------

**TITLE**: Managing Variants (SAP Fiori Elements) — manifest.json configuration and initial-load behavior

**INTRODUCTION**: This document explains how to choose and configure variant management (page-level vs control-level) in SAP Fiori Elements, with concrete manifest.json examples for OData V2 and OData V4, and a concise explanation of which variant is loaded on initial application load. Use these snippets to programmatically enable/disable variant management in generated or hand-maintained apps.

**TAGS**: fiori-elements, variant-management, manifest.json, ODataV2, ODataV4, smartVariantManagement, variantManagement, list-report, analytical-list-page

**STEP**: 1 — Rules and recommendations

**DESCRIPTION**: Key rules and UX recommendations you must enforce in code or templates:
- Do not enable page-level and control-level variant management at the same time for the same page — this causes end-user confusion.
- Use control-level variant management to separate variants for filters and for table/chart controls (filter variant stores filter selections and filter mode).
- Use page-level variant management to capture filter selection, filter mode, view mode, auto-hide icon state (eye icon), chart/table configuration (measures/dimensions), sort order, and grouping.
- For the object page, control-level variant management can be enabled separately (see step 6).

**LANGUAGE**: text

**CODE**:
```text
Rules:
- Only one type of variant management per page: Page OR Control (not both).
- Page-level captures filter + UI state + table/chart personalization.
- Control-level separates filter variants from control (table/chart) variants.
Manifest file: manifest.json
```

**STEP**: 2 — Configure variant management for OData V2 (List Report / Object Page / Worklist)

**DESCRIPTION**: The SAP Fiori generator sets defaults for OData V2:
- List report, Object page, Worklist: smartVariantManagement = true by default.
- Analytical list page: smartVariantManagement = false by default.
Change the default in manifest.json per page/component by adding or updating "smartVariantManagement" under the component "settings". Example manifest.json sample for a List Report page with smartVariantManagement enabled.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "XXXXXX_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "gridTable": false,
            "multiSelect": false,
            "smartVariantManagement": true
          }
        }
      }
    ]
  }
}
```

**STEP**: 3 — Configure OData V2 for Analytical List Page or disable control/page defaults

**DESCRIPTION**: Example: explicitly disable page-level variant management for an analytical list page (or any page) by setting smartVariantManagement to false in the page/component settings in manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.1.0",
    "pages": [
      {
        "entitySet": "SalesAnalytics",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "smartVariantManagement": false
          }
        }
      }
    ]
  }
}
```

**STEP**: 4 — Configure variant management for OData V4 (routing target settings)

**DESCRIPTION**: For OData V4 applications, the manifest structure uses routing target "options.settings.variantManagement". Default is "Page". Set "variantManagement" to "Page", "Control", or "None" per target. Example shows enabling Page for a List target and disabling for an Object target.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "variantManagement": "Page"
            }
          }
        },
        "SalesOrderManageObject": {
          "options": {
            "settings": {
              "variantManagement": "None"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Which variant is loaded on initial load (behavior to implement/test)

**DESCRIPTION**: Implement or test behavior as follows:
- For table and chart control variants: the end user's default variant (the one the user marked as default) is always loaded.
- For filter control variant or page variant:
  - If the app is launched via external navigation with a navigation context (URL parameters or xAppState), apply the incoming navigation context. This overrides the filter values of the end user's default variant; the filter bar will display the variant name as "Standard*" where "*" indicates a non-clean variant. Table/chart personalization from the user default remains.
  - If the app is navigated to with no incoming navigation context, SAP Fiori elements loads the end user's default variant (if configured). If no end-user default exists, the "Standard" variant is used as fallback. Only in this fallback case does the FLP apply end-user default values.
- Ensure your routing/navigation handling preserves personalization (table/chart) when applying incoming navigation filter context.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Pseudocode: apply incoming navigation context (URL/xAppState) then load variant settings
// 1) Check incoming navigation context (URL params or xAppState)
// 2) If present: apply navigation filter values -> overrides page/filter variant values
// 3) Still load control personalizations (table/chart) from user default variant
// 4) If no incoming context: load end-user default variant (if exists), else use "Standard" variant
```

**STEP**: 6 — Enable control-level variant management on the Object Page

**DESCRIPTION**: To enable control-level variant management on the object page, configure the relevant component settings in the object page's route target or use the Page Editor in SAP Business Application Studio / Page Editor UI. See the referenced documentation for a guided UI approach.

**LANGUAGE**: text

**CODE**:
```text
See: Enabling Variant Management on the Object Page
Documentation link: enabling-variant-management-on-the-object-page-f26d42b.md
Or use Page Editor: Configure Page Elements (https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/047507c86afa4e96bb3d284adb9f4726.html)
```

**STEP**: 7 — Notes and quick checks for implementation

**DESCRIPTION**: Quick checklist to validate variant behavior during development and in CI:
- Verify manifest.json modifications are in the correct scope: sap.ui.generic.app.pages[...] for OData V2, sap.ui5.routing.targets...options.settings for OData V4.
- Confirm only one variant mode enabled per page (Page vs Control).
- Test initial-load scenarios:
  - Launch app with URL navigation parameters -> confirm filters overridden, tables keep personalization.
  - Launch with no navigation context -> confirm user default variant loads or "Standard" fallback.
- If using generator defaults, be aware of difference between List/Worklist/Object (V2 default true) and AnalyticalListPage (V2 default false).

**LANGUAGE**: text

**CODE**:
```text
Checklist:
- manifest.json path verified
- Only Page OR Control variant management configured per page
- Initial-load tests: URL navigation vs no navigation context
```
--------------------------------

**TITLE**: Micro Chart Facet — Annotations to add a MicroChart in Object Page Header

**INTRODUCTION**: This guide shows the exact annotation patterns (XML, ABAP CDS, CAP CDS) required to: define a UI.Chart and corresponding UI.DataPoint, reference the chart as a header facet (UI.HeaderFacets / UI.ReferenceFacet), set unit of measure (Measures.ISOCurrency), and apply sort order (UI.PresentationVariant). Use these snippets in your local annotations file to render a micro chart facet in the object page header.

**TAGS**: microchart, header facet, UI.Chart, UI.DataPoint, UI.HeaderFacets, UI.ReferenceFacet, PresentationVariant, Measures.ISOCurrency, ODataV2, ODataV4, FioriElements

STEP: 1 — Define DataPoint and Chart (XML)
DESCRIPTION: Add a UI.DataPoint and a UI.Chart annotation on the entity that provides the micro chart data. The DataPoint is referenced from the chart via MeasureAttributes.DataPoint. Replace entity/paths and qualifier names to match your model. Use this XML in your local annotations file.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.BookingType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <!-- DataPoint definition -->
    <Annotation Term="SAP__UI.DataPoint" Qualifier="FlightPrice">
        <Record>
            <PropertyValue Property="Value" Path="FlightPrice"/>
        </Record>
    </Annotation>

    <!-- Chart definition (qualifier FlightPrice) -->
    <Annotation Term="SAP__UI.Chart" Qualifier="FlightPrice">
        <Record Type="SAP__UI.ChartDefinitionType">
            <PropertyValue Property="ChartType" EnumMember="SAP__UI.ChartType/Column"/>
            <PropertyValue Property="Title" String="Flight Price"/>
            <PropertyValue Property="Measures">
                <Collection>
                    <PropertyPath>FlightPrice</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="MeasureAttributes">
                <Collection>
                    <Record Type="SAP__UI.ChartMeasureAttributeType">
                        <PropertyValue Property="DataPoint" AnnotationPath="@SAP__UI.DataPoint#FlightPrice"/>
                        <PropertyValue Property="Role" EnumMember="SAP__UI.ChartMeasureRoleType/Axis1"/>
                        <PropertyValue Property="Measure" PropertyPath="FlightPrice"/>
                    </Record>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="Dimensions">
                <Collection>
                    <PropertyPath>FlightDate</PropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: 2 — Reference the Chart as a Header Facet (XML)
DESCRIPTION: Add UI.HeaderFacets to the parent/view entity and reference the chart using UI.ReferenceFacet.Target -> AnnotationPath to the chart (use qualifier). The ReferenceFacet can optionally include an ID.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.TravelType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="SAP__UI.HeaderFacets">
        <Collection>
            <Record Type="SAP__UI.ReferenceFacet">
                <PropertyValue Property="ID" String="FlightPrice"/>
                <!-- Target points to the chart qualifier on the child/linked entity -->
                <PropertyValue Property="Target" AnnotationPath="_Booking/@SAP__UI.Chart#FlightPrice"/>
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```

STEP: 3 — Equivalent ABAP CDS: Chart and Header Facet
DESCRIPTION: ABAP CDS equivalents to define the chart and expose it as a header facet. Use @UI.chart on the entity and @UI.facet on the view to reference the target element and qualifier.
LANGUAGE: ABAP CDS
CODE:
```abap
// @Scope: [ENTITY] ("BOOKING")
@UI: {
  chart: [ {
    title     : 'Flight Price',
    qualifier : 'FlightPrice',
    chartType : #COLUMN,
    measures  : [ 'FlightPrice' ],
    measureAttributes: [
      {
        measure   : 'FlightPrice',
        role      : #AXIS_1,
        asDataPoint: true      "asDataPoint means it is linked to a UI.DataPoint
      }
    ],
    dimensions: [ 'FlightDate' ]
  } ]
}

// @Scope: [VIEW] ("TRAVEL")
annotate view VIEWNAME with {
  @UI.facet: [ {
    targetElement   : '_Booking',
    targetQualifier : 'FlightPrice',
    type            : #CHART_REFERENCE,
    purpose         : #HEADER
  } ]
  ...
}

// @Scope: [VIEW] ("BOOKING")
annotate view VIEWNAME with {
  @UI.dataPoint: {
    title: 'Flight Price'
  }
  FlightPrice;
}
```

STEP: 4 — Equivalent CAP CDS: Chart and Header Facet
DESCRIPTION: CAP CDS pattern to annotate the entity with UI.Chart and the view/entity with UI.HeaderFacets pointing to the chart. Use $Type values matching UI annotations.
LANGUAGE: CDS
CODE:
```cds
annotate Booking with @(UI: {
  DataPoint #FlightPrice: { Value: FlightPrice },

  Chart #FlightPrice: {
    $Type            : 'UI.ChartDefinitionType',
    Title            : 'Flight Price',
    ChartType        : #Column,
    Measures         : [ FlightPrice ],
    Dimensions       : [ FlightDate ],
    MeasureAttributes: [{
      $Type    : 'UI.ChartMeasureAttributeType',
      Measure  : FlightPrice,
      Role     : #Axis1,
      DataPoint: '@UI.DataPoint#FlightPrice'
    }]
  }
});

annotate Travel with @(UI: { HeaderFacets: [{
  $Type : 'UI.ReferenceFacet',
  ID    : 'FlightPrice',
  Target: '_Booking/@UI.Chart#FlightPrice'
}]});
```

STEP: 5 — Unit of Measure: Measures.ISOCurrency (XML)
DESCRIPTION: Add a Measures.ISOCurrency annotation on the property that represents the currency code for the chart's value property (as used in UI.DataPoint.Value). The unit appears in the micro chart footer.
LANGUAGE: XML
CODE:
```xml
<!-- Target is the property path on the value entity type -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm"
             Target="STTA_PROD_MAN.STTA_C_MP_ProductSalesPriceType/AreaChartPrice">
     <Annotation Term="Org.OData.Measures.V1.ISOCurrency" Path="Currency"/>
</Annotations>
```

STEP: 6 — Unit of Measure: ABAP CDS and CAP CDS
DESCRIPTION: ABAP CDS and CAP CDS annotations for currency/unit mapping. Apply Semantics/Measures annotations to the value and currency properties.
LANGUAGE: ABAP CDS
CODE:
```abap
@Semantics.amount.currencyCode: 'Currency'
AreaChartPrice;
@Semantics.currencyCode: true
Currency;
```

LANGUAGE: CDS
CODE:
```cds
annotate STTA_PROD_MAN.STTA_C_MP_ProductSalesPriceType with {
  @Measures.ISOCurrency : Currency
  AreaChartPrice;
}
```

STEP: 7 — Apply Sort Order Using PresentationVariant (XML)
DESCRIPTION: To sort micro chart data, define a UI.PresentationVariant with SortOrder and Visualizations that reference the chart qualifier. Micro charts use only SortOrderType (ascending/descending). Reference the PresentationVariant from UI.HeaderFacets.Target.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="SAP__self.BookingType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <!-- Chart + DataPoint definitions (as in Step 1) omitted for brevity -->

    <Annotation Term="SAP__UI.PresentationVariant">
        <Record Type="SAP__UI.PresentationVariantType">
            <PropertyValue Property="SortOrder">
                <Collection>
                    <Record Type="SAP__Common.SortOrderType">
                        <PropertyValue Property="Property" PropertyPath="FlightPrice" />
                        <PropertyValue Property="Descending" Bool="false" />
                    </Record>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="Visualizations">
                <Collection>
                    <AnnotationPath>@SAP__UI.Chart#FlightPrice</AnnotationPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>

<Annotations Target="SAP__self.TravelType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="SAP__UI.HeaderFacets">
        <Collection>
            <Record Type="SAP__UI.ReferenceFacet">
                <PropertyValue Property="ID" String="FlightPrice"/>
                <PropertyValue Property="Target" AnnotationPath="_Booking/@SAP__UI.PresentationVariant"/>
            </Record>
        </Collection>
    </Annotation>
</Annotations>
```

STEP: 8 — PresentationVariant: ABAP CDS and CAP CDS
DESCRIPTION: ABAP CDS and CAP CDS pattern declaring presentationVariant with SortOrder and visualizations pointing to chart qualifier.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI: {
  presentationVariant: [ {
    sortOrder: [ { by: 'FlightPrice', direction: #ASC } ],
    visualizations: [ { type: #AS_CHART, qualifier: 'FlightPrice' } ]
  } ],
  chart: [ { qualifier: 'FlightPrice', title: 'Flight Price', chartType: #COLUMN, measures: ['FlightPrice'], dimensions: ['FlightDate'] } ]
}
```

LANGUAGE: CDS
CODE:
```cds
annotate Booking with @(UI: {
  DataPoint #FlightPrice: {Value: FlightPrice},

  Chart #FlightPrice: {
    $Type: 'UI.ChartDefinitionType',
    Title: 'Flight Price',
    ChartType: #Column,
    Measures: [FlightPrice],
    Dimensions: [FlightDate],
    MeasureAttributes: [{
      $Type: 'UI.ChartMeasureAttributeType',
      Measure: FlightPrice,
      Role: #Axis1,
      DataPoint: '@UI.DataPoint#FlightPrice'
    }]
  },

  PresentationVariant: {
    Visualizations: ['@UI.Chart#FlightPrice'],
    SortOrder: [{
      Property: FlightPrice,
      Descending: false
    }]
  }
});

annotate Travel with @(UI: { HeaderFacets: [{
  $Type : 'UI.ReferenceFacet',
  ID    : 'FlightPrice',
  Target: '_Booking/@UI.PresentationVariant'
}]});
```

STEP: 9 — Important Notes and Restrictions (use when implementing)
DESCRIPTION: Use these constraints to validate and design backend/service behavior before implementing micro chart facets.
LANGUAGE: PlainText
CODE:
```text
- Navigation properties inside UI.Chart are not supported by the template (OData V2 and V4). Do not use navigation property paths in the UI.Chart term.
- Micro charts require backend aggregation: the service must return aggregated data so that each key has a single record (client doesn't perform aggregation).
- Micro charts support DataPoint Criticality and CriticalityCalculation (link MeasureAttributes.DataPoint to a UI.DataPoint annotation).
- For OData V4 only: title navigation can be enabled for in-page and external navigation (see "Navigation from Header Facet Title" in Fiori docs).
- Supported micro chart types for header facets include: Area, Line, Column, Comparison, Stacked Bar, Bullet, Radial, Harvey (see related micro chart docs).
- Sorting: micro charts only consider SortOrderType in PresentationVariant; other PresentationVariant properties are ignored for sorting behavior.
```

**Related files and references**:
- Local annotations file (your annotations XML or local CDS annotation files) — add the shown snippets there.
- See related micro chart documentation pages:
  - area-micro-chart-1467f2b.md
  - bullet-micro-chart-b915166.md
  - radial-micro-chart-51eb569.md
  - line-micro-chart-e5cb2af.md
  - column-micro-chart-1a4ecb8.md
  - harvey-micro-chart-de4f8bf.md
  - stacked-bar-micro-chart-9c93837.md
  - comparison-micro-chart-9d126f1.md
--------------------------------

**TITLE**: Migrate SAP Web IDE Fiori Project to SAP Business Application Studio or Visual Studio Code

**INTRODUCTION**: Short, actionable steps to migrate an existing SAP Fiori (SAPUI5 / Fiori elements) project created in SAP Web IDE to SAP Business Application Studio (BAS) or Visual Studio Code (VS Code). Covers exporting the project, importing into BAS/VS Code, installing required tooling/extensions, adding ui5 tooling config, common package.json scripts, and a minimal xs-app.json for BTP HTML5 deployment/preview.

**TAGS**: fiori-elements-framework, migration, sap-web-ide, sap-business-application-studio, visual-studio-code, ui5, ui5-tooling, xs-app.json, ui5.yaml

STEP: 1 — Backup / Export Project from SAP Web IDE

DESCRIPTION: Create a local copy of your project. If the project is in a Git repository, clone it. Otherwise download/export it from SAP Web IDE as a ZIP and extract.

LANGUAGE: Shell

CODE:
```bash
# If using Git
git clone <git-repo-url> my-fiori-app
cd my-fiori-app

# If downloading from SAP Web IDE: extract zip into a folder
unzip MyWebIDEProject.zip -d my-fiori-app
cd my-fiori-app
```

STEP: 2 — Open Project in SAP Business Application Studio or Visual Studio Code

DESCRIPTION: Open the project folder in BAS or VS Code. In BAS use "File > Open Workspace" or clone from Git. In VS Code use "File > Open Folder" or `code .`.

LANGUAGE: Shell / Instruction

CODE:
```bash
# Open in VS Code (CLI)
code .
```

STEP: 3 — Install Recommended Extensions and UI5 Tooling

DESCRIPTION: Install the SAP Fiori tools extensions and ui5 tooling for local development and preview. In VS Code install "SAP Fiori tools - Extensions Pack" and "UI5 language assistant". In BAS install the equivalent extensions in the Dev Space. Then install @ui5/cli locally as a dev dependency.

LANGUAGE: Shell / JSON

CODE:
```bash
# Install UI5 CLI locally (recommended)
npm install --save-dev @ui5/cli

# Optionally install globally if preferred
# npm install --global @ui5/cli
```

STEP: 4 — Add ui5.yaml for UI5 Tooling or verify webapp path

DESCRIPTION: Add a minimal ui5.yaml to enable ui5-tooling (ui5 serve, ui5 build). Ensure the webapp path matches your project structure (commonly "webapp").

LANGUAGE: YAML

CODE:
```yaml
specVersion: '2.1'
metadata:
  name: my-fiori-app
type: application
resources:
  configuration:
    paths:
      webapp: webapp
```

STEP: 5 — Add / Update package.json scripts for local preview and build

DESCRIPTION: Add scripts that use ui5 tooling for local development and building production assets.

LANGUAGE: JSON

CODE:
```json
{
  "name": "my-fiori-app",
  "version": "1.0.0",
  "scripts": {
    "start": "ui5 serve --open index.html",
    "start:proxy": "ui5 serve --open index.html --config=./ui5-middleware-proxy.yaml",
    "build": "ui5 build --clean --include-dependencies",
    "deploy": "npm run build && <your-deploy-command>"
  },
  "devDependencies": {
    "@ui5/cli": "^3.0.0"
  }
}
```

STEP: 6 — (Optional) Add ui5-middleware-proxy for backend OData during local development

DESCRIPTION: To locally proxy OData requests to a backend, add a ui5-middleware proxy config file and run `npm run start:proxy`.

LANGUAGE: YAML

CODE:
```yaml
# ui5-middleware-proxy.yaml
routes:
  - path: /sap/opu/odata/sap
    url: https://<backend-host>
    changeOrigin: true
    headers:
      # Add additional headers if required
```

STEP: 7 — Verify SAPUI5 / Fiori Elements Dependencies and Manifest

DESCRIPTION: Ensure manifest.json, webapp folder, index.html and any component files exist and are correct. Update dependencies to supported UI5 versions if necessary (check package.json or libs referenced in index.html/manifest). Replace any SAP Web IDE specific tooling references.

LANGUAGE: Instruction

CODE:
```text
- Confirm webapp/manifest.json exists and contains required sap.ui5 and routing definitions.
- If index.html references a CDN UI5 version, update to the supported version or switch to local UI5 via ui5 tooling.
```

STEP: 8 — Minimal xs-app.json for HTML5 Application Repository (BTP) (if deploying to SAP BTP)

DESCRIPTION: If your project used neo-app.json in Web IDE or you will deploy to the SAP BTP HTML5 Application Repository, add/adjust xs-app.json routing and welcome file settings. This is used by SAP BTP router.

LANGUAGE: JSON

CODE:
```json
{
  "welcomeFile": "/index.html",
  "authenticationMethod": "none",
  "routes": [
    {
      "source": "^/resources/(.*)$",
      "target": "$1",
      "localDir": "resources"
    },
    {
      "source": "^/(.*)$",
      "target": "$1",
      "localDir": "webapp"
    }
  ]
}
```

STEP: 9 — Run Local Preview and Test

DESCRIPTION: Start local server and verify the app runs. Use Fiori tools preview in VS Code/BAS or ui5 serve.

LANGUAGE: Shell

CODE:
```bash
# Start local preview
npm run start

# If proxy configured for OData:
npm run start:proxy
```

STEP: 10 — Build and Deploy to BTP (high-level)

DESCRIPTION: Build with ui5 build, then deploy to your chosen target (HTML5 repo, Cloud Foundry, or ABAP). Replace <your-deploy-command> in package.json deploy script with your CI/deploy steps (e.g., cf push, sap deploy commands, or MTA packaging).

LANGUAGE: Shell / Instruction

CODE:
```bash
# Build production artifacts
npm run build

# Example: deploy to HTML5 Application Repository (Cloud Foundry)
# (Use your CLI/process for uploading built webapp/dist to the BTP HTML5 repo)
# cf login ...
# <upload/put command>
```

STEP: 11 — Important Notes and Links

DESCRIPTION: Caution about SAP Web IDE availability and links for additional documentation.

LANGUAGE: Markdown / Links

CODE:
```text
- Caution: SAP Web IDE is no longer available from SAP Business Technology Platform trial accounts. References to SAP Web IDE apply only if you have access via a productive SAP BTP account. Consider SAP Business Application Studio as an alternative.
- Migration reference: https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/70d41f3ee29d453a90efab3ce025d450.html
- App development in BAS: ../05_Developing_Apps/app-development-using-sap-business-application-studio-6bbad66.md
```

--------------------------------

**TITLE**: Migrate from registerControllerExtensions to manifest-based controller extensions (Fiori elements OData V2)

**INTRODUCTION**: This guide shows the code-level migration steps to move from the deprecated registerControllerExtensions API to manifest-based controller extensions for SAP Fiori elements (OData V2). It covers manifest.json registration, converting child controllers to sap.ui.core.mvc.ControllerExtension, updating event-handler references in manifest and views/fragments, and accessing extensionAPI from controller extensions. Apply these changes to object page floorplans where previously a parent controller registered multiple child controllers.

**TAGS**: sapui5, fiori-elements, migration, controller-extension, manifest.json, ObjectPage, ODataV2

**STEP**: 1 — Current setup and intent

**DESCRIPTION**: Identify current controller files and remove the parent registration approach. Existing project contains:
- webapp/ext/DetailsExtension.controller.js (parent, previously invoking extensionAPI.registerControllerExtensions)
- webapp/ext/SalesOrderExtension.controller.js (child, for entity set C_STTA_SalesOrder_WD_20)
- webapp/ext/SalesOrderItemExtension.controller.js (child, for entity set C_STTA_SalesOrderItem_WD_20)

From SAPUI5 version 2.0 onward: keep only child controllers and register them in manifest.json under sap.ui.controllerExtensions. Remove the parent controller file.

**LANGUAGE**: text

**CODE**:
```text
Files to remove/keep:
- Remove: webapp/ext/DetailsExtension.controller.js
- Keep:    webapp/ext/SalesOrderExtension.controller.js
           webapp/ext/SalesOrderItemExtension.controller.js
```

**STEP**: 2 — Register child controllers in manifest.json (sap.ui.controllerExtensions)

**DESCRIPTION**: Add entries for each child controller under sap.ui.controllerExtensions. Use the registration key format:
<FLOOR_PLAN_MODULE_NAME>#<STABLE_ID_OF_VIEW>
Populate sap.ui.generic.app configuration (entity set, Header/Sections actions etc.) inside that controller extension entry. Remove the parent controller extension entry from sap.ui.controllerExtensions.

Example for SalesOrder view registration key and content (copy header/section actions from previous parent controller to the corresponding child controller entry):

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "controllerExtensions": {
      "sap.suite.ui.generic.template.ObjectPage.view.Details#STTASOWD20::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20": {
        "controllerName": "STTASOWD20.ext.controller.SalesOrderExtension",
        "sap.ui.generic.app": {
          "C_STTA_SalesOrder_WD_20": {
            "EntitySet": "C_STTA_SalesOrder_WD_20",
            "Header": {
              "Actions": {
                /* copy header actions from parent controller extension */
              }
            },
            "Sections": {
              "Actions": {
                /* copy section actions from parent controller extension */
              }
            }
          }
        }
      },
      "sap.suite.ui.generic.template.ObjectPage.view.Details#STTASOWD20::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrderItem_WD_20": {
        "controllerName": "STTASOWD20.ext.controller.SalesOrderItemExtension",
        "sap.ui.generic.app": {
          "C_STTA_SalesOrderItem_WD_20": {
            "EntitySet": "C_STTA_SalesOrderItem_WD_20"
            /* add Header/Sections as needed */
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Convert child controllers to sap.ui.core.mvc.ControllerExtension

**DESCRIPTION**: Each child controller extension must extend sap.ui.core.mvc.ControllerExtension. Place framework-overridden methods under override: { ... } and add custom methods after override. Keep namespaced module ID consistent with manifest controllerName (e.g., STTASOWD20.ext.controller.SalesOrderExtension). Ensure overridden lifecycle and framework hook methods (onInit, onBeforeRendering, adaptNavigationParameterExtension, beforeSaveExtension, beforeDeleteExtension, etc.) go inside override.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/ext/SalesOrderExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension"
], function (ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("STTASOWD20.ext.controller.SalesOrderExtension", {
    override: {
      onInit: function () {
        // Initialization tasks for the extension
        // You can initialize this.extensionAPI here, see STEP 5
      },

      // Example framework hooks that must be inside override
      adaptNavigationParameterExtension: function (oSelectionVariant, oObjectInfo) {
        // Modify navigation parameters if needed
      },
      onBeforeRendering: function () {
        // Hook called before rendering
      },
      beforeDeleteExtension: function () {
        // Called before delete
      },
      beforeSaveExtension: function () {
        // Called before save
      }
    },

    // Custom methods (called from manifest or view via .extension.<module>.<method>)
    onObjectPage1CustomAction: function (oEvent) {
      // Custom action handler
    },
    onSalesOrderInfo: function (oEvent) {
      // Custom helper method
    },
    onSalesOrderItemInfo: function (oEvent) {
      // Custom helper method
    }
  });
});
```

**STEP**: 4 — Update manifest and view/fragment press handler references

**DESCRIPTION**: Change all press/event handler references from simple method names to the extension-qualified format:
".extension.<CONTROLLER_MODULE_NAME>.<METHOD_NAME>"

Update manifest.sap.ui.generic.app action press entries and any view/fragment press attributes to use this format. Use the same extension-qualified access when specifying event handlers in XML views or fragments.

- Before: "press": "onObjectPage1CustomAction"
- After:  "press": ".extension.STTASOWD20.ext.controller.SalesOrderExtension.onObjectPage1CustomAction"

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "C_STTA_SalesOrder_WD_20": {
      "EntitySet": "C_STTA_SalesOrder_WD_20",
      "Header": {
        "Actions": {
          "ObjectPageCustomAction": {
            "id": "ObjectPageCustomAction",
            "text": "Custom Action 1",
            "press": ".extension.STTASOWD20.ext.controller.SalesOrderExtension.onObjectPage1CustomAction",
            "determining": true,
            "applicablePath": "IsActiveEntity"
          }
        }
      }
    }
  }
}
```

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/ext/fragments/MyFragment.fragment.xml -->
<core:FragmentDefinition xmlns:core="sap.ui.core" xmlns="sap.m">
  <Button id="previousMemoBtn"
          text="{i18n>yes}"
          press=".extension.STTASOWD20.ext.controller.SalesOrderExtension.onPressPreviousMemo" />
</core:FragmentDefinition>
```

**STEP**: 5 — Access extensionAPI from within ControllerExtension

**DESCRIPTION**: To use extensionAPI methods inside a ControllerExtension, obtain the extensionAPI instance from the underlying view controller via this.getView().getController().extensionAPI. Initialize it in override.onInit and store on this for reuse. Example demonstrates calling getSelectedContexts with a control ID.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// webapp/ext/SalesOrderExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/ControllerExtension"
], function (ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("STTASOWD20.ext.controller.SalesOrderExtension", {
    override: {
      onInit: function () {
        // Initialize extensionAPI reference for reuse
        this.extensionAPI = this.getView().getController().extensionAPI;
      }
    },

    onSalesOrderInfo: function () {
      // Example usage of extensionAPI
      // Pass the control ID (view-scoped) or the stable ID format used in the app
      var aSelectedContexts = this.extensionAPI.getSelectedContexts("SalesOrderItemsID::responsiveTable");
      // process selected contexts...
    }
  });
});
```

**STEP**: 6 — Final cleanup and verification

**DESCRIPTION**: Remove the parent controller file (DetailsExtension.controller.js) and its manifest.controllerExtensions entry. Ensure:
- All child controller modules referenced in manifest.controllerExtensions exist.
- All overridden hooks are under override.
- All event handler references in manifest and XML use ".extension.<module>.<method>" format.
- Build and run the app; verify header/section actions and custom action handlers work as before.

**LANGUAGE**: text

**CODE**:
```text
Checklist:
- Deleted webapp/ext/DetailsExtension.controller.js
- Removed DetailsExtension entry from sap.ui.controllerExtensions in manifest.json
- Confirmed controllerName values in manifest map to actual module IDs
- Converted child controllers to ControllerExtension with override section
- Updated all "press" handlers to .extension.<module>.<method> in manifest, views, fragments
- Initialized extensionAPI via this.getView().getController().extensionAPI inside override.onInit
- Tested custom actions and framework hooks (onInit, beforeSaveExtension, etc.)
```
--------------------------------

**TITLE**: modifyStartupExtension — Modify startup parameters for Fiori elements (OData V2)

**INTRODUCTION**: Use the modifyStartupExtension extension method in your application extension.controller.js to modify startup parameters (selectionVariant, semanticDates, urlParameters, selectedQuickVariantSelectionKey) for List Report, Analytical List Page (ALP), and Overview Page. Applicable only for SAP Fiori elements for OData V2. These snippets show common patterns: combine/rename/remove parameters, add select options (including ranges), set semantic date ranges, and dynamically select a tab/view.

**TAGS**: fiori-elements, odata-v2, modifyStartupExtension, selectionVariant, semanticDates, urlParameters, quickVariantSelectionKey, list-report, analytical-list-page, overview-page, extension

**STEP**: 1 — Extension signature and oStartupObject shape

**DESCRIPTION**: Placement and expected properties of the startup object passed to the extension method. Implement this method in your application extension.controller.js file (the controller extension where you override Fiori element extension points).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// In application extension.controller.js
modifyStartupExtension: function (oStartupObject) {
    // oStartupObject properties:
    // - selectionVariant: SelectionVariant object from navigation (has methods like getSelectOption, addParameter, removeParameter, addSelectOption)
    // - urlParameters: key/value map from URL (use to decide which tab/view to select)
    // - selectedQuickVariantSelectionKey: optional string to force default tab (manifest-defined quickVariantSelectionKey)
    // - semanticDates: object containing semantic date ranges (modify or replace)
}
```

**STEP**: 2 — List Report: combine/rename/remove parameters, add select options, set semanticDates, select tab via selectedQuickVariantSelectionKey or urlParameters

**DESCRIPTION**: Example overrides for list report. Shows:
- Removing/adding parameters (combine FiscalYear + FiscalPeriod into FiscalYearPeriod pattern).
- Adding simple select options and range select option (BT).
- Overriding semanticDates format.
- Choosing a tab by setting selectedQuickVariantSelectionKey or by inspecting urlParameters.

Place this function in your application extension.controller.js (controller extension).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
modifyStartupExtension: function (oStartupObject) {
    var oSelectionVariant = oStartupObject.selectionVariant;

    if (oSelectionVariant) {
        // Remove an incoming parameter
        oSelectionVariant.removeParameter("TaxAmount");

        // Add/rename/transform parameters (example: combine FiscalYear + FiscalPeriod)
        var fiscalYear = oSelectionVariant.getParameter("FiscalYear");
        var fiscalPeriod = oSelectionVariant.getParameter("FiscalPeriod");
        if (fiscalYear && fiscalPeriod) {
            // combine into one parameter expected by the target app
            oSelectionVariant.removeParameter("FiscalYear");
            oSelectionVariant.removeParameter("FiscalPeriod");
            oSelectionVariant.addParameter("FiscalYearPeriod", fiscalYear + "-" + fiscalPeriod);
        }

        // Add a single-value parameter
        oSelectionVariant.addParameter("Product", "EPM-2365436");

        // Add a select option (simple equality)
        oSelectionVariant.addSelectOption("Category", "I", "EQ", "A");

        // Add a range select option (Between)
        // Signature: addSelectOption(name, sign, option, low, high)
        oSelectionVariant.addSelectOption("Price", "I", "BT", "1000", "5000");
    }

    // Override or set semanticDates object as required by the app
    oStartupObject.semanticDates = {
        "Dates": [
            {
                "PropertyName": "PickingDate",
                "Data": {
                    "operation": "YESTERDAY",
                    "value1": null,
                    "value2": null,
                    "key": "filterPickingDate",
                    "calendarType": "Gregorian"
                }
            }
        ]
    };

    // Option A: set the default tab by quick variant key (manifest-defined)
    oStartupObject.selectedQuickVariantSelectionKey = "_tab2";

    // Option B: dynamically choose a tab based on URL parameters (urlParameters example)
    // Example: urlParameters.status === "PAID" => choose paid tab
    if (oStartupObject.urlParameters && oStartupObject.urlParameters.status === "PAID") {
        oStartupObject.selectedQuickVariantSelectionKey = "_tabPaid";
    }
}
```

**STEP**: 3 — Analytical List Page: modify selectionVariant safely and set semanticDates

**DESCRIPTION**: ALP receives a SelectionVariant in oStartupObject.selectionVariant. Use getSelectOption safely (check for existence) before reading values, then add select options or parameters. Replace or add semanticDates as needed. This code should be in your application extension.controller.js.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
modifyStartupExtension: function (oStartupObject) {
    var oSelectionVariant = oStartupObject.selectionVariant;

    if (oSelectionVariant) {
        // Safe read of select option array for "CustomerCountry"
        var aCountryOptions = oSelectionVariant.getSelectOption("CustomerCountry");
        if (Array.isArray(aCountryOptions) && aCountryOptions.length > 0 && aCountryOptions[0].Low === "AR") {
            oSelectionVariant.addSelectOption("WBSElement", "I", "EQ", "BLUE PRINT VALIDATION");
            oSelectionVariant.addSelectOption("CompanyCode", "I", "EQ", "EASI");
        }

        // Add an empty equality filter example (matches empty value)
        oSelectionVariant.addSelectOption("c", "I", "EQ", "");
    }

    // Replace semanticDates (example semantic custom date)
    oStartupObject.semanticDates = {
        "Dates": [
            {
                "PropertyName": "SemanticCustomDate",
                "Data": {
                    "operation": "YESTERDAY",
                    "value1": null,
                    "value2": null,
                    "key": "SemanticCustomDate",
                    "calendarType": "Gregorian"
                }
            }
        ]
    };
}
```

**STEP**: 4 — Overview Page: add select options to the incoming selection variant

**DESCRIPTION**: For overview page navigation, the extension receives a selectionVariant-like object (oCustomSelectionVariant). Add select options or parameters to refine incoming filter context. Implement in application extension.controller.js.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
modifyStartupExtension: function (oCustomSelectionVariant) {
    // Add a select option to filter SupplierName equals "Talpa"
    oCustomSelectionVariant.addSelectOption("SupplierName", "I", "EQ", "Talpa");
}
```

**STEP**: 5 — Quick reference: common SelectionVariant API used in examples

**DESCRIPTION**: Quick examples of frequently used SelectionVariant methods to use inside modifyStartupExtension.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Common SelectionVariant methods (usage examples)
oSelectionVariant.getParameter("Name");            // read parameter value
oSelectionVariant.addParameter("Name", "Value");  // add/override parameter
oSelectionVariant.removeParameter("Name");        // remove parameter

// Select options: name, sign ("I" include / "E" exclude), option ("EQ","BT","LE",etc.), low, high (for ranges)
oSelectionVariant.addSelectOption("Field", "I", "EQ", "Value");
oSelectionVariant.addSelectOption("FieldRange", "I", "BT", "1000", "5000");
var aOptions = oSelectionVariant.getSelectOption("Field"); // returns array or undefined
```

**STEP**: 6 — Important behavior notes

**DESCRIPTION**: Runtime behavior and where the extension is invoked.

**LANGUAGE**: Text

**CODE**:
```text
- Applicable only for SAP Fiori elements OData V2.
- The modifyStartupExtension call is executed on initial navigation to the Analytical List Page.
  It is NOT called for subsequent actions (changing variants, modifying filter bar selections,
  navigating back, or refreshing when an iAppState exists).
- Use oStartupObject.urlParameters only to decide which tab/view to select; do not rely on it
  for permanent state changes without validating values.
```
--------------------------------

**TITLE**: Multi-Selection for Intent-Based Navigation (Fiori Elements, OData V4)

**INTRODUCTION**: Explain how multi-selection works for intent-based navigation in SAP Fiori elements (OData V4). Show the limitation when records lack a unique key and provide the exact structure of the selectionVariant payload that is passed during multi-record intent navigation.

**TAGS**: fiori-elements, odata-v4, intent-based-navigation, multi-selection, selection-variant, navigation

**STEP**: Default behavior and applicability

**DESCRIPTION**: Multi-selection for intent-based navigation is enabled by default. This behavior and the sample payload shown in subsequent steps apply only to SAP Fiori elements for OData V4.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "multiSelectionForIntentBasedNavigation": "enabled by default",
  "applicability": "SAP Fiori elements for OData V4 only"
}
```

**STEP**: Problem when records lack a unique key (example input contexts)

**DESCRIPTION**: If the selected rows do not contain a unique key that identifies each combined record context, the selectionVariant combines individual property values across records. This results in a filter that is a conjunction (AND) of properties and a disjunction (OR) of values per property, producing spurious combinations that did not exist in the original selection.

Provide the input records as a code-friendly data structure and show the logical combination that will be produced in the target app.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "selectedRecords": [
    { "recordId": 1, "P1": "A", "P2": "X" },
    { "recordId": 2, "P1": "B", "P2": "Y" },
    { "recordId": 3, "P1": "A", "P2": "Y" }
  ],
  "note": "Because there is no unique composite key passed, the resulting selectionVariant is interpreted as: (P1 = A OR P1 = B) AND (P2 = X OR P2 = Y). This allows the combination P1=B and P2=X (BX) which did not exist in the original selection."
}
```

**STEP**: Structure and example of the selectionVariant payload passed during multi-selection navigation

**DESCRIPTION**: The selectionVariant contains SelectOptions entries per property. Each SelectOptions entry lists Ranges for the values captured from selected rows. In the selectionVariant:
- "Sign": inclusion flag ("I" for include)
- "Option": comparison operator ("EQ" for equals)
- "Low": the value
- "High": typically null for EQ

Below is an annotated JavaScript example that preserves the original sample and comments indicating which selected-row context provided each Range entry.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
const selectionVariantPayload = {
  selectionVariant: {
    SelectOptions: [
      {
        PropertyName: "SalesOrder",
        Ranges: [
          { Sign: "I", Option: "EQ", Low: "2919682", High: null }, // from 1st selected record -> SalesOrder
          { Sign: "I", Option: "EQ", Low: "2915717", High: null }  // from 2nd selected record -> SalesOrder
        ]
      },
      {
        PropertyName: "SalesOrderType",
        Ranges: [
          { Sign: "I", Option: "EQ", Low: "OR", High: null }, // from 1st selected record -> SalesOrderType
          { Sign: "I", Option: "EQ", Low: "SE", High: null }  // from 2nd selected record -> SalesOrderType
        ]
      },
      {
        PropertyName: "TransactionCurrency",
        Ranges: [
          { Sign: "I", Option: "EQ", Low: "EUR", High: null },
          { Sign: "I", Option: "EQ", Low: "USD", High: null }
        ]
      }
      // ... additional properties and ranges follow the same structure
    ]
  }
};
```
--------------------------------

**TITLE**: Multiple Views in a List Report — modes, annotations, manifest config, and APIs

**INTRODUCTION**: This document explains how to implement multiple views (variant management) on an SAP Fiori elements List Report. It covers single-table vs multiple-table modes, which annotations to use, manifest.json configuration examples (including multiple entity sets, visibility binding, and sticky header control), controller-extension API calls to refresh view content/counts, and step-by-step actions in SAP Fiori Tools to add views.

**TAGS**: fiori-elements-framework, list-report, views, manifest, annotations, odata-v4, odata-v2, variant-management, extension-api

STEP: 1 — Modes and UI behavior

DESCRIPTION: Understand the two UI modes and their behavior so you can generate the correct configuration and UI controls.

- Single table mode:
  - One table instance, one toolbar, one variant management control.
  - Views switched via a segmented button (or a select control if > 3 views).
  - Use this mode when view differences are limited to filter criteria (SelectionVariant).
- Multiple table mode:
  - One table instance per view (n views → n table instances).
  - An icon tab bar switches between table instances.
  - Use this mode when you need different presentation (sort order, columns, visualization) per view (SelectionPresentationVariant or PresentationVariant).
- Note: If a property used in multiple views is not in SelectionFields, remove it from the FilterBar so users cannot add it via adapt filter.
- Restriction (OData V2 multiple views): Do not use StandardList or ObjectList in multiple view scenarios.

LANGUAGE: None

CODE:
```text
UI assets:
<link rel="stylesheet" type="text/css" href="../css/sap-icons.css"/>

Images (reference):
images/Single_Table_Mode_8a3bdfd.jpg
images/Multiple_Table_Mode_1be5a97.png
images/Multiple_Table_Mode_with_Charts_a0ae409.png
images/Multiple_Views_with_Multiple_Entity_Sets_1f20511.png
```

STEP: 2 — Which annotations to use

DESCRIPTION: Choose annotations based on what you need to describe for each view.

- Use SelectionVariant when you only need to describe which data is displayed (filter criteria).
  - Suitable for single table mode.
- Use SelectionPresentationVariant when you need to describe both which data and how to display it (sort order, presentation).
  - Can be used only in multiple table mode and multiple table mode with charts.
- Use PresentationVariant if you only need a different visualization (presentation).
- For OData vocabularies and details, refer to the UI vocabulary:
  - https://github.com/SAP/odata-vocabularies/blob/main/vocabularies/UI.md

LANGUAGE: None

CODE:
```text
Annotation choices:
- SelectionVariant
- SelectionPresentationVariant
- PresentationVariant
```

STEP: 3 — manifest.json: sample configuration for multiple views + sticky header + visibility binding

DESCRIPTION: Add views to your list report target in the manifest.json. The following sample illustrates:
- using variantManagement = "Control"
- enabling initialLoad
- disabling stickyMultiTabHeader (keeps tab bar visible while scrolling by default; set to false to hide)
- defining views[] -> paths[] entries with:
  - key (tab key)
  - annotationPath (SelectionVariant reference)
  - optional contextPath (to use a different entity set per tab)
  - visible property that supports Boolean, path, or an expression binding

LANGUAGE: JSON

CODE:
```json
"targets": {
     "DraftList": { 
          "type": "Component",
          "id": "DraftList",
          "name": "sap.fe.templates.ListReport",
          "options": {
               "settings": {
                    "contextPath": "/FirstDraft",
                    "variantManagement": "Control",
                    "initialLoad": "Enabled",
                    "stickyMultiTabHeader": false,
                    "views": {
                         "paths": [
                              {
                                   "key": "tab1",
                                   "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#One",
                                   "visible": "{= ${/MySingleton/IsViewAvailable} === true}"
                              },
                              {
                                   "key": "tab2",
                                   "contextPath": "/SecondDraft",
                                   "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Two"
                              }
                         ]
                    }
               }
               …
          }
     }
}
…
```

STEP: 4 — Use different entity sets per tab (manifest example)

DESCRIPTION: To show different entity sets on different tabs, specify contextPath on the corresponding view entry. Example shows tab2 using /SecondDraft while the page contextPath is /FirstDraft (tab1).

LANGUAGE: JSON

CODE:
```json
{
  "settings": {
    "contextPath": "/FirstDraft",
    "views": {
      "paths": [
        {
          "key": "tab1",
          "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#One"
        },
        {
          "key": "tab2",
          "contextPath": "/SecondDraft",
          "annotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#Two"
        }
      ]
    }
  }
}
```

STEP: 5 — Controller extension: refresh view content and counts via ExtensionAPI

DESCRIPTION: Use the ListReport ExtensionAPI to control refresh behavior programmatically:
- setTabContentToBeRefreshedOnNextOpening(tabKey) — mark tab to reload content next time it opens
- refreshTabsCount() — refresh counts for all tabs
Place calls in your controller extension where you have access to the extensionAPI (the framework injects it into the controller).

LANGUAGE: JavaScript

CODE:
```javascript
// Example in a controller extension (ListReport controller extension)
// The framework provides this.extensionAPI in controller extensions.

onSomeEvent: function () {
    // Mark a specific tab (by key) to be reloaded the next time it is opened
    const tabKey = "tab1";
    if (this.extensionAPI && typeof this.extensionAPI.setTabContentToBeRefreshedOnNextOpening === "function") {
        this.extensionAPI.setTabContentToBeRefreshedOnNextOpening(tabKey);
    }

    // Refresh the counts that appear in the multi-tab header
    if (this.extensionAPI && typeof this.extensionAPI.refreshTabsCount === "function") {
        this.extensionAPI.refreshTabsCount();
    }
}
```

STEP: 6 — OData V4: visible property modes and binding expressions

DESCRIPTION: For OData V4 you can control tab visibility using:
- Boolean
- Path to singleton or entity
- Binding expression (see Expression Binding docs)

Example binding expression in manifest is shown in STEP 3. For binding expression syntax see:
- Expression Binding: ../04_Essentials/expression-binding-daf6852.md

LANGUAGE: None

CODE:
```text
Visible options for a view:
- true | false
- "/MySingleton/IsViewAvailable"   (path)
- "{= ${/MySingleton/IsViewAvailable} === true }"  (expression binding)
```

STEP: 7 — SAP Fiori Tools: add multiple views via Page Map / Page Editor (UI actions)

DESCRIPTION: Steps to add views using SAP Fiori Tools Page Map and Page Editor UI (useful for code generation workflows where configuration is created via tooling):

1. Launch the Page Map (e.g., right-click project folder → Show Page Map).
2. Open Page Editor for the List Report (click the pencil icon next to List Report).
3. Click the + (Add) icon next to Views.
4. Choose Add Table View.
5. Select an Entity (entity set).
6. Click Add.
7. Expand the new view node.
8. Click + next to Columns.
9. Choose Add Basic Columns.
10. Select desired columns.
11. Click Add.
12. Select the new view node.
13. Set View Label to rename the view.
14. Preview via Previewing an Application.

LANGUAGE: None

CODE:
```text
SAP Fiori Tools actions summary:
- Page Map -> Page Editor -> Views -> Add Table View -> Choose Entity -> Add -> Configure Columns -> Rename View -> Preview
```

STEP: 8 — Additional resources and related pages

DESCRIPTION: Reference related documentation for detailed scenarios and extension points.

LANGUAGE: None

CODE:
```text
Related docs:
- Defining Multiple Views on a List Report Table - Single Table Mode
  (defining-multiple-views-on-a-list-report-table-single-table-mode-0d390fe.md)

- Defining Multiple Views on a List Report Table - Multiple Table Mode
  (defining-multiple-views-on-a-list-report-table-multiple-table-mode-37aeed7.md)

- Defining Multiple Views on a List Report with Different Entity Sets and Table Settings
  (defining-multiple-views-on-a-list-report-with-different-entity-sets-and-table-settings-b6b59e4.md)

- Extension Points for Views in the List Report
  (extension-points-for-views-in-the-list-report-eb37203.md)

- OData UI vocabulary
  https://github.com/SAP/odata-vocabularies/blob/main/vocabularies/UI.md
```
--------------------------------

**TITLE**: Outbound Navigation in SAP Fiori Elements — URL and Intent-Based Navigation (V2 & V4)

**INTRODUCTION**: Practical, code-focused reference for implementing outbound navigation in SAP Fiori Elements. Covers DataFieldWithUrl (absolute and path-based), intent-based navigation (semantic objects, semantic links, local links, buttons), mapping, hiding, security exclusions, multi-entity set target resolution, and the SelectionVariant/xAppState parameter format. Use these snippets directly in XML annotations, ABAP CDS, CAP CDS, extension controllers, and manifest.json.

**TAGS**: fiori-elements, navigation, semantic-object, DataFieldWithUrl, DataFieldWithIntentBasedNavigation, DataFieldForIntentBasedNavigation, SelectionVariant, manifest.json, CAP, ABAP, XML, JavaScript

STEP: DataFieldWithUrl — Path-based (property) reference
DESCRIPTION: Render a link whose URL comes from an entity property. Use UI.DataFieldWithUrl and set Value and Url to the property Path.
LANGUAGE: XML
CODE:
```xml
<!-- XML Annotation: DataFieldWithUrl — URL comes from entity property 'URL' -->
<Record Type="UI.DataFieldWithUrl">
    <PropertyValue Property="Label" String="Column label" />
    <PropertyValue Property="Value" Path="URL"/>
    <PropertyValue Property="Url" Path="URL"/>
</Record>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [{ type: #WITH_URL, url: 'URL' }]
URL;
```

LANGUAGE: CAP CDS
CODE:
```json
{
    "$Type": "UI.DataFieldWithUrl",
    "Value": "URL",
    "Url": "URL",
    "Label": "Column label"
}
```

STEP: DataFieldWithUrl — Absolute URL and LinkTarget
DESCRIPTION: Render a static external link (absolute URL) and control opening behavior using HTML5.LinkTarget: _self, _blank, _parent, _top.
LANGUAGE: XML
CODE:
```xml
<!-- Absolute URL -->
<Record Type="UI.DataFieldWithUrl">
    <PropertyValue Property="Label" String="Company"/>
    <PropertyValue Property="Value" String="SAP"/>
    <PropertyValue Property="Url" String="https://www.sap.com"/>
</Record>

<!-- With HTML5.LinkTarget; include the HTML5 vocabulary reference at top of annotations file -->
<edmx:Reference Uri="https://sap.github.io/odata-vocabularies/vocabularies/HTML5.xml">
  <edmx:Include Namespace="com.sap.vocabularies.HTML5.v1" Alias="SAP__HTML5"/>
</edmx:Reference>

<Record Type="UI.DataFieldWithUrl">
  <PropertyValue Property="Label" String="FLP version 6"/>
  <PropertyValue Property="Url" String="http://www.example.com"/>
  <PropertyValue Property="Value" String="Link Target"/>
  <Annotation Term="SAP__HTML5.LinkTarget" String="_blank"/>
</Record>
```

LANGUAGE: ABAP CDS
CODE:
```abap
{
    label: 'Company',
    type: #WITH_URL,
    url: 'https://www.sap.com'
}
```

LANGUAGE: CAP CDS
CODE:
```json
{
  "$Type": "UI.DataFieldWithUrl",
  "Label": "FLP version 6",
  "Url": "http://www.example.com",
  "Value": "Link Target",
  "![HTML5.LinkTarget]": "_blank"
}
```

STEP: SemanticObject — Global semantic link (annotate property)
DESCRIPTION: Globally mark a property as a semantic object so wherever it's used as a DataField it becomes a semantic link (popover when multiple targets).
LANGUAGE: XML
CODE:
```xml
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item/CostCenter">
    <Annotation Term="com.sap.vocabularies.Common.v1.SemanticObject" String="CostCenter"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view ITEM with {
    @Consumption.semanticObject: 'CostCenter'
    costcenter;
}
```

LANGUAGE: CAP CDS
CODE:
```json
annotate ZFAR_CUSTOMER_LINE_ITEMS2_SRV.Item with {
    "@Common.SemanticObject": "CostCenter"
};
```

STEP: SemanticObject — Dynamic semantic object via Path
DESCRIPTION: Use a Path that resolves to a semantic object name at runtime (dynamic semantic link).
LANGUAGE: XML
CODE:
```xml
<Annotations Target="myService.SalesorderManage/SoldToParty">
   <Annotation Term="Common.SemanticObject" Path="solToPartySemanticObject"/>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```json
SoldToParty: String(10) @(
  Common.SemanticObject: solToPartySemanticObject
);
```

STEP: DataFieldWithIntentBasedNavigation — Local semantic link (table/form)
DESCRIPTION: Add a link only in a specific annotation (LineItem or FieldGroup). Must specify both SemanticObject and Action for direct navigation. Value property determines link text.
LANGUAGE: XML
CODE:
```xml
<Record Type="UI.DataFieldWithIntentBasedNavigation">
    <PropertyValue Property="Label" String="My Link for navigation" />
    <PropertyValue Property="Value" Path="SomePath" />
    <PropertyValue Property="SemanticObject" String="MySemanticObject"/>
    <PropertyValue Property="Action" String="manage"/>
</Record>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [
  {
    label: 'My Link for navigation',
    value: 'SOMEPATH',
    semanticObjectAction: 'manage',
    type: #WITH_INTENT_BASED_NAVIGATION
  }
]
@Consumption.semanticObject: 'MySemanticObject'
```

LANGUAGE: CAP CDS
CODE:
```json
{
    "$Type": "UI.DataFieldWithIntentBasedNavigation",
    "Label": "My Link for navigation",
    "Value": "SomePath",
    "SemanticObject": "MySemanticObject",
    "Action": "manage"
}
```

STEP: DataFieldForIntentBasedNavigation — Button-based navigation + RequiresContext
DESCRIPTION: Create a button that triggers outbound intent-based navigation. Use RequiresContext (Bool) to control enabled state until selection. Use NavigationAvailable to dynamically enable based on a path/property.
LANGUAGE: XML
CODE:
```xml
<!-- Basic button -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
    <PropertyValue Property="Label" String="My Button for navigation"/>
    <PropertyValue Property="SemanticObject" String="MySemanticObject"/>
    <PropertyValue Property="Action" String="manage"/>
</Record>

<!-- RequiresContext true (button disabled until selection) -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
    <PropertyValue Property="Label" String="IBNWithContext"/>
    <PropertyValue Property="SemanticObject" String="EPMProduct"/>
    <PropertyValue Property="Action" String="manage_st"/>
    <PropertyValue Property="RequiresContext" Bool="true"/>
</Record>

<!-- NavigationAvailable path-based -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
    <PropertyValue Property="SemanticObject" String="v4Freestyle"/>
    <PropertyValue Property="Action" String="Inbound"/>
    <PropertyValue Property="Label" String="IBN with context"/>
    <PropertyValue Property="RequiresContext" Bool="true"/>
    <PropertyValue Property="NavigationAvailable" Path="isDeletable"/>
</Record>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [
  {
    label: 'My Button for navigation',
    semanticObjectAction: 'manage',
    type: #FOR_INTENT_BASED_NAVIGATION
  }
]
@Consumption.semanticObject: 'MySemanticObject'

/* RequiresContext example */
{
  semanticObject: 'EPMProduct',
  semanticObjectAction: 'manage_st',
  label: 'IBNWithContext',
  requiresContext: true,
  type: #FOR_INTENT_BASED_NAVIGATION
}
```

LANGUAGE: CAP CDS
CODE:
```json
{
    "$Type": "UI.DataFieldForIntentBasedNavigation",
    "Label": "IBNwithcontext",
    "SemanticObject": "SalesOrder",
    "Action": "manageInline",
    "RequiresContext": true
},
{
    "$Type": "UI.DataFieldForIntentBasedNavigation",
    "SemanticObject": "v4Freestyle",
    "Action": "Inbound",
    "Label": "IBN",
    "NavigationAvailable": "isDeletable",
    "RequiresContext": false
}
```

STEP: Semantic Object Mapping (SemanticObjectMapping / Mapping)
DESCRIPTION: Map source property names to target semantic object parameter names. For link-based semantic mapping use Common.SemanticObjectMapping. For button mapping use DataFieldForIntentBasedNavigation.Mapping.
LANGUAGE: XML
CODE:
```xml
<!-- SemanticObjectMapping for semantic links -->
<Annotations Target="com.c_salesordermanage_sd.defaultParamsForSalesOrderCreate/SoldToParty">
     <Annotation Term="Common.SemanticObject" String="Customer"/>
     <Annotation Term="Common.SemanticObjectMapping">
          <Collection>
               <Record Type="Common.SemanticObjectMappingType">
                    <PropertyValue Property="LocalProperty" PropertyPath="SoldToPartyID"/>
                    <PropertyValue Property="SemanticObjectProperty" String="CustomerID"/>
               </Record>
          </Collection>
     </Annotation>
</Annotations>

<!-- Mapping in DataFieldForIntentBasedNavigation (button) -->
<Record Type="UI.DataFieldForIntentBasedNavigation">
    <PropertyValue Property="Label" String="ButtonWithMapping"/>
    <PropertyValue Property="SemanticObject" String="MySO"/>
    <PropertyValue Property="Action" String="do"/>
    <PropertyValue Property="Mapping">
        <Collection>
            <Record>
                <PropertyValue Property="LocalProperty" PropertyPath="SoldToParty"/>
                <PropertyValue Property="SemanticObjectProperty" String="ABC"/>
            </Record>
        </Collection>
    </PropertyValue>
</Record>
```

LANGUAGE: CAP CDS
CODE:
```json
/* SemanticObject mapping for DataFieldForIntentBasedNavigation */
{
    "$Type": "UI.DataFieldForIntentBasedNavigation",
    "Mapping": [
        {
            "LocalProperty": "SoldToParty",
            "SemanticObjectProperty": "ABC"
        }
    ],
    "SemanticObject": "MySO",
    "Action": "do",
    "Label": "ButtonWithMapping"
}
```

STEP: Hide unwanted semantic actions (SemanticObjectUnavailableActions)
DESCRIPTION: Prevent certain actions from appearing in the semantic link popover using Common.SemanticObjectUnavailableActions (optionally with a qualifier).
LANGUAGE: XML
CODE:
```xml
<Annotations Target="MyService.SalesOrderManage/SoldToParty">
    <Annotation Term="Common.SemanticObject" Qualifier="SalesOrder" String="SalesOrder"/>
    <Annotation Term="Common.SemanticObjectMapping" Qualifier="SalesOrder">
        <Collection>
            <Record Type="Common.SemanticObjectMappingType">
                <PropertyValue Property="LocalProperty" PropertyPath="SoldToParty"/>
                <PropertyValue Property="SemanticObjectProperty" String="SoldToParty"/>
            </Record>
        </Collection>
    </Annotation>

    <!-- Hide specific actions from the popover -->
    <Annotation Term="Common.SemanticObjectUnavailableActions" Qualifier="SalesOrder">
        <Collection>
            <String>manageVM</String>
        </Collection>
    </Annotation>

    <Annotation Term="Common.SemanticObjectUnavailableActions">
        <Collection>
            <String>manage</String>
        </Collection>
    </Annotation>
</Annotations>
```

LANGUAGE: CAP CDS
CODE:
```json
annotate myService.SalesorderManage {
    @Common.SemanticObject: 'SalesOrder'
    @Common.SemanticObjectUnavailableActions: ['manage']
    @Common.SemanticObjectUnavailableActions#SalesOrder: ['analyze']
    OrderID
};
```

STEP: Exclude sensitive properties from navigation context
DESCRIPTION: Mark properties as sensitive or exclude them from navigation context completely using PersonalData.IsPotentiallySensitive or UI.ExcludeFromNavigationContext. Path-based FieldControl that resolves to Inapplicable is also excluded (V4).
LANGUAGE: XML
CODE:
```xml
<!-- Sensitive property -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/ID">
    <Annotation Term="com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"/>
</Annotations>

<!-- Exclude from navigation context -->
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/ID">
    <Annotation Term="UI.ExcludeFromNavigationContext" Bool="true"/>
</Annotations>

<!-- FieldControl example (V4) -->
<Annotations Target="SAP__self.ReviewsType/AvailabilityCode">
    <Annotation Term="SAP__Common.FieldControl" Path="__FieldControl/AvailabilityCode_FC"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view SALESORDERMANAGE with {
  @Semantics.personalData.isPotentiallySensitive: true
  ID;
}
```

LANGUAGE: CAP CDS
CODE:
```json
annotate com.c_salesordermanage_sd.SalesOrderManage {
    @PersonalData.IsPotentiallySensitive
    ID
};

annotate com.c_salesordermanage_sd.SalesOrderManage {
    @UI.ExcludeFromNavigationContext: true
    ID
};
```

STEP: Multi-Entity-Set Target Resolution — Pass extra parameter in extension controller (V2)
DESCRIPTION: For target apps with multiple entity-set object pages (tabs), add a key/value to the SelectionVariant in the source extension controller and mark the parameter in the target app manifest for target resolution (useForTargetResolution).
LANGUAGE: JavaScript
CODE:
```javascript
// ListReportExtension.controller.js (V2 / adaptNavigationParameterExtension)
adaptNavigationParameterExtension: function(oSelectionVariant, oObjectInfo) {
    if (oObjectInfo.semanticObject === "EPMSalesOrder" && oObjectInfo.action === "manage_sttasomv") {
        oSelectionVariant.addParameter("<Key>", "<Value1>");
    }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// ObjectPageExtension.controller.js (V2)
adaptNavigationParameterExtension: function(oSelectionVariant, oObjectInfo) {
    if (oObjectInfo.semanticObject === "EPMSalesOrder" && oObjectInfo.action === "manage_sttasomv") {
        oSelectionVariant.addParameter("<Key>", "<Value2>");
    }
}
```

LANGUAGE: JSON
CODE:
```json
// manifest.json (target app, V2)
"sap.ui.generic.app": {
    "settings": {
        "inboundParameters": {
            "<Key>": {
                "useForTargetResolution": true
            }
        }
    }
}
```

STEP: Multi-Entity-Set Target Resolution — Pass extra parameter in extension controller (V4 / sap.fe)
DESCRIPTION: V4 uses adaptNavigationContext and the sap.fe manifest setting inboundParameterForTargetResolution (sap.fe.app.inboundParameterForTargetResolution) or routing targetResolutionValue in sap.ui5 routing targets.
LANGUAGE: JavaScript
CODE:
```javascript
// ListReportExtension.controller.js (V4 / adaptNavigationContext)
adaptNavigationContext: function (selectionVariant, targetInfo) {
    if (targetInfo.semanticObject === "SalesOrder" && targetInfo.action === "manage") {
        selectionVariant.addParameter("<Key>", "<Value1>");
    }
}
```

LANGUAGE: JavaScript
CODE:
```javascript
// ObjectPageExtension.controller.js (V4)
adaptNavigationContext: function (selectionVariant, targetInfo) {
    if (targetInfo.semanticObject === "SalesOrder" && targetInfo.action === "manage") {
        selectionVariant.addParameter("<Key>", "<Value2>");
    }
}
```

LANGUAGE: JSON
CODE:
```json
// manifest.json (V4) - sap.fe app-level inbound param for target resolution
"sap.fe": {
    "app": {
        "inboundParameterForTargetResolution": "<Key>"
    }
}
```

LANGUAGE: JSON
CODE:
```json
// manifest.json (example for routing targets using the passed parameter)
"sap.ui5": {
    "routing": {
        "targets": {
            "ObjectPage|<EntitySet1>": {
                "type": "Component",
                "name": "sap.fe.templates.ObjectPage",
                "options": {
                    "settings": {
                        "targetResolutionValue": "<Value1>",
                        "entitySet": "<EntitySet1>"
                    }
                }
            },
            "ObjectPage|<EntitySet2>": {
                "type": "Component",
                "name": "sap.fe.templates.ObjectPage",
                "options": {
                    "settings": {
                        "targetResolutionValue": "<Value2>",
                        "entitySet": "<EntitySet2>"
                    }
                }
            }
        }
    }
}
```

STEP: SelectionVariant / xAppState — How parameters are passed to target
DESCRIPTION: Outbound parameter fields are always added twice in the SelectionVariant sent as part of xAppState:
- Under SelectOptions as "$Parameter.<ParamName>"
- Also under SelectOptions as "<ParamName>" (compatibility with V2)
Use selectionVariant.addParameter in extension controllers to add parameters.
LANGUAGE: JSON
CODE:
```json
// Example SelectionVariant inside xAppState (conceptual)
{
  "SelectionVariant": {
    "SelectOptions": {
      "$Parameter.P_CompanyCode": {
        "Ranges": [
          { "Sign": "I", "Option": "EQ", "Low": "1000" }
        ]
      },
      "P_CompanyCode": {
        "Ranges": [
          { "Sign": "I", "Option": "EQ", "Low": "1000" }
        ]
      }
    }
  }
}
```

STEP: Merged context, conflicts, and semantic link behavior (rules summary)
DESCRIPTION: Implementation rules for building outbound navigation context:
- If a property name appears only once across entity sets, pass property as PropertyName:value.
- If a property name appears in multiple entity sets (conflict), pass both the unprefixed property and prefixed variants (EntitySet.PropertyName).
- When a semantic link field is clicked, for its technical name only the semantic link field’s value is used (other values with same technical name are ignored).
- Navigation entity set properties are ignored when selecting page/table contexts unless they are the selected control context.
LANGUAGE: JSON
CODE:
```json
// Example: When conflict exists, both unprefixed and prefixed names are included
{
  "OrderID": "123",            // unprefixed
  "SO.Price": "400 EUR",       // prefixed from main entity
  "SO._Item.Price": "20 EUR",  // prefixed from navigation entity set
  "Price": "20 EUR"            // chosen specific value (table selection)
}
```


--------------------------------

**TITLE**: Configure Header Facet Title Navigation (In-Page and External) for SAP Fiori Elements (OData V4)

**INTRODUCTION**: This document shows exactly how to configure header facet title navigation in manifest.json for SAP Fiori elements (OData V4). It covers: in-page navigation (navigate to a section/subsection inside the same Object Page) and external navigation (navigate to another application via crossNavigation/outbounds). Use the provided manifest.json and crossNavigation fragments directly in your app manifest.

**TAGS**: fiori-elements-framework, ODataV4, manifest.json, navigation, header-facet, controlConfiguration, crossNavigation

**STEP**: 1 — Configure In-Page Navigation for Header Item Titles

**DESCRIPTION**: Add a controlConfiguration entry for the header item (data point, rating indicator, progress indicator or micro chart) in manifest.json. Provide target sectionId and/or subSectionId. If only sectionId is given, the first subsection is used. Incorrect IDs will show an error at runtime indicating the section cannot be found. File: manifest.json (app root).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.DataPoint#NetValue": {
            "navigation": {
              "targetSections": {
                "sectionId": "SalesOrder::SalesOrderManageObjectPage--fe::FacetSection::HeaderInfo",
                "subSectionId": "SalesOrder::SalesOrderManageObjectPage--fe::FacetSubSection::SalesOrderHeaderPartner"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Configure External Navigation from a Header Data Point (targetOutbound -> outbound)

**DESCRIPTION**: For external navigation from a header data point, set navigation.targetOutbound.outbound to the qualifier of the outbound defined in crossNavigation.outbounds. The outbound qualifier must match exactly. The page context is merged with the data point context when navigating. File: manifest.json (app root). Add the crossNavigation/outbounds fragment shown in the next code block.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.DataPoint#NetValue": {
            "navigation": {
              "targetOutbound": {
                "outbound": "ExternalNavigation"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Define Outbound Target in crossNavigation.outbounds

**DESCRIPTION**: Define the outbound descriptor that will be referenced by targetOutbound.outbound. Map semantic object, action, and parameters. Use binding format to pass values from the current navigation/context. File: manifest.json (app root), top-level crossNavigation section.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "crossNavigation": {
    "outbounds": {
      "ExternalNavigation": {
        "semanticObject": "SalesOrder",
        "action": "display",
        "parameters": {
          "SoldToParty": {
            "value": {
              "value": "CustomerName",
              "format": "binding"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Configure External Navigation from a Micro Chart (chart qualifier)

**DESCRIPTION**: For micro chart header items, use the chart qualifier key in controlConfiguration and set navigation.targetOutbound.outbound to the outbound qualifier. The page context is merged with the chart context (chart may produce multiple technical IDs for 1:n charts). File: manifest.json (app root).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "SalesOrderManageObjectPage": {
    "type": "Component",
    "id": "SalesOrderManageObjectPage",
    "name": "sap.fe.templates.ObjectPage",
    "options": {
      "settings": {
        "controlConfiguration": {
          "@com.sap.vocabularies.UI.v1.Chart#CreditLimitDetails": {
            "navigation": {
              "targetOutbound": {
                "outbound": "ExternalNavigation"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Supported Controls, Precedence and Behavior Notes

**DESCRIPTION**: Use these rules when configuring header facet title navigation.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "notes": {
    "supportedControls": [
      "data point",
      "rating indicator",
      "progress indicator",
      "micro chart"
    ],
    "inPageNavigation": {
      "provide": "sectionId and/or subSectionId in controlConfiguration.navigation.targetSections",
      "ifOnlySectionId": "first subsection is opened",
      "errorBehavior": "incorrect IDs -> runtime error message 'specified section could not be found'"
    },
    "externalNavigation": {
      "provide": "targetOutbound.outbound qualifier referencing crossNavigation.outbounds",
      "precedence": "external navigation wins if both external and in-page are configured",
      "singleTarget": "only a single target outbound is supported"
    },
    "microChartSpecifics": {
      "oneToMany": "1:n charts (stacked bars) produce multiple technical IDs; all are passed using OR operator",
      "renderingFallback": "if external app misconfigured or authorization missing -> title renders as plain text not link"
    }
  }
}
```
--------------------------------

**TITLE**: Inbound Navigation for SAP Fiori Elements — Deep Linking, Incoming Filters, and FLP Defaults

**INTRODUCTION**: Action-oriented guide for implementing and configuring inbound navigation into SAP Fiori elements apps. Covers: how incoming filters are applied, FLP default value behavior (including DisplayCurrency), deep linking rules for object and subobject pages (OData V2 and V4), manifest settings (allowDeepLinking, routing, FCL fullscreen), xapp-state sort handling, and matching rules for navigation entity set properties.

**TAGS**: fiori-elements-framework, inbound-navigation, deep-linking, manifest.json, allowDeepLinking, ODataV2, ODataV4, semantic-key, technical-key, FLP, DisplayCurrency, xapp-state, flexible-column-layout, filters

STEP: 1 — Apply incoming filter values to filter bar
DESCRIPTION: On inbound navigation to a Fiori elements app (list report / analytical list page, excluding overview page) apply incoming context values to matching filter fields. If a field is not visible in the filter bar, bring it into the visible area. Support both plain property names and property names prefixed with "P_" (accept match by adding/removing "P_").
LANGUAGE: Description
CODE:
```text
Behavior:
- Incoming value for a field present in the target entity set => apply to that filter field.
- If the filter field is not visible, make it visible in the filter bar.
- Matching supports property names that differ only by the "P_" parameter prefix (incoming P_Field OR Field).
```

STEP: 2 — FLP default values and special DisplayCurrency rules
DESCRIPTION: FLP target mapping may pass default parameter values. Behavior differs by navigation entry point. Documented rules:
- Intent-based navigation with context: only values added by FLP target mapping mechanism are considered (no extra FLP user defaults).
- Static FLP tile (no navigation context): if no user default variant exists, use FLP target mapping default values.
- Dynamic tile (context passed, e.g., SAP Smart Business): special handling for DisplayCurrency:
  - If a mandatory filter or parameter named DisplayCurrency (technical name DisplayCurrency or P_DisplayCurrency) receives no value from the incoming context, set it from the FLP user default DisplayCurrency.
  - For all other fields, ignore FLP user defaults except standard target mapping parameters.
NOTE: User default values from FLP mark the standard variant as dirty.
LANGUAGE: Description
CODE:
```text
FLP cases:
1) Intent-based with context: use FLP target mapping parameters only.
2) Static tile without context: if user default variant missing -> use FLP target mapping defaults.
3) Dynamic tile with context: use incoming context; if DisplayCurrency missing -> set from FLP user default DisplayCurrency; ignore other FLP user defaults (except standard target mapping).
```

STEP: 3 — Deep linking overview and rule for landing page
DESCRIPTION: Deep linking behavior:
- If URL provides all key fields that uniquely identify an object page (technical or semantic keys as per backend/annotations), open the object (or draft/object depending on keys/draft availability).
- Otherwise open list report or analytical list page.
- Deep linking requires SAP Fiori launchpad (intent-based). For standalone apps adjust links in annotations or manifest routing accordingly.
LANGUAGE: Description
CODE:
```text
If URL contains all keys for an entity instance -> open object page (draft or active depending on IsActiveEntity or semantic/draft rules).
Else -> open list report or analytical list page.
Restriction: Deep linking is not supported when the app is configured with parameters or mandatory filters.
```

STEP: 4 — Deep linking to object pages (OData V2: technical keys)
DESCRIPTION: Provide all technical keys defined in service metadata to deep link to V2 object pages. Include IsActiveEntity handling (load active or draft accordingly). Example entity type metadata shows key definition and example URL passing keys.
LANGUAGE: XML
CODE:
```xml
<!-- metadata snippet showing technical keys -->
<EntityType Name="SalesOrderManage">
   <Key>
      <PropertyRef Name="ID"/>
      <PropertyRef Name="IsActiveEntity"/>
   </Key>
</EntityType>

<!-- Example deep link URL query (technical keys) -->
...?ID=11111111-aaaa-bbbb-cccc-ddddeeeeffff&IsActiveEntity=true
```

STEP: 5 — Deep linking to subobject pages (V2 and general allowDeepLinking manifest configuration)
DESCRIPTION: To deep link to n-th level subobject pages you must set allowDeepLinking: true for every subobject level from root -> n. If allowDeepLinking is false at level k < n, the deepest level with allowDeepLinking=true is loaded. allowDeepLinking is not applicable for object pages (object pages always deep link if keys present).
LANGUAGE: JSON
CODE:
```json
// manifest.json (V2 page entry example)
"pages": {
  "navigationProperty": "to_ProductText",
  "entitySet": "STTA_C_MP_ProductText",
  "component": {
    "name": "sap.suite.ui.generic.template.ObjectPage",
    "settings": {
      "allowDeepLinking": true
    }
  }
}

// nested example: allowDeepLinking true for all levels to reach level 3
{
  "ObjectPage1": {
    "allowDeepLinking": true,
    "SubObjectPage1": {
      "allowDeepLinking": true,
      "SubObjectPage2": {
        "allowDeepLinking": true,
        "SubObjectPage3": {
          "allowDeepLinking": true
        }
      }
    }
  }
}
```

STEP: 6 — Routing and mapping for OData V4 deep linking using semantic keys
DESCRIPTION: For OData V4, deep linking can use semantic keys (annotation Common.SemanticKey) instead of technical keys. Ensure the manifest routing pattern includes a placeholder for the key and the target references the correct contextPath and level. Semantic keys take priority if both semantic and technical keys are present.
LANGUAGE: XML / ABAP CDS / CAP CDS / JSON
CODE:
```xml
<!-- XML Annotation for semantic key -->
<Annotation Term="Common.SemanticKey">
   <Collection>
      <PropertyPath>SalesOrder</PropertyPath>
   </Collection>
</Annotation>
```

```abap
" ABAP CDS annotation snippet
@ObjectModel: {
  semanticKey: [ 'SalesOrder' ]
}
define view SALESORDERMANAGE {
  // ...
}
```

```cql
// CAP CDS (annotation snippet)
Common.SemanticKey : [
    SalesOrder
]
```

```json
// manifest routing for OData V4 (sap.fe.templates.ObjectPage)
{
  "routing": {
    "routes": [
      {
        "pattern": "/yourEntity({key}):?query:",
        "name": "default",
        "target": "sample"
      }
    ],
    "targets": {
      "sample": {
        "type": "Component",
        "id": "Default",
        "name": "sap.fe.templates.ObjectPage",
        "level": 1,
        "options": {
          "settings": {
            "contextPath": "/yourEntity"
          }
        }
      }
    }
  }
}
```

STEP: 7 — Deep linking to subobject pages (OData V4 manifest example)
DESCRIPTION: Enable allowDeepLinking in manifest target options for the subobject page. Provide semantic or technical keys for the object and the subobject entity sets up to desired level in the URL.
LANGUAGE: JSON
CODE:
```json
// manifest.json target definition for subobject (V4)
"SalesOrderManageObjectPage": {
  "type": "Component",
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "options": {
    "settings": {
      "contextPath": "/SalesOrderManage",
      "allowDeepLinking": true
    }
  }
}
```

STEP: 8 — Matching incoming navigation entity set property names
DESCRIPTION: Incoming filter names for navigation entity sets must match either:
1) The fully qualified property name in the target (e.g., "SO._PO.Status"), OR
2) Match when the leading incoming entity set name is discarded (e.g., incoming "SO._PO.Status" matches a target property named "_PO.Status" or "Status" under a matching navigation property path).
Also support prefix "P_" add/remove logic when matching parameter names.
LANGUAGE: Description
CODE:
```text
Example:
Incoming context: "SO._PO.Status"

Matching order:
1) Target main entity set "SO" has navigation property "_PO" with filter field "Status".
2) Target has first-level navigation entity set "SO" -> "_PO" -> "Status" also matches.
3) Matching also considers adding/removing "P_" prefix: incoming "P_Status" matches target "Status" or "P_Status".
```

STEP: 9 — xapp-state sort order handling on inbound navigation
DESCRIPTION: If the xapp-state in the inbound navigation carries sorters, these sorters are read and applied to the target list report or analytical list page table. Incoming sorters have priority and are merged with existing sorters in this order of precedence:
1) Navigation sorters (highest priority)
2) Default user-defined control variant sorter (if default variant exists)
3) PresentationVariant annotation sorters (if no default variant)
4) If no variants or annotations, only navigation sorters are used
LANGUAGE: Description
CODE:
```text
Sorter merge scenarios:
- If default user variant with sorter exists:
    Apply navigation sorter(s) first, then user variant sorter(s).
- If no default user variant but PresentationVariant exists:
    Apply navigation sorter(s) first, then PresentationVariant sorter(s).
- If neither exist:
    Apply only navigation sorter(s).
```

STEP: 10 — Enable fullscreen on inbound navigation for Flexible Column Layout (FCL)
DESCRIPTION: Configure defaultLayoutTypeIfExternalNavigation to open object/subobject in fullscreen when external inbound navigation points to a unique object (improves performance). For main objects use MidColumnFullScreen; for sub-objects use EndColumnFullScreen.
LANGUAGE: JSON
CODE:
```json
// manifest.json sample (FCL)
"pages": {
  "ObjectPage|C_STTA_BusinessPartner": {
    "entitySet": "C_STTA_BusinessPartner",
    "defaultLayoutType": "TwoColumnsMidExpanded",
    "defaultLayoutTypeIfExternalNavigation": "MidColumnFullScreen",
    "component": {
      "name": "sap.suite.ui.generic.template.ObjectPage",
      "settings": {
        "allowDeepLinking": true
      }
    }
  }
}
```
NOTE:
- For external navigation with FCL enabled, defaultLayoutTypeIfExternalNavigation is used.
- For apps launched from SAP Fiori launchpad with FCL enabled, defaultLayout is considered.

STEP: 11 — Restrictions and important notes (concise checklist)
DESCRIPTION: Quick rules summary for implementation and testing.
LANGUAGE: Description
CODE:
```text
Checklist:
- Deep linking requires SAP Fiori launchpad (intent-based); standalone apps need manifest routing adjustments.
- Deep linking not supported when app configured with parameters or mandatory filters.
- allowDeepLinking must be true for every subobject level to deep link directly to that level.
- For V4, ensure manifest route pattern includes key placeholder and target contextPath.
- DisplayCurrency is treated specially for dynamic tiles; set from FLP user default if missing.
- FLP user defaults mark the standard variant as dirty.
```
--------------------------------

**TITLE**: Configure navigation to open an Object Page in edit mode (SAP Fiori Elements — OData V2 & V4)

**INTRODUCTION**: Instructions and ready-to-use manifest.json snippets to make an Object Page open directly in edit mode. Includes V2 configuration using editFlow and navToListOnSave, and V4 configuration using openInEditMode. Copy these snippets into your webapp/manifest.json under the indicated keys and adapt the entitySet names.

**TAGS**: fiori-elements, manifest.json, editMode, OData V2, OData V4, editFlow, navToListOnSave, openInEditMode, ObjectPage, ListReport

**STEP**: 1 — Configure List Report to open Object Page directly in edit mode (OData V2)

**DESCRIPTION**: Set editFlow to "direct" for the List Report page in manifest.json. This causes navigation from the list to the object page to open the object page directly in edit mode and adds a "Save and Next" footer action on the Object Page.

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (place under "sap.ui.generic.app" -> "pages")
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "editFlow": "direct"
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Prevent navigation back to the list on Save (OData V2, optional)

**DESCRIPTION**: By default, when editFlow is "direct", the Save action navigates back to the List Report. To keep the user on the Object Page after Save (but switch the page back to display mode), set navToListOnSave to false in the Object Page settings.

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (extend "sap.ui.generic.app" -> "pages")
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "navToListOnSave": false
          }
        }
      }
    }
  }
}
```

Behavior summary for V2:
- editFlow: "direct" → Object Page opens in edit mode; adds "Save", "Cancel", and "Save and Next".
- "Save" default behavior: navigate back to List Report (unless navToListOnSave is false).
- navToListOnSave: false → prevents navigation to list on Save; Object Page switches to display mode after saving.
- "Save and Next" → saves current changes and opens the next object in edit mode.

**STEP**: 3 — Configure Object Page to open in edit mode (OData V4)

**DESCRIPTION**: For Fiori Elements V4, set openInEditMode: true in the page/component options/settings inside manifest.json. Place this under the corresponding page/component settings for your Object Page or table row navigation. When set, the page opens directly in edit mode.

**LANGUAGE**: JSON

**CODE**:
```json
// webapp/manifest.json (example location under the page/component options)
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|LineItems": {
        "entitySet": "LineItems",
        "component": {
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "entitySet": "LineItems",
              "openInEditMode": true
            }
          }
        }
      }
    }
  }
}
```

Note for V4:
- When openInEditMode is true, the table's context menu will not show the "Open in New Tab" option.
--------------------------------

**TITLE**: Configure chevron navigation from List Report to Object Page and Subobject Page (manifest.json)

**INTRODUCTION**: Use the app manifest.json to enable chevron (row) navigation from a Fiori elements List Report to an Object Page and from an Object Page to a Subobject Page. This configuration maps target component routes and defines the navigation targets used by SAP Fiori Elements (OData V4). Apply these changes in the app manifest.json in the application root.

**TAGS**: fiori-elements-framework, sap.fe, manifest.json, navigation, object-page, list-report, subobject-page, odata-v4

**STEP**: 1 — Add List Report target and map its navigation to the Object Page

**DESCRIPTION**: In manifest.json, define a target for the List Report component and add a navigation mapping that points the list's detail navigation to the Object Page route. This enables table chevron navigation from the list entries to the Object Page.

**LANGUAGE**: JSON

**CODE**:
```json
// File: manifest.json (fragment)
{
  "targets": {
    "SalesOrderManageList": {
      "type": "Component",
      "id": "SalesOrderManageList",
      "name": "sap.fe.templates.ListReport",
      "options": {
        "settings": {
          "contextPath": "/SalesOrderManage",
          "variantManagement": "Page"
          // other List Report settings...
        },
        "navigation": {
          "SalesOrderManage": {
            "detail": {
              "route": "SalesOrderManageObjectPage"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Add Object Page target and map its navigation to the Subobject Page

**DESCRIPTION**: In manifest.json, define a target for the Object Page component. Inside its settings, add a navigation mapping for the child collection/property (for example _Item) so that the Object Page can navigate to a Subobject Page using the specified route.

**LANGUAGE**: JSON

**CODE**:
```json
// File: manifest.json (fragment)
{
  "targets": {
    "SalesOrderManageObjectPage": {
      "type": "Component",
      "id": "SalesOrderManageObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "options": {
        "settings": {
          "contextPath": "/SalesOrderManage",
          "navigation": {
            "_Item": {
              "detail": {
                "route": "SalesOrderItemObjectPage" // Subobject page navigation route
              }
            }
          },
          "variantManagement": "Control"
          // other Object Page settings...
        }
      }
    }
  }
}
```

**STEP**: 3 — Full combined example (List Report → Object Page → Subobject Page)

**DESCRIPTION**: Complete manifest.json targets fragment combining List Report and Object Page targets with navigation mapping. Place under the top-level "sap.app"/"sap.ui5" structure as required by your application manifest.

**LANGUAGE**: JSON

**CODE**:
```json
// File: manifest.json (fragment)
{
  "targets": {
    "SalesOrderManageList": {
      "type": "Component",
      "id": "SalesOrderManageList",
      "name": "sap.fe.templates.ListReport",
      "options": {
        "settings": {
          "contextPath": "/SalesOrderManage",
          "variantManagement": "Page",
          ...
          ...
        },
        "navigation": {
          "SalesOrderManage": {
            "detail": {
              "route": "SalesOrderManageObjectPage"
            }
          }
        }
      }
    },
    "SalesOrderManageObjectPage": {
      "type": "Component",
      "id": "SalesOrderManageObjectPage",
      "name": "sap.fe.templates.ObjectPage",
      "options": {
        "settings": {
          "contextPath": "/SalesOrderManage",
          "navigation": {
            "_Item": {
              "detail": {
                "route": "SalesOrderItemObjectPage" // For sub object page navigation
              }
            }
          },
          "variantManagement": "Control",
          ...
          ...
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Non-Draft Apps — Implementation Patterns and Code Examples for SAP Fiori elements (OData V2)

**INTRODUCTION**: Practical, code-focused guidance for implementing non-draft SAP Fiori elements apps (OData V2). Covers when to use non-draft, UX expectations, required behaviors (Save, data-loss handling, navigation), secured-execution checks for extension points, and code patterns (UI5 JavaScript) to detect/save pending changes, show data-loss dialogs, and wrap operations with busy/dataloss checks.

**TAGS**: fiori-elements-framework, non-draft, OData V2, UI5, data-loss, save, secured-execution, navigation, busy-indicator

**STEP**: 1 — When to choose non-draft apps (summary & rules)

**DESCRIPTION**: Decide whether your app can be non-draft. Use non-draft only for simple scenarios without complex multi-entity creation/edit flows. Preserve these constraints in code and design decisions.

- Applicable only to SAP Fiori elements OData V2.
- Do not mix draft and non-draft entity sets in the same application.
  - Exception: a draft-enabled entity set may contain a non-draft child for display-only (no actions/navigation from the non-draft child).
- Non-draft apps: no automatic locking, no autosave, no server-side draft handling.
- Value+text fields (currency+amount, unit+value): changed values display correctly after save only if you define a dedicated side effect.

**LANGUAGE**: Plaintext

**CODE**:
```Plaintext
Decision checklist:
- Is the scenario simple (single object edits, occasional field changes)? => Non-draft OK
- Does the scenario require multi-entity creation before a single save? => Use draft-enabled app
- Will you mix draft and non-draft entity sets? => Avoid; only allow non-draft child for display-only under a draft parent
```

**STEP**: 2 — Basic Save handler (UI5 OData V2 model)

**DESCRIPTION**: Implement a Save button handler that calls the OData V2 model submitChanges() and shows success/error feedback. Always expose a Save button on edit pages and subobject pages.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// Controller: Save button handler for OData V2 UI5 app
onSavePressed: function () {
  const oModel = this.getView().getModel(); // OData V2 model
  if (!oModel.hasPendingChanges()) {
    sap.m.MessageToast.show("No changes to save");
    return;
  }

  oModel.submitChanges({
    success: () => {
      sap.m.MessageToast.show("Save successful");
      // optionally refresh bindings or call side effects here
    },
    error: (oError) => {
      sap.m.MessageToast.show("Save failed");
      // handle error details: oError, maybe show MessageBox
    }
  });
}
```

**STEP**: 3 — Detect unsaved changes and show data-loss confirmation before navigation

**DESCRIPTION**: Use the model's hasPendingChanges() to detect unsaved edits and present a data-loss dialog before navigation. Offer Save / Discard / Cancel actions and handle them accordingly.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// Example: navigation guard function used before leaving the page
const oModel = this.getView().getModel();

function confirmDataLossAndNavigate(fnNavigate) {
  if (!oModel.hasPendingChanges()) {
    fnNavigate();
    return;
  }

  sap.m.MessageBox.confirm(
    "You have unsaved changes. Save before leaving?",
    {
      title: "Unsaved Changes",
      actions: ["Save", "Discard", "Cancel"],
      emphasizedAction: "Save",
      onClose: (sAction) => {
        if (sAction === "Save") {
          oModel.submitChanges({
            success: fnNavigate,
            error: () => { /* keep on current page, show error */ }
          });
        } else if (sAction === "Discard") {
          oModel.resetChanges(); // discard local changes (V2)
          fnNavigate();
        } else {
          // Cancel => do nothing (stay on page)
        }
      }
    }
  );
}

// Usage example: call confirmDataLossAndNavigate(() => { /* perform actual navigation */ });
```

**STEP**: 4 — Browser-level navigation & sign-out limitations

**DESCRIPTION**: Browser navigation (back/forward, refresh, URL change, bookmark, close) and SAP Fiori launchpad sign-out can cause data loss without a visible app data-loss message. Use beforeunload for browser actions to warn users where possible; note FLP sign-out may not allow a prompt.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// Add a beforeunload handler to warn on browser-level navigation if there are pending changes
window.addEventListener("beforeunload", (e) => {
  const oModel = sap.ui.getCore().byId("appComponent").getModel(); // adapt to your retrieval
  if (oModel && oModel.hasPendingChanges && oModel.hasPendingChanges()) {
    // Standard way to trigger a native confirm dialog in most browsers
    e.preventDefault();
    e.returnValue = ""; // required for Chrome to show the prompt
    // Note: text in returnValue is ignored by most browsers for security reasons
  }
});
```

**STEP**: 5 — Secured execution wrapper for extension points (busy / dataloss checks)

**DESCRIPTION**: Implement a reusable securedExecuter utility for extension-point functions and custom actions. It handles:
- busy.set=true => show busy indicator while the function runs
- busy.check=true => skip execution if the app is already busy
- dataloss.popup=true => show data-loss confirmation if pending changes exist
- dataloss.navigation=false => indicate that function execution will navigate away (affects dialog text)

This example shows an async wrapper pattern and how to use it from an extension hook or controller action.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// securedExecution utility
async function securedExecution({ busySet = true, busyCheck = true, datalossPopup = true, datalossNavigation = false } = {}, fn, oContext) {
  const oModel = (oContext && oContext.getView) ? oContext.getView().getModel() : sap.ui.getCore().getModel();
  const isAppBusy = () => {
    // implement your app-level busy detection; placeholder:
    return false; // return true if busy
  };

  if (busyCheck && isAppBusy()) {
    // skip or queue execution
    return;
  }

  const proceedWithFn = async () => {
    if (busySet) sap.ui.core.BusyIndicator.show(0);
    try {
      return await fn.call(oContext);
    } finally {
      if (busySet) sap.ui.core.BusyIndicator.hide();
    }
  };

  if (datalossPopup && oModel && oModel.hasPendingChanges && oModel.hasPendingChanges()) {
    const sMessage = datalossNavigation
      ? "You have unsaved changes. Leaving will discard them. Save now?"
      : "You have unsaved changes. Proceed?"
    ;
    return new Promise((resolve, reject) => {
      sap.m.MessageBox.confirm(sMessage, {
        actions: ["Save", "Discard", "Cancel"],
        onClose: (sAction) => {
          if (sAction === "Save") {
            oModel.submitChanges({
              success: () => {
                proceedWithFn().then(resolve).catch(reject);
              },
              error: (oError) => {
                reject(oError);
              }
            });
          } else if (sAction === "Discard") {
            oModel.resetChanges();
            proceedWithFn().then(resolve).catch(reject);
          } else {
            // Cancel => do not execute
            resolve(null);
          }
        }
      });
    });
  } else {
    return proceedWithFn();
  }
}

// Usage in a controller extension or action:
onCustomAction: function () {
  securedExecution(
    { busySet: true, busyCheck: true, datalossPopup: true, datalossNavigation: true },
    async function () {
      // actual action logic: e.g., navigate or perform side-effect call
      // await somePromiseCall();
      // If navigation, call router.navTo(...)
    },
    this
  ).catch((err) => {
    // handle execution error
  });
}
```

**STEP**: 6 — Extension points: input parameters and expected behavior mapping

**DESCRIPTION**: Map the method input parameters to behavior so extension authors can implement checks consistently.

- busy.set=true => show busy indicator during operation (use BusyIndicator.show/hide)
- busy.check=true => check app busy state and avoid execution if busy
- dataloss.popup=true => if model.hasPendingChanges() then display data-loss message before executing
- dataloss.navigation=false => indicates the function causes navigation (use different dialog copy when true)

**LANGUAGE**: Plaintext

**CODE**:
```Plaintext
Parameter -> Behavior:
- busy.set=true        : show busy indicator while function runs
- busy.check=true      : execute only if app is not busy (prevent overlapping operations)
- dataloss.popup=true  : show data-loss confirmation if there are pending changes
- dataloss.navigation=false: indicates the function will navigate (use navigation-specific dialog text)
```

**STEP**: 7 — Locking & concurrency behavior

**DESCRIPTION**: Non-draft apps do NOT lock objects when editing. Implement UI messaging and workflow safeguards in code to reduce accidental overwrites:

- Warn users about concurrent edits in UX guidelines (cannot prevent server race conditions).
- On save errors caused by backend conflicts, surface a clear error and optionally refresh data and let user re-edit.

**LANGUAGE**: Plaintext

**CODE**:
```Plaintext
Concurrency guidance:
- Expect "last save wins" behavior in backend for non-draft objects.
- On submitChanges error indicating conflict, call oModel.refresh(true) to reload server state and notify user.
```

**STEP**: 8 — Features not available in non-draft apps (quick checklist for implementation and testing)

**DESCRIPTION**: Use this checklist to ensure your app does NOT rely on draft features.

- No server-side draft-saving or restore workflows.
- No automatic asynchronous save/data-loss prevention.
- No in-app navigation without save.
- No device-switch continuation, action/field adjustments during entry, checks during entry, actions on entered data without saving, or editable-table sorting/filtering for data entry.

**LANGUAGE**: Plaintext

**CODE**:
```Plaintext
Non-supported draft features checklist:
- [ ] Autosave / heartbeat saves
- [ ] Continue later / incomplete saves
- [ ] Locking / pessimistic concurrency
- [ ] Cross-device continue
- [ ] Action-on-entered-data without save
- [ ] Context-dependent value helps during entry
- [ ] Editable-table advanced entry features (sorting/filtering for data entry)
```

**STEP**: 9 — Example: allowed mix scenario (draft parent with non-draft child for display-only)

**DESCRIPTION**: If a draft-enabled entity set contains a non-draft child attribute used exclusively for display, ensure no actions/navigation are implemented from that child. Document this in code and disable action handlers.

**LANGUAGE**: Plaintext

**CODE**:
```Plaintext
Example note to developers:
- Parent: SalesOrder (draft-enabled)
- Child: ContactInfo (non-draft, display-only)
Implementation rule:
- Do not implement buttons/links that call navigation or actions from ContactInfo detail UI.
- Make bindings read-only and disable navigation event handlers to enforce display-only usage.
```


--------------------------------

**TITLE**: Object Page Elements — implementation snippets for SAP Fiori elements

**INTRODUCTION**: This document provides concise, code-focused examples and configuration snippets to implement the main elements of an Object Page in SAP Fiori elements: application title and header, header image, header toolbar actions (generic and use-case specific), header facets (label-field pairs and graphical elements), content sections (field groups / tables), paginator behavior and footer actions (including draft Apply). It highlights OData V2 limitations (image in content area, paginator defaults).

**TAGS**: fiori-elements, object-page, annotations, manifest, headerinfo, facets, fieldgroup, actions, draft-handling, paginator

STEP: 1 — Register Object Page in manifest.json (webapp/manifest.json)

DESCRIPTION: Add an Object Page entry to the app manifest so the Fiori elements runtime knows to use the Object Page template for the entity set. Place pages configuration under sap.ui.generic.app (or the Fiori elements equivalent in your project). Adjust entitySet and component/template name to match your project.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "ProductSet",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        },
        "settings": {
          "navigationProperty": "To_SubItems" /* optional: for navigation to subitems */
        }
      }
    ]
  }
}
```

STEP: 2 — Add HeaderInfo annotation (annotations/annotations.xml)

DESCRIPTION: Use the UI.HeaderInfo annotation on the entity type to set the application title, the header title, description, and the header image. If the instance does not provide an image, the default image of the object type is used. OData V2: image in the content area is not supported (header image is supported via HeaderInfo). Replace Target and Path values with your service and property names.

LANGUAGE: XML

CODE:
```xml
<Annotations Target="MyService.ProductType">
  <Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo">
    <Record>
      <!-- Type name used for application title (e.g. "Product") -->
      <PropertyValue Property="TypeName" String="Product"/>
      <!-- Title displayed in header (bind to a property) -->
      <PropertyValue Property="Title" Path="Name"/>
      <!-- Short description under the title -->
      <PropertyValue Property="Description" Path="ShortDescription"/>
      <!-- Header image URL (bind to a property containing image URL) -->
      <PropertyValue Property="ImageUrl" Path="ImageUrl"/>
      <!-- Alt text for the image -->
      <PropertyValue Property="ImageAltText" Path="Name"/>
      <!-- Optional collection of header actions (use-case specific / display mode actions) -->
      <PropertyValue Property="Actions">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
            <PropertyValue Property="Label" String="Edit"/>
            <!-- Action name implemented in backend/annotation/manifest -->
            <PropertyValue Property="Action" String="MyService.EditProduct"/>
          </Record>
          <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
            <PropertyValue Property="Label" String="Delete"/>
            <PropertyValue Property="Action" String="MyService.DeleteProduct"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 3 — Define Header Facets (key label-field pairs and graphical elements)

DESCRIPTION: Use the UI.Facets annotation on the entity type to show header facets (key-value pairs / small graphical elements). Limit label-field pairs to a recommended maximum of five. Each ReferenceFacet targets a FieldGroup qualifier (see STEP 4). Use DataPoint annotations for graphical indicators if needed.

LANGUAGE: XML

CODE:
```xml
<Annotations Target="MyService.ProductType">
  <Annotation Term="com.sap.vocabularies.UI.v1.Facets">
    <Collection>
      <!-- A header facet that references a field group by qualifier -->
      <Record Type="com.sap.vocabularies.UI.v1.ReferenceFacet">
        <PropertyValue Property="Label" String="Key Facts"/>
        <PropertyValue Property="Target">
          <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
            <PropertyValue Property="TargetAnnotationPath" String="@UI.FieldGroup#KeyFacts"/>
          </Record>
        </PropertyValue>
      </Record>

      <!-- Example: small chart or rating indicator can be represented by a DataPoint or custom annotation -->
      <Record Type="com.sap.vocabularies.UI.v1.ReferenceFacet">
        <PropertyValue Property="Label" String="Credit Limit"/>
        <PropertyValue Property="Target">
          <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
            <PropertyValue Property="TargetAnnotationPath" String="@UI.DataPoint#CreditLimit"/>
          </Record>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: 4 — Define FieldGroup(s) for content sections (annotations/annotations.xml)

DESCRIPTION: Create UI.FieldGroup annotations with a Qualifier referenced from the header facets above. Each FieldGroup contains a collection of DataField entries (label + value bindings). Use this for content area sections on the Object Page. For tables inside sections, use UI.CollectionFacet + target annotation that points to a LineItem annotation.

LANGUAGE: XML

CODE:
```xml
<Annotations Target="MyService.ProductType">
  <!-- FieldGroup referenced by the header facet above -->
  <Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup" Qualifier="KeyFacts">
    <Record>
      <PropertyValue Property="Label" String="Key Facts"/>
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Label" String="Price"/>
            <PropertyValue Property="Value" Path="Price"/>
          </Record>
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Label" String="Availability"/>
            <PropertyValue Property="Value" Path="Availability"/>
          </Record>
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Label" String="Category"/>
            <PropertyValue Property="Value" Path="CategoryName"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>

  <!-- Example: a table section (CollectionFacet) referencing a LineItem annotation -->
  <Annotation Term="com.sap.vocabularies.UI.v1.Facets">
    <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.CollectionFacet">
        <PropertyValue Property="Label" String="Related Items"/>
        <PropertyValue Property="Target">
          <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
            <PropertyValue Property="TargetAnnotationPath" String="@UI.LineItem#RelatedItems"/>
          </Record>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: 5 — Add header toolbar actions (generic Share menu & related apps)

DESCRIPTION: The header toolbar shows generic actions in Display mode (Share menu: Send Email, Share in SAP Jam, Save as Tile, Share via Teams, etc.) and related apps. Generic share actions are provided by the Fiori elements framework; to add custom header actions, annotate DataFieldForAction items in HeaderInfo (see STEP 2). For cross-application navigation / Related Apps, implement CrossApplicationNavigation intents or manifest-based navigation targets.

LANGUAGE: XML / JSON (examples)

CODE:
```xml
<!-- In annotations: add DataFieldForAction entries inside HeaderInfo.Actions (see STEP 2) -->
<PropertyValue Property="Actions">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
      <PropertyValue Property="Label" String="Edit"/>
      <PropertyValue Property="Action" String="MyService.EditProduct"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
      <PropertyValue Property="Label" String="Delete"/>
      <PropertyValue Property="Action" String="MyService.DeleteProduct"/>
    </Record>
  </Collection>
</PropertyValue>
```

STEP: 6 — Paginator (Previous / Next) — visibility conditions and OData V2 note

DESCRIPTION: Paginator (next/previous) buttons appear when:
- The user is on a subobject page (navigated from a list).
- The navigation came from a list page that contains at least two entries.
- The current page is a subitem (not the main object page) — default behavior may differ for OData V2.

In SAP Fiori elements for OData V2:
- Paginator buttons are not available on the main object page by default. You can adapt the UI (manifest or controller extension) to enable them if required.

LANGUAGE: JSON / DESCRIPTION ONLY

CODE:
```json
/* No single annotation controls paginator universally.
   Use framework settings or adapt your app logic (controller/manifest extension)
   to enable next/previous behavior based on navigation context.
   Example placeholder (implementation depends on framework/version): */
{
  "sap.ui.generic.app": {
    "settings": {
      "enableNextPrevious": true  /* check framework docs for exact property name/version */
    }
  }
}
```

STEP: 7 — Footer bar, Draft Handling and Apply action

DESCRIPTION: The footer displays actions and the Show Messages button. For draft applications:
- Subitem object pages can show an Apply button in create/edit mode to conclude the create/edit, save the draft, and navigate one step up.
- A toast (message) should display on successful completion.
- In a draft app with flexible column layout, clicking Apply closes the subobject and returns to the main object.
Implement draft handling using the standard Fiori elements draft support (backend and annotations) and define actions (DataFieldForAction) where required. See your project's draft-handling implementation for exact manifest/settings.

LANGUAGE: XML (example action annotation)

CODE:
```xml
<Annotations Target="MyService.ProductType">
  <Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo">
    <Record>
      <!-- Apply action shown in footer for draft subitems (example) -->
      <PropertyValue Property="Actions">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
            <PropertyValue Property="Label" String="Apply"/>
            <PropertyValue Property="Action" String="MyService.ApplyDraft"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 8 — Files & paths — where to put annotations and manifest entries

DESCRIPTION: Typical file locations in a Fiori elements app:
- App manifest: webapp/manifest.json — register object page template and general settings.
- Annotations: webapp/annotations/annotations.xml (or annotations.cds / annotation files per service) — place HeaderInfo, Facets, FieldGroup, LineItem, DataPoint etc.
- Controller/UI extensions (if required): webapp/controller/Extension.controller.js (only for custom behavior like paging or custom share logic).

LANGUAGE: TEXT

CODE:
```text
webapp/
  ├─ manifest.json                # pages registration and app settings
  ├─ annotations/
  │   └─ annotations.xml          # HeaderInfo, Facets, FieldGroup, Actions, LineItems
  └─ controller/
      └─ Extension.controller.js  # optional UI adaptations (paginator, custom share)
```

STEP: 9 — Related documentation (references)

DESCRIPTION: Consult these docs for detailed control-level and annotation references:
- Controls related to object pages: sap.uxap (see control docs)
- Annotation guides: Configuring Object Page Features; Configuring Further Common Features
(Keep links in your internal docs; reference them from README or manifest comments.)

LANGUAGE: TEXT

CODE:
```text
See:
- ../10_More_About_Controls/sap-uxap-de71337.md
- configuring-object-page-features-d26d3dd.md
- configuring-further-common-features-a4d3c46.md
```

 Notes:
- Preserve OData V2 limitations: images cannot be added in the content area for SAP Fiori elements for OData V2; paginator buttons are not available on the main object page by default in OData V2.
- Keep header label-field pairs concise — recommended maximum: five.
- Use DataPoint annotations for graphical indicators (charts, ratings) in header facets.
- Implement backend actions (Action imports / bound actions) referenced by DataFieldForAction entries.
--------------------------------

**TITLE**: Overriding Horizontal Alignment for Annotation-Based Table Columns (OData V4, Fiori Elements)

**INTRODUCTION**: Modify the horizontal alignment of individual columns that are rendered from UI.LineItem annotations by adding a controlConfiguration entry in manifest.json for the specific page. This applies only to SAP Fiori elements for OData V4.

**TAGS**: fiori-elements-framework, sap-fiori, annotations, manifest.json, odata-v4, table, alignment, controlConfiguration

STEP: Edit manifest.json for the target page

DESCRIPTION: In your application's manifest.json, locate the Generic Object Page or List Report page entry (page key used by your app). Under that page's "options" -> "settings" -> "controlConfiguration" create an entry for the LineItem annotation and add a "columns" configuration targeting the specific DataField (annotation term) you want to override. Replace the page key (example: SalesOrderManageObjectPage) and column identifier (example: DataField::Material) with the correct values for your app.

LANGUAGE: JSON

CODE:
```json
{
  "SalesOrderManageObjectPage": {
    "options": {
      "settings": {
        "controlConfiguration": {
          "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
            "columns": {
              "DataField::Material": {
                "horizontalAlign": "Center"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Supported horizontalAlign values

DESCRIPTION: Valid values for the horizontalAlign property. Use the value that fits your UI needs.

LANGUAGE: JSON

CODE:
```json
{
  "horizontalAlignValues": [
    "Begin",
    "Center",
    "End"
  ]
}
```

STEP: Notes and placement guidance

DESCRIPTION: Ensure this configuration is placed in manifest.json under the correct page key used by your Fiori elements app (for example, under sap.ui.generic.app -> pages -> <pageKey> or the location your template expects). This is applicable only for OData V4-based Fiori elements; the controlConfiguration entry targets the UI.LineItem annotation and overrides the column horizontal alignment at runtime.
--------------------------------

**TITLE**: Overview Page Card — manifest.json configuration and annotations

**INTRODUCTION**: Practical, code-focused guide to configure Overview Page cards (sap.ovp) in manifest.json: define cards, set headers (title/subTitle/category), configure KPI/dataPoint annotations for KPI headers, and enable/disable Insights actions. Includes exact property names, annotation paths, and sample code snippets ready for code generation.

**TAGS**: fiori-elements-framework, sap.ovp, overview-page, cards, manifest.json, annotations, KPI, insights, SAPUI5

**STEP**: 1 — Define cards in manifest.json and global OVV settings

**DESCRIPTION**: Add the "sap.ovp" section to your manifest.json. Each card is an object property whose key is the card ID. The runtime display order follows the object property order. Bind each card to a single entity set via "model" and/or "entitySet" and choose a template (e.g., sap.ovp.cards.stack, sap.ovp.cards.table, sap.ovp.cards.charts.*). Include global filter model/entitySet if needed.

**LANGUAGE**: JSON

**CODE**:
```json
"sap.ovp": {
    "_version": "1.1.0",
    "globalFilterModel": "ZCD204_EPM_DEMO_SRV",
    "globalFilterEntityType": "SalesOrder", // Deprecated since SAPUI5 1.54.
    "globalFilterEntitySet": "SalesOrder", // Available from SAPUI5 1.54 onwards.
    "cards": {
        "card00": {
            "model": "ZCD204_EPM_DEMO_SRV",
            "template": "sap.ovp.cards.stack",
            "settings": {
                "category": "{{card00_category}}",
                "title": "{{card00_title}}",
                "subTitle": "{{card00_subTitle}}"
            }
        },
        "card01": {
            "model": "ZCD204_EPM_DEMO_SRV",
            "template": "sap.ovp.cards.table",
            "settings": {
                "title": "{{card01_title}}"
            }
        }
        // Additional cards can be added here; object property order determines runtime order
    }
}
```

**STEP**: 2 — Configure card header properties (title, subTitle, category, counter behavior)

**DESCRIPTION**: Set header properties inside each card's "settings". The title property is mandatory. subTitle is required when the card contains KPI/dataPoint annotations (e.g., KPI header). Title and subTitle must fit a maximum of two lines. A record counter is shown automatically for table and list cards — no manifest setting required for the counter (it displays according to current filters).

**LANGUAGE**: JSON

**CODE**:
```json
"cardExampleHeader": {
    "model": "MODEL",
    "template": "sap.ovp.cards.list",
    "settings": {
        "category": "Sales",
        "title": "Open Sales Orders",         // mandatory
        "subTitle": "Last 30 days",          // mandatory for KPI headers
        "actions": []                         // card actions appear in header (SAPUI5 1.110+)
    }
}
```

**STEP**: 3 — Configure KPI headers and annotation paths for cards that use DataPoint/Chart/Presentation/Selection annotations

**DESCRIPTION**: For KPI headers and chart cards that rely on OData annotations and aggregation, provide the relevant annotation path properties in the card "settings". The OData service must support aggregation and return aggregated KPI values from the backend. Use the following annotation path properties: identificationAnnotationPath, selectionAnnotationPath, chartAnnotationPath, presentationAnnotationPath, dataPointAnnotationPath. These map to annotation terms in the metadata (com.sap.vocabularies.UI.v1.*). Use fragment identifiers (#name) to reference specific annotation targets.

Annotation terms used:
- com.sap.vocabularies.UI.v1.DataPoint — KPI title and value
- com.sap.vocabularies.UI.v1.PresentationVariant — grouping/sorting for KPI/chart
- com.sap.vocabularies.UI.v1.SelectionVariant — filters
- com.sap.vocabularies.UI.v1.Chart — chart definition
- com.sap.vocabularies.UI.v1.Identification — fields used for identification

**LANGUAGE**: JSON

**CODE**:
```json
"card02": {
    "model": "ZCD204_EPM_DEMO_SRV",
    "template": "sap.ovp.cards.charts.bubble",
    "settings": {
        "entitySet": "SalesOrders",
        "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#bubble",
        "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#bubble",
        "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#bubble",
        "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#bubble",
        "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#bubble"
    }
}
```

**STEP**: 4 — Card actions (SAPUI5 1.110+) and disabling Add to Insights

**DESCRIPTION**: Card header actions available from SAPUI5 1.110: Refresh (reload card data), Add Card to Insights (shows preview and lets user add card to My Home Insights), and Manage Cards (open Manage Cards dialog). To prevent a card from being added to Insights programmatically, set "enableAddToInsights": false in the card "settings". If custom navigation is enabled for a card, Insights navigation will route to the parent overview page application (not the card target).

**LANGUAGE**: JSON

**CODE**:
```json
"card01": {
    "model": "MODEL",
    "template": "sap.ovp.cards.charts.analytical",
    "settings": {
        "title": "{{card01_title}}",
        "subTitle": "{{card01_subTitle}}",
        "entitySet": "C_EntitySet",
        "enableAddToInsights": false,
        "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#SV",
        "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#Chart",
        "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#PV",
        "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#DP",
        "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification"
    }
}
```

**STEP**: 5 — Insights usage rules and limits (behavioral notes for implementation)

**DESCRIPTION**: When implementing Add Card to Insights:
- Users can add a previewed card to My Home > Insights and edit title/subtitle before adding.
- Insights supports a maximum of 8 cards visible at a time. If the limit is reached, added cards go to the Edit Insights dialog for selection/deselection.
- If a card has custom navigation enabled, an Insights link navigates to the parent overview page application rather than the card's target.

**LANGUAGE**: JSON

**CODE**:
```json
// No code change required for behavior notes. Ensure your application:
// - Provides enableAddToInsights boolean per card if you want to restrict adding to Insights.
// - Tests navigation behavior when using custom navigation handlers.
// - Honors maximum 8 insights cards limit at runtime (UI behavior controlled by My Home/Insights service).
```
--------------------------------

**TITLE**: Overview Page (OVP) — Minimal SAPUI5 App Setup and Card Configuration

**INTRODUCTION**: This guide gives concise, code-focused examples to create an Overview Page (OVP) SAPUI5 application: extend the OVP component, configure the required manifest.json entries, define cards bound to OData entity sets, and configure a global smart filter. Use these snippets as copy-paste starting points in webapp/Component.js and webapp/manifest.json.

**TAGS**: fiori-elements-framework, overview-page, ovp, sapui5, manifest.json, Component.js, OData, cards, smart-filter

**STEP**: 1 — Create the OVP component file

**DESCRIPTION**: Extend the OVP base component so your application uses the OVP lifecycle and card rendering. Put this file at webapp/Component.js.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// File: webapp/Component.js
sap.ui.define([
  "sap/ovp/app/Component" // OVP base component
], function (OVPComponent) {
  "use strict";

  return OVPComponent.extend("com.example.ovp.Component", {
    metadata: {
      manifest: "json"
    }
  });
});
```

**STEP**: 2 — Minimal manifest.json skeleton with OVP entries, data source and models

**DESCRIPTION**: Configure the application id, OData data source, UI5 dependencies, and an OVP-specific "sap.ovp" section where you define global filters and cards. Place this at webapp/manifest.json. Replace URIs, entitySet names, and model ids with your service specifics.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.app": {
    "id": "com.example.ovp",
    "type": "application",
    "applicationVersion": { "version": "1.0.0" }
  },
  "sap.ui5": {
    "rootView": {
      "viewName": "com.example.ovp.view.App",
      "type": "XML",
      "async": true
    },
    "dependencies": {
      "minUI5Version": "1.96.0",
      "libs": {
        "sap.ovp": {},
        "sap.ui.core": {},
        "sap.m": {},
        "sap.ui.comp": {}
      }
    },
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "defaultBindingMode": "TwoWay"
        }
      }
    }
  },
  "sap.ui": {
    "technology": "UI5"
  },
  "sap.platform.abap": {},
  "dataSources": {
    "mainService": {
      "uri": "/sap/opu/odata/sap/Z_MY_SERVICE_SRV/",
      "type": "OData"
    }
  },
  "sap.ovp": {
    "globalFilters": [
      {
        "label": "Company Code",
        "entityType": "SalesOrder",   /* example entity type name */
        "property": "CompanyCode"     /* OData property used by Smart Filter */
      }
    ],
    "cards": {
      "SalesOrderList": {
        "model": "",
        "entitySet": "SalesOrderSet",
        "template": "sap.ovp.cards.list",   /* list card template */
        "title": "Open Sales Orders",
        "settings": {
          "navigation": {
            "semanticObject": "SalesOrder",
            "action": "display"
          },
          "list": {
            "content": "{SalesOrderID} - {CustomerName}",
            "maxItems": 5
          }
        }
      },
      "TopProductsChart": {
        "model": "",
        "entitySet": "TopProductsSet",
        "template": "sap.ovp.cards.charts.analytical", /* chart card template */
        "title": "Top Products",
        "settings": {
          "chartType": "donut",
          "dimensions": ["ProductName"],
          "measures": ["TotalSales"]
        }
      }
    }
  }
}
```

**STEP**: 3 — Add card-specific settings and annotations (annotation-driven cards)

**DESCRIPTION**: Cards can also be driven by OData UI annotations. If you prefer annotation-based cards, ensure your service exposes relevant annotations (e.g., UI.LineItem, UI.Chart) and reference the entity set in the manifest card entry. Example manifest card indicates the entitySet; the OData service annotations provide columns/fields and chart metadata.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.ovp": {
    "cards": {
      "AnnotatedCardExample": {
        "model": "",
        "entitySet": "AnnotatedEntitySet",
        "template": "sap.ovp.cards.list",
        "title": "Annotated Card (UI.LineItem)",
        "settings": {
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem" /* instructs OVP to use UI LineItem annotation */
        }
      }
    }
  }
}
```

**STEP**: 4 — File paths and deployment notes

**DESCRIPTION**: Use these file paths in your project layout and follow the note about sap-keep-alive and UI5 version compatibility.

**LANGUAGE**: Text

**CODE**:
```text
Project file locations:
- webapp/Component.js      -> extends sap/ovp/app/Component
- webapp/manifest.json     -> application configuration including "sap.ovp"

Important note:
- If you use sap-keep-alive mode with multiple overview page applications, upgrade SAPUI5 to 1.96.0 or above to avoid lifecycle issues.
```

**STEP**: 5 — Quick checklist for a working OVP app

**DESCRIPTION**: Action list to validate your app before running.

**LANGUAGE**: Text

**CODE**:
```text
Checklist:
- webapp/Component.js extends sap/ovp/app/Component
- webapp/manifest.json contains "sap.ovp" with cards and optional globalFilters
- dataSources section references your OData service and models section binds model to dataSource
- Include the sap.ovp library in sap.ui5.dependencies.libs
- For annotation-driven cards, ensure OData service exposes UI annotations (UI.LineItem, UI.Chart, etc.)
- If using sap-keep-alive across multiple OVP apps, use SAPUI5 >= 1.96.0
```

--------------------------------

**TITLE**: Passing Variant IDs as URL Parameters in SAP Fiori Elements

**INTRODUCTION**: How to pass page and control variant IDs as URL parameters when navigating between Fiori Elements apps (Analytical List Page, List Report). Includes how to find variant IDs at runtime and how to declare variant parameters in manifest.json for OData V2 and OData V4.

**TAGS**: fiori-elements-framework, sap-fiori, variants, url-parameters, manifest.json, ODataV2, ODataV4

**STEP**: 1 — URL parameters available and usage

**DESCRIPTION**: Use these query parameters on the target app URL to set page- or control-level variants. Always pass the variant ID (not the variant name). The ID must exist in the target app.

- sap-ui-fe-variant-id: page variant ID
- sap-ui-fe-filterbar-variant-id: filter bar (filter area) control variant ID
- sap-ui-fe-chart-variant-id: chart control variant ID
- sap-ui-fe-table-variant-id: table control variant ID

Examples:
- Page variant only:
  https://abc.com/ui#SalesOrder-analyze_deliv_perf?sap-ui-fe-variant-id=id_1542011587281_980_page
- Filterbar variant:
  https://abc.com/ui#SalesOrder-analyze_deliv_perf?sap-ui-fe-filterbar-variant-id=id_1542011587281_230_page
- Chart and table together:
  https://abc.com/ui#SalesOrder-analyze_deliv_perf?sap-ui-fe-chart-variant-id=id_1574157179885_675_chart&sap-ui-fe-table-variant-id=id_1574157179595_331_table

**LANGUAGE**: text

**CODE**:
```text
# Single page variant
https://abc.com/ui#SalesOrder-analyze_deliv_perf?sap-ui-fe-variant-id=id_1542011587281_980_page

# Filterbar variant
https://abc.com/ui#SalesOrder-analyze_deliv_perf?sap-ui-fe-filterbar-variant-id=id_1542011587281_230_page

# Chart and table variants (combined)
https://abc.com/ui#SalesOrder-analyze_deliv_perf?sap-ui-fe-chart-variant-id=id_1574157179885_675_chart&sap-ui-fe-table-variant-id=id_1574157179595_331_table
```

**STEP**: 2 — Find the variant ID at runtime (control or filter bar)

**DESCRIPTION**: To obtain the stable variant ID of a control (control-level variant) or the filter bar (page-level variant) in the source app, get the control instance by its stable ID and call getCurrentVariantId(). Use this variant ID in URL parameters or in manifest.json parameters.

- Ensure you use the stable ID used in the app (the same ID used in view/metadata).
- The API to call on the control instance is getCurrentVariantId().

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: get variant ID from a control or filter bar
sap.ui.define(["sap/ui/core/Element"], function(Element) {
  // Replace "myFilterBar" / "myChart" with the stable ID of the control
  var filterBar = Element.getElementById("myFilterBar"); // or Element.getElementById("myChart")
  if (filterBar && typeof filterBar.getCurrentVariantId === "function") {
    var variantId = filterBar.getCurrentVariantId(); // e.g. "id_1542011587281_980_page"
    console.log("Current variant ID:", variantId);
  } else {
    console.warn("Control instance not found or getCurrentVariantId() not available");
  }
});
```

**STEP**: 3 — Behavior, precedence and important notes

**DESCRIPTION**: Rules when combining page and control variants and invalid IDs:
- If both page variant and a control variant are present in the URL:
  - Page-variant-based apps: page variant takes precedence and control variant IDs are ignored.
  - Control-variant-based apps: the control variant ID applies. If control variant ID is missing, the page variant ID applies to the control.
- If the passed variant ID is invalid or missing, the app falls back to the default/standard variant.
- Adding a variant ID to the URL overrides the user's saved default variant in the target app.
- Always pass IDs that already exist in the target application.

**LANGUAGE**: text

**CODE**:
```text
# Precedence summary:
- Page-based variant present -> page-level variant applied (control variant ignored)
- Control-based variant present -> control-level variant applied
- Invalid or missing variant ID -> default/standard variant applied
- URL-specified variant ID overrides user's default variant
```

**STEP**: 4 — Declare variant parameter in manifest.json (SAP Fiori Elements for OData V2)

**DESCRIPTION**: To pass a variant ID from this app when launching a target app via cross-application navigation, add the parameter under the outbound configuration in manifest.json. Place manifest.json at the app root (e.g., webapp/manifest.json).

- For OData V2, parameters are provided as simple key/value pairs.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "crossNavigation": {
    "inbounds": {
      "...": {}
    },
    "outbounds": {
      "EPMProductManage": {
        "semanticObject": "EPMProduct",
        "action": "manage",
        "parameters": {
          "sap-ui-fe-variant-id": "id_1542011587281_980_page"
        }
      }
    }
  }
}
```

**STEP**: 5 — Declare variant parameter in manifest.json (SAP Fiori Elements for OData V4)

**DESCRIPTION**: For OData V4 outbound configuration, include the variant parameter with the nested value/format structure. This ensures correct encoding and plain format in the generated navigation URL.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "crossNavigation": {
      "outbounds": {
        "ProductDetails": {
          "semanticObject": "Manage",
          "action": "items",
          "parameters": {
            "sap-ui-fe-variant-id": {
              "value": {
                "value": "id_1633600133090_222",
                "format": "plain"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — Combined example: pass page and control variants in a manifest outbound (OData V4)

**DESCRIPTION**: Example declaring multiple variant parameters (page and control) in outbounds. Remember precedence rules when the target uses page-level vs control-level variants.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "crossNavigation": {
      "outbounds": {
        "OpenSalesReport": {
          "semanticObject": "Sales",
          "action": "report",
          "parameters": {
            "sap-ui-fe-variant-id": {
              "value": {
                "value": "id_1542011587281_980_page",
                "format": "plain"
              }
            },
            "sap-ui-fe-chart-variant-id": {
              "value": {
                "value": "id_1574157179885_675_chart",
                "format": "plain"
              }
            },
            "sap-ui-fe-table-variant-id": {
              "value": {
                "value": "id_1574157179595_331_table",
                "format": "plain"
              }
            }
          }
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Placing Reuse Component Instances on an Object Page (Fiori Elements, OData V2 & V4)

**INTRODUCTION**: Practical, code-focused guide for embedding, grouping, hiding, refreshing, and title-integration of reuse components on Object Pages in SAP Fiori elements apps. Covers both OData V2 (manifest-based embeddedComponents) and OData V4 (UI5 routing + custom subsections). Use these examples directly in manifest.json, routing config, component.js and reuse component controllers.

**TAGS**: fiori-elements, object-page, reuse-component, manifest, sapui5, routing, extension-api, ODataV2, ODataV4, stRefresh

STEP: OData V2 — Add a reuse component as a subsection to an existing section

DESCRIPTION: Add a reuse component to an existing Object Page section by referencing the target section's ID or facet path via "leadingSectionIdOrPath". Place the reuse component as a final subsection of the referenced section. Include component settings (e.g., navigationProperty).

LANGUAGE: JSON

CODE:
```JSON
{
  "sap.app": { /* ... */ },
  "sap.ui5": {
    "models": { /* ... */ },
    "embeddedComponents": {
      "tableTest": {
        "id": "tableTest",
        "componentName": "STTA_MP.reuseComponents.tableTest",
        "title": "{{SalesPriceReuse}}",
        "leadingSectionIdOrPath": "GeneralInformation", 
        "settings": {
          "navigationProperty": "to_ProductSalesPrice"
        }
      }
    }
  }
}
```

STEP: OData V2 — Group reuse components into a single section

DESCRIPTION: Group multiple reuse components under a group/section. Select one component as leading (set its id), other components reference it via leadingSectionIdOrPath. Use "groupTitle" to set the section title; if absent, existing title is used. If grouping is invalid (e.g., reused elsewhere), fallback displays components as separate sections.

LANGUAGE: JSON

CODE:
```JSON
{
  "sap.ui5": {
    "embeddedComponents": {
      "stateTest": {
        "id": "stateTest",
        "componentUsage": "stateTest",
        "title": "{{stateReuse}}",
        "groupTitle": "{{reuseGroupTitle}}"
      },
      "situationsTest": {
        "id": "situationsTest",
        "componentName": "STTA_MP.reuseComponents.situationsTest",
        "title": "{{situationsReuse}}",
        "settings": {
          "productKey": "{ProductForEdit}"
        },
        "leadingSectionIdOrPath": "stateTest"
      }
    }
  }
}
```

STEP: OData V2 — Hide a reuse component using the Extension API

DESCRIPTION: Use the ExtensionAPI.SetSectionHidden to hide only reuse components. Call this API from the reuse component (component.js). The API accepts a single Boolean argument. Example attaches to page data load and hides the section when ProductCategory !== "Notebooks".

LANGUAGE: JavaScript

CODE:
```JavaScript
// component.js (inside your reuse component)
function fnRegisterOnPageDataLoaded(oExtensionAPI) {
    oExtensionAPI.attachPageDataLoaded(function(oEvent) {
        var oContextData = oEvent.context.getObject();
        // SetSectionHidden expects a Boolean (true = hidden, false = visible)
        (oExtensionAPI.setSectionHidden || jQuery.noop)(oContextData.ProductCategory !== "Notebooks");
    });
}

// Example: call fnRegisterOnPageDataLoaded with the extension API reference in your component init
// fnRegisterOnPageDataLoaded(this.extensionAPI);
```

STEP: OData V2 — Refresh reuse component via stRefresh / stRefreshTrigger

DESCRIPTION: Reuse components expose a stRefresh function that the framework calls to refresh. Trigger refreshes by configuring stRefreshTrigger in the reuse component settings (manifest). stRefreshTrigger supports single property, concatenation of multiple properties, and expression binding.

LANGUAGE: JSON

CODE:
```JSON
{
  "sap.ui5": {
    "embeddedComponents": {
      "priceComponentEmbedding_single": {
        "id": "priceComponentEmbedding",
        "componentUsage": "priceComponentUsage",
        "title": "{{I18N_KEY_FOR_PRICE_COMPONENT_TITLE}}",
        "settings": {
          "stRefreshTrigger": "{Price}"
        }
      },
      "priceComponentEmbedding_multi": {
        "id": "priceComponentEmbeddingMulti",
        "componentUsage": "priceComponentUsageMulti",
        "title": "{{I18N_KEY_FOR_PRICE_COMPONENT_TITLE}}",
        "settings": {
          "stRefreshTrigger": "{Price}{Supplier}"
        }
      },
      "priceComponentEmbedding_expr": {
        "id": "priceComponentEmbeddingExpr",
        "componentUsage": "priceComponentUsageExpr",
        "title": "{{I18N_KEY_FOR_PRICE_COMPONENT_TITLE}}",
        "settings": {
          "stRefreshTrigger": "{= ${Price} + ${Supplier} }"
        }
      }
    }
  }
}
```

STEP: OData V2 — Set section title to control inside reuse component (setAsTitleOwner)

DESCRIPTION: Make the control inside the reuse component appear as the section/subsection title by calling extensionAPI.setAsTitleOwner(control). For SmartTable/SmartChart, call inside the control's initialise event; for other controls, call inside the controller onInit. The control must expose a header/text property.

LANGUAGE: XML

CODE:
```XML
<!-- reuse component view: attach initialise on SmartTable -->
<st:SmartTable id="SalesPriceFacetID" initialise="SalesPriceInitialise" />
```

LANGUAGE: JavaScript

CODE:
```JavaScript
// reuse component controller

// Scenario 1: SmartTable initialisation handler
SalesPriceInitialise: function(oEvent) {
    var oSmartTable = oEvent.getSource();
    // Obtain extension API and register the control as the title owner
    var oExtensionAPI = extensionAPI.getExtensionAPI(oSmartTable);
    oExtensionAPI.setAsTitleOwner(oSmartTable);
}

// Scenario 2: Other controls - call in onInit
onInit: function() {
    var oControl = this.byId("myControlId"); // control must have header/text
    var oExtensionAPI = extensionAPI.getExtensionAPI(oControl);
    oExtensionAPI.setAsTitleOwner(oControl);
}
```

STEP: OData V4 — Add reuse components using UI5 routing + custom subsection controlId

DESCRIPTION: For OData V4, place reuse components into empty custom subsections by using SAPUI5 routing targets. Add the reuse component as a separate routing target; set target properties: type = "Component", controlAggregation = "blocks", clearControlAggregation = true, parent = object page target name, controlId = subsection controlId, and options.settings = component settings.

LANGUAGE: JSON

CODE:
```JSON
{
  "sap.ui5": {
    "routing": {
      "routes": [
        {
          "pattern": "myEntitySet({key}):?query:",
          "name": "myObjectPage",
          "target": ["myObjectPage", "ReuseComponent", "ReuseComponent2"]
        }
      ],
      "targets": {
        "myObjectPage": {
          "type": "Component",
          "id": "myObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "mySection": {
                      "subSections": {
                        "ReuseContainer": {
                          "title": "{i18n>reuseTitle}",
                          "controlId": "firstReuseContainer",
                          "position": {
                            "placement": "After",
                            "anchor": "someSubSection"
                          }
                        }
                      }
                    },
                    "ReuseComponentContainer": {
                      "position": {
                        "placement": "Before",
                        "anchor": "mySubSection"
                      },
                      "title": "Reuse Container",
                      "subSections": {
                        "ReuseContainer": {
                          "controlId": "secondReuseContainer"
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "ReuseComponent": {
          "type": "Component",
          "id": "Reuse",
          "name": "path/to/reuseComponent",
          "options": {
            "settings": {
              "exampleSettings": "{somePropertyName}"
            }
          },
          "parent": "myObjectPage",
          "controlId": "firstReuseContainer",
          "controlAggregation": "blocks",
          "clearControlAggregation": true
        },
        "ReuseComponent2": {
          "type": "Component",
          "id": "Reuse2",
          "name": "path/to/reuseComponent2",
          "options": {
            "settings": {
              "exampleSettings": "{somePropertyName}"
            }
          },
          "parent": "myObjectPage",
          "controlId": "secondReuseContainer",
          "controlAggregation": "blocks",
          "clearControlAggregation": true
        }
      }
    }
  }
}
```

STEP: OData V4 — Hiding a reuse component (by hiding its subsection)

DESCRIPTION: A reuse component is bound to the custom subsection it occupies. To hide a reuse component, hide the corresponding subsection (via extension points or runtime logic that toggles the subsection visibility). See "Extension Points for Subsections on the Object Page" for subsection hiding methods.

LANGUAGE: JSON

CODE:
```JSON
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "myObjectPage": {
          "options": {
            "settings": {
              "content": {
                "body": {
                  "sections": {
                    "mySection": {
                      "subSections": {
                        "ReuseContainer": {
                          "controlId": "firstReuseContainer",
                          "visible": false  // hide subsection -> reuse component hidden
                        }
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V4 — Refreshing reuse components

DESCRIPTION: For V4 reuse components, implement property setter methods in the component to react to changes of inputs/exposed properties. The component refreshes itself based on its exposed properties; changes in properties should trigger appropriate internal refresh logic (for instance, call internal refresh or re-bind data in the setter).

LANGUAGE: JavaScript

CODE:
```JavaScript
// Example: in reuse component controller
setExampleProperty: function(sNewValue) {
    this._exampleProperty = sNewValue;
    // perform refresh logic: re-bind, call internal refresh, or fetch data
    if (this.stRefresh) {
        // if using stRefresh style API inside component
        this.stRefresh();
    } else {
        // custom refresh implementation
        this._refreshData();
    }
}
```
--------------------------------

**TITLE**: Plain Text Facet for Object Page Header (UI.ReferenceFacet + UI.FieldGroup + UI.MultiLineText)

**INTRODUCTION**: Add a plain text facet to the object page header to display a titled block of multiline text (e.g., a product description). Implement by adding a UI.ReferenceFacet inside the UI.HeaderFacets (or UI.HeaderFacet) that targets a UI.FieldGroup qualifier (PlainText). Ensure the text property is annotated as multiline with UI.MultiLineText.

**TAGS**: fiori-elements, annotations, UI.ReferenceFacet, UI.FieldGroup, UI.MultiLineText, CDS, ABAP, CAP, XML

**STEP**: 1 — Add UI.ReferenceFacet to header (XML)
**DESCRIPTION**: Place a UI.ReferenceFacet in the header area via UI.HeaderFacets. Set Label and Target to reference the FieldGroup qualifier PlainText on the related to_ProductTextInCurrentLang entity.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.HeaderFacets">
  <Collection>
    <Record Type="UI.ReferenceFacet">
      <!-- Title shown in header -->
      <PropertyValue Property="Label" String="{@i18n>@ProductDescription}"/>
      <!-- Reference the FieldGroup qualifier PlainText on the navigation target -->
      <PropertyValue Property="Target" AnnotationPath="to_ProductTextInCurrentLang/@UI.FieldGroup#PlainText"/>
    </Record>
  </Collection>
</Annotation>
```

**STEP**: 1 — Add UI.ReferenceFacet to header (ABAP CDS)
**DESCRIPTION**: Add a reference facet to the CDS view header using @UI.facet with type #FIELDGROUP_REFERENCE and target qualifier 'PlainText'.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.facet: [
  {
    label:        '{@i18n>@ProductDescription}',
    purpose:      #STANDARD,
    type:         #FIELDGROUP_REFERENCE,
    targetElement: '_ProductTextInCurrentLang',
    targetQualifier: 'PlainText'
  }
]
```

**STEP**: 1 — Add UI.ReferenceFacet to header (CAP CDS)
**DESCRIPTION**: Create a UI.ReferenceFacet object in your CDS annotation JSON (or annotation block) that points to the FieldGroup qualifier PlainText.
**LANGUAGE**: CDS (CAP)
**CODE**:
```json
{
  "$Type": "UI.ReferenceFacet",
  "Label": "{@i18n>@ProductDescription}",
  "Target": "to_ProductTextInCurrentLang/@UI.FieldGroup#PlainText"
}
```

**STEP**: 2 — Define UI.FieldGroup qualifier PlainText (XML)
**DESCRIPTION**: Create a UI.FieldGroup annotation with qualifier PlainText that contains a UI.DataField for the Description property (the value to display as plain text).
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="PlainText">
  <Record>
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="Description"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 2 — Define UI.FieldGroup qualifier PlainText (ABAP CDS)
**DESCRIPTION**: Define field group qualifier PlainText in ABAP CDS and include the Description field in the view projection or entity that holds product text.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.fieldGroup: [
  {
    qualifier: 'PlainText'
  }
]
DESCRIPTION;
```

**STEP**: 2 — Define UI.FieldGroup qualifier PlainText (CAP CDS)
**DESCRIPTION**: Define UI.FieldGroup #PlainText in CAP CDS annotation syntax and include a UI.DataField mapping to Description.
**LANGUAGE**: CDS (CAP)
**CODE**:
```json
"UI.FieldGroup#PlainText": {
  "Data": [
    {
      "$Type": "UI.DataField",
      "Value": "Description"
    }
  ]
}
```

**STEP**: 3 — Mark the Description property as multiline (XML)
**DESCRIPTION**: Annotate the target property's path to indicate it contains multiline text so the UI renders line breaks and respects long content.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductTextType/Description">
  <Annotation Term="UI.MultiLineText"/>
</Annotations>
```

**STEP**: 3 — Mark the Description property as multiline (ABAP CDS)
**DESCRIPTION**: Use @UI.multiLineText: true on the Description element in the ABAP CDS view or annotation block.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
annotate view STTA_C_MP_PRODUCTTEXTTYPE with {
  @UI.multiLineText: true
  description;
}
```

**STEP**: 3 — Mark the Description property as multiline (CAP CDS)
**DESCRIPTION**: Apply UI.MultiLineText to the Description field in CAP CDS annotate block.
**LANGUAGE**: CDS (CAP)
**CODE**:
```cap
annotate STTA_PROD_MAN.STTA_C_MP_ProductTextType with {
  @UI.MultiLineText
  Description
};
```

**STEP**: 4 — (Optional) Define custom CDS element for multiLineText and use in source
**DESCRIPTION**: If you manage custom CDS annotations, define a multiLineText annotation element (scope ELEMENT) and annotate the Description element in your CDS source.
**LANGUAGE**: CDS
**CODE**:
```cds
// Annotation definition file (e.g., xx.annotations.cds)
//@Scope: #ELEMENT
multiLineText : Boolean default true;
```

```cds
// CDS entity source where you apply the custom annotation
@UI.multiLineText
Description : String;
```
--------------------------------

**TITLE**: Prefilling Fields Using the DefaultValuesFunction (OData / SAP Fiori elements)

**INTRODUCTION**: Use the DefaultValuesFunction annotation to provide server-side default values when creating a new entity or prefilling action parameters in SAP Fiori elements. This applies to OData V2 non-draft apps and to OData V2/V4 draft apps when using empty-row mode. The annotation points to a FunctionImport that returns a structure with default values.

**TAGS**: fiori-elements-framework, odata-v2, odata-v4, default-values, annotations, DefaultValuesFunction, FunctionImport, metadata

**STEP**: 1 — Applicability and behavior

**DESCRIPTION**: Ensure your scenario supports DefaultValuesFunction:
- Supported scenarios:
  - SAP Fiori elements for OData V2 non-draft applications.
  - SAP Fiori elements for OData V2 and OData V4 draft applications only when using empty-row mode. See: enabling-inline-creation-mode-or-empty-row-mode-for-table-entries-cfb04f0.md
- Multiselect behavior: in multiselect scenarios the DefaultValuesFunction is invoked only when it has no input parameters.

**LANGUAGE**: Text

**CODE**:
```text
Notes:
- DefaultValuesFunction must be declared as a FunctionImport in the service metadata (EDMX).
- The Annotation Term is com.sap.vocabularies.Common.v1.DefaultValuesFunction and its String value is the FunctionImport Name.
- The Annotation Target must point to the EntitySet / navigation property for which defaults are required.
```

**STEP**: 2 — Create entity: FunctionImport + Annotation (root entity)

**DESCRIPTION**: Add a FunctionImport that returns the default values structure and annotate the target EntitySet (or EntityType path) with DefaultValuesFunction specifying the FunctionImport Name. Place these entries in your service metadata (EDMX).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- FunctionImport that returns defaults for creating the Root entity -->
<FunctionImport Name="GetDefaultsForRoot" ReturnType="cds_zrc_dv_defaultvalues.ZRC_DV_A_Create" m:HttpMethod="GET"/>

<!-- Annotation that associates the FunctionImport with the Root entity -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="cds_zrc_dv_defaultvalues.cds_zrc_dv_defaultvalues_Entities/Root">
  <Annotation Term="com.sap.vocabularies.Common.v1.DefaultValuesFunction" String="GetDefaultsForRoot"/>
</Annotations>
```

**STEP**: 3 — Navigation property / item create: FunctionImport with parameter + Annotation

**DESCRIPTION**: For creating a child (navigation property) that needs defaults based on the parent, declare a FunctionImport with an input parameter (e.g., parent key) and annotate the navigation property target with DefaultValuesFunction. Use sap:action-for to bind the FunctionImport to the parent type in the metadata.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- FunctionImport that accepts parent identifier and returns defaults for the child item -->
<FunctionImport Name="GetDefaultsForItem" ReturnType="cds_zrc_dv_defaultvalues.ZRC_DV_A_Create" m:HttpMethod="GET" sap:action-for="cds_zrc_dv_defaultvalues.RootType">
  <Parameter Name="UUID" Type="Edm.Guid" Mode="In"/>
</FunctionImport>

<!-- Annotation that associates the FunctionImport with the navigation property -->
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="cds_zrc_dv_defaultvalues.RootType/to_Item">
  <Annotation Term="com.sap.vocabularies.Common.v1.DefaultValuesFunction" String="GetDefaultsForItem"/>
</Annotations>
```

**STEP**: 4 — Implementation details and references

**DESCRIPTION**: Implementation checklist:
- Implement the FunctionImport in your backend service to return the exact structure expected by the client (ReturnType).
- Ensure the FunctionImport HTTP method (m:HttpMethod="GET") and parameter types (Edm.Guid, etc.) match your service implementation.
- Place Annotation entries in the EDMX under the correct Target (EntitySet path or navigation property).
- Verify empty-row mode is enabled for draft apps where applicable.

**LANGUAGE**: Text

**CODE**:
```text
Related documentation:
- Prefilling Fields When Creating a New Entity: prefilling-fields-when-creating-a-new-entity-11ff444.md
- Prefilling Fields When Creating a New Entity Using an Extension Point: prefilling-fields-when-creating-a-new-entity-using-an-extension-point-189e2d8.md
- Enabling Inline Creation Mode or Empty Row Mode for Table Entries: enabling-inline-creation-mode-or-empty-row-mode-for-table-entries-cfb04f0.md

Related topic:
- Actions: actions-cbf16c5.md
```
--------------------------------

**TITLE**: Prefilling Fields When Creating a New Entity (SAP Fiori Elements)

**INTRODUCTION**: This guide explains how to prefill fields when creating a new entity in SAP Fiori Elements applications. It covers server-side prefill for draft-enabled entities, transferring values from the front end, and specific options for OData V2 and OData V4 (including the NewAction annotation). Use these steps to implement predictable default values or to pass user input collected before creation into the new entity.

**TAGS**: fiori-elements-framework, odata, draft, prefilling, NewAction, DefaultValuesFunction, extension-point, preferredMode

**STEP**: 1 — Choose server-side prefill for draft-enabled entities

**DESCRIPTION**: For draft-enabled entities, implement prefill logic inside the backend service implementation that prepares the draft or handles the creation request. Put default-value logic in the server-side create/draft-prepare handler so the created draft record contains your prefilled values before the UI renders it.

Examples of where to add logic:
- SAP Gateway / OData service CREATE handler
- CAP (Cloud Application Programming) before CREATE / draft prepare hooks
- Any server-side draft prepare or create extension point provided by your OData service framework

**LANGUAGE**: text

**CODE**:
```text
// Implementation notes (pseudo):
// - Detect create of a new draft entity.
// - Populate fields with computed or transferred values.
// - Return the draft entity so the front-end opens with prefilling applied.
```

**STEP**: 2 — Transfer front-end values to the back end

**DESCRIPTION**: If prefilling values depend on prior user interaction in the UI, send those values from the front end to the back end when starting creation. Options:
- Pass parameters via navigation (cross-app or internal navigation) so the receiving app/service can use them when preparing the draft.
- Include values in the payload of the create POST (or the createDraft call) so the server receives them and applies them in the created draft entity.
- If using cross-app navigation, follow the preferredMode handling pattern (see Handling of the preferredMode Parameter).

Best practices:
- Only prefill fields that are visible/editable to the user.
- Avoid surprising the user with hidden prefilled values.

**LANGUAGE**: text

**CODE**:
```text
// Example approaches (UI5 / front-end pseudocode):
// 1) Navigation with parameters:
//   sap.ushell.Container.getService("CrossApplicationNavigation").toExternal({
//     target: { semanticObject: "SalesOrder", action: "create" },
//     params: { customerId: ["12345"], sourceContext: ["widgetA"] }
//   });
//
// 2) Create request with prefill values:
//   oModel.create("/SalesOrderDrafts", { CustomerID: "12345", Note: "Prefill from widgetA" });
// Backend reads these params/payload and applies values during draft creation.
```

**STEP**: 3 — OData V2: UI-side options (Extension Point and DefaultValuesFunction)

**DESCRIPTION**: For SAP Fiori Elements OData V2 apps you can support prefilling on the UI in additional ways:
- Extension point: Implement the relevant extension point in the List Report or Object Page to compute or inject default values before navigation to create screen. See "Prefilling Fields When Creating a New Entity Using an Extension Point".
- DefaultValuesFunction: Use the DefaultValuesFunction annotation/mechanism to return default values for fields when creating new items/entities on the UI. See "Prefilling Fields Using the DefaultValuesFunction".

Refer to the linked Fiori Elements docs for exact extension point names and annotation usage.

**LANGUAGE**: text

**CODE**:
```text
// Implementation notes:
// - Extension point: Add UI5 extension that sets model properties or navigation params.
// - DefaultValuesFunction: Configure the annotation on the entity/type and implement the function to return a set of default values.
```

**STEP**: 4 — OData V4: Define NewAction and parameters (List Report)

**DESCRIPTION**: For OData V4 List Report apps, you can define a NewAction on the DraftRoot annotation. NewAction lets the user provide parameter values during creation. For POST-based creation, a dialog is shown automatically if key or immutable fields require values.

Example annotation to set a NewAction on the DraftRoot:

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="Common.DraftRoot">
    <Record Type="Common.DraftRootType">
        <PropertyValue Property="NewAction" String="com.sap.gateway.srvd.c_salesordermanage_sd.v0001.CreateWithSalesOrderType"/>
        <!-- Additional configuration can go here -->
    </Record>
</Annotation>
```

**STEP**: 5 — Notes and caution

**DESCRIPTION**: Use prefilling carefully:
- Do not prefill fields that may be hidden from the user or might be unexpected.
- Ensure compliance with business rules and data validation.
- Test scenarios where users change or clear prefills.

**LANGUAGE**: text

**CODE**:
```text
// Checklist:
// - Prefilled fields are visible and editable as needed.
// - Backend applies same validation as manual input.
// - Navigation and parameter passing work across cross-app scenarios (consider preferredMode).
```

**STEP**: 6 — Related references

**DESCRIPTION**: Consult these Fiori Elements topics for implementation details and examples:
- Handling of the preferredMode Parameter (cross-app creation)
- Prefilling Fields When Creating a New Entity Using an Extension Point (OData V2)
- Prefilling Fields Using the DefaultValuesFunction (OData V2)
- Actions in the List Report (OData V4 List Report actions and parameters)

**LANGUAGE**: text

**CODE**:
```text
// Use the above doc names to find the exact annotation/extension point names and example code in SAP documentation.
```
--------------------------------

**TITLE**: Prefilling Fields When Creating a New Entity Using an Extension Point

**INTRODUCTION**: Configure a List Report to pass values from the filter bar (or from default values) into the new-entity creation dialog using the createWithFilters extension strategy. Applicable to SAP Fiori elements for OData V2. This guide shows the manifest change and the extension functions to extract filter values and/or fall back to DefaultValuesFunction.

**TAGS**: fiori-elements-framework, OData V2, SAPUI5, ListReport, SmartFilterBar, manifest.json, extension, getPredefinedValuesForCreateExtension, DefaultValuesFunction

**STEP**: 1 — Enable Create with Filters in manifest.json

**DESCRIPTION**: Add the createWithFilters strategy = "extension" for the ListReport page in manifest.json. This changes the Create button into a menu with "Create Object" (i18n key: CREATE_NEW_OBJECT) and "Create with Filters". The "Create with Filters" menu item is enabled only when the table data corresponds to the displayed filter values (user may need to press Go).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "???",
    "settings": {},
    "pages": {
      "ListReport|myEntitySet": {
        "entitySet": "myEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "createWithFilters": {
              "strategy": "extension"
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Implement getPredefinedValuesForCreateExtension (extract filter bar values)

**DESCRIPTION**: Implement getPredefinedValuesForCreateExtension in your ListReport extension controller. This function receives the SmartFilterBar instance and must return a plain object of name-value pairs for prefilling the new-entity dialog. The example below transfers a value only when the corresponding SelectOption exists, is unique, has Sign = "I" and Option = "EQ" (single equality).

Place this function in your ListReport extension file (e.g., webapp/extension/ListReportExtension.controller.js or your chosen extension module).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define([], function() {
  "use strict";
  return {
    /**
     * Called by the framework to obtain predefined values for the create dialog.
     * @param {sap.ui.comp.smartfilterbar.SmartFilterBar} oSmartFilterBar
     * @returns {Object} name-value map for fields to prefill
     */
    getPredefinedValuesForCreateExtension: function(oSmartFilterBar) {
      var oRet = {};
      if (!oSmartFilterBar || !oSmartFilterBar.getUiState) {
        return oRet;
      }

      var oSelectionVariant = oSmartFilterBar.getUiState().getSelectionVariant();
      var aSelectOptions = oSelectionVariant && oSelectionVariant.SelectOptions || [];

      var getUniqueEqValue = function(sFieldname) {
        for (var i = 0; i < aSelectOptions.length; i++) {
          var oSelectOption = aSelectOptions[i];
          if (oSelectOption.PropertyName === sFieldname) {
            if (oSelectOption.Ranges && oSelectOption.Ranges.length === 1) {
              var oFilter = oSelectOption.Ranges[0];
              if (oFilter.Sign === "I" && oFilter.Option === "EQ") {
                return oFilter.Low;
              }
            }
            break;
          }
        }
        return undefined;
      };

      // Transfer ProductCategory and Supplier if unique equality filters exist
      var vProductCategory = getUniqueEqValue("ProductCategory");
      if (vProductCategory !== undefined) {
        oRet.ProductCategory = vProductCategory;
      }

      var vSupplier = getUniqueEqValue("Supplier");
      if (vSupplier !== undefined) {
        oRet.Supplier = vSupplier;
      }

      return oRet;
    }
  };
});
```

**STEP**: 3 — Implement getPredefinedValuesForCreateExtension with DefaultValuesFunction fallback

**DESCRIPTION**: If you also use a DefaultValuesFunction, implement the two-parameter signature. If the filter bar does not provide a unique EQ value for a field, fall back to the value provided in oDefaultValues (if present). This example searches the filter bar first, then assigns defaults.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define([], function() {
  "use strict";
  return {
    /**
     * Called by the framework to obtain predefined values for the create dialog.
     * @param {sap.ui.comp.smartfilterbar.SmartFilterBar} oSmartFilterBar
     * @param {Object} [oDefaultValues] - values returned by the DefaultValuesFunction
     * @returns {Object} name-value map for fields to prefill
     */
    getPredefinedValuesForCreateExtension: function(oSmartFilterBar, oDefaultValues) {
      var oRet = {};
      if (!oSmartFilterBar || !oSmartFilterBar.getUiState) {
        // If no SmartFilterBar, use default values if provided
        return oDefaultValues ? Object.assign({}, oDefaultValues) : oRet;
      }

      var oSelectionVariant = oSmartFilterBar.getUiState().getSelectionVariant();
      var aSelectOptions = oSelectionVariant && oSelectionVariant.SelectOptions || [];

      var getUniqueEqValue = function(sFieldname) {
        for (var i = 0; i < aSelectOptions.length; i++) {
          var oSelectOption = aSelectOptions[i];
          if (oSelectOption.PropertyName === sFieldname) {
            if (oSelectOption.Ranges && oSelectOption.Ranges.length === 1) {
              var oFilter = oSelectOption.Ranges[0];
              if (oFilter.Sign === "I" && oFilter.Option === "EQ") {
                return oFilter.Low;
              }
            }
            break;
          }
        }
        return undefined;
      };

      // Fields to prefill - customize the list for your entity
      var aFields = ["ProductCategory", "Supplier"];

      aFields.forEach(function(sField) {
        var vValue = getUniqueEqValue(sField);
        if (vValue !== undefined) {
          oRet[sField] = vValue;
        } else if (oDefaultValues && Object.prototype.hasOwnProperty.call(oDefaultValues, sField)) {
          oRet[sField] = oDefaultValues[sField];
        }
      });

      return oRet;
    }
  };
});
```

**STEP**: 4 — Recommended constraints and i18n notes

**DESCRIPTION**: Use this approach only for fields that:
- are visible and editable on the object page, and
- cannot be changed through UI adaptation (to avoid saving values end users cannot view or change).

Do not change the "Create with Filters" label; the other menu item text comes from i18n key CREATE_NEW_OBJECT (default "Create Object") — consider customizing that key to a more specific label (for example "Create New Product").
--------------------------------

**TITLE**: SAP Fiori Elements — Prerequisites Checklist and Validation Examples (OData V4)

**INTRODUCTION**: Short, actionable checklist and code snippets to validate that a backend service and development environment meet SAP Fiori elements prerequisites for OData V4 apps. Use these steps to programmatically verify service capabilities (query options, draft support, value help), confirm tool support, and check system requirements before generating or running Fiori Elements UIs.

**TAGS**: fiori-elements-framework, odata-v4, sap-fiori, sap-fiori-tools, CAP, ABAP, OData, valuehelp, draft, system-requirements

STEP: 1 — Service topology and single-service constraint

DESCRIPTION: Ensure your Fiori Elements app uses a single OData service as the data source for all UI controls. Exceptions: KPI tags in analytical list pages and ValueHelp implementations via ValueListReference may reference other services. Validate conceptually and in your app configuration that only one main service is used.

LANGUAGE: PlainText

CODE:
```text
Checks:
- Confirm only one main OData service is configured in manifest.json / app descriptor.
- If ValueListReference or KPI tags need another service, ensure they are explicitly configured and documented.
- Example manifest.json "dataSources" should contain a single primary OData V4 service entry.
```

STEP: 2 — Validate required OData query options ($count, $skip, $top)

DESCRIPTION: SAP Fiori elements for OData V4 requires the service to support $count, $skip, and $top. Use HTTP requests to verify the service returns expected results and supports server-side paging and counting.

LANGUAGE: HTTP

CODE:
```http
# Fetch top 10 entities with count and skip 0
GET /sap/opu/odata/sap/YOUR_SERVICE/YourEntitySet?$count=true&$skip=0&$top=10
Host: <your-host>
Accept: application/json

# Expected: HTTP 200 with JSON including "@odata.count" and "value" array with up to $top entries.

# Verify that $skip works (e.g., skip first 10)
GET /sap/opu/odata/sap/YOUR_SERVICE/YourEntitySet?$count=true&$skip=10&$top=10
Accept: application/json
```

STEP: 3 — Check service metadata and draft capability (edit scenarios)

DESCRIPTION: Edit scenarios in Fiori Elements for OData V4 require a draft-enabled service. Validate draft support either by checking service metadata for draft annotations or by using CAP/ABAP-specific indicators. If using CAP, ensure @odata.draft.enabled is applied; if using RAP, ensure draft support is implemented. If your app uses edit features, reject non-draft services.

LANGUAGE: HTTP / XML

CODE:
```bash
# Retrieve service $metadata and inspect for draft-related entities/annotations
curl -s -u USER:PASS 'https://<host>/path/to/service/$metadata' -o metadata.xml
# Search metadata.xml for draft-related terms: "DraftAdministrativeData", "Capability.Terms", "DraftRoot", "Org.OData.Capabilities.V1.DraftSupport"
# Example (simplified) XML snippet to look for in metadata:
# <Annotation Term="Org.OData.Core.V1.DraftRoot">...</Annotation>

# CAP specific: check model or service definition for @odata.draft.enabled
# Example CAP CDS snippet to add in service:
# service CatalogService @(odata.draft.enabled: true) { entity Books as projection on Catalog.Books; }
```

STEP: 4 — Value Help (ValueListReference) and exceptions

DESCRIPTION: Value help back ends (ValueListReference) may be separate services but must also support required query options. For OData V4, ensure the referenced value help service supports $count, $skip, and $top. Use annotation examples to configure ValueListReference.

LANGUAGE: XML

CODE:
```xml
<!-- Example OData V4 annotation for ValueListReference (Edmx / Annotations) -->
<Annotations Target="MyService.MyEntity/MyProperty">
  <Annotation Term="Common.ValueListReference">
    <Record>
      <PropertyValue Property="CollectionPath" String="MyValueHelpSet"/>
    </Record>
  </Annotation>
</Annotations>

# Validate the value help entity set:
GET /path/to/valuehelp/service/MyValueHelpSet?$count=true&$skip=0&$top=20
Accept: application/json
```

STEP: 5 — Tooling: SAP Fiori tools and development environment

DESCRIPTION: Use SAP Fiori tools (VS Code or SAP Business Application Studio extensions) to develop Fiori Elements apps. Confirm your development environment has the required extensions installed. For edit scenarios, ensure the target service is draft-enabled (see Step 3).

LANGUAGE: PlainText

CODE:
```text
Recommended tools links:
- SAP Fiori tools: https://help.sap.com/viewer/product/SAP_FIORI_tools/Latest/en-US
- SAP Business Application Studio: https://help.sap.com/viewer/product/SAP%20Business%20Application%20Studio/Cloud/en-US

Developer actions:
- Install SAP Fiori tools extensions in VS Code or use Business Application Studio.
- In manifest.json choose the OData V4 service as the single primary dataSource.
- If using edit/draft features: verify draft support in the service before enabling draft-based templates.
```

STEP: 6 — Back end frameworks and security configuration

DESCRIPTION: Use appropriate backend frameworks and follow product-specific guides. CAP defaults to OData V4 but projects may need OData V2. If using CAP with Fiori Elements for OData V4, ensure backend security settings are compatible with your UI design and configuration. Follow product docs and security configuration reference.

LANGUAGE: PlainText

CODE:
```text
Backend documentation links:
- SAP S/4HANA (RAP): https://help.sap.com/viewer/fc4c71aa50014fd1b43721701471913d/latest/en-US
- SAP BTP ABAP Environment (RAP): https://help.sap.com/viewer/923180ddb98240829d935862025004d6/Cloud/en-US/289477a81eec4d4e84c0302fb6835035.html
- SAP Cloud Application Programming Model (CAP): https://cap.cloud.sap/docs/

Security reference (local doc):
- Security Configuration: security-configuration-ba0484b.md
Notes:
- CAP defaults to OData V4; fallback to OData V2 is sometimes required for legacy UIs.
- Validate authentication, Principal Propagation, and authorization models against UI needs.
```

STEP: 7 — System requirements and minimum versions

DESCRIPTION: Verify ABAP stack and other system prerequisites for draft and transactional apps. Confirm minimum ABAP NetWeaver and SP levels to support draft handling.

LANGUAGE: PlainText

CODE:
```text
System requirements:
- Development of transactional apps with draft capabilities requires:
  - ABAP Application Server: SAP NetWeaver AS for ABAP 7.51 innovation package SP02 or higher.
  - Draft capabilities are NOT available with SAP NetWeaver AS for ABAP 7.50.
- Recommended: use most up-to-date version; 7.5 SP01 or higher is suggested for general compatibility.

Related doc:
- Draft Handling: draft-handling-ed9aa41.md
```

STEP: 8 — Tutorials and hands-on examples

DESCRIPTION: Start with SAP developer tutorials demonstrating Fiori Tools + OData V4 scenarios (travel, incident). Use these for end-to-end examples including CAP services, metadata, and Fiori Elements templates.

LANGUAGE: PlainText

CODE:
```text
Tutorial links:
- Travel (Fiori tools + OData V4): https://developers.sap.com/group.fiori-tools-odata-v4-travel.html
- Incident (Fiori tools + OData V4): https://developers.sap.com/group.fiori-tools-odata-v4-incident.html

Developer tip:
- Follow a tutorial end-to-end to validate local toolchain, service capabilities ($metadata checks), and manifest.json configuration before generating production apps.
```
--------------------------------

**TITLE**: Progress Indicator Facet — Add a progress indicator to an Object Page header facet

**INTRODUCTION**: This document provides concise, code-focused instructions and complete annotation examples (XML, ABAP CDS, CAP CDS) to add a progress indicator to an Object Page header facet via UI.HeaderFacets -> UI.ReferenceFacet that points to a UI.DataPoint with Visualization = Progress. Includes unit-of-measure and footer annotation patterns and rendering rules required for correct behavior.

**TAGS**: fiori-elements, UI.HeaderFacets, UI.ReferenceFacet, UI.DataPoint, Progress, DataPoint, UoM, Common.Label, ABAP CDS, CAP CDS, XML

STEP: 1 — Add a ReferenceFacet to UI.HeaderFacets pointing to a DataPoint
DESCRIPTION: Add a record to UI.HeaderFacets of type UI.ReferenceFacet and set its Target to an AnnotationPath that references a UI.DataPoint qualifier (Visualization = Progress). This can be a direct DataPoint on the target entity or via a navigation path.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProjectType">
   <Annotation Term="UI.HeaderFacets">
      <Collection>
         <Record Type="UI.ReferenceFacet">
            <!-- If the DataPoint is on a navigated type use navigation path -->
            <PropertyValue Property="Target" AnnotationPath="to_ProgressType/@UI.DataPoint#Progress"/>
            <!-- Or, if DataPoint is on the same type: -->
            <!-- <PropertyValue Property="Target" AnnotationPath="@UI.DataPoint#Progress"/> -->
         </Record>
      </Collection>
   </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view STTA_C_MP_PROJECTTYPE with {
  @UI.Facet: [
    {
      targetQualifier: 'Progress',
      targetElement: 'TO_PROGRESSTYPE',     " navigation name to progress entity
      type: #DATAPOINT_REFERENCE,
      purpose: #HEADER
    }
  ]
  test;
}
```

LANGUAGE: CAP CDS
CODE:
```cql
annotate STTA_PROD_MAN.STTA_C_MP_ProjectType @(
  UI.HeaderFacets : [
    {
      $Type : 'UI.ReferenceFacet',
      Target : 'to_ProgressType/@UI.DataPoint#Progress'
    }
  ]
);
```

STEP: 2 — Create the UI.DataPoint (Qualifier = Progress)
DESCRIPTION: Annotate the entity type that contains the properties used by the DataPoint. The DataPoint must set Visualization = Progress. Title and Value are mandatory. Provide Description, TargetValue, Criticality as needed. Below are XML, ABAP CDS, CAP CDS patterns producing the DataPoint qualifier "Progress".
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProgressType">
   <Annotation Term="UI.DataPoint" Qualifier="Progress">
      <Record>
         <PropertyValue Property="Title" String="{@i18n>Title}"/>
         <PropertyValue Property="Description" String="{@i18n>SubTitle}"/>
         <PropertyValue Property="Value" Path="Progress"/>
         <PropertyValue Property="TargetValue" Decimal="150"/>
         <PropertyValue Property="Criticality" Path="Criticality"/>
         <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Progress"/>
      </Record>
   </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view STTA_C_MP_PROGRESSTYPE with {
  @UI.dataPoint: {
    title: '{@i18n>Title}',
    description: '{@i18n>SubTitle}',
    Value: Progress,                " property that holds the current value
    targetValue: 150,
    criticality: 'Criticality',
    visualization: #PROGRESS
  }
  progress;
}
```

LANGUAGE: CAP CDS
CODE:
```cql
annotate STTA_PROD_MAN.STTA_C_MP_ProgressType @(
  UI.DataPoint #Progress : {
    Title       : '{@i18n>Title}',
    Description : '{@i18n>SubTitle}',
    Value       : Progress,
    TargetValue : 150,
    Criticality : Criticality,
    Visualization: #Progress
  }
);
```

STEP: 3 — Annotate Unit of Measure (UoM) and Footer (Common.Label) on the Value property
DESCRIPTION: The DataPoint's Value property (e.g., Progress) must be annotated with a unit: either Measures.Unit or Measures.ISOCurrency. Annotate the same property with Common.Label to show footer text. Examples for both UoM types follow.
LANGUAGE: XML (Measures.Unit)
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProgressType/Value">
   <Annotation Term="Measures.Unit" Path="UoM"/>
   <Annotation Term="Common.Label" String="{@i18n>Footer}"/>
</Annotations>
```

LANGUAGE: ABAP CDS (Measures.Unit)
CODE:
```abap
@Semantics.unitOfMeasure: true
UoM;                    " unit property

@Semantics.quantity.unitOfMeasure: 'UoM'
Value;                  " value property annotated to use UoM
```

LANGUAGE: CAP CDS (Measures.Unit)
CODE:
```cql
annotate STTA_PROD_MAN.STTA_C_MP_ProgressType with {
  @Measures.Unit : UoM
  @Common.Label : '{@i18n>Footer}'
  Value
};
```

LANGUAGE: XML (Measures.ISOCurrency)
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProgressType/Value">
   <Annotation Term="Measures.ISOCurrency" Path="UoM"/>
   <Annotation Term="Common.Label" String="{@i18n>Footer}"/>
</Annotations>
```

LANGUAGE: ABAP CDS (Measures.ISOCurrency)
CODE:
```abap
@Semantics.currencyCode: true
UoM;

@Semantics.amount.currencyCode: 'UoM'
Value;
```

LANGUAGE: CAP CDS (Measures.ISOCurrency)
CODE:
```cql
annotate STTA_PROD_MAN.STTA_C_MP_ProgressType with {
  Measures.ISOCurrency : UoM
  @Common.Label : Footer
  Value
};
```

STEP: 4 — Rendering rules and required properties (must-follow checks)
DESCRIPTION: Rules the UI framework enforces when rendering the progress indicator. Implementations must adhere to these rules to guarantee correct visuals and behavior.
LANGUAGE: Text
CODE:
```
- Mandatory:
  - DataPoint.Title (Title) is required for header facet.
  - DataPoint.Value (Value) is required (progress cannot be calculated without it).
  - DataPoint.TargetValue is mandatory when:
      * Unit of measure (UoM) is not "%" (e.g., currency, PC, GB), or
      * No UoM is provided.

- Optional:
  - Unit of Measure (Measures.Unit or Measures.ISOCurrency)
  - Description (Subtitle)
  - Footer (Common.Label)

- Behavior:
  - If UoM == "%", Value is treated as an absolute percentage (no TargetValue division).
  - If UoM != "%" or is absent, Progress = Value / TargetValue (use TargetValue to compute percent).
  - Division by zero => progress shown as 0 (cannot be calculated).
  - If progress < 0 => no color appears in the bar (value still displayed).
  - If progress > 100% => bar is fully colored (value still displayed).
  - The numeric value is always displayed in the bar for special values (below 0 or above 100).

- Note:
  - "UI" is the alias for the vocabulary com.sap.vocabularies.UI.v1.
  - The DataPoint is attached via the ReferenceFacet.Target annotation path and referenced qualifier (e.g., #Progress).
```

STEP: 5 — Additional SAP Fiori Elements examples (V2 and V4 specifics)
DESCRIPTION: Additional compact examples for ABAP CDS (OData V2) and CAP CDS (OData V4) showing DataPoint annotations focused on Progress visualization.
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  title: '{@i18n>Title}',
  description: '{@i18n>SubTitle}',
  targetValue: 150,
  criticality: 'Criticality',
  visualization: #PROGRESS
}
ProjectProgress.Progress
```

LANGUAGE: CAP CDS
CODE:
```cql
@UI: DataPoint #Progress : {
    Value         : Progress,
    TargetValue   : 100,
    Title         : 'Progress',
    Visualization : #Progress
}
```
--------------------------------

**TITLE**: Make a key field editable in OData V2 draft applications using EditableFieldFor

**INTRODUCTION**: Use an additional non-key editable field that mirrors a key property during active state, and annotate it with com.sap.vocabularies.Common.v1.EditableFieldFor so SAP Fiori elements map navigation/filter parameters to the editable field while keeping the real key for navigation and identification. Applicable only for OData V2 draft-enabled apps and for existing databases where changing keys is not feasible.

**TAGS**: fiori-elements, OData V2, draft, annotations, EditableFieldFor, CAP, CDS, XML, navigation, filters

**STEP**: 1 — When to use this pattern
**DESCRIPTION**: Use this when:
- The app is OData V2 and uses draft handling.
- Existing database uses semantically meaningful key fields that must remain keys.
- Users must be allowed to change such key values in a draft without changing the draft identifier.
Implement by adding an auxiliary editable property (non-key) that:
- In active instances equals the key property.
- Is edited in drafts; backend logic copies it to the key on activation (so activation creates/updates the real keyed instance and navigation is handled automatically).
**LANGUAGE**: text
**CODE**:
```text
(No code) Requirements summary:
- Add an auxiliary non-key property to the entity (e.g., SalesOrderForEdit).
- Ensure backend logic copies SalesOrderForEdit -> SalesOrder on draft activation.
- Only display the auxiliary field in the UI; use the real key for navigation parameters.
```

**STEP**: 2 — Annotation purpose and behavior
**DESCRIPTION**: The annotation com.sap.vocabularies.Common.v1.EditableFieldFor tells Fiori elements to map navigation/filter parameters that use the key property to the annotated editable property. Use this when navigation parameters are not selective enough to directly resolve an object (e.g., list report -> object page navigation using filters).
**LANGUAGE**: text
**CODE**:
```text
Behavior:
- UI shows only the editable auxiliary field.
- Navigation/filter parameter uses the key property name.
- Fiori elements map incoming navigation parameter value to the auxiliary field using @Common.EditableFieldFor.
```

**STEP**: 3 — XML annotation example (OData V2 annotation XML)
**DESCRIPTION**: Add these annotations to your service annotations XML (e.g., annotations.xml). Replace target and PropertyPath values with your service, type and property names.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrderItem_WD_20Type/SalesOrderForEdit">
    <Annotation Term="com.sap.vocabularies.Common.v1.EditableFieldFor" PropertyPath="SalesOrder"/>
</Annotations>

<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrderItem_WD_20Type/SalesOrderItemForEdit">
    <Annotation Term="com.sap.vocabularies.Common.v1.EditableFieldFor" PropertyPath="SalesOrderItem"/>
</Annotations>
```

**STEP**: 4 — CAP CDS annotation example
**DESCRIPTION**: For CAP/CDS-based projects, annotate the CDS type fields with @Common.EditableFieldFor. Replace service/type names and property names accordingly.
**LANGUAGE**: CDS
**CODE**:
```c
annotate STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrderItem_WD_20Type with {
  @Common.EditableFieldFor : SalesOrder
  SalesOrderForEdit
};

annotate STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrderItem_WD_20Type with {
  @Common.EditableFieldFor : SalesOrderItem
  SalesOrderItemForEdit
};
```

**STEP**: 5 — UI and backend implementation notes (concise checklist)
**DESCRIPTION**: Implement these steps to complete the feature:
- Data model: add auxiliary non-key editable field (e.g., SalesOrderForEdit).
- Backend: on draft activation copy auxiliary -> real key (ensure DB operations preserve consistency and navigation).
- UI: show only the auxiliary field; hide the real key field.
- Navigation/filters: use the real key name as navigation parameter; ensure annotation maps it to the auxiliary field.
- Testing: verify draft edit changes only the auxiliary field; activation moves value to key and system navigates to the active instance.
**LANGUAGE**: text
**CODE**:
```text
Implementation checklist:
1. Add SalesOrderForEdit (non-key) to the entity.
2. Add @Common.EditableFieldFor (XML or CDS) pointing to SalesOrder.
3. Ensure draft logic copies SalesOrderForEdit -> SalesOrder on activation.
4. Configure UI to display SalesOrderForEdit and hide SalesOrder.
5. Ensure navigation uses SalesOrder as parameter; Fiori elements will map it via the annotation.
```
--------------------------------

**TITLE**: Quick View Card configuration for SAP Fiori Elements (HeaderInfo, Facets, Footer Actions)

**INTRODUCTION**: Instructions and code examples to configure Quick View Cards for Fiori Elements / SAP OVP. Shows how to set up com.sap.vocabularies.UI.v1.HeaderInfo and com.sap.vocabularies.UI.v1.Facets, how to tag summary fields with IsSummary, and how to wire annotationPath and identificationAnnotationPath in manifest.json. Also covers footer actions (DataFieldForAction and DataFieldForIntentBasedNavigation) and their rendering rules.

**TAGS**: fiori-elements, ovp, quick-view-card, annotations, manifest.json, HeaderInfo, Facets, Identification, IsSummary, DataFieldForAction, DataFieldForIntentBasedNavigation

STEP: 1 — Define HeaderInfo and Facets in your annotation file

DESCRIPTION: Create or update your OData annotations file (annotations.xml or annotations.cds / annotation JSON) to define HeaderInfo and Facets for the entity. Use HeaderInfo to configure TypeNamePlural, ImageUrl, Title, Description. Use Facets with referenceFacet and FieldGroup entries. Mark fields that should appear in the quick view content area with IsSummary on the referenceFacet FieldGroup items.

LANGUAGE: XML

CODE:
```xml
<!-- annotations.xml -->
<Annotations Target="YourService.YourEntityType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <!-- Header info: used for entity header (image, title, description, plural name) -->
  <Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeNamePlural" String="Business Partners"/>
      <PropertyValue Property="ImageUrl">
        <Record>
          <PropertyValue Property="Path" String="ImageUrl"/>
        </Record>
      </PropertyValue>
      <PropertyValue Property="Title">
        <Record>
          <PropertyValue Property="Path" String="Name"/>
        </Record>
      </PropertyValue>
      <PropertyValue Property="Description">
        <Record>
          <PropertyValue Property="Path" String="Description"/>
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>

  <!-- Facets: define detailed sections for quick view. Use referenceFacet to point to FieldGroups -->
  <Annotation Term="com.sap.vocabularies.UI.v1.Facets" Qualifier="QuickView">
    <Collection>
      <!-- Reference a FieldGroup and mark IsSummary=true to show in quick view content -->
      <Record Type="com.sap.vocabularies.UI.v1.ReferenceFacet">
        <PropertyValue Property="Label" String="Summary"/>
        <PropertyValue Property="Target">
          <Record Type="com.sap.vocabularies.UI.v1.Collection">
            <PropertyValue Property="Path" String="SummaryFieldGroup"/>
            <PropertyValue Property="IsSummary" Bool="true"/>
          </Record>
        </PropertyValue>
      </Record>

      <!-- Other facets can follow -->
    </Collection>
  </Annotation>

  <!-- Example FieldGroup definition referenced above -->
  <Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup" Qualifier="SummaryFieldGroup">
    <Record>
      <PropertyValue Property="Label" String="General Information"/>
      <PropertyValue Property="Data">
        <Collection>
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Value">
              <Record>
                <PropertyValue Property="Path" String="Name"/>
              </Record>
            </PropertyValue>
          </Record>
          <Record Type="com.sap.vocabularies.UI.v1.DataField">
            <PropertyValue Property="Value">
              <Record>
                <PropertyValue Property="Path" String="City"/>
              </Record>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 2 — Configure annotationPath for quick view cards in manifest.json (identificationAnnotationPath)

DESCRIPTION: In manifest.json under the sap.ovp.cards configuration, set identificationAnnotationPath to point to the Identification annotation qualifier (for actions in the footer). This wiring tells the card which Identification annotations (DataFieldForAction / DataFieldForIntentBasedNavigation) to use for footer actions.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card01": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.table",
        "settings": {
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#Qualifier1"
        }
      }
    }
  }
}
```

STEP: 3 — Configure annotationPath for object stream (quick view object stream facets) in manifest.json

DESCRIPTION: When using stack or object stream cards that open quick view cards in the object stream, set objectStreamCardsSettings.annotationPath (or similar property) to reference the Facets annotation qualifier you created. If annotationPath is not set, the unqualified com.sap.vocabularies.UI.v1.Facets will be used.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card00": {
        "model": "ZCD204_EPM_DEMO_SRV",
        "template": "sap.ovp.cards.stack",
        "settings": {
          "category": "{{card01_category}}",
          "entitySet": "BusinessPartners",
          "objectStreamCardsSettings": {
            "annotationPath": "com.sap.vocabularies.UI.v1.Facets#Qualifier2"
          }
        }
      }
    }
  }
}
```

STEP: 4 — Define footer actions in Identification annotations

DESCRIPTION: Add com.sap.vocabularies.UI.v1.Identification annotations for the entity and include DataFieldForIntentBasedNavigation and/or DataFieldForAction entries. The rendering rules:
- 0 actions: no footer displayed.
- 1 action: single button aligned to the right.
- 2 actions: buttons shown according to importance/order; recommend positive action left, negative right.
- >2 actions: an "Actions" button is shown; clicking opens an ActionSheet containing all actions in metadata order.
Actions defined here map to OData action requests; complex actions will open dialogs for parameters or confirmations.

LANGUAGE: XML

CODE:
```xml
<!-- Example Identification annotation with two actions -->
<Annotations Target="YourService.YourEntityType" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="com.sap.vocabularies.UI.v1.Identification" Qualifier="Qualifier1">
    <Record>
      <PropertyValue Property="Data">
        <Collection>
          <!-- Intent-based navigation -->
          <Record Type="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation">
            <PropertyValue Property="SemanticObject" String="Contact"/>
            <PropertyValue Property="Action" String="displayFactSheet"/>
            <PropertyValue Property="Inline" Bool="false"/>
            <PropertyValue Property="Label" String="Open Fact Sheet"/>
          </Record>

          <!-- OData action or function call -->
          <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
            <PropertyValue Property="Action" String="com.sap.Sample.ActionConfirm"/>
            <PropertyValue Property="Label" String="Confirm"/>
            <PropertyValue Property="Inline" Bool="false"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 5 — Rendering and UX specifics to keep in mind

DESCRIPTION: Implementation details to apply in code or tests:
- Footer buttons are rendered inside sap.m.OverflowToolbar; buttons are placed based on available width. Extra actions go into overflow.
- Quick view card height adapts to content. If content exceeds visible area, vertical scrolling happens only in the content area; header and footer remain fixed.
- OData actions invoked from footer follow the annotation mapping; ensure service supports called actions and parameters for dialog rendering.

LANGUAGE: Plain Text

CODE:
```text
- Footer controls use sap.m.OverflowToolbar for adaptive visibility and overflow handling.
- Mark summary fields with IsSummary=true on referenced FieldGroup inside com.sap.vocabularies.UI.v1.Facets to show them in the quick view content area.
- If annotationPath is omitted for Facets, the unqualified com.sap.vocabularies.UI.v1.Facets is used.
- For >2 actions, the UI shows a single "Actions" button which opens an ActionSheet listing actions in metadata order.
```
--------------------------------

**TITLE**: Quick Views — Configuration Examples (Currency and Supplier)

**INTRODUCTION**: This document provides actionable configuration examples to enable and customize Quick Views in SAP Fiori Elements (OData V2). It covers: (1) creating a referential constraint association in the EDMX so a currency quick view can be shown from a table column; (2) adding QuickViewFacet and FieldGroup annotations for Currency in XML, ABAP CDS and CAP CDS styles; (3) adding QuickView facets for Supplier with contact-type semantics (email, URL, phone) in XML and ABAP CDS. Use these snippets in your service metadata / external annotation files or CDS annotation files.

**TAGS**: fiori-elements-framework, quick-view, annotations, ODataV2, EDMX, CDS, CAP, ABAP

STEP: 1 — Add referential constraint association (EDMX / metadata)
DESCRIPTION: Add an Association with a ReferentialConstraint to the service metadata (EDMX or metadata.xml). This is required when the currency property has no referential constraint defined by the service—without it a Quick View for the currency may not resolve the target entity type.
LANGUAGE: XML
CODE:
```xml
<!-- Add this Association to your EDMX / metadata.xml -->
<Association Name="assoc_6D52161C1362D99A31996E5BB23202E8" sap:content-version="1">
    <End Type="STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType" Multiplicity="1" Role="FromRole_assoc_6D52161C1362D99A31996E5BB23202E8"/>
    <End Type="STTA_PROD_MAN.I_CurrencyType" Multiplicity="0..1" Role="ToRole_assoc_6D52161C1362D99A31996E5BB23202E8"/>
    <ReferentialConstraint>
        <Principal Role="FromRole_assoc_6D52161C1362D99A31996E5BB23202E8">
            <PropertyRef Name="Currency"/>
        </Principal>
        <Dependent Role="ToRole_assoc_6D52161C1362D99A31996E5BB23202E8">
            <PropertyRef Name="Currency"/>
        </Dependent>
    </ReferentialConstraint>
</Association>
```

STEP: 2a — Quick View facets for Currency (XML annotation)
DESCRIPTION: Annotate the Currency property of the product view with a semantic object, and define UI.QuickViewFacets + UI.FieldGroup on the I_CurrencyType entity. Place this in your OData annotation XML (external annotation file or inline annotations).
LANGUAGE: XML
CODE:
```xml
<!-- QuickViewFacets annotation for Currency -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType/Currency">
    <Annotation Term="Common.SemanticObject" String="EPMProduct"/>
</Annotations>

<Annotations Target="STTA_PROD_MAN.I_CurrencyType">
    <Annotation Term="UI.QuickViewFacets">
        <Collection>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#CurrencyQuickViewPOC_FieldGroup_1" />
            </Record>
        </Collection>
    </Annotation>

    <Annotation Term="UI.FieldGroup" Qualifier="CurrencyQuickViewPOC_FieldGroup_1">
        <Record>
            <PropertyValue Property="Data">
                <Collection>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Decimals" />
                        <PropertyValue Property="Value" Path="Decimals"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="CurrencyISOCode" />
                        <PropertyValue Property="Value" Path="CurrencyISOCode"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="AlternativeCurrencyKey" />
                        <PropertyValue Property="Value" Path="AlternativeCurrencyKey"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: 2b — Quick View facets for Currency (ABAP CDS annotation)
DESCRIPTION: If you use ABAP CDS views, annotate the product view's Currency property with @Consumption.semanticObject and define @UI.Facet and @UI.fieldGroup entries on the I_CURRENCYTYPE view using the same qualifier (CurrencyQuickViewPOC_FieldGroup_1).
LANGUAGE: ABAP CDS
CODE:
```abap
annotate view STTA_C_MP_PRODUCTSALESDATA with {
  @Consumption.semanticObject: 'EPMProduct'
  currency;
}

annotate view I_CURRENCYTYPE with {
  @UI.Facet: [
    {
      targetQualifier: 'CurrencyQuickViewPOC_FieldGroup_1',
      type: #FIELDGROUP_REFERENCE,
      purpose: #QUICK_VIEW
    }
  ]
  @UI.fieldGroup: [
    {
      label: 'Decimals',
      value: 'DECIMALS',
      type: #STANDARD,
      position: 1,
      qualifier: 'CurrencyQuickViewPOC_FieldGroup_1'
    }
  ]
  decimals;

  @UI.fieldGroup: [
    {
      label: 'CurrencyISOCode',
      value: 'CURRENCYISOCODE',
      type: #STANDARD,
      position: 2,
      qualifier: 'CurrencyQuickViewPOC_FieldGroup_1'
    }
  ]
  currencyisocode;

  @UI.fieldGroup: [
    {
      label: 'AlternativeCurrencyKey',
      value: 'ALTERNATIVECURRENCYKEY',
      type: #STANDARD,
      position: 3,
      qualifier: 'CurrencyQuickViewPOC_FieldGroup_1'
    }
  ]
  alternativecurrencykey;
}
```

STEP: 2c — Quick View facets for Currency (CAP CDS annotation)
DESCRIPTION: For CAP (CDS in CAP) projects, add @Common.SemanticObject to the product type's Currency property and add UI.QuickViewFacets and UI.FieldGroup on the I_CurrencyType. Use the FieldGroup qualifier CurrencyQuickViewPOC_FieldGroup_1.
LANGUAGE: CDS (CAP)
CODE:
```cdds
annotate STTA_PROD_MAN.STTA_C_MP_ProductSalesDataType with {
    @Common.SemanticObject : 'EPMProduct'
    Currency
};

annotate STTA_PROD_MAN.I_CURRENCYTYPE with @(
    UI.QuickViewFacets : [
        {
            $Type : 'UI.ReferenceFacet',
            Target : '@UI.FieldGroup#CurrencyQuickViewPOC_FieldGroup_1'
        }
    ],
    UI.FieldGroup #CurrencyQuickViewPOC_FieldGroup_1 : {
        Data : [
            {
                $Type : 'UI.DataField',
                Label : 'Decimals',
                Value : Decimals
            },
            {
                $Type : 'UI.DataField',
                Label : 'CurrencyISOCode',
                Value : CurrencyISOCode
            },
            {
                $Type : 'UI.DataField',
                Label : 'AlternativeCurrencyKey',
                Value : AlternativeCurrencyKey
            }
        ]
    }
);
```

STEP: 3a — Supplier Quick View facets (XML annotation) — contact-type semantics and field groups
DESCRIPTION: Use these XML annotations to mark email/URL/phone properties with correct semantics (IsEmailAddress / IsUrl / IsPhoneNumber) and define two field-group references for the supplier quick view. Place these in the OData annotation XML (add xmlns="http://docs.oasis-open.org/odata/ns/edm" where required).
LANGUAGE: XML
CODE:
```xml
<!-- QuickViewFacets annotation for Supplier (OData annotation XML) -->
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType/EmailAddress" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="com.sap.vocabularies.Communication.v1.IsEmailAddress" Bool="true"/>
</Annotations>

<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType/URL" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="Org.OData.Core.V1.IsUrl" Bool="true"/>
</Annotations>

<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType/PhoneNumber" xmlns="http://docs.oasis-open.org/odata/ns/edm">
    <Annotation Term="com.sap.vocabularies.Communication.v1.IsPhoneNumber" Bool="true"/>
</Annotations>

<Annotations Target="STTA_PROD_MAN.STTA_C_MP_SupplierType">
    <Annotation Term="UI.QuickViewFacets">
        <Collection>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SupplierQuickViewPOC_FieldGroup_1" />
            </Record>
            <Record Type="UI.ReferenceFacet">
                <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#SupplierQuickViewPOC_FieldGroup_2" />
            </Record>
        </Collection>
    </Annotation>

    <Annotation Term="UI.FieldGroup" Qualifier="SupplierQuickViewPOC_FieldGroup_1">
        <Record>
            <PropertyValue Property="Label" String="The first field group label" />
            <PropertyValue Property="Data">
                <Collection>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Supplier" />
                        <PropertyValue Property="Value" Path="Supplier"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Company Name" />
                        <PropertyValue Property="Value" Path="CompanyName"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Email Address" />
                        <PropertyValue Property="Value" Path="EmailAddress"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="to_Address / FormattedAddress" />
                        <PropertyValue Property="Value" Path="to_Address/FormattedAddress"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>

    <Annotation Term="UI.FieldGroup" Qualifier="SupplierQuickViewPOC_FieldGroup_2">
        <Record>
            <PropertyValue Property="Label" String="The second field group label" />
            <PropertyValue Property="Data">
                <Collection>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="Phone Number" />
                        <PropertyValue Property="Value" Path="PhoneNumber"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="URL" />
                        <PropertyValue Property="Value" Path="URL"/>
                    </Record>
                    <Record Type="UI.DataField">
                        <PropertyValue Property="Label" String="to_Address / AddressValidityStartDate" />
                        <PropertyValue Property="Value" Path="to_Address/AddressValidityStartDate"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: 3b — Supplier Quick View facets (ABAP CDS annotation)
DESCRIPTION: Annotate your STTA_C_MP_SUPPLIER view in ABAP CDS with @UI.Facet entries for two fieldgroup references and add @UI.fieldGroup and semantic annotations for email and telephone. Use qualifiers SupplierQuickViewPOC_FieldGroup_1 and SupplierQuickViewPOC_FieldGroup_2 to bind quick view facets to the field groups.
LANGUAGE: ABAP CDS
CODE:
```abap
annotate view STTA_C_MP_SUPPLIER with {
  @UI.Facet: [
    {
      targetQualifier: 'SupplierQuickViewPOC_FieldGroup_1',
      type: #FIELDGROUP_REFERENCE,
      purpose: #QUICK_VIEW
    },
    {
      targetQualifier: 'SupplierQuickViewPOC_FieldGroup_2',
      type: #FIELDGROUP_REFERENCE,
      purpose: #QUICK_VIEW
    }
  ]

  @UI.fieldGroup: [
    {
      label: 'Supplier',
      value: 'SUPPLIER',
      type: #STANDARD,
      position: 1,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_1',
      groupLabel: 'The first field group label'
    }
  ]
  supplier;

  @UI.fieldGroup: [
    {
      label: 'Company Name',
      value: 'COMPANYNAME',
      type: #STANDARD,
      position: 2,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_1'
    }
  ]
  companyname;

  @UI.fieldGroup: [
    {
      label: 'Email Address',
      value: 'EMAILADDRESS',
      type: #STANDARD,
      position: 3,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_1'
    }
  ]
  @Semantics: { eMail: { address: true, type: [ #PREF, #WORK ] } }
  emailaddress;

  @UI.fieldGroup: [
    {
      label: 'to_Address / FormattedAddress',
      value: 'TO_ADDRESS/FORMATTEDADDRESS',
      type: #STANDARD,
      position: 4,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_1'
    }
  ]
  to_address/formattedaddress;

  @UI.fieldGroup: [
    {
      label: 'Phone Number',
      value: 'PHONENUMBER',
      type: #STANDARD,
      position: 5,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_2'
    }
  ]
  @Semantics.telephone.type: #WORK
  phonenumber;

  @UI.fieldGroup: [
    {
      label: 'URL',
      value: 'URL',
      type: #STANDARD,
      position: 6,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_2'
    }
  ]
  url;

  @UI.fieldGroup: [
    {
      label: 'to_Address / AddressValidityStartDate',
      value: 'TO_ADDRESS/ADDRESSVALIDITYSTARTDATE',
      type: #STANDARD,
      position: 7,
      qualifier: 'SupplierQuickViewPOC_FieldGroup_2'
    }
  ]
  to_address/addressvaliditystartdate;
}
```
--------------------------------

**TITLE**: Radial Micro Chart — UI.Annotation Samples for Fiori Elements

**INTRODUCTION**: This document provides concise, copy-pasteable annotation examples and implementation requirements to render a Radial Micro Chart (donut) in Fiori Elements. It includes XML, ABAP CDS, and CAP CDS samples for the UI.Chart and UI.DataPoint annotations, plus mandatory and semantic-coloring rules. Use these directly in your metadata/annotations to enable a radial micro chart backed by a DataPoint.

**TAGS**: radial, microchart, donut, UI.Chart, UI.DataPoint, annotations, Fiori, CDS, CAP, ABAP, XML

STEP: 1 — Define UI.Chart (Radial/Donut) Annotation

DESCRIPTION: Add a UI.Chart annotation with ChartType = Donut, declare the measure(s) and the MeasureAttributes referencing a DataPoint. The Title and Description map to the chart title and subtitle. Use the provided qualifier to reference this chart from the UI or other annotations.

LANGUAGE: XML

CODE:
```xml
<!-- UI.Chart XML Annotation - Qualifier: SpecificationWidthRadialChart -->
<Annotation Term="UI.Chart" Qualifier="SpecificationWidthRadialChart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Product Width Specification"/>
        <PropertyValue Property="Description" String="No navigation with qualifier"/>
        <!-- Must be Donut for radial micro chart -->
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Donut"/>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>Width</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="Width"/>
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                    <!-- Link to a UI.DataPoint qualifier -->
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Width"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

LANGUAGE: ABAP

CODE:
```abap
" UI.Chart ABAP CDS Annotation - Qualifier: SpecificationWidthRadialChart
@UI.Chart: [
  {
    title: 'Product Width Specification',
    description: 'No navigation with qualifier',
    chartType: #DONUT,
    measures: [
      'WIDTH'
    ],
    measureAttributes: [
      {
        measure: 'Width',
        role: #AXIS_1,
        asDataPoint: true
      }
    ],
    qualifier: 'SpecificationWidthRadialChart'
  }
]
annotate view STTA_C_MP_PRODUCT with {
  // Additional annotations for the view go here
}
```

LANGUAGE: CDS

CODE:
```cds
// UI.Chart CAP CDS Annotation - Qualifier: #SpecificationWidthRadialChart
UI.Chart #SpecificationWidthRadialChart : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Product Width Specification',
    Description : 'No navigation with qualifier',
    ChartType : #Donut,
    Measures : [
        Width
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Width,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#Width'
        }
    ]
}
```

STEP: 2 — Define UI.DataPoint Annotation (Value, TargetValue, Criticality)

DESCRIPTION: Create a UI.DataPoint annotation that supplies the Value (required), optional TargetValue, and optional Criticality or CriticalityCalculation. Reference this DataPoint from UI.Chart → MeasureAttributes → DataPoint. The DataPoint Value must be a percentage-compatible numeric value. Note: unit labels are not rendered for radial micro charts.

LANGUAGE: XML

CODE:
```xml
<!-- UI.DataPoint XML Annotation - Qualifier: Width -->
<Annotation Term="UI.DataPoint" Qualifier="Width">
    <Record>
        <!-- Value is required -->
        <PropertyValue Property="Value" Path="Width"/>
        <!-- Optional target value -->
        <PropertyValue Property="TargetValue" Path="Weight"/>
        <!-- Optional semantic coloring by direct Criticality -->
        <PropertyValue Property="Criticality" Path="criticalityValue"/>
        <!-- Alternatively use CriticalityCalculation (see requirements step) -->
    </Record>
</Annotation>
```

LANGUAGE: ABAP

CODE:
```abap
" UI.DataPoint ABAP CDS snippet - attaching criticality
@UI.dataPoint: {
  criticality: 'criticalityValue'
}
Width;
```

LANGUAGE: CDS

CODE:
```cds
// UI.DataPoint CAP CDS Annotation - Qualifier: #Width
UI.DataPoint #Width : {
    Value : Width,
    TargetValue : Weight,
    Criticality : criticalityValue
}
```

STEP: 3 — Mandatory Annotations and Semantic Coloring Rules

DESCRIPTION: Apply these rules when implementing a radial micro chart. Use these as a checklist during code generation or validation.

LANGUAGE: TEXT

CODE:
```
Mandatory for Radial Micro Chart:
- UI.Chart:
  - ChartType must be "Donut".
  - Measures must include the field(s) representing the percentage value.
  - MeasureAttributes must include a DataPoint reference (AnnotationPath or asDataPoint).
- UI.DataPoint:
  - Value (required) must be provided and should be a percentage-compatible numeric field.

Semantic coloring:
- Supported annotations: UI.DataPoint -> Criticality OR UI.DataPoint -> CriticalityCalculation.
- If both Criticality and CriticalityCalculation are present, Criticality takes precedence (overrides CriticalityCalculation).
- If using CriticalityCalculation, also include CriticalityCalculation/ImprovementDirection.

UI/Rendering notes:
- Radial micro charts display percentage values; unit-of-measure labels are not rendered.
- The DataPoint used in MeasureAttributes should be qualified and referenced exactly (e.g., @UI.DataPoint#Width).
```

STEP: 4 — Implementation Tips for Code Generators

DESCRIPTION: Checklist for code generation tools or templates to produce valid radial micro chart annotations.

LANGUAGE: TEXT

CODE:
```
- Ensure ChartType is set to Donut in generated UI.Chart annotation.
- Emit MeasureAttributes with Role set to Axis1 (or appropriate role) and DataPoint pointing to a UI.DataPoint qualifier.
- Generate a UI.DataPoint qualifier that includes Value and optionally TargetValue and Criticality/CriticalityCalculation.
- If generating both Criticality and CriticalityCalculation, ensure Criticality is used to override.
- Avoid emitting unit-of-measure on the DataPoint or chart measure (units won't render).
- Keep qualifier names consistent across UI.Chart and UI.DataPoint (case-sensitive in annotation references).
```
--------------------------------

**TITLE**: Rating Indicator Facet — Object Page Header (Fiori Elements)

**INTRODUCTION**: How to add a read-only rating indicator to the Object Page header in SAP Fiori Elements. Covers aggregated and non-aggregated rating DataPoint configurations, how to set maximum stars, change the subtitle text, and examples for XML annotations, CAP CDS and ABAP CDS.

**TAGS**: fiori-elements-framework, rating, UI.DataPoint, UI.ReferenceFacet, annotations, CDS, XML, CAP, ABAP, ODataV4

**STEP**: 1 — Add a Rating Indicator Facet (XML annotation)
**DESCRIPTION**: Add a UI.ReferenceFacet to the entity UI.Facets that points to a UI.DataPoint with Visualization = Rating. Place this XML in your annotations file (e.g., annotations.xml or annotations/<Entity>.xml). This example shows a ReferenceFacet pointing to an Aggregated DataPoint qualifier.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- annotations.xml (or annotations/<Entity>.xml) -->
<Annotation Term="UI.Facets">
    <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Target" AnnotationPath="to_ProductRating/@UI.DataPoint#Aggregated" />
    </Record>
</Annotation>

<!-- Aggregated DataPoint qualifier referenced above -->
<Annotation Term="UI.DataPoint" Qualifier="Aggregated">
    <Record>
        <PropertyValue Property="Title" String="{@i18n>@ProductAverageRating}" />
        <PropertyValue Property="Value" Path="AverageRating" />
        <PropertyValue Property="TargetValue" Int="3" />
        <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Rating" />
        <PropertyValue Property="SampleSize" Path="ReviewCount" />
    </Record>
</Annotation>
```

**STEP**: 2 — Aggregated Rating (CAP CDS)
**DESCRIPTION**: CAP CDS example that defines a reference facet and the UI.DataPoint qualifier "Aggregated". Use this in your service CDS annotations (e.g., <service>.cds or annotations.cds).
**LANGUAGE**: CDS
**CODE**:
```cds
// annotations.cds (CAP-style)
UI.Facets : {
    $Type : 'UI.ReferenceFacet',
    Target : 'to_ProductRating/@UI.DataPoint#Aggregated'
},

UI.DataPoint #Aggregated : {
    Title : '{@i18n>@ProductAverageRating}',
    Value : AverageRating,
    TargetValue : 3,
    Visualization : #Rating,
    SampleSize : ReviewCount
}
```

**STEP**: 3 — Aggregated Rating (ABAP CDS / example placeholder)
**DESCRIPTION**: Example block from ABAP CDS context showing header-info and a target view annotation placeholder. Keep service/view names consistent with your model.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.headerInfo: {
  typeName: 'Sales Order',
  typeNamePlural: 'Sales Orders',
  title: {
    value: 'SO_ID',
    type: #STANDARD
  }
}
annotate view STTA_C_MP_PRODUCT with {

}
```

**STEP**: 4 — Add a Non-Aggregated Rating Facet (XML annotation)
**DESCRIPTION**: Reference a DataPoint qualifier for non-aggregated rating (e.g., user's own rating). Non-aggregated rating example with Description (used as subtitle) and targetValue bound to backend field.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Reference facet pointing to NonAggregated DataPoint qualifier -->
<Annotation Term="UI.Facets">
    <Record Type="UI.ReferenceFacet">
        <PropertyValue Property="Target" AnnotationPath="to_ProductRating/@UI.DataPoint#NonAggregated" />
    </Record>
</Annotation>

<!-- Non-aggregated DataPoint qualifier -->
<Annotation Term="UI.DataPoint" Qualifier="NonAggregated">
   <Record>
      <PropertyValue Property="Title" String="{@i18n>@ProductUserRating}" />
      <PropertyValue Property="Description" String="{@i18n>@MyRating}" />
      <PropertyValue Property="Value" Path="Rating" />
      <PropertyValue Property="TargetValue" Path="MaxRating" />
      <PropertyValue Property="Visualization" EnumMember="UI.VisualizationType/Rating" />
   </Record>
</Annotation>
```

**STEP**: 5 — Non-Aggregated Rating (ABAP CDS)
**DESCRIPTION**: ABAP CDS example that adds a facet reference to a data point qualifier and annotates the Rating field for display.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.facet: [
 {
  id:            'rating',
  type:          #DATAPOINT_REFERENCE,
  targetElement: '_ProductRating',
  targetQualifier: 'NonAggregated'
 }
]
product;

@UI.dataPoint: {
  title: '{@i18n>@ProductUserRating}',
  description: '@i18n>@MyRating}',
  targetValueElement: 'MaxRating',
  visualization: #RATING
}
Rating;
```

**STEP**: 6 — Non-Aggregated Rating (CAP CDS)
**DESCRIPTION**: CAP CDS example for a non-aggregated rating DataPoint qualifier where TargetValue is determined by a backend field.
**LANGUAGE**: CDS
**CODE**:
```cds
// annotations.cds (CAP-style)
UI.Facets : {
    $Type : 'UI.ReferenceFacet',
    Target : 'to_ProductRating/@UI.DataPoint#NonAggregated'
},

UI.DataPoint #NonAggregated : {
    Title : '{@i18n>@ProductUserRating}',
    Description : '@i18n>@MyRating}',
    Value : Rating,
    TargetValue : MaxRating,
    Visualization : #Rating
}
```

**STEP**: 7 — Set Maximum Number of Stars (options)
**DESCRIPTION**: Two ways to set the maximum number of stars (TargetValue): fixed constant in the DataPoint annotation, or bind TargetValue to a backend field (Path).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Fixed maximum number of stars (constant) -->
<PropertyValue Property="TargetValue" Int="5" />

<!-- Maximum number of stars determined by backend field -->
<PropertyValue Property="TargetValue" Path="MaxRating" />
```

**STEP**: 8 — Change the Subtitle / SampleSize vs Description
**DESCRIPTION**: - Aggregated rating: use SampleSize to display the number (e.g., ReviewCount) and annotate that property with Common.Label to change the trailing text (default is "ratings"). - Non-aggregated rating: set Description on UI.DataPoint to render the subtitle text.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Aggregated: SampleSize bound to ReviewCount -->
<PropertyValue Property="SampleSize" Path="ReviewCount" />

<!-- Annotate the ReviewCount property label (to change "ratings" to "user reviews") -->
<Property Name="ReviewCount">
    <Annotation Term="Common.Label" String="user reviews" />
</Property>

<!-- Non-aggregated: use Description as subtitle -->
<PropertyValue Property="Description" String="{@i18n>@MyRating}" />
```

**STEP**: 9 — Edit Mode Behavior (short)
**DESCRIPTION**: In Object Page Edit mode the rating indicator moves into the header facet and shows title only; aggregated ratings show the number of ratings in parentheses after the stars. The control remains read-only.
**LANGUAGE**: text
**CODE**:
```text
Edit mode: rating indicator moves to header facet, displays title only (aggregated: stars + (sampleSize)), remains read-only.
```

**STEP**: 10 — Additional Features: OData V4 CDS snippet
**DESCRIPTION**: OData V4 / CDS example showing a DataPoint definition with a floating TargetValue and Visualization #Rating.
**LANGUAGE**: CDS
**CODE**:
```cds
@UI: DataPoint #Rating : {
    Value         : Rating,
    TargetValue   : 5.0,
    Title         : 'Rating',
    Visualization : #Rating
}
```
--------------------------------

**TITLE**: Guidelines and Code Patterns for Extending a Generated SAP Fiori Elements App

**INTRODUCTION**: Practical, code-focused rules and examples for creating safe extensions to SAP Fiori elements apps. Covers view extensions, model usage, adding application-specific models, and calling function imports via the extensionAPI. Use these patterns to avoid interfering with template internals and to keep compatibility with future SAPUI5/Fiori elements versions.

**TAGS**: SAPUI5, SAP Fiori elements, extensionAPI, models, view-extension, OData, JavaScript, TypeScript, manifest.json

**STEP**: 1 — High-level rules and caution

**DESCRIPTION**: Follow these rules before adding any extension code. Use only the Fiori elements extensionAPI for interactions with the framework. Extension code becomes your application's responsibility; do not manipulate internal template objects or private models.

**LANGUAGE**: text

**CODE**:
```text
- Use extensions only when manifest settings, annotations, or configuration cannot achieve the required behavior.
- Use only the official extensionAPI for interactions with Fiori elements provided controls and system logic.
- Do NOT access or manipulate controls, models, properties, or internal objects created by Fiori elements beyond:
  - the default OData model (read/write with care),
  - the named "ui" model (read-only),
  - any model you attach yourself.
- Never access private Fiori elements models (they are internal and subject to change).
- Avoid using sap.ui.generic.app, sap.fe.navigation, or sap.ui.generic.template services directly from extension code.
```

**STEP**: 2 — Accessing controls inside your view extension

**DESCRIPTION**: Only access UI elements that you have created inside your view extension. Use element IDs from your extension view and standard API calls (this.byId, this.getView().byId). Do not query or manipulate template-owned controls.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// In a controller attached to your view extension
onInit: function () {
  // Access a control created inside the view extension by its local ID
  var oButton = this.byId("myExtensionButton"); // safe: element exists in your extension view
  if (oButton) {
    oButton.setVisible(true);
  }
},
onSomeAction: function () {
  // Do not use global selectors or traverse into template internals.
  // Bad: sap.ui.getCore().byId("templateControlId")  <-- avoid
}
```

**STEP**: 3 — Use of the default OData model

**DESCRIPTION**: The default model (configured in manifest.json) is typically the OData model. You may bind and read/write with it, but be careful: side effects (e.g., writes, batch behavior) can interfere with template logic. Prefer using the extensionAPI for actions that affect server-side state.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Access default OData model (configured in manifest.json)
var oModel = this.getView().getModel(); // default model: ODataModel
// Safe example: read-only binding usage or read requests via standard API
oModel.read("/SalesOrderSet('123')", {
  success: function (oData) { console.log("Read success", oData); },
  error: function (oErr) { console.error("Read error", oErr); }
});
// If you perform modifications, ensure you understand side effects on template behavior.
```

**STEP**: 4 — Using the "ui" model (read-only only)

**DESCRIPTION**: Each view has a named "ui" model containing UI state properties. You may read these properties in extensions but must not change them. Properties differ between OData V2 (enabled, editable, createMode) and OData V4 (editMode).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Read properties from the ui model
var oUiModel = this.getView().getModel("ui");
if (oUiModel) {
  // OData V2 example properties
  var bEnabled = oUiModel.getProperty("/enabled");     // boolean
  var bEditable = oUiModel.getProperty("/editable");   // boolean
  var bCreateMode = oUiModel.getProperty("/createMode"); // boolean

  // OData V4 example property
  var sEditMode = oUiModel.getProperty("/editMode");   // "Editable" or "Display"
}

// DO NOT set properties on the "ui" model
// Bad: oUiModel.setProperty("/enabled", false);  <-- forbidden
```

**STEP**: 5 — Do NOT access private Fiori elements models

**DESCRIPTION**: Fiori elements attaches private models to views for internal use. Accessing them is forbidden — they can change without notice. Only use the default model, "ui" model (read-only), or models you attach yourself.

**LANGUAGE**: text

**CODE**:
```text
Forbidden:
- Any access like this.getView().getModel("__internalModelName") or similar.
- Relying on internals from sap.ui.generic.template implementation.

Allowed:
- this.getView().getModel()     // default OData model
- this.getView().getModel("ui") // read-only ui model
- this.getView().getModel("your.namespace") // your own models
```

**STEP**: 6 — Attaching an application-specific JSON model (use a namespaced name)

**DESCRIPTION**: If you need a custom model, attach it to your extension scope. Prefer attaching to the extension view only. If you must attach to a larger scope (the whole view or component), use a clear namespaced name to avoid collisions.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Create and attach a JSON model to the extension view only
var oMyJson = new sap.ui.model.json.JSONModel({
  localState: { enabled: true, count: 0 }
});
this.getView().setModel(oMyJson, "com.mycompany.myExtensionModel");

// Accessing your model later
var oMyModel = this.getView().getModel("com.mycompany.myExtensionModel");
var oState = oMyModel.getProperty("/localState");

// If you must attach at view level (wider scope), still use a namespaced name:
this.getView().getModel("com.mycompany.myExtensionModel").setProperty("/localState/count", 5);
```

**STEP**: 7 — Calling function imports / actions: use extensionAPI.invokeActions

**DESCRIPTION**: For function imports or other actions that interact with server-side functions and that may be used also by the template, use the extensionAPI.invokeActions method (provided by Fiori elements). This avoids bypassing template logic and prevents conflicts.

Note: extensionAPI is made available to your extension controller by the framework. Use the extensionAPI rather than direct model function import calls when interacting with template-managed OData actions.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: call a function import via the extensionAPI
// 'extensionAPI' is provided by the framework in extension controllers
// The method signature depends on version; typical usage passes an action path and parameters.

var sFunctionImportPath = "/MyFunctionImport"; // function import path or action path
var mParameters = {
  // example parameters structure - adapt to your function import signature
  urlParameters: {
    Param1: "Value1",
    Param2: 123
  },
  success: function (oResult) { console.log("Function import success", oResult); },
  error: function (oError) { console.error("Function import error", oError); }
};

// Call function import using extensionAPI
if (this.extensionAPI && typeof this.extensionAPI.invokeActions === "function") {
  this.extensionAPI.invokeActions(sFunctionImportPath, mParameters);
} else {
  // Fallback: log and avoid direct OData function import calls that bypass template behavior
  console.error("extensionAPI.invokeActions is not available. Do not call function import directly.");
}
```

**STEP**: 8 — Summary of prohibited items and recommended alternatives

**DESCRIPTION**: Quick checklist to enforce safe extension coding.

**LANGUAGE**: text

**CODE**:
```text
Prohibited:
- Accessing or changing private Fiori elements models.
- Mutating the "ui" model properties.
- Accessing template-owned controls by global ID or by querying internals.
- Relying on sap.ui.generic.app or sap.ui.generic.template internal services.

Recommended:
- Use this.getView().getModel() for default OData model interactions, but prefer extensionAPI for server-side actions.
- Read (only) this.getView().getModel("ui") for UI state.
- Attach your own JSON models using a namespaced name, e.g. "com.mycompany.myModel".
- Use this.extensionAPI.invokeActions(...) for function imports/actions.
- Only manipulate controls you created inside your view extension using this.byId("...").
```

**STEP**: 9 — Reference points in project files

**DESCRIPTION**: Locations and artifacts relevant to extension development.

**LANGUAGE**: text

**CODE**:
```text
- manifest.json: Default OData model configuration lives here (check "models" and "dataSources").
- Extension view files: Your view extension XML/JS files (e.g., webapp/ext/MyExtension.view.xml, webapp/ext/MyExtension.controller.js)
- Controller extensions: Controller code for the extension where this.extensionAPI is available.
- Do not modify framework template files under sap/ui/generic/template or similar packages.
```
--------------------------------

**TITLE**: Rebind an Object Page Table on Every Instance Change (Fiori elements, OData V2)

**INTRODUCTION**: Procedure and code examples to force a subsection table on an Object Page to rebind every time the object page instance (binding context) changes. Applicable to SAP Fiori elements for OData V2. Key steps: set loadingBehavior in the manifest, attach the pageDataLoaded event in the controller extension, call extensionAPI.rebind(tableId), and optionally customize binding in onBeforeRebindTableExtension.

**TAGS**: fiori-elements-framework, SAPUI5, OData V2, object-page, table, extensionAPI, manifest, rebind

**STEP**: 1 — Update manifest: add loadingBehavior for the subsection containing the table

**DESCRIPTION**: In manifest.json, under the Object Page definition where the subsection that contains the table is declared, add a loadingBehavior object for that subsection. It is mandatory to set "waitForHeaderData": true to avoid duplicate batch calls. "waitForViewportEnter" is optional (true/false) based on your performance/UX requirement.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "sections": {
              "subsection1": {
                "loadingBehavior": {
                  "waitForHeaderData": true,
                  "waitForViewportEnter": true
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

**STEP**: 2 — Attach pageDataLoaded in your controller extension onInit

**DESCRIPTION**: In your extension controller (Controller Implementation - CI), attach to the pageDataLoaded event using the extensionAPI.attachPageDataLoaded method. Bind your rebind handler to ensure correct this context.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Controller Implementation (CI) for the Object Page extension
sap.ui.define([
  "sap/ui/base/Object"
], function(BaseObject) {
  "use strict";

  // Example: full table ID of the table to rebind
  var salesOrderItemTableId = "STTASOWD20::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20--SalesOrderItemsID::Table";

  return BaseObject.extend("STTASOWD20.ext.controller.CISalesOrder", {
    onInit: function(oController) {
      this.oController = oController;
      // Attach pageDataLoaded and bind the handler
      this.oController.extensionAPI.attachPageDataLoaded(this.rebindSalesorderItemTable.bind(this));
    },

    // Handler defined in STEP 3
    rebindSalesorderItemTable: function() {
      // implemented in STEP 3
    }

  });
});
```

**STEP**: 3 — Implement the rebind handler to call extensionAPI.rebind(tableId)

**DESCRIPTION**: In the handler you attached to pageDataLoaded, call extensionAPI.rebind with the table ID string to force rebinding of that specific table every time the page binding context changes.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
rebindSalesorderItemTable: function() {
  // Rebind the specific table when the page data is loaded (binding context changed)
  this.oController.extensionAPI.rebind(salesOrderItemTableId);
}
```

**STEP**: 4 — Optionally: customize the table binding before rebind (onBeforeRebindTableExtension)

**DESCRIPTION**: Implement onBeforeRebindTableExtension in the extension controller to add filters, sorters or modify binding parameters for a specific table. Verify the source table ID before modifying bindingParams as this hook is invoked for every table rebind.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
onBeforeRebindTableExtension: function(oEvent) {
  // Check the table ID so we only alter binding params for the specific table
  if (oEvent.getSource().getId() === salesOrderItemTableId) {
    // Example: add a filter to bindingParams
    // var Filter = sap.ui.model.Filter;
    // var FilterOperator = sap.ui.model.FilterOperator;
    // var filter = new Filter("so_item_pos", FilterOperator.GE, "1");
    // oEvent.mParameters.bindingParams.filters.push(filter);

    // You can also modify sorters, groupings, or other bindingParams here
  }
}
```
--------------------------------

**TITLE**: Reduce OData V2 Entity Sets via CDS Feature Toggle for SAP Fiori Elements

**INTRODUCTION**: Use a backend feature toggle to remove entity sets from the OData V2 service metadata so SAP Fiori elements UI (list report tabs, object page sections) automatically hides corresponding UI parts. Applicable only for SAP Fiori elements for OData V2.

**TAGS**: fiori-elements-framework, OData V2, CDS, feature-toggle, metadata, ABAP, UI

**STEP**: 1 — Add feature toggle annotation to the CDS view

**DESCRIPTION**: Place the feature toggle annotation on the CDS view that defines the entity. Replace Toggle_Name with your toggle ID. When the toggle is deactivated in the backend, the entity will be omitted from the generated OData metadata and thus hidden in Fiori elements applications.

**LANGUAGE**: CDS

**CODE**:
```CDS
@AbapCatalog.sqlViewName: 'ZMYVIEW'
@EndUserText.label: 'Sales Orders (conditional)'
@Feature: 'Toggle_SalesOrders'        // <-- Feature toggle name
define view Z_C_SalesOrder as select from sepm_sddl_so_header {
  key SalesOrder,
      SalesOrderType,
      TotalAmount
}
```

**STEP**: 2 — Create/Configure the feature toggle in the backend

**DESCRIPTION**: Create and manage the feature toggle in your backend (ABAP) feature management system according to your landscape conventions (e.g., using a feature toggle table, custom configuration transaction, or SAP's feature management solution). Ensure the toggle ID exactly matches the string used in the CDS annotation.

**LANGUAGE**: Text

**CODE**:
```text
- Feature toggle ID used in CDS: Toggle_SalesOrders
- Configure the toggle state (Activated / Deactivated) in the backend environment(s):
  - DEV: Activated (for development)
  - QAS: Activated or Deactivated (for testing)
  - PRD: Deactivated (to hide the entity in production)
- Implementation details depend on customer/system-specific feature-toggle mechanism.
```

**STEP**: 3 — Verify effect in OData metadata (before and after)

**DESCRIPTION**: Request the $metadata document for the OData V2 service to confirm the entity set is present (toggle activated) or removed (toggle deactivated). Use curl or browser to fetch service metadata.

**LANGUAGE**: bash

**CODE**:
```bash
# Fetch metadata (replace <SERVICE_NAME> and host details)
curl -u <user>:<pass> "https://<host>/sap/opu/odata/sap/<SERVICE_NAME>/$metadata" -o metadata.xml
```

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example snippet when the feature toggle is ACTIVATED (entity present) -->
<edmx:Edmx xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx" Version="1.0">
  ...
  <EntityContainer Name="ZMY_SRV_Entities">
    <EntitySet Name="ZC_SalesOrder" EntityType="ZMY_SRV.ZC_SalesOrder"/>
    <EntitySet Name="ZC_Customer"   EntityType="ZMY_SRV.ZC_Customer"/>
  </EntityContainer>
  ...
</edmx:Edmx>
```

```xml
<!-- Example snippet when the feature toggle is DEACTIVATED (entity removed) -->
<edmx:Edmx xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx" Version="1.0">
  ...
  <EntityContainer Name="ZMY_SRV_Entities">
    <!-- ZC_SalesOrder removed because @Feature:'Toggle_SalesOrders' is deactivated -->
    <EntitySet Name="ZC_Customer" EntityType="ZMY_SRV.ZC_Customer"/>
  </EntityContainer>
  ...
</edmx:Edmx>
```

**STEP**: 4 — Observe UI impact in Fiori elements

**DESCRIPTION**: When the entity set is removed from metadata:
- List report tab(s) bound to that entity set are removed.
- Object page sections bound to that entity are removed.
Check the application after metadata change; no additional UI code is required.

**LANGUAGE**: Text

**CODE**:
```text
- Expected UI behavior:
  - List Report with multiple tabs: Tabs corresponding to reduced entity sets disappear.
  - Object Page: Sections bound to reduced entities disappear.

- Reference images (for visual verification):
  - images/OP_with_all_tabs_when_feature_toggle_is_active_0ff5d08.png
  - images/OP_with_only_one_tab_when_other_related_entities_are_reduced_by_deactivating_the_toggle_42737b9.png
```

**STEP**: 5 — Testing and rollout checklist

**DESCRIPTION**: Validate toggle behavior across landscapes and ensure no leftover references cause runtime errors.

**LANGUAGE**: Text

**CODE**:
```text
- Test steps:
  1. Activate toggle -> fetch $metadata -> ensure EntitySet present.
  2. Deactivate toggle -> fetch $metadata -> ensure EntitySet absent.
  3. Run Fiori elements app against service -> verify tabs/sections are hidden when entity is absent.
  4. Check for stale manifest/navigation references to removed entity sets and remove/update if present.
- Notes:
  - Applies only to OData V2 services used by SAP Fiori elements.
  - Ensure toggle naming and backend configuration are consistent across environments.
```
--------------------------------

**TITLE**: Refreshing ALP Components with Component.refreshBinding()

**INTRODUCTION**: Use the Component.refreshBinding() API (defined in your app's Component.js) to refresh header, filter, and content areas in an Analytical List Page (ALP) built with SAP Fiori elements (OData V2) without reloading the browser. This retains filter selections and personalization (sorting, grouping) but clears the main chart selection — which can change table results if filter mode AutoHide is enabled.

**TAGS**: SAP, Fiori, ALP, refresh, refreshBinding, OData V2, controller-extension, Component.js

STEP: Applicability & effects
DESCRIPTION: When to use refreshBinding and what it does. Applicable only for SAP Fiori elements with OData V2. Refreshes header, filter, and content areas; retains filter selections and personalization settings; main chart selection is lost (may change table data when filter mode AutoHide is enabled).
LANGUAGE: Text
CODE:
```Text
Applicability:
- SAP Fiori elements (Analytical List Page) with OData V2 only.

Effects:
- Reloads data for header, filter and content areas.
- Retains: filter bar selections (compact/visual filter), personalization settings (sorting, grouping, etc.).
- Loses: main chart selection => may alter table data when filter mode AutoHide is on.
```

STEP: Location of API
DESCRIPTION: The API is implemented on the component instance. Ensure your application has a Component.js (root component) where the refreshBinding function is available.
LANGUAGE: Text
CODE:
```Text
File: Component.js
Path: <your-app-root>/webapp/Component.js

Ensure your Component.js exposes or inherits the refreshBinding method used by Fiori elements framework.
```

STEP: Call refreshBinding from a controller extension (JavaScript)
DESCRIPTION: Example: call refreshBinding directly from a controller extension method (e.g., in response to a button press). Use this.getOwnerComponent() to access the component instance and call refreshBinding().
LANGUAGE: JavaScript
CODE:
```JavaScript
// File: webapp/extension/ControllerExtension.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function(Controller) {
  "use strict";

  return Controller.extend("my.app.extension.ControllerExtension", {
    onRefreshPress: function() {
      // Get the owning component and call refreshBinding
      var component = this.getOwnerComponent();
      if (component && typeof component.refreshBinding === "function") {
        component.refreshBinding();
      } else {
        // Optional: error handling/logging
        jQuery.sap.log.error("refreshBinding is not available on the component");
      }
    }
  });
});
```

STEP: Call refreshBinding from an XML view via controller handler
DESCRIPTION: Add a button in an XML view to trigger the refresh handler implemented in the controller extension.
LANGUAGE: XML
CODE:
```XML
<!-- File: webapp/extension/SomeView.fragment.xml or View.xml -->
<Button text="Refresh"
        press=".onRefreshPress" />
```

STEP: TypeScript controller example
DESCRIPTION: If using TypeScript for controllers, same pattern applies. Ensure types account for optional refreshBinding.
LANGUAGE: TypeScript
CODE:
```TypeScript
// File: webapp/extension/ControllerExtension.controller.ts
import Controller from "sap/ui/core/mvc/Controller";

export default class ControllerExtension extends Controller {
  onRefreshPress(): void {
    const component: any = this.getOwnerComponent();
    if (component && typeof component.refreshBinding === "function") {
      component.refreshBinding();
    } else {
      // Optional: handle missing API
      console.error("refreshBinding not available on component");
    }
  }
}
```

STEP: Notes & troubleshooting
DESCRIPTION: Quick checks and warnings when using refreshBinding.
LANGUAGE: Text
CODE:
```Text
- Ensure your app targets OData V2 and uses Fiori elements ALP.
- refreshBinding is synchronous from the caller perspective but reloads the bound data asynchronously.
- Main chart selection is cleared during refresh; if your app logic depends on the chart selection, handle state persistence separately before calling refreshBinding.
- If table data changes unexpectedly, verify filter mode (AutoHide) and chart-to-table interactions.
```

STEP: Related documentation
DESCRIPTION: Link to deeper extension/configuration guidance for ALP apps.
LANGUAGE: Text
CODE:
```Text
See: Configuring Analytical List Page App Extensions
Link: configuring-analytical-list-page-app-extensions-9504fb4.md
```
--------------------------------

**TITLE**: Refresh Dataset on Back Navigation When sap-keep-alive = true

**INTRODUCTION**: When an app runs with sap-keep-alive = true, navigating away and back does not always trigger automatic data refresh. Use provided extension hooks to run custom logic that refreshes OData datasets when the app is suspended and later restored (back navigation). This document shows actionable code patterns for OData V2 and OData V4 in SAP Fiori Elements.

**TAGS**: fiori-elements-framework, sap-keep-alive, OData V2, OData V4, onLeaveAppExtension, onSuspend, onRestore, ControllerExtension, data-refresh, navigation

**STEP**: OData V2 — Use onLeaveAppExtension to return a reactivation function

**DESCRIPTION**: Implement the onLeaveAppExtension controller extension hook. Return a function that will be executed when the app is reactivated (back navigation). In that reactivation function, refresh the OData model or rebind specific controls (tables, lists). Replace "myTableId" with your control ID(s).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example placement: in your ObjectPage/ListReport controller extension
// Implement onLeaveAppExtension and return a reactivation function
onLeaveAppExtension: function (bIsDestroyed) {
    console.info("onLeaveAppExtension called! bIsDestroyed=", bIsDestroyed);

    var that = this;
    var fnReactivate = function () {
        // 1) Refresh the OData V2 model (force update)
        var oView = that.getView && that.getView();
        var oModel = oView && oView.getModel && oView.getModel();
        if (oModel && oModel.refresh) {
            // true forces refresh of bindings
            oModel.refresh(true);
        }

        // 2) Example: rebind or refresh a table/list binding by control ID
        var oTable = that.byId && that.byId("myTableId");
        if (oTable) {
            // for sap.m.Table / sap.ui.table.Table use appropriate binding name
            var oItemsBinding = oTable.getBinding("items") || oTable.getBinding("rows");
            if (oItemsBinding && oItemsBinding.refresh) {
                oItemsBinding.refresh();
            }
        }

        // 3) Optional user feedback
        if (sap && sap.m && sap.m.MessageToast && sap.m.MessageToast.show) {
            sap.m.MessageToast.show("Data refreshed on app restore");
        }
    };

    // Return the function; the framework invokes it when the app is reactivated
    return fnReactivate;
}

// Reference: API docs for onLeaveAppExtension
// https://ui5.sap.com/#/api/sap.suite.ui.generic.template.ObjectPage.controllerFrameworkExtensions
```

**STEP**: OData V4 — Implement ControllerExtension.override.viewState.onSuspend and onRestore

**DESCRIPTION**: For OData V4 + sap-keep-alive apps, implement onSuspend to run logic when the app is suspended and onRestore to refresh datasets when the app is restored. Use the onRestore hook to refresh the model or bindings (example shows common patterns). Replace control IDs and binding names according to your app (items, rows, or custom aggregation).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example controller extension file for a List Report (OData V4)
// Filename example: ext/ListReportExtension.js
return ControllerExtension.extend("SalesOrder.ext.LRExtend", {
    // override lifecycle hooks of the base controller
    override: {
        viewState: {
            onSuspend: function() {
                // Called when the app is suspended (navigating away)
                // Use to save transient state or pause background tasks
                // Example: console.info("App suspended");
            },
            onRestore: function() {
                // Called when the app is restored (back navigation)
                // Use to refresh data bindings or the OData V4 model

                var oView = this.getView && this.getView();
                if (!oView) {
                    return;
                }

                // 1) Refresh model (if supported)
                var oModel = oView.getModel && oView.getModel();
                if (oModel && oModel.refresh) {
                    // For many models, refresh() triggers re-read of data
                    try {
                        oModel.refresh();
                    } catch (e) {
                        // graceful fallback if model.refresh is not present
                        console.warn("Model refresh failed or not supported:", e);
                    }
                }

                // 2) Refresh specific table/list bindings by control ID
                var oTable = this.byId && this.byId("myTableId");
                if (oTable) {
                    // Try common binding names: rows (sap.ui.table.Table) or items (sap.m.Table/List)
                    var oBinding = oTable.getBinding("rows") || oTable.getBinding("items");
                    if (oBinding && oBinding.refresh) {
                        oBinding.refresh();
                    }
                }

                // 3) Optional: show a toast on restore
                if (sap && sap.m && sap.m.MessageToast && sap.m.MessageToast.show) {
                    sap.m.MessageToast.show("onRestore: data refreshed");
                }
            }
        }
    }
});
```
--------------------------------

**TITLE**: Configure Entity Set Refresh for sap-keep-alive Mode (OData V2 & V4)

**INTRODUCTION**: Short, code-focused guide to configure which OData entity sets are refreshed when an SAP Fiori Elements application is reactivated by the Fiori launchpad in sap-keep-alive mode. Includes manifest.json patterns for OData V2 and V4, extension API usage, and important runtime notes (ETag, parameterized entities, Create navigation behavior).

**TAGS**: fiori-elements-framework, sap-keep-alive, manifest.json, sap.ui.generic.app, sap.app, refreshStrategyOnAppRestore, odata, V2, V4, extension-api

STEP: Supported refresh options
DESCRIPTION: Define refresh behavior for each entity set using either "self" or "includingDependents". "includingDependents" refreshes dependent navigation entities only if there is a UI control bound to those child entities.
LANGUAGE: JSON
CODE:
```JSON
{
  "refreshStrategyOnAppRestore": {
    "entitySets": {
      "EntitySet1": "self",
      "EntitySet2": "includingDependents"
    }
  }
}
```

STEP: OData V2 — Override default chevron navigation refresh (ObjectPage -> outbound mapping)
DESCRIPTION: For ObjectPage chevron (navigation) you can override or disable the default refresh by configuring navigation.display with a target outbound and refreshStrategyOnAppRestore under the ObjectPage settings. Place this in manifest.json under sap.ui.generic.app.pages -> ListReport|<ListReportEntitySet> -> pages -> ObjectPage|<ObjectPageEntitySet>.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|<ListReportEntitySet>": {
        "pages": {
          "ObjectPage|<ObjectPageEntitySet>": {
            "navigation": {
              "display": {
                "path": "sap.apps.crossNavigation.outbounds",
                "target": "<OutboundTarget>",
                "refreshStrategyOnAppRestore": {
                  "entitySets": {
                    "<EntitySetToRefresh>": "self",
                    "<AnotherEntitySetToRefresh>": "includingDependents"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V2 — Default and per-outbound refresh strategies (externalNavigationSettings)
DESCRIPTION: Define default refresh behavior for all outbound navigation or customize per-outbound. Place under sap.ui.generic.app.settings.externalNavigationSettings in manifest.json. If entitySets is empty => disables refresh for that outbound/default.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.app": {
    "crossNavigation": {
      "outbounds": {
        "<OutboundTarget1>": { "semanticObject": "<SemanticObject1>", "action": "<Action1>" },
        "<OutboundTarget2>": { "semanticObject": "<SemanticObject2>", "action": "<Action2>" }
      }
    }
  },
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "externalNavigationSettings": {
        "defaultOutboundSettings": {
          "refreshStrategyOnAppRestore": {
            "entitySets": {
              "<EntitySetToRefresh>": "self",
              "<AnotherEntitySetToRefresh>": "includingDependents"
            }
          }
        },
        "outbounds": {
          "<OutboundTarget1>": {
            "refreshStrategyOnAppRestore": {
              "entitySets": {
                "<EntitySetToRefresh>": "self"
              }
            }
          },
          "<OutboundTarget2>": {
            "refreshStrategyOnAppRestore": {
              "entitySets": {
                "<EntitySetToRefresh>": "includingDependents"
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Use extension API to navigate externally (navigateExternal) and respect outbound refresh settings
DESCRIPTION: Use the extensionAPI navigation controller to navigate externally. The outbound target passed to navigateExternal will determine which entitySets are refreshed on app restore (configured under sap.app.crossNavigation.outbounds and sap.ui.generic.app.settings.externalNavigationSettings.outbounds.<OutboundTarget>.refreshStrategyOnAppRestore).
LANGUAGE: JavaScript
CODE:
```JavaScript
// In an extension controller / extension class
onListNavigationExtension: function (oEvent) {
    var oNavigationController = this.extensionAPI.getNavigationController();
    // Pass the outbound target ID (as defined in sap.app.crossNavigation.outbounds)
    oNavigationController.navigateExternal("<OutboundTarget>");
    return true;
}
```

STEP: Reuse component / extension view — setRefreshBehaviour before navigation
DESCRIPTION: In a reuse component's startup (stStart) or similar hook, bind the "before navigation" link callback to setRefreshBehaviour so that back navigation triggers refresh according to the provided entity set name.
LANGUAGE: JavaScript
CODE:
```JavaScript
// Example stStart in a reuse component
stStart: function(oModel, oBindingContext, oExtensionAPI) {
    var oComponentModel = this.getComponentModel();
    var oBinding = oComponentModel.bindProperty("/state");
    oBinding.attachChange(function(){
        oExtensionAPI.onCustomStateChange();
        this.setMessage();
    }.bind(this));
    this.adaptToBindingContext(oBindingContext);

    // Example: get link from popover and set beforeNavigationCallback
    var oNavPopOverLink = this.getRootControl().getContent()[0].getContent()[7];
    var oNavigationController = oExtensionAPI.getNavigationController();

    // setRefreshBehaviour accepts an entity set name (e.g., "EPMSalesOrder")
    oNavPopOverLink.setBeforeNavigationCallback(
        oNavigationController.setRefreshBehaviour.bind(null, "EPMSalesOrder")
    );
},
```

STEP: OData V4 — routing targets: intents + defaultBehavior precedence
DESCRIPTION: For OData V4, specify refreshStrategyOnAppRestore per routing target. The precedence is: exact semanticObject-action intent -> same semanticObject intent -> page-level defaultBehavior. Use "intents" for intent-specific mappings and "defaultBehavior" for fallback.
LANGUAGE: JSON
CODE:
```JSON
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "type": "Component",
          "id": "SalesOrderManageList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "refreshStrategyOnAppRestore": {
                "defaultBehavior": {
                  "SalesOrderManage": "self"
                }
              }
            }
          }
        },
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "refreshStrategyOnAppRestore": {
                "intents": {
                  "v4Freestyle": {
                    "SalesOrderItem": "includingDependents"
                  },
                  "v4Freestyle-Inbound": {
                    "SalesOrderItem": "includingDependents"
                  }
                },
                "defaultBehavior": {
                  "SalesOrderManage/_Item": "includingDependents"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: OData V4 — disable default chevron refresh using empty intent block
DESCRIPTION: To switch off the default chevron refresh for a specific intent / semanticObject, add an empty object for that intent under "intents". Create cases (external Create) are not affected — Create still triggers table entitySet refresh by default.
LANGUAGE: JSON
CODE:
```JSON
{
  "refreshStrategyOnAppRestore": {
    "intents": {
      "v4Freestyle-Inbound": {
        "SalesOrderItem": "includingDependents"
      },
      "v4Freestyle": { } // empty => no refresh for other intents from this semantic object (disables default chevron refresh)
    }
  }
}
```

STEP: Important runtime notes and manifest conventions
DESCRIPTION: Keep these rules when authoring manifest configs and backend:
LANGUAGE: text
CODE:
```
- "includingDependents" refreshes child navigation entity data only if a UI control is bound to that child navigation entity.
- External Create navigation: table entity set is refreshed on return (cannot be overridden in Fiori Elements for OData V2).
- External Chevron navigation: default table refresh can be overridden or disabled via manifest configuration (see above).
- Other external navigations (including extension APIs) do NOT refresh by default; configure refreshStrategyOnAppRestore for specific outbound or defaultOutboundSettings.
- Navigation using navigateExternal: the outbound target passed determines which refreshStrategyOnAppRestore is applied.
- If backend is NOT ETag-enabled and List Report table is refreshed in Flexible Column Layout (FCL) mode, refresh will be triggered for all dependents of the table's entity set. To avoid broad refresh, enable ETag support in the backend.
- For parameterized/containment-based entities where you must specify the full context path, begin the manifest entitySet key with a forward slash (e.g., "/Customer/Set"). For regular entity sets do not include the leading slash (e.g., "SalesOrderItem").
- After returning from external target, the refresh strategy controls only the data refresh on that page; normal forward internal navigation still triggers backend requests as usual.
```

STEP: File references
DESCRIPTION: Files and manifest locations to edit when implementing the above:
LANGUAGE: text
CODE:
```
- manifest.json
  - sap.app.crossNavigation.outbounds
  - sap.ui.generic.app.settings.externalNavigationSettings (V2)
  - sap.ui.generic.app.pages.<ListReport|EntitySet>.pages.<ObjectPage|EntitySet>.navigation.display (V2)
  - sap.ui5.routing.targets.<Target>.options.settings.refreshStrategyOnAppRestore (V4)
- Extension controllers or reuse component files (e.g., Component.js, extension controller .js)
  - Use this.extensionAPI.getNavigationController().navigateExternal("<OutboundTarget>")
  - Use oNavigationController.setRefreshBehaviour("<EntitySetName>") in beforeNavigationCallback for reuse component links
```
--------------------------------

**TITLE**: Configure Entity-Set Refresh on App Restore (sap-keep-alive) for Overview Pages

**INTRODUCTION**: Configure which OData entity sets are refreshed automatically when an overview page view is restored from the Fiori launchpad view cache (sap-keep-alive). Add a mapping under sap.ovp.refreshStrategyOnAppRestore.entitySets in manifest.json so that cards and UI elements reflect changes made while the user navigated to other apps.

**TAGS**: fiori-elements-framework, SAPUI5, sap-keep-alive, manifest.json, OVP, overview-pages, refresh, entitySet

**STEP**: 1 — Locate manifest.json and sap.ovp section

**DESCRIPTION**: Open your application's manifest.json (project root). Find or create the top-level "sap.ovp" section. This is where the refreshStrategyOnAppRestore configuration is placed.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters",
    "globalFilterEntitySet": "ZFilterEntitySet",
    "smartVariantRequired": true,
    "enableLiveFilter": true,
    "containerLayout": "resizable"
    /* add refreshStrategyOnAppRestore here */
  }
}
```

**STEP**: 2 — Add refreshStrategyOnAppRestore.entitySets mapping

**DESCRIPTION**: Under "sap.ovp", add the "refreshStrategyOnAppRestore" object with an "entitySets" mapping. Keys are the entity set names (exact OData entitySet names). Values are the refresh strategy token "self" to indicate that this entity set should be refreshed when the view is restored from the cache (sap-keep-alive).

Replace "<EntitySetName>" with your real entity set name (for example "SalesOrders" or "Products").

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "refreshStrategyOnAppRestore": {
      "entitySets": {
        "SalesOrders": "self"
      }
    }
  }
}
```

**STEP**: 3 — Example: multiple entity sets

**DESCRIPTION**: Configure multiple entity sets to refresh by adding additional key/value pairs. Each entity set maps to "self". All entries are evaluated when the application view is restored.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "refreshStrategyOnAppRestore": {
      "entitySets": {
        "SalesOrders": "self",
        "Products": "self",
        "ZFilterEntitySet": "self"
      }
    }
  }
}
```

**STEP**: 4 — Full minimal manifest snippet (context)

**DESCRIPTION**: Example showing the refreshStrategyOnAppRestore placed together with other common sap.ovp settings. Use this as a drop-in snippet inside your manifest.json "sap.ovp" section.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters",
    "globalFilterEntitySet": "ZFilterEntitySet",
    "smartVariantRequired": true,
    "enableLiveFilter": true,
    "containerLayout": "resizable",
    "refreshStrategyOnAppRestore": {
      "entitySets": {
        "SalesOrders": "self",
        "Products": "self"
      }
    },
    "cards": {
      /* your cards config */
    }
  }
}
```

**STEP**: 5 — Notes and compatibility reminders

**DESCRIPTION**: 
- "globalFilterEntityType" is deprecated; "globalFilterEntitySet" is available since SAPUI5 1.54.
- The keys under entitySets must match your OData entity set names.
- The token "self" instructs the framework to refresh that specific entity set when the overview page view is restored from the launchpad cache (sap-keep-alive).
--------------------------------

**TITLE**: Replacing the Standard Save Functionality in the Mass Edit Dialog

**INTRODUCTION**: Shows how to replace the framework's default save behavior for mass-edit dialogs in SAP Fiori Elements. Implement an extension function in your list report or controller extension to run custom save logic. For OData V2 you implement beforeMultiEditSaveExtension (return a Promise); for OData V4 you implement editFlow.customMassEditSave (async function that returns true to suppress default). The framework will perform cleanup (e.g., close dialog) after your extension completes (V2) or when you choose to suppress the default (V4).

**TAGS**: fiori-elements-framework, mass-edit, mass-edit-dialog, odata-v2, odata-v4, controller-extension, custom-save, sapui5

**STEP**: 1 — OData V2: Implement beforeMultiEditSaveExtension

**DESCRIPTION**: Add a beforeMultiEditSaveExtension function in your list report or controller extension. The function receives an array of update descriptors (aContextsToBeUpdated). Each item contains:
- sContextPath — the context path for the entity to be updated
- oUpdateData — an object mapping property paths to new values

Return a Promise that resolves/rejects after your custom save action completes. Call the framework's extensionAPI.invokeActions with your function import (service action) to perform the server-side updates. The framework performs cleanup after your Promise resolves.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Add this to your list report or controller extension
beforeMultiEditSaveExtension: function (aContextsToBeUpdated) {
    // aContextsToBeUpdated - Array of update descriptors
    // aContextsToBeUpdated[].sContextPath - Context path for the entity to update
    // aContextsToBeUpdated[].oUpdateData - Object with the updated values for selected properties

    var oApi = this.extensionAPI;

    // Return a Promise so the framework waits for completion
    return new Promise(function (fnResolve, fnReject) {
        // Replace the function import path below with your service action/function import
        var oPromise = oApi.invokeActions(
            "STTA_SALES_ORDER_ND_SRV_01/STTA_C_SO_SalesOrder_NDSetopportunityid",
            [],                       // action parameters (if any)
            aContextsToBeUpdated      // payload: contexts + update data
        );

        // Resolve/reject the outer Promise based on the invoked action result
        oPromise.then(fnResolve).catch(fnReject);
    });
}
```

**STEP**: 2 — OData V4: Implement editFlow.customMassEditSave

**DESCRIPTION**: In a controller extension (sap.ui.define + ControllerExtension), override editFlow.customMassEditSave. The function receives aParameters with:
- aParameters.aContexts — array of selected binding contexts
- aParameters.oUpdateData — dictionary with propertyPath -> updated value

Perform your custom save (e.g., call this.base.editFlow.invokeAction). If you return true from customMassEditSave, the framework's default mass-edit save will NOT be executed. Returning false/undefined lets the framework perform the default behavior. Use async/await to simplify error handling.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
sap.ui.define(
    [
        "sap/ui/core/mvc/ControllerExtension",
        "sap/m/MessageToast"
    ],
    function (ControllerExtension, MessageToast) {
        "use strict";

        return ControllerExtension.extend("your.namespace.YourExtension", {
            override: {
                editFlow: {
                    /**
                     * Custom mass-edit save handler for OData V4.
                     * @param {object} aParameters - { aContexts: [], oUpdateData: {} }
                     * @returns {Promise<boolean>|boolean} return true to prevent default save
                     */
                    customMassEditSave: async function (aParameters) {
                        try {
                            // Execute the custom save action (replace "Service.customUpdateAction" with your action)
                            await this.base.editFlow.invokeAction("Service.customUpdateAction", {
                                contexts: aParameters.aContexts,
                                parameterValues: aParameters.oUpdateData
                            });

                            // Return true to prevent framework default save behavior
                            return true;
                        } catch (e) {
                            // Handle error and surface message to the user
                            MessageToast.show(e.toString());
                            // Returning true prevents default; adjust if you want default to run on error
                            return true;
                        }
                    }
                }
            }
        });
    }
);
```

**STEP**: 3 — Behavior Notes and Integration Tips

**DESCRIPTION**: Combined operational notes:
- Implement either extension in the list report or controller extension files (where other controller extensions reside).
- For OData V2: return a Promise from beforeMultiEditSaveExtension; the framework performs dialog cleanup after the Promise resolves.
- For OData V4: return true from customMassEditSave to suppress the framework default; return false/undefined to allow default mass-edit save.
- Replace example function import/action names with your actual service action/function import names.
- Propagate errors to the UI (MessageToast or other mechanism) and ensure your Promise resolves/rejects appropriately so the framework can continue cleanup.

**LANGUAGE**: N/A

**CODE**:
```text
Related information:
- Enabling Editing Using a Dialog (Mass Edit): enabling-editing-using-a-dialog-mass-edit-965ef5b.md
```
--------------------------------

**TITLE**: Responsiveness Options for SAP Fiori elements — com.sap.vocabularies.UI.v1.Importance

**INTRODUCTION**: This document shows how to control which fields are rendered on phone/tablet/desktop by setting the OData UI annotation com.sap.vocabularies.UI.v1.Importance. It includes a concrete annotation XML example and the manifest.json snippet to register the local annotations file in a Fiori elements app.

**TAGS**: fiori-elements-framework, annotations, UI.Importance, responsiveness, OData, manifest, sap.fiori

**STEP**: 1 — Add Importance annotations to an annotations XML file

**DESCRIPTION**: Create an OData annotation XML file (for example webapp/annotations/annotations.xml) and set the Importance annotation per property. Use the fully qualified target "Namespace.EntityType/Property". High/Medium/Low values are specified with EnumMember values under com.sap.vocabularies.UI.v1.ImportanceType.

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" Version="4.0">
  <edmx:Reference Uri="http://docs.oasis-open.org/odata-vocabularies/v1/odata-common-vocabularies.xml">
    <edmx:Include Namespace="com.sap.vocabularies.UI.v1" Alias="UI"/>
  </edmx:Reference>

  <edmx:DataServices>
    <!-- Example: annotate properties of EntityType "Books" in service namespace "YourService" -->
    <Annotations Target="YourService.Books/Title">
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance"
                  EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/High" />
    </Annotations>

    <Annotations Target="YourService.Books/Author">
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance"
                  EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/Medium" />
    </Annotations>

    <Annotations Target="YourService.Books/ISBN">
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance"
                  EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/Low" />
    </Annotations>
  </edmx:DataServices>
</edmx:Edmx>
```

**STEP**: 2 — Place the annotation file in the project

**DESCRIPTION**: Put the annotations file in your Fiori elements project, for example under webapp/annotations/annotations.xml. Ensure the path matches the manifest.json reference.

**LANGUAGE**: text

**CODE**:
```
File path: webapp/annotations/annotations.xml
```

**STEP**: 3 — Register the local annotations file in manifest.json

**DESCRIPTION**: Reference the annotations XML file in the app manifest so the Fiori elements runtime loads them. Add the annotations entry under the OData data source settings and point the model to that dataSource.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/YOUR_SERVICE_SRV/",
        "type": "OData",
        "settings": {
          "annotations": [
            {
              "uri": "annotations/annotations.xml"
            }
          ]
        }
      }
    }
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      }
    }
  }
}
```

**STEP**: 4 — How Importance values map to devices (rendering rules)

**DESCRIPTION**: Use this mapping to decide which Importance to assign to properties depending on where they should appear.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "mobile": ["High"],
  "tablet": ["High", "Medium"],
  "desktop": ["High", "Medium", "Low"]
}
```

**STEP**: 5 — Quick verification

**DESCRIPTION**: After deploying the app, test on different viewport sizes or devices to confirm:
- Only High importance fields are shown on mobile.
- High + Medium appear on tablet.
- High + Medium + Low appear on desktop.

**LANGUAGE**: text

**CODE**:
```
Manual test steps:
1. Build and run the Fiori elements app.
2. Open the page with a toolbar (List Report table, Object Page table, Smart Chart toolbar).
3. Verify displayed fields on narrow (mobile), medium (tablet), and wide (desktop) viewports.
```
--------------------------------

**TITLE**: SAP Fiori Elements — Feature Map (Developer Quick Reference & Code Examples)

**INTRODUCTION**: This concise developer reference maps SAP Fiori Elements UI features to the actionable configuration/extension patterns you will use in code (manifest, CDS annotations, view/controller extensions, and micro frontend building blocks). Each step contains (1) what to do, (2) direct doc links (preserved file paths), (3) relevant tags/manifest keys/annotations, and (4) minimal code templates you can paste and adapt.

**TAGS**: fiori-elements, manifest.json, annotations, extension-points, building-blocks, OData-V2, OData-V4, cards, tables, filterbar, charts, actions, flexible-programming-model

STEP: Extending SAP Fiori Elements-Based Apps (Extension Points)
DESCRIPTION: Add or override UI fragments, views, or controller logic using view/controller extension points. Use manifest viewExtensions and controllerExtensions for app-specific extensions. See:
- Extending Generated Apps: extending-generated-apps-using-app-extensions-340cdb2.md
- List Report & Object Page extensions: extending-list-reports-and-object-pages-using-app-extensions-a892eb8.md
- Extension points for tables: extension-points-for-tables-d525522.md
- Canvas page extension: extending-apps-using-a-canvas-page-82c4b57.md
LANGUAGE: JSON / JavaScript
CODE:
```JSON
// manifest.json — view extension example (register a fragment in a specific extension point)
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.fe.templates.ListReport.view.ListReport": {
            "SomeListReportExtensionPoint": {
              "className": "my.custom.Extension",
              "fragment": "my.app.ext.fragments.CustomHeader"
            }
          }
        },
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ObjectPage.view.ObjectPage": {
            "ControllerExtension": {
              "controllerName": "my.app.ext.controllers.ObjectPageExtension"
            }
          }
        }
      }
    }
  }
}
```
```javascript
// Controller extension (webapp/ext/controllers/ObjectPageExtension.controller.js)
sap.ui.define(["sap/ui/core/mvc/Controller"], function(Controller) {
  return Controller.extend("my.app.ext.controllers.ObjectPageExtension", {
    onInit: function() {
      // custom init logic
    },
    onBeforeSave: function(oEvent) {
      // hook into save flow (example)
    }
  });
});
```

STEP: Add Column / Custom Column to a Table
DESCRIPTION: Configure UI.LineItem annotations or use extension points to add columns. For runtime-manifest-based table configuration use the settings for the table or table-specific view fragments. See:
- Defining Line Items: defining-line-items-f0e1e17.md
- Extension Points for Tables: extension-points-for-tables-d525522.md
- Table Cards: table-cards-167bf7c.md
- Table type/config: setting-the-table-type-7f844f1.md
LANGUAGE: CDS / JSON
CODE:
```CDS
// CDS annotation (add field to UI.LineItem)
entity SalesOrder {
  key SalesOrderID : String;
  CustomerName       : String;
  NetAmount          : Decimal(15,2);
  @UI.lineItem: [
    { position: 10, label: 'Sales Order', value: SalesOrderID },
    { position: 20, label: 'Customer', value: CustomerName },
    { position: 30, label: 'Net Amount', value: NetAmount, importance: #High }
  ]
}
```
```JSON
// manifest.json — enable add column UI settings for a list report table (example)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrder",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "tableSettings": {
              "type": "ResponsiveTable",
              "enableExport": true
            }
          }
        }
      }
    ]
  }
}
```

STEP: Configuring Tables & Table Types (Responsive / Analytical / Grid / Tree)
DESCRIPTION: Choose table type in manifest/page settings and annotate line items. Use table-specific docs for ALV (Analytical Table), Grid Table and Tree Table. See:
- Configuring Tables: configuring-tables-f4eb70f.md
- Setting the Table Type: setting-the-table-type-7f844f1.md
- Tree table example: example-adding-columns-to-a-tree-table-in-the-list-report-b903da5.md
LANGUAGE: JSON
CODE:
```JSON
// manifest.json — set table type for a List Report page
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "tableSettings": {
              "type": "TreeTable",     // options: ResponsiveTable, GridTable, AnalyticalTable, TreeTable
              "stickyColumns": 1,
              "enableExport": true
            }
          }
        }
      }
    ]
  }
}
```

STEP: Filter Bar, Filter Fields, Semantic Date Ranges & Value Help
DESCRIPTION: Configure the Smart FilterBar, visual filters, default filter values, semantic date ranges, and value help modes. Use FilterRestrictions, SelectionVariant and parameterized entities if needed. Docs:
- Smart Filter Bar: ../10_More_About_Controls/smart-filter-bar-7bcdffc.md
- Enabling Semantic Operators: enabling-semantic-operators-in-the-filter-bar-fef65d0.md
- Value Help as Dropdown: value-help-as-a-dropdown-list-2a0a630.md
- Configuring the Global Filter: configuring-the-global-filter-73d9693.md
LANGUAGE: JSON / CDS
CODE:
```JSON
// manifest.json — FilterBar settings + useSemanticDateRange example
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrder",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "filterSettings": {
              "useSemanticDateRange": true,
              "filterDefaults": {
                "SalesOrder/CreatedDate": "P30D" // example prefill using ISO period
              }
            }
          }
        }
      }
    ]
  }
}
```
```CDS
// CDS : define a value help annotation for a field (ValueList)
element CustomerID : String @(Common.ValueListWithFixedValues: [{Value: 'C1', Text: 'Cust 1'}]);
```

STEP: Actions, Buttons and Action Parameter Dialogs (Default values, placement)
DESCRIPTION: Define annotation-based actions, parameter dialogs, default values, and custom placements (header, table toolbar, footer). Use DataFieldForAction, DefaultValuesFunction and action parameter prefill. See:
- Actions: actions-cbf16c5.md
- DefaultValues for action parameters: actions-cbf16c5.md#DefaultValuesActionParameters
- Prefill using DefaultValuesFunction: prefilling-fields-using-the-defaultvaluesfunction-5ada91c.md
LANGUAGE: CDS / JSON
CODE:
```CDS
// CDS — Unbound action with parameter and default value via annotation example
action ConfirmOrder(inOrderId: String) returns Boolean;

annotate ConfirmOrder with {
  @UI: {
    isAction: true,
    parameterDialog: { // conceptual example - actual UI binding via OData annotations
      prefill: true
    }
  }
};
```
```JSON
// manifest.json — place actions and control placement example
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrder",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "actions": {
              "DeterminingActions": {
                "placement": "FooterToolbar" // header, table, footer toolbar, etc.
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: Cards & Overview Page (Add/Manage/Custom/Coloring/Resizing)
DESCRIPTION: Configure Overview page cards, including analytical, list, table, chart, link, stack and custom cards. Enable Add Card to Insights and coloring of cards based on thresholds. See:
- Creating Cards: creating-custom-cards-6d260f7.md
- Configuring overview manifest: configuring-the-manifest-for-the-overview-page-f194b41.md
- Coloring cards: coloring-cards-based-on-threshold-values-02c53f4.md
- Creating cards for Insights: creating-cards-for-the-insights-cards-section-of-my-home-in-sap-s-4hana-cloud-public-edit-9b13559.md
LANGUAGE: JSON
CODE:
```JSON
// manifest.json — overview page runtime capabilities example (card registration)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "pageType": "OverviewPage",
        "component": {
          "name": "sap.ovp",
          "settings": {
            "cards": {
              "MyCard": {
                "model": "mainModel",
                "template": "sap.ovp.cards.charts.analytical",
                "settings": {
                  "title": "Revenue",
                  "chartType": "Donut",
                  "colorThresholds": [
                    { "threshold": 80, "color": "Good" },
                    { "threshold": 50, "color": "Critical" }
                  ]
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: Charts & Micro Charts (Smart Chart, MicroChart facets, visual filters)
DESCRIPTION: Use Smart Chart / MicroChart building blocks in object/list pages, add micro charts to table facets, and configure chart-only view defaults. See:
- Configuring Charts: configuring-charts-653ed0f.md
- Micro Chart Facet: micro-chart-facet-e219fd0.md
- Adding a micro chart to a table: adding-a-micro-chart-to-a-table-b8312a4.md
LANGUAGE: JSON / CDS
CODE:
```CDS
// CDS — annotate a field for micro chart facet
annotate Product with {
  @UI.facet: [{ id: "SalesMicroChart", label: "Sales Trend", position: 10 }]
}
```
```JSON
// manifest.json — configure default chart-only view
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage",
          "settings": {
            "defaultVisualization": "Chart"
          }
        }
      }
    ]
  }
}
```

STEP: Building Blocks (OData V4 / Flexible Programming Model)
DESCRIPTION: Use modular building blocks (Field, Form, Table, FilterBar, Chart, MicroChart, Page, Paginator, VariantManagement, Status, Share, TreeTable, RichTextEditor, MessageButton, ConditionalSwitch, FlexibleColumnLayoutActions) for OData V4 Flexible Programming Model implementations. See:
- Building Blocks overview: building-blocks-24c1304.md
- Flexible Programming Model: flexible-programming-model-549749b.md
LANGUAGE: JSON / XML
CODE:
```JSON
// manifest.json — page using a building block macro (example concept)
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Product",
        "component": {
          "name": "sap.fe.templates.ObjectPage",
          "settings": {
            "buildingBlocks": {
              "Header": {
                "type": "Page",
                "settings": {
                  "title": "{Product/Name}"
                }
              },
              "TableBB": {
                "type": "Table",
                "settings": {
                  "tableType": "ResponsiveTable"
                }
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: Variant Management, Personalization & P13n Dialogs
DESCRIPTION: Enable variant management and table personalization for views; configure quickVariantSelection and p13n dialog support. See:
- Managing Variants: managing-variants-8ce658e.md
- Enabling Table Personalization: enabling-table-personalization-3e2b4d2.md
- P13n Dialog: https://experience.sap.com/fiori-design-web/p13n-dialog/
LANGUAGE: JSON
CODE:
```JSON
// manifest.json — enable variant management and personalization
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrder",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "variantManagement": true,
            "tableSettings": {
              "personalization": { "enabled": true }
            },
            "quickVariantSelection": {
              "variants": {
                "MyListView": { "label": "My View", "key": "MyListView" }
              }
            }
          }
        }
      }
    ]
  }
}
```

STEP: Draft Handling, Save Hooks and Keep-Alive
DESCRIPTION: Enable draft handling, adapt onBeforeSave hooks and sap-keep-alive caching mode for back navigation. See:
- Draft Handling: draft-handling-ed9aa41.md
- Adapting logic before save: adapting-logic-before-save-operation-6a0a050.md
- sap-keep-alive refresh: refresh-entity-sets-in-sap-keep-alive-mode-3c65f2c.md
LANGUAGE: JSON / JavaScript
CODE:
```JSON
// manifest.json — enable draft and keep-alive (conceptual)
{
  "sap.ui.generic.app": {
    "settings": {
      "detailedPages": {
        "ProductObjectPage": {
          "mode": "Draft",
          "sap-keep-alive": true
        }
      }
    }
  }
}
```
```javascript
// example controller hook naming (extension controller)
onBeforeSave: function(oEvent) {
  // validate or modify payload before save
}
```

STEP: Messages, Message Popover, Toasts and Confirmation Dialogs
DESCRIPTION: Use standard Messages API and annotations for server-side messages, show MessagePopover, MessageToast, and custom confirmation popups. See:
- Using Messages: using-messages-239b192.md
- Confirmation popups: confirmation-popups-9a53662.md
- Adding confirmation popovers for actions: adding-confirmation-popovers-for-actions-87130de.md
LANGUAGE: JavaScript
CODE:
```javascript
// UI5 usage: show message toast
sap.m.MessageToast.show("Saved successfully");

// Show message popover (controller snippet)
var oMessagePopover = this.getView().byId("msgPopover");
oMessagePopover.openBy(oSomeButton);
```

STEP: Quick Views, Smart Link & Contact Quick View
DESCRIPTION: Enable Quick View cards and quick view behavior for smart links and table entries. See:
- Quick View Cards: quick-view-cards-c4bd35e.md
- Enabling Quick Views for Link Navigation: enabling-quick-views-for-link-navigation-307ced1.md
- Adding a contact quick view to a table: adding-a-contact-quick-view-to-a-table-677fbde.md
LANGUAGE: CDS / JSON
CODE:
```CDS
// CDS — annotation for smart link quick view (illustrative)
annotate Communication.Contact with {
  @UI.quickInfo: { label: 'Contact Quick View' }
};
```

STEP: Export, Copy/Paste & Excel Integration
DESCRIPTION: Enable export to spreadsheet and allow copy/paste from Excel to table controls. See:
- Using the Export Button: using-the-export-button-4bab6f2.md
- Copying and pasting from external apps to tables: copying-and-pasting-from-external-applications-to-tables-f6a8fd2.md
LANGUAGE: JSON
CODE:
```JSON
// manifest.json — enable export on a page's table settings
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrder",
        "component": {
          "settings": {
            "tableSettings": {
              "enableExport": true
            }
          }
        }
      }
    ]
  }
}
```

STEP: Search, Navigation, Deep Links & Internal Navigation
DESCRIPTION: Configure search and navigation including preferredMode for object pages and internal navigation handlers. See:
- Enabling the Search Function: enabling-the-search-function-3cdebee.md
- Configuring Navigation: configuring-navigation-a424275.md
- Handling preferredMode parameter: handling-of-the-preferredmode-parameter-bfaf3cc.md
LANGUAGE: JSON
CODE:
```JSON
// manifest.json — enable search and preferredMode deep link example
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrder",
        "component": {
          "settings": {
            "search": { "enabled": true },
            "navigation": {
              "SalesOrderObjectPage": { "preferredMode": "Edit" }
            }
          }
        }
      }
    ]
  }
}
```

STEP: Useful Doc References (Preserved paths for deeper reading)
DESCRIPTION: Quick access to the original topic files for each feature (use these for complete examples and platform-specific details).
- Extending Generated Apps Using App Extensions: extending-generated-apps-using-app-extensions-340cdb2.md
- Extending List Reports and Object Pages Using App Extensions: extending-list-reports-and-object-pages-using-app-extensions-a892eb8.md
- Configuring Tables: configuring-tables-f4eb70f.md
- Defining Line Items: defining-line-items-f0e1e17.md
- Micro Chart Facet: micro-chart-facet-e219fd0.md
- Configuring Charts: configuring-charts-653ed0f.md
- Creating Custom Cards: creating-custom-cards-6d260f7.md
- Building Blocks: building-blocks-24c1304.md
- Flexible Programming Model: flexible-programming-model-549749b.md
- Value Help as Dropdown List: value-help-as-a-dropdown-list-2a0a630.md
- Actions: actions-cbf16c5.md
- Draft Handling: draft-handling-ed9aa41.md
- Using Messages: using-messages-239b192.md
- Many more: consult the Feature Map table rows for direct file names (e.g., table-cards-167bf7c.md, enabling-table-personalization-3e2b4d2.md, visual-filters-1714720.md)


--------------------------------

**TITLE**: SAP Fiori Elements Learning Resources Index (Tutorials, Courses, Blogs)

**INTRODUCTION**: Centralized, actionable index of official SAP Fiori Elements tutorials, courses, and blog posts. Use these links to follow step‑by‑step tutorials, enroll in learning journeys, or find blog-based examples and references while developing or extending Fiori Elements apps.

**TAGS**: fiori-elements-framework, SAP, Fiori, tutorials, courses, blogs, OData, CAP, RAP, ABAP, CDS

**STEP**: 1 — Official Tutorials (Action)
**DESCRIPTION**: Open and follow the step‑by‑step guided tutorials to scaffold and implement SAP Fiori Elements apps (OData V4, RAP, List Report/Object Page, mockserver & OPA testing, and adaptation projects). Each tutorial contains prerequisites, sample code, and run/debug instructions — use them as the primary recipe for building sample apps.
**LANGUAGE**: bash
**CODE**:
```bash
# macOS - open tutorial pages in default browser
open "https://developers.sap.com/group.fiori-tools-odata-v4-travel.html"
open "https://developers.sap.com/group.fiori-tools-odata-v4-incident.html"
open "https://developers.sap.com/group.fiori-tools-lrop.html"
open "https://developers.sap.com/group.fiori-elements-mockserver-opa.html"
open "https://developers.sap.com/group.sapui5-adaptation-projects.html"

# Linux - open with xdg-open
xdg-open "https://developers.sap.com/group.fiori-tools-odata-v4-travel.html"
xdg-open "https://developers.sap.com/group.fiori-tools-odata-v4-incident.html"
xdg-open "https://developers.sap.com/group.fiori-tools-lrop.html"
xdg-open "https://developers.sap.com/group.fiori-elements-mockserver-opa.html"
xdg-open "https://developers.sap.com/group.sapui5-adaptation-projects.html"

# Windows (PowerShell)
Start-Process "https://developers.sap.com/group.fiori-tools-odata-v4-travel.html"
Start-Process "https://developers.sap.com/group.fiori-tools-odata-v4-incident.html"
Start-Process "https://developers.sap.com/group.fiori-tools-lrop.html"
Start-Process "https://developers.sap.com/group.fiori-elements-mockserver-opa.html"
Start-Process "https://developers.sap.com/group.sapui5-adaptation-projects.html"
```

**STEP**: 2 — Courses and Learning Journeys (Action)
**DESCRIPTION**: Enroll or follow the structured courses and learning journeys to acquire end-to-end knowledge for developing and extending Fiori Elements apps (CAP OData V4, RAP services, and general extension patterns).
**LANGUAGE**: bash
**CODE**:
```bash
# Open course pages
open "https://learning.sap.com/courses/developing-and-extending-sap-fiori-elements-apps"
open "https://learning.sap.com/learning-journeys/developing-an-sap-fiori-elements-app-based-on-a-cap-odata-v4-service"
open "https://learning.sap.com/learning-journeys/getting-started-with-creating-an-sap-fiori-elements-app-based-on-an-odata-v4-rap-service"
```

**STEP**: 3 — Blogs and Community Articles (Action + Search)
**DESCRIPTION**: Use blog posts for examples, deep dives, and annotation patterns. If links are stale, search the SAP Community blog index or use the tag index. Examples below show direct blog links and how to search the SAP Community.
**LANGUAGE**: bash
**CODE**:
```bash
# Direct blog links
open "https://blogs.sap.com/tags/ed5c1ef6-932f-4c19-b2ba-1be375109ff5/"
open "https://blogs.sap.com/2021/12/07/the-sap-fiori-elements-feature-showcase-with-cap-cds-annotations/"
open "https://blogs.sap.com/2022/12/19/the-sap-fiori-elements-feature-showcase-with-rap-and-abap-cds-annotations/"

# Construct a search query on SAP Community (URL encode query)
SEARCH_QUERY="Fiori+Elements+annotations"
open "https://community.sap.com/search?q=${SEARCH_QUERY}"

# Fetch search results with curl (non-interactive)
curl -G "https://community.sap.com/search" --data-urlencode "q=Fiori Elements annotations"
```

**STEP**: 4 — Quick Local Workflow Template (Use after following a tutorial)
**DESCRIPTION**: Generic local workflow to clone a sample project from a tutorial, install dependencies, and run the app or mockserver. Replace placeholders with repository or sample folder names referenced in the chosen tutorial.
**LANGUAGE**: bash
**CODE**:
```bash
# Clone the sample repository referenced by a tutorial
git clone <repo-url.git> my-fiori-sample
cd my-fiori-sample

# Install dependencies and run
npm install
# If the tutorial provides a mockserver or specific start script, run it. Common examples:
npm run start        # serves the UI app
npm run mockserver   # starts the OData mockserver (if provided)

# If the tutorial includes test automation (OPA), run tests:
npm run test:integration
```

**STEP**: 5 — Practical Tips for Code Generation & Extension
**DESCRIPTION**: When automating or generating Fiori Elements projects, follow these steps: open the tutorial, identify scaffold/generator/manifest examples, use the tutorial's sample repository as a starting point, and adapt CDS/OData annotations or manifest.json settings per the tutorial guidance. Use the blog posts for annotation patterns (CAP CDS or ABAP CDS) and RAP scenarios.
**LANGUAGE**: text
**CODE**:
```text
- Read the tutorial prerequisites (tools, Node.js, SAP CLI, BAS or VS Code setup).
- Use the tutorial sample repository as a seed; search for manifest.json, webapp/, and local mockserver scripts.
- Apply CDS/OData annotation examples from the blogs:
  * CAP CDS annotations: follow the CAP example in the "feature showcase with CAP CDS annotations" blog.
  * RAP/ABAP CDS annotations: follow the RAP blog for ABAP-side annotations.
- For extension/adaptation projects in S/4HANA Cloud, follow the adaptation project tutorial link.
```

**STEP**: 6 — Reference Links (All resources from the index)
**DESCRIPTION**: Quick copyable list of all official URLs listed in this index.
**LANGUAGE**: text
**CODE**:
```text
# Tutorials
https://developers.sap.com/group.fiori-tools-odata-v4-travel.html
https://developers.sap.com/group.fiori-tools-odata-v4-incident.html
https://developers.sap.com/group.fiori-tools-lrop.html
https://developers.sap.com/group.fiori-elements-mockserver-opa.html
https://developers.sap.com/group.sapui5-adaptation-projects.html

# Courses / Learning Journeys
https://learning.sap.com/courses/developing-and-extending-sap-fiori-elements-apps
https://learning.sap.com/learning-journeys/developing-an-sap-fiori-elements-app-based-on-a-cap-odata-v4-service
https://learning.sap.com/learning-journeys/getting-started-with-creating-an-sap-fiori-elements-app-based-on-an-odata-v4-rap-service

# Blogs
https://blogs.sap.com/tags/ed5c1ef6-932f-4c19-b2ba-1be375109ff5/
https://blogs.sap.com/2021/12/07/the-sap-fiori-elements-feature-showcase-with-cap-cds-annotations/
https://blogs.sap.com/2022/12/19/the-sap-fiori-elements-feature-showcase-with-rap-and-abap-cds-annotations/

# SAP Community (start here to search blogs & topics)
https://community.sap.com/
```
--------------------------------

**TITLE**: Enable "Save and Close" Navigation from Object Page to List Report (OData V2)

**INTRODUCTION**: Short instruction for Fiori elements (OData V2) apps to configure the Object Page so that clicking Save navigates the user back to the List Report. Includes exact manifest.json snippet and alternatives (enable/disable/default).

**TAGS**: fiori-elements-framework, OData V2, manifest.json, ObjectPage, navToListOnSave, save-and-close, navigation

**STEP**: 1 — Enable "Save and Close" (navigate to list report on Save)

**DESCRIPTION**: Edit your app manifest (manifest.json) to set navToListOnSave to true for the Object Page component. Place this under the pages configuration for the target ObjectPage (example: ObjectPage|STTA_C_MP_Product). After saving and redeploying the application, when the user saves a draft/non-draft record on the Object Page, the app will automatically navigate back to the List Report.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "navToListOnSave": true,
            "showRelatedApps": true,
            "tableType": "ResponsiveTable",
            "editableHeaderContent": true,
            "sections": {
              "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
                "navigationProperty": "to_ProductText",
                "entitySet": "STTA_C_MP_ProductText",
                "multiSelect": true,
                "createMode": "inline",
                "tableType": "ResponsiveTable"
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Disable "Save and Close" or use default behavior (stay on Object Page)

**DESCRIPTION**: To keep the default behavior (user stays on the Object Page after saving), either set navToListOnSave to false or remove the property entirely from the Object Page settings. This results in no automatic navigation to the List Report after Save.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "navToListOnSave": false,
            "showRelatedApps": true,
            "tableType": "ResponsiveTable",
            "editableHeaderContent": true
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Notes and verification

**DESCRIPTION**: 
- Applicability: This option applies only to SAP Fiori elements for OData V2.
- Verification: After editing manifest.json, rebuild/deploy the app and open the Object Page. Create or edit a record and click Save. With navToListOnSave: true you should be navigated to the List Report after save; with false or omitted you remain on the Object Page.
--------------------------------

**TITLE**: Scatter Chart Card — UI.Chart Annotation Examples (Fiori Elements)

**INTRODUCTION**: Show how to define a Scatter chart card in Fiori Elements using UI.Chart annotations. Includes XML, ABAP CDS, and CAP CDS examples and concise rules for roles, measures, and dimensions. Use these snippets to generate or patch annotations in annotation files, CDS views, or CAP model files.

**TAGS**: fiori-elements-framework, UI.Chart, scatter-chart, annotations, CDS, CAP, ABAP, xml

**STEP**: 1 — XML UI.Annotation for Scatter Chart

**DESCRIPTION**: Add a UI.Chart annotation to your annotation file (annotations.xml or embedded in OData metadata annotations). The example defines a scatter chart with two measures mapped to Axis1 (x-axis) and Axis2 (y-axis), and one dimension plotted as series (different colors). Replace property names (salesshare, totalsales, suppliercompany) with your entity properties. The Qualifier identifies this chart configuration.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.Chart" Qualifier="Eval_by_Currency_Scatter">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Scatter Chart no role" />
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Scatter" />
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="salesshare" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
                </Record>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="totalsales" />
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2" />
                </Record>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="DimensionAttributes">
            <Collection>
                <Record Type="UI.ChartDimensionAttributeType">
                    <PropertyValue Property="Dimension" PropertyPath="suppliercompany" />
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 2 — ABAP CDS UI.Chart Annotation

**DESCRIPTION**: Use this ABAP CDS snippet to annotate a CDS view. Place into your ABAP CDS file (above or next to the view definition). The snippet defines the same scatter chart: ChartType SCATTER, two measures with roles AXIS_1 and AXIS_2, one dimension attribute, and a qualifier.

**LANGUAGE**: ABAP

**CODE**:
```
@UI.Chart: [
  {
    title: 'Scatter Chart no role',
    chartType: #SCATTER,
    measureAttributes: [
      {
        measure: 'salesshare',
        role: #AXIS_1
      },
      {
        measure: 'totalsales',
        role: #AXIS_2
      }
    ],
    dimensionAttributes: [
      {
        dimension: 'suppliercompany'
      }
    ],
    qualifier: 'Eval_by_Currency_Scatter'
  }
]
annotate view VIEWNAME with { }
```

**STEP**: 3 — CAP CDS UI.Chart Annotation

**DESCRIPTION**: Add this annotation to a CAP CDS file (.cds) in your project. It uses the UI namespace and defines a Scatter chart with MeasureAttributes and DimensionAttributes. Use the qualifier to reference this chart configuration in the UI or manifest.

**LANGUAGE**: CDS

**CODE**:
```
UI.Chart #Eval_by_Currency_Scatter : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Scatter Chart no role',
    ChartType : #Scatter,
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : salesshare,
            Role : #Axis1
        },
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : totalsales,
            Role : #Axis2
        }
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : suppliercompany
        }
    ]
},
```

**STEP**: 4 — Rules, Constraints, and Role Mapping (Summary)

**DESCRIPTION**: Copy these rules into developer notes or validation checks when generating annotations programmatically. They capture constraints and fallback behavior for roles, measures, and dimensions.

**LANGUAGE**: Plain Text

**CODE**:
```
- Purpose: Scatter charts visualize distribution of data points across two measures (x and y).

- Measures:
  - Support up to two measures for scatter chart (typically mapped to x and y).
  - Assign measure roles using: Axis1, Axis2 (or Axis3 fallback).
  - Role-to-axis mapping: Axis1 => valueAxis feed UID (x-axis). If Axis1 is absent, Axis2 is used; if Axis2 is absent, Axis3 may be used as fallback.

- Dimensions:
  - A scatter chart supports a maximum of two dimensions.
  - If a dimension has no Role assigned, all members are plotted as equal-sized bubbles with the same color.
  - Series role: Only one dimension can be assigned to "Series" — all members of that dimension get different colors.
  - Category role: At most one dimension can be assigned to "Category" — members get different shapes.
  - Use DimensionAttributes collection to list dimensions; use Series/Category role when needed.

- Visuals:
  - Example image path: ../01_Whats-New/images/Whats_New_140_OVP_Scatter_Chart_f264ec1.png

- Implementation notes:
  - Replace property names (salesshare, totalsales, suppliercompany) with your entity fields.
  - Use Qualifier to reference the chart definition in the UI configuration.
  - Validate that only up to two measures and up to two dimensions are annotated for a scatter chart.
```
--------------------------------

**TITLE**: Security Configuration for SAP Fiori elements (OData V4)

**INTRODUCTION**: Practical, code-focused guidance and examples to apply the security-related annotations and runtime-extension points used by SAP Fiori elements (OData V4). Use these steps to: declare acceptable upload media types, mark properties as potentially sensitive, mask UI input, and filter/strip sensitive data from outbound navigation. Includes example CDS annotations and a UI extension hook for adaptNavigationContext.

**TAGS**: fiori-elements, security, CAP, CDS, annotations, ODataV4, PersonalData, AcceptableMediaTypes, Common.Masked, extensionAPI

**STEP**: 1 — Verify backend OData/batch capacity for CAP
**DESCRIPTION**: Ensure the back end can handle the number of OData batch requests you will generate. If you use InvocationGrouping: Changeset on the client, you must confirm the OData server (CAP or other framework) allows enough requests in a single batch and that virus scanning/MIME/size rules are enforced for uploads. Action items:
- Review CAP/ABAP OData batch request limits and increase the cap where necessary.
- Ensure the server performs virus scanning and MIME/size checks for uploaded streams.
- Refer to CAP docs for server-side security aspects and batch configuration before enabling complex invocation grouping.

**LANGUAGE**: PlainText
**CODE**:
```text
# Action checklist (no single universal config key):
- Consult CAP runtime configuration for OData/batch size limits in your environment.
- If using a managed platform (CF, Kyma, BTP), check platform OData gateway/proxy limits.
- Ensure server-side stream handling enforces:
  - Allowed MIME types
  - Max file sizes
  - Virus scanning pipeline
```

**STEP**: 2 — Declare acceptable media types for upload properties
**DESCRIPTION**: Annotate stream/attachment properties with @Core.AcceptableMediaTypes to restrict allowed file types at OData metadata level. The back-end must also enforce virus scanning and size/MIME restrictions. Example CDS snippet shows how to annotate a binary/stream property in your CDS model.

**LANGUAGE**: CDS
**CODE**:
```cds
namespace my.company;

using { Core, Common, PersonalData } from '@sap/cds/common';

entity Documents {
  key ID      : UUID;
  Title       : String(255);
  // OData annotation to restrict acceptable upload MIME types
  @Core.AcceptableMediaTypes: ['application/pdf', 'image/png', 'image/jpeg']
  Attachment  : LargeBinary; // stream/binary property
}
```

**STEP**: 3 — Mark properties as potentially sensitive (PersonalData vocabulary)
**DESCRIPTION**: Use the OData PersonalData vocabulary to mark fields that contain potentially sensitive data. The Fiori elements framework will then disable certain behaviors (history, caching, storing in app state) for these fields. Add the annotation in CDS to get OData metadata reflecting sensitivity.

**LANGUAGE**: CDS
**CODE**:
```cds
namespace my.company;

using { PersonalData } from '@sap/cds/common';

entity Person {
  key ID    : UUID;
  Name      : String(100);
  // Mark as potentially sensitive so Fiori elements treats it accordingly
  @PersonalData.IsPotentiallySensitive: true
  NationalId: String(50);
}
```

**STEP**: 4 — Mask UI input fields (Common.Masked)
**DESCRIPTION**: Use the Common.Masked annotation to hide sensitive text on the UI. Note: this only hides the text on the client UI; the payload sent to the back end is not masked. Use additional server-side measures to protect data in transit/storage.

**LANGUAGE**: CDS
**CODE**:
```cds
namespace my.company;

using { Common } from '@sap/cds/common';

entity PaymentCard {
  key ID         : UUID;
  HolderName     : String(100);

  // UI-only masking example: shows last 4 characters on UI
  // (The exact structure below is an example; adjust to your annotation tooling)
  @Common.Masked: { type: 'Simple', showLastChars: 4 }
  CardNumber     : String(32);
}
```

**STEP**: 5 — Disable export or exclude sensitive columns from export
**DESCRIPTION**: Disable export at the table level or exclude individual columns that contain sensitive data. Implementation options depend on app version and framework; below are two pragmatic approaches:
- Manifest-level switch to turn off the generic export button for the app.
- Use annotations or UI column metadata to mark a column as excluded from export (framework-specific).

**LANGUAGE**: JSON
**CODE**:
```json
// webapp/manifest.json — example: disable generic export globally (framework-dependent)
{
  "sap.ui5": {
    "models": { /* ... */ },
    "config": {
      "sap.ui.generic.app": {
        "settings": {
          "enableExport": false
        }
      }
    }
  }
}
```

**LANGUAGE**: CDS
**CODE**:
```cds
namespace my.company;

using { UI } from '@sap/cds/common';

// Example: indicate column should not be exported (annotation name may vary by toolchain)
entity Orders {
  key ID : UUID;

  @UI.LineItem: [{ /* ... */ }]
  @UI.ExcludeFromExport: true
  SensitiveField: String;
}
```

**STEP**: 6 — Prevent copying to clipboard for sensitive controls (UX-level)
**DESCRIPTION**: Where necessary, disable copy-to-clipboard actions for fields annotated as sensitive. This is an application/UI setting — implementable via UI control properties or by preventing the clipboard action in a control extension. Below is a sample controller extension that prevents clipboard events on a sensitive input.

**LANGUAGE**: JavaScript
**CODE**:
```javascript
// webapp/extension/SensitiveInput.controller.js
sap.ui.define([], function () {
  "use strict";
  return {
    onInit: function () {
      var oInput = this.byId("sensitiveInput");
      if (oInput) {
        // prevent copy/paste shortcuts on this control
        oInput.addEventDelegate({
          onpaste: function (oEvent) { oEvent.preventDefault(); },
          oncopy:  function (oEvent) { oEvent.preventDefault(); },
          oncut:   function (oEvent) { oEvent.preventDefault(); }
        });
      }
    }
  };
});
```

**STEP**: 7 — Integrate extensionAPI.adaptNavigationContext to remove sensitive context before outbound navigation
**DESCRIPTION**: When implementing outbound navigation extensions, use the Fiori elements extensionAPI.adaptNavigationContext method to remove or reduce sensitive data from the navigation context that is passed to a target application. Always prefer manifest settings or annotations to pass minimal context; use this extension only when necessary.

**LANGUAGE**: JavaScript
**CODE**:
```javascript
// webapp/extension/NavigationContext.extension.js
sap.ui.define([], function () {
  "use strict";

  return {
    /**
     * Example extension hook for outbound navigation.
     * extensionAPI is provided by Fiori elements on extension entry points.
     */
    adaptNavigationContext: function (oContext) {
      // Remove sensitive fields explicitly before outbound navigation
      const safeContext = Object.assign({}, oContext);
      delete safeContext.NationalId;
      delete safeContext.CardNumber;

      // Optionally, pass only a whitelist of properties
      // return { ID: oContext.ID, Name: oContext.Name };

      return Promise.resolve(safeContext);
    }
  };
});
```

**STEP**: 8 — Notes on framework behaviors and documentation pointers
**DESCRIPTION**: Keep these behaviors in mind when you annotate fields as potentially sensitive:
- History (recently entered values) is disabled for sensitive fields.
- Caching of last executed requests is disabled when filters include sensitive properties.
- Store/restore app state does not persist changes to sensitive fields (unless used in filter context).
- Outbound navigation automatically removes top-level sensitive properties; nested sensitive properties beyond one level may not be removed — use adaptNavigationContext when needed.
- Enabling Share: Microsoft Teams › As Card may transfer data outside S/4HANA — explicitly exclude sensitive properties if needed.

**LANGUAGE**: PlainText
**CODE**:
```text
Reference & action list:
- CAP security aspects: review CAP security docs for server config (batch limits, stream handling).
- ABAP: consult ABAP RAP guides for secure search/filter implementations in unmanaged queries.
- Uploads: annotate streams with @Core.AcceptableMediaTypes and enforce server-side virus/MIME/size checks.
- Sensitive data: use @PersonalData.IsPotentiallySensitive and @Common.Masked to control UI and framework behavior.
- Outbound navigation: use extensionAPI.adaptNavigationContext to remove/filter sensitive fields.
- Share/Teams: consider excluding sensitive fields from the Teams card export.
```
--------------------------------

**TITLE**: Selecting Transports for Business Configuration Content (Fiori elements)

**INTRODUCTION**: This guide lists the exact manifest settings and annotations required to enable the "Select Transport Request" feature on an object page in SAP Fiori elements. Use these steps to: (1) ensure the OData/ABAP backend exposes the correct property and action, (2) configure the feature in the UI manifest, and (3) control availability or mandatory behavior via annotations.

**TAGS**: fiori-elements-framework, transport, manifest.json, annotations, OData, ABAP, business-configuration

**STEP**: 1 — Backend prerequisites (entity set and action)

**DESCRIPTION**: Ensure the service/entity-set used by the object page exposes:
- A transport request property (string) that stores the currently selected transport request.
- A select-transport action on the entity set:
  - The action has a parameter (Edm.String) for the transport request and a meaningful label.
  - The action parameter has a value list annotation so the UI can present selectable transport requests.
  - The action is annotated with @Common.SideEffects so the UI is refreshed after selection.

Tip: Use ValueListWithFixedValues for the action parameter if the number of transport requests is small so the parameter is rendered as a dropdown.

**LANGUAGE**: (Backend / Metadata requirements — no single code language)

**CODE**:
```text
Requirements summary to implement in OData/ABAP backend metadata or CDS:
- Expose entity property: <Namespace>.TransportRequestProperty (Edm.String)
- Expose bound action: <Namespace>.SelectTransportAction
  - Action parameter: e.g. transportRequest : Edm.String
  - Annotate parameter with a value list (e.g. ValueListWithFixedValues or ValueList)
  - Annotate action with @Common.SideEffects to refresh UI after selection
```

**STEP**: 2 — Enable feature in the UI manifest (manifest.json)

**DESCRIPTION**: Add the transport selection configuration to the object page target in manifest.json. Replace placeholders with your root page, transport property name, and fully-qualified action name.

- File: manifest.json
- Location: inside sap.ui5.routing.targets.<yourRootPage>.options.settings.content.transportSelection

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "<yourRootPage>": {
          "options": {
            "settings": {
              "content": {
                "transportSelection": {
                  "transportRequestProperty": "<TransportRequestProperty>",
                  "selectTransportAction": "<Namespace>.<SelectTransportAction>"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Disable/enable the SelectTransport action dynamically (OperationAvailable)

**DESCRIPTION**: If you want to enable the feature globally via manifest.json but still conditionally disable it at runtime, use the Common.OperationAvailable annotation on the SelectTransport action. The Path value should point to a boolean property/complex expression provided by your service or annotation model.

- File: annotations.xml (or your annotations provider)

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="Namespace.SelectTransportAction">
     <Annotation Term="Common.OperationAvailable" Path="selectTransportEnabled" />
</Annotations>
```

**STEP**: 4 — Make transport request mandatory (FieldControl)

**DESCRIPTION**: To force users to select a transport before saving, annotate the transportRequest property with Common.FieldControl set to Mandatory. This shows the warning strip until a transport is selected and prevents save operations.

- Static mandatory (always mandatory)
- Dynamic mandatory (resolve at runtime via a path to a field control expression)

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Static mandatory -->
<Annotations Target="Namespace.TransportRequestProperty">
     <Annotation Term="Common.FieldControl" EnumMember="Common.FieldControlType/Mandatory" />
</Annotations>

<!-- Dynamic mandatory -->
<Annotations Target="Namespace.TransportRequestProperty">
     <Annotation Term="Common.FieldControl" Path="transportRequestFieldControl" />
</Annotations>
```

**STEP**: 5 — UX behavior and image references (for implementation validation)

**DESCRIPTION**: Implementation notes for QA / UI validation:
- The Select Transport Request control is only visible when the object page is in edit mode (not read-only).
- If FieldControl is mandatory or save is executed without a selected transport, the UI shows a message strip warning until a transport is selected.
- When the select dialog is opened, the framework displays transport requests from the action parameter value list; selecting one updates the header toolbar.
- Images from the original docs (for visual reference) are available at:
  - images/Transport_Selection_Message_No_Transport_Request_Selected_abdf348.jpg
  - images/Transport_Selection_Prompt_for_Transport_Selection_Dialog_3e81ed2.png
  - images/Transport_Selection_Selected_Transport_Request_is_Displayed_412836f.png

**LANGUAGE**: (UI behavior / QA checklist — no code)

**CODE**:
```text
UI validation checklist:
- Start editing the object page -> Select Transport Request should appear in header toolbar.
- Click Select Transport Request -> dialog lists available transport requests (from action parameter value list).
- Select transport -> header toolbar shows selected transport request.
- Try Save without selected transport (if mandatory) -> dialog prompts selection and message strip warning is shown.
```

**STEP**: 6 — ABAP RAP generator option

**DESCRIPTION**: If you use ABAP RESTful Application Programming Model (RAP), you can enable transport selection during object generation:
- In the Generate ABAP Repository Objects Wizard, select "Enable Transport Selection Strip".
- See: Generating a Business Configuration Maintenance Object with the Generate ABAP Repository Objects Wizard

**LANGUAGE**: (Documentation / Tooling)

**CODE**:
```text
Reference: https://help.sap.com/docs/ABAP_PLATFORM_NEW/b5670aaaa2364a29935f40b16499972d/047e01c3bcdd4303a60b61364bd5b31d.html
```


--------------------------------

**TITLE**: Setting requireAppAuthorization for Overview Page (OVP) Cards

**INTRODUCTION**: Use the requireAppAuthorization property in webapp/manifest.json to restrict display of OVP cards to users who are authorized for the target application intent. The framework checks the intent via the Cross-Application Navigation service (isIntentSupported) and renders the card only when the intent is supported for the current user.

**TAGS**: fiori-elements-framework, sap.ovp, overview-page, cards, manifest.json, requireAppAuthorization, isIntentSupported, CrossApplicationNavigation, authorization

**STEP**: 1 — Add requireAppAuthorization to the card settings in manifest.json

**DESCRIPTION**: Edit the application's manifest.json (webapp/manifest.json) and add the requireAppAuthorization property under the specific card's settings object. Use the intent hash string (starting with '#') that identifies the target application intent. The framework will check isIntentSupported for this intent and only render the card when supported.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    ...
    "cards": {
      ...
      "card01": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.stack",
        "settings": {
          "title": "Stack Card Title",
          "subTitle": "Stack Card",
          "requireAppAuthorization": "#Action-toappnavsample",
          "entitySet": "SalesOrderSet"
        }
      }
    }
    ...
  }
}
```

**STEP**: 2 — Intent string format and placement

**DESCRIPTION**: The value for requireAppAuthorization must be an intent hash string (beginning with '#'). Place it in the card definition under sap.ovp -> cards -> <cardId> -> settings -> requireAppAuthorization. Example formats:
- "#SemanticObject-action"
- "#Action-toappnavsample" (example shown in STEP 1)

No additional manifest keys are required for this check.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "cardExample": {
        "settings": {
          "requireAppAuthorization": "#SemanticObject-action"
        }
      }
    }
  }
}
```

**STEP**: 3 — (Optional) Manual intent check using Cross-Application Navigation

**DESCRIPTION**: The OVP runtime uses Cross-Application Navigation's isIntentSupported automatically. For custom logic or debugging, you can manually call isIntentSupported to check whether the user is authorized for an intent. Example shows typical UI5 access to the service and handling the result.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: manual check of intent support in a UI5 controller
var crossAppNav = sap.ushell && sap.ushell.Container && sap.ushell.Container.getService
  ? sap.ushell.Container.getService("CrossApplicationNavigation")
  : null;

if (crossAppNav) {
  // Provide an object keyed by intent string (hash) or an array; here we pass a map
  var intents = {
    "#Action-toappnavsample": {}
  };

  // isIntentSupported returns a Promise-like object or jQuery.Deferred depending on platform
  crossAppNav.isIntentSupported(intents).done(function(result) {
    // result: { "#Action-toappnavsample": { supported: true/false, ... } }
    if (result && result["#Action-toappnavsample"] && result["#Action-toappnavsample"].supported) {
      // intent supported — authorized
      console.log("Intent supported — show card or enable navigation");
    } else {
      // intent not supported — hide card or disable navigation
      console.log("Intent not supported — hide card or show preview only");
    }
  }).fail(function(err) {
    console.error("isIntentSupported failed", err);
  });
}
```

**STEP**: 4 — Design-time and adaptation limitations

**DESCRIPTION**: requireAppAuthorization is evaluated at runtime. It does NOT work in design time for overview page cards and therefore is ineffective when creating adaptation projects or using UI adaptation scenarios (for example when creating an extension project from Business Application Studio or Visual Studio Code). Plan testing and validation at runtime in a deployed environment.
--------------------------------

**TITLE**: Setting Criticality for Action Buttons (UI.DataFieldForAction)

**INTRODUCTION**: Show how to mark action buttons with semantic criticality so Fiori Elements renders them as semantic (positive/negative) action buttons. Includes XML annotation, ABAP CDS annotation, and CAP/CDS JSON examples, supported values, supported locations, and behavioral notes.

**TAGS**: fiori-elements-framework, annotations, criticality, UI.DataFieldForAction, SAP Fiori, OData V4, ABAP CDS, CAP

**STEP**: 1 — XML Annotation (annotations.xml)
**DESCRIPTION**: Add a UI.DataFieldForAction record in your annotations XML to set a criticality for an action button. Place this record where lineItem, FieldGroup, or object-page annotations are defined (e.g., inside <Annotations Target="..."> in your annotations file).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Example: annotations.xml -->
<Annotations Target="YourService.YourEntityType">
  <!-- For a line item or any collection of actions -->
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataFieldForAction">
        <PropertyValue Property="Determining" Bool="true"/>
        <PropertyValue Property="Label" String="Positive (Dummy)"/>
        <PropertyValue Property="Action" String="com.c_salesordermanage_sd_aggregate.DummyBoundAction"/>
        <!-- Set semantic criticality using enum member -->
        <PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Positive"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 2 — ABAP CDS Annotation (Core Data Services)
**DESCRIPTION**: Define the action in your ABAP CDS view using @UI.lineItem or fieldGroup annotation entries. Use dataAction and type #FOR_ACTION to mark it as an action; specify the label and binding (PUSHDOWN or direct). Criticality is represented by including a UI annotation entry for the action — example shows creating the action entry in the UI annotation collection.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@UI.lineItem: [
  {
    label: 'Positive (Dummy)',
    dataAction: 'PUSHDOWN:com.c_salesordermanage_sd_aggregate.DummyBoundAction',
    type: #FOR_ACTION
    /* In ABAP CDS, Criticality for DataFieldForAction is usually added in the annotation file or via metadata extension.
       If supported in your ABAP environment, add the UI.CriticalityType mapping accordingly. */
  }
]
define view ZYour_CDS_View as select from ...
{
  ...
}
```

**STEP**: 3 — CAP / CDS JSON Annotation (UI metadata for CAP)
**DESCRIPTION**: In CAP or in UI annotations represented as JSON (e.g., annotations/app/annotations.cds.json or similar), define a UI.DataFieldForAction object and set Criticality to #Positive or #Negative.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "$Type": "UI.DataFieldForAction",
  "Determining": true,
  "Label": "Positive (Dummy)",
  "Action": "com.c_salesordermanage_sd_aggregate.DummyBoundAction",
  "Criticality": "#Positive"
}
```

**STEP**: 4 — Supported Criticality Values and Numeric Equivalents
**DESCRIPTION**: Use one of the supported enum members or equivalent numeric values for Criticality. Use these values exactly as shown.
**LANGUAGE**: JSON
**CODE**:
```json
// Supported values for Criticality:
{
  "UI.CriticalityType/Positive": 3,   // Positive / Green (Completed / Available / On Track)
  "UI.CriticalityType/Negative": 1    // Negative / Red (Attention / Alert)
}

// Examples:
<PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Positive"/>  // XML
"Criticality": "#Positive"                                                        // CAP JSON
```

**STEP**: 5 — Supported Locations for Critical Actions
**DESCRIPTION**: Criticality is supported only for DataFieldForAction and can be used in:
- Inline table row actions
- Object page header actions (note: for OData V4, only the left-most header action may be critical)
- Object page footer actions

**LANGUAGE**: Text
**CODE**:
```text
Supported locations:
- Table row (inline) actions
- Object page header (left-most action for OData V4)
- Object page footer
```

**STEP**: 6 — Behavioral Notes and Constraints
**DESCRIPTION**: Important behavior to account for when using critical actions:
- Criticality applies only to UI.DataFieldForAction.
- When an action is marked critical (semantic button), previously emphasized buttons (e.g., SAVE, EDIT, APPLY) will no longer appear emphasized.
- Emphasized buttons and semantic (critical) buttons cannot coexist as primary actions on the same page — only a single primary action is allowed.
- For OData V4 object pages, the critical action can only be the left-most header action.

**LANGUAGE**: Text
**CODE**:
```text
Notes:
- Use DataFieldForAction only.
- Semantic (critical) actions replace emphasized primary action styling.
- Do not mix emphasized and semantic primary actions on one page.
- OData V4 object page: critical action must be left-most header action.
```
--------------------------------

**TITLE**: Setting the Default Column Width (SAP Fiori elements)

**INTRODUCTION**: Customize the width of table columns in Fiori elements by using the com.sap.vocabularies.HTML5.v1.CssDefaults UI annotation (XML or CDS) or by configuring controlConfiguration in manifest.json. This guide shows actionable code samples and the exact manifest/annotation locations you need to modify. Use these patterns to set fixed or relative widths (em, rem, %) and to include the column header in width calculation.

**TAGS**: fiori-elements-framework, CssDefaults, UI.LineItem, manifest.json, controlConfiguration, annotations, CDS, CAP, column-width, OData

**STEP**: 1 — Understand default behavior and limits

**DESCRIPTION**: Fiori elements computes default column widths using metadata (type, label, referenced properties, text arrangement). You can improve defaults by providing maxLength for strings or Precision for numeric types. The algorithm enforces a minimum of 3rem and a maximum of 20rem. Some UI controls have fixed default widths shown below. Allowed units: em, rem, % (relative to table width). On mobile the table auto-adjusts columns to fill available width.

Default widths for specific controls:
- Images: 5rem
- Rating indicator: 6.875rem
- Progress indicator: 6.875rem
- Charts: 20rem

**LANGUAGE**: text

**CODE**:
```text
Defaults: min=3rem, max=20rem
Controls: Images=5rem, Rating=6.875rem, Progress=6.875rem, Charts=20rem
Allowed units: em, rem, %
Mobile: columns auto-adjust to occupy available width
Improve defaults: set maxLength (String) or Precision (Numeric)
```

**STEP**: 2 — Set column width using XML UI annotations (UI.LineItem)

**DESCRIPTION**: Add com.sap.vocabularies.HTML5.v1.CssDefaults with a width property to an entry in the UI.LineItem annotation (suitable for annotation XML files in your metadata or CDS-to-annotation export). The sample below shows two line-item columns with explicit widths.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.LineItem">
    <Collection>
        <Record Type="UI.DataFieldWithIntentBasedNavigation">
            <PropertyValue Property="SemanticObject" String="EPMSalesOrder" />
            <PropertyValue Property="Action" String="display_sttabupa" />
            <PropertyValue Property="Value" Path="bp_id" />
            <Annotation Term="com.sap.vocabularies.HTML5.v1.CssDefaults">
                <Record>
                    <PropertyValue Property="width" String="10rem"/>
                </Record>
            </Annotation>
        </Record>
        <Record Type="UI.DataField">
            <PropertyValue Property="Value" Path="currency_code" />
            <Annotation Term="com.sap.vocabularies.HTML5.v1.CssDefaults">
                <Record>
                    <PropertyValue Property="width" String="15rem"/>
                </Record>
            </Annotation>
        </Record>
    </Collection>
</Annotation>
```

**STEP**: 3 — Set column width using CAP CDS annotations (CDS file)

**DESCRIPTION**: In CAP CDS (annotation block for LineItem), use the shorthand annotation syntax ![@HTML5.CssDefaults] to define width per column. Use the same widths as in XML but remember syntax differences in CDS.

**LANGUAGE**: CDS

**CODE**:
```cds
LineItem : {
    {
        $Type : 'UI.DataFieldForIntentBasedNavigation',
        SemanticObject : 'EPMSalesOrder',
        Action : 'display_sttabupa',
        Value: 'bp_id',
        Label : 'IBN',
        ![@HTML5.CssDefaults] : { width : '10rem' }
    },
    {
        $Type : 'UI.DataField',
        Value : currency_code,
        ![@HTML5.CssDefaults] : { width : '15rem' }
    },
}
```

**STEP**: 4 — Set column width using manifest.json (controlConfiguration)

**DESCRIPTION**: Configure column width in manifest.json under the sap.ui5 controlConfiguration for the table. The column key identifies the column; examples of keys: "DataField::SalesOrderItemCategory" or "com.sap.vocabularies.UI.v1.DataField::gross_amount". Place this fragment under "sap.ui5": { "controlConfiguration": { ... } }.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "controlConfiguration": {
    "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
      "columns": {
        "DataField::SalesOrderItemCategory": {
          "width": "10em"
        }
      }
    }
  }
}
```

**STEP**: 5 — Include column header in width calculation (manifest.json setting)

**DESCRIPTION**: To include the column label when calculating default width, set widthIncludingColumnHeader to true globally in tableSettings and/or per column in the settings.columns map. Add this under the app manifest settings area where Fiori elements settings are specified (example below shows the settings fragment).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "settings": {
    "tableSettings": {
      "multiEdit": {
        "enabled": true
      },
      "widthIncludingColumnHeader": true
    },
    "columns": {
      "com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation::bp_id": {
        "widthIncludingColumnHeader": true
      },
      "com.sap.vocabularies.UI.v1.DataField::gross_amount": {
        "widthIncludingColumnHeader": true
      }
    }
  }
}
```

**STEP**: 6 — Key identification and references

**DESCRIPTION**: The column key used in manifest controlConfiguration or settings.columns must match the anchor/key used by Fiori elements. To find the correct key for your column, consult "Finding the Right Key for the Anchor". For custom columns and table extension points see "Extension Points for Tables".

**LANGUAGE**: text

**CODE**:
```text
Column key examples:
- DataField::SalesOrderItemCategory
- com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation::bp_id

See:
- finding-the-right-key-for-the-anchor-6ffb084.md
- extension-points-for-tables-d525522.md
```

**STEP**: 7 — Practical tips and constraints

**DESCRIPTION**: Quick actionable notes when applying column widths.

**LANGUAGE**: text

**CODE**:
```text
- Use em/rem/% units. rem or em recommended for consistency with overall UI.
- Keep widths within 3rem .. 20rem when overriding defaults (algorithm limits).
- Mobile: columns auto-adjust; fixed widths are respected but layout may reflow.
- Prefer adjusting metadata (maxLength or Precision) to improve automatic width calculation before forcing widths.
- For images/charts/rating/progress controls use the defaults shown in Step 1 unless you must override.
```
--------------------------------

**TITLE**: Setting the Table Header in manifest.json (Fiori elements)

**INTRODUCTION**: Configure the table header text and its visibility for Fiori elements tables by setting tableSettings.header and tableSettings.headerVisible in manifest.json. Use controlConfiguration entries under sap.ui5.routing.targets.<TargetName>.options.settings.controlConfiguration keyed by the LineItem annotation path (e.g. "@com.sap.vocabularies.UI.v1.LineItem" or "_NavigationProperty/@com.sap.vocabularies.UI.v1.LineItem") to target specific tables on List Reports and Object Pages.

**TAGS**: fiori-elements-framework, manifest.json, table header, headerVisible, controlConfiguration, LineItem, HeaderInfo, UI.v1

STEP: 1 — Configure a table header for a List Report target

DESCRIPTION: Add tableSettings.header and tableSettings.headerVisible for the LineItem annotation of a List Report target. Place this under sap.ui5.routing.targets.<TargetName>.options.settings.controlConfiguration. This example sets a custom header and shows it.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "header": "Another header",
                    "headerVisible": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 2 — Configure table headers and visibility for tables on an Object Page (per navigation/LineItem)

DESCRIPTION: Override table headers or visibility for nested tables on the Object Page by targeting the LineItem annotation for specific navigation properties. Use keys like "_Partner/@com.sap.vocabularies.UI.v1.LineItem" or "_Item/@com.sap.vocabularies.UI.v1.LineItem" to scope settings to those tables.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "_Partner/@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "header": "Another header for the Partners",
                    "headerVisible": true
                  }
                },
                "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "headerVisible": false
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — Notes and usage tips

DESCRIPTION: Implementation details to ensure correct behavior:
- The controlConfiguration key must match the annotation path for the table you want to configure:
  - For the main collection table on a List Report: "@com.sap.vocabularies.UI.v1.LineItem"
  - For tables tied to a navigation property on an Object Page: "_NavigationProperty/@com.sap.vocabularies.UI.v1.LineItem"
- tableSettings.header sets the displayed header text (string).
- tableSettings.headerVisible controls whether the header is shown (boolean).
- Place these entries inside the correct target under sap.ui5.routing.targets in manifest.json so they apply to that page/target.
--------------------------------

**TITLE**: Configure Table Types and Related Settings for Fiori Elements (OData V2 & V4)

**INTRODUCTION**: This document provides concise, code-focused examples and instructions for configuring table types (ResponsiveTable, GridTable, AnalyticalTable, TreeTable) and related settings in manifest.json and annotations for SAP Fiori Elements (OData V2 and OData V4). Use these snippets to: set table type per page/section, configure responsive popins, enable tree/analytical tables, annotate services for aggregation, and control row counts and aggregation behavior.

**TAGS**: manifest.json, tableSettings, tableTypes, ResponsiveTable, GridTable, AnalyticalTable, TreeTable, popinLayout, aggregation, @Aggregation.ApplySupported, sap.fe, controlConfiguration

**STEP**: 1 — Table types available
**DESCRIPTION**: Use one of these values in tableSettings.type to select the table control.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "availableTableTypes": [
    "ResponsiveTable",
    "GridTable",
    "AnalyticalTable",
    "TreeTable"
  ]
}
```

**STEP**: 2 — Set table type for List Report (OData V2) via sap.ui.generic.app pages
**DESCRIPTION**: Add or update the entity page entry under sap.ui.generic.app → pages → component.settings.tableSettings.type for the list report page. Path: manifest.json -> "sap.ui.generic.app" -> "pages".
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Zfarvd_Bs_Hd_Bo",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true,
          "settings": {
            "tableSettings": {
              "type": "GridTable"
            }
          }
        }
      }
    ]
  }
}
```

**STEP**: 3 — Set table type for Object Page sections (OData V2)
**DESCRIPTION**: Configure a section-specific table type inside an ObjectPage settings.sections entry. Section-level tableSettings takes precedence over the object page-level tableSettings.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": [
          {
            "entitySet": "STTA_C_MP_Product",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "sections": {
                  "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
                    "navigationProperty": "to_ProductText",
                    "entitySet": "STTA_C_MP_ProductText",
                    "tableSettings": {
                      "type": "TreeTable"
                    }
                  }
                }
              }
            }
          }
        ]
      }
    ]
  }
}
```

**STEP**: 4 — Backward compatibility: tableTypes vs tableSettings and priority
**DESCRIPTION**: Defining tableTypes is backward-compatible but deprecated; prefer tableSettings. Section-level tableSettings override object page-level tableSettings.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "pages": [
    {
      "entitySet": "STTA_C_MP_Product",
      "component": {
        "name": "sap.suite.ui.generic.template.ObjectPage",
        "settings": {
          "showRelatedApps": true,
          "tableSettings": {
            "type": "ResponsiveTable"
          },
          "sections": {
            "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
              "navigationProperty": "to_ProductText",
              "entitySet": "STTA_C_MP_ProductText",
              "tableSettings": {
                "type": "GridTable"
              }
            }
          }
        }
      }
    }
  ]
}
```

**STEP**: 5 — Set table type in manifest for OData V4 via sap.ui5 -> routing -> targets -> options -> settings -> controlConfiguration
**DESCRIPTION**: For Fiori elements (OData V4), define controlConfiguration per LineItem annotation qualifier under the target's settings. Place these snippets under manifest.json -> sap.ui5 -> routing -> targets -> <TargetName> -> options -> settings -> controlConfiguration.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "type": "Component",
          "id": "SalesOrderManageList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "type": "ResponsiveTable"
                  }
                }
              }
            }
          }
        },
        "SalesOrderManageObjectPage": {
          "type": "Component",
          "id": "SalesOrderManageObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "controlConfiguration": {
                "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "type": "GridTable"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — Configure popinLayout for ResponsiveTable (table-level)
**DESCRIPTION**: When using ResponsiveTable, control popin layout per table via tableSettings.popinLayout. Valid values: "Block" (default), "GridLarge", "GridSmall".
**LANGUAGE**: JSON
**CODE**:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "type": "ResponsiveTable",
        "popinLayout": "GridSmall"
      }
    }
  }
}
```

**STEP**: 7 — Configure default popin layout at application level (sap.fe default)
**DESCRIPTION**: Set a default popin layout app-wide. Table-level popinLayout overrides this.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "sap.fe": {
    "macros": {
      "table": {
        "defaultPopinLayout": "GridLarge"
      }
    }
  }
}
```

**STEP**: 8 — Annotate a service as Analytical (OData V4: @Aggregation.ApplySupported)
**DESCRIPTION**: Mark the entity with @Aggregation.ApplySupported and list required Transformations. This enables AnalyticalTable behavior. Ensure the back end supports the transformations. Use XML, ABAP CDS, or CAP CDS examples below.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="sap.fe.managepartners.ManagePartnersService.Customers">
  <Annotation Term="Aggregation.ApplySupported">
    <Record>
      <PropertyValue Property="Transformations">
        <Collection>
          <String>filter</String>
          <String>identity</String>
          <String>orderby</String>
          <String>search</String>
          <String>skip</String>
          <String>top</String>
          <String>groupby</String>
          <String>aggregate</String>
          <String>concat</String>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 9 — Analytical annotation examples (ABAP CDS and CAP CDS)
**DESCRIPTION**: ABAP CDS and CAP CDS equivalents for marking aggregation support and groupable/measure properties.
**LANGUAGE**: ABAP CDS
**CODE**:
```abap
@OData.applySupportedForAggregation: #FULL
```

**LANGUAGE**: CAP CDS
**CODE**:
```csl
// At the entity root
@Aggregation.ApplySupported : {
  Transformations : [
    'filter',
    'identity',
    'orderby',
    'search',
    'skip',
    'top',
    'groupby',
    'aggregate',
    'concat'
  ],
  GroupableProperties: [ Segment, Country ]
}
```

**STEP**: 10 — Define Groupable and Aggregatable (measure) properties
**DESCRIPTION**: Declare groupable properties and aggregatable measures. Aggregatable properties use Aggregation.default or Aggregation.CustomAggregate with qualifier; measures may also use @Analytics.Measure.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Groupable properties -->
<Annotations Target="sap.fe.managepartners.ManagePartnersService.Customers">
  <Annotation Term="Aggregation.ApplySupported">
    <PropertyValue Property="GroupableProperties">
      <Collection>
        <PropertyPath>Segment</PropertyPath>
        <PropertyPath>Country</PropertyPath>
      </Collection>
    </PropertyValue>
  </Annotation>
</Annotations>

<!-- Aggregatable (measure) property example -->
<Annotations Target="sap.fe.managepartners.ManagePartnersService.BusinessPartners/SalesAmount">
  <Annotation Term="Aggregation.default" EnumMember="Aggregation.defaultType/SUM"/>
  <Annotation Term="Analytics.Measure" Bool="true"/>
</Annotations>

<Annotations Target="sap.fe.managepartners.ManagePartnersService.EntityContainer">
  <Annotation Term="Aggregation.CustomAggregate" Qualifier="SalesAmount" String="Edm.Decimal"/>
</Annotations>
```

**LANGUAGE**: CAP CDS
**CODE**:
```csl
// Measure property
SalesAmount @Analytics.Measure : true @Aggregation.default : #SUM;

// At entity level: CustomAggregate qualifier
@Aggregation.CustomAggregate #SalesAmount : 'Edm.Decimal';
```

**STEP**: 11 — Enable Search transformation inside ApplySupported
**DESCRIPTION**: Include 'search' in Transformations to enable the Search field for analytical services.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="sap.fe.managepartners.ManagePartnersService.Customers">
  <Annotation Term="Aggregation.ApplySupported">
    <Record Type="Aggregation.ApplySupportedType">
      <PropertyValue Property="Transformations">
        <Collection>
          <String>search</String>
          <String>topcount</String>
          <String>bottomcount</String>
          <String>identity</String>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 12 — aggregationOnLeafLevel: aggregate only on visible columns (manifest)
**DESCRIPTION**: Set analyticalConfiguration.aggregationOnLeafLevel to true inside tableSettings to request aggregation only for visible columns and enable navigation/bound actions only if all keys are visible.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "type": "AnalyticalTable",
        "analyticalConfiguration": {
          "aggregationOnLeafLevel": true
        },
        "personalization": true
      }
    }
  }
}
```

**STEP**: 13 — Activate TreeTable in manifest (with hierarchyQualifier)
**DESCRIPTION**: To enable TreeTable, set type to "TreeTable" and provide hierarchyQualifier that links to @Aggregation.RecursiveHierarchy/@Hierarchy.RecursiveHierarchy qualifiers.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "type": "TreeTable",
        "hierarchyQualifier": "SalesOrgHierarchy",
        "personalization": true
      }
    }
  }
}
```

**STEP**: 14 — Configure number of visible rows: rowCount and rowCountMode
**DESCRIPTION**: Set rowCount and rowCountMode in tableSettings. rowCountMode values: "Fixed", "Auto", "Interactive". Note: rowCountMode does not apply to ResponsiveTable. When sectionLayout=Tabs and table is sole control, rowCountMode defaults to "Auto".
**LANGUAGE**: JSON
**CODE**:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "type": "GridTable",
        "rowCount": 10,
        "rowCountMode": "Fixed",
        "personalization": true
      }
    }
  }
}
```

**STEP**: 15 — Important restrictions and behavior notes (action-oriented)
**DESCRIPTION**: Preserve these constraints when implementing:
- Grid, Tree, Analytical tables do not support multi-line content columns (FieldGroup or multi-line text): avoid using multi-line column annotations for these table types.
- Analytical tables do not support navigation properties in LineItem; a column will appear empty if included.
- If tableSettings.type is set to Analytical but entitySet lacks aggregation capability, OData V2 falls back to GridTable; OData V4 displays an empty table.
- Analytical or Tree tables with draft-enabled service on List Report: only active entities are shown; edit/create/delete behavior differs (see final note: analytical on object/custom pages is read-only).
**LANGUAGE**: JSON
**CODE**:
```json
{
  "restrictions": {
    "noMultiLineColumns": true,
    "analytical_no_navigation_properties": true,
    "odata_v2_analytical_fallback": "GridTable_if_no_aggregation",
    "odata_v4_analytical_empty_table_if_no_aggregation": true,
    "draft_service_behavior": {
      "list_report": "only_active_entities",
      "object_page_analytical": "read_only_no_create_delete",
      "tree_table_with_draft": "no_restriction"
    }
  }
}
```

**STEP**: 16 — Backend requirements for aggregate controls (OData V4)
**DESCRIPTION**: Ensure the back end supports transformation filters and the required ApplySupported annotations for aggregate entities. Add Transformations values for filter/search/etc. Path: service metadata / annotation files.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotations Target="sap.fe.managepartners.ManagePartnersService.Customers">
  <Annotation Term="Aggregation.ApplySupported">
    <Record Type="Aggregation.ApplySupportedType">
      <PropertyValue Property="Transformations">
        <Collection>
          <String>filter</String>
          <String>search</String>
          <String>orderby</String>
          <String>skip</String>
          <String>top</String>
          <String>groupby</String>
          <String>aggregate</String>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 17 — References (where to place snippets)
**DESCRIPTION**: Use these manifest locations:
- OData V2 List/Object pages: manifest.json -> "sap.ui.generic.app" -> "pages"
- OData V4 targets: manifest.json -> "sap.ui5" -> "routing" -> "targets" -> <Target> -> "options" -> "settings" -> "controlConfiguration"
- App-level default popin: manifest.json -> "sap.fe" -> "macros" -> "table" -> "defaultPopinLayout"
- Annotations: metadata XML / annotation files, ABAP CDS, or CAP CDS definitions as shown above.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "paths": {
    "odata_v2_pages": "manifest.json -> sap.ui.generic.app -> pages",
    "odata_v4_targets": "manifest.json -> sap.ui5 -> routing -> targets -> <Target> -> options -> settings -> controlConfiguration",
    "app_popin_default": "manifest.json -> sap.fe -> macros -> table -> defaultPopinLayout",
    "annotations": "service metadata annotations (XML / ABAP CDS / CAP CDS)"
  }
}
```
--------------------------------

**TITLE**: Setting Units of Measure for OData Properties (EDMX, XML Annotations, CAP CDS)

**INTRODUCTION**: Show how to display units (measure or currency) next to numeric values in Fiori apps by: 1) declaring units directly in the OData metadata (EDMX) using sap:unit and sap:semantics, 2) annotating properties with Org.OData.Measures.V1.Unit / ISOCurrency in an XML annotation document, and 3) annotating a CAP CDS model. Use these patterns to bind numeric properties to their unit/currency sibling properties.

**TAGS**: fiori-elements-framework, odata, edmx, annotations, xml, cds, cap, units-of-measure, currency, Org.OData.Measures

STEP: 1 — Declare units in OData metadata (EDMX)

DESCRIPTION: Add sap:unit and sap:semantics attributes on numeric and unit properties inside your service $metadata EDMX (commonly metadata.xml). Use sap:unit="UnitPropertyName" on the numeric property and sap:semantics="unit-of-measure" on the corresponding unit property. For currency, use sap:semantics="currency-code" on the currency property and sap:unit on the numeric (currency) property.

LANGUAGE: XML

CODE:
```xml
<!-- Place in your service $metadata EDMX (e.g., metadata.xml) inside <Schema> -->
<EntityType Name="Product" sap:content-version="1">
    <Key>
        <PropertyRef Name="ProductID"/>
    </Key>

    <!-- Numeric/value + unit example -->
    <Property Name="WeightMeasure" Type="Edm.Decimal" Precision="13" Scale="3"
              sap:unit="WeightUnit" sap:label="Wt. Measure"/>
    <Property Name="WeightUnit" Type="Edm.String" MaxLength="3"
              sap:label="Qty. Unit" sap:semantics="unit-of-measure"/>

    <!-- Dimension example (shared unit for multiple properties) -->
    <Property Name="Width" Type="Edm.Decimal" Precision="13" Scale="3"
              sap:unit="DimUnit" sap:label="Dimensions"/>
    <Property Name="Depth" Type="Edm.Decimal" Precision="13" Scale="3"
              sap:unit="DimUnit" sap:label="Dimensions"/>
    <Property Name="Height" Type="Edm.Decimal" Precision="13" Scale="3"
              sap:unit="DimUnit" sap:label="Dimensions"/>
    <Property Name="DimUnit" Type="Edm.String" MaxLength="3"
              sap:label="Dim. Unit" sap:semantics="unit-of-measure"/>

    <!-- Currency example -->
    <Property Name="Price" Type="Edm.Decimal" Precision="16" Scale="3"
              sap:unit="CurrencyCode" sap:label="Unit Price"/>
    <Property Name="CurrencyCode" Type="Edm.String" MaxLength="5"
              sap:label="Currency" sap:semantics="currency-code"/>

    <!-- Other properties -->
    <Property Name="ProductID" Type="Edm.String" Nullable="false" MaxLength="10" sap:label="Product ID" sap:updatable="false"/>
    <!-- ... other properties and navigation properties ... -->
</EntityType>
```

STEP: 2 — Declare units with XML annotation document

DESCRIPTION: If you prefer annotations external to the EDMX or your metadata cannot include sap:unit, create an XML annotation file (e.g., annotations.xml) and add Org.OData.Measures.V1.Unit (for units) or Org.OData.Measures.V1.ISOCurrency (for currency) pointing to the unit/currency properties using Path. Target must be EntitySet/EntityType property, e.g., Namespace.Entity/Property.

LANGUAGE: XML

CODE:
```xml
<!-- annotations.xml (or embedded <Annotations> in your metadata) -->
<Annotations Target="GWSAMPLE_BASIC.Product/WeightMeasure">
    <Annotation Term="Org.OData.Measures.V1.Unit" Path="WeightUnit"/>
</Annotations>

<Annotations Target="GWSAMPLE_BASIC.Product/Width">
    <Annotation Term="Org.OData.Measures.V1.Unit" Path="DimUnit"/>
</Annotations>

<Annotations Target="GWSAMPLE_BASIC.Product/Depth">
    <Annotation Term="Org.OData.Measures.V1.Unit" Path="DimUnit"/>
</Annotations>

<Annotations Target="GWSAMPLE_BASIC.Product/Height">
    <Annotation Term="Org.OData.Measures.V1.Unit" Path="DimUnit"/>
</Annotations>

<Annotations Target="GWSAMPLE_BASIC.Product/Price">
    <Annotation Term="Org.OData.Measures.V1.ISOCurrency" Path="CurrencyCode"/>
</Annotations>
```

STEP: 3 — Annotate CAP CDS model

DESCRIPTION: In CAP CDS, add @Measures.Unit or @Measures.ISOCurrency annotations to the numeric fields to reference the unit or currency property. Place these annotate blocks in your .cds file or in a separate annotations file that is compiled with your model.

LANGUAGE: CDS

CODE:
```cds
// In your .cds file (e.g., schema.cds or annotations.cds)
annotate GWSAMPLE_BASIC.Product with {
  @Measures.Unit : WeightUnit
  WeightMeasure
};

annotate GWSAMPLE_BASIC.Product with {
  @Measures.Unit : DimUnit
  Width
};

annotate GWSAMPLE_BASIC.Product with {
  @Measures.Unit : DimUnit
  Depth
};

annotate GWSAMPLE_BASIC.Product with {
  @Measures.Unit : DimUnit
  Height
};

annotate GWSAMPLE_BASIC.Product with {
  @Measures.ISOCurrency : CurrencyCode
  Price
};
```

STEP: 4 — ABAP CDS guidance

DESCRIPTION: If you are using ABAP CDS: no sample ABAP CDS annotation is provided here. Use the XML annotation approach (step 2) as the supported alternative.

LANGUAGE: TEXT

CODE:
```text
// ABAP CDS note:
No ABAP CDS annotation sample is available. Use a local XML annotation file (see Step 2).
```

--------------------------------

**TITLE**: Object Page Header — Annotation Setup for Fiori Elements

**INTRODUCTION**: This guide shows how to define the Object Page header for SAP Fiori elements using UI vocabularies. It covers the vocabulary mappings and provides ready-to-use annotation examples for OData XML annotations, ABAP CDS, and CAP CDS. Use these examples to set title, subtitle/description, image, type name(s), initials or icon sources for the object header.

**TAGS**: fiori-elements, object-page, header, annotations, UI.HeaderInfo, CDS, ABAP, CAP, XML, OData

**STEP**: 1 — Header vocabulary mapping

**DESCRIPTION**: Map header display elements to the UI vocabulary terms used by Fiori Elements. Use these properties in OData or CDS annotations to control the Object Page header content.

- com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value — object title (primary header).
- com.sap.vocabularies.UI.v1.HeaderInfo/Description/Value — subtitle (secondary header).
- com.sap.vocabularies.UI.v1.HeaderInfo/ImageUrl — image URL for the instance.
- com.sap.vocabularies.UI.v1.HeaderInfo/TypeName — singular type label (used for back navigation link text).
- com.sap.vocabularies.UI.v1.HeaderInfo/TypeNamePlural — plural type label.
- com.sap.vocabularies.UI.v1.HeaderInfo/TypeImageUrl — icon for the object type.
- com.sap.vocabularies.UI.v1.HeaderInfo/Initials — initials (when image not available).

**LANGUAGE**: Plain

**CODE**:
```text
Vocabulary mapping (use in annotations):
- UI.HeaderInfo.Title.Value         -> primary header (string or path)
- UI.HeaderInfo.Description.Value   -> subtitle (string or path)
- UI.HeaderInfo.ImageUrl            -> image URL (path or expression)
- UI.HeaderInfo.TypeName            -> type name (string)
- UI.HeaderInfo.TypeNamePlural      -> plural type name (string)
- UI.HeaderInfo.TypeImageUrl        -> type icon URL
- UI.HeaderInfo.Initials            -> initials (string or path)

Reference: Object Page Header supports the dynamic header.
See also: ../10_More_About_Controls/object-page-header-6e340c1.md
```

**STEP**: 2 — Implement as OData XML Annotation (annotations.xml)

**DESCRIPTION**: Add a UI.HeaderInfo annotation in your service annotations (annotations.xml) to set Title, Description, ImageUrl, TypeName and TypeNamePlural. Place this annotation at the EntityType or EntitySet annotation target as required by your OData metadata.

- File example: annotations.xml (or the annotation file used by your OData service)
- Target the relevant entity/entity set with this Annotation block.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.HeaderInfo">
     <Record Type="UI.HeaderInfoType">
          <PropertyValue Property="Description">
               <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SalesOrderTypeName"/>
               </Record>
          </PropertyValue>
          <PropertyValue Property="ImageUrl" Path="ImageUrl"/>
          <PropertyValue Property="Title">
               <Record Type="UI.DataField">
                    <PropertyValue Property="Value" Path="SalesOrder"/>
               </Record>
          </PropertyValue>
          <PropertyValue Property="TypeName" String="Sales Order"/>
          <PropertyValue Property="TypeNamePlural" String="Sales Orders"/>
     </Record>
</Annotation>
```

**STEP**: 3 — Implement as ABAP CDS Annotation (CDS view file)

**DESCRIPTION**: Add the @UI.headerInfo annotation to your ABAP CDS view. This example assigns type names, image URL, Title and Description using CDS annotation syntax. Add it in the CDS view file (e.g., stta_c_mp_product.cds or your view file) close to the view declaration or in an annotate view block.

- File example: stta_c_mp_product.cds or an annotations include for the view.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.headerInfo: {
  typeName: 'Product',
  typeNamePlural: 'Products',
  imageUrl: 'PRODUCTPICTUREURL',
  title: {
    value: '_PRODUCTTEXTINCURRENTLANG.NAME',
    type: #STANDARD
  },
  description: {
    value: 'PRODUCT',
    type: #STANDARD
  }
}
annotate view STTA_C_MP_PRODUCT with {

}
```

**STEP**: 4 — Implement as CAP CDS Annotation (srv or db .cds file)

**DESCRIPTION**: Define UI.HeaderInfo in CAP CDS to attach header metadata to an entity. This can be placed in your service CDS (e.g., service.cds) or in a separate annotations CDS file that is loaded with the service.

- File example: service.cds or annotations.cds in a CAP project.

**LANGUAGE**: CAP CDS

**CODE**:
```cds
// Example annotation block in a CAP CDS file
UI.HeaderInfo : {
    TypeName : 'Product',
    TypeNamePlural : 'Products',
    ImageUrl : ProductPictureURL,
    Title : {
        $Type : 'UI.DataField',
        Value : to_ProductTextInCurrentLang.Name
    },
    Description : {
        $Type : 'UI.DataField',
        Value : Product
    }
}
```

**STEP**: 5 — Notes and related extensions

**DESCRIPTION**: Additional display options and extension points to consider:

- Dynamic header support: Use dynamic object page header when header content must react to runtime state. See ../10_More_About_Controls/object-page-header-6e340c1.md
- Images, initials, icons: For rules and formats for images, initials and icons see using-images-initials-and-icons-5760b63.md
- Custom status messages or header extensions: For extension points on object page header facets see extension-points-for-object-page-header-facets-61cf0ee.md

**LANGUAGE**: Plain

**CODE**:
```text
Related docs:
- Object Page Header details: ../10_More_About_Controls/object-page-header-6e340c1.md
- Using images, initials, and icons: using-images-initials-and-icons-5760b63.md
- Extension points for header facets: extension-points-for-object-page-header-facets-61cf0ee.md
```
--------------------------------

**TITLE**: Configuring List Report Table Editing Status and Semantic Key Fallbacks

**INTRODUCTION**: This guide shows the minimal manifest and annotation edits to ensure editing status (Draft / Unsaved / Locked) is displayed correctly in Fiori Elements List Reports and how to provide fallbacks when a semantic key is not part of LineItem. Includes examples for manifest.json (table type) and annotation patterns in CDS and OData annotation XML (EDMX) for SemanticKey and HeaderInfo Title path.

**TAGS**: fiori-elements, list-report, table, draft, semantic-key, annotations, manifest.json, odata-v2

**STEP**: 1 — Select table type in manifest.json (ResponsiveTable vs GridTable)

**DESCRIPTION**: Set the table type used by the List Report page. Editing-status display differs by table type: ResponsiveTable shows statuses in the key column; GridTable shows a separate status column next to the key column. Apply this in the page component settings of manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SalesOrderSet",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "tableType": "ResponsiveTable" // or "GridTable"
          }
        }
      }
    ]
  }
}
```

**STEP**: 2 — Add SemanticKey annotation (CDS)

**DESCRIPTION**: Add a semantic key for the entity so the List Report can show draft/lock status aligned with semantic key columns. If the semantic key is present in the LineItem, the editing status appears in the column where the first semantic key is displayed.

**LANGUAGE**: CDS

**CODE**:
```cds
namespace my.app;

entity SalesOrder {
  key SalesOrderID   : String(10);
      CustomerName   : String(50);
      TotalAmount    : Decimal(15,2);
}

annotate SalesOrder with {
  @Common: { SemanticKey: ['SalesOrderID'] }   // semantic key declaration
  @UI: {
    lineItem: [{ position: 10, label: 'Sales Order', value: SalesOrderID },
               { position: 20, label: 'Customer', value: CustomerName }],
    headerInfo: { title: { value: SalesOrderID } }
  }
}
```

**STEP**: 3 — Add SemanticKey annotation (OData annotation XML / EDMX)

**DESCRIPTION**: Equivalent SemanticKey declaration in service metadata. Use when editing annotations in XML/EDMX.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="my.app.SalesOrder">
  <Annotation Term="com.sap.vocabularies.Common.v1.SemanticKey">
    <Collection>
      <PropertyPath>SalesOrderID</PropertyPath>
    </Collection>
  </Annotation>

  <!-- UI.LineItem rows (example) -->
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value">
          <PropertyPath>SalesOrderID</PropertyPath>
        </PropertyValue>
        <PropertyValue Property="Label">
          <String>Sales Order</String>
        </PropertyValue>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value">
          <PropertyPath>CustomerName</PropertyPath>
        </PropertyValue>
        <PropertyValue Property="Label">
          <String>Customer</String>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 4 — Provide HeaderInfo title fallback when no semantic key in LineItem (CDS)

**DESCRIPTION**: If no semantic key is part of the table's LineItem, the List Report will try to show draft info in the Title (headerInfo) or Description column. Add headerInfo/title value path so the List Report has a deterministic fallback location to display draft status.

**LANGUAGE**: CDS

**CODE**:
```cds
annotate SalesOrder with {
  @UI: {
    headerInfo: {
      typeName: 'Sales Order',
      title: { value: SalesOrderID },       // fallback for draft status display
      description: { value: CustomerName }  // optional secondary fallback
    }
  }
}
```

**STEP**: 5 — Provide HeaderInfo title fallback (OData annotation XML / EDMX)

**DESCRIPTION**: Same fallback annotation in XML metadata. This ensures the list report knows which property to use for title when semantic key columns are absent.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="my.app.SalesOrder">
  <Annotation Term="UI.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeName"><String>Sales Order</String></PropertyValue>
      <PropertyValue Property="Title">
        <Record Type="UI.DataField">
          <PropertyValue Property="Value">
            <PropertyPath>SalesOrderID</PropertyPath>
          </PropertyValue>
        </Record>
      </PropertyValue>
      <PropertyValue Property="Description">
        <Record Type="UI.DataField">
          <PropertyValue Property="Value">
            <PropertyPath>CustomerName</PropertyPath>
          </PropertyValue>
        </Record>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: 6 — Ensure backend exposes draft support (OData / service-side)

**DESCRIPTION**: Draft/locking statuses are displayed only when the backend service supports draft handling. Ensure the OData service exposes the draft annotations (DraftRoot or equivalent) and draft-related properties. Example minimal EDMX annotation placeholder for DraftRoot (service-side implementation required).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: indicate draft-enabled entity (service implementation required) -->
<Annotations Target="my.app.SalesOrder">
  <Annotation Term="com.sap.vocabularies.Common.v1.DraftRoot" />
</Annotations>
```

**STEP**: 7 — Behavior summary and verification

**DESCRIPTION**: After applying annotations and manifest settings:
- ResponsiveTable: editing status shown inside the key column (if semantic key present there) or the Title/Description fallback.
- GridTable: editing status shown in a dedicated status column next to the key column.
Verify in the running app: Draft, Unsaved Changes by Another User, and Locked by Another User statuses should appear in the table following the rules above. No additional UI code is required beyond the annotations and manifest settings.
--------------------------------

**TITLE**: Object Page Table Settings in manifest.json (Fiori Elements)

**INTRODUCTION**: This document shows where and how to configure Object Page tables in a Fiori Elements app via the manifest.json. It covers common runtime options (table type, selection, row counts, variant management, export, inline create/delete) and provides ready-to-use manifest snippets you can copy and adapt for an ObjectPage|<EntitySet> entry.

**TAGS**: fiori-elements, manifest.json, object-page, table, configuration, sap.ui.generic.app

**STEP**: 1 — Locate the Object Page configuration in manifest.json

**DESCRIPTION**: Open manifest.json and navigate to the Object Page entry for the target entity set. The path is:
sap.ui.generic.app/pages/ObjectPage|<EntitySet>/component/settings

Replace <EntitySet> with your entity set name (for example, SalesOrder). All table-related settings for that page live under this settings node, typically inside sections -> blocks.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|<EntitySet>": {
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "...": "..."
          }
        }
      }
    }
  }
}
```

**STEP**: 2 — Configure an Object Page table block: basic options

**DESCRIPTION**: Add or update a block inside the target section for the Object Page. Use tableSettings to specify table type, selection, row count and threshold. The following example shows a table block for the "OrderItems" section of the "SalesOrder" Object Page. The manifestpath property is useful for navigation and tools.

- tableType: "ResponsiveTable" | "GridTable" | "AnalyticalTable"
- multiSelect: true/false
- selectionLimit: integer (max selectable rows)
- showRowCount: true/false
- threshold: integer (max rows before pagination/virtualization applies)

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|SalesOrder": {
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "sections": {
              "OrderItems::LineItems": {
                "blocks": [
                  {
                    "id": "OrderItemsTable",
                    "manifestpath": "/sap.ui.generic.app/pages/ObjectPage|SalesOrder/component/settings/sections/OrderItems::LineItems/blocks/OrderItemsTable",
                    "tableSettings": {
                      "tableType": "ResponsiveTable",
                      "multiSelect": true,
                      "selectionLimit": 10,
                      "showRowCount": true,
                      "threshold": 200
                    }
                  }
                ]
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 3 — Enable inline create / delete and creation mode

**DESCRIPTION**: For editable tables, set inlineCreate, inlineDelete and creationMode. creationMode commonly is "Inline" or "Dialog". Use inlineCreate=true to allow creating rows directly in the table.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|SalesOrder": {
        "component": {
          "settings": {
            "sections": {
              "OrderItems::LineItems": {
                "blocks": [
                  {
                    "id": "OrderItemsTable",
                    "tableSettings": {
                      "inlineCreate": true,
                      "inlineDelete": true,
                      "creationMode": "Inline"
                    }
                  }
                ]
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Enable export, personalization and variant management

**DESCRIPTION**: Turn on features that improve user productivity and persistence of table layout:

- enableExport: enable CSV/XLS export action
- useVariantManagement: enable variant management UI (save/load view variants)
- persistentVariant: persist the user's last variant on the backend or local storage (platform dependent)

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|SalesOrder": {
        "component": {
          "settings": {
            "sections": {
              "OrderItems::LineItems": {
                "blocks": [
                  {
                    "id": "OrderItemsTable",
                    "tableSettings": {
                      "enableExport": true,
                      "useVariantManagement": true,
                      "persistentVariant": true
                    }
                  }
                ]
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 5 — Analytical / Grid table specific settings

**DESCRIPTION**: Analytical and Grid tables have additional tuning parameters (visibleRowCountMode, visibleRowCount, fixedColumnCount, enableGrouping, enableColumnFreeze). Add these keys only when using that table type.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|SalesOrder": {
        "component": {
          "settings": {
            "sections": {
              "OrderItems::LineItems": {
                "blocks": [
                  {
                    "id": "OrderItemsGrid",
                    "tableSettings": {
                      "tableType": "GridTable",
                      "visibleRowCountMode": "Auto",
                      "visibleRowCount": 10,
                      "fixedColumnCount": 1,
                      "enableGrouping": true,
                      "enableColumnFreeze": true
                    }
                  }
                ]
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 6 — Complete example: combined table settings for an Object Page block

**DESCRIPTION**: A full, combined manifest.json snippet containing all common table settings for quick copy/paste. Replace SalesOrder and section/block IDs with your app-specific names.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|SalesOrder": {
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "headerFacet": {},
            "sections": {
              "OrderItems::LineItems": {
                "blocks": [
                  {
                    "id": "OrderItemsTable",
                    "manifestpath": "/sap.ui.generic.app/pages/ObjectPage|SalesOrder/component/settings/sections/OrderItems::LineItems/blocks/OrderItemsTable",
                    "tableSettings": {
                      "tableType": "ResponsiveTable",
                      "multiSelect": true,
                      "selectionLimit": 10,
                      "showRowCount": true,
                      "threshold": 200,
                      "inlineCreate": true,
                      "inlineDelete": true,
                      "creationMode": "Inline",
                      "enableExport": true,
                      "useVariantManagement": true,
                      "persistentVariant": true
                    }
                  }
                ]
              }
            }
          }
        }
      }
    }
  }
}
```

Notes:
- Update the entity set name in the ObjectPage key (ObjectPage|<EntitySet>) to match your metadata.
- The exact keys available can differ across Fiori Elements versions; confirm the set of supported keys for your SAP Fiori Elements library version. Use the manifestpath property to help tooling locate this configuration.
--------------------------------

**TITLE**: Sharing Overview Pages (Save as Tile / Send Email Link)

**INTRODUCTION**: Instructions for sharing the current state of an Overview Page: saving the current filter-state as a tile on the SAP Fiori Launchpad, or sending an email that contains a link to the current state. Use these steps to implement or automate the sharing UX.

**TAGS**: fiori-elements-framework, overview-page, sharing, launchpad, email, filters

**STEP**: Save current filter state as a tile on SAP Fiori Launchpad

**DESCRIPTION**: Persist the current state of the Overview Page (the filter bar settings) as a Launchpad tile. This stores the filter settings so the tile opens the app with the same filter state. Use this sequence in UI flows or documentation for users to save a tile.

**LANGUAGE**: text

**CODE**:
```text
User actions (UI flow):
1. On the Overview Page, locate the filter bar.
2. Click "Share" > "Save As Tile".
3. In the "Save As Tile" dialog, fill the required fields (e.g., Title, Subtitle, Tile Icon, Target URL if editable).
4. Click "OK" to save the tile to the SAP Fiori Launchpad.

Result:
- The current filter bar state is encoded and stored with the tile.
- Launching the application from the saved tile restores the stored filter state.
```

**STEP**: Share the current state by email (send link)

**DESCRIPTION**: Create an email containing a link to the current Overview Page state. The generated link includes the current filter bar state so recipients open the page with the same filters applied. Use this for implementing or automating the "Send Email" action.

**LANGUAGE**: text

**CODE**:
```text
User actions (UI flow):
1. On the Overview Page, locate the filter bar.
2. Click "Share" > "Send Email".
3. The system opens an email composer (or mail client) populated with a link to the current Overview Page including the active filter-state parameters.
4. Enter recipient(s), optionally add message text, and send the email.

Result:
- Recipient receives an email with a link that opens the app with the same filter bar state as when the email was created.
```

**STEP**: Implementation notes for automation and testing

**DESCRIPTION**: Notes to guide automation, testing, or generating documentation for developers who need to reproduce the same sharing actions programmatically or via UI tests.

**LANGUAGE**: text

**CODE**:
```text
- Ensure the Overview Page encodes filter state into the URL or tile metadata used by the Launchpad.
- For automated UI tests, follow the same UI flow: open filter bar, set filters, invoke Share > Save As Tile or Share > Send Email, and verify the stored tile or generated link restores filters.
- When validating restored state:
  1. Launch the app from the saved tile or open the generated link.
  2. Verify the filter bar values match the saved state.
- If customizing behavior, confirm Launchpad configuration supports storing tile parameters and the application reads parameters on startup to restore filter state.
```
--------------------------------

**TITLE**: Show/Hide Object Page Facets and Fields (UI.PartOfPreview)

**INTRODUCTION**: Action-oriented guide for enabling "Show More/Show Less" for reference facets and "Show Details/Hide Details" for fields inside reference facets in SAP Fiori elements by setting UI.PartOfPreview = false. Includes XML annotation, ABAP CDS, and CAP CDS examples for code insertion.

**TAGS**: fiori-elements-framework, annotations, UI.PartOfPreview, reference-facet, fieldgroup, CDS, CAP, XML, ABAP

STEP: Enable Show More / Show Less for a Reference Facet

DESCRIPTION: To allow a reference facet to be initially hidden and revealed with the Show More / Show Less controls, set the UI.PartOfPreview annotation of the UI.ReferenceFacet to false. Apply this in the annotation file (XML), ABAP CDS view annotations, or CAP CDS service/view annotations.

LANGUAGE: XML

CODE:
```xml
<!-- XML annotation: mark the ReferenceFacet as not part of preview -->
<Record Type="UI.ReferenceFacet">
    <PropertyValue Property="Label" String="{@i18n>@ShipToAddress}"/>
    <PropertyValue Property="ID" String="ShipToAddress"/>
    <PropertyValue Property="Target"
                   AnnotationPath="@UI.FieldGroup#ShipToAddress"/>
    <Annotation Term="UI.PartOfPreview" Bool="false"/>
</Record>
```

LANGUAGE: ABAP CDS

CODE:
```abap
/* ABAP CDS annotation: set isPartOfPreview = false for a FIELDGROUP_REFERENCE facet */
@UI.Facet: [{
    type         : #FIELDGROUP_REFERENCE,
    label        : 'Ship-To Address',
    targetQualifier : 'ShipToAddress',
    isPartOfPreview : false
}]
```

LANGUAGE: CAP CDS

CODE:
```cds
/* CAP CDS: ReferenceFacet not part of preview */
Facets: [{
    $Type : 'UI.ReferenceFacet',
    Label : '{@i18n>@ShipTo_NotPartOfPreview}',
    Target : '@UI.FieldGroup#ShipToAddress',
    ![@UI.PartOfPreview] : false
}]
```

STEP: Enable Show Details / Hide Details for Fields Inside a Reference Facet

DESCRIPTION: To let users expand/hide individual fields or tables inside a visible reference facet, set UI.PartOfPreview = false on the UI.DataField entries (or on data entries inside a FieldGroup). Use XML local annotations or CAP CDS. Note: this works only if the containing reference facet is visible initially (not applicable to facets that are initially hidden).

LANGUAGE: XML

CODE:
```xml
<!-- XML annotation for DataField: exclude from preview so "Show Details" appears -->
<Record Type="UI.DataField">
    <PropertyValue Property="Label" String="{@i18n>@StreetName}" />
    <PropertyValue Property="Value" Path="StreetName" />
    <Annotation Term="UI.PartOfPreview" Bool="false" />
</Record>
```

LANGUAGE: ABAP CDS

CODE:
```abap
/* No ABAP CDS sample available for per-field UI.PartOfPreview.
   Recommendation: use local XML annotation for DataField entries. */
```

LANGUAGE: CAP CDS

CODE:
```cds
/* CAP CDS: mark a Data entry inside FieldGroup as not part of preview */
FieldGroup#ShipToAddress: {
    Data: [{
        $Type                : 'UI.DataField',
        Label                : '{@i18n>@StreetName}',
        Value                : StreetName,
        ![@UI.PartOfPreview] : false
    }]
}
```

STEP: Rules, Restrictions, and Defaults

DESCRIPTION: Consolidated actionable notes to follow when adding UI.PartOfPreview annotations.

LANGUAGE: JSON

CODE:
```json
{
  "rules": [
    "Default behavior: if UI.PartOfPreview is not set, it defaults to true (i.e., shown in preview).",
    "Reference facet Show More/Show Less: applies only to reference facets implemented under a collection facet.",
    "Show Details/Hide Details for fields: applies only to fields/tables included in a visible reference facet.",
    "You cannot nest UI.PartOfPreview: you cannot mark fields inside a reference facet as partOfPreview=false if the containing reference facet itself is initially hidden (no nested toggling).",
    "Restriction: Show More/Show Less works only when the reference facet's target is a FieldGroup (form representation); it does NOT apply to facets that target tables, charts, or other target types."
  ],
  "resources": {
    "liveExamples": "https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/topic/floorplanObjectPage/showHideContent"
  }
}
```
--------------------------------

**TITLE**: Side Effect Annotations — Practical Examples for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: Collection of ready-to-use side effect annotation examples for OData V2 XML annotations, programmatic annotation creation in an MPC_EXT class (ABAP), and OData V4 / RAP ABAP CDS side effects. Use these as copy-paste templates to add side effect behavior: trigger function imports (TriggerAction), refresh properties/entities/navigation targets, react on structural changes (1:n), and configure side effects without data refresh. For further live examples and guidance see:
- SAP Fiori Global Patterns - Side Effects: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/advancedFeatures/guidance/guidanceSideEffects
- RAP Side Effects (ABAP RAP docs): https://help.sap.com/docs/abap-cloud/abap-rap/side-effects

**TAGS**: fiori-elements-framework, ODataV2, ODataV4, annotations, side-effects, XML, ABAP, CDS, TriggerAction, MPC_EXT, RAP

**STEP**: TriggerAction to calculate GrossPrice and NetPriceIncludingTax (OData V2 XML)

**DESCRIPTION**: Add a SideEffects annotation on the entity type that invokes a function import (TriggerAction) when UnitPrice or ProductQuantity are modified. Use this when you want the back-end function import CalculatePriceIncludingRegionalTax to run on validated changes. Place this XML in your local annotation file or central metadata annotations.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrder_WD_20Type">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="CalculatePrice">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>UnitPrice</PropertyPath>
                    <PropertyPath>ProductQuantity</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetProperties">
                <Collection>
                    <String>GrossPrice</String>
                    <String>NetPriceIncludingTax</String>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TriggerAction" String="STTA_SALES_ORDER_WD_20_SRV.STTA_SALES_ORDER_WD_20_SRV_Entities/CalculatePriceIncludingRegionalTax"/>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: Programmatically define Side Effects in MPC_EXT (ABAP)

**DESCRIPTION**: Use this ABAP pattern inside the DEFINE method of an MPC_EXT class to programmatically create side effect annotations (vocabulary model). The example shows creating a SideEffects annotation with SourceProperties collection entries for a purchase order entity type.

**LANGUAGE**: ABAP

**CODE**:
```ABAP
* define Side Effects for Purchase Order:
    DATA lo_ann_target TYPE REF TO /iwbep/if_mgw_vocan_ann_target.   " Vocabulary Annotation Target                     "#EC NEEDED
    DATA lo_annotation TYPE REF TO /iwbep/if_mgw_vocan_annotation.   " Vocabulary Annotation                            "#EC NEEDED
    DATA lo_collection TYPE REF TO /iwbep/if_mgw_vocan_collection.   " Vocabulary Annotation Collection                 "#EC NEEDED
    DATA lo_function   TYPE REF TO /iwbep/if_mgw_vocan_function.     " Vocabulary Annotation Function                   "#EC NEEDED
    DATA lo_fun_param  TYPE REF TO /iwbep/if_mgw_vocan_fun_param.    " Vocabulary Annotation Function Parameter         "#EC NEEDED
    DATA lo_property   TYPE REF TO /iwbep/if_mgw_vocan_property.     " Vocabulary Annotation Property                   "#EC NEEDED
    DATA lo_record     TYPE REF TO /iwbep/if_mgw_vocan_record.       " Vocabulary Annotation Record                     "#EC NEEDED
    DATA lo_reference  TYPE REF TO /iwbep/if_mgw_vocan_reference.    " Vocabulary Annotation Reference

    lo_reference = vocab_anno_model->create_vocabulary_reference( iv_vocab_id = '/IWBEP/VOC_COMMON'
                                                                  iv_vocab_version = '0001').
    lo_reference->create_include( iv_namespace = 'com.sap.vocabularies.Common.v1' ).
    lo_reference = vocab_anno_model->create_vocabulary_reference( iv_vocab_id = '/IWBEP/VOC_CORE'
                                                                  iv_vocab_version = '0001').
    lo_reference->create_include( iv_namespace = 'Org.OData.Core.V1' ).

    lo_ann_target = vocab_anno_model->create_annotations_target( 'MM_PUR_PO_AI_MAINTAIN.C_PurchaseOrderEnhWDType' ) ##NO_TEXT . "Add annotation term for VIPs introduced

    lo_annotation = lo_ann_target->create_annotation( iv_term = 'com.sap.vocabularies.Common.v1.SideEffects' ) ##NO_TEXT .

    lo_record     = lo_annotation->create_record( )  ##NO_TEXT.
    lo_property   = lo_record->create_property( 'SourceProperties' )   ##NO_TEXT.
    lo_collection = lo_property->create_collection( ).

    lo_collection->create_simple_value( )->set_property_path( 'Supplier' )  ##NO_TEXT .
    lo_collection->create_simple_value( )->set_property_path( 'CompanyCode' )  ##NO_TEXT .
    lo_collection->create_simple_value( )->set_property_path( 'DocumentCurrency' )  ##NO_TEXT .
    lo_collection->create_simple_value( )->set_property_path( 'PurchasingGroup' )  ##NO_TEXT.
    lo_collection->create_simple_value( )->set_property_path( 'PurchasingOrganization' )  ##NO_TEXT.
```

**STEP**: Refresh Price when multiple source fields or multi-input change (OData V2 XML)

**DESCRIPTION**: Define side effect that refreshes Price when Amount, Discount or a multi-input field ProductDetail/DeliveryLocations is changed.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotations Target="NAMESPACE.ENTITYTYPE">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="PriceChanged">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>Amount</PropertyPath>
                    <PropertyPath>Discount</PropertyPath>
                    <PropertyPath>ProductDetail/DeliveryLocations</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetProperties">
                <Collection>
                    <String>Price</String>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: Refresh a 1:1 navigation when supplier changes (OData V2 XML)

**DESCRIPTION**: When the Supplier property changes, refresh the 1:1 navigation target toSupplier.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotations Target="NAMESPACE.ENTITYTYPE">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="SupplierChanged">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>Supplier</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetEntities">
               <Collection>
                   <NavigationPropertyPath>toSupplier</NavigationPropertyPath>
               </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: Force whole-entity read due to field control (OData V2 XML)

**DESCRIPTION**: Use an empty NavigationPropertyPath inside TargetEntities to indicate that changing Status requires reading the whole entity (for field control scenarios).

**LANGUAGE**: XML

**CODE**:
```XML
<Annotations Target="NAMESPACE.ENTITYTYPE">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="PriceChanged">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>Status</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetEntities">
                <Collection>
                    <NavigationPropertyPath></NavigationPropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: Side effect on structural changes of a 1:n association (OData V2 XML)

**DESCRIPTION**: When subitems under toSalesOrderItems are created/deleted, refresh OverallAmount on the root entity.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotations Target="NAMESPACE.ENTITYTYPE">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="ReactOnItemCreationOrDeletion">
        <Record>
            <PropertyValue Property="SourceEntities">
                <Collection>
                    <NavigationPropertyPath>toSalesOrderItems</NavigationPropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetProperties">
                <Collection>
                    <String>OverallAmount</String>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: Side effect after executing an action (function import) — update associated entity properties and entities (OData V2 XML)

**DESCRIPTION**: Annotate a function import action (Setcurrency) to refresh an associated entity property to_Currency/Currency_Code_Text and refresh controls associated with to_Item.

**LANGUAGE**: XML

**CODE**:
```XML
<!-- Function import action "Setcurrency" refreshes Currency_Code_Text from associated entity "to_Currency", and refreshes controls associated with "to_Item" -->
<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.STTA_SALES_ORDER_WD_20_SRV_Entities/Setcurrency">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects">
        <Record>
            <PropertyValue Property="TargetProperties">
                <Collection>
                    <PropertyPath>to_Currency/Currency_Code_Text</PropertyPath>
                </Collection>
            </PropertyValue>

            <!-- Side Effects for action annotation with an entity as a target.
                 Here, controls associated with "to_Item" will be refreshed -->
            <PropertyValue Property="TargetEntities">
                <Collection>
                    <NavigationPropertyPath>to_Item</NavigationPropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: Refresh navigation target to root entity (OData V2 XML)

**DESCRIPTION**: Example 1 — when TaxAmount changes on an item, refresh the navigation target to the root entity using TargetEntities navigation path to_SalesOrder.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrderItem_WD_20Type">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="TaxAmountChanged">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                     <PropertyPath>TaxAmount</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetEntities">
               <Collection>
                     <NavigationPropertyPath>to_SalesOrder</NavigationPropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    <Annotation>
</Annotations>
```

**STEP**: Refresh all properties of the root entity (OData V2 XML)

**DESCRIPTION**: Example 2 — when TaxAmount changes on an item, refresh all properties of the root entity using TargetProperties with "to_SalesOrder/*".

**LANGUAGE**: XML

**CODE**:
```XML
<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrderItem_WD_20Type">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="TaxAmountChanged">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>TaxAmount</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TargetProperties">
                <Collection>
                    <String>to_SalesOrder/*</String>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: Side effect on 1:1 associated entity set's property (OData V2 XML template)

**DESCRIPTION**: Template: When a property on a 1:1 associated entity changes (rendered as a smart field), trigger side effect to refresh a target property on the main entity. Replace placeholders with actual schema, entity type, navigation property, and property names.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotations Target="<Schema Namespace>.<EntityType Name>">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="<Qualifier Name (Optional)>">
        <PropertyValue Property="SourceProperties">
            <Collection>
                <PropertyPath><1:1 Associated Navigation Property Name.Ex:to_Rating/Rating>/<Property Name></PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="TargetProperties">
            <Collection>
                <String><Target Property Name></String>
            </Collection>
        </PropertyValue>
    </Annotation>
</Annotations>
```

**STEP**: TriggerAction without refreshing any data (no targets) (OData V2 XML)

**DESCRIPTION**: Call a function import from a side effect (TriggerAction) solely to execute logic on the server without specifying TargetProperties or TargetEntities (no UI refresh targets).

**LANGUAGE**: XML

**CODE**:
```XML
<Annotations Target="STTA_SALES_ORDER_WD_20_SRV.C_STTA_SalesOrder_WD_20Type">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="CalculatePrice">
        <Record>
            <PropertyValue Property="SourceProperties">
                <Collection>
                    <PropertyPath>UnitPrice</PropertyPath>
                    <PropertyPath>ProductQuantity</PropertyPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TriggerAction" String="STTA_SALES_ORDER_WD_20_SRV.STTA_SALES_ORDER_WD_20_SRV_Entities/CalculatePriceIncludingRegionalTax"/>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: OData V4 / RAP ABAP CDS — side effects with actions, multiple targets, messages

**DESCRIPTION**: Use ABAP CDS side effects in RAP to declare effects of field changes and actions. This example shows field-to-field effects, entity effects, action effects, permission effects and message effects. Add the side effects block in your ABAP CDS behavior definition or appropriate CDS artifact per RAP guidance.

**LANGUAGE**: CDS

**CODE**:
```CDS
side effects {
    field IntegerValue affects field ProgressIntegerValue, field RadialIntegerValue;
    field Timestamp affects field IANATimestamp;
    field Supplier affects entity toSupplier;
    action changeCriticality affects field CriticalityCode;
    action resetTimesChildCreated affects field TimesChildCreated, permissions ( action resetTimesChildCreated );
    action overwriteTimezone affects $self;
    determine action validateDate executed on field ValidTo affects messages;
    $self affects permissions ( update _Child );
    determine action updateTimes executed on entity _Child affects field TotalPieces;
  }
```
--------------------------------

**TITLE**: Side Effects — Annotation and Extension Patterns for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: Practical, code-focused reference for implementing and annotating side effects in SAP Fiori elements apps. Includes default side effects mapping, annotation properties and formats, XML/CDS/manifest examples, and JavaScript extension API usage to register custom fields/columns as side-effect sources.

**TAGS**: side-effects, annotations, odata-v2, odata-v4, fiori-elements, XML, CDS, CAP, manifest.json, extensionAPI, registerCustomFieldForSideEffect, registerCustomColumnForSideEffect

STEP: 1 — Default side effects (mapping)
DESCRIPTION: Map of built-in UI actions to default side effect behavior (no backend annotation required).
LANGUAGE: JSON
CODE:
```json
{
  "Creating new entity or draft (list or object page)": "Refresh parent page list binding to show new entity/draft",
  "Deleting an entity (list or object page)": "Refresh parent page list binding to remove entity",
  "Creating draft for active object": "Refresh list report binding to show new draft",
  "Discarding draft": "Refresh list report binding to remove draft and show active version",
  "Activating draft": "Refresh list report binding to remove draft and show active version",
  "Triggering bound action that returns a different instance (e.g., copy)": "Refresh collection binding for the action's collection"
}
```

STEP: 2 — Side effect annotation core format & rules
DESCRIPTION: Core annotation keys, semantics and important rules for implementing side effects. Use these keys in XML/CDS annotations or local annotation files.
LANGUAGE: JSON
CODE:
```json
{
  "AnnotationTerm": "com.sap.vocabularies.Common.v1.SideEffects",
  "RecordType": "Common.SideEffectsType",
  "CommonProperties": {
    "SourceProperties": "Collection of PropertyPath elements (single or list) — triggers when focus leaves sources or value is set (controls like value help, combo box, checkbox, date pickers)",
    "SourceEntities": "NavigationPropertyPath(s) — V2: only 1:n allowed; V4: 1:1 and 1:n allowed (use absolute path for unbound actions)",
    "TargetProperties": "Collection of PropertyPath elements or 1:1 navigation properties — type strings must be quoted",
    "TargetEntities": "Collection of NavigationPropertyPath elements (1:1 or 1:n). Empty target => whole entity is updated",
    "TriggerAction (optional)": "Path to a function import/action executed when side effect triggers. Replaces deprecated PreparationAction",
    "Notes": [
      "EffectTypes is deprecated (SAPUI5 1.84+).",
      "PreparationAction is deprecated; use TriggerAction.",
      "If TriggerAction defined but no TargetProperties/TargetEntities, only action is called (no automatic refresh).",
      "Global side effects (no source defined) are supported.",
      "Validation errors on source properties prevent sending data to backend and prevent side effects."
    ]
  }
}
```

STEP: 3 — Example: EntityType and SideEffect XML annotation (OData V2 / generic)
DESCRIPTION: Entity type definition showing properties and navigation property, followed by a SideEffects annotation that lists SourceProperties and an empty TargetEntities (refresh whole entity).
LANGUAGE: XML
CODE:
```xml
<!-- EntityType definition -->
<EntityType Name="SEPMRA_I_ProductCategoryType" sap:label="Category" sap:content-version="1">
  <Key>
    <PropertyRef Name="ProductCategory"/>
  </Key>
  <Property Name="ProductCategory" Type="Edm.String" Nullable="false" MaxLength="40" sap:label="Category"/>
  <Property Name="MainProductCategory" Type="Edm.String" MaxLength="40" sap:label="Main Category" sap:value-list="fixed-values"/>
  <NavigationProperty Name="to_MainCategory" Relationship="STTA_PROD_MAN.assoc_BBDC3EA034F824A7382F8EEF561C1160"
      FromRole="FromRole_assoc_BBDC3EA034F824A7382F8EEF561C1160"
      ToRole="ToRole_assoc_BBDC3EA034F824A7382F8EEF561C1160"/>
</EntityType>

<!-- SideEffects annotation targetting entire entity (empty NavigationPropertyPath) -->
<Annotations Target="NAMESPACE.ENTITYTYPE">
  <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="ProductChanged">
    <Record>
      <PropertyValue Property="SourceProperties">
        <Collection>
          <PropertyPath>ProductCategory</PropertyPath>
          <PropertyPath>MainProductCategory</PropertyPath>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="TargetEntities">
        <Collection>
          <NavigationPropertyPath></NavigationPropertyPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 4 — OData V4: Define side effect on an unbound action (XML)
DESCRIPTION: Example XML schema that declares an unbound action, a LineItem UI action that invokes it, and a SideEffects annotation using an absolute path to refresh a full entity set.
LANGUAGE: XML
CODE:
```xml
<Schema Namespace="sap.fe.core.Service" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <EntityContainer Name="EntityContainer">
    <ActionImport Name="unBoundAction" Action="sap.fe.core.Service.unBoundAction" />
    ...
  </EntityContainer>

  <Action Name="unBoundAction" IsBound="false" />

  <Annotations Target="sap.fe.core.Service.RootEntity">
    <Annotation Term="UI.LineItem" Qualifier="sample7">
      <Collection>
        <Record Type="UI.DataFieldForAction">
          <PropertyValue Property="Label" String="Table Refresh" />
          <PropertyValue Property="Action" String="sap.fe.core.Service.EntityContainer/unBoundAction" />
          <PropertyValue Property="InvocationGrouping" EnumMember="UI.OperationGroupingType/ChangeSet" />
        </Record>
      </Collection>
    </Annotation>
  </Annotations>

  <Annotations Target="sap.fe.core.Service.UnboundAction()">
    <Annotation Term="Common.SideEffects">
      <Record Type="Common.SideEffectsType">
        <PropertyValue Property="TargetEntities">
          <Collection>
            <NavigationPropertyPath>/sap.fe.core.Service.EntityContainer/RootEntity</NavigationPropertyPath>
          </Collection>
        </PropertyValue>
      </Record>
    </Annotation>
  </Annotations>
</Schema>
```

STEP: 5 — CAP CDS: declare an unbound action with SideEffects (CAP annotations)
DESCRIPTION: CAP service CDS example showing UI LineItem with an unbound action and @Common.SideEffects annotation using absolute path to target an entity set.
LANGUAGE: CAP CDS
CODE:
```cds
// LineItem annotation with an unbound action
annotate RootEntity with @(
  UI : {
    LineItem : [
      {
        $Type             : 'UI.DataFieldForAction',
        Label             : 'My Unbound action',
        Action            : 'MyService.EntityContainer/unBoundAction',
        InvocationGrouping: #ChangeSet
      },
      { $Type: 'UI.DataField', Value: property1 },
      { $Type: 'UI.DataField', Value: property2 },
      { $Type: 'UI.DataField', Value: property3 }
    ]
  }
);

// Service and action with SideEffects targetting an entity container path
service MyService {
  @Common.SideEffects: { TargetEntities: ['/MyService.EntityContainer/RootEntity'] }
  action unBoundAction();
}
```

STEP: 6 — Value List refresh: SideEffects annotation for value list collection (absolute path)
DESCRIPTION: Use when value lists are transactional or should be invalidated by user actions. Provide an absolute TargetEntities path to the ValueListCollection.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="ChangeOfProperty">
  <Record>
    <PropertyValue Property="SourceProperties">
      <Collection>
        <PropertyPath>PropertyName</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="TargetEntities">
      <Collection>
        <NavigationPropertyPath>/Namespace.EntityContainer/ValueListCollection</NavigationPropertyPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: 7 — Extension fields in forms: registerCustomFieldForSideEffect (controller pattern)
DESCRIPTION: Register a custom extension field control so it participates as a source for side effects. Call the returned callback inside the extension field's event handler with the field name.
LANGUAGE: JavaScript
CODE:
```javascript
// Controller extension: register custom field for side effects in onAfterRendering
sap.ui.define("SOwoExt.ext.controller.ObjectPageExtension", ["sap/m/MessageBox"], function (MessageBox) {
  "use strict";
  var CustomFieldGroupChangeRegister;

  return {
    onCheckBoxEvent: function (oEvent) {
      var oView = this.getView();
      var model = oView.getModel();
      var context = oView.getBindingContext();
      var sFields = "SrcgProjNotesAreForbidden";
      var data = oEvent.getParameter("selected");

      // Update model property and notify side-effect registration callback
      model.setProperty(context.getPath() + "/" + sFields, data);
      CustomFieldGroupChangeRegister("SrcgProjNotesAreForbidden");
    },

    onAfterRendering: function () {
      var sEntitySet = "C_STTA_SalesOrder_WD_20";
      var sProperty = "SrcgProjNotesAreForbidden";
      var oControl = sap.ui.getCore().getElementById(
        "SOwoExt::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20--srcgProjNotesAreForbiddenCheckBox"
      );

      // registerCustomFieldForSideEffect(control, fieldName, entitySet)
      CustomFieldGroupChangeRegister = this.extensionAPI.registerCustomFieldForSideEffect(oControl, sProperty, sEntitySet);
    }
  };
});
```

STEP: 8 — Extension columns in tables: registerCustomColumnForSideEffect (controller pattern)
DESCRIPTION: Register a custom table column control (responsive/grid table) so the column's control triggers side effects. Call the returned callback in the column event handler.
LANGUAGE: JavaScript
CODE:
```javascript
sap.ui.define("SOwoExt.ext.controller.ObjectPageExtension", ["sap/m/MessageBox"], function (MessageBox) {
  "use strict";
  var CustomFieldGroupChangeRegister;

  return {
    onSubSectionEnteredExtension: function (subSection) {
      if (subSection.getId().indexOf("C_STTA_SalesOrder_WD_20--to_Item") !== -1) {
        var sourcingProjectItemTreeTable = this.oView.byId(
          "SOwoExt::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20--to_Item::com.sap.vocabularies.UI.v1.LineItem::responsiveTable"
        );

        sourcingProjectItemTreeTable.addEventDelegate({
          onAfterRendering: function () {
            var oControl = this.oView.byId(
              "SOwoExt::sap.suite.ui.generic.template.ObjectPage.view.Details::C_STTA_SalesOrder_WD_20--to_Item::com.sap.vocabularies.UI.v1.LineItem::responsiveTable"
            );

            // registerCustomColumnForSideEffect(oTableControl, fieldName, entitySet)
            CustomFieldGroupChangeRegister = this.extensionAPI.registerCustomColumnForSideEffect(
              oControl,
              "Raiseamount_ac",
              "C_STTA_SalesOrderItem_WD_20"
            );
          }
        }, this);
      }
    },

    onCheckBoxPressed: function () {
      // Invoke callback with FieldName when the custom column control changes
      CustomFieldGroupChangeRegister("Raiseamount_ac");
    }
  };
});
```

STEP: 9 — manifest.json: declare extension field property for OData V4 (object page target)
DESCRIPTION: When using custom extension fields with OData V4, specify the property key in manifest.json so side effects trigger on focus leave.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": { /* ... */ },
    "targets": {
      "MyObjectPage": {
        "type": "Component",
        "id": "Default",
        "name": "sap.fe.templates.ObjectPage",
        "level": 1,
        "options": {
          "settings": {
            "contextPath": "/RootEntity",
            "editableHeaderContent": true,
            "controlConfiguration": {
              "@com.sap.vocabularies.UI.v1.Identification": {
                "fields": {
                  "customFormElementIdentification1": {
                    "template": "sap.fe.core.fpmExplorer.customFormElementContent.CustomFormElement1",
                    "label": "Custom FormElement 1",
                    "property": "NameProperty"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 10 — Restrictions, gotchas and integration notes
DESCRIPTION: Compact actionable list of runtime restrictions and implementation notes to ensure correct behavior.
LANGUAGE: JSON
CODE:
```json
{
  "Validation": "No data is sent and no side effect is triggered while UI validation errors exist for source properties.",
  "SourcePropertiesRestrictions": "Cannot use navigation properties as source properties in general. V2: Use property list or virtual field group; trigger on focus-out.",
  "SourceEntitiesRestrictions": "V2: only 1:n navigation property allowed as source. V4: 1:1 and 1:n allowed. Do not use a 1:1 association or blank NavigationPropertyPath where you intend the whole entity as source.",
  "TargetPropertiesFormatting": "Values in TargetProperties must be quoted strings; 1:1 navigation properties supported and will cause $expand.",
  "TargetEntitiesPaging": "TargetEntities that are 1:n may not consider paging in V2 (requests are not sent by table binding) — use carefully.",
  "GlobalSideEffects": "Allowed (no sources specified).",
  "TriggerAction": "Use TriggerAction to invoke function import/action; replaces PreparationAction.",
  "NonDraftApps": "Side effects with source properties in non-draft apps trigger after a successful Save action. Structural changes on items tables trigger side effects when configured as source.",
  "TextArrangement": "When using text arrangement + value list, provide a side-effect annotation to update text when key changes."
}
```
--------------------------------

**TITLE**: Smart Controls for SAP Fiori elements (OData V2)

**INTRODUCTION**: Practical, code-focused examples showing how to configure and use Smart Controls (Smart Table, Smart Filter Bar, Smart Field, Smart Link, Smart Form) with OData V2 annotations. Includes annotation XML, manifest wiring, and example UI5 XML snippets for custom use. Use these snippets to enable list report behavior or to create custom pages that reuse Fiori Elements smart controls.

**TAGS**: fiori-elements, ODataV2, smart-controls, smart-table, smart-filterbar, smart-field, smart-link, smart-form, annotations, manifest

**STEP**: 1 — Create OData V2 annotation file (annotations/annotations.xml)

**DESCRIPTION**: Add an annotations XML file that defines UI annotations for the target entity set (example: Products). The file includes UI.LineItem (Smart Table columns), UI.SelectionFields (Smart Filter Bar), DataFieldWithIntentBasedNavigation (Smart Link behavior), and a FieldGroup (Smart Form / grouped fields). Place this file under webapp/annotations or app/annotations and reference it from the manifest (next step).

**LANGUAGE**: XML

**CODE**:
```XML
<?xml version="1.0" encoding="utf-8"?>
<edmx:Edmx Version="1.0"
    xmlns:edmx="http://schemas.microsoft.com/ado/2007/06/edmx">
  <!-- Annotation file containing UI vocabulary usage for OData V2 -->
  <edmx:Reference Uri="http://docs.oasis-open.org/odata/odata/v4.0/cs01/vocabularies/Org.OData.Core.V1.xml"/>
  <edmx:Reference Uri="http://sap.com/xi/SAPGlobal20/Global">
    <!-- references if needed -->
  </edmx:Reference>

  <Annotations Target="MyService.Products" xmlns="http://docs.oasis-open.org/odata/ns/edm"
             xmlns:ui="http://schemas.sap.com/odata/annotations/ui"
             xmlns:com="http://docs.oasis-open.org/odata/odata/v4.0/cs01/vocabularies/Org.OData.Core.V1"
             xmlns:common="http://schemas.sap.com/odata/4.0/common">
    <!-- Smart Table columns -->
    <Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
      <Collection>
        <Record Type="com.sap.vocabularies.UI.v1.DataField">
          <PropertyValue Property="Value">
            <Path>ProductID</Path>
          </PropertyValue>
          <PropertyValue Property="Label" String="Product ID" />
        </Record>

        <Record Type="com.sap.vocabularies.UI.v1.DataField">
          <PropertyValue Property="Value">
            <Path>ProductName</Path>
          </PropertyValue>
          <PropertyValue Property="Label" String="Name" />
        </Record>

        <Record Type="com.sap.vocabularies.UI.v1.DataField">
          <PropertyValue Property="Value">
            <Path>Category</Path>
          </PropertyValue>
          <PropertyValue Property="Label" String="Category" />
        </Record>

        <Record Type="com.sap.vocabularies.UI.v1.DataField">
          <PropertyValue Property="Value">
            <Path>Price</Path>
          </PropertyValue>
          <PropertyValue Property="Label" String="Price" />
          <PropertyValue Property="DisplayFormat" String="Amount" />
        </Record>

        <!-- Smart Link: open intent-based navigation on ProductName -->
        <Record Type="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation">
          <PropertyValue Property="Value">
            <Path>ProductName</Path>
          </PropertyValue>
          <PropertyValue Property="SemanticObject" String="Product" />
          <PropertyValue Property="Action" String="display" />
          <PropertyValue Property="Label" String="Name (Navigate)" />
        </Record>
      </Collection>
    </Annotation>

    <!-- Smart Filter Bar fields -->
    <Annotation Term="com.sap.vocabularies.UI.v1.SelectionFields">
      <Collection>
        <PropertyPath>ProductName</PropertyPath>
        <PropertyPath>Category</PropertyPath>
        <PropertyPath>Price</PropertyPath>
      </Collection>
    </Annotation>

    <!-- Smart Form: group fields for a form/Facet usage -->
    <Annotation Term="com.sap.vocabularies.UI.v1.FieldGroup" Qualifier="MainForm">
      <Record Type="com.sap.vocabularies.UI.v1.FieldGroupType">
        <PropertyValue Property="Data">
          <Collection>
            <Record Type="com.sap.vocabularies.UI.v1.DataField">
              <PropertyValue Property="Value"><Path>ProductID</Path></PropertyValue>
              <PropertyValue Property="Label" String="Product ID"/>
            </Record>
            <Record Type="com.sap.vocabularies.UI.v1.DataField">
              <PropertyValue Property="Value"><Path>ProductName</Path></PropertyValue>
              <PropertyValue Property="Label" String="Name"/>
            </Record>
            <Record Type="com.sap.vocabularies.UI.v1.DataField">
              <PropertyValue Property="Value"><Path>Category</Path></PropertyValue>
              <PropertyValue Property="Label" String="Category"/>
            </Record>
          </Collection>
        </PropertyValue>
        <PropertyValue Property="Label" String="Main Product Details"/>
      </Record>
    </Annotation>
  </Annotations>
</edmx:Edmx>
```

**STEP**: 2 — Reference annotation file in manifest.json (webapp/manifest.json)

**DESCRIPTION**: Wire the annotation file to the OData V2 service in the manifest so Fiori elements can consume it. Use dataSources settings -> annotations array for OData V2. Adjust "uri" to your backend OData service and path to annotations file.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "sap.app": {
    "id": "my.app.products",
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/ZMY_SERVICE_SRV/",
        "type": "OData",
        "settings": {
          "odataVersion": "2.0",
          "annotations": [
            {
              "uri": "annotations/annotations.xml"
            }
          ]
        }
      }
    }
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      }
    }
  }
}
```

**STEP**: 3 — Use Smart Table and Smart Filter Bar in a custom XML view (if not using standard List Report)

**DESCRIPTION**: If building a custom page (instead of the Fiori elements standard List Report), include SmartTable and SmartFilterBar controls and reference the same entitySet used in annotations. Use the control IDs to link SmartTable.smartFilterId to SmartFilterBar.

**LANGUAGE**: XML

**CODE**:
```XML
<mvc:View controllerName="my.app.controller.Products" xmlns:mvc="sap.ui.core.mvc"
          xmlns="sap.m"
          xmlns:smartTable="sap.ui.comp.smarttable"
          xmlns:smartFilterBar="sap.ui.comp.smartfilterbar">
  <App>
    <Page title="Products">
      <content>
        <VBox>
          <!-- Smart Filter Bar uses the SelectionFields annotation -->
          <smartFilterBar:SmartFilterBar id="SFB1"
                                         entitySet="Products"
                                         persistencyKey="ProductsFilter"
                                         enableBasicSearch="true" />

          <!-- Smart Table uses the LineItem annotation to build columns -->
          <smartTable:SmartTable id="ST1"
                                 entitySet="Products"
                                 smartFilterId="SFB1"
                                 tableType="Table"
                                 useExportToExcel="true"
                                 enableAutoBinding="true"
                                 header="Products"
                                 showRowCount="true" />
        </VBox>
      </content>
    </Page>
  </App>
</mvc:View>
```

**STEP**: 4 — Use SmartField inside columns or forms (UI5 XML snippet)

**DESCRIPTION**: SmartField renders input/display based on metadata and annotations. Use it inside table columns, form groups, or custom fragments. SmartField automatically reads ValueList annotation (if provided) and respects property metadata.

**LANGUAGE**: XML

**CODE**:
```XML
<ColumnListItem xmlns="sap.m" xmlns:smartField="sap.ui.comp.smartfield">
  <cells>
    <Text text="{ProductID}" />
    <!-- SmartField for editable/display behavior based on metadata -->
    <smartField:SmartField value="{path: 'ProductName'}" />
    <smartField:SmartField value="{path: 'Category'}" />
    <smartField:SmartField value="{path: 'Price'}" />
  </cells>
</ColumnListItem>
```

**STEP**: 5 — SmartLink example: enable intent navigation on a field

**DESCRIPTION**: SmartLink control (or DataFieldWithIntentBasedNavigation in annotations) enables semantic object navigation. The annotation example above already defines intent-based navigation on ProductName. For a custom UI5 view use sap.ui.comp.smartlink.SmartLink and set semanticObject.

**LANGUAGE**: XML

**CODE**:
```XML
<!-- SmartLink in a custom fragment or column template -->
<smartlink:SmartLink xmlns:smartlink="sap.ui.comp.smartlink"
                     semanticObject="Product"
                     press=".onNavToProduct"
                     text="{ProductName}" />
```

**STEP**: 6 — SmartForm example (UI5 Custom SmartForm)

**DESCRIPTION**: Use sap.ui.comp.smartform.SmartForm to render grouped fields. The FieldGroup annotation qualifier (MainForm) can be used by custom controllers/logic to bind the group; if you need direct control, create a SmartForm and SmartGroup with SmartFields, which will use property metadata and the same value binding used by smart controls.

**LANGUAGE**: XML

**CODE**:
```XML
<smartform:SmartForm xmlns:smartform="sap.ui.comp.smartform"
                     xmlns:smartgroup="sap.ui.comp.smartform"
                     xmlns:smartfield="sap.ui.comp.smartfield"
                     editable="false"
                     id="SmartFormProducts">
  <smartform:groups>
    <smartform:Group>
      <smartform:groupElements>
        <smartform:GroupElement>
          <smartfield:SmartField value="{ProductID}" />
        </smartform:GroupElement>
        <smartform:GroupElement>
          <smartfield:SmartField value="{ProductName}" />
        </smartform:GroupElement>
        <smartform:GroupElement>
          <smartfield:SmartField value="{Category}" />
        </smartform:GroupElement>
      </smartform:groupElements>
    </smartform:Group>
  </smartform:groups>
</smartform:SmartForm>
```

**STEP**: 7 — Notes and best practices

**DESCRIPTION**: Quick implementation notes for developers:

- Ensure the manifest JSON references the annotation XML and the OData service (odataVersion: "2.0").
- Use the same entitySet name in annotations and Smart control properties (entitySet="Products").
- Prefer annotations (annotations.xml) for Fiori elements List Report standard behavior; use custom Smart controls in XML views only when customization is required.
- For navigation, prefer DataFieldWithIntentBasedNavigation in annotations (semantic object + action) or use SmartLink in custom views.
- SmartField respects metadata (edm types, creatable/updatable) and ValueList annotations — provide ValueList annotation if you need dropdowns / value help.

**LANGUAGE**: PlainText

**CODE**:
```TEXT
File locations suggested:
- webapp/annotations/annotations.xml   (annotations file)
- webapp/manifest.json                (manifest wiring)
- webapp/view/Products.view.xml       (custom view using Smart controls)
```

--------------------------------

**TITLE**: Smart Table Extensions for Analytical List Page (ALP) — Controller, Columns, and Row Navigation

**INTRODUCTION**: This document shows exactly how to implement ALP (Analytical List Page) smart table extensions for SAP Fiori elements (OData V2). It covers: registering controller extensions in manifest.json, implementing onBeforeRebindTableExtension to modify table binding, adding custom AnalyticalTable columns via viewExtensions + XML fragment, and implementing onListNavigationExtension for row-level conditional navigation (including external navigation using navigateExternal()).

**TAGS**: fiori-elements-framework, sapui5, AnalyticalListPage, ALP, manifest.json, controllerExtensions, viewExtensions, fragment, OData V2, table, navigation

STEP: 1 — Register controller extension in manifest.json

DESCRIPTION: Add a controller extension entry under sap.ui5 → extends → extensions → sap.ui.controllerExtensions to point ALP’s AnalyticalListPage controller to your extension controller implementation file (JS module). This enables ALP to call extension hooks such as onBeforeRebindTableExtension and onListNavigationExtension.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "_version": "1.1.0",
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.controller.AnalyticalListPage": {
            "controllerName": "sap.poc.ftu.apps.alr.ext.controller.AnalyticalListPageExt"
          }
        }
      }
    }
  }
}
```

STEP: 2 — Implement onBeforeRebindTableExtension in extension controller

DESCRIPTION: Create the controller module referenced in manifest (path above). Implement onBeforeRebindTableExtension(oEvent) to run app-specific logic before the table is rebound. Use oEvent to access binding parameters and add filters or parameters to the table query. Return nothing — ALP expects you to modify binding params on the event object.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/ext/controller/AnalyticalListPageExt.controller.js
sap.ui.define([
    "sap/ui/model/Filter",
    "sap/ui/model/FilterOperator"
], function(Filter, FilterOperator) {
    "use strict";

    return {
        /**
         * Called by ALP before the table rebinding. Modify binding params here.
         * @param {sap.ui.base.Event} oEvent
         */
        onBeforeRebindTableExtension: function(oEvent) {
            // Example: obtain binding params to append a custom filter
            var oBindingParams = oEvent.getParameter && oEvent.getParameter("bindingParams") || oEvent.getSource && oEvent.getSource().getBinding && oEvent.getSource().getBinding("rows");

            // If using the event parameter convention
            if (oBindingParams && oBindingParams.filters) {
                // Add a filter: MyField = 'FixedValue'
                oBindingParams.filters.push(new Filter("MyField", FilterOperator.EQ, "FixedValue"));
            }

            // Simple debug example
            // alert("onBeforeRebindTableExtension called!");
        }
    };
});
```

STEP: 3 — Register a custom column fragment in manifest.json (view extension)

DESCRIPTION: Use sap.ui.viewExtensions to extend the ALP view and inject a fragment that defines one or more AnalyticalTable columns. The key name must follow the pattern: "AnalyticalTableColumnsExtension|<EntitySetName>". Provide className ("sap.ui.core.Fragment"), fragmentName (your fragment module), and type ("XML").

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "_version": "1.1.0",
    "extends": {
      "extensions": {
        "sap.ui.viewExtensions": {
          "sap.suite.ui.generic.template.AnalyticalListPage.view.AnalyticalListPage": {
            "AnalyticalTableColumnsExtension|CZ_EASILINEITEMS_SADL": {
              "className": "sap.ui.core.Fragment",
              "fragmentName": "sap.poc.ftu.apps.alr.ext.fragment.CustomColumn",
              "type": "XML"
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — Create the XML fragment that defines the custom AnalyticalTable column(s)

DESCRIPTION: Implement an XML fragment file at the fragmentName path used above. Define the AnalyticalColumn(s), label, template (cell content), and p13n customData for column key/index so ALP personalization works.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/ext/fragment/CustomColumn.fragment.xml -->
<core:FragmentDefinition
    xmlns:core="sap.ui.core"
    xmlns="sap.m"
    xmlns:table="sap.ui.table">
    <table:AnalyticalColumn width="150px" autoResizable="true">
        <!-- Column header -->
        <Label text="My Extended Column" />
        <!-- Cell template: put data-bound control here -->
        <table:template>
            <Label text="{MyServiceModel>MyField}" /> <!-- Bind to your model/entity property -->
        </table:template>
        <!-- Provide p13n metadata so column personalization works -->
        <table:customData>
            <core:CustomData
                key="p13nData"
                value='{"columnKey": "Test", "columnIndex": "1"}' />
        </table:customData>
    </table:AnalyticalColumn>
</core:FragmentDefinition>
```

STEP: 5 — Implement onListNavigationExtension for conditional row navigation

DESCRIPTION: In the same controller extension module, implement onListNavigationExtension(oEvent). Use this to decide per-row navigation target based on the selected row context. Use extensionAPI.getNavigationController().navigateExternal(target) for external navigation. Return true to prevent further default navigation, or return false to let ALP perform its standard navigation.

LANGUAGE: JavaScript

CODE:
```javascript
// Include this in the same controller module from Step 2
return {
    // ... existing methods ...

    /**
     * Conditional navigation for rows. Return true to prevent default ALP navigation.
     * @param {sap.ui.base.Event} oEvent
     * @returns {boolean}
     */
    onListNavigationExtension: function(oEvent) {
        var oNavigationController = this.extensionAPI && this.extensionAPI.getNavigationController && this.extensionAPI.getNavigationController();
        var oBindingContext = oEvent.getSource && oEvent.getSource().getBindingContext && oEvent.getSource().getBindingContext();
        var oObject = oBindingContext && oBindingContext.getObject && oBindingContext.getObject();

        if (!oObject || !oNavigationController) {
            // Not able to determine target, let ALP handle navigation
            return false;
        }

        // Example conditional navigation:
        if (oObject.CostCenter === "300-1000") {
            // External target semantic object/action defined in your inbound configuration
            oNavigationController.navigateExternal("ActualCostsKPIDetails");
            // Prevent default internal navigation
            return true;
        } else {
            // Return false to allow default ALP internal navigation to the object page
            return false;
        }
    }
};
```

STEP: 6 — Notes and prerequisites

DESCRIPTION: Quick checklist and important notes for implementation:
- Applicable only for SAP Fiori elements for OData V2 (ALP OData V2).
- Files to modify/create:
  - manifest.json (sap.ui5 → extends → extensions → sap.ui.controllerExtensions and sap.ui.viewExtensions)
  - Extension controller module (e.g., webapp/ext/controller/AnalyticalListPageExt.controller.js)
  - XML fragment(s) for columns (e.g., webapp/ext/fragment/CustomColumn.fragment.xml)
- Use this.extensionAPI.getNavigationController().navigateExternal() to perform external navigation when needed.
- Ensure fragmentName and controllerName use your application namespace and paths exactly as referenced in manifest.json.


--------------------------------

**TITLE**: Stack Cards (sap.ovp) — Configure Stack Card + Object Stream for Fiori Elements

**INTRODUCTION**: This document shows how to configure an OVP stack card in manifest.json (sap.ovp) and how to model the OData metadata relationships required for the object stream (quick view cards). Use this when you want a stack card that aggregates items of the same type and opens an object stream (up to 20 quick view cards) with optional footer navigation/actions.

**TAGS**: fiori-elements-framework, sap.ovp, stack-card, object-stream, quick-view, manifest.json, $metadata, OData, annotations

STEP: 1 — Add stack card to manifest.json (sap.ovp)
DESCRIPTION: Add a stack card entry under sap.ovp -> cards in your application manifest.json. Key settings:
- model: data model name (e.g., "salesOrder")
- template: must be "sap.ovp.cards.stack"
- settings.title / subTitle: display text for card left-hand section (header opens app/object stream)
- requireAppAuthorization: app nav intent (optional)
- itemText: custom placeholder text appended to placeholder card message
- entitySet: dominant EntitySet for stack (e.g., "SalesOrderSet")
- identificationAnnotationPath: the UI identification annotation path used to render quick view card content (can include qualifier)
- objectStreamCardsSettings.showFirstActionInFooter: boolean flag (default false). If true, the first footer action of the quick view card becomes a navigation action; if false the navigation action is not shown in the quick view footer (other actions remain)
- objectStreamCardsNavigationProperty: optional navigation property to display info from a secondary entity set (not used for quick view cards)

LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card00": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.stack",
        "settings": {
          "title": "Stack Card Title",
          "subTitle": "Stack Card",
          "requireAppAuthorization": "#Action-toappnavsample",
          "itemText": "items awaiting approval",
          "entitySet": "SalesOrderSet",
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification,com.sap.vocabularies.UI.v1.Identification#item2",
          "objectStreamCardsSettings": {
            "showFirstActionInFooter": false
          }
        }
      }
    }
  }
}
```

STEP: 2 — objectStreamCardsSettings: showFirstActionInFooter usage (examples)
DESCRIPTION: Control whether the first footer action of quick view cards in the object stream becomes a navigation action. Default = false.
- showFirstActionInFooter: false -> do not show navigation action in quick view footer; show other actions instead.
- showFirstActionInFooter: true -> the first footer action will be a navigation action.

LANGUAGE: JSON
CODE:
```json
// Example: showFirstActionInFooter = true
{
  "sap.ovp": {
    "cards": {
      "card00": {
        "settings": {
          "objectStreamCardsSettings": {
            "showFirstActionInFooter": true
          }
        }
      }
    }
  }
}
```

STEP: 3 — Behavior & UX rules (configuration implications)
DESCRIPTION: Implementation and UX rules you must handle or expect:
- Object stream shows up to 20 quick view cards for a stack. Click right-hand count area to open the object stream.
- Placeholder card: appears only when the object stream contains exactly 20 quick view cards; it provides additional information and is displayed as the last card in the object stream. The count shown on the stack card excludes this placeholder card.
- Clicking the left-hand header (title/subTitle) or the "View All" entry must navigate to the application destination (same target as object stream header navigation).
- Quick view cards can include actions (confirm, reject, etc.) and a navigation link. The object stream header is navigable and must navigate to the same destination as the stack card header.

LANGUAGE: JSON
CODE:
```json
// No additional code required. UX rules apply to the stack card and object stream behavior configured above.
```

STEP: 4 — OData metadata: required navigation property & association (service $metadata)
DESCRIPTION: If the stack card shows items from a secondary entity set via a navigation property, ensure your OData $metadata exposes:
- NavigationProperty from primary EntityType to secondary EntityType (e.g., BusinessPartner -> ToSalesOrders)
- Association and AssociationSet linking the two EntitySets
- EntitySets declared in the EntityContainer

Place this in your service $metadata (metadata.xml). The example below shows BusinessPartner -> SalesOrder relationship, with entity sets BusinessPartnerSet and SalesOrderSet and association Assoc_BusinessPartner_SalesOrders / Assoc_BusinessPartner_SalesOrders_AssocS.

LANGUAGE: XML
CODE:
```xml
<EntityType Name="BusinessPartner" sap:content-version="1">
    <Key>
        <PropertyRef Name="BusinessPartnerID"/>
    </Key>
    <Property Name="Address" Type="GWSAMPLE_BASIC.CT_Address" Nullable="false"/>
    <Property Name="BusinessPartnerID" Type="Edm.String" Nullable="false" MaxLength="10" sap:label="Bus. Part. ID" sap:creatable="false" sap:updatable="false"/>
    <Property Name="CompanyName" Type="Edm.String" MaxLength="80" sap:label="Company Name"/>
    <Property Name="WebAddress" Type="Edm.String" sap:label="Web Address" sap:sortable="false" sap:filterable="false" sap:semantics="url"/>
    <Property Name="EmailAddress" Type="Edm.String" MaxLength="255" sap:label="E-Mail Address" sap:semantics="email"/>
    <Property Name="PhoneNumber" Type="Edm.String" MaxLength="30" sap:label="Phone No." sap:semantics="tel"/>
    <Property Name="FaxNumber" Type="Edm.String" MaxLength="30" sap:label="Fax Number"/>
    <Property Name="LegalForm" Type="Edm.String" MaxLength="10" sap:label="Legal Form"/>
    <Property Name="CurrencyCode" Type="Edm.String" MaxLength="5" sap:label="Currency" sap:semantics="currency-code"/>
    <Property Name="BusinessPartnerRole" Type="Edm.String" MaxLength="3" sap:label="Bus. Part. Role"/>
    <Property Name="CreatedAt" Type="Edm.DateTime" Precision="7" sap:label="Time Stamp" sap:creatable="false" sap:updatable="false"/>
    <Property Name="ChangedAt" Type="Edm.DateTime" Precision="7" ConcurrencyMode="Fixed" sap:label="Time Stamp" sap:creatable="false" sap:updatable="false"/>
    <NavigationProperty Name="ToSalesOrders" Relationship="GWSAMPLE_BASIC.Assoc_BusinessPartner_SalesOrders" FromRole="FromRole_Assoc_BusinessPartner_SalesOrders" ToRole="ToRole_Assoc_BusinessPartner_SalesOrders"/>
    <NavigationProperty Name="ToContacts" Relationship="GWSAMPLE_BASIC.Assoc_BusinessPartner_Contacts" FromRole="FromRole_Assoc_BusinessPartner_Contacts" ToRole="ToRole_Assoc_BusinessPartner_Contacts"/>
    <NavigationProperty Name="ToProducts" Relationship="GWSAMPLE_BASIC.Assoc_BusinessPartner_Products" FromRole="FromRole_Assoc_BusinessPartner_Products" ToRole="ToRole_Assoc_BusinessPartner_Products"/>
</EntityType>

<EntityType Name="SalesOrder" sap:content-version="1">
    <Key>
        <PropertyRef Name="SalesOrderID"/>
    </Key>
    <Property Name="SalesOrderID" Type="Edm.String" Nullable="false" MaxLength="10" sap:label="Sa. Ord. ID" sap:creatable="false" sap:updatable="false"/>
    <Property Name="SalesOrderGuid" Type="Edm.Guid" Nullable="false" sap:label="SalesOrder GUID" sap:creatable="false" sap:updatable="false"/>
    <Property Name="Note" Type="Edm.String" MaxLength="255" sap:label="Description" sap:updatable="false" sap:sortable="false" sap:filterable="false"/>
    <Property Name="NoteLanguage" Type="Edm.String" MaxLength="1" sap:label="Language" sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false"/>
    <Property Name="CustomerID" Type="Edm.String" MaxLength="10" sap:label="Bus. Part. ID" sap:updatable="false"/>
    <Property Name="CustomerName" Type="Edm.String" MaxLength="80" sap:label="Company Name" sap:creatable="false" sap:updatable="false"/>
    <Property Name="CurrencyCode" Type="Edm.String" MaxLength="5" sap:label="Currency" sap:updatable="false" sap:semantics="currency-code"/>
    <Property Name="GrossAmount" Type="Edm.Decimal" Precision="16" Scale="3" sap:unit="CurrencyCode" sap:label="Gross Amt." sap:creatable="false" sap:updatable="false"/>
    <Property Name="NetAmount" Type="Edm.Decimal" Precision="16" Scale="3" sap:unit="CurrencyCode" sap:label="Net Amt." sap:creatable="false" sap:updatable="false"/>
    <Property Name="TaxAmount" Type="Edm.Decimal" Precision="16" Scale="3" sap:unit="CurrencyCode" sap:label="Tax Amt." sap:creatable="false" sap:updatable="false"/>
    <Property Name="LifecycleStatus" Type="Edm.String" MaxLength="1" sap:label="PO Lifecycle" sap:creatable="false" sap:updatable="false"/>
    <Property Name="LifecycleStatusDescription" Type="Edm.String" MaxLength="60" sap:label="Lifecycle Descript." sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false"/>
    <Property Name="BillingStatus" Type="Edm.String" MaxLength="1" sap:label="PO Confirmation" sap:creatable="false" sap:updatable="false"/>
    <Property Name="BillingStatusDescription" Type="Edm.String" MaxLength="60" sap:label="Billing Description" sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false"/>
    <Property Name="DeliveryStatus" Type="Edm.String" MaxLength="1" sap:label="PO Ordering" sap:creatable="false" sap:updatable="false"/>
    <Property Name="DeliveryStatusDescription" Type="Edm.String" MaxLength="60" sap:label="Delivery Description" sap:creatable="false" sap:updatable="false" sap:sortable="false" sap:filterable="false"/>
    <Property Name="CreatedAt" Type="Edm.DateTime" Precision="7" sap:label="Time Stamp" sap:creatable="false" sap:updatable="false"/>
    <Property Name="ChangedAt" Type="Edm.DateTime" Precision="7" sap:label="Time Stamp" sap:creatable="false" sap:updatable="false"/>
    <NavigationProperty Name="ToBusinessPartner" Relationship="GWSAMPLE_BASIC.Assoc_BusinessPartner_SalesOrders" FromRole="ToRole_Assoc_BusinessPartner_SalesOrders" ToRole="FromRole_Assoc_BusinessPartner_SalesOrders"/>
    <NavigationProperty Name="ToLineItems" Relationship="GWSAMPLE_BASIC.Assoc_SalesOrder_SalesOrderLineItems" FromRole="FromRole_Assoc_SalesOrder_SalesOrderLineItems" ToRole="ToRole_Assoc_SalesOrder_SalesOrderLineItems"/>
</EntityType>

<Association Name="Assoc_BusinessPartner_SalesOrders" sap:content-version="1">
    <End Type="GWSAMPLE_BASIC.BusinessPartner" Multiplicity="1" Role="FromRole_Assoc_BusinessPartner_SalesOrders"/>
    <End Type="GWSAMPLE_BASIC.SalesOrder" Multiplicity="*" Role="ToRole_Assoc_BusinessPartner_SalesOrders"/>
    <ReferentialConstraint>
        <Principal Role="FromRole_Assoc_BusinessPartner_SalesOrders">
            <PropertyRef Name="BusinessPartnerID"/>
        </Principal>
        <Dependent Role="ToRole_Assoc_BusinessPartner_SalesOrders">
            <PropertyRef Name="CustomerID"/>
        </Dependent>
    </ReferentialConstraint>
</Association>

<EntityContainer Name="GWSAMPLE_BASIC_Entities" m:IsDefaultEntityContainer="true">
    <EntitySet Name="BusinessPartnerSet" EntityType="GWSAMPLE_BASIC.BusinessPartner" sap:content-version="1"/>
    <EntitySet Name="SalesOrderSet" EntityType="GWSAMPLE_BASIC.SalesOrder" sap:updatable="false" sap:content-version="1"/>
    <AssociationSet Name="Assoc_BusinessPartner_SalesOrders_AssocS" Association="GWSAMPLE_BASIC.Assoc_BusinessPartner_SalesOrders" sap:creatable="false" sap:updatable="false" sap:deletable="false" sap:content-version="1">
        <End EntitySet="BusinessPartnerSet" Role="FromRole_Assoc_BusinessPartner_SalesOrders"/>
        <End EntitySet="SalesOrderSet" Role="ToRole_Assoc_BusinessPartner_SalesOrders"/>
    </AssociationSet>
</EntityContainer>
```

STEP: 5 — identificationAnnotationPath and quick view content
DESCRIPTION: Use an identification annotation (UI.V1.Identification) to specify which properties are shown inside each quick view card. Reference the annotation in the manifest via identificationAnnotationPath. The manifest example uses an annotation string with qualifier: "com.sap.vocabularies.UI.v1.Identification,com.sap.vocabularies.UI.v1.Identification#item2"
- Ensure the annotation exists in your service annotations file or metadata annotation provider.
- Quick view cards will render according to this identification; actions and navigation defined in annotations or card configuration will be available in the object stream.

LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card00": {
        "settings": {
          "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification,com.sap.vocabularies.UI.v1.Identification#item2"
        }
      }
    }
  }
}
```

STEP: 6 — Quick checklist before deployment
DESCRIPTION: Validate these points:
- manifest.json (sap.ovp) contains the stack card configuration and the correct entitySet.
- identificationAnnotationPath points to an existing UI identification annotation (with proper qualifier if used).
- $metadata exposes the navigation property, association, and association set if you use objectStreamCardsNavigationProperty.
- Test object stream: it should display up to 20 quick view cards; placeholder only appears when there are 20 cards; verify footer navigation behavior according to showFirstActionInFooter.

LANGUAGE: JSON
CODE:
```json
// Example validation items (no runtime code).
{
  "validation": [
    "manifest -> sap.ovp -> cards -> cardXX present",
    "settings.entitySet exists in $metadata EntityContainer",
    "identificationAnnotationPath is valid and annotation exists",
    "objectStreamCardsSettings.showFirstActionInFooter behaves as expected",
    "object stream returns up to 20 items; placeholder appears only when item count == 20"
  ]
}
```
--------------------------------

**TITLE**: Stacked Bar Micro Chart — UI.Chart & UI.DataPoint Annotations (XML, ABAP CDS, CAP CDS)

**INTRODUCTION**: Implementation reference for adding a Stacked Bar micro chart via UI.Chart and UI.DataPoint annotations. Includes action-oriented samples for XML OData annotations, ABAP CDS, and CAP CDS. Use when you need to present a configured measure as a percentage-stacked bar in Fiori elements. Preserve the rule that chart dimensions and measures must come from a 1:n navigation entity (cannot be the same entity).

**TAGS**: fiori-elements-framework, UI.Chart, UI.DataPoint, StackedBar, BarStacked, annotations, CDS, CAP, XML, ABAP

STEP: 1 — Key constraints and mapping rules

DESCRIPTION: Summary of constraints and mapping requirements you must enforce when creating the chart and datapoint annotations.

LANGUAGE: text

CODE:
```text
- Chart dimensions and measures cannot be from the same entity; they must come from a 1:n navigation entity.
- Mapping requirement: The same property must be referenced in:
  1) UI.Chart -> Measures collection (PropertyPath)
  2) UI.Chart -> MeasureAttributes -> Measure (PropertyPath)
  3) UI.DataPoint -> Value
  If these do not all point to the same entity property, the chart will not behave correctly.
- UI.Chart Title -> chart title; UI.Chart Description -> chart subtitle.
- Use ChartType = BarStacked (UI.ChartType/BarStacked or #BAR_STACKED/#BarStacked) for stacked bar micro charts.
```

STEP: 2 — UI.Chart annotation (XML OData annotations)

DESCRIPTION: XML annotation to define a Stacked Bar chart with one measure. Copy into your annotation XML file (examples use Qualifier "SalesPriceStackedBarChart"). Ensure Measure, MeasureAttributes, and DataPoint Value reference the same property.

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.Chart" Qualifier="SalesPriceStackedBarChart">
    <Record Type="UI.ChartDefinitionType">
        <PropertyValue Property="Title" String="Sales Price"/>
        <PropertyValue Property="Description" String="Stacked BarChart"/>
        <PropertyValue Property="ChartType" EnumMember="UI.ChartType/BarStacked"/>
        <PropertyValue Property="Measures">
            <Collection>
                <PropertyPath>Width</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="MeasureAttributes">
            <Collection>
                <Record Type="UI.ChartMeasureAttributeType">
                    <PropertyValue Property="Measure" PropertyPath="Width"/>
                    <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                    <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Width"/>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 3 — UI.Chart annotation (ABAP CDS)

DESCRIPTION: ABAP CDS syntax to annotate a view with a stacked bar chart. Place this at the top-level of a CDS view annotation block. Replace 'WIDTH' and view name with your property/view.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.Chart: [
  {
    title: 'Sales Price',
    description: 'Stacked BarChart',
    chartType: #BAR_STACKED,
    measures: [
      'WIDTH'
    ],
    measureAttributes: [
      {
        measure: 'Width',
        role: #AXIS_1,
        asDataPoint: true
      }
    ],
    qualifier: 'SalesPriceStackedBarChart'
  }
]
annotate view STTA_C_MP_PRODUCT with {
  // additional annotations or left empty if handled elsewhere
}
```

STEP: 4 — UI.Chart annotation (CAP CDS)

DESCRIPTION: CAP CDS annotation example using the UI namespace. Use this in your .cds file to define the chart. Ensure Measure and DataPoint mapping match.

LANGUAGE: CDS

CODE:
```cds
UI.Chart #SalesPriceStackedBarChart : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Sales Price',
    Description : 'Stacked BarChart',
    ChartType : #BarStacked,
    Measures : [
        Width
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : Width,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#Width'
        }
    ]
}
```

STEP: 5 — UI.DataPoint annotation (XML OData annotations)

DESCRIPTION: XML DataPoint annotation that provides the Value and Criticality for the measure. The DataPoint qualifier must match the Chart MeasureAttributes DataPoint reference (example uses qualifier "Width").

LANGUAGE: XML

CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Width">
    <Record>
        <PropertyValue Property="Value" Path="Width"/>
        <PropertyValue Property="Criticality" Path="criticalityValue"/>
    </Record>
</Annotation>
```

STEP: 6 — UI.DataPoint annotation (ABAP CDS)

DESCRIPTION: ABAP CDS inline DataPoint annotation example. Place in the field list or annotation area so that the Width property is annotated with criticality.

LANGUAGE: ABAP CDS

CODE:
```abap
@UI.dataPoint: {
  criticality: 'criticalityValue'
}
Width;
```

STEP: 7 — UI.DataPoint annotation (CAP CDS)

DESCRIPTION: CAP CDS DataPoint example. Add to your .cds definition so the DataPoint qualifier matches Chart.MeasureAttributes.DataPoint.

LANGUAGE: CDS

CODE:
```cds
UI.DataPoint #Width : {
    Value : Width,
    Criticality : criticalityValue
}
```

STEP: 8 — Quick implementation checklist

DESCRIPTION: Action checklist to validate before deployment.

LANGUAGE: text

CODE:
```text
- Verify Chart qualifier matches usage in UI.ListReport/page / UI.Facet (where applicable).
- Confirm Measures and MeasureAttributes reference the same property (e.g., Width).
- Confirm UI.DataPoint qualifier matches the MeasureAttributes.DataPoint annotationPath (e.g., @UI.DataPoint#Width).
- Ensure ChartType is BarStacked/#BAR_STACKED/#BarStacked depending on syntax.
- Ensure measure and dimension are from a 1:n navigation entity (not same entity).
- Test in SAP Fiori preview (e.g., https://ui5.sap.com) to validate rendering.
```
--------------------------------

**TITLE**: Stacked Column Chart Card (SAPUI5 / VizFrame) — Implementation Guide

**INTRODUCTION**: Show how to implement a stacked column chart card using SAPUI5 VizFrame. Covers data shape, two stacking strategies (by measures or by series dimension), required feed mappings (category, value, color/series), and how to apply a color palette for semantic coloring. Use these snippets as ready-to-use files in a typical SAPUI5 project (webapp folder).

**TAGS**: fiori-elements-framework, sapui5, vizframe, stacked-column, charts, semantic-coloring, OVP, card

**STEP**: 1 — Add sample data model
**DESCRIPTION**: Create a JSON data model for local testing. The dataset contains:
- Category: required dimension mapped to x-axis (axis category).
- Series: optional dimension to create stacks from a single measure (use when stacking by series).
- MeasureA / MeasureB: numeric measures used when stacking by measures (multiple measures stacked on top of each other).

Save as webapp/model/data.json and load as JSONModel in the app.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "items": [
    { "Category": "Q1", "Series": "Product A", "MeasureA": 120, "MeasureB": 80 },
    { "Category": "Q1", "Series": "Product B", "MeasureA": 70,  "MeasureB": 50 },
    { "Category": "Q2", "Series": "Product A", "MeasureA": 150, "MeasureB": 90 },
    { "Category": "Q2", "Series": "Product B", "MeasureA": 60,  "MeasureB": 40 },
    { "Category": "Q3", "Series": "Product A", "MeasureA": 200, "MeasureB": 120 },
    { "Category": "Q3", "Series": "Product B", "MeasureA": 90,  "MeasureB": 70 }
  ]
}
```

**STEP**: 2 — XML view with VizFrame (common dataset + feeds)
**DESCRIPTION**: Single XML view template used for both stacking strategies. Important:
- Ensure at least one DimensionDefinition representing the category (Category) and bind it to categoryAxis feed.
- Optional Series dimension (Series) can be added and mapped to the color feed to stack by series.
- When stacking by measures, include multiple MeasureDefinition entries and bind them to valueAxis.
- When stacking by series, include a single measure and use the Series dimension for the color feed.
Save as webapp/view/StackedColumn.view.xml.
**LANGUAGE**: XML
**CODE**:
```xml
<mvc:View
  controllerName="my.namespace.controller.StackedColumn"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:viz="sap.viz.ui5.controls"
  xmlns:viz.data="sap.viz.ui5.data"
  xmlns:viz.feeds="sap.viz.ui5.controls.common.feeds">
  <Page title="Stacked Column Chart">
    <content>
      <viz:VizFrame id="idVizFrame" vizType="stacked_column" uiConfig="{applicationSet:'fiori'}" width="100%" height="400px">
        <viz:dataset>
          <viz.data:FlattenedDataset data="{/items}">
            <viz.data:dimensions>
              <!-- REQUIRED: category dimension (x-axis) -->
              <viz.data:DimensionDefinition name="Category" value="{Category}" />
              <!-- OPTIONAL: series dimension for stacking by series -->
              <viz.data:DimensionDefinition name="Series" value="{Series}" />
            </viz.data:dimensions>
            <viz.data:measures>
              <!-- Use multiple measures to stack by measures -->
              <viz.data:MeasureDefinition name="Measure A" value="{MeasureA}" />
              <viz.data:MeasureDefinition name="Measure B" value="{MeasureB}" />
              <!-- Or use a single measure when stacking by the Series dimension above -->
            </viz.data:measures>
          </viz.data:FlattenedDataset>
        </viz:dataset>

        <!-- FEEDS: crucial to map dimension/measure roles to chart axes/legend -->
        <!-- categoryAxis: maps the Category dimension to the x-axis -->
        <viz.feeds:FeedItem uid="categoryAxis" type="Dimension" values="Category" />
        <!-- valueAxis: maps measures to the y-axis (stacked values) -->
        <viz.feeds:FeedItem uid="valueAxis" type="Measure" values="Measure A,Measure B" />
        <!-- color (series): when present, maps the Series dimension to color/stack segments -->
        <viz.feeds:FeedItem uid="color" type="Dimension" values="Series" />
      </viz:VizFrame>
    </content>
  </Page>
</mvc:View>
```

**STEP**: 3 — Controller: bind model and configure properties (color palette / semantic coloring)
**DESCRIPTION**: Load the JSONModel, set it on the view, and configure vizProperties:
- plotArea.colorPalette: use explicit hex values or semantic color tokens to enable semantic coloring.
- Do not mix stacking strategies: either provide multiple measures (stacking by measures) OR provide a single measure + Series dimension (stacking by series).
Save as webapp/controller/StackedColumn.controller.js.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/ui/model/json/JSONModel"
], function (Controller, JSONModel) {
  "use strict";

  return Controller.extend("my.namespace.controller.StackedColumn", {
    onInit: function () {
      // Load sample data model
      var oModel = new JSONModel(sap.ui.require.toUrl("my/namespace/model/data.json"));
      this.getView().setModel(oModel);

      // Configure VizFrame properties (apply color palette for semantic coloring)
      var oVizFrame = this.byId("idVizFrame");
      oVizFrame.setVizProperties({
        plotArea: {
          // Use any palette of hex colors or semantic tokens
          colorPalette: ["#4CAF50", "#FFC107", "#F44336", "#2196F3"]
        },
        title: {
          visible: false
        },
        // Category axis formatting
        categoryAxis: {
          title: { visible: true, text: "Category (x-axis)" }
        },
        valueAxis: {
          title: { visible: true, text: "Values (y-axis)" }
        }
      });

      // Optionally add a popover (tooltip) or interaction (omitted for brevity)
    }
  });
});
```

**STEP**: 4 — Two recommended stacking configurations (how to choose and configure)
**DESCRIPTION**: Use one of the two approaches below. Do not mix them in a single chart.

- A) Stacking by Measures (multiple measures stacked)
  - Dataset: include multiple MeasureDefinition entries (MeasureA, MeasureB, ...).
  - Feeds: map all measures to the valueAxis feed (valueAxis type="Measure").
  - Do not set Series dimension in the color feed.
  - Use when different measures represent stack segments.

- B) Stacking by Series (single measure stacked by dimension values)
  - Dataset: include a single MeasureDefinition (e.g., Sales).
  - Include the Series DimensionDefinition and map it to the color feed (uid="color", type="Dimension").
  - Use when one measure is split by a categorical series (e.g., product types).

**LANGUAGE**: JSON
**CODE**:
```json
{
  "A_StackByMeasures": {
    "dimensions": ["Category"],
    "measures": ["MeasureA", "MeasureB"],
    "feeds": {
      "categoryAxis": "Category",
      "valueAxis": ["MeasureA","MeasureB"],
      "color": []  // no series dimension
    }
  },
  "B_StackBySeries": {
    "dimensions": ["Category","Series"],
    "measures": ["Sales"],
    "feeds": {
      "categoryAxis": "Category",
      "valueAxis": ["Sales"],
      "color": ["Series"]  // Series drives stacks
    }
  }
}
```

**STEP**: 5 — Implementation notes and best practices
**DESCRIPTION**:
- Mandatory: At least one dimension assigned to the category role (x-axis).
- Optional: A dimension assigned to the series role can be used for stacking (map that dimension to the color feed).
- All measures provided in the dataset will be stacked on top of each other when mapped to the valueAxis feed.
- Recommendation: Use either stacking by multiple measures OR stacking by a series dimension — avoid mixing both in the same chart card to keep semantics clear.
- Semantic coloring: supply plotArea.colorPalette for consistent semantic colors or use theme tokens and hex colors depending on your visual requirements.
- File paths used in examples:
  - webapp/model/data.json
  - webapp/view/StackedColumn.view.xml
  - webapp/controller/StackedColumn.controller.js
--------------------------------

**TITLE**: Status Colors and Icons (UI Criticality for LineItem / Identification / FieldGroup)

**INTRODUCTION**: Show how to annotate fields with a criticality property so SAP Fiori elements renders status colors and optional icons. Use these annotations in UI.LineItem, UI.Identification, and UI.FieldGroup. The Criticality attribute must point to another property that stores the numeric criticality value; Value points to the display text.

**TAGS**: fiori-elements-framework, annotations, UI, criticality, icons, colors, CDS, ODataV4

**STEP**: 1 — XML UI Annotation for LineItem (set Criticality and Value paths)

**DESCRIPTION**: Add a UI.LineItem annotation that references a separate property for Criticality (numeric code) and a property for the displayed text (Value). Example: refer to a navigation property to_ProductStock for both criticality and value.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.LineItem">
  <Collection>
    <Record Type="UI.DataField">
      <!-- Criticality path: numeric value (0..3 or 5 for OData V4) -->
      <PropertyValue Property="Criticality" Path="to_ProductStock/StockCriticality"/>
      <!-- Visible text/value for the ObjectStatus -->
      <PropertyValue Property="Value" Path="to_ProductStock/StockEmergencyLevel"/>
      <!-- Importance optional -->
      <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High"/>
    </Record>
  </Collection>
</Annotation>
```

**STEP**: 2 — ABAP CDS UI Annotation (LineItem)

**DESCRIPTION**: Equivalent ABAP CDS syntax for embedding criticality and value in a line item. Use the criticality reference to the corresponding association/property.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.lineItem: [
  {
    criticality: '_ProductStock.StockCriticality',
    value: '_ProductStock.StockEmergencyLevel',
    importance: #HIGH
  }
]
```

**STEP**: 3 — CAP CDS UI Annotation (LineItem)

**DESCRIPTION**: CAP CDS JSON-like syntax for the same mapping. Use $Type = 'UI.DataField', set Criticality and Value to the referenced paths, and annotate importance.

**LANGUAGE**: CDS (CAP)

**CODE**:
```cdd
UI.LineItem : [
  {
    $Type : 'UI.DataField',
    Criticality : to_ProductStock.StockCriticality,
    Value : to_ProductStock.StockEmergencyLevel,
    ![@UI.Importance] : #High
  }
]
```

**STEP**: 4 — Criticality numeric values mapping (vocabulary: com.sap.vocabularies.UI.v1 CriticalityType)

**DESCRIPTION**: The property referenced by Criticality must contain one of these numeric values. Fiori elements maps the value to color and (by default) to an icon.

**LANGUAGE**: TEXT

**CODE**:
```
CriticalityType mapping:
  0 - Neutral
  1 - Negative (red)
  2 - Critical (orange)
  3 - Positive (green)

OData V4 additional value:
  5 - Information (blue)  <-- supported in SAP Fiori elements for OData V4
```

**STEP**: 5 — Icon rendering behavior and customization

**DESCRIPTION**: Default icon behavior and how to render with or without an icon. The ObjectStatus uses a status icon by default for each CriticalityType (e.g., com.sap.vocabularies.UI.v1.CriticalityType/Negative -> 'sap-icon://status-negative'). To render without an icon, mark the field with CriticalityRepresentationType/WithoutIcon. Texts on the status are dynamic — provide them via the Value path.

**LANGUAGE**: TEXT

**CODE**:
```
Notes:
- By default, Fiori elements assumes CriticalityRepresentationType/WithIcon and will set the ObjectStatus icon (e.g., status-negative).
- If the field is marked with CriticalityRepresentationType/WithoutIcon, the ObjectStatus is rendered without the icon.
- Provide dynamic texts by using the PropertyValue "Value" path (e.g., to_ProductStock/StockEmergencyLevel).
- Vocabulary reference: com.sap.vocabularies.UI.v1::CriticalityType
```

**STEP**: 6 — Visual reference (example image used in documentation)

**DESCRIPTION**: Use this example image to verify how statuses render in List Report and Object Page for stock availability.

**LANGUAGE**: TEXT

**CODE**:
```
Image path:
images/LROP_Status_Colors_and_Icons_75aa307.png
```
--------------------------------

**TITLE**: Store and Restore the Application State (iAppState) — SAP Fiori elements

**INTRODUCTION**: This reference documents what the iAppState mechanism stores/restores in SAP Fiori elements apps, describes variant and layer-merge behavior for OData V2/V4, lists restrictions, and gives concise, code-focused examples for adding custom state and for annotating sensitive properties. Use these examples when implementing custom state handling, extension logic, or debugging iAppState payloads.

**TAGS**: fiori-elements, iAppState, app-state, state-persistence, odata-v2, odata-v4, custom-state, flexibility, annotations

**STEP**: 1 — What iAppState stores (logical schema)

**DESCRIPTION**: The iAppState payload contains (at minimum) the parts listed here. Use this JSON schema as a checklist for what the framework stores/restores and as a template when adding custom data from an extension.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "filters": {
    "FilterFieldTechnicalName": {
      "value": "abc",        // single or multi-value as array
      "operator": "EQ",      // when applicable
      "controlState": {      // control-specific state if needed
        "goButtonState": "enabled"
      }
    }
  },
  "variant": {
    "id": "VariantIdOrKey",
    "label": "My Variant",
    "isDirty": false,
    "managementType": "sap.ui.fl"  // indicates where variant is stored/managed
  },
  "listReport": {
    "columns": [
      { "name": "Column1", "visible": true, "position": 0 },
      { "name": "Column2", "visible": false, "position": 1 }
    ],
    "tablePersonalization": {
      "sorters": [ /* ... */ ],
      "grouping": null
    }
  },
  "objectPage": {
    "selectedSection": "DetailsSectionId",
    "chartPersonalization": { /* ... */ },
    "tablePersonalization": { /* ... */ }
  },
  "customUI": {
    "myCustomControlKey": {
      "someState": 123,
      "selection": [ "A", "B" ]
    }
  },
  "meta": {
    "timestamp": "2025-02-01T12:34:56Z",
    "source": "iAppState"
  }
}
```

**STEP**: 2 — Variant handling rules (OData V2 vs OData V4)

**DESCRIPTION**: Use these rules when deciding how to present/restore variants in UI and when merging variants from other layers.

- OData V2: chosen variant is restored only if it was stored in a "clean" state. If marked as "dirty" when stored, restore falls back to the Standard variant but with a dirty indicator.
- OData V4: chosen variant is always restored. Fallback to Standard happens only if the chosen variant is not available for the target user at restore time.

**LANGUAGE**: JSON

**CODE**:
```json
// Example: variant object used by framework logic when applying iAppState
{
  "variant": {
    "id": "user-variant-123",
    "label": "MySavedView",
    "isDirty": false,          // V2: if true -> don't restore variant; V4: still restore if available
    "availableForUser": true
  }
}
```

**STEP**: 3 — Adding custom UI state to iAppState (extension pattern)

**DESCRIPTION**: When you extend an app and want to persist custom control state inside the iAppState, add a compact JSON subtree under a unique key (e.g., custom.<componentId>). On restore, read that subtree and reapply. The framework will merge the custom subtree with other parts of the iAppState.

- Hook points: implement custom logic in your extension controller/component to serialize/deserialize custom UI state.
- Keep payload small and deterministic.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// PSEUDOCODE: store custom state into the iAppState payload the framework will persist
function getCustomStateForAppState() {
  return {
    "custom.myExtension": {
      "myWidgetSelection": ["item1", "item2"],
      "myWidgetSettings": {
        "mode": "compact",
        "threshold": 10
      }
    }
  };
}

// PSEUDOCODE: merge this with the framework state just before saving
function onBeforeAppStateSave(frameworkState) {
  var customState = getCustomStateForAppState();
  // Merge shallow: frameworkState.custom = {...frameworkState.custom, ...customState}
  frameworkState.custom = Object.assign({}, frameworkState.custom || {}, customState);
  return frameworkState;
}

// PSEUDOCODE: restore custom state on app state restore
function onAfterAppStateRestore(restoredState) {
  var c = restoredState && restoredState.custom && restoredState.custom["custom.myExtension"];
  if (c) {
    // reapply to your controls
    applyMyWidgetSelection(c.myWidgetSelection);
    applyMyWidgetSettings(c.myWidgetSettings);
  }
}
```

**STEP**: 4 — Example iAppState restore flow and merge rules (pseudocode)

**DESCRIPTION**: When restoring, the framework merges data from other flex layers with user iAppState values. The end-user values in iAppState generally take precedence for single-valued fields. Exceptions apply (see next steps).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// PSEUDOCODE: simplify the merge/priority logic
function mergeLayerChanges(flexLayerChanges, iAppState) {
  // For single-valued fields: iAppState wins
  var merged = Object.assign({}, flexLayerChanges);
  Object.keys(iAppState.filters || {}).forEach(function(key) {
    merged.filters = merged.filters || {};
    merged.filters[key] = iAppState.filters[key];
  });
  // For table/column additions/removals: if variant from iAppState not available -> don't merge flex
  if (!isVariantAvailable(iAppState.variant)) {
    // apply full page state from iAppState on top of standard => flex-layer removals/position changes not retained
    merged = Object.assign({}, merged, iAppState);
  } else {
    // merge individual structures (columns, personalization)
    merged.listReport = mergeListReport(merged.listReport, iAppState.listReport);
  }
  return merged;
}
```

**STEP**: 5 — Restrictions and important notes (actionable checklist)

**DESCRIPTION**: Use this checklist in code reviews and tests to ensure expected behavior:

- Sensitive fields annotated with PersonalData.v1.IsPotentiallySensitive are not stored/restored (unless used in filter context). See annotation example below.
- OData V2: visibility changes of filter fields are not stored/restored; additions with values from Adapt Filters ARE stored.
- Order of smart filter fields is NOT stored/restored in OData V2.
- Selections inside charts/tables and table scroll positions are NOT persisted.
- If the SAP Fiori launchpad is NOT configured to persist iAppState in the back end, a browser refresh will not restore iAppState.
- Drilldown filters from chart "View By" are NOT stored/restored in OData V4.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: annotate a property as potentially sensitive (annotation XML) -->
<Annotations Target="MyService.MyEntity/ConfidentialProperty">
  <Annotation Term="PersonalData.v1.IsPotentiallySensitive" Bool="true"/>
</Annotations>
```

**STEP**: 6 — Exceptions: dynamic tiles and integration cards

**DESCRIPTION**: When navigation originates from:
- dynamic tiles created by the user (*Save as Tile*), or
- integration cards,

the framework does NOT merge changes from other flex layers with the iAppState; the intent is to return to the same app state as when tile/card was created. In these scenarios:
- Removed filter fields or table columns are not retained/restored.
- Changes in positions of filter fields or table columns are not retained/restored.

**LANGUAGE**: JSON

**CODE**:
```json
// Example flag indicating special handling when coming from tile/card
{
  "meta": {
    "navigationSource": "DynamicTile", // or "IntegrationCard"
    "applyLayerMerging": false
  }
}
```

**STEP**: 7 — Security and sharing behavior

**DESCRIPTION**: Sharing a URL restores the iAppState included in that URL. Note:
- If a variant referenced by the shared iAppState is not available to the recipient, the app loads the Standard variant and applies the page state from the iAppState on top — this can cause removed columns/positions not to be retained.
- Any filter value coming from other layers can be overwritten by values in the SAP Fiori launchpad (see default filter values configuration).

**LANGUAGE**: JSON

**CODE**:
```json
// Example: a shared URL embeds an appStateKey which maps to this payload server-side/back-end
{
  "appStateKey": "sap-iappstate-xxxx",
  "iAppStatePayload": { /* as shown earlier */ }
}
```

**STEP**: 8 — References (paths to related topics)

**DESCRIPTION**: Use these topics for implementation details, extension patterns, and security configuration.

**LANGUAGE**: TEXT

**CODE**:
```text
- The Share Functionality: the-share-functionality-022bf0d.md
- Enabling Discovery/Persistence Mode (Object Page): enabling-discovery-persistence-mode-7c62084.md
- Custom State Handling for Extended Apps: custom-state-handling-for-extended-apps-89fa878.md
- Security Configuration: security-configuration-ba0484b.md
- Configuring Default Filter Values: configuring-default-filter-values-f27ad7b.md
- SAPUI5 Flexibility (layer merging): ../04_Essentials/sapui5-flexibility-adapting-uis-made-easy-a8e55aa.md
- Topic reference where this section appears: store-restore-the-application-state-46bf248.md
```

**STEP**: 9 — Quick test checklist for developers

**DESCRIPTION**: Run through this checklist when verifying iAppState behavior after changes:

- [ ] Save a filter variant and verify it restores after navigation/refresh.
- [ ] Save a variant marked dirty (OData V2) and verify fallback behavior to Standard.
- [ ] Add a custom control state via extension; save & restore and assert round-trip equality.
- [ ] Confirm sensitive fields (annotated) are not included in saved payload.
- [ ] Verify behavior when coming from Dynamic Tile / Integration Card (no flex merge).
- [ ] Test sharing URL to another user who lacks the variant: check Standard variant + page state behavior.
- [ ] Test browser refresh when FLP persistence is disabled: iAppState should NOT restore.


--------------------------------

**TITLE**: Support for Extended OData Annotations (SAP Fiori elements — OData V4)

**INTRODUCTION**: This document shows how to use the extended OData annotation features supported by SAP Fiori elements for OData V4. It is action-oriented and focused on exact annotation XML samples you can copy into your annotation XML files (for example: webapp/annotations/annotations.xml) and reference from manifest.json. Supported usages include IF-expressions for specific annotations and the odata.concat function for object page header titles.

**TAGS**: fiori-elements-framework, odata-v4, annotations, IF-Expressions, FieldControl, UpdateRestrictions, InsertRestriction, DeleteRestriction, Core.OperationAvailable, odata.concat, HeaderInfo

**STEP**: 1 — Supported Annotations and Features

**DESCRIPTION**: Use IF-expression evaluation (OData IF) in annotations for conditional metadata-driven UI behavior. This support is available only for SAP Fiori elements for OData V4. The following annotation targets/terms accept IF-expressions and extended evaluation:

- com.sap.vocabularies.Common.v1.FieldControl (FieldControl)
- com.sap.vocabularies.UI.v1.Hidden (UI.Hidden)
- com.sap.vocabularies.Common.v1.OperationAvailable (Core.OperationAvailable)
- SAP__capabilities.UpdateRestrictions
- SAP__capabilities.InsertRestriction
- SAP__capabilities.DeleteRestriction

Place these annotation snippets in your annotation XML file (e.g., webapp/annotations/annotations.xml) and reference them in manifest.json dataSources.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Supported annotations (put this info in your annotations file or use the examples below) -->
<!-- Supported IF-expression annotations:
     - com.sap.vocabularies.Common.v1.FieldControl
     - com.sap.vocabularies.UI.v1.Hidden
     - com.sap.vocabularies.Common.v1.OperationAvailable
     - SAP__capabilities.UpdateRestrictions
     - SAP__capabilities.InsertRestriction
     - SAP__capabilities.DeleteRestriction
-->
```

**STEP**: 2 — Example: FieldControl with If-expression

**DESCRIPTION**: Use the FieldControl annotation with an If expression to set field editability dynamically. Place this annotation under the relevant entity or property target in your annotation file. The example below evaluates whether the property FieldControlDynamicIfValue equals 5; if true it uses ReadOnly, otherwise Optional.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="sap.fe.core.FieldEdit.RootEntity/FieldControlDynamicIf">
    <Annotation Term="com.sap.vocabularies.Common.v1.FieldControl">
        <If>
            <Eq>
                <Path>FieldControlDynamicIfValue</Path>
                <Int>5</Int>
            </Eq>
            <EnumMember>Common.FieldControlType/ReadOnly</EnumMember>
            <EnumMember>Common.FieldControlType/Optional</EnumMember>
        </If>
    </Annotation>
</Annotations>
```

**STEP**: 3 — Example: UpdateRestrictions (with embedded If-expression and complex navigation restriction)

**DESCRIPTION**: Use UpdateRestrictions and InsertRestrictions inside NavigationRestrictions to control create/update behavior based on entity values or paths. The example below demonstrates a navigation property restriction for navigation property _Item with Insertable bound to owner/isVerified and Updatable determined by an If expression that checks owner/isVerified for null or empty string. Use this pattern to bind capability booleans to data-driven paths or conditional expressions.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="Capabilities.NavigationRestrictions">
    <Record Type="Capabilities.NavigationRestrictionsType">
        <PropertyValue Property="RestrictedProperties">
            <Collection>
                <Record Type="Capabilities.NavigationPropertyRestriction">
                    <PropertyValue Property="NavigationProperty" NavigationPropertyPath="_Item" />
                    <PropertyValue Property="InsertRestrictions">
                        <Record Type="Capabilities.InsertRestrictionsType">
                            <!-- Bind Insertable to a path: owner/isVerified -->
                            <PropertyValue Property="Insertable" Path="owner/isVerified" />
                        </Record>
                    </PropertyValue>
                    <PropertyValue Property="UpdateRestrictions">
                        <Record Type="Capabilities.UpdateRestrictionsType">
                            <PropertyValue Property="Updatable">
                                <!-- If-expression: if owner/isVerified is null OR empty => false, else true -->
                                <If>
                                    <Or>
                                        <Eq>
                                            <Null />
                                            <Path>owner/isVerified</Path>
                                        </Eq>
                                        <Eq>
                                            <String />
                                            <Path>owner/isVerified</Path>
                                        </Eq>
                                    </Or>
                                    <Bool>false</Bool>
                                    <Bool>true</Bool>
                                </If>
                            </PropertyValue>
                        </Record>
                    </PropertyValue>
                </Record>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

**STEP**: 4 — Example: Use odata.concat in Object Page Header Title

**DESCRIPTION**: Use the odata.concat function in a HeaderInfo.Title expression to concatenate text and property values for the object page header. The sample below concatenates CompanyName + (separator) + LegalForm. Replace CompanyName and LegalForm with your entity properties. The record is attached to the entity target (e.g., SAP__self.BusinessPartner).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="SAP__self.BusinessPartner">
    <Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo">
        <Record Type="com.sap.vocabularies.UI.v1.HeaderInfoType">
            <PropertyValue Property="TypeName" String="Business Partner" />
            <PropertyValue Property="TypeNamePlural" String="Business Partners" />
            <PropertyValue Property="Title">
                <Record Type="com.sap.vocabularies.UI.v1.DataField">
                    <PropertyValue Property="Label" String="Name" />
                    <PropertyValue Property="Value">
                        <Apply Function="odata.concat">
                            <Path>CompanyName</Path>
                            <!-- Optional separator string -->
                            <String> </String>
                            <Path>LegalForm</Path>
                        </Apply>
                    </PropertyValue>
                </Record>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 5 — Usage Notes and Integration Tips

**DESCRIPTION**: Implementation tips:
- This feature applies only to SAP Fiori elements for OData V4 apps.
- Add these snippets into your annotation file (e.g., webapp/annotations/annotations.xml) and reference the annotation file in manifest.json under sap.ui5 -> models/dataSources -> annotation URI.
- Use exact Term names (com.sap.vocabularies.* or SAP__capabilities.*) as shown.
- IF-expressions and odata.concat examples can be adapted to other annotation targets (UI.Hidden, Core.OperationAvailable, etc.) following the same pattern. Validate your annotation XML against the OData vocabulary schema if tooling reports errors.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example manifest.json snippet to reference annotations (update paths and names to match your project) -->
{
  "sap.app": {
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/Y_SERVICE_SRV/",
        "type": "OData",
        "settings": { "annotations": ["localAnnotations"] }
      },
      "localAnnotations": {
        "uri": "annotations/annotations.xml",
        "type": "ODataAnnotation"
      }
    }
  }
}
```
--------------------------------

**TITLE**: Enable and Use Terminologies for SAP Fiori elements (OData V4) via app descriptor i18n models

**INTRODUCTION**: This guide shows exactly how to configure resource models with terminologies in the app descriptor (manifest.json) and how to register those models with SAP Fiori elements templates via enhanceI18n. Use this to switch UI wording by scenario/industry with additional resource bundles. Applicable only to SAP Fiori elements for OData V4.

**TAGS**: fiori-elements, SAPUI5, terminologies, i18n, manifest.json, OData V4, app-descriptor

STEP: 1 — Add a resource model with terminologies to the app descriptor (manifest.json)

DESCRIPTION: Add or update the "models" section in your manifest.json to define a ResourceModel (for example "i18n") and include a "terminologies" key. Each terminology entry must include bundleUrl (path to terminology properties file), bundleUrlRelativeTo (typically "manifest"), and supportedLocales (array). Keep bundleUrl exact (for example: i18n/terminologies/travel/i18n.terminologies.travel.properties).

LANGUAGE: JSON

CODE:
```json
{
  "models": {
    "i18n": {
      "type": "sap.ui.model.resource.ResourceModel",
      "settings": {
        "bundleUrl": "i18n/i18n.properties",
        "supportedLocales": ["en", "de"],
        "fallbackLocale": "en",
        "terminologies": {
          "travel": {
            "bundleUrl": "i18n/terminologies/travel/i18n.terminologies.travel.properties",
            "bundleUrlRelativeTo": "manifest",
            "supportedLocales": ["en", "de"]
          }
        }
      }
    }
    /* other models... */
  }
}
```

STEP: 2 — Register the resource model (or resource files) with the Fiori elements template via enhanceI18n

DESCRIPTION: Add the model name (e.g., "i18n") and/or specific resource files to the target component's options.settings.enhanceI18n array inside manifest.json. The template will consult the entries in array order for text keys: the last item has highest priority. Provide any combination of resource files and resource models. If a model in enhanceI18n does not include terminology configuration, activating terminologies has no effect for that model.

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "id": "your.app.id",
    "applicationVersion": { "version": "1.0.0" }
  },
  "sap.ui5": {
    "routing": {
      "targets": {
        "LineItemsList": {
          "type": "Component",
          "id": "LineItemsList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "contextPath": "/LineItems",
              "enhanceI18n": [
                "i18n/ManageItemsListReport.properties",
                "i18n"
              ],
              "variantManagement": "Page",
              "initialLoad": true,
              "navigation": {
                "LineItems": {
                  "detail": {
                    "route": "LineItemsObjectPage"
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 3 — Expected lookup behavior and precedence rules

DESCRIPTION: When the template resolves a text key:
- It checks enhanceI18n entries in reverse order (last entry wins). In the example above, it searches "i18n" first, then "i18n/ManageItemsListReport.properties", then SAP Fiori elements default texts.
- If the model in enhanceI18n has terminologies defined, the terminology-specific resource bundle is used according to supportedLocales and fallbackLocale.
- Models without terminologies do not get modified by active terminology settings.
- You may include any number of resource files and models in enhanceI18n. Maintain order to implement overrides.

LANGUAGE: text

CODE:
```
Lookup order example (given enhanceI18n: ["i18n/ManageItemsListReport.properties", "i18n"]):
1) Search key in model "i18n" (last element -> highest priority).
2) If not found, search key in file "i18n/ManageItemsListReport.properties".
3) If still not found, fallback to template default texts.

Terminology activation:
- If "i18n" model defines "terminologies" (e.g., "travel"), the terminology bundle at:
  i18n/terminologies/travel/i18n.terminologies.travel.properties
  is consulted for localized terminology keys per supportedLocales.
- bundleUrlRelativeTo: "manifest" means paths are resolved relative to the manifest location.
```

STEP: 4 — Files and paths to create (practical checklist)

DESCRIPTION: Create resource files and terminology files at these paths (adjust for your project):
- i18n/i18n.properties         (base resource bundle)
- i18n/terminologies/travel/i18n.terminologies.travel.properties
- i18n/ManageItemsListReport.properties (template enhancement file referenced by enhanceI18n)

LANGUAGE: text

CODE:
```
Project file layout (example):
- webapp/
  - manifest.json
  - i18n/
    - i18n.properties
    - ManageItemsListReport.properties
    - terminologies/
      - travel/
        - i18n.terminologies.travel.properties
```
--------------------------------

**TITLE**: Table Card Configuration and Annotations (sap.ovp.cards.table)

**INTRODUCTION**: Concise reference of manifest settings and UI annotations required to create and configure OVP table cards (3-column layout). Includes manifest JSON and annotation examples (XML, ABAP CDS, CAP CDS) for title/subtitle, units, KPIs, presentation/selection variants, data points, line items, smart links, contact, text arrangement and alignment. Use these snippets directly in your manifest, OData metadata, and annotation files.

**TAGS**: sap.ovp, table-card, manifest, annotation, LineItem, DataPoint, PresentationVariant, SelectionVariant, KPI, smart-links, contact, text-arrangement

STEP: Create basic table card in manifest
DESCRIPTION: Add a table card entry to your application manifest. Set model, template (use sap.ovp.cards.v4.table for OData V4), title, subtitle and entitySet. Use annotationPath to bind LineItem (optionally with qualifier).
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters", // Deprecated since SAPUI5 1.54.
    "globalFilterEntitySet": "GlobalFilters",  // Available from SAPUI5 1.54.
    "cards": {
      "card014": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.table",
        "settings": {
          "title": "Purchase Forecast",
          "subTitle": "per Supplier",
          "entitySet": "SalesShare"
        }
      }
    }
  }
}
```

STEP: Display unit-of-measure next to numeric values (two options)
DESCRIPTION: Option 1: declare sap:unit in OData metadata. Option 2: annotate with Org.OData.Measures.V1.ISOCurrency. Use either approach to render "850 kg" for GrossAmount with CurrencyCode = "KG".
LANGUAGE: XML
CODE:
```xml
<!-- Option 1: OData metadata properties (edmx/edm) -->
<Property Name="CurrencyCode" Type="Edm.String" MaxLength="5"
          sap:label="Currency" sap:updatable="false" sap:semantics="currency-code" />
<Property Name="GrossAmount" Type="Edm.Decimal" Precision="16" Scale="3"
          sap:unit="CurrencyCode" sap:label="Gross Amt." sap:creatable="false" sap:updatable="false" />
```

LANGUAGE: XML
CODE:
```xml
<!-- Option 2: Annotation mapping a Data property to its currency -->
<Annotations Target="GWSAMPLE_BASIC.SalesOrder/GrossAmount">
  <Annotation Term="Org.OData.Measures.V1.ISOCurrency" Path="CurrencyCode"/>
</Annotations>
```

STEP: Configure KPI entry in manifest and annotations
DESCRIPTION: Add kpiAnnotationPath in sap.ovp manifest settings and provide KPI/DataPoint/PresentationVariant annotations (XML / ABAP CDS / CAP CDS). Use qualifier to reference the KPI.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "kpiAnnotationPath": "com.sap.vocabularies.UI.v1.KPI#AllActualCosts"
  }
}
```

LANGUAGE: XML
CODE:
```xml
<!-- KPI XML sample (use Qualifier to reference in manifest) -->
<Annotation Term="UI.KPI" Qualifier="Eval_by_Country-Generic">
  <Record>
    <PropertyValue Property="DataPoint" Path="@UI.DataPoint#Eval_by_Country-Generic"/>
    <PropertyValue Property="Detail">
      <Record Type="UI.KPIDetailType">
        <PropertyValue Property="DefaultPresentationVariant" Path="@UI.PresentationVariant#Eval_by_Currency1"/>
        <PropertyValue Property="AlternativePresentationVariants">
          <Collection>
            <Path>@UI.PresentationVariant#Eval_by_Currency_Column</Path>
          </Collection>
        </PropertyValue>
        <PropertyValue String="Action" Property="SemanticObject"/>
        <PropertyValue String="toappnavsample" Property="Action"/>
      </Record>
    </PropertyValue>
    <PropertyValue String="String for KPI Annotation" Property="ID"/>
    <PropertyValue Property="SelectionVariantQualifier" Path="@UI.SelectionVariant#Eval_by_Currency_1"/>
  </Record>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Country_Generic">
  <Record>
    <PropertyValue Property="Value" Path="Currency"/>
    <PropertyValue String="test" Property="Title"/>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.KPI: [
  {
    detail: {
      defaultPresentationVariantQualifier: 'Eval_by_Currency1',
      alternativePresentationVariantQualifiers: [ 'Eval_by_Currency_Column' ],
      semanticObject: 'Action',
      semanticObjectAction: 'toappnavsample'
    },
    selectionVariantQualifier: 'Eval_by_Currency_1',
    id: 'String for KPI Annotation',
    qualifier: 'Eval_by_Country-Generic',
    dataPoint: { title: 'test' }
  }
]
```

LANGUAGE: CAP CDS
CODE:
```cds
UI.KPI #AllActualCosts: {
  $Type: 'UI.KPIType',
  Detail: {
    $Type: 'UI.KPIDetailType',
    DefaultPresentationVariant: ![@UI.PresentationVariant#Eval_by_Currency1],
    AlternativePresentationVariants: [ ![@UI.PresentationVariant#Eval_by_Currency_Column] ],
    SemanticObject: 'Action',
    Action: 'toappnavsample'
  },
  SelectionVariant: ![@UI.SelectionVariant#Eval_by_Currency_1],
  DataPoint: ![@UI.DataPoint#Eval_by_Country-Generic],
  ID: 'String for KPI Annotation'
}
```

STEP: Define PresentationVariant (max items, groupBy, sort and visualizations)
DESCRIPTION: Provide PresentationVariant with qualifier and reference it from KPI or card presentationAnnotationPath.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.PresentationVariant" Qualifier="Eval_by_Currency1">
  <Record>
    <PropertyValue Property="MaxItems" Int="5"/>
    <PropertyValue Property="GroupBy">
      <Collection>
        <PropertyPath>Country</PropertyPath>
        <PropertyPath>Currency</PropertyPath>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="SortOrder">
      <Collection>
        <Record>
          <PropertyValue Property="Property" PropertyPath="TotalSales"/>
          <PropertyValue Property="Descending" Bool="true"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Visualizations">
      <Collection>
        <AnnotationPath>@UI.Chart#Eval_by_Currency_Donut</AnnotationPath>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.PresentationVariant: [
  {
    maxItems: 5,
    groupBy: [ 'COUNTRY', 'CURRENCY' ],
    sortOrder: [{ by: 'TOTALSALES' }],
    visualizations: [{ type: '#AS_CHART', qualifier: 'Eval_by_Currency_Donut' }],
    qualifier: 'Eval_by_Currency1'
  }
]
```

LANGUAGE: CAP CDS
CODE:
```cds
UI.PresentationVariant #Eval_by_Currency1: {
  MaxItems: 5,
  GroupBy: ["Country","Currency"],
  SortOrder: [{ Property: "TotalSales", Descending: true }],
  Visualizations: ["@UI.Chart#Eval_by_Currency_Donut"]
}
```

STEP: Define SelectionVariant (default filters & parameters)
DESCRIPTION: Use SelectionVariant to predefine select options and parameters. Reference with selectionAnnotationPath or KPI SelectionVariantQualifier.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.SelectionVariant" Qualifier="Eval_by_Currency_1">
  <Record>
    <PropertyValue Property="SelectOptions">
      <Collection>
        <Record>
          <PropertyValue Property="PropertyName" PropertyPath="Country"/>
          <PropertyValue Property="Ranges">
            <Collection>
              <Record>
                <PropertyValue Property="Sign" EnumMember="UI.SelectionRangeSignType/I"/>
                <PropertyValue Property="Option" EnumMember="UI.SelectionRangeOptionType/EQ"/>
                <PropertyValue Property="Low" String="IN"/>
              </Record>
            </Collection>
          </PropertyValue>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="Parameters">
      <Collection>
        <Record Type="UI.Parameter">
          <PropertyValue Property="PropertyName" PropertyPath="Currency_Target"/>
          <PropertyValue Property="PropertyValue" String="EUR"/>
        </Record>
        <Record Type="UI.Parameter">
          <PropertyValue Property="PropertyName" PropertyPath="UoM_Target"/>
          <PropertyValue Property="PropertyValue" String="KGM"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: CAP CDS
CODE:
```cds
UI.SelectionVariant #Eval_by_Currency_1: {
  SelectOptions: [
    { PropertyName: "Country", Ranges: [{ Sign:"#I", Option:"#EQ", Low:"IN" }] }
  ],
  Parameters: [
    { $Type: "UI.Parameter", PropertyName: "Currency_Target", PropertyValue: "EUR" },
    { $Type: "UI.Parameter", PropertyName: "UoM_Target", PropertyValue: "KGM" }
  ]
}
```

STEP: Define DataPoint with formatting, criticality and trend
DESCRIPTION: Create DataPoint annotations referenced by DataFieldForAnnotation or KPI. Include ValueFormat, CriticalityCalculation, TargetValue, TrendCalculation.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="Eval_by_Country_Generic">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Title" String="Sales India - Generic Card" />
    <PropertyValue Property="Value" Path="Sales" />
    <PropertyValue Property="ValueFormat">
      <Record>
        <PropertyValue Property="ScaleFactor" Decimal="2" />
        <PropertyValue Property="NumberOfFractionalDigits" Int="1" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="CriticalityCalculation">
      <Record>
        <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirectionType/Minimize" />
        <PropertyValue Property="DeviationRangeHighValue" String="7300" />
        <PropertyValue Property="ToleranceRangeHighValue" String="7200" />
      </Record>
    </PropertyValue>
    <PropertyValue Property="TargetValue" String="2.000" />
    <PropertyValue Property="TrendCalculation">
      <Record>
        <PropertyValue Property="ReferenceValue" String="5201680" />
        <PropertyValue Property="DownDifference" Decimal="10000000.0" />
      </Record>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  title: "Sales India - Generic Card",
  valueFormat: { scaleFactor: 2, numberOfFractionalDigits: 1 },
  criticalityCalculation: {
    improvementDirection: "#MINIMIZE",
    deviationRangeHighValue: 7300,
    toleranceRangeHighValue: 7200
  },
  targetValue: 2.000,
  trendCalculation: { referenceValue: "refValElement", downDifference: 10000000.0 }
} Sales;
```

LANGUAGE: CAP CDS
CODE:
```cds
UI.DataPoint #Eval_by_Country-Generic: {
  $Type: "UI.DataPointType",
  Title: "Sales India - Generic Card",
  Value: "Sales",
  ValueFormat: { ScaleFactor: 2, NumberOfFractionalDigits: 1 },
  CriticalityCalculation: { ImprovementDirection: "#Minimizing", DeviationRangeHighValue: "7300", ToleranceRangeHighValue: "7200" },
  TargetValue: "2.000",
  TrendCalculation: { ReferenceValue: "5201680", DownDifference: 10000000.0 }
}
```

STEP: Configure View Switch (dropdown tabs) in manifest
DESCRIPTION: Use settings.valueSelectionInfo plus settings.tabs array to configure dropdown options. Each tab must provide annotationPath (LineItem qualifier or view), presentationAnnotationPath, selectionAnnotationPath, optional identification/dataPoint/dynamicSubtitle paths and a value key for binding.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "cards": {
      "card014": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.table",
        "settings": {
          "title": "Sales Forecast",
          "subTitle": "per Supplier",
          "valueSelectionInfo": "Value Selection Info",
          "entitySet": "SalesShare",
          "tabs": [
            {
              "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
              "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
              "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
              "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line",
              "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification",
              "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
              "value": "{{dropdown_value2}}"
            },
            {
              "dynamicSubtitleAnnotationPath": "com.sap.vocabularies.UI.v1.HeaderInfo#dynamicSubtitle",
              "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View4",
              "identificationAnnotationPath": "com.sap.vocabularies.UI.v1.Identification#item2",
              "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line",
              "value": "{{dropdown_value4}}"
            }
          ]
        }
      }
    }
  }
}
```

STEP: Configure LineItem (table columns) and manifest annotationPath
DESCRIPTION: Define com.sap.vocabularies.UI.v1.LineItem (optionally with qualifiers) to set table headers and row values. Use annotationPath in card settings to target a qualified LineItem. disableTableCardFlexibility affects runtime column selection and ordering.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ovp": {
    "disableTableCardFlexibility": false,
    "cards": {
      "card02": {
        "model": "salesOrder",
        "template": "sap.ovp.cards.table",
        "settings": {
          "title": "Sales Orders With Analytical Header",
          "subTitle": "Sales Orders With Analytical Header",
          "listFlavor": "bar",
          "listType": "extended",
          "entitySet": "SalesOrderSet",
          "dataPointAnnotationPath": "com.sap.vocabularies.UI.v1.DataPoint#line_without_trend",
          "selectionAnnotationPath": "com.sap.vocabularies.UI.v1.SelectionVariant#line1",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem#View1",
          "presentationAnnotationPath": "com.sap.vocabularies.UI.v1.PresentationVariant#line"
        }
      }
    }
  }
}
```

LANGUAGE: XML
CODE:
```xml
<!-- LineItem#View4 XML sample: DataField and DataFieldForAnnotation -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem" Qualifier="View4">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Order ID"/>
      <PropertyValue Property="Value" Path="SalesOrderID"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Customer"/>
      <PropertyValue Property="Value" Path="ToBusinessPartner/EmailAddress"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Customer"/>
      <PropertyValue Property="Value" Path="CustomerName"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
      <PropertyValue Property="Label" String="TaxAmount"/>
      <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.DataPoint#TaxAmount"/>
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [{ label: "Order ID", position: 10, qualifier: "View4" }] SALESORDERID;
@UI.lineItem: [{ label: "Customer", value: "_BUSINESSPARTNER.EMAILADDRESS", position: 20, qualifier: "View4" }] _BUSINESSPARTNER;
@UI.lineItem: [{ label: "Customer", position: 30, qualifier: "View4" }] CUSTOMERNAME;
@UI.lineItem: [{ label: "TaxAmount", valueQualifier: "TaxAmount", type: "#AS_DATAPOINT", position: 40, qualifier: "View4" }] PROPERTY_NAME;
```

LANGUAGE: CAP CDS
CODE:
```cds
UI.LineItem #View4: [
  { $Type: "UI.DataField", Label: "Order ID", Value: "SalesOrderID" },
  { $Type: "UI.DataField", Label: "Customer", Value: "ToBusinessPartner.EmailAddress" },
  { $Type: "UI.DataField", Label: "Customer", Value: "CustomerName" },
  { $Type: "UI.DataFieldForAnnotation", Label: "TaxAmount", Target: "@UI.DataPoint#TaxAmount" }
]
```

STEP: DataPoint sample for TaxAmount
DESCRIPTION: Define DataPoint referenced by DataFieldForAnnotation (TaxAmount) to display and highlight third column.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="TaxAmount">
  <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
    <PropertyValue Property="Title" String="TaxAmount"/>
    <PropertyValue Property="Value" Path="TaxAmount"/>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: { title: "TaxAmount" } TaxAmount;
```

LANGUAGE: CAP CDS
CODE:
```cds
UI.DataPoint #TaxAmount: {
  $Type: "UI.DataPointType",
  Title: "TaxAmount",
  Value: "TaxAmount"
}
```

STEP: Example — Product table with WeightMeasure DataPoint and LineItem
DESCRIPTION: Full example: DataPoint qualifier WeightMeasure and LineItem mapping where the first two columns are Product Name and Supplier, third column is a DataPoint value with criticality. Use importance to influence displayed columns when disableTableCardFlexibility is true.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="WeightMeasure">
  <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
    <PropertyValue Property="Title" String="Weight"/>
    <PropertyValue Property="Description" Path="Name"/>
    <PropertyValue Property="Value" Path="WeightMeasure"/>
    <PropertyValue Property="CriticalityCalculation">
      <Record Type="com.sap.vocabularies.UI.v1.CriticalityCalculationType">
        <PropertyValue Property="ImprovementDirection" EnumMember="com.sap.vocabularies.UI.v1.CriticalityCalculationType/Maximize"/>
        <PropertyValue Property="ToleranceRangeLowValue" Int="2"/>
        <PropertyValue Property="DeviationRangeLowValue" Int="4"/>
      </Record>
    </PropertyValue>
  </Record>
</Annotation>

<Annotation Term="com.sap.vocabularies.UI.v1.LineItem">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Product ID"/>
      <PropertyValue Property="Value" Path="ProductID"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Category"/>
      <PropertyValue Property="Value" Path="Category"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Product Name"/>
      <PropertyValue Property="Value" Path="Name"/>
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/High"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Supplier"/>
      <PropertyValue Property="Value" Path="SupplierName"/>
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/High"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Unit Price"/>
      <PropertyValue Property="Value" Path="Price"/>
      <Annotation Term="com.sap.vocabularies.UI.v1.Importance" EnumMember="com.sap.vocabularies.UI.v1.ImportanceType/High"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
      <PropertyValue Property="Label" String="Weight Measure"/>
      <PropertyValue Property="Target" AnnotationPath="@com.sap.vocabularies.UI.v1.DataPoint#WeightMeasure"/>
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
@UI.dataPoint: {
  title: "Weight",
  description: "Name",
  valueFormat: { scaleFactor: 2, numberOfFractionalDigits: 1 },
  criticalityCalculation: { improvementDirection: "#MAXIMIZE", deviationRangeHighValue: 4.3, toleranceRangeHighValue: 2.5 }
} WeightMeasure;

@UI.lineItem: [{ label: "Product ID", position: 10 }] PRODUCTID;
@UI.lineItem: [{ label: "Category", position: 20 }] CATEGORY;
@UI.lineItem: [{ importance: "#HIGH", label: "Product Name", position: 30 }] NAME;
@UI.lineItem: [{ importance: "#HIGH", label: "Supplier", position: 40 }] SUPPLIERNAME;
@UI.lineItem: [{ importance: "#HIGH", label: "Unit Price", position: 50 }] PRICE;
@UI.lineItem: [{ label: "Weight Measure", valueQualifier: "WeightMeasure", type: "#AS_DATAPOINT", position: 60 }] PROPERTY_NAME;
```

LANGUAGE: CAP CDS
CODE:
```cds
UI.DataPoint #WeightMeasure: {
  $Type: "UI.DataPointType",
  Title: "Weight",
  Description: "Name",
  Value: "WeightMeasure",
  CriticalityCalculation: { $Type: "UI.CriticalityCalculationType", ImprovementDirection: "#Maximize", ToleranceRangeLowValue: 2.5, DeviationRangeLowValue: 4.3 }
}

UI.LineItem: [
  { $Type: "UI.DataField", Label: "Product ID", Value: "ProductID" },
  { $Type: "UI.DataField", Label: "Category", Value: "Category" },
  { $Type: "UI.DataField", Label: "Product Name", Value: "Name", "![@UI.Importance]": "#High" },
  { $Type: "UI.DataField", Label: "Supplier", Value: "SupplierName", "![@UI.Importance]": "#High" },
  { $Type: "UI.DataField", Label: "Unit Price", Value: "Price", "![@UI.Importance]": "#High" },
  { $Type: "UI.DataFieldForAnnotation", Label: "Weight Measure", Target: "@UI.DataPoint#WeightMeasure" }
]
```

STEP: Enable Smart Links (semantic object) for entity property
DESCRIPTION: Define a semantic object annotation on the property so smart links become available in the table card (SalesOrderID -> OVP).
LANGUAGE: XML
CODE:
```xml
<Annotations Target="GWSAMPLE_BASIC.SalesOrder/SalesOrderID">
  <Annotation Term="com.sap.vocabularies.Common.v1.SemanticObject" String="OVP"/>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view SALESORDER with {
  @Consumption.semanticObject: 'OVP'
  salesorderid;
}
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.SemanticObject: 'OVP'
  SalesOrderID;
}
```

STEP: Display contact information in LineItem (Contact annotation)
DESCRIPTION: Use DataFieldForAnnotation with Communication.Contact target to show phone/email contact cards and contact actions in table cards.
LANGUAGE: XML
CODE:
```xml
<!-- LineItem using Contact -->
<Annotation Term="com.sap.vocabularies.UI.v1.LineItem" Qualifier="NewSalesOrders">
  <Collection>
    <Record Type="com.sap.vocabularies.UI.v1.DataField">
      <PropertyValue Property="Label" String="Order ID (Company)"/>
      <PropertyValue Property="Value" Path="SalesOrderID"/>
    </Record>
    <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAnnotation">
      <PropertyValue Property="Label" String="Created by (Role)" />
      <PropertyValue Property="Target" AnnotationPath="ToBusinessPartner/@com.sap.vocabularies.Communication.v1.Contact" />
    </Record>
  </Collection>
</Annotation>
```

LANGUAGE: XML
CODE:
```xml
<!-- Communication.v1.Contact sample -->
<Annotation Term="com.sap.vocabularies.Communication.v1.Contact">
  <Record>
    <PropertyValue Property="tel">
      <Collection>
        <Record>
          <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/fax"/>
          <PropertyValue Property="uri" Path="FaxNumber"/>
        </Record>
        <Record>
          <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.PhoneType/work com.sap.vocabularies.Communication.v1.PhoneType/preferred"/>
          <PropertyValue Property="uri" Path="PhoneNumber"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="email">
      <Collection>
        <Record>
          <PropertyValue Property="type" EnumMember="com.sap.vocabularies.Communication.v1.ContactInformationType/preferred com.sap.vocabularies.Communication.v1.ContactInformationType/work"/>
          <PropertyValue Property="address" Path="EmailAddress"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

LANGUAGE: ABAP CDS
CODE:
```abap
define view VIEWNAME {
  @Semantics.name.fullName: true
  CompanyName,

  @Semantics.eMail.address: true
  @Semantics.eMail.type: [#WORK]
  EmailAddress,

  @Semantics.telephone.type: [#FAX]
  FaxNumber,

  @Semantics.telephone.type: [#WORK]
  PhoneNumber
}
```

LANGUAGE: CAP CDS
CODE:
```cds
Communication.Contact: {
  tel: [
    { type: "#fax", uri: "FaxNumber" },
    { type: ["#work","#pref"], uri: "PhoneNumber" }
  ],
  email: [
    { type: ["#pref","#work"], address: "EmailAddress" }
  ]
}
```

STEP: Text Arrangement annotation (TextFirst, TextLast, TextOnly)
DESCRIPTION: Bind a text property to a key property and choose text arrangement (TextFirst/TextLast/TextOnly) to control display formatting in table cells.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="GWSAMPLE_BASIC.SalesOrder/CustomerID">
  <Annotation Term="com.sap.vocabularies.Common.v1.Text" Path="Supplier_Name">
    <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"/>
  </Annotation>
</Annotations>
```

LANGUAGE: ABAP CDS
CODE:
```abap
annotate view SALESORDER with {
  @UI.TextArrangement: #TEXT_LAST
  customerid;
}
```

LANGUAGE: CAP CDS
CODE:
```cds
annotate GWSAMPLE_BASIC.SalesOrder with {
  @Common.Text: Supplier_Name
  @UI.TextArrangement: #TextLast
  CustomerID;
}
```

STEP: Text Alignment rules
DESCRIPTION: Alignment rules to apply when rendering DataField/DataPoint in table columns. Use these rules when generating UI column metadata.
LANGUAGE: TEXT
CODE:
```text
- DataField or Contact annotation: left-aligned
- DataPoint (with or without Criticality or CriticalityCalculation) OR Edm.DateTime / Edm.DateTimeOffset property: right-aligned
- DataPoint with Criticality and property of type Edm.String: center-aligned
```
--------------------------------

**TITLE**: Table Groupings — SAP Fiori elements (OData V2 & V4)

**INTRODUCTION**: Practical, code-focused reference for enabling, disabling, and configuring table row groupings in SAP Fiori elements. Includes supported table types, restrictions, how to disable grouping in manifest.json (OData V4), how to define default group levels and totals with PresentationVariant (XML and CAP CDS), and how grouping header formatters are wired for OData V2 (responsive vs analytical tables).

**TAGS**: fiori-elements, grouping, table, responsive-table, analytical-table, manifest.json, PresentationVariant, CDS, ODataV2, ODataV4, UI5

**STEP**: Supported table types and key restrictions

**DESCRIPTION**: Use these rules to determine whether grouping is available and what behavior to expect (server-side grouping, TextArrangement, UoM/currency behavior).

**LANGUAGE**: Text

**CODE**:
```Plaintext
Supported tables:
- Responsive table: sap.m.Table  (grouping supported)
- Analytical table: sap.ui.Table.AnalyticalTable  (grouping supported)
- GridTable and TreeTable: not supported

Key restrictions / behavior:
- Grouping can only be activated for dimension columns.
- Grouping is performed on the server. Header formatters do not alter grouping boundaries:
    - Groups remain separate even if header formatting produces identical strings.
- TextArrangement annotation:
    - Not supported for analytical tables.
    - A property with an associated text property is shown as: "m – Meter".
- Units of measure (UoM) and currencies:
    - Displaying values with units of measure in analytical table grouping headers is not supported.
    - Units/currencies in grouping header are supported only in responsive tables.
```

**STEP**: Disable grouping in a responsive table (OData V4) via manifest.json

**DESCRIPTION**: Turn off grouping at runtime for responsive tables using the table personalization settings in the manifest.json. Add this under the LineItem annotation configuration for the list report / object page where applicable.

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
    "tableSettings": {
      "type": "ResponsiveTable",
      "condensedTableLayout": true,
      "personalization": {
        "column": true,
        "sort": false,
        "group": false
      }
      // other table settings...
    }
  }
}
```

**STEP**: Define default group levels and totals using PresentationVariant (XML Annotation)

**DESCRIPTION**: Use UI.PresentationVariant to set default GroupBy and Total on the entity. PresentationVariant.Visualizations must be present; otherwise the PV/SPV is ignored. For analytical tables you can define totals that show in aggregation rows. If Total is missing -> default totals provided for aggregatable columns. If Total exists and is empty -> no totals provided.

**LANGUAGE**: XML

**CODE**:
```XML
<Annotations Target="sap.fe.managepartners.ManagePartnersService.EntityContainer/BusinessPartners">
  <Annotation Term="UI.PresentationVariant">
    <Record Type="UI.PresentationVariantType">
      <PropertyValue Property="GroupBy">
        <Collection>
          <PropertyPath>Country</PropertyPath>
          <!-- additional group levels allowed; responsive table supports only first level -->
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Total">
        <Collection>
          <PropertyPath>SalesAmount</PropertyPath>
          <!-- totals for aggregatable properties -->
        </Collection>
      </PropertyValue>
      <PropertyValue Property="Visualizations">
        <Collection>
          <AnnotationPath>@UI.Chart</AnnotationPath>
          <AnnotationPath>@UI.LineItem</AnnotationPath>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

**STEP**: Define default group levels and totals using CAP CDS (Annotation form)

**DESCRIPTION**: Equivalent PresentationVariant expressed in CAP CDS annotation syntax.

**LANGUAGE**: CDS

**CODE**:
```CDS
annotate.sap.fe.managepartners.ManagePartnersService.EntityContainer.BusinessPartners with {
  @UI.PresentationVariant: {
    GroupBy: [
      Country
    ],
    Total: [
      SalesAmount
    ],
    Visualizations: [
      '@UI.Chart',
      '@UI.LineItem'
    ]
  }
}
```

**STEP**: Default totals rules and analytical table notes

**DESCRIPTION**: Behavior rules to implement or test after adding PresentationVariant entries.

**LANGUAGE**: Text

**CODE**:
```Plaintext
Default totals behavior:
- If no PresentationVariant defined (analytical table), a total is provided by default for all aggregatable columns.
- If PV is defined:
    - If Total attribute is present with entries -> totals only for listed aggregatable properties.
    - If Total attribute is present but empty -> no totals are provided.
    - If Total attribute is missing -> totals provided by default for all aggregatable properties.
Restrictions:
- If a group contains multiple units or currencies in its rows, the total cannot be computed directly.
  The table displays a "Show Details" link opening a popup showing totals/subtotals per unit/currency.
- Responsive tables support only one level of grouping: if PV has multiple levels, only the first is applied.
```

**STEP**: OData V2 — how grouping header text formatters are set (responsive vs analytical)

**DESCRIPTION**: For OData V2 scenarios SAP Fiori elements wires grouping header formatters automatically. If you need to customize or debug, use these extension points:

- Responsive tables: grouping is implemented using fnGroup on sap.ui.model.Sorter instances bound to the column sorter.
- Analytical tables: grouping header text is produced by the groupHeaderFormatter property on sap.ui.table.AnalyticalColumn instances.

Provide sample code to illustrate how fnGroup and groupHeaderFormatter are attached (for customizing in controller or component extension).

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// Responsive table: attach a grouping function to a Sorter for a column
// Example: set sorter with fnGroup when creating/adjusting binding
var oSorter = new sap.ui.model.Sorter("Country", false, function(oContext) {
  // oContext is the binding context of the item/row
  // return the grouping key (string) used as group header
  return oContext.getProperty("Country");
});
// Apply sorter to binding
oTable.getBinding("items").sort([oSorter]);

// Analytical table: provide a groupHeaderFormatter for AnalyticalColumn
// This function receives group data and should return the formatted group header string
var oAnalyticalColumn = new sap.ui.table.AnalyticalColumn({
  leadingProperty: "Country",
  template: new sap.m.Text({text: "{Country}"}),
  groupHeaderFormatter: function(oGroup) {
    // oGroup has properties like key, text, aggregate, count etc.
    // Return the string to display as the group header
    return oGroup ? (oGroup.key + " (" + oGroup.count + ")") : "";
  }
});
oAnalyticalTable.addColumn(oAnalyticalColumn);
```

**STEP**: Grouping header formatting rules / OData type mappings

**DESCRIPTION**: When grouping, SAP Fiori elements maps OData types and display formats to formatted group header strings. Use these mappings to anticipate formatted header text (important when comparing server grouping keys vs client formatting).

**LANGUAGE**: JSON

**CODE**:
```JSON
{
  "Edm.DateTimeOffsetDate": {
    "displayFormat": "Date",
    "odataExample": "/Date(1485471600000 +0000)/",
    "unformatted": "Fri Jan 27 2017 00:00:00 GMT+0100 (CET)",
    "formatted": "Jan 26, 2017",
    "note": "UTC used for grouping"
  },
  "Edm.DateTimeOffset": {
    "displayFormat": null,
    "odataExample": "/Date(1485471600000 +0000)/",
    "unformatted": "Fri Jan 27 2017 00:00:00 GMT+0100 (CET)",
    "formatted": "Jan 27, 2017, 12:00:00 AM"
  },
  "Edm.DateTime": {
    "displayFormat": "Date",
    "odataExample": "/Date(1485471600000 +0000)/",
    "formatted": "Jan 26, 2017",
    "note": "UTC used for grouping"
  },
  "Edm.Time": {
    "displayFormat": "Time",
    "odataExample": "PT11H13M01S",
    "unformatted": "{ms: 43980000, __edmType: 'Edm.Time'}",
    "formatted": "11:13:01 AM"
  },
  "Edm.String (date formatted)": {
    "odataExample": "20180313",
    "formatted": "Mar 13, 2018"
  },
  "Edm.Boolean": {
    "odataExample": "true",
    "formatted": "Yes"
  },
  "Edm.Decimal (UoM)": {
    "odataExample": "10",
    "formatted": "10.000 m*",
    "note": "Unit of measure in header supported only for responsive tables"
  },
  "Edm.Decimal (Currency)": {
    "odataExample": "2498.00",
    "formatted": "2,498.00 EUR*",
    "note": "Currency in header supported only for responsive tables"
  },
  "Edm.String (Unit/TextArrangement)": {
    "odataExample": "m",
    "formatted": "Meter (m)*",
    "note": "TextArrangement influences formatted output; analytical tables do not support TextArrangement"
  }
}
```

**STEP**: Developer checklist (practical actions to implement grouping)

**DESCRIPTION**: Quick step-by-step actions to implement or troubleshoot grouping in an app.

**LANGUAGE**: Text

**CODE**:
```Plaintext
- Confirm table type: use sap.m.Table (responsive) or sap.ui.Table.AnalyticalTable (analytical).
- Ensure the property to group is a dimension (non-aggregatable) or is allowed per your OData model.
- For OData V4 responsive tables:
    - Grouping enabled by default for sortable columns.
    - To disable grouping, set "personalization.group": false in manifest.json tableSettings.
- To set default groups/totals at app launch:
    - Add UI.PresentationVariant (or SelectionPresentationVariant) with GroupBy and Total entries.
    - Ensure PresentationVariant.Visualizations is present (otherwise PV ignored).
- Know server-side behavior:
    - Group keys used by server are authoritative; client-side formatters only change display text.
- For custom formatting or grouping behavior in OData V2:
    - Adjust sorter.fnGroup for responsive tables.
    - Provide groupHeaderFormatter on AnalyticalColumn for analytical tables.
- Test special cases:
    - Groups with mixed units/currencies -> totals will show "Show Details" popup.
    - Responsive tables only apply the first PV group level.
```

--------------------------------

**TITLE**: Tables — configuration and annotations for SAP Fiori elements (OData V2 & V4)

**INTRODUCTION**: This reference shows actionable, code-first examples to configure table behavior and appearance in SAP Fiori elements apps. It includes manifest.json settings and metadata annotations (XML, ABAP CDS, CAP CDS) for: table type, selection mode, context menu actions, responsive column visibility (UI.Importance), hiding columns (UI.Hidden), column width, threshold/scrollThreshold, copy-to-clipboard, freezing columns, search restrictions, and related keyboard shortcuts. Use these snippets when generating or modifying app code.

**TAGS**: manifest.json, UI.LineItem, UI.Hidden, UI.Importance, CssDefaults, threshold, scrollThreshold, copy, frozenColumnCount, controlConfiguration, annotations, ODataV2, ODataV4, ABAP_CDS, CAP_CDS, XML

STEP: Set table type and basic tableSettings (manifest.json)
DESCRIPTION: Configure table type and basic tableSettings per page/component. Use "tableSettings" under the component or controlConfiguration depending on your app structure (sap.ui.generic.app pages or sap.ui5 routing targets). Example shows Responsive, Grid, Analytical types and common settings (type, gridTable, multiSelect, selectionLimit).
LANGUAGE: JSON
CODE:
```json
// Example (sap.ui.generic.app pages -> ListReport)
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|<EntitySetName>": {
        "entitySet": "<EntitySetName>",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "gridTable": true,
            "tableSettings": {
              "type": "GridTable",         // "ResponsiveTable" | "GridTable" | "AnalyticalTable" | "TreeTable"
              "multiSelect": true,
              "selectAll": false,
              "selectionLimit": 10
            }
          }
        }
      }
    }
  }
}

// Equivalent pattern (sap.ui5 -> routing targets -> controlConfiguration)
// Use controlConfiguration["@com.sap.vocabularies.UI.v1.LineItem"].tableSettings for OData V4 controlConfiguration.
```

STEP: Configure selection mode and selection limits
DESCRIPTION: Set multi-select, selectAll and selectionLimit for tables in manifest to enable multi-selection and limit selections for bulk actions.
LANGUAGE: JSON
CODE:
```json
{
  "component": {
    "name": "sap.suite.ui.generic.template.AnalyticalListPage",
    "list": true,
    "settings": {
      "tableSettings": {
        "type": "AnalyticalTable",
        "multiSelect": true,
        "selectAll": false,
        "selectionLimit": 10
      }
    }
  }
}
```

STEP: Add custom actions and control context menu inclusion/exclusion
DESCRIPTION: Define custom actions in manifest with requiresSelection and excludeFromContextMenu. Implement controller action handlers and use extensionAPI.getSelectedContexts synchronously to obtain selected rows referenced by context menu actions.
LANGUAGE: JSON
CODE:
```json
// manifest.json: Register custom action (ListReport example)
{
  "sap.ui.controllerExtensions": {
    "sap.suite.ui.generic.template.ListReport.view.ListReport": {
      "controllerName": "STTA_MP.ext.controller.ListReportExtension",
      "sap.ui.generic.app": {
        "STTA_C_MP_Product": {
          "EntitySet": "STTA_C_MP_Product",
          "Actions": {
            "CopyWithNewSupplier": {
              "id": "CopyWithNewSupplier",
              "text": "Copy with new Supplier",
              "press": "onCopyWithNewSupplier",
              "excludeFromContextMenu": false,
              "requiresSelection": true
            }
          }
        }
      }
    }
  }
}
```
LANGUAGE: JavaScript
CODE:
```javascript
// Controller: STTA_MP.ext.controller.ListReportExtension
onCopyWithNewSupplier: function (oEvent) {
  // MUST be synchronous
  var aContexts = this.extensionAPI.getSelectedContexts(); // synchronous usage only
  // aContexts -> array of binding contexts for selected rows
  // Implement action logic here
}
```

STEP: Configure responsive column visibility using UI.Importance
DESCRIPTION: Use the UI.Importance annotation on DataField records to control column behavior on smaller screens: High (always visible/pop-in), Medium/None (hidden automatically), Low (hidden first). Semantic keys count as High even if unset.
LANGUAGE: XML
CODE:
```xml
<Annotations Target="STTA_PROD_MAN.STTA_C_MP_ProductSalesPriceType">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="PriceDay" />
        <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/High" />
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="TargetPrice" />
        <!-- treated as default "None" (same behavior as Medium) -->
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="DiscountPriceTarget" />
        <Annotation Term="UI.Importance" EnumMember="UI.ImportanceType/Low" />
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: Hide table columns using UI.Hidden (static and path-based)
DESCRIPTION: Hide entire columns (static true) or hide fields per-row using a path expression. If path evaluates to true for all rows only fields are hidden; if path targets parent entity field and evaluates true the entire column is hidden (object page).
LANGUAGE: XML
CODE:
```xml
<!-- Hide specific field per row (path-based) -->
<Annotation Term="UI.LineItem">
  <Collection>
    <Record Type="UI.DataFieldForAnnotation">
      <PropertyValue Property="Target" AnnotationPath="@UI.FieldGroup#multipleActionFields" />
      <PropertyValue Property="Label" String="Sold-To Party" />
      <Annotation Term="UI.Hidden" Path="Delivered" />
    </Record>
  </Collection>
</Annotation>
```
LANGUAGE: ABAP CDS
CODE:
```abap
@UI.lineItem: [{
  type: #AS_FIELDGROUP,
  valueQualifier: 'multipleActionFields',
  label: 'Sold-To Party',
  hidden: #( 'Delivered' )
}]
TEST;
```
LANGUAGE: CDS
CODE:
```c
// CAP CDS (snippet)
LineItem: {
  $value: [
    {
      $Type: 'UI.DataFieldForAnnotation',
      Target: '@UI.FieldGroup#multipleActionFields',
      Label: 'Sold-To Party',
      ![@UI.Hidden]: Delivered
    }
  ]
}
```

STEP: Column width calculation and custom CSS defaults
DESCRIPTION: Column width defaults are auto-calculated from MaxLength (min 3rem, max 20rem). Use com.sap.vocabularies.HTML5.v1.CssDefaults (UI annotation) to customize column CSS defaults or set widthIncludingColumnHeader in manifest to include header when auto-calculating.
LANGUAGE: JSON
CODE:
```json
// Include column header when calculating column width (controlConfiguration example)
"controlConfiguration": {
  "@com.sap.vocabularies.UI.v1.LineItem": {
    "tableSettings": {
      "widthIncludingColumnHeader": true
    },
    "columns": {
      "DataField::commonProperty": {
        "widthIncludingColumnHeader": false
      }
    }
  }
}
```
LANGUAGE: XML
CODE:
```xml
<!-- Use CssDefaults to set column CSS defaults (structure example) -->
<Annotations Target="MyService.MyEntity">
  <Annotation Term="com.sap.vocabularies.HTML5.v1.CssDefaults">
    <!-- Provide CSS defaults for UI rendering (example structure) -->
    <Record>
      <PropertyValue Property="DefaultClass" String="myCustomColumnClass" />
    </Record>
  </Annotation>
</Annotations>
```

STEP: Configure copy-to-clipboard button visibility
DESCRIPTION: Control display of the "Copy to Clipboard" button per table via manifest: tableSettings.copy (V2) or disableCopyToClipboard under controlConfiguration (V4). Section-level settings override page-level settings.
LANGUAGE: JSON
CODE:
```json
// V2: Disable copy at List Report table level
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|<EntitySetName>": {
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "tableSettings": {
              "copy": false
            }
          }
        }
      }
    }
  }
}

// V4: Disable copyToClipboard via controlConfiguration
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "disableCopyToClipboard": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Configure threshold (initial preload) and scrollThreshold (dynamic loading)
DESCRIPTION: Set threshold to preload rows (added to visible rows). If threshold = 0, scrollThreshold is used. Set scrollThreshold to control number of rows loaded on scroll. Examples for ListReport, ObjectPage, AnalyticalListPage are shown. Note: analytical/tree tables require scrollThreshold > threshold to take effect.
LANGUAGE: JSON
CODE:
```json
// V2: ListReport threshold and scrollThreshold
{
  "component": {
    "name": "sap.suite.ui.generic.template.ListReport",
    "list": true,
    "settings": {
      "gridTable": true,
      "tableSettings": {
        "threshold": 400,
        "scrollThreshold": 600
      }
    }
  }
}

// V2: ObjectPage threshold & scrollThreshold
{
  "component": {
    "name": "sap.suite.ui.generic.template.ObjectPage",
    "settings": {
      "gridTable": true,
      "tableSettings": {
        "threshold": 400,
        "scrollThreshold": 600
      }
    }
  }
}

// V2: AnalyticalListPage threshold & scrollThreshold
{
  "component": {
    "name": "sap.suite.ui.generic.template.AnalyticalListPage",
    "list": true,
    "settings": {
      "tableSettings": {
        "type": "AnalyticalTable",
        "multiSelect": true,
        "selectionLimit": 10,
        "threshold": 400,
        "scrollThreshold": 600
      }
    }
  }
}

// V4: Example controlConfiguration for threshold (override MaxItems)
{
  "targets": {
    "SalesOrderManageList": {
      "type": "Component",
      "id": "SalesOrderManageList",
      "name": "sap.fe.templates.ListReport",
      "options": {
        "settings": {
          "contextPath": "/SalesOrderManage",
          "controlConfiguration": {
            "@com.sap.vocabularies.UI.v1.LineItem": {
              "tableSettings": {
                "type": "ResponsiveTable",
                "threshold": 100
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Default threshold values (quick reference)
DESCRIPTION: Default number of preloaded rows per table type — list both OData V2 and V4 defaults for quick decision making.
LANGUAGE: JSON
CODE:
```json
// Defaults (OData V2)
{
  "ResponsiveTable": {
    "ListReport": 20,
    "ObjectPageAnchorBar": 10,
    "ObjectPageIconTabBar": 20
  },
  "TreeTable": 100,
  "GridTable": 100,
  "AnalyticalTable": 100
}

// Defaults (OData V4)
{
  "ResponsiveTable": {
    "ListReport": 30,
    "ObjectPage": 10
  },
  "TreeTable": 200,
  "GridTable": 100,
  "AnalyticalTable": 100
}
```

STEP: Freeze columns and disable column freezing
DESCRIPTION: Freeze N left-most columns using frozenColumnCount in manifest. Disable freeze via disableColumnFreeze. Freezing not supported for ResponsiveTable.
LANGUAGE: JSON
CODE:
```json
// Freeze first 3 columns (LineItem controlConfiguration example)
"_Item/@com.sap.vocabularies.UI.v1.LineItem": {
  "tableSettings": {
    "type": "GridTable",
    "frozenColumnCount": 3
  }
}

// Disable column freeze
"_Item/@com.sap.vocabularies.UI.v1.LineItem": {
  "tableSettings": {
    "type": "GridTable",
    "disableColumnFreeze": true
  }
}
```

STEP: Search field behavior and search restrictions (NavigationRestrictions and SearchRestrictions)
DESCRIPTION: Enable/disable search field by adding Capabilities.SearchRestrictions at child entity or NavigationRestrictions at parent entity. Analytical/tree tables use ApplySupported Transformations (including "search") to determine availability.
LANGUAGE: XML
CODE:
```xml
<!-- Parent entity: NavigationRestrictions -> restrict child's search (non-containment example) -->
<Annotations Target="com.c_salesordermanage_sd.Container/SalesOrderManage">
  <Annotation Term="Capabilities.NavigationRestrictions">
    <Record>
      <PropertyValue Property="RestrictedProperties">
        <Collection>
          <Record>
            <PropertyValue Property="NavigationProperty" NavigationPropertyPath="_Items" />
            <PropertyValue Property="SearchRestrictions">
              <Record>
                <PropertyValue Property="Searchable" Bool="false" />
              </Record>
            </PropertyValue>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>

<!-- Child entity: SearchRestrictions directly at child (non-containment) -->
<Annotations Target="com.c_salesordermanage_sd.Container/SalesOrderItem">
  <Annotation Term="SAP__capabilities.SearchRestrictions">
    <Record>
      <PropertyValue Property="Searchable" Bool="false" />
    </Record>
  </Annotation>
</Annotations>

<!-- ApplySupported transformations include 'search' -> enables search field for analytical/table -->
<Annotation Term="SAP__aggregation.ApplySupported">
  <Record>
    <PropertyValue Property="Transformations">
      <Collection>
        <String>filter</String>
        <String>orderby</String>
        <String>search</String>
        <String>descendants</String>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```
LANGUAGE: CDS
CODE:
```c
// CAP CDS non-containment example
entity SalesOrderManage
  @(Capabilities: {
    NavigationRestrictions: {
      RestrictedProperties: [{
        NavigationProperty: '_Items',
        SearchRestrictions: { Searchable: false }
      }]
    }
  })
{ ... }

// CAP CDS child entity SearchRestrictions
entity SalesOrderItem
  @(Capabilities: {
    SearchRestrictions: { Searchable: false }
  })
{ ... }
```

STEP: Copy/paste and selection keyboard shortcuts
DESCRIPTION: Keyboard selection behavior for copying ranges/rows. Use these shortcuts when automating selection flows or documenting UX.
LANGUAGE: TEXT
CODE:
```text
Key combinations and behavior:
- Space: selects the cell with focus; if inside a selection, removes it.
- Shift + Arrow keys: adjusts existing selection or creates a new selection.
- Shift + Space: transforms the current selection into a row selection (respects table selection mode).
- Control + Space: expands selection to all cells in a column (up to range limit).
- Control + Shift + A: clears the selection.
Note: To select a range with the mouse without focusing editable fields, press Ctrl (Windows) or Cmd (macOS) before mouse selection.
```

STEP: Notes and important constraints (single/multi selection, context menu, analytics)
DESCRIPTION: Keep these constraints in code-generation logic or validation checks:
- Default row selection is single-selection; set multiSelect explicitly for multiple selection.
- Context menu: "Open in New Tab" removed if openInEditMode=true or certain navigation extension implementations.
- extensionAPI.getSelectedContexts must be used synchronously.
- Analytical tables are not supported for draft-enabled entities (OData V4).
- Use scrollThreshold > threshold for analytical/tree tables to take effect.
LANGUAGE: TEXT
CODE:
```text
Constraints summary:
- Default selection mode: single-selection (change via manifest).
- extensionAPI.getSelectedContexts: synchronous only.
- If openInEditMode = true, 'Open in New Tab' not available in context menu.
- Analytical tables: not supported on draft-enabled entities (OData V4).
- For analytical/tree tables, ensure scrollThreshold > threshold for dynamic loading to apply.
```

STEP: References and file paths (where to place settings)
DESCRIPTION: Use these file paths when adding settings:
- manifest.json: add tableSettings under "sap.ui.generic.app.pages...component.settings.tableSettings" (OData V2) or "sap.ui5.routing.targets...options.settings.controlConfiguration" (OData V4).
- Annotations: add XML files under local annotations (e.g., annotations.xml) or in ABAP CDS / CAP CDS files as shown.
LANGUAGE: TEXT
CODE:
```text
Common locations:
- manifest.json (project root) -> sap.ui.generic.app.pages[...] or sap.ui5.routing.targets[...].options.settings.controlConfiguration
- Annotations XML file (e.g., annotations.xml) -> include in service registration
- ABAP CDS and CAP CDS -> annotate entity definitions directly
```
--------------------------------

**TITLE**: Chart Building Block (sap.fe.macros.Chart) — Instantiation, Personalization, and Public APIs

**INTRODUCTION**: Quick reference for instantiating the Chart building block (sap.fe.macros.Chart) in Fiori Elements XML views, rules for context/meta paths, required backend aggregation, enabling personalization/variant management, and using the Chart public APIs to get/set presentation and selection variants.

**TAGS**: fiori-elements-framework, chart, sap.fe.macros, personalization, variant-management, aggregation, API, UI5

**STEP**: 1 — Basic Chart instantiation (XML)

**DESCRIPTION**: Add a Chart building block in a view. Key attributes: id, contextPath (optional), metaPath, dataPointsSelected (event handler), personalization (enabled personalization aspects), selectionMode.

**LANGUAGE**: XML

**CODE**:
```xml
<macros:Chart
    id="chartDefault"
    contextPath="/RootEntitySet"
    metaPath="@com.sap.vocabularies.UI.v1.Chart"
    dataPointsSelected=".onChartSelectionChanged"
    personalization="Sort,Type,Item"
    selectionMode="Multiple"
></macros:Chart>
```

**STEP**: 2 — Rules for contextPath and metaPath

**DESCRIPTION**: Use one of these patterns:
- If metaPath is absolute, contextPath is optional.
- If metaPath is relative and no contextPath is provided, the parent binding path is used as the contextPath.
Provide explicit contextPath when you need to target a specific entitySet/navigation property.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Absolute metaPath: contextPath optional -->
<macros:Chart id="c1" metaPath="/RootEntitySet/@com.sap.vocabularies.UI.v1.Chart" />

<!-- Relative metaPath: provide contextPath if not relying on parent binding -->
<macros:Chart id="c2" contextPath="/RootEntitySet" metaPath="@com.sap.vocabularies.UI.v1.Chart" />
```

**STEP**: 3 — Backend: enable aggregation for the entitySet

**DESCRIPTION**: Ensure the entitySet referenced by the Chart supports aggregation in the backend. See the Configuring Charts documentation for details about enabling aggregation in the backend.

**LANGUAGE**: Markdown

**CODE**:
```text
See: configuring-charts-653ed0f.md#loio653ed0f4f0d743dbb33ace4f68886c4e__enabling_aggregation_subsection
```

**STEP**: 4 — Enable Chart personalization and variant management

**DESCRIPTION**: Enable personalization by setting the personalization attribute and wire variant management if required. The Chart supports personalization aspects such as Sort, Type, and Item (example below). Chart personalization must be enabled for selection-variant methods to work.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Personalization enabled for Sort, Type, Item -->
<macros:Chart
    id="chartPersonalized"
    contextPath="/RootEntitySet"
    metaPath="@com.sap.vocabularies.UI.v1.Chart"
    personalization="Sort,Type,Item"
    selectionMode="Multiple"
/>
```

**STEP**: 5 — Use Chart public APIs: presentation & selection variants (JavaScript)

**DESCRIPTION**: Obtain the Chart control by ID and call the public APIs to get/set presentation and selection variants. The getSelectionVariant()/setSelectionVariant() methods only work if chart personalization is enabled. These methods operate on variants applied directly to the chart (they exclude variants applied to a bound model).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Get the Chart control instance (from a controller)
const chart = this.byId("chartDefault");

// Get current presentation variant (object describing presentation state)
const presVariant = chart.getPresentationVariant();
// Modify or store presentation variant, then apply it back
chart.setPresentationVariant(presVariant);

// Get current selection variant (object describing selection/filters)
// Note: chart personalization must be enabled for these to work
const selVariant = chart.getSelectionVariant();
// Modify or apply selection variant
chart.setSelectionVariant(selVariant);
```

**STEP**: 6 — Get and set the currently visible variant ID

**DESCRIPTION**: The Chart supports reading and setting which variant is currently visible. Use the Chart's variant/variant-management integration to get/set the visible variant ID via the chart's variant APIs or the associated Variant Management control. Check the Chart API Reference for the exact method names available in your version.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example pattern (variant-management API names may vary — consult API reference)
// Get visible variant id
const visibleVariantId = chart.getVariantManagement()?.getCurrentVariantId();

// Set (switch to) a visible variant by id
chart.getVariantManagement()?.setCurrentVariantId("variant-123");
```

**STEP**: 7 — Link Chart with FilterBar, add custom actions, and control UI elements

**DESCRIPTION**: You can:
- Link a FilterBar building block to the Chart (wire filter input/selection to chart data).
- Add custom actions (toolbar/menu actions) to the Chart header.
- Configure chart title and control header visibility.
- Control visibility of tabs in chart personalization options.

Implement these by wiring events between FilterBar and Chart, adding toolbar/popover actions in the view/controller, and adjusting Chart attributes or manifest configuration. See the Building Blocks - Chart live examples for patterns.

**LANGUAGE**: Markdown

**CODE**:
```text
See live examples and extension points:
- Building Blocks - Chart (examples): https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/chart/chartDefault
- Chart public APIs: https://ui5.sap.com/#/api/sap.fe.macros.Chart
- Chart APIs examples and extensions: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/chart/chartPublicAPIs

Also see enabling-table-personalization documentation:
enabling-table-personalization-3e2b4d2.md
```

**STEP**: 8 — References: API and example pages

**DESCRIPTION**: Use these links for the full API and interactive examples.

**LANGUAGE**: Markdown

**CODE**:
```text
API Reference: https://ui5.sap.com/#/api/sap.fe.macros.Chart
Building Blocks - Chart examples: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/chart/chartDefault
Building Blocks - Chart public APIs examples: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/chart/chartPublicAPIs
```
--------------------------------

**TITLE**: ConditionalSwitch building block — usage in tables/forms with a factory function

**INTRODUCTION**: Use the ConditionalSwitch building block to display different UI5 controls (ObjectStatus, Button, etc.) per row or form field based on runtime data. Define the properties to watch in the view and implement a lightweight factory function in the controller that returns a control (or oldControl) based on those property values and optional context.

**TAGS**: fiori-elements-framework, ConditionalSwitch, sap.fe.macros, UI5, factory, table, performance, Table, Form

**STEP**: 1 — Add ConditionalSwitch to the XML view (declare watched properties)
**DESCRIPTION**: Insert a ConditionalSwitch inside a Table/Column or Form container. Declare one ConditionalSwitchProperty element per watched property. Each property’s key becomes a property name available in the factory function’s properties parameter. Include namespace declarations for sap.fe.macros.
**LANGUAGE**: XML
**CODE**:
```XML
<mvc:View xmlns:mvc="sap.ui.core.mvc"
          xmlns:macros="sap.fe.macros"
          xmlns:fe="sap.fe.macros">
  <!-- Example: Table column using ConditionalSwitch -->
  <macros:Table metaPath="/Products/@com.sap.vocabularies.UI.v1.LineItem">
    <macros:columns>
      <macros:Column key="My ComplexColumn" width="20rem">
        <!-- factory=".myColumnFactory" points to a controller function -->
        <macros:ConditionalSwitch factory=".myColumnFactory">
          <!-- keys become properties.travelID and properties.price in the factory -->
          <fe:ConditionalSwitchProperty key="travelID" value="{TravelID}" />
          <fe:ConditionalSwitchProperty key="price" value="{TotalPrice}" />
        </macros:ConditionalSwitch>
      </macros:Column>
    </macros:columns>
  </macros:Table>
</mvc:View>
```

**STEP**: 2 — Implement the factory function in the controller
**DESCRIPTION**: Implement the factory function in your controller. Parameters: properties (object keyed by ConditionalSwitchProperty key), context (binding context for the current row in table scenarios), oldControl (previously created control for reuse). Return a control instance or oldControl; return null/undefined to display nothing. Prefer updating and returning oldControl to avoid recreating controls.
**LANGUAGE**: JavaScript
**CODE**:
```JavaScript
// In the controller (e.g., webapp/controller/MyController.controller.js)
myColumnFactory: function (properties, context, oldControl) {
  // properties.travelID and properties.price come from the keys defined in the view
  var travelID = properties.travelID;
  var price = properties.price;

  // Example: show different controls when travelID exists
  if (travelID) {
    // High price -> ObjectStatus with Warning
    if (price && price > 1000) {
      if (oldControl && oldControl instanceof sap.m.ObjectStatus) {
        // reuse and update existing control
        oldControl.setText("Expensive!");
        oldControl.setState("Warning");
        return oldControl;
      }
      // create new control (lightweight)
      return new sap.m.ObjectStatus({
        text: "Expensive!",
        state: "Warning"
      });
    }

    // Otherwise -> Button
    if (oldControl && oldControl instanceof sap.m.Button) {
      oldControl.setText("Increase Price !");
      return oldControl;
    }
    return new sap.m.Button({ text: "Increase Price !" });
  }

  // No travelID -> return oldControl to keep current instance, or null to render nothing
  return oldControl || null;
}
```

**STEP**: 3 — Use context to access row data (optional)
**DESCRIPTION**: In table scenarios, context is the row binding context. Use context.getObject() to read additional runtime data if needed. Keep access minimal and avoid heavy synchronous operations inside the factory.
**LANGUAGE**: JavaScript
**CODE**:
```JavaScript
// Example reading additional fields from the row binding context
myColumnFactory: function (properties, context, oldControl) {
  var rowData = context && context.getObject && context.getObject(); // { TravelID: ..., TotalPrice: ..., ... }
  // Use rowData only when necessary to decide which control to show
  var someFlag = rowData && rowData.SomeFlag;
  // ... rest of logic
}
```

**STEP**: 4 — Performance guidelines and best practices
**DESCRIPTION**: Keep the factory function lightweight: avoid expensive computations, synchronous network calls, heavy DOM operations, or creating new control instances on every invocation. Reuse oldControl by updating its properties when possible. Remember that for grid/tree/analytical tables the factory runs in real time while scrolling.
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "bestPractices": [
    "Return oldControl when possible (update and reuse).",
    "Avoid creating new controls for every row render.",
    "Do not perform network calls or heavy computations inside the factory.",
    "Use context.getObject() sparingly and only when required.",
    "Keep control creation simple and fast (e.g., sap.m.Button, sap.m.ObjectStatus)."
  ]
}
```

**STEP**: 5 — API reference
**DESCRIPTION**: Refer to the official API documentation for sap.fe.macros.ConditionalSwitch for full property and behavior details.
**LANGUAGE**: plain
**CODE**:
```text
API Reference: https://ui5.sap.com/#/api/sap.fe.macros.ConditionalSwitch
```
--------------------------------

**TITLE**: Field building block (sap.fe.macros.Field) — usage, configuration, and examples

**INTRODUCTION**: The Field building block instantiates controls based on metadata (service annotations) and automatically selects appropriate UI controls. Use it inside XML fragments, inside FormElement fields aggregation, or create fields dynamically at runtime in controllers. Configure behavior via formatOptions or manifest controlConfiguration (readOnly, semanticObject, formatOptions). Use cases: standard forms, custom sections/pages, dialogs, table columns, JSON model bindings, value helps, currency formatting, radio-button rendering for fixed value lists.

**TAGS**: fiori-elements-framework, Field, sap.fe.macros, manifest, formatOptions, XML, JSON, runtime, controlConfiguration

STEP: 1 — Basic XML instantiation (fragment)
DESCRIPTION: Use the Field building block in an XML fragment. This instantiates the control tree corresponding to the metadata property referenced by metaPath. Add the macro namespace (sap.fe.macros) and reference metaPath.
LANGUAGE: XML
CODE:
```xml
<!-- File: fragments/MyFieldFragment.fragment.xml -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:macro="sap.fe.macros">
    <!-- Instantiate a Field for the metadata property "MyProperty" -->
    <macro:Field metaPath="MyProperty" />
</core:FragmentDefinition>
```

STEP: 2 — Use Field inside a FormElement (automatically get label)
DESCRIPTION: Place Field inside a FormElement's fields aggregation (or inside a Form building block with an assigned field group for custom sections/pages) to automatically get the label from metadata.
LANGUAGE: XML
CODE:
```xml
<!-- Example: FormElement containing a Fields aggregation -->
<Form>
  <FormContainer>
    <FormElement>
      <!-- Field inside fields aggregation gets label from metadata -->
      <fields>
        <macro:Field metaPath="MyProperty" id="myFieldInForm" />
      </fields>
    </FormElement>
  </FormContainer>
</Form>
```

STEP: 3 — Create a Field dynamically at runtime (controller)
DESCRIPTION: Instantiate Field and FormatOptions at runtime to add the field into dialogs or other UI5 controls. Bind the dialog to an entity path and add the dialog as a dependent to the view/controller.
LANGUAGE: JavaScript
CODE:
```javascript
// Assumes Field, FormatOptions, Dialog, Label, Button are available/imported in the controller scope.
// Place inside your controller: createField: function () { ... }
createField: function () {
    // Configure format options (example: maximum text length)
    const maxLength = new FormatOptions({ textMaxLength: 10 });

    // Create a Field instance bound to the metadata path
    const field = new Field({ metaPath: "/Entities/singleLine", formatOptions: maxLength });

    // Create a dialog and include the Field (with label)
    const newDialog = new Dialog({
        title: "Dialog",
        content: [
            new Label({
                text: "My field",
                labelFor: field
            }),
            field
        ],
        beginButton: new Button({
            text: "OK",
            press: function () { newDialog.close(); }
        }),
        endButton: new Button({
            text: "Cancel",
            press: function () { newDialog.close(); }
        })
    });

    newDialog.addStyleClass("sapUiContentPadding");
    // Bind dialog to an entity from the OData model
    newDialog.bindElement("/Entities(1)");
    // Add dialog as dependent using extension API (or this.getView().addDependent)
    this.getExtensionAPI().addDependent(newDialog);
    newDialog.open();
}
```

STEP: 4 — Manifest-based configuration (controlConfiguration)
DESCRIPTION: Configure Field behavior centrally in manifest.json under controlConfiguration. Supported settings per field (via controlConfiguration) include readOnly, semanticObject, and formatOptions. formatOptions supports:
- textLinesEdit
- textMaxLines
- textMaxCharactersDisplay
- textExpandBehaviorDisplay
- textMaxLength
Note: readOnly and semanticObject are limited by usage context (see restriction below).
LANGUAGE: JSON
CODE:
```json
// Example manifest.json excerpt: set readOnly for a field inside a specific FieldGroup qualifier
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.FieldGroup#myQualifier": {
                  "fields": {
                    "DataField::myFormTextField": {
                      "readOnly": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Manifest restriction for readOnly and semanticObject
DESCRIPTION: readOnly and semanticObject manifest settings are only effective when the Field is placed in the correct grouping context:
- In a standard UI: the Field must be used within a field group (FieldGroup qualifier).
- In a custom section or custom page: the Field must be inside a Form building block that has an assigned field group.

LANGUAGE: Plain text
CODE:
```text
Restriction:
- Standard UI usage: Field must be within a field group to apply readOnly/semanticObject from manifest.
- Custom section/page usage: Field must be within a Form building block with an assigned field group.
```

STEP: 6 — Time data element (example: time picker)
DESCRIPTION: A metadata property of type Time renders as an input field with a time picker in edit mode when using Field.
LANGUAGE: XML
CODE:
```xml
<!-- Custom Section Fragment: timeData -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:macro="sap.fe.macros">
    <VBox width="30vw">
        <Text text="Time Data Field:" />
        <macro:Field metaPath="timeData" id="timeDataField" />
    </VBox>
</core:FragmentDefinition>
```

STEP: 7 — Numeric field with currency (two controls in edit mode)
DESCRIPTION: A numeric property with a currency (CDS Currency) renders as two inputs in edit mode (value + currency selector). Use formatOptions to control measureDisplayMode (influence currency input-readiness/visibility) and displayMode (control value/description ordering).
LANGUAGE: XML
CODE:
```xml
<!-- Basic numeric field with currency -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:macro="sap.fe.macros">
    <VBox width="30vw">
        <Text text="Numeric Field with Currency:" />
        <macro:Field metaPath="numberWithCurrency" id="numberWithCurrencyField" />
    </VBox>
</core:FragmentDefinition>

<!-- Variants showing measureDisplayMode to ReadOnly and Hidden -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:macro="sap.fe.macros">
    <VBox width="30vw">
        <Text text="No formatOptions:" />
        <macro:Field metaPath="numberWithCurrency" id="numberWithCurrencyField" />

        <Text text="measureDisplayMode=ReadOnly:" />
        <macro:Field metaPath="numberWithCurrency" id="numberWithCurrencyFieldCurrencyReadOnly">
            <formatOptions measureDisplayMode="ReadOnly" />
        </macro:Field>

        <Text text="measureDisplayMode=Hidden:" />
        <macro:Field metaPath="numberWithCurrency" id="numberWithCurrencyFieldCurrencyHidden">
            <formatOptions measureDisplayMode="Hidden" />
        </macro:Field>
    </VBox>
</core:FragmentDefinition>

<!-- Variants showing displayMode ordering (value/description) -->
<core:FragmentDefinition
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:macro="sap.fe.macros">
    <VBox width="30vw">
        <Text text="displayMode=ValueDescription:" />
        <macro:Field metaPath="currencyField_code" id="currencyFieldValueDescription">
            <formatOptions displayMode="ValueDescription" />
        </macro:Field>

        <Text text="displayMode=DescriptionValue:" />
        <macro:Field metaPath="currencyField_code" id="currencyFieldDescriptionValue">
            <formatOptions displayMode="DescriptionValue" />
        </macro:Field>
    </VBox>
</core:FragmentDefinition>
```

STEP: 8 — Render fixed value list as radio buttons
DESCRIPTION: If a data element has a fixed value list, instruct Field to render radio buttons by using formatOptions useRadioButtons="true". By default radio button layout is vertical; set radioButtonsHorizontalLayout to true to render horizontally (configurable in manifest or formatOptions depending on runtime/api support).
LANGUAGE: XML
CODE:
```xml
<!-- Field configured to use radio buttons (horizontal layout set via formatOptions) -->
<Text text="Field with fixed value list as radio buttons:" />
<macros:Field metaPath="FieldWithFixedValueList" id="FieldWithFixedValueListRadioButtonsHorizontal">
    <formatOptions useRadioButtons="true" radioButtonsHorizontalLayout="true" />
</macros:Field>
```

STEP: 9 — Use Field with a JSON model or hard-coded value binding
DESCRIPTION: Bind Field value to a JSON model path or provide a hard-coded string using the value property. Supported control types: text fields, date/time pickers, value help, object status (rating indicator edit not supported).
LANGUAGE: XML
CODE:
```xml
<!-- Bind Field to JSON model path -->
<macros:Field
    id="myCustomField"
    metaPath="/RootEntity/name"
    value="{myJSONModel>/customModelBindingPath}" />

<!-- Use a hard-coded string (value property) -->
<macros:Field
    id="myCustomFieldStatic"
    metaPath="/RootEntity/name"
    value="Static display text" />
```

STEP: 10 — Bind description for value help to JSON model
DESCRIPTION: Use the description property together with value when value help requires a description bound to another JSON path.
LANGUAGE: XML
CODE:
```xml
<macros:Field
    id="myCustomField"
    metaPath="/RootEntity/name"
    value="{myJSONModel>/customModelBindingPath}"
    description="{myJSONModel>/customModelDescriptionBindingPath}" />
```

STEP: 11 — API reference
DESCRIPTION: See the official API documentation for properties, methods, events and the complete Field API surface.
LANGUAGE: Plain text
CODE:
```text
API Reference:
https://ui5.sap.com/#/api/sap.fe.macros.Field
```
--------------------------------

**TITLE**: FilterBar Building Block — Usage, APIs, and Integration Notes

**INTRODUCTION**: This document provides compact, code-focused guidance for embedding and controlling the SAP Fiori FilterBar building block (sap.fe.macros.FilterBar) in views, programmatically triggering searches, working with the SelectionVariant format, and opting out of persistence of personalization. Use the samples directly in XML views and controller code.

**TAGS**: fiori-elements-framework, FilterBar, SAPUI5, UI5, building-blocks, selectionVariant, personalization, FilterField

**STEP**: Basic usage (XML view)

**DESCRIPTION**: Add the FilterBar building block to an XML view/fragment. The metaPath points to the UI annotation SelectionFields. Provide handlers for search and filtersChanged events. Default values from UI.SelectionVariant and Common.FilterDefaultValue are supported. For live examples see the SAP Fiori development portal link below.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Add this in your XML view / fragment -->
<macros:FilterBar
    id="FilterBar"
    metaPath="@com.sap.vocabularies.UI.v1.SelectionFields#SF1"
    search=".handlers.onSearch"
    filtersChanged=".handlers.onFiltersChanged" />
```

**STEP**: Fragment context requirement & visual-filter-bar restriction

**DESCRIPTION**: When using the FilterBar inside a custom section or custom subsection that uses a navigation entity, ensure that all controls that need to be filtered reside in the same UI fragment as the FilterBar. The FilterBar building block does not provide a way to programmatically display a "visual filter bar" — this is a restriction.

**LANGUAGE**: plain

**CODE**:
```text
- Ensure controls to be filtered and the <macros:FilterBar> are in the same fragment.
- The control has no API to "bring up" a separate visual filter bar.
```

**STEP**: Programmatically trigger filter search (triggerSearch)

**DESCRIPTION**: Trigger the FilterBar search programmatically on initial load or at any time by calling triggerSearch(). The call validates mandatory filter fields first; the 'Go' action runs only if all mandatory filters have valid values. If validation fails, focus moves to the first missing mandatory field (no highlight or error messages are shown). Use async/await or promises depending on your controller setup.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Controller example: trigger search on initial load
onInit: async function () {
    const oFilterBar = this.byId("FilterBar");
    if (oFilterBar && typeof oFilterBar.triggerSearch === "function") {
        // triggerSearch may return a Promise depending on runtime
        await oFilterBar.triggerSearch();
        // After triggerSearch resolves, the search has been executed (if validation passed)
    }
}

// Trigger search on demand (e.g., user action)
onTriggerFilterSearch: function () {
    const oFilterBar = this.byId("FilterBar");
    if (oFilterBar) {
        oFilterBar.triggerSearch();
    }
}
```

**STEP**: Use SelectionVariant format (getSelectionVariant / setSelectionVariant)

**DESCRIPTION**: Read and write the FilterBar state using SelectionVariant objects. The FilterBar exposes async getSelectionVariant() and setSelectionVariant(selectionVariant). Note: custom filters are not included in these APIs.

**LANGUAGE**: TypeScript / JavaScript

**CODE**:
```typescript
// TypeScript / JS usage examples in controller
async function readSelectionVariant(controller) {
    const oFilterBar = controller.byId("FilterBar");
    if (oFilterBar && typeof oFilterBar.getSelectionVariant === "function") {
        const selectionVariant = await oFilterBar.getSelectionVariant();
        // selectionVariant is a SelectionVariant object you can inspect or persist
        return selectionVariant;
    }
    return null;
}

async function applySelectionVariant(controller, selectionVariant) {
    const oFilterBar = controller.byId("FilterBar");
    if (oFilterBar && typeof oFilterBar.setSelectionVariant === "function") {
        await oFilterBar.setSelectionVariant(selectionVariant);
        // After setting, you may call triggerSearch() to execute the filters
        await oFilterBar.triggerSearch();
    }
}

// API signatures (as documented)
// async getSelectionVariant() : Promise<SelectionVariant>
// async setSelectionVariant(selectionVariant : SelectionVariant) : Promise<void>
```

**STEP**: Ignore persistence of personalization changes (experimental)

**DESCRIPTION**: To keep user personalization (filter values, positions) transient for a FilterBar (not saved as variants or iAppState), set ignorePersonalizationChanges="true" on the FilterBar control. This is experimental—do not use this setting on a control with an existing ID; create a new ID when you enable it. When enabled, variants and application states stored with iAppState are not applied to this filter bar. Recommended for transient contexts only (e.g., custom dialog or value help dialog).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Experimental: do not persist personalization changes for this FilterBar instance -->
<macros:FilterBar
    id="FilterBarTransient"
    metaPath="@com.sap.vocabularies.UI.v1.SelectionFields"
    ignorePersonalizationChanges="true" />
```

**STEP**: Important notes and links

**DESCRIPTION**: Preserve these restrictions and cross-references when implementing:
- Custom filters are not part of getSelectionVariant and setSelectionVariant.
- Do not enable ignorePersonalizationChanges on an existing FilterBar ID; use a new ID.
- Use ignorePersonalizationChanges only for transient UI (dialogs, value help).
- For adding custom filter fields, consult the FilterField building block documentation and examples.

**LANGUAGE**: plain

**CODE**:
```text
Helpful links and docs:
- Filter Bar overview & examples:
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/filterBar/filterBarDefault

- Filter Bar default values examples:
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/filterBar/filterBarDefaultValue

- Filter Bar public APIs (SelectionVariant, triggerSearch, etc.):
  https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/filterBar/filterBarPublicAPIs

- FilterField building block (add custom filter fields):
  the-filterfield-building-block-2df7837.md

- API Reference for sap.fe.macros.FilterBar:
  https://ui5.sap.com/#/api/sap.fe.macros.FilterBar

- Compatibility / experimental features (caution):
  ../02_Read-Me-First/compatibility-rules-91f0873.md

- Managing Variants:
  managing-variants-8ce658e.md

- Store/Restore the Application State (iAppState):
  store-restore-the-application-state-46bf248.md

- Personalization for SAPUI5 Controls:
  ../09_Developing_Controls/how-to-enable-personalization-for-sapui5-controls-5f215c1.md
```
--------------------------------

**TITLE**: FilterField building block — add custom XML filter fields to a FilterBar

**INTRODUCTION**: Shows how to add custom XML fragments as filter fields to a macros:FilterBar using the FilterField building block. Includes a ready-to-use FilterBar example, fragment file skeleton, fragment naming/path conventions, and common attributes/events to wire up the custom fields.

**TAGS**: fiori-elements-framework, filterbar, FilterField, UI5, macros, XML, fragments

**STEP**: 1 — Add FilterField entries to the macros:FilterBar

**DESCRIPTION**: Insert FilterField entries inside macros:filterFields of the macros:FilterBar. Each FilterField provides a key, label and an embedded core:Fragment reference that points to the XML fragment implementing the filter control(s).

**LANGUAGE**: XML

**CODE**:
```XML
<macros:FilterBar
    metaPath="@com.sap.vocabularies.UI.v1.SelectionFields#SF1"
    id="FilterBar"
    showMessages="true"
    search=".handlers.onSearch"
    filterChanged=".handlers.onFiltersChanged"
>
    <macros:filterFields>
        <macros:FilterField key="NameProperty" label="Name">
            <core:Fragment fragmentName="ApplicationNamespace.view.fragments.NameFilterXMLFileName" type="XML" />
        </macros:FilterField>
        <macros:FilterField key="StreetProperty" label="Street" required="true">
            <core:Fragment fragmentName="ApplicationNamespace.view.fragments.StreetFilterXMLFileName" type="XML" />
        </macros:FilterField>
    </macros:filterFields>
</macros:FilterBar>
```

**STEP**: 2 — Create the XML fragment file(s) for each FilterField

**DESCRIPTION**: Create a fragment file for each FilterField. Name and namespace mapping: the fragmentName above (dot-separated, e.g. ApplicationNamespace.view.fragments.NameFilterXMLFileName) maps to a file typically located at webapp/view/fragments/NameFilterXMLFileName.fragment.xml (resource path depends on your project structure). Keep the fragment content minimal and include the UI controls you need (Input, Select, DateRangeSelection, etc.). Replace bindings/placeholders with your real property paths.

**LANGUAGE**: XML

**CODE**:
```XML
<!-- File: webapp/view/fragments/NameFilterXMLFileName.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
    <!-- Replace the control below with the required UI elements and bindings -->
    <Input
        id="nameFilterInput"
        placeholder="Enter name"
        value="{path: 'NameProperty'}" />
</core:FragmentDefinition>
```

**STEP**: 3 — Use fully qualified fragmentName and map to resource files

**DESCRIPTION**: core:Fragment.fragmentName must be the fully qualified name (application namespace + folder + fragment base name). In runtime, UI5 resolves this to the fragment file resource. Example mapping:
- fragmentName: ApplicationNamespace.view.fragments.NameFilterXMLFileName
- file path: webapp/view/fragments/NameFilterXMLFileName.fragment.xml

Use your app's namespace in place of ApplicationNamespace.

**LANGUAGE**: TEXT

**CODE**:
```
Example mapping:
  fragmentName="my.company.app.view.fragments.NameFilterXMLFileName"
  => file: webapp/view/fragments/NameFilterXMLFileName.fragment.xml
```

**STEP**: 4 — Common FilterField attributes and events

**DESCRIPTION**: Important attributes you will use when declaring FilterField elements:
- key: unique identifier for the filter field (used in filter handling).
- label: visible label for the field.
- required="true": enforces required input for the field.
- metaPath: set at macros:FilterBar level to bind selection fields to OData metadata.
- search: handler function path for search event (e.g., ".handlers.onSearch").
- filterChanged: handler function path for filter change events (e.g., ".handlers.onFiltersChanged").

Use these attributes in your FilterBar and implement corresponding handler functions in the controller.

**LANGUAGE**: XML

**CODE**:
```XML
<!-- Example showing required attribute and event handlers -->
<macros:FilterBar
    metaPath="@com.sap.vocabularies.UI.v1.SelectionFields#SF1"
    id="FilterBar"
    search=".handlers.onSearch"
    filterChanged=".handlers.onFiltersChanged"
>
    <macros:filterFields>
        <macros:FilterField key="StartDate" label="Start Date" required="true">
            <core:Fragment fragmentName="my.company.app.view.fragments.StartDateFilter" type="XML" />
        </macros:FilterField>
    </macros:filterFields>
</macros:FilterBar>
```

**STEP**: 5 — References and live examples

**DESCRIPTION**: Use the official API reference and live UI5 examples to inspect FilterField options and sample building-block implementations.

**LANGUAGE**: TEXT

**CODE**:
```
API Reference: https://ui5.sap.com/#/api/sap.fe.macros.filterBar.FilterField
Live example (Filter Bar - Custom Filter): https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/filterBar/filterBarCustom
```
--------------------------------

**TITLE**: FlexibleColumnLayoutActions building block

**INTRODUCTION**: Use the FlexibleColumnLayoutActions building block to add the Close, Enter Full Screen and Exit Full Screen buttons that appear in the top-right corner of applications using the Flexible Column Layout (FCL). Instantiate it inside a fragment that is enabled for building-block usage by referencing the building-block namespace.

**TAGS**: fiori-elements-framework, building-block, flexible-column-layout, macros, sap.fe.macros, UI5, fragments

**STEP**: 1 — Create an XML fragment and declare the building-block namespace

**DESCRIPTION**: Create an XML fragment and add the macros namespace mapping to sap.fe.macros. Use FragmentDefinition as the root and include the building block element <macros:FlexibleColumnLayoutActions/> where the action buttons should appear (top-right area of an FCL application). This fragment can then be included where fragments are supported.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example fragment: FragmentDefinition root, default namespace sap.m (or the UI5 control library you need) -->
<core:FragmentDefinition
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:macros="sap.fe.macros">

  <!-- Instantiate the building block: this creates the Close, Enter Full Screen, Exit Full Screen buttons -->
  <macros:FlexibleColumnLayoutActions/>

</core:FragmentDefinition>
```

**STEP**: 2 — What this instantiates and where to look for API details

**DESCRIPTION**: The single building-block tag above instantiates the control tree that implements the Close, Enter Full Screen, and Exit Full Screen buttons for an app using the flexible column layout. For full API details and available properties/events, consult the library API reference.

**LANGUAGE**: TEXT

**CODE**:
```
API Reference:
https://ui5.sap.com/#/api/sap.fe.macros.FlexibleColumnLayoutActions
```
--------------------------------

**TITLE**: Form Building Block (sap.fe.macros.Form)

**INTRODUCTION**: Instantiate UI5 Fiori Elements forms from OData annotations. Use sap.fe.macros.Form to render a form from a FieldGroup annotation or a CollectionFacet that contains FieldGroups. You can also append inline form elements (macros:FormElement) to the generated form for custom placements or labels.

**TAGS**: fiori-elements-framework, form, FieldGroup, CollectionFacet, UI5, macros, sap.fe.macros.Form

**STEP**: 1 — Basic form from a FieldGroup annotation

**DESCRIPTION**: Create a form by setting metaPath to a FieldGroup annotation. Required/commonly used attributes:
- id: control ID
- metaPath: annotation path, e.g. @com.sap.vocabularies.UI.v1.FieldGroup#<FacetID>
- title: visible title of the form

Set metaPath to the exact annotation path for the FieldGroup you want rendered.

**LANGUAGE**: XML

**CODE**:
```xml
<macros:Form
     id="myForm"
     metaPath="@com.sap.vocabularies.UI.v1.FieldGroup#General"
     title="My Title"
/>
```

**STEP**: 2 — Form from a CollectionFacet (multiple FieldGroups)

**DESCRIPTION**: Point metaPath to a CollectionFacet that contains multiple FieldGroups. The Form macro will render each FieldGroup inside the referenced CollectionFacet. Use the CollectionFacet annotation ID after the #.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: metaPath points to a CollectionFacet annotation by ID -->
<macros:Form
     id="myFormFromCollection"
     metaPath="@com.sap.vocabularies.UI.v1.CollectionFacet#MainGroups"
     title="Main Groups"
/>
```

**STEP**: 3 — Add inline form elements (macros:FormElement)

**DESCRIPTION**: Add inline macros:FormElement child nodes inside macros:Form to insert or override individual form fields. Common FormElement attributes:
- metaPath: property name or annotation path for the element
- id: element ID
- label: visible label text
- placement: "Before" or "After" (placement relative to anchor)
- anchor: reference DataField or property to anchor the placement, e.g. "DataField::NumberProperty"

Inline FormElement nodes are merged into the annotated FieldGroup rendering.

**LANGUAGE**: XML

**CODE**:
```xml
<macros:Form
     id="myForm"
     metaPath="@com.sap.vocabularies.UI.v1.FieldGroup#General"
     title="My Title"
>
     <macros:FormElement
          metaPath="ID"
          id="formElementMacroID"
          label="ID Property After Number"
          placement="After"
          anchor="DataField::NumberProperty"
     />
</macros:Form>
```

**STEP**: 4 — API reference

**DESCRIPTION**: Consult the official API for all available properties, events and methods on the Form macro.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "API Reference": "https://ui5.sap.com/#/api/sap.fe.macros.Form"
}
```
--------------------------------

**TITLE**: FormElement building block — usage and examples

**INTRODUCTION**: The FormElement building block (sap.fe.macros.FormElement) wraps a labeled form field with visibility control and automatic label resolution from annotations. Use it inside a UI5 Form → FormContainer → formElements aggregation. By default it creates an inner Field building block using the same metaPath; to customize the inner Field, use the fields aggregation.

**TAGS**: fiori-elements-framework, sap.fe.macros, FormElement, Field, FormContainer, Form, UI5, XML

**STEP**: 1 — Minimal usage inside a UI5 Form
**DESCRIPTION**: Place FormElement inside the formElements aggregation of a FormContainer. Provide metaPath to bind to an annotated property. The FormElement will automatically create an inner Field using the same metaPath and derive the label from annotations if available.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Minimal FormElement usage: automatically creates an inner Field using the same metaPath -->
<f:Form xmlns:f="sap.ui.layout.form" xmlns:macros="sap.fe.macros">
  <f:layout>
    <f:ColumnLayout columnsM="2" columnsL="3" columnsXL="4" labelCellsLarge="12"/>
  </f:layout>
  <f:formContainers>
    <f:FormContainer>
      <f:formElements>
        <macros:FormElement id="myID" metaPath="MyProperty"/>
      </f:formElements>
    </f:FormContainer>
  </f:formContainers>
</f:Form>
```

**STEP**: 2 — Customize the inner Field using fields aggregation
**DESCRIPTION**: To provide detailed configuration for the inner Field (control type, formatting, or additional attributes), declare one or more macros:Field elements inside the FormElement's fields aggregation. The FormElement uses the declared Field(s) instead of automatically creating one.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- FormElement with a customized inner Field via the fields aggregation -->
<f:Form xmlns:f="sap.ui.layout.form" xmlns:macros="sap.fe.macros">
  <f:layout>
    <f:ColumnLayout columnsM="2" columnsL="3" columnsXL="4" labelCellsLarge="12"/>
  </f:layout>
  <f:formContainers>
    <f:FormContainer>
      <f:formElements>
        <macros:FormElement id="myID" metaPath="MyProperty">
          <macros:fields>
            <!-- Configure the Field building block for MyProperty explicitly -->
            <macros:Field metaPath="MyProperty"/>
          </macros:fields>
        </macros:FormElement>
      </f:formElements>
    </f:FormContainer>
  </f:formContainers>
</f:Form>
```

**STEP**: 3 — Required placement and layout considerations
**DESCRIPTION**: Always place FormElement inside the formElements aggregation of a FormContainer which itself must be inside a Form. Use Form layout (e.g., ColumnLayout) to control column counts and label cell sizes. Ensure correct namespace declarations: xmlns:f="sap.ui.layout.form" and xmlns:macros="sap.fe.macros".
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Example that shows required nesting and layout attributes -->
<f:Form xmlns:f="sap.ui.layout.form" xmlns:macros="sap.fe.macros">
  <f:layout>
    <f:ColumnLayout columnsM="2" columnsL="3" columnsXL="4" labelCellsLarge="12"/>
  </f:layout>
  <f:formContainers>
    <f:FormContainer>
      <f:formElements>
        <macros:FormElement id="elem1" metaPath="PropertyA"/>
        <macros:FormElement id="elem2" metaPath="PropertyB"/>
      </f:formElements>
    </f:FormContainer>
  </f:formContainers>
</f:Form>
```

**STEP**: 4 — Where FormElement can be reused
**DESCRIPTION**: Use FormElement in custom header facets, custom sections, custom pages, and custom table columns within Fiori elements apps. It is specifically designed as a building block for consistent labeled fields with visibility control and annotation-driven labels.
**LANGUAGE**: Text
**CODE**:
```text
Valid usage examples:
- Custom header facet fragments
- Custom section fragments
- Custom page fragments
- Custom table column fragments
Ensure the FormElement is placed inside a Form -> FormContainer -> formElements aggregation.
```

**STEP**: 5 — API reference
**DESCRIPTION**: Consult the official API reference for detailed properties, aggregations, and events of sap.fe.macros.FormElement.
**LANGUAGE**: Text
**CODE**:
```text
API Reference: https://ui5.sap.com/#/api/sap.fe.macros.FormElement
```
--------------------------------

**TITLE**: KPITag Building Block — Usage Examples and How-To

**INTRODUCTION**: The KPITag building block (sap.fe.macros.KPITag) renders a compact KPI value with an optional unit and status indicator. Use it inside XML views or fragments in SAP Fiori elements apps to show numeric KPIs with binding support and conditional status coloring.

**TAGS**: fiori-elements-framework, KPITag, KPI, sap.fe.macros, UI5, XML, binding

**STEP**: 1 — Basic usage inside an XML view

**DESCRIPTION**: Minimal XML view example showing how to add a KPITag. Include required XML namespace for the macros and a simple property binding for number and unit.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  controllerName="my.app.controller.Detail">
  <!-- KPITag with bound number and unit, static status -->
  <macros:KPITag
    id="mySuccessKPI"
    number="{TotalPrice}"
    unit="{CurrencyCode_code}"
    status="Success" />
</mvc:View>
```

**STEP**: 2 — KPITag inside a fragment

**DESCRIPTION**: Example showing KPITag usage inside a FragmentDefinition. Use this when you want to reuse the KPI tag markup as a fragment.

**LANGUAGE**: XML

**CODE**:
```xml
<core:FragmentDefinition
  xmlns:core="sap.ui.core"
  xmlns:macros="sap.fe.macros">
  <macros:KPITag
    id="fragmentKPI"
    number="{/Totals/TotalPrice}"
    unit="{/Totals/CurrencyCode_code}"
    status="Neutral" />
</core:FragmentDefinition>
```

**STEP**: 3 — Dynamic status using expression binding

**DESCRIPTION**: Use UI5 expression binding to compute the status from the bound value. This example sets status to "Success" when the number exceeds 1000, otherwise "Warning".

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  controllerName="my.app.controller.Detail">
  <macros:KPITag
    id="conditionalKPI"
    number="{TotalPrice}"
    unit="{CurrencyCode_code}"
    status="{= ${TotalPrice} > 1000 ? 'Success' : 'Warning' }" />
</mvc:View>
```

**STEP**: 4 — Formatting the number value (binding with type)

**DESCRIPTION**: Show numeric formatting by specifying a binding object with a UI5 type. Useful for forcing decimal places or locale-aware formatting.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  controllerName="my.app.controller.Detail">
  <macros:KPITag
    id="formattedKPI"
    number="{ path: 'TotalPrice', type: 'sap.ui.model.type.Float', formatOptions: { minFractionDigits: 2, maxFractionDigits: 2 } }"
    unit="{CurrencyCode_code}"
    status="Neutral" />
</mvc:View>
```

**STEP**: 5 — Accepted status values and API link

**DESCRIPTION**: KPITag status property accepts these semantic values: "Success", "Warning", "Error", "Neutral". For full API details, props, events and richer examples, consult the official API reference and live examples.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "component": "sap.fe.macros.KPITag",
  "properties": {
    "id": "string",
    "number": "any (binding supported)",
    "unit": "string (binding supported)",
    "status": "Success | Warning | Error | Neutral"
  },
  "documentation": {
    "apiReference": "https://ui5.sap.com/#/api/sap.fe.macros.KPITag",
    "liveExamples": "https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/kpiTag/kpiTagDefault"
  }
}
```
--------------------------------

**TITLE**: MessageButton building block (Fiori Elements) — embed, hook, and message handling examples

**INTRODUCTION**: Practical, code-focused examples and handler templates to embed the sap.fe.macros.MessageButton in an XML view, implement the visibilityChange handler, implement the controller extension hook beforeShowMessageButton() to control rendering, grouping and link behavior, and manage the message lifecycle in the message model. Use these snippets when you need to surface bound, non-technical messages in a footer or custom container and customize how messages are displayed and handled.

**TAGS**: fiori-elements, ui5, MessageButton, message-model, controller-extension, XML, JavaScript

**STEP**: 1 — Embed MessageButton in an XML view

**DESCRIPTION**: Add the MessageButton building block to your XML view. Declare the macros namespace and wire the visibilityChange handler to your controller method. This is the minimal embed; the handler is executed before the control is shown so you can show/hide the parent container.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: view/MyObjectPage.view.xml -->
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  xmlns:core="sap.ui.core"
  controllerName="my.namespace.controller.MyObjectPage">
  <!-- Place the MessageButton where required, e.g. footer toolbar -->
  <macros:MessageButton visibilityChange=".handleMessageButtonVisibility" />
</mvc:View>
```

**STEP**: 2 — Implement visibilityChange handler in controller

**DESCRIPTION**: The visibilityChange handler is invoked before the MessageButton is displayed. Typical use: show or hide the parent container (e.g., footer toolbar). Implement the handler in your page controller. The handler receives a boolean (visible) or an object depending on your FE version; the example shows both safe checks.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: controller/MyObjectPage.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("my.namespace.controller.MyObjectPage", {
    /**
     * Called by the MessageButton macro before showing the control.
     * @param {boolean|object} vPayload - boolean visible OR an object with details (check your FE version).
     */
    handleMessageButtonVisibility: function (vPayload) {
      // Normalize payload to boolean visible
      var bVisible = (typeof vPayload === "boolean") ? vPayload : (vPayload && vPayload.visible) || false;

      // Example: show/hide footer toolbar
      var oFooterToolbar = this.byId("pageFooterToolbar"); // ensure view has this ID
      if (oFooterToolbar) {
        oFooterToolbar.setVisible(bVisible);
      }
    }
  });
});
```

**STEP**: 3 — Implement the beforeShowMessageButton controller extension hook to control rendering, grouping, and link behavior

**DESCRIPTION**: The MessageButton building block calls the controller extension hook beforeShowMessageButton() when bound, non-technical messages exist. Implement this hook to:
- decide whether the building block should render the messages (renderDefault),
- filter or transform messages,
- group messages (default group: "General"),
- override link click behavior (focus a field, open dialog, etc.).

Below are example controller-extension implementations showing common patterns:
- prevent default rendering and show messages in a dialog when NOT in edit mode,
- group messages by a custom field,
- override the message link action.

Adjust signatures to your FE version; examples use an object parameter { messages, renderDefault, setGroups, overrideLinkAction } — if your FE version uses a different signature, adapt accordingly.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: controllerextensions/MessageButtonExtension.js
// This file demonstrates typical hook implementations for beforeShowMessageButton
sap.ui.define([], function () {
  "use strict";

  return {
    /**
     * Hook invoked before MessageButton is shown.
     * Example signature (adapt if your FE runtime passes different params):
     * @param {object} oParams
     * @param {Array<object>} oParams.messages - array of message objects collected from the message model
     * @param {function(boolean)} oParams.renderDefault - call with true/false to allow/stop default rendering
     * @param {function(Object)} oParams.setGroups - call with grouping map: { "GroupName": [messageIndex, ...], ... }
     * @param {function(function)} oParams.overrideLinkAction - pass a callback to handle link press for messages
     */
    beforeShowMessageButton: function (oParams) {
      // Defensive check
      oParams = oParams || {};
      var aMessages = oParams.messages || [];

      // 1) Example: Do not render default MessageButton content when not in edit mode.
      // Assume we have an application state check accessible via this.isDraftEnabled / this.isInEditMode()
      var bInEditMode = (this && typeof this.isInEditMode === "function") ? this.isInEditMode() : false;
      if (!bInEditMode) {
        // Tell the building block NOT to render the default message popover
        if (typeof oParams.renderDefault === "function") {
          oParams.renderDefault(false);
        }

        // Open a custom dialog with messages instead of the popover
        this._showMessagesInDialog(aMessages);
        return; // we handled presentation; building block won't show default
      }

      // 2) Example: Group messages by a custom target path (fallback to "General")
      var mGroups = {};
      aMessages.forEach(function (oMsg, iIndex) {
        var sGroup = (oMsg && oMsg.target) ? oMsg.target.split("/")[1] : "General";
        if (!sGroup) { sGroup = "General"; }
        if (!mGroups[sGroup]) { mGroups[sGroup] = []; }
        mGroups[sGroup].push(iIndex); // pass indices of messages that belong in group
      });
      if (typeof oParams.setGroups === "function") {
        oParams.setGroups(mGroups); // building block uses this map to group messages
      }

      // 3) Example: Override message link behavior to focus a specific control
      if (typeof oParams.overrideLinkAction === "function") {
        var that = this;
        oParams.overrideLinkAction(function (oMessage) {
          // oMessage: single message object clicked
          // Custom behavior: focus a control by field id contained in oMessage.targetId (example)
          if (oMessage && oMessage.targetId) {
            var oTarget = that.byId(oMessage.targetId);
            if (oTarget && typeof oTarget.focus === "function") {
              oTarget.focus();
              return;
            }
          }
          // fallback: open message details dialog
          that._showMessageDetails(oMessage);
        });
      }

      // If we did not call renderDefault(false), building block will render default popover.
    },

    // Example helpers used above
    _showMessagesInDialog: function (aMessages) {
      // Create and open a dialog displaying messages; implement for your app UI
      // For brevity, use console.log here as placeholder
      console.log("Opening message dialog with messages:", aMessages);
      // TODO: implement actual sap.m.Dialog listing messages
    },

    _showMessageDetails: function (oMessage) {
      console.log("Show details for message:", oMessage);
      // TODO: implement detail dialog
    }
  };
});
```

**STEP**: 4 — Access and manage the message model lifecycle (clear, filter, and add messages)

**DESCRIPTION**: You must manage the lifecycle of messages in the message model. Clear messages that are no longer relevant (e.g., after Save) and only add state messages after finalizing actions. Examples below show reading messages, filtering for bound, non-technical messages, and clearing messages. Adjust model API calls to match your UI5/FioriElements version.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example utility methods in a controller to read and manage messages.
// File: controller/MessageUtils.js (import into your controller or extension as needed)
sap.ui.define([], function () {
  "use strict";

  return {
    getAllMessages: function () {
      var oMessageManager = sap.ui.getCore().getMessageManager && sap.ui.getCore().getMessageManager();
      if (!oMessageManager) {
        return [];
      }
      // MessageModel structure can vary. Commonly the model exposes an array of messages.
      var oMsgModel = oMessageManager.getMessageModel && oMessageManager.getMessageModel();
      var aMsgs = [];
      if (oMsgModel && typeof oMsgModel.getData === "function") {
        // Many runtimes store messages under property '/'. Try common fallbacks.
        var oData = oMsgModel.getData();
        aMsgs = oData && (oData.messages || oData) || [];
      } else if (typeof oMessageManager.getMessageModel === "function") {
        // fallback: try getProperty on common paths
        try {
          aMsgs = oMessageManager.getMessageModel().getProperty("/messages") || [];
        } catch (e) {
          aMsgs = [];
        }
      }
      return aMsgs;
    },

    getBoundNonTechnicalMessages: function () {
      var aAll = this.getAllMessages();
      // Filter for bound, non-technical messages.
      // Typical message object fields: { message, type, technical, target, targetId, ... }
      return aAll.filter(function (m) {
        var bNonTechnical = (m.technical === false) || (m.technical === undefined);
        var bIsBound = !!m.target; // presence of target indicates bound message
        return bNonTechnical && bIsBound;
      });
    },

    clearAllMessages: function () {
      var oMessageManager = sap.ui.getCore().getMessageManager && sap.ui.getCore().getMessageManager();
      if (oMessageManager && typeof oMessageManager.removeAllMessages === "function") {
        oMessageManager.removeAllMessages();
      }
    },

    addStateMessageAfterSave: function (sText, sTarget) {
      // Example: add a state message only after Save completes
      var oMessageManager = sap.ui.getCore().getMessageManager && sap.ui.getCore().getMessageManager();
      if (!oMessageManager) { return; }

      // Create a message - adapt to your Message constructor if different in your runtime
      var oMessage = new sap.ui.core.message.Message({
        message: sText,
        type: sap.ui.core.MessageType.Success,
        target: sTarget,
        processor: this.getView().getModel() // optional: attach to model/processor used by your app
      });
      oMessageManager.addMessages(oMessage);
    }
  };
});
```

**STEP**: 5 — API reference

**DESCRIPTION**: Official API documentation for the MessageButton building block and its properties.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "apiReference": "https://ui5.sap.com/#/api/sap.fe.macros.MessageButton"
}
```
--------------------------------

**TITLE**: MicroChart Building Block — XML usage and attributes

**INTRODUCTION**: Quick reference and copy-ready XML examples for using the sap.fe.macros.MicroChart building block in Fiori Elements views. Shows required namespaces, common attributes (id, metaPath, contextPath, batchGroupId, size, showOnlyChart), and rules for metaPath/contextPath resolution.

**TAGS**: fiori-elements, ui5, microchart, macroui, sap.fe.macros, XML

**STEP**: 1 — Minimal XML view example with namespace
**DESCRIPTION**: Place the MicroChart macro inside an XML view or fragment. Ensure the macros namespace is declared. This minimal example shows id, metaPath, contextPath and batchGroupId attributes exactly as in the source sample.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- In your XML view/fragment root element add:
     xmlns:macros="sap.fe.macros"
-->
<mvc:View
    controllerName="your.controller.Name"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:core="sap.ui.core"
    xmlns:macros="sap.fe.macros">

    <!-- Minimal MicroChart usage -->
    <macros:MicroChart
        id="bar"
        metaPath="@com.sap.vocabularies.UI.v1.Chart#BarStackedPath"
        contextPath="/RootEntity/_Item"
        batchGroupId="$auto.abc" />
</mvc:View>
```

**STEP**: 2 — Show-only-chart and size attributes
**DESCRIPTION**: Control rendering options. Use showOnlyChart to hide labels and size to adjust chart dimensions. Include examples for both attributes; adapt size tokens to your design system (e.g., "S", "M", "L" or other project conventions).
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Hide labels, render only the micro chart -->
<macros:MicroChart
    id="compactChart"
    metaPath="@com.sap.vocabularies.UI.v1.Chart#BarStackedPath"
    contextPath="/RootEntity/_Item"
    showOnlyChart="true" />

<!-- Adjust chart size -->
<macros:MicroChart
    id="mediumChart"
    metaPath="@com.sap.vocabularies.UI.v1.Chart#BarStackedPath"
    contextPath="/RootEntity/_Item"
    size="M" />
```

**STEP**: 3 — metaPath and contextPath resolution rules (absolute vs relative)
**DESCRIPTION**: Use absolute metaPath when it starts with an annotation path (leading "@"). If metaPath is absolute, contextPath is optional. If metaPath is relative (no leading "@") and no contextPath is provided, the macro uses the parent binding path as the contextPath. Examples show both cases.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Absolute metaPath (annotation path) — contextPath optional -->
<macros:MicroChart
    id="absoluteChart"
    metaPath="@com.sap.vocabularies.UI.v1.Chart#BarStackedPath" />

<!-- Relative metaPath — provide contextPath explicitly -->
<macros:MicroChart
    id="relativeChart"
    metaPath="MyRelativeChartReference#SomeChart"
    contextPath="/RootEntity/_Item" />

<!-- Relative metaPath without contextPath:
     parent binding path will be used as contextPath by the macro -->
<SomeParentElement binding="{/RootEntity/_Item}">
    <macros:MicroChart
        id="inheritedContextChart"
        metaPath="MyRelativeChartReference#SomeChart" />
</SomeParentElement>
```

**STEP**: 4 — Additional attribute: batchGroupId
**DESCRIPTION**: Use batchGroupId to control OData batching for requests initiated by the macro. Example uses an automatic batch group id token.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Example using batchGroupId -->
<macros:MicroChart
    id="batchedChart"
    metaPath="@com.sap.vocabularies.UI.v1.Chart#BarStackedPath"
    contextPath="/RootEntity/_Item"
    batchGroupId="$auto.abc" />
```

**STEP**: 5 — References: API and live examples
**DESCRIPTION**: External resources for API details and live examples.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "API": "https://ui5.sap.com/#/api/sap.fe.macros.MicroChart",
  "LiveExamples": "https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/microchart/microChartDefault"
}
```
--------------------------------

**TITLE**: Page Building Block (sap.fe.macros.Page) — XML usage and examples

**INTRODUCTION**: Use the sap.fe.macros.Page building block to create a custom page with predefined layout, margins and paddings. This document provides ready-to-use XML view examples, attribute usage, and pointers to the API and live demos for quick integration in Fiori Elements / UI5 views.

**TAGS**: fiori-elements-framework, page, building-block, macros, sap.fe.macros, UI5, SAPUI5, XML, view

**STEP**: 1 — Create an XML view containing the Page building block

**DESCRIPTION**: Add a Page macro to an XML view. Include the macros namespace and use sap.m controls for content panels and text. Example file path: webapp/view/MyPage.view.xml

**LANGUAGE**: XML

**CODE**:
```xml
<?xml version="1.0" encoding="utf-8"?>
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  xmlns:m="sap.m"
  displayBlock="true">
  <!-- Page macro: provides preconfigured paddings/margins -->
  <macros:Page title="Page title" description="Page description" avatarSrc="sap-icon://page" id="myPage">
    <m:Panel headerText="First content" id="firstContent">
      <m:Text text="This is the first content of the page" />
    </m:Panel>

    <m:Panel headerText="Second content" id="secondContent">
      <m:Text text="This is the second content, it is properly padded" />
    </m:Panel>
  </macros:Page>
</mvc:View>
```

**STEP**: 2 — Common attributes and usage patterns

**DESCRIPTION**: Use these attributes to configure the Page. Add child controls (sap.m.Panel, sap.m.FlexBox, sap.m.List, custom fragments) inside the Page content aggregation. IDs are optional but recommended for testing and programmatic access.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Attributes -->
<macros:Page
  id="orderPage"                    <!-- optional stable id -->
  title="Orders"                    <!-- main title -->
  description="Open orders list"    <!-- subtitle/description -->
  avatarSrc="sap-icon://orders"     <!-- icon on the header -->
/>

<!-- Child content examples -->
<macros:Page ...>
  <!-- Panel with headerText -->
  <m:Panel headerText="Details">
    <m:Text text="Detail content..." />
  </m:Panel>

  <!-- Any SAPUI5 control or fragment can be added -->
  <m:Panel headerText="Items">
    <m:List>
      <!-- list items -->
    </m:List>
  </m:Panel>
</macros:Page>
```

**STEP**: 3 — Notes on layout and behavior

**DESCRIPTION**: The Page building block applies standard paddings and margins suitable for Fiori apps. Use panels or other controls as children; spacing is applied automatically. No additional CSS is required for default spacing. Use stable IDs for accessibility and automated tests.

**LANGUAGE**: text

**CODE**:
```
Behavior notes:
- The Page macro handles layout padding/margins automatically.
- Child controls are placed inside the Page content area; use Panels to get section headers.
- Provide avatarSrc (icon URI) to show an icon in the page header.
- Use unique IDs (id property) for runtime control or test selectors.
```

**STEP**: 4 — References: API and live examples

**DESCRIPTION**: Use the API reference for full property/method/event list and the SAP Fiori development portal for live examples.

**LANGUAGE**: text

**CODE**:
```
API Reference:
https://ui5.sap.com/#/api/sap.fe.macros.Page

Live examples and playground:
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/page/pageDefault
```
--------------------------------

**TITLE**: SAP Fiori `Paginator` Building Block (sap.fe.macros.Paginator)

**INTRODUCTION**: Use the `Paginator` building block to add paginator buttons for traversing lists in Fiori elements apps. This guide shows how to add the control to an XML view and wire it to an existing list/table binding from a controller. Use the API reference link to inspect specific methods and properties when needed.

**TAGS**: fiori-elements-framework, paginator, sapui5, sap.fe.macros, ui5, building-blocks

**STEP**: 1 — Add Paginator to an XML View

**DESCRIPTION**: Import the macros namespace and place the Paginator in the view. Adjust placement to match your page/layout.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example XML view snippet -->
<mvc:View
  controllerName="my.app.controller.List"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:macros="sap.fe.macros">

  <Page id="page">
    <content>
      <!-- Your list or table (example: sap.m.List or sap.ui.table.Table / SmartTable) -->
      <List id="myList">
        <!-- list items binding omitted for brevity -->
      </List>

      <!-- Paginator building block -->
      <macros:Paginator id="paginator" />
    </content>
  </Page>
</mvc:View>
```

**STEP**: 2 — Wire Paginator to a List/Table Binding (JavaScript controller)

**DESCRIPTION**: In the controller, get the UI control that provides the list binding (List, Table, or SmartTable), obtain the ListBinding (getBinding("items") or getBinding("rows") depending on control), and pass it to the paginator. Also set the initial binding context if required. Attach after the list/table and binding are available (onInit or onAfterRendering).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Controller: my/app/controller/List.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("my.app.controller.List", {
    onInit: function () {
      // If binding exists immediately:
      this._initPaginator();

      // Or ensure initialization after rendering / data load:
      // this.getView().byId("myList").attachEventOnce("updateFinished", this._initPaginator.bind(this));
    },

    _initPaginator: function () {
      var oView = this.getView();
      var oList = oView.byId("myList");
      var oPaginator = oView.byId("paginator");

      if (!oList || !oPaginator) {
        return;
      }

      // Get the list binding. Use "items" for sap.m.List / sap.m.Table,
      // use "rows" for sap.ui.table.Table, or use SmartTable.getTable().getBinding("rows/items")
      var oListBinding = oList.getBinding("items") || oList.getBinding("rows");

      if (!oListBinding) {
        // If the binding is not yet available, attach a one-time change/dataReceived handler
        var fnAttach = function () {
          oListBinding = oList.getBinding("items") || oList.getBinding("rows");
          if (oListBinding) {
            // Set the binding on the paginator
            if (typeof oPaginator.setListBinding === "function") {
              oPaginator.setListBinding(oListBinding);
            } else {
              // Fallback: set binding context if the control exposes standard UI5 context API
              oPaginator.setBindingContext(oList.getBindingContext && oList.getBindingContext());
            }
          }
        }.bind(this);

        // Example: attach to the list's updateFinished/dataReceived event depending on control
        if (oList.attachEvent) {
          oList.attachEventOnce("updateFinished", fnAttach);
        }
        return;
      }

      // If binding is present now, assign it
      if (typeof oPaginator.setListBinding === "function") {
        oPaginator.setListBinding(oListBinding);
      } else {
        oPaginator.setBindingContext(oList.getBindingContext && oList.getBindingContext());
      }

      // Optionally set an initial context for the paginator (if you have one)
      // var oInitialContext = oView.getModel().getContext("/SomeEntitySet(...)");
      // oPaginator.setBindingContext(oInitialContext);
    }
  });
});
```

**STEP**: 3 — Wire Paginator to a List/Table Binding (TypeScript controller)

**DESCRIPTION**: Same wiring pattern in a TypeScript controller; include typing for controls and binding. Adjust imports and types to your project setup.

**LANGUAGE**: TypeScript

**CODE**:
```typescript
// Controller: my/app/controller/List.controller.ts
import Controller from "sap/ui/core/mvc/Controller";
import List from "sap/m/List";
import Control from "sap/ui/core/Control";
import type ListBinding from "sap/ui/model/ListBinding";

export default class ListController extends Controller {
  onInit(): void {
    this._initPaginator();
  }

  private _initPaginator(): void {
    const oView = this.getView();
    const oList = oView.byId("myList") as unknown as List | undefined;
    const oPaginator = oView.byId("paginator") as unknown as Control | undefined;

    if (!oList || !oPaginator) {
      return;
    }

    let oListBinding = (oList as any).getBinding("items") as ListBinding | undefined;
    oListBinding = oListBinding || (oList as any).getBinding("rows");

    if (!oListBinding) {
      (oList as any).attachEventOnce?.("updateFinished", () => {
        oListBinding = (oList as any).getBinding("items") || (oList as any).getBinding("rows");
        if (oListBinding && typeof (oPaginator as any).setListBinding === "function") {
          (oPaginator as any).setListBinding(oListBinding);
        }
      });
      return;
    }

    if (typeof (oPaginator as any).setListBinding === "function") {
      (oPaginator as any).setListBinding(oListBinding);
    } else {
      // fallback to setting binding context if applicable
      (oPaginator as any).setBindingContext?.((oList as any).getBindingContext?.());
    }
  }
}
```

**STEP**: 4 — Notes, events, and troubleshooting

**DESCRIPTION**:
- Use getBinding("items") for sap.m.List / sap.m.Table, getBinding("rows") for sap.ui.table.Table, or obtain the binding from SmartTable.getTable().
- If the list binding is created asynchronously, attach to updateFinished / dataReceived / change events to set the paginator after the binding exists.
- To set an initial navigation context for the paginator, set a binding context on the paginator control (setBindingContext) or consult the API reference for any paginator-specific initialContext property/method.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "apiReference": "https://ui5.sap.com/#/api/sap.fe.macros.Paginator",
  "exampleViewSnippet": "<macros:Paginator id=\"paginator\" />",
  "commonBindings": ["items", "rows"]
}
```

**STEP**: 5 — API Reference

**DESCRIPTION**: Consult the official API for exact properties and methods exposed by sap.fe.macros.Paginator (e.g., any paginator-specific setters/getters). Use the API to adapt the code above to the exact method names in your UI5 version.

**LANGUAGE**: URL

**CODE**:
```text
https://ui5.sap.com/#/api/sap.fe.macros.Paginator
```
--------------------------------

**TITLE**: RichTextEditor Building Block (SAP Fiori Elements)

**INTRODUCTION**: Use the RichTextEditor building block to display formatted text in display mode and allow inline editing in edit mode. This building block wraps the SAPUI5 rich text editor and exposes button groups and plugins the same way as the underlying control.

**TAGS**: fiori-elements-framework, sap.fe.macros, rich-text, SAPUI5, RichTextEditor, macros, UI5

**STEP**: 1 — Add RichTextEditor to an XML View

**DESCRIPTION**: Insert the RichTextEditor building block into an XML view. Bind the value to a model property (example: custom>/myFormattedValue). Set id and required attributes as needed. Include namespaces required for macros and the richtexteditor sub-tags.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:macros="sap.fe.macros"
  xmlns:richtexteditor="sap.fe.macros.richtexteditor"
  controllerName="your.controller.Name">

  <macros:RichTextEditor
    id="myRichTextEditor"
    value="{custom>/myFormattedValue}"
    required="true">

    <!-- configure button groups (see Step 2) -->
    <macros:buttonGroups>
      <richtexteditor:ButtonGroup
        name="font-style"
        visible="true"
        priority="10"
        customToolbarPriority="10"
        buttons="bold,italic"/>
      <richtexteditor:ButtonGroup
        name="styleselect"
        visible="true"
        priority="10"
        customToolbarPriority="10"
        buttons="styleselect"/>
      <richtexteditor:ButtonGroup
        name="table"
        visible="true"
        priority="10"
        customToolbarPriority="10"
        buttons="table"/>
    </macros:buttonGroups>

    <!-- configure plugins (see Step 3) -->
    <macros:plugins>
      <richtexteditor:Plugin name="autoresize"/>
    </macros:plugins>

  </macros:RichTextEditor>

</mvc:View>
```

**STEP**: 2 — Configure Button Groups

**DESCRIPTION**: Define button groups to control which toolbar buttons are available. Important attributes:
- name: identifier for the group (e.g., "font-style", "table").
- visible: boolean to show/hide the group.
- priority: toolbar priority (numeric).
- customToolbarPriority: priority for custom toolbars (numeric).
- buttons: comma-separated list of button identifiers supported by the underlying editor (e.g., "bold,italic,underline").

**LANGUAGE**: XML

**CODE**:
```xml
<macros:buttonGroups>
  <richtexteditor:ButtonGroup
    name="font-style"
    visible="true"
    priority="10"
    customToolbarPriority="10"
    buttons="bold,italic,underline"/>
  <richtexteditor:ButtonGroup
    name="styleselect"
    visible="true"
    priority="10"
    customToolbarPriority="10"
    buttons="styleselect"/>
  <!-- add or remove groups as required -->
</macros:buttonGroups>
```

**STEP**: 3 — Add Plugins

**DESCRIPTION**: Add plugins to extend editor behavior. Use the richtexteditor:Plugin element and provide plugin name(s) supported by the SAPUI5 rich text editor.

**LANGUAGE**: XML

**CODE**:
```xml
<macros:plugins>
  <richtexteditor:Plugin name="autoresize"/>
  <!-- Example: add other plugin names supported by the editor -->
</macros:plugins>
```

**STEP**: 4 — Display Mode Behavior & Limitations

**DESCRIPTION**: In display mode, the building block uses sap.m.FormattedText. Not all editor formatting features are supported in display mode (for example, images are not supported). Use this step to validate that your content is compatible with sap.m.FormattedText when view-only rendering is required.

**LANGUAGE**: Text

**CODE**:
```text
Note: Display mode uses sap.m.FormattedText -> some features (e.g., images) may not render.
See: https://ui5.sap.com/#/api/sap.m.FormattedText%23controlProperties
```

**STEP**: 5 — API References and Live Examples

**DESCRIPTION**: Use the official API references and live examples for complete property, aggregation, and event lists and to test configurations.

**LANGUAGE**: Text

**CODE**:
```text
RichTextEditor API (building block): https://ui5.sap.com/#/api/sap.fe.macros.RichTextEditor
sap.m.FormattedText API (display mode): https://ui5.sap.com/#/api/sap.m.FormattedText%23controlProperties
Live examples / Building Blocks explorer: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/rte/rteDefault
```
--------------------------------

**TITLE**: Share Building Block (sap.fe.macros.Share) — Configure Send Email and Collaboration Manager Options

**INTRODUCTION**: This document shows how to add the Share building block (sap.fe.macros.Share) to a SAPUI5/Fiori view and how to configure visibility of the Send Email and Share: Collaboration Manager actions using the shareOptions aggregation. Includes example XML snippets and links to the API references.

**TAGS**: fiori-elements-framework, SAPUI5, Share, sap.fe.macros, building-blocks, macros, collaboration

**STEP**: 1 — Add the Share building block to a view

**DESCRIPTION**: Insert the Share macro into an XML view or fragment. Ensure the macros namespace is declared (xmlns:macros="sap.fe.macros"). Use an id so you can reference or extend the control in controller extensions if needed.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View controllerName="my.app.controller.Some"
          xmlns:mvc="sap.ui.core.mvc"
          xmlns:macros="sap.fe.macros">
  <macros:Share id="shareWithStaticProperties">
    <!-- shareOptions configured in next step -->
  </macros:Share>
</mvc:View>
```

**STEP**: 2 — Configure visibility of Send Email and Share: Collaboration Manager

**DESCRIPTION**: Use the shareOptions aggregation with attributes showSendEmail and showCollaborationManager to control the visibility of the corresponding actions. Both attributes accept boolean values ("true" / "false"). By default both are false.

- To hide Send Email and show Collaboration Manager set showSendEmail="false" showCollaborationManager="true".
- To enable both actions set both attributes to "true".

Place the shareOptions element as a child of macros:Share.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: hide Send Email, show Collaboration Manager -->
<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns:macros="sap.fe.macros">
  <macros:Share id="shareWithStaticProperties">
    <macros:shareOptions showSendEmail="false" showCollaborationManager="true" />
  </macros:Share>
</mvc:View>

<!-- Example: enable both Send Email and Collaboration Manager -->
<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns:macros="sap.fe.macros">
  <macros:Share id="shareWithBothEnabled">
    <macros:shareOptions showSendEmail="true" showCollaborationManager="true" />
  </macros:Share>
</mvc:View>
```

**STEP**: 3 — Default behavior note

**DESCRIPTION**: If you omit the shareOptions element, showSendEmail and showCollaborationManager default to false. Explicitly set them when you need a different default.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Default behavior: both options are false if not provided -->
<mvc:View xmlns:mvc="sap.ui.core.mvc" xmlns:macros="sap.fe.macros">
  <macros:Share id="shareDefaultBehavior" />
</mvc:View>
```

**STEP**: 4 — API and controller extension references

**DESCRIPTION**: Consult the official API reference for the Share macro and for controller extensions to implement or extend Share behavior programmatically.

**LANGUAGE**: TEXT

**CODE**:
https://ui5.sap.com/#/api/sap.fe.macros.Share
https://ui5.sap.com/#/api/sap.fe.core.controllerextensions.Share
--------------------------------

**TITLE**: Share Functionality — configuration and extension examples for SAP Fiori elements apps

**INTRODUCTION**: Action-focused reference for implementing and customizing the Share menu in SAP Fiori elements apps (OData V2 and V4). Includes manifest.json configuration (application and page level), press handler wiring, controller extension example to adapt email subject, visibility toggles, OData V4 export/print option wiring, and semantic bookmarking annotation examples (XML, ABAP CDS, CAP).

**TAGS**: fiori-elements-framework, share, manifest.json, sap.ui5, sap.fe, ODataV2, ODataV4, semantic-bookmarking, controller-extension, Teams, Collaboration-Manager, SAP-Jam, tile

STEP: Configure application-level Share options (press handlers)
DESCRIPTION: Define Share options at the application level in manifest.json. When you provide a press handler, the corresponding Share option is displayed. Use fully-qualified reference to your custom handler (module.function).
LANGUAGE: JSON
CODE:
```json
{
  "sap.fe": {
    "app": {
      "share": {
        "print": {
          "press": "SalesOrder.ext.CustomHandler.print"
        }
      }
    }
  }
}
```

STEP: Configure page-level Share options for a routing target (press handler example)
DESCRIPTION: Enable Share options only for a specific page/target (for example, a List Report). Place share settings under the routing target's options.settings.share path. The press property references the handler implementation.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "type": "Component",
          "id": "SalesOrderManageList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "share": {
                "exportToSpreadsheet": {
                  "press": "SalesOrder.ext.CustomHandler.export"
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Add a controller extension mapping in manifest.json
DESCRIPTION: Register a controller extension so your custom controller (OPExtend) is used by the standard ObjectPage controller, enabling you to override share-related lifecycle and APIs (for example adaptShareMetadata to change email subject).
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ObjectPage.ObjectPageController": {
            "controllerName": "SalesOrder.ext.OPExtend"
          }
        }
      }
    }
  }
}
```

STEP: Implement controller extension to adapt email subject and other share metadata
DESCRIPTION: Example ControllerExtension module that overrides the share.adaptShareMetadata hook to change the email subject. Register the module path in manifest (see previous step).
LANGUAGE: JavaScript
CODE:
```javascript
// File: webapp/extension/SalesOrder/ext/OPExtend.controller.js
sap.ui.define(["sap/ui/core/mvc/ControllerExtension"], function(ControllerExtension) {
    "use strict";
    return ControllerExtension.extend("SalesOrder.ext.OPExtend", {
        override: {
            onInit: function() {
                // optional init logic
            },
            share: {
                adaptShareMetadata: function(oShareMetadata) {
                    // customize or change email subject
                    oShareMetadata.email.title = "test email subject";
                    return oShareMetadata;
                }
            }
        }
    });
});
```

STEP: Enable OData V4 export/print options (properties mapping and sample app-level wiring)
DESCRIPTION: For OData V4, additional Share options exist: print, exportToSpreadsheet, exportToCSV, exportToPDF. Each option is displayed only when a press handler is defined. Configure at application or page level by supplying "press" for each property.
LANGUAGE: JSON
CODE:
```json
{
  "sap.fe": {
    "app": {
      "share": {
        "print": {
          "press": "SalesOrder.ext.CustomHandler.print"
        },
        "exportToSpreadsheet": {
          "press": "SalesOrder.ext.CustomHandler.exportToSpreadsheet"
        },
        "exportToCSV": {
          "press": "SalesOrder.ext.CustomHandler.exportToCSV"
        },
        "exportToPDF": {
          "press": "SalesOrder.ext.CustomHandler.exportToPDF"
        }
      }
    }
  }
}
```

STEP: Hide or conditionally show specific Share options (application level)
DESCRIPTION: Control visibility via boolean or binding expressions at application level. If application-level visibility is false, it overrides page-level settings. Note: Save as Tile cannot be hidden.
LANGUAGE: JSON
CODE:
```json
{
  "sap.fe": {
    "app": {
      "share": {
        "showSendEmail": "{= !${isVerified} }",
        "teams": {
          "showMsTeamsOptions": false
        }
      }
    }
  }
}
```

STEP: Hide or conditionally show specific Share options (page level)
DESCRIPTION: Configure visibility per routing target. Application-level true/undefined inherits to page; application-level false hides regardless of page config.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "type": "Component",
          "id": "SalesOrderManageList",
          "name": "sap.fe.templates.ListReport",
          "options": {
            "settings": {
              "share": {
                "showSendEmail": false,
                "teams": {
                  "showMsTeamsOptions": "{= ${Delivered} }"
                }
              }
            }
          }
        },
        "SalesOrderManageObjectPage": {
          "type": "Component",
          "id": "SalesOrderManageObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "share": {
                "teams": {
                  "showMsTeamsOptions": true
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: Semantic bookmarking — XML annotation sample
DESCRIPTION: Add Common.SemanticKey annotations to expose semantic keys so shared URLs use semantic keys (enables opening a shared URL that references an object while in draft or display). If semantic keys are absent, URLs use technical keys and draft sharing may not be accessible to other users.
LANGUAGE: XML
CODE:
```xml
<Annotation Term="Common.SemanticKey">
   <Collection>
      <PropertyPath>SalesOrder</PropertyPath>
   </Collection>
</Annotation>
```

STEP: Semantic bookmarking — ABAP CDS annotation sample
DESCRIPTION: CDS example adding semanticKey to an ABAP CDS view definition. Ensure this annotation is applied to the entity set used by the Fiori elements app.
LANGUAGE: ABAP CDS
CODE:
```abap
@ObjectModel: {
  semanticKey: [ 'SalesOrder' ]
}
define view SALESORDERMANAGE {
  /* view fields */
}
```

STEP: Semantic bookmarking — CAP CDS annotation sample
DESCRIPTION: CAP model snippet adding Common.SemanticKey. Use the appropriate syntax for your CAP model file so the generated service metadata contains semantic keys.
LANGUAGE: CDS
CODE:
```cql
Common.SemanticKey : [
    SalesOrder
],
```

STEP: Important constraints and platform-specific notes
DESCRIPTION: Short, actionable constraints to apply during implementation:
- Share appears on list report, object page, and subobject page. For flexible column layout, shown on highest view level.
- Share button is hidden for newly created draft objects.
- OData V2: for draft objects with an existing active instance, Share directly shares the active instance URL.
- OData V4: for draft objects with an existing active instance, Share uses semantic bookmarking if semantic keys are defined; otherwise the active instance URL is shared.
- Semantic bookmarking is not supported for subobject pages or when not all semantic keys are in the available context — in such cases edit mode adds technical keys to the URL and draft-sharing by another user will fail.
- Save as Tile is always visible. To change a dynamic tile to static during tile creation, implement an extension (see "Extending the Bookmark Function to Save Static Tiles to the SAP Fiori Launchpad").
LANGUAGE: text
CODE:
```
Constraints and notes:
- Share: available on List Report, Object Page, Subobject Page; on FCL shown at highest level.
- Newly created objects in draft mode: Share button not visible.
- OData V2 draft behavior: shares active instance URL for existing active instances.
- OData V4 draft behavior: uses semantic bookmarking when semantic keys are defined; otherwise shares active instance URL.
- Semantic bookmarking unsupported for subobject pages or when semantic keys are not fully available in context.
- Save as Tile cannot be hidden. To change dynamic to static tiles during save, use an extension (see relevant extension docs).
```


--------------------------------

**TITLE**: Implementing "Share: Microsoft Teams" for SAP Fiori elements object pages

**INTRODUCTION**: Practical developer-focused guidance and code examples to make SAP Fiori elements applications work well with the Share: Microsoft Teams feature. Contains annotation snippets (XML and CDS), manifest examples, i18n sample, and security/behavior notes. Use these examples to: (1) mark/exclude personal or sensitive fields, (2) expose header facets and header actions that can be shared as a Teams card, and (3) avoid manifest/override patterns that prevent card actions from being shared.

**TAGS**: SAP, Fiori, Microsoft Teams, annotations, manifest.json, DataFieldForAction, PersonalData, DataPoint, header facets, object page

STEP: 1 — Prerequisites and admin links

DESCRIPTION: Ensure Microsoft Teams integration is configured in your SAP landscape. Provide these links to administrators and include them in deployment documentation.

LANGUAGE: text

CODE:
```text
Admin configuration and documentation:
- SAP S/4HANA Cloud Public Edition: https://help.sap.com/docs/SAP_S4HANA_CLOUD/0f69f8fb28ac4bf48d2b57b9637e81fa/257ec7408db6420682462cd1d000e744.html
- SAP S/4HANA (on-premise): https://help.sap.com/docs/SAP_S4HANA_ON-PREMISE/8308e6d301d54584a33cd04a9861bc52/849465e69b7a490a88049fe0b24fb01e.html?version=2023.000
```

STEP: 2 — Mark/exclude sensitive or personal fields (prevent leaking to Teams cards)

DESCRIPTION: Use the PersonalData vocabulary to flag fields that are potentially personal or sensitive so that application teams can exclude them from cards or take appropriate action.

LANGUAGE: XML (OData V4 annotations)

CODE:
```xml
<!-- File: annotations/PersonalData.annotations.xml -->
<Annotations Target="YourService.YourEntityType">
  <!-- Mark an attribute as potentially personal -->
  <Annotation Term="com.sap.vocabularies.PersonalData.v1.IsPotentiallyPersonal">
    <Bool>true</Bool>
  </Annotation>

  <!-- Mark an attribute as potentially sensitive -->
  <Annotation Term="com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive">
    <Bool>true</Bool>
  </Annotation>
</Annotations>
```

LANGUAGE: CDS

CODE:
```cds
// File: db/schema.cds (CDS example)
// Import PersonalData vocabulary or use fully qualified annotation keys per your toolchain
entity Customers {
  @com.sap.vocabularies.PersonalData.v1.IsPotentiallyPersonal : true
  FirstName   : String;

  @com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive : true
  SocialSecurityNumber : String;
}
```

STEP: 3 — Expose header facets (DataPoints) for sharing as a Card

DESCRIPTION: Annotate header facets that you want to appear on the shared Teams card. Note restrictions: micro charts, rating/progress indicators, custom facets, and icon-based images are not supported on cards. Formatting can change (custom OData V4 formatters and DataPoint.NumberOfFractionalDigits may differ).

LANGUAGE: XML (Header facets + DataPoint example)

CODE:
```xml
<!-- File: annotations/HeaderFacets.annotations.xml -->
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.HeaderFacets">
    <Collection>
      <Record Type="com.sap.vocabularies.UI.v1.HeaderFacet">
        <PropertyValue Property="Label" String="Key Data"/>
        <PropertyValue Property="Value" Path="KeyDataText"/>
      </Record>
      <!-- DataPoint with explicit fractional digits -->
      <Record Type="com.sap.vocabularies.UI.v1.HeaderFacet">
        <PropertyValue Property="Label" String="Amount"/>
        <PropertyValue Property="Value">
          <Record Type="com.sap.vocabularies.UI.v1.DataPoint">
            <PropertyValue Property="Value" Path="Amount"/>
            <PropertyValue Property="NumberOfFractionalDigits" Int="2"/>
            <PropertyValue Property="Unit" Path="Currency"/>
          </Record>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

LANGUAGE: CDS (Header facet / UI annotation example)

CODE:
```cds
// File: annotations.cds (CDS annotation snippet)
annotate YourService.YourEntityType with {
  @UI.HeaderFacets: [
    { @UI.HeaderFacet: { Label: 'Key Data', Value: 'KeyDataText' } },
    {
      @UI.HeaderFacet: {
        Label: 'Amount',
        Value: @UI.DataPoint: {
          Value: 'Amount',
          NumberOfFractionalDigits: 2,
          Unit: 'Currency'
        }
      }
    }
  ]
}
```

STEP: 4 — Expose header actions for sharing as a Card (annotation-based only)

DESCRIPTION: Define annotation-based header actions using DataFieldForAction. The Teams card supports only annotation-based actions (not manifest-overridden ones) and shows only the first two supported actions. Bound actions pass the page context; action parameter types will be shown as simple dropdown fields (no advanced field-help). Buttons based on DataFieldForIntentBasedNavigation are not supported.

LANGUAGE: XML (DataFieldForAction + Criticality example)

CODE:
```xml
<!-- File: annotations/HeaderActions.annotations.xml -->
<Annotations Target="YourService.YourEntityType">
  <Annotation Term="com.sap.vocabularies.UI.v1.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeName" String="PurchaseOrder"/>
      <PropertyValue Property="Actions">
        <Collection>
          <!-- Simple annotation-based action (bound) -->
          <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
            <PropertyValue Property="Action" String="YourService.ApprovePurchaseOrder" />
            <PropertyValue Property="Label" String="Approve"/>
            <PropertyValue Property="RequiresContext" Bool="true"/>
          </Record>

          <!-- Confirmation-based action (IsActionCritical) -->
          <Record Type="com.sap.vocabularies.UI.v1.DataFieldForAction">
            <PropertyValue Property="Action" String="YourService.CancelPurchaseOrder" />
            <PropertyValue Property="Label" String="Cancel"/>
            <PropertyValue Property="RequiresContext" Bool="true"/>
            <!-- Use Common.IsActionCritical to indicate confirmation is required -->
            <PropertyValue Property="IsActionCritical" Bool="true"/>
          </Record>

          <!-- Actions using DataFieldForIntentBasedNavigation are not supported for share-as-card -->
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CDS

CODE:
```cds
// File: annotations.cds (CDS snippet for header actions)
annotate YourService.YourEntityType with {
  @UI.HeaderInfo: {
    TypeName: 'PurchaseOrder',
    Actions: [
      { @UI.DataFieldForAction: { Action: 'YourService.ApprovePurchaseOrder', Label: 'Approve', RequiresContext: true } },
      { @UI.DataFieldForAction: { Action: 'YourService.CancelPurchaseOrder', Label: 'Cancel', RequiresContext: true, IsActionCritical: true } }
    ]
  }
}
```

STEP: 5 — Action parameters and limitations in Teams cards

DESCRIPTION: When actions expose parameters to the Teams card:
- Supported: simple scalar parameter fields displayed as dropdowns.
- Not supported: field help (value help), dropdown lists with advanced value help, date pickers/date-time pickers, default values, IN/OUT parameter mappings (IN influencing other fields or OUT populating other fields).
- The Teams card will show parameter fields as simple dropdowns; do not rely on advanced UI controls or default-driven parameter logic for card execution.

LANGUAGE: text

CODE:
```text
Behavior summary:
- Action parameter fields in Teams cards: primitive dropdown-like inputs only.
- Not supported in card UI: field help(value help), date/time pickers, default values, IN/OUT mappings.
- Only the first two supported header actions are displayed on the card; action order follows annotation order.
```

STEP: 6 — Avoid manifest overrides and binding-expression-based visibility for annotation actions

DESCRIPTION: If an annotation-based action is overridden in manifest.json (for example by changing visibility via binding expressions or replacing the annotation with a manifest-defined control), the action will not be shareable in the card. Keep annotation-based actions un-overridden if you want Teams cards to show and allow execution.

LANGUAGE: JSON (manifest.json override example — avoid this pattern)

CODE:
```json
// File: webapp/manifest.json
{
  "sap.ui5": {
    "models": {
      // ...
    },
    "extensions": {
      // Example of overriding/controlling an action via a UI5 property or binding expression:
      // Avoid using manifest-level UI overrides or binding expressions for annotation actions
      // if you expect them to be shareable as Teams card actions.
    }
  }
}
```

STEP: 7 — i18n confirm message key used by Teams card for confirmation-based actions

DESCRIPTION: For confirmation-based actions (Common.IsActionCritical) triggered from a Teams card, the card shows the default i18n key "C_OPERATIONS_ACTION_CONFIRM_MESSAGE". Overriding that i18n key in your app will not change the message displayed in the Teams card — the card uses the default text only.

LANGUAGE: properties (i18n)

CODE:
```properties
# File: i18n/i18n.properties
# This is the key used by the Teams card for confirmations. Overriding it in your app will NOT change the message shown in the Teams card.
C_OPERATIONS_ACTION_CONFIRM_MESSAGE=Are you sure you want to perform this action?
```

STEP: 8 — Behavior notes: URL shortening (application state), incognito cookies, cleanup

DESCRIPTION: The Share: Microsoft Teams functionality uses application state records to shorten long URLs. These application state records expire and are cleaned up by the system. Users in incognito/private mode will get an HTTP 401 Unauthorized if third-party cookies are blocked — instruct end users to allow third-party cookies for incognito sessions when using this feature.

LANGUAGE: text

CODE:
```text
Operational notes:
- Application state cleanup: expired app state records are cleaned up automatically.
  Reference: https://help.sap.com/docs/ABAP_PLATFORM_NEW/a7b390faab1140c087b8926571e942b7/6107ee41f89a43c9af0aa279fe039cca.html

- Incognito/private mode: If third-party cookies are blocked, users may see:
  Authentication Information HTTP Status 401 - Unauthorized
  Action: inform users to allow third-party cookies for the incognito session.

- Security caution: Enabling "Share: Microsoft Teams" › "As Card" can transfer sensitive/personal data outside your SAP environment. Use the PersonalData annotations to mark/exclude fields and publish guidance to business users before enabling.
```

STEP: 9 — Restrictions & developer checklist

DESCRIPTION: Quick checklist to validate your app for Teams card sharing.

LANGUAGE: text

CODE:
```text
Developer checklist:
- [ ] Annotate personal/sensitive fields with:
      com.sap.vocabularies.PersonalData.v1.IsPotentiallyPersonal
      com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive

- [ ] Use annotation-based header actions (DataFieldForAction) — do NOT override them in manifest.json or via binding expressions.

- [ ] Avoid DataFieldForIntentBasedNavigation if you want actions in Teams card (not supported).

- [ ] Ensure header facets do not rely on micro charts, rating/progress indicators, custom facets, or icon-based images for Teams card content.

- [ ] Be aware DataPoint formatting (including NumberOfFractionalDigits) might render differently in cards vs. object page.

- [ ] Understand action parameter UI limitations in Teams cards (no advanced field help or IN/OUT behaviour).

- [ ] Inform admins about application-state cleanup and users about incognito cookie requirements.

- [ ] Add security guidance about external data transfer when enabling "As Card".
```


--------------------------------

**TITLE**: Status Building Block — SAP Fiori elements (macros:Status)

**INTRODUCTION**: Use the Status building block to render an annotation-driven status/criticality UI control (based on sap.m.ObjectStatus) in Fiori elements/SAPUI5 XML views. The macro binds to an annotation path (metaPath) and supports a press event handler for custom interactivity.

**TAGS**: fiori-elements-framework, sap.ui5, macros, Status, ObjectStatus, annotation, metaPath, press-event, SAPUI5

**STEP**: 1 — Add the Status macro to an XML View

**DESCRIPTION**: Import the macros namespace and place the Status macro in your XML view. Set metaPath to the annotation path that contains the status/criticality data, give the control an id, optionally enable largeDesign, and bind a press event handler to a controller function (note the leading dot to map to the view controller).

**LANGUAGE**: XML

**CODE**:
```XML
<!-- XML view: /webapp/view/SomeView.view.xml -->
<mvc:View
    controllerName="my.app.controller.SomeView"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:macros="sap.fe.macros"
    xmlns="sap.m">
    <VBox>
        <!-- Status macro bound to an annotation path -->
        <macros:Status
            id="myStatus"
            metaPath="@com.sap.vocabularies.UI.v1.FieldGroup#ApprovalData/Data/0"
            largeDesign="true"
            press=".onStatusPressed" />
    </VBox>
</mvc:View>
```

**STEP**: 2 — Implement the press handler in the view controller

**DESCRIPTION**: Implement the press handler referenced by the view (press=".onStatusPressed"). Typical tasks: access the pressed control via oEvent.getSource(), read its binding context or displayed text, and perform navigation, open a popover, or show a message. Example below shows reading the binding context and showing a message.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// Controller: /webapp/controller/SomeView.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/m/MessageToast"
], function (Controller, MessageToast) {
  "use strict";

  return Controller.extend("my.app.controller.SomeView", {
    onStatusPressed: function (oEvent) {
      // pressed control (sap.m.ObjectStatus-like control wrapped by the macro)
      var oSource = oEvent.getSource();

      // Example: read bound entity context and a property (adjust property name to your service)
      var oContext = oSource.getBindingContext();
      if (oContext) {
        var oData = oContext.getObject(); // full entity data object
        MessageToast.show("Status pressed, entity data: " + JSON.stringify(oData));
      } else {
        MessageToast.show("Status pressed");
      }

      // TODO: replace with navigation or popover logic as needed
    }
  });
});
```

**STEP**: 3 — Attributes and usage notes

**DESCRIPTION**: Quick reference for commonly used attributes:
- metaPath (string): Annotation path to the Status definition, e.g. "@com.sap.vocabularies.UI.v1.FieldGroup#ApprovalData/Data/0". This must point to an annotation item that contains the status/criticality information.
- id (string): Control id for later access (e.g., by getView().byId("myStatus")).
- largeDesign (boolean): When true, renders the status with larger styling.
- press (function reference): Event handler name relative to the view controller (use ".functionName" in XML).

Keep the view controller declared in the XML (controllerName) so press=".onStatusPressed" maps correctly.

**LANGUAGE**: text

**CODE**:
```text
metaPath example:
"@com.sap.vocabularies.UI.v1.FieldGroup#ApprovalData/Data/0"

Notes:
- metaPath is an annotation path into the service metadata; ensure the vocabulary and fragment exist in the OData service.
- The macro renders an ObjectStatus-based control, so you can expect common ObjectStatus properties (text, state/criticality).
```

**STEP**: 4 — API reference and live examples

**DESCRIPTION**: Consult the official API and live examples for more attributes and runtime behavior.

**LANGUAGE**: text

**CODE**:
```text
API Reference:
https://ui5.sap.com/#/api/sap.fe.macros.Status

Live examples (Building Blocks - Status Overview):
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/features/statusDefault
```
--------------------------------

**TITLE**: Table building block (sap.fe.macros.Table) — instantiation, actions, personalization, events, and APIs

**INTRODUCTION**: This document contains concise, copy-paste ready examples and actionable notes for using the sap.fe.macros Table building block in UI5 Fiori Elements applications. Use these snippets to instantiate tables, add actions and action groups, link a FilterBar, enable quick filters and mass edit, intercept and modify binding requests (beforeRebindTable), and use Table APIs and editFlow createDocument.

**TAGS**: fiori-elements-framework, sap.fe.macros, Table, UI5, building-blocks, FilterBar, MassEdit, QuickVariantSelection, beforeRebindTable, editFlow

**STEP**: Instantiate Table (basic metaPath variants)

**DESCRIPTION**: Instantiate the Table building block in an XML fragment. Use either an entitySet metaPath, a navigation property, or an explicit LineItem annotation path.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- XML fragment (fragment or view enabled for building blocks) -->
<macros:Table xmlns:macros="sap.fe.macros" metaPath="/MyEntitySet" id="TableFromEntitySet"/>
<macros:Table xmlns:macros="sap.fe.macros" metaPath="MyNavProperty" id="TableFromNavProperty"/>
<macros:Table xmlns:macros="sap.fe.macros" metaPath="MyNavProperty/@com.sap.vocabularies.UI.v1.LineItem" id="TableFromLineItem"/>
```

**STEP**: Add bound/unbound actions and ActionGroup menu

**DESCRIPTION**: Define actions inside the Table building block. Use requiresSelection="true" for bound actions. Group actions into a menu with ActionGroup and control placement using anchor and placement.

**LANGUAGE**: XML

**CODE**:
```xml
<macros:Table xmlns:macros="sap.fe.macros"
              metaPath="@com.sap.vocabularies.UI.v1.LineItem"
              readOnly="true"
              id="LineItemTablePageCustomActions">
    <creationMode name="InlineCreationRows" inlineCreationRowsHiddenInEditMode="true" />
    <macros:actions>
        <macros:Action
            key="customAction"
            text="My Custom Action"
            press=".onPressAction"
            placement="After"
            anchor="DataFieldForAction::Service.toggleBoolean"
            requiresSelection="true"
        />
        <macros:ActionGroup text="Grouped Actions" placement="After" anchor="customAction">
            <macros:Action text="Menu Action 1" press=".onPressMenuAction" />
            <macros:Action text="Menu Action 2" press=".onPressMenuAction" />
        </macros:ActionGroup>
    </macros:actions>
</macros:Table>
```

**STEP**: Configure creation options (creationMode)

**DESCRIPTION**: Set Table creation options through the creationMode aggregation. Use the TableCreationOptions API for all available settings (see API reference).

**LANGUAGE**: XML

**CODE**:
```xml
<macros:Table xmlns:macros="sap.fe.macros"
              metaPath="@com.sap.vocabularies.UI.v1.LineItem"
              id="LineItemTableWithCreation">
    <creationMode name="InlineCreationRows" inlineCreationRowsHiddenInEditMode="true" />
</macros:Table>
```

**STEP**: Link a FilterBar to the Table

**DESCRIPTION**: Reference a FilterBar by its ID (local or global) using the table's filterBar property to connect filters to the table. Example shows a FilterBar defined in the same view/panel.

**LANGUAGE**: XML

**CODE**:
```xml
<Panel headerText="Table in Display Mode with FilterBar">
    <macros:FilterBar xmlns:macros="sap.fe.macros"
                      metaPath="@com.sap.vocabularies.UI.v1.SelectionFields#SF1"
                      id="FilterBar" />
    <macros:Table xmlns:macros="sap.fe.macros"
                  metaPath="@com.sap.vocabularies.UI.v1.LineItem"
                  displayMode="true"
                  id="LineItemTable"
                  filterBar="FilterBar" />
</Panel>
```

**STEP**: Enable Quick Variant Selection (quick filters)

**DESCRIPTION**: Add quickVariantSelection to show quick filters/variants for the Table. Use paths to selection presentation variants and showCounts to display counts.

**LANGUAGE**: XML

**CODE**:
```xml
<macros:Table xmlns:macros="sap.fe.macros"
              xmlns:macrosTable="sap.fe.macros.table"
              metaPath="@com.sap.vocabularies.UI.v1.LineItem"
              id="LineItemTableQuickFilters">
    <macros:quickVariantSelection>
        <macrosTable:QuickVariantSelection
            paths="com.sap.vocabularies.UI.v1.SelectionPresentationVariant#All,com.sap.vocabularies.UI.v1.SelectionPresentationVariant#Success"
            showCounts="true" />
    </macros:quickVariantSelection>
</macros:Table>
```

**STEP**: Configure Mass Edit (massEdit aggregation)

**DESCRIPTION**: Declare massEdit inside the Table to show a Mass Edit dialog. You can provide visibleFields and custom form fragments inside the MassEdit aggregation.

**LANGUAGE**: XML

**CODE**:
```xml
<macros:Table xmlns:macros="sap.fe.macros"
              xmlns:macrosTable="sap.fe.macros.table"
              xmlns:f="sap.ui.layout.form"
              metaPath="@com.sap.vocabularies.UI.v1.LineItem"
              id="LineItemTablePageMassEdit">
    <massEdit>
        <macrosTable:MassEdit visibleFields="BooleanProperty,TagStatus">
            <f:FormContainer>
                <f:formElements>
                    <f:FormElement label="Custom Element">
                        <Text text="This is a custom fragment displayed in the Mass-edit dialog" />
                    </f:FormElement>
                </f:formElements>
            </f:FormContainer>
        </macrosTable:MassEdit>
    </massEdit>
</macros:Table>
```

**STEP**: Intercept and modify binding request before rebind (beforeRebindTable)

**DESCRIPTION**: Add beforeRebindTable to the Table and implement the extension point in the page controller to inspect and modify CollectionBindingInfo (add filters, sorters, selects). Use collectionBindingInfoAPI methods: addFilter, addSorter, addSelect.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Table with beforeRebindTable attribute -->
<macros:Table xmlns:macros="sap.fe.macros"
              metaPath="@com.sap.vocabularies.UI.v1.LineItem"
              readOnly="true"
              id="LineItemTablePageCustomActions"
              isSearchable="false"
              beforeRebindTable=".tableRefreshed" />
```

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Controller extension (PageController)
sap.ui.define(
    ["sap/fe/core/PageController", "sap/m/MessageBox", "sap/ui/model/Filter", "sap/ui/model/FilterOperator", "sap/ui/model/Sorter"],
    function (PageController, MessageBox, Filter, FilterOperator, Sorter) {
        "use strict";

        return PageController.extend("sap.fe.core.fpmExplorer.tableCustoms.Page", {
            tableRefreshed(event) {
                // event parameter provides collectionBindingInfo API
                var collectionBindingInfoAPI = event.getParameters("collectionBindingInfo");

                // Add a filter
                var filter = new Filter({
                    path: "BooleanProperty",
                    operator: FilterOperator.EQ,
                    value1: false
                });
                collectionBindingInfoAPI.addFilter(filter);

                // Add a sorter
                var sorter = new Sorter("ID", true);
                collectionBindingInfoAPI.addSorter(sorter);

                // Request an additional property in the request
                collectionBindingInfoAPI.addSelect(["TagStatus"]);
            }
        });
    }
);
```

**STEP**: Trigger createDocument from editFlow (create new child row/document programmatically)

**DESCRIPTION**: Use the editFlow.createDocument API from the editFlow controller extension to programmatically create an inline row/document in a table. Provide creation options and initial data payload.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Get the table control by ID (example id used by framework)
var table = this.getView().byId("fe::table::_Child::LineItem::Table");

// Call editFlow.createDocument with options and data
this.base.editFlow
    .createDocument(table, {
        creationMode: coreLibrary.CreationMode.Inline, // coreLibrary must be available (import or global)
        createAtEnd: true,
        data: {
            ChildTitleProperty: "Child Object Custom Title",
            ChildDescriptionProperty: "Child Custom Description"
        }
    })
    .then(function () {
        MessageToast.show("Custom create action successfully invoked");
    });
```

**STEP**: Use Table public APIs (variants, messages, selection)

**DESCRIPTION**: Common programmatic APIs for a Table building block. These are available on the Table object (sap.fe.macros.Table) and can be used in controller extensions. Note selection variant APIs require table personalization enabled.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example usages (table = reference to sap.fe.macros.Table instance)
// Presentation / Selection variants
var pv = table.getPresentationVariant();
table.setPresentationVariant(pv);

var sv = table.getSelectionVariant(); // requires table personalization enabled
table.setSelectionVariant(sv);

// Get / set current variant id
var currentVariantId = table.getCurrentVariantID();
table.setCurrentVariantID("myVariantId");

// Send / remove messages related to the table
table.sendMessage({ /* message object */ });
table.removeMessage(messageId);
```

**STEP**: Important notes and constraints

**DESCRIPTION**: Quick actionable notes to avoid common pitfalls.

**LANGUAGE**: Text

**CODE**:
```text
- Manifest-level properties/aggregations are NOT supported for the Table building block. Define properties and aggregations at the building-block (fragment/view) level.
- If the entity is searchable the Search field appears in the table toolbar automatically. Disable it using isSearchable="false".
- getSelectionVariant() and setSelectionVariant() work only when table personalization is enabled. See "Enabling Table Personalization" for setup.
- For full list of properties, aggregations, events, and TableCreationOptions, consult the API Reference: https://ui5.sap.com/#/api/sap.fe.macros.Table
- Live examples and additional extension examples:
  - Custom Column / Custom Action: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/customColumn
  - Usage with FilterBar: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/tableFilterBar
  - Table APIs: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/tablePublicAPIs
  - Mass Edit: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/tableMassEdit
  - Global Patterns (Draft Handling / editFlow): https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/controllerExtensions/editFlow
```
--------------------------------

**TITLE**: TreeTable Building Block (sap.fe.macros.TreeTable) — XML view usage

**INTRODUCTION**: Use the TreeTable building block (sap.fe.macros.TreeTable) to render hierarchical (tree) tables in UI5/Fiori Elements without exposing tree-specific parameters in the generic Table building block. This guide gives minimal, copy-paste-ready XML examples and actionable notes for common property usage.

**TAGS**: fiori-elements-framework, TreeTable, sap.fe.macros, UI5, XML, macros, tree-table

**STEP**: 1 — Basic XML view with TreeTable macro

**DESCRIPTION**: Add a TreeTable macro to an XML view. Provide the metadata path (metaPath) to the LineItem collection, set the hierarchyQualifier to the managed hierarchy annotation, and optionally set the table to read-only. Use the provided controllerName if you rely on the example controller; otherwise replace with your app controller.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
    xmlns="sap.m"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns:macros="sap.fe.macros"
    controllerName="sap.fe.core.fpmExplorer.treeTable.TreeTable"
>
    <Page enableScrolling="true">
        <Panel headerText="Tree table in Display Mode">
            <macros:TreeTable
                metaPath="/Products/@com.sap.vocabularies.UI.v1.LineItem"
                hierarchyQualifier="ProductsHierarchy"
                readOnly="true"
                id="treeTable"
            />
        </Panel>
    </Page>
</mvc:View>
```

**STEP**: 2 — Example variations (editable, different metaPath)

**DESCRIPTION**: Common variations: make the table editable by omitting or setting readOnly="false"; point to a different entity set / annotation path; assign an explicit id for controller access.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Editable tree table -->
<macros:TreeTable
    id="editableTreeTable"
    metaPath="/SalesOrders/@com.sap.vocabularies.UI.v1.LineItem"
    hierarchyQualifier="SalesOrderHierarchy"
    readOnly="false"
/>

<!-- Different annotation path (if annotations are on the entity set itself) -->
<macros:TreeTable
    id="altTreeTable"
    metaPath="/Departments/TeamMembers/@com.sap.vocabularies.UI.v1.LineItem"
    hierarchyQualifier="DepartmentHierarchy"
/>
```

**STEP**: 3 — Key macro properties and usage notes

**DESCRIPTION**: Quick reference for the main macro attributes and what they control. Use these in your XML to wire the TreeTable to OData annotations and the app behavior.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "metaPath": "/EntitySet/@com.sap.vocabularies.UI.v1.LineItem",
  "hierarchyQualifier": "YourHierarchyQualifier", 
  "readOnly": "true | false", 
  "id": "string"
}
```

- metaPath: path to the UI.LineItem annotation that defines the columns.
- hierarchyQualifier: matches the qualifier used in the UI.Hierarchy (managed or unmanaged) annotation for the entity set.
- readOnly: true | false to control editing capability on the TreeTable.
- id: optional view-level control id to access the control from controller code.

**STEP**: 4 — Live examples and API reference

**DESCRIPTION**: Use the official live examples and API documentation when implementing or debugging.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "liveExamples": "https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/treeTable",
  "apiReference": "https://ui5.sap.com/#/api/sap.fe.macros.TreeTable",
  "additionalDoc": "tree-tables-7cf7a31.md"
}
```

Notes:
- Open the live examples URL to inspect runtime behavior and sample projects.
- Consult the API reference for runtime properties, events and aggregations supported by sap.fe.macros.TreeTable.
- For full conceptual guidance on tree tables, see the Tree Tables documentation (tree-tables-7cf7a31.md).
--------------------------------

**TITLE**: VariantManagement building block — page-level and control-level usage (SAP Fiori elements / SAPUI5)

**INTRODUCTION**: Enables variant management for flex-enabled controls (FilterBar, Table, Chart) in flexible programming model SAPUI5 apps. Use the VariantManagement building block to capture and persist user personalization across linked controls at the page level, or enable variant management directly on individual controls via their variantManagement property.

**TAGS**: fiori-elements-framework, variant-management, sap.ui5, sap.fe.macros, FilterBar, Table, Chart, flexible-programming-model

**STEP**: 1 — When to use page-level vs control-level variant management

**DESCRIPTION**: 
- Use the VariantManagement building block to apply a single variant management instance to multiple flex-enabled controls on a page (page-level). This automatically captures and saves flex-relevant personalization for all linked controls into user-defined variants. 
- Use control-level variant management when you only need variant behavior for an individual control (Table or Chart) by setting the control's variantManagement property instead of adding the VariantManagement building block.

**LANGUAGE**: Text

**CODE**:
```text
Behavior summary:
- Page-level VariantManagement: add a macros:VariantManagement and link controls using the 'for' association (comma-separated control IDs). The building block captures personalization changes on linked controls and saves them into user-created variants.
- Control-level variant management: set the 'variantManagement' property on Table or Chart to enable local variant behavior without the VariantManagement building block.
- For exact property types and additional options, consult the API references below.
```

**STEP**: 2 — Page-level VariantManagement — XML view example (full context)

**DESCRIPTION**: Add a VariantManagement building block to a DynamicPage title and link flex-enabled controls using the for association. The for value is a comma-separated list of control IDs (here: FilterBar and LineItemTable). Common attributes: showSetAsDefault="true", headerLevel="H2". The linked Table uses filterBar="FilterBar" to connect to the FilterBar control.

**LANGUAGE**: XML

**CODE**:
```xml
<mvc:View
  xmlns:mvc="sap.ui.core.mvc"
  xmlns:f="sap.f"
  xmlns:macros="sap.fe.macros"
  controllerName="your.namespace.Controller"
  displayBlock="true">

  <f:DynamicPage id="FilterBarVMWithTable" class="sapUiResponsiveContentPadding">
    <f:title>
      <f:DynamicPageTitle id="_IDGenDynamicPageTitle1">
        <f:heading>
          <!-- VariantManagement building block linked to FilterBar and LineItemTable -->
          <macros:VariantManagement
            id="vm"
            for="FilterBar,LineItemTable"
            showSetAsDefault="true"
            headerLevel="H2" />
        </f:heading>
      </f:DynamicPageTitle>
    </f:title>

    <f:header>
      <f:DynamicPageHeader id="_IDGenDynamicPageHeader1" pinnable="true">
        <VBox id="_IDGenVBox1">
          <!-- FilterBar (flex-enabled) -->
          <macros:FilterBar
            id="FilterBar"
            metaPath="@com.sap.vocabularies.UI.v1.SelectionFields" />
        </VBox>
      </f:DynamicPageHeader>
    </f:header>

    <f:content>
      <!-- Table (flex-enabled) linked to FilterBar and VariantManagement via 'for' -->
      <macros:Table
        id="LineItemTable"
        metaPath="@com.sap.vocabularies.UI.v1.LineItem"
        readOnly="true"
        filterBar="FilterBar" />
    </f:content>
  </f:DynamicPage>
</mvc:View>
```

**STEP**: 3 — Control-level variant management (Table example)

**DESCRIPTION**: If you only need variant management for a single control (Table or Chart), enable the control's built-in variantManagement property instead of using the VariantManagement building block. See the control's API for exact property type and accepted values (boolean or reference). This example shows the typical usage pattern: enabling the property on the Table macro.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example: enable control-level variant management on the Table macro -->
<macros:Table
  id="LineItemTable"
  metaPath="@com.sap.vocabularies.UI.v1.LineItem"
  readOnly="true"
  filterBar="FilterBar"
  variantManagement="true" />
```

**STEP**: 4 — Behavior details and best practices

**DESCRIPTION**:
- The VariantManagement building block automatically captures flex-relevant personalization changes (sorting, column order/visibility, filter state, chart personalization, etc.) on linked controls and saves them when the user creates/saves a variant.
- Use the 'for' association on macros:VariantManagement to list all linked control IDs (comma-separated).
- If using page-level VariantManagement, ensure linked controls are flex-enabled and have stable IDs matching those listed in 'for'.
- For Table/Chart when using control-level variantManagement, consult the Table/Chart API for configuration details, e.g., how to store default variants, set the variant model, or integrate with backend persistence.

**LANGUAGE**: Text

**CODE**:
```text
Best practices:
- Prefer page-level VariantManagement when the same variant should capture personalization across multiple controls.
- Prefer control-level variantManagement when the variant behavior applies only to a single control.
- Ensure stable control IDs for reliable linking via the 'for' association.
```

**STEP**: 5 — References and live examples

**DESCRIPTION**: Use the official API references and live sample explorer to validate property types and see working examples.

**LANGUAGE**: Text

**CODE**:
```text
API references:
- VariantManagement API: https://ui5.sap.com/#/api/sap.fe.macros.VariantManagement
- Table macro API:        https://ui5.sap.com/#/api/sap.fe.macros.Table

Live example:
- Filter Bar with Variant Management and Chart: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/filterBar/filterBarVMWithChart
```
--------------------------------

**TITLE**: Time Series Chart Card — configuration examples and requirements

**INTRODUCTION**: Quick reference for implementing time series analytical cards in SAP Fiori Elements (OVP). Includes OData metadata, UI.Chart annotations (XML, ABAP CDS, CAP CDS), and manifest.json settings for chart-level and tab-level time-axis granularity (chartProperties.timeAxis.levels). Use these snippets when creating charts that must use a time axis.

**TAGS**: fiori-elements-framework, time-series, chart, UI.Chart, manifest.json, OData, CDS, CAP, ABAP

**STEP**: 1 — Requirements for automatic time-axis behavior

**DESCRIPTION**: Chart must meet all rules below for analytical cards to automatically use a time axis. Use this checklist when designing annotations and data model.

**LANGUAGE**: Text

**CODE**:
```Text
- Allowed chart types (time-axis eligible): VerticalBullet, StackedColumn, Scatter, Line, Bubble, Column, Waterfall, Combination, DualCombination.

- Dimension rules:
  - For Bubble, Column, Waterfall, Combination: only one dimension.
  - For Line charts: up to two dimensions; the second can be a color/series dimension.
  - If using a color/series dimension, the dimension with uid "color" must have Role = Series.

- Dimension data type:
  - Either Edm.DateTime (Edm.DateTime or Edm.DateTimeOffset depending on OData) OR
  - Edm.String with OData metadata sap:semantics annotation, one of:
    - "year (YYYY)"
    - "yearweek (YYYYWW)"
    - "yearmonth (YYYYMM)"
    - "yearquarter (YYYYQ)"

- Measure rules:
  - Bubble: requires two measures (x and y or bubble size).
  - Combination charts: require at least two measures.
  - VerticalBullet, StackedColumn, Scatter: require at least one dimension and one measure.
  - Scatter supports extra color and shape dimensions.

- Chart granularity:
  - Use chartProperties.timeAxis.levels in manifest.json to set drilldown levels: allowed values include "year", "month", "day", "hour", "minute".
  - Increase dataset granularity until there are no repeating values at the lowest displayed level.
```

**STEP**: 2 — OData metadata sample: define a Date property as dimension

**DESCRIPTION**: Add OData property definition with aggregation-role dimension and display-format Date. This goes into your OData service metadata (.edmx).

**LANGUAGE**: XML

**CODE**:
```xml
<Property Name="Date" Type="Edm.DateTime" sap:display-format="Date" sap:label="Date" sap:aggregation-role="dimension"/>
```

**STEP**: 3 — UI.Chart XML annotation (example: Line chart with series by currency)

**DESCRIPTION**: UI.Chart annotation in XML (e.g., annotations.xml). Shows ChartType Line, measure attribute with data point reference, and two dimension attributes (Date as Category, Sales_CURRENCY as Series).

**LANGUAGE**: XML

**CODE**:
```xml
<Annotation Term="UI.Chart" Qualifier="Line-Time_-Currency">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="View1" />
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Line"/>
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="SalesShare" />
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
          <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#Eval_by_CtryCurr_-SalesShare"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="Date" />
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
        </Record>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="Sales_CURRENCY"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Series"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 4 — ABAP CDS annotation example (Line chart with qualifier and data point)

**DESCRIPTION**: ABAP CDS pattern to annotate a view with UI.Chart for a time-series line chart. Use qualifier to reference in manifest (chartAnnotationPath if needed).

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
@UI.Chart: [
  {
    title: 'View1',
    chartType: #LINE,
    measureAttributes: [
      {
        measure: 'SalesShare',
        role: #AXIS_1,
        asDataPoint: true
      }
    ],
    dimensionAttributes: [
      {
        dimension: 'Date',
        role: #CATEGORY
      },
      {
        dimension: 'Sales_CURRENCY',
        role: #SERIES
      }
    ],
    qualifier: 'Line-Time-Currency'
  }
]
annotate view VIEWNAME with { }
```

**STEP**: 5 — CAP CDS (SAP CAP) annotation example

**DESCRIPTION**: CAP CDS UI.Chart annotation example. Use qualifier #Line-Time-Currency to refer from manifest or OVP config.

**LANGUAGE**: CDS

**CODE**:
```cds
UI.Chart #Line-Time-Currency : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'View1',
    ChartType : #Line,
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : SalesShare,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#Eval_by_CtryCurr-SalesShare'
        }
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : Date,
            Role : #Category
        },
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : Sales_CURRENCY,
            Role : #Series
        }
    ]
}
```

**STEP**: 6 — manifest.json: set chartProperties.timeAxis.levels at chart-level (OVP)

**DESCRIPTION**: Add chartProperties.timeAxis.levels inside your card settings at sap.ovp/cards/<card-id>/settings to configure time-axis granularity globally for the card.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "cardchartsline": {
        "model": "sales",
        "template": "sap.ovp.cards.charts.analytical",
        "settings": {
          "entitySet": "salesSet",
          "chartProperties": {
            "timeAxis": {
              "levels": ["year", "month", "day", "hour", "minute"]
            }
          }
        }
      }
    }
  }
}
```

**STEP**: 7 — manifest.json: set chartProperties.timeAxis.levels at tab-level (v4 template)

**DESCRIPTION**: Configure time-axis levels per tab to customize drilldown/levels individually. Use chartAnnotationPath to point to the annotated chart qualifier (e.g., com.sap.vocabularies.UI.v1.Chart#year).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "card_11_v4": {
    "model": "sales",
    "template": "sap.ovp.cards.v4.charts.analytical",
    "settings": {
      "title": "{{TIME_SERIES_ANALYTICAL_CARD}}",
      "subTitle": "{{COMMON_ANALYTICAL_CARD_SUBTITLE_V4}}",
      "entitySet": "salesSet",
      "tabs": [
        {
          "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#year",
          "value": "With CalenderYear"
        },
        {
          "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart#year",
          "value": "With TimeAxis",
          "chartProperties": {
            "timeAxis": {
              "levels": ["year", "month", "day", "hour"]
            }
          }
        }
      ]
    }
  }
}
```

**STEP**: 8 — Time-axis levels and dataset granularity recommendations

**DESCRIPTION**: Rules and tips for choosing time levels and preparing dataset to avoid repeated values on the chart axis.

**LANGUAGE**: Text

**CODE**:
```Text
- Allowed level values: "year", "month", "day", "hour", "minute".
- Choose levels matching the timestamp granularity in your data. If multiple data points share the same time unit at the lowest level, the chart will collapse those points — increase dataset granularity until unique values appear for the lowest level.
- Define levels at chart-level for global card behavior or at tab-level for per-tab drilldown.
- Ensure OData dimension semantics (Edm.DateTime or Edm.String + sap:semantics) match chosen granularity.
```
--------------------------------

**TITLE**: Toggling Between Draft and Saved Values (Fiori elements)

**INTRODUCTION**: This document summarizes the runtime behavior and gives concise, copy-pasteable code patterns to implement toggling between draft and saved versions of entities in SAP Fiori elements list reports and object pages. Use these snippets inside controller extensions, UI5 fragments, or list-report/object-page custom code actions. Replace placeholder OData paths and model names with your app-specific values.

**TAGS**: fiori-elements, draft, list-report, object-page, odata, ui5, toggle

**STEP**: Behavior Mapping (reference)

**DESCRIPTION**: System behavior mapping for the Editing Status filter option "All (Hiding Drafts)". Keep this mapping as a source of truth when implementing toggle logic and navigation flows.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "EditingStatusFilter": "All (Hiding Drafts)",
  "ListReport": "Only saved objects (saved version) are displayed in the table",
  "NavigateToObjectPage": "Saved object is displayed; show 'Return to Draft' button if a draft exists for the object",
  "NavigateBackToListReport": "Only saved objects are displayed in the table"
}
```

**STEP**: Object Page — Toggle button and popover behavior

**DESCRIPTION**: Implement a toggle button on the object page header that opens a popover with two choices (Saved Version, Draft). Choose the version to render the page data. The button label must reflect the current version. Use this pattern in a controller extension or a custom UI5 controller.

**LANGUAGE**: TypeScript

**CODE**:
```typescript
// Controller extension: key methods (replace placeholder model/paths with actual names)

async function onToggleVersion(entityId: string, target: 'saved' | 'draft') {
  // target: 'saved' => load and display saved version
  // target: 'draft' => load and display draft version
  const data = target === 'draft'
    ? await fetchDraftVersion(entityId)
    : await fetchSavedVersion(entityId);

  if (!data) {
    // handle missing version (show message/toast)
    return;
  }

  setViewModelData(data);           // push data into the object page view model
  updateToggleButtonLabel(target);  // update header button text: "Draft" or "Saved Version"
  refreshBindings();                // refresh UI bindings if necessary
}

// Helper placeholders - adapt OData read calls to your models and metadata
async function fetchDraftVersion(entityId: string): Promise<any> {
  // Example placeholder: read the draft entity; adapt path to your service (V2/V4)
  // return await odataModel.read(`/EntitySet(${entityId})/Draft`); 
  return await odataRead(entityId, { version: 'draft' });
}

async function fetchSavedVersion(entityId: string): Promise<any> {
  // Example placeholder: read the active/saved entity
  // return await odataModel.read(`/EntitySet(${entityId})`);
  return await odataRead(entityId, { version: 'saved' });
}

// UI: open popover and bind actions to onToggleVersion
function onToggleButtonPress(event) {
  openPopover([
    { key: 'saved', text: 'Saved Version' },
    { key: 'draft', text: 'Draft' }
  ], async (selected) => {
    await onToggleVersion(currentEntityId(), selected);
  });
}
```

**STEP**: Detect draft existence and show Return/Display button

**DESCRIPTION**: Before rendering the object page, check whether a draft exists. If a draft exists, show a contextual button (Return to Draft / Display Saved Version) according to current view. Use this pattern on navigation or when opening an object page.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Run during navigation to object page (or onBeforeShow)
async function onObjectNavigate(entityId) {
  const hasDraft = await draftExists(entityId);

  if (hasDraft) {
    // Show button: "Return to Draft" when viewing Saved; "Display Saved Version" when viewing Draft
    showHeaderToggleButton(hasDraft);
  } else {
    hideHeaderToggleButton();
  }

  // By default (EditingStatus = "All (Hiding Drafts)"), show saved version
  await onToggleVersion(entityId, 'saved');
}

async function draftExists(entityId) {
  // Placeholder: call service to check draft existence
  // Adapt to your OData service: you may read a DraftAdministrativeData navigation or a service-provided flag
  // return (await odataModel.read(`/EntitySet(${entityId})/DraftExists`)) === true;
  const result = await odataCheckDraft(entityId);
  return Boolean(result);
}
```

**STEP**: List Report — Apply Editing Status filter "All (Hiding Drafts)"

**DESCRIPTION**: When the Editing Status is "All (Hiding Drafts)" the list report must show only saved objects. Apply a filter to the list binding to hide drafts on table binding. Property name for draft status differs between services – confirm via metadata (common names: IsActiveEntity, IsDraft, or service-specific flags).

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// Example: apply a binding filter to show only saved objects on table binding
function applyHideDraftsFilter(tableBinding, hideDrafts) {
  const filters = [];

  if (hideDrafts) {
    // Replace 'IsActiveEntity' with your service's property (or use appropriate draft flag)
    // For OData V4: IsActiveEntity === true typically denotes the active/saved entity
    filters.push(new Filter('IsActiveEntity', FilterOperator.EQ, true));
  }

  tableBinding.filter(filters, FilterType.Application);
}

// Example usage when Editing Status control changes
onEditingStatusChange(selection) {
  const hideDrafts = selection === 'All (Hiding Drafts)';
  const tableBinding = this.byId('listTable').getBinding('items');
  applyHideDraftsFilter(tableBinding, hideDrafts);
}
```

**STEP**: Navigation flow pseudocode (List -> Object -> Back)

**DESCRIPTION**: Typical navigation flow with draft awareness. Keep this flow in your routing or list item-press code.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
async function onListItemPress(oEvent) {
  const entityId = getEntityIdFromItem(oEvent.getSource());
  // If editing status is "All (Hiding Drafts)", list shows saved entries.
  // When navigating, show the saved object. If a draft exists, show 'Return to Draft' button on object page.
  await navigateToObjectPage(entityId);
  // onObjectNavigate will check draftExists(entityId) and show toggle button accordingly
}
```

**STEP**: V2 Classic Header Note

**DESCRIPTION**: Implementation detail for SAP Fiori elements OData V2 apps with the classic header: the toggle button appears in the header toolbar as "Display Saved Version" / "Return to Draft" instead of a menu button next to the title. Ensure your header customization targets the toolbar for classic headers.

**LANGUAGE**: Plain text

**CODE**:
```text
Note: For OData V2 classic header apps, place the toggle button in the header toolbar with labels:
- "Return to Draft" (when a draft exists and you are viewing Saved)
- "Display Saved Version" (when viewing Draft)
```

**STEP**: Images and Related Links

**DESCRIPTION**: Reference image file paths and related documentation link for implementation details and conceptual background.

**LANGUAGE**: Plain text

**CODE**:
```text
Images (reference implementation/screenshots):
- images/Toggling_Between_Draft_and_Saved_Values_1_6817734.png
- images/Object_Page_Draft_Version_is_Shown_Including_Toggle_Popover_fbdd6a2.png
- images/Object_Page_Saved_Version_is_Shown_4d6823f.png

Related Information:
- Draft Handling: draft-handling-ed9aa41.md
```

--------------------------------

**TITLE**: Enable/Disable Editability of Object Page Header Fields (editableHeaderContent)

**INTRODUCTION**: This doc shows how to control whether fields in the Object Page header can be edited via the manifest property editableHeaderContent. It includes manifest.json examples for both SAP Fiori elements OData V2 and OData V4, explains defaults, and highlights field-level constraints (ReadOnly annotation, non-editable facets like micro charts).

**TAGS**: fiori-elements-framework, manifest.json, editableHeaderContent, object-page, ODataV2, ODataV4, header, manifest

STEP: 1 — Behavior and constraints
DESCRIPTION: Summary of default behavior per OData version and important constraints: setting editableHeaderContent enables header editing at the page level but does not override field-level read-only settings or facet capabilities (for example, micro chart facets are not editable). Use ReadOnly annotations or UI annotations to control individual fields.
LANGUAGE: Text
CODE:
```text
- OData V2 default: header is NOT editable. To allow editable header fields, set editableHeaderContent: true.
- OData V4 default: header IS editable. To disable, set editableHeaderContent: false.
- Setting editableHeaderContent only toggles the header-level permission. Each field/facet still follows its own editability:
  - Text fields annotated as ReadOnly remain non-editable.
  - Micro chart facets and other non-editable facet types remain non-editable.
```

STEP: 2 — Enable editable header for OData V2 (manifest.json)
DESCRIPTION: Add editableHeaderContent under the ObjectPage component settings in the sap.ui.generic.app pages definition. File: manifest.json (project root).
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "SEPMRA_C_PD_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "list": true
        },
        "pages": [
          {
            "entitySet": "SEPMRA_C_PD_Product",
            "component": {
              "name": "sap.suite.ui.generic.template.ObjectPage",
              "settings": {
                "editableHeaderContent": true
              }
            },
            "pages": [
              {
                "navigationProperty": "to_ProductText",
                "entitySet": "SEPMRA_C_PD_ProductText",
                "component": {
                  "name": "sap.suite.ui.generic.template.ObjectPage"
                }
              }
            ]
          }
        ]
      }
    ]
  }
}
```

STEP: 3 — Disable or enable editable header for OData V4 (manifest.json)
DESCRIPTION: Set editableHeaderContent in the target options.settings for the ObjectPage component in sap.ui5.routing.targets. Use true to enable, false to disable. File: manifest.json (project root).
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui5": {
    ...
    "routing": {
      "routes": [
        {
          "pattern": "SalesOrderManage({key})/_Item({key2}):?query:",
          "name": "SalesOrderItemObjectPage",
          "target": "SalesOrderItemObjectPage"
        }
      ],
      "targets": {
        "SalesOrderItemObjectPage": {
          "type": "Component",
          "id": "SalesOrderItemObjectPage",
          "name": "sap.fe.templates.ObjectPage",
          "options": {
            "settings": {
              "contextPath": "/SalesOrderItem",
              "editableHeaderContent": true
              ...
            }
          }
        }
      }
    }
  }
}
```

STEP: 4 — Toggle examples (quick reference)
DESCRIPTION: Minimal manifest fragments showing how to explicitly enable or disable header editability for each OData version.
LANGUAGE: JSON
CODE:
```json
// OData V2: enable editable header
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "editableHeaderContent": true
          }
        }
      }
    ]
  }
}

// OData V4: disable editable header
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "MyObjectPageTarget": {
          "options": {
            "settings": {
              "editableHeaderContent": false
            }
          }
        }
      }
    }
  }
}
```

STEP: 5 — Practical notes for code generation / automation
DESCRIPTION: When generating or modifying manifest.json programmatically, update the correct path based on OData version:
- OData V2: sap.ui.generic.app.pages[<pageIndex>].component.settings.editableHeaderContent
- OData V4: sap.ui5.routing.targets[<targetName>].options.settings.editableHeaderContent
LANGUAGE: Text
CODE:
```text
- Ensure you locate the correct page/target entry by entitySet or target name.
- Do not assume editableHeaderContent overrides annotations: preserve field-level annotations (ReadOnly) in your metadata or annotation files.
```
--------------------------------

**TITLE**: Enabling and Customizing Tree Tables in SAP Fiori Elements (OData V4)

**INTRODUCTION**: Practical, code-focused guide for enabling TreeTable building blocks in SAP Fiori elements (OData V4). Covers manifest.json tableSettings, create modes (including custom create menus and creation dialogs), createInPlace behavior, drag & drop / cut & paste / copy & paste extension points and sample controller implementations, CDS & XML annotations to disable hierarchy changes or root reordering, and references to the TreeTable macro/API.

**TAGS**: TreeTable, Fiori Elements, OData V4, manifest.json, controller extension, drag-and-drop, createMode, hierarchy, CDS, XML

STEP: 1 — Enable TreeTable in manifest.json
DESCRIPTION: Configure the page tableSettings to use a TreeTable and reference the qualifier from the Hierarchy.RecursiveHierarchy annotation on the entity set.
LANGUAGE: JSON
CODE:
```json
// manifest.json (inside the relevant page or table configuration)
"tableSettings": {
  "type": "TreeTable",
  "hierarchyQualifier": "NodesHierarchy",
  "personalization": true
  // ...other tableSettings properties
}
```

STEP: 2 — Supported Create Modes (manifest.json)
DESCRIPTION: Configure the supported creation modes for the TreeTable: Inline, NewPage, CreationDialog. Example shows adding creationMode with a custom nodeType menu.
LANGUAGE: JSON
CODE:
```json
// manifest.json: creation-mode with custom nodeType menu
"tableSettings": {
  "type": "TreeTable",
  "hierarchyQualifier": "NodesHierarchy",
  "personalization": true,
  "creationMode": {
    "name": "Inline",              // or "NewPage" or "CreationDialog"
    "nodeType": {
      "propertyName": "nodeType", // property used to categorize node types
      "values": {
        "Zone": "Create a new Zone",
        "Intermediary": "Create a new Intermediary node",
        "Line": "Create a new Line item"
      }
    },
    "isCreateEnabled": ".extension.hierarchy-edit.custom.OPExtend.enableCreate"
  }
}
```

STEP: 3 — Create Dialog per Node Type (manifest.json)
DESCRIPTION: Configure CreationDialog to show specific creation fields per node type. creationFields can be property names or a FieldGroup annotation target.
LANGUAGE: JSON
CODE:
```json
// manifest.json: CreationDialog with per-nodeType creationFields
"tableSettings": {
  "type": "TreeTable",
  "hierarchyQualifier": "NodesHierarchy",
  "personalization": true,
  "creationMode": {
    "name": "CreationDialog",
    "creationFields": "Title", // default fields (can be overridden per node type)
    "nodeType": {
      "propertyName": "nodeType",
      "values": {
        "Zone": "Create a new Zone",
        "Intermediary": {
          "label": "Create a new Intermediary node",
          "creationFields": "Category"
        },
        "Line": "Create a new Line item"
      }
    },
    "isCreateEnabled": ".extension.hierarchy-edit.custom.OPExtend.enableCreate"
  }
}
```

STEP: 4 — Implement isCreateEnabled ControllerExtension (JavaScript)
DESCRIPTION: Add a ControllerExtension implementing enableCreate(value, parentContext). Parameters: value = selected menu item value or null for default create; parentContext = binding context of parent node (undefined for root-level creation). Return true/false to enable or disable menu item.
LANGUAGE: JavaScript
CODE:
```javascript
// webapp/extension/hierarchy-edit/custom/OPExtend.js
sap.ui.define(["sap/ui/core/mvc/ControllerExtension"], function (ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("hierarchy-edit.custom.OPExtend", {
    /**
     * Callback to enable/disable Create actions.
     * @param {any} value - menu item value (null for default create)
     * @param {sap.ui.model.Context|undefined} parentContext - parent binding context (undefined for root)
     * @returns {boolean}
     */
    enableCreate: function (value, parentContext) {
      switch (parentContext?.getProperty("nodeType")) {
        case "Zone":
          return value !== "Zone";       // Allow anything but Zone under a Zone
        case "Intermediary":
          return value === "Line";       // Only Line under Intermediary
        case "Line":
          return false;                  // Nothing under Line
        default:
          return value === "Zone";       // Only Zone at root level
      }
    }
  });
});
```

STEP: 5 — createInPlace: place new node in server-calculated position
DESCRIPTION: Enable createInPlace so a newly created node appears in its correct position under its parent (according to backend sorting/logic). If the new node is filtered out, a message toast is shown (except specific flexible column layout behavior).
LANGUAGE: JSON
CODE:
```json
// manifest.json: createInPlace example
"tableSettings": {
  "type": "TreeTable",
  "hierarchyQualifier": "NodesHierarchy",
  "personalization": true,
  "creationMode": {
    "name": "Inline",
    "createInPlace": true,
    "nodeType": { ... },
    "isCreateEnabled": ".extension.hierarchy-edit.custom.OPExtend.enableCreate"
  }
}
```

STEP: 6 — Enable Drag & Drop and extension points (manifest.json)
DESCRIPTION: Wire extension callbacks for drag&drop, cut/paste, and copy/paste. Use controller extension method names referenced here.
LANGUAGE: JSON
CODE:
```json
// manifest.json: enable drag/drop and copy/paste callback references
"tableSettings": {
  "type": "TreeTable",
  "hierarchyQualifier": "NodesHierarchy",
  "personalization": true,
  "creationMode": { ... },
  "isMoveToPositionAllowed": ".extension.hierarchy-edit.custom.OPExtend.moveToPositionAllowed",
  "isNodeMovable": ".extension.hierarchy-edit.custom.OPExtend.nodeMovable",
  "isNodeCopyable": ".extension.hierarchy-edit.custom.OPExtend.nodeCopyable",
  "isCopyToPositionAllowed": ".extension.hierarchy-edit.custom.OPExtend.copyToPositionAllowed"
}
```

STEP: 7 — Implement drag & drop / cut / paste extension callbacks
DESCRIPTION: Implement callbacks used to control allowed drag/cut/paste/copy operations. moveToPositionAllowed(sourceContext, parentContext) receives source and target contexts (parentContext is null when dropping as root). nodeMovable(sourceContext) controls whether a node may be dragged/cut. nodeCopyable(sourceContext) controls copy eligibility. copyToPositionAllowed(sourceContext, parentContext) controls pasting a copy.
LANGUAGE: JavaScript
CODE:
```javascript
// webapp/extension/hierarchy-edit/custom/OPExtend.js
sap.ui.define(["sap/ui/core/mvc/ControllerExtension"], function (ControllerExtension) {
  "use strict";

  return ControllerExtension.extend("hierarchy-edit.custom.OPExtend", {
    // Called for Drop and Paste actions (drop source onto parent)
    moveToPositionAllowed: function (sourceContext, parentContext) {
      // parentContext == null when dropping as root
      switch (parentContext?.getProperty("nodeType")) {
        case "Zone":
          return sourceContext?.getProperty("nodeType") === "Intermediary";
        case "Intermediary":
          return sourceContext?.getProperty("nodeType") === "Line"
                 && sourceContext?.getProperty("name") !== "Dublin";
        case "Line":
          return false;
        default:
          return false;
      }
    },

    // Called for Drag and Cut actions (can this node be moved/cut?)
    nodeMovable: function (sourceContext) {
      return sourceContext?.getProperty("name") !== "USA";
    },

    // Called to check if node can be copied
    nodeCopyable: function (sourceContext) {
      // Example: allow copy for non-root and not named "Restricted"
      return sourceContext && sourceContext.getProperty("name") !== "Restricted";
    },

    // Called to validate pasting a copied node under a target parent
    copyToPositionAllowed: function (sourceContext, parentContext) {
      // Example: only allow copying Line nodes under Intermediary
      return parentContext?.getProperty("nodeType") === "Intermediary"
             && sourceContext?.getProperty("nodeType") === "Line";
    }
  });
});
```

STEP: 8 — Move Up / Move Down behavior and restrictions
DESCRIPTION: Move up/down between siblings is supported when ChangeNextSiblingAction is set in RecursiveHierarchyActions. Restrictions: disabled when sort is applied, when nodes are "out of place" (created without createInPlace), or when extension callbacks return false.
LANGUAGE: None
CODE:
```text
// No code. Actionable checklist for developers:
- Ensure RecursiveHierarchyActions.ChangeNextSiblingAction is defined in service annotations for node-level reordering.
- Avoid client-side sorting during move operations, or disable move UI when sorting is applied.
- Use createInPlace to make newly created nodes placeable and movable; otherwise moves are disabled for those nodes.
- Implement isNodeMovable / isMoveToPositionAllowed for custom constraints.
```

STEP: 9 — Disable hierarchy changes via CDS annotations (sample CDS)
DESCRIPTION: Prevent drag/drop/cut/paste by marking the navigation property as non-updatable using Capabilities.UpdateRestrictions and NonUpdatableNavigationProperties in CDS.
LANGUAGE: CDS
CODE:
```cds
// Example CDS entity and annotation to disable hierarchy change operations.
// Place in a .cds file (service model)
@odata.draft.enabled
entity TreeTableSubEntityWithUpdateRestriction {
  @Core.Immutable: true
  @Common.Label: 'ID'
  key ID           : String;
  parent           : String;

  @Common.Label: 'Org level name'
  name             : String;

  @UI.Hidden: true
  orgID            : String;

  @Core.Computed: true
  @UI.Hidden: true
  DistanceFromRoot : Integer64;

  Superordinate    : Association to TreeTableSubEntityWithUpdateRestriction
                       on Superordinate.ID = parent;
  Organization     : Association to TreeTableEntity
                       on Organization.ID = orgID;
}

// Annotate to make the Superordinate navigation property non-updatable:
annotate TreeTableSubEntityWithUpdateRestriction with @(Capabilities: {
  UpdateRestrictions: { NonUpdatableNavigationProperties: [ Superordinate ] }
});
```

STEP: 10 — Prevent reordering of root nodes using XML annotations
DESCRIPTION: Use the com.sap.vocabularies.Hierarchy.v1.RecursiveHierarchyActions annotation with ChangeSiblingForRootsSupported = false to prevent reordering of root nodes.
LANGUAGE: XML
CODE:
```xml
<!-- Add to your service annotation file (edmx) -->
<edmx:Reference Uri="/sap/opu/odata/IWFND/CATALOGSERVICE;v=2/Vocabularies(TechnicalName='%2FIWBEP%2FVOC_HIERARCHY',Version='0001',SAP__Origin='LOCAL')/$value">
  <edmx:Include Namespace="com.sap.vocabularies.Hierarchy.v1" Alias="SAP__hierarchy"/>
</edmx:Reference>

<Annotations Target="YourServiceNamespace.HierarchyEntityType">
  <Annotation Term="SAP__hierarchy.RecursiveHierarchyActions" Qualifier="HierarchyNode">
    <Record>
      <PropertyValue Property="ChangeNextSiblingAction" String="YourServiceNamespace.changeNextSibling"/>
      <PropertyValue Property="CopyAction" String="YourServiceNamespace.copy"/>
      <PropertyValue Property="ChangeSiblingForRootsSupported" Bool="false"/>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 11 — Notes: context menu and multi-selection
DESCRIPTION: Context menu (right-click) shows only bound actions and greys out other nodes. Actions specific to tree tables (cut/paste/expand all/collapse all) are not supported with multi-selection. Build UI behaviors accordingly.
LANGUAGE: None
CODE:
```text
// Developer notes:
- Right-click context menu shows only actions bound to the node and greys out other nodes.
- Do not rely on cut/paste/expand-all/collapse-all for multiple selected nodes; implement custom logic if multi-selection support is required.
```

STEP: 12 — References to TreeTable macro / building block
DESCRIPTION: Use the TreeTable building block macro and API for advanced customization. Consult the UI5 API & Building Blocks examples.
LANGUAGE: None
CODE:
```text
// Useful references:
- TreeTable macro API: https://ui5.sap.com/#/api/sap.fe.macros.TreeTable
- Building Blocks examples (Tree Table): https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/table/treeTable
```

--------------------------------

**TITLE**: Types of OVP Cards and manifest.json Configuration (Fiori Elements)

**INTRODUCTION**: Quick reference for available OVP (Overview Page) card types, their common usage, and actionable manifest.json examples. Use this to configure table, list, analytical chart, link list, stack, and quick view cards, and to enable automatic refresh for cards in SAP Fiori Elements applications.

**TAGS**: fiori-elements-framework, sap-ovp, cards, manifest.json, refreshIntervalInMinutes, analytical-charts, odata-v2, LineItem

**STEP**: 1 — Card types overview

**DESCRIPTION**: Reference list of core OVP card types and short action-oriented descriptions to pick the correct template or annotation for a card implementation.

**LANGUAGE**: text

**CODE**:
```
Card types (select one by template/annotation):

- Table
  - Purpose: Displays a list of records using com.sap.vocabularies.UI.v1.LineItem.
  - Layout: 3-column table.
  - Use: template "sap.ovp.cards.table" with annotationPath referring to LineItem.

- List
  - Purpose: Displays a list of records using com.sap.vocabularies.UI.v1.LineItem.
  - Layout: Up to six fields per list item.
  - Use: template "sap.ovp.cards.list" with annotationPath referring to LineItem.

- Analytical Chart
  - Purpose: Shows data in chart formats (line, bubble, donut, column, stacked column, combination, scatter, etc.)
  - Template: "sap.ovp.cards.charts.analytical"
  - Use: chart annotation path (UI Chart or custom annotation) or settings for chart binding.

- Link List
  - Purpose: Displays a list of links with optional image/icon and subtitle.
  - Use: template "sap.ovp.cards.linklist" (or similar), configure link data source.
```

**STEP**: 2 — Additional card types available in SAP Fiori Elements for OData V2

**DESCRIPTION**: Extra card types provided specifically for OData V2 scenarios. Use when grouping or detailed single-record display is required.

**LANGUAGE**: text

**CODE**:
```
- Stack
  - Purpose: Aggregates a set of cards of the same type (common topic/action).
  - Behavior: Click can open up to 20 cards in an object stream.
  - Use: template "sap.ovp.cards.stack" (configure contained cards via settings).

- Quick View
  - Purpose: Displays detailed information for a single record (deeper than table/list).
  - Use: template "sap.ovp.cards.quickview" (point to the entity/annotation for detail fields).
```

**STEP**: 3 — Enable automatic card refresh in manifest.json

**DESCRIPTION**: Set a global refresh interval (in minutes) for OVP cards in the application manifest. Minimum/default allowed value is 1 minute. Add or update the "refreshIntervalInMinutes" property under "sap.ovp".

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "globalFilterModel": "salesOrder",
    "globalFilterEntityType": "GlobalFilters", // Deprecated since SAPUI5 1.54.
    "globalFilterEntitySet": "GlobalFilters", // Available from SAPUI5 1.54.
    "refreshIntervalInMinutes": 12,
    "disableTableCardFlexibility": false,
    "cards": {
      ...
    }
  }
}
```

**STEP**: 4 — Minimal manifest.json card examples (Table and Analytical Chart)

**DESCRIPTION**: Example card definitions to use as a starting point. Replace entitySet and annotationPath values with your service/entity names and annotations. Keep the "template" property for the correct generic OVP component.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "refreshIntervalInMinutes": 5,
    "cards": {
      "SalesOrdersTable": {
        "model": "sap_ovp_model",
        "template": "sap.ovp.cards.table",
        "title": "Sales Orders",
        "settings": {
          "entitySet": "SalesOrderSet",
          "annotationPath": "com.sap.vocabularies.UI.v1.LineItem"
        }
      },
      "SalesAnalyticalChart": {
        "model": "sap_ovp_model",
        "template": "sap.ovp.cards.charts.analytical",
        "title": "Sales Chart",
        "settings": {
          "entitySet": "SalesOrderSet",
          "chartAnnotationPath": "com.sap.vocabularies.UI.v1.Chart" 
          /* or use the chart annotation path you have defined */
        }
      }
    }
  }
}
```

**STEP**: 5 — Implementation notes and actionable tips

**DESCRIPTION**: Keep these technical details in mind when implementing or generating OVP cards programmatically.

**LANGUAGE**: text

**CODE**:
```
- Use the com.sap.vocabularies.UI.v1.LineItem annotation to drive Table and List cards (annotationPath).
- For Analytical Chart cards, point to the chart annotation or configure binding under settings; template is "sap.ovp.cards.charts.analytical".
- Minimum refresh interval is 1 minute; set refreshIntervalInMinutes under "sap.ovp".
- For OData V2-specific features, enable and configure Stack and Quick View cards as needed.
- Always validate template names against your SAPUI5/OVP library version.
```
--------------------------------

**TITLE**: Add UI Controls to an Object Page Header (SAPUI5 / Fiori Elements)

**INTRODUCTION**: This guide shows practical, code-focused examples for placing UI controls in an Object Page header. It covers: a reusable XML fragment for the sap.uxap.ObjectPageHeader, a controller to bind data and handle events, and how to include the fragment in an XML view. Use these snippets as drop-in examples for Fiori Elements extensions or SAPUI5 freestyle ObjectPages.

**TAGS**: sapui5, fiori-elements, object-page, objectpageheader, uxap, xml, javascript, fragment, extension

STEP: 1 - Create an Object Page Header XML fragment

DESCRIPTION: Create a reusable XML fragment that defines the Object Page header UI. This fragment uses sap.uxap.ObjectPageHeader and common UI controls: Image, Title, Subtitle, Number + NumberUnit, custom Buttons (actions), and a RatingIndicator. Save under webapp/fragment/ObjectPageCustomHeader.fragment.xml and reference it from your Object Page view or extension point.

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/fragment/ObjectPageCustomHeader.fragment.xml -->
<core:FragmentDefinition
  xmlns="sap.m"
  xmlns:core="sap.ui.core"
  xmlns:uxap="sap.uxap">

  <!-- ObjectPageHeader can be used as a headerTitle aggregation in an ObjectPageLayout -->
  <uxap:ObjectPageHeader
    id="customObjectPageHeader"
    objectImageURI="{/Header/ImageUrl}"
    title="{/Header/Title}"
    objectSubtitle="{/Header/Subtitle}"
    objectImageShape="Circle"
    showPlaceholder="true">

    <!-- Numeric KPI with unit -->
    <objectImagePress>
      <!-- developer-defined press handler in controller -->
    </objectImagePress>

    <actions>
      <!-- Primary action -->
      <Button
        id="btnEdit"
        text="Edit"
        icon="sap-icon://edit"
        type="Emphasized"
        press=".onEditPress" />

      <!-- Secondary action -->
      <Button
        id="btnShare"
        text="Share"
        icon="sap-icon://share-2"
        press=".onSharePress" />
    </actions>

    <!-- Additional content inside header -->
    <content>
      <HBox alignItems="Center" justifyContent="SpaceBetween" width="100%">
        <VBox>
          <Text text="{/Header/StatusText}" />
          <Text text="{path: '/Header/CreatedOn', formatter: '.formatDate'}" class="sapUiSmallMarginTop" />
        </VBox>

        <VBox alignItems="End">
          <HBox alignItems="Center">
            <Text text="{/Header/Amount}" class="sapUiTinyMarginEnd"/>
            <Text text="{/Header/Currency}" class="sapUiSmallMarginEnd"/>
            <!-- Rating indicator as an example control in header -->
            <RatingIndicator
              maxValue="5"
              value="{/Header/Rating}"
              liveChange=".onRatingLiveChange"
              editable="false" />
          </HBox>
        </VBox>
      </HBox>
    </content>
  </uxap:ObjectPageHeader>

</core:FragmentDefinition>
```

STEP: 2 - Controller: bind data, event handlers, and formatters

DESCRIPTION: Provide a controller for fragment event handlers and small data formatting utilities. Save as webapp/controller/ObjectPageCustomHeader.controller.js. The controller demonstrates binding the header to a JSONModel and handling button press events.

LANGUAGE: JavaScript

CODE:
```javascript
// File: webapp/controller/ObjectPageCustomHeader.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller",
  "sap/ui/model/json/JSONModel",
  "sap/m/MessageToast",
  "sap/ui/core/Fragment"
], function (Controller, JSONModel, MessageToast, Fragment) {
  "use strict";

  return Controller.extend("my.app.controller.ObjectPageCustomHeader", {
    onInit: function () {
      // Example: local JSON model containing header data
      var oHeaderData = {
        Header: {
          ImageUrl: "https://via.placeholder.com/80",
          Title: "Order 12345",
          Subtitle: "Customer: ACME Corp.",
          StatusText: "Open",
          CreatedOn: "/Date(1622505600000)/", // example
          Amount: "1,250.00",
          Currency: "USD",
          Rating: 4
        }
      };
      var oModel = new JSONModel(oHeaderData);
      this.getView().setModel(oModel);
    },

    // Example formatter
    formatDate: function (sDate) {
      if (!sDate) {
        return "";
      }
      try {
        // handle OData-style /Date(<ms>)/ or ISO strings
        var i = parseInt(sDate.replace(/[^0-9]/g, ""), 10);
        var oDate = new Date(i);
        return oDate.toLocaleDateString();
      } catch (e) {
        return sDate;
      }
    },

    // Button press handlers referenced in the fragment
    onEditPress: function () {
      MessageToast.show("Edit action pressed");
      // Implement edit navigation or dialog open here
    },

    onSharePress: function () {
      MessageToast.show("Share action pressed");
      // Implement share logic here
    },

    onRatingLiveChange: function (oEvent) {
      var fValue = oEvent.getParameter("value");
      MessageToast.show("Rating changed: " + fValue);
    }
  });
});
```

STEP: 3 - Include fragment in an XML view (freestyle / extension usage)

DESCRIPTION: Insert the fragment into an ObjectPage XML view. In a freestyle SAPUI5 ObjectPageLayout, place the fragment into the headerTitle aggregation. For Fiori Elements, use the platform-specific extension point to inject this fragment into the ObjectPage header; below is a direct XML view inclusion example (file: webapp/view/ObjectPage.view.xml).

LANGUAGE: XML

CODE:
```xml
<!-- File: webapp/view/ObjectPage.view.xml -->
<mvc:View
  controllerName="my.app.controller.ObjectPageCustomHeader"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:uxap="sap.uxap"
  xmlns:core="sap.ui.core">

  <uxap:ObjectPageLayout id="objectPageLayout">
    <!-- Insert the custom header fragment into the headerTitle aggregation -->
    <headerTitle>
      <core:Fragment fragmentName="my.app.fragment.ObjectPageCustomHeader" type="XML" />
    </headerTitle>

    <headerContent>
      <!-- Optional header content area -->
    </headerContent>

    <sections>
      <!-- ObjectPage sections and subsections go here -->
    </sections>
  </uxap:ObjectPageLayout>
</mvc:View>
```

STEP: 4 - Integration notes for Fiori Elements

DESCRIPTION: For Fiori Elements (SAP Fiori tools / Managed apps) you will not edit the core ObjectPage XML directly. Instead:
- Add the fragment under webapp/fragment/.
- Provide the controller under webapp/controller/.
- Register the fragment via the framework extension point for the Object Page header. Use the specific extension mechanism of your Fiori Elements version (app descriptor annotations, manifest extension points, or annotation-driven extension points).
- Alternatively, use annotations (CDS/OData) to configure simple header fields (title, subtitle, image, KPI) and reserve the fragment for custom interactive controls.

LANGUAGE: JSON

CODE:
```json
// Example manifest hint (conceptual) - follow your project's Fiori Elements doc for exact extension keys.
// File: manifest.json (snippet)
{
  "sap.ui5": {
    "rootView": {
      // ...
    },
    "dependencies": { /* ... */ },
    "controllers": {
      "my.app.controller.ObjectPageCustomHeader": {}
    }
  }
}
```

Step 5 - Quick checklist for successful header integration

DESCRIPTION: Follow this checklist after adding the fragment:
- File placement: webapp/fragment/ObjectPageCustomHeader.fragment.xml and webapp/controller/ObjectPageCustomHeader.controller.js
- Bind a model on the view or let Fiori Elements provide the context model
- If embedding in an existing XML view, add <core:Fragment ... /> inside headerTitle aggregation
- For Fiori Elements, use the platform extension mechanism to inject the fragment into the Object Page header
- Ensure all XML namespaces used in the fragment match your project (sap.m, sap.uxap, sap.ui.core)

LANGUAGE: Plain text

CODE:
```text
Checklist:
- webapp/fragment/ObjectPageCustomHeader.fragment.xml
- webapp/controller/ObjectPageCustomHeader.controller.js
- Include in view via <core:Fragment fragmentName="...">
- Wire model binding (JSONModel for local testing or OData/Fiori Elements context)
- Implement press handlers and formatters in controller
```
--------------------------------

**TITLE**: Registering and Implementing a Custom Root View for a Fiori Elements App

**INTRODUCTION**: This guide shows how to create a custom root view (XML + controller) and register it for a SAP Fiori Elements / UI5 application. Use this when the standard NavContainer or FlexibleColumnLayout root views do not meet your UI requirements. The custom root must include the app/container control (id "app") so the Fiori framework router can place pages.

**TAGS**: fiori-elements-framework, ui5, root-view, manifest.json, custom-view, xml, controller

**STEP**: 1 — Create the XML root view file

**DESCRIPTION**: Add an XML view file under webapp/view that defines your custom root UI. Include the app/container with id "app" so the Fiori framework router can load pages into it. Example below uses sap.m.App. If you need FCL, swap in sap.f.FlexibleColumnLayout and add sap.f to dependencies.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/view/CustomRoot.view.xml -->
<mvc:View
  controllerName="my.app.controller.CustomRoot"
  xmlns:mvc="sap.ui.core.mvc"
  xmlns="sap.m"
  xmlns:core="sap.ui.core">
  <!-- App container with id "app" is required for Fiori framework routing -->
  <App id="app">
    <!-- Optionally add a shell/header or static content here -->
  </App>
</mvc:View>
```

**STEP**: 2 — Add the controller for the custom root view

**DESCRIPTION**: Create a controller that complements the XML view. Keep initialization lightweight — routing is usually handled by the framework/Component. Use this controller to attach global models, initial event handlers, or perform view-specific setup.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/controller/CustomRoot.controller.js
sap.ui.define([
  "sap/ui/core/mvc/Controller"
], function (Controller) {
  "use strict";

  return Controller.extend("my.app.controller.CustomRoot", {
    onInit: function () {
      // Optional: attach models, services, or event handlers here.
      // Do not re-initialize the router unless your app specifically requires it.
      // Example:
      // var oModel = this.getOwnerComponent().getModel();
      // this.getView().setModel(oModel);
    }
  });
});
```

**STEP**: 3 — Register the custom root view in manifest.json

**DESCRIPTION**: Tell UI5/your component to use the new root view by configuring sap.ui5.rootView in webapp/manifest.json. This is the recommended place to register the root view. Ensure viewName matches the XML view namespace and path.

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (partial extract)
{
  "sap.app": {
    "id": "my.app",
    "type": "application"
  },
  "sap.ui5": {
    "dependencies": {
      "minUI5Version": "1.71.0",
      "libs": {
        "sap.m": {},
        "sap.ui.core": {}
        // add "sap.f": {} if you use FlexibleColumnLayout
      }
    },
    "rootView": {
      "viewName": "my.app.view.CustomRoot",
      "type": "XML",
      "id": "customRoot"
    },
    "routing": {
      // keep your existing routing configuration here
    }
  }
}
```

**STEP**: 4 — Alternative: register root view in Component.js metadata (optional)

**DESCRIPTION**: As an alternative to manifest.json, you can declare the rootView inside Component.js metadata. Use this only if your project pattern requires it.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// File: webapp/Component.js (partial)
sap.ui.define([
  "sap/ui/core/UIComponent"
], function (UIComponent) {
  "use strict";

  return UIComponent.extend("my.app.Component", {
    metadata: {
      manifest: "json",
      // optional: only if not defined in manifest.json
      rootView: "my.app.view.CustomRoot"
    }
  });
});
```

**STEP**: 5 — Ensure libraries and view IDs expected by the framework

**DESCRIPTION**: Verify the manifest dependencies include libraries used by your root view (sap.m or sap.f). Ensure your root view contains an app/container control with id "app" so the Fiori Elements framework can place pages. If you replace the default FCL/root container, make sure routing targets match the container type (for FCL use the correct aggregation names).

**LANGUAGE**: JSON

**CODE**:
```json
// Manifest notes (example)
{
  "sap.ui5": {
    "dependencies": {
      "libs": {
        "sap.m": {},
        "sap.f": {} // add if your custom root uses sap.f.FlexibleColumnLayout
      }
    }
  }
}
```

**STEP**: 6 — Reference: SAP Fiori Development Portal examples

**DESCRIPTION**: For live examples and additional guidance, consult the SAP Fiori Development Portal Custom Root View examples.

**LANGUAGE**: TEXT

**CODE**:
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/guidance/guidanceOwnRootView
--------------------------------

**TITLE**: Action Control for Context-Dependent Actions (SAP Fiori Elements)

**INTRODUCTION**: Configure context-dependent actions so actions are enabled, disabled, or hidden based on entity-instance Boolean properties. Covers OData V2 (sap:action-for / sap:applicable-path) and OData V4 (OperationAvailable). Includes UX rules for header vs line-item behavior and parameter-dialog behavior for single-context actions.

**TAGS**: fiori-elements-framework, OData-V2, OData-V4, action-control, annotations, FunctionImport, OperationAvailable, sap:applicable-path

**STEP**: 1 — OData V2: Add sap:action-for and sap:applicable-path to FunctionImport (or action)
**DESCRIPTION**: For OData V2, make an action context-dependent by annotating the FunctionImport (or action) with sap:action-for pointing to the target entity type and sap:applicable-path pointing to a Boolean property on that entity type. SAP Fiori elements reads the Boolean at runtime and hides or disables the action according to UX rules (below). Use this pattern for server-side FunctionImport definitions in your service metadata (EDMX/CSDL).
**LANGUAGE**: XML
**CODE**:
```XML
<FunctionImport Name="SEPMRA_C_PD_ProductCopy" 
                ReturnType="SEPMRA_PROD_MAN.SEPMRA_C_PD_ProductType" 
                EntitySet="SEPMRA_C_PD_Product" m:HttpMethod="POST"
                sap:action-for="SEPMRA_PROD_MAN.SEPMRA_C_PD_ProductType" 
                sap:applicable-path="IsActiveEntity">
    <Parameter Name="ProductDraftUUID" Type="Edm.Guid" Mode="In"/>
    <Parameter Name="ActiveProduct" Type="Edm.String" Mode="In" MaxLength="10"/>
</FunctionImport>
```

**STEP**: 2 — OData V4: Add OperationAvailable term to enable/disable actions
**DESCRIPTION**: For OData V4, add an OperationAvailable annotation to the action definition that points to a Boolean property on the entity. The Boolean determines whether the action is enabled for a selected instance. Apply this annotation to the action/operation in your CSDL/annotation file so Fiori elements evaluates availability at runtime.
**LANGUAGE**: XML
**CODE**:
```XML
<!-- Example pattern for OData V4 action availability.
     Replace Term and Path according to your annotation namespace/style. -->
<Action Name="MyCustomAction" IsBound="true" EntitySetPath="MyEntitySet">
  <Annotation Term="OperationAvailable" Path="IsActionAvailable"/>
  <!-- action parameters here -->
</Action>
```

**STEP**: 3 — UX behavior rules and special notes
**DESCRIPTION**: Summarize runtime semantics and cautions developers must follow when using context-dependent actions.
**LANGUAGE**: JSON
**CODE**:
```JSON
{
  "behavior": {
    "evaluation": "Fiori elements evaluates the Boolean property referenced by applicable-path or OperationAvailable at runtime per selected instance.",
    "visibility_rules": {
      "page_header_or_line_item_buttons": "action is hidden when applicable-path condition is false",
      "table_header_buttons": "action is disabled when applicable-path condition is false"
    },
    "multi_select": "If multi-select is enabled in a table, the action is allowed when at least one selected entry fulfills the condition.",
    "parameter_dialog": "For single-context select actions: if action parameters are dynamic and none are required for the selected instance, the parameter dialog is not shown.",
    "ui_hidden_precedence": "Do not use UI.Hidden for DataFieldForAction within page header together with sap:applicable-path: UI.Hidden takes precedence and can deviate from recommended visibility behavior."
  }
}
```
--------------------------------

**TITLE**: Enabling and Using Analytical Parameters from the Back End (OData V2 / SAP Fiori elements)

**INTRODUCTION**: This document shows how to enable analytical parameters for Fiori Elements apps that consume OData V2, how the framework passes parameter values directly to the back end, and how to configure the app (manifest.json) so that parameter filters are automatically provided and enforced in the List Report and Object Page.

**TAGS**: fiori-elements-framework, odata-v2, analytical-parameters, manifest.json, filters, list-report, object-page

**STEP**: 1 — Concept and backend parameter call example

**DESCRIPTION**: Analytical parameters are key/value pairs sent directly to the back end (not part of $filter). Use parameters to normalize units (for example Currency) at runtime. Example shows a parameter P_DisplayCurrency passed to an entity action/FunctionImport call.

**LANGUAGE**: HTTP

**CODE**:
```http
GET http://<host>/<service>/Customer(P_DisplayCurrency='EUR')/Set?$count=true
```

Notes:
- The backend receives P_DisplayCurrency='EUR' as a parameter, not as a $filter expression.
- Use parameters to request server-side normalization (currency conversion, unit conversion, etc.) so aggregation and other operations behave correctly.

**STEP**: 2 — Enable analytical parameters in manifest.json

**DESCRIPTION**: Set the considerAnalyticalParameters flag to true in your app's webapp/manifest.json under sap.ui.generic.app > settings. This instructs the Fiori Elements framework to automatically expose analytical parameters as filters in the List Report. The filters become mandatory and the framework includes the parameter values in backend calls.

Place the snippet in webapp/manifest.json (inside the existing sap.ui.generic.app node).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "considerAnalyticalParameters": true,
      "forceGlobalRefresh": true,
      "inboundParameters": {
        "Supplier": {
          "useForCreate": true
        }
      },
      "objectPageDynamicHeaderTitleWithVM": true
    }
  }
}
```

Notes:
- Path: webapp/manifest.json
- considerAnalyticalParameters: true — framework creates parameter filters and sends parameter values to backend.
- forceGlobalRefresh, inboundParameters and objectPageDynamicHeaderTitleWithVM are shown as related settings you may already have; keep them when merging into your manifest.

**STEP**: 3 — UI behavior and validation

**DESCRIPTION**: After enabling the manifest setting:
- The List Report shows filters for analytical parameters automatically.
- These filters become mandatory; users must provide values before data can be fetched/aggregated.
- When a user sets a parameter (e.g., Currency = EUR), subsequent requests include the parameter to the backend so server-side conversion/aggregation occurs.

**LANGUAGE**: Plain

**CODE**:
```text
Behavior summary:
- Parameter filters are added automatically to List Report filter bar.
- Filter values are sent as query parameters to backend (not part of $filter).
- Backend must support the analytical parameter on the entity/function for correct processing.
```

**STEP**: 4 — Implementation checklist for developers

**DESCRIPTION**: Quick checklist to implement analytical parameters end-to-end.

**LANGUAGE**: Plain

**CODE**:
```text
1. Backend:
   - Expose analytical parameter(s) on the OData entity or function import.
   - Implement server-side conversion/normalization logic (e.g., currency conversion).
2. Frontend:
   - Add "considerAnalyticalParameters": true to webapp/manifest.json under sap.ui.generic.app > settings.
   - Optionally keep other settings like forceGlobalRefresh or inboundParameters.
3. Run and test:
   - Open List Report; verify parameter filters appear.
   - Set a parameter value; check the network request includes the parameter (see Step 1 example).
   - Verify backend returns expected normalized/aggregated results.
```

**STEP**: 5 — Related links

**DESCRIPTION**: For additional info about parameterized entities in OData V4 (concepts apply similarly), consult the SAP Fiori Elements Configuring Filter Bars documentation.

**LANGUAGE**: Plain

**CODE**:
```text
See: Configuring Filter Bars — Supporting Parameterized Entities
File reference: configuring-filter-bars-4bd7590.md#loio4bd7590569c74c61a0124c6e370030f6__suppprting_parameterized_entities_subsection
```
--------------------------------

**TITLE**: Implementing onBefore* Extension Methods (Fiori elements OData V4)

**INTRODUCTION**: This guide shows how to implement onBefore* controller extension methods for SAP Fiori elements (OData V4) to run custom code before the framework’s standard operations. It includes secure execution wrapping (securedExecution) and the updatesDocument flag to allow Fiori elements to show discard confirmation when your code changes document state.

**TAGS**: fiori-elements, odata-v4, controller-extension, onBeforeSave, onBeforeCreate, securedExecution, updatesDocument

**STEP**: 1 — Create the controller extension module file

**DESCRIPTION**: Create a UI5 module that exports the extension methods. Place the file in your app (example path below) and export an object implementing any of the onBefore* methods you need.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// File: webapp/extension/ObjectPage/Extension.js
sap.ui.define([], function () {
    "use strict";

    // Export the extension object containing any of the supported onBefore* hooks.
    // The extension API (this) exposes securedExecution, i18n, logger, etc.
    return {

        /**
         * Called before the standard create flow is executed.
         * @param {sap.ui.base.Event} oEvent
         * @returns {Promise|undefined}
         */
        onBeforeCreate: function (oEvent) {
            // Example: quick validation or initialization before creating a new draft
            return this.securedExecution(async () => {
                // Custom pre-create logic here
                // e.g., set default values on the draft, log, or call a service
                // this.getModel().setProperty("/MyField", "Default");
                // If you change document state (affects discard), set updatesDocument: true
            }, {
                // updatesDocument true if your code modifies the draft/object state
                updatesDocument: false
            });
        },

        /**
         * Called before switching to edit mode / before the standard edit flow.
         * @param {sap.ui.base.Event} oEvent
         */
        onBeforeEdit: function (oEvent) {
            return this.securedExecution(async () => {
                // Custom logic before edit is started, e.g., check authorizations
            }, {
                updatesDocument: false
            });
        },

        /**
         * Called before saving the draft or non-draft entity.
         * If you modify the entity or need to present confirm/validation, use updatesDocument accordingly.
         * @param {sap.ui.base.Event} oEvent
         */
        onBeforeSave: function (oEvent) {
            return this.securedExecution(async () => {
                // Custom validation or transformation before save
                // Throw or return a rejected promise to cancel the save
                // Example: validate a field and show message
                const invalid = false; // replace with real validation
                if (invalid) {
                    // Use the framework messaging inside securedExecution
                    throw new Error("Validation failed: required field missing.");
                }
            }, {
                updatesDocument: false
            });
        },

        /**
         * Called before discarding a draft.
         * Use updatesDocument true if your code changes the draft state so FE can show confirmation popover.
         * @param {sap.ui.base.Event} oEvent
         */
        onBeforeDiscard: function (oEvent) {
            return this.securedExecution(async () => {
                // Custom cleanup or checks before discard
            }, {
                updatesDocument: false
            });
        },

        /**
         * Called before delete is executed. For object page: single context. For list/table: for each selected context.
         * @param {sap.ui.base.Event} oEvent
         */
        onBeforeDelete: function (oEvent) {
            return this.securedExecution(async () => {
                // Example: inspect selected contexts (if any)
                const aContexts = oEvent.getParameter && oEvent.getParameter("selectedContexts");
                if (Array.isArray(aContexts) && aContexts.length) {
                    // custom logic for each selected context
                    aContexts.forEach(function (oContext) {
                        // e.g., check business rules before deletion
                    });
                } else {
                    // object page single deletion: you can use the binding context
                    const oContext = oEvent.getSource && oEvent.getSource().getBindingContext();
                    // custom logic for single context
                }
            }, {
                updatesDocument: false
            });
        }
    };
});
```

**STEP**: 2 — Wrap custom logic with securedExecution and set updatesDocument appropriately

**DESCRIPTION**: Always run custom code that shows messages or changes the object state inside securedExecution to ensure Fiori elements handles messaging and confirm/discard behavior correctly. Set updatesDocument: true in the options when your code changes the draft/object so the framework can show a discard confirmation popover.

**LANGUAGE**: JavaScript

**CODE**:
```JavaScript
// Example usage pattern inside any onBefore* method:
return this.securedExecution(async () => {
    // custom changes that mutate the document/draft
    // e.g., this.getModel().setProperty("/Entity/Field", "value");
    // optionally show messages using the extension API or throw errors to cancel
}, {
    updatesDocument: true // true if you changed the draft/object state
});
```

**STEP**: 3 — Register the controller extension in manifest.json

**DESCRIPTION**: Register your extension module in the app manifest so Fiori elements loads it for the relevant floorplan (object page, list report, etc.). Example below maps an ObjectPage controller extension to the module created in STEP 1.

**LANGUAGE**: JSON

**CODE**:
```JSON
// Snippet to add to your webapp/manifest.json (sap.ui5 section).
// Adjust the template controller key and module path for your app and floorplan.
{
  "sap.ui5": {
    "extends": {
      "extensions": {
        "sap.ui.controllerExtensions": {
          "sap.fe.templates.ObjectPage.controllerExtensions": {
            // The key below is the arbitrary extension name; the value is the module path.
            "MyObjectPageExtension": "extension/ObjectPage/Extension"
          }
        }
      }
    }
  }
}
```

**STEP**: 4 — Common patterns and tips

**DESCRIPTION**: Quick actionable notes to apply when writing onBefore* code.

**LANGUAGE**: Plain text

**CODE**:
```text
- Use securedExecution to wrap any custom code that:
  - displays messages via the framework,
  - makes changes that affect the document/draft.
- Set updatesDocument: true when your code modifies the object/draft so FE shows discard confirmation popover on navigation/cancel.
- If validation should cancel the standard operation, throw an Error or return a rejected Promise inside securedExecution.
- For onBeforeDelete on tables, read selected contexts with oEvent.getParameter("selectedContexts").
- Keep onBefore* handlers short and asynchronous-friendly (return Promises).
- This applies only for SAP Fiori elements with OData V4.
```
--------------------------------

**TITLE**: Defining Global Side Effects (TriggerAction) for SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: This document shows how to define global side effects (no source properties/entities) that trigger when the user presses Enter in draft-enabled SAP Fiori Elements apps. It includes examples for OData V2 (XML annotations + manifest.json setting) and OData V4 (CAP CDS annotations). Use these to refresh specific target properties/entities or to call a TriggerAction. Prefer specific targets for performance; use forceGlobalRefresh only for exceptional cases.

**TAGS**: fiori-elements, side-effects, global-side-effect, triggeraction, draft, annotations, ODataV2, ODataV4, manifest.json, CAP, CDS

**STEP**: 1 — Key behavior and constraints

**DESCRIPTION**: Summary of behavior and important constraints developers must be aware of before implementing global side effects.

- Global side effects are only valid in draft-enabled applications.
- Global side effects are defined without source properties/entities; they should specify TargetProperties and optionally TriggerAction.
- On pressing Enter in an input field, the entity’s global side effect is triggered:
  - For OData V2 (Fiori Elements): if TriggerAction is present, it replaces the PreparationAction call when Enter is pressed.
- Prefer specifying TargetProperties/TargetEntities for performance. Use forceGlobalRefresh to refresh the entire entity only if necessary.
- forceGlobalRefresh default (runtime since SAPUI5 1.106): false. Design-time default for newly generated apps: false.

**LANGUAGE**: text

**CODE**:
```text
Note:
- Applicable only in draft-enabled apps.
- Prefer specific TargetProperties/TargetEntities; use forceGlobalRefresh only when required.
- Runtime default (SAPUI5 >=1.106) for forceGlobalRefresh is false.
```

**STEP**: 2 — Add a Global Side Effect annotation (OData V2, XML)

**DESCRIPTION**: Add an XML annotation to your annotation file (e.g., webapp/annotations/annotations.xml or any annotations file referenced in manifest.json). The annotation must target the entity type (NAMESPACE.ENTITYTYPE), list the TargetProperties to refresh and set TriggerAction to the action name to call when Enter is pressed.

- File: webapp/annotations/<your_annotations>.xml (or project-specific annotations file referenced in manifest.json)
- Behavior: When Enter is pressed on any input field of the entity, the specified TargetProperties are refreshed and the TriggerAction is executed (TriggerAction replaces PreparationAction for draft-enabled OData V2 apps).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- webapp/annotations/annotations.xml -->
<Annotations Target="NAMESPACE.ENTITYTYPE">
    <Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="GlobalSideEffect">
        <Record>
            <PropertyValue Property="TargetProperties">
                <Collection>
                    <String>TaxAmount</String>
                    <String>NetAmount</String>
                    <String>GrossAmount</String>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="TriggerAction" String="NAMESPACE.MyAction"/>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 3 — Configure forceGlobalRefresh in manifest.json (OData V2 and OData V4 runtime behavior)

**DESCRIPTION**: Optional. To force a full model/entity refresh on Enter (instead of only refreshing annotated targets/calling TriggerAction), set forceGlobalRefresh in the app manifest. Use this only for exceptional cases; prefer targeted annotations.

- File: webapp/manifest.json (root sap.ui.generic.app settings)
- Runtime behavior:
  - true = refresh entire model when Enter is pressed
  - false = refresh only annotated targets and/or call TriggerAction
  - If not set, runtime default (SAPUI5 >=1.106) is false

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "_version": "1.3.0",
    "settings": {
      "forceGlobalRefresh": true
    }
  }
}
```

**STEP**: 4 — Add a Global Side Effect annotation (OData V4, CAP CDS)

**DESCRIPTION**: For OData V4 / CAP projects, annotate the entity in your CDS file or a separate annotations file. Specify TargetProperties and TriggerAction as shown. The annotation triggers the specified action and refreshes the listed properties when Enter is pressed (draft-enabled apps).

- Place in a CDS file or an annotations file loaded by your service metadata.

**LANGUAGE**: CDS

**CODE**:
```cds
/* example: app/annotations.cds or srv/<service>-annotations.cds */
annotate NAMESPACE.ENTITYTYPE @(
  Common.SideEffects #GlobalSideEffect : {
    TargetProperties : [
      TaxAmount,
      NetAmount,
      GrossAmount
    ],
    TriggerAction : 'NAMESPACE.MyAction'
  }
);
```

**STEP**: 5 — Implementation checklist & best practices

**DESCRIPTION**: Quick checklist before deploying changes.

- Verify the app uses draft handling (required).
- Prefer listing specific TargetProperties/TargetEntities for side effects.
- Only enable forceGlobalRefresh in manifest.json when full model refresh is unavoidable.
- For OData V2: if you add TriggerAction, ensure it is implemented on the backend and referenced with the correct namespace and action name.
- For OData V4 / CAP: implement the action (NAMESPACE.MyAction) and ensure the annotation is loaded into service metadata.

**LANGUAGE**: text

**CODE**:
```text
Checklist:
- App is draft-enabled.
- Annotation file referenced in manifest.json (if necessary).
- Backend action NAMESPACE.MyAction implemented and exposed.
- Use specific TargetProperties; set forceGlobalRefresh only if needed.
- Verify runtime defaults: forceGlobalRefresh defaults to false (SAPUI5 >=1.106).
```
--------------------------------

**TITLE**: Displaying Images, Initials, and Icons (SAP Fiori / UI5 Avatar usage)

**INTRODUCTION**: Show how to render object images, initials, or icons using the sap.m.Avatar control. Includes expression-binding examples for initials, icon fallbacks, sample static image asset path, and notes about object-page header behaviour and Page Editor for OData V2 apps.

**TAGS**: fiori-elements, sapui5, avatar, object-page, initials, icon, images, fallback

**STEP**: 1 — Avatar in an XML fragment (bind to OData properties)
**DESCRIPTION**: Add a sap.m.Avatar to an XML fragment or view. Bind the image source to an OData property, compute initials via expression binding (or use a controller method), and provide an icon fallback. Use displayShape to control circular vs square rendering.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- File: fragments/ObjectHeaderAvatar.fragment.xml -->
<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core">
  <!-- Avatar: prefer image (Picture), then initials (FirstName+LastName), then icon fallback -->
  <Avatar
    id="objectAvatar"
    src="{/Picture}"                             <!-- OData property holding image binary/url -->
    initials="{= ${FirstName} && ${LastName} ? ((${FirstName}).charAt(0) + (${LastName}).charAt(0)).toUpperCase() : '' }"
    icon="{= ${Picture} ? '' : 'sap-icon://product' }"   <!-- choose icon only when no picture -->
    displayShape="Square"                        <!-- Square or Circle -->
    size="L"
    tooltip="{= ${FirstName} && ${LastName} ? ${FirstName} + ' ' + ${LastName} : '' }"
  />
</core:FragmentDefinition>
```

**STEP**: 2 — Using a local image asset as fallback/placeholder
**DESCRIPTION**: Place a placeholder image asset in the project and bind conditionally to it when the entity has no picture. The example uses the included image path images/Avatar_e9e8ed2.jpg.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Conditional binding with formatter (controller method shown below) -->
<Avatar
  id="objectAvatarWithPlaceholder"
  src="{ path: 'Picture', formatter: '.formatAvatarSrc' }"
  initials="{= ${FirstName} && ${LastName} ? ((${FirstName}).charAt(0) + (${LastName}).charAt(0)).toUpperCase() : '' }"
  icon="sap-icon://product"
  displayShape="Square"
  size="L"
/>
```

```javascript
// File: controller/ObjectPage.controller.js
// formatAvatarSrc: return the Picture URL when available, otherwise a project asset path
formatAvatarSrc: function(sPicture) {
  // sPicture: URL or base64 image from OData service
  if (sPicture) {
    return sPicture;
  }
  // Project asset fallback (preserve this file path in your project)
  return sap.ui.require.toUrl("my/app") + "/images/Avatar_e9e8ed2.jpg";
}
```

**STEP**: 3 — Compute initials in controller (alternative to expression binding)
**DESCRIPTION**: Compute initials in the controller and set them on the Avatar control. Use when expression binding is not preferred or logic is more complex.
**LANGUAGE**: JavaScript
**CODE**:
```javascript
// File: controller/ObjectPage.controller.js
onInit: function () {
  // example: after OData entity is loaded, compute initials and set on avatar control
  // assume this.getView().getModel() is already set to the entity model
},

_setAvatarInitials: function(oEntity) {
  var sFirst = oEntity.FirstName || "";
  var sLast = oEntity.LastName || "";
  var sInitials = "";
  if (sFirst || sLast) {
    sInitials = (sFirst.charAt(0) || "") + (sLast.charAt(0) || "");
    sInitials = sInitials.toUpperCase();
  }
  var oAvatar = this.byId("objectAvatar") || this.byId("objectAvatarWithPlaceholder");
  if (oAvatar) {
    oAvatar.setInitials(sInitials);
  }
}
```

**STEP**: 4 — Object Page header behaviour and shape fallback notes
**DESCRIPTION**: Important behaviour facts to guide implementation and UI decisions.
**LANGUAGE**: JSON
**CODE**:
```json
{
  "notes": [
    "In the object page header the avatar control is used; its shape defaults to Square unless configured otherwise.",
    "Fallback logic used by the UI/Avatar approach: image (src) -> initials -> icon fallback.",
    "If avatar displayShape is Circle and no source/initials/icon is provided, a person icon is shown as placeholder.",
    "If avatar displayShape is Square and no source/initials/icon is provided, a product icon is shown as placeholder.",
    "For SAP Fiori elements apps built with OData V2, you can change the display shape using the Page Editor of SAP Fiori tools."
  ],
  "pageEditorLink": "https://help.sap.com/docs/SAP_FIORI_tools/17d50220bcd848aa854c9c182d65b699/047507c86afa4e96bb3d284adb9f4726.html",
  "exampleAssetPath": "images/Avatar_e9e8ed2.jpg"
}
```

**STEP**: 5 — Styling (optional)
**DESCRIPTION**: Override size or spacing if required by your Object Page layout.
**LANGUAGE**: CSS
**CODE**:
```css
/* File: css/ObjectPage.style.css */
#objectAvatar, #objectAvatarWithPlaceholder {
  /* override avatar size if needed */
  width: 4rem;
  height: 4rem;
}
```

Notes:
- Use expression binding for small inline logic; move to controller formatters for complex rules or reuse.
- Preserve the asset file images/Avatar_e9e8ed2.jpg in the project's webapp/images folder if used as fallback.
--------------------------------

**TITLE**: Handling Back-End Messages (State & Transition) in SAP Fiori Elements (OData V2/V4)

**INTRODUCTION**: Practical, code-oriented guidance for producing, annotating, and handling server-side messages (state and transition) in SAP Fiori Elements apps using OData V2 and V4. Includes back-end validation rules, required annotations (OData V4 side effects), UI behavior mapping, and client-side handling guidelines (412 and 503 responses, message popover/dialog behavior, and using the ObjectPage ExtensionAPI).

**TAGS**: fiori-elements, OData, server-messages, side-effects, SAP__Messages, message-popover, message-dialog, 412, 503, ObjectPage.ExtensionAPI

STEP: 1 — Message Types: State vs Transition
DESCRIPTION: Define and differentiate server messages so backend and frontend behave consistently.
- State message: refers to instance state (e.g., "Amount must not be negative"). Persisted in backend. Display rules:
  - Not expected in list report or object page in display mode.
  - In object page edit mode (and subobject edit mode) show in message popover. Popover shows messages for current object and its subtree only.
  - Client-side validation messages also shown in the same popover.
- Transition message: transient (not persisted). Sent only in response to a specific request (fire-and-forget). Display rules:
  - Shown in message dialog (also in edit mode for OData V2).
  - If bound to an entity and exactly one success transition message is returned, show a message toast.
  - Removed when user triggers a new action or changes data.

LANGUAGE: None
CODE:
```text
(No code — conceptual definitions for backend/frontend developers)
```

STEP: 2 — Back-End Validation After Field Change (Drafts & Activation)
DESCRIPTION: Implement backend validation rules and message lifecycle for drafts and activation flows.
- Validate input moderately — avoid excessive validations that slow UX or prevent incomplete draft entry.
- Validate:
  - Before draft activation.
  - When user presses Enter or Validation button (mobile).
- Backend must:
  - Return state messages (SAP__Messages) for invalid fields. If any field invalid, activation must fail and draft returned for correction.
  - After a single-field correction, revalidate changed fields and update/remove corresponding state messages.
- Multiple targets in a single message:
  - Allowed for special scenarios (e.g., cross-field validation: startDate > endDate; or annotate unit-of-measure together with value).
  - Ensure targets are on the same UI page.

LANGUAGE: None
CODE:
```text
(No code — validation lifecycle and rules)
```

STEP: 3 — OData V4: Annotate Side Effects to Request/Update State Messages
DESCRIPTION: For OData V4, annotate side effects so the client requests/refreshes SAP__Messages for changes that can alter messages. Use TargetProperties to include SAP__Messages. If an action returns an entity with a message property but no side effect exists, the client implicitly requests the message property. If you add side effects, include SAP__Messages in TargetProperties.
- Place these annotations in your annotation file (e.g., annotations.xml) associated with the service metadata.

LANGUAGE: XML
CODE:
```xml
<!-- Side effect: annotate when Customer changes, refresh SAP__Messages -->
<Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="CustomerChange">
    <Record>
        <PropertyValue Property="SourceProperties">
            <Collection>
                <PropertyPath>Customer</PropertyPath>
            </Collection>
        </PropertyValue>
        <PropertyValue Property="TargetProperties">
            <Collection>
                <PropertyPath>SAP__Messages</PropertyPath>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

LANGUAGE: XML
CODE:
```xml
<!-- Side effect: always read state messages for all properties of the entity -->
<Annotation Term="com.sap.vocabularies.Common.v1.SideEffects" Qualifier="AllwaysReadStateMessages">
    <Record>
        <PropertyValue Property="SourceEntities">
            <Collection>
                <NavigationPropertyPath />
            </Collection>
        </PropertyValue>
        <PropertyValue Property="TargetProperties">
            <Collection>
                <PropertyPath>SAP__Messages</PropertyPath>
            </Collection>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 4 — Bound vs Unbound Messages & UI Mapping (Popovers, Dialogs, Button)
DESCRIPTION: Map server message binding to UI components and behaviors.
- Bound messages (associated with an entity instance):
  - Both state and transition messages appear in message popover in edit mode.
  - Popover: grouped by message group (table/section) or 'General'; supports filtering by severity; supports navigation to the UI element that caused the message.
  - Bound transition messages:
    - Shown in message dialog in list report and object page in display mode.
    - Removed when new action or data change occurs.
    - If exactly one transition success message exists, show message toast instead of dialog.
  - Message Button:
    - Visible only if bound messages exist.
    - Colored by highest severity.
    - Shows count of error messages.
- Unbound messages (not tied to instance):
  - Always considered transition messages.
  - Displayed in message dialog.
  - Dialog shows list, filtering by severity, type, title/subtitle, description, and chevron navigation to message details (technical details: status code/text, component ID, service ID, timestamps, etc.)

LANGUAGE: None
CODE:
```text
(No code — UI behavior mapping reference for frontend implementation)
```

STEP: 5 — OData V2: Draft Operations & Transition Messages
DESCRIPTION: Additional OData V2 handling notes:
- Transition messages are always shown in message dialog, also in object page edit mode.
- Treat draft operations like actions (activate, prepare, validate).
- Recommendation: Avoid raising transition messages during prepare and validate operations (they are displayed in a dialog and unnecessary for edit-mode flows).

LANGUAGE: None
CODE:
```text
(No code — behavioral guideline)
```

STEP: 6 — Handling 412 Precondition Failed Messages (Retry Flow)
DESCRIPTION: Implement client retry flow for 412 (Precondition Failed) messages — allow users to ignore 412 warnings and retry the action. Provide a confirmation popup allowing the user to retry or cancel the action.
- Use your app’s confirmation dialog pattern to present the 412 details and a Retry button.
- If the user confirms retry, resend the original request (optionally with an override header/flag if your backend supports “force” execution).

LANGUAGE: JavaScript
CODE:
```javascript
// Pseudocode: handle 412 on an action call and offer retry via confirmation dialog
fetch(actionUrl, options)
  .then(response => {
    if (response.status === 412) {
      const details = /* parse response body */;
      // Show confirmation popup (use your UI framework's dialog)
      showConfirmationDialog({
        title: "Precondition Failed",
        message: details.message,
        confirmLabel: "Retry ignoring warnings",
        onConfirm: () => {
          // resend request with an agreed override header or parameter
          options.headers['X-Force'] = 'true';
          return fetch(actionUrl, options).then(retryResp => { /* handle retryResp */ });
        }
      });
    }
  });
```

STEP: 7 — Special Handling: 503 Service Unavailable
DESCRIPTION: Use retry-after header to decide UX and retry strategy. Behavior:
- If 503 occurs on application startup: show an error page.
- If response includes Retry-After header:
  - retry-after < 5 seconds => show busy indicator
  - 5 <= retry-after <= 600 seconds => show dialog with error details and automatically retry when timer expires
  - retry-after > 600 seconds => show error page or dialog (no automatic retry)
- If no retry-after header or custom backend guidance, fallback to reasonable retry/backoff policies.

LANGUAGE: JavaScript
CODE:
```javascript
// Pseudocode: handle 503 and retry-after header
function handle503(response) {
  const retryAfter = parseInt(response.headers.get('retry-after'), 10);
  if (isNaN(retryAfter)) {
    showErrorPage();
    return;
  }
  if (retryAfter < 5) {
    showBusyIndicator();
  } else if (retryAfter <= 600) {
    showDialogWithAutoRetry(response, retryAfter); // start timer and retry after expiry
  } else {
    showErrorPage(); // or show dialog without auto-retry
  }
}
```

STEP: 8 — Message Popover: Details & Navigation
DESCRIPTION: Implement message popover UI features:
- Components: filter by severity, group names (table/section), short description, subtitle, chevron navigation to long text/details.
- If back-end provides long text, enable navigation from popover to a detailed pane/dialog showing technical details.
- Support navigation from message item to the exact UI control where the error/warning occurs.

LANGUAGE: None
CODE:
```text
(No code — UI component feature checklist for frontend implementers)
```

STEP: 9 — Using Status Message Strip on Object Page (ObjectPage.ExtensionAPI)
DESCRIPTION: Show or hide an object-level status message strip derived from message criticality. Use the ObjectPage.ExtensionAPI to programmatically show/hide or override the message strip. See API reference for exact method signature: https://ui5.sap.com/#/api/sap.fe.templates.ObjectPage.ExtensionAPI/methods/showMessages
- Implementation notes:
  - The message strip should be used only for object-level messages (not child entity messages or field-level issues).
  - Color depends on message criticality.
  - Prefer invoking the ExtensionAPI from controller extensions when you need to hide/show or display a custom message.

LANGUAGE: JavaScript
CODE:
```javascript
// Example pattern (consult API reference for exact parameters)
// within an ObjectPage controller extension
onAfterBinding() {
  const extAPI = this.extensionAPI;
  // Example placeholder: showMessages parameters vary by API version — check the UI5 docs link
  // extAPI.showMessages({ /* pass messages or show/hide flags per API */ });
}
```

STEP: 10 — Implementation Checklist for Backend & Frontend
DESCRIPTION: Quick actionable checklist to implement consistent message handling across backend and UI:
- Backend:
  - Return state messages in complex type body as SAP__Messages for OData V4.
  - Persist state messages when they refer to instance state.
  - Return transition messages for transient, operation-specific feedback.
  - Provide long text and technical metadata when available (status code, component ID, timestamps).
  - Provide Retry-After header for 503 scenarios.
- Service Metadata / Annotations:
  - Annotate side effects (TargetProperties includes SAP__Messages) for properties/operations that change messages.
  - Optionally add a side effect with SourceEntities to always read SAP__Messages.
- Frontend:
  - Map bound messages to message popover (edit mode) and message dialog/toast (display mode/list report).
  - Implement navigation from messages to UI controls.
  - Prompt and allow retry for 412 messages.
  - Use Retry-After header logic for 503 responses (busy indicator / dialog / error page).
  - Use ObjectPage.ExtensionAPI to show/hide object-level message strip.

LANGUAGE: None
CODE:
```text
(Implementation checklist — follow items above)
```
--------------------------------

**TITLE**: Using SAP Fiori Elements Floorplans — quick manifest examples

**INTRODUCTION**: Short reference for implementing SAP Fiori Elements floorplans (List Report + Object Page, Analytical List Page, Overview Page, Worklist). Includes minimal manifest.json snippets and file/link references to integrate each floorplan into a Fiori Elements app. Use these snippets as starting points and adapt entitySet, dataSource, and settings to your OData service and app requirements.

**TAGS**: fiori-elements-framework, floorplans, manifest.json, list-report, object-page, analytical-list-page, overview-page, worklist, sap.ovp, sap.ui.generic.app

STEP: 1 — List Report and Object Page (manifest.json integration)

DESCRIPTION: Configure a combined List Report and Object Page floorplan in the application descriptor (manifest.json). Define the OData data source, bind it to the default model, and declare pages under "sap.ui.generic.app" with the ListReport and ObjectPage template component names. Replace entitySet and dataSource.uri with your service values. See detailed docs: list-report-and-object-page-c0eec49.md. Reference images: images/Using_SAP_Fiori_Elements_Floorplans_List_Report_3e93d0e.png and images/Using_SAP_Fiori_Elements_Floorplans_Object_Page_563b849.png

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "id": "com.example.fiori.listobject",
    "type": "application",
    "applicationVersion": { "version": "1.0.0" },
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/ZSERVICE_SRV/",
        "type": "OData",
        "settings": { "odataVersion": "2.0" }
      }
    }
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport"
        }
      },
      {
        "entitySet": "Products",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      }
    ]
  }
}
```

STEP: 2 — Analytical List Page (ALP) manifest snippet

DESCRIPTION: Configure an Analytical List Page in manifest.json. Use the AnalyticalListPage template component and bind to the OData entity set that provides measures and dimensions for charts, KPIs, and table content. Replace entitySet and dataSource as needed. See docs: analytical-list-page-3d33684.md. Reference image: images/Using_SAP_Fiori_Elements_Floorplans_Analytical_List_Page_897c8d0.png

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "id": "com.example.fiori.alp",
    "type": "application",
    "applicationVersion": { "version": "1.0.0" },
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/ZSERVICE_SRV/",
        "type": "OData",
        "settings": { "odataVersion": "2.0" }
      }
    }
  },
  "sap.ui5": {
    "models": {
      "": { "dataSource": "mainService" }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "AnalyticsEntitySet",
        "component": {
          "name": "sap.suite.ui.generic.template.AnalyticalListPage"
        }
      }
    ]
  }
}
```

STEP: 3 — Overview Page (OVP) manifest snippet

DESCRIPTION: Configure an Overview Page (OVP) using the "sap.ovp" section in manifest.json. Define cards and map them to an entitySet or annotation-based cards. Use the mainService model or other configured models. See docs: overview-pages-c64ef8c.md. Reference image: images/Using_SAP_Fiori_Elements_Floorplans_Overview_Page_e83a616.png

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "id": "com.example.fiori.ovp",
    "type": "application",
    "applicationVersion": { "version": "1.0.0" },
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/ZSERVICE_SRV/",
        "type": "OData",
        "settings": { "odataVersion": "2.0" }
      }
    }
  },
  "sap.ui5": {
    "models": {
      "": { "dataSource": "mainService" }
    }
  },
  "sap.ovp": {
    "cards": {
      "salesOverviewCard": {
        "model": "mainService",
        "settings": {
          "entitySet": "SalesSet",
          "cardType": "List"
        }
      },
      "kpiCard": {
        "model": "mainService",
        "settings": {
          "entitySet": "KPISet",
          "cardType": "KPI"
        }
      }
    }
  }
}
```

STEP: 4 — Worklist floorplan guidance + minimal manifest example

DESCRIPTION: A Worklist displays items for user processing and typically requires a simple list without advanced filtering. Configure a pages entry for the Worklist-like list. If you use a generic template, the ListReport template can be adapted for simple worklist scenarios; otherwise implement a custom view/controller. See docs: worklist-d1d588f.md. Reference image: images/Using_SAP_Fiori_Elements_Floorplans_Worklist_0393ce6.png

LANGUAGE: JSON

CODE:
```json
{
  "sap.app": {
    "id": "com.example.fiori.worklist",
    "type": "application",
    "applicationVersion": { "version": "1.0.0" },
    "dataSources": {
      "mainService": {
        "uri": "/sap/opu/odata/sap/ZSERVICE_SRV/",
        "type": "OData",
        "settings": { "odataVersion": "2.0" }
      }
    }
  },
  "sap.ui5": {
    "models": {
      "": { "dataSource": "mainService" }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "WorkItems",
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport"
        }
      }
    ]
  }
}
```

STEP: 5 — General references and next steps

DESCRIPTION: Additional general information and references:
- How to use generic Fiori Elements configuration and annotation-driven behavior: how-to-use-sap-fiori-elements-20de950.md
- Check SAPUI5 version and maintenance status: https://ui5.sap.com/versionoverview.html
- Use the above manifest snippets as starting points; extend with UI annotations, routing, navigation, and view-level configurations per your app requirements.
LANGUAGE: TEXT

CODE:
```text
Relevant files/links:
- List Report & Object Page doc: list-report-and-object-page-c0eec49.md
- Analytical List Page doc: analytical-list-page-3d33684.md
- Overview Pages doc: overview-pages-c64ef8c.md
- Worklist doc: worklist-d1d588f.md
- How to use Fiori Elements: how-to-use-sap-fiori-elements-20de950.md
- SAPUI5 Versions Maintenance Status: https://ui5.sap.com/versionoverview.html

Images referenced in docs:
- images/Using_SAP_Fiori_Elements_Floorplans_List_Report_3e93d0e.png
- images/Using_SAP_Fiori_Elements_Floorplans_Object_Page_563b849.png
- images/Using_SAP_Fiori_Elements_Floorplans_Analytical_List_Page_897c8d0.png
- images/Using_SAP_Fiori_Elements_Floorplans_Overview_Page_e83a616.png
- images/Using_SAP_Fiori_Elements_Floorplans_Worklist_0393ce6.png
```
--------------------------------

**TITLE**: Application Preview Generator — Setup and Use (Fiori elements, ABAP projects)

**INTRODUCTION**: Step-by-step, code-focused guide to enable and use the Application Preview Generator for Fiori elements object pages (ABAP-based projects). Covers required project configuration (ui5.yaml), install commands, how to launch the generator, where generated files appear, manifest updates, overwrite behavior, and the configurable features available in the generator dialog.

**TAGS**: fiori-elements, ui5, cards, cards-editor, application-preview, ABAP, ui5.yaml, manifest.json, webapp/cards

STEP: Restriction and behavior
DESCRIPTION: Key restrictions and default behavior to keep in mind before enabling or using the generator.
LANGUAGE: text
CODE:
```text
- Restriction: Application preview cards can only be generated for object pages.
- Restriction: The Application Preview Generator is available only for ABAP-based projects.
- Note: Integration cards are displayed by default in the UI; an adaptive card is always generated alongside the integration card (you may choose which to display).
```

STEP: Prerequisites
DESCRIPTION: Ensure the project is cloned in SAP Business Application Studio and compatible with UI5 CLI v3. If not compatible, migrate the project so it can run in Business Application Studio.
LANGUAGE: text
CODE:
```text
Prerequisite checklist:
1. Project cloned into SAP Business Application Studio.
2. Project compatible with UI5 CLI v3 (migrate if necessary).
   - Migrate docs: https://ui5.github.io/cli/v3/updates/migrate-v3/
   - Migration guide: https://community.sap.com/t5/technology-blogs-by-sap/migrate-sap-fiori-projects-from-sap-web-ide-to-sap-business-application/ba-p/13544987
```

STEP: Configure ui5.yaml to use latest SAP UI5 resources
DESCRIPTION: Ensure the project uses the public SAP UI5 CDN by setting url: https://ui5.sap.com. Add or verify the server.customMiddleware.fiori-tools-proxy.ui5.url entry in ui5.yaml.
LANGUAGE: YAML
CODE:
```yaml
specVersion: "3.1"
metadata:
  name: sales-order.wd.sample
type: application
resources:
  configuration:
    paths:
      webapp: webapp
server:
  customMiddleware:
  - name: fiori-tools-proxy
    afterMiddleware: compression
    configuration:
      ignoreCertError: false
      ui5:
        path:
        - /resources
        - /test-resources
        url: https://ui5.sap.com
  - name: sap-fe-mockserver
    mountPath: /
    afterMiddleware: compression
    configuration:
      annotations:
      - localPath: './mockserver/sap/opu/odata/sap/salesorder/annotations.xml'
        urlPath: '/sap/opu/odata/sap/salesorder;v=2/Annotations*'
      services:
      - urlPath: '/sap/opu/odata/sap/salesorder'
        metadataPath: './mockserver/sap/opu/odata/sap/salesorder/metadata.xml'
        mockdataPath: './mockserver/sap/opu/odata/sap/salesorder/data/'
```

STEP: Install the cards editor (add generator)
DESCRIPTION: From a terminal at the project location, add the cards-editor tool using one of the following installer commands (choose one).
LANGUAGE: Shell
CODE:
```sh
# Option 1 (npx)
npx @sap-ux/create@latest add cards-editor

# Option 2 (npm init)
npm init @sap-ux@latest add cards-editor
```

STEP: Launch the cards generator locally
DESCRIPTION: Start the cards generator server and open the app. From a list report landing page, navigate (use filters/search) to the target object page. From the object page, open the user menu and choose "Generate Card" to open the card generator dialog.
LANGUAGE: Shell
CODE:
```sh
# Start the cards generator (run in project root)
npm run start-cards-generator
```

STEP: Use the Card Generator dialog (UI actions)
DESCRIPTION: Fill in fields in the dialog to compose an integration card and its adaptive card. A live preview of both cards appears. When finished, choose Save. (If the landing page is a list report, navigate to the object page first.)
LANGUAGE: text
CODE:
```text
UI steps:
1. Open project in browser via npm run start-cards-generator.
2. Navigate to the object page for which you want a card (apply filters/search if needed).
3. Open the user menu → Generate Card.
4. Fill Card Header, Card Content, Card Actions, Advanced settings as needed.
5. Observe live previews for Integration Card (left) and Adaptive Card (right).
6. Click Save to generate card files into the repository.
```

STEP: Resulting files and manifest update
DESCRIPTION: Saving the card creates a new 'cards' folder under webapp and updates manifest.json to link the card to the object page. Example manifest section shown below. Generated card files are placed under webapp/cards/op/<CardId>.
LANGUAGE: JSON
CODE:
```json
// Example manifest.json snippet added/updated automatically
"sap.cards.ap": {
  "embeds": {
    "ObjectPage": {
      "default": "C_STTA_SalesOrder_WD_20",
      "manifests": {
        "C_STTA_SalesOrder_WD_20": [
          {
            "localUri": "cards/op/C_STTA_SalesOrder_WD_20"
          }
        ]
      }
    }
  }
}
```

STEP: Generated file locations
DESCRIPTION: Files created by Save:
LANGUAGE: text
CODE:
```text
- Webapp cards folder:
  webapp/cards/
    op/
      C_STTA_SalesOrder_WD_20/    <-- example card folder
        (integration card files, adaptive card files, metadata)

- CSS reference for rendered cards (if required by your project):
  <link rel="stylesheet" type="text/css" href="../css/sap-icons.css"/>
```

STEP: Overwrite behavior and repository update
DESCRIPTION: Regenerating a card for the same object page overwrites the previously generated card. After adding or updating cards, commit and merge all changed files back to the project repository to persist changes.
LANGUAGE: text
CODE:
```text
- Regeneration: Re-running the generator for the same ObjectPage will overwrite files under webapp/cards/op/<CardId>.
- Repository: Review, commit, and merge all changed files (including webapp/cards and manifest.json) into your project repository.
```

STEP: Card Generator dialog — actionable feature summary
DESCRIPTION: Concise, code-focused listing of dialog features and what they control so code generation tools can map UI selections into card definitions or metadata edits.
LANGUAGE: text
CODE:
```text
Card Header:
- Configure title, subtitle, and main indicator (single headline values).

Card Content:
- Add properties grouped into sections.
- Edit labels and property formatting (display label overrides).
- Control which entity properties appear in the card body.

Card Actions:
- Add import-based actions as footer actions on the adaptive card (executable from Teams or similar hosts).
- Actions are mapped into adaptive card action payloads (ensure action target metadata is available in the card's manifest or folder).

Advanced Panel:
- Apply criticality assignments (e.g., Negative/Positive/Critical/Neutral).
- Apply units of measure to number/string properties.
- Apply text arrangement settings for property display.
- These options become global property configuration for how the property is rendered anywhere in this card.

More (per-property additional options):
- Apply Units of Measure: for string or number properties.
- Apply Formatter:
  - Date Type: format date/time or date only; enable/disable UTC; optional relative formatting.
  - Number Type: format as Float, Currency, Percent, or Integer.
- Apply Criticality: map property values to criticality statuses.
- Apply Trend: for string or number properties (trend icons/indicators).
- Apply Indicators: for string or number properties (icons/semantic statuses).

Notes:
- Use these dialog settings to produce the card's local manifest and card payload files under webapp/cards/op/<CardId>.
- The adaptive card is always generated; you can choose at runtime which card type to display.
```


--------------------------------

**TITLE**: Enable Condensed Table Layout for Grid Tables in Fiori Elements (List Report & Object Page)

**INTRODUCTION**: This document shows exact manifest/descriptor edits to enable the condensed table layout for sap.ui.table (GridTable) in SAP Fiori Elements applications (OData V2 and V4). It includes actionable JSON snippets for Object Page and List Report scenarios and the required constraints you must validate before enabling the feature.

**TAGS**: fiori-elements-framework, sapui5, condensed, table-layout, manifest.json, object-page, list-report, grid-table, sap.ui.table, sap.m.table, controlConfiguration

**STEP**: Prerequisites and rules (validate before changes)

**DESCRIPTION**: Confirm these constraints before enabling condensedTableLayout:
- Applies only to grid tables (sap.ui.table). Not supported for responsive tables (sap.m.Table).
- The application must run in compact mode (content density = "compact"). If the app runs in cozy mode, the condensed class will not be applied even if the manifest key is true.
- Object Page restriction: condensedTableLayout will be applied only if either:
  - There is exactly one section that contains a grid table (sap.ui.table), or
  - The Object Page uses an icon tab bar for navigation and each section contains just one table. Otherwise the class is not applied.

**LANGUAGE**: text

**CODE**:
```text
Prerequisites:
- Table control must be GridTable (sap.ui.table).
- App must run in compact mode.
- Object Page: single-section-with-grid-table OR icon-tab-bar + each section contains only one table.
```

**STEP**: Enable condensed layout for Object Page (OData V2 - manifest.json)

**DESCRIPTION**: Add the condensedTableLayout flag to the specific section definition in the sap.ui.generic.app pages configuration. Place this in webapp/manifest.json under "sap.ui.generic.app" -> "pages". The example below sets condensedTableLayout for the LineItem section "to_ProductText::com.sap.vocabularies.UI.v1.LineItem" on the STTA_C_MP_Product object page.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ObjectPage|STTA_C_MP_Product": {
        "entitySet": "STTA_C_MP_Product",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage",
          "settings": {
            "sections": {
              "to_ProductText::com.sap.vocabularies.UI.v1.LineItem": {
                "condensedTableLayout": true
              }
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Enable condensed layout for Object Page (OData V4 - component/manifest snippet)

**DESCRIPTION**: For Fiori Elements OData V4, set condensedTableLayout for the LineItem control via controlConfiguration/tableSettings. Add this in the component descriptor or manifest.json used by the FE application (example shown as a component entry). This targets the LineItem vocabulary entry and forces GridTable with condensed layout.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "id": "SalesOrderManageObjectPage",
  "name": "sap.fe.templates.ObjectPage",
  "type": "Component",
  "options": {
    "settings": {
      "contextPath": "/SalesOrderManage",
      "controlConfiguration": {
        "_Item/@com.sap.vocabularies.UI.v1.LineItem": {
          "tableSettings": {
            "type": "GridTable",
            "condensedTableLayout": true
          }
        }
      }
    }
  }
}
```

**STEP**: Enable condensed layout for List Report (example manifest.json)

**DESCRIPTION**: For a List Report page, add condensedTableLayout where the table settings are configured for the ListReport page. Ensure the table "type" is GridTable (sap.ui.table). Place this under webapp/manifest.json -> "sap.ui.generic.app" -> "pages".

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui.generic.app": {
    "pages": {
      "ListReport|SalesOrder": {
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport",
          "settings": {
            "tableSettings": {
              "type": "GridTable",
              "condensedTableLayout": true
            }
          }
        }
      }
    }
  }
}
```

**STEP**: Validation checklist after changes

**DESCRIPTION**: After updating manifest/descriptor:
- Build and run the app in compact mode and verify the grid table uses condensed spacing.
- Confirm no effect occurs for sap.m.Table or when app is in cozy mode.
- For Object Page cases with multiple sections/tables, verify the class is applied only when the object-page constraints are satisfied.

**LANGUAGE**: text

**CODE**:
```text
Validation checklist:
- Run app in compact mode and verify condensed spacing on sap.ui.table.
- Confirm no change for sap.m.Table instances.
- On Object Page: if multiple sections/tables exist, verify whether the condensed class is applied per the constraints.
```
--------------------------------

**TITLE**: Using the Export Button in SAP Fiori elements (OData V4)

**INTRODUCTION**: This document shows how to enable/disable the Export button, configure export behavior for spreadsheets, configure export-related column settings in the manifest, enable PDF export via service annotations, and set the export request size limit. Use these manifest and annotation snippets directly in your application configuration and OData annotation files.

**TAGS**: fiori-elements-framework, OData V4, export, manifest.json, controlConfiguration, tableSettings, exportSettings, PDF, exportRequestSize

STEP: 1 — Enable / Disable Export for a Page (manifest.json)

DESCRIPTION: Use the controlConfiguration entry for the LineItem annotation to enable or disable the Export button for specific pages (List Report or Object Page). Place these snippets in the relevant target's options.settings.controlConfiguration section of manifest.json.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "enableExport": false
                  }
                }
              }
            }
          }
        },
        "SalesOrderManageObjectPage": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "enableExport": true
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```

STEP: 2 — Export Menu and "Export As..." Options (behavior summary)

DESCRIPTION: The Export icon triggers default export. The drop-down "Export As..." opens a dialog with options:
- Split cells with multiple values: exports one column per value (cases: amount+unit, price+currency, code+text when Text annotation exists, DataPoint target value, FieldGroup members, custom column properties).
- Include filter settings: adds current filter as a separate sheet.

LANGUAGE: Text

CODE:
```text
Export actions:
- Export: start export with default settings.
- Export As...:
  - splitCellsWithMultipleValues (true/false): expand multi-values into separate columns.
  - includeFilterSettings (true/false): add current filters on a second sheet.
```

STEP: 3 — Configure Column Export Behavior (manifest.json -> controlConfiguration -> columns)

DESCRIPTION: Use the columns.{key}.exportSettings object to configure how each column exports. Available properties include: type (sap.ui.export.EdmType), property (string or array), template (indexed placeholders), width (characters), wrap (boolean), label, textAlign (Left, Right, Center, Begin, End), trueValue, falseValue, valueMap (for Enumeration). To exclude a column from export, use disableExport: true. Configure export file/sheet names in tableSettings via exportFileName and exportSheetName (max 31 chars).

LANGUAGE: JSON

CODE:
```json
{
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.LineItem": {
      "tableSettings": {
        "personalization": true,
        "exportFileName": "SalesOrdersExport",         // max 31 chars (truncated if longer)
        "exportSheetName": "OrdersSheet",              // max 31 chars (truncated if longer)
        "enableExport": true
      },
      "columns": {
        "DataField::Shipping": {
          "exportSettings": {
            "template": "{0}",
            "width": "5",
            "type": "Enumeration",
            "label": "Shipping Method",
            "textAlign": "Center",
            "valueMap": {
              "A": "Standard Shipping",
              "B": "Premium Shipping",
              "C": "Express Shipping"
            }
          }
        },
        "DataField::Delivered": {
          "exportSettings": {
            "template": "{0}",
            "width": "5",
            "type": "Boolean",
            "textAlign": "Right",
            "trueValue": "Yes",
            "falseValue": "No"
          }
        },
        "DataField::SensitiveColumn": {
          "disableExport": true
        },
        "CustomColumnSorting": {
          "header": "{i18n>LRCustomColumnSorting}",
          "template": "SalesOrder.custom.CustomColumn.CustomColumnSorting",
          "properties": [
            "ID",
            "TotalNetAmount",
            "_CustomerPaymentTerms/CustomerPaymentTerms",
            "_ShipToParty/BusinessPartner"
          ],
          "exportSettings": {
            "property": [
              "ID",
              "TotalNetAmount"
            ],
            "template": "{0} {1}",
            "type": "String",
            "width": "50",
            "wrap": true
          }
        }
      }
    }
  }
}
```

STEP: 4 — Restrictions & Security Notes (text)

DESCRIPTION: Important restrictions and security considerations to keep in mind when enabling export.

LANGUAGE: Text

CODE:
```text
Restrictions:
- Columns with DataFieldForAnnotation pointing to Charts or DataFieldForAction export empty.
- Not exported: multi-input (1:n) columns, stream media, binary media.
- Columns with dynamic UI.Hidden expressions are still exported.
- Numbers >15 digits are rounded due to JavaScript limits.
Security:
- If data is annotated as PersonalData.IsPotentiallySensitive, consider disabling export (enableExport: false) to avoid uncontrolled data export.
```

STEP: 5 — Enable Export to PDF (service-level annotations)

DESCRIPTION: To allow exporting tables to PDF, update the OData service annotations to include application/pdf in SupportedFormats and add the com.sap.vocabularies.PDF.v1.Feature annotation. Add these in your service metadata or annotation file.

LANGUAGE: XML

CODE:
```xml
<!-- Example service-level annotations (annotations.xml) -->
<Annotations Target="YourService.YourEntityContainer">
  <Annotation Term="Org.OData.Capabilities.V1.SupportedFormats">
    <Collection>
      <String>application/json</String>
      <String>application/pdf</String>
    </Collection>
  </Annotation>

  <!-- com.sap.vocabularies.PDF.v1.Feature: add feature configuration according to the PDF vocabulary -->
  <Annotation Term="com.sap.vocabularies.PDF.v1.Feature">
    <Record>
      <!-- Example properties (refer to the PDF vocabulary for details) -->
      <PropertyValue Property="Title">
        <String>ExportedReport</String>
      </PropertyValue>
      <PropertyValue Property="Layout">
        <String>Portrait</String>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

STEP: 6 — Configure the Maximum Number of Records Per Export Request (exportRequestSize)

DESCRIPTION: Set exportRequestSize in tableSettings to control how many records are fetched per request during export. Default is 1000 for responsive and grid tables. Analytical and tree tables default to none. Tune based on data shape and performance.

LANGUAGE: JSON

CODE:
```json
{
  "sap.ui5": {
    "routing": {
      "targets": {
        "SalesOrderManageList": {
          "options": {
            "settings": {
              "controlConfiguration": {
                "@com.sap.vocabularies.UI.v1.LineItem": {
                  "tableSettings": {
                    "exportRequestSize": 3000
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}
```
--------------------------------

**TITLE**: Using the extensionAPI in SAP Fiori Elements (OData V2 & V4)

**INTRODUCTION**: This document shows how to access and use the template-provided extensionAPI from controller extensions for List Report, Object Page and Analytical List Page (OData V2 and OData V4). It includes the required precautions, mappings to runtime ExtensionAPI objects, a sample onAfterActivate handler, and concrete invokeActions usage examples (contexts, URL parameters, settings and promise handling).

**TAGS**: fiori-elements-framework, extensionAPI, sapui5, ODataV2, ODataV4, ListReport, ObjectPage, AnalyticalListPage, invokeActions, ExtensionAPI

**STEP**: 1 — Overview and constraints

**DESCRIPTION**: Summary of allowed public usage and important restrictions when using extensionAPI from controller extensions.

**LANGUAGE**: Text

**CODE**:
```text
- Allowed: Use public methods of sap.ui.core.mvc.Controller inside extension hook implementations.
- Not allowed: Access or manipulate framework-internal controls, properties, models or any controller members considered private (names starting with '_').
- Do not create instances of classes in the namespace sap.suite.ui.generic.template — those classes are not public.
- Do not rely on the exact class names of ExtensionAPI implementations; rely on the methods they expose.
```

**STEP**: 2 — Runtime ExtensionAPI objects (mapping)

**DESCRIPTION**: Runtime ExtensionAPI objects you will get from the controller for each template (OData V2 and OData V4). Use these objects to call template services and helper methods.

**LANGUAGE**: Text

**CODE**:
```text
OData V2 template runtime instances (access via controller.extensionAPI):
- List Report:      sap.suite.ui.generic.template.ListReport.extensionAPI.ExtensionAPI
- Object Page:      sap.suite.ui.generic.template.ObjectPage.extensionAPI.ExtensionAPI
- Analytical List:  sap.suite.ui.generic.template.AnalyticalListPage.extensionAPI.ExtensionAPI

OData V4 template runtime instances (access via controller.getExtensionAPI()):
- List Report:      sap.fe.templates.ListReport.ExtensionAPI
- Object Page:      sap.fe.templates.ObjectPage.ExtensionAPI

Note: Do not depend on these class names in your code; prefer method contracts.
```

**STEP**: 3 — Accessing the ExtensionAPI from a controller (examples)

**DESCRIPTION**: How to obtain the ExtensionAPI in your controller extension for OData V2 (legacy) and OData V4 templates.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
// OData V2 templates (ListReport/ObjectPage/AnalyticalListPage)
onInit: function () {
    // Within controller methods you can use:
    var oExtensionAPI = this.extensionAPI;
    // Example: call a method (if available)
    // oExtensionAPI.someMethod(...);
}

// OData V4 templates (fe templates)
onInit: function () {
    // getExtensionAPI() returns the template-specific ExtensionAPI instance
    var oExtensionAPI = this.getExtensionAPI();
    // Example: call a method (if available)
    // oExtensionAPI.someMethod(...);
}
```

**STEP**: 4 — Sample: onAfterActivate handler (send email after successful activation)

**DESCRIPTION**: Full runnable sample of an onAfterActivate event handler that sends an email when the activated entity has Price > 1000. The handler waits for backend confirmation via the activationPromise.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
(function() {
    "use strict";

    // Example controller extension or standalone handler function
    function onAfterActivate(oEvent) {
        /*
         * AfterActivate event contains activationPromise which resolves after successful back-end activation.
         * Use the resolved response to access returned data.
         */
        oEvent.activationPromise.then(function(oResponse) {
            var oData = oResponse && oResponse.data;
            if (oData && oData.Price > 1000) {
                // Use SAPUI5 URLHelper to generate mail client call
                sap.m.URLHelper.triggerEmail(
                    null,
                    "critical price change",
                    "changed price of " + oData.Product_Text + " to " + oData.Price + " " + oData.Currency
                );
            }
        }).catch(function(oError) {
            // Optional: handle activation error
            /* eslint-disable no-console */
            console.error("Activation failed or promise rejected", oError);
            /* eslint-enable no-console */
        });
    }

    // Export or attach this handler as needed inside your controller extension
    // Example: return { onAfterActivate: onAfterActivate } in an extension file
})();
```

**STEP**: 5 — invokeActions: signature, behaviors and examples

**DESCRIPTION**: Description of invokeActions parameters, behavior (invokes actions, groups change sets, submits changes) and example calls with single context, multiple contexts, URL params and settings. Always handle returned Promise and errors.

**LANGUAGE**: JavaScript

**CODE**:
```javascript
/* Signature (conceptual)
 * extensionAPI.invokeActions(sFunctionName, vContext, mUrlParameters?, oSettings?)
 *
 * Parameters:
 *  - sFunctionName: string  => name of the function/action to call (function import/action)
 *  - vContext: array|sap.ui.model.Context  => binding context or array of contexts
 *  - mUrlParameters: map (optional) => URL parameters (name-value pairs) for the action
 *  - oSettings: object (optional) => additional settings
 *      - oSettings.bInvocationGroupingChangeSet: boolean => true/false for grouping changesets
 *
 * Returns:
 *  - Promise resolving to the action results; rejects on error (e.g., function does not exist or input invalid)
 */

// Example: single context, no URL params, default settings
this.extensionAPI.invokeActions("SomeAction", oBindingContext)
    .then(function(aResults) {
        // handle success
    })
    .catch(function(oError) {
        // handle error (e.g., missing function import or invalid parameters)
    });

// Example: multiple contexts (array), with URL parameters and custom settings
var aContexts = [oCtx1, oCtx2];
var mUrlParameters = { param1: "value1", param2: "value2" };
var oSettings = { bInvocationGroupingChangeSet: true };

this.extensionAPI.invokeActions("SomeAction", aContexts, mUrlParameters, oSettings)
    .then(function(aResults) {
        // Results for each invocation
    })
    .catch(function(oError) {
        // Error handling
    });
```

**STEP**: 6 — Best practices and error scenarios

**DESCRIPTION**: Actionable rules to follow and common error cases to guard for in code.

**LANGUAGE**: Text

**CODE**:
```text
- Do not call or construct classes in sap.suite.ui.generic.template; those are internal.
- Do not access controller private members (properties/methods prefixed with '_').
- Always handle the Promise returned by invokeActions() and activationPromise to detect backend errors.
- invokeActions throws/rejects if:
  * The OData function import/action does not exist,
  * Provided action input parameters are invalid.
- Prefer method-based usage of ExtensionAPI rather than depending on concrete runtime class names.
```
--------------------------------

**TITLE**: Multi-Input Field on the Object Page — Implementation Examples and Annotations

**INTRODUCTION**: Practical, code-focused examples and annotation snippets to enable and configure the multi-input field on an Object Page in SAP Fiori Elements. Shows how to define the required 1:n association in the data model, reference the navigation property in UI annotations, configure field control and capabilities, bind the UI5 MultiInput to a JSON model, and important constraints to observe.

**TAGS**: fiori-elements, multi-input, navigation-property, annotations, ABAP-CDS, CAP-CDS, OData-V4, UI5, FieldControl, Capabilities

**STEP**: 1 — Define a 1:n association in the data model (ABAP CDS)
**DESCRIPTION**: Create a one-to-many navigation/composition association in an ABAP CDS view. The presence of a 1:n navigation property causes the UI to render a multi-input field for that DataField on the object page.
**LANGUAGE**: ABAP CDS
**CODE**:
```ABAP CDS
composition [0..*] of SupportedMaterial as _SupportedMaterials
```

**STEP**: 2 — Define a 1:n association in the data model (CAP CDS)
**DESCRIPTION**: Create a Composition of many association in CAP CDS. This creates the navigation property used by the UI annotations to display multiple values.
**LANGUAGE**: CAP CDS
**CODE**:
```CAP CDS
_SupportedMaterials : Composition of many SupportedMaterial on _SupportedMaterials.owner = $self;
```

**STEP**: 3 — Reference the navigation property in a UI LineItem (XML Annotation)
**DESCRIPTION**: Use the navigation property inside a UI.DataField to display the property (for example "Material") of each associated SupportedMaterial. This example shows a LineItem annotation that references the navigation property.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.LineItem">
  <Collection>
    <Record Type="UI.DataField">
      <PropertyValue Property="Value" Path="_SupportedMaterials/Material" />
    </Record>
  </Collection>
</Annotation>
```

**STEP**: 4 — UI: ABAP CDS UI annotation examples (LineItem and FieldGroup)
**DESCRIPTION**: ABAP CDS UI annotation examples that reference the navigation property value for LineItem and FieldGroup. Use these within your CDS view UI annotations.
**LANGUAGE**: ABAP CDS
**CODE**:
```ABAP CDS
@UI: { lineItem: [ { value: '_SupportedMaterials.Material', label: 'Supported Materials' } ] }  
@UI.fieldGroup: [{ position: 10, qualifier: 'FieldgroupID', value: '_SupportedMaterials.Material' } ]
_SupportedMaterials;
```

**STEP**: 5 — UI: CAP CDS annotation example for DataField (LineItem)
**DESCRIPTION**: CAP-style UI annotation for a LineItem that uses a UI.DataField and references the navigation property's property value.
**LANGUAGE**: CAP CDS
**CODE**:
```CAP CDS
LineItem : {
  {
    $Type  : 'UI.DataField',
    Label  : 'Supported Materials',
    Value  : _SupportedMaterials.Material,
  },
  …
}
```

**STEP**: 6 — Mark the field Mandatory / ReadOnly using Common.FieldControl (XML FieldGroup)
**DESCRIPTION**: Use Common.FieldControl to make the multi-input mandatory or read-only in the UI (no backend validation is performed automatically — backend checks required). Example shows a FieldGroup with a DataField and a Common.FieldControl = Mandatory.
**LANGUAGE**: XML
**CODE**:
```xml
<Annotation Term="UI.FieldGroup" Qualifier="AdditionalInformation">
  <Record Type="UI.FieldGroupType">
    <PropertyValue Property="Data">
      <Collection>
        <Record Type="UI.DataField">
          <PropertyValue Property="Value" Path="ToItemAvailableColors/ColorName" />
          <Annotation Term="Common.FieldControl" EnumMember="Common.FieldControlType/Mandatory" />
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

**STEP**: 7 — CAP CDS: Mark field Mandatory using CAP syntax
**DESCRIPTION**: CAP CDS annotate snippet showing how to mark a DataField as Mandatory using the CAP UI annotation syntax.
**LANGUAGE**: CAP CDS
**CODE**:
```CAP CDS
annotate RootElement with @UI: {
  FieldGroup #GeneralInformation: {
    Label: 'General Information',
    Data : [
      { Value: ID },
      {
        $Type : 'UI.DataField',
        Value : PropWithUnit,
        ![@Common.FieldControl]: #Mandatory
      }
    ]
  }
};
```

**STEP**: 8 — OData V4: Configure Capabilities.InsertRestrictions and Capabilities.DeleteRestrictions
**DESCRIPTION**: Use OData V4 Capabilities annotations to control whether the navigation/property values can be inserted or deleted by the UI. Apply these annotations to the navigation property or property in local XML annotations.
**LANGUAGE**: XML
**CODE**:
```xml
<!-- Prevent inserts on the navigation property -->
<Annotation Term="Capabilities.InsertRestrictions">
  <Record>
    <PropertyValue Property="Insertable" Bool="false" />
  </Record>
</Annotation>

<!-- Prevent deletes on the navigation property -->
<Annotation Term="Capabilities.DeleteRestrictions">
  <Record>
    <PropertyValue Property="Deletable" Bool="false" />
  </Record>
</Annotation>
```

**STEP**: 9 — Bind a UI5 MultiInput control to a JSON model (UI5 XML view)
**DESCRIPTION**: Example showing a minimal SAPUI5 MultiInput control bound to a JSON model array (selectedKeys). Use a value help or token template as required. This illustrates binding UI values to a client-side JSON model.
**LANGUAGE**: XML (SAPUI5 view)
**CODE**:
```xml
<mvc:View xmlns:mvc="sap.ui.core.mvc"
          xmlns:m="sap.m"
          controllerName="my.App.controller">
  <!-- MultiInput bound to JSON model path /selectedMaterials (array of keys) -->
  <m:MultiInput id="multiInput"
                selectedKeys="{/selectedMaterials}"
                showValueHelp="true"
                valueHelpRequest="onValueHelp" />
</mvc:View>
```

**STEP**: 10 — Notes, constraints and UI assets
**DESCRIPTION**: Important constraints, recommendations and references to UI assets:
- The multi-input field is activated automatically when the DataField has a 1:n navigation property.  
- Multi-input fields are supported only in draft-enabled applications.  
- If you need to display more than 100 selected values, use a table instead of a multi-input field.  
- Define a value help (value help annotation or UI pattern) on the target property to add/remove existing values from the multi-input.  
- The UI shows a red asterisk when Common.FieldControl = Mandatory, but the backend must enforce validation.  
- Images referenced in documentation: images/Multi-Input_Control_on_the_Object_Page_d756a5b.png and images/Smart_MultiInput_Control_on_the_Object_Page_Table_dcb027c.png  
- Live examples and additional UI patterns: Building Blocks - Field - Input Fields - Multi-Input Field: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/fieldMultiValueField
**LANGUAGE**: TEXT
**CODE**:
```text
- Multi-input is auto-activated for 1:n navigation properties.
- Only supported in draft-enabled apps.
- Use a table if >100 values need to be displayed.
- Backend validation required when using Common.FieldControl = Mandatory.
- Refer to the UI5 building blocks link for live MultiInput examples.
```
--------------------------------

**TITLE**: Using securedExecution in SAP Fiori elements extensions

**INTRODUCTION**: Practical, code-focused examples showing how to call extensionAPI.securedExecution from Fiori elements extension controllers (OData V2 and V4). Covers typical use cases, the required fnFunction pattern (must return a Promise and must not perform user interactions), handling the returned Promise, and the V4-specific updatesDocument option.

**TAGS**: fiori-elements, securedExecution, ExtensionAPI, ODataV2, ODataV4, async, dataloss, extension

**STEP**: 1 — Basic pattern (List Report / Object Page extension, JavaScript)
**DESCRIPTION**: Use securedExecution to wrap an asynchronous extension action. fnFunction must return a Promise and must not perform user interactions. The Promise returned by securedExecution is rejected if fnFunction is not executed (for example when user edits are unsaved or dataloss confirmation blocks execution). Handle success and failure with .then/.catch or async/await.
**LANGUAGE**: JavaScript
**CODE**:
```JavaScript
// File: webapp/extension/MyListReportExtension.controller.js
// This is a controller extension for a Fiori elements List Report (OData V2 or V4).
// Use this.extensionAPI.securedExecution to run async, potentially state-changing operations.
//
// Note: fnFunction must NOT perform user interactions (no MessageBox/Dialogs inside fnFunction).
// If fnFunction runs, securedExecution resolves/rejects like fnFunction's Promise.
// If fnFunction is NOT executed (e.g. because of unsaved edits), securedExecution rejects.

onMyCustomAction: function (oEvent) {
  // 'this.extensionAPI' is injected by the framework in controller extensions
  return this.extensionAPI.securedExecution(() => {
    // fnFunction: do async work here, return a Promise.
    // Example: call a backend service via a model, or perform any async logic.
    return new Promise((resolve, reject) => {
      // simulate async operation (replace with real model call)
      setTimeout(() => {
        // on success
        resolve("ok");
        // on error
        // reject(new Error("failed"));
      }, 1000);
    });
  }, {
    // optional params (framework-specific). Provide metadata if available.
    // For V2/V4 API differences check the official API docs:
    // V2: https://ui5.sap.com/#/api/sap.suite.ui.generic.template.ListReport.extensionAPI.ExtensionAPI/methods/securedExecution
    // V4: https://ui5.sap.com/#/api/sap.fe.core.controllerextensions.EditFlow/methods/securedExecution
  }).then(function (result) {
    // securedExecution resolved — fnFunction executed and resolved
    // safe to perform UI interactions here (e.g., show MessageToast)
    sap.m.MessageToast.show("Action completed: " + result);
  }).catch(function (err) {
    // securedExecution rejected — fnFunction was not executed or fnFunction failed
    console.error("securedExecution rejected", err);
    sap.m.MessageBox.error("Action could not be executed.");
  });
}
```

**STEP**: 2 — OData V4: Mark operation as document-updating (updatesDocument = true)
**DESCRIPTION**: When custom code changes the persistent state of an object in OData V4, set updatesDocument: true in the securedExecution options. This instructs the framework that the operation updates the document (important for navigation/draft handling).
**LANGUAGE**: JavaScript
**CODE**:
```JavaScript
// File: webapp/extension/MyObjectPageExtension.controller.js
onSaveCustomChanges: function () {
  return this.extensionAPI.securedExecution(async () => {
    // Example: submit pending changes via the default model on the view
    const oModel = this.getView().getModel();
    // ensure this returns a Promise
    await oModel.submitBatch
      ? oModel.submitBatch() // if model exposes batch submit
      : Promise.resolve(); // replace with real submit call for your app
    // return a value or nothing
    return "submitted";
  }, {
    updatesDocument: true // V4 only: indicates the operation updates the document
  }).then(function () {
    sap.m.MessageToast.show("Changes saved via securedExecution.");
  }).catch(function (err) {
    // Could be rejection because fnFunction was not executed (e.g., unsaved edits)
    console.error("Save failed or not executed", err);
  });
}
```

**STEP**: 3 — Do not perform user interactions inside fnFunction
**DESCRIPTION**: fnFunction must not trigger UI dialogs or other user interactions. If user interaction is required, do it outside securedExecution handlers (for example in the .then or .catch handlers after securedExecution completes).
**LANGUAGE**: JavaScript
**CODE**:
```JavaScript
// WRONG: Do NOT do this (inside fnFunction)
// This will break the contract: no user interaction inside fnFunction.
return this.extensionAPI.securedExecution(() => {
  // ❌ BAD: showing a dialog here is disallowed
  // sap.m.MessageBox.confirm("Confirm something", { ... });  // DO NOT do this
  return Promise.resolve();
});
```

**STEP**: 4 — Handle cases where fnFunction is not executed (common reasons)
**DESCRIPTION**: securedExecution may reject without executing fnFunction. Common reasons:
- unsaved user edits in non-draft scenarios (OData V2 specific)
- user in edit mode or has unsaved input
- user previously triggered an action secured by securedExecution and confirmation prevented re-entry
- user clicked Cancel in a data-loss confirmation dialog
Always add rejection handling to detect these situations and inform the user or retry as appropriate.
**LANGUAGE**: JavaScript
**CODE**:
```JavaScript
// Example: react appropriately when securedExecution rejects because fnFunction wasn't run
this.extensionAPI.securedExecution(() => {
  return this._performServerCall(); // returns a Promise
}).catch(err => {
  // Distinguish between actual operation error and "not executed" scenarios if possible
  // Log and inform the user; do NOT open dialogs inside fnFunction — do it here.
  console.warn("securedExecution did not run or failed", err);
  sap.m.MessageToast.show("Operation cancelled or failed.");
});
```

**STEP**: 5 — References (keep for quick lookup)
**DESCRIPTION**: Official API references for details and platform-specific options.
**LANGUAGE**: Plain text (URL comments)
**CODE**:
```
// SAP Fiori elements securedExecution API references:
// OData V2 (ListReport ExtensionAPI): 
// https://ui5.sap.com/#/api/sap.suite.ui.generic.template.ListReport.extensionAPI.ExtensionAPI/methods/securedExecution
//
// OData V4 (EditFlow securedExecution):
// https://ui5.sap.com/#/api/sap.fe.core.controllerextensions.EditFlow/methods/securedExecution
```
--------------------------------

**TITLE**: Validation of Required Fields in Non-draft (OData V2) Fiori Elements Applications

**INTRODUCTION**: Validate mandatory properties annotated under Org.OData.Capabilities.V1.InsertRestrictions for each entity set in non-draft OData V2 applications. If any RequiredProperties are empty during create (non-dialog), the framework prevents the backend call and shows an error in the message popover with a navigation link to the erroneous field. You can also override the default message texts via i18n keys.

**TAGS**: fiori-elements-framework, OData V2, annotations, InsertRestrictions, RequiredProperties, i18n, message-popover

**STEP**: 1 — Add RequiredProperties annotation to an entity set

**DESCRIPTION**: Add an InsertRestrictions annotation for the target entity set. Configure the RequiredProperties collection listing the property paths that must be non-empty during create. This annotation must be added individually per entity set. The annotation is applicable only for OData V2 non-draft applications.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- Example annotations XML: add per entity set -->
<Annotations Target="STTA_SALES_ORDER_ND_SRV_01.STTA_SALES_ORDER_ND_SRV_01_Entities/STTA_C_SO_SalesOrder_ND">
    <Annotation Term="Org.OData.Capabilities.V1.InsertRestrictions">
        <Record Type="Org.OData.Capabilities.V1.InsertRestrictionsType">
            <PropertyValue Property="RequiredProperties">
                <Collection>
                    <PropertyPath>BusinessPartnerID</PropertyPath>
                    <PropertyPath>CurrencyCode</PropertyPath>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

**STEP**: 2 — Override default "create mandatory" messages (i18n)

**DESCRIPTION**: To customize the validation message shown in the message popover for a specific property, add an i18n entry using the key format:
CREATE_MANDATORY|PropertyName = Custom message
Place this entry in your component/application i18n properties file (e.g., i18n.properties). If a key is missing, the framework default message is used.

**LANGUAGE**: Properties

**CODE**:
```properties
# i18n.properties (example)
# Use format: CREATE_MANDATORY|<PropertyName> = <Custom message>
CREATE_MANDATORY|CurrencyCode = Enter a valid currency code
# If you want to override BusinessPartnerID as well:
# CREATE_MANDATORY|BusinessPartnerID = Enter a value for the Business Partner ID
```

**STEP**: 3 — Behavior notes and references

**DESCRIPTION**: Key behavioral points to implement and test:
- Validation occurs before the create request is sent to the backend for non-draft apps.
- If RequiredProperties are empty, the framework displays an error in the message popover with a link that navigates to the corresponding input field.
- RequiredProperties must be set individually for each entity set.
- This functionality applies only to SAP Fiori elements for OData V2.
- Required fields are NOT validated when creating via a dialog (create with dialog is excluded).
- Reference image and anchors from original documentation (keep for visual mapping or docs integration).

**LANGUAGE**: TEXT

**CODE**:
```
Notes:
- Applies only to OData V2 non-draft apps.
- Not validated during create-with-dialog flows.
- Image reference: images/Validation_of_Required_Fields_in_Non-Draft_Apps_1_18415a9.png
- Internal anchor/id: loio400565b3b81e4fceb2b9aef1679f005b
- Optional anchor tag from source: <a name="loio400565b3b81e4fceb2b9aef1679f005b__section_lrk_tfx_gsb"/>
```
--------------------------------

**TITLE**: Value Help as a Dropdown or Radio Button List (Fiori Elements)

**INTRODUCTION**: Practical, copy-paste-ready examples to render a value help as a dropdown (ComboBox / MultiComboBox) or as a radio button group in SAP Fiori Elements. Covers OData V2 metadata, OData V4 XML annotations, ABAP CDS, CAP CDS, FilterRestrictions, and manifest.json controlConfiguration to switch to RadioButtons and horizontal layout. Use these snippets in service metadata, annotation files, CDS files, or application manifest.

**TAGS**: fiori-elements, value-help, dropdown, combobox, multicombo, radio-buttons, ODataV2, ODataV4, annotations, CDS, CAP, ABAP, manifest.json, FilterRestrictions

STEP: OData V2 — Enable Fixed-Values Dropdown via $metadata

DESCRIPTION: Add sap:value-list="fixed-values" on the Property and sap:semantics="fixed-values" on the EntitySet in your OData V2 $metadata to render the field as a dropdown (sap.m.ComboBox) or MultiComboBox for multi-selection.

LANGUAGE: XML

CODE:
```xml
<!-- $metadata (OData V2) -->
<EntityType Name="SMART_C_ProductType" sap:label="Product" sap:content-version="1">
    <Key>
        ...
    </Key>
    ...
    <Property 
        Name="ProductCategory" 
        Type="Edm.String" 
        Nullable="false" 
        MaxLength="40" 
        sap:label="Category" 
        sap:value-list="fixed-values" />
    ...
</EntityType>

<EntityContainer 
    Name="SMART_PROD_MAN_Entities" 
    m:IsDefaultEntityContainer="true" 
    sap:supported-formats="atom json xlsx">
    ...
    <EntitySet 
        Name="SEPMRA_I_ProductCategory" 
        EntityType="SMART_PROD_MAN.SEPMRA_I_ProductCategoryType"
        sap:creatable="false" 
        sap:updatable="false" 
        sap:deletable="false" 
        sap:searchable="true" 
        sap:content-version="1" 
        sap:semantics="fixed-values" />
</EntityContainer>
```

STEP: OData V4 — Enable Fixed-Values Dropdown via XML Annotations

DESCRIPTION: Use Common.ValueListWithFixedValues and a Common.ValueList to render a property as a dropdown list. The example targets Products/currency_code and configures label, text, and the value list collection.

LANGUAGE: XML

CODE:
```xml
<!-- XML Annotation for OData V4 -->
<Annotations Target="sap.fe.officesupplies.CatalogAdminService.Products/currency_code">
   <Annotation Term="Common.Label" String="Currency"/>
   <Annotation Term="Common.Text" Path="currency/name">
      <Annotation Term="UI.TextArrangement" EnumMember="UI.TextArrangementType/TextOnly"/>
   </Annotation>
   <Annotation Term="Common.ValueListWithFixedValues" Bool="true"/>
   <Annotation Term="Common.ValueList">
     <Record Type="Common.ValueListType">
       <PropertyValue Property="Label" String="Currency"/>
       <PropertyValue Property="CollectionPath" String="Currencies"/>
       <PropertyValue Property="Parameters">
         <Collection>
            <Record Type="Common.ValueListParameterInOut">
               <PropertyValue Property="LocalDataProperty" PropertyPath="currency_code"/>
               <PropertyValue Property="ValueListProperty" String="code"/>
            </Record>
            <Record Type="Common.ValueListParameterDisplayOnly">
               <PropertyValue Property="ValueListProperty" String="name"/>
            </Record>
         </Collection>
      </PropertyValue>
    </Record>
   </Annotation>
   <Annotation Term="Core.Description" String="A currency code as specified in ISO 4217"/>
</Annotations>
```

STEP: OData V4 — ABAP CDS Annotation Example (Currency Fixed Values)

DESCRIPTION: Annotate an ABAP CDS view field to expose a value help with fixed values and text arrangement. Use @Consumption.valueHelpDefinition and UI text arrangement.

LANGUAGE: ABAP CDS

CODE:
```abap
annotate view PRODUCTS with {
	@Consumption.valueHelpDefinition:
	[{
	  entity :{
		 name    : 'Currencies',
		 element : 'code'
		},
	    label  : 'Currency'
	}]

	@ObjectModel: {
		text: {
			element: [ 'name' ]
		 }
	}
	@UI.textArrangement: #TEXT_ONLY
   currency_code;
}
```

STEP: OData V4 — CAP CDS Annotation Example (Currency Fixed Values)

DESCRIPTION: Annotate a CAP CDS entity field to declare a fixed-value value list, text, and parameters to bind the local property to a value list collection.

LANGUAGE: CDS

CODE:
```cds
annotate sap.fe.officesupplies.CatalogAdminService.Products with {
    @Common.Label : 'Currency'
    @Common : {
        Text            : currency.name,
        TextArrangement : #TextOnly
    }
    @Common.ValueListWithFixedValues : true
    @Common.ValueList : {
        $Type : 'Common.ValueListType',
        Label : 'Currency',
        CollectionPath : 'Currencies',
        Parameters : [
            {
                $Type : 'Common.ValueListParameterInOut',
                LocalDataProperty : currency_code,
                ValueListProperty : 'code'
            },
            {
                $Type : 'Common.ValueListParameterDisplayOnly',
                ValueListProperty : 'name'
            }
        ]
    }
    @Core.Description : 'A currency code as specified in ISO 4217'
    currency_code
};
```

STEP: FilterRestrictions — Allow SingleValue or MultiValue Expressions

DESCRIPTION: Configure filter expression restrictions so the property's filter supports MultiValue or SingleValue expressions. Examples for XML annotation, ABAP CDS, and CAP CDS are provided.

LANGUAGE: XML

CODE:
```xml
<!-- XML Annotation: FilterRestrictions -->
<Annotation Term="SAP__capabilities.FilterRestrictions">
    <Record>
       <PropertyValue Property="FilterExpressionRestrictions">
         <Collection>
            <Record>
               <PropertyValue Property="Property" PropertyPath="currency_code" />
               <PropertyValue Property="AllowedExpressions" String="MultiValue" />
            </Record>
	 </Collection>
       </PropertyValue>
    </Record> 
</Annotation>
```

LANGUAGE: ABAP CDS

CODE:
```abap
/* ABAP CDS: disable filter or configure filter properties */
@ObjectModel: { 
    filter.enabled: false 
}
currency_code;
```

LANGUAGE: CDS

CODE:
```cds
/* CAP CDS: FilterRestrictions example */
Capabilities.FilterRestrictions : {
    FilterExpressionRestrictions : [
        {
            Property : currency_code,
            AllowedExpressions : 'MultiValue'
        }
    ]
}
```

STEP: Radio Button Group — Annotation-based (Vertical layout, show values immediately)

DESCRIPTION: Render a fixed-value value help as a radio button group by adding Common.ValueListWithFixedValues and Common.ValueListShowValuesImmediately annotations. Radio buttons use labels from Common.Text or ValueList display parameter. Restrictions & tips: use only for non-Boolean values, avoid for non-mandatory fields (default selection), recommend <= 8 values, and do NOT use when value lists have dependencies or multiple value lists.

LANGUAGE: XML

CODE:
```xml
<!-- XML Annotation: Render as Radio Button Group (vertical) -->
<Annotations Target="sap.fe.core.ValueHelpRadioButtons.RootElement/PropWithValueList">
  <Annotation Term="Common.Label" String="Radio button field via annotation"/>
  <Annotation Term="Common.ValueListWithFixedValues" Bool="true">
    <Annotation Term="Common.ValueListShowValuesImmediately" Bool="true"/>
  </Annotation>
  <Annotation Term="Common.ValueList">
    <Record Type="Common.ValueListType">
      <PropertyValue Property="Label" String="Value list with fixed values"/>
      <PropertyValue Property="CollectionPath" String="FixedValueListEntity"/>
      <PropertyValue Property="Parameters">
        <Collection>
          <Record Type="Common.ValueListParameterInOut">
            <PropertyValue Property="LocalDataProperty" PropertyPath="PropWithValueList"/>
            <PropertyValue Property="ValueListProperty" String="KeyProp"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

LANGUAGE: CDS

CODE:
```cds
/* CAP CDS: Radio Buttons via annotation (show values immediately) */
FieldWithRadioButtons  : String @(Common: {
		ValueListWithFixedValues                                       : true,
		ValueListWithFixedValues.@Common.ValueListShowValuesImmediately: true,
		ValueList                                                      : {
			CollectionPath: 'FixedValueListEntity',
			Parameters    : [
				{
					$Type            : 'Common.ValueListParameterInOut',
					LocalDataProperty: FieldWithRadioButtons,
					ValueListProperty: 'KeyProp'
				}
			]
		}
});
 
@cds.autoexpose
entity FixedValueListEntity {
		key KeyProp     : Integer @Common.Text : Description;
		Description : String
}
```

STEP: Radio Button Group — manifest.json-based (Horizontal layout via controlConfiguration)

DESCRIPTION: Use controlConfiguration in manifest.json to set fieldEditStyle to "RadioButtons" and radioButtonsHorizontalLayout to true for a specific field (by field group and DataField annotation target) — suitable when you want manifest-driven layout control instead of annotations. Provide CAP CDS entity + UI.FieldGroup example to show how to reference field.

LANGUAGE: CDS

CODE:
```cds
/* CAP CDS: field exposed via CDS, to be rendered as radio buttons via manifest.json */
FieldWithRadioButtonsViaManifest  : String @(Common: {
		ValueListWithFixedValues    : true,
		ValueList                   : {
			CollectionPath: 'FixedValueListEntity',
			Parameters    : [
				{
					$Type            : 'Common.ValueListParameterInOut',
					LocalDataProperty: FieldWithRadioButtonsViaManifest,
					ValueListProperty: 'KeyProp'
				}
			]
		}
});

@cds.autoexpose
entity FixedValueListEntity {
  key KeyProp     : Integer @Common.Text : Description;
  Description : String
}

UI.FieldGroup #MyFieldGroup : {
    Label: 'Line item data',
    Data : [
      {Value: FieldWithRadioButtonsViaManifest}
    ]
}
```

LANGUAGE: JSON

CODE:
```json
// manifest.json: controlConfiguration to render the field as horizontal radio buttons
{
  ...
  "controlConfiguration": {
    "@com.sap.vocabularies.UI.v1.FieldGroup#MyFieldGroup": {
      "fields": {
        "DataField::FieldWithRadioButtonsViaManifest": {
          "formatOptions": {
            "fieldEditStyle"              : "RadioButtons",
            "radioButtonsHorizontalLayout": true
          }
        }
      }
    }
  }
  ...
}
```

STEP: Implementation Notes, Tips, and Restrictions

DESCRIPTION: Keep these actionable rules next to your implementation:
- Text handling and sorting follow the Value Help Dialog logic — reuse the same annotations for text fields and UI.TextArrangement.
- Fixed-values value-help does not show recently entered values; do not expect history behavior.
- Radio buttons require ValueListWithFixedValues=true and a ValueList annotation; LocalDataProperty must refer to the field itself (ValueListParameterInOut or ValueListParameterOut).
- Radio buttons do NOT support:
  - Multiple value lists or ValueListRelevantQualifiers
  - Value lists with dependencies (ValueListParameterInOut with dependencies)
  - ValueListParameterConstant filters (they will be ignored)
- Recommended: use radio buttons only for value lists with <= 8 values and not for Boolean values.

LANGUAGE: Text

CODE:
```text
Follow rules above when choosing between dropdown and radio buttons; place annotations in XML annotation file (e.g., annotations.xml) or in CDS/manifest.json as shown.
```
--------------------------------

**TITLE**: Value Help Dialog — Configuration and Annotations Reference

**INTRODUCTION**: Practical, code-focused reference for configuring a Value Help Dialog in Fiori elements. Use this guide to implement titles, multiple value help variants, filter fields, search behavior, table presentation (including data load, text handling, sorting), hierarchical displays, caching, and define-conditions behavior via annotations (XML, ABAP CDS, CAP CDS).

**TAGS**: fiori-elements-framework, value-help, annotations, Common.ValueList, Common.ValueListMapping, UI.PresentationVariant, ValueListParameter, FetchValues, SearchSupported, SelectionFields, RecursiveHierarchyQualifier, caching, filter-bar, define-conditions

---

STEP: Title selection for Value Help Dialog

DESCRIPTION: Determine the dialog title precedence and annotate the property accordingly. The title is chosen in this order:
- DataField.label (if field is annotated with DataField)
- Common.Label on the property
- label in Common.ValueList / Common.ValueListMapping (fallback)
- For context-dependent value help (Common.ValueListRelevantQualifiers), prefer the label in Common.ValueList / Common.ValueListMapping, then Common.Label, then DataField.label.

LANGUAGE: XML / CDS / ABAP (annotation context)

CODE:
```xml
<!-- Example: set label on DataField (consumption layer UI) -->
<Annotations Target="serviceNamespace.BookingType/FlightDate">
    <Annotation Term="UI.DataField">
        <Record>
            <PropertyValue Property="Label" String="Flight Date"/>
        </Record>
    </Annotation>
</Annotations>
```

```cds
// CAP CDS: set Common.Label on element
entity Booking {
  FlightDate : Date @Common.Label : 'Flight Date';
}
```

```abap
" ABAP CDS: set @Common.Label
@UI.lineItem: [{ label: 'Flight Date' }]
define view entity C_BOOKINGS as select from ...
```

---

STEP: Multiple Value Help Variants (dropdown to switch flavors)

DESCRIPTION: When multiple Common.ValueList or Common.ValueListMapping annotations exist on a property, the unqualified (default) is used initially. Expose other qualifiers as variants in a dropdown so end users can switch flavors (value list variants). Configure qualifiers on each annotation.

LANGUAGE: XML / CDS / ABAP

CODE:
```xml
<!-- XML Annotation snippet: multiple ValueList annotations with qualifiers -->
<Annotations Target="serviceNamespace.BookingType/FlightDate">
    <Annotation Term="Common.ValueList">
        <Record>
            <PropertyValue Property="CollectionPath" String="Flight"/>
            <PropertyValue Property="Label" String="By Date"/>
        </Record>
    </Annotation>
    <Annotation Term="Common.ValueList" Qualifier="ByConnection">
        <Record>
            <PropertyValue Property="CollectionPath" String="FlightByConnection"/>
            <PropertyValue Property="Label" String="By Connection"/>
        </Record>
    </Annotation>
</Annotations>
```

```cds
// CAP CDS: multiple ValueList qualifiers
annotate TravelService.Booking {
  FlightDate @Common.ValueList: [{ CollectionPath: 'Flight' }, { CollectionPath: 'FlightByConnection', qualifier: 'ByConnection' }];
}
```

---

STEP: Configure Filter Fields (SelectionFields & ValueListParameterConstant)

DESCRIPTION: Use SelectionFields on the value help entity to specify which filter fields are shown in the filter panel. If SelectionFields is not defined, all filterable properties are used. Use ValueListParameterConstant to feed constant default filter values (eq comparison) into queries. Note conditions that auto-expand the filter bar.

Auto-expand filter bar if any of:
- At least one filter field is mandatory
- Search is disabled for the entity set of the value help
- FetchValues = 2 (data is not loaded by default)

LANGUAGE: XML / CDS / ABAP

CODE:
```xml
<!-- XML: SelectionFields on value-help entity -->
<Annotations Target="serviceNamespace.Flight">
  <Annotation Term="UI.SelectionFields">
    <Collection>
      <PropertyPath>City</PropertyPath>
      <PropertyPath>AirlineID</PropertyPath>
    </Collection>
  </Annotation>
</Annotations>

<!-- XML: ValueListParameterConstant -->
<Annotation Term="Common.ValueListParameterConstant">
  <Record>
    <PropertyValue Property="ValueListProperty" String="CountryCode"/>
    <PropertyValue Property="Constant" String="'DE'"/>
  </Record>
</Annotation>
```

```cds
// CAP CDS: SelectionFields & ValueListParameterConstant example
annotate TravelService.Flight with @(UI : { SelectionFields : [ 'City', 'AirlineID' ] });

annotate TravelService.Booking.FlightDate with @Common.ValueList: {
  CollectionPath : 'Flight',
  Parameters: [
    { $Type: 'Common.ValueListParameterInOut', LocalDataProperty: FlightDate, ValueListProperty: 'FlightDate' }
  ],
  FetchValues: 2
};

annotate TravelService.Flight with @Common : {
  ValueListParameterConstant : [ { ValueListProperty: 'CountryCode', Constant: "'DE'" } ]
};
```

---

STEP: Control Search Field Visibility

DESCRIPTION: Hide or show the search field at:
- Entity level: set Capabilities.SearchRestrictions.Searchable = false to hide it globally for the entity set.
- Value list level: set SearchSupported: false in Common.ValueList or Common.ValueListMapping to hide the search for that value help (overrides entity-level searchable=true).

Note: Type-ahead is not supported for non-searchable value helps.

LANGUAGE: XML / CDS / ABAP

CODE:
```xml
<!-- XML: Hide search at entity level -->
<Annotations Target="serviceNamespace.FlightType">
  <Annotation Term="Capabilities.SearchRestrictions">
    <Record>
      <PropertyValue Property="Searchable" Bool="false"/>
    </Record>
  </Annotation>
</Annotations>

<!-- XML: Hide search per value list -->
<Annotation Term="Common.ValueList">
  <Record>
    <PropertyValue Property="CollectionPath" String="Flight"/>
    <PropertyValue Property="SearchSupported" Bool="false"/>
  </Record>
</Annotation>
```

```cds
// CAP CDS: SearchSupported in ValueList definition
annotate TravelService.Booking.FlightDate with @Common.ValueList: {
  CollectionPath : 'Flight',
  SearchSupported : false
};
```

---

STEP: Table definition in Value Help (columns, hidden columns, FetchValues)

DESCRIPTION: The value help dialog table is derived from Common.ValueList/Common.ValueListMapping annotations. Ensure all ValueListProperty values referenced in:
- Common.ValueListParameterInOut
- Common.ValueListParameterOut
- Common.ValueListParameterDisplayOnly
are included in the table. Columns annotated with UI.Hidden are not rendered. Parameters already displayed through Common.Text are ignored.

Control data load:
- Default: data loads immediately on open.
- To delay and require user action (Go), set FetchValues (in Common.ValueList) accordingly (e.g., FetchValues = 2).

LANGUAGE: XML / CDS / ABAP

CODE:
```xml
<!-- XML: ValueList with Parameters and FetchValues -->
<Annotations Target="Self.ArtistsType/CountryOfOrigin">
  <Annotation Term="Common.ValueList">
    <Record>
      <PropertyValue Property="CollectionPath" String="myEntityName"/>
      <PropertyValue Property="SearchSupported" Bool="true"/>
      <PropertyValue Property="Parameters">
        <Collection>
          <Record Type="Common.ValueListParameterInOut">
            <PropertyValue Property="LocalDataProperty" PropertyPath="CountryOfOrigin"/>
            <PropertyValue Property="ValueListProperty" String="CountryCode"/>
          </Record>
          <Record Type="Common.ValueListParameterDisplayOnly">
            <PropertyValue Property="ValueListProperty" String="CountryCode_Text"/>
          </Record>
        </Collection>
      </PropertyValue>
      <PropertyValue Property="FetchValues" Int="2"/>
    </Record>
  </Annotation>
</Annotations>
```

```cds
// CAP CDS: FetchValues example
annotate TravelService.Booking.FlightDate with @Common.ValueList: {
  CollectionPath : 'Flight',
  FetchValues : 2,
  Parameters: [
    { $Type: 'Common.ValueListParameterInOut', LocalDataProperty: FlightDate, ValueListProperty: 'FlightDate' },
    { $Type: 'Common.ValueListParameterDisplayOnly', ValueListProperty: 'FlightDate_Text' }
  ]
};
```

---

STEP: Text handling rules (Common.Text & Common.TextArrangement)

DESCRIPTION: Text display in table follows these rules:
- If no Common.Text for the ID field → show only ID.
- If Common.Text exists → show associated text according to:
  1. Common.TextArrangement on the property
  2. Common.TextArrangement on the entity
  3. Default: TextFirst
- ValueListParameterOut text values are carried to the main entity property (they can override main entity text during selection).

LANGUAGE: XML / CDS / ABAP

CODE:
```xml
<!-- XML: Common.Text and TextArrangement at property level -->
<Annotations Target="serviceNamespace.Flight/FlightID">
  <Annotation Term="Common.Text">
    <PropertyValue Property="Path" PropertyPath="FlightID_Text"/>
  </Annotation>
  <Annotation Term="Common.TextArrangement">
    <EnumMember>Common.TextArrangementType/TextFirst</EnumMember>
  </Annotation>
</Annotations>
```

```cds
// CAP CDS: annotate text association and arrangement
entity Flight {
  FlightID : String;
  FlightID_Text : String;
}
annotate TravelService.Flight.FlightID with @Common.Text : { Path : 'FlightID_Text' };
annotate TravelService.Flight with @Common.TextArrangement : 'TextFirst';
```

---

STEP: Sorting the Value Help Table (UI.PresentationVariant)

DESCRIPTION: By default, sorting uses the first column. If first column has TextArrangement=TextOnly, sorting uses the property referenced by Common.Text. Use UI.PresentationVariant (PresentationVariantQualifier referenced from Common.ValueList via PresentationVariantQualifier) to change default sort order. Warning: PresentationVariant overrides backend search order and may create inconsistent ordering for search/type-ahead results.

LANGUAGE: XML / ABAP / CDS

CODE:
```xml
<!-- XML: ValueList -> PresentationVariantQualifier -->
<Annotations Target="serviceNamespace.BookingType/FlightDate">
  <Annotation Term="Common.ValueList">
    <Record>
      ...
      <PropertyValue Property="PresentationVariantQualifier" String="VH_Booking_to_Flight"/>
    </Record>
  </Annotation>
</Annotations>

<!-- XML: UI.PresentationVariant with qualifier -->
<Annotations Target="serviceNamespace.FlightType">
  <Annotation Term="UI.PresentationVariant" Qualifier="VH_Booking_to_Flight">
    <Record>
      <PropertyValue Property="SortOrder">
        <Collection>
          <Record Type="common.SortOrderType">
            <PropertyValue Property="Property" PropertyPath="FlightDate"/>
            <PropertyValue Property="Descending" Bool="true"/>
          </Record>
        </Collection>
      </PropertyValue>
    </Record>
  </Annotation>
</Annotations>
```

```abap
" ABAP CDS: PresentationVariant + valueHelpDefinition linking
annotate view C_BOOKINGS with {
  @Consumption.valueHelpDefinition: [
    {
      entity: { name: 'VH_Flight', element: 'FlightDate' },
      presentationVariantQualifier: 'VH_Booking_to_Flight'
    }
  ]
  FlightDate;
}

@UI.presentationVariant: [{
  qualifier: 'VH_Booking_to_Flight',
  sortOrder: [{ by: 'FlightDate', direction: #DESC }]
}]
define view entity VH_Flight as select from Flight {
  FlightDate;
}
```

```cds
// CAP CDS: PresentationVariant usage
annotate TravelService.Booking {
  FlightDate @Common.ValueList: {
    CollectionPath : 'Flight',
    PresentationVariantQualifier : 'VH_Booking_to_Flight',
  };
}

annotate TravelService.Flight with @(
  UI.PresentationVariant #VH_Booking_to_Flight : {
    $Type : 'UI.PresentationVariantType',
    SortOrder : [
      {
        $Type     : 'Common.SortOrderType',
        Property  : FlightDate,
        Descending: true,
      },
    ],
  }
);
```

---

STEP: Hierarchical display in Value Help (RecursiveHierarchyQualifier & InitialExpansionLevel)

DESCRIPTION: To display a hierarchy:
- Provide RecursiveHierarchyQualifier in UI.PresentationVariant
- Set InitialExpansionLevel to control starting expansion
- Link PresentationVariantQualifier from the value list to the presentation variant qualifier containing the RecursiveHierarchyQualifier.

LANGUAGE: XML / ABAP / CDS

CODE:
```xml
<!-- XML: ValueList with PresentationVariant qualifier + PresentationVariant with recursion -->
<Annotations Target="Self.ArtistsType/CountryOfOrigin">
    <Annotation Term="Common.ValueList">
        <Record>
            <PropertyValue Property="CollectionPath" String="myEntityName"/>
            <PropertyValue Property="SearchSupported" Bool="true"/>
            <PropertyValue Property="Parameters">
                <Collection>
                    <Record Type="Common.ValueListParameterInOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="CountryOfOrigin"/>
                        <PropertyValue Property="ValueListProperty" String="CountryCode"/>
                    </Record>
                    <Record Type="Common.ValueListParameterDisplayOnly">
                        <PropertyValue Property="ValueListProperty" String="CountryCode_Text"/>
                    </Record>
                    <Record Type="Common.ValueListParameterDisplayOnly">
                        <PropertyValue Property="ValueListProperty" String="CountryIndicator"/>
                    </Record>
                </Collection>
            </PropertyValue>
            <PropertyValueProperty="PresentationVariantQualifier"String="Country_Pres" />
        </Record>
    </Annotation>
    <Annotation Term="UI.PresentationVariant" Qualifier="Country_Pres">
        <Record>
            <PropertyValue Property="Visualizations">
                <Collection>
                    <AnnotationPath>@UI.LineItem#DefaultLineItem</AnnotationPath>
                </Collection>
            </PropertyValue>
            <PropertyValue Property="InitialExpansionLevel" Int="2"/>
            <PropertyValue Property="RecursiveHierarchyQualifier" String="CountryHierarchy"/>
        </Record>
    </Annotation>
</Annotations>
```

```abap
" ABAP CDS: valueHelpDefinition + presentation variant with recursion
@Consumption.valueHelpDefinition: [
    {
          entity :{ name : 'myEntityName', element : 'CountryCode' },
          label  : 'mylabel',
          presentationVariantQualifier: 'Country_Pres'
    }
]
@UI.presentationVariant: [
    {
      visualizations: [ { type: #AS_LINEITEM, qualifier: 'DefaultLineItem' } ],
      initialExpansionLevel: 2,
      recursiveHierarchyQualifier: 'CountryHierarchy',
      qualifier: 'Country_Pres'
    }
]
CountryOfOrigin,
```

```cds
// CAP CDS: Hierarchy config in annotations
entity Artist {
    CountryOfOrigin : String(40) @(Common : {
      Label : 'Country',
      ValueList : {
        CollectionPath : 'myEntityName',
        Parameters     : [
          { $Type : 'Common.ValueListParameterInOut', LocalDataProperty : CountryOfOrigin, ValueListProperty : 'CountryCode' },
          { $Type : 'Common.ValueListParameterDisplayOnly', ValueListProperty : 'CountryCode_Text' },
          { $Type : 'Common.ValueListParameterDisplayOnly', ValueListProperty : 'CountryIndicator' }
        ],
        PresentationVariantQualifier: 'Country_Pres'
      }
    },
    UI : {
      PresentationVariant #Country_Pres : {
        Visualizations : [ '@UI.LineItem#DefaultLineItem' ],
        InitialExpansionLevel : 2,
        RecursiveHierarchyQualifier: 'CountryHierarchy'
      }
    }
);
```

Links for live examples:
- Hierarchy in multi-input value help: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/field/fieldMultiValueField
- Tree table example: https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/buildingBlocks/filterBar/filterBarDefault

---

STEP: Caching value help table contents and invalidation

DESCRIPTION: By default, table data is loaded and cached on first open within a session. Subsequent opens reuse cache. To ensure fresh data after backend changes:
- Trigger a refresh via a side effect that targets the value help entity.
Restrictions:
- Cache invalidation/refresh works only when the value help entity is defined in the same metadata as the main entity (e.g., CAP). Not supported when VH entity is in separate metadata (RAP).

LANGUAGE: General / Annotations

CODE:
```xml
<!-- Example: Side effect that targets VH entity (XML annotation concept) -->
<Annotations Target="serviceNamespace.ActionCollection">
  <Annotation Term="Common.SideEffects">
    <Collection>
      <Record>
        <PropertyValue Property="SourceProperties">
          <Collection>
            <PropertyPath>ChangedProperty</PropertyPath>
          </Collection>
        </PropertyValue>
        <PropertyValue Property="TargetEntities">
          <Collection>
            <PropertyPath>VH_Flight</PropertyPath>
          </Collection>
        </PropertyValue>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

Reference: Side Effects documentation — see Side Effects (side-effects-18b17bd.md) and Global Patterns - Side Effects live example:
https://ui5.sap.com/test-resources/sap/fe/core/fpmExplorer/index.html#/advancedFeatures/guidance/guidanceSideEffects

Note: Dropdown-based fields do not support value help caching.

---

STEP: Define Conditions tab (Capabilities.FilterRestrictions.AllowedExpressions and available operators)

DESCRIPTION: The Define Conditions tab is shown for fields in filter contexts unless AllowedExpressions limits it. Configure AllowedExpressions via Capabilities.FilterRestrictions.AllowedExpressions on the property. The operator availability by AllowedExpressions:

- SingleValue → Define Conditions tab hidden (None)
- MultiValue → hidden (None)
- SingleRange → Equal To + single range operators (<=, <, >=, >, Between)
- MultiRange → multiple range conditions (like SingleRange, but multiple)
- SearchExpression → Contains, Starts with, Ends with
- Not defined → All conditions available

Extra notes:
- Tab includes negation (Exclude) operators and an empty operator placeholder (maps to equal to "" or null)
- Edm.Date with AllowedExpressions SingleValue/SingleRange and Edm.DateTimeOffset with SingleRange show semantic date options

LANGUAGE: XML / CDS / ABAP

CODE:
```xml
<!-- XML: Example AllowedExpressions usage -->
<Annotations Target="serviceNamespace.BookingType/Price">
  <Annotation Term="Capabilities.FilterRestrictions">
    <Record>
      <PropertyValue Property="AllowedExpressions" EnumMember="Capabilities.FilterExpression/SingleRange"/>
    </Record>
  </Annotation>
</Annotations>
```

```cds
// CAP CDS: AllowedExpressions example
annotate TravelService.Booking.Price with @(Capabilities : {
  FilterRestrictions : { AllowedExpressions : 'SingleRange' }
});
```

Reference: Enabling semantic operators in filter bar — see Enabling the Search Function documentation (enabling-the-search-function-3cdebee.md) and semantic operators guide (enabling-semantic-operators-in-the-filter-bar-fef65d0.md).

---

END OF DOCUMENT
--------------------------------

**TITLE**: Value Help Annotations (Common.ValueList, Common.ValueListMapping, Validation, Context-Dependent, InitialValueIsSignificant)

**INTRODUCTION**: Quick reference and code-ready examples for configuring value help in Fiori elements applications. Includes:
- Common.ValueList (use when value-help entity is part of the main service metadata — CAP/CDS)
- Common.ValueListMapping + Common.ValueListReference (use when value-help entity is external — RAP/RESTful ABAP)
- Client-side validation via Common.ValueListForValidation (hard-coded and conditional)
- Context-dependent qualifiers via Common.ValueListRelevantQualifiers
- Using InitialValueIsSignificant for empty/null IN parameters

Notes:
- Draft-enabled entities only show active documents in value help.
- Filter fields show the Define Conditions tab even if no ValueList/ValueListMapping is defined.

**TAGS**: value-help, annotations, Common.ValueList, Common.ValueListMapping, Common.ValueListForValidation, Common.ValueListReference, Common.ValueListRelevantQualifiers, InitialValueIsSignificant, CAP, RAP, ABAP

STEP: 1 — Configure Value Help (Common.ValueList) — XML (when value help entity is in main metadata, e.g., CAP)
DESCRIPTION: Define a ValueList annotation on a property. Use Parameters to map LocalDataProperty ↔ ValueListProperty, specify Importance, InitialValueIsSignificant, and FetchValues behavior.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="MyService.Travel/AgencyId">
    <Annotation Term="Common.ValueList">
        <Record>
            <PropertyValue Property="CollectionPath" String="TravelAgency" />
            <PropertyValue Property="Label" String="Travel Agency" />
            <PropertyValue Property="SearchSupported" Bool="true" />
            <PropertyValue Property="FetchValues" Int="2" />
            <PropertyValue Property="Parameters">
                <Collection>
                    <Record Type="Common.ValueListParameterInOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="AgencyId" />
                        <PropertyValue Property="ValueListProperty" String="Agency_Id" />
                        <PropertyValue Property="Importance" EnumMember="Common.ImportanceType/High" />
                    </Record>
                    <Record Type="Common.ValueListParameterInOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="_TourOperator/RegionId" />
                        <PropertyValue Property="ValueListProperty" String="Region_Id" />
                        <PropertyValue Property="InitialValueIsSignificant" Bool="true" />
                    </Record>
                    <Record Type="Common.ValueListParameterDisplayOnly">
                        <PropertyValue Property="ValueListProperty" String="AgencyName" />
                        <PropertyValue Property="Importance" EnumMember="Common.ImportanceType/High" />
                    </Record>
                    <Record Type="Common.ValueListParameterOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="CountryIndicator" />
                        <PropertyValue Property="ValueListProperty" String="Country_Flag" />
                    </Record>
                    <Record Type="Common.ValueListParameterConstant">
                        <PropertyValue Property="Constant" String="001" />
                        <PropertyValue Property="ValueListProperty" String="PredefinedField" />
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: 2 — Configure Value Help (Common.ValueList) — CAP CDS
DESCRIPTION: Equivalent CAP CDS annotation for ValueList when the value list entity is in the same service metadata.
LANGUAGE: CDS (CAP)
CODE:
```CDS
annotate MyService.Travel with {
    AgencyId @Common.ValueList: {
        CollectionPath : 'TravelAgency',
        Label          : 'Travel Agency',
        SearchSupported,
        FetchValues    : 2,
        Parameters     : [
            {
                $Type             : 'Common.ValueListParameterInOut',
                LocalDataProperty : AgencyId,
                ValueListProperty : 'Agency_Id',
                ![@UI.Importance] : #High,
            },
            {
                $Type                    : 'Common.ValueListParameterInOut',
                LocalDataProperty        : to_TourOperator.RegionId,
                ValueListProperty        : 'Region_Id',
                InitialValueIsSignificant
            },
            {
                $Type             : 'Common.ValueListParameterDisplayOnly',
                ValueListProperty : 'AgencyName',
                ![@UI.Importance] : #High,
            },
            {
                $Type             : 'Common.ValueListParameterOut',
                LocalDataProperty : CountryIndicator,
                ValueListProperty : 'Country_Flag'
            },
            {
                $Type            : 'Common.ValueListParameterConstant',
                Constant: '001',
                ValueListProperty: 'PredefinedField'
            }
        ]
    };
};
```

STEP: 3 — Configure External Value Help (Common.ValueListMapping) — XML (RAP / external service)
DESCRIPTION: Use Common.ValueListMapping when the value-help entity is external to the main service metadata (RAP). Parameters and properties mirror Common.ValueList.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="MyService.Travel/AgencyId">
    <Annotation Term="Common.ValueListMapping">
        <Record>
            <PropertyValue Property="CollectionPath" String="TravelAgency" />
            <PropertyValue Property="Label" String="Travel Agency" />
            <PropertyValue Property="SearchSupported" Bool="true" />
            <PropertyValue Property="FetchValues" Int="2" />
            <PropertyValue Property="Parameters">
                <Collection>
                    <Record Type="Common.ValueListParameterInOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="AgencyId" />
                        <PropertyValue Property="ValueListProperty" String="Agency_Id" />
                        <PropertyValue Property="Importance" EnumMember="Common.ImportanceType/High" />
                    </Record>
                    <Record Type="Common.ValueListParameterInOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="_TourOperator/RegionId" />
                        <PropertyValue Property="ValueListProperty" String="Region_Id" />
                        <PropertyValue Property="InitialValueIsSignificant" Bool="true" />
                    </Record>
                    <Record Type="Common.ValueListParameterDisplayOnly">
                        <PropertyValue Property="ValueListProperty" String="AgencyName" />
                        <PropertyValue Property="Importance" EnumMember="Common.ImportanceType/High" />
                    </Record>
                    <Record Type="Common.ValueListParameterOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="CountryIndicator" />
                        <PropertyValue Property="ValueListProperty" String="Country_Flag" />
                    </Record>
                    <Record Type="Common.ValueListParameterConstant">
                        <PropertyValue Property="Constant" String="001" />
                        <PropertyValue Property="ValueListProperty" String="PredefinedField" />
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: 4 — Reference External Value Help Metadata (Common.ValueListReference) — XML
DESCRIPTION: When using Common.ValueListMapping, add Common.ValueListReferences (string path relative to main metadata file) to point to the external metadata file containing the value list.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="Self.TravelType/AgencyId">
  <Annotation Term="Common.ValueListReferences">
    <Collection>
      <String>../../../../srvd_f4/sap/myentityname/0001;ps='srvd-sadl_gw_apptravel_definition-0001';va='com.sap.gateway.srvd.sadl_gw_apptravel_definition.v0001.et-c_mdbu_v4_travel.agencyid'/$metadata</String>
    </Collection>
  </Annotation>
</Annotations>
```

STEP: 5 — Common ValueList Properties (quick mapping)
DESCRIPTION: Quick reference JSON mapping of common properties and semantics to use when generating annotations or code.
LANGUAGE: JSON
CODE:
```JSON
{
  "Label": "Dialog title",
  "CollectionPath": "Entity providing the value help data",
  "SearchSupported": "Bool - show search bar",
  "FetchValues": "1 (default: load immediately) | 2 (load after filters are applied)",
  "Parameters": [
    {
      "Types": [
        "Common.ValueListParameterIn",
        "Common.ValueListParameterOut",
        "Common.ValueListParameterInOut",
        "Common.ValueListParameterDisplayOnly",
        "Common.ValueListParameterConstant"
      ],
      "LocalDataProperty": "PropertyPath in main entity",
      "ValueListProperty": "Property name in value list entity",
      "Importance": "Common.ImportanceType/#High | #Medium | #Low",
      "InitialValueIsSignificant": "Bool (only for Edm.String object page IN parameters)"
    }
  ],
  "Note": "Value help shows for filter fields even without ValueList annotation (only Define Conditions tab)"
}
```

STEP: 6 — Client-Side Validation (Common.ValueListForValidation) — Hard-coded XML
DESCRIPTION: Validate UI input client-side against a value list. Use empty string "" to validate against the default (unqualified) ValueList. Use qualifier name to validate against a qualified ValueList.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="serviceNamespace.BookingType/FlightDate">
    <!-- Validate against default (unqualified) value list -->
    <Annotation Term="Common.ValueListForValidation" String=""/>
    <!-- Define the value list used for validation -->
    <Annotation Term="Common.ValueList">
        <!-- ...Definition of ValueList... -->
    </Annotation>
</Annotations>
```

STEP: 7 — Client-Side Validation — ABAP CDS (hard-coded)
DESCRIPTION: ABAP CDS example to enable validation using an unqualified ValueList.
LANGUAGE: ABAP CDS
CODE:
```ABAP
annotate schema.Booking {
  @Common.ValueListForValidation : ''
  @Common.ValueList : {
      $Type : 'Common.ValueListType',
      CollectionPath : 'Flight',
  }
  FlightDate;
}
```

STEP: 8 — Client-Side Validation — CAP CDS (hard-coded)
DESCRIPTION: CAP CDS example to enable validation using an unqualified ValueList.
LANGUAGE: CDS (CAP)
CODE:
```CDS
annotate schema.Booking {
  @Common.ValueListForValidation : ''
  @Common.ValueList : {
      $Type : 'Common.ValueListType',
      CollectionPath : 'Flight',
  }
  FlightDate;
}
```

STEP: 9 — Client-Side Validation — Conditional (XML)
DESCRIPTION: Use a conditional expression to select the qualifier at runtime. The expression must return a single qualifier (string) or empty string.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="com.c_salesordermanage_sd.HeaderPartner/BusinessPartner">
    <Annotation Term="com.sap.vocabularies.Common.v1.ValueListForValidation">
        <If>
            <Eq>
                <Path>PartnerFunction</Path>
                <String>WE</String>
            </Eq>
            <String>BusinessPartnerQualifier</String>
            <String />
        </If>
    </Annotation>
</Annotations>
```

STEP: 10 — Client-Side Validation — Conditional (CAP CDS with $edmJson) 
DESCRIPTION: CAP CDS showing JSON expression binding for conditional ValueListForValidation; alternative inline ternary style shown.
LANGUAGE: CDS (CAP)
CODE:
```CDS
annotate schema.HeaderPartner { 
  @Common.ValueListForValidation: {$edmJson: {$If: [ 
    {$Eq: [ {$Path: 'PartnerFunction'}, 'WE' ]}, 
    'BusinessPartnerQualifier', 
    '' 
  ]}} 
  BusinessPartner; 
}

/* OR */

annotate schema.HeaderPartner with { 
  @Common.ValueListForValidation : (PartnerFunction = 'WE' ? 'BusinessPartnerQualifier' : '') 
  BusinessPartner; 
};
```

STEP: 11 — Context-Dependent Value Help (ValueListRelevantQualifiers) — XML
DESCRIPTION: Define relevant qualifiers conditionally based on another property (e.g., PartnerFunction). Provide both qualified and unqualified ValueList annotations.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="com.c_salesordermanage_sd.HeaderPartner/BusinessPartner">
    <Annotation Term="com.sap.vocabularies.Common.v1.ValueListRelevantQualifiers">
        <Collection>
            <String/>
            <If>
                <Eq>
                    <Path>PartnerFunction</Path>
                    <String>WE</String>
                </Eq>
                <String>BusinessPartnerQualifier</String>
            </If>
        </Collection>
    </Annotation>

    <Annotation Term="Common.ValueList" Qualifier="BusinessPartnerQualifier">
        <!-- ...Definition of ValueList for BusinessPartnerQualifier... -->
    </Annotation>

    <Annotation Term="Common.ValueList">
        <!-- ...Definition of ValueList without qualifier... -->
    </Annotation>
</Annotations>
```

STEP: 12 — Context-Dependent Value Help — CAP CDS
DESCRIPTION: CAP CDS conditional qualifier example mapping PartnerFunction to a specific qualifier.
LANGUAGE: CDS (CAP)
CODE:
```CDS
annotate schema.HeaderPartner with {
  @Common.ValueListRelevantQualifiers:
    (PartnerFunction = 'WE' ? 'BusinessPartnerQualifier' : '')
  @Common.ValueList: {
    $Type: 'Common.ValueListType',
    /* ...default value list definition... */
  }
  @Common.ValueList#BusinessPartnerQualifier: {
    $Type: 'Common.ValueListType',
    /* ...qualified value list definition... */
  }
  BusinessPartner;
};
```

STEP: 13 — InitialValueIsSignificant (treat empty/null as significant) — XML
DESCRIPTION: For object pages only and only for Edm.String IN parameters. Use InitialValueIsSignificant = true to include empty string as a meaningful filter value.
LANGUAGE: XML
CODE:
```XML
<Annotations Target="com.c_salesordermanage_sd.SalesOrderManage/ShippingCondition"> 
    <Annotation Term="Common.ValueList">
        <Record Type="Common.ValueListType">
            <PropertyValue Property="CollectionPath" String="ShippingCondition"/>
            <PropertyValue Property="Label" String="Shipping Condition"/>
            <PropertyValue Property="Parameters">
                <Collection>
                    <Record Type="Common.ValueListParameterInOut">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="ShippingCondition"/>
                        <PropertyValue Property="ValueListProperty" String="ShippingCondition"/>
                    </Record>
                    <Record Type="Common.ValueListParameterIn">
                        <PropertyValue Property="LocalDataProperty" PropertyPath="SoldToParty"/>
                        <PropertyValue Property="ValueListProperty" String="SoldToParty"/>
                        <PropertyValue Property="InitialValueIsSignificant" Bool="true"/>
                    </Record>
                    <Record Type="Common.ValueListParameterDisplayOnly">
                        <PropertyValue Property="ValueListProperty" String="ShippingCondition_Text"/>
                    </Record>
                </Collection>
            </PropertyValue>
        </Record>
    </Annotation>
</Annotations>
```

STEP: 14 — InitialValueIsSignificant — CAP CDS
DESCRIPTION: CAP CDS representation of InitialValueIsSignificant for the same behavior.
LANGUAGE: CDS (CAP)
CODE:
```CDS
/* Note: Context-dependent value help may not support individual In/Out params for different ShippingCondition */
annotate schema.SalesOrderManage with {
  ShippingCondition @Common.ValueList: {
    Label          : 'Shipping Condition',
    CollectionPath : 'ShippingCondition',
    Parameters     : [
      {
        $Type             : 'Common.ValueListParameterInOut',
        LocalDataProperty : ShippingCondition,
        ValueListProperty : 'ShippingCondition'
      },
      {
        $Type             : 'Common.ValueListParameterIn',
        LocalDataProperty : SoldToParty,
        ValueListProperty : 'SoldToParty',
        InitialValueIsSignificant: true
      },
      {
        $Type             : 'Common.ValueListParameterDisplayOnly',
        ValueListProperty : 'ShippingCondition_Text'
      }
    ]
  }
};
```

STEP: 15 — Restrictions & Implementation Notes
DESCRIPTION: Keep these rules in your generated annotations or validation logic.
LANGUAGE: Text
CODE:
```text
- InitialValueIsSignificant: supported only on object pages and only for parameters of type Edm.String.
- Parameterized value help service is not supported.
- When using Common.ValueListMapping (external value help), ensure Common.ValueListReferences is present and the string path is correct relative to the main metadata file.
- If Common.ValueListForValidation is not specified for filter fields, validation uses the default (unqualified) ValueList annotation.
- Draft-enabled entities only show active documents in value help.
```

--------------------------------

**TITLE**: Vertical Bullet Chart Card (OVP)

**INTRODUCTION**: Quick reference and ready-to-use examples to implement a Vertical Bullet Chart card on an SAP Fiori Overview Page (OVP). Shows backend entity/fields, sample OData payload for testing, and the exact manifest.json card configuration that assigns dimension(s) and measures with roles axis1 (actual) and axis2 (target).

**TAGS**: fiori-elements-framework, ovp, vertical-bullet, card, manifest.json, CDS, OData

**STEP**: 1 — Define backend entity (CDS) with one dimension and two measures

**DESCRIPTION**: Create a CDS entity that exposes a category/dimension and two numeric measures: Actual (axis1) and Target (axis2). Mark the numeric fields as measures so the front end / OData consumer recognizes them as measures.

**LANGUAGE**: CDS

**CODE**:
```cds
namespace my.app;

using { cuid } from '@sap/cds/common';

entity VerticalBulletData {
  key ID       : UUID        default cuid();
  Category     : String(80);           // dimension
  Actual       : Decimal(15,2);        // measure - actual values
  Target       : Decimal(15,2);        // measure - target values
}
```

**STEP**: 2 — Example OData JSON payload (for mocking or testing)

**DESCRIPTION**: Minimal OData-style JSON array returned by the OData service for the entity. Use this for mocking the service during UI testing.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "d": {
    "results": [
      { "ID": "1", "Category": "Product A", "Actual": 75.00, "Target": 100.00 },
      { "ID": "2", "Category": "Product B", "Actual": 50.00, "Target": 80.00 },
      { "ID": "3", "Category": "Product C", "Actual": 120.00, "Target": 110.00 }
    ]
  }
}
```

**STEP**: 3 — Add Vertical Bullet Chart card configuration to webapp/manifest.json

**DESCRIPTION**: Add an OVP card entry in the manifest.json. The card uses the chart template and assigns:
- dimensions: all assigned to the axis category (provide value binding).
- measures: role "axis1" for Actual (rendered as solid column), role "axis2" for Target (rendered as solid black line).

Place this under the sap.ovp.cards section of webapp/manifest.json (or appropriate OVP card registry in your app).

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ovp": {
    "cards": {
      "verticalBulletCard": {
        "template": "sap.ovp.cards.charts",
        "model": "odataModel", 
        "settings": {
          "title": "Vertical Bullet Chart",
          "subTitle": "Actual vs Target by Category",
          "chartType": "verticalBullet",
          "data": {
            "path": "/VerticalBulletData"   /* OData entity set path */
          },
          "dimensions": {
            "Category": {
              "label": "Category",
              "value": "{Category}"
            }
          },
          "measures": {
            "Actual": {
              "label": "Actual",
              "value": "{Actual}",
              "role": "axis1"
            },
            "Target": {
              "label": "Target",
              "value": "{Target}",
              "role": "axis2"
            }
          },
          "presentationAnnotationPath": "", /* optional: annotation path if using UI.Chart annotations */
          "maxItems": 5
        }
      }
    }
  }
}
```

**STEP**: 4 — Notes on visualization behavior and expectations

**DESCRIPTION**: Rules the card follows at runtime:
- All dimension(s) are assigned to the axis category (x-axis for category grouping).
- Measures with role "axis1" are rendered as solid-colored columns representing Actual values.
- Measures with role "axis2" are rendered as a solid black line representing Target values.
- Provide at least one dimension and one measure. Multiple measures can be used; ensure roles are set explicitly.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "behavior": {
    "dimensionsToAxis": "All dimensions are mapped to axis",
    "axis1": "Solid column(s) = actual values",
    "axis2": "Solid black line = target value",
    "requirements": "At least one dimension and one measure required"
  }
}
```

**STEP**: 5 — File locations and integration tips

**DESCRIPTION**: Where to place files and quick integration hints.
- Backend CDS: srv/src or db/src depending on project layout (example CDS path: srv/src/data-model.cds).
- Manifest card: webapp/manifest.json under "sap.ovp" → "cards".
- OData model name in manifest ("odataModel") should match the model configured in webapp/manifest.json or Component.js.
- For real projects, prefer adding UI.Chart / UI.LineItem annotations for richer behavior; the minimal card config above is sufficient to render a Vertical Bullet Chart in OVP.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "paths": {
    "cds": "srv/src/data-model.cds",
    "manifest": "webapp/manifest.json",
    "odataEntity": "/VerticalBulletData"
  },
  "notes": {
    "modelBinding": "Ensure 'model' in card config matches the OData model name registered in the app",
    "annotations": "Optional: add annotation-based configuration via presentationAnnotationPath if required"
  }
}
```
--------------------------------

**TITLE**: Visual Filters — Configuration and Code Samples for Fiori Elements

**INTRODUCTION**: Practical, code-focused guide to configure visual filters (bar, line, donut) in SAP Fiori elements using annotation-driven approaches. Includes ValueList IN/OUT mapping, PresentationVariant, Chart, SelectionVariant, SelectionFields, TextArrangement, DataPoint scale/format, manifest setting for lazy loading, grouping calls, UoM text handling, semantic coloring, and platform-specific notes for OData V2 and V4.

**TAGS**: fiori-elements-framework, visual-filters, annotations, UI.Chart, Common.ValueList, PresentationVariant, SelectionVariant, SelectionFields, TextArrangement, DataPoint, manifest.json, ODataV2, ODataV4, CAP, ABAP, XML, CDS

STEP: 1 — Configure ValueList Annotation for Visual Filter (XML)
DESCRIPTION: Enhance the property with Common.ValueList (qualifier VisualFilter). Ensure CollectionPath, PresentationVariantQualifier, SelectionVariantQualifier and Parameters (IN/OUT mapping) are defined. The dimension in the chart must match ValueListProperty of the OUT parameter. Ensure the value help entity set returns same records as regular filter's value help for sync.
LANGUAGE: xml
CODE:
```xml
<Annotations xmlns="http://docs.oasis-open.org/odata/ns/edm" Target="SEPMRA_ALP_SO_ANA_SRV.SEPMRA_C_ALP_SlsOrdItemCubeALPResult/SalesOrderOverallStatus">
   <Annotation Term="Common.ValueList" Qualifier="VisualFilter">
      <Record>
         <PropertyValue Property="Label" String="Overall Status" />
         <PropertyValue Property="CollectionPath" String="SEPMRA_C_ALP_SlsOrdItemCubeALPResults" />
         <PropertyValue Property="SearchSupported" Bool="false" />
         <PropertyValue Property="PresentationVariantQualifier" String="FilterNumberOfSalesOrdersByStatus" />
         <PropertyValue Property="SelectionVariantQualifier" String="SVForStatus" />
         <PropertyValue Property="Parameters">
            <Collection>
               <Record Type="Common.ValueListParameterInOut">
                  <PropertyValue Property="LocalDataProperty" PropertyPath="SalesOrderOverallStatus" />
                  <PropertyValue Property="ValueListProperty" String="SalesOrderOverallStatus" />
               </Record>
               <Record Type="Common.ValueListParameterInOut">
                  <PropertyValue Property="LocalDataProperty" PropertyPath="MainProductCategory" />
                  <PropertyValue Property="ValueListProperty" String="MainProductCategory" />
               </Record>
               <Record Type="Common.ValueListParameterInOut">
                  <PropertyValue Property="LocalDataProperty" PropertyPath="ProductCategory" />
                  <PropertyValue Property="ValueListProperty" String="ProductCategory" />
               </Record>
            </Collection>
         </PropertyValue>
      </Record>
   </Annotation>
</Annotations>
```

STEP: 2 — Configure ValueList Annotation for Visual Filter (CAP CDS)
DESCRIPTION: Equivalent CAP CDS annotation for VisualFilter value list. Use Common.ValueList qualifier and define Parameters as Common.ValueListParameterInOut.
LANGUAGE: cds
CODE:
```cds
annotate SEPMRA_ALP_SO_ANA_SRV.SEPMRA_C_ALP_SlsOrdItemCubeALPResult with {
  @Common.ValueList #VisualFilter : {
    Label : 'Overall Status',
    CollectionPath : 'SEPMRA_C_ALP_SlsOrdItemCubeALPResults',
    SearchSupported : false,
    PresentationVariantQualifier : 'FilterNumberOfSalesOrdersByStatus',
    SelectionVariantQualifier : 'SVForStatus',
    Parameters : [
        {
            $Type : 'Common.ValueListParameterInOut',
            LocalDataProperty : SalesOrderOverallStatus,
            ValueListProperty : 'SalesOrderOverallStatus'
        },
        {
            $Type : 'Common.ValueListParameterInOut',
            LocalDataProperty : MainProductCategory,
            ValueListProperty : 'MainProductCategory'
        },
        {
            $Type : 'Common.ValueListParameterInOut',
            LocalDataProperty : ProductCategory,
            ValueListProperty : 'ProductCategory'
        }
    ]
  }
  SalesOrderOverallStatus
};
```

STEP: 3 — Define PresentationVariant Qualifier (XML)
DESCRIPTION: PresentationVariant qualifier supplies the chart reference (Visualizations) and SortOrder. Visual filter picks the first chart in Visualizations. If unsupported chart type, fallback to bar chart. Control sort using SortOrder in PresentationVariant.
LANGUAGE: xml
CODE:
```xml
<Annotation Term="UI.PresentationVariant" Qualifier="FilterNumberOfSalesOrdersByStatus">
   <Record>
      <PropertyValue Property="Text" String="Filter: Number of Sales Order by Status" />
      <PropertyValue Property="SortOrder">
         <Collection>
            <Record Type="Common.SortOrderType">
               <PropertyValue Property="Property" PropertyPath="NumberOfSalesOrders" />
               <PropertyValue Property="Descending" Bool="true" />
            </Record>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="Visualizations">
         <Collection>
            <AnnotationPath>@UI.Chart#FilterNumberOfSalesOrdersByStatus</AnnotationPath>
         </Collection>
      </PropertyValue>
   </Record>
</Annotation>
```

STEP: 4 — PresentationVariant (ABAP CDS / CAP CDS)
DESCRIPTION: ABAP CDS and CAP CDS forms of PresentationVariant. Use to define qualifier, sort order and visualizations referencing UI.Chart qualifier.
LANGUAGE: abap
CODE:
```abap
@UI.PresentationVariant: [
  {
    text: 'Filter: Number of Sales Order by Status',
    sortOrder: [
      {
        by: 'NUMBEROFSALESORDERS',
        direction: #DESC
      }
    ],
    visualizations: [
      {
        type: #AS_CHART,
        qualifier: 'FilterNumberOfSalesOrdersByStatus'
      }
    ],
    qualifier: 'FilterNumberOfSalesOrdersByStatus'
  }
]
annotate view VIEWNAME with {

}
```
LANGUAGE: cds
CODE:
```cds
UI.PresentationVariant #FilterNumberOfSalesOrdersByStatus : {
    Text : 'Filter: Number of Sales Order by Status',
    SortOrder : [
        {
            $Type : 'Common.SortOrderType',
            Property : NumberOfSalesOrders,
            Descending : true
        },
    ],
    Visualizations : [
        '@UI.Chart#FilterNumberOfSalesOrdersByStatus'
    ]
},
```

STEP: 5 — Define Chart Annotation (XML)
DESCRIPTION: ChartDefinitionType defines ChartType, Dimensions, Measures, and related attributes. Visual filter uses first measure and first dimension from the first chart in PresentationVariant.
LANGUAGE: xml
CODE:
```xml
<Annotation Term="UI.Chart" Qualifier="FilterNumberOfSalesOrdersByStatus">
   <Record Type="UI.ChartDefinitionType">
      <PropertyValue Property="Title" String="Sales Orders by Status" />
      <PropertyValue Property="Description" String="Number of Sales Orders by Status" />
      <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Donut" />
      <PropertyValue Property="Dimensions">
         <Collection>
            <PropertyPath>SalesOrderOverallStatus</PropertyPath>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="DimensionAttributes">
         <Collection>
            <Record Type="UI.ChartDimensionAttributeType">
               <PropertyValue Property="Dimension" PropertyPath="SalesOrderOverallStatus" />
               <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category" />
            </Record>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="Measures">
         <Collection>
            <PropertyPath>NumberOfSalesOrders</PropertyPath>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="MeasureAttributes">
         <Collection>
            <Record Type="UI.ChartMeasureAttributeType">
               <PropertyValue Property="Measure" PropertyPath="NumberOfSalesOrders" />
               <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1" />
               <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#NumberOfSalesOrders" />
            </Record>
         </Collection>
      </PropertyValue>
   </Record>
</Annotation>
```

STEP: 6 — Chart Annotation (ABAP CDS / CAP CDS)
DESCRIPTION: ABAP CDS and CAP equivalents for UI.Chart chart definition and measure/data point linking.
LANGUAGE: abap
CODE:
```abap
@UI.Chart: [
  {
    title: 'Sales Orders by Status',
    description: 'Number of Sales Orders by Status',
    chartType: #DONUT,
    dimensions: [
      'SALESORDEROVERALLSTATUS'
    ],
    dimensionAttributes: [
      {
        dimension: 'SalesOrderOverallStatus',
        role: #CATEGORY
      }
    ],
    measures: [
      'NUMBEROFSALESORDERS'
    ],
    measureAttributes: [
      {
        measure: 'NumberOfSalesOrders',
        role: #AXIS_1,
		asDataPoint: true
      }
    ],
    qualifier: 'FilterNumberOfSalesOrdersByStatus'
  }
]
annotate view VIEWNAME with {

}
```
LANGUAGE: cds
CODE:
```cds
UI.Chart #FilterNumberOfSalesOrdersByStatus : {
    $Type : 'UI.ChartDefinitionType',
    Title : 'Sales Orders by Status',
    Description : 'Number of Sales Orders by Status',
    ChartType : #Donut,
    Dimensions : [
        SalesOrderOverallStatus
    ],
    DimensionAttributes : [
        {
            $Type : 'UI.ChartDimensionAttributeType',
            Dimension : SalesOrderOverallStatus,
            Role : #Category
        }
    ],
    Measures : [
        NumberOfSalesOrders
    ],
    MeasureAttributes : [
        {
            $Type : 'UI.ChartMeasureAttributeType',
            Measure : NumberOfSalesOrders,
            Role : #Axis1,
            DataPoint : '@UI.DataPoint#NumberOfSalesOrders'
        }
    ]
}
```

STEP: 7 — Define SelectionFields (XML / ABAP CDS / CAP CDS)
DESCRIPTION: Use UI.SelectionFields to control ordering of displayed filter fields in the visual filter bar. Mandatory filter fields not in SelectionFields appear first.
LANGUAGE: xml
CODE:
```xml
<Annotation Term="UI.SelectionFields">
  <Collection>
    <PropertyPath>DeliveryCalendarYear</PropertyPath>
    <PropertyPath>SoldToParty</PropertyPath>
    <PropertyPath>Product</PropertyPath>
    <PropertyPath>MainProductCategory</PropertyPath>
    <PropertyPath>DeliveryCalendarQuarter</PropertyPath>
  </Collection>
</Annotation>
```
LANGUAGE: abap
CODE:
```abap
@UI.SelectionField: [{ position: 10 }]
DELIVERYCALENDARYEAR;

@UI.SelectionField: [{ position: 20 }]
SOLDTOPARTY;

@UI.SelectionField: [{ position: 30 }]
PRODUCT;

@UI.SelectionField: [{ position: 40 }]
MAINPRODUCTCATEGORY;

@UI.SelectionField: [{ position: 50 }]
DELIVERYCALENDARQUARTER;
```
LANGUAGE: cds
CODE:
```cds
UI.SelectionFields : [
    DeliveryCalendarYear,
    SoldToParty,
    Product,
    MainProductCategory,
    DeliveryCalendarQuarter
]
```

STEP: 8 — Define SelectionVariant (XML / ABAP CDS / CAP CDS)
DESCRIPTION: Use SelectionVariant qualifier to provide default filter values (SelectOptions) or request parameters for parameterized collection paths. IN/OUT parameter values take precedence over SelectionVariant values when both provided.
LANGUAGE: xml
CODE:
```xml
<Annotation Term="UI.SelectionVariant" Qualifier="SVForStatus">
   <Record>
      <PropertyValue Property="Parameters">
         <Collection>
            <Record Type="UI.Parameter">
               <PropertyValue Property="PropertyName" PropertyPath="CompanyCurrency" />
               <PropertyValue Property="PropertyValue" String="EUR" />
            </Record>
         </Collection>
      </PropertyValue>
      <PropertyValue Property="SelectOptions">
         <Collection>
            <Record Type="UI.SelectOptionType">
               <PropertyValue Property="PropertyName" PropertyPath="SalesOrderOverallStatus" />
               <PropertyValue Property="Ranges">
                  <Collection>
                     <Record Type="UI.SelectionRangeType">
                        <PropertyValue EnumMember="UI.SelectionRangeSignType/E" Property="Sign" />
                        <PropertyValue EnumMember="UI.SelectionRangeOptionType/EQ" Property="Option" />
                        <PropertyValue Property="Low" String="D" />
                     </Record>
                  </Collection>
               </PropertyValue>
            </Record>
            <Record Type="UI.SelectOptionType">
               <PropertyValue Property="PropertyName" PropertyPath="Product" />
               <PropertyValue Property="Ranges">
                  <Collection>
                     <Record Type="UI.SelectionRangeType">
                        <PropertyValue EnumMember="UI.SelectionRangeSignType/E" Property="Sign" />
                        <PropertyValue EnumMember="UI.SelectionRangeOptionType/EQ" Property="Option" />
                        <PropertyValue Property="Low" String="HT-1502" />
                     </Record>
                  </Collection>
               </PropertyValue>
            </Record>
         </Collection>
      </PropertyValue>
   </Record>
</Annotation>
```
LANGUAGE: abap
CODE:
```abap
@UI.selectionVariant: [
  {
    qualifier: 'SVForStatus',
	parameters: [{name: 'PropertyName', value: 'CompanyCurrency' },{ name: 'PropertyValue', value: 'EUR'}]
  }
]
```
LANGUAGE: cds
CODE:
```cds
UI.SelectionVariant #SVForStatus : {
    Parameters : [
        {
            $Type : 'UI.Parameter',
            PropertyName : CompanyCurrency,
            PropertyValue : 'EUR'
        }
    ],
    SelectOptions : [
        {
            $Type : 'UI.SelectOptionType',
            PropertyName : SalesOrderOverallStatus,
            Ranges : [
                {
                    $Type : 'UI.SelectionRangeType',
                    Sign : #E,
                    Option : #EQ,
                    Low : 'D'
                }
            ]
        },
        {
            $Type : 'UI.SelectOptionType',
            PropertyName : Product,
            Ranges : [
                {
                    $Type : 'UI.SelectionRangeType',
                    Sign : #E,
                    Option : #EQ,
                    Low : 'HT-1502'
                }
            ]
        }
    ]
}
```

STEP: 9 — TextArrangement (XML / ABAP CDS / CAP CDS)
DESCRIPTION: Control formatting of axis labels, tooltips, and selected link display. Use UI.TextArrangement types: TextFirst, TextLast, TextOnly, TextSeparate.
LANGUAGE: xml
CODE:
```xml
<Annotations Target="ProductType"> <!-- Main EntitySet -->
  <Annotation Term="com.sap.vocabularies.UI.v1.TextArrangement" EnumMember="com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst"/> 
</Annotations>
```
LANGUAGE: abap
CODE:
```abap
@UI.textArrangement: #TEXT_FIRST
annotate view ProductType with {

}
```
LANGUAGE: cds
CODE:
```cds
annotate ProductType @(
  UI.TextArrangement : #TextFirst
);
```

STEP: 10 — Enable Lazy Loading of Visual Filters (manifest.json)
DESCRIPTION: In OData V2, enable lazyLoadVisualFilter to defer the batch call until user opens the visual filter bar. In OData V4 lazy loading is enabled by default and cannot be disabled.
LANGUAGE: json
CODE:
```json
"settings": {
    "qualifier": "MainContent",
    "defaultContentView": "charttable",
    "smartVariantManagement": true,
    "showGoButtonOnFilterBar": true,
    "multiSelect": true,
    "lazyLoadVisualFilter": true,
    "tableType": "AnalyticalTable"
    // ...
}
```

STEP: 11 — Group Visual Filter Calls (Controller Extension)
DESCRIPTION: Optionally set oContext.groupId in onBeforeRebindVisualFilterExtension to group multiple visual filter requests into one batch call. groupId values must be keys in oContext.
LANGUAGE: javascript
CODE:
```javascript
onBeforeRebindVisualFilterExtension: function(sEntityType, sDimension, sMeasure, oContext){
    'use strict';
    var Log = sap.ui.require("sap/base/Log");
    if (sDimension === "Product") {
        oContext.groupId = "Group1";
    }
    if (sDimension === "DeliveryCalendarMonth" || sDimension === "DeliveryCalendarQuarter") {
        oContext.groupId = "Group2";
    }
    Log.info("onBeforeRebindVisualFilterExtension called!");
}
```

STEP: 12 — DataPoint Scale Factor (XML) — Chart Title Scale
DESCRIPTION: Use UI.DataPoint ValueFormat.ScaleFactor to control scale in chart title and values (avoid hard-coded scale unless range is fixed).
LANGUAGE: xml
CODE:
```xml
<Annotation Term="UI.DataPoint" Qualifier="LineChartTimeDataPoint">
    <Record Type="UI.DataPointType">
        <PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Positive"/>
        <PropertyValue Property="Title" String="Total Pricing"/>
        <PropertyValue Property="Value" Path="totalPricing"/>
        <PropertyValue Property="ValueFormat">
            <Record Type="UI.NumberFormat">
                <PropertyValue Property="ScaleFactor" Decimal="1000"/> <!-- 1000 results in "K" scaling -->
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
```

STEP: 13 — Number Formatting (DataPoint ValueFormat NumberOfFractionalDigits)
DESCRIPTION: Use NumberOfFractionalDigits in UI.DataPoint.ValueFormat to control fraction digits. Rules: decimals not shown by default; specify 1 or 2 digits (V2 allows >2; V4 caps at 2). For currency measures, decimals applied only when scale factor is used (V4: otherwise uses displayed currency).
LANGUAGE: xml
CODE:
```xml
<Annotation Term="com.sap.vocabularies.UI.v1.DataPoint" Qualifier="Price">
    <Record Type="com.sap.vocabularies.UI.v1.DataPointType">
        <PropertyValue Property="Value" Path="Price"/>
        <PropertyValue Property="ValueFormat">
            <Record Type="com.sap.vocabularies.UI.v1.NumberFormat">
                <PropertyValue Property="NumberOfFractionalDigits" Int="1"/>
            </Record>
        </PropertyValue>
    </Record>
</Annotation>
```
LANGUAGE: abap
CODE:
```abap
@UI.dataPoint: { 
   valueFormat.numberOfFractionalDigits: 1  
}
price;
```
LANGUAGE: cds
CODE:
```cds
UI.DataPoint #Price : {
    $Type : 'UI.DataPointType',
    Value : Price,
    ValueFormat : {
        $Type : 'UI.NumberFormat',
        NumberOfFractionalDigits : 1
    }
}
```

STEP: 14 — Unit of Measure Text Lookup (XML)
DESCRIPTION: If unit field (currency/UoM) has sap:text annotation on main entity or value list entity set, the text is displayed in brackets in visual filter. If main entity has sap:text, it takes precedence; otherwise check value list entity set.
LANGUAGE: xml
CODE:
```xml
<!-- Main EntitySet: DisplayCurrency without sap:text -->
<EntityType Name="ZEPM_C_SALESORDERITEMQUERYResult" sap:semantics="aggregate" sap:content-version="1">
    <Key>
        <PropertyRef Name="ID"/>
    </Key> 
  <Property Name="DisplayCurrency" Type="Edm.String" MaxLength="5" sap:aggregation-role="dimension" sap:creatable="false" sap:label="Display Currency" sap:updatable="false" sap:semantics="currency-code"/>  
</EntityType>

<!-- Value List EntitySet: DisplayCurrency with sap:text to DisplayCurrencyText -->
<EntityType Name="ZEPM_C_SALESORDERITEMQUERYValueHelpResult" sap:semantics="aggregate" sap:content-version="1">
    <Key>
        <PropertyRef Name="ID"/>
    </Key> 
    <Property Name="DisplayCurrency" Type="Edm.String" MaxLength="5" sap:aggregation-role="dimension" sap:creatable="false" sap:label="Display Currency" sap:updatable="false" sap:semantics="currency-code" sap:text="DisplayCurrencyText"/>
    <Property Name="DisplayCurrencyText" Type="Edm.String" MaxLength="60" sap:filterable="false"/>
</EntityType>
```

STEP: 15 — Semantic Coloring (Dimensions and Measures)
DESCRIPTION: - For dimension-based coloring, use ValueCriticality annotations (color determined by returned value path). - For measures, configure UI.DataPoint.Criticality or CriticalityCalculation. Measure color precedence over dimension. Provide a data point and link it from Chart.MeasureAttributes.DataPoint.
LANGUAGE: xml
CODE:
```xml
<Annotation Term="UI.Chart" Qualifier="BarChartSoldToParty">
     <Record Type="UI.ChartDefinitionType">
          <PropertyValue Property="Title" String="Bar Chart"/>
          <PropertyValue Property="Description" String="Testing Bar Chart"/>
          <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Bar"/>
          <PropertyValue Property="Measures">
               <Collection>
                    <PropertyPath>totalPricing</PropertyPath>
               </Collection>
          </PropertyValue>
          <PropertyValue Property="Dimensions">
               <Collection>
                    <PropertyPath>SoldToParty</PropertyPath>
               </Collection>
          </PropertyValue>
          <PropertyValue Property="MeasureAttributes">
               <Collection>
                    <Record Type="UI.ChartMeasureAttributeType">
                         <PropertyValue Property="Measure" PropertyPath=" totalPricing"/>
                         <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis1"/>
                         <PropertyValue Property="DataPoint" AnnotationPath="@UI.DataPoint#LineChartTimeDataPoint"/>
                    </Record>
               </Collection>
          </PropertyValue>
          <PropertyValue Property="DimensionAttributes">
               <Collection/>
          </PropertyValue>
     </Record>
</Annotation>

<Annotation Term="UI.DataPoint" Qualifier="LineChartTimeDataPoint">
     <Record Type="UI.DataPointType">
          <PropertyValue Property="Value" Path="totalPricing"/>
          <PropertyValue Property="Title" String="Total Pricing"/>
          <PropertyValue Property="Criticality" EnumMember="UI.CriticalityType/Positive"/>
     </Record>
</Annotation>
```

STEP: 16 — Chart Type Behavior & Sorting Rules (Actionable Summary)
DESCRIPTION: Use these rules when choosing chart type and annotations:
- Bar: displays top/bottom 3 records. Sorting defaults to measure descending. Use PresentationVariant.SortOrder to control.
- Donut (OData V2 only): displays top/bottom 2 records. Sorting defaults to measure descending; can override with PresentationVariant.SortOrder. For donut, set Analytics.AccumulativeMeasure = false to allow overlay if negative values exist.
- Line: displays first/last 6 data points. If dimension is time-based, sorting is based on dimension ascending (annotation sort ignored for time-based line charts). For non-time-based line charts, sorting is dimension ascending by default; use PresentationVariant.SortOrder to override.
- Visual filters include only the first measure and dimension of the first chart in PresentationVariant.
LANGUAGE: xml
CODE:
```xml
<!-- Example: Disable AccumulativeMeasure for donut overlay message (OData V2) -->
<Annotations Target="SEPMRA_ALP_SO_ANA_SRV.Z_SEPMRA_C_ALP_QUARTERVHType/DifferenceAmount">
    <Annotation Term="Analytics.Measure" Bool="true" />
    <Annotation Term="Analytics.AccumulativeMeasure" Bool="false" />
</Annotations>
```

STEP: 17 — Date Selection and Supported Formats (Actionable Summary)
DESCRIPTION: Visual filters support UTC date-based single-select fields; semantic dates and ranges are not supported. Supported formats (use appropriate sap:semantics or Edm types):
- Edm.DateTime with sap:display-format="Date"
- Edm.String with sap:semantics values: yearmonthday, yearmonth, year, yearquarter, yearweek, fiscalyear, fiscalyearperiod
- OData V4: Edm.Date / Edm.Time / Edm.DateTimeOffset for line charts (time-based only)
- For SelectionVariant date values, use UTC format: "2018-10-15T00:00:00Z" (time zeros + 'Z').
LANGUAGE: xml
CODE:
```xml
<Property Name="StartDate" Type="Edm.DateTime" sap:display-format="Date" 
sap:aggregation-role="dimension" sap:label="Date" sap:filter-restriction="single-value"/>

<Property Name="StartDate" Type="Edm.String" sap:semantics="yearmonthday" 
sap:aggregation-role="dimension" sap:label="Date" sap:filter-restriction="single-value"/>
```

STEP: 18 — Fixed Values, IN/OUT Precedence, and Parameterized Collection Paths (Actionable Summary)
DESCRIPTION:
- Use SelectionVariant.SelectOptions to show default chart records. IN/OUT parameter mapping values override SelectionVariant for same fields.
- For parameterized value list CollectionPath (OData V2), provide parameters in SelectionVariant.Parameters; filter bar inputs override SelectionVariant parameter values.
- Example scenarios:
  - Chart dimension Status with SelectionVariant.SelectOptions Status=[In Progress, New] and Parameter Project=List Report — chart uses those values; changing Project in filter bar re-renders chart for new project.
  - For parameterized collection path with P_DisplayCurrency=USD in SelectionVariant, setting EUR in filter bar overrides to EUR.
LANGUAGE: none
CODE:
```text
(See SelectionVariant examples in STEP 8 for parameter and select option syntax.)
```

STEP: 19 — Additional Platform Notes (Actionable Summary)
DESCRIPTION:
- OData V2: Donut supported; lazyLoadVisualFilter disabled by default; can enable via manifest.json.
- OData V4: Lazy loading enabled by default (cannot disable); line charts only for time-based dimensions (Edm.Date/Time/DateTimeOffset); ensure manifest entries exist per visual filter to render (see Visual Filter Bar config docs).
- Visual filters do not appear if backend returns multiple UoM values for measure — ensure single UoM via filter or backend.
- Empty dimension values appear as "Not Assigned" in visual filter charts (display differs in value help/dropdown).
LANGUAGE: none
CODE:
```text
(Platform-specific behaviors summarized above — refer to platform docs if needed.)
```

Related: Configuring the Visual Filter Bar — use to ensure manifest properties and additional setup for OData V4 visual filters.
--------------------------------

**TITLE**: Waterfall Chart Card — Annotations and Samples (XML, ABAP CDS, CAP CDS)

**INTRODUCTION**: This document provides concise, code-focused examples and actionable rules for defining a Waterfall Chart card in Fiori elements. It covers required roles, legend behavior, semantic coloring, and sample annotations in XML, ABAP CDS, and CAP CDS. Use these snippets as drop-in templates and adapt property names/paths to your data model.

**TAGS**: fiori-elements-framework, UI.Chart, Waterfall, annotations, XML, CDS, CAP, ABAP, datapoint, criticality

STEP: Requirements and rules (summary)
DESCRIPTION: Minimal requirements and role behavior for waterfall charts — enforce these when generating annotations or UI metadata.
LANGUAGE: text
CODE:
```text
- At least 1 measure and 1 dimension are required.
- Dimension roles:
  - Category (x-axis): the dimension mapped to the category role becomes the x-axis. If none specified, the first dimension is used.
  - Series: dimensions mapped to series become the cumulative data points. Only one dimension per role is allowed.
  - waterfallType (optional UID): map this to a dimension to show intermediate subtotals/total (valid values: null, "subtotal:2", "total").
- Measure role:
  - Measures make up the y-axis (value axis). You can map measures to Axis2 if needed (e.g., secondary axis).
- Legend:
  - By default: shows the measure name and two groups "<0" and ">0".
  - If multiple measures exist: each measure is displayed in the legend instead of group names.
- Semantic waterfall charts:
  - To enable semantic coloring, provide criticality via UI.DataPoint annotations using com.sap.vocabularies.UI.v1.Criticality or CriticalityCalculation on the data point for the measure.
```

STEP: XML Annotation — basic waterfall chart
DESCRIPTION: Core XML annotation for a waterfall chart with one measure and two dimensions (category + series). Use this as a direct annotation snippet (Qualifier is optional).
LANGUAGE: XML
CODE:
```xml
<Annotation Term="UI.Chart" Qualifier="Waterfall_Eval_by_Country">
  <Record Type="UI.ChartDefinitionType">
    <PropertyValue Property="Title" String="Revenue Waterfall"/>
    <PropertyValue Property="ChartType" EnumMember="UI.ChartType/Waterfall"/>
    <PropertyValue Property="MeasureAttributes">
      <Collection>
        <Record Type="UI.ChartMeasureAttributeType">
          <PropertyValue Property="Measure" PropertyPath="Finances"/>
          <!-- Optional: set secondary axis -->
          <PropertyValue Property="Role" EnumMember="UI.ChartMeasureRoleType/Axis2"/>
        </Record>
      </Collection>
    </PropertyValue>
    <PropertyValue Property="DimensionAttributes">
      <Collection>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="SpendType"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category"/>
        </Record>
        <Record Type="UI.ChartDimensionAttributeType">
          <PropertyValue Property="Dimension" PropertyPath="Type"/>
          <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Series"/>
        </Record>
      </Collection>
    </PropertyValue>
  </Record>
</Annotation>
```

STEP: XML — configure waterfallType for subtotal/total
DESCRIPTION: Example showing how to mark a dimension as subtotal or total using the waterfallType UID. Use the listed valid values: null, "subtotal:2", "total". Place this property inside the ChartDimensionAttributeType record for the specific dimension.
LANGUAGE: XML
CODE:
```xml
<!-- Example: mark the Category dimension to produce a subtotal after two items -->
<Record Type="UI.ChartDimensionAttributeType">
  <PropertyValue Property="Dimension" PropertyPath="SpendType"/>
  <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Category"/>
  <!-- waterfallType UID values: null | "subtotal:2" | "total" -->
  <PropertyValue Property="WaterfallType" String="subtotal:2"/>
</Record>

<!-- Example: mark the final column as total -->
<Record Type="UI.ChartDimensionAttributeType">
  <PropertyValue Property="Dimension" PropertyPath="GrandTotalMarker"/>
  <PropertyValue Property="Role" EnumMember="UI.ChartDimensionRoleType/Series"/>
  <PropertyValue Property="WaterfallType" String="total"/>
</Record>
```

STEP: XML — semantic coloring via UI.DataPoint (criticality)
DESCRIPTION: Minimal XML snippet to attach a DataPoint annotation to the measure for semantic coloring using Criticality or CriticalityCalculation. Attach this to the property or view as required.
LANGUAGE: XML
CODE:
```xml
<!-- Attach this DataPoint annotation to the measure property (Finances) -->
<Annotation Term="UI.DataPoint" Qualifier="FinancesDP">
  <Record Type="UI.DataPointType">
    <PropertyValue Property="Value" Path="Finances"/>
    <!-- Example: static criticality -->
    <PropertyValue Property="Criticality" EnumMember="UI.Criticality/Positive"/>
    <!-- Or dynamic calculation using CriticalityCalculation -->
    <!--
    <PropertyValue Property="CriticalityCalculation">
      <Record Type="UI.CriticalityCalculationType">
        <PropertyValue Property="ImprovementDirection" EnumMember="UI.ImprovementDirection/Maximize"/>
        <PropertyValue Property="ToleranceRangeHighValue" Path="UpperThreshold"/>
        <PropertyValue Property="DeviationRangeValue" Path="LowerThreshold"/>
      </Record>
    </PropertyValue>
    -->
  </Record>
</Annotation>
```

STEP: ABAP CDS Annotation — basic waterfall chart
DESCRIPTION: ABAP CDS UI.Chart annotation equivalent. Use this block in your CDS view annotations (replace VIEWNAME and field names accordingly).
LANGUAGE: ABAP
CODE:
```abap
@UI.Chart: [
  {
    title: 'Revenue Waterfall',
    chartType: #WATERFALL,
    measureAttributes: [
      {
        measure: 'Finances',
        role: #AXIS_2   /* optional: use #AXIS_2 for secondary axis */
      }
    ],
    dimensionAttributes: [
      {
        dimension: 'SpendType',
        role: #CATEGORY
      },
      {
        dimension: 'Type',
        role: #SERIES
      }
    ],
    qualifier: 'Waterfall_Eval_by_Country'
  }
]
annotate view VIEWNAME with { }
```

STEP: ABAP CDS — waterfallType and criticality examples
DESCRIPTION: Show how to specify waterfallType (subtotal/total) and attach data point criticality in ABAP CDS annotations.
LANGUAGE: ABAP
CODE:
```abap
@UI.Chart: [
  {
    title: 'Revenue Waterfall',
    chartType: #WATERFALL,
    measureAttributes: [
      {
        measure: 'Finances',
        role: #AXIS_2
      }
    ],
    dimensionAttributes: [
      {
        dimension: 'SpendType',
        role: #CATEGORY,
        /* waterfallType values: '', 'SUBTOTAL:2', 'TOTAL' - case may vary by implementation */
        waterfallType: 'SUBTOTAL:2'
      },
      {
        dimension: 'Type',
        role: #SERIES
      }
    ]
  }
]

/* DataPoint with static criticality example */
@UI.dataPoint: {
  value: 'Finances',
  criticality: #POSITIVE
}
```

STEP: CAP CDS (CDS) — basic waterfall chart
DESCRIPTION: CAP CDS JSON-like annotation style for UI.Chart. Use this in your service or annotation file (adapt property names to your model).
LANGUAGE: CDS
CODE:
```cds
UI.Chart #Waterfall_Eval_by_Country : {
  $Type : 'UI.ChartDefinitionType',
  Title : 'Revenue Waterfall',
  ChartType : #Waterfall,
  MeasureAttributes : [
    {
      $Type : 'UI.ChartMeasureAttributeType',
      Measure : Finances,
      Role : #Axis2
    }
  ],
  DimensionAttributes : [
    {
      $Type : 'UI.ChartDimensionAttributeType',
      Dimension : SpendType,
      Role : #Category
    },
    {
      $Type : 'UI.ChartDimensionAttributeType',
      Dimension : Type,
      Role : #Series
    }
  ]
}
```

STEP: CAP CDS — waterfallType and datapoint criticality
DESCRIPTION: CAP CDS examples to set waterfallType and enable semantic coloring via UI.DataPoint criticality.
LANGUAGE: CDS
CODE:
```cds
/* Mark a dimension as a subtotal or total using WaterfallType */
UI.Chart #Waterfall_Eval_by_Country : {
  ...
  DimensionAttributes : [
    {
      $Type : 'UI.ChartDimensionAttributeType',
      Dimension : SpendType,
      Role : #Category,
      /* waterfallType values: null | 'subtotal:2' | 'total' */
      WaterfallType : 'subtotal:2'
    },
    ...
  ]
}

/* DataPoint annotation for semantic coloring */
annotate MyEntity with {
  Finances @ UI.DataPoint : {
    $Type : 'UI.DataPointType',
    Value   : Finances,
    Criticality : #Positive
  };
}
```

Step: Implementation checklist (use before deploying)
DESCRIPTION: Quick checklist to validate generated chart annotations.
LANGUAGE: text
CODE:
```text
- Confirm at least one measure and one category dimension are present.
- Ensure only one dimension per role (Category, Series).
- If using waterfallType, validate the value is one of: null, "subtotal:2", "total".
- If semantic coloring required, add UI.DataPoint with Criticality or CriticalityCalculation for the measure.
- Verify qualifier usage if multiple charts defined on same view/entity.
- Test in a Fiori elements app to confirm legend and subtotal/total columns render as expected.
```

--------------------------------

**TITLE**: Why Use SAP Fiori Elements — Benefits and Quick Starter Configuration

**INTRODUCTION**: A concise, code-focused guide describing why to use SAP Fiori Elements and how to start a Fiori Elements app. Covers key benefits (developer productivity, UX consistency, enterprise readiness), recommended file layout, minimal manifest configuration, backend CDS and annotation examples, and annotation XML for OData services. Use these snippets when generating project scaffolding, manifest.json, CDS services, or annotation files.

**TAGS**: fiori-elements-framework, SAP Fiori, SAPUI5, annotations, CDS, OData, manifest.json, UX, enterprise

**STEP**: 1 — Core Benefits (Code-focused summary)

**DESCRIPTION**: Use this summary when generating README, architecture notes, or automated selection dialogs to explain why Fiori Elements should be chosen for a new SAPUI5 app.

**LANGUAGE**: TEXT

**CODE**:
```text
Developer Productivity:
- Focus on business logic and back-end services; minimal UI code generation.
- Use metadata-driven UI templates (ListReport, ObjectPage, AnalyticalListPage).
- Reduce development & maintenance costs via framework reuse.

UX Consistency:
- Automatically follow SAP Fiori design specification.
- Centralized UX behavior: consistent layout, navigation, search, filtering, and actions.

Enterprise Readiness:
- Built-in accessibility, mobile support, translation (i18n), performance optimizations.
- Stable UI with enterprise-grade features out of the box.
```

**STEP**: 2 — When to Choose Fiori Elements

**DESCRIPTION**: Decision criteria to embed in tools that choose between freestyle SAPUI5 vs Fiori Elements.

**LANGUAGE**: TEXT

**CODE**:
```text
Choose Fiori Elements when:
- UI can be driven by OData metadata + annotations (CDS annotations or OData XML).
- You need consistent SAP Fiori UX across many apps.
- You require enterprise features (i18n, accessibility, mobile, role-based variants).
Avoid when:
- Highly custom, non-standard UIs are required that cannot be expressed with annotations.
Note: Initial setup (annotations, manifest routing) may take more effort but scales well for many apps.
```

**STEP**: 3 — Recommended Project Structure (file paths)

**DESCRIPTION**: Use this skeleton when scaffolding or generating a Fiori Elements app.

**LANGUAGE**: TEXT

**CODE**:
```text
Project root/
  ├─ webapp/
  │   ├─ manifest.json                <- Core app descriptor (Fiori Elements config)
  │   ├─ Component.js                 <- Optional bootstrap
  │   ├─ i18n/i18n.properties         <- Translations (i18n)
  │   ├─ annotations/annotations.xml  <- Annotation XML (for OData v2/v4)
  │   └─ index.html
  ├─ srv/                             <- Backend CDS / Node.js service
  │   ├─ package.json
  │   └─ srv.cds
  └─ mta.yaml or xs-app.json (optional)
```

**STEP**: 4 — Minimal manifest.json (ListReport + ObjectPage for Fiori Elements)

**DESCRIPTION**: Copy this minimal manifest.json fragment to enable sap.ui.generic.app templates. Replace service URIs, ids, and entitySet names to match the backend.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.app": {
    "id": "my.app",
    "applicationVersion": { "version": "1.0.0" },
    "title": "My Fiori Elements App"
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService"
      },
      "i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "settings": { "bundleName": "my.app.i18n.i18n" }
      }
    }
  },
  "sap.ui.generic.app": {
    "pages": [
      {
        "entitySet": "Books", 
        "component": {
          "name": "sap.suite.ui.generic.template.ListReport"
        }
      },
      {
        "entitySet": "Books",
        "component": {
          "name": "sap.suite.ui.generic.template.ObjectPage"
        }
      }
    ]
  },
  "sap.app/dataSources": {
    "mainService": {
      "uri": "/sap/opu/odata/sap/ZMY_SERVICE_SRV/",
      "type": "OData",
      "settings": { "odataVersion": "2.0" }
    }
  }
}
```

**STEP**: 5 — Example CDS Model + Service (preferred for RAP/CDS backends)

**DESCRIPTION**: Use this CDS snippet when generating a backend service (srv/*.cds). It includes an entity and service exposure. Adapt namespace and fields. Add @UI annotations (next step) or annotate separately.

**LANGUAGE**: CDS

**CODE**:
```cds
namespace my.app;

using { cuid } from '@sap/cds/common';

entity Books {
  key ID    : UUID        @title : 'ID';
  title     : String(200);
  author    : String(100);
  price     : Decimal(9,2);
}

/* Service exposing the entity */
service CatalogService @(path: '/catalog') {
  entity Books as projection on my.app.Books;
}
```

**STEP**: 6 — CDS Annotations Example (inline annotations for Fiori Elements)

**DESCRIPTION**: Annotate the CDS entity to drive Fiori Elements pages (header info and line items). Use these annotations when generating CDS files.

**LANGUAGE**: CDS

**CODE**:
```cds
annotate my.app.Books with {
  @UI.headerInfo: {
    typeName: 'Book',
    typeNamePlural: 'Books',
    title: { value: 'title' }
  },
  @UI.lineItem: [
    { position: 10, value: 'title' },
    { position: 20, value: 'author' },
    { position: 30, value: 'price' }
  ]
};
```

**STEP**: 7 — OData Annotation XML (alternative for OData services without CDS)

**DESCRIPTION**: Use this XML when the backend provides an OData EDMX and you need an annotations XML file (webapp/annotations/annotations.xml). Update Target and Paths to match your service.

**LANGUAGE**: XML

**CODE**:
```xml
<Annotations Target="MyService.Books" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="UI.HeaderInfo">
    <Record>
      <PropertyValue Property="TypeName" String="Book"/>
      <PropertyValue Property="Title" Path="title"/>
    </Record>
  </Annotation>
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataField">
        <PropertyValue Property="Label" String="Title"/>
        <PropertyValue Property="Value" Path="title"/>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Label" String="Author"/>
        <PropertyValue Property="Value" Path="author"/>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Label" String="Price"/>
        <PropertyValue Property="Value" Path="price"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 8 — Enable i18n and Accessibility (manifest additions and file paths)

**DESCRIPTION**: Add resource bundle and ensure accessibility settings are in place. Use this snippet to generate i18n resource model and placeholder i18n file.

**LANGUAGE**: JSON

**CODE**:
```json
{
  "sap.ui5": {
    "models": {
      "i18n": {
        "type": "sap.ui.model.resource.ResourceModel",
        "settings": {
          "bundleName": "my.app.i18n.i18n"
        }
      }
    }
  }
}
```

File: webapp/i18n/i18n.properties
```text
title=My Fiori Elements App
book.title=Title
book.author=Author
book.price=Price
```

**STEP**: 9 — Trade-offs and Operational Advice

**DESCRIPTION**: Use this short text as a comment block in generated README or scaffold prompts to set expectations.

**LANGUAGE**: TEXT

**CODE**:
```text
- Initial setup time is higher: create annotations, configure manifest, and wire OData service.
- Long-term payoff: consistent UX, faster app creation for additional entities, lower maintenance.
- For maximum control, combine Fiori Elements for standard screens and freestyle UI5 for custom screens.
- Test with real OData metadata and annotation files early to validate templates (ListReport/ObjectPage).
```

**STEP**: 10 — Quick Checklist for Code Generators

**DESCRIPTION**: Include this checklist in scaffolding scripts or wizards to validate before building/deploying.

**LANGUAGE**: TEXT

**CODE**:
```text
- [ ] manifest.json contains sap.ui.generic.app/pages with correct entitySet and template component.
- [ ] dataSource mainService points to the correct OData URI and version.
- [ ] Annotations provided (CDS or annotations.xml) expose UI.HeaderInfo and UI.LineItem at minimum.
- [ ] i18n resource bundle configured and present in webapp/i18n/.
- [ ] Backend service exposes the entity set (CDS service or OData service).
- [ ] Accessibility and translation tested; mobile layout validated.
```
--------------------------------

**TITLE**: Working With OData Annotations (Fiori Elements)

**INTRODUCTION**: Quick reference and ready-to-use code examples for defining OData annotations used by SAP Fiori elements. Includes XML annotation files, CAP CDS, and ABAP CDS examples, plus how to register front-end annotation files in manifest.json so they override or extend back-end annotations.

**TAGS**: fiori-elements-framework, OData, annotations, CDS, CAP, RAP, ABAP, XML, manifest.json, UI.LineItem, Common.Label

**STEP**: 1 — Add a label for a single property (XML annotation file)

**DESCRIPTION**: Create an additional annotation XML file and target the specific entity property to define a UI label. Save file in your UI project (example path: webapp/annotations/annotations.xml). When this file is registered in manifest.json, the front-end annotation will be applied (and will override same-term back-end annotations for the same term).

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/annotations/annotations.xml -->
<Annotations Target="namespace.ServiceName.Products/Name" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="Common.Label" String="Name"/>
</Annotations>
```

**STEP**: 2 — Add a label in back-end CDS (ABAP CDS)

**DESCRIPTION**: Add or update an ABAP CDS projection/view to annotate the property with an end-user text label. This resides in the ABAP back end. When the $metadata is requested, the annotation is exposed as XML automatically.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
// Example ABAP CDS projection (file name / package scope as per ABAP dev environment)
@EndUserText.label: 'Products Projection'
define view ZProducts_Projection as select from ZProducts {
  @EndUserText.label: 'Name'
  name          as Name,
  @EndUserText.label: 'Category'
  category      as Category,
  @EndUserText.label: 'Price'
  price         as Price,
  @EndUserText.label: 'Availability'
  availability  as Availability
}
```

**STEP**: 3 — Add a label in CAP CDS (service/data model)

**DESCRIPTION**: In CAP, annotate the model field with @title or @EndUserText to generate semantic annotations in the service metadata. Place in your CDS model file (e.g., db/schema.cds or srv/service.cds depending on project layout).

**LANGUAGE**: CDS

**CODE**:
```cds
// File: db/schema.cds (or appropriate CAP model file)
entity Products {
  key ID       : UUID;
  Name         : String(100) @title: 'Name';
  Category     : String(50)  @title: 'Category';
  Price        : Decimal(9,2) @title: 'Price';
  Availability : String(20)  @title: 'Availability';
}
```

**STEP**: 4 — Define UI.LineItem (XML annotation for table columns)

**DESCRIPTION**: Define which entity properties appear as columns in a list/table using the UI.LineItem term. Use a front-end annotation file or expect the back end to provide equivalent annotations. Wrap the UI.LineItem in an Annotations element targeting the entity type.

**LANGUAGE**: XML

**CODE**:
```xml
<!-- File: webapp/annotations/lineitems.xml -->
<Annotations Target="namespace.ServiceName.Products" xmlns="http://docs.oasis-open.org/odata/ns/edm">
  <Annotation Term="UI.LineItem">
    <Collection>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Name"/>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Category"/>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Price"/>
      </Record>
      <Record Type="UI.DataField">
        <PropertyValue Property="Value" Path="Availability"/>
      </Record>
    </Collection>
  </Annotation>
</Annotations>
```

**STEP**: 5 — Define UI.LineItem in ABAP CDS (back end)

**DESCRIPTION**: Annotate individual fields in an ABAP CDS view to control the order/appearance of line items in UI list/table. Use @UI.lineItem with position metadata. The CDS view name and annotation placement follow ABAP CDS development conventions.

**LANGUAGE**: ABAP CDS

**CODE**:
```abap
// Example ABAP CDS projection or view with UI.lineItem annotations
@UI.lineItem: [{ position: 10 }]
Name;

@UI.lineItem: [{ position: 20 }]
Category;

@UI.lineItem: [{ position: 30 }]
Price;

@UI.lineItem: [{ position: 40 }]
Availability;
```

**STEP**: 6 — Define UI.LineItem in CAP (annotate service)

**DESCRIPTION**: In CAP, annotate the service to attach UI.LineItem to an entity exposed by the service. Use an "annotate <Service>.<Entity> with" construct inside a CDS service file (e.g., srv/service.cds).

**LANGUAGE**: CDS

**CODE**:
```cds
// File: srv/service.cds
service CatalogService {
  entity Products as projection on my.Product;
}

annotate CatalogService.Products with @(UI.LineItem: [
  { $Type: 'UI.DataField', Value: Name },
  { $Type: 'UI.DataField', Value: Category },
  { $Type: 'UI.DataField', Value: Price },
  { $Type: 'UI.DataField', Value: Availability }
]);
```

**STEP**: 7 — Register front-end annotation files in manifest.json

**DESCRIPTION**: Add local annotation files to your UI application's manifest.json so the Fiori elements runtime loads them as additional annotation sources. Front-end annotations override back-end annotations on a term-by-term basis. Place the annotation files under webapp/annotations/ and reference them from webapp/manifest.json.

**LANGUAGE**: JSON

**CODE**:
```json
// File: webapp/manifest.json (relevant excerpt)
{
  "sap.app": {
    "id": "com.example.app",
    "title": "Example App"
  },
  "sap.ui5": {
    "models": {
      "": {
        "dataSource": "mainService",
        "settings": {
          "annotations": [
            "annotations/annotations.xml",
            "annotations/lineitems.xml"
          ]
        }
      }
    }
  }
}
```

**STEP**: 8 — Behavior notes and best practices (short actionable guidance)

**DESCRIPTION**: Rules to apply when deciding where to maintain annotations:
- Maintain annotations in the back end (CDS) when possible to keep semantic metadata with the data model (recommended).
- Use front-end annotation files when you must override back-end annotations for a single UI or when you cannot change the back end.
- Front-end annotations overwrite back-end terms on a term-by-term basis; keep file paths consistent and validate after property renames.
- Use SAP Fiori Tools in VS Code / Business Application Studio to edit and validate XML and CAP CDS annotations (Page Map, Guided Development, and annotation editors).

**LANGUAGE**: JSON

**CODE**:
```json
// Example file locations referenced above
// webapp/annotations/annotations.xml
// webapp/annotations/lineitems.xml
// webapp/manifest.json
// db/schema.cds (CAP model)
// srv/service.cds (CAP service annotations)
// ABAP CDS are maintained in the ABAP backend (via ADT) as view/metadata definitions.
```
--------------------------------

**TITLE**: Worklist (SAP Fiori Elements) — actionable configuration and code snippets

**INTRODUCTION**: This document summarizes how to create and configure a Worklist floorplan in SAP Fiori Elements (OData V2 and V4). It focuses on practical, copy-pasteable manifest and view snippets and exact flags to set for variant management and table behavior. Use these snippets when generating or modifying a Worklist app (SAP Fiori application generator) and when customizing the manifest.json or view XML.

**TAGS**: fiori-elements, worklist, manifest.json, smart-table, variant-management, ODataV2, ODataV4, SAPUI5

STEP: 1 — Create Worklist app with the SAP Fiori generator
DESCRIPTION: Use the SAP Fiori application generator to scaffold a Worklist app. In the Template Selection step choose "Worklist Page" as the template. This creates a simplified list report (worklist) without a smart filter bar and with a search field in the table toolbar.
LANGUAGE: none
CODE:
```text
Action: Run the SAP Fiori application generator (yo easy-ui5 / yo @sap/generator-fiori, or other tooling)
Template: Choose "Worklist Page" during template selection
Notes:
- Worklist is a simplified list report (no SmartFilterBar).
- Search field is available in the table toolbar.
```

STEP: 2 — Enable table-level variant management (manifest.json)
DESCRIPTION: To provide variant management at the table level set the variantManagementHidden flag to false in the worklist page settings in manifest.json. The exact manifest path depends on the generated structure; below are two safe patterns found in Fiori Elements manifest layouts. Replace <pageIndexOrId>, <entitySet> and template names as needed for your app.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "component": {
          "name": "sap.suite.ui.generic.template.Worklist",   /* or the template name used in your project */
          "settings": {
            "entitySet": "WorklistEntitySet",
            "variantManagementHidden": false
          }
        }
      }
    ]
  }
}
```

STEP: 3 — Enable page-level variant management (manifest.json)
DESCRIPTION: For page-level variant management enable smartVariantManagement and ensure variantManagementHidden is false. Add both flags in the worklist page settings in manifest.json.
LANGUAGE: JSON
CODE:
```json
{
  "sap.ui.generic.app": {
    "pages": [
      {
        "component": {
          "name": "sap.suite.ui.generic.template.Worklist",
          "settings": {
            "entitySet": "WorklistEntitySet",
            "smartVariantManagement": true,
            "variantManagementHidden": false
          }
        }
      }
    ]
  }
}
```

STEP: 4 — Smart table: enable multiselect, responsive table, row count (XML view)
DESCRIPTION: The worklist uses a SmartTable. Typical requirements: default responsive table, show row count in title, and allow multi-selection. The SmartTable will create a responsive sap.m.Table by default. Use the inner table "mode" property to enable MultiSelect. This XML snippet shows the canonical pattern — adapt ids, entitySet and namespace prefixes to your view.
LANGUAGE: XML
CODE:
```xml
<!-- Add namespace declarations on the root view:
     xmlns:smartTable="sap.ui.comp.smarttable"
     xmlns:table="sap.m"
-->
<smartTable:SmartTable
    id="WorklistSmartTable"
    entitySet="WorklistEntitySet"
    tableType="ResponsiveTable"
    showRowCount="true"
    useVariantManagement="true"
    header="Worklist"
    enableAutoBinding="true">
    <!-- The generated inner table will use this sap.m.Table config -->
    <table:Table id="WorklistTableInner" mode="MultiSelect" />
</smartTable:SmartTable>
```

STEP: 5 — Smart table notes and limitations (actionable checklist)
DESCRIPTION: Apply these behavioral rules and constraints in your implementation (no code block required).
LANGUAGE: none
CODE:
```text
Checklist:
- Multiselect: enabled for worklist tables (use sap.m.Table mode="MultiSelect").
- No-selection table: if a table has only line-item actions, consider no-selection mode as per business logic.
- Export to Excel: Not available in Worklist; do not rely on useExportToExcel.
- Table type: Responsive table is the default.
- Row count: Show using showRowCount in SmartTable (title will contain the row count).
- Table content: Fixed layout and scroll-to-load are the default settings; confirm performance behavior in the generated app.
- "Execute on Select" action: Not available in the worklist floorplan — avoid trying to configure it.
```

STEP: 6 — Create a category worklist (multiple views inside a single table)
DESCRIPTION: To implement a category worklist, define multiple views (multiple table views) inside the single table. These views are configured as "multiple views" on the list table (see your list-report/worklist view annotations or the List Report tools). Use the List Report / SmartTable multiple views feature or the generator options; the pattern is the same as "Defining Multiple Views on a List Report Table - Single Table Mode".
LANGUAGE: none
CODE:
```text
Action:
- Define multiple table views (e.g., different default filters or columns) using the SmartTable/ListReport multiple views feature.
- Reference: use your project's annotation file or the List Report configuration to add additional views.
Note:
- Exact implementation depends on whether your project uses annotations or manifest-driven configuration. Consult the "Defining Multiple Views on a List Report Table - Single Table Mode" documentation for annotation examples.
```

STEP: 7 — OData V4 considerations
DESCRIPTION: For OData V4 the Worklist is still a simplified list report without a filter bar. Create a Worklist template with the SAP Fiori application generator. Use the same manifest flags (smartVariantManagement, variantManagementHidden) and SmartTable patterns. For filter-related differences, consult "Configuring Filter Bars".
LANGUAGE: none
CODE:
```text
Notes:
- OData V4 worklists follow the same high-level manifest and SmartTable settings.
- Filter bar: Not present in Worklist; any filter UI must be realized in the table toolbar or custom extensions.
```

STEP: 8 — References and extension points
DESCRIPTION: Where to look next and which docs/extensions to consult when customizing further.
LANGUAGE: none
CODE:
```text
Key references:
- Building an App / Generator: use "Worklist Page" template step.
- List Report and Object Page docs for additional configuration patterns.
- Configuring Tables and Configuring Filter Bars for SmartTable details.
- Extending List Reports and Object Pages Using App Extensions for custom behavior.
- SAP Fiori Design Guidelines for floorplan UX expectations.
```

--------------------------------
